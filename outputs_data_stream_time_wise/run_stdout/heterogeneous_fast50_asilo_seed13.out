[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:39803
[S3] → join 127.0.0.1:39802
[S4] → join 127.0.0.1:39802
[S5] → join 127.0.0.1:39802
[S6] → join 127.0.0.1:39802
[S7] → join 127.0.0.1:39802
[S8] → join 127.0.0.1:39802
[S9] → join 127.0.0.1:39802
[S10] → join 127.0.0.1:39802
[S11] → join 127.0.0.1:39802
[S13] → join 127.0.0.1:39802
[S14] → join 127.0.0.1:39802
[S15] → join 127.0.0.1:39802
[S16] → join 127.0.0.1:39802
[S17] → join 127.0.0.1:39802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.209882 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.199233 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.113235 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.155243 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.143025 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.171347 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.101981 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.127373 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.130461 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.177005 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.177009 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.166676 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.118523 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.194061 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.151082 (no previous merge yet)
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S16
[S3] + discovered S13
[S3] + discovered S9
[S3] + discovered S4
[S3] + discovered S15
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S17
[S3] + discovered S10
[S3] + discovered S8
[S3] + discovered S7
[S3] + discovered S6
[S3] + discovered S11
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S8
[S4] + discovered S7
[S4] + discovered S6
[S4] + discovered S11
[S4] + discovered S5
[S4] + discovered S14
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S9
[S4] + discovered S15
[S5] + discovered S9
[S5] + discovered S16
[S5] + discovered S11
[S5] + discovered S10
[S5] + discovered S17
[S5] + discovered S15
[S5] + discovered S7
[S5] + discovered S13
[S5] + discovered S14
[S5] + discovered S6
[S5] + discovered S8
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S2
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S4
[S6] + discovered S7
[S6] + discovered S17
[S6] + discovered S11
[S6] + discovered S9
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S13
[S6] + discovered S15
[S6] + discovered S10
[S6] + discovered S16
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S14
[S7] + discovered S11
[S7] + discovered S9
[S7] + discovered S10
[S7] + discovered S13
[S7] + discovered S8
[S7] + discovered S17
[S8] + discovered S5
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S2
[S8] + discovered S6
[S8] + discovered S17
[S8] + discovered S10
[S8] + discovered S15
[S8] + discovered S9
[S8] + discovered S13
[S8] + discovered S11
[S8] + discovered S14
[S8] + discovered S16
[S9] + discovered S6
[S9] + discovered S8
[S9] + discovered S7
[S9] + discovered S3
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S13
[S9] + discovered S15
[S9] + discovered S10
[S10] + discovered S4
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S2
[S10] + discovered S5
[S10] + discovered S3
[S10] + discovered S8
[S10] + discovered S6
[S11] + discovered S8
[S11] + discovered S10
[S11] + discovered S2
[S11] + discovered S9
[S11] + discovered S6
[S11] + discovered S3
[S11] + discovered S5
[S11] + discovered S7
[S11] + discovered S4
[S10] + discovered S15
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S16
[S13] + discovered S9
[S13] + discovered S11
[S13] + discovered S10
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S5
[S13] + discovered S3
[S13] + discovered S6
[S13] + discovered S2
[S13] + discovered S8
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S15
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S17
[S13] + discovered S16
[S14] + discovered S2
[S14] + discovered S6
[S14] + discovered S5
[S14] + discovered S7
[S14] + discovered S11
[S14] + discovered S8
[S14] + discovered S10
[S14] + discovered S3
[S14] + discovered S4
[S14] + discovered S9
[S14] + discovered S13
[S15] + discovered S13
[S15] + discovered S9
[S15] + discovered S14
[S15] + discovered S7
[S15] + discovered S6
[S15] + discovered S2
[S15] + discovered S10
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S8
[S15] + discovered S11
[S15] + discovered S5
[S14] + discovered S16
[S14] + discovered S17
[S14] + discovered S15
[S16] + discovered S8
[S16] + discovered S10
[S16] + discovered S14
[S16] + discovered S9
[S16] + discovered S15
[S16] + discovered S5
[S16] + discovered S11
[S16] + discovered S3
[S16] + discovered S4
[S16] + discovered S2
[S16] + discovered S6
[S16] + discovered S7
[S16] + discovered S13
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S17
[S17] + discovered S16
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S10
[S17] + discovered S13
[S17] + discovered S5
[S17] + discovered S7
[S17] + discovered S2
[S17] + discovered S3
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S8
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S7] ⇄ pheromone p=1.000 → S13@127.0.0.1:39813
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:39811
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S10] ⇄ pheromone p=1.000 → S5@127.0.0.1:39805
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:39805
[S9] ⇄ pheromone p=1.000 → S7@127.0.0.1:39808
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:39808
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:39808
[S11] ⇄ pheromone p=1.000 → S2@127.0.0.1:39802
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:39803
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:39807
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:39809
[S2] START round=1 head_norm_before_train=1.241940 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1755252752414433, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6156895487922063, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.211001 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5714928260230896, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4793320956867033, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.116590 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.31941247396689687, 'auprc': 0.31941247396689687, 'loss_val': 1.464931664996885, 'psi': 0.31941247396689687}-{'f1_val': 0.3329127234490011, 'auprc': 0.3329127234490011, 'loss_val': 1.364006506328451, 'psi': 0.3329127234490011}
[S5] START round=1 head_norm_before_train=1.153281 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4225358895697713, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.401050096916605, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.164907 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8504077826426493, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5102367354213104, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.174934 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5616852702348034, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5110063852471323, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.113717 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5141950411458398, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.410229684342869, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.136160 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.598270724694462, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.48977944253362, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.143048 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5405786920072748, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4410050854294905, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.178496 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4867841292740067, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4150616226028312, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.182135 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.613398200871263, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.454848497275552, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.172154 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4768830524305663, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3978072720986843, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.117605 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6505951610584852, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.495576315942495, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.204322 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5289820886612304, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4406717807497973, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.180114 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7690985474936185, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4980980275823943, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.301325 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.774222664237214, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1755252752414433, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.233282 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7901177005724667, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5714928260230896, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.146147 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.31928900592495063, 'auprc': 0.31928900592495063, 'loss_val': 1.7103184049938909, 'psi': 0.31928900592495063}-{'f1_val': 0.31941247396689687, 'auprc': 0.31941247396689687, 'loss_val': 1.464931664996885, 'psi': 0.31941247396689687}
[S5] START round=2 head_norm_before_train=1.162367 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4609301964782349, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4225358895697713, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.216858 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9816766250929705, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8504077826426493, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.188903 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6500015916164321, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5616852702348034, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.150323 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8067870452493395, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5141950411458398, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.157868 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8321376169393544, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.598270724694462, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.181328 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8129032117417057, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5405786920072748, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.190671 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6183280405692924, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4867841292740067, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.213466 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8786069797403389, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.613398200871263, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.188436 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6132490204640983, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4768830524305663, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.148272 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0129243209258894, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6505951610584852, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.225114 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7376704469183084, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5289820886612304, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.234508 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.975755191799851, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7690985474936185, 'psi': 0.0}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.345985 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.809749913916844, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.774222664237214, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.267721 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3961551583653056, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7901177005724667, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.196728 (no previous merge yet)
[S4] round=3 local utility u=0.168619 metrics={'f1_val': 0.33238845144356954, 'auprc': 0.33238845144356954, 'loss_val': 1.4909757687371459, 'psi': 0.33238845144356954}-{'f1_val': 0.31928900592495063, 'auprc': 0.31928900592495063, 'loss_val': 1.7103184049938909, 'psi': 0.31928900592495063}
[S5] START round=3 head_norm_before_train=1.181972 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5483336871073468, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4609301964782349, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.280641 (no previous merge yet)
[S6] round=3 local utility u=0.151655 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6783657649014243, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9816766250929705, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.214060 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.862473146960163, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6500015916164321, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.199941 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.3220148873253798, 'auprc': 0.3220148873253798, 'loss_val': 1.5112893230610684, 'psi': 0.3220148873253798}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8067870452493395, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.190596 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4246576077335207, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8321376169393544, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.226413 (no previous merge yet)
[S10] round=3 local utility u=0.014528 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7838462241527775, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8129032117417057, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.213763 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9798324520694919, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6183280405692924, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.249088 (no previous merge yet)
[S13] round=3 local utility u=0.126090 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6264275422297971, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8786069797403389, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.216513 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.937712816278501, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6132490204640983, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.189637 (no previous merge yet)
[S15] round=3 local utility u=0.060266 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8923922930212942, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0129243209258894, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.256458 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3839574559888606, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7376704469183084, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.269573 (no previous merge yet)
[S17] round=3 local utility u=0.126321 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7231124945570153, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.975755191799851, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:39814
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39805
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=-0.0136
[S5] DROPPED delta from S8 (cos=-0.0136 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S4
[S14] cosine check vs S4: cos=0.0067
[S17] not sending this round → trigger blocked (psi=0.000)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.0000 head_norm=1.253142
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.732427e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.0000 head_norm=0.879073 delta_norm=0.873243
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.382672 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.822853990061484, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.809749913916844, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.308509 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8845456090125228, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3961551583653056, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.224860 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.21643423571233253, 'auprc': 0.21643423571233253, 'loss_val': 1.383179570062281, 'psi': 0.2164342357123325}-{'f1_val': 0.33238845144356954, 'auprc': 0.33238845144356954, 'loss_val': 1.4909757687371459, 'psi': 0.33238845144356954}
[S5] START round=4 head_norm_before_train=1.211419 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.727622276897802, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5483336871073468, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.316104 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0710730300592846, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6783657649014243, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.246073 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.03884494987155, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.862473146960163, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.224522 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.2278006203563442, 'auprc': 0.2278006203563442, 'loss_val': 1.3854372700596072, 'psi': 0.2278006203563442}-{'f1_val': 0.3220148873253798, 'auprc': 0.3220148873253798, 'loss_val': 1.5112893230610684, 'psi': 0.3220148873253798}
[S9] START round=4 head_norm_before_train=1.231330 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0708427739330224, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4246576077335207, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.256419 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.956706522988318, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7838462241527775, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.247726 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7002505557573304, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9798324520694919, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.253940 (no previous merge yet)
[S13] round=4 local utility u=0.057776 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.510875912631887, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6264275422297971, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=0.879073 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2250624613067713, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.937712816278501, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.208983 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9175586655442283, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8923922930212942, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.296535 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.156917069728391, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3839574559888606, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.283771 (no previous merge yet)
[S17] round=4 local utility u=0.058881 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6053514743586614, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7231124945570153, 'psi': 0.0}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=5 head_norm_before_train=1.430699 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.005500339883873, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.822853990061484, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.339389 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9490680658926722, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8845456090125228, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.279011 (no previous merge yet)
[S4] round=5 local utility u=0.458864 metrics={'f1_val': 0.3080965356169716, 'auprc': 0.3080965356169716, 'loss_val': 1.2904128963800507, 'psi': 0.3080965356169716}-{'f1_val': 0.21643423571233253, 'auprc': 0.21643423571233253, 'loss_val': 1.383179570062281, 'psi': 0.2164342357123325}
[S5] START round=5 head_norm_before_train=1.241288 (no previous merge yet)
[S5] round=5 local utility u=0.037471 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6526796857262818, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.727622276897802, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.368408 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3454840390933436, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0710730300592846, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.265650 (no previous merge yet)
[S7] round=5 local utility u=0.053135 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9325758679843592, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.03884494987155, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.275432 (no previous merge yet)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.20361057382333977, 'auprc': 0.20361057382333977, 'loss_val': 1.2397970307587252, 'psi': 0.20361057382333977}-{'f1_val': 0.2278006203563442, 'auprc': 0.2278006203563442, 'loss_val': 1.3854372700596072, 'psi': 0.2278006203563442}
[S9] START round=5 head_norm_before_train=1.264887 (no previous merge yet)
[S9] round=5 local utility u=0.083250 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9043426872771407, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0708427739330224, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.303871 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0034290025699204, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.956706522988318, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.282525 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.712996699737786, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7002505557573304, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.274082 (no previous merge yet)
[S13] round=5 local utility u=0.050762 metrics={'f1_val': 0.0016347882949158084, 'auprc': 0.0016347882949158084, 'loss_val': 1.4240658116690263, 'psi': 0.0016347882949158087}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.510875912631887, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=0.916702 cos_to_last_merge=0.9966 (last merge round=3)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9352045517493237, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2250624613067713, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.246774 (no previous merge yet)
[S15] round=5 local utility u=0.202743 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5120720133023529, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9175586655442283, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.329150 (no previous merge yet)
[S16] round=5 local utility u=0.013311 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1302957638836255, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.156917069728391, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.321247 (no previous merge yet)
[S17] round=5 local utility u=0.097394 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4105628114227562, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6053514743586614, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[S13] not sending this round → trigger blocked (psi=0.002)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=0.6494
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] ⇄ pheromone p=0.328 → S6@127.0.0.1:39807
[S9] ⇄ pheromone p=0.344 → S7@127.0.0.1:39808
[S5] ⇄ pheromone p=0.335 → S3@127.0.0.1:39803
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.0000 head_norm=0.953999
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.093159e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.0000 head_norm=1.042236 delta_norm=0.509316
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.328 → S7@127.0.0.1:39808
[S6] ⇄ pheromone p=0.347 → S7@127.0.0.1:39808
[S13] ⇄ pheromone p=0.363 → S10@127.0.0.1:39811
[S8] ⇄ pheromone p=0.456 → S5@127.0.0.1:39805
[S15] ⇄ pheromone p=0.376 → S14@127.0.0.1:39814
[S7] ⇄ pheromone p=0.338 → S13@127.0.0.1:39813
[S10] ⇄ pheromone p=0.330 → S5@127.0.0.1:39805
[S11] ⇄ pheromone p=0.328 → S2@127.0.0.1:39802
[S3] ⇄ pheromone p=0.328 → S14@127.0.0.1:39814
[S4] ⇄ pheromone p=0.441 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=0.373 → S8@127.0.0.1:39809
[S16] ⇄ pheromone p=0.330 → S14@127.0.0.1:39814
[S2] START round=6 head_norm_before_train=1.483569 (no previous merge yet)
[S2] round=6 local utility u=0.439266 metrics={'f1_val': 0.07072649572649573, 'auprc': 0.07072649572649573, 'loss_val': 2.7635070239881663, 'psi': 0.07072649572649573}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.005500339883873, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.362857 (no previous merge yet)
[S3] round=6 local utility u=0.145071 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.658925436183816, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9490680658926722, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.334618 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.20571799870045485, 'auprc': 0.20571799870045485, 'loss_val': 1.2850553429196687, 'psi': 0.20571799870045485}-{'f1_val': 0.3080965356169716, 'auprc': 0.3080965356169716, 'loss_val': 1.2904128963800507, 'psi': 0.3080965356169716}
[S5] START round=6 head_norm_before_train=1.244563 (no previous merge yet)
[S5] round=6 local utility u=0.054650 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5433800657310193, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6526796857262818, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.424569 (no previous merge yet)
[S6] round=6 local utility u=0.279868 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 2.979518424731084, 'psi': 0.02153000458085204}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3454840390933436, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.269072 (no previous merge yet)
[S7] round=6 local utility u=0.016521 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8995340891991528, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9325758679843592, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.331586 (no previous merge yet)
[S8] round=6 local utility u=0.482991 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.186876000608867, 'psi': 0.30506182380216385}-{'f1_val': 0.20361057382333977, 'auprc': 0.20361057382333977, 'loss_val': 1.2397970307587252, 'psi': 0.20361057382333977}
[S9] START round=6 head_norm_before_train=1.284434 (no previous merge yet)
[S9] round=6 local utility u=0.184627 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.535089687045178, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9043426872771407, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.361982 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.532480752385327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0034290025699204, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.301686 (no previous merge yet)
[S11] round=6 local utility u=0.168019 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3769590055406824, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.712996699737786, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.303990 (no previous merge yet)
[S13] round=6 local utility u=1.000000 metrics={'f1_val': 0.3069849690539346, 'auprc': 0.3069849690539346, 'loss_val': 1.2801664089521225, 'psi': 0.3069849690539346}-{'f1_val': 0.0016347882949158084, 'auprc': 0.0016347882949158084, 'loss_val': 1.4240658116690263, 'psi': 0.0016347882949158087}
[S14] START round=6 head_norm_before_train=1.042236 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.182954 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.569295652950797, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9352045517493237, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.287936 (no previous merge yet)
[S15] round=6 local utility u=0.908690 metrics={'f1_val': 0.1827100646352724, 'auprc': 0.1827100646352724, 'loss_val': 1.3390819961507763, 'psi': 0.1827100646352724}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5120720133023529, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.349256 (no previous merge yet)
[S16] round=6 local utility u=0.070620 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.989055236878768, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1302957638836255, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.362353 (no previous merge yet)
[S17] round=6 local utility u=0.017722 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3751194270077107, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4105628114227562, 'psi': 0.0}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.071)
[S6] not sending this round → trigger blocked (psi=0.022)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39805
[S16] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39811
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.183)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=-0.0101
[S5] DROPPED delta from S8 (cos=-0.0101 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.0667
[S17] not sending this round → trigger blocked (psi=0.000)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.0000 head_norm=1.412903
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.337848e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.0000 head_norm=0.998107 delta_norm=0.933785
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.541059 (no previous merge yet)
[S2] round=7 local utility u=0.869553 metrics={'f1_val': 0.23552894211576847, 'auprc': 0.23552894211576847, 'loss_val': 2.5076229836550965, 'psi': 0.23552894211576847}-{'f1_val': 0.07072649572649573, 'auprc': 0.07072649572649573, 'loss_val': 2.7635070239881663, 'psi': 0.07072649572649573}
[S3] START round=7 head_norm_before_train=1.381623 (no previous merge yet)
[S3] round=7 local utility u=0.171534 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.315856861884551, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.658925436183816, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.394045 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2757986189977453, 'psi': 0.0}-{'f1_val': 0.20571799870045485, 'auprc': 0.20571799870045485, 'loss_val': 1.2850553429196687, 'psi': 0.20571799870045485}
[S5] START round=7 head_norm_before_train=1.247370 (no previous merge yet)
[S5] round=7 local utility u=0.222669 metrics={'f1_val': 0.04478491455509723, 'auprc': 0.04478491455509723, 'loss_val': 1.5011055822073482, 'psi': 0.04478491455509723}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5433800657310193, 'psi': 0.0}
[S6] START round=7 head_norm_before_train=1.480397 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.010772833723653397, 'auprc': 0.010772833723653397, 'loss_val': 4.080874591767603, 'psi': 0.010772833723653397}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 2.979518424731084, 'psi': 0.02153000458085204}
[S7] START round=7 head_norm_before_train=1.278166 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0325739921624257, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8995340891991528, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.382351 (no previous merge yet)
[S8] round=7 local utility u=0.048416 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.090043416663871, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.186876000608867, 'psi': 0.30506182380216385}
[S9] START round=7 head_norm_before_train=1.305974 (no previous merge yet)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.606206011084303, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.535089687045178, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=0.998107 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.514613 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.503254927607825, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.532480752385327, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.318220 (no previous merge yet)
[S11] round=7 local utility u=0.028165 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3206284814748224, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3769590055406824, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.319109 (no previous merge yet)
[S13] round=7 local utility u=0.179378 metrics={'f1_val': 0.3331695331695332, 'auprc': 0.3331695331695332, 'loss_val': 1.1570720889567152, 'psi': 0.3331695331695332}-{'f1_val': 0.3069849690539346, 'auprc': 0.3069849690539346, 'loss_val': 1.2801664089521225, 'psi': 0.3069849690539346}
[S14] START round=7 head_norm_before_train=1.056733 cos_to_last_merge=0.9976 (last merge round=5)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8795198169501885, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.569295652950797, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.350799 (no previous merge yet)
[S15] round=7 local utility u=0.130682 metrics={'f1_val': 0.2053577219952001, 'auprc': 0.2053577219952001, 'loss_val': 1.2815470555488653, 'psi': 0.2053577219952001}-{'f1_val': 0.1827100646352724, 'auprc': 0.1827100646352724, 'loss_val': 1.3390819961507763, 'psi': 0.1827100646352724}
[S16] START round=7 head_norm_before_train=1.368276 (no previous merge yet)
[S16] round=7 local utility u=0.028662 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9317319051820587, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.989055236878768, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.406480 (no previous merge yet)
[S17] round=7 local utility u=0.155472 metrics={'f1_val': 0.02944015444015444, 'auprc': 0.02944015444015444, 'loss_val': 1.329137234927258, 'psi': 0.029440154440154437}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3751194270077107, 'psi': 0.0}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39807
[S13] not sending this round → trigger blocked (psi=0.333)
[S5] not sending this round → trigger blocked (psi=0.045)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[S16] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.305)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0005
[S14] DROPPED delta from S15 (cos=-0.0005 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=0.0264
[S17] not sending this round → trigger blocked (psi=0.029)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.0108 head_norm=1.532758
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.093733e+00
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.122929 delta_norm=1.093733
[S6] aggregate: ROLLBACK (f1_val pre=0.011 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=1.601592 (no previous merge yet)
[S2] round=8 local utility u=0.612999 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.469161861768676, 'psi': 0.3674775928297055}-{'f1_val': 0.23552894211576847, 'auprc': 0.23552894211576847, 'loss_val': 2.5076229836550965, 'psi': 0.23552894211576847}
[S3] START round=8 head_norm_before_train=1.404326 (no previous merge yet)
[S3] round=8 local utility u=0.111258 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0933404099199984, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.315856861884551, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.443471 (no previous merge yet)
[S4] round=8 local utility u=0.593829 metrics={'f1_val': 0.12606292517006804, 'auprc': 0.12606292517006804, 'loss_val': 1.222707362459991, 'psi': 0.12606292517006804}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2757986189977453, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.262449 (no previous merge yet)
[S5] round=8 local utility u=0.807543 metrics={'f1_val': 0.21817773283900685, 'auprc': 0.21817773283900685, 'loss_val': 1.4465558314952536, 'psi': 0.21817773283900685}-{'f1_val': 0.04478491455509723, 'auprc': 0.04478491455509723, 'loss_val': 1.5011055822073482, 'psi': 0.04478491455509723}
[S6] START round=8 head_norm_before_train=1.122929 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.287557 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.408805763438735, 'psi': 0.0}-{'f1_val': 0.010772833723653397, 'auprc': 0.010772833723653397, 'loss_val': 4.080874591767603, 'psi': 0.010772833723653397}
[S7] START round=8 head_norm_before_train=1.299300 (no previous merge yet)
[S7] round=8 local utility u=0.047495 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9375830738732733, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0325739921624257, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.426007 (no previous merge yet)
[S8] round=8 local utility u=0.180931 metrics={'f1_val': 0.33274715014912354, 'auprc': 0.33274715014912354, 'loss_val': 0.9773498367903869, 'psi': 0.33274715014912354}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.090043416663871, 'psi': 0.30506182380216385}
[S9] START round=8 head_norm_before_train=1.339420 (no previous merge yet)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8905387515856766, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.606206011084303, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.060344 cos_to_last_merge=0.9943 (last merge round=6)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.665129811848024, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.503254927607825, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.341965 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.498181172886691, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3206284814748224, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.354987 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.24025513819985825, 'auprc': 0.24025513819985825, 'loss_val': 1.075582007979438, 'psi': 0.24025513819985825}-{'f1_val': 0.3331695331695332, 'auprc': 0.3331695331695332, 'loss_val': 1.1570720889567152, 'psi': 0.3331695331695332}
[S14] START round=8 head_norm_before_train=1.075479 cos_to_last_merge=0.9907 (last merge round=5)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.974711361728878, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8795198169501885, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.404719 (no previous merge yet)
[S15] round=8 local utility u=0.154712 metrics={'f1_val': 0.2452552482763963, 'auprc': 0.2452552482763963, 'loss_val': 1.3312015937697208, 'psi': 0.2452552482763963}-{'f1_val': 0.2053577219952001, 'auprc': 0.2053577219952001, 'loss_val': 1.2815470555488653, 'psi': 0.2053577219952001}
[S16] START round=8 head_norm_before_train=1.393193 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.992938073010369, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9317319051820587, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.449713 (no previous merge yet)
[S17] round=8 local utility u=0.483006 metrics={'f1_val': 0.1396797153024911, 'auprc': 0.1396797153024911, 'loss_val': 1.3552812975818762, 'psi': 0.1396797153024911}-{'f1_val': 0.02944015444015444, 'auprc': 0.02944015444015444, 'loss_val': 1.329137234927258, 'psi': 0.029440154440154437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:39805
[S6] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.245)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.367)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39803
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S8
[S5] cosine check vs S8: cos=-0.0059
[S5] DROPPED delta from S8 (cos=-0.0059 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=0.0249
[S14] RECEIVED delta(kind=head bytes=1796) from S4
[S14] cosine check vs S4: cos=0.8733
[S17] not sending this round → trigger blocked (psi=0.140)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.0000 head_norm=1.433309
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.494551e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.0000 head_norm=0.973224 delta_norm=0.949455
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.0000 head_norm=1.095096
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.782017e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.253166 delta_norm=0.378202
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.658923 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.24083317926911937, 'auprc': 0.24083317926911937, 'loss_val': 2.637814603021275, 'psi': 0.2408331792691194}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.469161861768676, 'psi': 0.3674775928297055}
[S3] START round=9 head_norm_before_train=0.973224 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.126713 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.839914297307847, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0933404099199984, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.492544 (no previous merge yet)
[S4] round=9 local utility u=0.533547 metrics={'f1_val': 0.24386322883818712, 'auprc': 0.24386322883818712, 'loss_val': 1.2158151856741126, 'psi': 0.24386322883818712}-{'f1_val': 0.12606292517006804, 'auprc': 0.12606292517006804, 'loss_val': 1.222707362459991, 'psi': 0.12606292517006804}
[S5] START round=9 head_norm_before_train=1.281751 (no previous merge yet)
[S5] round=9 local utility u=0.052178 metrics={'f1_val': 0.21938117053687, 'auprc': 0.21938117053687, 'loss_val': 1.3530302542430095, 'psi': 0.21938117053687}-{'f1_val': 0.21817773283900685, 'auprc': 0.21817773283900685, 'loss_val': 1.4465558314952536, 'psi': 0.21817773283900685}
[S6] START round=9 head_norm_before_train=1.183966 cos_to_last_merge=0.9963 (last merge round=7)
[S6] round=9 local utility u=0.066512 metrics={'f1_val': 0.06297071129707113, 'auprc': 0.06297071129707113, 'loss_val': 3.842518501929427, 'psi': 0.06297071129707113}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.408805763438735, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.311449 (no previous merge yet)
[S7] round=9 local utility u=0.102928 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7317279127767469, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9375830738732733, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.476482 (no previous merge yet)
[S8] round=9 local utility u=1.000000 metrics={'f1_val': 0.913152787279025, 'auprc': 0.913152787279025, 'loss_val': 0.9023844232831884, 'psi': 0.913152787279025}-{'f1_val': 0.33274715014912354, 'auprc': 0.33274715014912354, 'loss_val': 0.9773498367903869, 'psi': 0.33274715014912354}
[S9] START round=9 head_norm_before_train=1.379360 (no previous merge yet)
[S9] round=9 local utility u=0.123774 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.642991684994437, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8905387515856766, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.140906 cos_to_last_merge=0.9798 (last merge round=6)
[S10] round=9 local utility u=0.657737 metrics={'f1_val': 0.14697941275734053, 'auprc': 0.14697941275734053, 'loss_val': 2.672469993684622, 'psi': 0.14697941275734053}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.665129811848024, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.372436 (no previous merge yet)
[S11] round=9 local utility u=0.120469 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.257243111501644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.498181172886691, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.403710 (no previous merge yet)
[S13] round=9 local utility u=0.538719 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0752748288367477, 'psi': 0.3599362944611573}-{'f1_val': 0.24025513819985825, 'auprc': 0.24025513819985825, 'loss_val': 1.075582007979438, 'psi': 0.24025513819985825}
[S14] START round=9 head_norm_before_train=1.253166 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.128665 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7173810011348083, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.974711361728878, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.456808 (no previous merge yet)
[S15] round=9 local utility u=0.277330 metrics={'f1_val': 0.28935764509593614, 'auprc': 0.28935764509593614, 'loss_val': 1.1734631211331739, 'psi': 0.28935764509593614}-{'f1_val': 0.2452552482763963, 'auprc': 0.2452552482763963, 'loss_val': 1.3312015937697208, 'psi': 0.2452552482763963}
[S16] START round=9 head_norm_before_train=1.422693 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.058533693018362, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.992938073010369, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.490948 (no previous merge yet)
[S17] round=9 local utility u=0.115783 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2377181896763776, 'psi': 0.15234678044996122}-{'f1_val': 0.1396797153024911, 'auprc': 0.1396797153024911, 'loss_val': 1.3552812975818762, 'psi': 0.1396797153024911}
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39811
[S10] not sending this round → trigger blocked (psi=0.147)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.063)
[S5] not sending this round → trigger blocked (psi=0.219)
[S11] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.244)
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.913)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=-0.0084
[S14] DROPPED delta from S15 (cos=-0.0084 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.5892
[S17] not sending this round → trigger blocked (psi=0.152)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.1470 head_norm=1.212465
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.154544e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.2401 head_norm=1.192310 delta_norm=0.615454
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.705506 (no previous merge yet)
[S2] round=10 local utility u=0.594522 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5885703869555563, 'psi': 0.3674775928297055}-{'f1_val': 0.24083317926911937, 'auprc': 0.24083317926911937, 'loss_val': 2.637814603021275, 'psi': 0.2408331792691194}
[S3] START round=10 head_norm_before_train=1.011544 cos_to_last_merge=0.9982 (last merge round=8)
[S3] round=10 local utility u=0.014370 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8111739471206991, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.839914297307847, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.547314 (no previous merge yet)
[S4] round=10 local utility u=0.516108 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1999751070955975, 'psi': 0.3567939207526687}-{'f1_val': 0.24386322883818712, 'auprc': 0.24386322883818712, 'loss_val': 1.2158151856741126, 'psi': 0.24386322883818712}
[S5] START round=10 head_norm_before_train=1.298582 (no previous merge yet)
[S5] round=10 local utility u=1.000000 metrics={'f1_val': 0.6990686152773806, 'auprc': 0.6990686152773806, 'loss_val': 1.2750064841456115, 'psi': 0.6990686152773806}-{'f1_val': 0.21938117053687, 'auprc': 0.21938117053687, 'loss_val': 1.3530302542430095, 'psi': 0.21938117053687}
[S6] START round=10 head_norm_before_train=1.255264 cos_to_last_merge=0.9866 (last merge round=7)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 4.1957280985421805, 'psi': 0.09965504024530472}-{'f1_val': 0.06297071129707113, 'auprc': 0.06297071129707113, 'loss_val': 3.842518501929427, 'psi': 0.06297071129707113}
[S7] START round=10 head_norm_before_train=1.318921 (no previous merge yet)
[S7] round=10 local utility u=0.033660 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6644074415653904, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7317279127767469, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.546929 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.6481574261732622, 'auprc': 0.6481574261732622, 'loss_val': 0.8720256120430793, 'psi': 0.6481574261732622}-{'f1_val': 0.913152787279025, 'auprc': 0.913152787279025, 'loss_val': 0.9023844232831884, 'psi': 0.913152787279025}
[S9] START round=10 head_norm_before_train=1.418974 (no previous merge yet)
[S9] round=10 local utility u=0.201496 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.240000187596595, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.642991684994437, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.192310 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=1.000000 metrics={'f1_val': 0.33295467240856885, 'auprc': 0.33295467240856885, 'loss_val': 1.928755733270366, 'psi': 0.33295467240856885}-{'f1_val': 0.14697941275734053, 'auprc': 0.14697941275734053, 'loss_val': 2.672469993684622, 'psi': 0.14697941275734053}
[S11] START round=10 head_norm_before_train=1.404358 (no previous merge yet)
[S11] round=10 local utility u=0.120121 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0170003855373366, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.257243111501644, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.459692 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1599011942359154, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0752748288367477, 'psi': 0.3599362944611573}
[S14] START round=10 head_norm_before_train=1.266893 cos_to_last_merge=0.9991 (last merge round=8)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.931144292344773, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7173810011348083, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.492329 (no previous merge yet)
[S15] round=10 local utility u=0.127822 metrics={'f1_val': 0.286130964395811, 'auprc': 0.286130964395811, 'loss_val': 0.8887789958766668, 'psi': 0.286130964395811}-{'f1_val': 0.28935764509593614, 'auprc': 0.28935764509593614, 'loss_val': 1.1734631211331739, 'psi': 0.28935764509593614}
[S16] START round=10 head_norm_before_train=1.451882 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.280711242911867, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.058533693018362, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.522991 (no previous merge yet)
[S17] round=10 local utility u=0.050090 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.1372724504007137, 'psi': 0.15231723870467326}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2377181896763776, 'psi': 0.15234678044996122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:39803
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.286)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39805
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=0.9514
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] cosine check vs S2: cos=0.6174
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.0283
[S3] RECEIVED delta(kind=head bytes=1805) from S5
[S3] cosine check vs S5: cos=0.6279
[S17] not sending this round → trigger blocked (psi=0.152)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.0000 head_norm=1.287755
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.700249e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.422373 delta_norm=0.270025
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.143 → S7@127.0.0.1:39808
[S9] ⇄ pheromone p=0.188 → S7@127.0.0.1:39808
[S8] ⇄ pheromone p=0.377 → S5@127.0.0.1:39805
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.0000 head_norm=1.060298
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.250345e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.072920 delta_norm=0.525035
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.174 → S14@127.0.0.1:39814
[S11] ⇄ pheromone p=0.167 → S2@127.0.0.1:39802
[S15] ⇄ pheromone p=0.301 → S14@127.0.0.1:39814
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.0997 head_norm=1.320962
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.956207e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.0989 head_norm=1.379691 delta_norm=0.695621
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.184 → S7@127.0.0.1:39808
[S13] ⇄ pheromone p=0.306 → S10@127.0.0.1:39811
[S7] ⇄ pheromone p=0.141 → S13@127.0.0.1:39813
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.6991 head_norm=1.315069
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.921252e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.6713 head_norm=0.917709 delta_norm=0.892125
[S5] aggregate: ROLLBACK (f1_val pre=0.699 post=0.671 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.449 → S3@127.0.0.1:39803
[S2] ⇄ pheromone p=0.430 → S6@127.0.0.1:39807
[S4] ⇄ pheromone p=0.409 → S14@127.0.0.1:39814
[S10] ⇄ pheromone p=0.466 → S5@127.0.0.1:39805
[S16] ⇄ pheromone p=0.117 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=0.230 → S8@127.0.0.1:39809
[S2] START round=11 head_norm_before_train=1.740670 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.2168392264114085, 'auprc': 0.2168392264114085, 'loss_val': 2.8889468231010405, 'psi': 0.2168392264114085}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5885703869555563, 'psi': 0.3674775928297055}
[S3] START round=11 head_norm_before_train=1.072920 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.000523 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8101282264923926, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8111739471206991, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.591793 (no previous merge yet)
[S4] round=11 local utility u=0.014610 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1707553695563253, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1999751070955975, 'psi': 0.3567939207526687}
[S5] START round=11 head_norm_before_train=0.917709 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2873903019942297, 'psi': 0.35933890172383154}-{'f1_val': 0.6990686152773806, 'auprc': 0.6990686152773806, 'loss_val': 1.2750064841456115, 'psi': 0.6990686152773806}
[S6] START round=11 head_norm_before_train=1.379691 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 3.636629284128004, 'psi': 0.021310724106324473}-{'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 4.1957280985421805, 'psi': 0.09965504024530472}
[S7] START round=11 head_norm_before_train=1.334481 (no previous merge yet)
[S7] round=11 local utility u=0.020790 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6228270088172094, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6644074415653904, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.610513 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8601306963930138, 'psi': 0.35939447907390915}-{'f1_val': 0.6481574261732622, 'auprc': 0.6481574261732622, 'loss_val': 0.8720256120430793, 'psi': 0.6481574261732622}
[S9] START round=11 head_norm_before_train=1.452950 (no previous merge yet)
[S9] round=11 local utility u=0.684128 metrics={'f1_val': 0.09717568214456677, 'auprc': 0.09717568214456677, 'loss_val': 1.7463260164634276, 'psi': 0.09717568214456677}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.240000187596595, 'psi': 0.0}
[S10] START round=11 head_norm_before_train=1.243683 cos_to_last_merge=0.9966 (last merge round=9)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.33295531871194484, 'auprc': 0.33295531871194484, 'loss_val': 2.0991796346013487, 'psi': 0.33295531871194484}-{'f1_val': 0.33295467240856885, 'auprc': 0.33295467240856885, 'loss_val': 1.928755733270366, 'psi': 0.33295467240856885}
[S11] START round=11 head_norm_before_train=1.439959 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.453134736595583, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0170003855373366, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.512179 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2598460277907202, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1599011942359154, 'psi': 0.3599362944611573}
[S14] START round=11 head_norm_before_train=1.422373 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.010826 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9094916737103853, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.931144292344773, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.528526 (no previous merge yet)
[S15] round=11 local utility u=1.000000 metrics={'f1_val': 0.6152400655239009, 'auprc': 0.6152400655239009, 'loss_val': 0.7565726177624063, 'psi': 0.6152400655239009}-{'f1_val': 0.286130964395811, 'auprc': 0.286130964395811, 'loss_val': 0.8887789958766668, 'psi': 0.286130964395811}
[S16] START round=11 head_norm_before_train=1.483239 (no previous merge yet)
[S16] round=11 local utility u=0.302061 metrics={'f1_val': 0.03028991778450887, 'auprc': 0.03028991778450887, 'loss_val': 2.9491991657383276, 'psi': 0.03028991778450887}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.280711242911867, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.554737 (no previous merge yet)
[S17] round=11 local utility u=0.039710 metrics={'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 1.0570547896618523, 'psi': 0.15222868217054264}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.1372724504007137, 'psi': 0.15231723870467326}
[S3] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.097)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.030)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39814
[S15] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=-0.0113
[S14] DROPPED delta from S15 (cos=-0.0113 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.9833
[S17] not sending this round → trigger blocked (psi=0.152)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.0000 head_norm=1.441726
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.684287e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.528698 delta_norm=0.168429
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.768148 (no previous merge yet)
[S2] round=12 local utility u=0.771131 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7024298236403608, 'psi': 0.3674775928297055}-{'f1_val': 0.2168392264114085, 'auprc': 0.2168392264114085, 'loss_val': 2.8889468231010405, 'psi': 0.2168392264114085}
[S3] START round=12 head_norm_before_train=1.107239 cos_to_last_merge=0.9974 (last merge round=10)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9811465178066197, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8101282264923926, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.628495 (no previous merge yet)
[S4] round=12 local utility u=0.012244 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1462683136105534, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1707553695563253, 'psi': 0.3567939207526687}
[S5] START round=12 head_norm_before_train=0.942095 cos_to_last_merge=0.9982 (last merge round=10)
[S5] round=12 local utility u=0.015878 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.25563495256635, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2873903019942297, 'psi': 0.35933890172383154}
[S6] START round=12 head_norm_before_train=1.436106 cos_to_last_merge=0.9966 (last merge round=10)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 4.129363592235754, 'psi': 0.02240512117055327}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 3.636629284128004, 'psi': 0.021310724106324473}
[S7] START round=12 head_norm_before_train=1.349072 (no previous merge yet)
[S7] round=12 local utility u=0.023856 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5751154494452282, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6228270088172094, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.658316 (no previous merge yet)
[S8] round=12 local utility u=0.003614 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8529036365709696, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8601306963930138, 'psi': 0.35939447907390915}
[S9] START round=12 head_norm_before_train=1.485095 (no previous merge yet)
[S9] round=12 local utility u=0.225923 metrics={'f1_val': 0.14842166232261803, 'auprc': 0.14842166232261803, 'loss_val': 1.7556935178931494, 'psi': 0.14842166232261803}-{'f1_val': 0.09717568214456677, 'auprc': 0.09717568214456677, 'loss_val': 1.7463260164634276, 'psi': 0.09717568214456677}
[S10] START round=12 head_norm_before_train=1.321920 cos_to_last_merge=0.9854 (last merge round=9)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.3324559304458802, 'auprc': 0.3324559304458802, 'loss_val': 2.2036484452682537, 'psi': 0.3324559304458802}-{'f1_val': 0.33295531871194484, 'auprc': 0.33295531871194484, 'loss_val': 2.0991796346013487, 'psi': 0.33295531871194484}
[S11] START round=12 head_norm_before_train=1.476139 (no previous merge yet)
[S11] round=12 local utility u=0.210929 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0312760798756218, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.453134736595583, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.556095 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3689493788420268, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2598460277907202, 'psi': 0.3599362944611573}
[S14] START round=12 head_norm_before_train=1.528698 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2206933028234026, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9094916737103853, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.579320 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6156600837574151, 'auprc': 0.6156600837574151, 'loss_val': 0.7640933394223047, 'psi': 0.6156600837574151}-{'f1_val': 0.6152400655239009, 'auprc': 0.6152400655239009, 'loss_val': 0.7565726177624063, 'psi': 0.6152400655239009}
[S16] START round=12 head_norm_before_train=1.514314 (no previous merge yet)
[S16] round=12 local utility u=0.115536 metrics={'f1_val': 0.0618293991416309, 'auprc': 0.0618293991416309, 'loss_val': 3.001982543611985, 'psi': 0.0618293991416309}-{'f1_val': 0.03028991778450887, 'auprc': 0.03028991778450887, 'loss_val': 2.9491991657383276, 'psi': 0.03028991778450887}
[S17] START round=12 head_norm_before_train=1.598098 (no previous merge yet)
[S17] round=12 local utility u=0.034775 metrics={'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.9875050250271569, 'psi': 0.15222868217054264}-{'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 1.0570547896618523, 'psi': 0.15222868217054264}
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39805
[S16] not sending this round → trigger blocked (psi=0.062)
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.148)
[S5] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.9915
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.8691
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=0.6527
[S5] RECEIVED delta(kind=head bytes=1796) from S8
[S5] cosine check vs S8: cos=0.0051
[S17] not sending this round → trigger blocked (psi=0.152)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.0000 head_norm=1.149249
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.500813e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.0000 head_norm=0.967802 delta_norm=0.450081
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.0224 head_norm=1.500015
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.439119e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.0220 head_norm=1.591345 delta_norm=0.443912
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.0000 head_norm=1.548895
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.199048e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.603508 delta_norm=0.119905
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.3593 head_norm=0.978597
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.802319e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.3593 head_norm=0.984583 delta_norm=0.980232
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.791321 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7680317934438436, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7024298236403608, 'psi': 0.3674775928297055}
[S3] START round=13 head_norm_before_train=0.967802 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.005015 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9711173181942563, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9811465178066197, 'psi': 0.0}
[S4] START round=13 head_norm_before_train=1.664979 (no previous merge yet)
[S4] round=13 local utility u=0.010892 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.12448415431389, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1462683136105534, 'psi': 0.3567939207526687}
[S5] START round=13 head_norm_before_train=0.984583 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.3201405847811234, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.25563495256635, 'psi': 0.35933890172383154}
[S6] START round=13 head_norm_before_train=1.591345 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.253055 metrics={'f1_val': 0.024145785876993165, 'auprc': 0.024145785876993165, 'loss_val': 3.6389203795292198, 'psi': 0.024145785876993165}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 4.129363592235754, 'psi': 0.02240512117055327}
[S7] START round=13 head_norm_before_train=1.359340 (no previous merge yet)
[S7] round=13 local utility u=0.007464 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5601874062635617, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5751154494452282, 'psi': 0.0}
[S8] START round=13 head_norm_before_train=1.703780 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.856094820204826, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8529036365709696, 'psi': 0.35939447907390915}
[S9] START round=13 head_norm_before_train=1.519226 (no previous merge yet)
[S9] round=13 local utility u=1.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4999635952824928, 'psi': 0.36867172340800847}-{'f1_val': 0.14842166232261803, 'auprc': 0.14842166232261803, 'loss_val': 1.7556935178931494, 'psi': 0.14842166232261803}
[S10] START round=13 head_norm_before_train=1.399442 cos_to_last_merge=0.9722 (last merge round=9)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.3328754815262242, 'auprc': 0.3328754815262242, 'loss_val': 2.266930994488047, 'psi': 0.3328754815262242}-{'f1_val': 0.3324559304458802, 'auprc': 0.3324559304458802, 'loss_val': 2.2036484452682537, 'psi': 0.3324559304458802}
[S11] START round=13 head_norm_before_train=1.509727 (no previous merge yet)
[S11] round=13 local utility u=0.594895 metrics={'f1_val': 0.19120586275816123, 'auprc': 0.19120586275816123, 'loss_val': 2.5623389267202485, 'psi': 0.19120586275816123}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0312760798756218, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.583537 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4469240571367887, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3689493788420268, 'psi': 0.3599362944611573}
[S14] START round=13 head_norm_before_train=1.603508 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.381174642842502, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2206933028234026, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.628790 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6155201796505004, 'auprc': 0.6155201796505004, 'loss_val': 0.7719097439370802, 'psi': 0.6155201796505004}-{'f1_val': 0.6156600837574151, 'auprc': 0.6156600837574151, 'loss_val': 0.7640933394223047, 'psi': 0.6156600837574151}
[S16] START round=13 head_norm_before_train=1.543481 (no previous merge yet)
[S16] round=13 local utility u=0.055385 metrics={'f1_val': 0.06811033147834503, 'auprc': 0.06811033147834503, 'loss_val': 2.9477410374240636, 'psi': 0.06811033147834503}-{'f1_val': 0.0618293991416309, 'auprc': 0.0618293991416309, 'loss_val': 3.001982543611985, 'psi': 0.0618293991416309}
[S17] START round=13 head_norm_before_train=1.634070 (no previous merge yet)
[S17] round=13 local utility u=0.033615 metrics={'f1_val': 0.1555456647778618, 'auprc': 0.1555456647778618, 'loss_val': 0.9501280405060715, 'psi': 0.1555456647778618}-{'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.9875050250271569, 'psi': 0.15222868217054264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:39814
[S16] not sending this round → trigger blocked (psi=0.068)
[S6] not sending this round → trigger blocked (psi=0.024)
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.191)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S9
[S7] cosine check vs S9: cos=-0.0033
[S7] DROPPED delta from S9 (cos=-0.0033 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S4
[S14] cosine check vs S4: cos=0.9942
[S17] not sending this round → trigger blocked (psi=0.156)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.0000 head_norm=1.618408
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.003629e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.661084 delta_norm=0.100363
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.811328 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.819204536116276, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7680317934438436, 'psi': 0.3674775928297055}
[S3] START round=14 head_norm_before_train=1.004239 cos_to_last_merge=0.9970 (last merge round=12)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1454502119765646, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9711173181942563, 'psi': 0.0}
[S4] START round=14 head_norm_before_train=1.708596 (no previous merge yet)
[S4] round=14 local utility u=0.013176 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0981321777200646, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.12448415431389, 'psi': 0.3567939207526687}
[S5] START round=14 head_norm_before_train=1.008841 cos_to_last_merge=0.9956 (last merge round=12)
[S5] round=14 local utility u=0.017914 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2843119114701718, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.3201405847811234, 'psi': 0.35933890172383154}
[S6] START round=14 head_norm_before_train=1.648581 cos_to_last_merge=0.9971 (last merge round=12)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.05382315249893208, 'auprc': 0.05382315249893208, 'loss_val': 4.140554865974054, 'psi': 0.05382315249893208}-{'f1_val': 0.024145785876993165, 'auprc': 0.024145785876993165, 'loss_val': 3.6389203795292198, 'psi': 0.024145785876993165}
[S7] START round=14 head_norm_before_train=1.376647 (no previous merge yet)
[S7] round=14 local utility u=0.002468 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5552508166438914, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5601874062635617, 'psi': 0.0}
[S8] START round=14 head_norm_before_train=1.746048 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8646629688013473, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.856094820204826, 'psi': 0.35939447907390915}
[S9] START round=14 head_norm_before_train=1.553396 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6071332691027196, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4999635952824928, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.474568 cos_to_last_merge=0.9599 (last merge round=9)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.24934194783441013, 'auprc': 0.24934194783441013, 'loss_val': 2.264239956011727, 'psi': 0.24934194783441013}-{'f1_val': 0.3328754815262242, 'auprc': 0.3328754815262242, 'loss_val': 2.266930994488047, 'psi': 0.3328754815262242}
[S11] START round=14 head_norm_before_train=1.540395 (no previous merge yet)
[S11] round=14 local utility u=0.542214 metrics={'f1_val': 0.31994191674733785, 'auprc': 0.31994191674733785, 'loss_val': 2.636536013450655, 'psi': 0.31994191674733785}-{'f1_val': 0.19120586275816123, 'auprc': 0.19120586275816123, 'loss_val': 2.5623389267202485, 'psi': 0.19120586275816123}
[S13] START round=14 head_norm_before_train=1.607903 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.512974668387985, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4469240571367887, 'psi': 0.3599362944611573}
[S14] START round=14 head_norm_before_train=1.661084 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.578083313171303, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.381174642842502, 'psi': 0.0}
[S15] START round=14 head_norm_before_train=1.672579 (no previous merge yet)
[S15] round=14 local utility u=0.006572 metrics={'f1_val': 0.6162765197878417, 'auprc': 0.6162765197878417, 'loss_val': 0.7655735932977139, 'psi': 0.6162765197878417}-{'f1_val': 0.6155201796505004, 'auprc': 0.6155201796505004, 'loss_val': 0.7719097439370802, 'psi': 0.6155201796505004}
[S16] START round=14 head_norm_before_train=1.574809 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.010955902492467818, 'auprc': 0.010955902492467818, 'loss_val': 3.820709757649145, 'psi': 0.010955902492467818}-{'f1_val': 0.06811033147834503, 'auprc': 0.06811033147834503, 'loss_val': 2.9477410374240636, 'psi': 0.06811033147834503}
[S17] START round=14 head_norm_before_train=1.668970 (no previous merge yet)
[S17] round=14 local utility u=0.228961 metrics={'f1_val': 0.20370676894079467, 'auprc': 0.20370676894079467, 'loss_val': 0.9256562786779557, 'psi': 0.20370676894079467}-{'f1_val': 0.1555456647778618, 'auprc': 0.1555456647778618, 'loss_val': 0.9501280405060715, 'psi': 0.1555456647778618}
[S7] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39802
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:39803
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39814
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S5
[S3] cosine check vs S5: cos=0.4838
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=-0.0174
[S14] DROPPED delta from S15 (cos=-0.0174 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=0.0660
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=0.9955
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.0035
[S8] DROPPED delta from S17 (cos=-0.0035 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.0000 head_norm=1.676502
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.765244e-02
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.708834 delta_norm=0.087652
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.0000 head_norm=1.058294
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.327065e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.0000 head_norm=0.903004 delta_norm=0.532706
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.3675 head_norm=1.828689
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.163133e+00
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.3675 head_norm=1.241554 delta_norm=1.163133
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.241554 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.534863 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.7494787233169224, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.819204536116276, 'psi': 0.3674775928297055}
[S3] START round=15 head_norm_before_train=0.903004 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.162279 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8208917376409777, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1454502119765646, 'psi': 0.0}
[S4] START round=15 head_norm_before_train=1.744975 (no previous merge yet)
[S4] round=15 local utility u=0.009930 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0782722481602205, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0981321777200646, 'psi': 0.3567939207526687}
[S5] START round=15 head_norm_before_train=1.038460 cos_to_last_merge=0.9867 (last merge round=12)
[S5] round=15 local utility u=0.016754 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.250804829079479, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2843119114701718, 'psi': 0.35933890172383154}
[S6] START round=15 head_norm_before_train=1.708223 cos_to_last_merge=0.9908 (last merge round=12)
[S6] round=15 local utility u=0.082552 metrics={'f1_val': 0.10042081101759755, 'auprc': 0.10042081101759755, 'loss_val': 4.394830461584844, 'psi': 0.10042081101759755}-{'f1_val': 0.05382315249893208, 'auprc': 0.05382315249893208, 'loss_val': 4.140554865974054, 'psi': 0.05382315249893208}
[S7] START round=15 head_norm_before_train=1.395901 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5890182592612803, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5552508166438914, 'psi': 0.0}
[S8] START round=15 head_norm_before_train=1.786782 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.880278106771207, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8646629688013473, 'psi': 0.35939447907390915}
[S9] START round=15 head_norm_before_train=1.585711 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7336681904421873, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6071332691027196, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.538229 cos_to_last_merge=0.9506 (last merge round=9)
[S10] round=15 local utility u=0.009560 metrics={'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.2456589470256434, 'psi': 0.2494019138755981}-{'f1_val': 0.24934194783441013, 'auprc': 0.24934194783441013, 'loss_val': 2.264239956011727, 'psi': 0.24934194783441013}
[S11] START round=15 head_norm_before_train=1.563510 (no previous merge yet)
[S11] round=15 local utility u=0.247289 metrics={'f1_val': 0.3316279069767442, 'auprc': 0.3316279069767442, 'loss_val': 2.2471322427086453, 'psi': 0.3316279069767442}-{'f1_val': 0.31994191674733785, 'auprc': 0.31994191674733785, 'loss_val': 2.636536013450655, 'psi': 0.31994191674733785}
[S13] START round=15 head_norm_before_train=1.630589 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5966392338300934, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.512974668387985, 'psi': 0.3599362944611573}
[S14] START round=15 head_norm_before_train=1.708834 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7466862641930745, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.578083313171303, 'psi': 0.0}
[S15] START round=15 head_norm_before_train=1.718088 (no previous merge yet)
[S15] round=15 local utility u=0.015896 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7350346030835964, 'psi': 0.6164158146233559}-{'f1_val': 0.6162765197878417, 'auprc': 0.6162765197878417, 'loss_val': 0.7655735932977139, 'psi': 0.6162765197878417}
[S16] START round=15 head_norm_before_train=1.603619 (no previous merge yet)
[S16] round=15 local utility u=0.939715 metrics={'f1_val': 0.13606943218593703, 'auprc': 0.13606943218593703, 'loss_val': 3.067302371032433, 'psi': 0.13606943218593703}-{'f1_val': 0.010955902492467818, 'auprc': 0.010955902492467818, 'loss_val': 3.820709757649145, 'psi': 0.010955902492467818}
[S17] START round=15 head_norm_before_train=1.696648 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.17565400230073808, 'auprc': 0.17565400230073808, 'loss_val': 0.899334273436176, 'psi': 0.17565400230073808}-{'f1_val': 0.20370676894079467, 'auprc': 0.20370676894079467, 'loss_val': 0.9256562786779557, 'psi': 0.20370676894079467}
[S6] not sending this round → trigger blocked (psi=0.100)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39807
[S3] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S4
[S14] cosine check vs S4: cos=0.9963
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.3186
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=0.7297
[S2] RECEIVED delta(kind=head bytes=1806) from S11
[S2] cosine check vs S11: cos=0.6434
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=-0.0201
[S14] DROPPED delta from S15 (cos=-0.0201 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=0.8396
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.136)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.1004 head_norm=1.755756
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.003184e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.1004 head_norm=1.424701 delta_norm=0.600318
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.109 → S7@127.0.0.1:39808
[S7] ⇄ pheromone p=0.052 → S13@127.0.0.1:39813
[S8] ⇄ pheromone p=0.124 → S5@127.0.0.1:39805
[S9] ⇄ pheromone p=0.269 → S7@127.0.0.1:39808
[S4] ⇄ pheromone p=0.142 → S14@127.0.0.1:39814
[S10] ⇄ pheromone p=0.155 → S5@127.0.0.1:39805
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.3593 head_norm=1.071169
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.079091e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.3593 head_norm=1.094645 delta_norm=0.807909
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.155 → S3@127.0.0.1:39803
[S11] ⇄ pheromone p=0.289 → S2@127.0.0.1:39802
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.3675 head_norm=1.302932
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.234469e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.3675 head_norm=1.310944 delta_norm=0.623447
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.327 → S6@127.0.0.1:39807
[S13] ⇄ pheromone p=0.100 → S10@127.0.0.1:39811
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.0000 head_norm=1.725795
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.769423e-02
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.742684 delta_norm=0.077694
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.048 → S7@127.0.0.1:39808
[S16] ⇄ pheromone p=0.270 → S14@127.0.0.1:39814
[S15] ⇄ pheromone p=0.185 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=0.123 → S8@127.0.0.1:39809
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.0000 head_norm=0.952350
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.920972e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.0000 head_norm=0.970498 delta_norm=0.292097
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.090 → S14@127.0.0.1:39814
[S2] START round=16 head_norm_before_train=1.310944 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.164116 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.4212469970353527, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.7494787233169224, 'psi': 0.3674775928297055}
[S3] START round=16 head_norm_before_train=0.970498 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.053953 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7129861354592226, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8208917376409777, 'psi': 0.0}
[S4] START round=16 head_norm_before_train=1.762839 (no previous merge yet)
[S4] round=16 local utility u=0.010288 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0576971130123773, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0782722481602205, 'psi': 0.3567939207526687}
[S5] START round=16 head_norm_before_train=1.094645 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.002554 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2456959703121777, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.250804829079479, 'psi': 0.35933890172383154}
[S6] START round=16 head_norm_before_train=1.424701 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.70865165222349, 'psi': 0.0}-{'f1_val': 0.10042081101759755, 'auprc': 0.10042081101759755, 'loss_val': 4.394830461584844, 'psi': 0.10042081101759755}
[S7] START round=16 head_norm_before_train=1.405379 (no previous merge yet)
[S7] round=16 local utility u=0.009143 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5707322742047698, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5890182592612803, 'psi': 0.0}
[S8] START round=16 head_norm_before_train=1.830283 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.914922543684262, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.880278106771207, 'psi': 0.35939447907390915}
[S9] START round=16 head_norm_before_train=1.614789 (no previous merge yet)
[S9] round=16 local utility u=0.025370 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.682927440698631, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7336681904421873, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.598289 cos_to_last_merge=0.9427 (last merge round=9)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=16 local utility u=0.009539 metrics={'f1_val': 0.24934194783441013, 'auprc': 0.24934194783441013, 'loss_val': 2.226041568377441, 'psi': 0.24934194783441013}-{'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.2456589470256434, 'psi': 0.2494019138755981}
[S11] START round=16 head_norm_before_train=1.586471 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.3296347665279704, 'auprc': 0.3296347665279704, 'loss_val': 2.326918513336769, 'psi': 0.3296347665279704}-{'f1_val': 0.3316279069767442, 'auprc': 0.3316279069767442, 'loss_val': 2.2471322427086453, 'psi': 0.3316279069767442}
[S13] START round=16 head_norm_before_train=1.651435 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6674378889172217, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5966392338300934, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.742684 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8236225770825123, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7466862641930745, 'psi': 0.0}
[S15] START round=16 head_norm_before_train=1.759609 (no previous merge yet)
[S15] round=16 local utility u=0.036780 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6619939732244334, 'psi': 0.6164734888353558}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7350346030835964, 'psi': 0.6164158146233559}
[S16] START round=16 head_norm_before_train=1.630304 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.08978675645342311, 'auprc': 0.08978675645342311, 'loss_val': 3.8643633844087306, 'psi': 0.08978675645342311}-{'f1_val': 0.13606943218593703, 'auprc': 0.13606943218593703, 'loss_val': 3.067302371032433, 'psi': 0.13606943218593703}
[S17] START round=16 head_norm_before_train=1.726005 (no previous merge yet)
[S17] round=16 local utility u=0.259213 metrics={'f1_val': 0.23583309363147967, 'auprc': 0.23583309363147967, 'loss_val': 0.9225205146542907, 'psi': 0.23583309363147967}-{'f1_val': 0.17565400230073808, 'auprc': 0.17565400230073808, 'loss_val': 0.899334273436176, 'psi': 0.17565400230073808}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=0.7159
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.7047
[S14] RECEIVED delta(kind=head bytes=1796) from S4
[S14] cosine check vs S4: cos=0.9967
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39805
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=-0.0242
[S14] DROPPED delta from S15 (cos=-0.0242 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39808
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.8708
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39809
[S9] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S9
[S7] cosine check vs S9: cos=-0.0000
[S7] DROPPED delta from S9 (cos=-0.0000 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=-0.0027
[S8] DROPPED delta from S17 (cos=-0.0027 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.3593 head_norm=1.118369
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.367497e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.3593 head_norm=1.341720 delta_norm=0.436750
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.0000 head_norm=1.478541
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.532894e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.0000 head_norm=1.326141 delta_norm=0.553289
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.0000 head_norm=1.759745
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.246672e-02
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.0000 head_norm=1.770172 delta_norm=0.072467
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.0000 head_norm=1.016382
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.050311e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.0000 head_norm=0.988858 delta_norm=0.405031
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.394085 cos_to_last_merge=0.9868 (last merge round=15)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6053985001584956, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.4212469970353527, 'psi': 0.3674775928297055}
[S3] START round=17 head_norm_before_train=0.988858 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8204301483947196, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7129861354592226, 'psi': 0.0}
[S4] START round=17 head_norm_before_train=1.783484 (no previous merge yet)
[S4] round=17 local utility u=0.010815 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.036066122499918, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0576971130123773, 'psi': 0.3567939207526687}
[S5] START round=17 head_norm_before_train=1.341720 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.24654302726893465, 'auprc': 0.24654302726893465, 'loss_val': 1.2334108801313537, 'psi': 0.24654302726893465}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2456959703121777, 'psi': 0.35933890172383154}
[S6] START round=17 head_norm_before_train=1.326141 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.797374 metrics={'f1_val': 0.09980842911877395, 'auprc': 0.09980842911877395, 'loss_val': 3.0121802926879337, 'psi': 0.09980842911877395}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.70865165222349, 'psi': 0.0}
[S7] START round=17 head_norm_before_train=1.414070 (no previous merge yet)
[S7] round=17 local utility u=0.004865 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5610028912211624, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5707322742047698, 'psi': 0.0}
[S8] START round=17 head_norm_before_train=1.871485 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.972246794402389, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.914922543684262, 'psi': 0.35939447907390915}
[S9] START round=17 head_norm_before_train=1.641215 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.769121663196943, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.682927440698631, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.652628 cos_to_last_merge=0.9365 (last merge round=9)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=17 local utility u=0.014253 metrics={'f1_val': 0.24934194783441013, 'auprc': 0.24934194783441013, 'loss_val': 2.197535241477301, 'psi': 0.24934194783441013}-{'f1_val': 0.24934194783441013, 'auprc': 0.24934194783441013, 'loss_val': 2.226041568377441, 'psi': 0.24934194783441013}
[S11] START round=17 head_norm_before_train=1.609724 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.685136822114183, 'psi': 0.33185875048506014}-{'f1_val': 0.3296347665279704, 'auprc': 0.3296347665279704, 'loss_val': 2.326918513336769, 'psi': 0.3296347665279704}
[S13] START round=17 head_norm_before_train=1.668930 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.729065694384615, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6674378889172217, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=1.770172 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.276548 metrics={'f1_val': 0.05674978503869304, 'auprc': 0.05674978503869304, 'loss_val': 3.7812742698235704, 'psi': 0.05674978503869304}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8236225770825123, 'psi': 0.0}
[S15] START round=17 head_norm_before_train=1.804523 (no previous merge yet)
[S15] round=17 local utility u=0.003074 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.6553267962532952, 'psi': 0.6164158146233559}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6619939732244334, 'psi': 0.6164734888353558}
[S16] START round=17 head_norm_before_train=1.655199 (no previous merge yet)
[S16] round=17 local utility u=0.534415 metrics={'f1_val': 0.14482060185185186, 'auprc': 0.14482060185185186, 'loss_val': 3.290837116420987, 'psi': 0.14482060185185186}-{'f1_val': 0.08978675645342311, 'auprc': 0.08978675645342311, 'loss_val': 3.8643633844087306, 'psi': 0.08978675645342311}
[S17] START round=17 head_norm_before_train=1.759003 (no previous merge yet)
[S17] round=17 local utility u=0.264142 metrics={'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 1.0505380155592812, 'psi': 0.30875549754205167}-{'f1_val': 0.23583309363147967, 'auprc': 0.23583309363147967, 'loss_val': 0.9225205146542907, 'psi': 0.23583309363147967}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.9673
[S14] not sending this round → trigger blocked (psi=0.057)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.100)
[S7] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.145)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[S4] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=-0.0022
[S8] DROPPED delta from S17 (cos=-0.0022 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S4
[S14] cosine check vs S4: cos=0.9977
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=-0.0289
[S14] DROPPED delta from S15 (cos=-0.0289 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.2465 head_norm=1.363503
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.567019e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.2460 head_norm=1.518386 delta_norm=0.256702
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.0567 head_norm=1.785998
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.270386e-02
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.0392 head_norm=1.796836 delta_norm=0.062704
[S14] aggregate: ROLLBACK (f1_val pre=0.057 post=0.039 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.499724 cos_to_last_merge=0.9625 (last merge round=15)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.7739909247586862, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6053985001584956, 'psi': 0.3674775928297055}
[S3] START round=18 head_norm_before_train=1.030021 cos_to_last_merge=0.9937 (last merge round=16)
[S3] round=18 local utility u=0.558223 metrics={'f1_val': 0.1326963906581741, 'auprc': 0.1326963906581741, 'loss_val': 1.8982520853613825, 'psi': 0.1326963906581741}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8204301483947196, 'psi': 0.0}
[S4] START round=18 head_norm_before_train=1.809783 (no previous merge yet)
[S4] round=18 local utility u=0.004565 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.026936974085083, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.036066122499918, 'psi': 0.3567939207526687}
[S5] START round=18 head_norm_before_train=1.518386 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.467249 metrics={'f1_val': 0.34715811929497437, 'auprc': 0.34715811929497437, 'loss_val': 1.2044494957866114, 'psi': 0.34715811929497437}-{'f1_val': 0.24654302726893465, 'auprc': 0.24654302726893465, 'loss_val': 1.2334108801313537, 'psi': 0.24654302726893465}
[S6] START round=18 head_norm_before_train=1.388452 cos_to_last_merge=0.9952 (last merge round=16)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.06821000413393964, 'auprc': 0.06821000413393964, 'loss_val': 3.8110449846814145, 'psi': 0.06821000413393964}-{'f1_val': 0.09980842911877395, 'auprc': 0.09980842911877395, 'loss_val': 3.0121802926879337, 'psi': 0.09980842911877395}
[S7] START round=18 head_norm_before_train=1.422307 (no previous merge yet)
[S7] round=18 local utility u=0.013337 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5343295205862872, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5610028912211624, 'psi': 0.0}
[S8] START round=18 head_norm_before_train=1.906564 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0541275236168766, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.972246794402389, 'psi': 0.35939447907390915}
[S9] START round=18 head_norm_before_train=1.665624 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9143560432517543, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.769121663196943, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.698129 cos_to_last_merge=0.9322 (last merge round=9)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=18 local utility u=0.006107 metrics={'f1_val': 0.24934194783441013, 'auprc': 0.24934194783441013, 'loss_val': 2.185320461775947, 'psi': 0.24934194783441013}-{'f1_val': 0.24934194783441013, 'auprc': 0.24934194783441013, 'loss_val': 2.197535241477301, 'psi': 0.24934194783441013}
[S11] START round=18 head_norm_before_train=1.633932 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.7681356288942767, 'psi': 0.3320133550741517}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.685136822114183, 'psi': 0.33185875048506014}
[S13] START round=18 head_norm_before_train=1.690141 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7731442198904368, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.729065694384615, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.796836 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.04743198021242543, 'auprc': 0.04743198021242543, 'loss_val': 3.913169078718889, 'psi': 0.04743198021242543}-{'f1_val': 0.05674978503869304, 'auprc': 0.05674978503869304, 'loss_val': 3.7812742698235704, 'psi': 0.05674978503869304}
[S15] START round=18 head_norm_before_train=1.845952 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6655169077718887, 'psi': 0.61591610673549}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.6553267962532952, 'psi': 0.6164158146233559}
[S16] START round=18 head_norm_before_train=1.678600 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.09020267563886886, 'auprc': 0.09020267563886886, 'loss_val': 4.110739615434766, 'psi': 0.09020267563886886}-{'f1_val': 0.14482060185185186, 'auprc': 0.14482060185185186, 'loss_val': 3.290837116420987, 'psi': 0.14482060185185186}
[S17] START round=18 head_norm_before_train=1.786309 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.1831789165327608, 'auprc': 0.1831789165327608, 'loss_val': 1.0111125373583714, 'psi': 0.1831789165327608}-{'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 1.0505380155592812, 'psi': 0.30875549754205167}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:39805
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.133)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:39803
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] cosine check vs S5: cos=0.7008
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=0.9983
[S5] RECEIVED delta(kind=head bytes=1804) from S10
[S5] cosine check vs S10: cos=0.9845
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.0474 head_norm=1.814987
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.342010e-02
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.0322 head_norm=1.819236 delta_norm=0.053420
[S14] aggregate: ROLLBACK (f1_val pre=0.047 post=0.032 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.1327 head_norm=1.083382
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.496985e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.1338 head_norm=1.213372 delta_norm=0.549699
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.3472 head_norm=1.541157
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.739576e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.4486 head_norm=1.632708 delta_norm=0.173958
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.574533 cos_to_last_merge=0.9457 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.946
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.9110718231529111, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.7739909247586862, 'psi': 0.3674775928297055}
[S3] START round=19 head_norm_before_train=1.213372 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.685463 metrics={'f1_val': 0.2837041262597452, 'auprc': 0.2837041262597452, 'loss_val': 1.8863951005167348, 'psi': 0.2837041262597452}-{'f1_val': 0.1326963906581741, 'auprc': 0.1326963906581741, 'loss_val': 1.8982520853613825, 'psi': 0.1326963906581741}
[S4] START round=19 head_norm_before_train=1.825039 (no previous merge yet)
[S4] round=19 local utility u=0.004484 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.017969660575417, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.026936974085083, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.632708 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.388248 metrics={'f1_val': 0.4289970293735025, 'auprc': 0.4289970293735025, 'loss_val': 1.1645030445135154, 'psi': 0.4289970293735025}-{'f1_val': 0.34715811929497437, 'auprc': 0.34715811929497437, 'loss_val': 1.2044494957866114, 'psi': 0.34715811929497437}
[S6] START round=19 head_norm_before_train=1.467489 cos_to_last_merge=0.9829 (last merge round=16)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.05248500428449015, 'auprc': 0.05248500428449015, 'loss_val': 4.327926254806623, 'psi': 0.05248500428449015}-{'f1_val': 0.06821000413393964, 'auprc': 0.06821000413393964, 'loss_val': 3.8110449846814145, 'psi': 0.06821000413393964}
[S7] START round=19 head_norm_before_train=1.429616 (no previous merge yet)
[S7] round=19 local utility u=0.011002 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5123250188538884, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5343295205862872, 'psi': 0.0}
[S8] START round=19 head_norm_before_train=1.942249 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.130228370087168, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0541275236168766, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.688145 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0479756098436184, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9143560432517543, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.736903 cos_to_last_merge=0.9288 (last merge round=9)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=19 local utility u=0.384359 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.1646314502641126, 'psi': 0.3324563501554652}-{'f1_val': 0.24934194783441013, 'auprc': 0.24934194783441013, 'loss_val': 2.185320461775947, 'psi': 0.24934194783441013}
[S11] START round=19 head_norm_before_train=1.654228 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.9069029002285696, 'psi': 0.33216756042589574}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.7681356288942767, 'psi': 0.3320133550741517}
[S13] START round=19 head_norm_before_train=1.715084 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8179954336892372, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7731442198904368, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.819236 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.083588 metrics={'f1_val': 0.07183787561146052, 'auprc': 0.07183787561146052, 'loss_val': 3.9656457699461494, 'psi': 0.07183787561146052}-{'f1_val': 0.04743198021242543, 'auprc': 0.04743198021242543, 'loss_val': 3.913169078718889, 'psi': 0.04743198021242543}
[S15] START round=19 head_norm_before_train=1.884391 (no previous merge yet)
[S15] round=19 local utility u=0.019669 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.629941974324505, 'psi': 0.6163342951580373}-{'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6655169077718887, 'psi': 0.61591610673549}
[S16] START round=19 head_norm_before_train=1.698247 (no previous merge yet)
[S16] round=19 local utility u=0.067828 metrics={'f1_val': 0.09688636004425479, 'auprc': 0.09688636004425479, 'loss_val': 4.035237055982457, 'psi': 0.09688636004425479}-{'f1_val': 0.09020267563886886, 'auprc': 0.09020267563886886, 'loss_val': 4.110739615434766, 'psi': 0.09020267563886886}
[S17] START round=19 head_norm_before_train=1.807869 (no previous merge yet)
[S17] round=19 local utility u=1.000000 metrics={'f1_val': 0.4209675584481122, 'auprc': 0.4209675584481122, 'loss_val': 0.8790300212715529, 'psi': 0.4209675584481122}-{'f1_val': 0.1831789165327608, 'auprc': 0.1831789165327608, 'loss_val': 1.0111125373583714, 'psi': 0.1831789165327608}
[S14] not sending this round → trigger blocked (psi=0.072)
[S5] not sending this round → trigger blocked (psi=0.429)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[S7] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.332)
[S4] not sending this round → trigger blocked (psi=0.357)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.097)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:39814
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S3
[S14] cosine check vs S3: cos=0.0486
[S14] RECEIVED delta(kind=head bytes=1805) from S15
[S14] cosine check vs S15: cos=-0.0379
[S14] DROPPED delta from S15 (cos=-0.0379 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1807 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1807) from S17
[S8] cosine check vs S17: cos=-0.0020
[S8] DROPPED delta from S17 (cos=-0.0020 < 0.0)
[S13] r=20 psi=0.360 u=0.0000 p_local=0.0410 f1=0.360 auprc=0.360 bytes=3599
[S4] r=20 psi=0.357 u=0.0045 p_local=0.0622 f1=0.357 auprc=0.357 bytes=21554
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.0718 head_norm=1.837272
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.084808e+00
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.0000 head_norm=1.134940 delta_norm=1.084808
[S14] aggregate: ROLLBACK (f1_val pre=0.072 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S14] r=20 psi=0.072 u=0.0836 p_local=0.0717 f1=0.072 auprc=0.072 bytes=0
[S7] r=20 psi=0.000 u=0.0110 p_local=0.0271 f1=0.000 auprc=0.000 bytes=0
[S10] r=20 psi=0.332 u=0.3844 p_local=0.1440 f1=0.332 auprc=0.332 bytes=9007
[S2] r=20 psi=0.367 u=0.0000 p_local=0.1506 f1=0.367 auprc=0.367 bytes=8994
[S6] r=20 psi=0.052 u=0.0000 p_local=0.1468 f1=0.052 auprc=0.052 bytes=0
[S11] r=20 psi=0.332 u=0.0000 p_local=0.1183 f1=0.332 auprc=0.332 bytes=3608
[S9] r=20 psi=0.369 u=0.0000 p_local=0.1127 f1=0.369 auprc=0.369 bytes=3605
[S5] r=20 psi=0.429 u=0.3882 p_local=0.2161 f1=0.429 auprc=0.429 bytes=12599
[S8] r=20 psi=0.359 u=0.0000 p_local=0.0508 f1=0.359 auprc=0.359 bytes=7197
[S15] r=20 psi=0.616 u=0.0197 p_local=0.0837 f1=0.616 auprc=0.616 bytes=14408
[S3] r=20 psi=0.284 u=0.6855 p_local=0.2689 f1=0.284 auprc=0.284 bytes=1795
[S17] r=20 psi=0.421 u=1.0000 p_local=0.3108 f1=0.421 auprc=0.421 bytes=7213
[S16] r=20 psi=0.097 u=0.0678 p_local=0.1925 f1=0.097 auprc=0.097 bytes=0
[S2] START round=20 head_norm_before_train=1.623827 cos_to_last_merge=0.9356 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.936
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0227415503486466, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.9110718231529111, 'psi': 0.3674775928297055}
[S3] START round=20 head_norm_before_train=1.246686 cos_to_last_merge=0.9960 (last merge round=18)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.29362214199759323, 'auprc': 0.29362214199759323, 'loss_val': 1.9943910212786535, 'psi': 0.29362214199759323}-{'f1_val': 0.2837041262597452, 'auprc': 0.2837041262597452, 'loss_val': 1.8863951005167348, 'psi': 0.2837041262597452}
[S4] START round=20 head_norm_before_train=1.845355 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0193104857967115, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.017969660575417, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.654925 cos_to_last_merge=0.9983 (last merge round=18)
[S5] round=20 local utility u=0.744591 metrics={'f1_val': 0.5871479410578946, 'auprc': 0.5871479410578946, 'loss_val': 1.098680122923205, 'psi': 0.5871479410578946}-{'f1_val': 0.4289970293735025, 'auprc': 0.4289970293735025, 'loss_val': 1.1645030445135154, 'psi': 0.4289970293735025}
[S6] START round=20 head_norm_before_train=1.532861 cos_to_last_merge=0.9716 (last merge round=16)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.05190905190905191, 'auprc': 0.05190905190905191, 'loss_val': 4.5875461368682044, 'psi': 0.05190905190905191}-{'f1_val': 0.05248500428449015, 'auprc': 0.05248500428449015, 'loss_val': 4.327926254806623, 'psi': 0.05248500428449015}
[S7] START round=20 head_norm_before_train=1.442257 (no previous merge yet)
[S7] round=20 local utility u=0.022245 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4678356876684062, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5123250188538884, 'psi': 0.0}
[S8] START round=20 head_norm_before_train=1.971292 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1981061911449433, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.130228370087168, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.707386 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1404540868859323, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0479756098436184, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.769463 cos_to_last_merge=0.9266 (last merge round=9)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.2027443927850587, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.1646314502641126, 'psi': 0.3324563501554652}
[S11] START round=20 head_norm_before_train=1.670507 (no previous merge yet)
[S11] round=20 local utility u=0.060663 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.7834933920993956, 'psi': 0.3319360347772085}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.9069029002285696, 'psi': 0.33216756042589574}
[S13] START round=20 head_norm_before_train=1.738655 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8677030473144574, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8179954336892372, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.134940 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.209594 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.899916878268985, 'psi': 0.0}-{'f1_val': 0.07183787561146052, 'auprc': 0.07183787561146052, 'loss_val': 3.9656457699461494, 'psi': 0.07183787561146052}
[S15] START round=20 head_norm_before_train=1.919073 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.6299208256082749, 'psi': 0.6160556042184989}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.629941974324505, 'psi': 0.6163342951580373}
[S16] START round=20 head_norm_before_train=1.715715 (no previous merge yet)
[S16] round=20 local utility u=0.370763 metrics={'f1_val': 0.14323030039181542, 'auprc': 0.14323030039181542, 'loss_val': 3.710806102100148, 'psi': 0.14323030039181542}-{'f1_val': 0.09688636004425479, 'auprc': 0.09688636004425479, 'loss_val': 4.035237055982457, 'psi': 0.09688636004425479}
[S17] START round=20 head_norm_before_train=1.827170 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.26008115272409554, 'auprc': 0.26008115272409554, 'loss_val': 1.0157768029380065, 'psi': 0.26008115272409554}-{'f1_val': 0.4209675584481122, 'auprc': 0.4209675584481122, 'loss_val': 0.8790300212715529, 'psi': 0.4209675584481122}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39803
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:39802
[S14] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.143)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1806) from S11
[S2] cosine check vs S11: cos=0.7464
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=0.8937
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.117 → S7@127.0.0.1:39808
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.2936 head_norm=1.286948
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.938300e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.2942 head_norm=1.447053 delta_norm=0.393830
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.215 → S14@127.0.0.1:39814
[S13] ⇄ pheromone p=0.033 → S10@127.0.0.1:39811
[S9] ⇄ pheromone p=0.090 → S7@127.0.0.1:39808
[S15] ⇄ pheromone p=0.067 → S14@127.0.0.1:39814
[S4] ⇄ pheromone p=0.050 → S14@127.0.0.1:39814
[S10] ⇄ pheromone p=0.115 → S5@127.0.0.1:39805
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.3675 head_norm=1.658314
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.952769e-01
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.3675 head_norm=1.561948 delta_norm=0.595277
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.121 → S6@127.0.0.1:39807
[S7] ⇄ pheromone p=0.026 → S13@127.0.0.1:39813
[S8] ⇄ pheromone p=0.041 → S5@127.0.0.1:39805
[S14] ⇄ pheromone p=0.099 → S7@127.0.0.1:39808
[S5] ⇄ pheromone p=0.322 → S3@127.0.0.1:39803
[S11] ⇄ pheromone p=0.107 → S2@127.0.0.1:39802
[S17] ⇄ pheromone p=0.249 → S8@127.0.0.1:39809
[S16] ⇄ pheromone p=0.228 → S14@127.0.0.1:39814
[S2] START round=21 head_norm_before_train=1.561948 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.205173 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6123955597097213, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0227415503486466, 'psi': 0.3674775928297055}
[S3] START round=21 head_norm_before_train=1.447053 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.2730735423381189, 'auprc': 0.2730735423381189, 'loss_val': 2.1036444340105263, 'psi': 0.2730735423381189}-{'f1_val': 0.29362214199759323, 'auprc': 0.29362214199759323, 'loss_val': 1.9943910212786535, 'psi': 0.29362214199759323}
[S4] START round=21 head_norm_before_train=1.870427 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0318483718148135, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0193104857967115, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.685793 cos_to_last_merge=0.9939 (last merge round=18)
[S5] round=21 local utility u=0.391581 metrics={'f1_val': 0.6640870848949777, 'auprc': 0.6640870848949777, 'loss_val': 1.0079711253707917, 'psi': 0.6640870848949777}-{'f1_val': 0.5871479410578946, 'auprc': 0.5871479410578946, 'loss_val': 1.098680122923205, 'psi': 0.5871479410578946}
[S6] START round=21 head_norm_before_train=1.581686 cos_to_last_merge=0.9635 (last merge round=16)
[S6] round=21 local utility u=0.016569 metrics={'f1_val': 0.06767384105960265, 'auprc': 0.06767384105960265, 'loss_val': 4.696291696481178, 'psi': 0.06767384105960265}-{'f1_val': 0.05190905190905191, 'auprc': 0.05190905190905191, 'loss_val': 4.5875461368682044, 'psi': 0.05190905190905191}
[S7] START round=21 head_norm_before_train=1.456005 (no previous merge yet)
[S7] round=21 local utility u=0.102459 metrics={'f1_val': 0.01729106628242075, 'auprc': 0.01729106628242075, 'loss_val': 1.4185373618012802, 'psi': 0.01729106628242075}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4678356876684062, 'psi': 0.0}
[S8] START round=21 head_norm_before_train=1.997714 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2690363648342173, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1981061911449433, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.723457 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1961951638035218, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1404540868859323, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.801108 cos_to_last_merge=0.9239 (last merge round=9)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.2123224449869427, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.2027443927850587, 'psi': 0.3324563501554652}
[S11] START round=21 head_norm_before_train=1.684658 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.9366745877685214, 'psi': 0.33201273984308244}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.7834933920993956, 'psi': 0.3319360347772085}
[S13] START round=21 head_norm_before_train=1.754468 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9015442579325639, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8677030473144574, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.163547 cos_to_last_merge=0.9987 (last merge round=19)
[S14] round=21 local utility u=0.231201 metrics={'f1_val': 0.07258514796203239, 'auprc': 0.07258514796203239, 'loss_val': 3.090781821557901, 'psi': 0.07258514796203239}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.899916878268985, 'psi': 0.0}
[S15] START round=21 head_norm_before_train=1.948235 (no previous merge yet)
[S15] round=21 local utility u=0.010332 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6117642250899112, 'psi': 0.6163342951580373}-{'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.6299208256082749, 'psi': 0.6160556042184989}
[S16] START round=21 head_norm_before_train=1.732397 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.12659176029962546, 'auprc': 0.12659176029962546, 'loss_val': 4.08586884873192, 'psi': 0.12659176029962546}-{'f1_val': 0.14323030039181542, 'auprc': 0.14323030039181542, 'loss_val': 3.710806102100148, 'psi': 0.14323030039181542}
[S17] START round=21 head_norm_before_train=1.846842 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.2676443569351676, 'auprc': 0.2676443569351676, 'loss_val': 1.0849504868999387, 'psi': 0.2676443569351676}-{'f1_val': 0.26008115272409554, 'auprc': 0.26008115272409554, 'loss_val': 1.0157768029380065, 'psi': 0.26008115272409554}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39807
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.073)
[S6] not sending this round → trigger blocked (psi=0.068)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:39803
[S7] not sending this round → trigger blocked (psi=0.017)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:39814
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=-0.0522
[S14] DROPPED delta from S15 (cos=-0.0522 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=0.7550
[S3] RECEIVED delta(kind=head bytes=1806) from S5
[S3] cosine check vs S5: cos=0.9676
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.0677 head_norm=1.617962
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.649264e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.0687 head_norm=1.511985 delta_norm=0.564926
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.2731 head_norm=1.471890
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.369987e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.2703 head_norm=1.582152 delta_norm=0.236999
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.610180 cos_to_last_merge=0.9985 (last merge round=20)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.761464855681631, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6123955597097213, 'psi': 0.3674775928297055}
[S3] START round=22 head_norm_before_train=1.582152 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.139054 metrics={'f1_val': 0.2945521698984303, 'auprc': 0.2945521698984303, 'loss_val': 2.018843435192324, 'psi': 0.2945521698984303}-{'f1_val': 0.2730735423381189, 'auprc': 0.2730735423381189, 'loss_val': 2.1036444340105263, 'psi': 0.2730735423381189}
[S4] START round=22 head_norm_before_train=1.892895 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.041344432924942, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0318483718148135, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.718222 cos_to_last_merge=0.9887 (last merge round=18)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.5968001224255698, 'auprc': 0.5968001224255698, 'loss_val': 0.9219209121972651, 'psi': 0.5968001224255698}-{'f1_val': 0.6640870848949777, 'auprc': 0.6640870848949777, 'loss_val': 1.0079711253707917, 'psi': 0.6640870848949777}
[S6] START round=22 head_norm_before_train=1.511985 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.564998 metrics={'f1_val': 0.05760271071579839, 'auprc': 0.05760271071579839, 'loss_val': 3.4756551802253886, 'psi': 0.057602710715798394}-{'f1_val': 0.06767384105960265, 'auprc': 0.06767384105960265, 'loss_val': 4.696291696481178, 'psi': 0.06767384105960265}
[S7] START round=22 head_norm_before_train=1.465616 (no previous merge yet)
[S7] round=22 local utility u=1.000000 metrics={'f1_val': 0.2408457968024755, 'auprc': 0.2408457968024755, 'loss_val': 1.367115414298037, 'psi': 0.24084579680247548}-{'f1_val': 0.01729106628242075, 'auprc': 0.01729106628242075, 'loss_val': 1.4185373618012802, 'psi': 0.01729106628242075}
[S8] START round=22 head_norm_before_train=2.022557 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3276674654797482, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2690363648342173, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.737617 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2252885830258986, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1961951638035218, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.827046 cos_to_last_merge=0.9223 (last merge round=9)
[S10] ⚠️ Model drifted since last merge! cos=0.922
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.2618587092925333, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.2123224449869427, 'psi': 0.3324563501554652}
[S11] START round=22 head_norm_before_train=1.698287 (no previous merge yet)
[S11] round=22 local utility u=0.090981 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.7526312440518765, 'psi': 0.33178150217256364}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.9366745877685214, 'psi': 0.33201273984308244}
[S13] START round=22 head_norm_before_train=1.767467 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9385267846939975, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9015442579325639, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.206048 cos_to_last_merge=0.9941 (last merge round=19)
[S14] round=22 local utility u=0.087733 metrics={'f1_val': 0.10923379174852653, 'auprc': 0.10923379174852653, 'loss_val': 3.2451541279745797, 'psi': 0.10923379174852653}-{'f1_val': 0.07258514796203239, 'auprc': 0.07258514796203239, 'loss_val': 3.090781821557901, 'psi': 0.07258514796203239}
[S15] START round=22 head_norm_before_train=1.976485 (no previous merge yet)
[S15] round=22 local utility u=0.004905 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6019544162787355, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6117642250899112, 'psi': 0.6163342951580373}
[S16] START round=22 head_norm_before_train=1.748022 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.11808567298181542, 'auprc': 0.11808567298181542, 'loss_val': 4.212410775962076, 'psi': 0.11808567298181541}-{'f1_val': 0.12659176029962546, 'auprc': 0.12659176029962546, 'loss_val': 4.08586884873192, 'psi': 0.12659176029962546}
[S17] START round=22 head_norm_before_train=1.874283 (no previous merge yet)
[S17] round=22 local utility u=1.000000 metrics={'f1_val': 0.5873617256431483, 'auprc': 0.5873617256431483, 'loss_val': 0.8753194885172517, 'psi': 0.5873617256431483}-{'f1_val': 0.2676443569351676, 'auprc': 0.2676443569351676, 'loss_val': 1.0849504868999387, 'psi': 0.2676443569351676}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.109)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39813
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:39814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.058)
[S3] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S3
[S14] cosine check vs S3: cos=0.5565
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=0.8928
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] cosine check vs S7: cos=-0.0079
[S13] DROPPED delta from S7 (cos=-0.0079 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1805) from S15
[S14] cosine check vs S15: cos=-0.0527
[S14] DROPPED delta from S15 (cos=-0.0527 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=-0.0003
[S8] DROPPED delta from S17 (cos=-0.0003 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.3675 head_norm=1.671115
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.923760e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.3675 head_norm=1.646565 delta_norm=0.392376
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.1092 head_norm=1.253615
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.890668e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.0857 head_norm=1.261396 delta_norm=0.689067
[S14] aggregate: ROLLBACK (f1_val pre=0.109 post=0.086 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.646565 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.087680 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.5861040177008439, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.761464855681631, 'psi': 0.3674775928297055}
[S3] START round=23 head_norm_before_train=1.600098 cos_to_last_merge=0.9981 (last merge round=21)
[S3] round=23 local utility u=0.022085 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.0033630492653187, 'psi': 0.29773995791014735}-{'f1_val': 0.2945521698984303, 'auprc': 0.2945521698984303, 'loss_val': 2.018843435192324, 'psi': 0.2945521698984303}
[S4] START round=23 head_norm_before_train=1.907254 (no previous merge yet)
[S4] round=23 local utility u=0.002447 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0364495081125884, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.041344432924942, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.750593 cos_to_last_merge=0.9837 (last merge round=18)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.3062077531431677, 'psi': 0.3335071121394324}-{'f1_val': 0.5968001224255698, 'auprc': 0.5968001224255698, 'loss_val': 0.9219209121972651, 'psi': 0.5968001224255698}
[S6] START round=23 head_norm_before_train=1.557376 cos_to_last_merge=0.9987 (last merge round=21)
[S6] round=23 local utility u=0.039014 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 3.7949793672480525, 'psi': 0.1017530487804878}-{'f1_val': 0.05760271071579839, 'auprc': 0.05760271071579839, 'loss_val': 3.4756551802253886, 'psi': 0.057602710715798394}
[S7] START round=23 head_norm_before_train=1.478933 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.20989613387189845, 'auprc': 0.20989613387189845, 'loss_val': 1.3702079858403398, 'psi': 0.20989613387189845}-{'f1_val': 0.2408457968024755, 'auprc': 0.2408457968024755, 'loss_val': 1.367115414298037, 'psi': 0.24084579680247548}
[S8] START round=23 head_norm_before_train=2.042111 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3952184513777408, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3276674654797482, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.750691 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2569484310186043, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2252885830258986, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.851876 cos_to_last_merge=0.9204 (last merge round=9)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.2857448413888237, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.2618587092925333, 'psi': 0.3324563501554652}
[S11] START round=23 head_norm_before_train=1.713956 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 2.946739995556362, 'psi': 0.3320907114010562}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.7526312440518765, 'psi': 0.33178150217256364}
[S13] START round=23 head_norm_before_train=1.775362 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.948596192743115, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9385267846939975, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.261396 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.100222 metrics={'f1_val': 0.07432150313152401, 'auprc': 0.07432150313152401, 'loss_val': 2.730498789030605, 'psi': 0.07432150313152401}-{'f1_val': 0.10923379174852653, 'auprc': 0.10923379174852653, 'loss_val': 3.2451541279745797, 'psi': 0.10923379174852653}
[S15] START round=23 head_norm_before_train=2.002153 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6056487915685576, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6019544162787355, 'psi': 0.6163342951580373}
[S16] START round=23 head_norm_before_train=1.762688 (no previous merge yet)
[S16] round=23 local utility u=0.248070 metrics={'f1_val': 0.14220283533260633, 'auprc': 0.14220283533260633, 'loss_val': 3.9333243739381603, 'psi': 0.14220283533260633}-{'f1_val': 0.11808567298181542, 'auprc': 0.11808567298181542, 'loss_val': 4.212410775962076, 'psi': 0.11808567298181541}
[S17] START round=23 head_norm_before_train=1.894246 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.35930996691840156, 'auprc': 0.35930996691840156, 'loss_val': 1.2711098562503238, 'psi': 0.35930996691840156}-{'f1_val': 0.5873617256431483, 'auprc': 0.5873617256431483, 'loss_val': 0.8753194885172517, 'psi': 0.5873617256431483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39814
[S4] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S4
[S14] cosine check vs S4: cos=0.4872
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S6] not sending this round → trigger blocked (psi=0.102)
[S2] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.8639
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S3
[S14] cosine check vs S3: cos=0.8955
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.074)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.142)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.1018 head_norm=1.612344
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.356734e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.1018 head_norm=1.603152 delta_norm=0.435673
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.0743 head_norm=1.301232
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.649754e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.0648 head_norm=1.274063 delta_norm=0.264975
[S14] aggregate: ROLLBACK (f1_val pre=0.074 post=0.065 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.708848 cos_to_last_merge=0.9965 (last merge round=22)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.7150808144682428, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.5861040177008439, 'psi': 0.3674775928297055}
[S3] START round=24 head_norm_before_train=1.623380 cos_to_last_merge=0.9937 (last merge round=21)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.26119327900191164, 'auprc': 0.26119327900191164, 'loss_val': 2.304624338155605, 'psi': 0.26119327900191164}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.0033630492653187, 'psi': 0.29773995791014735}
[S4] START round=24 head_norm_before_train=1.915485 (no previous merge yet)
[S4] round=24 local utility u=0.006734 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.022981432648813, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0364495081125884, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.775624 cos_to_last_merge=0.9795 (last merge round=18)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.5825716618556318, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.3062077531431677, 'psi': 0.3335071121394324}
[S6] START round=24 head_norm_before_train=1.603152 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 3.7882299549687346, 'psi': 0.021749084249084248}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 3.7949793672480525, 'psi': 0.1017530487804878}
[S7] START round=24 head_norm_before_train=1.491838 (no previous merge yet)
[S7] round=24 local utility u=0.134392 metrics={'f1_val': 0.2336739780658026, 'auprc': 0.2336739780658026, 'loss_val': 1.3154251062425049, 'psi': 0.2336739780658026}-{'f1_val': 0.20989613387189845, 'auprc': 0.20989613387189845, 'loss_val': 1.3702079858403398, 'psi': 0.20989613387189845}
[S8] START round=24 head_norm_before_train=2.063020 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4631809944666179, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3952184513777408, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.762662 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.291725867792115, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2569484310186043, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.873900 cos_to_last_merge=0.9188 (last merge round=9)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.3007726470977676, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.2857448413888237, 'psi': 0.3324563501554652}
[S11] START round=24 head_norm_before_train=1.728481 (no previous merge yet)
[S11] round=24 local utility u=0.046203 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.851551598533471, 'psi': 0.33178150217256364}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 2.946739995556362, 'psi': 0.3320907114010562}
[S13] START round=24 head_norm_before_train=1.784565 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9583678614810924, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.948596192743115, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.274063 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.12436289500509684, 'auprc': 0.12436289500509684, 'loss_val': 3.2212084088989927, 'psi': 0.12436289500509684}-{'f1_val': 0.07432150313152401, 'auprc': 0.07432150313152401, 'loss_val': 2.730498789030605, 'psi': 0.07432150313152401}
[S15] START round=24 head_norm_before_train=2.026247 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6224295445984968, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6056487915685576, 'psi': 0.6164734888353558}
[S16] START round=24 head_norm_before_train=1.776139 (no previous merge yet)
[S16] round=24 local utility u=0.002727 metrics={'f1_val': 0.14323030039181542, 'auprc': 0.14323030039181542, 'loss_val': 3.9371175718974896, 'psi': 0.14323030039181542}-{'f1_val': 0.14220283533260633, 'auprc': 0.14220283533260633, 'loss_val': 3.9333243739381603, 'psi': 0.14220283533260633}
[S17] START round=24 head_norm_before_train=1.915188 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.33346739520288615, 'auprc': 0.33346739520288615, 'loss_val': 1.4069530563314248, 'psi': 0.33346739520288615}-{'f1_val': 0.35930996691840156, 'auprc': 0.35930996691840156, 'loss_val': 1.2711098562503238, 'psi': 0.35930996691840156}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.143)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39802
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S7
[S13] cosine check vs S7: cos=-0.0059
[S13] DROPPED delta from S7 (cos=-0.0059 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1803) from S11
[S2] cosine check vs S11: cos=0.9305
[S14] RECEIVED delta(kind=head bytes=1794) from S4
[S14] cosine check vs S4: cos=0.6629
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.1244 head_norm=1.323528
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.215897e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.1229 head_norm=1.486917 delta_norm=0.721590
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.3675 head_norm=1.774587
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.281090e-01
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.3675 head_norm=1.727749 delta_norm=0.328109
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.727749 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.049405 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6162705778733601, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.7150808144682428, 'psi': 0.3674775928297055}
[S3] START round=25 head_norm_before_train=1.650766 cos_to_last_merge=0.9883 (last merge round=21)
[S3] round=25 local utility u=0.264307 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.1058409897216808, 'psi': 0.29784120014635934}-{'f1_val': 0.26119327900191164, 'auprc': 0.26119327900191164, 'loss_val': 2.304624338155605, 'psi': 0.26119327900191164}
[S4] START round=25 head_norm_before_train=1.926525 (no previous merge yet)
[S4] round=25 local utility u=0.001971 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.019039689030401, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.022981432648813, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.795561 cos_to_last_merge=0.9762 (last merge round=18)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8756934922202537, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.5825716618556318, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.650910 cos_to_last_merge=0.9978 (last merge round=23)
[S6] round=25 local utility u=0.219765 metrics={'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 4.0498528184629485, 'psi': 0.09965504024530472}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 3.7882299549687346, 'psi': 0.021749084249084248}
[S7] START round=25 head_norm_before_train=1.504946 (no previous merge yet)
[S7] round=25 local utility u=0.037738 metrics={'f1_val': 0.23691956508680242, 'auprc': 0.23691956508680242, 'loss_val': 1.26915868224965, 'psi': 0.23691956508680242}-{'f1_val': 0.2336739780658026, 'auprc': 0.2336739780658026, 'loss_val': 1.3154251062425049, 'psi': 0.2336739780658026}
[S8] START round=25 head_norm_before_train=2.081967 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5189510614368746, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4631809944666179, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.773496 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.332586511843147, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.291725867792115, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.893678 cos_to_last_merge=0.9175 (last merge round=9)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=25 local utility u=0.004921 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.2909313850639426, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.3007726470977676, 'psi': 0.3324563501554652}
[S11] START round=25 head_norm_before_train=1.742523 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.9259886399064445, 'psi': 0.33185875048506014}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.851551598533471, 'psi': 0.33178150217256364}
[S13] START round=25 head_norm_before_train=1.792678 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0135272966751816, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9583678614810924, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.486917 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13051146384479717, 'auprc': 0.13051146384479717, 'loss_val': 4.106528541470865, 'psi': 0.13051146384479717}-{'f1_val': 0.12436289500509684, 'auprc': 0.12436289500509684, 'loss_val': 3.2212084088989927, 'psi': 0.12436289500509684}
[S15] START round=25 head_norm_before_train=2.050715 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6380874358566392, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6224295445984968, 'psi': 0.6163342951580373}
[S16] START round=25 head_norm_before_train=1.788374 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.12574086578137894, 'auprc': 0.12574086578137894, 'loss_val': 4.340093629795186, 'psi': 0.12574086578137894}-{'f1_val': 0.14323030039181542, 'auprc': 0.14323030039181542, 'loss_val': 3.9371175718974896, 'psi': 0.14323030039181542}
[S17] START round=25 head_norm_before_train=1.939180 (no previous merge yet)
[S17] round=25 local utility u=0.898125 metrics={'f1_val': 0.5054211372996952, 'auprc': 0.5054211372996952, 'loss_val': 1.1582873440958557, 'psi': 0.5054211372996952}-{'f1_val': 0.33346739520288615, 'auprc': 0.33346739520288615, 'loss_val': 1.4069530563314248, 'psi': 0.33346739520288615}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.100)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:39813
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.9506
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=0.9195
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] cosine check vs S3: cos=0.4002
[S13] RECEIVED delta(kind=head bytes=1795) from S7
[S13] cosine check vs S7: cos=-0.0044
[S13] DROPPED delta from S7 (cos=-0.0044 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.9410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.0015
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.3331 head_norm=1.818413
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.963260e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.3335 head_norm=1.840577 delta_norm=0.296326
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.138 → S3@127.0.0.1:39803
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.1305 head_norm=1.532719
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.730410e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.1307 head_norm=1.408981 delta_norm=0.273041
[S14] aggregate: ACCEPT kept=['S3', 'S4'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.073 → S7@127.0.0.1:39808
[S11] ⇄ pheromone p=0.052 → S2@127.0.0.1:39802
[S9] ⇄ pheromone p=0.030 → S7@127.0.0.1:39808
[S15] ⇄ pheromone p=0.023 → S14@127.0.0.1:39814
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.0997 head_norm=1.706362
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.524854e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.0993 head_norm=1.710941 delta_norm=0.352485
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.147 → S7@127.0.0.1:39808
[S13] ⇄ pheromone p=0.011 → S10@127.0.0.1:39811
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.3594 head_norm=2.100216
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.433097e+00
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.3594 head_norm=1.435258 delta_norm=1.433097
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.013 → S5@127.0.0.1:39805
[S16] ⇄ pheromone p=0.107 → S14@127.0.0.1:39814
[S2] ⇄ pheromone p=0.077 → S6@127.0.0.1:39807
[S4] ⇄ pheromone p=0.018 → S14@127.0.0.1:39814
[S3] ⇄ pheromone p=0.140 → S14@127.0.0.1:39814
[S7] ⇄ pheromone p=0.148 → S13@127.0.0.1:39813
[S10] ⇄ pheromone p=0.039 → S5@127.0.0.1:39805
[S17] ⇄ pheromone p=0.363 → S8@127.0.0.1:39809
[S2] START round=26 head_norm_before_train=1.786465 cos_to_last_merge=0.9973 (last merge round=24)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.74209109695085, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6162705778733601, 'psi': 0.3674775928297055}
[S3] START round=26 head_norm_before_train=1.675372 cos_to_last_merge=0.9833 (last merge round=21)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.29299953639313864, 'auprc': 0.29299953639313864, 'loss_val': 2.359469698997637, 'psi': 0.29299953639313864}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.1058409897216808, 'psi': 0.29784120014635934}
[S4] START round=26 head_norm_before_train=1.937071 (no previous merge yet)
[S4] round=26 local utility u=0.005522 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0079962212951046, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.019039689030401, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.840577 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.201798 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.4758857637890481, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8756934922202537, 'psi': 0.33308623671855697}
[S6] START round=26 head_norm_before_train=1.710941 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.05946857865879376, 'auprc': 0.05946857865879376, 'loss_val': 3.703188421510616, 'psi': 0.05946857865879375}-{'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 4.0498528184629485, 'psi': 0.09965504024530472}
[S7] START round=26 head_norm_before_train=1.521372 (no previous merge yet)
[S7] round=26 local utility u=0.043476 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.2078259893249854, 'psi': 0.23976608187134504}-{'f1_val': 0.23691956508680242, 'auprc': 0.23691956508680242, 'loss_val': 1.26915868224965, 'psi': 0.23691956508680242}
[S8] START round=26 head_norm_before_train=1.435258 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.187850 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1432501006119742, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5189510614368746, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.783721 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3742771684340336, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.332586511843147, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.909043 cos_to_last_merge=0.9170 (last merge round=9)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.336986263706675, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.2909313850639426, 'psi': 0.3324563501554652}
[S11] START round=26 head_norm_before_train=1.759614 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.0094476325304296, 'psi': 0.3319360347772085}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.9259886399064445, 'psi': 0.33185875048506014}
[S13] START round=26 head_norm_before_train=1.805680 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0450262601606144, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0135272966751816, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.408981 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.195157 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.764955049926391, 'psi': 0.13592717296421}-{'f1_val': 0.13051146384479717, 'auprc': 0.13051146384479717, 'loss_val': 4.106528541470865, 'psi': 0.13051146384479717}
[S15] START round=26 head_norm_before_train=2.073646 (no previous merge yet)
[S15] round=26 local utility u=0.010377 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6185859693189732, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6380874358566392, 'psi': 0.6163342951580373}
[S16] START round=26 head_norm_before_train=1.799101 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.09006410256410256, 'auprc': 0.09006410256410256, 'loss_val': 4.9215345991234685, 'psi': 0.09006410256410256}-{'f1_val': 0.12574086578137894, 'auprc': 0.12574086578137894, 'loss_val': 4.340093629795186, 'psi': 0.12574086578137894}
[S17] START round=26 head_norm_before_train=1.953602 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.4229925036966332, 'auprc': 0.4229925036966332, 'loss_val': 1.4344726583820564, 'psi': 0.4229925036966332}-{'f1_val': 0.5054211372996952, 'auprc': 0.5054211372996952, 'loss_val': 1.1582873440958557, 'psi': 0.5054211372996952}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S10@127.0.0.1:39811
[S14] not sending this round → trigger blocked (psi=0.136)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:39817
[S8] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1807 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.6458
[S10] RECEIVED delta(kind=head bytes=1807) from S5
[S10] cosine check vs S5: cos=0.9857
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39807
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] cosine check vs S7: cos=0.1403
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.0595 head_norm=1.761976
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.086716e+00
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.0443 head_norm=1.250039 delta_norm=1.086716
[S6] aggregate: ROLLBACK (f1_val pre=0.059 post=0.044 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.3325 head_norm=1.928423
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.638526e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.3325 head_norm=1.888419 delta_norm=0.163853
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.4230 head_norm=1.972658
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.624192e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.4184 head_norm=1.583620 delta_norm=0.762419
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.844805 cos_to_last_merge=0.9913 (last merge round=24)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.20217917675544794, 'auprc': 0.20217917675544794, 'loss_val': 2.3896725929086173, 'psi': 0.20217917675544794}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.74209109695085, 'psi': 0.3674775928297055}
[S3] START round=27 head_norm_before_train=1.700176 cos_to_last_merge=0.9790 (last merge round=21)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.28633446583616456, 'auprc': 0.28633446583616456, 'loss_val': 2.4961599337641167, 'psi': 0.28633446583616456}-{'f1_val': 0.29299953639313864, 'auprc': 0.29299953639313864, 'loss_val': 2.359469698997637, 'psi': 0.29299953639313864}
[S4] START round=27 head_norm_before_train=1.948919 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0161337595828528, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0079962212951046, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.862025 cos_to_last_merge=0.9998 (last merge round=25)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.6158877649892893, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.4758857637890481, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.250039 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 3.4971509020862994, 'psi': 0.02109124254928932}-{'f1_val': 0.05946857865879376, 'auprc': 0.05946857865879376, 'loss_val': 3.703188421510616, 'psi': 0.05946857865879375}
[S7] START round=27 head_norm_before_train=1.543548 (no previous merge yet)
[S7] round=27 local utility u=0.025804 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.1555296309719896, 'psi': 0.23968964488212474}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.2078259893249854, 'psi': 0.23976608187134504}
[S8] START round=27 head_norm_before_train=1.512248 cos_to_last_merge=0.9976 (last merge round=25)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.192206678331071, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1432501006119742, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.793358 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.417021345782442, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3742771684340336, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.888419 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.3874595855658094, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.336986263706675, 'psi': 0.3324563501554652}
[S11] START round=27 head_norm_before_train=1.777163 (no previous merge yet)
[S11] round=27 local utility u=0.007863 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.993025341223701, 'psi': 0.33185875048506014}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.0094476325304296, 'psi': 0.3319360347772085}
[S13] START round=27 head_norm_before_train=1.819807 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.064778201675936, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0450262601606144, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.446058 cos_to_last_merge=0.9995 (last merge round=25)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.8584666543456723, 'psi': 0.13582554517133957}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.764955049926391, 'psi': 0.13592717296421}
[S15] START round=27 head_norm_before_train=2.093940 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6154970049053944, 'auprc': 0.6154970049053944, 'loss_val': 0.6345838345678706, 'psi': 0.6154970049053944}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6185859693189732, 'psi': 0.6164734888353558}
[S16] START round=27 head_norm_before_train=1.807530 (no previous merge yet)
[S16] round=27 local utility u=0.044795 metrics={'f1_val': 0.09057449191870699, 'auprc': 0.09057449191870699, 'loss_val': 4.8365383179205, 'psi': 0.09057449191870699}-{'f1_val': 0.09006410256410256, 'auprc': 0.09006410256410256, 'loss_val': 4.9215345991234685, 'psi': 0.09006410256410256}
[S17] START round=27 head_norm_before_train=1.583620 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.889208 metrics={'f1_val': 0.5799790686086429, 'auprc': 0.5799790686086429, 'loss_val': 1.068935993943921, 'psi': 0.5799790686086429}-{'f1_val': 0.4229925036966332, 'auprc': 0.4229925036966332, 'loss_val': 1.4344726583820564, 'psi': 0.4229925036966332}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.240)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.091)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=28 head_norm_before_train=1.888251 cos_to_last_merge=0.9860 (last merge round=24)
[S2] round=28 local utility u=0.990114 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.897130519773774, 'psi': 0.3674775928297055}-{'f1_val': 0.20217917675544794, 'auprc': 0.20217917675544794, 'loss_val': 2.3896725929086173, 'psi': 0.20217917675544794}
[S3] START round=28 head_norm_before_train=1.724164 cos_to_last_merge=0.9752 (last merge round=21)
[S3] round=28 local utility u=0.063489 metrics={'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 2.47000691068564, 'psi': 0.2975373066007507}-{'f1_val': 0.28633446583616456, 'auprc': 0.28633446583616456, 'loss_val': 2.4961599337641167, 'psi': 0.28633446583616456}
[S4] START round=28 head_norm_before_train=1.958116 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0238157094874294, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0161337595828528, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.886742 cos_to_last_merge=0.9992 (last merge round=25)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7468129748896506, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.6158877649892893, 'psi': 0.33308623671855697}
[S6] START round=28 head_norm_before_train=1.336455 cos_to_last_merge=0.9903 (last merge round=26)
[S6] round=28 local utility u=0.198799 metrics={'f1_val': 0.10118365788468882, 'auprc': 0.10118365788468882, 'loss_val': 3.820385624705857, 'psi': 0.10118365788468882}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 3.4971509020862994, 'psi': 0.02109124254928932}
[S7] START round=28 head_norm_before_train=1.563989 (no previous merge yet)
[S7] round=28 local utility u=0.558598 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1190013567148158, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.1555296309719896, 'psi': 0.23968964488212474}
[S8] START round=28 head_norm_before_train=1.611705 cos_to_last_merge=0.9909 (last merge round=25)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2637170570176495, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.192206678331071, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.802696 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.454374648680684, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.417021345782442, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.907014 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.4259361647961133, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.3874595855658094, 'psi': 0.3324563501554652}
[S11] START round=28 head_norm_before_train=1.794103 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.068584180144284, 'psi': 0.3319360347772085}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.993025341223701, 'psi': 0.33185875048506014}
[S13] START round=28 head_norm_before_train=1.832659 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0902894475810374, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.064778201675936, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.479725 cos_to_last_merge=0.9982 (last merge round=25)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.9952541927664225, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.8584666543456723, 'psi': 0.13582554517133957}
[S15] START round=28 head_norm_before_train=2.110998 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.662999539592322, 'psi': 0.6163342951580373}-{'f1_val': 0.6154970049053944, 'auprc': 0.6154970049053944, 'loss_val': 0.6345838345678706, 'psi': 0.6154970049053944}
[S16] START round=28 head_norm_before_train=1.815972 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.08939175092280532, 'auprc': 0.08939175092280532, 'loss_val': 5.196317589034678, 'psi': 0.08939175092280532}-{'f1_val': 0.09057449191870699, 'auprc': 0.09057449191870699, 'loss_val': 4.8365383179205, 'psi': 0.09057449191870699}
[S17] START round=28 head_norm_before_train=1.622527 cos_to_last_merge=0.9996 (last merge round=26)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5726492526977077, 'auprc': 0.5726492526977077, 'loss_val': 1.1675868461028425, 'psi': 0.5726492526977077}-{'f1_val': 0.5799790686086429, 'auprc': 0.5799790686086429, 'loss_val': 1.068935993943921, 'psi': 0.5799790686086429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:39812
[S6] not sending this round → trigger blocked (psi=0.101)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=0.9335
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.6404
[S11] RECEIVED delta(kind=head bytes=1795) from S2
[S11] cosine check vs S2: cos=0.9304
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.3331 head_norm=1.912269
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.433269e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.3331 head_norm=1.799096 delta_norm=0.343327
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.3319 head_norm=1.809951
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.518885e-01
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.3319 head_norm=1.831675 delta_norm=0.351889
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.1012 head_norm=1.422477
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.406720e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.1004 head_norm=1.360306 delta_norm=0.640672
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.918801 cos_to_last_merge=0.9822 (last merge round=24)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.9699316673783949, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.897130519773774, 'psi': 0.3674775928297055}
[S3] START round=29 head_norm_before_train=1.747130 cos_to_last_merge=0.9720 (last merge round=21)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.28858241861337836, 'auprc': 0.28858241861337836, 'loss_val': 2.6818841216277627, 'psi': 0.28858241861337836}-{'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 2.47000691068564, 'psi': 0.2975373066007507}
[S4] START round=29 head_norm_before_train=1.972939 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0258630470228518, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0238157094874294, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.799096 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8318096110460622, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7468129748896506, 'psi': 0.33308623671855697}
[S6] START round=29 head_norm_before_train=1.360306 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 3.5295745162473513, 'psi': 0.02153000458085204}-{'f1_val': 0.10118365788468882, 'auprc': 0.10118365788468882, 'loss_val': 3.820385624705857, 'psi': 0.10118365788468882}
[S7] START round=29 head_norm_before_train=1.580616 (no previous merge yet)
[S7] round=29 local utility u=0.011733 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0955359153306645, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1190013567148158, 'psi': 0.35976373724718097}
[S8] START round=29 head_norm_before_train=1.687004 cos_to_last_merge=0.9848 (last merge round=25)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3376475242193175, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2637170570176495, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.811535 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4866267389546164, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.454374648680684, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.926058 cos_to_last_merge=0.9999 (last merge round=26)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.438446451243404, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.4259361647961133, 'psi': 0.3324563501554652}
[S11] START round=29 head_norm_before_train=1.831675 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.004603 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.0593775630614957, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.068584180144284, 'psi': 0.3319360347772085}
[S13] START round=29 head_norm_before_train=1.842939 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1215704920535243, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0902894475810374, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.508827 cos_to_last_merge=0.9967 (last merge round=25)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.138214513476341, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.9952541927664225, 'psi': 0.13587634006482174}
[S15] START round=29 head_norm_before_train=2.127137 (no previous merge yet)
[S15] round=29 local utility u=0.035058 metrics={'f1_val': 0.6156024116067705, 'auprc': 0.6156024116067705, 'loss_val': 0.5862972243321593, 'psi': 0.6156024116067705}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.662999539592322, 'psi': 0.6163342951580373}
[S16] START round=29 head_norm_before_train=1.823704 (no previous merge yet)
[S16] round=29 local utility u=0.992860 metrics={'f1_val': 0.16254367575122292, 'auprc': 0.16254367575122292, 'loss_val': 3.8689653063730294, 'psi': 0.16254367575122292}-{'f1_val': 0.08939175092280532, 'auprc': 0.08939175092280532, 'loss_val': 5.196317589034678, 'psi': 0.08939175092280532}
[S17] START round=29 head_norm_before_train=1.675544 cos_to_last_merge=0.9986 (last merge round=26)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5618855104933168, 'auprc': 0.5618855104933168, 'loss_val': 1.2495513829010063, 'psi': 0.5618855104933168}-{'f1_val': 0.5726492526977077, 'auprc': 0.5726492526977077, 'loss_val': 1.1675868461028425, 'psi': 0.5726492526977077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.163)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39807
[S7] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=0.8749
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2]  timeout peer S3
[S3]  timeout peer S2
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.0215 head_norm=1.439762
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.865491e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.0213 head_norm=1.468497 delta_norm=0.386549
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.941744 cos_to_last_merge=0.9794 (last merge round=24)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.24180957649517487, 'auprc': 0.24180957649517487, 'loss_val': 2.108902676062586, 'psi': 0.24180957649517487}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.9699316673783949, 'psi': 0.3674775928297055}
[S3] START round=30 head_norm_before_train=1.768486 cos_to_last_merge=0.9693 (last merge round=21)
[S3] round=30 local utility u=0.178904 metrics={'f1_val': 0.29751461988304095, 'auprc': 0.29751461988304095, 'loss_val': 2.4044665732479826, 'psi': 0.29751461988304095}-{'f1_val': 0.28858241861337836, 'auprc': 0.28858241861337836, 'loss_val': 2.6818841216277627, 'psi': 0.28858241861337836}
[S4] START round=30 head_norm_before_train=1.980093 (no previous merge yet)
[S4] round=30 local utility u=0.002451 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0209613765670276, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0258630470228518, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.817023 cos_to_last_merge=0.9999 (last merge round=28)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8723955061627424, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8318096110460622, 'psi': 0.33308623671855697}
[S6] START round=30 head_norm_before_train=1.468497 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.053433 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 3.4325483553897747, 'psi': 0.02262340036563071}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 3.5295745162473513, 'psi': 0.02153000458085204}
[S7] START round=30 head_norm_before_train=1.593391 (no previous merge yet)
[S7] round=30 local utility u=0.006114 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0833085602799584, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0955359153306645, 'psi': 0.35976373724718097}
[S8] START round=30 head_norm_before_train=1.747775 cos_to_last_merge=0.9800 (last merge round=25)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.401042437921465, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3376475242193175, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.819913 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5154124318494353, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4866267389546164, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.942536 cos_to_last_merge=0.9998 (last merge round=26)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.4415700038761226, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.438446451243404, 'psi': 0.3324563501554652}
[S11] START round=30 head_norm_before_train=1.846287 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=30 local utility u=0.018847 metrics={'f1_val': 0.3253442897359811, 'auprc': 0.3253442897359811, 'loss_val': 2.9623585820588314, 'psi': 0.3253442897359811}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.0593775630614957, 'psi': 0.3319360347772085}
[S13] START round=30 head_norm_before_train=1.857812 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.148112420488626, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1215704920535243, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.534460 cos_to_last_merge=0.9951 (last merge round=25)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.273512583526947, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.138214513476341, 'psi': 0.13592717296421}
[S15] START round=30 head_norm_before_train=2.142139 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6691265568466161, 'psi': 0.6163342951580373}-{'f1_val': 0.6156024116067705, 'auprc': 0.6156024116067705, 'loss_val': 0.5862972243321593, 'psi': 0.6156024116067705}
[S16] START round=30 head_norm_before_train=1.831347 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.11531696872371339, 'auprc': 0.11531696872371339, 'loss_val': 4.734012948960811, 'psi': 0.11531696872371339}-{'f1_val': 0.16254367575122292, 'auprc': 0.16254367575122292, 'loss_val': 3.8689653063730294, 'psi': 0.16254367575122292}
[S17] START round=30 head_norm_before_train=1.717252 cos_to_last_merge=0.9975 (last merge round=26)
[S17] round=30 local utility u=0.244742 metrics={'f1_val': 0.6015342721858152, 'auprc': 0.6015342721858152, 'loss_val': 1.1169053487450675, 'psi': 0.6015342721858152}-{'f1_val': 0.5618855104933168, 'auprc': 0.5618855104933168, 'loss_val': 1.2495513829010063, 'psi': 0.5618855104933168}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39805
[S3] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.023)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39807
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] cosine check vs S3: cos=0.9771
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] cosine check vs S7: cos=0.9320
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] ⇄ pheromone p=0.152 → S11@127.0.0.1:39812
[S3] ⇄ pheromone p=0.090 → S5@127.0.0.1:39805
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.3331 head_norm=1.828636
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.947571e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.3331 head_norm=1.797129 delta_norm=0.194757
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.062 → S10@127.0.0.1:39811
[S14] ⇄ pheromone p=0.040 → S3@127.0.0.1:39803
[S13] ⇄ pheromone p=0.004 → S7@127.0.0.1:39808
[S8] ⇄ pheromone p=0.020 → S17@127.0.0.1:39817
[S11] ⇄ pheromone p=0.022 → S2@127.0.0.1:39802
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.0226 head_norm=1.555294
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.923423e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.0224 head_norm=1.553179 delta_norm=0.292342
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.084 → S2@127.0.0.1:39802
[S10] ⇄ pheromone p=0.013 → S13@127.0.0.1:39813
[S7] ⇄ pheromone p=0.129 → S6@127.0.0.1:39807
[S17] ⇄ pheromone p=0.259 → S8@127.0.0.1:39809
[S2] START round=31 head_norm_before_train=1.959589 cos_to_last_merge=0.9772 (last merge round=24)
[S2] round=31 local utility u=0.576300 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.087313929775374, 'psi': 0.3674775928297055}-{'f1_val': 0.24180957649517487, 'auprc': 0.24180957649517487, 'loss_val': 2.108902676062586, 'psi': 0.24180957649517487}
[S3] START round=31 head_norm_before_train=1.786420 cos_to_last_merge=0.9671 (last merge round=21)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.29093281148075667, 'auprc': 0.29093281148075667, 'loss_val': 2.7916598005114084, 'psi': 0.29093281148075667}-{'f1_val': 0.29751461988304095, 'auprc': 0.29751461988304095, 'loss_val': 2.4044665732479826, 'psi': 0.29751461988304095}
[S4] START round=31 head_norm_before_train=1.989153 (no previous merge yet)
[S4] round=31 local utility u=0.000311 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0203400291284574, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0209613765670276, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.797129 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.010601 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.851193131740533, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8723955061627424, 'psi': 0.33308623671855697}
[S6] START round=31 head_norm_before_train=1.553179 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 3.56428707148806, 'psi': 0.021749084249084248}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 3.4325483553897747, 'psi': 0.02262340036563071}
[S7] START round=31 head_norm_before_train=1.605216 (no previous merge yet)
[S7] round=31 local utility u=0.005870 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0715688763896687, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0833085602799584, 'psi': 0.35976373724718097}
[S8] START round=31 head_norm_before_train=1.795014 cos_to_last_merge=0.9763 (last merge round=25)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4742451620134738, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.401042437921465, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.827760 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.539746059365059, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5154124318494353, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.958327 cos_to_last_merge=0.9996 (last merge round=26)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.448915687546098, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.4415700038761226, 'psi': 0.3324563501554652}
[S11] START round=31 head_norm_before_train=1.859391 cos_to_last_merge=0.9999 (last merge round=28)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.1318005817446473, 'psi': 0.3319360347772085}-{'f1_val': 0.3253442897359811, 'auprc': 0.3253442897359811, 'loss_val': 2.9623585820588314, 'psi': 0.3253442897359811}
[S13] START round=31 head_norm_before_train=1.867538 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1593045708535845, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.148112420488626, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.556963 cos_to_last_merge=0.9936 (last merge round=25)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.400774719211826, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.273512583526947, 'psi': 0.13592717296421}
[S15] START round=31 head_norm_before_train=2.154392 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6806681751293724, 'psi': 0.6161950003225232}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6691265568466161, 'psi': 0.6163342951580373}
[S16] START round=31 head_norm_before_train=1.838697 (no previous merge yet)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.06881077038145102, 'auprc': 0.06881077038145102, 'loss_val': 5.4373417158025426, 'psi': 0.06881077038145102}-{'f1_val': 0.11531696872371339, 'auprc': 0.11531696872371339, 'loss_val': 4.734012948960811, 'psi': 0.11531696872371339}
[S17] START round=31 head_norm_before_train=1.748070 cos_to_last_merge=0.9964 (last merge round=26)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5700659858434249, 'auprc': 0.5700659858434249, 'loss_val': 1.3193512791898565, 'psi': 0.5700659858434249}-{'f1_val': 0.6015342721858152, 'auprc': 0.6015342721858152, 'loss_val': 1.1169053487450675, 'psi': 0.6015342721858152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39803
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39807
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.2825
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=0.9513
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=0.9931
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.2909 head_norm=1.802821
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.063194e-01
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.2908 head_norm=1.800941 delta_norm=0.106319
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.0217 head_norm=1.641217
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.196131e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.0217 head_norm=1.412037 delta_norm=0.519613
[S6] aggregate: ACCEPT kept=['S2', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.974709 cos_to_last_merge=0.9754 (last merge round=24)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.1298626955353135, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.087313929775374, 'psi': 0.3674775928297055}
[S3] START round=32 head_norm_before_train=1.800941 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.090190 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.672544383006831, 'psi': 0.29773995791014735}-{'f1_val': 0.29093281148075667, 'auprc': 0.29093281148075667, 'loss_val': 2.7916598005114084, 'psi': 0.29093281148075667}
[S4] START round=32 head_norm_before_train=2.006265 (no previous merge yet)
[S4] round=32 local utility u=0.004432 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0114764538513659, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0203400291284574, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.805330 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8747684427468685, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.851193131740533, 'psi': 0.33308623671855697}
[S6] START round=32 head_norm_before_train=1.412037 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 3.8804547223149632, 'psi': 0.021967963386727688}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 3.56428707148806, 'psi': 0.021749084249084248}
[S7] START round=32 head_norm_before_train=1.621770 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.0619814473432816, 'psi': 0.23976608187134504}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0715688763896687, 'psi': 0.35976373724718097}
[S8] START round=32 head_norm_before_train=1.831390 cos_to_last_merge=0.9735 (last merge round=25)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5416403474166476, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4742451620134738, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.835066 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5625252770215665, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.539746059365059, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=1.971158 cos_to_last_merge=0.9994 (last merge round=26)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.501632253918295, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.448915687546098, 'psi': 0.3324563501554652}
[S11] START round=32 head_norm_before_train=1.872385 cos_to_last_merge=0.9997 (last merge round=28)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.1456981724600257, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.1318005817446473, 'psi': 0.3319360347772085}
[S13] START round=32 head_norm_before_train=1.872892 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.18599518927164, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1593045708535845, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.576710 cos_to_last_merge=0.9922 (last merge round=25)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.510746355453367, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.400774719211826, 'psi': 0.13587634006482174}
[S15] START round=32 head_norm_before_train=2.168408 (no previous merge yet)
[S15] round=32 local utility u=0.033397 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.616380460216931, 'psi': 0.6164734888353558}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6806681751293724, 'psi': 0.6161950003225232}
[S16] START round=32 head_norm_before_train=1.846134 (no previous merge yet)
[S16] round=32 local utility u=1.000000 metrics={'f1_val': 0.17969488321857705, 'auprc': 0.17969488321857705, 'loss_val': 3.4111285463407066, 'psi': 0.17969488321857705}-{'f1_val': 0.06881077038145102, 'auprc': 0.06881077038145102, 'loss_val': 5.4373417158025426, 'psi': 0.06881077038145102}
[S17] START round=32 head_norm_before_train=1.779876 cos_to_last_merge=0.9952 (last merge round=26)
[S17] round=32 local utility u=0.246722 metrics={'f1_val': 0.6117312035612582, 'auprc': 0.6117312035612582, 'loss_val': 1.2008948890224624, 'psi': 0.6117312035612582}-{'f1_val': 0.5700659858434249, 'auprc': 0.5700659858434249, 'loss_val': 1.3193512791898565, 'psi': 0.5700659858434249}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:39805
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1794 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.180)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1794) from S3
[S5] cosine check vs S3: cos=0.9976
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.7769
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.3594 head_norm=1.862246
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.131614e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.3594 head_norm=1.728917 delta_norm=0.613161
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.3331 head_norm=1.814052
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.300285e-02
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.3331 head_norm=1.813915 delta_norm=0.063003
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.988596 cos_to_last_merge=0.9737 (last merge round=24)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.23956981272019284, 'auprc': 0.23956981272019284, 'loss_val': 2.3264393584409095, 'psi': 0.23956981272019284}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.1298626955353135, 'psi': 0.3674775928297055}
[S3] START round=33 head_norm_before_train=1.815965 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.711005329330668, 'psi': 0.29773995791014735}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.672544383006831, 'psi': 0.29773995791014735}
[S4] START round=33 head_norm_before_train=2.020955 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0119031687222328, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0114764538513659, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.813915 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.011759 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.855037450900649, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8747684427468685, 'psi': 0.33308623671855697}
[S6] START round=33 head_norm_before_train=1.505089 cos_to_last_merge=0.9941 (last merge round=31)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 4.487471052780838, 'psi': 0.021749084249084248}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 3.8804547223149632, 'psi': 0.021967963386727688}
[S7] START round=33 head_norm_before_train=1.634689 (no previous merge yet)
[S7] round=33 local utility u=0.545722 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.050517257584115, 'psi': 0.35976373724718097}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.0619814473432816, 'psi': 0.23976608187134504}
[S8] START round=33 head_norm_before_train=1.728917 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.074593 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3924548341400036, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5416403474166476, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.842272 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.585557729769081, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5625252770215665, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=1.988224 cos_to_last_merge=0.9993 (last merge round=26)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.574774720028557, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.501632253918295, 'psi': 0.3324563501554652}
[S11] START round=33 head_norm_before_train=1.884705 cos_to_last_merge=0.9995 (last merge round=28)
[S11] round=33 local utility u=0.015396 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.1142109113797996, 'psi': 0.33185875048506014}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.1456981724600257, 'psi': 0.3319360347772085}
[S13] START round=33 head_norm_before_train=1.880580 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1974251366552933, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.18599518927164, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=1.594455 cos_to_last_merge=0.9909 (last merge round=25)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.608354094691181, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.510746355453367, 'psi': 0.13587634006482174}
[S15] START round=33 head_norm_before_train=2.181966 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6147513074387981, 'auprc': 0.6147513074387981, 'loss_val': 0.6225213251669035, 'psi': 0.6147513074387981}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.616380460216931, 'psi': 0.6164734888353558}
[S16] START round=33 head_norm_before_train=1.853692 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.09767805313686091, 'auprc': 0.09767805313686091, 'loss_val': 4.318020594058136, 'psi': 0.09767805313686091}-{'f1_val': 0.17969488321857705, 'auprc': 0.17969488321857705, 'loss_val': 3.4111285463407066, 'psi': 0.17969488321857705}
[S17] START round=33 head_norm_before_train=1.806179 cos_to_last_merge=0.9945 (last merge round=26)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6015342721858152, 'auprc': 0.6015342721858152, 'loss_val': 1.2935786763850925, 'psi': 0.6015342721858152}-{'f1_val': 0.6117312035612582, 'auprc': 0.6117312035612582, 'loss_val': 1.2008948890224624, 'psi': 0.6117312035612582}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:39817
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39802
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39803
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39807
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.8284
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.9989
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.9716
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9298
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=33 metric=0.2977 head_norm=1.830034
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.200027e-02
[S3] stored merged vector for next round verification (round=33)
[S3] DEBUG after merge:  round=33 metric=0.2977 head_norm=1.826150 delta_norm=0.042000
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=33 metric=0.2396 head_norm=2.001051
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.380586e-01
[S2] stored merged vector for next round verification (round=33)
[S2] DEBUG after merge:  round=33 metric=0.2406 head_norm=1.934698 delta_norm=0.238059
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S8
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.0217 head_norm=1.578478
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.741229e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.0217 head_norm=1.543451 delta_norm=0.474123
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.6015 head_norm=1.827946
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.387333e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.6008 head_norm=1.770914 delta_norm=0.338733
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.934698 cos_to_last_merge=1.0000 (last merge round=33)
[S2] round=34 local utility u=0.708624 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.060360879241058, 'psi': 0.3674775928297055}-{'f1_val': 0.23956981272019284, 'auprc': 0.23956981272019284, 'loss_val': 2.3264393584409095, 'psi': 0.23956981272019284}
[S3] START round=34 head_norm_before_train=1.826150 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.28644211718086615, 'auprc': 0.28644211718086615, 'loss_val': 2.87727572211627, 'psi': 0.28644211718086615}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.711005329330668, 'psi': 0.29773995791014735}
[S4] START round=34 head_norm_before_train=2.030064 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0249654369021093, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0119031687222328, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.823225 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8659382460603475, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.855037450900649, 'psi': 0.3335071121394324}
[S6] START round=34 head_norm_before_train=1.543451 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.386155 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 3.7131885150924124, 'psi': 0.02153000458085204}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 4.487471052780838, 'psi': 0.021749084249084248}
[S7] START round=34 head_norm_before_train=1.649992 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0279904861117228, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.050517257584115, 'psi': 0.35976373724718097}
[S8] START round=34 head_norm_before_train=1.777741 cos_to_last_merge=0.9995 (last merge round=32)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4674499616096783, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3924548341400036, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.849326 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.608236637004974, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.585557729769081, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=2.005979 cos_to_last_merge=0.9992 (last merge round=26)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.598295300267344, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.574774720028557, 'psi': 0.3324563501554652}
[S11] START round=34 head_norm_before_train=1.896115 cos_to_last_merge=0.9993 (last merge round=28)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.159760208107847, 'psi': 0.3319360347772085}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.1142109113797996, 'psi': 0.33185875048506014}
[S13] START round=34 head_norm_before_train=1.888449 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.210923357649021, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1974251366552933, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=1.610363 cos_to_last_merge=0.9896 (last merge round=25)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.6968814734651145, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.608354094691181, 'psi': 0.13587634006482174}
[S15] START round=34 head_norm_before_train=2.191255 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.6932726008577531, 'psi': 0.6160556042184989}-{'f1_val': 0.6147513074387981, 'auprc': 0.6147513074387981, 'loss_val': 0.6225213251669035, 'psi': 0.6147513074387981}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.861301 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.08966955405838949, 'auprc': 0.08966955405838949, 'loss_val': 5.22850835131098, 'psi': 0.08966955405838949}-{'f1_val': 0.09767805313686091, 'auprc': 0.09767805313686091, 'loss_val': 4.318020594058136, 'psi': 0.09767805313686091}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.770914 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.281255 metrics={'f1_val': 0.643964789488041, 'auprc': 0.643964789488041, 'loss_val': 1.1129435923484927, 'psi': 0.643964789488041}-{'f1_val': 0.6015342721858152, 'auprc': 0.6015342721858152, 'loss_val': 1.2935786763850925, 'psi': 0.6015342721858152}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.022)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:39807
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9737
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S2
[S6] cosine check vs S2: cos=0.3616
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.0215 head_norm=1.602385
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.014039e+00
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.0215 head_norm=1.469240 delta_norm=1.014039
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] RoundReady barrier timeout: have=2 need=3 — continuing
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RoundReady barrier timeout: have=2 need=3 — continuing
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3]  timeout peer S5
[S13]  timeout peer S7
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S15
[S14]  timeout peer S16
[S10]  timeout peer S13
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S14
[S5]  timeout peer S10
[S6]  timeout peer S2
[S2] START round=35 head_norm_before_train=1.950960 cos_to_last_merge=0.9999 (last merge round=33)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.130732870290058, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.060360879241058, 'psi': 0.3674775928297055}
[S3] START round=35 head_norm_before_train=1.839613 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=35 local utility u=0.085150 metrics={'f1_val': 0.2972329118563313, 'auprc': 0.2972329118563313, 'loss_val': 2.804093058803335, 'psi': 0.2972329118563313}-{'f1_val': 0.28644211718086615, 'auprc': 0.28644211718086615, 'loss_val': 2.87727572211627, 'psi': 0.28644211718086615}
[S4] START round=35 head_norm_before_train=2.036868 (no previous merge yet)
[S4] round=35 local utility u=0.006652 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0116608160841976, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0249654369021093, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=35 head_norm_before_train=1.834755 cos_to_last_merge=0.9999 (last merge round=32)
[S5] round=35 local utility u=0.011191 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8435568830142168, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8659382460603475, 'psi': 0.3335071121394324}
[S6] START round=35 head_norm_before_train=1.469240 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 4.034583994691008, 'psi': 0.02284148012791229}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 3.7131885150924124, 'psi': 0.02153000458085204}
[S7] START round=35 head_norm_before_train=1.664796 (no previous merge yet)
[S7] round=35 local utility u=0.002087 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.023816962590192, 'psi': 0.23968964488212474}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0279904861117228, 'psi': 0.23968964488212474}
[S8] START round=35 head_norm_before_train=1.839405 cos_to_last_merge=0.9978 (last merge round=32)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.553887554265568, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4674499616096783, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.856098 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.630737253986465, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.608236637004974, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=2.018365 cos_to_last_merge=0.9990 (last merge round=26)
[S10] round=35 local utility u=0.007019 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.584256928120533, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.598295300267344, 'psi': 0.3324563501554652}
[S11] START round=35 head_norm_before_train=1.906829 cos_to_last_merge=0.9990 (last merge round=28)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.2243774194050188, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.159760208107847, 'psi': 0.3319360347772085}
[S13] START round=35 head_norm_before_train=1.895912 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.227582212594198, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.210923357649021, 'psi': 0.3599362944611573}
[S14] START round=35 head_norm_before_train=1.624806 cos_to_last_merge=0.9884 (last merge round=25)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.7814427573058795, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.6968814734651145, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=2.200760 (no previous merge yet)
[S15] round=35 local utility u=0.021645 metrics={'f1_val': 0.615275621225241, 'auprc': 0.615275621225241, 'loss_val': 0.6429635862573965, 'psi': 0.615275621225241}-{'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.6932726008577531, 'psi': 0.6160556042184989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=35 head_norm_before_train=1.866329 (no previous merge yet)
[S16] round=35 local utility u=0.961148 metrics={'f1_val': 0.1217436974789916, 'auprc': 0.1217436974789916, 'loss_val': 3.594879736776492, 'psi': 0.1217436974789916}-{'f1_val': 0.08966955405838949, 'auprc': 0.08966955405838949, 'loss_val': 5.22850835131098, 'psi': 0.08966955405838949}
[S16] not sending this round → trigger blocked (psi=0.122)
[S17] START round=35 head_norm_before_train=1.797555 cos_to_last_merge=0.9999 (last merge round=33)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.48061247702663934, 'auprc': 0.48061247702663934, 'loss_val': 1.6023601570332395, 'psi': 0.48061247702663934}-{'f1_val': 0.643964789488041, 'auprc': 0.643964789488041, 'loss_val': 1.1129435923484927, 'psi': 0.643964789488041}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:39813
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S11] ⇄ pheromone p=0.009 → S2@127.0.0.1:39802
[S13] ⇄ pheromone p=0.001 → S10@127.0.0.1:39811
[S6] ⇄ pheromone p=0.089 → S7@127.0.0.1:39808
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.3594 head_norm=1.895445
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.396288e-01
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.3594 head_norm=1.831539 delta_norm=0.239629
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.016 → S17@127.0.0.1:39817
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39803
[S17] ⇄ pheromone p=0.155 → S8@127.0.0.1:39809
[S14] RECEIVED delta(kind=head bytes=1799) from S3
[S14] cosine check vs S3: cos=0.5183
[S5] RECEIVED delta(kind=head bytes=1805) from S10
[S5] cosine check vs S10: cos=0.9362
[S13] RECEIVED delta(kind=head bytes=1801) from S7
[S13] cosine check vs S7: cos=0.0091
[S10] ⇄ pheromone p=0.006 → S5@127.0.0.1:39805
[S7] ⇄ pheromone p=0.113 → S13@127.0.0.1:39813
[S3] ⇄ pheromone p=0.056 → S14@127.0.0.1:39814
[S5] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.9989
[S2] ⇄ pheromone p=0.210 → S6@127.0.0.1:39807
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.3335 head_norm=1.844122
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.573466e-01
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.3335 head_norm=1.904511 delta_norm=0.357347
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.025 → S3@127.0.0.1:39803
[S2] START round=36 head_norm_before_train=1.971060 cos_to_last_merge=0.9997 (last merge round=33)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.186468760626974, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.130732870290058, 'psi': 0.3674775928297055}
[S3] START round=36 head_norm_before_train=1.853113 cos_to_last_merge=0.9998 (last merge round=33)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.29385113268608415, 'auprc': 0.29385113268608415, 'loss_val': 2.913236825401201, 'psi': 0.29385113268608415}-{'f1_val': 0.2972329118563313, 'auprc': 0.2972329118563313, 'loss_val': 2.804093058803335, 'psi': 0.2972329118563313}
[S4] START round=36 head_norm_before_train=2.049103 (no previous merge yet)
[S4] round=36 local utility u=0.004039 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.003581855239759, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0116608160841976, 'psi': 0.3567939207526687}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] START round=36 head_norm_before_train=1.904511 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.133710 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.5761366826889132, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8435568830142168, 'psi': 0.3335071121394324}
[S6] START round=36 head_norm_before_train=1.533826 cos_to_last_merge=0.9977 (last merge round=34)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 4.532982785133424, 'psi': 0.021749084249084248}-{'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 4.034583994691008, 'psi': 0.02284148012791229}
[S7] START round=36 head_norm_before_train=1.677381 (no previous merge yet)
[S7] round=36 local utility u=0.532512 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0394594211784844, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.023816962590192, 'psi': 0.23968964488212474}
[S8] START round=36 head_norm_before_train=1.831539 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.015967 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5219537604047058, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.553887554265568, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=1.862626 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6546856654906605, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.630737253986465, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=2.027050 cos_to_last_merge=0.9987 (last merge round=26)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.5964871393093922, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.584256928120533, 'psi': 0.3324563501554652}
[S11] START round=36 head_norm_before_train=1.916722 cos_to_last_merge=0.9988 (last merge round=28)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.270019759738887, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.2243774194050188, 'psi': 0.3319360347772085}
[S13] START round=36 head_norm_before_train=1.902119 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.2510985928779674, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.227582212594198, 'psi': 0.3599362944611573}
[S14] START round=36 head_norm_before_train=1.638092 cos_to_last_merge=0.9872 (last merge round=25)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.859116109464271, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.7814427573058795, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.1359 head_norm=1.650448
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.652198e-01
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.1359 head_norm=1.526564 delta_norm=0.865220
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] START round=36 head_norm_before_train=2.211385 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.5860968595332271, 'auprc': 0.5860968595332271, 'loss_val': 0.6769330663059877, 'psi': 0.5860968595332271}-{'f1_val': 0.615275621225241, 'auprc': 0.615275621225241, 'loss_val': 0.6429635862573965, 'psi': 0.615275621225241}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.872318 (no previous merge yet)
[S16] round=36 local utility u=0.402092 metrics={'f1_val': 0.1463222244133307, 'auprc': 0.1463222244133307, 'loss_val': 3.011902720063156, 'psi': 0.1463222244133307}-{'f1_val': 0.1217436974789916, 'auprc': 0.1217436974789916, 'loss_val': 3.594879736776492, 'psi': 0.1217436974789916}
[S16] not sending this round → trigger blocked (psi=0.146)
[S17] START round=36 head_norm_before_train=1.828898 cos_to_last_merge=0.9996 (last merge round=33)
[S17] round=36 local utility u=0.932635 metrics={'f1_val': 0.640855625790139, 'auprc': 0.640855625790139, 'loss_val': 1.1792787856389664, 'psi': 0.640855625790139}-{'f1_val': 0.48061247702663934, 'auprc': 0.48061247702663934, 'loss_val': 1.6023601570332395, 'psi': 0.48061247702663934}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:39817
[S7] not sending this round → trigger blocked (psi=0.360)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39809
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=36 metric=0.2939 head_norm=1.866308
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.142312e-02
[S3] stored merged vector for next round verification (round=36)
[S3] DEBUG after merge:  round=36 metric=0.2942 head_norm=1.854535 delta_norm=0.051423
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=36 metric=0.3599 head_norm=1.910112
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.265222e+00
[S13] stored merged vector for next round verification (round=36)
[S13] DEBUG after merge:  round=36 metric=0.3599 head_norm=1.276825 delta_norm=1.265222
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → trigger blocked (psi=0.334)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9848
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.9848
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.6409 head_norm=1.849917
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.635953e-01
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.6398 head_norm=1.860159 delta_norm=0.163595
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=36 metric=0.3594 head_norm=1.884601
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.635953e-01
[S8] stored merged vector for next round verification (round=36)
[S8] DEBUG after merge:  round=36 metric=0.3594 head_norm=1.860159 delta_norm=0.163595
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.990575 cos_to_last_merge=0.9992 (last merge round=33)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2299348402703933, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.186468760626974, 'psi': 0.3674775928297055}
[S3] START round=37 head_norm_before_train=1.854535 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=37 local utility u=0.078177 metrics={'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 2.790057392958847, 'psi': 0.2975373066007507}-{'f1_val': 0.29385113268608415, 'auprc': 0.29385113268608415, 'loss_val': 2.913236825401201, 'psi': 0.29385113268608415}
[S4] START round=37 head_norm_before_train=2.058733 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0061080733915189, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.003581855239759, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.914139 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=37 local utility u=0.003290 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.5695575652735716, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.5761366826889132, 'psi': 0.3335071121394324}
[S6] START round=37 head_norm_before_train=1.587021 cos_to_last_merge=0.9935 (last merge round=34)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.929421560267959, 'psi': 0.017774699907663897}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 4.532982785133424, 'psi': 0.021749084249084248}
[S7] START round=37 head_norm_before_train=1.692155 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0413406398040752, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0394594211784844, 'psi': 0.35976373724718097}
[S8] START round=37 head_norm_before_train=1.860159 cos_to_last_merge=1.0000 (last merge round=36)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5303983876429004, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5219537604047058, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=1.869052 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.677046561558475, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6546856654906605, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.038720 cos_to_last_merge=0.9985 (last merge round=26)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.6005225321879726, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.5964871393093922, 'psi': 0.3324563501554652}
[S11] START round=37 head_norm_before_train=1.925996 cos_to_last_merge=0.9985 (last merge round=28)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.272305899389761, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.270019759738887, 'psi': 0.3319360347772085}
[S13] START round=37 head_norm_before_train=1.276825 cos_to_last_merge=1.0000 (last merge round=36)
[S13] round=37 local utility u=0.377005 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4970879244686468, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.2510985928779674, 'psi': 0.3599362944611573}
[S14] START round=37 head_norm_before_train=1.526564 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.559970 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.7391755809415166, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.859116109464271, 'psi': 0.13587634006482174}
[S14] not sending this round → trigger blocked (psi=0.136)
[S15] START round=37 head_norm_before_train=2.220978 (no previous merge yet)
[S15] round=37 local utility u=0.149531 metrics={'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6462434917863222, 'psi': 0.61591610673549}-{'f1_val': 0.5860968595332271, 'auprc': 0.5860968595332271, 'loss_val': 0.6769330663059877, 'psi': 0.5860968595332271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=37 head_norm_before_train=1.878609 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.1426599840197574, 'auprc': 0.1426599840197574, 'loss_val': 4.374354434525068, 'psi': 0.1426599840197574}-{'f1_val': 0.1463222244133307, 'auprc': 0.1463222244133307, 'loss_val': 3.011902720063156, 'psi': 0.1463222244133307}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.860159 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.173569 metrics={'f1_val': 0.6686245780999813, 'auprc': 0.6686245780999813, 'loss_val': 1.0820618682532555, 'psi': 0.6686245780999813}-{'f1_val': 0.640855625790139, 'auprc': 0.640855625790139, 'loss_val': 1.1792787856389664, 'psi': 0.640855625790139}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.669)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S2] START round=38 head_norm_before_train=2.008210 cos_to_last_merge=0.9987 (last merge round=33)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2708502122573737, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2299348402703933, 'psi': 0.3674775928297055}
[S3] START round=38 head_norm_before_train=1.866810 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.2835139760410725, 'auprc': 0.2835139760410725, 'loss_val': 3.0386463088053475, 'psi': 0.2835139760410725}-{'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 2.790057392958847, 'psi': 0.2975373066007507}
[S4] START round=38 head_norm_before_train=2.068897 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.24126751085826145, 'auprc': 0.24126751085826145, 'loss_val': 0.9604070938524364, 'psi': 0.24126751085826145}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0061080733915189, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.923323 cos_to_last_merge=0.9999 (last merge round=35)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6015781030623228, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.5695575652735716, 'psi': 0.3335071121394324}
[S6] START round=38 head_norm_before_train=1.626869 cos_to_last_merge=0.9896 (last merge round=34)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.079098013926741, 'psi': 0.021749084249084248}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.929421560267959, 'psi': 0.017774699907663897}
[S7] START round=38 head_norm_before_train=1.702019 (no previous merge yet)
[S7] round=38 local utility u=0.000389 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0405619346309156, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0413406398040752, 'psi': 0.35976373724718097}
[S8] START round=38 head_norm_before_train=1.915539 cos_to_last_merge=0.9994 (last merge round=36)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5953022914778785, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5303983876429004, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.875388 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6963198668300006, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.677046561558475, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.047169 cos_to_last_merge=0.9981 (last merge round=26)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.6033053549200535, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.6005225321879726, 'psi': 0.3324563501554652}
[S11] START round=38 head_norm_before_train=1.934805 cos_to_last_merge=0.9983 (last merge round=28)
[S11] round=38 local utility u=0.022520 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.2265706806991292, 'psi': 0.33185875048506014}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.272305899389761, 'psi': 0.3319360347772085}
[S13] START round=38 head_norm_before_train=1.302719 cos_to_last_merge=0.9990 (last merge round=36)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5508533312945223, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4970879244686468, 'psi': 0.3599362944611573}
[S14] START round=38 head_norm_before_train=1.542547 cos_to_last_merge=0.9999 (last merge round=36)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.9238144106849058, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.7391755809415166, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=2.230357 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6807494319588308, 'psi': 0.6163342951580373}-{'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6462434917863222, 'psi': 0.61591610673549}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.885421 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.03464345379407368, 'auprc': 0.03464345379407368, 'loss_val': 5.993515044461465, 'psi': 0.03464345379407368}-{'f1_val': 0.1426599840197574, 'auprc': 0.1426599840197574, 'loss_val': 4.374354434525068, 'psi': 0.1426599840197574}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.878729 cos_to_last_merge=0.9999 (last merge round=36)
[S17] round=38 local utility u=0.425007 metrics={'f1_val': 0.7399015130756441, 'auprc': 0.7399015130756441, 'loss_val': 0.8735393919966259, 'psi': 0.7399015130756441}-{'f1_val': 0.6686245780999813, 'auprc': 0.6686245780999813, 'loss_val': 1.0820618682532555, 'psi': 0.6686245780999813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:39809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1805 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] cosine check vs S17: cos=0.9971
[S2] START round=39 head_norm_before_train=2.023858 cos_to_last_merge=0.9981 (last merge round=33)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3101590703609793, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2708502122573737, 'psi': 0.3674775928297055}
[S3] START round=39 head_norm_before_train=1.878654 cos_to_last_merge=0.9999 (last merge round=36)
[S3] round=39 local utility u=0.168170 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.830341035868602, 'psi': 0.29773995791014735}-{'f1_val': 0.2835139760410725, 'auprc': 0.2835139760410725, 'loss_val': 3.0386463088053475, 'psi': 0.2835139760410725}
[S4] START round=39 head_norm_before_train=2.080578 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.24034125533211456, 'auprc': 0.24034125533211456, 'loss_val': 0.9618011362923322, 'psi': 0.24034125533211456}-{'f1_val': 0.24126751085826145, 'auprc': 0.24126751085826145, 'loss_val': 0.9604070938524364, 'psi': 0.24126751085826145}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.240 u=0.0000 p_local=0.0021 f1=0.240 auprc=0.240 bytes=35914
[S5] START round=39 head_norm_before_train=1.930922 cos_to_last_merge=0.9999 (last merge round=35)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6072977608696313, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6015781030623228, 'psi': 0.3335071121394324}
[S6] START round=39 head_norm_before_train=1.656528 cos_to_last_merge=0.9864 (last merge round=34)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 5.121431461867854, 'psi': 0.02284148012791229}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.079098013926741, 'psi': 0.021749084249084248}
[S7] START round=39 head_norm_before_train=1.711351 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0284130659350375, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0405619346309156, 'psi': 0.35976373724718097}
[S8] START round=39 head_norm_before_train=1.966261 cos_to_last_merge=0.9980 (last merge round=36)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6489235306584606, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5953022914778785, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=1.881393 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7130667056595446, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6963198668300006, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0013 f1=0.369 auprc=0.369 bytes=3605
[S10] START round=39 head_norm_before_train=2.054938 cos_to_last_merge=0.9978 (last merge round=26)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.6442397333352208, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.6033053549200535, 'psi': 0.3324563501554652}
[S11] START round=39 head_norm_before_train=1.943263 cos_to_last_merge=0.9980 (last merge round=28)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 3.2274396618515273, 'psi': 0.3317042898145993}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.2265706806991292, 'psi': 0.33185875048506014}
[S13] START round=39 head_norm_before_train=1.341579 cos_to_last_merge=0.9957 (last merge round=36)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5764798663551163, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5508533312945223, 'psi': 0.3599362944611573}
[S14] START round=39 head_norm_before_train=1.565922 cos_to_last_merge=0.9993 (last merge round=36)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.09988121810643, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.9238144106849058, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0770 f1=0.136 auprc=0.136 bytes=0
[S15] START round=39 head_norm_before_train=2.240077 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.7104371646824479, 'psi': 0.6161950003225232}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6807494319588308, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.616 u=0.0000 p_local=0.0242 f1=0.616 auprc=0.616 bytes=27017
[S16] START round=39 head_norm_before_train=1.889859 (no previous merge yet)
[S16] round=39 local utility u=0.986326 metrics={'f1_val': 0.13330374315727178, 'auprc': 0.13330374315727178, 'loss_val': 4.908806639644863, 'psi': 0.13330374315727178}-{'f1_val': 0.03464345379407368, 'auprc': 0.03464345379407368, 'loss_val': 5.993515044461465, 'psi': 0.03464345379407368}
[S16] not sending this round → trigger blocked (psi=0.133)
[S16] r=40 psi=0.133 u=0.9863 p_local=0.3858 f1=0.133 auprc=0.133 bytes=0
[S17] START round=39 head_norm_before_train=1.891461 cos_to_last_merge=0.9997 (last merge round=36)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5254200235930062, 'auprc': 0.5254200235930062, 'loss_val': 1.5011191519263736, 'psi': 0.5254200235930062}-{'f1_val': 0.7399015130756441, 'auprc': 0.7399015130756441, 'loss_val': 0.8735393919966259, 'psi': 0.7399015130756441}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0074 f1=0.332 auprc=0.332 bytes=18004
[S3] r=40 psi=0.298 u=0.1682 p_local=0.0665 f1=0.298 auprc=0.298 bytes=17988
[S10] r=40 psi=0.332 u=0.0000 p_local=0.0023 f1=0.332 auprc=0.332 bytes=12609
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0487 f1=0.360 auprc=0.360 bytes=5406
[S6] r=40 psi=0.023 u=0.0000 p_local=0.0366 f1=0.023 auprc=0.023 bytes=0
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.3594 head_norm=2.008897
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.112475e-01
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.3594 head_norm=1.947889 delta_norm=0.111247
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0082 f1=0.359 auprc=0.359 bytes=12605
[S7] r=40 psi=0.240 u=0.0000 p_local=0.1009 f1=0.240 auprc=0.240 bytes=19788
[S17] r=40 psi=0.525 u=0.0000 p_local=0.2493 f1=0.525 auprc=0.525 bytes=21630
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.334 u=0.0000 p_local=0.0243 f1=0.334 auprc=0.334 bytes=25212
[S2] r=40 psi=0.367 u=0.0000 p_local=0.0862 f1=0.367 auprc=0.367 bytes=19783
[S2] START round=40 head_norm_before_train=2.037695 cos_to_last_merge=0.9976 (last merge round=33)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.344144483358512, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3101590703609793, 'psi': 0.3674775928297055}
[S3] START round=40 head_norm_before_train=1.889328 cos_to_last_merge=0.9998 (last merge round=36)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.888046037491487, 'psi': 0.29773995791014735}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.830341035868602, 'psi': 0.29773995791014735}
[S4] START round=40 head_norm_before_train=2.079607 (no previous merge yet)
[S4] round=40 local utility u=0.003254 metrics={'f1_val': 0.24086967143031635, 'auprc': 0.24086967143031635, 'loss_val': 0.9600487045074607, 'psi': 0.24086967143031635}-{'f1_val': 0.24034125533211456, 'auprc': 0.24034125533211456, 'loss_val': 0.9618011362923322, 'psi': 0.24034125533211456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=40 head_norm_before_train=1.936131 cos_to_last_merge=0.9998 (last merge round=35)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6278722199677185, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6072977608696313, 'psi': 0.3335071121394324}
[S6] START round=40 head_norm_before_train=1.680501 cos_to_last_merge=0.9838 (last merge round=34)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.3366403506685876, 'psi': 0.021749084249084248}-{'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 5.121431461867854, 'psi': 0.02284148012791229}
[S7] START round=40 head_norm_before_train=1.716003 (no previous merge yet)
[S7] round=40 local utility u=0.004445 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0195227391220367, 'psi': 0.23968964488212474}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0284130659350375, 'psi': 0.23968964488212474}
[S8] START round=40 head_norm_before_train=1.947889 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.656396759637756, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6489235306584606, 'psi': 0.35939447907390915}
[S9] START round=40 head_norm_before_train=1.887027 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.731485351458702, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7130667056595446, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.066390 cos_to_last_merge=0.9976 (last merge round=26)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.645500521801867, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.6442397333352208, 'psi': 0.3324563501554652}
[S11] START round=40 head_norm_before_train=1.951204 cos_to_last_merge=0.9977 (last merge round=28)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.269039264294244, 'psi': 0.3319360347772085}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 3.2274396618515273, 'psi': 0.3317042898145993}
[S13] START round=40 head_norm_before_train=1.378822 cos_to_last_merge=0.9914 (last merge round=36)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.621491284349431, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5764798663551163, 'psi': 0.3599362944611573}
[S14] START round=40 head_norm_before_train=1.591783 cos_to_last_merge=0.9983 (last merge round=36)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.258067151539421, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.09988121810643, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=2.249987 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.7196643381247005, 'psi': 0.6160556042184989}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.7104371646824479, 'psi': 0.6161950003225232}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.895500 (no previous merge yet)
[S16] round=40 local utility u=0.794043 metrics={'f1_val': 0.18964491172386433, 'auprc': 0.18964491172386433, 'loss_val': 3.8277905795675657, 'psi': 0.18964491172386433}-{'f1_val': 0.13330374315727178, 'auprc': 0.13330374315727178, 'loss_val': 4.908806639644863, 'psi': 0.13330374315727178}
[S16] not sending this round → trigger blocked (psi=0.190)
[S17] START round=40 head_norm_before_train=1.909581 cos_to_last_merge=0.9996 (last merge round=36)
[S17] round=40 local utility u=0.461756 metrics={'f1_val': 0.6064742965506638, 'auprc': 0.6064742965506638, 'loss_val': 1.3070950920447564, 'psi': 0.6064742965506638}-{'f1_val': 0.5254200235930062, 'auprc': 0.5254200235930062, 'loss_val': 1.5011191519263736, 'psi': 0.5254200235930062}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.007 → S17@127.0.0.1:39817
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9966
[S17] ⇄ pheromone p=0.292 → S8@127.0.0.1:39809
[S2] ⇄ pheromone p=0.069 → S11@127.0.0.1:39812
[S5]  timeout peer S8
[S2] START round=41 head_norm_before_train=2.050262 cos_to_last_merge=0.9970 (last merge round=33)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3750182928933348, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.344144483358512, 'psi': 0.3674775928297055}
[S3] START round=41 head_norm_before_train=1.900153 cos_to_last_merge=0.9996 (last merge round=36)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.291037823737656, 'auprc': 0.291037823737656, 'loss_val': 3.0643027913408023, 'psi': 0.291037823737656}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.888046037491487, 'psi': 0.29773995791014735}
[S4] START round=41 head_norm_before_train=2.093963 (no previous merge yet)
[S4] round=41 local utility u=0.004523 metrics={'f1_val': 0.2413560981580075, 'auprc': 0.2413560981580075, 'loss_val': 0.9553797017702611, 'psi': 0.2413560981580075}-{'f1_val': 0.24086967143031635, 'auprc': 0.24086967143031635, 'loss_val': 0.9600487045074607, 'psi': 0.24086967143031635}
[S4] not sending this round → trigger blocked (psi=0.241)
[S5] START round=41 head_norm_before_train=1.945469 cos_to_last_merge=0.9997 (last merge round=35)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6600297557812151, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6278722199677185, 'psi': 0.3335071121394324}
[S6] START round=41 head_norm_before_train=1.700795 cos_to_last_merge=0.9816 (last merge round=34)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 5.441302095341102, 'psi': 0.02240512117055327}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.3366403506685876, 'psi': 0.021749084249084248}
[S7] START round=41 head_norm_before_train=1.720419 (no previous merge yet)
[S7] round=41 local utility u=0.531996 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0361968461002213, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0195227391220367, 'psi': 0.23968964488212474}
[S8] START round=41 head_norm_before_train=1.990512 cos_to_last_merge=0.9998 (last merge round=39)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7210328443470273, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.656396759637756, 'psi': 0.35939447907390915}
[S9] START round=41 head_norm_before_train=1.892784 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7498232768309134, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.731485351458702, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.075046 cos_to_last_merge=0.9972 (last merge round=26)
[S10] round=41 local utility u=0.003241 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.639019257574514, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.645500521801867, 'psi': 0.3324563501554652}
[S11] START round=41 head_norm_before_train=1.958763 cos_to_last_merge=0.9975 (last merge round=28)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.319550693177274, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.269039264294244, 'psi': 0.3319360347772085}
[S13] START round=41 head_norm_before_train=1.415390 cos_to_last_merge=0.9869 (last merge round=36)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6762834907871897, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.621491284349431, 'psi': 0.3599362944611573}
[S14] START round=41 head_norm_before_train=1.616618 cos_to_last_merge=0.9969 (last merge round=36)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.391520690357406, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.258067151539421, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.260018 (no previous merge yet)
[S15] round=41 local utility u=0.023485 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.676454618503837, 'psi': 0.6164734888353558}-{'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.7196643381247005, 'psi': 0.6160556042184989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=41 head_norm_before_train=1.901493 (no previous merge yet)
[S16] round=41 local utility u=0.115979 metrics={'f1_val': 0.19414423265867556, 'auprc': 0.19414423265867556, 'loss_val': 3.6363267921488296, 'psi': 0.19414423265867556}-{'f1_val': 0.18964491172386433, 'auprc': 0.18964491172386433, 'loss_val': 3.8277905795675657, 'psi': 0.18964491172386433}
[S16] not sending this round → trigger blocked (psi=0.194)
[S17] START round=41 head_norm_before_train=1.931965 cos_to_last_merge=0.9992 (last merge round=36)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.5915541989837374, 'auprc': 0.5915541989837374, 'loss_val': 1.4564884510407794, 'psi': 0.5915541989837374}-{'f1_val': 0.6064742965506638, 'auprc': 0.6064742965506638, 'loss_val': 1.3070950920447564, 'psi': 0.6064742965506638}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.360)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.3594 head_norm=2.027736
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.109542e-01
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.3594 head_norm=1.977319 delta_norm=0.110954
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=2.061798 cos_to_last_merge=0.9965 (last merge round=33)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4013955267915414, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3750182928933348, 'psi': 0.3674775928297055}
[S3] START round=42 head_norm_before_train=1.910921 cos_to_last_merge=0.9994 (last merge round=36)
[S3] round=42 local utility u=0.064801 metrics={'f1_val': 0.29743589743589743, 'auprc': 0.29743589743589743, 'loss_val': 2.992284297279605, 'psi': 0.29743589743589743}-{'f1_val': 0.291037823737656, 'auprc': 0.291037823737656, 'loss_val': 3.0643027913408023, 'psi': 0.291037823737656}
[S4] START round=42 head_norm_before_train=2.105595 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.2407814407814408, 'auprc': 0.2407814407814408, 'loss_val': 0.9597007654253744, 'psi': 0.24078144078144081}-{'f1_val': 0.2413560981580075, 'auprc': 0.2413560981580075, 'loss_val': 0.9553797017702611, 'psi': 0.2413560981580075}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.955483 cos_to_last_merge=0.9995 (last merge round=35)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6751269907889446, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6600297557812151, 'psi': 0.3335071121394324}
[S6] START round=42 head_norm_before_train=1.717945 cos_to_last_merge=0.9798 (last merge round=34)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.02327704244637152, 'auprc': 0.02327704244637152, 'loss_val': 5.456874660214101, 'psi': 0.02327704244637152}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 5.441302095341102, 'psi': 0.02240512117055327}
[S7] START round=42 head_norm_before_train=1.726143 (no previous merge yet)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.0581387971036176, 'psi': 0.23976608187134504}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0361968461002213, 'psi': 0.35976373724718097}
[S8] START round=42 head_norm_before_train=1.977319 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.002709 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7156152080095852, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7210328443470273, 'psi': 0.35939447907390915}
[S9] START round=42 head_norm_before_train=1.898445 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7669609372935398, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7498232768309134, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.084926 cos_to_last_merge=0.9969 (last merge round=26)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.6881079911682053, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.639019257574514, 'psi': 0.3324563501554652}
[S11] START round=42 head_norm_before_train=1.966172 cos_to_last_merge=0.9972 (last merge round=28)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3483471267642937, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.319550693177274, 'psi': 0.3319360347772085}
[S13] START round=42 head_norm_before_train=1.450533 cos_to_last_merge=0.9828 (last merge round=36)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7271732157886779, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6762834907871897, 'psi': 0.3599362944611573}
[S14] START round=42 head_norm_before_train=1.639781 cos_to_last_merge=0.9954 (last merge round=36)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.539765533598097, 'psi': 0.13582554517133957}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.391520690357406, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.269648 (no previous merge yet)
[S15] round=42 local utility u=0.004721 metrics={'f1_val': 0.6148100952273245, 'auprc': 0.6148100952273245, 'loss_val': 0.6520429137201184, 'psi': 0.6148100952273245}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.676454618503837, 'psi': 0.6164734888353558}
[S15] not sending this round → trigger blocked (psi=0.615)
[S16] START round=42 head_norm_before_train=1.907670 (no previous merge yet)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.19302737837305495, 'auprc': 0.19302737837305495, 'loss_val': 3.7794831416250587, 'psi': 0.19302737837305495}-{'f1_val': 0.19414423265867556, 'auprc': 0.19414423265867556, 'loss_val': 3.6363267921488296, 'psi': 0.19414423265867556}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.957854 cos_to_last_merge=0.9988 (last merge round=36)
[S17] round=42 local utility u=0.861373 metrics={'f1_val': 0.7338599987005681, 'auprc': 0.7338599987005681, 'loss_val': 1.0144939336244365, 'psi': 0.7338599987005681}-{'f1_val': 0.5915541989837374, 'auprc': 0.5915541989837374, 'loss_val': 1.4564884510407794, 'psi': 0.5915541989837374}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:39817
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9965
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.9965
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=42 metric=0.7339 head_norm=1.978160
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.558004e-02
[S17] stored merged vector for next round verification (round=42)
[S17] DEBUG after merge:  round=42 metric=0.7333 head_norm=1.994607 delta_norm=0.085580
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=42 metric=0.3594 head_norm=2.014559
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.558003e-02
[S8] stored merged vector for next round verification (round=42)
[S8] DEBUG after merge:  round=42 metric=0.3594 head_norm=1.994607 delta_norm=0.085580
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=2.072380 cos_to_last_merge=0.9960 (last merge round=33)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4291721214253656, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4013955267915414, 'psi': 0.3674775928297055}
[S3] START round=43 head_norm_before_train=1.921093 cos_to_last_merge=0.9992 (last merge round=36)
[S3] round=43 local utility u=0.004929 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.9851627688831, 'psi': 0.29773995791014735}-{'f1_val': 0.29743589743589743, 'auprc': 0.29743589743589743, 'loss_val': 2.992284297279605, 'psi': 0.29743589743589743}
[S4] START round=43 head_norm_before_train=2.117172 (no previous merge yet)
[S4] round=43 local utility u=0.004114 metrics={'f1_val': 0.24113475177304966, 'auprc': 0.24113475177304966, 'loss_val': 0.9546527952917259, 'psi': 0.24113475177304966}-{'f1_val': 0.2407814407814408, 'auprc': 0.2407814407814408, 'loss_val': 0.9597007654253744, 'psi': 0.24078144078144081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=43 head_norm_before_train=1.962143 cos_to_last_merge=0.9993 (last merge round=35)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6943604441951814, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6751269907889446, 'psi': 0.3335071121394324}
[S6] START round=43 head_norm_before_train=1.733505 cos_to_last_merge=0.9780 (last merge round=34)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.02327704244637152, 'auprc': 0.02327704244637152, 'loss_val': 5.560786448896813, 'psi': 0.02327704244637152}-{'f1_val': 0.02327704244637152, 'auprc': 0.02327704244637152, 'loss_val': 5.456874660214101, 'psi': 0.02327704244637152}
[S7] START round=43 head_norm_before_train=1.736146 (no previous merge yet)
[S7] round=43 local utility u=0.541963 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0541911899330902, 'psi': 0.35976373724718097}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.0581387971036176, 'psi': 0.23976608187134504}
[S8] START round=43 head_norm_before_train=1.994607 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7355121004500706, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7156152080095852, 'psi': 0.35939447907390915}
[S9] START round=43 head_norm_before_train=1.903875 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7823503380450934, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7669609372935398, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.095682 cos_to_last_merge=0.9966 (last merge round=26)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.742434656585636, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.6881079911682053, 'psi': 0.3324563501554652}
[S11] START round=43 head_norm_before_train=1.973260 cos_to_last_merge=0.9969 (last merge round=28)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.361430801293843, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3483471267642937, 'psi': 0.3319360347772085}
[S13] START round=43 head_norm_before_train=1.485089 cos_to_last_merge=0.9788 (last merge round=36)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7639399782761351, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7271732157886779, 'psi': 0.3599362944611573}
[S14] START round=43 head_norm_before_train=1.660234 cos_to_last_merge=0.9940 (last merge round=36)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.676097079416954, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.539765533598097, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=2.278981 (no previous merge yet)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7029508954496811, 'psi': 0.6164734888353558}-{'f1_val': 0.6148100952273245, 'auprc': 0.6148100952273245, 'loss_val': 0.6520429137201184, 'psi': 0.6148100952273245}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.913992 (no previous merge yet)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.14572501444251876, 'auprc': 0.14572501444251876, 'loss_val': 4.7684789456263506, 'psi': 0.14572501444251876}-{'f1_val': 0.19302737837305495, 'auprc': 0.19302737837305495, 'loss_val': 3.7794831416250587, 'psi': 0.19302737837305495}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.994607 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.39625141461058155, 'auprc': 0.39625141461058155, 'loss_val': 1.9107584998173812, 'psi': 0.39625141461058155}-{'f1_val': 0.7338599987005681, 'auprc': 0.7338599987005681, 'loss_val': 1.0144939336244365, 'psi': 0.7338599987005681}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.298)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=2.082434 cos_to_last_merge=0.9955 (last merge round=33)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4550977513334336, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4291721214253656, 'psi': 0.3674775928297055}
[S3] START round=44 head_norm_before_train=1.931010 cos_to_last_merge=0.9990 (last merge round=36)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.2940578504759264, 'auprc': 0.2940578504759264, 'loss_val': 3.1316621803492604, 'psi': 0.2940578504759264}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.9851627688831, 'psi': 0.29773995791014735}
[S4] START round=44 head_norm_before_train=2.132218 (no previous merge yet)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.24086967143031635, 'auprc': 0.24086967143031635, 'loss_val': 0.9605560309481331, 'psi': 0.24086967143031635}-{'f1_val': 0.24113475177304966, 'auprc': 0.24113475177304966, 'loss_val': 0.9546527952917259, 'psi': 0.24113475177304966}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.968557 cos_to_last_merge=0.9991 (last merge round=35)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.723400218587223, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6943604441951814, 'psi': 0.3335071121394324}
[S6] START round=44 head_norm_before_train=1.747139 cos_to_last_merge=0.9765 (last merge round=34)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 5.6780924311455205, 'psi': 0.02284148012791229}-{'f1_val': 0.02327704244637152, 'auprc': 0.02327704244637152, 'loss_val': 5.560786448896813, 'psi': 0.02327704244637152}
[S7] START round=44 head_norm_before_train=1.744925 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0746925891149217, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0541911899330902, 'psi': 0.35976373724718097}
[S8] START round=44 head_norm_before_train=2.033590 cos_to_last_merge=0.9998 (last merge round=42)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7850651562052526, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7355121004500706, 'psi': 0.35939447907390915}
[S9] START round=44 head_norm_before_train=1.909152 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.797519280264087, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7823503380450934, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.106700 cos_to_last_merge=0.9964 (last merge round=26)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.7791022303611856, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.742434656585636, 'psi': 0.3324563501554652}
[S11] START round=44 head_norm_before_train=1.980011 cos_to_last_merge=0.9967 (last merge round=28)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3748832302858385, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.361430801293843, 'psi': 0.3319360347772085}
[S13] START round=44 head_norm_before_train=1.514066 cos_to_last_merge=0.9758 (last merge round=36)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8316456489434951, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7639399782761351, 'psi': 0.3599362944611573}
[S14] START round=44 head_norm_before_train=1.678581 cos_to_last_merge=0.9926 (last merge round=36)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.757907136280557, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.676097079416954, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.286517 (no previous merge yet)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.7250173374293639, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7029508954496811, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.919714 (no previous merge yet)
[S16] round=44 local utility u=0.233796 metrics={'f1_val': 0.1596739054044557, 'auprc': 0.1596739054044557, 'loss_val': 4.426426737327829, 'psi': 0.1596739054044557}-{'f1_val': 0.14572501444251876, 'auprc': 0.14572501444251876, 'loss_val': 4.7684789456263506, 'psi': 0.14572501444251876}
[S16] not sending this round → trigger blocked (psi=0.160)
[S17] START round=44 head_norm_before_train=2.006696 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=44 local utility u=1.000000 metrics={'f1_val': 0.7491996148758131, 'auprc': 0.7491996148758131, 'loss_val': 0.8693548176367367, 'psi': 0.7491996148758131}-{'f1_val': 0.39625141461058155, 'auprc': 0.39625141461058155, 'loss_val': 1.9107584998173812, 'psi': 0.39625141461058155}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39809
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] cosine check vs S17: cos=0.9989
[S2] START round=45 head_norm_before_train=2.091882 cos_to_last_merge=0.9950 (last merge round=33)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4804946726221977, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4550977513334336, 'psi': 0.3674775928297055}
[S3] START round=45 head_norm_before_train=1.940436 cos_to_last_merge=0.9987 (last merge round=36)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.29457364341085274, 'auprc': 0.29457364341085274, 'loss_val': 3.1493369172888825, 'psi': 0.29457364341085274}-{'f1_val': 0.2940578504759264, 'auprc': 0.2940578504759264, 'loss_val': 3.1316621803492604, 'psi': 0.2940578504759264}
[S4] START round=45 head_norm_before_train=2.142077 (no previous merge yet)
[S4] round=45 local utility u=0.001263 metrics={'f1_val': 0.24091381100726894, 'auprc': 0.24091381100726894, 'loss_val': 0.9584274263658373, 'psi': 0.24091381100726894}-{'f1_val': 0.24086967143031635, 'auprc': 0.24086967143031635, 'loss_val': 0.9605560309481331, 'psi': 0.24086967143031635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=45 head_norm_before_train=1.979354 cos_to_last_merge=0.9989 (last merge round=35)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7529420239265274, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.723400218587223, 'psi': 0.3335071121394324}
[S6] START round=45 head_norm_before_train=1.759849 cos_to_last_merge=0.9751 (last merge round=34)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 5.747395912319306, 'psi': 0.02284148012791229}-{'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 5.6780924311455205, 'psi': 0.02284148012791229}
[S7] START round=45 head_norm_before_train=1.754951 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 1.0711333437941297, 'psi': 0.23930704898446833}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0746925891149217, 'psi': 0.35976373724718097}
[S8] START round=45 head_norm_before_train=2.071416 cos_to_last_merge=0.9992 (last merge round=42)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.831530708208951, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7850651562052526, 'psi': 0.35939447907390915}
[S9] START round=45 head_norm_before_train=1.914303 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.812104859606447, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.797519280264087, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.116861 cos_to_last_merge=0.9961 (last merge round=26)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.8178031109320663, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.7791022303611856, 'psi': 0.3324563501554652}
[S11] START round=45 head_norm_before_train=1.986338 cos_to_last_merge=0.9964 (last merge round=28)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3825566124643154, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3748832302858385, 'psi': 0.3319360347772085}
[S13] START round=45 head_norm_before_train=1.547815 cos_to_last_merge=0.9720 (last merge round=36)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8744961991924771, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8316456489434951, 'psi': 0.3599362944611573}
[S14] START round=45 head_norm_before_train=1.694552 cos_to_last_merge=0.9913 (last merge round=36)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 4.8258949972834735, 'psi': 0.13533083645443197}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.757907136280557, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.295583 (no previous merge yet)
[S15] round=45 local utility u=0.019819 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6853783709217033, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.7250173374293639, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=45 head_norm_before_train=1.924493 (no previous merge yet)
[S16] round=45 local utility u=0.625671 metrics={'f1_val': 0.19562520404831862, 'auprc': 0.19562520404831862, 'loss_val': 3.4986474121948166, 'psi': 0.19562520404831862}-{'f1_val': 0.1596739054044557, 'auprc': 0.1596739054044557, 'loss_val': 4.426426737327829, 'psi': 0.1596739054044557}
[S16] not sending this round → trigger blocked (psi=0.196)
[S17] START round=45 head_norm_before_train=2.011419 cos_to_last_merge=0.9999 (last merge round=42)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.3827033613397014, 'auprc': 0.3827033613397014, 'loss_val': 1.9197363792015931, 'psi': 0.3827033613397014}-{'f1_val': 0.7491996148758131, 'auprc': 0.7491996148758131, 'loss_val': 0.8693548176367367, 'psi': 0.7491996148758131}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=45 metric=0.3594 head_norm=2.104090
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.958220e-02
[S8] stored merged vector for next round verification (round=45)
[S8] DEBUG after merge:  round=45 metric=0.3594 head_norm=2.056737 delta_norm=0.079582
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.002 → S17@127.0.0.1:39817
[S11] ⇄ pheromone p=0.002 → S2@127.0.0.1:39802
[S17] ⇄ pheromone p=0.344 → S8@127.0.0.1:39809
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.023 → S11@127.0.0.1:39812
[S2] START round=46 head_norm_before_train=2.100659 cos_to_last_merge=0.9946 (last merge round=33)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5063618984837923, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4804946726221977, 'psi': 0.3674775928297055}
[S3] START round=46 head_norm_before_train=1.949270 cos_to_last_merge=0.9985 (last merge round=36)
[S3] round=46 local utility u=0.187914 metrics={'f1_val': 0.29743308669041746, 'auprc': 0.29743308669041746, 'loss_val': 2.799243784377297, 'psi': 0.29743308669041746}-{'f1_val': 0.29457364341085274, 'auprc': 0.29457364341085274, 'loss_val': 3.1493369172888825, 'psi': 0.29457364341085274}
[S4] START round=46 head_norm_before_train=2.149573 (no previous merge yet)
[S4] round=46 local utility u=0.516188 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9689721217796005, 'psi': 0.3567939207526687}-{'f1_val': 0.24091381100726894, 'auprc': 0.24091381100726894, 'loss_val': 0.9584274263658373, 'psi': 0.24091381100726894}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] START round=46 head_norm_before_train=1.988327 cos_to_last_merge=0.9987 (last merge round=35)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.770411585622715, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7529420239265274, 'psi': 0.3335071121394324}
[S6] START round=46 head_norm_before_train=1.771856 cos_to_last_merge=0.9737 (last merge round=34)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 5.80073985828343, 'psi': 0.023059360730593607}-{'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 5.747395912319306, 'psi': 0.02284148012791229}
[S7] START round=46 head_norm_before_train=1.762855 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.07818387370264, 'psi': 0.23968964488212474}-{'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 1.0711333437941297, 'psi': 0.23930704898446833}
[S8] START round=46 head_norm_before_train=2.056737 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=46 local utility u=0.006795 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8179415521888365, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.831530708208951, 'psi': 0.35939447907390915}
[S9] START round=46 head_norm_before_train=1.919343 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8274990499044796, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.812104859606447, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.127033 cos_to_last_merge=0.9959 (last merge round=26)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.853317062621091, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.8178031109320663, 'psi': 0.3324563501554652}
[S11] START round=46 head_norm_before_train=1.992427 cos_to_last_merge=0.9961 (last merge round=28)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.38479287965135, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3825566124643154, 'psi': 0.3319360347772085}
[S13] START round=46 head_norm_before_train=1.577486 cos_to_last_merge=0.9688 (last merge round=36)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9336835125393907, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8744961991924771, 'psi': 0.3599362944611573}
[S14] START round=46 head_norm_before_train=1.708952 cos_to_last_merge=0.9901 (last merge round=36)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 4.914292631261988, 'psi': 0.13413413413413414}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 4.8258949972834735, 'psi': 0.13533083645443197}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.305103 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.7229082936084391, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6853783709217033, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.929655 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.14013575651412305, 'auprc': 0.14013575651412305, 'loss_val': 4.819478570430194, 'psi': 0.14013575651412305}-{'f1_val': 0.19562520404831862, 'auprc': 0.19562520404831862, 'loss_val': 3.4986474121948166, 'psi': 0.19562520404831862}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.025361 cos_to_last_merge=0.9998 (last merge round=42)
[S17] round=46 local utility u=1.000000 metrics={'f1_val': 0.7622668761948712, 'auprc': 0.7622668761948712, 'loss_val': 0.8655904714382311, 'psi': 0.7622668761948712}-{'f1_val': 0.3827033613397014, 'auprc': 0.3827033613397014, 'loss_val': 1.9197363792015931, 'psi': 0.3827033613397014}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:39817
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.9986
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9986
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=46 metric=0.7623 head_norm=2.040338
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.985058e-02
[S17] stored merged vector for next round verification (round=46)
[S17] DEBUG after merge:  round=46 metric=0.7620 head_norm=2.063011 delta_norm=0.059851
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=46 metric=0.3594 head_norm=2.087155
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.985058e-02
[S8] stored merged vector for next round verification (round=46)
[S8] DEBUG after merge:  round=46 metric=0.3594 head_norm=2.063011 delta_norm=0.059851
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2]  timeout peer S6
[S3]  timeout peer S14
[S10]  timeout peer S5
[S7]  timeout peer S13
[S13]  timeout peer S10
[S5]  timeout peer S3
[S6]  timeout peer S7
[S2] START round=47 head_norm_before_train=2.109104 cos_to_last_merge=0.9941 (last merge round=33)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.532897512271179, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5063618984837923, 'psi': 0.3674775928297055}
[S3] START round=47 head_norm_before_train=1.957438 cos_to_last_merge=0.9983 (last merge round=36)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 3.0980845740158633, 'psi': 0.29773995791014735}-{'f1_val': 0.29743308669041746, 'auprc': 0.29743308669041746, 'loss_val': 2.799243784377297, 'psi': 0.29743308669041746}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.157294 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9700364945825184, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9689721217796005, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.996780 cos_to_last_merge=0.9984 (last merge round=35)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.794663564420921, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.770411585622715, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.783240 cos_to_last_merge=0.9724 (last merge round=34)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 5.894410599089599, 'psi': 0.02284148012791229}-{'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 5.80073985828343, 'psi': 0.023059360730593607}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.772373 (no previous merge yet)
[S7] round=47 local utility u=0.542692 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.073466453657861, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.07818387370264, 'psi': 0.23968964488212474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=47 head_norm_before_train=2.063011 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8285135483754755, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8179415521888365, 'psi': 0.35939447907390915}
[S9] START round=47 head_norm_before_train=1.924360 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8439003423383467, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8274990499044796, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.137706 cos_to_last_merge=0.9957 (last merge round=26)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.8870829402739724, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.853317062621091, 'psi': 0.3324563501554652}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.998487 cos_to_last_merge=0.9959 (last merge round=28)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3942468985492353, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.38479287965135, 'psi': 0.3319360347772085}
[S13] START round=47 head_norm_before_train=1.613013 cos_to_last_merge=0.9647 (last merge round=36)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9904554292156462, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9336835125393907, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.721781 cos_to_last_merge=0.9891 (last merge round=36)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.004162395680637, 'psi': 0.13413413413413414}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 4.914292631261988, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.313917 (no previous merge yet)
[S15] round=47 local utility u=0.008459 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.7059907854354551, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.7229082936084391, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=47 head_norm_before_train=1.935140 (no previous merge yet)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.018924033522573668, 'auprc': 0.018924033522573668, 'loss_val': 6.4379889538541, 'psi': 0.018924033522573668}-{'f1_val': 0.14013575651412305, 'auprc': 0.14013575651412305, 'loss_val': 4.819478570430194, 'psi': 0.14013575651412305}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.063011 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6011801543405189, 'auprc': 0.6011801543405189, 'loss_val': 1.4201872778563718, 'psi': 0.6011801543405189}-{'f1_val': 0.7622668761948712, 'auprc': 0.7622668761948712, 'loss_val': 0.8655904714382311, 'psi': 0.7622668761948712}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=2.117220 cos_to_last_merge=0.9937 (last merge round=33)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.55559154805988, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.532897512271179, 'psi': 0.3674775928297055}
[S3] START round=48 head_norm_before_train=1.964936 cos_to_last_merge=0.9980 (last merge round=36)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.2883947837508209, 'auprc': 0.2883947837508209, 'loss_val': 3.3202863959035196, 'psi': 0.2883947837508209}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 3.0980845740158633, 'psi': 0.29773995791014735}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.168802 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.979203600319966, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9700364945825184, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=2.007057 cos_to_last_merge=0.9981 (last merge round=35)
[S5] round=48 local utility u=0.002492 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7896801451069102, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.794663564420921, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=48 head_norm_before_train=1.793785 cos_to_last_merge=0.9712 (last merge round=34)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 5.94447696096996, 'psi': 0.02284148012791229}-{'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 5.894410599089599, 'psi': 0.02284148012791229}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.783181 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0532318712975366, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.073466453657861, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.093448 cos_to_last_merge=0.9999 (last merge round=46)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8717597205648882, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8285135483754755, 'psi': 0.35939447907390915}
[S9] START round=48 head_norm_before_train=1.929329 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8582355738699246, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8439003423383467, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.147451 cos_to_last_merge=0.9954 (last merge round=26)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.8987838987080963, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.8870829402739724, 'psi': 0.3324563501554652}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=2.004318 cos_to_last_merge=0.9956 (last merge round=28)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.4060069062999765, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3942468985492353, 'psi': 0.3319360347772085}
[S13] START round=48 head_norm_before_train=1.641437 cos_to_last_merge=0.9620 (last merge round=36)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0514977613160617, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9904554292156462, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.733456 cos_to_last_merge=0.9881 (last merge round=36)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.0815468564921975, 'psi': 0.1351317597102535}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.004162395680637, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.322048 (no previous merge yet)
[S15] round=48 local utility u=0.004493 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6970044761095207, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.7059907854354551, 'psi': 0.6163342951580373}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=48 head_norm_before_train=1.940640 (no previous merge yet)
[S16] round=48 local utility u=0.802177 metrics={'f1_val': 0.09069097888675624, 'auprc': 0.09069097888675624, 'loss_val': 5.479536801690501, 'psi': 0.09069097888675624}-{'f1_val': 0.018924033522573668, 'auprc': 0.018924033522573668, 'loss_val': 6.4379889538541, 'psi': 0.018924033522573668}
[S16] not sending this round → trigger blocked (psi=0.091)
[S17] START round=48 head_norm_before_train=2.076799 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=48 local utility u=0.885297 metrics={'f1_val': 0.7440744720399479, 'auprc': 0.7440744720399479, 'loss_val': 0.9356421940554003, 'psi': 0.7440744720399479}-{'f1_val': 0.6011801543405189, 'auprc': 0.6011801543405189, 'loss_val': 1.4201872778563718, 'psi': 0.6011801543405189}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=0.9994
[S2] START round=49 head_norm_before_train=2.124802 cos_to_last_merge=0.9932 (last merge round=33)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5761815031281916, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.55559154805988, 'psi': 0.3674775928297055}
[S3] START round=49 head_norm_before_train=1.972074 cos_to_last_merge=0.9978 (last merge round=36)
[S3] round=49 local utility u=0.401368 metrics={'f1_val': 0.2979327477597374, 'auprc': 0.2979327477597374, 'loss_val': 2.6033930519039536, 'psi': 0.2979327477597374}-{'f1_val': 0.2883947837508209, 'auprc': 0.2883947837508209, 'loss_val': 3.3202863959035196, 'psi': 0.2883947837508209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=49 head_norm_before_train=2.176618 (no previous merge yet)
[S4] round=49 local utility u=0.000262 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.978678800590846, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.979203600319966, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=49 head_norm_before_train=2.014239 cos_to_last_merge=0.9978 (last merge round=35)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.797485075447465, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7896801451069102, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.803584 cos_to_last_merge=0.9701 (last merge round=34)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 6.000469315522552, 'psi': 0.02284148012791229}-{'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 5.94447696096996, 'psi': 0.02284148012791229}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.788887 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0584508966426727, 'psi': 0.23968964488212474}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0532318712975366, 'psi': 0.23968964488212474}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.122880 cos_to_last_merge=0.9996 (last merge round=46)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9126163835064238, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8717597205648882, 'psi': 0.35939447907390915}
[S9] START round=49 head_norm_before_train=1.934094 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.870151539362006, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8582355738699246, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.154020 cos_to_last_merge=0.9950 (last merge round=26)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.921398391316682, 'psi': 0.3324563501554652}-{'f1_val': 0.3324563501554652, 'auprc': 0.3324563501554652, 'loss_val': 2.8987838987080963, 'psi': 0.3324563501554652}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.010008 cos_to_last_merge=0.9953 (last merge round=28)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.41793007346388, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.4060069062999765, 'psi': 0.3319360347772085}
[S13] START round=49 head_norm_before_train=1.677462 cos_to_last_merge=0.9583 (last merge round=36)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.098441792428346, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0514977613160617, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.744668 cos_to_last_merge=0.9872 (last merge round=36)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.154161332083829, 'psi': 0.13533083645443197}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.0815468564921975, 'psi': 0.1351317597102535}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.330353 (no previous merge yet)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.727663785829504, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6970044761095207, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.945610 (no previous merge yet)
[S16] round=49 local utility u=0.325041 metrics={'f1_val': 0.12768184196755625, 'auprc': 0.12768184196755625, 'loss_val': 5.16237351390568, 'psi': 0.12768184196755625}-{'f1_val': 0.09069097888675624, 'auprc': 0.09069097888675624, 'loss_val': 5.479536801690501, 'psi': 0.09069097888675624}
[S16] not sending this round → trigger blocked (psi=0.128)
[S17] START round=49 head_norm_before_train=2.087043 cos_to_last_merge=0.9999 (last merge round=46)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.5937042124787482, 'auprc': 0.5937042124787482, 'loss_val': 1.458177723725038, 'psi': 0.5937042124787482}-{'f1_val': 0.7440744720399479, 'auprc': 0.7440744720399479, 'loss_val': 0.9356421940554003, 'psi': 0.7440744720399479}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=49 metric=0.3594 head_norm=2.149630
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.901413e-02
[S8] stored merged vector for next round verification (round=49)
[S8] DEBUG after merge:  round=49 metric=0.3594 head_norm=2.117746 delta_norm=0.059014
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
