[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:44903
[S3] → join 127.0.0.1:44902
[S4] → join 127.0.0.1:44902
[S5] → join 127.0.0.1:44902
[S6] → join 127.0.0.1:44902
[S7] → join 127.0.0.1:44902
[S8] → join 127.0.0.1:44902
[S9] → join 127.0.0.1:44902
[S10] → join 127.0.0.1:44902
[S11] → join 127.0.0.1:44902
[S13] → join 127.0.0.1:44902
[S14] → join 127.0.0.1:44902
[S15] → join 127.0.0.1:44902
[S16] → join 127.0.0.1:44902
[S17] → join 127.0.0.1:44902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.143495 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.206713 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.155136 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.142226 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.129377 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.105428 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.133170 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.175820 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.174211 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.153988 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.134774 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.154904 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.125557 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.115516 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.148555 (no previous merge yet)
[S15]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S3] + discovered S10
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S9
[S3] + discovered S8
[S3] + discovered S16
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S4
[S3] + discovered S17
[S3] + discovered S11
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S10
[S4] + discovered S11
[S4] + discovered S17
[S4] + discovered S13
[S4] + discovered S5
[S4] + discovered S6
[S4] + discovered S15
[S4] + discovered S7
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S9
[S4] + discovered S14
[S5] + discovered S3
[S6] + discovered S3
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S4
[S5] + discovered S17
[S5] + discovered S13
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S7
[S5] + discovered S8
[S5] + discovered S14
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S3
[S7] + discovered S4
[S7] + discovered S2
[S6] + discovered S14
[S6] + discovered S16
[S6] + discovered S11
[S6] + discovered S9
[S6] + discovered S17
[S6] + discovered S8
[S6] + discovered S7
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S13
[S8] + discovered S2
[S8] + discovered S7
[S8] + discovered S3
[S8] + discovered S5
[S8] + discovered S4
[S8] + discovered S6
[S7] + discovered S15
[S7] + discovered S10
[S7] + discovered S11
[S7] + discovered S16
[S7] + discovered S13
[S7] + discovered S8
[S7] + discovered S17
[S7] + discovered S9
[S7] + discovered S14
[S8] + discovered S13
[S8] + discovered S16
[S8] + discovered S14
[S8] + discovered S17
[S8] + discovered S11
[S8] + discovered S10
[S8] + discovered S15
[S9] + discovered S8
[S9] + discovered S5
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S6
[S9] + discovered S4
[S9] + discovered S3
[S8] + discovered S9
[S10] + discovered S3
[S10] + discovered S4
[S10] + discovered S9
[S10] + discovered S6
[S10] + discovered S2
[S10] + discovered S5
[S10] + discovered S8
[S9] + discovered S10
[S9] + discovered S14
[S9] + discovered S16
[S9] + discovered S15
[S9] + discovered S11
[S9] + discovered S17
[S9] + discovered S13
[S10] + discovered S7
[S11] + discovered S3
[S11] + discovered S6
[S11] + discovered S5
[S11] + discovered S10
[S11] + discovered S8
[S11] + discovered S2
[S11] + discovered S9
[S11] + discovered S7
[S11] + discovered S4
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S11
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S13
[S11] + discovered S16
[S11] + discovered S17
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S8
[S13] + discovered S10
[S13] + discovered S5
[S13] + discovered S3
[S13] + discovered S7
[S13] + discovered S9
[S13] + discovered S2
[S13] + discovered S6
[S14] + discovered S13
[S14] + discovered S6
[S14] + discovered S9
[S14] + discovered S3
[S14] + discovered S8
[S14] + discovered S2
[S14] + discovered S7
[S14] + discovered S5
[S14] + discovered S10
[S14] + discovered S11
[S14] + discovered S4
[S13] + discovered S16
[S13] + discovered S14
[S13] + discovered S17
[S13] + discovered S15
[S14] + discovered S17
[S14] + discovered S15
[S14] + discovered S16
[S15] + discovered S6
[S15] + discovered S10
[S15] + discovered S7
[S15] + discovered S14
[S15] + discovered S9
[S15] + discovered S4
[S15] + discovered S11
[S15] + discovered S5
[S15] + discovered S2
[S15] + discovered S8
[S15] + discovered S3
[S15] + discovered S13
[S16] + discovered S13
[S16] + discovered S3
[S16] + discovered S8
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S4
[S16] + discovered S2
[S16] + discovered S11
[S16] + discovered S9
[S16] + discovered S7
[S16] + discovered S6
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S17
[S17] + discovered S3
[S17] + discovered S10
[S17] + discovered S9
[S17] + discovered S2
[S17] + discovered S15
[S17] + discovered S5
[S17] + discovered S13
[S17] + discovered S6
[S17] + discovered S7
[S17] + discovered S11
[S17] + discovered S4
[S17] + discovered S14
[S17] + discovered S16
[S17] + discovered S8
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:44911
[S10] ⇄ pheromone p=1.000 → S9@127.0.0.1:44910
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:44905
[S2] ⇄ pheromone p=1.000 → S15@127.0.0.1:44915
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:44912
[S8] ⇄ pheromone p=1.000 → S9@127.0.0.1:44910
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:44909
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:44902
[S11] ⇄ pheromone p=1.000 → S15@127.0.0.1:44915
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:44916
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:44916
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:44909
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:44914
[S7] ⇄ pheromone p=1.000 → S3@127.0.0.1:44903
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:44903
[S2] START round=1 head_norm_before_train=1.148710 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4950413946261274, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4235040587568244, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.220957 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7304514561957096, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.463420141331341, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.162182 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.33207468009230123, 'auprc': 0.33207468009230123, 'loss_val': 1.3403541159160115, 'psi': 0.33207468009230123}-{'f1_val': 0.9988614709603036, 'auprc': 0.9988614709603036, 'loss_val': 1.2968984824077363, 'psi': 0.9988614709603036}
[S5] START round=1 head_norm_before_train=1.161438 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6045677390150408, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4859244540481915, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.133458 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.566085608020162, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.45865949400935, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.124174 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.711451593828674, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4564406943266153, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.141209 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4924417674326271, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4641551272101652, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.193143 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8255368806680004, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.491617619690868, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.178801 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.454525991900786, 'psi': 0.0}-{'f1_val': 0.24041246668983896, 'auprc': 0.24041246668983896, 'loss_val': 1.4015051681531974, 'psi': 0.24041246668983896}
[S11] START round=1 head_norm_before_train=1.153742 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4874394822412988, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.419633047021249, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.141604 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.383009336613921, 'psi': 0.0}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3422609535665253, 'psi': 0.3599362944611573}
[S14] START round=1 head_norm_before_train=1.158562 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5778373501988512, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4900662359418548, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.135224 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4897096275268804, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4408379611522546, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.107287 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.474550517231084, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4034323507773192, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.144910 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5050907698422467, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4673215939824928, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.165755 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6397050277750964, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4950413946261274, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.270503 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.780700296931978, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7304514561957096, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.180063 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.3331228956228956, 'auprc': 0.3331228956228956, 'loss_val': 1.4133532993405, 'psi': 0.3331228956228956}-{'f1_val': 0.33207468009230123, 'auprc': 0.33207468009230123, 'loss_val': 1.3403541159160115, 'psi': 0.33207468009230123}
[S5] START round=2 head_norm_before_train=1.202713 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6934139973862146, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6045677390150408, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.148392 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7708418667967907, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.566085608020162, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.167684 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9493506582469668, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.711451593828674, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.156440 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5462948083629326, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4924417674326271, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.241115 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.744513411123266, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8255368806680004, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.194595 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5607191036479082, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.454525991900786, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.164524 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6022741188691507, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4874394822412988, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.157065 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4808574089259317, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.383009336613921, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.175706 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.746560868275313, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5778373501988512, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.155729 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6078774359806416, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4897096275268804, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.116426 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5879716422228063, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.474550517231084, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.153147 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5718362382932265, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5050907698422467, 'psi': 0.0}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.194861 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0817759425191125, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6397050277750964, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.334104 (no previous merge yet)
[S3] round=3 local utility u=0.079381 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.62193742190484, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.780700296931978, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.207383 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.32711282711282713, 'auprc': 0.32711282711282713, 'loss_val': 1.5699636196988576, 'psi': 0.32711282711282713}-{'f1_val': 0.3331228956228956, 'auprc': 0.3331228956228956, 'loss_val': 1.4133532993405, 'psi': 0.3331228956228956}
[S5] START round=3 head_norm_before_train=1.230685 (no previous merge yet)
[S5] round=3 local utility u=0.014953 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6635084403812386, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6934139973862146, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.176262 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2727669139855124, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7708418667967907, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.193845 (no previous merge yet)
[S7] round=3 local utility u=0.364778 metrics={'f1_val': 0.06035983749274521, 'auprc': 0.06035983749274521, 'loss_val': 1.7630331180298995, 'psi': 0.06035983749274522}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9493506582469668, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.180609 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.657325695546392, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5462948083629326, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.295586 (no previous merge yet)
[S9] round=3 local utility u=0.182436 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3796406267560806, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.744513411123266, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.218590 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.832776427548473, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5607191036479082, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.187142 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8849750874277262, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6022741188691507, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.181118 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7603354334902108, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4808574089259317, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.203218 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1630185584726016, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.746560868275313, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.183464 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.828275288100134, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6078774359806416, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.139250 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8310511992036245, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5879716422228063, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.174607 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.738378838673458, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5718362382932265, 'psi': 0.0}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.060)
[S9] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.234350 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0118228348949656, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0817759425191125, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.376143 (no previous merge yet)
[S3] round=4 local utility u=0.177165 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.267608200963609, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.62193742190484, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.240674 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.3332280812546048, 'auprc': 0.3332280812546048, 'loss_val': 1.630249615519242, 'psi': 0.3332280812546048}-{'f1_val': 0.32711282711282713, 'auprc': 0.32711282711282713, 'loss_val': 1.5699636196988576, 'psi': 0.32711282711282713}
[S5] START round=4 head_norm_before_train=1.253109 (no previous merge yet)
[S5] round=4 local utility u=0.976918 metrics={'f1_val': 0.19969685486926866, 'auprc': 0.19969685486926866, 'loss_val': 1.5069448368856264, 'psi': 0.19969685486926866}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6635084403812386, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.214823 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9198693602741264, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2727669139855124, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.200545 (no previous merge yet)
[S7] round=4 local utility u=1.000000 metrics={'f1_val': 0.30229043134519246, 'auprc': 0.30229043134519246, 'loss_val': 1.8681201370051288, 'psi': 0.30229043134519246}-{'f1_val': 0.06035983749274521, 'auprc': 0.06035983749274521, 'loss_val': 1.7630331180298995, 'psi': 0.06035983749274522}
[S8] START round=4 head_norm_before_train=1.210564 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7229419981886076, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.657325695546392, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.329618 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6845547121413915, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3796406267560806, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.246454 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.968872577241089, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.832776427548473, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.218959 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4661536500823167, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8849750874277262, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.210352 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.955447497702209, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7603354334902108, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.238468 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8982690940009928, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1630185584726016, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.209157 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9508251729384092, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.828275288100134, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.173452 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.378285624129854, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8310511992036245, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.206684 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9291554896362832, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.738378838673458, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:44903
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.200)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S7
[S3] cosine check vs S7: cos=0.0337
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.0000 head_norm=1.424184
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.246441e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.1683 head_norm=0.956029 delta_norm=0.924644
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.275118 (no previous merge yet)
[S2] round=5 local utility u=0.046192 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.919437937443626, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0118228348949656, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=0.956029 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.223508 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8205930470416753, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.267608200963609, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.265096 (no previous merge yet)
[S4] round=5 local utility u=0.083901 metrics={'f1_val': 0.33238845144356954, 'auprc': 0.33238845144356954, 'loss_val': 1.454891345326234, 'psi': 0.33238845144356954}-{'f1_val': 0.3332280812546048, 'auprc': 0.3332280812546048, 'loss_val': 1.630249615519242, 'psi': 0.3332280812546048}
[S5] START round=5 head_norm_before_train=1.275080 (no previous merge yet)
[S5] round=5 local utility u=0.660223 metrics={'f1_val': 0.3328060740272066, 'auprc': 0.3328060740272066, 'loss_val': 1.3844813083713727, 'psi': 0.3328060740272066}-{'f1_val': 0.19969685486926866, 'auprc': 0.19969685486926866, 'loss_val': 1.5069448368856264, 'psi': 0.19969685486926866}
[S6] START round=5 head_norm_before_train=1.248442 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.980831885217195, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9198693602741264, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.228665 (no previous merge yet)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.20609791849897388, 'auprc': 0.20609791849897388, 'loss_val': 1.5392383314212557, 'psi': 0.20609791849897388}-{'f1_val': 0.30229043134519246, 'auprc': 0.30229043134519246, 'loss_val': 1.8681201370051288, 'psi': 0.30229043134519246}
[S8] START round=5 head_norm_before_train=1.232668 (no previous merge yet)
[S8] round=5 local utility u=0.027498 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6679463257752734, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7229419981886076, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.381820 (no previous merge yet)
[S9] round=5 local utility u=0.206668 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2712195919304743, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6845547121413915, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.262864 (no previous merge yet)
[S10] round=5 local utility u=0.070315 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8282428155852926, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.968872577241089, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.251364 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7755791960427323, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4661536500823167, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.225389 (no previous merge yet)
[S13] round=5 local utility u=0.049886 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.855675171381369, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.955447497702209, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.271759 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.367861068776571, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8982690940009928, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.226290 (no previous merge yet)
[S15] round=5 local utility u=0.056950 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.836924693324896, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9508251729384092, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.211221 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.726004606707077, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.378285624129854, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.236137 (no previous merge yet)
[S17] round=5 local utility u=0.050787 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.827582268884896, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9291554896362832, 'psi': 0.0}
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44916
[S10] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:44912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=-0.0286
[S11] DROPPED delta from S4 (cos=-0.0286 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=-0.0272
[S16] DROPPED delta from S5 (cos=-0.0272 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S3] ⇄ pheromone p=0.411 → S2@127.0.0.1:44902
[S2] ⇄ pheromone p=0.337 → S15@127.0.0.1:44915
[S10] ⇄ pheromone p=0.342 → S9@127.0.0.1:44910
[S9] ⇄ pheromone p=0.392 → S16@127.0.0.1:44916
[S8] ⇄ pheromone p=0.333 → S9@127.0.0.1:44910
[S6] ⇄ pheromone p=0.328 → S8@127.0.0.1:44909
[S11] ⇄ pheromone p=0.328 → S15@127.0.0.1:44915
[S15] ⇄ pheromone p=0.339 → S5@127.0.0.1:44905
[S14] ⇄ pheromone p=0.328 → S8@127.0.0.1:44909
[S13] ⇄ pheromone p=0.338 → S10@127.0.0.1:44911
[S7] ⇄ pheromone p=0.534 → S3@127.0.0.1:44903
[S4] ⇄ pheromone p=0.344 → S11@127.0.0.1:44912
[S5] ⇄ pheromone p=0.618 → S16@127.0.0.1:44916
[S17] ⇄ pheromone p=0.338 → S3@127.0.0.1:44903
[S16] ⇄ pheromone p=0.328 → S14@127.0.0.1:44914
[S2] START round=6 head_norm_before_train=1.296239 (no previous merge yet)
[S2] round=6 local utility u=0.103057 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7133238514603133, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.919437937443626, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.025639 cos_to_last_merge=0.9926 (last merge round=4)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1249983708570324, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8205930470416753, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.281907 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.16102872324450793, 'auprc': 0.16102872324450793, 'loss_val': 1.3247999921677627, 'psi': 0.16102872324450793}-{'f1_val': 0.33238845144356954, 'auprc': 0.33238845144356954, 'loss_val': 1.454891345326234, 'psi': 0.33238845144356954}
[S5] START round=6 head_norm_before_train=1.304266 (no previous merge yet)
[S5] round=6 local utility u=1.000000 metrics={'f1_val': 0.6264819753956206, 'auprc': 0.6264819753956206, 'loss_val': 1.2819119903360792, 'psi': 0.6264819753956206}-{'f1_val': 0.3328060740272066, 'auprc': 0.3328060740272066, 'loss_val': 1.3844813083713727, 'psi': 0.3328060740272066}
[S6] START round=6 head_norm_before_train=1.269989 (no previous merge yet)
[S6] round=6 local utility u=0.111443 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7579457803209886, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.980831885217195, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.236975 (no previous merge yet)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.04344614659546917, 'auprc': 0.04344614659546917, 'loss_val': 1.4955147431234959, 'psi': 0.04344614659546917}-{'f1_val': 0.20609791849897388, 'auprc': 0.20609791849897388, 'loss_val': 1.5392383314212557, 'psi': 0.20609791849897388}
[S8] START round=6 head_norm_before_train=1.251172 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.28214062360403824, 'auprc': 0.28214062360403824, 'loss_val': 1.5261852897458654, 'psi': 0.28214062360403824}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6679463257752734, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.440597 (no previous merge yet)
[S9] round=6 local utility u=0.490466 metrics={'f1_val': 0.09881271543469936, 'auprc': 0.09881271543469936, 'loss_val': 2.179601482201808, 'psi': 0.09881271543469936}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2712195919304743, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.271618 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.010537698350583, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8282428155852926, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.276914 (no previous merge yet)
[S11] round=6 local utility u=0.131739 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5121008101010798, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7755791960427323, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.229522 (no previous merge yet)
[S13] round=6 local utility u=0.080287 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6951021326970657, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.855675171381369, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.296301 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.383652300175528, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.367861068776571, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.237252 (no previous merge yet)
[S15] round=6 local utility u=0.027862 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7812016615993158, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.836924693324896, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.235447 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7779668086268754, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.726004606707077, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.259349 (no previous merge yet)
[S17] round=6 local utility u=0.133079 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5614244403150914, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.827582268884896, 'psi': 0.0}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:44910
[S2] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.626)
[S6] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.099)
[S11] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S8
[S9] cosine check vs S8: cos=-0.1032
[S9] DROPPED delta from S8 (cos=-0.1032 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=7 head_norm_before_train=1.319786 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.151759917453993, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7133238514603133, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.109967 cos_to_last_merge=0.9750 (last merge round=4)
[S3] round=7 local utility u=0.467190 metrics={'f1_val': 0.10213243546576879, 'auprc': 0.10213243546576879, 'loss_val': 2.109810300595343, 'psi': 0.10213243546576879}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1249983708570324, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.301002 (no previous merge yet)
[S4] round=7 local utility u=0.913467 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2597518770497613, 'psi': 0.3567939207526687}-{'f1_val': 0.16102872324450793, 'auprc': 0.16102872324450793, 'loss_val': 1.3247999921677627, 'psi': 0.16102872324450793}
[S5] START round=7 head_norm_before_train=1.334647 (no previous merge yet)
[S5] round=7 local utility u=1.000000 metrics={'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 1.2095484660442852, 'psi': 1.0}-{'f1_val': 0.6264819753956206, 'auprc': 0.6264819753956206, 'loss_val': 1.2819119903360792, 'psi': 0.6264819753956206}
[S6] START round=7 head_norm_before_train=1.291615 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9653535923081993, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7579457803209886, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.263156 (no previous merge yet)
[S7] round=7 local utility u=0.189572 metrics={'f1_val': 0.07151413512218495, 'auprc': 0.07151413512218495, 'loss_val': 1.3689829336495287, 'psi': 0.07151413512218495}-{'f1_val': 0.04344614659546917, 'auprc': 0.04344614659546917, 'loss_val': 1.4955147431234959, 'psi': 0.04344614659546917}
[S8] START round=7 head_norm_before_train=1.264778 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.23212054391767734, 'auprc': 0.23212054391767734, 'loss_val': 1.4748458800281068, 'psi': 0.23212054391767734}-{'f1_val': 0.28214062360403824, 'auprc': 0.28214062360403824, 'loss_val': 1.5261852897458654, 'psi': 0.28214062360403824}
[S9] START round=7 head_norm_before_train=1.505034 (no previous merge yet)
[S9] round=7 local utility u=0.288381 metrics={'f1_val': 0.15260644647831278, 'auprc': 0.15260644647831278, 'loss_val': 2.086983320171487, 'psi': 0.15260644647831278}-{'f1_val': 0.09881271543469936, 'auprc': 0.09881271543469936, 'loss_val': 2.179601482201808, 'psi': 0.09881271543469936}
[S10] START round=7 head_norm_before_train=1.293935 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.137091120326701, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.010537698350583, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.297705 (no previous merge yet)
[S11] round=7 local utility u=0.101152 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.309796181535876, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5121008101010798, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.231177 (no previous merge yet)
[S13] round=7 local utility u=0.034697 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6257072298607982, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6951021326970657, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.313880 (no previous merge yet)
[S14] round=7 local utility u=0.039101 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3054509005231, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.383652300175528, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.255960 (no previous merge yet)
[S15] round=7 local utility u=0.046108 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6889854640255804, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7812016615993158, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.256490 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8655588619826444, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7779668086268754, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.279712 (no previous merge yet)
[S17] round=7 local utility u=1.000000 metrics={'f1_val': 0.21027817067421029, 'auprc': 0.21027817067421029, 'loss_val': 1.417528224409112, 'psi': 0.21027817067421029}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5614244403150914, 'psi': 0.0}
[S7] not sending this round → trigger blocked (psi=0.072)
[S3] not sending this round → trigger blocked (psi=0.102)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44916
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.153)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=-0.0364
[S11] DROPPED delta from S4 (cos=-0.0364 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=-0.0411
[S16] DROPPED delta from S5 (cos=-0.0411 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=-0.0645
[S3] DROPPED delta from S17 (cos=-0.0645 < 0.0)
[S2] START round=8 head_norm_before_train=1.351157 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2050012412838265, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.151759917453993, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.190427 cos_to_last_merge=0.9584 (last merge round=4)
[S3] round=8 local utility u=0.724097 metrics={'f1_val': 0.29772040648173576, 'auprc': 0.29772040648173576, 'loss_val': 2.421907813777682, 'psi': 0.29772040648173576}-{'f1_val': 0.10213243546576879, 'auprc': 0.10213243546576879, 'loss_val': 2.109810300595343, 'psi': 0.10213243546576879}
[S4] START round=8 head_norm_before_train=1.331739 (no previous merge yet)
[S4] round=8 local utility u=0.024239 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2112735528740832, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2597518770497613, 'psi': 0.3567939207526687}
[S5] START round=8 head_norm_before_train=1.378011 (no previous merge yet)
[S5] round=8 local utility u=0.018074 metrics={'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 1.1733994794642033, 'psi': 1.0}-{'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 1.2095484660442852, 'psi': 1.0}
[S6] START round=8 head_norm_before_train=1.324121 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2815217605367186, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9653535923081993, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.286740 (no previous merge yet)
[S7] round=8 local utility u=0.150698 metrics={'f1_val': 0.10193634542621856, 'auprc': 0.10193634542621856, 'loss_val': 1.3413870456359027, 'psi': 0.10193634542621856}-{'f1_val': 0.07151413512218495, 'auprc': 0.07151413512218495, 'loss_val': 1.3689829336495287, 'psi': 0.07151413512218495}
[S8] START round=8 head_norm_before_train=1.293097 (no previous merge yet)
[S8] round=8 local utility u=0.016878 metrics={'f1_val': 0.22735781137509, 'auprc': 0.22735781137509, 'loss_val': 1.3982259970788933, 'psi': 0.22735781137509}-{'f1_val': 0.23212054391767734, 'auprc': 0.23212054391767734, 'loss_val': 1.4748458800281068, 'psi': 0.23212054391767734}
[S9] START round=8 head_norm_before_train=1.571048 (no previous merge yet)
[S9] round=8 local utility u=0.973463 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0846450521726076, 'psi': 0.36867172340800847}-{'f1_val': 0.15260644647831278, 'auprc': 0.15260644647831278, 'loss_val': 2.086983320171487, 'psi': 0.15260644647831278}
[S10] START round=8 head_norm_before_train=1.315998 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.626308325179461, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.137091120326701, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.320915 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3154170155183147, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.309796181535876, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.239814 (no previous merge yet)
[S13] round=8 local utility u=0.001669 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.622369357088499, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6257072298607982, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.330076 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7139140003837694, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3054509005231, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.280481 (no previous merge yet)
[S15] round=8 local utility u=0.107607 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.473772228336775, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6889854640255804, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.284126 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.127151225398544, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8655588619826444, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.308360 (no previous merge yet)
[S17] round=8 local utility u=0.013741 metrics={'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 1.3249945686131916, 'psi': 0.20305027788548533}-{'f1_val': 0.21027817067421029, 'auprc': 0.21027817067421029, 'loss_val': 1.417528224409112, 'psi': 0.21027817067421029}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[S5] not sending this round → trigger blocked (psi=1.000)
[S4] not sending this round → trigger blocked (psi=0.357)
[S15] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.102)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[S3] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.0255
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=-0.0081
[S2] DROPPED delta from S3 (cos=-0.0081 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=-0.0960
[S9] DROPPED delta from S8 (cos=-0.0960 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.203)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.0000 head_norm=1.318335
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.035558e+00
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.061711 delta_norm=1.035558
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.383731 (no previous merge yet)
[S2] round=9 local utility u=0.019573 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.165855287086674, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2050012412838265, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.260571 cos_to_last_merge=0.9451 (last merge round=4)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=9 local utility u=0.071671 metrics={'f1_val': 0.29128895795562465, 'auprc': 0.29128895795562465, 'loss_val': 2.22068351920731, 'psi': 0.29128895795562465}-{'f1_val': 0.29772040648173576, 'auprc': 0.29772040648173576, 'loss_val': 2.421907813777682, 'psi': 0.29772040648173576}
[S4] START round=9 head_norm_before_train=1.363374 (no previous merge yet)
[S4] round=9 local utility u=0.011587 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1880986584424806, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2112735528740832, 'psi': 0.3567939207526687}
[S5] START round=9 head_norm_before_train=1.422056 (no previous merge yet)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.5476717994079695, 'auprc': 0.5476717994079695, 'loss_val': 1.1309094675165148, 'psi': 0.5476717994079695}-{'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 1.1733994794642033, 'psi': 1.0}
[S6] START round=9 head_norm_before_train=1.361749 (no previous merge yet)
[S6] round=9 local utility u=0.059981 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.161559076753351, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2815217605367186, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.318059 (no previous merge yet)
[S7] round=9 local utility u=0.294346 metrics={'f1_val': 0.1641025641025641, 'auprc': 0.1641025641025641, 'loss_val': 1.3121918096828287, 'psi': 0.1641025641025641}-{'f1_val': 0.10193634542621856, 'auprc': 0.10193634542621856, 'loss_val': 1.3413870456359027, 'psi': 0.10193634542621856}
[S8] START round=9 head_norm_before_train=1.326232 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.20616268442355398, 'auprc': 0.20616268442355398, 'loss_val': 1.3180722516336991, 'psi': 0.20616268442355398}-{'f1_val': 0.22735781137509, 'auprc': 0.22735781137509, 'loss_val': 1.3982259970788933, 'psi': 0.22735781137509}
[S9] START round=9 head_norm_before_train=1.631322 (no previous merge yet)
[S9] round=9 local utility u=0.006688 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0712691268864845, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0846450521726076, 'psi': 0.36867172340800847}
[S10] START round=9 head_norm_before_train=1.344542 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.878907340105834, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.626308325179461, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.349403 (no previous merge yet)
[S11] round=9 local utility u=0.265738 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7839411516110684, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3154170155183147, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.256975 (no previous merge yet)
[S13] round=9 local utility u=0.067372 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.487625939782448, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.622369357088499, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.353334 (no previous merge yet)
[S14] round=9 local utility u=0.120517 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.472879322460811, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7139140003837694, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.309549 (no previous merge yet)
[S15] round=9 local utility u=0.619852 metrics={'f1_val': 0.12544696066746128, 'auprc': 0.12544696066746128, 'loss_val': 1.3630916312222776, 'psi': 0.12544696066746128}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.473772228336775, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.061711 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.317648 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.491854684078276, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.127151225398544, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.341466 (no previous merge yet)
[S17] round=9 local utility u=0.033807 metrics={'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 1.256318621761539, 'psi': 0.20293224827229864}-{'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 1.3249945686131916, 'psi': 0.20305027788548533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:44912
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.291)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.164)
[S14] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.125)
[S9] not sending this round → trigger blocked (psi=0.369)
[S6] not sending this round → trigger blocked (psi=0.000)
[S4] sending update (kind=head size=1806 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1806) from S4
[S11] cosine check vs S4: cos=-0.0414
[S11] DROPPED delta from S4 (cos=-0.0414 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=-0.0764
[S3] DROPPED delta from S17 (cos=-0.0764 < 0.0)
[S2] START round=10 head_norm_before_train=1.419432 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4460704109698583, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.165855287086674, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.319422 cos_to_last_merge=0.9345 (last merge round=4)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.879210056010441, 'psi': 0.29773995791014735}-{'f1_val': 0.29128895795562465, 'auprc': 0.29128895795562465, 'loss_val': 2.22068351920731, 'psi': 0.29128895795562465}
[S4] START round=10 head_norm_before_train=1.396491 (no previous merge yet)
[S4] round=10 local utility u=0.003870 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1803585854920524, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1880986584424806, 'psi': 0.3567939207526687}
[S5] START round=10 head_norm_before_train=1.462867 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.25276482846867215, 'auprc': 0.25276482846867215, 'loss_val': 1.2030506195892927, 'psi': 0.25276482846867215}-{'f1_val': 0.5476717994079695, 'auprc': 0.5476717994079695, 'loss_val': 1.1309094675165148, 'psi': 0.5476717994079695}
[S6] START round=10 head_norm_before_train=1.396576 (no previous merge yet)
[S6] round=10 local utility u=0.295370 metrics={'f1_val': 0.03287119856887299, 'auprc': 0.03287119856887299, 'loss_val': 2.866659993833054, 'psi': 0.03287119856887299}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.161559076753351, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.346581 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.12482011664015753, 'auprc': 0.12482011664015753, 'loss_val': 1.3291375568192987, 'psi': 0.12482011664015753}-{'f1_val': 0.1641025641025641, 'auprc': 0.1641025641025641, 'loss_val': 1.3121918096828287, 'psi': 0.1641025641025641}
[S8] START round=10 head_norm_before_train=1.361983 (no previous merge yet)
[S8] round=10 local utility u=0.010778 metrics={'f1_val': 0.2043616126318514, 'auprc': 0.2043616126318514, 'loss_val': 1.2803073925901696, 'psi': 0.2043616126318514}-{'f1_val': 0.20616268442355398, 'auprc': 0.20616268442355398, 'loss_val': 1.3180722516336991, 'psi': 0.20616268442355398}
[S9] START round=10 head_norm_before_train=1.681483 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2532304081929793, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0712691268864845, 'psi': 0.36867172340800847}
[S10] START round=10 head_norm_before_train=1.374351 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.151642162377472, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.878907340105834, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.381396 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9045504854865458, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7839411516110684, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.270040 (no previous merge yet)
[S13] round=10 local utility u=0.094839 metrics={'f1_val': 0.009052699644358229, 'auprc': 0.009052699644358229, 'loss_val': 1.3794225283912624, 'psi': 0.009052699644358229}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.487625939782448, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.373196 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.18197660851968, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.472879322460811, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.343532 (no previous merge yet)
[S15] round=10 local utility u=0.626062 metrics={'f1_val': 0.2554667957718067, 'auprc': 0.2554667957718067, 'loss_val': 1.2811451797520965, 'psi': 0.2554667957718067}-{'f1_val': 0.12544696066746128, 'auprc': 0.12544696066746128, 'loss_val': 1.3630916312222776, 'psi': 0.12544696066746128}
[S16] START round=10 head_norm_before_train=1.092236 cos_to_last_merge=0.9979 (last merge round=8)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.561342070740249, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.491854684078276, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.372902 (no previous merge yet)
[S17] round=10 local utility u=0.019131 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.2184107495452816, 'psi': 0.20297157622739018}-{'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 1.256318621761539, 'psi': 0.20293224827229864}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.009)
[S4] not sending this round → trigger blocked (psi=0.357)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.033)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44910
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:44905
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S8
[S9] cosine check vs S8: cos=-0.0979
[S9] DROPPED delta from S8 (cos=-0.0979 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] cosine check vs S15: cos=0.0178
[S17] not sending this round → trigger blocked (psi=0.203)
[S13] ⇄ pheromone p=0.151 → S10@127.0.0.1:44911
[S2] ⇄ pheromone p=0.122 → S15@127.0.0.1:44915
[S4] ⇄ pheromone p=0.212 → S11@127.0.0.1:44912
[S10] ⇄ pheromone p=0.112 → S9@127.0.0.1:44910
[S14] ⇄ pheromone p=0.131 → S8@127.0.0.1:44909
[S7] ⇄ pheromone p=0.261 → S3@127.0.0.1:44903
[S9] ⇄ pheromone p=0.324 → S16@127.0.0.1:44916
[S3] ⇄ pheromone p=0.287 → S2@127.0.0.1:44902
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.2528 head_norm=1.505724
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.010814e+00
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.0021 head_norm=1.028930 delta_norm=1.010814
[S5] aggregate: ROLLBACK (f1_val pre=0.253 post=0.002 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.389 → S16@127.0.0.1:44916
[S11] ⇄ pheromone p=0.171 → S15@127.0.0.1:44915
[S6] ⇄ pheromone p=0.185 → S8@127.0.0.1:44909
[S8] ⇄ pheromone p=0.195 → S9@127.0.0.1:44910
[S15] ⇄ pheromone p=0.356 → S5@127.0.0.1:44905
[S17] ⇄ pheromone p=0.235 → S3@127.0.0.1:44903
[S16] ⇄ pheromone p=0.158 → S14@127.0.0.1:44914
[S2] START round=11 head_norm_before_train=1.449918 (no previous merge yet)
[S2] round=11 local utility u=0.134210 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.177650917539711, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4460704109698583, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.367553 cos_to_last_merge=0.9260 (last merge round=4)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=11 local utility u=0.025704 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.8278030022697056, 'psi': 0.29773995791014735}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.879210056010441, 'psi': 0.29773995791014735}
[S4] START round=11 head_norm_before_train=1.429991 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1865529254753695, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1803585854920524, 'psi': 0.3567939207526687}
[S5] START round=11 head_norm_before_train=1.028930 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.0007388935069733075, 'auprc': 0.0007388935069733075, 'loss_val': 2.0107779688452108, 'psi': 0.0007388935069733075}-{'f1_val': 0.25276482846867215, 'auprc': 0.25276482846867215, 'loss_val': 1.2030506195892927, 'psi': 0.25276482846867215}
[S6] START round=11 head_norm_before_train=1.429548 (no previous merge yet)
[S6] round=11 local utility u=0.040065 metrics={'f1_val': 0.06785270997103848, 'auprc': 0.06785270997103848, 'loss_val': 3.1013645148934463, 'psi': 0.06785270997103848}-{'f1_val': 0.03287119856887299, 'auprc': 0.03287119856887299, 'loss_val': 2.866659993833054, 'psi': 0.03287119856887299}
[S7] START round=11 head_norm_before_train=1.380518 (no previous merge yet)
[S7] round=11 local utility u=0.478632 metrics={'f1_val': 0.22387275864656012, 'auprc': 0.22387275864656012, 'loss_val': 1.2633468387742373, 'psi': 0.22387275864656012}-{'f1_val': 0.12482011664015753, 'auprc': 0.12482011664015753, 'loss_val': 1.3291375568192987, 'psi': 0.12482011664015753}
[S8] START round=11 head_norm_before_train=1.395738 (no previous merge yet)
[S8] round=11 local utility u=0.005268 metrics={'f1_val': 0.20579993483219292, 'auprc': 0.20579993483219292, 'loss_val': 1.2827155436007722, 'psi': 0.20579993483219292}-{'f1_val': 0.2043616126318514, 'auprc': 0.2043616126318514, 'loss_val': 1.2803073925901696, 'psi': 0.2043616126318514}
[S9] START round=11 head_norm_before_train=1.722736 (no previous merge yet)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.421760860835532, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2532304081929793, 'psi': 0.36867172340800847}
[S10] START round=11 head_norm_before_train=1.405832 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3501545125734915, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.151642162377472, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.419859 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9478932947352126, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9045504854865458, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.281867 (no previous merge yet)
[S13] round=11 local utility u=1.000000 metrics={'f1_val': 0.23107399079130528, 'auprc': 0.23107399079130528, 'loss_val': 1.3231365253727045, 'psi': 0.23107399079130528}-{'f1_val': 0.009052699644358229, 'auprc': 0.009052699644358229, 'loss_val': 1.3794225283912624, 'psi': 0.009052699644358229}
[S14] START round=11 head_norm_before_train=1.395240 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.4708158916832375, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.18197660851968, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.376110 (no previous merge yet)
[S15] round=11 local utility u=0.212020 metrics={'f1_val': 0.3002370791844476, 'auprc': 0.3002370791844476, 'loss_val': 1.2600369743188091, 'psi': 0.3002370791844476}-{'f1_val': 0.2554667957718067, 'auprc': 0.2554667957718067, 'loss_val': 1.2811451797520965, 'psi': 0.2554667957718067}
[S16] START round=11 head_norm_before_train=1.130446 cos_to_last_merge=0.9912 (last merge round=8)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6422185266960394, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.561342070740249, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.401847 (no previous merge yet)
[S17] round=11 local utility u=0.018777 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 1.180148863685313, 'psi': 0.20289293555469456}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.2184107495452816, 'psi': 0.20297157622739018}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.068)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:44902
[S8] not sending this round → trigger blocked (psi=0.206)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.300)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=-0.0096
[S2] DROPPED delta from S3 (cos=-0.0096 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=-0.0607
[S10] DROPPED delta from S13 (cos=-0.0607 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] cosine check vs S7: cos=0.4911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=-0.0836
[S3] DROPPED delta from S17 (cos=-0.0836 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.2977 head_norm=1.409576
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.121702e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.2974 head_norm=1.219085 delta_norm=0.712170
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.476688 (no previous merge yet)
[S2] round=12 local utility u=0.261536 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.654579343830184, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.177650917539711, 'psi': 0.0}
[S3] START round=12 head_norm_before_train=1.219085 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.347388 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.133027731945566, 'psi': 0.29773995791014735}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.8278030022697056, 'psi': 0.29773995791014735}
[S4] START round=12 head_norm_before_train=1.463727 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.24172932330827068, 'auprc': 0.24172932330827068, 'loss_val': 1.1966973837292372, 'psi': 0.24172932330827068}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1865529254753695, 'psi': 0.3567939207526687}
[S5] START round=12 head_norm_before_train=1.089726 cos_to_last_merge=0.9960 (last merge round=10)
[S5] round=12 local utility u=1.000000 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 2.561948812005261, 'psi': 0.33451196111837667}-{'f1_val': 0.0007388935069733075, 'auprc': 0.0007388935069733075, 'loss_val': 2.0107779688452108, 'psi': 0.0007388935069733075}
[S6] START round=12 head_norm_before_train=1.463423 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.06002527379949452, 'auprc': 0.06002527379949452, 'loss_val': 3.557068121726652, 'psi': 0.06002527379949452}-{'f1_val': 0.06785270997103848, 'auprc': 0.06785270997103848, 'loss_val': 3.1013645148934463, 'psi': 0.06785270997103848}
[S7] START round=12 head_norm_before_train=1.414144 (no previous merge yet)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.1731307907778496, 'auprc': 0.1731307907778496, 'loss_val': 1.2628848542785003, 'psi': 0.1731307907778496}-{'f1_val': 0.22387275864656012, 'auprc': 0.22387275864656012, 'loss_val': 1.2633468387742373, 'psi': 0.22387275864656012}
[S8] START round=12 head_norm_before_train=1.426588 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.15468260188087773, 'auprc': 0.15468260188087773, 'loss_val': 1.2163360780068466, 'psi': 0.15468260188087773}-{'f1_val': 0.20579993483219292, 'auprc': 0.20579993483219292, 'loss_val': 1.2827155436007722, 'psi': 0.20579993483219292}
[S9] START round=12 head_norm_before_train=1.754951 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.474854544471614, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.421760860835532, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=1.433926 (no previous merge yet)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.518020644651465, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3501545125734915, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.455662 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6535673901363332, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9478932947352126, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.300863 (no previous merge yet)
[S13] round=12 local utility u=0.379597 metrics={'f1_val': 0.3045838896306186, 'auprc': 0.3045838896306186, 'loss_val': 1.2255315846851047, 'psi': 0.3045838896306186}-{'f1_val': 0.23107399079130528, 'auprc': 0.23107399079130528, 'loss_val': 1.3231365253727045, 'psi': 0.23107399079130528}
[S14] START round=12 head_norm_before_train=1.416803 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.948279025742934, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.4708158916832375, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.408865 (no previous merge yet)
[S15] round=12 local utility u=0.154410 metrics={'f1_val': 0.33301777637530244, 'auprc': 0.33301777637530244, 'loss_val': 1.2462423487935408, 'psi': 0.33301777637530244}-{'f1_val': 0.3002370791844476, 'auprc': 0.3002370791844476, 'loss_val': 1.2600369743188091, 'psi': 0.3002370791844476}
[S16] START round=12 head_norm_before_train=1.169594 cos_to_last_merge=0.9805 (last merge round=8)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7992269333802398, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6422185266960394, 'psi': 0.0}
[S17] START round=12 head_norm_before_train=1.423779 (no previous merge yet)
[S17] round=12 local utility u=0.001064 metrics={'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 1.1783755943798015, 'psi': 0.20293224827229864}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 1.180148863685313, 'psi': 0.20289293555469456}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.298)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44905
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.305)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:44916
[S2] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=-0.1267
[S16] DROPPED delta from S5 (cos=-0.1267 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.6177
[S17] not sending this round → trigger blocked (psi=0.203)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.3345 head_norm=1.166469
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.829211e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.0013 head_norm=1.173641 delta_norm=0.582921
[S5] aggregate: ROLLBACK (f1_val pre=0.335 post=0.001 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.505411 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.750711491227082, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.654579343830184, 'psi': 0.0}
[S3] START round=13 head_norm_before_train=1.276588 cos_to_last_merge=0.9977 (last merge round=11)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.29751461988304095, 'auprc': 0.29751461988304095, 'loss_val': 2.2436008738900752, 'psi': 0.29751461988304095}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.133027731945566, 'psi': 0.29773995791014735}
[S4] START round=13 head_norm_before_train=1.501447 (no previous merge yet)
[S4] round=13 local utility u=0.020052 metrics={'f1_val': 0.24472573839662448, 'auprc': 0.24472573839662448, 'loss_val': 1.1835620369733313, 'psi': 0.24472573839662448}-{'f1_val': 0.24172932330827068, 'auprc': 0.24172932330827068, 'loss_val': 1.1966973837292372, 'psi': 0.24172932330827068}
[S5] START round=13 head_norm_before_train=1.173641 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.19895864582619768, 'auprc': 0.19895864582619768, 'loss_val': 2.4421863829028454, 'psi': 0.19895864582619768}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 2.561948812005261, 'psi': 0.33451196111837667}
[S6] START round=13 head_norm_before_train=1.494545 (no previous merge yet)
[S6] round=13 local utility u=0.400386 metrics={'f1_val': 0.13870632998962296, 'auprc': 0.13870632998962296, 'loss_val': 3.46442533711311, 'psi': 0.13870632998962296}-{'f1_val': 0.06002527379949452, 'auprc': 0.06002527379949452, 'loss_val': 3.557068121726652, 'psi': 0.06002527379949452}
[S7] START round=13 head_norm_before_train=1.439599 (no previous merge yet)
[S7] round=13 local utility u=0.337591 metrics={'f1_val': 0.2383056133056133, 'auprc': 0.2383056133056133, 'loss_val': 1.1742770507575155, 'psi': 0.23830561330561328}-{'f1_val': 0.1731307907778496, 'auprc': 0.1731307907778496, 'loss_val': 1.2628848542785003, 'psi': 0.1731307907778496}
[S8] START round=13 head_norm_before_train=1.451073 (no previous merge yet)
[S8] round=13 local utility u=0.123223 metrics={'f1_val': 0.17136401088994146, 'auprc': 0.17136401088994146, 'loss_val': 1.1200221414124276, 'psi': 0.17136401088994146}-{'f1_val': 0.15468260188087773, 'auprc': 0.15468260188087773, 'loss_val': 1.2163360780068466, 'psi': 0.15468260188087773}
[S9] START round=13 head_norm_before_train=1.780872 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.528021926107149, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.474854544471614, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=1.458643 (no previous merge yet)
[S10] round=13 local utility u=0.002803 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5124140670712607, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.518020644651465, 'psi': 0.0}
[S11] START round=13 head_norm_before_train=1.486542 (no previous merge yet)
[S11] round=13 local utility u=0.165866 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.321836280683173, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6535673901363332, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.320381 (no previous merge yet)
[S13] round=13 local utility u=1.000000 metrics={'f1_val': 0.6440928510494269, 'auprc': 0.6440928510494269, 'loss_val': 1.1727185154032336, 'psi': 0.6440928510494269}-{'f1_val': 0.3045838896306186, 'auprc': 0.3045838896306186, 'loss_val': 1.2255315846851047, 'psi': 0.3045838896306186}
[S14] START round=13 head_norm_before_train=1.444927 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.3497134023405, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.948279025742934, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.440073 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.33301717778480344, 'auprc': 0.33301717778480344, 'loss_val': 1.2788906015459491, 'psi': 0.33301717778480344}-{'f1_val': 0.33301777637530244, 'auprc': 0.33301777637530244, 'loss_val': 1.2462423487935408, 'psi': 0.33301777637530244}
[S16] START round=13 head_norm_before_train=1.210696 cos_to_last_merge=0.9681 (last merge round=8)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9958689350816705, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7992269333802398, 'psi': 0.0}
[S17] START round=13 head_norm_before_train=1.438539 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.1866659536759518, 'psi': 0.15231723870467326}-{'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 1.1783755943798015, 'psi': 0.20293224827229864}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:44911
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44910
[S6] not sending this round → trigger blocked (psi=0.139)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:44903
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:44912
[S4] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=-0.0584
[S10] DROPPED delta from S13 (cos=-0.0584 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1805) from S4
[S11] cosine check vs S4: cos=-0.0581
[S11] DROPPED delta from S4 (cos=-0.0581 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] cosine check vs S7: cos=0.8005
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S8
[S9] cosine check vs S8: cos=-0.0979
[S9] DROPPED delta from S8 (cos=-0.0979 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.2975 head_norm=1.345918
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.472954e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.2960 head_norm=1.333171 delta_norm=0.447295
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.533298 (no previous merge yet)
[S2] round=14 local utility u=0.901171 metrics={'f1_val': 0.19020514644847622, 'auprc': 0.19020514644847622, 'loss_val': 2.6602166745078333, 'psi': 0.19020514644847622}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.750711491227082, 'psi': 0.0}
[S3] START round=14 head_norm_before_train=1.333171 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.015073 metrics={'f1_val': 0.28711286830462207, 'auprc': 0.28711286830462207, 'loss_val': 2.119838335794479, 'psi': 0.28711286830462207}-{'f1_val': 0.29751461988304095, 'auprc': 0.29751461988304095, 'loss_val': 2.2436008738900752, 'psi': 0.29751461988304095}
[S4] START round=14 head_norm_before_train=1.537268 (no previous merge yet)
[S4] round=14 local utility u=0.511796 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1685841580417156, 'psi': 0.3567939207526687}-{'f1_val': 0.24472573839662448, 'auprc': 0.24472573839662448, 'loss_val': 1.1835620369733313, 'psi': 0.24472573839662448}
[S5] START round=14 head_norm_before_train=1.246697 cos_to_last_merge=0.9929 (last merge round=12)
[S5] round=14 local utility u=0.442165 metrics={'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.774057240132307, 'psi': 0.33409214683912186}-{'f1_val': 0.19895864582619768, 'auprc': 0.19895864582619768, 'loss_val': 2.4421863829028454, 'psi': 0.19895864582619768}
[S6] START round=14 head_norm_before_train=1.521721 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.07900040306328093, 'auprc': 0.07900040306328093, 'loss_val': 4.326075141702805, 'psi': 0.07900040306328093}-{'f1_val': 0.13870632998962296, 'auprc': 0.13870632998962296, 'loss_val': 3.46442533711311, 'psi': 0.13870632998962296}
[S7] START round=14 head_norm_before_train=1.464015 (no previous merge yet)
[S7] round=14 local utility u=0.470599 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0860922152305925, 'psi': 0.33308476261496395}-{'f1_val': 0.2383056133056133, 'auprc': 0.2383056133056133, 'loss_val': 1.1742770507575155, 'psi': 0.23830561330561328}
[S8] START round=14 head_norm_before_train=1.476470 (no previous merge yet)
[S8] round=14 local utility u=0.629195 metrics={'f1_val': 0.2991041310366262, 'auprc': 0.2991041310366262, 'loss_val': 1.0112940842527152, 'psi': 0.2991041310366262}-{'f1_val': 0.17136401088994146, 'auprc': 0.17136401088994146, 'loss_val': 1.1200221414124276, 'psi': 0.17136401088994146}
[S9] START round=14 head_norm_before_train=1.802669 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.586770458375888, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.528021926107149, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.481262 (no previous merge yet)
[S10] round=14 local utility u=0.031838 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.448738069657577, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5124140670712607, 'psi': 0.0}
[S11] START round=14 head_norm_before_train=1.508468 (no previous merge yet)
[S11] round=14 local utility u=1.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 1.953194417745305, 'psi': 0.3317042898145993}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.321836280683173, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.340860 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.25430061906375023, 'auprc': 0.25430061906375023, 'loss_val': 1.110771638884372, 'psi': 0.25430061906375023}-{'f1_val': 0.6440928510494269, 'auprc': 0.6440928510494269, 'loss_val': 1.1727185154032336, 'psi': 0.6440928510494269}
[S14] START round=14 head_norm_before_train=1.475896 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.53113473576198, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.3497134023405, 'psi': 0.0}
[S15] START round=14 head_norm_before_train=1.467560 (no previous merge yet)
[S15] round=14 local utility u=0.014066 metrics={'f1_val': 0.3329116592873709, 'auprc': 0.3329116592873709, 'loss_val': 1.249809804792304, 'psi': 0.3329116592873709}-{'f1_val': 0.33301717778480344, 'auprc': 0.33301717778480344, 'loss_val': 1.2788906015459491, 'psi': 0.33301717778480344}
[S16] START round=14 head_norm_before_train=1.249906 cos_to_last_merge=0.9572 (last merge round=8)
[S16] round=14 local utility u=0.107132 metrics={'f1_val': 0.00023299161230195712, 'auprc': 0.00023299161230195712, 'loss_val': 2.783702447196814, 'psi': 0.00023299161230195712}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9958689350816705, 'psi': 0.0}
[S17] START round=14 head_norm_before_train=1.456415 (no previous merge yet)
[S17] round=14 local utility u=0.011220 metrics={'f1_val': 0.15219918620422399, 'auprc': 0.15219918620422399, 'loss_val': 1.1631636703662604, 'psi': 0.15219918620422399}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.1866659536759518, 'psi': 0.15231723870467326}
[S10] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44905
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:44902
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S2] not sending this round → trigger blocked (psi=0.190)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:44910
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.9231
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=-0.0610
[S11] DROPPED delta from S4 (cos=-0.0610 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=-0.1665
[S16] DROPPED delta from S5 (cos=-0.1665 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=-0.0752
[S15] DROPPED delta from S11 (cos=-0.0752 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=-0.0592
[S2] DROPPED delta from S3 (cos=-0.0592 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.8484
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=-0.0584
[S3] DROPPED delta from S17 (cos=-0.0584 < 0.0)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S8
[S9] cosine check vs S8: cos=-0.0975
[S9] DROPPED delta from S8 (cos=-0.0975 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.2871 head_norm=1.389066
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.864152e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.2969 head_norm=1.411171 delta_norm=0.286415
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.3341 head_norm=1.319099
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.957015e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.0018 head_norm=1.351389 delta_norm=0.395701
[S5] aggregate: ROLLBACK (f1_val pre=0.334 post=0.002 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.559484 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.18214841722885314, 'auprc': 0.18214841722885314, 'loss_val': 2.6316010364999007, 'psi': 0.18214841722885314}-{'f1_val': 0.19020514644847622, 'auprc': 0.19020514644847622, 'loss_val': 2.6602166745078333, 'psi': 0.19020514644847622}
[S3] START round=15 head_norm_before_train=1.411171 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.268219 metrics={'f1_val': 0.2820768846729905, 'auprc': 0.2820768846729905, 'loss_val': 1.5380768310204678, 'psi': 0.2820768846729905}-{'f1_val': 0.28711286830462207, 'auprc': 0.28711286830462207, 'loss_val': 2.119838335794479, 'psi': 0.28711286830462207}
[S4] START round=15 head_norm_before_train=1.570155 (no previous merge yet)
[S4] round=15 local utility u=0.000412 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1677604532672459, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1685841580417156, 'psi': 0.3567939207526687}
[S5] START round=15 head_norm_before_train=1.351389 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.178504 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 2.4208273159313576, 'psi': 0.33451196111837667}-{'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.774057240132307, 'psi': 0.33409214683912186}
[S6] START round=15 head_norm_before_train=1.546308 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.061502938706968935, 'auprc': 0.061502938706968935, 'loss_val': 4.712495539664036, 'psi': 0.061502938706968935}-{'f1_val': 0.07900040306328093, 'auprc': 0.07900040306328093, 'loss_val': 4.326075141702805, 'psi': 0.07900040306328093}
[S7] START round=15 head_norm_before_train=1.489084 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.24152542372881355, 'auprc': 0.24152542372881355, 'loss_val': 1.066441349595327, 'psi': 0.24152542372881355}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0860922152305925, 'psi': 0.33308476261496395}
[S8] START round=15 head_norm_before_train=1.499997 (no previous merge yet)
[S8] round=15 local utility u=0.413283 metrics={'f1_val': 0.3784216754828324, 'auprc': 0.3784216754828324, 'loss_val': 0.8985856882813579, 'psi': 0.3784216754828324}-{'f1_val': 0.2991041310366262, 'auprc': 0.2991041310366262, 'loss_val': 1.0112940842527152, 'psi': 0.2991041310366262}
[S9] START round=15 head_norm_before_train=1.821294 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.64202854144093, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.586770458375888, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.502833 (no previous merge yet)
[S10] round=15 local utility u=0.417194 metrics={'f1_val': 0.06919275123558484, 'auprc': 0.06919275123558484, 'loss_val': 3.2370856523168006, 'psi': 0.06919275123558484}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.448738069657577, 'psi': 0.0}
[S11] START round=15 head_norm_before_train=1.529250 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.354767038992899, 'psi': 0.3319360347772085}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 1.953194417745305, 'psi': 0.3317042898145993}
[S13] START round=15 head_norm_before_train=1.360373 (no previous merge yet)
[S13] round=15 local utility u=0.147485 metrics={'f1_val': 0.28365535180010154, 'auprc': 0.28365535180010154, 'loss_val': 1.0799946781706284, 'psi': 0.28365535180010154}-{'f1_val': 0.25430061906375023, 'auprc': 0.25430061906375023, 'loss_val': 1.110771638884372, 'psi': 0.25430061906375023}
[S14] START round=15 head_norm_before_train=1.503171 (no previous merge yet)
[S14] round=15 local utility u=0.336374 metrics={'f1_val': 0.05753542292829541, 'auprc': 0.05753542292829541, 'loss_val': 5.376205530748863, 'psi': 0.057535422928295415}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.53113473576198, 'psi': 0.0}
[S15] START round=15 head_norm_before_train=1.491858 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.29043374925727866, 'auprc': 0.29043374925727866, 'loss_val': 1.1916220148459962, 'psi': 0.29043374925727866}-{'f1_val': 0.3329116592873709, 'auprc': 0.3329116592873709, 'loss_val': 1.249809804792304, 'psi': 0.3329116592873709}
[S16] START round=15 head_norm_before_train=1.283981 cos_to_last_merge=0.9475 (last merge round=8)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=15 local utility u=0.589470 metrics={'f1_val': 0.10222303206997084, 'auprc': 0.10222303206997084, 'loss_val': 2.5226729986786385, 'psi': 0.10222303206997084}-{'f1_val': 0.00023299161230195712, 'auprc': 0.00023299161230195712, 'loss_val': 2.783702447196814, 'psi': 0.00023299161230195712}
[S17] START round=15 head_norm_before_train=1.472115 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.1667833091231739, 'psi': 0.1522581895716224}-{'f1_val': 0.15219918620422399, 'auprc': 0.15219918620422399, 'loss_val': 1.1631636703662604, 'psi': 0.15219918620422399}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44910
[S14] not sending this round → trigger blocked (psi=0.058)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:44916
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.102)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.069)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=-0.0546
[S10] DROPPED delta from S13 (cos=-0.0546 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=-0.0634
[S11] DROPPED delta from S4 (cos=-0.0634 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1807) from S5
[S16] cosine check vs S5: cos=-0.1611
[S16] DROPPED delta from S5 (cos=-0.1611 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] cosine check vs S3: cos=-0.0638
[S2] DROPPED delta from S3 (cos=-0.0638 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] cosine check vs S8: cos=-0.0978
[S9] DROPPED delta from S8 (cos=-0.0978 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.115 → S8@127.0.0.1:44909
[S2] ⇄ pheromone p=0.222 → S15@127.0.0.1:44915
[S7] ⇄ pheromone p=0.243 → S3@127.0.0.1:44903
[S9] ⇄ pheromone p=0.106 → S16@127.0.0.1:44916
[S5] ⇄ pheromone p=0.336 → S16@127.0.0.1:44916
[S3] ⇄ pheromone p=0.188 → S2@127.0.0.1:44902
[S4] ⇄ pheromone p=0.154 → S11@127.0.0.1:44912
[S8] ⇄ pheromone p=0.264 → S9@127.0.0.1:44910
[S15] ⇄ pheromone p=0.152 → S5@127.0.0.1:44905
[S10] ⇄ pheromone p=0.126 → S9@127.0.0.1:44910
[S14] ⇄ pheromone p=0.110 → S8@127.0.0.1:44909
[S11] ⇄ pheromone p=0.237 → S15@127.0.0.1:44915
[S16] ⇄ pheromone p=0.187 → S14@127.0.0.1:44914
[S13] ⇄ pheromone p=0.328 → S10@127.0.0.1:44911
[S17] ⇄ pheromone p=0.080 → S3@127.0.0.1:44903
[S2] START round=16 head_norm_before_train=1.584701 (no previous merge yet)
[S2] round=16 local utility u=0.399524 metrics={'f1_val': 0.2469904524699045, 'auprc': 0.2469904524699045, 'loss_val': 2.4161318545500303, 'psi': 0.2469904524699045}-{'f1_val': 0.18214841722885314, 'auprc': 0.18214841722885314, 'loss_val': 2.6316010364999007, 'psi': 0.18214841722885314}
[S3] START round=16 head_norm_before_train=1.470580 cos_to_last_merge=0.9923 (last merge round=14)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.29751461988304095, 'auprc': 0.29751461988304095, 'loss_val': 2.0270816226585078, 'psi': 0.29751461988304095}-{'f1_val': 0.2820768846729905, 'auprc': 0.2820768846729905, 'loss_val': 1.5380768310204678, 'psi': 0.2820768846729905}
[S4] START round=16 head_norm_before_train=1.605124 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1752065919502988, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1677604532672459, 'psi': 0.3567939207526687}
[S5] START round=16 head_norm_before_train=1.402662 cos_to_last_merge=0.9972 (last merge round=14)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.628950187654264, 'psi': 0.33400978131092857}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 2.4208273159313576, 'psi': 0.33451196111837667}
[S6] START round=16 head_norm_before_train=1.566827 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.01350721937587331, 'auprc': 0.01350721937587331, 'loss_val': 5.201505753474335, 'psi': 0.01350721937587331}-{'f1_val': 0.061502938706968935, 'auprc': 0.061502938706968935, 'loss_val': 4.712495539664036, 'psi': 0.061502938706968935}
[S7] START round=16 head_norm_before_train=1.504561 (no previous merge yet)
[S7] round=16 local utility u=0.446812 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.996851943473567, 'psi': 0.33308476261496395}-{'f1_val': 0.24152542372881355, 'auprc': 0.24152542372881355, 'loss_val': 1.066441349595327, 'psi': 0.24152542372881355}
[S8] START round=16 head_norm_before_train=1.528547 (no previous merge yet)
[S8] round=16 local utility u=1.000000 metrics={'f1_val': 0.6487498097184481, 'auprc': 0.6487498097184481, 'loss_val': 0.7925877421400909, 'psi': 0.6487498097184481}-{'f1_val': 0.3784216754828324, 'auprc': 0.3784216754828324, 'loss_val': 0.8985856882813579, 'psi': 0.3784216754828324}
[S9] START round=16 head_norm_before_train=1.837726 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6838345317798122, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.64202854144093, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.519043 (no previous merge yet)
[S10] round=16 local utility u=0.665254 metrics={'f1_val': 0.19672368802551465, 'auprc': 0.19672368802551465, 'loss_val': 3.0543563465262045, 'psi': 0.19672368802551465}-{'f1_val': 0.06919275123558484, 'auprc': 0.06919275123558484, 'loss_val': 3.2370856523168006, 'psi': 0.06919275123558484}
[S11] START round=16 head_norm_before_train=1.554050 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.296111802961118, 'auprc': 0.296111802961118, 'loss_val': 2.0338852319639975, 'psi': 0.296111802961118}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.354767038992899, 'psi': 0.3319360347772085}
[S13] START round=16 head_norm_before_train=1.386356 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.2428150204639887, 'auprc': 0.2428150204639887, 'loss_val': 1.0466448515488085, 'psi': 0.24281502046398867}-{'f1_val': 0.28365535180010154, 'auprc': 0.28365535180010154, 'loss_val': 1.0799946781706284, 'psi': 0.28365535180010154}
[S14] START round=16 head_norm_before_train=1.526856 (no previous merge yet)
[S14] round=16 local utility u=0.339881 metrics={'f1_val': 0.12601626016260162, 'auprc': 0.12601626016260162, 'loss_val': 5.312771746771416, 'psi': 0.12601626016260162}-{'f1_val': 0.05753542292829541, 'auprc': 0.05753542292829541, 'loss_val': 5.376205530748863, 'psi': 0.057535422928295415}
[S15] START round=16 head_norm_before_train=1.509011 (no previous merge yet)
[S15] round=16 local utility u=0.015098 metrics={'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 1.0999727830240502, 'psi': 0.2836055656382335}-{'f1_val': 0.29043374925727866, 'auprc': 0.29043374925727866, 'loss_val': 1.1916220148459962, 'psi': 0.29043374925727866}
[S16] START round=16 head_norm_before_train=1.317237 cos_to_last_merge=0.9376 (last merge round=8)
[S16] ⚠️ Model drifted since last merge! cos=0.938
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.01539855072463768, 'auprc': 0.01539855072463768, 'loss_val': 3.0075074929482097, 'psi': 0.01539855072463768}-{'f1_val': 0.10222303206997084, 'auprc': 0.10222303206997084, 'loss_val': 2.5226729986786385, 'psi': 0.10222303206997084}
[S17] START round=16 head_norm_before_train=1.489030 (no previous merge yet)
[S17] round=16 local utility u=0.020789 metrics={'f1_val': 0.15249466123082897, 'auprc': 0.15249466123082897, 'loss_val': 1.1273343167207832, 'psi': 0.15249466123082897}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.1667833091231739, 'psi': 0.1522581895716224}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44905
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.197)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S14] not sending this round → trigger blocked (psi=0.126)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:44910
[S8] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=-0.0277
[S15] DROPPED delta from S2 (cos=-0.0277 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.9273
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.9181
[S9] RECEIVED delta(kind=head bytes=1806) from S8
[S9] cosine check vs S8: cos=-0.0991
[S9] DROPPED delta from S8 (cos=-0.0991 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=-0.0517
[S3] DROPPED delta from S17 (cos=-0.0517 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.3340 head_norm=1.455948
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.872964e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.3345 head_norm=1.466622 delta_norm=0.287296
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.2975 head_norm=1.542681
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.104377e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.2956 head_norm=1.502084 delta_norm=0.310438
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.610800 (no previous merge yet)
[S2] round=17 local utility u=0.028299 metrics={'f1_val': 0.2538451068463318, 'auprc': 0.2538451068463318, 'loss_val': 2.4212252253501343, 'psi': 0.2538451068463318}-{'f1_val': 0.2469904524699045, 'auprc': 0.2469904524699045, 'loss_val': 2.4161318545500303, 'psi': 0.2469904524699045}
[S3] START round=17 head_norm_before_train=1.502084 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.111581 metrics={'f1_val': 0.29727015429562675, 'auprc': 0.29727015429562675, 'loss_val': 1.8017200517041605, 'psi': 0.29727015429562675}-{'f1_val': 0.29751461988304095, 'auprc': 0.29751461988304095, 'loss_val': 2.0270816226585078, 'psi': 0.29751461988304095}
[S4] START round=17 head_norm_before_train=1.640395 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.180318097381265, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1752065919502988, 'psi': 0.3567939207526687}
[S5] START round=17 head_norm_before_train=1.466622 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.176993 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.2749636493555143, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.628950187654264, 'psi': 0.33400978131092857}
[S6] START round=17 head_norm_before_train=1.583190 (no previous merge yet)
[S6] round=17 local utility u=0.063543 metrics={'f1_val': 0.023928896991795807, 'auprc': 0.023928896991795807, 'loss_val': 5.16821392713004, 'psi': 0.023928896991795807}-{'f1_val': 0.01350721937587331, 'auprc': 0.01350721937587331, 'loss_val': 5.201505753474335, 'psi': 0.01350721937587331}
[S7] START round=17 head_norm_before_train=1.524924 (no previous merge yet)
[S7] round=17 local utility u=0.033018 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.930070830232725, 'psi': 0.3330019880715706}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.996851943473567, 'psi': 0.33308476261496395}
[S8] START round=17 head_norm_before_train=1.562973 (no previous merge yet)
[S8] round=17 local utility u=1.000000 metrics={'f1_val': 0.9834123143105495, 'auprc': 0.9834123143105495, 'loss_val': 0.714334852494155, 'psi': 0.9834123143105495}-{'f1_val': 0.6487498097184481, 'auprc': 0.6487498097184481, 'loss_val': 0.7925877421400909, 'psi': 0.6487498097184481}
[S9] START round=17 head_norm_before_train=1.851746 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7195187863116987, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6838345317798122, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.539073 (no previous merge yet)
[S10] round=17 local utility u=0.262216 metrics={'f1_val': 0.23869597801648765, 'auprc': 0.23869597801648765, 'loss_val': 2.9076747563119243, 'psi': 0.23869597801648765}-{'f1_val': 0.19672368802551465, 'auprc': 0.19672368802551465, 'loss_val': 3.0543563465262045, 'psi': 0.19672368802551465}
[S11] START round=17 head_norm_before_train=1.574654 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.320650545139303, 'psi': 0.323943661971831}-{'f1_val': 0.296111802961118, 'auprc': 0.296111802961118, 'loss_val': 2.0338852319639975, 'psi': 0.296111802961118}
[S13] START round=17 head_norm_before_train=1.407693 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.24025513819985825, 'auprc': 0.24025513819985825, 'loss_val': 1.0367718796733358, 'psi': 0.24025513819985825}-{'f1_val': 0.2428150204639887, 'auprc': 0.2428150204639887, 'loss_val': 1.0466448515488085, 'psi': 0.24281502046398867}
[S14] START round=17 head_norm_before_train=1.550043 (no previous merge yet)
[S14] round=17 local utility u=0.026184 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.3190284945254005, 'psi': 0.13253012048192772}-{'f1_val': 0.12601626016260162, 'auprc': 0.12601626016260162, 'loss_val': 5.312771746771416, 'psi': 0.12601626016260162}
[S15] START round=17 head_norm_before_train=1.532074 (no previous merge yet)
[S15] round=17 local utility u=0.081548 metrics={'f1_val': 0.2842995169082126, 'auprc': 0.2842995169082126, 'loss_val': 0.9431214842661655, 'psi': 0.2842995169082126}-{'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 1.0999727830240502, 'psi': 0.2836055656382335}
[S16] START round=17 head_norm_before_train=1.349826 cos_to_last_merge=0.9283 (last merge round=8)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=17 local utility u=0.762011 metrics={'f1_val': 0.13606943218593703, 'auprc': 0.13606943218593703, 'loss_val': 2.569523178525018, 'psi': 0.13606943218593703}-{'f1_val': 0.01539855072463768, 'auprc': 0.01539855072463768, 'loss_val': 3.0075074929482097, 'psi': 0.01539855072463768}
[S17] START round=17 head_norm_before_train=1.510919 (no previous merge yet)
[S17] round=17 local utility u=0.032750 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.0597068078857532, 'psi': 0.1522581895716224}-{'f1_val': 0.15249466123082897, 'auprc': 0.15249466123082897, 'loss_val': 1.1273343167207832, 'psi': 0.15249466123082897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.024)
[S2] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=-0.0603
[S2] DROPPED delta from S3 (cos=-0.0603 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] cosine check vs S8: cos=-0.1006
[S9] DROPPED delta from S8 (cos=-0.1006 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S2
[S15] cosine check vs S2: cos=-0.0247
[S15] DROPPED delta from S2 (cos=-0.0247 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] cosine check vs S7: cos=0.9526
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44905
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.9731
[S16] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44910
[S14] not sending this round → trigger blocked (psi=0.133)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=0.0374
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=-0.1616
[S16] DROPPED delta from S5 (cos=-0.1616 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=-0.0424
[S3] DROPPED delta from S17 (cos=-0.0424 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.2973 head_norm=1.561973
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.397053e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.2932 head_norm=1.538545 delta_norm=0.239705
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.3687 head_norm=1.864740
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.192837e+00
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.3687 head_norm=1.237625 delta_norm=1.192837
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.3340 head_norm=1.501434
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.798944e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.3345 head_norm=1.520211 delta_norm=0.179894
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.635339 (no previous merge yet)
[S2] round=18 local utility u=0.050520 metrics={'f1_val': 0.24633682790754705, 'auprc': 0.24633682790754705, 'loss_val': 2.2526099815954925, 'psi': 0.24633682790754702}-{'f1_val': 0.2538451068463318, 'auprc': 0.2538451068463318, 'loss_val': 2.4212252253501343, 'psi': 0.2538451068463318}
[S3] START round=18 head_norm_before_train=1.538545 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.006571 metrics={'f1_val': 0.29727015429562675, 'auprc': 0.29727015429562675, 'loss_val': 1.7885770862559767, 'psi': 0.29727015429562675}-{'f1_val': 0.29727015429562675, 'auprc': 0.29727015429562675, 'loss_val': 1.8017200517041605, 'psi': 0.29727015429562675}
[S4] START round=18 head_norm_before_train=1.672117 (no previous merge yet)
[S4] round=18 local utility u=0.000218 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1798829757422729, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.180318097381265, 'psi': 0.3567939207526687}
[S5] START round=18 head_norm_before_train=1.520211 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.066414 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.142136008426107, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.2749636493555143, 'psi': 0.33400978131092857}
[S6] START round=18 head_norm_before_train=1.599306 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.426029202492091, 'psi': 0.017774699907663897}-{'f1_val': 0.023928896991795807, 'auprc': 0.023928896991795807, 'loss_val': 5.16821392713004, 'psi': 0.023928896991795807}
[S7] START round=18 head_norm_before_train=1.552225 (no previous merge yet)
[S7] round=18 local utility u=0.049776 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.8312645198246018, 'psi': 0.33308476261496395}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.930070830232725, 'psi': 0.3330019880715706}
[S8] START round=18 head_norm_before_train=1.599087 (no previous merge yet)
[S8] round=18 local utility u=0.115852 metrics={'f1_val': 0.9997177674455537, 'auprc': 0.9997177674455537, 'loss_val': 0.6293807296105989, 'psi': 0.9997177674455537}-{'f1_val': 0.9834123143105495, 'auprc': 0.9834123143105495, 'loss_val': 0.714334852494155, 'psi': 0.9834123143105495}
[S9] START round=18 head_norm_before_train=1.237625 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.496781 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.725956012642741, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7195187863116987, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.559454 (no previous merge yet)
[S10] round=18 local utility u=0.098795 metrics={'f1_val': 0.24952107279693486, 'auprc': 0.24952107279693486, 'loss_val': 2.8075106912880767, 'psi': 0.24952107279693486}-{'f1_val': 0.23869597801648765, 'auprc': 0.23869597801648765, 'loss_val': 2.9076747563119243, 'psi': 0.23869597801648765}
[S11] START round=18 head_norm_before_train=1.595385 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.2801989268420364, 'auprc': 0.2801989268420364, 'loss_val': 1.942967678608591, 'psi': 0.2801989268420364}-{'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.320650545139303, 'psi': 0.323943661971831}
[S13] START round=18 head_norm_before_train=1.431661 (no previous merge yet)
[S13] round=18 local utility u=0.000246 metrics={'f1_val': 0.24012750132813884, 'auprc': 0.24012750132813884, 'loss_val': 1.0351302544212697, 'psi': 0.24012750132813884}-{'f1_val': 0.24025513819985825, 'auprc': 0.24025513819985825, 'loss_val': 1.0367718796733358, 'psi': 0.24025513819985825}
[S14] START round=18 head_norm_before_train=1.573423 (no previous merge yet)
[S14] round=18 local utility u=0.012681 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.322452816041396, 'psi': 0.13572854291417166}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.3190284945254005, 'psi': 0.13253012048192772}
[S15] START round=18 head_norm_before_train=1.559649 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.28080438756855575, 'auprc': 0.28080438756855575, 'loss_val': 0.9270485405647214, 'psi': 0.28080438756855575}-{'f1_val': 0.2842995169082126, 'auprc': 0.2842995169082126, 'loss_val': 0.9431214842661655, 'psi': 0.2842995169082126}
[S16] START round=18 head_norm_before_train=1.381010 cos_to_last_merge=0.9198 (last merge round=8)
[S16] ⚠️ Model drifted since last merge! cos=0.920
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.06996601177153279, 'auprc': 0.06996601177153279, 'loss_val': 3.2377157026598473, 'psi': 0.06996601177153279}-{'f1_val': 0.13606943218593703, 'auprc': 0.13606943218593703, 'loss_val': 2.569523178525018, 'psi': 0.13606943218593703}
[S17] START round=18 head_norm_before_train=1.534723 (no previous merge yet)
[S17] round=18 local utility u=0.020053 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.0203983579256464, 'psi': 0.15234678044996122}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.0597068078857532, 'psi': 0.1522581895716224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:44912
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=-0.0220
[S15] DROPPED delta from S2 (cos=-0.0220 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=-0.0590
[S2] DROPPED delta from S3 (cos=-0.0590 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=-0.0690
[S11] DROPPED delta from S4 (cos=-0.0690 < 0.0)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[S14] not sending this round → trigger blocked (psi=0.136)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:44911
[S5] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:44910
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=-0.1554
[S16] DROPPED delta from S5 (cos=-0.1554 < 0.0)
[S8] sending update (kind=head size=1807 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.5244
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] cosine check vs S10: cos=0.6230
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.9617
[S9] RECEIVED delta(kind=head bytes=1807) from S8
[S9] cosine check vs S8: cos=-0.0519
[S9] DROPPED delta from S8 (cos=-0.0519 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1805) from S13
[S10] cosine check vs S13: cos=-0.0515
[S10] DROPPED delta from S13 (cos=-0.0515 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=-0.0376
[S3] DROPPED delta from S17 (cos=-0.0376 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.2973 head_norm=1.603141
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.208531e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.2938 head_norm=1.579723 delta_norm=0.220853
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.3687 head_norm=1.304419
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.376160e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.3687 head_norm=1.299392 delta_norm=0.637616
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.0700 head_norm=1.412609
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.641570e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.0707 head_norm=1.186331 delta_norm=0.664157
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.658645 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.19219924812030076, 'auprc': 0.19219924812030076, 'loss_val': 2.829022306023585, 'psi': 0.19219924812030076}-{'f1_val': 0.24633682790754705, 'auprc': 0.24633682790754705, 'loss_val': 2.2526099815954925, 'psi': 0.24633682790754702}
[S3] START round=19 head_norm_before_train=1.579723 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.029949 metrics={'f1_val': 0.2942877801879971, 'auprc': 0.2942877801879971, 'loss_val': 1.7018372499985581, 'psi': 0.2942877801879971}-{'f1_val': 0.29727015429562675, 'auprc': 0.29727015429562675, 'loss_val': 1.7885770862559767, 'psi': 0.29727015429562675}
[S4] START round=19 head_norm_before_train=1.701382 (no previous merge yet)
[S4] round=19 local utility u=0.004715 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1704532905689005, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1798829757422729, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.550313 cos_to_last_merge=0.9990 (last merge round=17)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.3644752966647555, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.142136008426107, 'psi': 0.33400978131092857}
[S6] START round=19 head_norm_before_train=1.613148 (no previous merge yet)
[S6] round=19 local utility u=0.060717 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.340365308979081, 'psi': 0.021749084249084248}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.426029202492091, 'psi': 0.017774699907663897}
[S7] START round=19 head_norm_before_train=1.586992 (no previous merge yet)
[S7] round=19 local utility u=0.033418 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.7644279667229987, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.8312645198246018, 'psi': 0.33308476261496395}
[S8] START round=19 head_norm_before_train=1.641261 (no previous merge yet)
[S8] round=19 local utility u=0.026311 metrics={'f1_val': 0.9991531851296138, 'auprc': 0.9991531851296138, 'loss_val': 0.5716781714944936, 'psi': 0.9991531851296138}-{'f1_val': 0.9997177674455537, 'auprc': 0.9997177674455537, 'loss_val': 0.6293807296105989, 'psi': 0.9997177674455537}
[S9] START round=19 head_norm_before_train=1.299392 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.106542 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5128723450998456, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.725956012642741, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.577478 (no previous merge yet)
[S10] round=19 local utility u=0.037271 metrics={'f1_val': 0.24958123953098826, 'auprc': 0.24958123953098826, 'loss_val': 2.733510281693614, 'psi': 0.24958123953098826}-{'f1_val': 0.24952107279693486, 'auprc': 0.24952107279693486, 'loss_val': 2.8075106912880767, 'psi': 0.24952107279693486}
[S11] START round=19 head_norm_before_train=1.616351 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.28047422545359274, 'auprc': 0.28047422545359274, 'loss_val': 2.1572735522522546, 'psi': 0.28047422545359274}-{'f1_val': 0.2801989268420364, 'auprc': 0.2801989268420364, 'loss_val': 1.942967678608591, 'psi': 0.2801989268420364}
[S13] START round=19 head_norm_before_train=1.449963 (no previous merge yet)
[S13] round=19 local utility u=0.530364 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.052681686509633, 'psi': 0.3599362944611573}-{'f1_val': 0.24012750132813884, 'auprc': 0.24012750132813884, 'loss_val': 1.0351302544212697, 'psi': 0.24012750132813884}
[S14] START round=19 head_norm_before_train=1.600451 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.342210313175133, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.322452816041396, 'psi': 0.13572854291417166}
[S15] START round=19 head_norm_before_train=1.586630 (no previous merge yet)
[S15] round=19 local utility u=0.061567 metrics={'f1_val': 0.28346647300895667, 'auprc': 0.28346647300895667, 'loss_val': 0.8278732994081487, 'psi': 0.28346647300895667}-{'f1_val': 0.28080438756855575, 'auprc': 0.28080438756855575, 'loss_val': 0.9270485405647214, 'psi': 0.28080438756855575}
[S16] START round=19 head_norm_before_train=1.186331 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.802661 metrics={'f1_val': 0.1347784413477844, 'auprc': 0.1347784413477844, 'loss_val': 2.2157063653235722, 'psi': 0.1347784413477844}-{'f1_val': 0.06996601177153279, 'auprc': 0.06996601177153279, 'loss_val': 3.2377157026598473, 'psi': 0.06996601177153279}
[S17] START round=19 head_norm_before_train=1.562885 (no previous merge yet)
[S17] round=19 local utility u=0.015671 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 0.9885242943049509, 'psi': 0.152287708414114}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.0203983579256464, 'psi': 0.15234678044996122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:44911
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.135)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44910
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44910
[S13] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:44912
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=-0.0491
[S10] DROPPED delta from S13 (cos=-0.0491 < 0.0)
[S8] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] cosine check vs S9: cos=0.7033
[S3] RECEIVED delta(kind=head bytes=1794) from S7
[S3] cosine check vs S7: cos=0.9678
[S9] RECEIVED delta(kind=head bytes=1804) from S8
[S9] cosine check vs S8: cos=-0.0069
[S9] DROPPED delta from S8 (cos=-0.0069 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] cosine check vs S10: cos=0.8632
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S4] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=-0.0690
[S11] DROPPED delta from S4 (cos=-0.0690 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=-0.0345
[S3] DROPPED delta from S17 (cos=-0.0345 < 0.0)
[S15] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.9775
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] cosine check vs S3: cos=-0.0571
[S2] DROPPED delta from S3 (cos=-0.0571 < 0.0)
[S2] r=20 psi=0.192 u=0.0000 p_local=0.1435 f1=0.192 auprc=0.192 bytes=5402
[S11] r=20 psi=0.280 u=0.0000 p_local=0.0972 f1=0.280 auprc=0.280 bytes=1800
[S6] r=20 psi=0.022 u=0.0607 p_local=0.0675 f1=0.022 auprc=0.022 bytes=0
[S13] r=20 psi=0.360 u=0.5304 p_local=0.2403 f1=0.360 auprc=0.360 bytes=9004
[S10] r=20 psi=0.250 u=0.0373 p_local=0.1764 f1=0.250 auprc=0.250 bytes=5398
[S7] r=20 psi=0.333 u=0.0334 p_local=0.1642 f1=0.333 auprc=0.333 bytes=14386
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.3687 head_norm=1.386460
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.030769e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.3687 head_norm=1.439802 delta_norm=0.403077
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.369 u=0.1065 p_local=0.1443 f1=0.369 auprc=0.369 bytes=5405
[S14] r=20 psi=0.136 u=0.0000 p_local=0.0853 f1=0.136 auprc=0.136 bytes=0
[S8] r=20 psi=0.999 u=0.0263 p_local=0.3622 f1=0.999 auprc=0.999 bytes=18026
[S4] r=20 psi=0.357 u=0.0047 p_local=0.0641 f1=0.357 auprc=0.357 bytes=14413
[S15] r=20 psi=0.283 u=0.0616 p_local=0.0866 f1=0.283 auprc=0.283 bytes=10794
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.2943 head_norm=1.643930
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.071647e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.2921 head_norm=1.611757 delta_norm=0.207165
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.294 u=0.0299 p_local=0.0982 f1=0.294 auprc=0.294 bytes=12601
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.1348 head_norm=1.224439
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.083741e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.1338 head_norm=1.205121 delta_norm=0.508374
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.135 u=0.8027 p_local=0.3346 f1=0.135 auprc=0.135 bytes=0
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.3340 head_norm=1.590664
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.702520e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.3340 head_norm=1.592970 delta_norm=0.170252
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.334 u=0.0000 p_local=0.1711 f1=0.334 auprc=0.334 bytes=12610
[S17] r=20 psi=0.152 u=0.0157 p_local=0.0456 f1=0.152 auprc=0.152 bytes=14404
[S2] START round=20 head_norm_before_train=1.678900 (no previous merge yet)
[S2] round=20 local utility u=0.485004 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.33449066349244, 'psi': 0.2450298816928894}-{'f1_val': 0.19219924812030076, 'auprc': 0.19219924812030076, 'loss_val': 2.829022306023585, 'psi': 0.19219924812030076}
[S3] START round=20 head_norm_before_train=1.611757 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.013820 metrics={'f1_val': 0.2928802588996764, 'auprc': 0.2928802588996764, 'loss_val': 1.6615295196685411, 'psi': 0.2928802588996764}-{'f1_val': 0.2942877801879971, 'auprc': 0.2942877801879971, 'loss_val': 1.7018372499985581, 'psi': 0.2942877801879971}
[S4] START round=20 head_norm_before_train=1.723609 (no previous merge yet)
[S4] round=20 local utility u=0.005580 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1592940933882177, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1704532905689005, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.592970 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.051566 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.256818289369211, 'psi': 0.3335071121394324}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.3644752966647555, 'psi': 0.33400978131092857}
[S6] START round=20 head_norm_before_train=1.627519 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.010543580131208997, 'auprc': 0.010543580131208997, 'loss_val': 5.841223060233359, 'psi': 0.010543580131208997}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.340365308979081, 'psi': 0.021749084249084248}
[S7] START round=20 head_norm_before_train=1.605880 (no previous merge yet)
[S7] round=20 local utility u=0.012570 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7385426781410791, 'psi': 0.3330019880715706}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.7644279667229987, 'psi': 0.33308476261496395}
[S8] START round=20 head_norm_before_train=1.682521 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.59408046190016, 'psi': 0.9988708350860451}-{'f1_val': 0.9991531851296138, 'auprc': 0.9991531851296138, 'loss_val': 0.5716781714944936, 'psi': 0.9991531851296138}
[S9] START round=20 head_norm_before_train=1.439802 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.043010 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4268520725029934, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5128723450998456, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.596474 (no previous merge yet)
[S10] round=20 local utility u=0.031298 metrics={'f1_val': 0.24952153110047848, 'auprc': 0.24952153110047848, 'loss_val': 2.670377409759173, 'psi': 0.24952153110047848}-{'f1_val': 0.24958123953098826, 'auprc': 0.24958123953098826, 'loss_val': 2.733510281693614, 'psi': 0.24958123953098826}
[S11] START round=20 head_norm_before_train=1.638526 (no previous merge yet)
[S11] round=20 local utility u=0.054728 metrics={'f1_val': 0.2762402425649958, 'auprc': 0.2762402425649958, 'loss_val': 2.009712573461442, 'psi': 0.2762402425649958}-{'f1_val': 0.28047422545359274, 'auprc': 0.28047422545359274, 'loss_val': 2.1572735522522546, 'psi': 0.28047422545359274}
[S13] START round=20 head_norm_before_train=1.464828 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.064703784439942, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.052681686509633, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.628987 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.401590068891607, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.342210313175133, 'psi': 0.13592717296421}
[S15] START round=20 head_norm_before_train=1.613339 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.2815085158150851, 'auprc': 0.2815085158150851, 'loss_val': 0.8360953023647691, 'psi': 0.2815085158150851}-{'f1_val': 0.28346647300895667, 'auprc': 0.28346647300895667, 'loss_val': 0.8278732994081487, 'psi': 0.28346647300895667}
[S16] START round=20 head_norm_before_train=1.205121 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.09011604641856742, 'auprc': 0.09011604641856742, 'loss_val': 2.265109904177565, 'psi': 0.09011604641856742}-{'f1_val': 0.1347784413477844, 'auprc': 0.1347784413477844, 'loss_val': 2.2157063653235722, 'psi': 0.1347784413477844}
[S17] START round=20 head_norm_before_train=1.593146 (no previous merge yet)
[S17] round=20 local utility u=0.001029 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 0.9862014203365815, 'psi': 0.1522581895716224}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 0.9885242943049509, 'psi': 0.152287708414114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:44902
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:44916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:44912
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=-0.0687
[S11] DROPPED delta from S4 (cos=-0.0687 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1805) from S9
[S16] cosine check vs S9: cos=0.8578
[S2] RECEIVED delta(kind=head bytes=1795) from S3
[S2] cosine check vs S3: cos=-0.0536
[S2] DROPPED delta from S3 (cos=-0.0536 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.9743
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=-0.1406
[S16] DROPPED delta from S5 (cos=-0.1406 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] cosine check vs S11: cos=-0.0718
[S15] DROPPED delta from S11 (cos=-0.0718 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=0.9210
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=-0.0173
[S15] DROPPED delta from S2 (cos=-0.0173 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=-0.0306
[S3] DROPPED delta from S17 (cos=-0.0306 < 0.0)
[S6] ⇄ pheromone p=0.054 → S8@127.0.0.1:44909
[S8] ⇄ pheromone p=0.290 → S9@127.0.0.1:44910
[S14] ⇄ pheromone p=0.068 → S8@127.0.0.1:44909
[S10] ⇄ pheromone p=0.147 → S9@127.0.0.1:44910
[S11] ⇄ pheromone p=0.089 → S15@127.0.0.1:44915
[S4] ⇄ pheromone p=0.052 → S11@127.0.0.1:44912
[S5] ⇄ pheromone p=0.147 → S16@127.0.0.1:44916
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.2929 head_norm=1.673023
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.883342e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.2867 head_norm=1.639712 delta_norm=0.188334
[S3] aggregate: ROLLBACK (f1_val pre=0.293 post=0.287 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.081 → S2@127.0.0.1:44902
[S2] ⇄ pheromone p=0.212 → S15@127.0.0.1:44915
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.3687 head_norm=1.531163
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.157900e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.3687 head_norm=1.543356 delta_norm=0.315790
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.124 → S16@127.0.0.1:44916
[S13] ⇄ pheromone p=0.192 → S10@127.0.0.1:44911
[S7] ⇄ pheromone p=0.134 → S3@127.0.0.1:44903
[S17] ⇄ pheromone p=0.037 → S3@127.0.0.1:44903
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.0901 head_norm=1.250011
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.947535e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.0881 head_norm=1.340770 delta_norm=0.394753
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.268 → S14@127.0.0.1:44914
[S15] ⇄ pheromone p=0.069 → S5@127.0.0.1:44905
[S2] START round=21 head_norm_before_train=1.698157 (no previous merge yet)
[S2] round=21 local utility u=0.030641 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.456762059881589, 'psi': 0.26542475888492534}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.33449066349244, 'psi': 0.2450298816928894}
[S3] START round=21 head_norm_before_train=1.639712 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.2943675978663774, 'auprc': 0.2943675978663774, 'loss_val': 1.7283160625597263, 'psi': 0.2943675978663774}-{'f1_val': 0.2928802588996764, 'auprc': 0.2928802588996764, 'loss_val': 1.6615295196685411, 'psi': 0.2928802588996764}
[S4] START round=21 head_norm_before_train=1.738420 (no previous merge yet)
[S4] round=21 local utility u=0.005729 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1478357801375787, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1592940933882177, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.642719 cos_to_last_merge=0.9979 (last merge round=19)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4006937789585012, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.256818289369211, 'psi': 0.3335071121394324}
[S6] START round=21 head_norm_before_train=1.640727 (no previous merge yet)
[S6] round=21 local utility u=0.212140 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.51976337958091, 'psi': 0.021967963386727688}-{'f1_val': 0.010543580131208997, 'auprc': 0.010543580131208997, 'loss_val': 5.841223060233359, 'psi': 0.010543580131208997}
[S7] START round=21 head_norm_before_train=1.627651 (no previous merge yet)
[S7] round=21 local utility u=0.021154 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6962344547754206, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7385426781410791, 'psi': 0.3330019880715706}
[S8] START round=21 head_norm_before_train=1.716074 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6285404993036735, 'psi': 0.35939447907390915}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.59408046190016, 'psi': 0.9988708350860451}
[S9] START round=21 head_norm_before_train=1.543356 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5491730061350442, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4268520725029934, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.618297 (no previous merge yet)
[S10] round=21 local utility u=0.023694 metrics={'f1_val': 0.24952153110047848, 'auprc': 0.24952153110047848, 'loss_val': 2.6229890484476885, 'psi': 0.24952153110047848}-{'f1_val': 0.24952153110047848, 'auprc': 0.24952153110047848, 'loss_val': 2.670377409759173, 'psi': 0.24952153110047848}
[S11] START round=21 head_norm_before_train=1.660055 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.2849070328615375, 'psi': 0.28041912246234446}-{'f1_val': 0.2762402425649958, 'auprc': 0.2762402425649958, 'loss_val': 2.009712573461442, 'psi': 0.2762402425649958}
[S13] START round=21 head_norm_before_train=1.486257 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0903274478545224, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.064703784439942, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.658284 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.480699509885959, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.401590068891607, 'psi': 0.13572854291417166}
[S15] START round=21 head_norm_before_train=1.639066 (no previous merge yet)
[S15] round=21 local utility u=0.049673 metrics={'f1_val': 0.28346647300895667, 'auprc': 0.28346647300895667, 'loss_val': 0.7543713970514049, 'psi': 0.28346647300895667}-{'f1_val': 0.2815085158150851, 'auprc': 0.2815085158150851, 'loss_val': 0.8360953023647691, 'psi': 0.2815085158150851}
[S16] START round=21 head_norm_before_train=1.340770 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.236094 metrics={'f1_val': 0.12151439582861029, 'auprc': 0.12151439582861029, 'loss_val': 2.0755069829348214, 'psi': 0.12151439582861029}-{'f1_val': 0.09011604641856742, 'auprc': 0.09011604641856742, 'loss_val': 2.265109904177565, 'psi': 0.09011604641856742}
[S17] START round=21 head_norm_before_train=1.622913 (no previous merge yet)
[S17] round=21 local utility u=0.250066 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9424901342827903, 'psi': 0.20297157622739018}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 0.9862014203365815, 'psi': 0.1522581895716224}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[S16] not sending this round → trigger blocked (psi=0.122)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44910
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:44912
[S15] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S4
[S11] cosine check vs S4: cos=-0.0693
[S11] DROPPED delta from S4 (cos=-0.0693 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S2
[S15] cosine check vs S2: cos=-0.0152
[S15] DROPPED delta from S2 (cos=-0.0152 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.9785
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=0.9491
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] cosine check vs S7: cos=0.9799
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=-0.0287
[S3] DROPPED delta from S17 (cos=-0.0287 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.3335 head_norm=1.674025
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.733825e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.3335 head_norm=1.661367 delta_norm=0.173383
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.3687 head_norm=1.628540
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.604497e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.3687 head_norm=1.612120 delta_norm=0.260450
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.2944 head_norm=1.697704
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.695805e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.2926 head_norm=1.665216 delta_norm=0.169581
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.715549 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.24938067712634185, 'auprc': 0.24938067712634185, 'loss_val': 2.7551762801429716, 'psi': 0.24938067712634182}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.456762059881589, 'psi': 0.26542475888492534}
[S3] START round=22 head_norm_before_train=1.665216 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.026404 metrics={'f1_val': 0.2907137907137907, 'auprc': 0.2907137907137907, 'loss_val': 1.6426228943805388, 'psi': 0.2907137907137907}-{'f1_val': 0.2943675978663774, 'auprc': 0.2943675978663774, 'loss_val': 1.7283160625597263, 'psi': 0.2943675978663774}
[S4] START round=22 head_norm_before_train=1.756574 (no previous merge yet)
[S4] round=22 local utility u=0.006280 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1352753613069926, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1478357801375787, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.661367 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.118817 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1630603879657664, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4006937789585012, 'psi': 0.3335071121394324}
[S6] START round=22 head_norm_before_train=1.654047 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.932654828623767, 'psi': 0.017551963048498844}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.51976337958091, 'psi': 0.021967963386727688}
[S7] START round=22 head_norm_before_train=1.649607 (no previous merge yet)
[S7] round=22 local utility u=0.026129 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6439764300164658, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6962344547754206, 'psi': 0.3330019880715706}
[S8] START round=22 head_norm_before_train=1.746219 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6694413852403049, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6285404993036735, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.612120 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.020237 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5086988054812578, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5491730061350442, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.637494 (no previous merge yet)
[S10] round=22 local utility u=0.034327 metrics={'f1_val': 0.24952153110047848, 'auprc': 0.24952153110047848, 'loss_val': 2.5543343834685914, 'psi': 0.24952153110047848}-{'f1_val': 0.24952153110047848, 'auprc': 0.24952153110047848, 'loss_val': 2.6229890484476885, 'psi': 0.24952153110047848}
[S11] START round=22 head_norm_before_train=1.679892 (no previous merge yet)
[S11] round=22 local utility u=0.036571 metrics={'f1_val': 0.2799790767621289, 'auprc': 0.2799790767621289, 'loss_val': 2.2078036824918152, 'psi': 0.2799790767621289}-{'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.2849070328615375, 'psi': 0.28041912246234446}
[S13] START round=22 head_norm_before_train=1.505765 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1131201019621908, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0903274478545224, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.685930 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.581297562136517, 'psi': 0.1355297641332834}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.480699509885959, 'psi': 0.13572854291417166}
[S15] START round=22 head_norm_before_train=1.666746 (no previous merge yet)
[S15] round=22 local utility u=1.000000 metrics={'f1_val': 0.6101781237856817, 'auprc': 0.6101781237856817, 'loss_val': 0.7872862222271091, 'psi': 0.6101781237856817}-{'f1_val': 0.28346647300895667, 'auprc': 0.28346647300895667, 'loss_val': 0.7543713970514049, 'psi': 0.28346647300895667}
[S16] START round=22 head_norm_before_train=1.383829 cos_to_last_merge=0.9965 (last merge round=20)
[S16] round=22 local utility u=0.119700 metrics={'f1_val': 0.15196917808219176, 'auprc': 0.15196917808219176, 'loss_val': 2.110200378088729, 'psi': 0.15196917808219176}-{'f1_val': 0.12151439582861029, 'auprc': 0.12151439582861029, 'loss_val': 2.0755069829348214, 'psi': 0.12151439582861029}
[S17] START round=22 head_norm_before_train=1.647281 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.15283914874144325, 'auprc': 0.15283914874144325, 'loss_val': 0.8898856751577676, 'psi': 0.15283914874144325}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9424901342827903, 'psi': 0.20297157622739018}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:44902
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44905
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.152)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.9900
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.9836
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=0.9657
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.1476
[S16] DROPPED delta from S5 (cos=-0.1476 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] cosine check vs S9: cos=0.8868
[S15] RECEIVED delta(kind=head bytes=1795) from S11
[S15] cosine check vs S11: cos=-0.0719
[S15] DROPPED delta from S11 (cos=-0.0719 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=-0.0677
[S11] DROPPED delta from S4 (cos=-0.0677 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=-0.0500
[S2] DROPPED delta from S3 (cos=-0.0500 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.2907 head_norm=1.719243
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.554038e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.2810 head_norm=1.688325 delta_norm=0.155404
[S3] aggregate: ROLLBACK (f1_val pre=0.291 post=0.281 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.3335 head_norm=1.688272
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.192269e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.3335 head_norm=1.685842 delta_norm=0.119227
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.3687 head_norm=1.694041
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.200754e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.3687 head_norm=1.661850 delta_norm=0.220075
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.1520 head_norm=1.438375
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.926988e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.1476 head_norm=1.521557 delta_norm=0.392699
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.731832 (no previous merge yet)
[S2] round=23 local utility u=0.174061 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.5519236535371155, 'psi': 0.2654773703336637}-{'f1_val': 0.24938067712634185, 'auprc': 0.24938067712634185, 'loss_val': 2.7551762801429716, 'psi': 0.24938067712634182}
[S3] START round=23 head_norm_before_train=1.688325 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.2942877801879971, 'auprc': 0.2942877801879971, 'loss_val': 1.74174870773957, 'psi': 0.2942877801879971}-{'f1_val': 0.2907137907137907, 'auprc': 0.2907137907137907, 'loss_val': 1.6426228943805388, 'psi': 0.2907137907137907}
[S4] START round=23 head_norm_before_train=1.775541 (no previous merge yet)
[S4] round=23 local utility u=0.005129 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.125018000565035, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1352753613069926, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.685842 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.196294677831757, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1630603879657664, 'psi': 0.3335071121394324}
[S6] START round=23 head_norm_before_train=1.667120 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.005210800568450971, 'auprc': 0.005210800568450971, 'loss_val': 6.136559989905485, 'psi': 0.005210800568450971}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.932654828623767, 'psi': 0.017551963048498844}
[S7] START round=23 head_norm_before_train=1.671342 (no previous merge yet)
[S7] round=23 local utility u=0.010134 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6237081755944729, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6439764300164658, 'psi': 0.3330019880715706}
[S8] START round=23 head_norm_before_train=1.772194 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6816633035752353, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6694413852403049, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.661850 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.010186 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4883260712106967, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5086988054812578, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.658489 (no previous merge yet)
[S10] round=23 local utility u=0.027523 metrics={'f1_val': 0.24952153110047848, 'auprc': 0.24952153110047848, 'loss_val': 2.4992881114832537, 'psi': 0.24952153110047848}-{'f1_val': 0.24952153110047848, 'auprc': 0.24952153110047848, 'loss_val': 2.5543343834685914, 'psi': 0.24952153110047848}
[S11] START round=23 head_norm_before_train=1.696769 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.28030898140874577, 'auprc': 0.28030898140874577, 'loss_val': 2.325255152925572, 'psi': 0.28030898140874577}-{'f1_val': 0.2799790767621289, 'auprc': 0.2799790767621289, 'loss_val': 2.2078036824918152, 'psi': 0.2799790767621289}
[S13] START round=23 head_norm_before_train=1.528234 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.146809474536362, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1131201019621908, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.711970 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.679957648424554, 'psi': 0.13592717296421}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.581297562136517, 'psi': 0.1355297641332834}
[S15] START round=23 head_norm_before_train=1.691832 (no previous merge yet)
[S15] round=23 local utility u=0.051299 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7408283705457854, 'psi': 0.6164158146233559}-{'f1_val': 0.6101781237856817, 'auprc': 0.6101781237856817, 'loss_val': 0.7872862222271091, 'psi': 0.6101781237856817}
[S16] START round=23 head_norm_before_train=1.521557 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.13548339592077166, 'auprc': 0.13548339592077166, 'loss_val': 2.199927719201074, 'psi': 0.13548339592077166}-{'f1_val': 0.15196917808219176, 'auprc': 0.15196917808219176, 'loss_val': 2.110200378088729, 'psi': 0.15196917808219176}
[S17] START round=23 head_norm_before_train=1.668000 (no previous merge yet)
[S17] round=23 local utility u=0.004830 metrics={'f1_val': 0.1525044949903416, 'auprc': 0.1525044949903416, 'loss_val': 0.8772135774214338, 'psi': 0.1525044949903416}-{'f1_val': 0.15283914874144325, 'auprc': 0.15283914874144325, 'loss_val': 0.8898856751577676, 'psi': 0.15283914874144325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:44916
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:44910
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:44905
[S15] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=-0.0663
[S11] DROPPED delta from S4 (cos=-0.0663 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1805) from S9
[S16] cosine check vs S9: cos=0.9506
[S15] RECEIVED delta(kind=head bytes=1801) from S2
[S15] cosine check vs S2: cos=-0.0125
[S15] DROPPED delta from S2 (cos=-0.0125 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S10
[S9] cosine check vs S10: cos=0.9760
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.9907
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] cosine check vs S7: cos=0.9868
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=-0.0248
[S3] DROPPED delta from S17 (cos=-0.0248 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.2943 head_norm=1.738032
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.413320e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.2926 head_norm=1.708706 delta_norm=0.141332
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.3335 head_norm=1.735195
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.178315e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.3335 head_norm=1.722993 delta_norm=0.117831
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.1355 head_norm=1.563538
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.726570e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.1275 head_norm=1.628518 delta_norm=0.272657
[S16] aggregate: ROLLBACK (f1_val pre=0.135 post=0.128 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.3687 head_norm=1.734409
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.890337e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.3687 head_norm=1.697132 delta_norm=0.189034
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.746607 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.2478411053540587, 'auprc': 0.2478411053540587, 'loss_val': 2.4905314438909834, 'psi': 0.2478411053540587}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.5519236535371155, 'psi': 0.2654773703336637}
[S3] START round=24 head_norm_before_train=1.708706 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.129948 metrics={'f1_val': 0.2759427470410129, 'auprc': 0.2759427470410129, 'loss_val': 1.316748214763035, 'psi': 0.2759427470410129}-{'f1_val': 0.2942877801879971, 'auprc': 0.2942877801879971, 'loss_val': 1.74174870773957, 'psi': 0.2942877801879971}
[S4] START round=24 head_norm_before_train=1.792268 (no previous merge yet)
[S4] round=24 local utility u=0.002878 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1192612009843255, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.125018000565035, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.722993 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.013936 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1684227366466304, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.196294677831757, 'psi': 0.3335071121394324}
[S6] START round=24 head_norm_before_train=1.678097 (no previous merge yet)
[S6] round=24 local utility u=0.168055 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.945349559625132, 'psi': 0.021310724106324473}-{'f1_val': 0.005210800568450971, 'auprc': 0.005210800568450971, 'loss_val': 6.136559989905485, 'psi': 0.005210800568450971}
[S7] START round=24 head_norm_before_train=1.690724 (no previous merge yet)
[S7] round=24 local utility u=0.009009 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6056894697539809, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6237081755944729, 'psi': 0.3330019880715706}
[S8] START round=24 head_norm_before_train=1.798743 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7290517358686136, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6816633035752353, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.697132 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.017462 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4534026074422906, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4883260712106967, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.680418 (no previous merge yet)
[S10] round=24 local utility u=0.022103 metrics={'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.4545458522445958, 'psi': 0.24946185123176273}-{'f1_val': 0.24952153110047848, 'auprc': 0.24952153110047848, 'loss_val': 2.4992881114832537, 'psi': 0.24952153110047848}
[S11] START round=24 head_norm_before_train=1.715084 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.514714464509357, 'psi': 0.280398322851153}-{'f1_val': 0.28030898140874577, 'auprc': 0.28030898140874577, 'loss_val': 2.325255152925572, 'psi': 0.28030898140874577}
[S13] START round=24 head_norm_before_train=1.553855 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2014577477998902, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.146809474536362, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.735590 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13433395872420262, 'auprc': 0.13433395872420262, 'loss_val': 5.7746772901313665, 'psi': 0.13433395872420262}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.679957648424554, 'psi': 0.13592717296421}
[S15] START round=24 head_norm_before_train=1.718802 (no previous merge yet)
[S15] round=24 local utility u=0.016762 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.70730468882362, 'psi': 0.6164158146233559}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7408283705457854, 'psi': 0.6164158146233559}
[S16] START round=24 head_norm_before_train=1.628518 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.047714 metrics={'f1_val': 0.14163027656477437, 'auprc': 0.14163027656477437, 'loss_val': 2.159821560731791, 'psi': 0.14163027656477437}-{'f1_val': 0.13548339592077166, 'auprc': 0.13548339592077166, 'loss_val': 2.199927719201074, 'psi': 0.13548339592077166}
[S17] START round=24 head_norm_before_train=1.688391 (no previous merge yet)
[S17] round=24 local utility u=0.218466 metrics={'f1_val': 0.20326065549725758, 'auprc': 0.20326065549725758, 'loss_val': 0.8970877542302046, 'psi': 0.20326065549725758}-{'f1_val': 0.1525044949903416, 'auprc': 0.1525044949903416, 'loss_val': 0.8772135774214338, 'psi': 0.1525044949903416}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.142)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:44912
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:44902
[S6] not sending this round → trigger blocked (psi=0.021)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.9894
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=0.9830
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.9901
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=-0.0661
[S11] DROPPED delta from S4 (cos=-0.0661 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] cosine check vs S9: cos=0.9722
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=-0.1237
[S16] DROPPED delta from S5 (cos=-0.1237 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=-0.0474
[S2] DROPPED delta from S3 (cos=-0.0474 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S17
[S3] cosine check vs S17: cos=-0.0242
[S3] DROPPED delta from S17 (cos=-0.0242 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.2759 head_norm=1.755929
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.281263e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.2729 head_norm=1.730250 delta_norm=0.128126
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.3687 head_norm=1.760392
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.621406e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.3687 head_norm=1.724065 delta_norm=0.162141
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.3335 head_norm=1.780254
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.249491e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.3335 head_norm=1.762088 delta_norm=0.124949
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.1416 head_norm=1.666642
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.074167e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.1371 head_norm=1.701563 delta_norm=0.207417
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.760383 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.2457492354740061, 'auprc': 0.2457492354740061, 'loss_val': 2.5268069165644054, 'psi': 0.2457492354740061}-{'f1_val': 0.2478411053540587, 'auprc': 0.2478411053540587, 'loss_val': 2.4905314438909834, 'psi': 0.2478411053540587}
[S3] START round=25 head_norm_before_train=1.730250 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.2811560693641619, 'auprc': 0.2811560693641619, 'loss_val': 1.4533946156862247, 'psi': 0.2811560693641619}-{'f1_val': 0.2759427470410129, 'auprc': 0.2759427470410129, 'loss_val': 1.316748214763035, 'psi': 0.2759427470410129}
[S4] START round=25 head_norm_before_train=1.809553 (no previous merge yet)
[S4] round=25 local utility u=0.000953 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1173546701959507, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1192612009843255, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.762088 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.029800 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1088226557537744, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1684227366466304, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.686832 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.173833885025145, 'psi': 0.01732902033271719}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.945349559625132, 'psi': 0.021310724106324473}
[S7] START round=25 head_norm_before_train=1.713790 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.5473731763182128, 'psi': 0.24962705121829937}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6056894697539809, 'psi': 0.3330019880715706}
[S8] START round=25 head_norm_before_train=1.822140 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7635976701408633, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7290517358686136, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.724065 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4687818527786076, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4534026074422906, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.702469 (no previous merge yet)
[S10] round=25 local utility u=0.022527 metrics={'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.409492668707007, 'psi': 0.24946185123176273}-{'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.4545458522445958, 'psi': 0.24946185123176273}
[S11] START round=25 head_norm_before_train=1.733335 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.5681503715762517, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.514714464509357, 'psi': 0.280398322851153}
[S13] START round=25 head_norm_before_train=1.572856 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2545135570474057, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2014577477998902, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.756802 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.11679586563307494, 'auprc': 0.11679586563307494, 'loss_val': 5.901867489442199, 'psi': 0.11679586563307495}-{'f1_val': 0.13433395872420262, 'auprc': 0.13433395872420262, 'loss_val': 5.7746772901313665, 'psi': 0.13433395872420262}
[S15] START round=25 head_norm_before_train=1.752664 (no previous merge yet)
[S15] round=25 local utility u=0.002268 metrics={'f1_val': 0.6162765197878417, 'auprc': 0.6162765197878417, 'loss_val': 0.7015142590594557, 'psi': 0.6162765197878417}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.70730468882362, 'psi': 0.6164158146233559}
[S16] START round=25 head_norm_before_train=1.701563 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.091660 metrics={'f1_val': 0.15449059282925098, 'auprc': 0.15449059282925098, 'loss_val': 2.0922454015990115, 'psi': 0.15449059282925098}-{'f1_val': 0.14163027656477437, 'auprc': 0.14163027656477437, 'loss_val': 2.159821560731791, 'psi': 0.14163027656477437}
[S17] START round=25 head_norm_before_train=1.706169 (no previous merge yet)
[S17] round=25 local utility u=0.027212 metrics={'f1_val': 0.2044013420472869, 'auprc': 0.2044013420472869, 'loss_val': 0.8529297722574374, 'psi': 0.2044013420472869}-{'f1_val': 0.20326065549725758, 'auprc': 0.20326065549725758, 'loss_val': 0.8970877542302046, 'psi': 0.20326065549725758}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.154)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44910
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=0.9879
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=-0.0661
[S11] DROPPED delta from S4 (cos=-0.0661 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=-0.1171
[S16] DROPPED delta from S5 (cos=-0.1171 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.9905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S17
[S3] cosine check vs S17: cos=-0.0229
[S3] DROPPED delta from S17 (cos=-0.0229 < 0.0)
[S14] ⇄ pheromone p=0.022 → S8@127.0.0.1:44909
[S7] ⇄ pheromone p=0.051 → S3@127.0.0.1:44903
[S8] ⇄ pheromone p=0.095 → S9@127.0.0.1:44910
[S13] ⇄ pheromone p=0.063 → S10@127.0.0.1:44911
[S6] ⇄ pheromone p=0.062 → S8@127.0.0.1:44909
[S2] ⇄ pheromone p=0.094 → S15@127.0.0.1:44915
[S3] ⇄ pheromone p=0.050 → S2@127.0.0.1:44902
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.3687 head_norm=1.781811
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.391734e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.3687 head_norm=1.750801 delta_norm=0.139173
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.047 → S16@127.0.0.1:44916
[S11] ⇄ pheromone p=0.033 → S15@127.0.0.1:44915
[S15] ⇄ pheromone p=0.139 → S5@127.0.0.1:44905
[S4] ⇄ pheromone p=0.020 → S11@127.0.0.1:44912
[S10] ⇄ pheromone p=0.065 → S9@127.0.0.1:44910
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.3335 head_norm=1.822232
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.257386e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.3335 head_norm=1.800838 delta_norm=0.125739
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.069 → S16@127.0.0.1:44916
[S16] ⇄ pheromone p=0.145 → S14@127.0.0.1:44914
[S17] ⇄ pheromone p=0.074 → S3@127.0.0.1:44903
[S2] START round=26 head_norm_before_train=1.773110 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.24624624624624625, 'auprc': 0.24624624624624625, 'loss_val': 2.557595872990527, 'psi': 0.24624624624624625}-{'f1_val': 0.2457492354740061, 'auprc': 0.2457492354740061, 'loss_val': 2.5268069165644054, 'psi': 0.2457492354740061}
[S3] START round=26 head_norm_before_train=1.774925 cos_to_last_merge=0.9983 (last merge round=24)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.2763185108583247, 'auprc': 0.2763185108583247, 'loss_val': 1.4358901917472744, 'psi': 0.2763185108583247}-{'f1_val': 0.2811560693641619, 'auprc': 0.2811560693641619, 'loss_val': 1.4533946156862247, 'psi': 0.2811560693641619}
[S4] START round=26 head_norm_before_train=1.821692 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.117583463837959, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1173546701959507, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.800838 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.019869 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.0690836980422005, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1088226557537744, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.696227 (no previous merge yet)
[S6] round=26 local utility u=0.495767 metrics={'f1_val': 0.07104722792607802, 'auprc': 0.07104722792607802, 'loss_val': 5.665763415205402, 'psi': 0.07104722792607802}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.173833885025145, 'psi': 0.01732902033271719}
[S7] START round=26 head_norm_before_train=1.729050 (no previous merge yet)
[S7] round=26 local utility u=0.384175 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.5293967306318896, 'psi': 0.3330019880715706}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.5473731763182128, 'psi': 0.24962705121829937}
[S8] START round=26 head_norm_before_train=1.845029 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7685812187724049, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7635976701408633, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.750801 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5354826271296802, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4687818527786076, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.730461 (no previous merge yet)
[S10] round=26 local utility u=0.021815 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.3664012032521025, 'psi': 0.24952175992348158}-{'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.409492668707007, 'psi': 0.24946185123176273}
[S11] START round=26 head_norm_before_train=1.750134 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.6140680333401014, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.5681503715762517, 'psi': 0.280398322851153}
[S13] START round=26 head_norm_before_train=1.585567 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2876891709917848, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2545135570474057, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.776726 (no previous merge yet)
[S14] round=26 local utility u=0.070590 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.932411414099652, 'psi': 0.13587634006482174}-{'f1_val': 0.11679586563307494, 'auprc': 0.11679586563307494, 'loss_val': 5.901867489442199, 'psi': 0.11679586563307495}
[S15] START round=26 head_norm_before_train=1.788050 (no previous merge yet)
[S15] round=26 local utility u=0.011554 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6789268139779068, 'psi': 0.6163342951580373}-{'f1_val': 0.6162765197878417, 'auprc': 0.6162765197878417, 'loss_val': 0.7015142590594557, 'psi': 0.6162765197878417}
[S16] START round=26 head_norm_before_train=1.736976 cos_to_last_merge=0.9981 (last merge round=24)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.1487543973005959, 'auprc': 0.1487543973005959, 'loss_val': 2.2849628448476045, 'psi': 0.1487543973005959}-{'f1_val': 0.15449059282925098, 'auprc': 0.15449059282925098, 'loss_val': 2.0922454015990115, 'psi': 0.15449059282925098}
[S17] START round=26 head_norm_before_train=1.721312 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.19522804150442113, 'auprc': 0.19522804150442113, 'loss_val': 0.8260094676413179, 'psi': 0.19522804150442113}-{'f1_val': 0.2044013420472869, 'auprc': 0.2044013420472869, 'loss_val': 0.8529297722574374, 'psi': 0.2044013420472869}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44910
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44916
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S6] not sending this round → trigger blocked (psi=0.071)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:44905
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=-0.1242
[S16] DROPPED delta from S5 (cos=-0.1242 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1804) from S10
[S9] cosine check vs S10: cos=0.9911
[S5] RECEIVED delta(kind=head bytes=1805) from S15
[S5] cosine check vs S15: cos=0.9911
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] cosine check vs S7: cos=0.9852
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.3687 head_norm=1.803240
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.207550e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.3687 head_norm=1.776359 delta_norm=0.120755
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.2763 head_norm=1.814119
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.570592e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.2750 head_norm=1.771647 delta_norm=0.157059
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.3335 head_norm=1.858407
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.242772e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.3335 head_norm=1.834683 delta_norm=0.124277
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.784913 (no previous merge yet)
[S2] round=27 local utility u=0.019742 metrics={'f1_val': 0.25448096776236623, 'auprc': 0.25448096776236623, 'loss_val': 2.5922246988636117, 'psi': 0.25448096776236623}-{'f1_val': 0.24624624624624625, 'auprc': 0.24624624624624625, 'loss_val': 2.557595872990527, 'psi': 0.24624624624624625}
[S3] START round=27 head_norm_before_train=1.771647 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.26924108340037545, 'auprc': 0.26924108340037545, 'loss_val': 1.3743155210867266, 'psi': 0.26924108340037545}-{'f1_val': 0.2763185108583247, 'auprc': 0.2763185108583247, 'loss_val': 1.4358901917472744, 'psi': 0.2763185108583247}
[S4] START round=27 head_norm_before_train=1.839994 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1210551809911196, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.117583463837959, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.834683 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.050842 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9673998996674162, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.0690836980422005, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.706505 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.50283026486999, 'psi': 0.0}-{'f1_val': 0.07104722792607802, 'auprc': 0.07104722792607802, 'loss_val': 5.665763415205402, 'psi': 0.07104722792607802}
[S7] START round=27 head_norm_before_train=1.742348 (no previous merge yet)
[S7] round=27 local utility u=0.001557 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.5262820772774048, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.5293967306318896, 'psi': 0.3330019880715706}
[S8] START round=27 head_norm_before_train=1.868241 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8103968547276165, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7685812187724049, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.776359 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5746667408958739, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5354826271296802, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.757383 (no previous merge yet)
[S10] round=27 local utility u=0.024896 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.31660845527656, 'psi': 0.24952175992348158}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.3664012032521025, 'psi': 0.24952175992348158}
[S11] START round=27 head_norm_before_train=1.766088 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.28061893522161024, 'auprc': 0.28061893522161024, 'loss_val': 2.6944193866051793, 'psi': 0.28061893522161024}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.6140680333401014, 'psi': 0.280398322851153}
[S13] START round=27 head_norm_before_train=1.595927 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2940467760117775, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2876891709917848, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.794429 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.0108001234508155, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.932411414099652, 'psi': 0.13587634006482174}
[S15] START round=27 head_norm_before_train=1.819159 (no previous merge yet)
[S15] round=27 local utility u=0.016150 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6478797329376239, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6789268139779068, 'psi': 0.6163342951580373}
[S16] START round=27 head_norm_before_train=1.772684 cos_to_last_merge=0.9940 (last merge round=24)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.09061799551713096, 'auprc': 0.09061799551713096, 'loss_val': 3.077909263477201, 'psi': 0.09061799551713096}-{'f1_val': 0.1487543973005959, 'auprc': 0.1487543973005959, 'loss_val': 2.2849628448476045, 'psi': 0.1487543973005959}
[S17] START round=27 head_norm_before_train=1.739493 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.20391650024080257, 'auprc': 0.20391650024080257, 'loss_val': 0.9185755494730371, 'psi': 0.20391650024080257}-{'f1_val': 0.19522804150442113, 'auprc': 0.19522804150442113, 'loss_val': 0.8260094676413179, 'psi': 0.19522804150442113}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:44902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:44913
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=-0.0272
[S13] DROPPED delta from S10 (cos=-0.0272 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] cosine check vs S5: cos=0.9934
[S3] RECEIVED delta(kind=head bytes=1801) from S2
[S3] cosine check vs S2: cos=-0.0429
[S3] DROPPED delta from S2 (cos=-0.0429 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S15
[S2] cosine check vs S15: cos=-0.0103
[S2] DROPPED delta from S15 (cos=-0.0103 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.6165 head_norm=1.848074
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.079035e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.6165 head_norm=1.858636 delta_norm=0.107903
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.795776 (no previous merge yet)
[S2] round=28 local utility u=0.014602 metrics={'f1_val': 0.2632854989843392, 'auprc': 0.2632854989843392, 'loss_val': 2.6422618316022954, 'psi': 0.2632854989843392}-{'f1_val': 0.25448096776236623, 'auprc': 0.25448096776236623, 'loss_val': 2.5922246988636117, 'psi': 0.25448096776236623}
[S3] START round=28 head_norm_before_train=1.804600 cos_to_last_merge=0.9994 (last merge round=26)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.2717303005686434, 'auprc': 0.2717303005686434, 'loss_val': 1.4698050308562458, 'psi': 0.2717303005686434}-{'f1_val': 0.26924108340037545, 'auprc': 0.26924108340037545, 'loss_val': 1.3743155210867266, 'psi': 0.26924108340037545}
[S4] START round=28 head_norm_before_train=1.856557 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.130393441409369, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1210551809911196, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.875357 cos_to_last_merge=0.9989 (last merge round=26)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1576856583387887, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9673998996674162, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.715846 (no previous merge yet)
[S6] round=28 local utility u=0.563818 metrics={'f1_val': 0.05229318474067724, 'auprc': 0.05229318474067724, 'loss_val': 5.845832787140688, 'psi': 0.05229318474067724}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.50283026486999, 'psi': 0.0}
[S7] START round=28 head_norm_before_train=1.756713 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.5016011905319567, 'psi': 0.24962705121829937}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.5262820772774048, 'psi': 0.3330019880715706}
[S8] START round=28 head_norm_before_train=1.891656 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8450481147533582, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8103968547276165, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.823739 cos_to_last_merge=0.9989 (last merge round=26)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7152896634134347, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5746667408958739, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.781997 (no previous merge yet)
[S10] round=28 local utility u=0.106492 metrics={'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 2.103627486963175, 'psi': 0.24952198852772467}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.31660845527656, 'psi': 0.24952175992348158}
[S11] START round=28 head_norm_before_train=1.781124 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.28061893522161024, 'auprc': 0.28061893522161024, 'loss_val': 2.7367264869095895, 'psi': 0.28061893522161024}-{'f1_val': 0.28061893522161024, 'auprc': 0.28061893522161024, 'loss_val': 2.6944193866051793, 'psi': 0.28061893522161024}
[S13] START round=28 head_norm_before_train=1.603415 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3105830722278904, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2940467760117775, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.810665 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.086360499603374, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.0108001234508155, 'psi': 0.13582554517133957}
[S15] START round=28 head_norm_before_train=1.858636 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.004863 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6381531342056889, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6478797329376239, 'psi': 0.6164734888353558}
[S16] START round=28 head_norm_before_train=1.805030 cos_to_last_merge=0.9898 (last merge round=24)
[S16] round=28 local utility u=0.839448 metrics={'f1_val': 0.17034743722050225, 'auprc': 0.17034743722050225, 'loss_val': 2.1165778884800526, 'psi': 0.17034743722050225}-{'f1_val': 0.09061799551713096, 'auprc': 0.09061799551713096, 'loss_val': 3.077909263477201, 'psi': 0.09061799551713096}
[S17] START round=28 head_norm_before_train=1.755625 (no previous merge yet)
[S17] round=28 local utility u=0.036102 metrics={'f1_val': 0.21059061719021863, 'auprc': 0.21059061719021863, 'loss_val': 0.9064391334803342, 'psi': 0.2105906171902186}-{'f1_val': 0.20391650024080257, 'auprc': 0.20391650024080257, 'loss_val': 0.9185755494730371, 'psi': 0.20391650024080257}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.263)
[S16] not sending this round → trigger blocked (psi=0.170)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.250)
[S15] not sending this round → trigger blocked (psi=0.616)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.052)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=29 head_norm_before_train=1.805972 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.26513197062909305, 'auprc': 0.26513197062909305, 'loss_val': 2.877917433727424, 'psi': 0.26513197062909305}-{'f1_val': 0.2632854989843392, 'auprc': 0.2632854989843392, 'loss_val': 2.6422618316022954, 'psi': 0.2632854989843392}
[S3] START round=29 head_norm_before_train=1.835877 cos_to_last_merge=0.9979 (last merge round=26)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.2758288622919246, 'auprc': 0.2758288622919246, 'loss_val': 1.5715886901454632, 'psi': 0.2758288622919246}-{'f1_val': 0.2717303005686434, 'auprc': 0.2717303005686434, 'loss_val': 1.4698050308562458, 'psi': 0.2717303005686434}
[S4] START round=29 head_norm_before_train=1.867867 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1423544895619187, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.130393441409369, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.917990 cos_to_last_merge=0.9964 (last merge round=26)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.302377850911501, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1576856583387887, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.723528 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.421171209805054, 'psi': 0.017774699907663897}-{'f1_val': 0.05229318474067724, 'auprc': 0.05229318474067724, 'loss_val': 5.845832787140688, 'psi': 0.05229318474067724}
[S7] START round=29 head_norm_before_train=1.768474 (no previous merge yet)
[S7] round=29 local utility u=0.384097 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.4837811954522265, 'psi': 0.3330019880715706}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.5016011905319567, 'psi': 0.24962705121829937}
[S8] START round=29 head_norm_before_train=1.909709 (no previous merge yet)
[S8] round=29 local utility u=0.041247 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7625534720709355, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8450481147533582, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.865163 cos_to_last_merge=0.9968 (last merge round=26)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8352044397409535, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7152896634134347, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.808502 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 2.110553546845389, 'psi': 0.24952198852772467}-{'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 2.103627486963175, 'psi': 0.24952198852772467}
[S11] START round=29 head_norm_before_train=1.795591 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.28061893522161024, 'auprc': 0.28061893522161024, 'loss_val': 2.7789412444184065, 'psi': 0.28061893522161024}-{'f1_val': 0.28061893522161024, 'auprc': 0.28061893522161024, 'loss_val': 2.7367264869095895, 'psi': 0.28061893522161024}
[S13] START round=29 head_norm_before_train=1.611055 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3235254249091661, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3105830722278904, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.825532 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.159133273302767, 'psi': 0.13592717296421}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.086360499603374, 'psi': 0.13582554517133957}
[S15] START round=29 head_norm_before_train=1.886506 cos_to_last_merge=0.9999 (last merge round=27)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.640322308684949, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6381531342056889, 'psi': 0.6164734888353558}
[S16] START round=29 head_norm_before_train=1.832195 cos_to_last_merge=0.9862 (last merge round=24)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.13688771388705295, 'auprc': 0.13688771388705295, 'loss_val': 2.8695353425649084, 'psi': 0.13688771388705295}-{'f1_val': 0.17034743722050225, 'auprc': 0.17034743722050225, 'loss_val': 2.1165778884800526, 'psi': 0.17034743722050225}
[S17] START round=29 head_norm_before_train=1.769801 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.2080131485417829, 'auprc': 0.2080131485417829, 'loss_val': 0.9754335291334633, 'psi': 0.2080131485417829}-{'f1_val': 0.21059061719021863, 'auprc': 0.21059061719021863, 'loss_val': 0.9064391334803342, 'psi': 0.2105906171902186}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:44907
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=-0.1385
[S6] DROPPED delta from S8 (cos=-0.1385 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=1.815227 (no previous merge yet)
[S2] round=30 local utility u=0.010737 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.8588362094435653, 'psi': 0.2653978324081417}-{'f1_val': 0.26513197062909305, 'auprc': 0.26513197062909305, 'loss_val': 2.877917433727424, 'psi': 0.26513197062909305}
[S3] START round=30 head_norm_before_train=1.862531 cos_to_last_merge=0.9963 (last merge round=26)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 1.5847686528829301, 'psi': 0.2587947777992154}-{'f1_val': 0.2758288622919246, 'auprc': 0.2758288622919246, 'loss_val': 1.5715886901454632, 'psi': 0.2758288622919246}
[S4] START round=30 head_norm_before_train=1.879683 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.148024506390184, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1423544895619187, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.961100 cos_to_last_merge=0.9932 (last merge round=26)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4050879778363488, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.302377850911501, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.729294 (no previous merge yet)
[S6] round=30 local utility u=0.092986 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.270968685422066, 'psi': 0.021749084249084248}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.421171209805054, 'psi': 0.017774699907663897}
[S7] START round=30 head_norm_before_train=1.779278 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.4695435587577616, 'psi': 0.24962705121829937}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.4837811954522265, 'psi': 0.3330019880715706}
[S8] START round=30 head_norm_before_train=1.926080 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7867560266195353, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7625534720709355, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.897122 cos_to_last_merge=0.9948 (last merge round=26)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9322253425146991, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8352044397409535, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.832886 (no previous merge yet)
[S10] round=30 local utility u=0.368302 metrics={'f1_val': 0.2866895039920254, 'auprc': 0.2866895039920254, 'loss_val': 1.708456769781593, 'psi': 0.2866895039920254}-{'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 2.110553546845389, 'psi': 0.24952198852772467}
[S11] START round=30 head_norm_before_train=1.808981 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.28061893522161024, 'auprc': 0.28061893522161024, 'loss_val': 2.8081769950260136, 'psi': 0.28061893522161024}-{'f1_val': 0.28061893522161024, 'auprc': 0.28061893522161024, 'loss_val': 2.7789412444184065, 'psi': 0.28061893522161024}
[S13] START round=30 head_norm_before_train=1.618911 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3457074604768475, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3235254249091661, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.838857 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.223636747000649, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.159133273302767, 'psi': 0.13592717296421}
[S15] START round=30 head_norm_before_train=1.913715 cos_to_last_merge=0.9995 (last merge round=27)
[S15] round=30 local utility u=0.004241 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6318399833098767, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.640322308684949, 'psi': 0.6163342951580373}
[S16] START round=30 head_norm_before_train=1.853792 cos_to_last_merge=0.9832 (last merge round=24)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.062163978494623656, 'auprc': 0.062163978494623656, 'loss_val': 3.786248784860764, 'psi': 0.062163978494623656}-{'f1_val': 0.13688771388705295, 'auprc': 0.13688771388705295, 'loss_val': 2.8695353425649084, 'psi': 0.13688771388705295}
[S17] START round=30 head_norm_before_train=1.783772 (no previous merge yet)
[S17] round=30 local utility u=0.348495 metrics={'f1_val': 0.2746577698675881, 'auprc': 0.2746577698675881, 'loss_val': 0.8782457859274978, 'psi': 0.2746577698675881}-{'f1_val': 0.2080131485417829, 'auprc': 0.2080131485417829, 'loss_val': 0.9754335291334633, 'psi': 0.2080131485417829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:44902
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:44913
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S15
[S2] cosine check vs S15: cos=-0.0047
[S2] DROPPED delta from S15 (cos=-0.0047 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1793) from S2
[S3] cosine check vs S2: cos=-0.0368
[S3] DROPPED delta from S2 (cos=-0.0368 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=-0.0231
[S13] DROPPED delta from S10 (cos=-0.0231 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S3] ⇄ pheromone p=0.016 → S17@127.0.0.1:44917
[S11] ⇄ pheromone p=0.011 → S4@127.0.0.1:44904
[S8] ⇄ pheromone p=0.038 → S6@127.0.0.1:44907
[S9] ⇄ pheromone p=0.015 → S8@127.0.0.1:44909
[S5] ⇄ pheromone p=0.029 → S15@127.0.0.1:44915
[S10] ⇄ pheromone p=0.113 → S13@127.0.0.1:44913
[S15] ⇄ pheromone p=0.050 → S2@127.0.0.1:44902
[S2] ⇄ pheromone p=0.037 → S3@127.0.0.1:44903
[S16] ⇄ pheromone p=0.155 → S5@127.0.0.1:44905
[S17] ⇄ pheromone p=0.098 → S3@127.0.0.1:44903
[S14] ⇄ pheromone p=0.013 → S16@127.0.0.1:44916
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S17
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S15
[S16]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S16
[S2]  timeout peer S17
[S2] START round=31 head_norm_before_train=1.824015 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.2457943353520524, 'auprc': 0.2457943353520524, 'loss_val': 2.6834188831009227, 'psi': 0.2457943353520524}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.8588362094435653, 'psi': 0.2653978324081417}
[S3] START round=31 head_norm_before_train=1.884663 cos_to_last_merge=0.9947 (last merge round=26)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.2595961550867686, 'auprc': 0.2595961550867686, 'loss_val': 1.6418239538973418, 'psi': 0.2595961550867686}-{'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 1.5847686528829301, 'psi': 0.2587947777992154}
[S4] START round=31 head_norm_before_train=1.891393 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1605572491432754, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.148024506390184, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.996435 cos_to_last_merge=0.9902 (last merge round=26)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4813139941321465, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4050879778363488, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=1.734759 (no previous merge yet)
[S6] round=31 local utility u=0.576651 metrics={'f1_val': 0.10179184140297369, 'auprc': 0.10179184140297369, 'loss_val': 5.8380516158971645, 'psi': 0.10179184140297369}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.270968685422066, 'psi': 0.021749084249084248}
[S7] START round=31 head_norm_before_train=1.790100 (no previous merge yet)
[S7] round=31 local utility u=1.000000 metrics={'f1_val': 0.4704782710379726, 'auprc': 0.4704782710379726, 'loss_val': 0.432362466721232, 'psi': 0.4704782710379726}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.4695435587577616, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] sending update (kind=head size=1791 to 1 peers)
[S8] START round=31 head_norm_before_train=1.941286 (no previous merge yet)
[S8] round=31 local utility u=0.055058 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6766401133680839, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7867560266195353, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.922420 cos_to_last_merge=0.9930 (last merge round=26)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.004342114497528, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9322253425146991, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.855614 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.2798370445679118, 'auprc': 0.2798370445679118, 'loss_val': 1.728859322530193, 'psi': 0.2798370445679118}-{'f1_val': 0.2866895039920254, 'auprc': 0.2866895039920254, 'loss_val': 1.708456769781593, 'psi': 0.2866895039920254}
[S11] START round=31 head_norm_before_train=1.821536 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.28056374959029823, 'auprc': 0.28056374959029823, 'loss_val': 2.8197458390543533, 'psi': 0.28056374959029823}-{'f1_val': 0.28061893522161024, 'auprc': 0.28061893522161024, 'loss_val': 2.8081769950260136, 'psi': 0.28061893522161024}
[S13] START round=31 head_norm_before_train=1.627650 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3643033484517422, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3457074604768475, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.851256 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.278015199206008, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.223636747000649, 'psi': 0.13572854291417166}
[S15] START round=31 head_norm_before_train=1.940868 cos_to_last_merge=0.9989 (last merge round=27)
[S15] round=31 local utility u=0.002979 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.625882586402857, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6318399833098767, 'psi': 0.6163342951580373}
[S16] START round=31 head_norm_before_train=1.872028 cos_to_last_merge=0.9808 (last merge round=24)
[S16] round=31 local utility u=0.851938 metrics={'f1_val': 0.15097576667381515, 'auprc': 0.15097576667381515, 'loss_val': 2.8816797659924642, 'psi': 0.15097576667381515}-{'f1_val': 0.062163978494623656, 'auprc': 0.062163978494623656, 'loss_val': 3.786248784860764, 'psi': 0.062163978494623656}
[S17] START round=31 head_norm_before_train=1.797244 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.23885187603154545, 'auprc': 0.23885187603154545, 'loss_val': 1.0125230660783686, 'psi': 0.23885187603154545}-{'f1_val': 0.2746577698675881, 'auprc': 0.2746577698675881, 'loss_val': 0.8782457859274978, 'psi': 0.2746577698675881}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.102)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:44907
[S16] not sending this round → trigger blocked (psi=0.151)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=-0.1387
[S6] DROPPED delta from S8 (cos=-0.1387 < 0.0)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:44902
[S15] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S15
[S2] cosine check vs S15: cos=-0.0049
[S2] DROPPED delta from S15 (cos=-0.0049 < 0.0)
[S2] START round=32 head_norm_before_train=1.832470 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 2.7551851874576934, 'psi': 0.24520932503356518}-{'f1_val': 0.2457943353520524, 'auprc': 0.2457943353520524, 'loss_val': 2.6834188831009227, 'psi': 0.2457943353520524}
[S3] START round=32 head_norm_before_train=1.903461 cos_to_last_merge=0.9933 (last merge round=26)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.26159349593495934, 'auprc': 0.26159349593495934, 'loss_val': 1.6955733747919897, 'psi': 0.26159349593495934}-{'f1_val': 0.2595961550867686, 'auprc': 0.2595961550867686, 'loss_val': 1.6418239538973418, 'psi': 0.2595961550867686}
[S4] START round=32 head_norm_before_train=1.904357 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.17376046060032, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1605572491432754, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=2.022554 cos_to_last_merge=0.9880 (last merge round=26)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4933931715517472, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4813139941321465, 'psi': 0.3335071121394324}
[S6] START round=32 head_norm_before_train=1.741731 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.916449046638099, 'psi': 0.0}-{'f1_val': 0.10179184140297369, 'auprc': 0.10179184140297369, 'loss_val': 5.8380516158971645, 'psi': 0.10179184140297369}
[S7] START round=32 head_norm_before_train=1.802109 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.5379126639127152, 'psi': 0.24962705121829937}-{'f1_val': 0.4704782710379726, 'auprc': 0.4704782710379726, 'loss_val': 0.432362466721232, 'psi': 0.4704782710379726}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.955741 (no previous merge yet)
[S8] round=32 local utility u=0.035805 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6050301765858731, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6766401133680839, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.943093 cos_to_last_merge=0.9915 (last merge round=26)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0581658968619228, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.004342114497528, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=1.883705 (no previous merge yet)
[S10] round=32 local utility u=0.282219 metrics={'f1_val': 0.32325799798874116, 'auprc': 0.32325799798874116, 'loss_val': 1.5552095095063772, 'psi': 0.32325799798874116}-{'f1_val': 0.2798370445679118, 'auprc': 0.2798370445679118, 'loss_val': 1.728859322530193, 'psi': 0.2798370445679118}
[S11] START round=32 head_norm_before_train=1.833153 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.28056374959029823, 'auprc': 0.28056374959029823, 'loss_val': 2.843859925720333, 'psi': 0.28056374959029823}-{'f1_val': 0.28056374959029823, 'auprc': 0.28056374959029823, 'loss_val': 2.8197458390543533, 'psi': 0.28056374959029823}
[S13] START round=32 head_norm_before_train=1.637010 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4018158070155662, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3643033484517422, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.863187 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.329419374459298, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.278015199206008, 'psi': 0.13572854291417166}
[S15] START round=32 head_norm_before_train=1.964939 cos_to_last_merge=0.9983 (last merge round=27)
[S15] round=32 local utility u=0.004560 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6167634538993491, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.625882586402857, 'psi': 0.6163342951580373}
[S16] START round=32 head_norm_before_train=1.887361 cos_to_last_merge=0.9789 (last merge round=24)
[S16] round=32 local utility u=0.353542 metrics={'f1_val': 0.18467294715039753, 'auprc': 0.18467294715039753, 'loss_val': 2.4778699503274435, 'psi': 0.18467294715039753}-{'f1_val': 0.15097576667381515, 'auprc': 0.15097576667381515, 'loss_val': 2.8816797659924642, 'psi': 0.15097576667381515}
[S17] START round=32 head_norm_before_train=1.808186 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.1952809366743793, 'auprc': 0.1952809366743793, 'loss_val': 1.0290071591458132, 'psi': 0.1952809366743793}-{'f1_val': 0.23885187603154545, 'auprc': 0.23885187603154545, 'loss_val': 1.0125230660783686, 'psi': 0.23885187603154545}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:44913
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1803 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=-0.0202
[S13] DROPPED delta from S10 (cos=-0.0202 < 0.0)
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] not sending this round → trigger blocked (psi=0.185)
[S8] not sending this round → trigger blocked (psi=0.359)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.840381 (no previous merge yet)
[S2] round=33 local utility u=0.045671 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.8453090277548125, 'psi': 0.26537216828478966}-{'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 2.7551851874576934, 'psi': 0.24520932503356518}
[S3] START round=33 head_norm_before_train=1.920046 cos_to_last_merge=0.9919 (last merge round=26)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.26045307443365695, 'auprc': 0.26045307443365695, 'loss_val': 1.732184369213734, 'psi': 0.26045307443365695}-{'f1_val': 0.26159349593495934, 'auprc': 0.26159349593495934, 'loss_val': 1.6955733747919897, 'psi': 0.26159349593495934}
[S4] START round=33 head_norm_before_train=1.914399 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1905728548271504, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.17376046060032, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=2.036208 cos_to_last_merge=0.9869 (last merge round=26)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5052363197912575, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4933931715517472, 'psi': 0.3335071121394324}
[S6] START round=33 head_norm_before_train=1.747146 (no previous merge yet)
[S6] round=33 local utility u=0.923474 metrics={'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 5.966396046924816, 'psi': 0.09965504024530472}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.916449046638099, 'psi': 0.0}
[S7] START round=33 head_norm_before_train=1.814385 (no previous merge yet)
[S7] round=33 local utility u=0.040972 metrics={'f1_val': 0.24950248756218907, 'auprc': 0.24950248756218907, 'loss_val': 0.4548467866271707, 'psi': 0.24950248756218907}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.5379126639127152, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=33 head_norm_before_train=1.970869 (no previous merge yet)
[S8] round=33 local utility u=0.010918 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5831947631685835, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6050301765858731, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.960270 cos_to_last_merge=0.9902 (last merge round=26)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.111101490644747, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0581658968619228, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=1.910977 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.2627720239535003, 'auprc': 0.2627720239535003, 'loss_val': 1.8121243907723739, 'psi': 0.2627720239535003}-{'f1_val': 0.32325799798874116, 'auprc': 0.32325799798874116, 'loss_val': 1.5552095095063772, 'psi': 0.32325799798874116}
[S11] START round=33 head_norm_before_train=1.844316 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.2807086614173228, 'auprc': 0.2807086614173228, 'loss_val': 2.8926556854069094, 'psi': 0.2807086614173228}-{'f1_val': 0.28056374959029823, 'auprc': 0.28056374959029823, 'loss_val': 2.843859925720333, 'psi': 0.28056374959029823}
[S13] START round=33 head_norm_before_train=1.645511 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.43565396361401, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4018158070155662, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=1.874294 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.381289011024843, 'psi': 0.13582554517133957}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.329419374459298, 'psi': 0.13592717296421}
[S15] START round=33 head_norm_before_train=1.986989 cos_to_last_merge=0.9976 (last merge round=27)
[S15] round=33 local utility u=0.010471 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5958207341215129, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6167634538993491, 'psi': 0.6163342951580373}
[S16] START round=33 head_norm_before_train=1.901188 cos_to_last_merge=0.9772 (last merge round=24)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.05911662866311967, 'auprc': 0.05911662866311967, 'loss_val': 4.146002940575799, 'psi': 0.059116628663119675}-{'f1_val': 0.18467294715039753, 'auprc': 0.18467294715039753, 'loss_val': 2.4778699503274435, 'psi': 0.18467294715039753}
[S17] START round=33 head_norm_before_train=1.817431 (no previous merge yet)
[S17] round=33 local utility u=0.249469 metrics={'f1_val': 0.25248254446120644, 'auprc': 0.25248254446120644, 'loss_val': 1.0448840298589213, 'psi': 0.25248254446120644}-{'f1_val': 0.1952809366743793, 'auprc': 0.1952809366743793, 'loss_val': 1.0290071591458132, 'psi': 0.1952809366743793}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S6] not sending this round → trigger blocked (psi=0.100)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=-0.0321
[S3] DROPPED delta from S17 (cos=-0.0321 < 0.0)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:44907
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] cosine check vs S2: cos=-0.0335
[S3] DROPPED delta from S2 (cos=-0.0335 < 0.0)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S15
[S2] cosine check vs S15: cos=-0.0050
[S2] DROPPED delta from S15 (cos=-0.0050 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=-0.1387
[S6] DROPPED delta from S8 (cos=-0.1387 < 0.0)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.847557 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.25984833232668947, 'auprc': 0.25984833232668947, 'loss_val': 3.0539191056740744, 'psi': 0.25984833232668947}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.8453090277548125, 'psi': 0.26537216828478966}
[S3] START round=34 head_norm_before_train=1.934673 cos_to_last_merge=0.9907 (last merge round=26)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.25909471379821003, 'auprc': 0.25909471379821003, 'loss_val': 1.7616772900924935, 'psi': 0.25909471379821003}-{'f1_val': 0.26045307443365695, 'auprc': 0.26045307443365695, 'loss_val': 1.732184369213734, 'psi': 0.26045307443365695}
[S4] START round=34 head_norm_before_train=1.923772 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2152962847916056, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1905728548271504, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=2.050737 cos_to_last_merge=0.9859 (last merge round=26)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5066874964584787, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5052363197912575, 'psi': 0.3335071121394324}
[S6] START round=34 head_norm_before_train=1.751348 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.0159870250231696, 'auprc': 0.0159870250231696, 'loss_val': 6.776060274437925, 'psi': 0.0159870250231696}-{'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 5.966396046924816, 'psi': 0.09965504024530472}
[S7] START round=34 head_norm_before_train=1.826810 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.4569385733281196, 'psi': 0.24962705121829937}-{'f1_val': 0.24950248756218907, 'auprc': 0.24950248756218907, 'loss_val': 0.4548467866271707, 'psi': 0.24950248756218907}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.983002 (no previous merge yet)
[S8] round=34 local utility u=0.007921 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.567352793263903, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5831947631685835, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.975576 cos_to_last_merge=0.9890 (last merge round=26)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1576802982026217, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.111101490644747, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=1.937895 (no previous merge yet)
[S10] round=34 local utility u=0.261098 metrics={'f1_val': 0.29750491054838885, 'auprc': 0.29750491054838885, 'loss_val': 1.602524395294624, 'psi': 0.29750491054838885}-{'f1_val': 0.2627720239535003, 'auprc': 0.2627720239535003, 'loss_val': 1.8121243907723739, 'psi': 0.2627720239535003}
[S11] START round=34 head_norm_before_train=1.854810 (no previous merge yet)
[S11] round=34 local utility u=0.009096 metrics={'f1_val': 0.28802262169258736, 'auprc': 0.28802262169258736, 'loss_val': 2.94028873879728, 'psi': 0.28802262169258736}-{'f1_val': 0.2807086614173228, 'auprc': 0.2807086614173228, 'loss_val': 2.8926556854069094, 'psi': 0.2807086614173228}
[S13] START round=34 head_norm_before_train=1.657435 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4752829462923955, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.43565396361401, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=1.883960 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.426713032198782, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.381289011024843, 'psi': 0.13582554517133957}
[S15] START round=34 head_norm_before_train=2.007905 cos_to_last_merge=0.9969 (last merge round=27)
[S15] round=34 local utility u=0.000226 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5966213728848104, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5958207341215129, 'psi': 0.6163342951580373}
[S16] START round=34 head_norm_before_train=1.913341 cos_to_last_merge=0.9758 (last merge round=24)
[S16] round=34 local utility u=0.721409 metrics={'f1_val': 0.14105646630236793, 'auprc': 0.14105646630236793, 'loss_val': 3.4406432890864624, 'psi': 0.14105646630236793}-{'f1_val': 0.05911662866311967, 'auprc': 0.05911662866311967, 'loss_val': 4.146002940575799, 'psi': 0.059116628663119675}
[S17] START round=34 head_norm_before_train=1.829029 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.23699168059830913, 'auprc': 0.23699168059830913, 'loss_val': 1.1031170774924315, 'psi': 0.2369916805983091}-{'f1_val': 0.25248254446120644, 'auprc': 0.25248254446120644, 'loss_val': 1.0448840298589213, 'psi': 0.25248254446120644}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:44913
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1806) from S11
[S4] cosine check vs S11: cos=-0.0638
[S4] DROPPED delta from S11 (cos=-0.0638 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=-0.0165
[S13] DROPPED delta from S10 (cos=-0.0165 < 0.0)
[S16] not sending this round → trigger blocked (psi=0.141)
[S15] not sending this round → trigger blocked (psi=0.616)
[S8] not sending this round → trigger blocked (psi=0.359)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.854619 (no previous merge yet)
[S2] round=35 local utility u=0.060691 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.9824830650721115, 'psi': 0.2653978324081417}-{'f1_val': 0.25984833232668947, 'auprc': 0.25984833232668947, 'loss_val': 3.0539191056740744, 'psi': 0.25984833232668947}
[S3] START round=35 head_norm_before_train=1.947991 cos_to_last_merge=0.9896 (last merge round=26)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.2587448559670782, 'auprc': 0.2587448559670782, 'loss_val': 1.7896192225405207, 'psi': 0.2587448559670782}-{'f1_val': 0.25909471379821003, 'auprc': 0.25909471379821003, 'loss_val': 1.7616772900924935, 'psi': 0.25909471379821003}
[S4] START round=35 head_norm_before_train=1.931226 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2413708143104079, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2152962847916056, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=2.063075 cos_to_last_merge=0.9849 (last merge round=26)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.535025692179117, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5066874964584787, 'psi': 0.3335071121394324}
[S6] START round=35 head_norm_before_train=1.755426 (no previous merge yet)
[S6] round=35 local utility u=0.170666 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.486585992400873, 'psi': 0.021749084249084248}-{'f1_val': 0.0159870250231696, 'auprc': 0.0159870250231696, 'loss_val': 6.776060274437925, 'psi': 0.0159870250231696}
[S7] START round=35 head_norm_before_train=1.837236 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.47792125432679217, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.4569385733281196, 'psi': 0.24962705121829937}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.996040 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6441180135895489, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.567352793263903, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.989150 cos_to_last_merge=0.9879 (last merge round=26)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2001446005719516, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1576802982026217, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=1.965134 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.27386241544398887, 'auprc': 0.27386241544398887, 'loss_val': 1.8566991213108661, 'psi': 0.27386241544398887}-{'f1_val': 0.29750491054838885, 'auprc': 0.29750491054838885, 'loss_val': 1.602524395294624, 'psi': 0.29750491054838885}
[S11] START round=35 head_norm_before_train=1.864451 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.2903094462540717, 'auprc': 0.2903094462540717, 'loss_val': 2.9692857921849254, 'psi': 0.2903094462540717}-{'f1_val': 0.28802262169258736, 'auprc': 0.28802262169258736, 'loss_val': 2.94028873879728, 'psi': 0.28802262169258736}
[S13] START round=35 head_norm_before_train=1.668630 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4853534818579623, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4752829462923955, 'psi': 0.3599362944611573}
[S14] START round=35 head_norm_before_train=1.893384 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.468758219636293, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.426713032198782, 'psi': 0.13582554517133957}
[S15] START round=35 head_norm_before_train=2.028546 cos_to_last_merge=0.9961 (last merge round=27)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6036215264549639, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5966213728848104, 'psi': 0.6164734888353558}
[S16] START round=35 head_norm_before_train=1.923219 cos_to_last_merge=0.9747 (last merge round=24)
[S16] round=35 local utility u=1.000000 metrics={'f1_val': 0.2476621943428007, 'auprc': 0.2476621943428007, 'loss_val': 1.9959859737239911, 'psi': 0.24766219434280073}-{'f1_val': 0.14105646630236793, 'auprc': 0.14105646630236793, 'loss_val': 3.4406432890864624, 'psi': 0.14105646630236793}
[S17] START round=35 head_norm_before_train=1.840895 (no previous merge yet)
[S17] round=35 local utility u=0.091710 metrics={'f1_val': 0.261662568380661, 'auprc': 0.261662568380661, 'loss_val': 1.1417343887124913, 'psi': 0.261662568380661}-{'f1_val': 0.23699168059830913, 'auprc': 0.23699168059830913, 'loss_val': 1.1031170774924315, 'psi': 0.2369916805983091}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S6] not sending this round → trigger blocked (psi=0.022)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.005 → S4@127.0.0.1:44904
[S14] ⇄ pheromone p=0.004 → S16@127.0.0.1:44916
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] ⇄ pheromone p=0.249 → S8@127.0.0.1:44909
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.007 → S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S10] ⇄ pheromone p=0.108 → S13@127.0.0.1:44913
[S4] ⇄ pheromone p=0.002 → S11@127.0.0.1:44912
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=-0.0327
[S3] DROPPED delta from S17 (cos=-0.0327 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] ⇄ pheromone p=0.083 → S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:44905
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] cosine check vs S2: cos=-0.0318
[S3] DROPPED delta from S2 (cos=-0.0318 < 0.0)
[S3] ⇄ pheromone p=0.005 → S17@127.0.0.1:44917
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S16
[S5] cosine check vs S16: cos=-0.1368
[S5] DROPPED delta from S16 (cos=-0.1368 < 0.0)
[S2] ⇄ pheromone p=0.030 → S3@127.0.0.1:44903
[S15] ⇄ pheromone p=0.018 → S2@127.0.0.1:44902
[S16] ⇄ pheromone p=0.472 → S5@127.0.0.1:44905
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.010 → S16@127.0.0.1:44916
[S9] ⇄ pheromone p=0.005 → S8@127.0.0.1:44909
[S8] ⇄ pheromone p=0.023 → S6@127.0.0.1:44907
[S2] START round=36 head_norm_before_train=1.861901 (no previous merge yet)
[S2] round=36 local utility u=0.049387 metrics={'f1_val': 0.26521452145214525, 'auprc': 0.26521452145214525, 'loss_val': 2.8820584276716317, 'psi': 0.26521452145214525}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.9824830650721115, 'psi': 0.2653978324081417}
[S3] START round=36 head_norm_before_train=1.960280 cos_to_last_merge=0.9885 (last merge round=26)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2587448559670782, 'auprc': 0.2587448559670782, 'loss_val': 1.822036950280473, 'psi': 0.2587448559670782}-{'f1_val': 0.2587448559670782, 'auprc': 0.2587448559670782, 'loss_val': 1.7896192225405207, 'psi': 0.2587448559670782}
[S4] START round=36 head_norm_before_train=1.939852 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2491573780052097, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2413708143104079, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=2.071850 cos_to_last_merge=0.9837 (last merge round=26)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5474188196295673, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.535025692179117, 'psi': 0.3335071121394324}
[S6] START round=36 head_norm_before_train=1.760507 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.587500060887654, 'psi': 0.02153000458085204}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.486585992400873, 'psi': 0.021749084249084248}
[S7] START round=36 head_norm_before_train=1.847120 (no previous merge yet)
[S7] round=36 local utility u=0.728966 metrics={'f1_val': 0.4086161338785129, 'auprc': 0.4086161338785129, 'loss_val': 0.4508902685379002, 'psi': 0.4086161338785129}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.47792125432679217, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=36 head_norm_before_train=2.007801 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6774254517886731, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6441180135895489, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=2.001532 cos_to_last_merge=0.9869 (last merge round=26)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.243952762569299, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2001446005719516, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=1.990200 (no previous merge yet)
[S10] round=36 local utility u=0.205150 metrics={'f1_val': 0.29698906713465606, 'auprc': 0.29698906713465606, 'loss_val': 1.6545381933667462, 'psi': 0.29698906713465606}-{'f1_val': 0.27386241544398887, 'auprc': 0.27386241544398887, 'loss_val': 1.8566991213108661, 'psi': 0.27386241544398887}
[S11] START round=36 head_norm_before_train=1.873394 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.2883720930232558, 'auprc': 0.2883720930232558, 'loss_val': 2.9791370161224946, 'psi': 0.2883720930232558}-{'f1_val': 0.2903094462540717, 'auprc': 0.2903094462540717, 'loss_val': 2.9692857921849254, 'psi': 0.2903094462540717}
[S13] START round=36 head_norm_before_train=1.677403 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5067398710100475, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4853534818579623, 'psi': 0.3599362944611573}
[S14] START round=36 head_norm_before_train=1.902676 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.509877806313443, 'psi': 0.13572854291417166}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.468758219636293, 'psi': 0.13587634006482174}
[S15] START round=36 head_norm_before_train=2.047473 cos_to_last_merge=0.9953 (last merge round=27)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6134506608259811, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6036215264549639, 'psi': 0.6163342951580373}
[S16] START round=36 head_norm_before_train=1.931556 cos_to_last_merge=0.9737 (last merge round=24)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.09096722621902477, 'auprc': 0.09096722621902477, 'loss_val': 3.6259538050249946, 'psi': 0.09096722621902477}-{'f1_val': 0.2476621943428007, 'auprc': 0.2476621943428007, 'loss_val': 1.9959859737239911, 'psi': 0.24766219434280073}
[S17] START round=36 head_norm_before_train=1.856205 (no previous merge yet)
[S17] round=36 local utility u=0.200606 metrics={'f1_val': 0.3131206920684558, 'auprc': 0.3131206920684558, 'loss_val': 1.2036462743144214, 'psi': 0.3131206920684558}-{'f1_val': 0.261662568380661, 'auprc': 0.261662568380661, 'loss_val': 1.1417343887124913, 'psi': 0.261662568380661}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.313)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:44913
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.265)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=-0.0137
[S13] DROPPED delta from S10 (cos=-0.0137 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.868899 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.25156523916854495, 'auprc': 0.25156523916854495, 'loss_val': 2.791476772796013, 'psi': 0.25156523916854495}-{'f1_val': 0.26521452145214525, 'auprc': 0.26521452145214525, 'loss_val': 2.8820584276716317, 'psi': 0.26521452145214525}
[S3] START round=37 head_norm_before_train=1.971890 cos_to_last_merge=0.9875 (last merge round=26)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 1.8544494286264215, 'psi': 0.25869495339119253}-{'f1_val': 0.2587448559670782, 'auprc': 0.2587448559670782, 'loss_val': 1.822036950280473, 'psi': 0.2587448559670782}
[S4] START round=37 head_norm_before_train=1.951156 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2572603891809642, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2491573780052097, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=2.082210 cos_to_last_merge=0.9829 (last merge round=26)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5642548032474997, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5474188196295673, 'psi': 0.3335071121394324}
[S6] START round=37 head_norm_before_train=1.766591 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.58892590880782, 'psi': 0.02153000458085204}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.587500060887654, 'psi': 0.02153000458085204}
[S7] START round=37 head_norm_before_train=1.860001 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.5168501103443898, 'psi': 0.24962705121829937}-{'f1_val': 0.4086161338785129, 'auprc': 0.4086161338785129, 'loss_val': 0.4508902685379002, 'psi': 0.4086161338785129}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=2.019556 (no previous merge yet)
[S8] round=37 local utility u=0.005758 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6659087865389204, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6774254517886731, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=2.013328 cos_to_last_merge=0.9859 (last merge round=26)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.282379342995795, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.243952762569299, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=2.012230 (no previous merge yet)
[S10] round=37 local utility u=0.037559 metrics={'f1_val': 0.3135928289154095, 'auprc': 0.3135928289154095, 'loss_val': 1.728854574003512, 'psi': 0.3135928289154095}-{'f1_val': 0.29698906713465606, 'auprc': 0.29698906713465606, 'loss_val': 1.6545381933667462, 'psi': 0.29698906713465606}
[S11] START round=37 head_norm_before_train=1.881991 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.28446040295232394, 'auprc': 0.28446040295232394, 'loss_val': 2.9879816058663473, 'psi': 0.28446040295232394}-{'f1_val': 0.2883720930232558, 'auprc': 0.2883720930232558, 'loss_val': 2.9791370161224946, 'psi': 0.2883720930232558}
[S13] START round=37 head_norm_before_train=1.684561 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5201426492104793, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5067398710100475, 'psi': 0.3599362944611573}
[S14] START round=37 head_norm_before_train=1.911581 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 6.55129975557173, 'psi': 0.1355297641332834}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.509877806313443, 'psi': 0.13572854291417166}
[S15] START round=37 head_norm_before_train=2.064997 cos_to_last_merge=0.9946 (last merge round=27)
[S15] round=37 local utility u=0.000639 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6121728139338933, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6134506608259811, 'psi': 0.6163342951580373}
[S16] START round=37 head_norm_before_train=1.938047 cos_to_last_merge=0.9730 (last merge round=24)
[S16] round=37 local utility u=0.031113 metrics={'f1_val': 0.10035149384885765, 'auprc': 0.10035149384885765, 'loss_val': 3.648185766391287, 'psi': 0.10035149384885765}-{'f1_val': 0.09096722621902477, 'auprc': 0.09096722621902477, 'loss_val': 3.6259538050249946, 'psi': 0.09096722621902477}
[S17] START round=37 head_norm_before_train=1.867436 (no previous merge yet)
[S17] round=37 local utility u=0.063324 metrics={'f1_val': 0.2984177214443598, 'auprc': 0.2984177214443598, 'loss_val': 0.9446705938021251, 'psi': 0.2984177214443598}-{'f1_val': 0.3131206920684558, 'auprc': 0.3131206920684558, 'loss_val': 1.2036462743144214, 'psi': 0.3131206920684558}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.314)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:44903
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=-0.0335
[S3] DROPPED delta from S17 (cos=-0.0335 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44910
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S16
[S9] cosine check vs S16: cos=0.9378
[S2] RECEIVED delta(kind=head bytes=1801) from S15
[S2] cosine check vs S15: cos=-0.0054
[S2] DROPPED delta from S15 (cos=-0.0054 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=-0.1388
[S6] DROPPED delta from S8 (cos=-0.1388 < 0.0)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=37 metric=0.3687 head_norm=2.024241
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.521018e-01
[S9] stored merged vector for next round verification (round=37)
[S9] DEBUG after merge:  round=37 metric=0.3687 head_norm=1.953754 delta_norm=0.352102
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.875662 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.2457492354740061, 'auprc': 0.2457492354740061, 'loss_val': 2.815258741949496, 'psi': 0.2457492354740061}-{'f1_val': 0.25156523916854495, 'auprc': 0.25156523916854495, 'loss_val': 2.791476772796013, 'psi': 0.25156523916854495}
[S3] START round=38 head_norm_before_train=1.982905 cos_to_last_merge=0.9865 (last merge round=26)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.2587448559670782, 'auprc': 0.2587448559670782, 'loss_val': 1.8808397948836983, 'psi': 0.2587448559670782}-{'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 1.8544494286264215, 'psi': 0.25869495339119253}
[S4] START round=38 head_norm_before_train=1.962411 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2773074272953537, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2572603891809642, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=2.094445 cos_to_last_merge=0.9819 (last merge round=26)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.594630762027491, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5642548032474997, 'psi': 0.3335071121394324}
[S6] START round=38 head_norm_before_train=1.774030 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 6.682057157591327, 'psi': 0.020871559633027524}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.58892590880782, 'psi': 0.02153000458085204}
[S7] START round=38 head_norm_before_train=1.871921 (no previous merge yet)
[S7] round=38 local utility u=1.000000 metrics={'f1_val': 0.47742167963450655, 'auprc': 0.47742167963450655, 'loss_val': 0.4529798399949692, 'psi': 0.47742167963450655}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.5168501103443898, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=38 head_norm_before_train=2.031676 (no previous merge yet)
[S8] round=38 local utility u=0.003683 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6585425412183565, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6659087865389204, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.953754 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=38 local utility u=0.082489 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1174015987167794, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.282379342995795, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=2.032179 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.3000067690828908, 'auprc': 0.3000067690828908, 'loss_val': 1.69679012706066, 'psi': 0.3000067690828908}-{'f1_val': 0.3135928289154095, 'auprc': 0.3135928289154095, 'loss_val': 1.728854574003512, 'psi': 0.3135928289154095}
[S11] START round=38 head_norm_before_train=1.890271 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.28366819176447183, 'auprc': 0.28366819176447183, 'loss_val': 3.002609299661888, 'psi': 0.28366819176447183}-{'f1_val': 0.28446040295232394, 'auprc': 0.28446040295232394, 'loss_val': 2.9879816058663473, 'psi': 0.28446040295232394}
[S13] START round=38 head_norm_before_train=1.691208 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.536069714031215, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5201426492104793, 'psi': 0.3599362944611573}
[S14] START round=38 head_norm_before_train=1.920030 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.588552889450787, 'psi': 0.13587634006482174}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 6.55129975557173, 'psi': 0.1355297641332834}
[S15] START round=38 head_norm_before_train=2.082004 cos_to_last_merge=0.9938 (last merge round=27)
[S15] round=38 local utility u=0.006933 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.5895115926270345, 'psi': 0.6153571007984797}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6121728139338933, 'psi': 0.6163342951580373}
[S16] START round=38 head_norm_before_train=1.945432 cos_to_last_merge=0.9722 (last merge round=24)
[S16] round=38 local utility u=0.257092 metrics={'f1_val': 0.13480077120822623, 'auprc': 0.13480077120822623, 'loss_val': 3.4440444526741434, 'psi': 0.13480077120822623}-{'f1_val': 0.10035149384885765, 'auprc': 0.10035149384885765, 'loss_val': 3.648185766391287, 'psi': 0.10035149384885765}
[S17] START round=38 head_norm_before_train=1.877952 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.3123520998198173, 'psi': 0.30380970798684975}-{'f1_val': 0.2984177214443598, 'auprc': 0.2984177214443598, 'loss_val': 0.9446705938021251, 'psi': 0.2984177214443598}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.135)
[S15] not sending this round → trigger blocked (psi=0.615)
[S8] not sending this round → trigger blocked (psi=0.359)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S9
[S8] cosine check vs S9: cos=0.0164
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.3594 head_norm=2.044380
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.406081e+00
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.7677 head_norm=1.429258 delta_norm=1.406081
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.881972 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.2455690013445789, 'auprc': 0.2455690013445789, 'loss_val': 2.836321069477, 'psi': 0.24556900134457893}-{'f1_val': 0.2457492354740061, 'auprc': 0.2457492354740061, 'loss_val': 2.815258741949496, 'psi': 0.2457492354740061}
[S3] START round=39 head_norm_before_train=1.992918 cos_to_last_merge=0.9856 (last merge round=26)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.2590446761941548, 'auprc': 0.2590446761941548, 'loss_val': 1.9040344970429424, 'psi': 0.2590446761941548}-{'f1_val': 0.2587448559670782, 'auprc': 0.2587448559670782, 'loss_val': 1.8808397948836983, 'psi': 0.2587448559670782}
[S4] START round=39 head_norm_before_train=1.972506 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.293704952712117, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2773074272953537, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=2.108653 cos_to_last_merge=0.9808 (last merge round=26)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6390685349836938, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.594630762027491, 'psi': 0.3335071121394324}
[S6] START round=39 head_norm_before_train=1.782426 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 6.749658022349381, 'psi': 0.01954921803127875}-{'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 6.682057157591327, 'psi': 0.020871559633027524}
[S7] START round=39 head_norm_before_train=1.883443 (no previous merge yet)
[S7] round=39 local utility u=0.011418 metrics={'f1_val': 0.4789796546762491, 'auprc': 0.4789796546762491, 'loss_val': 0.4441665397253252, 'psi': 0.4789796546762491}-{'f1_val': 0.47742167963450655, 'auprc': 0.47742167963450655, 'loss_val': 0.4529798399949692, 'psi': 0.47742167963450655}
[S7] not sending this round → trigger blocked (psi=0.479)
[S7] r=40 psi=0.479 u=0.0114 p_local=0.2874 f1=0.479 auprc=0.479 bytes=35973
[S8] START round=39 head_norm_before_train=1.429258 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=1.000000 metrics={'f1_val': 0.6202471363761686, 'auprc': 0.6202471363761686, 'loss_val': 0.5310406629482577, 'psi': 0.6202471363761686}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6585425412183565, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=1.964738 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.170095506420061, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1174015987167794, 'psi': 0.36867172340800847}
[S10] START round=39 head_norm_before_train=2.050262 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.2914409623062681, 'auprc': 0.2914409623062681, 'loss_val': 1.6674710766252892, 'psi': 0.2914409623062681}-{'f1_val': 0.3000067690828908, 'auprc': 0.3000067690828908, 'loss_val': 1.69679012706066, 'psi': 0.3000067690828908}
[S11] START round=39 head_norm_before_train=1.898192 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.2842902711323764, 'auprc': 0.2842902711323764, 'loss_val': 3.021905065713866, 'psi': 0.2842902711323764}-{'f1_val': 0.28366819176447183, 'auprc': 0.28366819176447183, 'loss_val': 3.002609299661888, 'psi': 0.28366819176447183}
[S13] START round=39 head_norm_before_train=1.698908 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5475338414907454, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.536069714031215, 'psi': 0.3599362944611573}
[S14] START round=39 head_norm_before_train=1.928067 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.627063864094539, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.588552889450787, 'psi': 0.13587634006482174}
[S15] START round=39 head_norm_before_train=2.097827 cos_to_last_merge=0.9930 (last merge round=27)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6075277908840357, 'psi': 0.6163342951580373}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.5895115926270345, 'psi': 0.6153571007984797}
[S16] START round=39 head_norm_before_train=1.952818 cos_to_last_merge=0.9714 (last merge round=24)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.07947776417788657, 'auprc': 0.07947776417788657, 'loss_val': 4.064922232817372, 'psi': 0.07947776417788657}-{'f1_val': 0.13480077120822623, 'auprc': 0.13480077120822623, 'loss_val': 3.4440444526741434, 'psi': 0.13480077120822623}
[S17] START round=39 head_norm_before_train=1.888614 (no previous merge yet)
[S17] round=39 local utility u=0.053294 metrics={'f1_val': 0.3114871450549657, 'auprc': 0.3114871450549657, 'loss_val': 1.2748615393782845, 'psi': 0.3114871450549657}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.3123520998198173, 'psi': 0.30380970798684975}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0009 f1=0.357 auprc=0.357 bytes=25227
[S6] r=40 psi=0.020 u=0.0000 p_local=0.1021 f1=0.020 auprc=0.020 bytes=0
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.284 u=0.0000 p_local=0.0020 f1=0.284 auprc=0.284 bytes=7197
[S17] sending update (kind=head size=1801 to 1 peers)
[S10] r=40 psi=0.291 u=0.0000 p_local=0.0699 f1=0.291 auprc=0.291 bytes=27004
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0028 f1=0.360 auprc=0.360 bytes=9004
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0018 f1=0.136 auprc=0.136 bytes=0
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=-0.0341
[S3] DROPPED delta from S17 (cos=-0.0341 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:44907
[S17] r=40 psi=0.311 u=0.0533 p_local=0.0731 f1=0.311 auprc=0.311 bytes=34224
[S3] r=40 psi=0.259 u=0.0000 p_local=0.0022 f1=0.259 auprc=0.259 bytes=17997
[S8] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S8
[S6] cosine check vs S8: cos=-0.1385
[S6] DROPPED delta from S8 (cos=-0.1385 < 0.0)
[S15] r=40 psi=0.616 u=0.0000 p_local=0.0087 f1=0.616 auprc=0.616 bytes=30594
[S16] r=40 psi=0.079 u=0.0000 p_local=0.2385 f1=0.079 auprc=0.079 bytes=3597
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.334 u=0.0000 p_local=0.0039 f1=0.334 auprc=0.334 bytes=23411
[S2] r=40 psi=0.246 u=0.0000 p_local=0.0174 f1=0.246 auprc=0.246 bytes=18001
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0153 f1=0.369 auprc=0.369 bytes=14413
[S8] r=40 psi=0.620 u=1.0000 p_local=0.2108 f1=0.620 auprc=0.620 bytes=27029
[S2] START round=40 head_norm_before_train=1.887844 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.2455690013445789, 'auprc': 0.2455690013445789, 'loss_val': 2.8511840125206804, 'psi': 0.24556900134457893}-{'f1_val': 0.2455690013445789, 'auprc': 0.2455690013445789, 'loss_val': 2.836321069477, 'psi': 0.24556900134457893}
[S3] START round=40 head_norm_before_train=2.002284 cos_to_last_merge=0.9848 (last merge round=26)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.2588946792768449, 'auprc': 0.2588946792768449, 'loss_val': 1.9233800330769262, 'psi': 0.2588946792768449}-{'f1_val': 0.2590446761941548, 'auprc': 0.2590446761941548, 'loss_val': 1.9040344970429424, 'psi': 0.2590446761941548}
[S4] START round=40 head_norm_before_train=1.982221 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3119898073765115, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.293704952712117, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=2.124261 cos_to_last_merge=0.9795 (last merge round=26)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.686688023206142, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6390685349836938, 'psi': 0.3335071121394324}
[S6] START round=40 head_norm_before_train=1.791093 (no previous merge yet)
[S6] round=40 local utility u=0.196209 metrics={'f1_val': 0.032243618450515, 'auprc': 0.032243618450515, 'loss_val': 6.471489592964191, 'psi': 0.032243618450515}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 6.749658022349381, 'psi': 0.01954921803127875}
[S7] START round=40 head_norm_before_train=1.896834 (no previous merge yet)
[S7] round=40 local utility u=0.888501 metrics={'f1_val': 0.6642426795781429, 'auprc': 0.6642426795781429, 'loss_val': 0.3345308112820505, 'psi': 0.6642426795781429}-{'f1_val': 0.4789796546762491, 'auprc': 0.4789796546762491, 'loss_val': 0.4441665397253252, 'psi': 0.4789796546762491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=40 head_norm_before_train=1.463705 cos_to_last_merge=0.9995 (last merge round=38)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.5531822431909426, 'auprc': 0.5531822431909426, 'loss_val': 0.4960429075466187, 'psi': 0.5531822431909426}-{'f1_val': 0.6202471363761686, 'auprc': 0.6202471363761686, 'loss_val': 0.5310406629482577, 'psi': 0.6202471363761686}
[S9] START round=40 head_norm_before_train=1.975845 cos_to_last_merge=0.9999 (last merge round=37)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2136809694717363, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.170095506420061, 'psi': 0.36867172340800847}
[S10] START round=40 head_norm_before_train=2.067533 (no previous merge yet)
[S10] round=40 local utility u=0.000968 metrics={'f1_val': 0.29795975680823383, 'auprc': 0.29795975680823383, 'loss_val': 1.7242044358815334, 'psi': 0.29795975680823383}-{'f1_val': 0.2914409623062681, 'auprc': 0.2914409623062681, 'loss_val': 1.6674710766252892, 'psi': 0.2914409623062681}
[S11] START round=40 head_norm_before_train=1.906021 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.28081922016541944, 'auprc': 0.28081922016541944, 'loss_val': 3.0265913425621815, 'psi': 0.28081922016541944}-{'f1_val': 0.2842902711323764, 'auprc': 0.2842902711323764, 'loss_val': 3.021905065713866, 'psi': 0.2842902711323764}
[S13] START round=40 head_norm_before_train=1.706241 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5599608815829835, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5475338414907454, 'psi': 0.3599362944611573}
[S14] START round=40 head_norm_before_train=1.935537 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.66127540763628, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.627063864094539, 'psi': 0.13582554517133957}
[S15] START round=40 head_norm_before_train=2.111514 cos_to_last_merge=0.9925 (last merge round=27)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6211547592258374, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6075277908840357, 'psi': 0.6163342951580373}
[S16] START round=40 head_norm_before_train=1.959439 cos_to_last_merge=0.9707 (last merge round=24)
[S16] round=40 local utility u=0.814034 metrics={'f1_val': 0.1564467076879553, 'auprc': 0.1564467076879553, 'loss_val': 3.1295753658742522, 'psi': 0.1564467076879553}-{'f1_val': 0.07947776417788657, 'auprc': 0.07947776417788657, 'loss_val': 4.064922232817372, 'psi': 0.07947776417788657}
[S17] START round=40 head_norm_before_train=1.898054 (no previous merge yet)
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.5981042485593429, 'auprc': 0.5981042485593429, 'loss_val': 0.8078764842728345, 'psi': 0.5981042485593429}-{'f1_val': 0.3114871450549657, 'auprc': 0.3114871450549657, 'loss_val': 1.2748615393782845, 'psi': 0.3114871450549657}
[S17] not sending this round → trigger blocked (psi=0.598)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.032)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:44913
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.001 → S16@127.0.0.1:44916
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.001 → S11@127.0.0.1:44912
[S6] ⇄ pheromone p=0.121 → S8@127.0.0.1:44909
[S11] ⇄ pheromone p=0.002 → S4@127.0.0.1:44904
[S13] ⇄ pheromone p=0.002 → S10@127.0.0.1:44911
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] ⇄ pheromone p=0.258 → S3@127.0.0.1:44903
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=-0.0093
[S13] DROPPED delta from S10 (cos=-0.0093 < 0.0)
[S10] ⇄ pheromone p=0.056 → S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] ⇄ pheromone p=0.002 → S17@127.0.0.1:44917
[S9] RECEIVED delta(kind=head bytes=1801) from S16
[S9] cosine check vs S16: cos=0.9814
[S15] ⇄ pheromone p=0.007 → S2@127.0.0.1:44902
[S16] ⇄ pheromone p=0.354 → S9@127.0.0.1:44910
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.014 → S3@127.0.0.1:44903
[S5] ⇄ pheromone p=0.003 → S16@127.0.0.1:44916
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=40 metric=0.3687 head_norm=1.986140
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.909970e-01
[S9] stored merged vector for next round verification (round=40)
[S9] DEBUG after merge:  round=40 metric=0.3687 head_norm=1.966875 delta_norm=0.190997
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.012 → S8@127.0.0.1:44909
[S8] ⇄ pheromone p=0.169 → S6@127.0.0.1:44907
[S2] START round=41 head_norm_before_train=1.893718 (no previous merge yet)
[S2] round=41 local utility u=0.003858 metrics={'f1_val': 0.24620098039215688, 'auprc': 0.24620098039215688, 'loss_val': 2.849156505187459, 'psi': 0.24620098039215688}-{'f1_val': 0.2455690013445789, 'auprc': 0.2455690013445789, 'loss_val': 2.8511840125206804, 'psi': 0.24556900134457893}
[S3] START round=41 head_norm_before_train=2.011233 cos_to_last_merge=0.9840 (last merge round=26)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.25894465894465896, 'auprc': 0.25894465894465896, 'loss_val': 1.9458077895853534, 'psi': 0.25894465894465896}-{'f1_val': 0.2588946792768449, 'auprc': 0.2588946792768449, 'loss_val': 1.9233800330769262, 'psi': 0.2588946792768449}
[S4] START round=41 head_norm_before_train=1.988210 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3258743562414965, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3119898073765115, 'psi': 0.3567939207526687}
[S5] START round=41 head_norm_before_train=2.132898 cos_to_last_merge=0.9784 (last merge round=26)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.717185111165058, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.686688023206142, 'psi': 0.3335071121394324}
[S6] START round=41 head_norm_before_train=1.799776 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.728858709178895, 'psi': 0.021749084249084248}-{'f1_val': 0.032243618450515, 'auprc': 0.032243618450515, 'loss_val': 6.471489592964191, 'psi': 0.032243618450515}
[S7] START round=41 head_norm_before_train=1.911192 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.4657817582782152, 'auprc': 0.4657817582782152, 'loss_val': 0.45049171861737236, 'psi': 0.4657817582782152}-{'f1_val': 0.6642426795781429, 'auprc': 0.6642426795781429, 'loss_val': 0.3345308112820505, 'psi': 0.6642426795781429}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.517294 cos_to_last_merge=0.9973 (last merge round=38)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.538820655949728, 'auprc': 0.538820655949728, 'loss_val': 0.46591172581982987, 'psi': 0.538820655949728}-{'f1_val': 0.5531822431909426, 'auprc': 0.5531822431909426, 'loss_val': 0.4960429075466187, 'psi': 0.5531822431909426}
[S9] START round=41 head_norm_before_train=1.966875 cos_to_last_merge=1.0000 (last merge round=40)
[S9] round=41 local utility u=0.048049 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1175835240272383, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2136809694717363, 'psi': 0.36867172340800847}
[S10] START round=41 head_norm_before_train=2.084241 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.2935473571457998, 'auprc': 0.2935473571457998, 'loss_val': 1.7060368843594391, 'psi': 0.2935473571457998}-{'f1_val': 0.29795975680823383, 'auprc': 0.29795975680823383, 'loss_val': 1.7242044358815334, 'psi': 0.29795975680823383}
[S11] START round=41 head_norm_before_train=1.913568 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.28054298642533937, 'auprc': 0.28054298642533937, 'loss_val': 3.036619631302488, 'psi': 0.28054298642533937}-{'f1_val': 0.28081922016541944, 'auprc': 0.28081922016541944, 'loss_val': 3.0265913425621815, 'psi': 0.28081922016541944}
[S13] START round=41 head_norm_before_train=1.711736 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5726267385962038, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5599608815829835, 'psi': 0.3599362944611573}
[S14] START round=41 head_norm_before_train=1.943182 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 6.702874664406433, 'psi': 0.13373403456048086}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.66127540763628, 'psi': 0.13587634006482174}
[S15] START round=41 head_norm_before_train=2.124744 cos_to_last_merge=0.9919 (last merge round=27)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.634546388913231, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6211547592258374, 'psi': 0.6164734888353558}
[S16] START round=41 head_norm_before_train=1.966062 cos_to_last_merge=0.9700 (last merge round=24)
[S16] round=41 local utility u=0.473761 metrics={'f1_val': 0.19386551317341724, 'auprc': 0.19386551317341724, 'loss_val': 2.5188226792372066, 'psi': 0.19386551317341724}-{'f1_val': 0.1564467076879553, 'auprc': 0.1564467076879553, 'loss_val': 3.1295753658742522, 'psi': 0.1564467076879553}
[S17] START round=41 head_norm_before_train=1.905830 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.3131206920684558, 'auprc': 0.3131206920684558, 'loss_val': 1.2454332710997404, 'psi': 0.3131206920684558}-{'f1_val': 0.5981042485593429, 'auprc': 0.5981042485593429, 'loss_val': 0.8078764842728345, 'psi': 0.5981042485593429}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:44903
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1796 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.194)
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=-0.0280
[S3] DROPPED delta from S2 (cos=-0.0280 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S9
[S8] cosine check vs S9: cos=0.6305
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.5388 head_norm=1.572263
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.844197e-01
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9989 head_norm=1.604805 delta_norm=0.784420
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.899466 (no previous merge yet)
[S2] round=42 local utility u=0.041594 metrics={'f1_val': 0.25706973768394115, 'auprc': 0.25706973768394115, 'loss_val': 2.863786792017269, 'psi': 0.25706973768394115}-{'f1_val': 0.24620098039215688, 'auprc': 0.24620098039215688, 'loss_val': 2.849156505187459, 'psi': 0.24620098039215688}
[S3] START round=42 head_norm_before_train=2.019923 cos_to_last_merge=0.9832 (last merge round=26)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 1.966246436119285, 'psi': 0.2587947777992154}-{'f1_val': 0.25894465894465896, 'auprc': 0.25894465894465896, 'loss_val': 1.9458077895853534, 'psi': 0.25894465894465896}
[S4] START round=42 head_norm_before_train=1.991719 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.335249749127266, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3258743562414965, 'psi': 0.3567939207526687}
[S5] START round=42 head_norm_before_train=2.143921 cos_to_last_merge=0.9774 (last merge round=26)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.72271016403663, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.717185111165058, 'psi': 0.3335071121394324}
[S6] START round=42 head_norm_before_train=1.808235 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 7.082113465945013, 'psi': 0.017105871474803514}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.728858709178895, 'psi': 0.021749084249084248}
[S7] START round=42 head_norm_before_train=1.923936 (no previous merge yet)
[S7] round=42 local utility u=0.194980 metrics={'f1_val': 0.4982204138618798, 'auprc': 0.4982204138618798, 'loss_val': 0.35247968990009876, 'psi': 0.4982204138618798}-{'f1_val': 0.4657817582782152, 'auprc': 0.4657817582782152, 'loss_val': 0.45049171861737236, 'psi': 0.4657817582782152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=42 head_norm_before_train=1.604805 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=1.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.4804448904015668, 'psi': 0.9988708350860451}-{'f1_val': 0.538820655949728, 'auprc': 0.538820655949728, 'loss_val': 0.46591172581982987, 'psi': 0.538820655949728}
[S9] START round=42 head_norm_before_train=1.977224 cos_to_last_merge=1.0000 (last merge round=40)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1695315501532084, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1175835240272383, 'psi': 0.36867172340800847}
[S10] START round=42 head_norm_before_train=2.100041 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.2893150185587129, 'auprc': 0.2893150185587129, 'loss_val': 1.7209837417640363, 'psi': 0.2893150185587129}-{'f1_val': 0.2935473571457998, 'auprc': 0.2935473571457998, 'loss_val': 1.7060368843594391, 'psi': 0.2935473571457998}
[S11] START round=42 head_norm_before_train=1.920829 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.28165119494370927, 'auprc': 0.28165119494370927, 'loss_val': 3.0602806156411844, 'psi': 0.28165119494370927}-{'f1_val': 0.28054298642533937, 'auprc': 0.28054298642533937, 'loss_val': 3.036619631302488, 'psi': 0.28054298642533937}
[S13] START round=42 head_norm_before_train=1.719568 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5957996171214377, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5726267385962038, 'psi': 0.3599362944611573}
[S14] START round=42 head_norm_before_train=1.950572 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 6.743302245634103, 'psi': 0.13232893910860014}-{'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 6.702874664406433, 'psi': 0.13373403456048086}
[S15] START round=42 head_norm_before_train=2.137619 cos_to_last_merge=0.9913 (last merge round=27)
[S15] round=42 local utility u=0.000266 metrics={'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6302503082817773, 'psi': 0.61591610673549}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.634546388913231, 'psi': 0.6163342951580373}
[S16] START round=42 head_norm_before_train=1.972720 cos_to_last_merge=0.9693 (last merge round=24)
[S16] round=42 local utility u=0.089443 metrics={'f1_val': 0.20118724996773776, 'auprc': 0.20118724996773776, 'loss_val': 2.405831853004685, 'psi': 0.20118724996773776}-{'f1_val': 0.19386551317341724, 'auprc': 0.19386551317341724, 'loss_val': 2.5188226792372066, 'psi': 0.19386551317341724}
[S17] START round=42 head_norm_before_train=1.913029 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.2755541928578857, 'auprc': 0.2755541928578857, 'loss_val': 1.1590623514647442, 'psi': 0.2755541928578857}-{'f1_val': 0.3131206920684558, 'auprc': 0.3131206920684558, 'loss_val': 1.2454332710997404, 'psi': 0.3131206920684558}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.257)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:44907
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S16
[S9] cosine check vs S16: cos=0.9942
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=-0.1105
[S6] DROPPED delta from S8 (cos=-0.1105 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S15
[S2] cosine check vs S15: cos=-0.0055
[S2] DROPPED delta from S15 (cos=-0.0055 < 0.0)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=42 metric=0.3687 head_norm=1.987817
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.067076e-01
[S9] stored merged vector for next round verification (round=42)
[S9] DEBUG after merge:  round=42 metric=0.3687 head_norm=1.980780 delta_norm=0.106708
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.905231 (no previous merge yet)
[S2] round=43 local utility u=0.007308 metrics={'f1_val': 0.262665882199124, 'auprc': 0.262665882199124, 'loss_val': 2.899537026618618, 'psi': 0.262665882199124}-{'f1_val': 0.25706973768394115, 'auprc': 0.25706973768394115, 'loss_val': 2.863786792017269, 'psi': 0.25706973768394115}
[S3] START round=43 head_norm_before_train=2.028240 cos_to_last_merge=0.9825 (last merge round=26)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 1.9859830778966057, 'psi': 0.2587947777992154}-{'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 1.966246436119285, 'psi': 0.2587947777992154}
[S4] START round=43 head_norm_before_train=1.997777 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3628008816827928, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.335249749127266, 'psi': 0.3567939207526687}
[S5] START round=43 head_norm_before_train=2.153840 cos_to_last_merge=0.9765 (last merge round=26)
[S5] round=43 local utility u=0.005777 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.71115569632136, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.72271016403663, 'psi': 0.3335071121394324}
[S6] START round=43 head_norm_before_train=1.816253 (no previous merge yet)
[S6] round=43 local utility u=0.079628 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 6.958726771061903, 'psi': 0.02109124254928932}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 7.082113465945013, 'psi': 0.017105871474803514}
[S7] START round=43 head_norm_before_train=1.931438 (no previous merge yet)
[S7] round=43 local utility u=0.782603 metrics={'f1_val': 0.6647444222245239, 'auprc': 0.6647444222245239, 'loss_val': 0.28598989284448284, 'psi': 0.6647444222245239}-{'f1_val': 0.4982204138618798, 'auprc': 0.4982204138618798, 'loss_val': 0.35247968990009876, 'psi': 0.4982204138618798}
[S7] not sending this round → trigger blocked (psi=0.665)
[S8] START round=43 head_norm_before_train=1.647629 cos_to_last_merge=0.9981 (last merge round=41)
[S8] round=43 local utility u=0.057040 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3663647609282208, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.4804448904015668, 'psi': 0.9988708350860451}
[S9] START round=43 head_norm_before_train=1.980780 cos_to_last_merge=1.0000 (last merge round=42)
[S9] round=43 local utility u=0.023646 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.122240228151875, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1695315501532084, 'psi': 0.36867172340800847}
[S10] START round=43 head_norm_before_train=2.114152 (no previous merge yet)
[S10] round=43 local utility u=0.007674 metrics={'f1_val': 0.28743856675357604, 'auprc': 0.28743856675357604, 'loss_val': 1.6887473826512502, 'psi': 0.28743856675357604}-{'f1_val': 0.2893150185587129, 'auprc': 0.2893150185587129, 'loss_val': 1.7209837417640363, 'psi': 0.2893150185587129}
[S11] START round=43 head_norm_before_train=1.927762 (no previous merge yet)
[S11] round=43 local utility u=0.012186 metrics={'f1_val': 0.2873841193067312, 'auprc': 0.2873841193067312, 'loss_val': 3.0875057228968354, 'psi': 0.2873841193067312}-{'f1_val': 0.28165119494370927, 'auprc': 0.28165119494370927, 'loss_val': 3.0602806156411844, 'psi': 0.28165119494370927}
[S13] START round=43 head_norm_before_train=1.728657 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6018734891706137, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5957996171214377, 'psi': 0.3599362944611573}
[S14] START round=43 head_norm_before_train=1.957853 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.1329320290945573, 'auprc': 0.1329320290945573, 'loss_val': 6.770628777288236, 'psi': 0.1329320290945573}-{'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 6.743302245634103, 'psi': 0.13232893910860014}
[S15] START round=43 head_norm_before_train=2.149772 cos_to_last_merge=0.9908 (last merge round=27)
[S15] round=43 local utility u=0.001036 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6319411815160735, 'psi': 0.6163342951580373}-{'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6302503082817773, 'psi': 0.61591610673549}
[S16] START round=43 head_norm_before_train=1.979480 cos_to_last_merge=0.9686 (last merge round=24)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.19321388724814595, 'auprc': 0.19321388724814595, 'loss_val': 2.7532522747622235, 'psi': 0.19321388724814595}-{'f1_val': 0.20118724996773776, 'auprc': 0.20118724996773776, 'loss_val': 2.405831853004685, 'psi': 0.20118724996773776}
[S17] START round=43 head_norm_before_train=1.924595 (no previous merge yet)
[S17] round=43 local utility u=0.955261 metrics={'f1_val': 0.4793475574078767, 'auprc': 0.4793475574078767, 'loss_val': 1.0826803790244464, 'psi': 0.4793475574078767}-{'f1_val': 0.2755541928578857, 'auprc': 0.2755541928578857, 'loss_val': 1.1590623514647442, 'psi': 0.2755541928578857}
[S6] not sending this round → trigger blocked (psi=0.021)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:44913
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[S10] sending update (kind=head size=1797 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:44903
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=-0.0348
[S3] DROPPED delta from S17 (cos=-0.0348 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1805) from S11
[S4] cosine check vs S11: cos=-0.0626
[S4] DROPPED delta from S11 (cos=-0.0626 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=-0.0059
[S13] DROPPED delta from S10 (cos=-0.0059 < 0.0)
[S15] not sending this round → trigger blocked (psi=0.616)
[S8] not sending this round → trigger blocked (psi=0.999)
[S2] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=-0.1365
[S16] DROPPED delta from S5 (cos=-0.1365 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=-0.0271
[S3] DROPPED delta from S2 (cos=-0.0271 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S9
[S8] cosine check vs S9: cos=0.8715
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=43 metric=0.9989 head_norm=1.709729
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.884596e-01
[S8] stored merged vector for next round verification (round=43)
[S8] DEBUG after merge:  round=43 metric=0.9989 head_norm=1.790362 delta_norm=0.488460
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.910780 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.26338905276958374, 'auprc': 0.26338905276958374, 'loss_val': 2.927386068861407, 'psi': 0.26338905276958374}-{'f1_val': 0.262665882199124, 'auprc': 0.262665882199124, 'loss_val': 2.899537026618618, 'psi': 0.262665882199124}
[S3] START round=44 head_norm_before_train=2.036227 cos_to_last_merge=0.9817 (last merge round=26)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.2587448559670782, 'auprc': 0.2587448559670782, 'loss_val': 2.004411701389877, 'psi': 0.2587448559670782}-{'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 1.9859830778966057, 'psi': 0.2587947777992154}
[S4] START round=44 head_norm_before_train=2.006199 (no previous merge yet)
[S4] round=44 local utility u=0.007044 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3487124128513726, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3628008816827928, 'psi': 0.3567939207526687}
[S5] START round=44 head_norm_before_train=2.160788 cos_to_last_merge=0.9758 (last merge round=26)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7361873568418837, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.71115569632136, 'psi': 0.3335071121394324}
[S6] START round=44 head_norm_before_train=1.824497 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.077474816276093, 'psi': 0.017774699907663897}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 6.958726771061903, 'psi': 0.02109124254928932}
[S7] START round=44 head_norm_before_train=1.935718 (no previous merge yet)
[S7] round=44 local utility u=0.009514 metrics={'f1_val': 0.6645773415894515, 'auprc': 0.6645773415894515, 'loss_val': 0.2654590805796135, 'psi': 0.6645773415894515}-{'f1_val': 0.6647444222245239, 'auprc': 0.6647444222245239, 'loss_val': 0.28598989284448284, 'psi': 0.6647444222245239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=44 head_norm_before_train=1.790362 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.4130181918954715, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3663647609282208, 'psi': 0.9988708350860451}
[S9] START round=44 head_norm_before_train=1.991182 cos_to_last_merge=1.0000 (last merge round=42)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1753823372477896, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.122240228151875, 'psi': 0.36867172340800847}
[S10] START round=44 head_norm_before_train=2.127309 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.2852752278505879, 'auprc': 0.2852752278505879, 'loss_val': 1.7136437976757457, 'psi': 0.2852752278505879}-{'f1_val': 0.28743856675357604, 'auprc': 0.28743856675357604, 'loss_val': 1.6887473826512502, 'psi': 0.28743856675357604}
[S11] START round=44 head_norm_before_train=1.934560 (no previous merge yet)
[S11] round=44 local utility u=0.003161 metrics={'f1_val': 0.2909016727866177, 'auprc': 0.2909016727866177, 'loss_val': 3.112841893163651, 'psi': 0.2909016727866177}-{'f1_val': 0.2873841193067312, 'auprc': 0.2873841193067312, 'loss_val': 3.0875057228968354, 'psi': 0.2873841193067312}
[S13] START round=44 head_norm_before_train=1.735457 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.62043648569903, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6018734891706137, 'psi': 0.3599362944611573}
[S14] START round=44 head_norm_before_train=1.964753 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 6.79758761985576, 'psi': 0.1347331583552056}-{'f1_val': 0.1329320290945573, 'auprc': 0.1329320290945573, 'loss_val': 6.770628777288236, 'psi': 0.1329320290945573}
[S15] START round=44 head_norm_before_train=2.161044 cos_to_last_merge=0.9903 (last merge round=27)
[S15] round=44 local utility u=0.004515 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6241631788854771, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6319411815160735, 'psi': 0.6163342951580373}
[S16] START round=44 head_norm_before_train=1.986307 cos_to_last_merge=0.9679 (last merge round=24)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.1494228149422815, 'auprc': 0.1494228149422815, 'loss_val': 3.7179817843879004, 'psi': 0.1494228149422815}-{'f1_val': 0.19321388724814595, 'auprc': 0.19321388724814595, 'loss_val': 2.7532522747622235, 'psi': 0.19321388724814595}
[S17] START round=44 head_norm_before_train=1.937780 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.3065619657460797, 'auprc': 0.3065619657460797, 'loss_val': 1.568623577245098, 'psi': 0.3065619657460797}-{'f1_val': 0.4793475574078767, 'auprc': 0.4793475574078767, 'loss_val': 1.0826803790244464, 'psi': 0.4793475574078767}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.291)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:44912
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=-0.0630
[S11] DROPPED delta from S4 (cos=-0.0630 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S15
[S2] cosine check vs S15: cos=-0.0054
[S2] DROPPED delta from S15 (cos=-0.0054 < 0.0)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.916235 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.26344086021505375, 'auprc': 0.26344086021505375, 'loss_val': 2.9414938019748567, 'psi': 0.26344086021505375}-{'f1_val': 0.26338905276958374, 'auprc': 0.26338905276958374, 'loss_val': 2.927386068861407, 'psi': 0.26338905276958374}
[S3] START round=45 head_norm_before_train=2.043983 cos_to_last_merge=0.9810 (last merge round=26)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.2587448559670782, 'auprc': 0.2587448559670782, 'loss_val': 2.0213953757618417, 'psi': 0.2587448559670782}-{'f1_val': 0.2587448559670782, 'auprc': 0.2587448559670782, 'loss_val': 2.004411701389877, 'psi': 0.2587448559670782}
[S4] START round=45 head_norm_before_train=2.013053 (no previous merge yet)
[S4] round=45 local utility u=0.003937 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.340839200814755, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3487124128513726, 'psi': 0.3567939207526687}
[S5] START round=45 head_norm_before_train=2.171221 cos_to_last_merge=0.9749 (last merge round=26)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7480569207810306, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7361873568418837, 'psi': 0.3335071121394324}
[S6] START round=45 head_norm_before_train=1.832302 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.121305460805989, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.077474816276093, 'psi': 0.017774699907663897}
[S7] START round=45 head_norm_before_train=1.940959 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6636554092885958, 'auprc': 0.6636554092885958, 'loss_val': 0.3103123811219517, 'psi': 0.6636554092885958}-{'f1_val': 0.6645773415894515, 'auprc': 0.6645773415894515, 'loss_val': 0.2654590805796135, 'psi': 0.6645773415894515}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.839360 cos_to_last_merge=0.9971 (last merge round=43)
[S8] round=45 local utility u=0.072086 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.2688454647215159, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.4130181918954715, 'psi': 0.9988708350860451}
[S9] START round=45 head_norm_before_train=2.001548 cos_to_last_merge=0.9999 (last merge round=42)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2213142945211417, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1753823372477896, 'psi': 0.36867172340800847}
[S10] START round=45 head_norm_before_train=2.140067 (no previous merge yet)
[S10] round=45 local utility u=0.015731 metrics={'f1_val': 0.2893150185587129, 'auprc': 0.2893150185587129, 'loss_val': 1.7185395858287609, 'psi': 0.2893150185587129}-{'f1_val': 0.2852752278505879, 'auprc': 0.2852752278505879, 'loss_val': 1.7136437976757457, 'psi': 0.2852752278505879}
[S11] START round=45 head_norm_before_train=1.941125 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.28170683524298695, 'auprc': 0.28170683524298695, 'loss_val': 3.102955976635886, 'psi': 0.28170683524298695}-{'f1_val': 0.2909016727866177, 'auprc': 0.2909016727866177, 'loss_val': 3.112841893163651, 'psi': 0.2909016727866177}
[S13] START round=45 head_norm_before_train=1.743793 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6422887996998692, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.62043648569903, 'psi': 0.3599362944611573}
[S14] START round=45 head_norm_before_train=1.971377 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.827482279940804, 'psi': 0.13572854291417166}-{'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 6.79758761985576, 'psi': 0.1347331583552056}
[S15] START round=45 head_norm_before_train=2.171235 cos_to_last_merge=0.9899 (last merge round=27)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6414720834826023, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6241631788854771, 'psi': 0.6164734888353558}
[S16] START round=45 head_norm_before_train=1.992563 cos_to_last_merge=0.9672 (last merge round=24)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.06789815277084373, 'auprc': 0.06789815277084373, 'loss_val': 4.827401148187368, 'psi': 0.06789815277084373}-{'f1_val': 0.1494228149422815, 'auprc': 0.1494228149422815, 'loss_val': 3.7179817843879004, 'psi': 0.1494228149422815}
[S17] START round=45 head_norm_before_train=1.948509 (no previous merge yet)
[S17] round=45 local utility u=0.418899 metrics={'f1_val': 0.37976325270200717, 'auprc': 0.37976325270200717, 'loss_val': 1.3896371317473164, 'psi': 0.37976325270200717}-{'f1_val': 0.3065619657460797, 'auprc': 0.3065619657460797, 'loss_val': 1.568623577245098, 'psi': 0.3065619657460797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.357)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.050 → S8@127.0.0.1:44909
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.002 → S11@127.0.0.1:44912
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.003 → S4@127.0.0.1:44904
[S17] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S14] ⇄ pheromone p=0.000 → S16@127.0.0.1:44916
[S13] ⇄ pheromone p=0.001 → S10@127.0.0.1:44911
[S13] RECEIVED delta(kind=head bytes=1792) from S10
[S13] cosine check vs S10: cos=-0.0038
[S13] DROPPED delta from S10 (cos=-0.0038 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=-0.0346
[S3] DROPPED delta from S17 (cos=-0.0346 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:44907
[S17] ⇄ pheromone p=0.291 → S3@127.0.0.1:44903
[S10] ⇄ pheromone p=0.023 → S13@127.0.0.1:44913
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.001 → S17@127.0.0.1:44917
[S8] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S8
[S6] cosine check vs S8: cos=-0.1055
[S6] DROPPED delta from S8 (cos=-0.1055 < 0.0)
[S15] ⇄ pheromone p=0.003 → S2@127.0.0.1:44902
[S16] ⇄ pheromone p=0.164 → S9@127.0.0.1:44910
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.010 → S3@127.0.0.1:44903
[S5] ⇄ pheromone p=0.002 → S16@127.0.0.1:44916
[S9] ⇄ pheromone p=0.011 → S8@127.0.0.1:44909
[S8] ⇄ pheromone p=0.179 → S6@127.0.0.1:44907
[S2] START round=46 head_norm_before_train=1.921637 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.2633372656966837, 'auprc': 0.2633372656966837, 'loss_val': 2.9497254612078225, 'psi': 0.2633372656966837}-{'f1_val': 0.26344086021505375, 'auprc': 0.26344086021505375, 'loss_val': 2.9414938019748567, 'psi': 0.26344086021505375}
[S3] START round=46 head_norm_before_train=2.051355 cos_to_last_merge=0.9803 (last merge round=26)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 2.0384547072886727, 'psi': 0.25869495339119253}-{'f1_val': 0.2587448559670782, 'auprc': 0.2587448559670782, 'loss_val': 2.0213953757618417, 'psi': 0.2587448559670782}
[S4] START round=46 head_norm_before_train=2.017140 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.347893757702911, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.340839200814755, 'psi': 0.3567939207526687}
[S5] START round=46 head_norm_before_train=2.177252 cos_to_last_merge=0.9742 (last merge round=26)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.778842120690326, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7480569207810306, 'psi': 0.3335071121394324}
[S6] START round=46 head_norm_before_train=1.839853 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 7.143522246425359, 'psi': 0.01910681399631676}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.121305460805989, 'psi': 0.017774699907663897}
[S7] START round=46 head_norm_before_train=1.947335 (no previous merge yet)
[S7] round=46 local utility u=0.033824 metrics={'f1_val': 0.6644937387261324, 'auprc': 0.6644937387261324, 'loss_val': 0.2502095396118736, 'psi': 0.6644937387261324}-{'f1_val': 0.6636554092885958, 'auprc': 0.6636554092885958, 'loss_val': 0.3103123811219517, 'psi': 0.6636554092885958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S7] sending update (kind=head size=1787 to 1 peers)
[S8] START round=46 head_norm_before_train=1.898614 cos_to_last_merge=0.9897 (last merge round=43)
[S8] round=46 local utility u=0.049002 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.17084150691693792, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.2688454647215159, 'psi': 0.9988708350860451}
[S9] START round=46 head_norm_before_train=2.011606 cos_to_last_merge=0.9998 (last merge round=42)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2692428187098175, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2213142945211417, 'psi': 0.36867172340800847}
[S10] START round=46 head_norm_before_train=2.152143 (no previous merge yet)
[S10] round=46 local utility u=0.020473 metrics={'f1_val': 0.2922331367343917, 'auprc': 0.2922331367343917, 'loss_val': 1.7038571341095279, 'psi': 0.2922331367343917}-{'f1_val': 0.2893150185587129, 'auprc': 0.2893150185587129, 'loss_val': 1.7185395858287609, 'psi': 0.2893150185587129}
[S11] START round=46 head_norm_before_train=1.947442 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.2807086614173228, 'auprc': 0.2807086614173228, 'loss_val': 3.1112350283376853, 'psi': 0.2807086614173228}-{'f1_val': 0.28170683524298695, 'auprc': 0.28170683524298695, 'loss_val': 3.102955976635886, 'psi': 0.28170683524298695}
[S13] START round=46 head_norm_before_train=1.752174 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6543746634058714, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6422887996998692, 'psi': 0.3599362944611573}
[S14] START round=46 head_norm_before_train=1.977779 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.857869087567138, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.827482279940804, 'psi': 0.13572854291417166}
[S15] START round=46 head_norm_before_train=2.181231 cos_to_last_merge=0.9895 (last merge round=27)
[S15] round=46 local utility u=0.028768 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.582682553163326, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6414720834826023, 'psi': 0.6164734888353558}
[S16] START round=46 head_norm_before_train=1.998021 cos_to_last_merge=0.9666 (last merge round=24)
[S16] round=46 local utility u=1.000000 metrics={'f1_val': 0.23992901508429457, 'auprc': 0.23992901508429457, 'loss_val': 2.516334737829745, 'psi': 0.2399290150842946}-{'f1_val': 0.06789815277084373, 'auprc': 0.06789815277084373, 'loss_val': 4.827401148187368, 'psi': 0.06789815277084373}
[S17] START round=46 head_norm_before_train=1.958747 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.375822387196052, 'auprc': 0.375822387196052, 'loss_val': 1.3925122239018188, 'psi': 0.375822387196052}-{'f1_val': 0.37976325270200717, 'auprc': 0.37976325270200717, 'loss_val': 1.3896371317473164, 'psi': 0.37976325270200717}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.292)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:44902
[S8] not sending this round → trigger blocked (psi=0.999)
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S16
[S9] cosine check vs S16: cos=0.9970
[S2] RECEIVED delta(kind=head bytes=1796) from S15
[S2] cosine check vs S15: cos=-0.0054
[S2] DROPPED delta from S15 (cos=-0.0054 < 0.0)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=46 metric=0.3687 head_norm=2.021295
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.849637e-02
[S9] stored merged vector for next round verification (round=46)
[S9] DEBUG after merge:  round=46 metric=0.3687 head_norm=2.011220 delta_norm=0.078496
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.926897 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.2633372656966837, 'auprc': 0.2633372656966837, 'loss_val': 2.9628165632209744, 'psi': 0.2633372656966837}-{'f1_val': 0.2633372656966837, 'auprc': 0.2633372656966837, 'loss_val': 2.9497254612078225, 'psi': 0.2633372656966837}
[S3] START round=47 head_norm_before_train=2.058499 cos_to_last_merge=0.9797 (last merge round=26)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 2.0547528497609364, 'psi': 0.25869495339119253}-{'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 2.0384547072886727, 'psi': 0.25869495339119253}
[S4] START round=47 head_norm_before_train=2.022439 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3584369322337366, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.347893757702911, 'psi': 0.3567939207526687}
[S5] START round=47 head_norm_before_train=2.181599 cos_to_last_merge=0.9733 (last merge round=26)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7962982703299044, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.778842120690326, 'psi': 0.3335071121394324}
[S6] START round=47 head_norm_before_train=1.847156 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.226670040270476, 'psi': 0.017774699907663897}-{'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 7.143522246425359, 'psi': 0.01910681399631676}
[S7] START round=47 head_norm_before_train=1.953453 (no previous merge yet)
[S7] round=47 local utility u=0.009811 metrics={'f1_val': 0.6649113362787039, 'auprc': 0.6649113362787039, 'loss_val': 0.23434626634919778, 'psi': 0.6649113362787039}-{'f1_val': 0.6644937387261324, 'auprc': 0.6644937387261324, 'loss_val': 0.2502095396118736, 'psi': 0.6644937387261324}
[S7] not sending this round → trigger blocked (psi=0.665)
[S8] START round=47 head_norm_before_train=1.952557 cos_to_last_merge=0.9817 (last merge round=43)
[S8] round=47 local utility u=0.016929 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.13698351761433167, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.17084150691693792, 'psi': 0.9988708350860451}
[S9] START round=47 head_norm_before_train=2.011220 cos_to_last_merge=1.0000 (last merge round=46)
[S9] round=47 local utility u=0.029349 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.210545140967786, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2692428187098175, 'psi': 0.36867172340800847}
[S10] START round=47 head_norm_before_train=2.163759 (no previous merge yet)
[S10] round=47 local utility u=0.011170 metrics={'f1_val': 0.2935473571457998, 'auprc': 0.2935473571457998, 'loss_val': 1.6933453376596121, 'psi': 0.2935473571457998}-{'f1_val': 0.2922331367343917, 'auprc': 0.2922331367343917, 'loss_val': 1.7038571341095279, 'psi': 0.2922331367343917}
[S11] START round=47 head_norm_before_train=1.953589 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.2821527502967946, 'auprc': 0.2821527502967946, 'loss_val': 3.128980766791206, 'psi': 0.2821527502967946}-{'f1_val': 0.2807086614173228, 'auprc': 0.2807086614173228, 'loss_val': 3.1112350283376853, 'psi': 0.2807086614173228}
[S13] START round=47 head_norm_before_train=1.758274 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6750435730047828, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6543746634058714, 'psi': 0.3599362944611573}
[S14] START round=47 head_norm_before_train=1.983943 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.887919435349571, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.857869087567138, 'psi': 0.13592717296421}
[S15] START round=47 head_norm_before_train=2.190899 cos_to_last_merge=0.9890 (last merge round=27)
[S15] round=47 local utility u=0.010317 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5607944127068142, 'psi': 0.6161950003225232}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.582682553163326, 'psi': 0.6163342951580373}
[S16] START round=47 head_norm_before_train=2.004172 cos_to_last_merge=0.9660 (last merge round=24)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.1662157474852584, 'auprc': 0.1662157474852584, 'loss_val': 3.532005690305807, 'psi': 0.1662157474852584}-{'f1_val': 0.23992901508429457, 'auprc': 0.23992901508429457, 'loss_val': 2.516334737829745, 'psi': 0.2399290150842946}
[S17] START round=47 head_norm_before_train=1.973295 (no previous merge yet)
[S17] round=47 local utility u=1.000000 metrics={'f1_val': 0.6092825616909661, 'auprc': 0.6092825616909661, 'loss_val': 1.0377370817712261, 'psi': 0.6092825616909661}-{'f1_val': 0.375822387196052, 'auprc': 0.375822387196052, 'loss_val': 1.3925122239018188, 'psi': 0.375822387196052}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:44913
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=-0.0023
[S13] DROPPED delta from S10 (cos=-0.0023 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=-0.0348
[S3] DROPPED delta from S17 (cos=-0.0348 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.616)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:44907
[S8] sending update (kind=head size=1807 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1807) from S8
[S6] cosine check vs S8: cos=-0.1119
[S6] DROPPED delta from S8 (cos=-0.1119 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S9
[S8] cosine check vs S9: cos=0.9000
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=47 metric=0.9989 head_norm=1.994558
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.491554e-01
[S8] stored merged vector for next round verification (round=47)
[S8] DEBUG after merge:  round=47 metric=0.9989 head_norm=1.956653 delta_norm=0.449155
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.931884 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.2633372656966837, 'auprc': 0.2633372656966837, 'loss_val': 2.9719836567364237, 'psi': 0.2633372656966837}-{'f1_val': 0.2633372656966837, 'auprc': 0.2633372656966837, 'loss_val': 2.9628165632209744, 'psi': 0.2633372656966837}
[S3] START round=48 head_norm_before_train=2.065374 cos_to_last_merge=0.9790 (last merge round=26)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 2.0725026113206613, 'psi': 0.25869495339119253}-{'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 2.0547528497609364, 'psi': 0.25869495339119253}
[S4] START round=48 head_norm_before_train=2.029482 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.371074426240534, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3584369322337366, 'psi': 0.3567939207526687}
[S5] START round=48 head_norm_before_train=2.186785 cos_to_last_merge=0.9726 (last merge round=26)
[S5] round=48 local utility u=0.005072 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.786155089529345, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7962982703299044, 'psi': 0.3335071121394324}
[S6] START round=48 head_norm_before_train=1.854303 (no previous merge yet)
[S6] round=48 local utility u=0.066575 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 7.127318250944557, 'psi': 0.02153000458085204}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.226670040270476, 'psi': 0.017774699907663897}
[S7] START round=48 head_norm_before_train=1.958609 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6646609027451812, 'auprc': 0.6646609027451812, 'loss_val': 0.3099041793499125, 'psi': 0.6646609027451812}-{'f1_val': 0.6649113362787039, 'auprc': 0.6649113362787039, 'loss_val': 0.23434626634919778, 'psi': 0.6649113362787039}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.956653 cos_to_last_merge=1.0000 (last merge round=47)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.2164528869021044, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.13698351761433167, 'psi': 0.9988708350860451}
[S9] START round=48 head_norm_before_train=2.020447 cos_to_last_merge=1.0000 (last merge round=46)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.261012204609705, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.210545140967786, 'psi': 0.36867172340800847}
[S10] START round=48 head_norm_before_train=2.174664 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.2935473571457998, 'auprc': 0.2935473571457998, 'loss_val': 1.701989276141529, 'psi': 0.2935473571457998}-{'f1_val': 0.2935473571457998, 'auprc': 0.2935473571457998, 'loss_val': 1.6933453376596121, 'psi': 0.2935473571457998}
[S11] START round=48 head_norm_before_train=1.959460 (no previous merge yet)
[S11] round=48 local utility u=0.006215 metrics={'f1_val': 0.2855426511814177, 'auprc': 0.2855426511814177, 'loss_val': 3.147058920023764, 'psi': 0.2855426511814177}-{'f1_val': 0.2821527502967946, 'auprc': 0.2821527502967946, 'loss_val': 3.128980766791206, 'psi': 0.2821527502967946}
[S13] START round=48 head_norm_before_train=1.762016 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6824954965692152, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6750435730047828, 'psi': 0.3599362944611573}
[S14] START round=48 head_norm_before_train=1.990020 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.917455549626512, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.887919435349571, 'psi': 0.13587634006482174}
[S15] START round=48 head_norm_before_train=2.200594 cos_to_last_merge=0.9886 (last merge round=27)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.644747580094739, 'psi': 0.6164734888353558}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5607944127068142, 'psi': 0.6161950003225232}
[S16] START round=48 head_norm_before_train=2.010086 cos_to_last_merge=0.9654 (last merge round=24)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.11871105031159751, 'auprc': 0.11871105031159751, 'loss_val': 4.340686821871007, 'psi': 0.11871105031159751}-{'f1_val': 0.1662157474852584, 'auprc': 0.1662157474852584, 'loss_val': 3.532005690305807, 'psi': 0.1662157474852584}
[S17] START round=48 head_norm_before_train=1.987553 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.387088836026577, 'auprc': 0.387088836026577, 'loss_val': 1.5049844627568563, 'psi': 0.387088836026577}-{'f1_val': 0.6092825616909661, 'auprc': 0.6092825616909661, 'loss_val': 1.0377370817712261, 'psi': 0.6092825616909661}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:44904
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1794) from S11
[S4] cosine check vs S11: cos=-0.0598
[S4] DROPPED delta from S11 (cos=-0.0598 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.1385
[S16] DROPPED delta from S5 (cos=-0.1385 < 0.0)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.936813 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.2632854989843392, 'auprc': 0.2632854989843392, 'loss_val': 2.977701233767392, 'psi': 0.2632854989843392}-{'f1_val': 0.2633372656966837, 'auprc': 0.2633372656966837, 'loss_val': 2.9719836567364237, 'psi': 0.2633372656966837}
[S3] START round=49 head_norm_before_train=2.072156 cos_to_last_merge=0.9784 (last merge round=26)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 2.0868334020667287, 'psi': 0.25869495339119253}-{'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 2.0725026113206613, 'psi': 0.25869495339119253}
[S4] START round=49 head_norm_before_train=2.036027 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3858931660868552, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.371074426240534, 'psi': 0.3567939207526687}
[S5] START round=49 head_norm_before_train=2.195222 cos_to_last_merge=0.9720 (last merge round=26)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.824761491096029, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.786155089529345, 'psi': 0.3335071121394324}
[S6] START round=49 head_norm_before_train=1.861018 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.203661776509783, 'psi': 0.01954921803127875}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 7.127318250944557, 'psi': 0.02153000458085204}
[S7] START round=49 head_norm_before_train=1.965340 (no previous merge yet)
[S7] round=49 local utility u=0.061820 metrics={'f1_val': 0.6636554092885958, 'auprc': 0.6636554092885958, 'loss_val': 0.17721538636542208, 'psi': 0.6636554092885958}-{'f1_val': 0.6646609027451812, 'auprc': 0.6646609027451812, 'loss_val': 0.3099041793499125, 'psi': 0.6646609027451812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=49 head_norm_before_train=1.984827 cos_to_last_merge=0.9994 (last merge round=47)
[S8] round=49 local utility u=0.024416 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.1676208731680071, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.2164528869021044, 'psi': 0.9988708350860451}
[S9] START round=49 head_norm_before_train=2.030251 cos_to_last_merge=0.9999 (last merge round=46)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3076399125671756, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.261012204609705, 'psi': 0.36867172340800847}
[S10] START round=49 head_norm_before_train=2.184946 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.2906460388633563, 'auprc': 0.2906460388633563, 'loss_val': 1.7553496927225396, 'psi': 0.2906460388633563}-{'f1_val': 0.2935473571457998, 'auprc': 0.2935473571457998, 'loss_val': 1.701989276141529, 'psi': 0.2935473571457998}
[S11] START round=49 head_norm_before_train=1.965166 (no previous merge yet)
[S11] round=49 local utility u=0.004969 metrics={'f1_val': 0.28878088294856213, 'auprc': 0.28878088294856213, 'loss_val': 3.1662642945679917, 'psi': 0.28878088294856213}-{'f1_val': 0.2855426511814177, 'auprc': 0.2855426511814177, 'loss_val': 3.147058920023764, 'psi': 0.2855426511814177}
[S13] START round=49 head_norm_before_train=1.765669 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.699265845081119, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6824954965692152, 'psi': 0.3599362944611573}
[S14] START round=49 head_norm_before_train=1.995963 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.94515064647221, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.917455549626512, 'psi': 0.13582554517133957}
[S15] START round=49 head_norm_before_train=2.209296 cos_to_last_merge=0.9882 (last merge round=27)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6634724309116355, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.644747580094739, 'psi': 0.6164734888353558}
[S16] START round=49 head_norm_before_train=2.015470 cos_to_last_merge=0.9648 (last merge round=24)
[S16] round=49 local utility u=0.137701 metrics={'f1_val': 0.13116458704693998, 'auprc': 0.13116458704693998, 'loss_val': 4.177367390099282, 'psi': 0.13116458704693998}-{'f1_val': 0.11871105031159751, 'auprc': 0.11871105031159751, 'loss_val': 4.340686821871007, 'psi': 0.11871105031159751}
[S17] START round=49 head_norm_before_train=1.995348 (no previous merge yet)
[S17] round=49 local utility u=0.936828 metrics={'f1_val': 0.5733856159101718, 'auprc': 0.5733856159101718, 'loss_val': 1.3080002058974585, 'psi': 0.5733856159101718}-{'f1_val': 0.387088836026577, 'auprc': 0.387088836026577, 'loss_val': 1.5049844627568563, 'psi': 0.387088836026577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:44903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.289)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=-0.0343
[S3] DROPPED delta from S17 (cos=-0.0343 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=-0.0959
[S6] DROPPED delta from S8 (cos=-0.0959 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S16
[S9] cosine check vs S16: cos=0.9983
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=49 metric=0.3687 head_norm=2.039720
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.957269e-02
[S9] stored merged vector for next round verification (round=49)
[S9] DEBUG after merge:  round=49 metric=0.3687 head_norm=2.028904 delta_norm=0.059573
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
