[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:59803
[S3] → join 127.0.0.1:59802
[S4] → join 127.0.0.1:59802
[S5] → join 127.0.0.1:59802
[S6] → join 127.0.0.1:59802
[S7] → join 127.0.0.1:59802
[S8] → join 127.0.0.1:59802
[S9] → join 127.0.0.1:59802
[S10] → join 127.0.0.1:59802
[S11] → join 127.0.0.1:59802
[S13] → join 127.0.0.1:59802
[S14] → join 127.0.0.1:59802
[S15] → join 127.0.0.1:59802
[S16] → join 127.0.0.1:59802
[S17] → join 127.0.0.1:59802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.146703 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.176093 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.135277 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.158500 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.137810 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.168658 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.144739 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.136546 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.161860 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.157963 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.218655 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.163037 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.113835 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.132919 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.141926 (no previous merge yet)
[S14]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4] + discovered S3
[S3] + discovered S17
[S3] + discovered S11
[S3] + discovered S16
[S3] + discovered S9
[S3] + discovered S14
[S3] + discovered S13
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S10
[S3] + discovered S6
[S3] + discovered S8
[S3] + discovered S5
[S3] + discovered S4
[S4] + discovered S2
[S4] + discovered S11
[S4] + discovered S17
[S4] + discovered S16
[S4] + discovered S9
[S4] + discovered S13
[S4] + discovered S14
[S4] + discovered S7
[S4] + discovered S10
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S8
[S4] + discovered S5
[S5] + discovered S4
[S5] + discovered S3
[S5] + discovered S2
[S6] + discovered S3
[S6] + discovered S2
[S6] + discovered S4
[S6] + discovered S5
[S5] + discovered S14
[S5] + discovered S8
[S5] + discovered S15
[S5] + discovered S7
[S5] + discovered S9
[S5] + discovered S16
[S5] + discovered S6
[S5] + discovered S10
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S13
[S6] + discovered S11
[S6] + discovered S9
[S6] + discovered S17
[S6] + discovered S10
[S6] + discovered S7
[S6] + discovered S8
[S6] + discovered S13
[S6] + discovered S16
[S6] + discovered S15
[S6] + discovered S14
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S4
[S7] + discovered S2
[S7] + discovered S3
[S7] + discovered S10
[S7] + discovered S15
[S7] + discovered S13
[S7] + discovered S8
[S7] + discovered S9
[S7] + discovered S14
[S7] + discovered S16
[S7] + discovered S17
[S7] + discovered S11
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S2
[S8] + discovered S6
[S8] + discovered S5
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S3
[S9] + discovered S5
[S9] + discovered S6
[S9] + discovered S8
[S8] + discovered S11
[S8] + discovered S13
[S8] + discovered S16
[S8] + discovered S14
[S8] + discovered S17
[S8] + discovered S9
[S8] + discovered S15
[S8] + discovered S10
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S5
[S10] + discovered S7
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S4
[S10] + discovered S2
[S9] + discovered S14
[S9] + discovered S10
[S9] + discovered S15
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S13
[S9] + discovered S11
[S10] + discovered S17
[S10] + discovered S16
[S10] + discovered S11
[S10] + discovered S13
[S10] + discovered S15
[S10] + discovered S14
[S11] + discovered S9
[S11] + discovered S4
[S11] + discovered S8
[S11] + discovered S10
[S11] + discovered S7
[S11] + discovered S6
[S11] + discovered S2
[S11] + discovered S3
[S11] + discovered S5
[S13] + discovered S5
[S13] + discovered S3
[S13] + discovered S10
[S13] + discovered S8
[S13] + discovered S2
[S13] + discovered S11
[S13] + discovered S6
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S9
[S11] + discovered S14
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S13
[S14] + discovered S11
[S14] + discovered S8
[S14] + discovered S7
[S14] + discovered S10
[S14] + discovered S13
[S14] + discovered S6
[S14] + discovered S4
[S14] + discovered S9
[S13] + discovered S17
[S13] + discovered S14
[S13] + discovered S16
[S13] + discovered S15
[S14] + discovered S5
[S14] + discovered S3
[S14] + discovered S2
[S15] + discovered S10
[S15] + discovered S9
[S15] + discovered S4
[S15] + discovered S6
[S15] + discovered S13
[S15] + discovered S5
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S11
[S15] + discovered S2
[S15] + discovered S8
[S15] + discovered S7
[S14] + discovered S15
[S14] + discovered S16
[S14] + discovered S17
[S16] + discovered S7
[S16] + discovered S14
[S16] + discovered S15
[S16] + discovered S11
[S16] + discovered S8
[S16] + discovered S13
[S16] + discovered S5
[S16] + discovered S2
[S16] + discovered S6
[S16] + discovered S3
[S16] + discovered S4
[S16] + discovered S10
[S16] + discovered S9
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S17
[S17] + discovered S6
[S17] + discovered S10
[S17] + discovered S3
[S17] + discovered S13
[S17] + discovered S2
[S17] + discovered S7
[S17] + discovered S16
[S17] + discovered S4
[S17] + discovered S15
[S17] + discovered S9
[S17] + discovered S14
[S17] + discovered S5
[S17] + discovered S8
[S17] + discovered S11
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=1.000 → S9@127.0.0.1:59810
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:59805
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:59814
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:59815
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:59810
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:59804
[S9] ⇄ pheromone p=1.000 → S14@127.0.0.1:59814
[S8] ⇄ pheromone p=1.000 → S6@127.0.0.1:59807
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:59802
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:59807
[S13] ⇄ pheromone p=1.000 → S9@127.0.0.1:59810
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:59804
[S7] ⇄ pheromone p=1.000 → S6@127.0.0.1:59807
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:59812
[S17] ⇄ pheromone p=1.000 → S5@127.0.0.1:59805
[S2] START round=1 head_norm_before_train=1.160608 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8929533498897542, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4950846893088119, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.187551 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.558490412736312, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4732032286249865, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.147295 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6042930729131264, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5209018828615037, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.152219 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5043090609924255, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.455820568533936, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.151210 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5979567710747913, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4399798213964363, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.170404 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4401858006250086, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3939620763179, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.162226 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7692859341609566, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5883624434208714, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.131996 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5238085856752595, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4400280640204588, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.172837 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6959729919827418, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5147136175784537, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.157055 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5791637640851015, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5047483878430012, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.245771 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.588616880128961, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4148452864300292, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.174287 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5327539635102692, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4252868036678374, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.119712 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.669669119757301, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.494165433574708, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.132192 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4575741381568577, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4074433887020963, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.154592 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6055157662872617, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4404856273615034, 'psi': 0.0}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.210638 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8422822763501783, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8929533498897542, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.209990 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6947170334938237, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.558490412736312, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.190041 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7608405545348738, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6042930729131264, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.158305 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5836837147239067, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5043090609924255, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.192665 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3989921914661587, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5979567710747913, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.180845 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5307463011401168, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4401858006250086, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.198668 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7883025747035863, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7692859341609566, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.141627 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6634078634388767, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5238085856752595, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.208520 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9611381939812114, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6959729919827418, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.168855 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7107789131349704, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5791637640851015, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.290770 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1139763909610014, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.588616880128961, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.196850 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7585422224242864, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5327539635102692, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.149170 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1061245606951013, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.669669119757301, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.146101 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5425524592967792, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4575741381568577, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.201262 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.08227809042718, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6055157662872617, 'psi': 0.0}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.265026 (no previous merge yet)
[S2] round=3 local utility u=0.083374 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.675533539727408, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8422822763501783, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.242366 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0127586548809027, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6947170334938237, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.238511 (no previous merge yet)
[S4] round=3 local utility u=0.074697 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6114469440270913, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7608405545348738, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.177348 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.774244582237554, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5836837147239067, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.258198 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6742097591358607, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3989921914661587, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.200191 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.741033077959234, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5307463011401168, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.230880 (no previous merge yet)
[S8] round=3 local utility u=0.102286 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5837297071148422, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7883025747035863, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.163419 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9715032171779614, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6634078634388767, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.241967 (no previous merge yet)
[S10] round=3 local utility u=0.006151 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9488364267965208, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9611381939812114, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.192214 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0251887493561056, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7107789131349704, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.337494 (no previous merge yet)
[S13] round=3 local utility u=0.219118 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6757413766183489, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1139763909610014, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.227859 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3969540683529713, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7585422224242864, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.188030 (no previous merge yet)
[S15] round=3 local utility u=0.083566 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9389921551863682, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1061245606951013, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.171971 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7565942228141824, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5425524592967792, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.258763 (no previous merge yet)
[S17] round=3 local utility u=0.258457 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5653639784577125, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.08227809042718, 'psi': 0.0}
[S13] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=4 head_norm_before_train=1.302272 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1347116687047736, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.675533539727408, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.282597 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.557839214151139, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0127586548809027, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.281719 (no previous merge yet)
[S4] round=4 local utility u=0.042148 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5271503341731, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6114469440270913, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.208083 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0046119887894043, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.774244582237554, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.315143 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.495518376808516, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6742097591358607, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.227124 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9862750067392332, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.741033077959234, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.259133 (no previous merge yet)
[S8] round=4 local utility u=1.000000 metrics={'f1_val': 0.2204999301773495, 'auprc': 0.2204999301773495, 'loss_val': 1.2648397949439585, 'psi': 0.22049993017734953}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5837297071148422, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.195896 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4266989423603413, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9715032171779614, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.263848 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2625692317391, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9488364267965208, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.225482 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6779864551086554, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0251887493561056, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.344421 (no previous merge yet)
[S13] round=4 local utility u=0.103186 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4693692347760758, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6757413766183489, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.267098 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.018089451679345, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3969540683529713, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.203647 (no previous merge yet)
[S15] round=4 local utility u=0.158899 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6211940703378729, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9389921551863682, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.207634 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3547820918976363, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7565942228141824, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.285660 (no previous merge yet)
[S17] round=4 local utility u=0.065972 metrics={'f1_val': 0.0011918951132300357, 'auprc': 0.0011918951132300357, 'loss_val': 1.4441460932841412, 'psi': 0.0011918951132300357}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5653639784577125, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=-0.0198
[S6] DROPPED delta from S8 (cos=-0.0198 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.001)
[S2] START round=5 head_norm_before_train=1.356646 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.139414072694992, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1347116687047736, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.320958 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.687407266436221, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.557839214151139, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.341608 (no previous merge yet)
[S4] round=5 local utility u=0.012944 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5012626225776522, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5271503341731, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.232334 (no previous merge yet)
[S5] round=5 local utility u=0.105620 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.793371888180938, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0046119887894043, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.379368 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7358293318749265, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.495518376808516, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.246339 (no previous merge yet)
[S7] round=5 local utility u=0.025467 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9353404838140327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9862750067392332, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.300291 (no previous merge yet)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.42618340264688276, 'auprc': 0.42618340264688276, 'loss_val': 1.06663042335611, 'psi': 0.42618340264688276}-{'f1_val': 0.2204999301773495, 'auprc': 0.2204999301773495, 'loss_val': 1.2648397949439585, 'psi': 0.22049993017734953}
[S9] START round=5 head_norm_before_train=1.226025 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.520338925108902, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4266989423603413, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.302573 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.078803405359909, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2625692317391, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.261264 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8624616374106306, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6779864551086554, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.366203 (no previous merge yet)
[S13] round=5 local utility u=0.938789 metrics={'f1_val': 0.20052709980520225, 'auprc': 0.20052709980520225, 'loss_val': 1.3965351254449199, 'psi': 0.20052709980520225}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4693692347760758, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.295963 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0472627971397674, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.018089451679345, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.227367 (no previous merge yet)
[S15] round=5 local utility u=0.097232 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4267307766335993, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6211940703378729, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.250404 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5380756905413615, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3547820918976363, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.337249 (no previous merge yet)
[S17] round=5 local utility u=0.810567 metrics={'f1_val': 0.166102770141679, 'auprc': 0.166102770141679, 'loss_val': 1.3072089960103015, 'psi': 0.166102770141679}-{'f1_val': 0.0011918951132300357, 'auprc': 0.0011918951132300357, 'loss_val': 1.4441460932841412, 'psi': 0.0011918951132300357}
[S4] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:59810
[S8] not sending this round → trigger blocked (psi=0.426)
[S13] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S13
[S9] cosine check vs S13: cos=0.0337
[S17] not sending this round → trigger blocked (psi=0.166)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.0000 head_norm=1.243793
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.226857e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.0000 head_norm=0.954046 delta_norm=0.922686
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.328 → S14@127.0.0.1:59814
[S7] ⇄ pheromone p=0.333 → S6@127.0.0.1:59807
[S2] ⇄ pheromone p=0.338 → S6@127.0.0.1:59807
[S10] ⇄ pheromone p=0.328 → S4@127.0.0.1:59804
[S3] ⇄ pheromone p=0.328 → S2@127.0.0.1:59802
[S14] ⇄ pheromone p=0.328 → S11@127.0.0.1:59812
[S6] ⇄ pheromone p=0.328 → S15@127.0.0.1:59815
[S15] ⇄ pheromone p=0.383 → S14@127.0.0.1:59814
[S5] ⇄ pheromone p=0.349 → S9@127.0.0.1:59810
[S4] ⇄ pheromone p=0.347 → S5@127.0.0.1:59805
[S8] ⇄ pheromone p=0.701 → S6@127.0.0.1:59807
[S11] ⇄ pheromone p=0.328 → S9@127.0.0.1:59810
[S13] ⇄ pheromone p=0.560 → S9@127.0.0.1:59810
[S17] ⇄ pheromone p=0.533 → S5@127.0.0.1:59805
[S16] ⇄ pheromone p=0.328 → S4@127.0.0.1:59804
[S2] START round=6 head_norm_before_train=1.413439 (no previous merge yet)
[S2] round=6 local utility u=1.000000 metrics={'f1_val': 0.22868977545236538, 'auprc': 0.22868977545236538, 'loss_val': 2.5658668055535436, 'psi': 0.22868977545236535}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.139414072694992, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.351923 (no previous merge yet)
[S3] round=6 local utility u=0.108500 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.470408132269139, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.687407266436221, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.395872 (no previous merge yet)
[S4] round=6 local utility u=0.006198 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4888671353944811, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5012626225776522, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.231967 (no previous merge yet)
[S5] round=6 local utility u=0.083502 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6263678652353861, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.793371888180938, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.425384 (no previous merge yet)
[S6] round=6 local utility u=0.331667 metrics={'f1_val': 0.013959981386691484, 'auprc': 0.013959981386691484, 'loss_val': 3.1981342789533573, 'psi': 0.013959981386691484}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7358293318749265, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.251653 (no previous merge yet)
[S7] round=6 local utility u=0.086109 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7631222907283202, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9353404838140327, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.362259 (no previous merge yet)
[S8] round=6 local utility u=0.287189 metrics={'f1_val': 0.47327721201038353, 'auprc': 0.47327721201038353, 'loss_val': 0.9160965142510499, 'psi': 0.47327721201038353}-{'f1_val': 0.42618340264688276, 'auprc': 0.42618340264688276, 'loss_val': 1.06663042335611, 'psi': 0.42618340264688276}
[S9] START round=6 head_norm_before_train=0.954046 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.257272 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0057951780821375, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.520338925108902, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.354078 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5392448103001426, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.078803405359909, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.285079 (no previous merge yet)
[S11] round=6 local utility u=0.166235 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5299913387702877, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8624616374106306, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.405733 (no previous merge yet)
[S13] round=6 local utility u=0.682619 metrics={'f1_val': 0.3321822068738694, 'auprc': 0.3321822068738694, 'loss_val': 1.2161932505097033, 'psi': 0.3321822068738694}-{'f1_val': 0.20052709980520225, 'auprc': 0.20052709980520225, 'loss_val': 1.3965351254449199, 'psi': 0.20052709980520225}
[S14] START round=6 head_norm_before_train=1.317207 (no previous merge yet)
[S14] round=6 local utility u=0.065156 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.916951352514242, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0472627971397674, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.272191 (no previous merge yet)
[S15] round=6 local utility u=1.000000 metrics={'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.2429919978450414, 'psi': 0.3040138275398502}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4267307766335993, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.283008 (no previous merge yet)
[S16] round=6 local utility u=0.022324 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.493428576936783, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5380756905413615, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.386872 (no previous merge yet)
[S17] round=6 local utility u=0.006430 metrics={'f1_val': 0.16543807919123843, 'auprc': 0.16543807919123843, 'loss_val': 1.2883658081192773, 'psi': 0.16543807919123843}-{'f1_val': 0.166102770141679, 'auprc': 0.166102770141679, 'loss_val': 1.3072089960103015, 'psi': 0.166102770141679}
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.332)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[S6] not sending this round → trigger blocked (psi=0.014)
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:59807
[S9] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:59814
[S11] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=-0.0144
[S6] DROPPED delta from S8 (cos=-0.0144 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=-0.0789
[S6] DROPPED delta from S2 (cos=-0.0789 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=-0.0151
[S14] DROPPED delta from S15 (cos=-0.0151 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.165)
[S2] START round=7 head_norm_before_train=1.459499 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.20392517632628027, 'auprc': 0.20392517632628027, 'loss_val': 2.3759894338925216, 'psi': 0.20392517632628027}-{'f1_val': 0.22868977545236538, 'auprc': 0.22868977545236538, 'loss_val': 2.5658668055535436, 'psi': 0.22868977545236535}
[S3] START round=7 head_norm_before_train=1.383422 (no previous merge yet)
[S3] round=7 local utility u=0.054724 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3609600850096912, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.470408132269139, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.441660 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4962048810427917, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4888671353944811, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.235174 (no previous merge yet)
[S5] round=7 local utility u=0.057604 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5111607592884986, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6263678652353861, 'psi': 0.0}
[S6] START round=7 head_norm_before_train=1.467707 (no previous merge yet)
[S6] round=7 local utility u=0.326980 metrics={'f1_val': 0.08877952755905512, 'auprc': 0.08877952755905512, 'loss_val': 3.2175496315802237, 'psi': 0.08877952755905512}-{'f1_val': 0.013959981386691484, 'auprc': 0.013959981386691484, 'loss_val': 3.1981342789533573, 'psi': 0.013959981386691484}
[S7] START round=7 head_norm_before_train=1.252700 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7978882613127063, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7631222907283202, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.433860 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.816805808305515, 'psi': 0.35939447907390915}-{'f1_val': 0.47327721201038353, 'auprc': 0.47327721201038353, 'loss_val': 0.9160965142510499, 'psi': 0.47327721201038353}
[S9] START round=7 head_norm_before_train=0.980052 cos_to_last_merge=0.9981 (last merge round=5)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4997957572771434, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0057951780821375, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.405044 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6113512013010642, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5392448103001426, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.300172 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.650690782118757, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5299913387702877, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.449290 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.24520795660036165, 'auprc': 0.24520795660036165, 'loss_val': 1.2081931422282055, 'psi': 0.24520795660036165}-{'f1_val': 0.3321822068738694, 'auprc': 0.3321822068738694, 'loss_val': 1.2161932505097033, 'psi': 0.3321822068738694}
[S14] START round=7 head_norm_before_train=1.338894 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.137398454442709, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.916951352514242, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.329831 (no previous merge yet)
[S15] round=7 local utility u=0.014036 metrics={'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.2149205641327319, 'psi': 0.3040138275398502}-{'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.2429919978450414, 'psi': 0.3040138275398502}
[S16] START round=7 head_norm_before_train=1.318159 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.015483739145619, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.493428576936783, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.434024 (no previous merge yet)
[S17] round=7 local utility u=0.020349 metrics={'f1_val': 0.17211496270293988, 'auprc': 0.17211496270293988, 'loss_val': 1.3077596030876673, 'psi': 0.17211496270293988}-{'f1_val': 0.16543807919123843, 'auprc': 0.16543807919123843, 'loss_val': 1.2883658081192773, 'psi': 0.16543807919123843}
[S5] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:59814
[S6] not sending this round → trigger blocked (psi=0.089)
[S15] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=-0.0240
[S14] DROPPED delta from S15 (cos=-0.0240 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.172)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=8 head_norm_before_train=1.508832 (no previous merge yet)
[S2] round=8 local utility u=0.127389 metrics={'f1_val': 0.24303373140582443, 'auprc': 0.24303373140582443, 'loss_val': 2.4731891213914743, 'psi': 0.24303373140582443}-{'f1_val': 0.20392517632628027, 'auprc': 0.20392517632628027, 'loss_val': 2.3759894338925216, 'psi': 0.20392517632628027}
[S3] START round=8 head_norm_before_train=1.417163 (no previous merge yet)
[S3] round=8 local utility u=0.145063 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0708338117191105, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3609600850096912, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.479670 (no previous merge yet)
[S4] round=8 local utility u=0.035986 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4242330947592527, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4962048810427917, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.245883 (no previous merge yet)
[S5] round=8 local utility u=0.178634 metrics={'f1_val': 0.03138922640745241, 'auprc': 0.03138922640745241, 'loss_val': 1.4363960038562642, 'psi': 0.03138922640745241}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5111607592884986, 'psi': 0.0}
[S6] START round=8 head_norm_before_train=1.506279 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.07780921584478577, 'auprc': 0.07780921584478577, 'loss_val': 4.051339348755824, 'psi': 0.07780921584478577}-{'f1_val': 0.08877952755905512, 'auprc': 0.08877952755905512, 'loss_val': 3.2175496315802237, 'psi': 0.08877952755905512}
[S7] START round=8 head_norm_before_train=1.266728 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8439238480025024, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7978882613127063, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.495195 (no previous merge yet)
[S8] round=8 local utility u=0.015905 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7849967679556682, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.816805808305515, 'psi': 0.35939447907390915}
[S9] START round=8 head_norm_before_train=1.019918 cos_to_last_merge=0.9918 (last merge round=5)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6777442946931442, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4997957572771434, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.441691 (no previous merge yet)
[S10] round=8 local utility u=0.016290 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5787711467256, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6113512013010642, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.322343 (no previous merge yet)
[S11] round=8 local utility u=0.039037 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5726162455818553, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.650690782118757, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.509798 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.24017003188097766, 'auprc': 0.24017003188097766, 'loss_val': 1.279790867272362, 'psi': 0.24017003188097766}-{'f1_val': 0.24520795660036165, 'auprc': 0.24520795660036165, 'loss_val': 1.2081931422282055, 'psi': 0.24520795660036165}
[S14] START round=8 head_norm_before_train=1.366927 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4377008439948753, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.137398454442709, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.389355 (no previous merge yet)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.28221007893139044, 'auprc': 0.28221007893139044, 'loss_val': 1.2596477274649907, 'psi': 0.28221007893139044}-{'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.2149205641327319, 'psi': 0.3040138275398502}
[S16] START round=8 head_norm_before_train=1.360604 (no previous merge yet)
[S16] round=8 local utility u=0.170421 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.67464236824847, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.015483739145619, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.473731 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.15747794707297513, 'auprc': 0.15747794707297513, 'loss_val': 1.2188700621275674, 'psi': 0.15747794707297513}-{'f1_val': 0.17211496270293988, 'auprc': 0.17211496270293988, 'loss_val': 1.3077596030876673, 'psi': 0.17211496270293988}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:59807
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:59807
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.031)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1806 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=-0.0050
[S6] DROPPED delta from S8 (cos=-0.0050 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1806) from S2
[S6] cosine check vs S2: cos=-0.0767
[S6] DROPPED delta from S2 (cos=-0.0767 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=9 head_norm_before_train=1.562702 (no previous merge yet)
[S2] round=9 local utility u=0.115468 metrics={'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 2.2618331593420002, 'psi': 0.24520932503356518}-{'f1_val': 0.24303373140582443, 'auprc': 0.24303373140582443, 'loss_val': 2.4731891213914743, 'psi': 0.24303373140582443}
[S3] START round=9 head_norm_before_train=1.449037 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.318648861738847, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0708338117191105, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.511326 (no previous merge yet)
[S4] round=9 local utility u=0.034125 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3559827093192576, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4242330947592527, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.266141 (no previous merge yet)
[S5] round=9 local utility u=0.933426 metrics={'f1_val': 0.22865872288420408, 'auprc': 0.22865872288420408, 'loss_val': 1.3449690478398544, 'psi': 0.22865872288420408}-{'f1_val': 0.03138922640745241, 'auprc': 0.03138922640745241, 'loss_val': 1.4363960038562642, 'psi': 0.03138922640745241}
[S6] START round=9 head_norm_before_train=1.554557 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.010985561833019459, 'auprc': 0.010985561833019459, 'loss_val': 5.083386059212756, 'psi': 0.010985561833019459}-{'f1_val': 0.07780921584478577, 'auprc': 0.07780921584478577, 'loss_val': 4.051339348755824, 'psi': 0.07780921584478577}
[S7] START round=9 head_norm_before_train=1.283177 (no previous merge yet)
[S7] round=9 local utility u=0.057510 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.728904369873756, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8439238480025024, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.565613 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8024377810808367, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7849967679556682, 'psi': 0.35939447907390915}
[S9] START round=9 head_norm_before_train=1.061507 cos_to_last_merge=0.9831 (last merge round=5)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.127557532586652, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6777442946931442, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.473372 (no previous merge yet)
[S10] round=9 local utility u=0.132833 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.313105684961035, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5787711467256, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.349312 (no previous merge yet)
[S11] round=9 local utility u=0.085656 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4013045222214147, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5726162455818553, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.567009 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.24017003188097766, 'auprc': 0.24017003188097766, 'loss_val': 1.3275330599820152, 'psi': 0.24017003188097766}-{'f1_val': 0.24017003188097766, 'auprc': 0.24017003188097766, 'loss_val': 1.279790867272362, 'psi': 0.24017003188097766}
[S14] START round=9 head_norm_before_train=1.399589 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.4511766661719845, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4377008439948753, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.444599 (no previous merge yet)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.17466977466977465, 'auprc': 0.17466977466977465, 'loss_val': 1.285996326494855, 'psi': 0.17466977466977465}-{'f1_val': 0.28221007893139044, 'auprc': 0.28221007893139044, 'loss_val': 1.2596477274649907, 'psi': 0.28221007893139044}
[S16] START round=9 head_norm_before_train=1.400549 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9964808039015995, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.67464236824847, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.504287 (no previous merge yet)
[S17] round=9 local utility u=0.282991 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.062330112599256, 'psi': 0.20297157622739018}-{'f1_val': 0.15747794707297513, 'auprc': 0.15747794707297513, 'loss_val': 1.2188700621275674, 'psi': 0.15747794707297513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:59807
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:59810
[S10] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S2] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=-0.0270
[S9] DROPPED delta from S5 (cos=-0.0270 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S2
[S6] cosine check vs S2: cos=-0.0730
[S6] DROPPED delta from S2 (cos=-0.0730 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] cosine check vs S17: cos=0.0906
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.2287 head_norm=1.288234
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.594799e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.3593 head_norm=1.049148 delta_norm=0.959480
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.609398 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.25564675192466757, 'auprc': 0.25564675192466757, 'loss_val': 2.3574213726093256, 'psi': 0.25564675192466757}-{'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 2.2618331593420002, 'psi': 0.24520932503356518}
[S3] START round=10 head_norm_before_train=1.483311 (no previous merge yet)
[S3] round=10 local utility u=0.121672 metrics={'f1_val': 0.0057553956834532375, 'auprc': 0.0057553956834532375, 'loss_val': 2.127102467271438, 'psi': 0.0057553956834532375}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.318648861738847, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.536011 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3719868078229698, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3559827093192576, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.049148 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.618150 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.284790062648113, 'psi': 0.35933890172383154}-{'f1_val': 0.22865872288420408, 'auprc': 0.22865872288420408, 'loss_val': 1.3449690478398544, 'psi': 0.22865872288420408}
[S6] START round=10 head_norm_before_train=1.597485 (no previous merge yet)
[S6] round=10 local utility u=0.195208 metrics={'f1_val': 0.03721754541426672, 'auprc': 0.03721754541426672, 'loss_val': 4.929058605252825, 'psi': 0.03721754541426672}-{'f1_val': 0.010985561833019459, 'auprc': 0.010985561833019459, 'loss_val': 5.083386059212756, 'psi': 0.010985561833019459}
[S7] START round=10 head_norm_before_train=1.294689 (no previous merge yet)
[S7] round=10 local utility u=0.063452 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6020007292792422, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.728904369873756, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.632609 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8587176521807451, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8024377810808367, 'psi': 0.35939447907390915}
[S9] START round=10 head_norm_before_train=1.105557 cos_to_last_merge=0.9740 (last merge round=5)
[S9] round=10 local utility u=0.166130 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7952967610369543, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.127557532586652, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.499490 (no previous merge yet)
[S10] round=10 local utility u=0.102660 metrics={'f1_val': 0.0004775549188156638, 'auprc': 0.0004775549188156638, 'loss_val': 3.1120842528672745, 'psi': 0.0004775549188156638}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.313105684961035, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.378494 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4378107064123467, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4013045222214147, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.611141 (no previous merge yet)
[S13] round=10 local utility u=0.543978 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3174726119539713, 'psi': 0.3599362944611573}-{'f1_val': 0.24017003188097766, 'auprc': 0.24017003188097766, 'loss_val': 1.3275330599820152, 'psi': 0.24017003188097766}
[S14] START round=10 head_norm_before_train=1.437185 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.330263461963012, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.4511766661719845, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.493548 (no previous merge yet)
[S15] round=10 local utility u=0.602407 metrics={'f1_val': 0.28221007893139044, 'auprc': 0.28221007893139044, 'loss_val': 1.049045773428999, 'psi': 0.28221007893139044}-{'f1_val': 0.17466977466977465, 'auprc': 0.17466977466977465, 'loss_val': 1.285996326494855, 'psi': 0.17466977466977465}
[S16] START round=10 head_norm_before_train=1.436090 (no previous merge yet)
[S16] round=10 local utility u=0.035528 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.925425359264781, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9964808039015995, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.543723 (no previous merge yet)
[S17] round=10 local utility u=0.040342 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9816453161556339, 'psi': 0.20297157622739018}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.062330112599256, 'psi': 0.20297157622739018}
[S3] not sending this round → trigger blocked (psi=0.006)
[S9] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[S7] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[S6] not sending this round → trigger blocked (psi=0.037)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S13
[S9] cosine check vs S13: cos=0.6466
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.0429
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0382
[S14] DROPPED delta from S15 (cos=-0.0382 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] cosine check vs S17: cos=0.7795
[S10] ⇄ pheromone p=0.152 → S4@127.0.0.1:59804
[S3] ⇄ pheromone p=0.165 → S2@127.0.0.1:59802
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.0000 head_norm=1.147409
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.237935e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.0000 head_norm=0.953537 delta_norm=0.523794
[S9] aggregate: ACCEPT kept=['S13', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.162 → S14@127.0.0.1:59814
[S4] ⇄ pheromone p=0.124 → S5@127.0.0.1:59805
[S8] ⇄ pheromone p=0.255 → S6@127.0.0.1:59807
[S11] ⇄ pheromone p=0.140 → S9@127.0.0.1:59810
[S6] ⇄ pheromone p=0.207 → S15@127.0.0.1:59815
[S2] ⇄ pheromone p=0.228 → S6@127.0.0.1:59807
[S7] ⇄ pheromone p=0.138 → S6@127.0.0.1:59807
[S14] ⇄ pheromone p=0.113 → S11@127.0.0.1:59812
[S13] ⇄ pheromone p=0.348 → S9@127.0.0.1:59810
[S15] ⇄ pheromone p=0.329 → S14@127.0.0.1:59814
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.3593 head_norm=1.078184
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.025179e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.3593 head_norm=1.258685 delta_norm=0.502518
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.423 → S9@127.0.0.1:59810
[S17] ⇄ pheromone p=0.231 → S5@127.0.0.1:59805
[S16] ⇄ pheromone p=0.138 → S4@127.0.0.1:59804
[S2] START round=11 head_norm_before_train=1.649178 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.2509524701767535, 'auprc': 0.2509524701767535, 'loss_val': 2.4151410020848534, 'psi': 0.2509524701767535}-{'f1_val': 0.25564675192466757, 'auprc': 0.25564675192466757, 'loss_val': 2.3574213726093256, 'psi': 0.25564675192466757}
[S3] START round=11 head_norm_before_train=1.514436 (no previous merge yet)
[S3] round=11 local utility u=0.734501 metrics={'f1_val': 0.15595680651442734, 'auprc': 0.15595680651442734, 'loss_val': 2.009913909083421, 'psi': 0.15595680651442734}-{'f1_val': 0.0057553956834532375, 'auprc': 0.0057553956834532375, 'loss_val': 2.127102467271438, 'psi': 0.0057553956834532375}
[S4] START round=11 head_norm_before_train=1.579955 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3853734890714644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3719868078229698, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.258685 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.014536 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.255717155541017, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.284790062648113, 'psi': 0.35933890172383154}
[S6] START round=11 head_norm_before_train=1.625764 (no previous merge yet)
[S6] round=11 local utility u=0.082179 metrics={'f1_val': 0.05666383701188455, 'auprc': 0.05666383701188455, 'loss_val': 4.939716531258415, 'psi': 0.05666383701188455}-{'f1_val': 0.03721754541426672, 'auprc': 0.03721754541426672, 'loss_val': 4.929058605252825, 'psi': 0.03721754541426672}
[S7] START round=11 head_norm_before_train=1.308406 (no previous merge yet)
[S7] round=11 local utility u=0.027212 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5475762547612002, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6020007292792422, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.691586 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.938129955539522, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8587176521807451, 'psi': 0.35939447907390915}
[S9] START round=11 head_norm_before_train=0.953537 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.338622 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1180531069507924, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7952967610369543, 'psi': 0.0}
[S10] START round=11 head_norm_before_train=1.529852 (no previous merge yet)
[S10] round=11 local utility u=0.896053 metrics={'f1_val': 0.18370123979437555, 'auprc': 0.18370123979437555, 'loss_val': 2.968991717096959, 'psi': 0.18370123979437555}-{'f1_val': 0.0004775549188156638, 'auprc': 0.0004775549188156638, 'loss_val': 3.1120842528672745, 'psi': 0.0004775549188156638}
[S11] START round=11 head_norm_before_train=1.414529 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5663120436620153, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4378107064123467, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.639984 (no previous merge yet)
[S13] round=11 local utility u=0.004477 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3085182589851443, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3174726119539713, 'psi': 0.3599362944611573}
[S14] START round=11 head_norm_before_train=1.472544 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.657216030405138, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.330263461963012, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.534023 (no previous merge yet)
[S15] round=11 local utility u=0.053067 metrics={'f1_val': 0.27924620655898186, 'auprc': 0.27924620655898186, 'loss_val': 0.9162368346209986, 'psi': 0.27924620655898186}-{'f1_val': 0.28221007893139044, 'auprc': 0.28221007893139044, 'loss_val': 1.049045773428999, 'psi': 0.28221007893139044}
[S16] START round=11 head_norm_before_train=1.469811 (no previous merge yet)
[S16] round=11 local utility u=0.553955 metrics={'f1_val': 0.10143066764490095, 'auprc': 0.10143066764490095, 'loss_val': 2.7303921148701593, 'psi': 0.10143066764490095}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.925425359264781, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.584658 (no previous merge yet)
[S17] round=11 local utility u=0.021371 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9389034140682085, 'psi': 0.20297157622739018}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9816453161556339, 'psi': 0.20297157622739018}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.101)
[S10] not sending this round → trigger blocked (psi=0.184)
[S3] not sending this round → trigger blocked (psi=0.156)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:59810
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:59814
[S6] not sending this round → trigger blocked (psi=0.057)
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S13
[S9] cosine check vs S13: cos=0.8284
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=-0.0349
[S14] DROPPED delta from S15 (cos=-0.0349 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.3434
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S17
[S5] cosine check vs S17: cos=0.9513
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.0000 head_norm=0.995296
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.177434e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.0063 head_norm=1.003932 delta_norm=0.317743
[S9] aggregate: ACCEPT kept=['S13', 'S5'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.3593 head_norm=1.288274
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.816374e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.3593 head_norm=1.439072 delta_norm=0.281637
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.682076 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 2.468286508680717, 'psi': 0.24538903139123003}-{'f1_val': 0.2509524701767535, 'auprc': 0.2509524701767535, 'loss_val': 2.4151410020848534, 'psi': 0.2509524701767535}
[S3] START round=12 head_norm_before_train=1.541096 (no previous merge yet)
[S3] round=12 local utility u=0.490028 metrics={'f1_val': 0.2609597924773022, 'auprc': 0.2609597924773022, 'loss_val': 1.9748838002727915, 'psi': 0.2609597924773022}-{'f1_val': 0.15595680651442734, 'auprc': 0.15595680651442734, 'loss_val': 2.009913909083421, 'psi': 0.15595680651442734}
[S4] START round=12 head_norm_before_train=1.616288 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.403718836872993, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3853734890714644, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.439072 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.009905 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.235907955350664, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.255717155541017, 'psi': 0.35933890172383154}
[S6] START round=12 head_norm_before_train=1.644682 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.045276447540269917, 'auprc': 0.045276447540269917, 'loss_val': 5.2306933904806, 'psi': 0.045276447540269917}-{'f1_val': 0.05666383701188455, 'auprc': 0.05666383701188455, 'loss_val': 4.939716531258415, 'psi': 0.05666383701188455}
[S7] START round=12 head_norm_before_train=1.328367 (no previous merge yet)
[S7] round=12 local utility u=0.061158 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4252606665404246, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5475762547612002, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.745142 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0547783432362625, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.938129955539522, 'psi': 0.35939447907390915}
[S9] START round=12 head_norm_before_train=1.003932 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=1.000000 metrics={'f1_val': 0.18192881046547002, 'auprc': 0.18192881046547002, 'loss_val': 1.729457741252501, 'psi': 0.18192881046547002}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1180531069507924, 'psi': 0.0}
[S10] START round=12 head_norm_before_train=1.562265 (no previous merge yet)
[S10] round=12 local utility u=0.166406 metrics={'f1_val': 0.21255839516350647, 'auprc': 0.21255839516350647, 'loss_val': 2.8958949111154153, 'psi': 0.21255839516350647}-{'f1_val': 0.18370123979437555, 'auprc': 0.18370123979437555, 'loss_val': 2.968991717096959, 'psi': 0.18370123979437555}
[S11] START round=12 head_norm_before_train=1.452849 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.739192618302428, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5663120436620153, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.665753 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3277046511241566, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3085182589851443, 'psi': 0.3599362944611573}
[S14] START round=12 head_norm_before_train=1.499337 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.701592316308501, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.657216030405138, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.577736 (no previous merge yet)
[S15] round=12 local utility u=0.025722 metrics={'f1_val': 0.27724477244772444, 'auprc': 0.27724477244772444, 'loss_val': 0.8467792548853695, 'psi': 0.27724477244772444}-{'f1_val': 0.27924620655898186, 'auprc': 0.27924620655898186, 'loss_val': 0.9162368346209986, 'psi': 0.27924620655898186}
[S16] START round=12 head_norm_before_train=1.504090 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.0001392757660167131, 'auprc': 0.0001392757660167131, 'loss_val': 3.5042028817224984, 'psi': 0.0001392757660167131}-{'f1_val': 0.10143066764490095, 'auprc': 0.10143066764490095, 'loss_val': 2.7303921148701593, 'psi': 0.10143066764490095}
[S17] START round=12 head_norm_before_train=1.625067 (no previous merge yet)
[S17] round=12 local utility u=0.016333 metrics={'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 0.9065909133859412, 'psi': 0.20301091942882987}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9389034140682085, 'psi': 0.20297157622739018}
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.182)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:59814
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:59802
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:59804
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=-0.0075
[S4] DROPPED delta from S10 (cos=-0.0075 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=-0.0306
[S14] DROPPED delta from S15 (cos=-0.0306 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.5143
[S2] RECEIVED delta(kind=head bytes=1794) from S3
[S2] cosine check vs S3: cos=0.0969
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] cosine check vs S17: cos=0.9830
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.2454 head_norm=1.708764
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.101946e+00
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.2476 head_norm=1.213994 delta_norm=1.101946
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.1819 head_norm=1.046822
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.451482e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.1991 head_norm=1.097775 delta_norm=0.645148
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.3593 head_norm=1.465202
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.737730e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.3593 head_norm=1.556381 delta_norm=0.173773
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.213994 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.403384 metrics={'f1_val': 0.24922466195261136, 'auprc': 0.24922466195261136, 'loss_val': 1.6960393651473304, 'psi': 0.24922466195261136}-{'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 2.468286508680717, 'psi': 0.24538903139123003}
[S3] START round=13 head_norm_before_train=1.567245 (no previous merge yet)
[S3] round=13 local utility u=0.505297 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.8931178809731755, 'psi': 0.3641628959276018}-{'f1_val': 0.2609597924773022, 'auprc': 0.2609597924773022, 'loss_val': 1.9748838002727915, 'psi': 0.2609597924773022}
[S4] START round=13 head_norm_before_train=1.653244 (no previous merge yet)
[S4] round=13 local utility u=0.008143 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.387433255443017, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.403718836872993, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.556381 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.006431 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.223045422342108, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.235907955350664, 'psi': 0.35933890172383154}
[S6] START round=13 head_norm_before_train=1.664490 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 5.654092290391937, 'psi': 0.019770114942528734}-{'f1_val': 0.045276447540269917, 'auprc': 0.045276447540269917, 'loss_val': 5.2306933904806, 'psi': 0.045276447540269917}
[S7] START round=13 head_norm_before_train=1.346058 (no previous merge yet)
[S7] round=13 local utility u=0.576850 metrics={'f1_val': 0.12443946188340807, 'auprc': 0.12443946188340807, 'loss_val': 1.391514879298501, 'psi': 0.12443946188340807}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4252606665404246, 'psi': 0.0}
[S8] START round=13 head_norm_before_train=1.790574 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1485108662772794, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0547783432362625, 'psi': 0.35939447907390915}
[S9] START round=13 head_norm_before_train=1.097775 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.1671415004748338, 'auprc': 0.1671415004748338, 'loss_val': 1.7219706468305545, 'psi': 0.1671415004748338}-{'f1_val': 0.18192881046547002, 'auprc': 0.18192881046547002, 'loss_val': 1.729457741252501, 'psi': 0.18192881046547002}
[S10] START round=13 head_norm_before_train=1.586816 (no previous merge yet)
[S10] round=13 local utility u=0.217471 metrics={'f1_val': 0.24801252710190316, 'auprc': 0.24801252710190316, 'loss_val': 2.780040646168576, 'psi': 0.24801252710190316}-{'f1_val': 0.21255839516350647, 'auprc': 0.21255839516350647, 'loss_val': 2.8958949111154153, 'psi': 0.21255839516350647}
[S11] START round=13 head_norm_before_train=1.485690 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8018244315470184, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.739192618302428, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.691935 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3759341082815288, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3277046511241566, 'psi': 0.3599362944611573}
[S14] START round=13 head_norm_before_train=1.522195 (no previous merge yet)
[S14] round=13 local utility u=0.441500 metrics={'f1_val': 0.10078447015024598, 'auprc': 0.10078447015024598, 'loss_val': 5.725652749072707, 'psi': 0.10078447015024598}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.701592316308501, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.625859 (no previous merge yet)
[S15] round=13 local utility u=1.000000 metrics={'f1_val': 0.6094692059031576, 'auprc': 0.6094692059031576, 'loss_val': 0.7933368105464406, 'psi': 0.6094692059031576}-{'f1_val': 0.27724477244772444, 'auprc': 0.27724477244772444, 'loss_val': 0.8467792548853695, 'psi': 0.27724477244772444}
[S16] START round=13 head_norm_before_train=1.538064 (no previous merge yet)
[S16] round=13 local utility u=1.000000 metrics={'f1_val': 0.18479515291402193, 'auprc': 0.18479515291402193, 'loss_val': 2.561944316288415, 'psi': 0.18479515291402193}-{'f1_val': 0.0001392757660167131, 'auprc': 0.0001392757660167131, 'loss_val': 3.5042028817224984, 'psi': 0.0001392757660167131}
[S17] START round=13 head_norm_before_train=1.660789 (no previous merge yet)
[S17] round=13 local utility u=0.448577 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.916627001214203, 'psi': 0.30380970798684975}-{'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 0.9065909133859412, 'psi': 0.20301091942882987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:59802
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.124)
[S16] not sending this round → trigger blocked (psi=0.185)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:59807
[S14] not sending this round → trigger blocked (psi=0.101)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:59810
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:59804
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.8881
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=-0.0070
[S4] DROPPED delta from S10 (cos=-0.0070 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S2
[S6] cosine check vs S2: cos=-0.0357
[S6] DROPPED delta from S2 (cos=-0.0357 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S15
[S14] cosine check vs S15: cos=-0.0270
[S14] DROPPED delta from S15 (cos=-0.0270 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=0.6823
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S17
[S5] cosine check vs S17: cos=0.9909
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.1671 head_norm=1.133592
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.880769e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.1793 head_norm=1.320364 delta_norm=0.388077
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.2492 head_norm=1.278504
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.903884e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.2505 head_norm=1.318747 delta_norm=0.590388
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.3593 head_norm=1.582056
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.222309e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.3593 head_norm=1.631732 delta_norm=0.122231
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.318747 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.629776 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.5007634697892733, 'psi': 0.3674775928297055}-{'f1_val': 0.24922466195261136, 'auprc': 0.24922466195261136, 'loss_val': 1.6960393651473304, 'psi': 0.24922466195261136}
[S3] START round=14 head_norm_before_train=1.593967 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.258047967166859, 'auprc': 0.258047967166859, 'loss_val': 2.127154780022834, 'psi': 0.258047967166859}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.8931178809731755, 'psi': 0.3641628959276018}
[S4] START round=14 head_norm_before_train=1.686174 (no previous merge yet)
[S4] round=14 local utility u=1.000000 metrics={'f1_val': 0.23745783001414736, 'auprc': 0.23745783001414736, 'loss_val': 1.3635265055468868, 'psi': 0.23745783001414736}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.387433255443017, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.631732 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.18097340501558157, 'auprc': 0.18097340501558157, 'loss_val': 1.2136201331247092, 'psi': 0.18097340501558157}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.223045422342108, 'psi': 0.35933890172383154}
[S6] START round=14 head_norm_before_train=1.685622 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.004976303317535545, 'auprc': 0.004976303317535545, 'loss_val': 5.838663941671574, 'psi': 0.004976303317535545}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 5.654092290391937, 'psi': 0.019770114942528734}
[S7] START round=14 head_norm_before_train=1.363535 (no previous merge yet)
[S7] round=14 local utility u=0.330466 metrics={'f1_val': 0.19640744326126705, 'auprc': 0.19640744326126705, 'loss_val': 1.3782938853118416, 'psi': 0.19640744326126705}-{'f1_val': 0.12443946188340807, 'auprc': 0.12443946188340807, 'loss_val': 1.391514879298501, 'psi': 0.12443946188340807}
[S8] START round=14 head_norm_before_train=1.822387 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2337187451582392, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1485108662772794, 'psi': 0.35939447907390915}
[S9] START round=14 head_norm_before_train=1.320364 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.055085 metrics={'f1_val': 0.18366439371479396, 'auprc': 0.18366439371479396, 'loss_val': 1.7605071330943836, 'psi': 0.18366439371479396}-{'f1_val': 0.1671415004748338, 'auprc': 0.1671415004748338, 'loss_val': 1.7219706468305545, 'psi': 0.1671415004748338}
[S10] START round=14 head_norm_before_train=1.604414 (no previous merge yet)
[S10] round=14 local utility u=0.060677 metrics={'f1_val': 0.24946133588700023, 'auprc': 0.24946133588700023, 'loss_val': 2.6717267777948677, 'psi': 0.24946133588700026}-{'f1_val': 0.24801252710190316, 'auprc': 0.24801252710190316, 'loss_val': 2.780040646168576, 'psi': 0.24801252710190316}
[S11] START round=14 head_norm_before_train=1.514455 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1875715364490267, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8018244315470184, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.712072 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.393086602664042, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3759341082815288, 'psi': 0.3599362944611573}
[S14] START round=14 head_norm_before_train=1.543580 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.012300123001230012, 'auprc': 0.012300123001230012, 'loss_val': 5.817917345612585, 'psi': 0.012300123001230012}-{'f1_val': 0.10078447015024598, 'auprc': 0.10078447015024598, 'loss_val': 5.725652749072707, 'psi': 0.10078447015024598}
[S15] START round=14 head_norm_before_train=1.662575 (no previous merge yet)
[S15] round=14 local utility u=0.073974 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6983800216749042, 'psi': 0.6153571007984797}-{'f1_val': 0.6094692059031576, 'auprc': 0.6094692059031576, 'loss_val': 0.7933368105464406, 'psi': 0.6094692059031576}
[S16] START round=14 head_norm_before_train=1.569748 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.04764898164445562, 'auprc': 0.04764898164445562, 'loss_val': 3.5998698547435213, 'psi': 0.04764898164445562}-{'f1_val': 0.18479515291402193, 'auprc': 0.18479515291402193, 'loss_val': 2.561944316288415, 'psi': 0.18479515291402193}
[S17] START round=14 head_norm_before_train=1.688811 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.2039951713973338, 'auprc': 0.2039951713973338, 'loss_val': 0.9010861162987354, 'psi': 0.2039951713973338}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.916627001214203, 'psi': 0.30380970798684975}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:59805
[S7] not sending this round → trigger blocked (psi=0.196)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:59804
[S9] not sending this round → trigger blocked (psi=0.184)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[S15] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=-0.0098
[S6] DROPPED delta from S2 (cos=-0.0098 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S4
[S5] cosine check vs S4: cos=-0.0635
[S5] DROPPED delta from S4 (cos=-0.0635 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=-0.0256
[S14] DROPPED delta from S15 (cos=-0.0256 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=-0.0084
[S4] DROPPED delta from S10 (cos=-0.0084 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=15 head_norm_before_train=1.408131 cos_to_last_merge=0.9905 (last merge round=13)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 1.6368984658928765, 'psi': 0.24507471790179935}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.5007634697892733, 'psi': 0.3674775928297055}
[S3] START round=15 head_norm_before_train=1.617369 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.25322509596627024, 'auprc': 0.25322509596627024, 'loss_val': 2.2271539467908887, 'psi': 0.25322509596627024}-{'f1_val': 0.258047967166859, 'auprc': 0.258047967166859, 'loss_val': 2.127154780022834, 'psi': 0.258047967166859}
[S4] START round=15 head_norm_before_train=1.722075 (no previous merge yet)
[S4] round=15 local utility u=0.448621 metrics={'f1_val': 0.3330795906284361, 'auprc': 0.3330795906284361, 'loss_val': 1.3268809750283448, 'psi': 0.3330795906284361}-{'f1_val': 0.23745783001414736, 'auprc': 0.23745783001414736, 'loss_val': 1.3635265055468868, 'psi': 0.23745783001414736}
[S5] START round=15 head_norm_before_train=1.658775 cos_to_last_merge=0.9990 (last merge round=13)
[S5] round=15 local utility u=1.000000 metrics={'f1_val': 0.4977446138446502, 'auprc': 0.4977446138446502, 'loss_val': 1.2054325749907326, 'psi': 0.4977446138446502}-{'f1_val': 0.18097340501558157, 'auprc': 0.18097340501558157, 'loss_val': 1.2136201331247092, 'psi': 0.18097340501558157}
[S6] START round=15 head_norm_before_train=1.703596 (no previous merge yet)
[S6] round=15 local utility u=0.094590 metrics={'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 5.812230668132465, 'psi': 0.023059360730593607}-{'f1_val': 0.004976303317535545, 'auprc': 0.004976303317535545, 'loss_val': 5.838663941671574, 'psi': 0.004976303317535545}
[S7] START round=15 head_norm_before_train=1.376895 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.18155126009297773, 'auprc': 0.18155126009297773, 'loss_val': 1.377734653129147, 'psi': 0.18155126009297773}-{'f1_val': 0.19640744326126705, 'auprc': 0.19640744326126705, 'loss_val': 1.3782938853118416, 'psi': 0.19640744326126705}
[S8] START round=15 head_norm_before_train=1.851400 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3120060862593217, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2337187451582392, 'psi': 0.35939447907390915}
[S9] START round=15 head_norm_before_train=1.353058 cos_to_last_merge=0.9966 (last merge round=13)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.1523316806783071, 'auprc': 0.1523316806783071, 'loss_val': 1.981366165389487, 'psi': 0.1523316806783071}-{'f1_val': 0.18366439371479396, 'auprc': 0.18366439371479396, 'loss_val': 1.7605071330943836, 'psi': 0.18366439371479396}
[S10] START round=15 head_norm_before_train=1.639272 (no previous merge yet)
[S10] round=15 local utility u=0.066782 metrics={'f1_val': 0.24952130205840115, 'auprc': 0.24952130205840115, 'loss_val': 2.538702187155164, 'psi': 0.24952130205840112}-{'f1_val': 0.24946133588700023, 'auprc': 0.24946133588700023, 'loss_val': 2.6717267777948677, 'psi': 0.24946133588700026}
[S11] START round=15 head_norm_before_train=1.538861 (no previous merge yet)
[S11] round=15 local utility u=1.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.6283306806943134, 'psi': 0.3319353836595216}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1875715364490267, 'psi': 0.0}
[S13] START round=15 head_norm_before_train=1.731812 (no previous merge yet)
[S13] round=15 local utility u=0.003433 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3862207356864558, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.393086602664042, 'psi': 0.3599362944611573}
[S14] START round=15 head_norm_before_train=1.566150 (no previous merge yet)
[S14] round=15 local utility u=0.494087 metrics={'f1_val': 0.10236011667992574, 'auprc': 0.10236011667992574, 'loss_val': 5.640283116685602, 'psi': 0.10236011667992574}-{'f1_val': 0.012300123001230012, 'auprc': 0.012300123001230012, 'loss_val': 5.817917345612585, 'psi': 0.012300123001230012}
[S15] START round=15 head_norm_before_train=1.695023 (no previous merge yet)
[S15] round=15 local utility u=0.013819 metrics={'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.6606355341519768, 'psi': 0.6142341889454641}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6983800216749042, 'psi': 0.6153571007984797}
[S16] START round=15 head_norm_before_train=1.597612 (no previous merge yet)
[S16] round=15 local utility u=0.748970 metrics={'f1_val': 0.14871582435791217, 'auprc': 0.14871582435791217, 'loss_val': 3.011530808168795, 'psi': 0.14871582435791217}-{'f1_val': 0.04764898164445562, 'auprc': 0.04764898164445562, 'loss_val': 3.5998698547435213, 'psi': 0.04764898164445562}
[S17] START round=15 head_norm_before_train=1.707537 (no previous merge yet)
[S17] round=15 local utility u=0.273806 metrics={'f1_val': 0.26058467876858754, 'auprc': 0.26058467876858754, 'loss_val': 0.8627799798474763, 'psi': 0.26058467876858754}-{'f1_val': 0.2039951713973338, 'auprc': 0.2039951713973338, 'loss_val': 0.9010861162987354, 'psi': 0.2039951713973338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[S14] not sending this round → trigger blocked (psi=0.102)
[S6] not sending this round → trigger blocked (psi=0.023)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:59810
[S16] not sending this round → trigger blocked (psi=0.149)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:59805
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=-0.0109
[S4] DROPPED delta from S10 (cos=-0.0109 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S4
[S5] cosine check vs S4: cos=-0.0659
[S5] DROPPED delta from S4 (cos=-0.0659 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S11
[S9] cosine check vs S11: cos=0.0381
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] cosine check vs S13: cos=0.2977
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.9486
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=-0.0236
[S14] DROPPED delta from S15 (cos=-0.0236 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] cosine check vs S17: cos=0.9885
[S3] ⇄ pheromone p=0.229 → S2@127.0.0.1:59802
[S8] ⇄ pheromone p=0.084 → S6@127.0.0.1:59807
[S7] ⇄ pheromone p=0.180 → S6@127.0.0.1:59807
[S2] ⇄ pheromone p=0.227 → S6@127.0.0.1:59807
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.1523 head_norm=1.397746
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.539180e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.1749 head_norm=1.126350 delta_norm=0.453918
[S9] aggregate: ACCEPT kept=['S11', 'S13', 'S5'] (k=3/3) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.192 → S14@127.0.0.1:59814
[S14] ⇄ pheromone p=0.192 → S11@127.0.0.1:59812
[S6] ⇄ pheromone p=0.094 → S15@127.0.0.1:59815
[S13] ⇄ pheromone p=0.115 → S9@127.0.0.1:59810
[S10] ⇄ pheromone p=0.191 → S4@127.0.0.1:59804
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.4977 head_norm=1.685912
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.311241e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.4418 head_norm=1.703085 delta_norm=0.131124
[S5] aggregate: ROLLBACK (f1_val pre=0.498 post=0.442 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.342 → S9@127.0.0.1:59810
[S4] ⇄ pheromone p=0.291 → S5@127.0.0.1:59805
[S11] ⇄ pheromone p=0.246 → S9@127.0.0.1:59810
[S15] ⇄ pheromone p=0.258 → S14@127.0.0.1:59814
[S17] ⇄ pheromone p=0.191 → S5@127.0.0.1:59805
[S16] ⇄ pheromone p=0.368 → S4@127.0.0.1:59804
[S2] START round=16 head_norm_before_train=1.507563 cos_to_last_merge=0.9726 (last merge round=13)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.2522760092923966, 'auprc': 0.2522760092923966, 'loss_val': 1.797658876399004, 'psi': 0.2522760092923966}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 1.6368984658928765, 'psi': 0.24507471790179935}
[S3] START round=16 head_norm_before_train=1.639781 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.25779998718687935, 'auprc': 0.25779998718687935, 'loss_val': 2.381099908766859, 'psi': 0.25779998718687935}-{'f1_val': 0.25322509596627024, 'auprc': 0.25322509596627024, 'loss_val': 2.2271539467908887, 'psi': 0.25322509596627024}
[S4] START round=16 head_norm_before_train=1.762807 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.3227760045830264, 'auprc': 0.3227760045830264, 'loss_val': 1.2933442107191775, 'psi': 0.3227760045830264}-{'f1_val': 0.3330795906284361, 'auprc': 0.3330795906284361, 'loss_val': 1.3268809750283448, 'psi': 0.3330795906284361}
[S5] START round=16 head_norm_before_train=1.703085 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.26045149153042496, 'auprc': 0.26045149153042496, 'loss_val': 1.2191705806502071, 'psi': 0.26045149153042496}-{'f1_val': 0.4977446138446502, 'auprc': 0.4977446138446502, 'loss_val': 1.2054325749907326, 'psi': 0.4977446138446502}
[S6] START round=16 head_norm_before_train=1.721308 (no previous merge yet)
[S6] round=16 local utility u=0.733956 metrics={'f1_val': 0.10450586898901931, 'auprc': 0.10450586898901931, 'loss_val': 5.077336288605518, 'psi': 0.10450586898901931}-{'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 5.812230668132465, 'psi': 0.023059360730593607}
[S7] START round=16 head_norm_before_train=1.394401 (no previous merge yet)
[S7] round=16 local utility u=0.191044 metrics={'f1_val': 0.21909409409409408, 'auprc': 0.21909409409409408, 'loss_val': 1.333531987503633, 'psi': 0.21909409409409408}-{'f1_val': 0.18155126009297773, 'auprc': 0.18155126009297773, 'loss_val': 1.377734653129147, 'psi': 0.18155126009297773}
[S8] START round=16 head_norm_before_train=1.878543 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3844957802159121, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3120060862593217, 'psi': 0.35939447907390915}
[S9] START round=16 head_norm_before_train=1.126350 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.391555 metrics={'f1_val': 0.20808507912101992, 'auprc': 0.20808507912101992, 'loss_val': 1.700035947162785, 'psi': 0.20808507912101992}-{'f1_val': 0.1523316806783071, 'auprc': 0.1523316806783071, 'loss_val': 1.981366165389487, 'psi': 0.1523316806783071}
[S10] START round=16 head_norm_before_train=1.696313 (no previous merge yet)
[S10] round=16 local utility u=0.063477 metrics={'f1_val': 0.2494615936826992, 'auprc': 0.2494615936826992, 'loss_val': 2.411211677555889, 'psi': 0.2494615936826992}-{'f1_val': 0.24952130205840115, 'auprc': 0.24952130205840115, 'loss_val': 2.538702187155164, 'psi': 0.24952130205840112}
[S11] START round=16 head_norm_before_train=1.559982 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.97154777105491, 'psi': 0.33201273984308244}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.6283306806943134, 'psi': 0.3319353836595216}
[S13] START round=16 head_norm_before_train=1.754927 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4158744614244396, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3862207356864558, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.587432 (no previous merge yet)
[S14] round=16 local utility u=0.215405 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.508000413525341, 'psi': 0.1355297641332834}-{'f1_val': 0.10236011667992574, 'auprc': 0.10236011667992574, 'loss_val': 5.640283116685602, 'psi': 0.10236011667992574}
[S15] START round=16 head_norm_before_train=1.743143 (no previous merge yet)
[S15] round=16 local utility u=0.043834 metrics={'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.5881048408490628, 'psi': 0.61591610673549}-{'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.6606355341519768, 'psi': 0.6142341889454641}
[S16] START round=16 head_norm_before_train=1.625561 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.020316432937792162, 'auprc': 0.020316432937792162, 'loss_val': 4.198432014238765, 'psi': 0.020316432937792162}-{'f1_val': 0.14871582435791217, 'auprc': 0.14871582435791217, 'loss_val': 3.011530808168795, 'psi': 0.14871582435791217}
[S17] START round=16 head_norm_before_train=1.730054 (no previous merge yet)
[S17] round=16 local utility u=0.232618 metrics={'f1_val': 0.31475018141724603, 'auprc': 0.31475018141724603, 'loss_val': 0.8850340290675024, 'psi': 0.31475018141724603}-{'f1_val': 0.26058467876858754, 'auprc': 0.26058467876858754, 'loss_val': 0.8627799798474763, 'psi': 0.26058467876858754}
[S14] not sending this round → trigger blocked (psi=0.136)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.105)
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=-0.0093
[S4] DROPPED delta from S10 (cos=-0.0093 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=-0.1114
[S14] DROPPED delta from S9 (cos=-0.1114 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=-0.0206
[S14] DROPPED delta from S15 (cos=-0.0206 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] cosine check vs S7: cos=0.0110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] cosine check vs S17: cos=0.9940
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.1045 head_norm=1.732038
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.111158e+00
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.1117 head_norm=1.123181 delta_norm=1.111158
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.2605 head_norm=1.726986
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.639269e-02
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.2505 head_norm=1.740177 delta_norm=0.096393
[S5] aggregate: ROLLBACK (f1_val pre=0.260 post=0.251 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.579489 cos_to_last_merge=0.9601 (last merge round=13)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.2513763763763764, 'auprc': 0.2513763763763764, 'loss_val': 1.9117872312340316, 'psi': 0.2513763763763764}-{'f1_val': 0.2522760092923966, 'auprc': 0.2522760092923966, 'loss_val': 1.797658876399004, 'psi': 0.2522760092923966}
[S3] START round=17 head_norm_before_train=1.664341 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.1939838025453143, 'auprc': 0.1939838025453143, 'loss_val': 2.498682768374661, 'psi': 0.1939838025453143}-{'f1_val': 0.25779998718687935, 'auprc': 0.25779998718687935, 'loss_val': 2.381099908766859, 'psi': 0.25779998718687935}
[S4] START round=17 head_norm_before_train=1.789522 (no previous merge yet)
[S4] round=17 local utility u=0.172806 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2538938384138723, 'psi': 0.3567939207526687}-{'f1_val': 0.3227760045830264, 'auprc': 0.3227760045830264, 'loss_val': 1.2933442107191775, 'psi': 0.3227760045830264}
[S5] START round=17 head_norm_before_train=1.740177 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.2509457755359395, 'auprc': 0.2509457755359395, 'loss_val': 1.5218090847700156, 'psi': 0.2509457755359395}-{'f1_val': 0.26045149153042496, 'auprc': 0.26045149153042496, 'loss_val': 1.2191705806502071, 'psi': 0.26045149153042496}
[S6] START round=17 head_norm_before_train=1.123181 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.513092 metrics={'f1_val': 0.007543611504007544, 'auprc': 0.007543611504007544, 'loss_val': 3.178491530508938, 'psi': 0.007543611504007544}-{'f1_val': 0.10450586898901931, 'auprc': 0.10450586898901931, 'loss_val': 5.077336288605518, 'psi': 0.10450586898901931}
[S7] START round=17 head_norm_before_train=1.411545 (no previous merge yet)
[S7] round=17 local utility u=0.654024 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.291509826776927, 'psi': 0.35976373724718097}-{'f1_val': 0.21909409409409408, 'auprc': 0.21909409409409408, 'loss_val': 1.333531987503633, 'psi': 0.21909409409409408}
[S8] START round=17 head_norm_before_train=1.901837 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4504300170384392, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3844957802159121, 'psi': 0.35939447907390915}
[S9] START round=17 head_norm_before_train=1.176525 cos_to_last_merge=0.9965 (last merge round=15)
[S9] round=17 local utility u=0.089746 metrics={'f1_val': 0.23102671778954417, 'auprc': 0.23102671778954417, 'loss_val': 1.727018955734669, 'psi': 0.23102671778954417}-{'f1_val': 0.20808507912101992, 'auprc': 0.20808507912101992, 'loss_val': 1.700035947162785, 'psi': 0.20808507912101992}
[S10] START round=17 head_norm_before_train=1.744451 (no previous merge yet)
[S10] round=17 local utility u=0.028492 metrics={'f1_val': 0.2494615936826992, 'auprc': 0.2494615936826992, 'loss_val': 2.354226944428557, 'psi': 0.2494615936826992}-{'f1_val': 0.2494615936826992, 'auprc': 0.2494615936826992, 'loss_val': 2.411211677555889, 'psi': 0.2494615936826992}
[S11] START round=17 head_norm_before_train=1.579634 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.0544945011879197, 'psi': 0.33201273984308244}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.97154777105491, 'psi': 0.33201273984308244}
[S13] START round=17 head_norm_before_train=1.774424 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4383436030675416, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4158744614244396, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=1.609466 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.1292929292929293, 'auprc': 0.1292929292929293, 'loss_val': 5.478143732248916, 'psi': 0.1292929292929293}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.508000413525341, 'psi': 0.1355297641332834}
[S15] START round=17 head_norm_before_train=1.795377 (no previous merge yet)
[S15] round=17 local utility u=0.008859 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5728965380304065, 'psi': 0.6161950003225232}-{'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.5881048408490628, 'psi': 0.61591610673549}
[S16] START round=17 head_norm_before_train=1.650927 (no previous merge yet)
[S16] round=17 local utility u=1.000000 metrics={'f1_val': 0.1558330967925064, 'auprc': 0.1558330967925064, 'loss_val': 3.1833287672538684, 'psi': 0.1558330967925064}-{'f1_val': 0.020316432937792162, 'auprc': 0.020316432937792162, 'loss_val': 4.198432014238765, 'psi': 0.020316432937792162}
[S17] START round=17 head_norm_before_train=1.758561 (no previous merge yet)
[S17] round=17 local utility u=0.394755 metrics={'f1_val': 0.3976864547246121, 'auprc': 0.3976864547246121, 'loss_val': 0.8419495254922419, 'psi': 0.3976864547246121}-{'f1_val': 0.31475018141724603, 'auprc': 0.31475018141724603, 'loss_val': 0.8850340290675024, 'psi': 0.31475018141724603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.008)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.156)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:59807
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=0.6021
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=-0.0071
[S4] DROPPED delta from S10 (cos=-0.0071 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=-0.0203
[S14] DROPPED delta from S15 (cos=-0.0203 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=-0.1107
[S14] DROPPED delta from S9 (cos=-0.1107 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] cosine check vs S4: cos=-0.0617
[S5] DROPPED delta from S4 (cos=-0.0617 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S17
[S5] cosine check vs S17: cos=0.9956
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.2509 head_norm=1.762736
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.346256e-02
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.2502 head_norm=1.770621 delta_norm=0.083463
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.0075 head_norm=1.169102
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.920520e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.0280 head_norm=1.165683 delta_norm=0.592052
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.626558 cos_to_last_merge=0.9524 (last merge round=13)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.250529991270732, 'auprc': 0.250529991270732, 'loss_val': 2.0045042613301125, 'psi': 0.250529991270732}-{'f1_val': 0.2513763763763764, 'auprc': 0.2513763763763764, 'loss_val': 1.9117872312340316, 'psi': 0.2513763763763764}
[S3] START round=18 head_norm_before_train=1.689212 (no previous merge yet)
[S3] round=18 local utility u=0.766647 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.497000418705136, 'psi': 0.3641628959276018}-{'f1_val': 0.1939838025453143, 'auprc': 0.1939838025453143, 'loss_val': 2.498682768374661, 'psi': 0.1939838025453143}
[S4] START round=18 head_norm_before_train=1.821695 (no previous merge yet)
[S4] round=18 local utility u=0.015884 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.222125165238865, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2538938384138723, 'psi': 0.3567939207526687}
[S5] START round=18 head_norm_before_train=1.770621 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.23845117873640184, 'auprc': 0.23845117873640184, 'loss_val': 2.1572282796787823, 'psi': 0.23845117873640184}-{'f1_val': 0.2509457755359395, 'auprc': 0.2509457755359395, 'loss_val': 1.5218090847700156, 'psi': 0.2509457755359395}
[S6] START round=18 head_norm_before_train=1.165683 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.265582 metrics={'f1_val': 0.024145785876993165, 'auprc': 0.024145785876993165, 'loss_val': 2.796746329392917, 'psi': 0.024145785876993165}-{'f1_val': 0.007543611504007544, 'auprc': 0.007543611504007544, 'loss_val': 3.178491530508938, 'psi': 0.007543611504007544}
[S7] START round=18 head_norm_before_train=1.432440 (no previous merge yet)
[S7] round=18 local utility u=0.012221 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2670673490118907, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.291509826776927, 'psi': 0.35976373724718097}
[S8] START round=18 head_norm_before_train=1.920624 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4960211394423417, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4504300170384392, 'psi': 0.35939447907390915}
[S9] START round=18 head_norm_before_train=1.233312 cos_to_last_merge=0.9888 (last merge round=15)
[S9] round=18 local utility u=0.580318 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.805187986257558, 'psi': 0.36867172340800847}-{'f1_val': 0.23102671778954417, 'auprc': 0.23102671778954417, 'loss_val': 1.727018955734669, 'psi': 0.23102671778954417}
[S10] START round=18 head_norm_before_train=1.792028 (no previous merge yet)
[S10] round=18 local utility u=0.016147 metrics={'f1_val': 0.2494615936826992, 'auprc': 0.2494615936826992, 'loss_val': 2.321932604247259, 'psi': 0.2494615936826992}-{'f1_val': 0.2494615936826992, 'auprc': 0.2494615936826992, 'loss_val': 2.354226944428557, 'psi': 0.2494615936826992}
[S11] START round=18 head_norm_before_train=1.596968 (no previous merge yet)
[S11] round=18 local utility u=0.101837 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 2.8473501353919777, 'psi': 0.33162711338607104}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.0544945011879197, 'psi': 0.33201273984308244}
[S13] START round=18 head_norm_before_train=1.788200 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4698566690924981, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4383436030675416, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.633142 (no previous merge yet)
[S14] round=18 local utility u=0.060246 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.415572359494716, 'psi': 0.13572854291417166}-{'f1_val': 0.1292929292929293, 'auprc': 0.1292929292929293, 'loss_val': 5.478143732248916, 'psi': 0.1292929292929293}
[S15] START round=18 head_norm_before_train=1.843178 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6121492794829994, 'auprc': 0.6121492794829994, 'loss_val': 0.6127968291211232, 'psi': 0.6121492794829994}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5728965380304065, 'psi': 0.6161950003225232}
[S16] START round=18 head_norm_before_train=1.673922 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.08884612300537247, 'auprc': 0.08884612300537247, 'loss_val': 4.130751966020506, 'psi': 0.08884612300537247}-{'f1_val': 0.1558330967925064, 'auprc': 0.1558330967925064, 'loss_val': 3.1833287672538684, 'psi': 0.1558330967925064}
[S17] START round=18 head_norm_before_train=1.782383 (no previous merge yet)
[S17] round=18 local utility u=0.030310 metrics={'f1_val': 0.4065243363981092, 'auprc': 0.4065243363981092, 'loss_val': 0.8608700952650535, 'psi': 0.4065243363981092}-{'f1_val': 0.3976864547246121, 'auprc': 0.3976864547246121, 'loss_val': 0.8419495254922419, 'psi': 0.3976864547246121}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:59804
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[S10] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=-0.0056
[S4] DROPPED delta from S10 (cos=-0.0056 < 0.0)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.8468
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:59810
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] cosine check vs S4: cos=-0.0604
[S5] DROPPED delta from S4 (cos=-0.0604 < 0.0)
[S6] not sending this round → trigger blocked (psi=0.024)
[S11] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S11
[S9] cosine check vs S11: cos=0.2259
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:59805
[S3] sending update (kind=head size=1793 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1793) from S3
[S2] cosine check vs S3: cos=0.7970
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S17
[S5] cosine check vs S17: cos=0.9963
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.2505 head_norm=1.659843
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.377876e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.2505 head_norm=1.598180 delta_norm=0.537788
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[S9] sending update (kind=head size=1801 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.2385 head_norm=1.795136
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.719915e-02
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.2506 head_norm=1.799186 delta_norm=0.077199
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=-0.1119
[S14] DROPPED delta from S9 (cos=-0.1119 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.0241 head_norm=1.235490
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.858319e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.0347 head_norm=1.291081 delta_norm=0.385832
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.3687 head_norm=1.287670
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.127668e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.2452 head_norm=1.141783 delta_norm=0.912767
[S9] aggregate: ROLLBACK (f1_val pre=0.369 post=0.245 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.598180 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.686262 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6845080484445858, 'psi': 0.3674775928297055}-{'f1_val': 0.250529991270732, 'auprc': 0.250529991270732, 'loss_val': 2.0045042613301125, 'psi': 0.250529991270732}
[S3] START round=19 head_norm_before_train=1.712224 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.2570096442485789, 'auprc': 0.2570096442485789, 'loss_val': 2.605807099012156, 'psi': 0.2570096442485789}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.497000418705136, 'psi': 0.3641628959276018}
[S4] START round=19 head_norm_before_train=1.868921 (no previous merge yet)
[S4] round=19 local utility u=0.012880 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1963647608129186, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.222125165238865, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.799186 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.11579647054170887, 'auprc': 0.11579647054170887, 'loss_val': 2.4476896741293546, 'psi': 0.11579647054170887}-{'f1_val': 0.23845117873640184, 'auprc': 0.23845117873640184, 'loss_val': 2.1572282796787823, 'psi': 0.23845117873640184}
[S6] START round=19 head_norm_before_train=1.291081 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.02327704244637152, 'auprc': 0.02327704244637152, 'loss_val': 2.9863187991328966, 'psi': 0.02327704244637152}-{'f1_val': 0.024145785876993165, 'auprc': 0.024145785876993165, 'loss_val': 2.796746329392917, 'psi': 0.024145785876993165}
[S7] START round=19 head_norm_before_train=1.450889 (no previous merge yet)
[S7] round=19 local utility u=0.013902 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2392628065331817, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2670673490118907, 'psi': 0.35976373724718097}
[S8] START round=19 head_norm_before_train=1.935952 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5336935582935858, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4960211394423417, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.141783 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.215524 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3741398367788347, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.805187986257558, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.836201 (no previous merge yet)
[S10] round=19 local utility u=0.039739 metrics={'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.2419173766835008, 'psi': 0.2494019138755981}-{'f1_val': 0.2494615936826992, 'auprc': 0.2494615936826992, 'loss_val': 2.321932604247259, 'psi': 0.2494615936826992}
[S11] START round=19 head_norm_before_train=1.617260 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.990702432948215, 'psi': 0.3317042898145993}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 2.8473501353919777, 'psi': 0.33162711338607104}
[S13] START round=19 head_norm_before_train=1.804689 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4864631564719115, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4698566690924981, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.657752 (no previous merge yet)
[S14] round=19 local utility u=0.008248 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.3990765944597054, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.415572359494716, 'psi': 0.13572854291417166}
[S15] START round=19 head_norm_before_train=1.880467 (no previous merge yet)
[S15] round=19 local utility u=0.005219 metrics={'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.6045736239531968, 'psi': 0.612395395031292}-{'f1_val': 0.6121492794829994, 'auprc': 0.6121492794829994, 'loss_val': 0.6127968291211232, 'psi': 0.6121492794829994}
[S16] START round=19 head_norm_before_train=1.692351 (no previous merge yet)
[S16] round=19 local utility u=0.580851 metrics={'f1_val': 0.15086515086515087, 'auprc': 0.15086515086515087, 'loss_val': 3.527221964734686, 'psi': 0.15086515086515087}-{'f1_val': 0.08884612300537247, 'auprc': 0.08884612300537247, 'loss_val': 4.130751966020506, 'psi': 0.08884612300537247}
[S17] START round=19 head_norm_before_train=1.806529 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.4013216608359342, 'auprc': 0.4013216608359342, 'loss_val': 0.9305216309422587, 'psi': 0.4013216608359342}-{'f1_val': 0.4065243363981092, 'auprc': 0.4065243363981092, 'loss_val': 0.8608700952650535, 'psi': 0.4065243363981092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:59804
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:59805
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=-0.0032
[S4] DROPPED delta from S10 (cos=-0.0032 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] cosine check vs S7: cos=0.8986
[S5] RECEIVED delta(kind=head bytes=1803) from S4
[S5] cosine check vs S4: cos=-0.0596
[S5] DROPPED delta from S4 (cos=-0.0596 < 0.0)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=0.0390
[S16] not sending this round → trigger blocked (psi=0.151)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[S9] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1806) from S9
[S14] cosine check vs S9: cos=0.0086
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=-0.0199
[S14] DROPPED delta from S15 (cos=-0.0199 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.367 u=0.6863 p_local=0.2302 f1=0.367 auprc=0.367 bytes=10810
[S3] r=20 psi=0.257 u=0.0000 p_local=0.2165 f1=0.257 auprc=0.257 bytes=5386
[S7] r=20 psi=0.360 u=0.0139 p_local=0.1819 f1=0.360 auprc=0.360 bytes=7195
[S13] r=20 psi=0.360 u=0.0000 p_local=0.0472 f1=0.360 auprc=0.360 bytes=7180
[S10] r=20 psi=0.249 u=0.0397 p_local=0.0989 f1=0.249 auprc=0.249 bytes=14406
[S11] r=20 psi=0.332 u=0.0000 p_local=0.1170 f1=0.332 auprc=0.332 bytes=3606
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.0233 head_norm=1.370124
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.544490e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.0215 head_norm=1.119191 delta_norm=0.554449
[S6] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S6] r=20 psi=0.023 u=0.0000 p_local=0.2216 f1=0.023 auprc=0.023 bytes=0
[S9] r=20 psi=0.369 u=0.2155 p_local=0.2662 f1=0.369 auprc=0.369 bytes=7204
[S8] r=20 psi=0.359 u=0.0000 p_local=0.0343 f1=0.359 auprc=0.359 bytes=5401
[S5] r=20 psi=0.116 u=0.0000 p_local=0.1399 f1=0.116 auprc=0.116 bytes=10799
[S15] r=20 psi=0.612 u=0.0052 p_local=0.1121 f1=0.612 auprc=0.612 bytes=19808
[S4] r=20 psi=0.357 u=0.0129 p_local=0.1466 f1=0.357 auprc=0.357 bytes=8998
[S17] r=20 psi=0.401 u=0.0000 p_local=0.1575 f1=0.401 auprc=0.401 bytes=16208
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.1357 head_norm=1.682199
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.023609e+00
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.1311 head_norm=1.031915 delta_norm=1.023609
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.136 u=0.0082 p_local=0.1121 f1=0.136 auprc=0.136 bytes=0
[S16] r=20 psi=0.151 u=0.5809 p_local=0.3951 f1=0.151 auprc=0.151 bytes=0
[S2] START round=20 head_norm_before_train=1.640934 cos_to_last_merge=0.9992 (last merge round=18)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.8146948771108964, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6845080484445858, 'psi': 0.3674775928297055}
[S3] START round=20 head_norm_before_train=1.730197 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.254126679462572, 'auprc': 0.254126679462572, 'loss_val': 2.6725251954859797, 'psi': 0.254126679462572}-{'f1_val': 0.2570096442485789, 'auprc': 0.2570096442485789, 'loss_val': 2.605807099012156, 'psi': 0.2570096442485789}
[S4] START round=20 head_norm_before_train=1.904221 (no previous merge yet)
[S4] round=20 local utility u=0.008096 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1801723813488414, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1963647608129186, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.821851 cos_to_last_merge=0.9995 (last merge round=18)
[S5] round=20 local utility u=0.872390 metrics={'f1_val': 0.3181258430856521, 'auprc': 0.3181258430856521, 'loss_val': 2.5238737957329587, 'psi': 0.3181258430856521}-{'f1_val': 0.11579647054170887, 'auprc': 0.11579647054170887, 'loss_val': 2.4476896741293546, 'psi': 0.11579647054170887}
[S6] START round=20 head_norm_before_train=1.119191 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 3.35964663522393, 'psi': 0.021310724106324473}-{'f1_val': 0.02327704244637152, 'auprc': 0.02327704244637152, 'loss_val': 2.9863187991328966, 'psi': 0.02327704244637152}
[S7] START round=20 head_norm_before_train=1.464159 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.23761544920235098, 'auprc': 0.23761544920235098, 'loss_val': 1.2227857225993446, 'psi': 0.23761544920235098}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2392628065331817, 'psi': 0.35976373724718097}
[S8] START round=20 head_norm_before_train=1.950956 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5773422171940945, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5336935582935858, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.181293 cos_to_last_merge=0.9976 (last merge round=18)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4839589419318044, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3741398367788347, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.871330 (no previous merge yet)
[S10] round=20 local utility u=0.017264 metrics={'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.2079294957186812, 'psi': 0.24946185123176273}-{'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.2419173766835008, 'psi': 0.2494019138755981}
[S11] START round=20 head_norm_before_train=1.641230 (no previous merge yet)
[S11] round=20 local utility u=0.113163 metrics={'f1_val': 0.3315508021390374, 'auprc': 0.3315508021390374, 'loss_val': 2.7629953123959043, 'psi': 0.3315508021390374}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.990702432948215, 'psi': 0.3317042898145993}
[S13] START round=20 head_norm_before_train=1.818860 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4921139715112182, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4864631564719115, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.031915 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.973442 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 3.4486140809134858, 'psi': 0.13533083645443197}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.3990765944597054, 'psi': 0.13572854291417166}
[S15] START round=20 head_norm_before_train=1.916114 (no previous merge yet)
[S15] round=20 local utility u=0.037538 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.5561521845967141, 'psi': 0.6153571007984797}-{'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.6045736239531968, 'psi': 0.612395395031292}
[S16] START round=20 head_norm_before_train=1.711529 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.1253471440366284, 'auprc': 0.1253471440366284, 'loss_val': 4.152867301542975, 'psi': 0.1253471440366284}-{'f1_val': 0.15086515086515087, 'auprc': 0.15086515086515087, 'loss_val': 3.527221964734686, 'psi': 0.15086515086515087}
[S17] START round=20 head_norm_before_train=1.837001 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.3948132137531493, 'auprc': 0.3948132137531493, 'loss_val': 1.0203720471550928, 'psi': 0.3948132137531493}-{'f1_val': 0.4013216608359342, 'auprc': 0.4013216608359342, 'loss_val': 0.9305216309422587, 'psi': 0.4013216608359342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:59810
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[S14] not sending this round → trigger blocked (psi=0.135)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S10
[S4] cosine check vs S10: cos=-0.0012
[S4] DROPPED delta from S10 (cos=-0.0012 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] cosine check vs S4: cos=-0.0616
[S5] DROPPED delta from S4 (cos=-0.0616 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=-0.0957
[S14] DROPPED delta from S15 (cos=-0.0957 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] cosine check vs S11: cos=0.7826
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.5254
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.284 → S11@127.0.0.1:59812
[S2] ⇄ pheromone p=0.184 → S6@127.0.0.1:59807
[S7] ⇄ pheromone p=0.146 → S6@127.0.0.1:59807
[S3] ⇄ pheromone p=0.173 → S2@127.0.0.1:59802
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.3687 head_norm=1.230396
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.886046e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.3687 head_norm=1.216648 delta_norm=0.288605
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.213 → S14@127.0.0.1:59814
[S6] ⇄ pheromone p=0.177 → S15@127.0.0.1:59815
[S8] ⇄ pheromone p=0.027 → S6@127.0.0.1:59807
[S13] ⇄ pheromone p=0.038 → S9@127.0.0.1:59810
[S10] ⇄ pheromone p=0.083 → S4@127.0.0.1:59804
[S4] ⇄ pheromone p=0.119 → S5@127.0.0.1:59805
[S15] ⇄ pheromone p=0.097 → S14@127.0.0.1:59814
[S5] ⇄ pheromone p=0.286 → S9@127.0.0.1:59810
[S11] ⇄ pheromone p=0.116 → S9@127.0.0.1:59810
[S17] ⇄ pheromone p=0.126 → S5@127.0.0.1:59805
[S16] ⇄ pheromone p=0.316 → S4@127.0.0.1:59804
[S2] START round=21 head_norm_before_train=1.693661 cos_to_last_merge=0.9964 (last merge round=18)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.22241758241758244, 'auprc': 0.22241758241758244, 'loss_val': 2.3167374160090404, 'psi': 0.22241758241758244}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.8146948771108964, 'psi': 0.3674775928297055}
[S3] START round=21 head_norm_before_train=1.746735 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.2508571784801446, 'auprc': 0.2508571784801446, 'loss_val': 2.673251674707036, 'psi': 0.2508571784801446}-{'f1_val': 0.254126679462572, 'auprc': 0.254126679462572, 'loss_val': 2.6725251954859797, 'psi': 0.254126679462572}
[S4] START round=21 head_norm_before_train=1.930138 (no previous merge yet)
[S4] round=21 local utility u=0.008557 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1630592413152059, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1801723813488414, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.844927 cos_to_last_merge=0.9983 (last merge round=18)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.2505691101293414, 'auprc': 0.2505691101293414, 'loss_val': 2.629610434500283, 'psi': 0.2505691101293414}-{'f1_val': 0.3181258430856521, 'auprc': 0.3181258430856521, 'loss_val': 2.5238737957329587, 'psi': 0.3181258430856521}
[S6] START round=21 head_norm_before_train=1.223034 cos_to_last_merge=0.9763 (last merge round=19)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.013959981386691484, 'auprc': 0.013959981386691484, 'loss_val': 4.444152089642033, 'psi': 0.013959981386691484}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 3.35964663522393, 'psi': 0.021310724106324473}
[S7] START round=21 head_norm_before_train=1.481627 (no previous merge yet)
[S7] round=21 local utility u=0.008633 metrics={'f1_val': 0.23606596846033467, 'auprc': 0.23606596846033467, 'loss_val': 1.191573857113784, 'psi': 0.23606596846033467}-{'f1_val': 0.23761544920235098, 'auprc': 0.23761544920235098, 'loss_val': 1.2227857225993446, 'psi': 0.23761544920235098}
[S8] START round=21 head_norm_before_train=1.969211 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6301939049381275, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5773422171940945, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.216648 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.031322 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4213157414927322, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4839589419318044, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.904035 (no previous merge yet)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.29404727299351, 'psi': 0.2494019138755981}-{'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.2079294957186812, 'psi': 0.24946185123176273}
[S11] START round=21 head_norm_before_train=1.662986 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.0098124896374707, 'psi': 0.33162711338607104}-{'f1_val': 0.3315508021390374, 'auprc': 0.3315508021390374, 'loss_val': 2.7629953123959043, 'psi': 0.3315508021390374}
[S13] START round=21 head_norm_before_train=1.837548 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4960453475299769, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4921139715112182, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.071108 cos_to_last_merge=0.9985 (last merge round=19)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.698114639155305, 'psi': 0.13572854291417166}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 3.4486140809134858, 'psi': 0.13533083645443197}
[S15] START round=21 head_norm_before_train=1.947814 (no previous merge yet)
[S15] round=21 local utility u=0.014656 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5356343732573906, 'psi': 0.6163342951580373}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.5561521845967141, 'psi': 0.6153571007984797}
[S16] START round=21 head_norm_before_train=1.727915 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.0867535812007082, 'auprc': 0.0867535812007082, 'loss_val': 4.564430376668699, 'psi': 0.0867535812007082}-{'f1_val': 0.1253471440366284, 'auprc': 0.1253471440366284, 'loss_val': 4.152867301542975, 'psi': 0.1253471440366284}
[S17] START round=21 head_norm_before_train=1.862786 (no previous merge yet)
[S17] round=21 local utility u=0.044450 metrics={'f1_val': 0.40416461735761977, 'auprc': 0.40416461735761977, 'loss_val': 1.0156352753278277, 'psi': 0.40416461735761977}-{'f1_val': 0.3948132137531493, 'auprc': 0.3948132137531493, 'loss_val': 1.0203720471550928, 'psi': 0.3948132137531493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S9] → sending delta(kind=head bytes=1810) to S14@127.0.0.1:59814
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:59805
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1810 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1810) from S9
[S14] cosine check vs S9: cos=0.4840
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] cosine check vs S4: cos=-0.0610
[S5] DROPPED delta from S4 (cos=-0.0610 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=0.7568
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:59814
[S15] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=-0.0918
[S14] DROPPED delta from S15 (cos=-0.0918 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] → sending delta(kind=head bytes=1809) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1809 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1809) from S17
[S5] cosine check vs S17: cos=0.9912
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.0140 head_norm=1.330719
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.005537e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.0173 head_norm=1.328074 delta_norm=0.500554
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.2506 head_norm=1.864356
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.244876e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.2502 head_norm=1.869031 delta_norm=0.124488
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.1357 head_norm=1.129256
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.103788e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.0000 head_norm=1.031007 delta_norm=0.610379
[S14] aggregate: ROLLBACK (f1_val pre=0.136 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.737477 cos_to_last_merge=0.9934 (last merge round=18)
[S2] round=22 local utility u=0.813813 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.9946516259435718, 'psi': 0.3674775928297055}-{'f1_val': 0.22241758241758244, 'auprc': 0.22241758241758244, 'loss_val': 2.3167374160090404, 'psi': 0.22241758241758244}
[S3] START round=22 head_norm_before_train=1.761441 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.24964327811899, 'auprc': 0.24964327811899, 'loss_val': 2.6984428763577757, 'psi': 0.24964327811899}-{'f1_val': 0.2508571784801446, 'auprc': 0.2508571784801446, 'loss_val': 2.673251674707036, 'psi': 0.2508571784801446}
[S4] START round=22 head_norm_before_train=1.950228 (no previous merge yet)
[S4] round=22 local utility u=0.000910 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.161238672638413, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1630592413152059, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.869031 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.037436 metrics={'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.55134590598035, 'psi': 0.2501920777223545}-{'f1_val': 0.2505691101293414, 'auprc': 0.2505691101293414, 'loss_val': 2.629610434500283, 'psi': 0.2505691101293414}
[S6] START round=22 head_norm_before_train=1.328074 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.753805 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 2.968869740686492, 'psi': 0.017551963048498844}-{'f1_val': 0.013959981386691484, 'auprc': 0.013959981386691484, 'loss_val': 4.444152089642033, 'psi': 0.013959981386691484}
[S7] START round=22 head_norm_before_train=1.502616 (no previous merge yet)
[S7] round=22 local utility u=0.032554 metrics={'f1_val': 0.23784691002817238, 'auprc': 0.23784691002817238, 'loss_val': 1.1424941011974978, 'psi': 0.23784691002817238}-{'f1_val': 0.23606596846033467, 'auprc': 0.23606596846033467, 'loss_val': 1.191573857113784, 'psi': 0.23606596846033467}
[S8] START round=22 head_norm_before_train=1.982269 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6653368358239244, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6301939049381275, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.263272 cos_to_last_merge=0.9973 (last merge round=20)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.541207020066199, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4213157414927322, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.935047 (no previous merge yet)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.344350011726076, 'psi': 0.24946185123176273}-{'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.29404727299351, 'psi': 0.2494019138755981}
[S11] START round=22 head_norm_before_train=1.681956 (no previous merge yet)
[S11] round=22 local utility u=0.015314 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 2.979184900598724, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.0098124896374707, 'psi': 0.33162711338607104}
[S13] START round=22 head_norm_before_train=1.861589 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5439645921020102, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4960453475299769, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.031007 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.367570 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 2.9629739353399995, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.698114639155305, 'psi': 0.13572854291417166}
[S15] START round=22 head_norm_before_train=1.979677 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5613849483546577, 'psi': 0.6150769866718802}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5356343732573906, 'psi': 0.6163342951580373}
[S16] START round=22 head_norm_before_train=1.744171 (no previous merge yet)
[S16] round=22 local utility u=0.966062 metrics={'f1_val': 0.1713697219361483, 'auprc': 0.1713697219361483, 'loss_val': 3.3938522292829965, 'psi': 0.1713697219361483}-{'f1_val': 0.0867535812007082, 'auprc': 0.0867535812007082, 'loss_val': 4.564430376668699, 'psi': 0.0867535812007082}
[S17] START round=22 head_norm_before_train=1.881947 (no previous merge yet)
[S17] round=22 local utility u=0.002983 metrics={'f1_val': 0.4069952596226001, 'auprc': 0.4069952596226001, 'loss_val': 1.0351453406023061, 'psi': 0.4069952596226001}-{'f1_val': 0.40416461735761977, 'auprc': 0.40416461735761977, 'loss_val': 1.0156352753278277, 'psi': 0.40416461735761977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:59805
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.171)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:59805
[S4] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.6695
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] cosine check vs S11: cos=0.7113
[S5] RECEIVED delta(kind=head bytes=1795) from S4
[S5] cosine check vs S4: cos=-0.0590
[S5] DROPPED delta from S4 (cos=-0.0590 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.9154
[S6] RECEIVED delta(kind=head bytes=1804) from S2
[S6] cosine check vs S2: cos=0.1800
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S17
[S5] cosine check vs S17: cos=0.9960
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.3687 head_norm=1.313180
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.090322e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.3687 head_norm=1.291608 delta_norm=0.209032
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.0176 head_norm=1.382379
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.844061e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.0176 head_norm=1.191585 delta_norm=0.484406
[S6] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.2502 head_norm=1.888457
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.495091e-02
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.2502 head_norm=1.894295 delta_norm=0.084951
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.770816 cos_to_last_merge=0.9909 (last merge round=18)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.21370027821640725, 'auprc': 0.21370027821640725, 'loss_val': 2.8598893691359444, 'psi': 0.21370027821640725}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.9946516259435718, 'psi': 0.3674775928297055}
[S3] START round=23 head_norm_before_train=1.774375 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.24445659437458234, 'auprc': 0.24445659437458234, 'loss_val': 2.7324649246312593, 'psi': 0.24445659437458234}-{'f1_val': 0.24964327811899, 'auprc': 0.24964327811899, 'loss_val': 2.6984428763577757, 'psi': 0.24964327811899}
[S4] START round=23 head_norm_before_train=1.974390 (no previous merge yet)
[S4] round=23 local utility u=0.000181 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1608776261683564, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.161238672638413, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.894295 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.442239 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4167032285987564, 'psi': 0.3335071121394324}-{'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.55134590598035, 'psi': 0.2501920777223545}
[S6] START round=23 head_norm_before_train=1.191585 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 3.077527669534392, 'psi': 0.02153000458085204}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 2.968869740686492, 'psi': 0.017551963048498844}
[S7] START round=23 head_norm_before_train=1.524995 (no previous merge yet)
[S7] round=23 local utility u=0.570668 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0984096184334735, 'psi': 0.35976373724718097}-{'f1_val': 0.23784691002817238, 'auprc': 0.23784691002817238, 'loss_val': 1.1424941011974978, 'psi': 0.23784691002817238}
[S8] START round=23 head_norm_before_train=1.991660 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.700002403970195, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6653368358239244, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.291608 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.028631 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4839457728179806, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.541207020066199, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.959570 (no previous merge yet)
[S10] round=23 local utility u=0.019041 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.30680705688186, 'psi': 0.24952175992348158}-{'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.344350011726076, 'psi': 0.24946185123176273}
[S11] START round=23 head_norm_before_train=1.700971 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.1896687285160747, 'psi': 0.33201273984308244}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 2.979184900598724, 'psi': 0.33162711338607104}
[S13] START round=23 head_norm_before_train=1.876958 (no previous merge yet)
[S13] round=23 local utility u=0.005075 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5338146689164165, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5439645921020102, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.077127 cos_to_last_merge=0.9952 (last merge round=21)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 3.469836455476092, 'psi': 0.13253012048192772}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 2.9629739353399995, 'psi': 0.13572854291417166}
[S15] START round=23 head_norm_before_train=2.009321 (no previous merge yet)
[S15] round=23 local utility u=0.016260 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5389274566413501, 'psi': 0.6161950003225232}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5613849483546577, 'psi': 0.6150769866718802}
[S16] START round=23 head_norm_before_train=1.758512 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.12897934839334974, 'auprc': 0.12897934839334974, 'loss_val': 4.156400528854485, 'psi': 0.12897934839334974}-{'f1_val': 0.1713697219361483, 'auprc': 0.1713697219361483, 'loss_val': 3.3938522292829965, 'psi': 0.1713697219361483}
[S17] START round=23 head_norm_before_train=1.903910 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.4069952596226001, 'auprc': 0.4069952596226001, 'loss_val': 1.0791806991681883, 'psi': 0.4069952596226001}-{'f1_val': 0.4069952596226001, 'auprc': 0.4069952596226001, 'loss_val': 1.0351453406023061, 'psi': 0.4069952596226001}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:59810
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:59814
[S10] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.0026
[S6] RECEIVED delta(kind=head bytes=1804) from S7
[S6] cosine check vs S7: cos=0.8260
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.1232
[S14] DROPPED delta from S15 (cos=-0.1232 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] cosine check vs S4: cos=-0.0586
[S5] DROPPED delta from S4 (cos=-0.0586 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S9
[S14] cosine check vs S9: cos=0.7708
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S13
[S9] cosine check vs S13: cos=0.1188
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.7266
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.0215 head_norm=1.261673
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.346435e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.0217 head_norm=1.340156 delta_norm=0.434644
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.3568 head_norm=1.993392
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.401504e+00
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.3568 head_norm=1.405193 delta_norm=1.401504
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.3687 head_norm=1.334682
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.328449e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.3687 head_norm=1.215555 delta_norm=0.632845
[S9] aggregate: ACCEPT kept=['S13', 'S5'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.1325 head_norm=1.141832
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.289110e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.0000 head_norm=1.165595 delta_norm=0.428911
[S14] aggregate: ROLLBACK (f1_val pre=0.133 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.795983 cos_to_last_merge=0.9888 (last merge round=18)
[S2] round=24 local utility u=1.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.136429625207022, 'psi': 0.3674775928297055}-{'f1_val': 0.21370027821640725, 'auprc': 0.21370027821640725, 'loss_val': 2.8598893691359444, 'psi': 0.21370027821640725}
[S3] START round=24 head_norm_before_train=1.785232 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.24472419874718723, 'auprc': 0.24472419874718723, 'loss_val': 2.77489461295012, 'psi': 0.24472419874718723}-{'f1_val': 0.24445659437458234, 'auprc': 0.24445659437458234, 'loss_val': 2.7324649246312593, 'psi': 0.24445659437458234}
[S4] START round=24 head_norm_before_train=1.405193 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.020676 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.119526616415139, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1608776261683564, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.913017 cos_to_last_merge=0.9997 (last merge round=22)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.489591952437298, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4167032285987564, 'psi': 0.3335071121394324}
[S6] START round=24 head_norm_before_train=1.340156 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1884253468551105, 'psi': 0.0}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 3.077527669534392, 'psi': 0.02153000458085204}
[S7] START round=24 head_norm_before_train=1.542093 (no previous merge yet)
[S7] round=24 local utility u=0.012743 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0729243025397375, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0984096184334735, 'psi': 0.35976373724718097}
[S8] START round=24 head_norm_before_train=1.999559 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.728340478414399, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.700002403970195, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.215555 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6901811536309579, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4839457728179806, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.975842 (no previous merge yet)
[S10] round=24 local utility u=0.001357 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.3040932869760185, 'psi': 0.24952175992348158}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.30680705688186, 'psi': 0.24952175992348158}
[S11] START round=24 head_norm_before_train=1.716365 (no previous merge yet)
[S11] round=24 local utility u=0.050037 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 3.086819263242186, 'psi': 0.3317042898145993}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.1896687285160747, 'psi': 0.33201273984308244}
[S13] START round=24 head_norm_before_train=1.885681 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5657058533634736, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5338146689164165, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.165595 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.239299 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.0200240081904512, 'psi': 0.13572854291417166}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 3.469836455476092, 'psi': 0.13253012048192772}
[S15] START round=24 head_norm_before_train=2.037674 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6147964639178166, 'auprc': 0.6147964639178166, 'loss_val': 0.5669215041180926, 'psi': 0.6147964639178166}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5389274566413501, 'psi': 0.6161950003225232}
[S16] START round=24 head_norm_before_train=1.772719 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.09147509578544061, 'auprc': 0.09147509578544061, 'loss_val': 4.4654271131366094, 'psi': 0.09147509578544061}-{'f1_val': 0.12897934839334974, 'auprc': 0.12897934839334974, 'loss_val': 4.156400528854485, 'psi': 0.12897934839334974}
[S17] START round=24 head_norm_before_train=1.924729 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.407465843834764, 'auprc': 0.407465843834764, 'loss_val': 1.1471666964235054, 'psi': 0.407465843834764}-{'f1_val': 0.4069952596226001, 'auprc': 0.4069952596226001, 'loss_val': 1.0791806991681883, 'psi': 0.4069952596226001}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:59803
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:59816
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1807) from S4
[S16] cosine check vs S4: cos=-0.1036
[S16] DROPPED delta from S4 (cos=-0.1036 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] cosine check vs S2: cos=0.8923
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] cosine check vs S11: cos=0.7077
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.1357 head_norm=1.210039
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.107118e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.1018 head_norm=1.361444 delta_norm=0.610712
[S14] aggregate: ROLLBACK (f1_val pre=0.136 post=0.102 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.2447 head_norm=1.795598
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.194071e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.2491 head_norm=1.757299 delta_norm=0.419407
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.817645 cos_to_last_merge=0.9871 (last merge round=18)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.26205241048209643, 'auprc': 0.26205241048209643, 'loss_val': 2.218758195472603, 'psi': 0.26205241048209643}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.136429625207022, 'psi': 0.3674775928297055}
[S3] START round=25 head_norm_before_train=1.757299 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.649312 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.551218822471173, 'psi': 0.3641628959276018}-{'f1_val': 0.24472419874718723, 'auprc': 0.24472419874718723, 'loss_val': 2.77489461295012, 'psi': 0.24472419874718723}
[S4] START round=25 head_norm_before_train=1.475959 cos_to_last_merge=0.9975 (last merge round=23)
[S4] round=25 local utility u=0.006757 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1060127091450858, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.119526616415139, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.933742 cos_to_last_merge=0.9988 (last merge round=22)
[S5] round=25 local utility u=0.012485 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4646227674662433, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.489591952437298, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.410686 cos_to_last_merge=0.9889 (last merge round=23)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.03035071942446043, 'auprc': 0.03035071942446043, 'loss_val': 3.6357395425719714, 'psi': 0.03035071942446043}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1884253468551105, 'psi': 0.0}
[S7] START round=25 head_norm_before_train=1.556842 (no previous merge yet)
[S7] round=25 local utility u=0.008676 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0555730651569142, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0729243025397375, 'psi': 0.35976373724718097}
[S8] START round=25 head_norm_before_train=2.013208 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7566092691393642, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.728340478414399, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.262485 cos_to_last_merge=0.9984 (last merge round=23)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7902161459689132, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6901811536309579, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.997627 (no previous merge yet)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.387040517636018, 'psi': 0.24952175992348158}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.3040932869760185, 'psi': 0.24952175992348158}
[S11] START round=25 head_norm_before_train=1.728816 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 3.2190812259572943, 'psi': 0.3319353836595216}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 3.086819263242186, 'psi': 0.3317042898145993}
[S13] START round=25 head_norm_before_train=1.891213 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6186810664990103, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5657058533634736, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.361444 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.258156681862275, 'psi': 0.13582554517133957}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.0200240081904512, 'psi': 0.13572854291417166}
[S15] START round=25 head_norm_before_train=2.064785 (no previous merge yet)
[S15] round=25 local utility u=0.010002 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5607570895814935, 'psi': 0.6163342951580373}-{'f1_val': 0.6147964639178166, 'auprc': 0.6147964639178166, 'loss_val': 0.5669215041180926, 'psi': 0.6147964639178166}
[S16] START round=25 head_norm_before_train=1.786240 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.09147509578544061, 'auprc': 0.09147509578544061, 'loss_val': 4.56456215597762, 'psi': 0.09147509578544061}-{'f1_val': 0.09147509578544061, 'auprc': 0.09147509578544061, 'loss_val': 4.4654271131366094, 'psi': 0.09147509578544061}
[S17] START round=25 head_norm_before_train=1.942674 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.3060124359905949, 'auprc': 0.3060124359905949, 'loss_val': 1.2834859856513956, 'psi': 0.3060124359905949}-{'f1_val': 0.407465843834764, 'auprc': 0.407465843834764, 'loss_val': 1.1471666964235054, 'psi': 0.407465843834764}
[S4] not sending this round → trigger blocked (psi=0.357)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.360)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:59817
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S5
[S17] cosine check vs S5: cos=0.9935
[S6] RECEIVED delta(kind=head bytes=1801) from S15
[S6] cosine check vs S15: cos=-0.0320
[S6] DROPPED delta from S15 (cos=-0.0320 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.044 → S16@127.0.0.1:59816
[S6] ⇄ pheromone p=0.135 → S2@127.0.0.1:59802
[S14] ⇄ pheromone p=0.169 → S9@127.0.0.1:59810
[S11] ⇄ pheromone p=0.048 → S14@127.0.0.1:59814
[S9] ⇄ pheromone p=0.076 → S5@127.0.0.1:59805
[S2] ⇄ pheromone p=0.304 → S3@127.0.0.1:59803
[S15] ⇄ pheromone p=0.037 → S6@127.0.0.1:59807
[S5] ⇄ pheromone p=0.157 → S17@127.0.0.1:59817
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.3060 head_norm=1.954798
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.115780e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.3060 head_norm=1.949259 delta_norm=0.111578
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.045 → S5@127.0.0.1:59805
[S16] ⇄ pheromone p=0.202 → S4@127.0.0.1:59804
[S2] START round=26 head_norm_before_train=1.835495 cos_to_last_merge=0.9856 (last merge round=18)
[S2] round=26 local utility u=0.478339 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2109066160116493, 'psi': 0.3674775928297055}-{'f1_val': 0.26205241048209643, 'auprc': 0.26205241048209643, 'loss_val': 2.218758195472603, 'psi': 0.26205241048209643}
[S3] START round=26 head_norm_before_train=1.768784 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.574749418569189, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.551218822471173, 'psi': 0.3641628959276018}
[S4] START round=26 head_norm_before_train=1.562518 cos_to_last_merge=0.9904 (last merge round=23)
[S4] round=26 local utility u=0.006651 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0927106667987767, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1060127091450858, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.950098 cos_to_last_merge=0.9979 (last merge round=22)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.516995115243701, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4646227674662433, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.473013 cos_to_last_merge=0.9734 (last merge round=23)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 4.348344731062511, 'psi': 0.017551963048498844}-{'f1_val': 0.03035071942446043, 'auprc': 0.03035071942446043, 'loss_val': 3.6357395425719714, 'psi': 0.03035071942446043}
[S7] START round=26 head_norm_before_train=1.568386 (no previous merge yet)
[S7] round=26 local utility u=0.005172 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0452298100080446, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0555730651569142, 'psi': 0.35976373724718097}
[S8] START round=26 head_norm_before_train=2.026642 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7939941596050486, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7566092691393642, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.306547 cos_to_last_merge=0.9944 (last merge round=23)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8712703838102798, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7902161459689132, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=2.017424 (no previous merge yet)
[S10] round=26 local utility u=0.038848 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.309344820698819, 'psi': 0.24952175992348158}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.387040517636018, 'psi': 0.24952175992348158}
[S11] START round=26 head_norm_before_train=1.739512 (no previous merge yet)
[S11] round=26 local utility u=0.025243 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.1686014430289227, 'psi': 0.3319360347772085}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 3.2190812259572943, 'psi': 0.3319353836595216}
[S13] START round=26 head_norm_before_train=1.899556 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6337335965523372, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6186810664990103, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.400174 cos_to_last_merge=0.9957 (last merge round=24)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.10548523206751055, 'auprc': 0.10548523206751055, 'loss_val': 3.7193599546834495, 'psi': 0.10548523206751056}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.258156681862275, 'psi': 0.13582554517133957}
[S15] START round=26 head_norm_before_train=2.088876 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.584118401537942, 'auprc': 0.584118401537942, 'loss_val': 0.6220632904014403, 'psi': 0.584118401537942}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5607570895814935, 'psi': 0.6163342951580373}
[S16] START round=26 head_norm_before_train=1.797026 (no previous merge yet)
[S16] round=26 local utility u=0.599821 metrics={'f1_val': 0.1265032377428307, 'auprc': 0.1265032377428307, 'loss_val': 3.6801724626102894, 'psi': 0.1265032377428307}-{'f1_val': 0.09147509578544061, 'auprc': 0.09147509578544061, 'loss_val': 4.56456215597762, 'psi': 0.09147509578544061}
[S17] START round=26 head_norm_before_train=1.949259 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.590438 metrics={'f1_val': 0.4191217320557882, 'auprc': 0.4191217320557882, 'loss_val': 1.1205944164886326, 'psi': 0.4191217320557882}-{'f1_val': 0.3060124359905949, 'auprc': 0.3060124359905949, 'loss_val': 1.2834859856513956, 'psi': 0.3060124359905949}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:59814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.127)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] → sending delta(kind=head bytes=1808) to S3@127.0.0.1:59803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:59816
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1808 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S4
[S16] cosine check vs S4: cos=-0.0940
[S16] DROPPED delta from S4 (cos=-0.0940 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1808) from S2
[S3] cosine check vs S2: cos=0.9686
[S14] RECEIVED delta(kind=head bytes=1806) from S11
[S14] cosine check vs S11: cos=0.9113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S17
[S5] cosine check vs S17: cos=0.9977
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.3642 head_norm=1.779478
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.299476e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.3642 head_norm=1.800370 delta_norm=0.229948
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.1055 head_norm=1.448394
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.678314e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.1059 head_norm=1.564119 delta_norm=0.367831
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.3335 head_norm=1.960712
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.717031e-02
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.3335 head_norm=1.958625 delta_norm=0.067170
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.849830 cos_to_last_merge=0.9844 (last merge round=18)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2412771261102042, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2109066160116493, 'psi': 0.3674775928297055}
[S3] START round=27 head_norm_before_train=1.800370 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.049884 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.4749817807866235, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.574749418569189, 'psi': 0.3641628959276018}
[S4] START round=27 head_norm_before_train=1.614922 cos_to_last_merge=0.9847 (last merge round=23)
[S4] round=27 local utility u=0.002744 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0872221302329945, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0927106667987767, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.958625 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.133247 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2505011440091724, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.516995115243701, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.523127 cos_to_last_merge=0.9613 (last merge round=23)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 4.521008372772969, 'psi': 0.021749084249084248}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 4.348344731062511, 'psi': 0.017551963048498844}
[S7] START round=27 head_norm_before_train=1.578054 (no previous merge yet)
[S7] round=27 local utility u=0.003919 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.037391407188884, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0452298100080446, 'psi': 0.35976373724718097}
[S8] START round=27 head_norm_before_train=2.032795 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8207480566807133, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7939941596050486, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.345022 cos_to_last_merge=0.9897 (last merge round=23)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9364922022238666, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8712703838102798, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=2.035569 (no previous merge yet)
[S10] round=27 local utility u=0.209801 metrics={'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.8897450080466895, 'psi': 0.24952198852772467}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.309344820698819, 'psi': 0.24952175992348158}
[S11] START round=27 head_norm_before_train=1.750911 (no previous merge yet)
[S11] round=27 local utility u=0.004328 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.157165617393126, 'psi': 0.33162711338607104}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.1686014430289227, 'psi': 0.3319360347772085}
[S13] START round=27 head_norm_before_train=1.907634 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6446716700273747, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6337335965523372, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.564119 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.149995 metrics={'f1_val': 0.13111866112998616, 'auprc': 0.13111866112998616, 'loss_val': 3.650070989702919, 'psi': 0.13111866112998616}-{'f1_val': 0.10548523206751055, 'auprc': 0.10548523206751055, 'loss_val': 3.7193599546834495, 'psi': 0.10548523206751056}
[S15] START round=27 head_norm_before_train=2.107643 (no previous merge yet)
[S15] round=27 local utility u=0.179124 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5537582923093037, 'psi': 0.6163342951580373}-{'f1_val': 0.584118401537942, 'auprc': 0.584118401537942, 'loss_val': 0.6220632904014403, 'psi': 0.584118401537942}
[S16] START round=27 head_norm_before_train=1.807260 (no previous merge yet)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.10783460282916213, 'auprc': 0.10783460282916213, 'loss_val': 3.9829149564051147, 'psi': 0.10783460282916213}-{'f1_val': 0.1265032377428307, 'auprc': 0.1265032377428307, 'loss_val': 3.6801724626102894, 'psi': 0.1265032377428307}
[S17] START round=27 head_norm_before_train=1.958840 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.4055814708881089, 'auprc': 0.4055814708881089, 'loss_val': 1.2090186994629064, 'psi': 0.4055814708881089}-{'f1_val': 0.4191217320557882, 'auprc': 0.4191217320557882, 'loss_val': 1.1205944164886326, 'psi': 0.4191217320557882}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:59802
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:59804
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:59816
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[S14] not sending this round → trigger blocked (psi=0.131)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S5
[S4] cosine check vs S5: cos=-0.0216
[S4] DROPPED delta from S5 (cos=-0.0216 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] cosine check vs S15: cos=-0.0281
[S6] DROPPED delta from S15 (cos=-0.0281 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S4
[S16] cosine check vs S4: cos=-0.0915
[S16] DROPPED delta from S4 (cos=-0.0915 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] cosine check vs S11: cos=0.9691
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=0.9913
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.3675 head_norm=1.864670
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.243311e-01
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.3675 head_norm=1.833986 delta_norm=0.124331
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.1311 head_norm=1.600937
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.245909e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.1313 head_norm=1.670066 delta_norm=0.224591
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.833986 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.24876176324913324, 'auprc': 0.24876176324913324, 'loss_val': 2.043498538834265, 'psi': 0.24876176324913324}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2412771261102042, 'psi': 0.3674775928297055}
[S3] START round=28 head_norm_before_train=1.811336 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.5190994751915197, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.4749817807866235, 'psi': 0.3641628959276018}
[S4] START round=28 head_norm_before_train=1.669468 cos_to_last_merge=0.9794 (last merge round=23)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0980302504208685, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0872221302329945, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.966640 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3920032959318593, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2505011440091724, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.562585 cos_to_last_merge=0.9524 (last merge round=23)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.018946399584385, 'psi': 0.017551963048498844}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 4.521008372772969, 'psi': 0.021749084249084248}
[S7] START round=28 head_norm_before_train=1.586847 (no previous merge yet)
[S7] round=28 local utility u=0.001190 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0350115314584027, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.037391407188884, 'psi': 0.35976373724718097}
[S8] START round=28 head_norm_before_train=2.042420 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8471845399300948, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8207480566807133, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.377385 cos_to_last_merge=0.9854 (last merge round=23)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0027422432702875, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9364922022238666, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=2.053809 (no previous merge yet)
[S10] round=28 local utility u=0.163719 metrics={'f1_val': 0.24970145689037496, 'auprc': 0.24970145689037496, 'loss_val': 1.563922191659624, 'psi': 0.24970145689037493}-{'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.8897450080466895, 'psi': 0.24952198852772467}
[S11] START round=28 head_norm_before_train=1.765254 (no previous merge yet)
[S11] round=28 local utility u=0.052764 metrics={'f1_val': 0.3316279069767442, 'auprc': 0.3316279069767442, 'loss_val': 3.051644068165647, 'psi': 0.3316279069767442}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.157165617393126, 'psi': 0.33162711338607104}
[S13] START round=28 head_norm_before_train=1.916003 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.669556192807323, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6446716700273747, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.670066 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13111866112998616, 'auprc': 0.13111866112998616, 'loss_val': 3.674622573812992, 'psi': 0.13111866112998616}-{'f1_val': 0.13111866112998616, 'auprc': 0.13111866112998616, 'loss_val': 3.650070989702919, 'psi': 0.13111866112998616}
[S15] START round=28 head_norm_before_train=2.126759 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.5846442393907408, 'auprc': 0.5846442393907408, 'loss_val': 0.6291412378714374, 'psi': 0.5846442393907408}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5537582923093037, 'psi': 0.6163342951580373}
[S16] START round=28 head_norm_before_train=1.816149 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.1257125712571257, 'auprc': 0.1257125712571257, 'loss_val': 4.429456021197905, 'psi': 0.1257125712571257}-{'f1_val': 0.10783460282916213, 'auprc': 0.10783460282916213, 'loss_val': 3.9829149564051147, 'psi': 0.10783460282916213}
[S17] START round=28 head_norm_before_train=1.971407 cos_to_last_merge=0.9998 (last merge round=25)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.3991183482728094, 'auprc': 0.3991183482728094, 'loss_val': 1.3701391079789023, 'psi': 0.3991183482728094}-{'f1_val': 0.4055814708881089, 'auprc': 0.4055814708881089, 'loss_val': 1.2090186994629064, 'psi': 0.4055814708881089}
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S16
[S6]  timeout peer S17
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.9842
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.1311 head_norm=1.704066
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.596707e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.1311 head_norm=1.735511 delta_norm=0.159671
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] CommDone barrier timeout: have=2 need=3 — continuing
[S9] CommDone barrier timeout: have=2 need=3 — continuing
[S2] START round=29 head_norm_before_train=1.850757 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=29 local utility u=0.001955 metrics={'f1_val': 0.2550625277724878, 'auprc': 0.2550625277724878, 'loss_val': 2.096294538459837, 'psi': 0.2550625277724878}-{'f1_val': 0.24876176324913324, 'auprc': 0.24876176324913324, 'loss_val': 2.043498538834265, 'psi': 0.24876176324913324}
[S3] START round=29 head_norm_before_train=1.824248 cos_to_last_merge=0.9999 (last merge round=26)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.24269852763697805, 'auprc': 0.24269852763697805, 'loss_val': 2.5598283483851967, 'psi': 0.24269852763697805}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.5190994751915197, 'psi': 0.3641628959276018}
[S4] START round=29 head_norm_before_train=1.721736 cos_to_last_merge=0.9747 (last merge round=23)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0992742392765413, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0980302504208685, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.972754 cos_to_last_merge=0.9999 (last merge round=26)
[S5] round=29 local utility u=0.061241 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2695222675677345, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3920032959318593, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.593911 cos_to_last_merge=0.9468 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.23606720050293, 'psi': 0.0}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.018946399584385, 'psi': 0.017551963048498844}
[S7] START round=29 head_norm_before_train=1.594610 (no previous merge yet)
[S7] round=29 local utility u=0.005288 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.024435673470824, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0350115314584027, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=29 head_norm_before_train=2.054127 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.884049125852151, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8471845399300948, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.405220 cos_to_last_merge=0.9819 (last merge round=23)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.075509049324184, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0027422432702875, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=2.069308 (no previous merge yet)
[S10] round=29 local utility u=0.182236 metrics={'f1_val': 0.2408473405480083, 'auprc': 0.2408473405480083, 'loss_val': 1.1197629871298165, 'psi': 0.24084734054800827}-{'f1_val': 0.24970145689037496, 'auprc': 0.24970145689037496, 'loss_val': 1.563922191659624, 'psi': 0.24970145689037493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=29 head_norm_before_train=1.780771 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.1687323842591355, 'psi': 0.33162711338607104}-{'f1_val': 0.3316279069767442, 'auprc': 0.3316279069767442, 'loss_val': 3.051644068165647, 'psi': 0.3316279069767442}
[S13] START round=29 head_norm_before_train=1.925898 (no previous merge yet)
[S13] round=29 local utility u=0.008261 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6530348778006274, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.669556192807323, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=29 head_norm_before_train=1.735511 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.0627217255569746, 'auprc': 0.0627217255569746, 'loss_val': 3.9448528567105354, 'psi': 0.0627217255569746}-{'f1_val': 0.13111866112998616, 'auprc': 0.13111866112998616, 'loss_val': 3.674622573812992, 'psi': 0.13111866112998616}
[S15] START round=29 head_norm_before_train=2.144316 (no previous merge yet)
[S15] round=29 local utility u=0.168483 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5773860970684155, 'psi': 0.6163342951580373}-{'f1_val': 0.5846442393907408, 'auprc': 0.5846442393907408, 'loss_val': 0.6291412378714374, 'psi': 0.5846442393907408}
[S16] START round=29 head_norm_before_train=1.825682 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.11647965804137089, 'auprc': 0.11647965804137089, 'loss_val': 4.5764216040393855, 'psi': 0.11647965804137089}-{'f1_val': 0.1257125712571257, 'auprc': 0.1257125712571257, 'loss_val': 4.429456021197905, 'psi': 0.1257125712571257}
[S17] START round=29 head_norm_before_train=1.991744 cos_to_last_merge=0.9992 (last merge round=25)
[S17] round=29 local utility u=0.356617 metrics={'f1_val': 0.46765370502953285, 'auprc': 0.46765370502953285, 'loss_val': 1.2737235045070985, 'psi': 0.46765370502953285}-{'f1_val': 0.3991183482728094, 'auprc': 0.3991183482728094, 'loss_val': 1.3701391079789023, 'psi': 0.3991183482728094}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:59805
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:59803
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=0.9964
[S6] RECEIVED delta(kind=head bytes=1801) from S15
[S6] cosine check vs S15: cos=-0.0245
[S6] DROPPED delta from S15 (cos=-0.0245 < 0.0)
[S2] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[S3] RECEIVED delta(kind=head bytes=1803) from S2
[S3] cosine check vs S2: cos=0.9958
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S5
[S4] cosine check vs S5: cos=-0.0223
[S4] DROPPED delta from S5 (cos=-0.0223 < 0.0)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14]  timeout peer S9
[S14]  timeout peer S15
[S2]  timeout peer S3
[S6]  timeout peer S2
[S6]  timeout peer S7
[S6]  timeout peer S8
[S9]  timeout peer S5
[S9]  timeout peer S11
[S9]  timeout peer S13
[S4]  timeout peer S10
[S15]  timeout peer S6
[S5]  timeout peer S4
[S11]  timeout peer S14
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.3335 head_norm=1.983990
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.582609e-02
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.3335 head_norm=1.997077 delta_norm=0.085826
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=1.869403 cos_to_last_merge=0.9998 (last merge round=27)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.2534695937421146, 'auprc': 0.2534695937421146, 'loss_val': 2.1496739804544918, 'psi': 0.2534695937421146}-{'f1_val': 0.2550625277724878, 'auprc': 0.2550625277724878, 'loss_val': 2.096294538459837, 'psi': 0.2550625277724878}
[S3] START round=30 head_norm_before_train=1.836806 cos_to_last_merge=0.9998 (last merge round=26)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.2401505493838402, 'auprc': 0.2401505493838402, 'loss_val': 2.5942869480801143, 'psi': 0.24015054938384017}-{'f1_val': 0.24269852763697805, 'auprc': 0.24269852763697805, 'loss_val': 2.5598283483851967, 'psi': 0.24269852763697805}
[S4] START round=30 head_norm_before_train=1.764314 cos_to_last_merge=0.9714 (last merge round=23)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1073757918106717, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0992742392765413, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.997077 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3300107348247967, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2695222675677345, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.616724 cos_to_last_merge=0.9429 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=30 local utility u=0.852682 metrics={'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 4.422065038127916, 'psi': 0.09904030710172745}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.23606720050293, 'psi': 0.0}
[S7] START round=30 head_norm_before_train=1.605507 (no previous merge yet)
[S7] round=30 local utility u=0.008194 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0080477831979278, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.024435673470824, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=30 head_norm_before_train=2.064778 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9034673933524107, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.884049125852151, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.429629 cos_to_last_merge=0.9792 (last merge round=23)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1439607976466815, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.075509049324184, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=2.086043 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.2392497712717292, 'auprc': 0.2392497712717292, 'loss_val': 1.106144914679139, 'psi': 0.2392497712717292}-{'f1_val': 0.2408473405480083, 'auprc': 0.2408473405480083, 'loss_val': 1.1197629871298165, 'psi': 0.24084734054800827}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=30 head_norm_before_train=1.794690 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.239943256937378, 'psi': 0.33185875048506014}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.1687323842591355, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.930612 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6725353258598592, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6530348778006274, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.768942 cos_to_last_merge=0.9983 (last merge round=28)
[S14] round=30 local utility u=0.207969 metrics={'f1_val': 0.12186379928315412, 'auprc': 0.12186379928315412, 'loss_val': 4.061193859728879, 'psi': 0.12186379928315413}-{'f1_val': 0.0627217255569746, 'auprc': 0.0627217255569746, 'loss_val': 3.9448528567105354, 'psi': 0.0627217255569746}
[S15] START round=30 head_norm_before_train=2.157791 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6148552968559068, 'auprc': 0.6148552968559068, 'loss_val': 0.5737703199261571, 'psi': 0.6148552968559068}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5773860970684155, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.835472 (no previous merge yet)
[S16] round=30 local utility u=0.084074 metrics={'f1_val': 0.12921976302257993, 'auprc': 0.12921976302257993, 'loss_val': 4.52293451629345, 'psi': 0.12921976302257993}-{'f1_val': 0.11647965804137089, 'auprc': 0.11647965804137089, 'loss_val': 4.5764216040393855, 'psi': 0.11647965804137089}
[S17] START round=30 head_norm_before_train=2.013739 cos_to_last_merge=0.9985 (last merge round=25)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.3297665112756757, 'auprc': 0.3297665112756757, 'loss_val': 1.6163312593067791, 'psi': 0.3297665112756757}-{'f1_val': 0.46765370502953285, 'auprc': 0.46765370502953285, 'loss_val': 1.2737235045070985, 'psi': 0.46765370502953285}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.099)
[S16] not sending this round → trigger blocked (psi=0.129)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.122)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] ⇄ pheromone p=0.120 → S5@127.0.0.1:59805
[S16] ⇄ pheromone p=0.132 → S4@127.0.0.1:59804
[S4] ⇄ pheromone p=0.015 → S16@127.0.0.1:59816
[S14] ⇄ pheromone p=0.112 → S11@127.0.0.1:59812
[S6] ⇄ pheromone p=0.215 → S15@127.0.0.1:59815
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.2402 head_norm=1.847732
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.862364e-02
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.2405 head_norm=1.856485 delta_norm=0.088624
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.066 → S2@127.0.0.1:59802
[S9] ⇄ pheromone p=0.025 → S14@127.0.0.1:59814
[S2] ⇄ pheromone p=0.139 → S6@127.0.0.1:59807
[S5] ⇄ pheromone p=0.075 → S17@127.0.0.1:59817
[S2] START round=31 head_norm_before_train=1.887143 cos_to_last_merge=0.9996 (last merge round=27)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.25043630017452007, 'auprc': 0.25043630017452007, 'loss_val': 2.1980052583371767, 'psi': 0.25043630017452007}-{'f1_val': 0.2534695937421146, 'auprc': 0.2534695937421146, 'loss_val': 2.1496739804544918, 'psi': 0.2534695937421146}
[S3] START round=31 head_norm_before_train=1.856485 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.24099012440682313, 'auprc': 0.24099012440682313, 'loss_val': 2.6057198324196826, 'psi': 0.24099012440682313}-{'f1_val': 0.2401505493838402, 'auprc': 0.2401505493838402, 'loss_val': 2.5942869480801143, 'psi': 0.24015054938384017}
[S4] START round=31 head_norm_before_train=1.791355 cos_to_last_merge=0.9694 (last merge round=23)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1175698550333384, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1073757918106717, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=2.009932 cos_to_last_merge=0.9999 (last merge round=29)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3759339463351354, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3300107348247967, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=1.631259 cos_to_last_merge=0.9405 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.335487607334589, 'psi': 0.01732902033271719}-{'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 4.422065038127916, 'psi': 0.09904030710172745}
[S7] START round=31 head_norm_before_train=1.622103 (no previous merge yet)
[S7] round=31 local utility u=0.010581 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9868867818492868, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0080477831979278, 'psi': 0.35976373724718097}
[S7] not sending this round → trigger blocked (psi=0.360)
[S8] START round=31 head_norm_before_train=2.068168 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9159476017183161, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9034673933524107, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.450771 cos_to_last_merge=0.9768 (last merge round=23)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.195114700581134, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1439607976466815, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=2.105050 (no previous merge yet)
[S10] round=31 local utility u=0.039430 metrics={'f1_val': 0.24822021831988608, 'auprc': 0.24822021831988608, 'loss_val': 1.1080188645799356, 'psi': 0.24822021831988608}-{'f1_val': 0.2392497712717292, 'auprc': 0.2392497712717292, 'loss_val': 1.106144914679139, 'psi': 0.2392497712717292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=31 head_norm_before_train=1.809493 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.274881969232049, 'psi': 0.3319360347772085}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.239943256937378, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.935373 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6818050079964673, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6725353258598592, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.803279 cos_to_last_merge=0.9947 (last merge round=28)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.10213556174558959, 'auprc': 0.10213556174558959, 'loss_val': 4.3922245153493975, 'psi': 0.10213556174558959}-{'f1_val': 0.12186379928315412, 'auprc': 0.12186379928315412, 'loss_val': 4.061193859728879, 'psi': 0.12186379928315413}
[S15] START round=31 head_norm_before_train=2.172438 (no previous merge yet)
[S15] round=31 local utility u=0.043165 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5020041762840844, 'psi': 0.6164734888353558}-{'f1_val': 0.6148552968559068, 'auprc': 0.6148552968559068, 'loss_val': 0.5737703199261571, 'psi': 0.6148552968559068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=31 head_norm_before_train=1.845123 (no previous merge yet)
[S16] round=31 local utility u=0.704113 metrics={'f1_val': 0.15353418308227115, 'auprc': 0.15353418308227115, 'loss_val': 3.333539140265802, 'psi': 0.15353418308227115}-{'f1_val': 0.12921976302257993, 'auprc': 0.12921976302257993, 'loss_val': 4.52293451629345, 'psi': 0.12921976302257993}
[S17] START round=31 head_norm_before_train=2.028919 cos_to_last_merge=0.9980 (last merge round=25)
[S17] round=31 local utility u=0.331044 metrics={'f1_val': 0.40197275201501415, 'auprc': 0.40197275201501415, 'loss_val': 1.6040993881086727, 'psi': 0.40197275201501415}-{'f1_val': 0.3297665112756757, 'auprc': 0.3297665112756757, 'loss_val': 1.6163312593067791, 'psi': 0.3297665112756757}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.154)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=0.9978
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.3335 head_norm=2.017576
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.806476e-02
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.3335 head_norm=2.029068 delta_norm=0.068065
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.903305 cos_to_last_merge=0.9994 (last merge round=27)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.24890045220838752, 'auprc': 0.24890045220838752, 'loss_val': 2.2479021067683425, 'psi': 0.24890045220838752}-{'f1_val': 0.25043630017452007, 'auprc': 0.25043630017452007, 'loss_val': 2.1980052583371767, 'psi': 0.25043630017452007}
[S3] START round=32 head_norm_before_train=1.867031 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.24117306579201236, 'auprc': 0.24117306579201236, 'loss_val': 2.6432453560619242, 'psi': 0.24117306579201236}-{'f1_val': 0.24099012440682313, 'auprc': 0.24099012440682313, 'loss_val': 2.6057198324196826, 'psi': 0.24099012440682313}
[S4] START round=32 head_norm_before_train=1.819174 cos_to_last_merge=0.9675 (last merge round=23)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.127865809575165, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1175698550333384, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=2.029068 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.056006 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.25939336723608, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3759339463351354, 'psi': 0.3335071121394324}
[S6] START round=32 head_norm_before_train=1.646242 cos_to_last_merge=0.9379 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=32 local utility u=0.028047 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 5.323112666536604, 'psi': 0.022186642268984445}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.335487607334589, 'psi': 0.01732902033271719}
[S7] START round=32 head_norm_before_train=1.640086 (no previous merge yet)
[S7] round=32 local utility u=0.008732 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9694220368676968, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9868867818492868, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=32 head_norm_before_train=2.075936 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9302102381339161, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9159476017183161, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.468895 cos_to_last_merge=0.9748 (last merge round=23)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.241077902498555, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.195114700581134, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=2.122551 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.2479260488267362, 'auprc': 0.2479260488267362, 'loss_val': 1.11090868177844, 'psi': 0.2479260488267362}-{'f1_val': 0.24822021831988608, 'auprc': 0.24822021831988608, 'loss_val': 1.1080188645799356, 'psi': 0.24822021831988608}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.824198 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3126245951737263, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.274881969232049, 'psi': 0.3319360347772085}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.943340 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.698003044257472, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6818050079964673, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.833687 cos_to_last_merge=0.9909 (last merge round=28)
[S14] round=32 local utility u=0.074683 metrics={'f1_val': 0.13111866112998616, 'auprc': 0.13111866112998616, 'loss_val': 4.503706184706131, 'psi': 0.13111866112998616}-{'f1_val': 0.10213556174558959, 'auprc': 0.10213556174558959, 'loss_val': 4.3922245153493975, 'psi': 0.10213556174558959}
[S15] START round=32 head_norm_before_train=2.188121 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.5849841480605997, 'auprc': 0.5849841480605997, 'loss_val': 0.7342858187486667, 'psi': 0.5849841480605997}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5020041762840844, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.854946 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.11860088024090804, 'auprc': 0.11860088024090804, 'loss_val': 3.9952160878777043, 'psi': 0.11860088024090804}-{'f1_val': 0.15353418308227115, 'auprc': 0.15353418308227115, 'loss_val': 3.333539140265802, 'psi': 0.15353418308227115}
[S17] START round=32 head_norm_before_train=2.042765 cos_to_last_merge=0.9974 (last merge round=25)
[S17] round=32 local utility u=0.071915 metrics={'f1_val': 0.4128005593608784, 'auprc': 0.4128005593608784, 'loss_val': 1.5577202734780866, 'psi': 0.4128005593608784}-{'f1_val': 0.40197275201501415, 'auprc': 0.40197275201501415, 'loss_val': 1.6040993881086727, 'psi': 0.40197275201501415}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.413)
[S14] not sending this round → trigger blocked (psi=0.131)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:59817
[S5] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S5
[S17] cosine check vs S5: cos=0.9990
[S2] START round=33 head_norm_before_train=1.918152 cos_to_last_merge=0.9991 (last merge round=27)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.24834662216453426, 'auprc': 0.24834662216453426, 'loss_val': 2.2942478696673136, 'psi': 0.2483466221645343}-{'f1_val': 0.24890045220838752, 'auprc': 0.24890045220838752, 'loss_val': 2.2479021067683425, 'psi': 0.24890045220838752}
[S3] START round=33 head_norm_before_train=1.877403 cos_to_last_merge=0.9999 (last merge round=30)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.23563753804111545, 'auprc': 0.23563753804111545, 'loss_val': 2.6378047079193516, 'psi': 0.23563753804111545}-{'f1_val': 0.24117306579201236, 'auprc': 0.24117306579201236, 'loss_val': 2.6432453560619242, 'psi': 0.24117306579201236}
[S4] START round=33 head_norm_before_train=1.846880 cos_to_last_merge=0.9651 (last merge round=23)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.139382865441356, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.127865809575165, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=2.037499 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.295771541905434, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.25939336723608, 'psi': 0.33300395256917}
[S6] START round=33 head_norm_before_train=1.663581 cos_to_last_merge=0.9351 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.935
[S6] round=33 local utility u=0.092539 metrics={'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 5.169280364003609, 'psi': 0.025658492279745686}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 5.323112666536604, 'psi': 0.022186642268984445}
[S7] START round=33 head_norm_before_train=1.651886 (no previous merge yet)
[S7] round=33 local utility u=0.001303 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9668154228852535, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9694220368676968, 'psi': 0.35976373724718097}
[S7] not sending this round → trigger blocked (psi=0.360)
[S8] START round=33 head_norm_before_train=2.087739 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9443540293422434, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9302102381339161, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.485204 cos_to_last_merge=0.9729 (last merge round=23)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2865429446389705, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.241077902498555, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=2.139239 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.24456394669160628, 'auprc': 0.24456394669160628, 'loss_val': 1.120382358079306, 'psi': 0.24456394669160628}-{'f1_val': 0.2479260488267362, 'auprc': 0.2479260488267362, 'loss_val': 1.11090868177844, 'psi': 0.2479260488267362}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.837917 (no previous merge yet)
[S11] round=33 local utility u=0.032136 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.245573174033399, 'psi': 0.33162711338607104}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3126245951737263, 'psi': 0.3319360347772085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=33 head_norm_before_train=1.947797 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.723853858240145, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.698003044257472, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.859743 cos_to_last_merge=0.9874 (last merge round=28)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.12165450121654502, 'auprc': 0.12165450121654502, 'loss_val': 4.692377310957805, 'psi': 0.121654501216545}-{'f1_val': 0.13111866112998616, 'auprc': 0.13111866112998616, 'loss_val': 4.503706184706131, 'psi': 0.13111866112998616}
[S15] START round=33 head_norm_before_train=2.203475 (no previous merge yet)
[S15] round=33 local utility u=0.238301 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.541087626650668, 'psi': 0.6164734888353558}-{'f1_val': 0.5849841480605997, 'auprc': 0.5849841480605997, 'loss_val': 0.7342858187486667, 'psi': 0.5849841480605997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=33 head_norm_before_train=1.864510 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.021018593371059015, 'auprc': 0.021018593371059015, 'loss_val': 5.551586942601502, 'psi': 0.021018593371059015}-{'f1_val': 0.11860088024090804, 'auprc': 0.11860088024090804, 'loss_val': 3.9952160878777043, 'psi': 0.11860088024090804}
[S17] START round=33 head_norm_before_train=2.056975 cos_to_last_merge=0.9967 (last merge round=25)
[S17] round=33 local utility u=0.613030 metrics={'f1_val': 0.5148793227302709, 'auprc': 0.5148793227302709, 'loss_val': 1.2503690585347216, 'psi': 0.5148793227302709}-{'f1_val': 0.4128005593608784, 'auprc': 0.4128005593608784, 'loss_val': 1.5577202734780866, 'psi': 0.4128005593608784}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.026)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] cosine check vs S17: cos=0.9986
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.5149 head_norm=2.070809
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.259652e-02
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.5137 head_norm=2.053548 delta_norm=0.052597
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.3330 head_norm=2.047402
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.535771e-02
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.3330 head_norm=2.058394 delta_norm=0.055358
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.931955 cos_to_last_merge=0.9988 (last merge round=27)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.24788697637115184, 'auprc': 0.24788697637115184, 'loss_val': 2.338510407613998, 'psi': 0.24788697637115184}-{'f1_val': 0.24834662216453426, 'auprc': 0.24834662216453426, 'loss_val': 2.2942478696673136, 'psi': 0.2483466221645343}
[S3] START round=34 head_norm_before_train=1.887593 cos_to_last_merge=0.9998 (last merge round=30)
[S3] round=34 local utility u=0.021500 metrics={'f1_val': 0.24038344861060548, 'auprc': 0.24038344861060548, 'loss_val': 2.6375188648060757, 'psi': 0.24038344861060545}-{'f1_val': 0.23563753804111545, 'auprc': 0.23563753804111545, 'loss_val': 2.6378047079193516, 'psi': 0.23563753804111545}
[S4] START round=34 head_norm_before_train=1.866544 cos_to_last_merge=0.9631 (last merge round=23)
[S4] round=34 local utility u=0.006472 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1264391834800582, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.139382865441356, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=2.058394 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.499693953929903, 'psi': 0.3335071121394324}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.295771541905434, 'psi': 0.33300395256917}
[S6] START round=34 head_norm_before_train=1.679921 cos_to_last_merge=0.9326 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.933
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.001431980906921241, 'auprc': 0.001431980906921241, 'loss_val': 5.575815563966998, 'psi': 0.001431980906921241}-{'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 5.169280364003609, 'psi': 0.025658492279745686}
[S7] START round=34 head_norm_before_train=1.655463 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9610839869287783, 'psi': 0.23976608187134504}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9668154228852535, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=2.101218 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9647299172676678, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9443540293422434, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.500365 cos_to_last_merge=0.9713 (last merge round=23)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3251960892896837, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2865429446389705, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=2.154935 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.23249611024672148, 'auprc': 0.23249611024672148, 'loss_val': 1.2359850263469512, 'psi': 0.23249611024672148}-{'f1_val': 0.24456394669160628, 'auprc': 0.24456394669160628, 'loss_val': 1.120382358079306, 'psi': 0.24456394669160628}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.851985 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3860960362763284, 'psi': 0.3319360347772085}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.245573174033399, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.957568 (no previous merge yet)
[S13] round=34 local utility u=0.026413 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6710280516269844, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.723853858240145, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=34 head_norm_before_train=1.881493 cos_to_last_merge=0.9845 (last merge round=28)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.12560386473429952, 'auprc': 0.12560386473429952, 'loss_val': 4.814409391599382, 'psi': 0.12560386473429952}-{'f1_val': 0.12165450121654502, 'auprc': 0.12165450121654502, 'loss_val': 4.692377310957805, 'psi': 0.121654501216545}
[S15] START round=34 head_norm_before_train=2.218039 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.6137398617431126, 'psi': 0.6149367764291455}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.541087626650668, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.873576 (no previous merge yet)
[S16] round=34 local utility u=1.000000 metrics={'f1_val': 0.10438459826396616, 'auprc': 0.10438459826396616, 'loss_val': 4.281726892539278, 'psi': 0.10438459826396615}-{'f1_val': 0.021018593371059015, 'auprc': 0.021018593371059015, 'loss_val': 5.551586942601502, 'psi': 0.021018593371059015}
[S17] START round=34 head_norm_before_train=2.053548 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.409054674875562, 'auprc': 0.409054674875562, 'loss_val': 1.5821551489231167, 'psi': 0.409054674875562}-{'f1_val': 0.5148793227302709, 'auprc': 0.5148793227302709, 'loss_val': 1.2503690585347216, 'psi': 0.5148793227302709}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.104)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:59816
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S4
[S16] cosine check vs S4: cos=-0.0866
[S16] DROPPED delta from S4 (cos=-0.0866 < 0.0)
[S2] START round=35 head_norm_before_train=1.945004 cos_to_last_merge=0.9985 (last merge round=27)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.24724632330318133, 'auprc': 0.24724632330318133, 'loss_val': 2.377241541650938, 'psi': 0.2472463233031813}-{'f1_val': 0.24788697637115184, 'auprc': 0.24788697637115184, 'loss_val': 2.338510407613998, 'psi': 0.24788697637115184}
[S3] START round=35 head_norm_before_train=1.897759 cos_to_last_merge=0.9997 (last merge round=30)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.24138974638339084, 'auprc': 0.24138974638339084, 'loss_val': 2.6525418192263746, 'psi': 0.24138974638339084}-{'f1_val': 0.24038344861060548, 'auprc': 0.24038344861060548, 'loss_val': 2.6375188648060757, 'psi': 0.24038344861060545}
[S4] START round=35 head_norm_before_train=1.879534 cos_to_last_merge=0.9618 (last merge round=23)
[S4] round=35 local utility u=0.000270 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.125899071673975, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1264391834800582, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=2.065964 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5047013560671725, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.499693953929903, 'psi': 0.3335071121394324}
[S6] START round=35 head_norm_before_train=1.694216 cos_to_last_merge=0.9302 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.930
[S6] round=35 local utility u=0.182114 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.394442186222315, 'psi': 0.021749084249084248}-{'f1_val': 0.001431980906921241, 'auprc': 0.001431980906921241, 'loss_val': 5.575815563966998, 'psi': 0.001431980906921241}
[S7] START round=35 head_norm_before_train=1.658225 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9606286460896915, 'psi': 0.23968964488212474}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9610839869287783, 'psi': 0.23976608187134504}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=2.115808 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9833057698312802, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9647299172676678, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.514243 cos_to_last_merge=0.9698 (last merge round=23)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3594104043501383, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3251960892896837, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=2.169041 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.24057037718491261, 'auprc': 0.24057037718491261, 'loss_val': 1.35723811824044, 'psi': 0.24057037718491261}-{'f1_val': 0.23249611024672148, 'auprc': 0.23249611024672148, 'loss_val': 1.2359850263469512, 'psi': 0.23249611024672148}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.864820 (no previous merge yet)
[S11] round=35 local utility u=0.009355 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.366690168991629, 'psi': 0.33185875048506014}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3860960362763284, 'psi': 0.3319360347772085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=35 head_norm_before_train=1.964034 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7436284805211826, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6710280516269844, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.899778 cos_to_last_merge=0.9821 (last merge round=28)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13212760612911328, 'auprc': 0.13212760612911328, 'loss_val': 4.9138474150918965, 'psi': 0.13212760612911328}-{'f1_val': 0.12560386473429952, 'auprc': 0.12560386473429952, 'loss_val': 4.814409391599382, 'psi': 0.12560386473429952}
[S15] START round=35 head_norm_before_train=2.231352 (no previous merge yet)
[S15] round=35 local utility u=0.059094 metrics={'f1_val': 0.6163105695516834, 'auprc': 0.6163105695516834, 'loss_val': 0.5079163963823623, 'psi': 0.6163105695516834}-{'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.6137398617431126, 'psi': 0.6149367764291455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=35 head_norm_before_train=1.882414 (no previous merge yet)
[S16] round=35 local utility u=0.111336 metrics={'f1_val': 0.1114106988783434, 'auprc': 0.1114106988783434, 'loss_val': 4.122289074529208, 'psi': 0.1114106988783434}-{'f1_val': 0.10438459826396616, 'auprc': 0.10438459826396616, 'loss_val': 4.281726892539278, 'psi': 0.10438459826396615}
[S17] START round=35 head_norm_before_train=2.069191 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=35 local utility u=0.342964 metrics={'f1_val': 0.46636466393086, 'auprc': 0.46636466393086, 'loss_val': 1.4120177974202783, 'psi': 0.46636466393085996}-{'f1_val': 0.409054674875562, 'auprc': 0.409054674875562, 'loss_val': 1.5821551489231167, 'psi': 0.409054674875562}
[S4] not sending this round → trigger blocked (psi=0.357)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.111)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:59805
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] ⇄ pheromone p=0.283 → S4@127.0.0.1:59804
[S4] ⇄ pheromone p=0.006 → S16@127.0.0.1:59816
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] cosine check vs S17: cos=0.9997
[S17] ⇄ pheromone p=0.221 → S5@127.0.0.1:59805
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.3335 head_norm=2.072045
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.510083e-02
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.3335 head_norm=2.080432 delta_norm=0.025101
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.030 → S17@127.0.0.1:59817
[S2] START round=36 head_norm_before_train=1.956981 cos_to_last_merge=0.9981 (last merge round=27)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.24642747623428396, 'auprc': 0.24642747623428396, 'loss_val': 2.4124786667279525, 'psi': 0.24642747623428396}-{'f1_val': 0.24724632330318133, 'auprc': 0.24724632330318133, 'loss_val': 2.377241541650938, 'psi': 0.2472463233031813}
[S3] START round=36 head_norm_before_train=1.907587 cos_to_last_merge=0.9996 (last merge round=30)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2396839866302036, 'auprc': 0.2396839866302036, 'loss_val': 2.674920624729226, 'psi': 0.2396839866302036}-{'f1_val': 0.24138974638339084, 'auprc': 0.24138974638339084, 'loss_val': 2.6525418192263746, 'psi': 0.24138974638339084}
[S4] START round=36 head_norm_before_train=1.893504 cos_to_last_merge=0.9604 (last merge round=23)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.138147634697451, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.125899071673975, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=2.080432 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.564885837542753, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5047013560671725, 'psi': 0.3335071121394324}
[S6] START round=36 head_norm_before_train=1.709304 cos_to_last_merge=0.9278 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=36 local utility u=0.038637 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.3191381130550175, 'psi': 0.021967963386727688}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.394442186222315, 'psi': 0.021749084249084248}
[S7] START round=36 head_norm_before_train=1.662092 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9662703550782995, 'psi': 0.23976608187134504}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9606286460896915, 'psi': 0.23968964488212474}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=2.129970 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0037724966149635, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9833057698312802, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.527112 cos_to_last_merge=0.9683 (last merge round=23)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.389458617048367, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3594104043501383, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=2.182527 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.23270300333704116, 'auprc': 0.23270300333704116, 'loss_val': 1.292534105904575, 'psi': 0.23270300333704114}-{'f1_val': 0.24057037718491261, 'auprc': 0.24057037718491261, 'loss_val': 1.35723811824044, 'psi': 0.24057037718491261}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.876360 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.3798299859790055, 'psi': 0.33178150217256364}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.366690168991629, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.962444 (no previous merge yet)
[S13] round=36 local utility u=0.024965 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6936984263865458, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7436284805211826, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=36 head_norm_before_train=1.915072 cos_to_last_merge=0.9801 (last merge round=28)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.012166648784539, 'psi': 0.13253012048192772}-{'f1_val': 0.13212760612911328, 'auprc': 0.13212760612911328, 'loss_val': 4.9138474150918965, 'psi': 0.13212760612911328}
[S15] START round=36 head_norm_before_train=2.244273 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.5851915420534665, 'auprc': 0.5851915420534665, 'loss_val': 0.7398130513842119, 'psi': 0.5851915420534665}-{'f1_val': 0.6163105695516834, 'auprc': 0.6163105695516834, 'loss_val': 0.5079163963823623, 'psi': 0.6163105695516834}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.888269 (no previous merge yet)
[S16] round=36 local utility u=0.106415 metrics={'f1_val': 0.14830782496227635, 'auprc': 0.14830782496227635, 'loss_val': 4.241533157238749, 'psi': 0.14830782496227635}-{'f1_val': 0.1114106988783434, 'auprc': 0.1114106988783434, 'loss_val': 4.122289074529208, 'psi': 0.1114106988783434}
[S17] START round=36 head_norm_before_train=2.089087 cos_to_last_merge=0.9998 (last merge round=33)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.43618956247126783, 'auprc': 0.43618956247126783, 'loss_val': 1.5858622147503658, 'psi': 0.43618956247126783}-{'f1_val': 0.46636466393086, 'auprc': 0.46636466393086, 'loss_val': 1.4120177974202783, 'psi': 0.46636466393085996}
[S6] not sending this round → trigger blocked (psi=0.022)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.148)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.967972 cos_to_last_merge=0.9978 (last merge round=27)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.24583945178658836, 'auprc': 0.24583945178658836, 'loss_val': 2.442993223365113, 'psi': 0.24583945178658834}-{'f1_val': 0.24642747623428396, 'auprc': 0.24642747623428396, 'loss_val': 2.4124786667279525, 'psi': 0.24642747623428396}
[S3] START round=37 head_norm_before_train=1.917328 cos_to_last_merge=0.9994 (last merge round=30)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.24115794573643412, 'auprc': 0.24115794573643412, 'loss_val': 2.707967305780083, 'psi': 0.24115794573643412}-{'f1_val': 0.2396839866302036, 'auprc': 0.2396839866302036, 'loss_val': 2.674920624729226, 'psi': 0.2396839866302036}
[S4] START round=37 head_norm_before_train=1.913597 cos_to_last_merge=0.9585 (last merge round=23)
[S4] round=37 local utility u=0.004201 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1297457144652558, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.138147634697451, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=2.086446 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6042614362798977, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.564885837542753, 'psi': 0.3335071121394324}
[S6] START round=37 head_norm_before_train=1.720651 cos_to_last_merge=0.9259 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.926
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 5.464726651636115, 'psi': 0.02109124254928932}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.3191381130550175, 'psi': 0.021967963386727688}
[S7] START round=37 head_norm_before_train=1.669201 (no previous merge yet)
[S7] round=37 local utility u=0.538173 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9699023903600882, 'psi': 0.35976373724718097}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9662703550782995, 'psi': 0.23976608187134504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=37 head_norm_before_train=2.143751 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.021942972795367, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0037724966149635, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.539035 cos_to_last_merge=0.9669 (last merge round=23)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4185157144218943, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.389458617048367, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=2.196272 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.2225531914893617, 'auprc': 0.2225531914893617, 'loss_val': 1.2737741746372742, 'psi': 0.2225531914893617}-{'f1_val': 0.23270300333704116, 'auprc': 0.23270300333704116, 'loss_val': 1.292534105904575, 'psi': 0.23270300333704114}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.887529 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.396492179025594, 'psi': 0.33178150217256364}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.3798299859790055, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.967560 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7341691191381745, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6936984263865458, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.928105 cos_to_last_merge=0.9784 (last merge round=28)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.10155818641189, 'psi': 0.13253012048192772}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.012166648784539, 'psi': 0.13253012048192772}
[S15] START round=37 head_norm_before_train=2.256892 (no previous merge yet)
[S15] round=37 local utility u=0.214152 metrics={'f1_val': 0.6155212897483049, 'auprc': 0.6155212897483049, 'loss_val': 0.5844761619589223, 'psi': 0.6155212897483049}-{'f1_val': 0.5851915420534665, 'auprc': 0.5851915420534665, 'loss_val': 0.7398130513842119, 'psi': 0.5851915420534665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=37 head_norm_before_train=1.894636 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.14583784564291388, 'auprc': 0.14583784564291388, 'loss_val': 4.3800826400294675, 'psi': 0.14583784564291388}-{'f1_val': 0.14830782496227635, 'auprc': 0.14830782496227635, 'loss_val': 4.241533157238749, 'psi': 0.14830782496227635}
[S17] START round=37 head_norm_before_train=2.107383 cos_to_last_merge=0.9996 (last merge round=33)
[S17] round=37 local utility u=1.000000 metrics={'f1_val': 0.7003390449662668, 'auprc': 0.7003390449662668, 'loss_val': 0.8587454186347362, 'psi': 0.7003390449662668}-{'f1_val': 0.43618956247126783, 'auprc': 0.43618956247126783, 'loss_val': 1.5858622147503658, 'psi': 0.43618956247126783}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:59816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:59805
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1804) from S4
[S16] cosine check vs S4: cos=-0.0858
[S16] DROPPED delta from S4 (cos=-0.0858 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S17
[S5] cosine check vs S17: cos=0.9997
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.3335 head_norm=2.092999
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.952645e-02
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.3335 head_norm=2.103585 delta_norm=0.029526
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.978340 cos_to_last_merge=0.9975 (last merge round=27)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.24583945178658836, 'auprc': 0.24583945178658836, 'loss_val': 2.4707193774445866, 'psi': 0.24583945178658834}-{'f1_val': 0.24583945178658836, 'auprc': 0.24583945178658836, 'loss_val': 2.442993223365113, 'psi': 0.24583945178658834}
[S3] START round=38 head_norm_before_train=1.926449 cos_to_last_merge=0.9992 (last merge round=30)
[S3] round=38 local utility u=0.005137 metrics={'f1_val': 0.24262176353431106, 'auprc': 0.24262176353431106, 'loss_val': 2.710866944319118, 'psi': 0.24262176353431106}-{'f1_val': 0.24115794573643412, 'auprc': 0.24115794573643412, 'loss_val': 2.707967305780083, 'psi': 0.24115794573643412}
[S4] START round=38 head_norm_before_train=1.925378 cos_to_last_merge=0.9581 (last merge round=23)
[S4] round=38 local utility u=0.007632 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.114482137860677, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1297457144652558, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=2.103585 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6183121033815118, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6042614362798977, 'psi': 0.3335071121394324}
[S6] START round=38 head_norm_before_train=1.731985 cos_to_last_merge=0.9240 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.924
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.651983965424586, 'psi': 0.017774699907663897}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 5.464726651636115, 'psi': 0.02109124254928932}
[S7] START round=38 head_norm_before_train=1.674931 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9789864841078235, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9699023903600882, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=2.157205 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0369407035876463, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.021942972795367, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.550429 cos_to_last_merge=0.9656 (last merge round=23)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4449041587224682, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4185157144218943, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=2.209778 (no previous merge yet)
[S10] round=38 local utility u=0.019820 metrics={'f1_val': 0.22709509335649153, 'auprc': 0.22709509335649153, 'loss_val': 1.2750104531959456, 'psi': 0.22709509335649153}-{'f1_val': 0.2225531914893617, 'auprc': 0.2225531914893617, 'loss_val': 1.2737741746372742, 'psi': 0.2225531914893617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=38 head_norm_before_train=1.898347 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.435331617680444, 'psi': 0.33185875048506014}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.396492179025594, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.977826 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.736485006318405, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7341691191381745, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.939492 cos_to_last_merge=0.9769 (last merge round=28)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.179661908783489, 'psi': 0.13253012048192772}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.10155818641189, 'psi': 0.13253012048192772}
[S15] START round=38 head_norm_before_train=2.268171 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5967518550420333, 'psi': 0.6163342951580373}-{'f1_val': 0.6155212897483049, 'auprc': 0.6155212897483049, 'loss_val': 0.5844761619589223, 'psi': 0.6155212897483049}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.901640 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.1436856604320719, 'auprc': 0.1436856604320719, 'loss_val': 4.4893412143098805, 'psi': 0.1436856604320719}-{'f1_val': 0.14583784564291388, 'auprc': 0.14583784564291388, 'loss_val': 4.3800826400294675, 'psi': 0.14583784564291388}
[S17] START round=38 head_norm_before_train=2.114530 cos_to_last_merge=0.9995 (last merge round=33)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.4243701020312128, 'auprc': 0.4243701020312128, 'loss_val': 1.7396052432060507, 'psi': 0.4243701020312128}-{'f1_val': 0.7003390449662668, 'auprc': 0.7003390449662668, 'loss_val': 0.8587454186347362, 'psi': 0.7003390449662668}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.357)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.988213 cos_to_last_merge=0.9972 (last merge round=27)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.24583945178658836, 'auprc': 0.24583945178658836, 'loss_val': 2.4981211840658384, 'psi': 0.24583945178658834}-{'f1_val': 0.24583945178658836, 'auprc': 0.24583945178658836, 'loss_val': 2.4707193774445866, 'psi': 0.24583945178658834}
[S3] START round=39 head_norm_before_train=1.934659 cos_to_last_merge=0.9991 (last merge round=30)
[S3] round=39 local utility u=0.534008 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7367207511590355, 'psi': 0.3641628959276018}-{'f1_val': 0.24262176353431106, 'auprc': 0.24262176353431106, 'loss_val': 2.710866944319118, 'psi': 0.24262176353431106}
[S4] START round=39 head_norm_before_train=1.934319 cos_to_last_merge=0.9571 (last merge round=23)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.116267833408477, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.114482137860677, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=2.113531 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6358982317455437, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6183121033815118, 'psi': 0.3335071121394324}
[S6] START round=39 head_norm_before_train=1.745796 cos_to_last_merge=0.9219 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.922
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.7557111619873105, 'psi': 0.021310724106324473}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.651983965424586, 'psi': 0.017774699907663897}
[S7] START round=39 head_norm_before_train=1.680793 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9824722565506956, 'psi': 0.23976608187134504}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9789864841078235, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.240 u=0.0000 p_local=0.0758 f1=0.240 auprc=0.240 bytes=27008
[S8] START round=39 head_norm_before_train=2.170101 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.054381223407956, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0369407035876463, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0004 f1=0.359 auprc=0.359 bytes=5401
[S9] START round=39 head_norm_before_train=1.561178 cos_to_last_merge=0.9644 (last merge round=23)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4691910042141263, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4449041587224682, 'psi': 0.36867172340800847}
[S10] START round=39 head_norm_before_train=2.222133 (no previous merge yet)
[S10] round=39 local utility u=0.022357 metrics={'f1_val': 0.23249611024672148, 'auprc': 0.23249611024672148, 'loss_val': 1.278904849988803, 'psi': 0.23249611024672148}-{'f1_val': 0.22709509335649153, 'auprc': 0.22709509335649153, 'loss_val': 1.2750104531959456, 'psi': 0.22709509335649153}
[S10] not sending this round → trigger blocked (psi=0.232)
[S10] r=40 psi=0.232 u=0.0224 p_local=0.0203 f1=0.232 auprc=0.232 bytes=30573
[S11] START round=39 head_norm_before_train=1.909132 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.463019026811099, 'psi': 0.33185875048506014}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.435331617680444, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0058 f1=0.332 auprc=0.332 bytes=18008
[S13] START round=39 head_norm_before_train=1.989627 (no previous merge yet)
[S13] round=39 local utility u=0.004301 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7278829252381482, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.736485006318405, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S13] r=40 psi=0.360 u=0.0043 p_local=0.0059 f1=0.360 auprc=0.360 bytes=16181
[S14] START round=39 head_norm_before_train=1.949830 cos_to_last_merge=0.9757 (last merge round=28)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.24959456842938, 'psi': 0.13333333333333333}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.179661908783489, 'psi': 0.13253012048192772}
[S15] START round=39 head_norm_before_train=2.280007 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.614683999495662, 'auprc': 0.614683999495662, 'loss_val': 0.6059105715425256, 'psi': 0.614683999495662}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5967518550420333, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.615 u=0.0000 p_local=0.0539 f1=0.615 auprc=0.615 bytes=37813
[S16] START round=39 head_norm_before_train=1.909005 (no previous merge yet)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.13327416611197396, 'auprc': 0.13327416611197396, 'loss_val': 4.868101039591499, 'psi': 0.13327416611197396}-{'f1_val': 0.1436856604320719, 'auprc': 0.1436856604320719, 'loss_val': 4.4893412143098805, 'psi': 0.1436856604320719}
[S17] START round=39 head_norm_before_train=2.121192 cos_to_last_merge=0.9994 (last merge round=33)
[S17] round=39 local utility u=0.487642 metrics={'f1_val': 0.5068305444101118, 'auprc': 0.5068305444101118, 'loss_val': 1.506465825646614, 'psi': 0.5068305444101118}-{'f1_val': 0.4243701020312128, 'auprc': 0.4243701020312128, 'loss_val': 1.7396052432060507, 'psi': 0.4243701020312128}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:59805
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.364)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.021 u=0.0000 p_local=0.0537 f1=0.021 auprc=0.021 bytes=0
[S3] r=40 psi=0.364 u=0.5340 p_local=0.1179 f1=0.364 auprc=0.364 bytes=12591
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0033 f1=0.369 auprc=0.369 bytes=10820
[S2] r=40 psi=0.246 u=0.0000 p_local=0.0187 f1=0.246 auprc=0.246 bytes=18027
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0043 f1=0.357 auprc=0.357 bytes=25198
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] r=40 psi=0.133 u=0.0000 p_local=0.1269 f1=0.133 auprc=0.133 bytes=0
[S14] r=40 psi=0.133 u=0.0000 p_local=0.0182 f1=0.133 auprc=0.133 bytes=0
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1797) from S17
[S5] cosine check vs S17: cos=0.9996
[S17] r=40 psi=0.507 u=0.4876 p_local=0.3160 f1=0.507 auprc=0.507 bytes=32416
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=39 metric=0.3335 head_norm=2.124091
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.042361e-02
[S5] stored merged vector for next round verification (round=39)
[S5] DEBUG after merge:  round=39 metric=0.3335 head_norm=2.126693 delta_norm=0.030424
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] r=40 psi=0.334 u=0.0000 p_local=0.0124 f1=0.334 auprc=0.334 bytes=23392
[S2] START round=40 head_norm_before_train=1.997565 cos_to_last_merge=0.9969 (last merge round=27)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.2457492354740061, 'auprc': 0.2457492354740061, 'loss_val': 2.525605500115823, 'psi': 0.2457492354740061}-{'f1_val': 0.24583945178658836, 'auprc': 0.24583945178658836, 'loss_val': 2.4981211840658384, 'psi': 0.24583945178658834}
[S3] START round=40 head_norm_before_train=1.942310 cos_to_last_merge=0.9989 (last merge round=30)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7713256884255855, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7367207511590355, 'psi': 0.3641628959276018}
[S4] START round=40 head_norm_before_train=1.943936 cos_to_last_merge=0.9554 (last merge round=23)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.13031810887643, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.116267833408477, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=2.126693 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6436305566931977, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6358982317455437, 'psi': 0.3335071121394324}
[S6] START round=40 head_norm_before_train=1.760272 cos_to_last_merge=0.9197 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.920
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.015538033395176253, 'auprc': 0.015538033395176253, 'loss_val': 5.835478082170175, 'psi': 0.015538033395176253}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.7557111619873105, 'psi': 0.021310724106324473}
[S7] START round=40 head_norm_before_train=1.682431 (no previous merge yet)
[S7] round=40 local utility u=0.534976 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9924993614601226, 'psi': 0.35976373724718097}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9824722565506956, 'psi': 0.23976608187134504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=40 head_norm_before_train=2.181796 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.072145593348824, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.054381223407956, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.571331 cos_to_last_merge=0.9632 (last merge round=23)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.494778865414197, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4691910042141263, 'psi': 0.36867172340800847}
[S10] START round=40 head_norm_before_train=2.233917 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.23343003793796027, 'auprc': 0.23343003793796027, 'loss_val': 1.2893591145914178, 'psi': 0.23343003793796027}-{'f1_val': 0.23249611024672148, 'auprc': 0.23249611024672148, 'loss_val': 1.278904849988803, 'psi': 0.23249611024672148}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.919297 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.4971728336925194, 'psi': 0.33185875048506014}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.463019026811099, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.995107 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.731329063808071, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7278829252381482, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.959238 cos_to_last_merge=0.9745 (last merge round=28)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.315993046453293, 'psi': 0.1331327566754419}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.24959456842938, 'psi': 0.13333333333333333}
[S15] START round=40 head_norm_before_train=2.291523 (no previous merge yet)
[S15] round=40 local utility u=0.029030 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5627030814258235, 'psi': 0.6163342951580373}-{'f1_val': 0.614683999495662, 'auprc': 0.614683999495662, 'loss_val': 0.6059105715425256, 'psi': 0.614683999495662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=40 head_norm_before_train=1.914798 (no previous merge yet)
[S16] round=40 local utility u=0.287294 metrics={'f1_val': 0.14908882192567083, 'auprc': 0.14908882192567083, 'loss_val': 4.435844566206298, 'psi': 0.14908882192567083}-{'f1_val': 0.13327416611197396, 'auprc': 0.13327416611197396, 'loss_val': 4.868101039591499, 'psi': 0.13327416611197396}
[S17] START round=40 head_norm_before_train=2.129727 cos_to_last_merge=0.9993 (last merge round=33)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.4266596820275165, 'auprc': 0.4266596820275165, 'loss_val': 1.8515554630780657, 'psi': 0.4266596820275165}-{'f1_val': 0.5068305444101118, 'auprc': 0.5068305444101118, 'loss_val': 1.506465825646614, 'psi': 0.5068305444101118}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.149)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.003 → S16@127.0.0.1:59816
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] ⇄ pheromone p=0.253 → S5@127.0.0.1:59805
[S16] ⇄ pheromone p=0.159 → S4@127.0.0.1:59804
[S5] ⇄ pheromone p=0.010 → S17@127.0.0.1:59817
[S2] START round=41 head_norm_before_train=2.006602 cos_to_last_merge=0.9966 (last merge round=27)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.24583945178658836, 'auprc': 0.24583945178658836, 'loss_val': 2.5471904825566787, 'psi': 0.24583945178658834}-{'f1_val': 0.2457492354740061, 'auprc': 0.2457492354740061, 'loss_val': 2.525605500115823, 'psi': 0.2457492354740061}
[S3] START round=41 head_norm_before_train=1.950081 cos_to_last_merge=0.9987 (last merge round=30)
[S3] round=41 local utility u=0.003786 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.763754559909116, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7713256884255855, 'psi': 0.3641628959276018}
[S4] START round=41 head_norm_before_train=1.959906 cos_to_last_merge=0.9534 (last merge round=23)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1310335103727365, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.13031810887643, 'psi': 0.3567939207526687}
[S5] START round=41 head_norm_before_train=2.140542 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=41 local utility u=0.001140 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6413509270351936, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6436305566931977, 'psi': 0.3335071121394324}
[S6] START round=41 head_norm_before_train=1.773366 cos_to_last_merge=0.9177 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.918
[S6] round=41 local utility u=0.439302 metrics={'f1_val': 0.05609859753506162, 'auprc': 0.05609859753506162, 'loss_val': 5.321919908996687, 'psi': 0.05609859753506162}-{'f1_val': 0.015538033395176253, 'auprc': 0.015538033395176253, 'loss_val': 5.835478082170175, 'psi': 0.015538033395176253}
[S7] START round=41 head_norm_before_train=1.684069 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9841168205813299, 'psi': 0.23976608187134504}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9924993614601226, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=2.191721 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0886696438156194, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.072145593348824, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.581309 cos_to_last_merge=0.9621 (last merge round=23)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.520033869099579, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.494778865414197, 'psi': 0.36867172340800847}
[S10] START round=41 head_norm_before_train=2.245515 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.23343003793796027, 'auprc': 0.23343003793796027, 'loss_val': 1.2958311163898424, 'psi': 0.23343003793796027}-{'f1_val': 0.23343003793796027, 'auprc': 0.23343003793796027, 'loss_val': 1.2893591145914178, 'psi': 0.23343003793796027}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.928779 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.5385084948017314, 'psi': 0.3319360347772085}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.4971728336925194, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.999231 (no previous merge yet)
[S13] round=41 local utility u=0.007145 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.717038879968342, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.731329063808071, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=41 head_norm_before_train=1.967940 cos_to_last_merge=0.9735 (last merge round=28)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.374627718077749, 'psi': 0.13333333333333333}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.315993046453293, 'psi': 0.1331327566754419}
[S15] START round=41 head_norm_before_train=2.301252 (no previous merge yet)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6153591648042265, 'auprc': 0.6153591648042265, 'loss_val': 0.5607080517456378, 'psi': 0.6153591648042265}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5627030814258235, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.919995 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.11185475805831219, 'auprc': 0.11185475805831219, 'loss_val': 5.137926509349857, 'psi': 0.11185475805831219}-{'f1_val': 0.14908882192567083, 'auprc': 0.14908882192567083, 'loss_val': 4.435844566206298, 'psi': 0.14908882192567083}
[S17] START round=41 head_norm_before_train=2.139395 cos_to_last_merge=0.9991 (last merge round=33)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.41606070053147165, 'auprc': 0.41606070053147165, 'loss_val': 1.9285494501035112, 'psi': 0.41606070053147165}-{'f1_val': 0.4266596820275165, 'auprc': 0.4266596820275165, 'loss_val': 1.8515554630780657, 'psi': 0.4266596820275165}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.056)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:59817
[S5] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S5
[S17] cosine check vs S5: cos=0.9994
[S6]  timeout peer S15
[S5]  timeout peer S9
[S3]  timeout peer S2
[S14]  timeout peer S11
[S9]  timeout peer S14
[S2]  timeout peer S6
[S2] START round=42 head_norm_before_train=2.015137 cos_to_last_merge=0.9964 (last merge round=27)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.24602008327210387, 'auprc': 0.24602008327210387, 'loss_val': 2.5667088902915953, 'psi': 0.2460200832721039}-{'f1_val': 0.24583945178658836, 'auprc': 0.24583945178658836, 'loss_val': 2.5471904825566787, 'psi': 0.24583945178658834}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.957711 cos_to_last_merge=0.9985 (last merge round=30)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.788308179766742, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.763754559909116, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.975235 cos_to_last_merge=0.9513 (last merge round=23)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1350101049819887, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1310335103727365, 'psi': 0.3567939207526687}
[S5] START round=42 head_norm_before_train=2.154322 cos_to_last_merge=0.9998 (last merge round=39)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6991529125076674, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6413509270351936, 'psi': 0.3335071121394324}
[S6] START round=42 head_norm_before_train=1.785679 cos_to_last_merge=0.9158 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.916
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.007797972421806, 'psi': 0.017105871474803514}-{'f1_val': 0.05609859753506162, 'auprc': 0.05609859753506162, 'loss_val': 5.321919908996687, 'psi': 0.05609859753506162}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.685841 (no previous merge yet)
[S7] round=42 local utility u=0.002788 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9785416018197882, 'psi': 0.23976608187134504}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9841168205813299, 'psi': 0.23976608187134504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=42 head_norm_before_train=2.201241 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1023421414788532, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0886696438156194, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.590949 cos_to_last_merge=0.9610 (last merge round=23)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.540707677846679, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.520033869099579, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.256721 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.23332589783627036, 'auprc': 0.23332589783627036, 'loss_val': 1.2980395318210356, 'psi': 0.23332589783627036}-{'f1_val': 0.23343003793796027, 'auprc': 0.23343003793796027, 'loss_val': 1.2958311163898424, 'psi': 0.23343003793796027}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.937610 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.554153454524285, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.5385084948017314, 'psi': 0.3319360347772085}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=2.004472 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7571456938995917, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.717038879968342, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.976008 cos_to_last_merge=0.9725 (last merge round=28)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.433633288957367, 'psi': 0.1331327566754419}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.374627718077749, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.312069 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.5885463611321468, 'auprc': 0.5885463611321468, 'loss_val': 0.6146586267304022, 'psi': 0.5885463611321468}-{'f1_val': 0.6153591648042265, 'auprc': 0.6153591648042265, 'loss_val': 0.5607080517456378, 'psi': 0.6153591648042265}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.924873 (no previous merge yet)
[S16] round=42 local utility u=0.110992 metrics={'f1_val': 0.12753233161396427, 'auprc': 0.12753233161396427, 'loss_val': 5.057041172167535, 'psi': 0.12753233161396427}-{'f1_val': 0.11185475805831219, 'auprc': 0.11185475805831219, 'loss_val': 5.137926509349857, 'psi': 0.11185475805831219}
[S17] START round=42 head_norm_before_train=2.151748 cos_to_last_merge=0.9989 (last merge round=33)
[S17] round=42 local utility u=1.000000 metrics={'f1_val': 0.6142793780773941, 'auprc': 0.6142793780773941, 'loss_val': 1.2472255472139457, 'psi': 0.6142793780773941}-{'f1_val': 0.41606070053147165, 'auprc': 0.41606070053147165, 'loss_val': 1.9285494501035112, 'psi': 0.41606070053147165}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.128)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=0.9992
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=42 metric=0.6143 head_norm=2.157444
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.687618e-02
[S17] stored merged vector for next round verification (round=42)
[S17] DEBUG after merge:  round=42 metric=0.6150 head_norm=2.155568 delta_norm=0.036876
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=2.023164 cos_to_last_merge=0.9961 (last merge round=27)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.24633682790754705, 'auprc': 0.24633682790754705, 'loss_val': 2.5898207130175046, 'psi': 0.24633682790754702}-{'f1_val': 0.24602008327210387, 'auprc': 0.24602008327210387, 'loss_val': 2.5667088902915953, 'psi': 0.2460200832721039}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.964718 cos_to_last_merge=0.9984 (last merge round=30)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.24115794573643412, 'auprc': 0.24115794573643412, 'loss_val': 2.8252249091653296, 'psi': 0.24115794573643412}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.788308179766742, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.986401 cos_to_last_merge=0.9497 (last merge round=23)
[S4] ⚠️ Model drifted since last merge! cos=0.950
[S4] round=43 local utility u=0.001797 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1314168901730293, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1350101049819887, 'psi': 0.3567939207526687}
[S5] START round=43 head_norm_before_train=2.164731 cos_to_last_merge=0.9997 (last merge round=39)
[S5] round=43 local utility u=0.013001 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.668622791597215, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6991529125076674, 'psi': 0.3335071121394324}
[S6] START round=43 head_norm_before_train=1.796513 cos_to_last_merge=0.9141 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.914
[S6] round=43 local utility u=0.163779 metrics={'f1_val': 0.025442980463425715, 'auprc': 0.025442980463425715, 'loss_val': 5.7552729900897415, 'psi': 0.025442980463425715}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.007797972421806, 'psi': 0.017105871474803514}
[S6] not sending this round → trigger blocked (psi=0.025)
[S7] START round=43 head_norm_before_train=1.690671 (no previous merge yet)
[S7] round=43 local utility u=0.006137 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9655797837063669, 'psi': 0.23968964488212474}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9785416018197882, 'psi': 0.23976608187134504}
[S7] not sending this round → trigger blocked (psi=0.240)
[S8] START round=43 head_norm_before_train=2.210970 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.11736996378765, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1023421414788532, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.599901 cos_to_last_merge=0.9600 (last merge round=23)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.558668849192855, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.540707677846679, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.266998 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.23343003793796027, 'auprc': 0.23343003793796027, 'loss_val': 1.300205310982541, 'psi': 0.23343003793796027}-{'f1_val': 0.23332589783627036, 'auprc': 0.23332589783627036, 'loss_val': 1.2980395318210356, 'psi': 0.23332589783627036}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.946444 (no previous merge yet)
[S11] round=43 local utility u=0.001208 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.5510424063771313, 'psi': 0.33185875048506014}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.554153454524285, 'psi': 0.3319360347772085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S11] sending update (kind=head size=1808 to 1 peers)
[S13] START round=43 head_norm_before_train=2.015707 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7915800516855276, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7571456938995917, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.983633 cos_to_last_merge=0.9715 (last merge round=28)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.485770823520463, 'psi': 0.13253012048192772}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.433633288957367, 'psi': 0.1331327566754419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=2.322439 (no previous merge yet)
[S15] round=43 local utility u=0.115013 metrics={'f1_val': 0.6121495767377926, 'auprc': 0.6121495767377926, 'loss_val': 0.5970606369964737, 'psi': 0.6121495767377926}-{'f1_val': 0.5885463611321468, 'auprc': 0.5885463611321468, 'loss_val': 0.6146586267304022, 'psi': 0.5885463611321468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=43 head_norm_before_train=1.931258 (no previous merge yet)
[S16] round=43 local utility u=0.275609 metrics={'f1_val': 0.147524467472654, 'auprc': 0.147524467472654, 'loss_val': 4.685752510001468, 'psi': 0.147524467472654}-{'f1_val': 0.12753233161396427, 'auprc': 0.12753233161396427, 'loss_val': 5.057041172167535, 'psi': 0.12753233161396427}
[S17] START round=43 head_norm_before_train=2.155568 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.43933568870997897, 'auprc': 0.43933568870997897, 'loss_val': 1.8364671593480213, 'psi': 0.43933568870997897}-{'f1_val': 0.6142793780773941, 'auprc': 0.6142793780773941, 'loss_val': 1.2472255472139457, 'psi': 0.6142793780773941}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:59816
[S16] not sending this round → trigger blocked (psi=0.148)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:59817
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S4
[S16] cosine check vs S4: cos=-0.0823
[S16] DROPPED delta from S4 (cos=-0.0823 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S5
[S17] cosine check vs S5: cos=0.9996
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=43 metric=0.3330 head_norm=2.173040
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.766468e-02
[S5] stored merged vector for next round verification (round=43)
[S5] DEBUG after merge:  round=43 metric=0.3330 head_norm=2.164731 delta_norm=0.047665
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=2.031183 cos_to_last_merge=0.9958 (last merge round=27)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.24642747623428396, 'auprc': 0.24642747623428396, 'loss_val': 2.6093603761236244, 'psi': 0.24642747623428396}-{'f1_val': 0.24633682790754705, 'auprc': 0.24633682790754705, 'loss_val': 2.5898207130175046, 'psi': 0.24633682790754702}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.971843 cos_to_last_merge=0.9982 (last merge round=30)
[S3] round=44 local utility u=0.016647 metrics={'f1_val': 0.24154413989229748, 'auprc': 0.24154413989229748, 'loss_val': 2.7954067774466536, 'psi': 0.2415441398922975}-{'f1_val': 0.24115794573643412, 'auprc': 0.24115794573643412, 'loss_val': 2.8252249091653296, 'psi': 0.24115794573643412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=44 head_norm_before_train=2.002427 cos_to_last_merge=0.9481 (last merge round=23)
[S4] ⚠️ Model drifted since last merge! cos=0.948
[S4] round=44 local utility u=0.000667 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1300838559071364, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1314168901730293, 'psi': 0.3567939207526687}
[S5] START round=44 head_norm_before_train=2.164731 cos_to_last_merge=1.0000 (last merge round=43)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.696496078125805, 'psi': 0.3335071121394324}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.668622791597215, 'psi': 0.33300395256917}
[S6] START round=44 head_norm_before_train=1.807609 cos_to_last_merge=0.9124 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.912
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.1310347212988745, 'psi': 0.017774699907663897}-{'f1_val': 0.025442980463425715, 'auprc': 0.025442980463425715, 'loss_val': 5.7552729900897415, 'psi': 0.025442980463425715}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.698177 (no previous merge yet)
[S7] round=44 local utility u=0.545538 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9551700589808176, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9655797837063669, 'psi': 0.23968964488212474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=44 head_norm_before_train=2.221004 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1376782342792024, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.11736996378765, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.608382 cos_to_last_merge=0.9590 (last merge round=23)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.575836865019058, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.558668849192855, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.276780 (no previous merge yet)
[S10] round=44 local utility u=0.001677 metrics={'f1_val': 0.23405683598120386, 'auprc': 0.23405683598120386, 'loss_val': 1.3024933536895067, 'psi': 0.23405683598120386}-{'f1_val': 0.23343003793796027, 'auprc': 0.23343003793796027, 'loss_val': 1.300205310982541, 'psi': 0.23343003793796027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=44 head_norm_before_train=1.954936 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.567085140456632, 'psi': 0.33185875048506014}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.5510424063771313, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=2.038331 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8609239661073282, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7915800516855276, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.991059 cos_to_last_merge=0.9706 (last merge round=28)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.529792946566911, 'psi': 0.1331327566754419}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.485770823520463, 'psi': 0.13253012048192772}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.332056 (no previous merge yet)
[S15] round=44 local utility u=0.016146 metrics={'f1_val': 0.6160899759974897, 'auprc': 0.6160899759974897, 'loss_val': 0.6002325275839665, 'psi': 0.6160899759974897}-{'f1_val': 0.6121495767377926, 'auprc': 0.6121495767377926, 'loss_val': 0.5970606369964737, 'psi': 0.6121495767377926}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=44 head_norm_before_train=1.938353 (no previous merge yet)
[S16] round=44 local utility u=1.000000 metrics={'f1_val': 0.20494111623143882, 'auprc': 0.20494111623143882, 'loss_val': 3.050815224255494, 'psi': 0.20494111623143882}-{'f1_val': 0.147524467472654, 'auprc': 0.147524467472654, 'loss_val': 4.685752510001468, 'psi': 0.147524467472654}
[S17] START round=44 head_norm_before_train=2.168690 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=44 local utility u=0.425552 metrics={'f1_val': 0.5056149281028954, 'auprc': 0.5056149281028954, 'loss_val': 1.5818766075500317, 'psi': 0.5056149281028954}-{'f1_val': 0.43933568870997897, 'auprc': 0.43933568870997897, 'loss_val': 1.8364671593480213, 'psi': 0.43933568870997897}
[S4] not sending this round → trigger blocked (psi=0.357)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:59805
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] cosine check vs S17: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=-0.0823
[S4] DROPPED delta from S16 (cos=-0.0823 < 0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=44 metric=0.5056 head_norm=2.180720
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.364690e-02
[S17] stored merged vector for next round verification (round=44)
[S17] DEBUG after merge:  round=44 metric=0.5052 head_norm=2.176623 delta_norm=0.033647
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=2.038779 cos_to_last_merge=0.9955 (last merge round=27)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.24633682790754705, 'auprc': 0.24633682790754705, 'loss_val': 2.629734408437489, 'psi': 0.24633682790754702}-{'f1_val': 0.24642747623428396, 'auprc': 0.24642747623428396, 'loss_val': 2.6093603761236244, 'psi': 0.24642747623428396}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.978403 cos_to_last_merge=0.9980 (last merge round=30)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.239995141798749, 'auprc': 0.239995141798749, 'loss_val': 2.811602436631549, 'psi': 0.23999514179874903}-{'f1_val': 0.24154413989229748, 'auprc': 0.24154413989229748, 'loss_val': 2.7954067774466536, 'psi': 0.2415441398922975}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.022567 cos_to_last_merge=0.9464 (last merge round=23)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=45 local utility u=0.010712 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1086596734355276, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1300838559071364, 'psi': 0.3567939207526687}
[S5] START round=45 head_norm_before_train=2.172067 cos_to_last_merge=1.0000 (last merge round=43)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7356047994309374, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.696496078125805, 'psi': 0.3335071121394324}
[S6] START round=45 head_norm_before_train=1.817831 cos_to_last_merge=0.9107 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.911
[S6] round=45 local utility u=0.048942 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.068921093656381, 'psi': 0.021749084249084248}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.1310347212988745, 'psi': 0.017774699907663897}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=45 head_norm_before_train=1.707044 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9679191064109179, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9551700589808176, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=2.231658 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1561765117424785, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1376782342792024, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.616531 cos_to_last_merge=0.9580 (last merge round=23)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.591955832017787, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.575836865019058, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.286243 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.23369079535299375, 'auprc': 0.23369079535299375, 'loss_val': 1.3137411172288758, 'psi': 0.23369079535299375}-{'f1_val': 0.23405683598120386, 'auprc': 0.23405683598120386, 'loss_val': 1.3024933536895067, 'psi': 0.23405683598120386}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.962995 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.587458262208923, 'psi': 0.33185875048506014}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.567085140456632, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=2.051641 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.899695187807795, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8609239661073282, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.998126 cos_to_last_merge=0.9698 (last merge round=28)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.573076049603104, 'psi': 0.13413413413413414}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.529792946566911, 'psi': 0.1331327566754419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.341965 (no previous merge yet)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6161713758743649, 'auprc': 0.6161713758743649, 'loss_val': 0.6055143868134595, 'psi': 0.6161713758743649}-{'f1_val': 0.6160899759974897, 'auprc': 0.6160899759974897, 'loss_val': 0.6002325275839665, 'psi': 0.6160899759974897}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.945252 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.12522522522522522, 'auprc': 0.12522522522522522, 'loss_val': 4.708744967980578, 'psi': 0.12522522522522522}-{'f1_val': 0.20494111623143882, 'auprc': 0.20494111623143882, 'loss_val': 3.050815224255494, 'psi': 0.20494111623143882}
[S17] START round=45 head_norm_before_train=2.176623 cos_to_last_merge=1.0000 (last merge round=44)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.46914065571192703, 'auprc': 0.46914065571192703, 'loss_val': 1.7194966658455297, 'psi': 0.46914065571192703}-{'f1_val': 0.5056149281028954, 'auprc': 0.5056149281028954, 'loss_val': 1.5818766075500317, 'psi': 0.5056149281028954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:59816
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=0.259 → S4@127.0.0.1:59804
[S4] sending update (kind=head size=1790 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.3335 head_norm=2.181905
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.949444e-02
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.3335 head_norm=2.181225 delta_norm=0.019494
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.005 → S17@127.0.0.1:59817
[S17] ⇄ pheromone p=0.253 → S5@127.0.0.1:59805
[S16] RECEIVED delta(kind=head bytes=1790) from S4
[S16] cosine check vs S4: cos=-0.0823
[S16] DROPPED delta from S4 (cos=-0.0823 < 0.0)
[S4] ⇄ pheromone p=0.004 → S16@127.0.0.1:59816
[S2] START round=46 head_norm_before_train=2.046071 cos_to_last_merge=0.9953 (last merge round=27)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.24656357388316152, 'auprc': 0.24656357388316152, 'loss_val': 2.6493203479099896, 'psi': 0.24656357388316152}-{'f1_val': 0.24633682790754705, 'auprc': 0.24633682790754705, 'loss_val': 2.629734408437489, 'psi': 0.24633682790754702}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.984957 cos_to_last_merge=0.9978 (last merge round=30)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.23725705903923724, 'auprc': 0.23725705903923724, 'loss_val': 2.8848791331816583, 'psi': 0.23725705903923724}-{'f1_val': 0.239995141798749, 'auprc': 0.239995141798749, 'loss_val': 2.811602436631549, 'psi': 0.23999514179874903}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.037708 cos_to_last_merge=0.9450 (last merge round=23)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=46 local utility u=0.000196 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1082678260970011, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1086596734355276, 'psi': 0.3567939207526687}
[S5] START round=46 head_norm_before_train=2.181225 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.741529651758246, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7356047994309374, 'psi': 0.3335071121394324}
[S6] START round=46 head_norm_before_train=1.828280 cos_to_last_merge=0.9091 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.909
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 6.083429909221115, 'psi': 0.02109124254928932}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.068921093656381, 'psi': 0.021749084249084248}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.715138 (no previous merge yet)
[S7] round=46 local utility u=0.005535 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9568497327765841, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9679191064109179, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=46 head_norm_before_train=2.241920 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1688668068222263, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1561765117424785, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.624331 cos_to_last_merge=0.9571 (last merge round=23)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6065795046522364, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.591955832017787, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.295749 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.2322895847212969, 'auprc': 0.2322895847212969, 'loss_val': 1.322400243355388, 'psi': 0.2322895847212969}-{'f1_val': 0.23369079535299375, 'auprc': 0.23369079535299375, 'loss_val': 1.3137411172288758, 'psi': 0.23369079535299375}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.970594 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.6198587294797533, 'psi': 0.3319360347772085}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.587458262208923, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=2.065868 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.914546480013994, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.899695187807795, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.004756 cos_to_last_merge=0.9689 (last merge round=28)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.614569958299453, 'psi': 0.1351317597102535}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.573076049603104, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.351374 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6161713758743649, 'auprc': 0.6161713758743649, 'loss_val': 0.6091929442709665, 'psi': 0.6161713758743649}-{'f1_val': 0.6161713758743649, 'auprc': 0.6161713758743649, 'loss_val': 0.6055143868134595, 'psi': 0.6161713758743649}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.951456 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.004059415075191438, 'auprc': 0.004059415075191438, 'loss_val': 6.230534375191416, 'psi': 0.004059415075191438}-{'f1_val': 0.12522522522522522, 'auprc': 0.12522522522522522, 'loss_val': 4.708744967980578, 'psi': 0.12522522522522522}
[S17] START round=46 head_norm_before_train=2.188499 cos_to_last_merge=1.0000 (last merge round=44)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.4446942581258927, 'auprc': 0.4446942581258927, 'loss_val': 1.8646110502787199, 'psi': 0.4446942581258927}-{'f1_val': 0.46914065571192703, 'auprc': 0.46914065571192703, 'loss_val': 1.7194966658455297, 'psi': 0.46914065571192703}
[S4] not sending this round → trigger blocked (psi=0.357)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=2.053263 cos_to_last_merge=0.9950 (last merge round=27)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.2467907376696763, 'auprc': 0.2467907376696763, 'loss_val': 2.6670254547461894, 'psi': 0.2467907376696763}-{'f1_val': 0.24656357388316152, 'auprc': 0.24656357388316152, 'loss_val': 2.6493203479099896, 'psi': 0.24656357388316152}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.991429 cos_to_last_merge=0.9976 (last merge round=30)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.23256101328390485, 'auprc': 0.23256101328390485, 'loss_val': 2.925126173293988, 'psi': 0.23256101328390483}-{'f1_val': 0.23725705903923724, 'auprc': 0.23725705903923724, 'loss_val': 2.8848791331816583, 'psi': 0.23725705903923724}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.045018 cos_to_last_merge=0.9436 (last merge round=23)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1245110688127764, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1082678260970011, 'psi': 0.3567939207526687}
[S5] START round=47 head_norm_before_train=2.193059 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=47 local utility u=0.004412 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7327056756570136, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.741529651758246, 'psi': 0.3335071121394324}
[S6] START round=47 head_norm_before_train=1.837960 cos_to_last_merge=0.9077 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.908
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.242271649765756, 'psi': 0.017105871474803514}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 6.083429909221115, 'psi': 0.02109124254928932}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.720246 (no previous merge yet)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9188590195731144, 'psi': 0.23976608187134504}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9568497327765841, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.251302 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1842893580136615, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1688668068222263, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.631922 cos_to_last_merge=0.9561 (last merge round=23)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6181070336167953, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6065795046522364, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.305093 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.2316209034543844, 'auprc': 0.2316209034543844, 'loss_val': 1.3328467885899928, 'psi': 0.2316209034543844}-{'f1_val': 0.2322895847212969, 'auprc': 0.2322895847212969, 'loss_val': 1.322400243355388, 'psi': 0.2322895847212969}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.977834 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.6514239490188416, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.6198587294797533, 'psi': 0.3319360347772085}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=2.076263 (no previous merge yet)
[S13] round=47 local utility u=0.021828 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8708907171335907, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.914546480013994, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=47 head_norm_before_train=2.011152 cos_to_last_merge=0.9682 (last merge round=28)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 5.6558764123692065, 'psi': 0.1345336334083521}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.614569958299453, 'psi': 0.1351317597102535}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.360297 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6161713758743649, 'auprc': 0.6161713758743649, 'loss_val': 0.6146459545219123, 'psi': 0.6161713758743649}-{'f1_val': 0.6161713758743649, 'auprc': 0.6161713758743649, 'loss_val': 0.6091929442709665, 'psi': 0.6161713758743649}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.956380 (no previous merge yet)
[S16] round=47 local utility u=1.000000 metrics={'f1_val': 0.15064377682403432, 'auprc': 0.15064377682403432, 'loss_val': 4.261042296908281, 'psi': 0.15064377682403432}-{'f1_val': 0.004059415075191438, 'auprc': 0.004059415075191438, 'loss_val': 6.230534375191416, 'psi': 0.004059415075191438}
[S17] START round=47 head_norm_before_train=2.202266 cos_to_last_merge=1.0000 (last merge round=44)
[S17] round=47 local utility u=0.504244 metrics={'f1_val': 0.524413669655545, 'auprc': 0.524413669655545, 'loss_val': 1.5735984890789723, 'psi': 0.524413669655545}-{'f1_val': 0.4446942581258927, 'auprc': 0.4446942581258927, 'loss_val': 1.8646110502787199, 'psi': 0.4446942581258927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:59805
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:59817
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1794) from S16
[S4] cosine check vs S16: cos=-0.0817
[S4] DROPPED delta from S16 (cos=-0.0817 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] cosine check vs S17: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1798) from S5
[S17] cosine check vs S5: cos=0.9999
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=47 metric=0.3335 head_norm=2.204705
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.585811e-02
[S5] stored merged vector for next round verification (round=47)
[S5] DEBUG after merge:  round=47 metric=0.3335 head_norm=2.208430 delta_norm=0.015858
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=47 metric=0.5244 head_norm=2.212264
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.585812e-02
[S17] stored merged vector for next round verification (round=47)
[S17] DEBUG after merge:  round=47 metric=0.5232 head_norm=2.208430 delta_norm=0.015858
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=2.060178 cos_to_last_merge=0.9947 (last merge round=27)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.2467907376696763, 'auprc': 0.2467907376696763, 'loss_val': 2.6868316666111443, 'psi': 0.2467907376696763}-{'f1_val': 0.2467907376696763, 'auprc': 0.2467907376696763, 'loss_val': 2.6670254547461894, 'psi': 0.2467907376696763}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.996878 cos_to_last_merge=0.9974 (last merge round=30)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.22394552676376014, 'auprc': 0.22394552676376014, 'loss_val': 2.9446259487428104, 'psi': 0.22394552676376014}-{'f1_val': 0.23256101328390485, 'auprc': 0.23256101328390485, 'loss_val': 2.925126173293988, 'psi': 0.23256101328390483}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.060535 cos_to_last_merge=0.9420 (last merge round=23)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1323104531155828, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1245110688127764, 'psi': 0.3567939207526687}
[S5] START round=48 head_norm_before_train=2.208430 cos_to_last_merge=1.0000 (last merge round=47)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7342397974915187, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7327056756570136, 'psi': 0.3335071121394324}
[S6] START round=48 head_norm_before_train=1.847115 cos_to_last_merge=0.9063 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.906
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.316696440618878, 'psi': 0.02153000458085204}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.242271649765756, 'psi': 0.017105871474803514}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.724161 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.23877026137926907, 'auprc': 0.23877026137926907, 'loss_val': 0.9217664091883087, 'psi': 0.23877026137926907}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9188590195731144, 'psi': 0.23976608187134504}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.260304 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.2045660321487115, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1842893580136615, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.639229 cos_to_last_merge=0.9553 (last merge round=23)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.624788364350668, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6181070336167953, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.313773 (no previous merge yet)
[S10] round=48 local utility u=0.000393 metrics={'f1_val': 0.2322895847212969, 'auprc': 0.2322895847212969, 'loss_val': 1.3380784086333697, 'psi': 0.2322895847212969}-{'f1_val': 0.2316209034543844, 'auprc': 0.2316209034543844, 'loss_val': 1.3328467885899928, 'psi': 0.2316209034543844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=48 head_norm_before_train=1.984922 (no previous merge yet)
[S11] round=48 local utility u=0.002579 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.645570599655966, 'psi': 0.33185875048506014}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.6514239490188416, 'psi': 0.3319360347772085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=48 head_norm_before_train=2.085672 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9422579924884122, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8708907171335907, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.017384 cos_to_last_merge=0.9674 (last merge round=28)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 5.6980958757384235, 'psi': 0.13393415946927026}-{'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 5.6558764123692065, 'psi': 0.1345336334083521}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.369265 (no previous merge yet)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6162528155847986, 'auprc': 0.6162528155847986, 'loss_val': 0.6193006481109474, 'psi': 0.6162528155847986}-{'f1_val': 0.6161713758743649, 'auprc': 0.6161713758743649, 'loss_val': 0.6146459545219123, 'psi': 0.6161713758743649}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.960461 (no previous merge yet)
[S16] round=48 local utility u=0.483479 metrics={'f1_val': 0.18592562974810076, 'auprc': 0.18592562974810076, 'loss_val': 3.611621346660876, 'psi': 0.18592562974810076}-{'f1_val': 0.15064377682403432, 'auprc': 0.15064377682403432, 'loss_val': 4.261042296908281, 'psi': 0.15064377682403432}
[S17] START round=48 head_norm_before_train=2.208430 cos_to_last_merge=1.0000 (last merge round=47)
[S17] round=48 local utility u=0.233079 metrics={'f1_val': 0.5586601645610138, 'auprc': 0.5586601645610138, 'loss_val': 1.4156586047388091, 'psi': 0.5586601645610138}-{'f1_val': 0.524413669655545, 'auprc': 0.524413669655545, 'loss_val': 1.5735984890789723, 'psi': 0.524413669655545}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.559)
[S16] not sending this round → trigger blocked (psi=0.186)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=2.067029 cos_to_last_merge=0.9944 (last merge round=27)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.24692723697148478, 'auprc': 0.24692723697148478, 'loss_val': 2.703200982177739, 'psi': 0.24692723697148478}-{'f1_val': 0.2467907376696763, 'auprc': 0.2467907376696763, 'loss_val': 2.6868316666111443, 'psi': 0.2467907376696763}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.001672 cos_to_last_merge=0.9973 (last merge round=30)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.22352570167139704, 'auprc': 0.22352570167139704, 'loss_val': 2.9766163628048683, 'psi': 0.22352570167139704}-{'f1_val': 0.22394552676376014, 'auprc': 0.22394552676376014, 'loss_val': 2.9446259487428104, 'psi': 0.22394552676376014}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.075022 cos_to_last_merge=0.9406 (last merge round=23)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1419809860529588, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1323104531155828, 'psi': 0.3567939207526687}
[S5] START round=49 head_norm_before_train=2.217801 cos_to_last_merge=1.0000 (last merge round=47)
[S5] round=49 local utility u=0.000116 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7340076166809113, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7342397974915187, 'psi': 0.3335071121394324}
[S6] START round=49 head_norm_before_train=1.856000 cos_to_last_merge=0.9049 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.905
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.454871610535761, 'psi': 0.01732902033271719}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.316696440618878, 'psi': 0.02153000458085204}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.728471 (no previous merge yet)
[S7] round=49 local utility u=0.003087 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9238669011939096, 'psi': 0.23968964488212474}-{'f1_val': 0.23877026137926907, 'auprc': 0.23877026137926907, 'loss_val': 0.9217664091883087, 'psi': 0.23877026137926907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=49 head_norm_before_train=2.269811 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.223817902216596, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.2045660321487115, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.646211 cos_to_last_merge=0.9544 (last merge round=23)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6311817142436063, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.624788364350668, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.322216 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.23156962585787028, 'auprc': 0.23156962585787028, 'loss_val': 1.3420898207173193, 'psi': 0.23156962585787028}-{'f1_val': 0.2322895847212969, 'auprc': 0.2322895847212969, 'loss_val': 1.3380784086333697, 'psi': 0.2322895847212969}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.991908 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.6527824810890075, 'psi': 0.33185875048506014}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.645570599655966, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=2.090193 (no previous merge yet)
[S13] round=49 local utility u=0.010777 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9207029999481984, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9422579924884122, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=49 head_norm_before_train=2.023414 cos_to_last_merge=0.9667 (last merge round=28)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.736146391133501, 'psi': 0.1331327566754419}-{'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 5.6980958757384235, 'psi': 0.13393415946927026}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.377903 (no previous merge yet)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6160899759974897, 'auprc': 0.6160899759974897, 'loss_val': 0.6226874137493413, 'psi': 0.6160899759974897}-{'f1_val': 0.6162528155847986, 'auprc': 0.6162528155847986, 'loss_val': 0.6193006481109474, 'psi': 0.6162528155847986}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.965820 (no previous merge yet)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.03992329149232915, 'auprc': 0.03992329149232915, 'loss_val': 6.079592994388718, 'psi': 0.03992329149232915}-{'f1_val': 0.18592562974810076, 'auprc': 0.18592562974810076, 'loss_val': 3.611621346660876, 'psi': 0.18592562974810076}
[S17] START round=49 head_norm_before_train=2.216200 cos_to_last_merge=1.0000 (last merge round=47)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.543477299202265, 'auprc': 0.543477299202265, 'loss_val': 1.4965167251075213, 'psi': 0.543477299202265}-{'f1_val': 0.5586601645610138, 'auprc': 0.5586601645610138, 'loss_val': 1.4156586047388091, 'psi': 0.5586601645610138}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:59817
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S5
[S17] cosine check vs S5: cos=0.9999
[runner] rounds complete.
[runner] all agents stopped.
