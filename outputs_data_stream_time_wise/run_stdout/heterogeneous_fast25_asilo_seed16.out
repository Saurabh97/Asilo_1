[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:37103
[S3] → join 127.0.0.1:37102
[S4] → join 127.0.0.1:37102
[S5] → join 127.0.0.1:37102
[S6] → join 127.0.0.1:37102
[S7] → join 127.0.0.1:37102
[S8] → join 127.0.0.1:37102
[S9] → join 127.0.0.1:37102
[S10] → join 127.0.0.1:37102
[S11] → join 127.0.0.1:37102
[S13] → join 127.0.0.1:37102
[S14] → join 127.0.0.1:37102
[S15] → join 127.0.0.1:37102
[S16] → join 127.0.0.1:37102
[S17] → join 127.0.0.1:37102
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.142281 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.178164 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.140992 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.198671 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.183877 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.147191 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.177616 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.164137 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.181693 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.131308 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.184338 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.134690 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.168325 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.124212 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.170009 (no previous merge yet)
[S7]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3] + discovered S4
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S10
[S3] + discovered S17
[S3] + discovered S16
[S3] + discovered S14
[S3] + discovered S8
[S3] + discovered S11
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S9
[S3] + discovered S6
[S5] + discovered S3
[S5] + discovered S2
[S4] + discovered S10
[S5] + discovered S4
[S4] + discovered S17
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S14
[S4] + discovered S11
[S4] + discovered S7
[S4] + discovered S15
[S4] + discovered S5
[S4] + discovered S13
[S4] + discovered S9
[S4] + discovered S6
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S2
[S6] + discovered S3
[S5] + discovered S7
[S5] + discovered S9
[S5] + discovered S8
[S5] + discovered S16
[S5] + discovered S10
[S5] + discovered S6
[S5] + discovered S13
[S5] + discovered S15
[S5] + discovered S11
[S5] + discovered S14
[S5] + discovered S17
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S3
[S7] + discovered S2
[S7] + discovered S4
[S6] + discovered S17
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S15
[S6] + discovered S10
[S6] + discovered S8
[S6] + discovered S9
[S6] + discovered S14
[S6] + discovered S16
[S6] + discovered S7
[S7] + discovered S16
[S7] + discovered S14
[S7] + discovered S10
[S7] + discovered S9
[S7] + discovered S13
[S7] + discovered S17
[S7] + discovered S8
[S7] + discovered S15
[S7] + discovered S11
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S7
[S9] + discovered S8
[S9] + discovered S3
[S9] + discovered S6
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S2
[S8] + discovered S16
[S8] + discovered S17
[S8] + discovered S9
[S8] + discovered S11
[S8] + discovered S13
[S8] + discovered S10
[S8] + discovered S15
[S8] + discovered S14
[S10] + discovered S6
[S10] + discovered S5
[S10] + discovered S7
[S9] + discovered S17
[S9] + discovered S15
[S9] + discovered S13
[S9] + discovered S14
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S10
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S9
[S10] + discovered S4
[S10] + discovered S2
[S11] + discovered S8
[S11] + discovered S6
[S11] + discovered S2
[S11] + discovered S4
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S10
[S11] + discovered S7
[S11] + discovered S5
[S10] + discovered S16
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S15
[S10] + discovered S17
[S10] + discovered S11
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S13
[S11] + discovered S14
[S13] + discovered S5
[S13] + discovered S9
[S13] + discovered S10
[S13] + discovered S2
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S3
[S13] + discovered S7
[S14] + discovered S13
[S14] + discovered S4
[S14] + discovered S7
[S14] + discovered S8
[S14] + discovered S2
[S14] + discovered S10
[S14] + discovered S5
[S14] + discovered S3
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S9
[S13] + discovered S14
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S16
[S15] + discovered S4
[S15] + discovered S6
[S15] + discovered S3
[S15] + discovered S5
[S15] + discovered S2
[S15] + discovered S7
[S15] + discovered S13
[S15] + discovered S9
[S15] + discovered S11
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S14
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S16] + discovered S14
[S16] + discovered S8
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S7
[S16] + discovered S2
[S16] + discovered S3
[S16] + discovered S4
[S16] + discovered S13
[S16] + discovered S15
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S6
[S15] + discovered S17
[S15] + discovered S16
[S17] + discovered S16
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S9
[S17] + discovered S8
[S17] + discovered S6
[S17] + discovered S5
[S17] + discovered S15
[S17] + discovered S3
[S17] + discovered S7
[S17] + discovered S10
[S17] + discovered S14
[S16] + discovered S17
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:37102
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:37104
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:37116
[S14] ⇄ pheromone p=1.000 → S4@127.0.0.1:37104
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:37110
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:37114
[S9] ⇄ pheromone p=1.000 → S13@127.0.0.1:37113
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:37112
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:37114
[S15] ⇄ pheromone p=1.000 → S16@127.0.0.1:37116
[S2] ⇄ pheromone p=1.000 → S16@127.0.0.1:37116
[S4] ⇄ pheromone p=1.000 → S9@127.0.0.1:37110
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:37117
[S7] ⇄ pheromone p=1.000 → S10@127.0.0.1:37111
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:37110
[S2] START round=1 head_norm_before_train=1.144194 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5049347062302403, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4230481183007553, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.199797 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7483736683829831, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.506230702380796, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.148145 (no previous merge yet)
[S4] round=1 local utility u=0.115988 metrics={'f1_val': 0.3329127234490011, 'auprc': 0.3329127234490011, 'loss_val': 1.3332816967873669, 'psi': 0.3329127234490011}-{'f1_val': 0.3049814836239043, 'auprc': 0.3049814836239043, 'loss_val': 1.3138770417192807, 'psi': 0.3049814836239043}
[S5] START round=1 head_norm_before_train=1.214237 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.649335104168651, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5184939053170223, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.190169 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.532461745969511, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4538166378609092, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.158755 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5956489720455231, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4677544337472703, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.178943 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4102686704457403, 'psi': 0.0}-{'f1_val': 0.09339389592796239, 'auprc': 0.09339389592796239, 'loss_val': 1.3699410863497803, 'psi': 0.09339389592796239}
[S9] START round=1 head_norm_before_train=1.185182 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.945428633907693, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5599587076655625, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.187480 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.511046735136136, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4537214712321818, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.140536 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5993585666663166, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5075175947125452, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.190697 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4935258221727756, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4612830649422797, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.131018 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4421802603767497, 'psi': 0.0}-{'f1_val': 0.25492662473794553, 'auprc': 0.25492662473794553, 'loss_val': 1.3599499343185293, 'psi': 0.25492662473794553}
[S15] START round=1 head_norm_before_train=1.170582 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4683004055740687, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4278114401045496, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.132722 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4801860323872182, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4059331077245405, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.175213 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5021454687709008, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4599987405393589, 'psi': 0.0}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:37116
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1790 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1790) from S4
[S16] cosine check vs S4: cos=-0.0433
[S16] DROPPED delta from S4 (cos=-0.0433 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.160177 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6607060779597913, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5049347062302403, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.252589 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.713327300302286, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7483736683829831, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.164080 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.33301777637530244, 'auprc': 0.33301777637530244, 'loss_val': 1.3700947474282725, 'psi': 0.33301777637530244}-{'f1_val': 0.3329127234490011, 'auprc': 0.3329127234490011, 'loss_val': 1.3332816967873669, 'psi': 0.3329127234490011}
[S5] START round=2 head_norm_before_train=1.253803 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.098244712000912, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.649335104168651, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.209498 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6879109388920333, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.532461745969511, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.195952 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.100390990685658, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5956489720455231, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.191988 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4991097915520157, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4102686704457403, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.236912 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.767750096872937, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.945428633907693, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.204166 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.610624625076687, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.511046735136136, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.160950 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7874581183968459, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5993585666663166, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.203829 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5533071580588862, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4935258221727756, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.139265 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6010885093080458, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4421802603767497, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.182331 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5216925378108346, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4683004055740687, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.154462 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6131354264690685, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4801860323872182, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.188484 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5648096129111468, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5021454687709008, 'psi': 0.0}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.191964 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0178522140612043, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6607060779597913, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.324715 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7338477221749877, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.713327300302286, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.189589 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.3332280812546048, 'auprc': 0.3332280812546048, 'loss_val': 1.4567279640800783, 'psi': 0.3332280812546048}-{'f1_val': 0.33301777637530244, 'auprc': 0.33301777637530244, 'loss_val': 1.3700947474282725, 'psi': 0.33301777637530244}
[S5] START round=3 head_norm_before_train=1.302568 (no previous merge yet)
[S5] round=3 local utility u=0.576363 metrics={'f1_val': 0.0906113537117904, 'auprc': 0.0906113537117904, 'loss_val': 1.761020580347613, 'psi': 0.0906113537117904}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.098244712000912, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.240844 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.11957674884483, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6879109388920333, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.243947 (no previous merge yet)
[S7] round=3 local utility u=0.110262 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8798660984135243, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.100390990685658, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.215000 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6981824391756193, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4991097915520157, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.297994 (no previous merge yet)
[S9] round=3 local utility u=0.084719 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5983111545910367, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.767750096872937, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.231367 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.809082293232507, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.610624625076687, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.191183 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2790558031130392, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7874581183968459, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.221997 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7272192943011302, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5533071580588862, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.159904 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9913172523339824, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6010885093080458, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.202489 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6851494043183466, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5216925378108346, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.188608 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9720961475335055, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6131354264690685, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.212370 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.70214710774612, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5648096129111468, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.091)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.230263 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7373715936362792, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0178522140612043, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.375031 (no previous merge yet)
[S3] round=4 local utility u=0.078111 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.577625006922313, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7338477221749877, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.221620 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.3332280812546048, 'auprc': 0.3332280812546048, 'loss_val': 1.5598467631409854, 'psi': 0.3332280812546048}-{'f1_val': 0.3332280812546048, 'auprc': 0.3332280812546048, 'loss_val': 1.4567279640800783, 'psi': 0.3332280812546048}
[S5] START round=4 head_norm_before_train=1.297858 (no previous merge yet)
[S5] round=4 local utility u=0.881064 metrics={'f1_val': 0.27724477244772444, 'auprc': 0.27724477244772444, 'loss_val': 1.6785924118611515, 'psi': 0.27724477244772444}-{'f1_val': 0.0906113537117904, 'auprc': 0.0906113537117904, 'loss_val': 1.761020580347613, 'psi': 0.0906113537117904}
[S6] START round=4 head_norm_before_train=1.281883 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7878540079402843, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.11957674884483, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.246441 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8825283135060242, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8798660984135243, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.241264 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.800448738165129, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6981824391756193, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.351774 (no previous merge yet)
[S9] round=4 local utility u=0.139623 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.31906453223363, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5983111545910367, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.263586 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8203233298446106, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.809082293232507, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.226978 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9728301742563112, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2790558031130392, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.247060 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.944506308014829, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7272192943011302, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.190678 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8327863022904993, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9913172523339824, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.230654 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9651581232484425, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6851494043183466, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.234591 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7791402472930997, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9720961475335055, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.246657 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9773121186773273, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.70214710774612, 'psi': 0.0}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:37110
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.1216
[S9] DROPPED delta from S5 (cos=-0.1216 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.268115 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7782233909674225, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7373715936362792, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.425312 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7208746592031283, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.577625006922313, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.248747 (no previous merge yet)
[S4] round=5 local utility u=0.018397 metrics={'f1_val': 0.3329127234490011, 'auprc': 0.3329127234490011, 'loss_val': 1.520214856938998, 'psi': 0.3329127234490011}-{'f1_val': 0.3332280812546048, 'auprc': 0.3332280812546048, 'loss_val': 1.5598467631409854, 'psi': 0.3332280812546048}
[S5] START round=5 head_norm_before_train=1.310565 (no previous merge yet)
[S5] round=5 local utility u=0.155076 metrics={'f1_val': 0.3063616706498236, 'auprc': 0.3063616706498236, 'loss_val': 1.6304932815739812, 'psi': 0.3063616706498236}-{'f1_val': 0.27724477244772444, 'auprc': 0.27724477244772444, 'loss_val': 1.6785924118611515, 'psi': 0.27724477244772444}
[S6] START round=5 head_norm_before_train=1.320570 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.914757398414717, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7878540079402843, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.266041 (no previous merge yet)
[S7] round=5 local utility u=0.087356 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.707816497485598, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8825283135060242, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.262528 (no previous merge yet)
[S8] round=5 local utility u=0.097253 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6059434555936898, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.800448738165129, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.412865 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.744811092483964, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.31906453223363, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.276919 (no previous merge yet)
[S10] round=5 local utility u=0.017099 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.786126050200509, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8203233298446106, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.258788 (no previous merge yet)
[S11] round=5 local utility u=0.205033 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.562764790407929, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9728301742563112, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.264652 (no previous merge yet)
[S13] round=5 local utility u=0.085615 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7732758688814456, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.944506308014829, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.224844 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.237420811037727, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8327863022904993, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.254399 (no previous merge yet)
[S15] round=5 local utility u=0.062420 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8403187057935158, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9651581232484425, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.283195 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0933724620715433, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7791402472930997, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.280294 (no previous merge yet)
[S17] round=5 local utility u=0.105725 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.76586179000253, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9773121186773273, 'psi': 0.0}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:37110
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] cosine check vs S4: cos=-0.0631
[S9] DROPPED delta from S4 (cos=-0.0631 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1791) from S5
[S9] cosine check vs S5: cos=-0.1289
[S9] DROPPED delta from S5 (cos=-0.1289 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S9] ⇄ pheromone p=0.361 → S13@127.0.0.1:37113
[S14] ⇄ pheromone p=0.328 → S4@127.0.0.1:37104
[S3] ⇄ pheromone p=0.340 → S4@127.0.0.1:37104
[S13] ⇄ pheromone p=0.345 → S16@127.0.0.1:37116
[S10] ⇄ pheromone p=0.331 → S14@127.0.0.1:37114
[S6] ⇄ pheromone p=0.328 → S11@127.0.0.1:37112
[S11] ⇄ pheromone p=0.369 → S14@127.0.0.1:37114
[S8] ⇄ pheromone p=0.347 → S17@127.0.0.1:37117
[S2] ⇄ pheromone p=0.328 → S8@127.0.0.1:37109
[S15] ⇄ pheromone p=0.340 → S16@127.0.0.1:37116
[S7] ⇄ pheromone p=0.359 → S10@127.0.0.1:37111
[S4] ⇄ pheromone p=0.341 → S9@127.0.0.1:37110
[S5] ⇄ pheromone p=0.573 → S9@127.0.0.1:37110
[S17] ⇄ pheromone p=0.349 → S9@127.0.0.1:37110
[S16] ⇄ pheromone p=0.328 → S8@127.0.0.1:37109
[S2] START round=6 head_norm_before_train=1.291088 (no previous merge yet)
[S2] round=6 local utility u=0.057662 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6629002182612096, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7782233909674225, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.471760 (no previous merge yet)
[S3] round=6 local utility u=0.267383 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.186109614515773, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7208746592031283, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.269168 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.32145395471621485, 'auprc': 0.32145395471621485, 'loss_val': 1.4606575262390942, 'psi': 0.32145395471621485}-{'f1_val': 0.3329127234490011, 'auprc': 0.3329127234490011, 'loss_val': 1.520214856938998, 'psi': 0.3329127234490011}
[S5] START round=6 head_norm_before_train=1.337824 (no previous merge yet)
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.21406355645706557, 'auprc': 0.21406355645706557, 'loss_val': 1.4240032697107023, 'psi': 0.21406355645706557}-{'f1_val': 0.3063616706498236, 'auprc': 0.3063616706498236, 'loss_val': 1.6304932815739812, 'psi': 0.3063616706498236}
[S6] START round=6 head_norm_before_train=1.352872 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0621480040924336, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.914757398414717, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.288093 (no previous merge yet)
[S7] round=6 local utility u=0.071302 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5652116886241787, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.707816497485598, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.274900 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.23206937095825986, 'auprc': 0.23206937095825986, 'loss_val': 1.4282889327896267, 'psi': 0.23206937095825986}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6059434555936898, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.476224 (no previous merge yet)
[S9] round=6 local utility u=0.936486 metrics={'f1_val': 0.13750277223331117, 'auprc': 0.13750277223331117, 'loss_val': 2.1093639277339853, 'psi': 0.13750277223331117}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.744811092483964, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.290129 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8194740205840998, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.786126050200509, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.271419 (no previous merge yet)
[S11] round=6 local utility u=0.176437 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.209891250134029, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.562764790407929, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.266427 (no previous merge yet)
[S13] round=6 local utility u=0.060522 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6522322522068027, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7732758688814456, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.245101 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2494600363367216, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.237420811037727, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.262349 (no previous merge yet)
[S15] round=6 local utility u=0.041505 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7573081539621433, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8403187057935158, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.316823 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.217414113713949, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0933724620715433, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.291999 (no previous merge yet)
[S17] round=6 local utility u=0.083999 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5978640230156136, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.76586179000253, 'psi': 0.0}
[S2] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:37117
[S3] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.138)
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=-0.0476
[S17] DROPPED delta from S8 (cos=-0.0476 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=7 head_norm_before_train=1.316393 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9908521115014524, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6629002182612096, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.500424 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3071867500465406, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.186109614515773, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.298263 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.24227119681665135, 'auprc': 0.24227119681665135, 'loss_val': 1.3843654183713838, 'psi': 0.24227119681665132}-{'f1_val': 0.32145395471621485, 'auprc': 0.32145395471621485, 'loss_val': 1.4606575262390942, 'psi': 0.32145395471621485}
[S5] START round=7 head_norm_before_train=1.358025 (no previous merge yet)
[S5] round=7 local utility u=0.470738 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.3021003763228787, 'psi': 0.3051272166538165}-{'f1_val': 0.21406355645706557, 'auprc': 0.21406355645706557, 'loss_val': 1.4240032697107023, 'psi': 0.21406355645706557}
[S6] START round=7 head_norm_before_train=1.388386 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.191428315779867, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0621480040924336, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.319159 (no previous merge yet)
[S7] round=7 local utility u=0.082804 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3996032832638012, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5652116886241787, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.289831 (no previous merge yet)
[S8] round=7 local utility u=0.017498 metrics={'f1_val': 0.22839372242713532, 'auprc': 0.22839372242713532, 'loss_val': 1.3602117511113871, 'psi': 0.22839372242713532}-{'f1_val': 0.23206937095825986, 'auprc': 0.23206937095825986, 'loss_val': 1.4282889327896267, 'psi': 0.23206937095825986}
[S9] START round=7 head_norm_before_train=1.530730 (no previous merge yet)
[S9] round=7 local utility u=0.390416 metrics={'f1_val': 0.22894881673087508, 'auprc': 0.22894881673087508, 'loss_val': 2.151545959208894, 'psi': 0.22894881673087508}-{'f1_val': 0.13750277223331117, 'auprc': 0.13750277223331117, 'loss_val': 2.1093639277339853, 'psi': 0.13750277223331117}
[S10] START round=7 head_norm_before_train=1.310895 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9674095458506458, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8194740205840998, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.289020 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3336556193822653, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.209891250134029, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.270300 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6610445850860525, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6522322522068027, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.258203 (no previous merge yet)
[S14] round=7 local utility u=0.065486 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1184879702434225, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2494600363367216, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.277196 (no previous merge yet)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8501159907993379, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7573081539621433, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.348666 (no previous merge yet)
[S16] round=7 local utility u=0.004593 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2082278652461484, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.217414113713949, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.309080 (no previous merge yet)
[S17] round=7 local utility u=0.178761 metrics={'f1_val': 0.02944111776447106, 'auprc': 0.02944111776447106, 'loss_val': 1.505312314997314, 'psi': 0.02944111776447106}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5978640230156136, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:37113
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[S7] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:37117
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=-0.1361
[S9] DROPPED delta from S5 (cos=-0.1361 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=-0.0471
[S17] DROPPED delta from S8 (cos=-0.0471 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] cosine check vs S9: cos=0.0351
[S17] not sending this round → trigger blocked (psi=0.029)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.0000 head_norm=1.285144
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.003782e+00
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.038846 delta_norm=1.003782
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.347137 (no previous merge yet)
[S2] round=8 local utility u=0.168310 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.654231288046736, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9908521115014524, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.534179 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4188922309052727, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3071867500465406, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.331096 (no previous merge yet)
[S4] round=8 local utility u=0.398234 metrics={'f1_val': 0.32723381487426434, 'auprc': 0.32723381487426434, 'loss_val': 1.352561959128716, 'psi': 0.32723381487426434}-{'f1_val': 0.24227119681665135, 'auprc': 0.24227119681665135, 'loss_val': 1.3843654183713838, 'psi': 0.24227119681665132}
[S5] START round=8 head_norm_before_train=1.392618 (no previous merge yet)
[S5] round=8 local utility u=1.000000 metrics={'f1_val': 0.9246630172686949, 'auprc': 0.9246630172686949, 'loss_val': 1.2174126158796732, 'psi': 0.9246630172686949}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.3021003763228787, 'psi': 0.3051272166538165}
[S6] START round=8 head_norm_before_train=1.425122 (no previous merge yet)
[S6] round=8 local utility u=0.098292 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9948435046969872, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.191428315779867, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.345449 (no previous merge yet)
[S7] round=8 local utility u=0.026298 metrics={'f1_val': 0.0017352503718393653, 'auprc': 0.0017352503718393653, 'loss_val': 1.362624305752039, 'psi': 0.0017352503718393653}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3996032832638012, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.316121 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.2051981806367771, 'auprc': 0.2051981806367771, 'loss_val': 1.2446237049177469, 'psi': 0.2051981806367771}-{'f1_val': 0.22839372242713532, 'auprc': 0.22839372242713532, 'loss_val': 1.3602117511113871, 'psi': 0.22839372242713532}
[S9] START round=8 head_norm_before_train=1.588070 (no previous merge yet)
[S9] round=8 local utility u=0.613677 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1816978420556663, 'psi': 0.36867172340800847}-{'f1_val': 0.22894881673087508, 'auprc': 0.22894881673087508, 'loss_val': 2.151545959208894, 'psi': 0.22894881673087508}
[S10] START round=8 head_norm_before_train=1.338515 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.04911871766652, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9674095458506458, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.317150 (no previous merge yet)
[S11] round=8 local utility u=0.072261 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.189134526378594, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3336556193822653, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.038846 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.026190 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.608664349102597, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6610445850860525, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.270466 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.14836669387319, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1184879702434225, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.305691 (no previous merge yet)
[S15] round=8 local utility u=0.140720 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.568675958982314, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8501159907993379, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.380779 (no previous merge yet)
[S16] round=8 local utility u=0.028730 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.150766870215723, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2082278652461484, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.337148 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.0056179775280898875, 'auprc': 0.0056179775280898875, 'loss_val': 1.425901132821382, 'psi': 0.0056179775280898875}-{'f1_val': 0.02944111776447106, 'auprc': 0.02944111776447106, 'loss_val': 1.505312314997314, 'psi': 0.02944111776447106}
[S2] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:37113
[S6] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.002)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:37110
[S16] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S4] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S9
[S13] cosine check vs S9: cos=0.7704
[S9] RECEIVED delta(kind=head bytes=1804) from S4
[S9] cosine check vs S4: cos=-0.0599
[S9] DROPPED delta from S4 (cos=-0.0599 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.1374
[S9] DROPPED delta from S5 (cos=-0.1374 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.0000 head_norm=1.057356
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.324857e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.272307 delta_norm=0.532486
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.378878 (no previous merge yet)
[S2] round=9 local utility u=0.098428 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4573751261986407, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.654231288046736, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.569764 (no previous merge yet)
[S3] round=9 local utility u=0.054665 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3095628952911023, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4188922309052727, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.365815 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3635058031996656, 'psi': 0.0}-{'f1_val': 0.32723381487426434, 'auprc': 0.32723381487426434, 'loss_val': 1.352561959128716, 'psi': 0.32723381487426434}
[S5] START round=9 head_norm_before_train=1.440373 (no previous merge yet)
[S5] round=9 local utility u=0.359207 metrics={'f1_val': 0.9997184513402302, 'auprc': 0.9997184513402302, 'loss_val': 1.1744968847933042, 'psi': 0.9997184513402302}-{'f1_val': 0.9246630172686949, 'auprc': 0.9246630172686949, 'loss_val': 1.2174126158796732, 'psi': 0.9246630172686949}
[S6] START round=9 head_norm_before_train=1.462708 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.229853316696951, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9948435046969872, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.382723 (no previous merge yet)
[S7] round=9 local utility u=1.000000 metrics={'f1_val': 0.3330843913368185, 'auprc': 0.3330843913368185, 'loss_val': 1.2912888962651101, 'psi': 0.3330843913368185}-{'f1_val': 0.0017352503718393653, 'auprc': 0.0017352503718393653, 'loss_val': 1.362624305752039, 'psi': 0.0017352503718393653}
[S8] START round=9 head_norm_before_train=1.342962 (no previous merge yet)
[S8] round=9 local utility u=0.020508 metrics={'f1_val': 0.2036893704850361, 'auprc': 0.2036893704850361, 'loss_val': 1.190027728592588, 'psi': 0.2036893704850361}-{'f1_val': 0.2051981806367771, 'auprc': 0.2051981806367771, 'loss_val': 1.2446237049177469, 'psi': 0.2051981806367771}
[S9] START round=9 head_norm_before_train=1.639087 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.39549176701023, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1816978420556663, 'psi': 0.36867172340800847}
[S10] START round=9 head_norm_before_train=1.366796 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4678366673692156, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.04911871766652, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.348850 (no previous merge yet)
[S11] round=9 local utility u=1.000000 metrics={'f1_val': 0.20227642276422764, 'auprc': 0.20227642276422764, 'loss_val': 1.7417366371060932, 'psi': 0.20227642276422764}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.189134526378594, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.272307 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6663291003150573, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.608664349102597, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.287164 (no previous merge yet)
[S14] round=9 local utility u=0.021534 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.105299498692052, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.14836669387319, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.333658 (no previous merge yet)
[S15] round=9 local utility u=0.060354 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4479681237060626, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.568675958982314, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.407323 (no previous merge yet)
[S16] round=9 local utility u=0.108903 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.932960653953253, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.150766870215723, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.367640 (no previous merge yet)
[S17] round=9 local utility u=0.265491 metrics={'f1_val': 0.058931860036832415, 'auprc': 0.058931860036832415, 'loss_val': 1.374744950954842, 'psi': 0.058931860036832415}-{'f1_val': 0.0056179775280898875, 'auprc': 0.0056179775280898875, 'loss_val': 1.425901132821382, 'psi': 0.0056179775280898875}
[S16] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S2] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:37117
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:37111
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=-0.0054
[S14] DROPPED delta from S11 (cos=-0.0054 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] cosine check vs S8: cos=-0.0496
[S17] DROPPED delta from S8 (cos=-0.0496 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=-0.1381
[S9] DROPPED delta from S5 (cos=-0.1381 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=-0.0114
[S10] DROPPED delta from S7 (cos=-0.0114 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.059)
[S2] START round=10 head_norm_before_train=1.413794 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.161536259793913, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4573751261986407, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.600204 (no previous merge yet)
[S3] round=10 local utility u=0.425996 metrics={'f1_val': 0.10031783869686134, 'auprc': 0.10031783869686134, 'loss_val': 2.3604307209284645, 'psi': 0.10031783869686134}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3095628952911023, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.402777 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4100298288179047, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3635058031996656, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.488270 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.6641464877893855, 'auprc': 0.6641464877893855, 'loss_val': 1.1480872171143948, 'psi': 0.6641464877893855}-{'f1_val': 0.9997184513402302, 'auprc': 0.9997184513402302, 'loss_val': 1.1744968847933042, 'psi': 0.9997184513402302}
[S6] START round=10 head_norm_before_train=1.500591 (no previous merge yet)
[S6] round=10 local utility u=0.642538 metrics={'f1_val': 0.06094997898276587, 'auprc': 0.06094997898276587, 'loss_val': 3.493326724534662, 'psi': 0.06094997898276587}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.229853316696951, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.412603 (no previous merge yet)
[S7] round=10 local utility u=0.032967 metrics={'f1_val': 0.3332503939620138, 'auprc': 0.3332503939620138, 'loss_val': 1.226848921977505, 'psi': 0.3332503939620138}-{'f1_val': 0.3330843913368185, 'auprc': 0.3330843913368185, 'loss_val': 1.2912888962651101, 'psi': 0.3330843913368185}
[S8] START round=10 head_norm_before_train=1.375023 (no previous merge yet)
[S8] round=10 local utility u=0.011074 metrics={'f1_val': 0.20341384863123993, 'auprc': 0.20341384863123993, 'loss_val': 1.165399649004037, 'psi': 0.20341384863123993}-{'f1_val': 0.2036893704850361, 'auprc': 0.2036893704850361, 'loss_val': 1.190027728592588, 'psi': 0.2036893704850361}
[S9] START round=10 head_norm_before_train=1.680566 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.476172742526213, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.39549176701023, 'psi': 0.36867172340800847}
[S10] START round=10 head_norm_before_train=1.401902 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.804800519554385, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4678366673692156, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.383792 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.18737407656145064, 'auprc': 0.18737407656145064, 'loss_val': 2.042076526941608, 'psi': 0.18737407656145064}-{'f1_val': 0.20227642276422764, 'auprc': 0.20227642276422764, 'loss_val': 1.7417366371060932, 'psi': 0.20227642276422764}
[S13] START round=10 head_norm_before_train=1.283174 cos_to_last_merge=0.9977 (last merge round=8)
[S13] round=10 local utility u=0.005878 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6545727726091615, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6663291003150573, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.306957 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5835352162225393, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.105299498692052, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.371901 (no previous merge yet)
[S15] round=10 local utility u=0.670716 metrics={'f1_val': 0.1397903145282077, 'auprc': 0.1397903145282077, 'loss_val': 1.36464809721797, 'psi': 0.1397903145282077}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4479681237060626, 'psi': 0.0}
[S16] START round=10 head_norm_before_train=1.429543 (no previous merge yet)
[S16] round=10 local utility u=0.055650 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8216602906979578, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.932960653953253, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.397461 (no previous merge yet)
[S17] round=10 local utility u=0.694317 metrics={'f1_val': 0.21079484425349088, 'auprc': 0.21079484425349088, 'loss_val': 1.3528775317483304, 'psi': 0.21079484425349088}-{'f1_val': 0.058931860036832415, 'auprc': 0.058931860036832415, 'loss_val': 1.374744950954842, 'psi': 0.058931860036832415}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.100)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:37111
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.061)
[S16] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.140)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:37117
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] cosine check vs S7: cos=-0.0088
[S10] DROPPED delta from S7 (cos=-0.0088 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=-0.0518
[S17] DROPPED delta from S8 (cos=-0.0518 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=-0.0316
[S9] DROPPED delta from S17 (cos=-0.0316 < 0.0)
[S9] ⇄ pheromone p=0.313 → S13@127.0.0.1:37113
[S10] ⇄ pheromone p=0.108 → S14@127.0.0.1:37114
[S6] ⇄ pheromone p=0.248 → S11@127.0.0.1:37112
[S15] ⇄ pheromone p=0.277 → S16@127.0.0.1:37116
[S3] ⇄ pheromone p=0.227 → S4@127.0.0.1:37104
[S13] ⇄ pheromone p=0.122 → S16@127.0.0.1:37116
[S2] ⇄ pheromone p=0.149 → S8@127.0.0.1:37109
[S4] ⇄ pheromone p=0.163 → S9@127.0.0.1:37110
[S5] ⇄ pheromone p=0.422 → S9@127.0.0.1:37110
[S11] ⇄ pheromone p=0.305 → S14@127.0.0.1:37114
[S14] ⇄ pheromone p=0.118 → S4@127.0.0.1:37104
[S8] ⇄ pheromone p=0.203 → S17@127.0.0.1:37117
[S7] ⇄ pheromone p=0.302 → S10@127.0.0.1:37111
[S17] ⇄ pheromone p=0.321 → S9@127.0.0.1:37110
[S16] ⇄ pheromone p=0.140 → S8@127.0.0.1:37109
[S2] START round=11 head_norm_before_train=1.450104 (no previous merge yet)
[S2] round=11 local utility u=0.343128 metrics={'f1_val': 0.07272727272727272, 'auprc': 0.07272727272727272, 'loss_val': 3.1298253714258433, 'psi': 0.07272727272727272}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.161536259793913, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.623801 (no previous merge yet)
[S3] round=11 local utility u=0.919028 metrics={'f1_val': 0.2802618749129405, 'auprc': 0.2802618749129405, 'loss_val': 2.1418702298579495, 'psi': 0.2802618749129405}-{'f1_val': 0.10031783869686134, 'auprc': 0.10031783869686134, 'loss_val': 2.3604307209284645, 'psi': 0.10031783869686134}
[S4] START round=11 head_norm_before_train=1.440004 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4392943913513565, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4100298288179047, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.535231 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.33493014743065364, 'auprc': 0.33493014743065364, 'loss_val': 1.2998669384720083, 'psi': 0.33493014743065364}-{'f1_val': 0.6641464877893855, 'auprc': 0.6641464877893855, 'loss_val': 1.1480872171143948, 'psi': 0.6641464877893855}
[S6] START round=11 head_norm_before_train=1.530870 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.128345370208709, 'psi': 0.0}-{'f1_val': 0.06094997898276587, 'auprc': 0.06094997898276587, 'loss_val': 3.493326724534662, 'psi': 0.06094997898276587}
[S7] START round=11 head_norm_before_train=1.451489 (no previous merge yet)
[S7] round=11 local utility u=0.038062 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.149234441195382, 'psi': 0.33308476261496395}-{'f1_val': 0.3332503939620138, 'auprc': 0.3332503939620138, 'loss_val': 1.226848921977505, 'psi': 0.3332503939620138}
[S8] START round=11 head_norm_before_train=1.406191 (no previous merge yet)
[S8] round=11 local utility u=0.468015 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1442017992204985, 'psi': 0.30506182380216385}-{'f1_val': 0.20341384863123993, 'auprc': 0.20341384863123993, 'loss_val': 1.165399649004037, 'psi': 0.20341384863123993}
[S9] START round=11 head_norm_before_train=1.713254 (no previous merge yet)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.518565265124699, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.476172742526213, 'psi': 0.36867172340800847}
[S10] START round=11 head_norm_before_train=1.439100 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0064968416298528, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.804800519554385, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.422307 (no previous merge yet)
[S11] round=11 local utility u=0.384432 metrics={'f1_val': 0.2791202823784958, 'auprc': 0.2791202823784958, 'loss_val': 2.098928418469792, 'psi': 0.2791202823784958}-{'f1_val': 0.18737407656145064, 'auprc': 0.18737407656145064, 'loss_val': 2.042076526941608, 'psi': 0.18737407656145064}
[S13] START round=11 head_norm_before_train=1.295564 cos_to_last_merge=0.9929 (last merge round=8)
[S13] round=11 local utility u=0.103955 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4466626491379555, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6545727726091615, 'psi': 0.0}
[S14] START round=11 head_norm_before_train=1.330958 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.839507453078488, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5835352162225393, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.409748 (no previous merge yet)
[S15] round=11 local utility u=0.054265 metrics={'f1_val': 0.15111545350920044, 'auprc': 0.15111545350920044, 'loss_val': 1.3580442312760947, 'psi': 0.15111545350920044}-{'f1_val': 0.1397903145282077, 'auprc': 0.1397903145282077, 'loss_val': 1.36464809721797, 'psi': 0.1397903145282077}
[S16] START round=11 head_norm_before_train=1.451677 (no previous merge yet)
[S16] round=11 local utility u=0.093385 metrics={'f1_val': 0.00046253469010175765, 'auprc': 0.00046253469010175765, 'loss_val': 2.6390538941403774, 'psi': 0.00046253469010175765}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8216602906979578, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.424178 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.20767195767195767, 'auprc': 0.20767195767195767, 'loss_val': 1.3526387541038891, 'psi': 0.20767195767195767}-{'f1_val': 0.21079484425349088, 'auprc': 0.21079484425349088, 'loss_val': 1.3528775317483304, 'psi': 0.21079484425349088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:37117
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:37114
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:37111
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.073)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.151)
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:37104
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S3] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=-0.0534
[S17] DROPPED delta from S8 (cos=-0.0534 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S11
[S14] cosine check vs S11: cos=0.0032
[S10] RECEIVED delta(kind=head bytes=1803) from S7
[S10] cosine check vs S7: cos=-0.0066
[S10] DROPPED delta from S7 (cos=-0.0066 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1806) from S3
[S4] cosine check vs S3: cos=0.0639
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.0000 head_norm=1.473446
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.071024e+00
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.141363 delta_norm=1.071024
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.0000 head_norm=1.358389
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.960826e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.0000 head_norm=0.999288 delta_norm=0.996083
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.485568 (no previous merge yet)
[S2] round=12 local utility u=0.673788 metrics={'f1_val': 0.15123456790123457, 'auprc': 0.15123456790123457, 'loss_val': 2.48881439561623, 'psi': 0.15123456790123457}-{'f1_val': 0.07272727272727272, 'auprc': 0.07272727272727272, 'loss_val': 3.1298253714258433, 'psi': 0.07272727272727272}
[S3] START round=12 head_norm_before_train=1.651835 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.22371364653243847, 'auprc': 0.22371364653243847, 'loss_val': 2.4239765340030908, 'psi': 0.22371364653243847}-{'f1_val': 0.2802618749129405, 'auprc': 0.2802618749129405, 'loss_val': 2.1418702298579495, 'psi': 0.2802618749129405}
[S4] START round=12 head_norm_before_train=1.141363 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.041890 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3555147923638016, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4392943913513565, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.582395 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.262897873960865, 'psi': 0.33409214683912186}-{'f1_val': 0.33493014743065364, 'auprc': 0.33493014743065364, 'loss_val': 1.2998669384720083, 'psi': 0.33493014743065364}
[S6] START round=12 head_norm_before_train=1.558129 (no previous merge yet)
[S6] round=12 local utility u=0.789517 metrics={'f1_val': 0.05946857865879376, 'auprc': 0.05946857865879376, 'loss_val': 4.084527859964544, 'psi': 0.05946857865879375}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.128345370208709, 'psi': 0.0}
[S7] START round=12 head_norm_before_train=1.492389 (no previous merge yet)
[S7] round=12 local utility u=0.147731 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.093882216088043, 'psi': 0.35976373724718097}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.149234441195382, 'psi': 0.33308476261496395}
[S8] START round=12 head_norm_before_train=1.435580 (no previous merge yet)
[S8] round=12 local utility u=0.020987 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.102227330789189, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1442017992204985, 'psi': 0.30506182380216385}
[S9] START round=12 head_norm_before_train=1.739758 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5801477428953397, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.518565265124699, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=1.476989 (no previous merge yet)
[S10] round=12 local utility u=0.958031 metrics={'f1_val': 0.21458670988654782, 'auprc': 0.21458670988654782, 'loss_val': 3.0217153919522057, 'psi': 0.21458670988654782}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0064968416298528, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.461606 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.13168415792103946, 'auprc': 0.13168415792103946, 'loss_val': 2.589673307865156, 'psi': 0.13168415792103946}-{'f1_val': 0.2791202823784958, 'auprc': 0.2791202823784958, 'loss_val': 2.098928418469792, 'psi': 0.2791202823784958}
[S13] START round=12 head_norm_before_train=1.302059 cos_to_last_merge=0.9896 (last merge round=8)
[S13] round=12 local utility u=1.000000 metrics={'f1_val': 0.25982598259825984, 'auprc': 0.25982598259825984, 'loss_val': 1.3545775066667698, 'psi': 0.25982598259825984}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4466626491379555, 'psi': 0.0}
[S14] START round=12 head_norm_before_train=0.999288 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.374668 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0901706827365234, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.839507453078488, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.444200 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.1352802954011413, 'auprc': 0.1352802954011413, 'loss_val': 1.3474622147249031, 'psi': 0.1352802954011413}-{'f1_val': 0.15111545350920044, 'auprc': 0.15111545350920044, 'loss_val': 1.3580442312760947, 'psi': 0.15111545350920044}
[S16] START round=12 head_norm_before_train=1.478549 (no previous merge yet)
[S16] round=12 local utility u=0.071267 metrics={'f1_val': 0.034808766652342074, 'auprc': 0.034808766652342074, 'loss_val': 2.8056359794814343, 'psi': 0.034808766652342074}-{'f1_val': 0.00046253469010175765, 'auprc': 0.00046253469010175765, 'loss_val': 2.6390538941403774, 'psi': 0.00046253469010175765}
[S17] START round=12 head_norm_before_train=1.448246 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.2031386224934612, 'auprc': 0.2031386224934612, 'loss_val': 1.3812841608343878, 'psi': 0.2031386224934612}-{'f1_val': 0.20767195767195767, 'auprc': 0.20767195767195767, 'loss_val': 1.3526387541038891, 'psi': 0.20767195767195767}
[S16] not sending this round → trigger blocked (psi=0.035)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:37116
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.059)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[S2] not sending this round → trigger blocked (psi=0.151)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:37111
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:37117
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S13
[S16] cosine check vs S13: cos=-0.0974
[S16] DROPPED delta from S13 (cos=-0.0974 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=-0.0541
[S17] DROPPED delta from S8 (cos=-0.0541 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=-0.0453
[S14] DROPPED delta from S10 (cos=-0.0453 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=-0.0074
[S10] DROPPED delta from S7 (cos=-0.0074 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=13 head_norm_before_train=1.516648 (no previous merge yet)
[S2] round=13 local utility u=0.574263 metrics={'f1_val': 0.26243681830274007, 'auprc': 0.26243681830274007, 'loss_val': 2.3411081179791786, 'psi': 0.26243681830274007}-{'f1_val': 0.15123456790123457, 'auprc': 0.15123456790123457, 'loss_val': 2.48881439561623, 'psi': 0.15123456790123457}
[S3] START round=13 head_norm_before_train=1.685005 (no previous merge yet)
[S3] round=13 local utility u=0.175534 metrics={'f1_val': 0.264823955248437, 'auprc': 0.264823955248437, 'loss_val': 2.4429019998534347, 'psi': 0.264823955248437}-{'f1_val': 0.22371364653243847, 'auprc': 0.22371364653243847, 'loss_val': 2.4239765340030908, 'psi': 0.22371364653243847}
[S4] START round=13 head_norm_before_train=1.171979 cos_to_last_merge=0.9987 (last merge round=11)
[S4] round=13 local utility u=0.009396 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.336721927016958, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3555147923638016, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.635170 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.595086305824615, 'psi': 0.33409214683912186}-{'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.262897873960865, 'psi': 0.33409214683912186}
[S6] START round=13 head_norm_before_train=1.578065 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.069336689016688, 'psi': 0.01732902033271719}-{'f1_val': 0.05946857865879376, 'auprc': 0.05946857865879376, 'loss_val': 4.084527859964544, 'psi': 0.05946857865879375}
[S7] START round=13 head_norm_before_train=1.533775 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.2381551362683438, 'auprc': 0.2381551362683438, 'loss_val': 1.1131506396045978, 'psi': 0.23815513626834384}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.093882216088043, 'psi': 0.35976373724718097}
[S8] START round=13 head_norm_before_train=1.461893 (no previous merge yet)
[S8] round=13 local utility u=0.042560 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0171081173522123, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.102227330789189, 'psi': 0.30506182380216385}
[S9] START round=13 head_norm_before_train=1.762405 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6339149032177214, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5801477428953397, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=1.511992 (no previous merge yet)
[S10] round=13 local utility u=0.128851 metrics={'f1_val': 0.23309517734115845, 'auprc': 0.23309517734115845, 'loss_val': 2.9305899005898803, 'psi': 0.23309517734115845}-{'f1_val': 0.21458670988654782, 'auprc': 0.21458670988654782, 'loss_val': 3.0217153919522057, 'psi': 0.21458670988654782}
[S11] START round=13 head_norm_before_train=1.496844 (no previous merge yet)
[S11] round=13 local utility u=1.000000 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.0358676953583448, 'psi': 0.3240172688025449}-{'f1_val': 0.13168415792103946, 'auprc': 0.13168415792103946, 'loss_val': 2.589673307865156, 'psi': 0.13168415792103946}
[S13] START round=13 head_norm_before_train=1.313506 cos_to_last_merge=0.9862 (last merge round=8)
[S13] round=13 local utility u=0.228687 metrics={'f1_val': 0.30554815801154017, 'auprc': 0.30554815801154017, 'loss_val': 1.3087032693530716, 'psi': 0.30554815801154017}-{'f1_val': 0.25982598259825984, 'auprc': 0.25982598259825984, 'loss_val': 1.3545775066667698, 'psi': 0.25982598259825984}
[S14] START round=13 head_norm_before_train=1.030834 cos_to_last_merge=0.9980 (last merge round=11)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.604580565704828, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0901706827365234, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.475443 (no previous merge yet)
[S15] round=13 local utility u=0.363615 metrics={'f1_val': 0.21373390557939917, 'auprc': 0.21373390557939917, 'loss_val': 1.3263138717297909, 'psi': 0.2137339055793992}-{'f1_val': 0.1352802954011413, 'auprc': 0.1352802954011413, 'loss_val': 1.3474622147249031, 'psi': 0.1352802954011413}
[S16] START round=13 head_norm_before_train=1.508487 (no previous merge yet)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.05108295872496935, 'auprc': 0.05108295872496935, 'loss_val': 3.061569713485447, 'psi': 0.05108295872496935}-{'f1_val': 0.034808766652342074, 'auprc': 0.034808766652342074, 'loss_val': 2.8056359794814343, 'psi': 0.034808766652342074}
[S17] START round=13 head_norm_before_train=1.469957 (no previous merge yet)
[S17] round=13 local utility u=0.013468 metrics={'f1_val': 0.20486902050113895, 'auprc': 0.20486902050113895, 'loss_val': 1.3699217587078836, 'psi': 0.20486902050113895}-{'f1_val': 0.2031386224934612, 'auprc': 0.2031386224934612, 'loss_val': 1.3812841608343878, 'psi': 0.2031386224934612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:37114
[S11] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:37109
[S4] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.6909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:37104
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=0.0792
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:37116
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=0.7307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] cosine check vs S13: cos=-0.0986
[S16] DROPPED delta from S13 (cos=-0.0986 < 0.0)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S15
[S16] cosine check vs S15: cos=-0.0252
[S16] DROPPED delta from S15 (cos=-0.0252 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=-0.0460
[S14] DROPPED delta from S10 (cos=-0.0460 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] cosine check vs S17: cos=-0.0454
[S9] DROPPED delta from S17 (cos=-0.0454 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:37117
[S8] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=-0.0539
[S17] DROPPED delta from S8 (cos=-0.0539 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.0000 head_norm=1.215307
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.884117e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.369659 delta_norm=0.588412
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.3051 head_norm=1.486184
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.029583e+00
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.3051 head_norm=1.114537 delta_norm=1.029583
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.0000 head_norm=1.071874
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.533131e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.199786 delta_norm=0.553313
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.547812 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.26194761047790444, 'auprc': 0.26194761047790444, 'loss_val': 2.3910981188408162, 'psi': 0.26194761047790444}-{'f1_val': 0.26243681830274007, 'auprc': 0.26243681830274007, 'loss_val': 2.3411081179791786, 'psi': 0.26243681830274007}
[S3] START round=14 head_norm_before_train=1.722620 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.2819055637409668, 'auprc': 0.2819055637409668, 'loss_val': 2.6797519462182477, 'psi': 0.2819055637409668}-{'f1_val': 0.264823955248437, 'auprc': 0.264823955248437, 'loss_val': 2.4429019998534347, 'psi': 0.264823955248437}
[S4] START round=14 head_norm_before_train=1.369659 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.002001 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3327196125619223, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.336721927016958, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.673308 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.673766548190688, 'psi': 0.2501920777223545}-{'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.595086305824615, 'psi': 0.33409214683912186}
[S6] START round=14 head_norm_before_train=1.600461 (no previous merge yet)
[S6] round=14 local utility u=0.118973 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 4.879039590181262, 'psi': 0.02262340036563071}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.069336689016688, 'psi': 0.01732902033271719}
[S7] START round=14 head_norm_before_train=1.564861 (no previous merge yet)
[S7] round=14 local utility u=0.577739 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0521505298114084, 'psi': 0.35976373724718097}-{'f1_val': 0.2381551362683438, 'auprc': 0.2381551362683438, 'loss_val': 1.1131506396045978, 'psi': 0.23815513626834384}
[S8] START round=14 head_norm_before_train=1.114537 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0245629447501698, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0171081173522123, 'psi': 0.30506182380216385}
[S9] START round=14 head_norm_before_train=1.781980 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.671660963474487, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6339149032177214, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.542818 (no previous merge yet)
[S10] round=14 local utility u=0.125796 metrics={'f1_val': 0.24952107279693486, 'auprc': 0.24952107279693486, 'loss_val': 2.826831031875056, 'psi': 0.24952107279693486}-{'f1_val': 0.23309517734115845, 'auprc': 0.23309517734115845, 'loss_val': 2.9305899005898803, 'psi': 0.23309517734115845}
[S11] START round=14 head_norm_before_train=1.530480 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.3243120309301797, 'auprc': 0.3243120309301797, 'loss_val': 2.3446309937165997, 'psi': 0.3243120309301797}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.0358676953583448, 'psi': 0.3240172688025449}
[S13] START round=14 head_norm_before_train=1.332990 cos_to_last_merge=0.9820 (last merge round=8)
[S13] round=14 local utility u=0.048015 metrics={'f1_val': 0.31194103129669587, 'auprc': 0.31194103129669587, 'loss_val': 1.270209667582156, 'psi': 0.31194103129669587}-{'f1_val': 0.30554815801154017, 'auprc': 0.30554815801154017, 'loss_val': 1.3087032693530716, 'psi': 0.30554815801154017}
[S14] START round=14 head_norm_before_train=1.199786 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.254596 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0953893951363276, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.604580565704828, 'psi': 0.0}
[S15] START round=14 head_norm_before_train=1.505365 (no previous merge yet)
[S15] round=14 local utility u=0.200933 metrics={'f1_val': 0.25650991061018263, 'auprc': 0.25650991061018263, 'loss_val': 1.3094327614551617, 'psi': 0.25650991061018263}-{'f1_val': 0.21373390557939917, 'auprc': 0.21373390557939917, 'loss_val': 1.3263138717297909, 'psi': 0.2137339055793992}
[S16] START round=14 head_norm_before_train=1.537909 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.05121365697519339, 'auprc': 0.05121365697519339, 'loss_val': 3.2853271856841917, 'psi': 0.05121365697519339}-{'f1_val': 0.05108295872496935, 'auprc': 0.05108295872496935, 'loss_val': 3.061569713485447, 'psi': 0.05108295872496935}
[S17] START round=14 head_norm_before_train=1.486324 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.15299961044020258, 'auprc': 0.15299961044020258, 'loss_val': 1.2467422984280392, 'psi': 0.15299961044020258}-{'f1_val': 0.20486902050113895, 'auprc': 0.20486902050113895, 'loss_val': 1.3699217587078836, 'psi': 0.20486902050113895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[S4] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.023)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:37111
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=-0.0999
[S16] DROPPED delta from S13 (cos=-0.0999 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=-0.0291
[S14] DROPPED delta from S10 (cos=-0.0291 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S7
[S10] cosine check vs S7: cos=-0.0097
[S10] DROPPED delta from S7 (cos=-0.0097 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] cosine check vs S15: cos=-0.0215
[S16] DROPPED delta from S15 (cos=-0.0215 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=15 head_norm_before_train=1.580098 (no previous merge yet)
[S2] round=15 local utility u=0.028222 metrics={'f1_val': 0.25721784776902884, 'auprc': 0.25721784776902884, 'loss_val': 2.2920858560301287, 'psi': 0.25721784776902884}-{'f1_val': 0.26194761047790444, 'auprc': 0.26194761047790444, 'loss_val': 2.3910981188408162, 'psi': 0.26194761047790444}
[S3] START round=15 head_norm_before_train=1.758577 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.28121720881427076, 'auprc': 0.28121720881427076, 'loss_val': 2.731673885815445, 'psi': 0.28121720881427076}-{'f1_val': 0.2819055637409668, 'auprc': 0.2819055637409668, 'loss_val': 2.6797519462182477, 'psi': 0.2819055637409668}
[S4] START round=15 head_norm_before_train=1.404091 cos_to_last_merge=0.9977 (last merge round=13)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3384333087362528, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3327196125619223, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.710824 (no previous merge yet)
[S5] round=15 local utility u=0.391974 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.6441770460966105, 'psi': 0.33400978131092857}-{'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.673766548190688, 'psi': 0.2501920777223545}
[S6] START round=15 head_norm_before_train=1.620322 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.014862981885740827, 'auprc': 0.014862981885740827, 'loss_val': 5.506262208586212, 'psi': 0.014862981885740829}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 4.879039590181262, 'psi': 0.02262340036563071}
[S7] START round=15 head_norm_before_train=1.587323 (no previous merge yet)
[S7] round=15 local utility u=0.022534 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0070825269543577, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0521505298114084, 'psi': 0.35976373724718097}
[S8] START round=15 head_norm_before_train=1.151167 cos_to_last_merge=0.9984 (last merge round=13)
[S8] round=15 local utility u=0.018540 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9874819476500083, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0245629447501698, 'psi': 0.30506182380216385}
[S9] START round=15 head_norm_before_train=1.799000 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.711597765617749, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.671660963474487, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.573651 (no previous merge yet)
[S10] round=15 local utility u=0.422490 metrics={'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 2.7318529044703483, 'psi': 0.3328546353917345}-{'f1_val': 0.24952107279693486, 'auprc': 0.24952107279693486, 'loss_val': 2.826831031875056, 'psi': 0.24952107279693486}
[S11] START round=15 head_norm_before_train=1.558082 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.3103373231773667, 'auprc': 0.3103373231773667, 'loss_val': 2.2208766207276507, 'psi': 0.3103373231773667}-{'f1_val': 0.3243120309301797, 'auprc': 0.3243120309301797, 'loss_val': 2.3446309937165997, 'psi': 0.3243120309301797}
[S13] START round=15 head_norm_before_train=1.357795 cos_to_last_merge=0.9766 (last merge round=8)
[S13] round=15 local utility u=1.000000 metrics={'f1_val': 0.6638714909491261, 'auprc': 0.6638714909491261, 'loss_val': 1.1724332271682143, 'psi': 0.6638714909491261}-{'f1_val': 0.31194103129669587, 'auprc': 0.31194103129669587, 'loss_val': 1.270209667582156, 'psi': 0.31194103129669587}
[S14] START round=15 head_norm_before_train=1.224647 cos_to_last_merge=0.9980 (last merge round=13)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.610366137129924, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0953893951363276, 'psi': 0.0}
[S15] START round=15 head_norm_before_train=1.532856 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.16816249409541806, 'auprc': 0.16816249409541806, 'loss_val': 1.28065279780849, 'psi': 0.16816249409541806}-{'f1_val': 0.25650991061018263, 'auprc': 0.25650991061018263, 'loss_val': 1.3094327614551617, 'psi': 0.25650991061018263}
[S16] START round=15 head_norm_before_train=1.566499 (no previous merge yet)
[S16] round=15 local utility u=0.141402 metrics={'f1_val': 0.09018100272304981, 'auprc': 0.09018100272304981, 'loss_val': 3.3532293576642216, 'psi': 0.09018100272304981}-{'f1_val': 0.05121365697519339, 'auprc': 0.05121365697519339, 'loss_val': 3.2853271856841917, 'psi': 0.05121365697519339}
[S17] START round=15 head_norm_before_train=1.503044 (no previous merge yet)
[S17] round=15 local utility u=0.045840 metrics={'f1_val': 0.15641178813221823, 'auprc': 0.15641178813221823, 'loss_val': 1.1857725636557779, 'psi': 0.15641178813221823}-{'f1_val': 0.15299961044020258, 'auprc': 0.15299961044020258, 'loss_val': 1.2467422984280392, 'psi': 0.15299961044020258}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:37117
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:37109
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:37110
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:37111
[S16] not sending this round → trigger blocked (psi=0.090)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=-0.0110
[S10] DROPPED delta from S7 (cos=-0.0110 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] cosine check vs S13: cos=-0.1004
[S16] DROPPED delta from S13 (cos=-0.1004 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1805) from S5
[S9] cosine check vs S5: cos=-0.1489
[S9] DROPPED delta from S5 (cos=-0.1489 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S2
[S8] cosine check vs S2: cos=0.7037
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.0486
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=-0.0263
[S14] DROPPED delta from S10 (cos=-0.0263 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=-0.0476
[S9] DROPPED delta from S17 (cos=-0.0476 < 0.0)
[S11] ⇄ pheromone p=0.259 → S14@127.0.0.1:37114
[S9] ⇄ pheromone p=0.103 → S13@127.0.0.1:37113
[S3] ⇄ pheromone p=0.172 → S4@127.0.0.1:37104
[S6] ⇄ pheromone p=0.181 → S11@127.0.0.1:37112
[S14] ⇄ pheromone p=0.118 → S4@127.0.0.1:37104
[S4] ⇄ pheromone p=0.059 → S9@127.0.0.1:37110
[S15] ⇄ pheromone p=0.174 → S16@127.0.0.1:37116
[S5] ⇄ pheromone p=0.217 → S9@127.0.0.1:37110
[S13] ⇄ pheromone p=0.388 → S16@127.0.0.1:37116
[S2] ⇄ pheromone p=0.225 → S8@127.0.0.1:37109
[S10] ⇄ pheromone p=0.255 → S14@127.0.0.1:37114
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.3051 head_norm=1.203665
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.737842e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.3051 head_norm=1.301900 delta_norm=0.573784
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.116 → S17@127.0.0.1:37117
[S7] ⇄ pheromone p=0.214 → S10@127.0.0.1:37111
[S16] ⇄ pheromone p=0.089 → S8@127.0.0.1:37109
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.1564 head_norm=1.518839
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.457957e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.1531 head_norm=0.991620 delta_norm=0.945796
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.116 → S9@127.0.0.1:37110
[S2] START round=16 head_norm_before_train=1.612308 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.2651064392436864, 'auprc': 0.2651064392436864, 'loss_val': 2.450465886960163, 'psi': 0.2651064392436864}-{'f1_val': 0.25721784776902884, 'auprc': 0.25721784776902884, 'loss_val': 2.2920858560301287, 'psi': 0.25721784776902884}
[S3] START round=16 head_norm_before_train=1.791305 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.2820026683519416, 'auprc': 0.2820026683519416, 'loss_val': 2.7936581999963774, 'psi': 0.2820026683519416}-{'f1_val': 0.28121720881427076, 'auprc': 0.28121720881427076, 'loss_val': 2.731673885815445, 'psi': 0.28121720881427076}
[S4] START round=16 head_norm_before_train=1.444465 cos_to_last_merge=0.9918 (last merge round=13)
[S4] round=16 local utility u=0.004951 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.328530352331641, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3384333087362528, 'psi': 0.0}
[S5] START round=16 head_norm_before_train=1.749238 (no previous merge yet)
[S5] round=16 local utility u=0.029142 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5813681018711985, 'psi': 0.3335071121394324}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.6441770460966105, 'psi': 0.33400978131092857}
[S6] START round=16 head_norm_before_train=1.638752 (no previous merge yet)
[S6] round=16 local utility u=0.584093 metrics={'f1_val': 0.08682753164556962, 'auprc': 0.08682753164556962, 'loss_val': 4.985757815025666, 'psi': 0.08682753164556962}-{'f1_val': 0.014862981885740827, 'auprc': 0.014862981885740827, 'loss_val': 5.506262208586212, 'psi': 0.014862981885740829}
[S7] START round=16 head_norm_before_train=1.614174 (no previous merge yet)
[S7] round=16 local utility u=0.025846 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9553910859846131, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0070825269543577, 'psi': 0.35976373724718097}
[S8] START round=16 head_norm_before_train=1.301900 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0242462192118322, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9874819476500083, 'psi': 0.30506182380216385}
[S9] START round=16 head_norm_before_train=1.815161 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.750981360908002, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.711597765617749, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.605976 (no previous merge yet)
[S10] round=16 local utility u=0.046223 metrics={'f1_val': 0.33277498604131767, 'auprc': 0.33277498604131767, 'loss_val': 2.6386897305210204, 'psi': 0.33277498604131767}-{'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 2.7318529044703483, 'psi': 0.3328546353917345}
[S11] START round=16 head_norm_before_train=1.580885 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.4373858216121467, 'psi': 0.32387008857597094}-{'f1_val': 0.3103373231773667, 'auprc': 0.3103373231773667, 'loss_val': 2.2208766207276507, 'psi': 0.3103373231773667}
[S13] START round=16 head_norm_before_train=1.380225 cos_to_last_merge=0.9722 (last merge round=8)
[S13] round=16 local utility u=0.021343 metrics={'f1_val': 0.6634942550327166, 'auprc': 0.6634942550327166, 'loss_val': 1.126352575486337, 'psi': 0.6634942550327166}-{'f1_val': 0.6638714909491261, 'auprc': 0.6638714909491261, 'loss_val': 1.1724332271682143, 'psi': 0.6638714909491261}
[S14] START round=16 head_norm_before_train=1.259238 cos_to_last_merge=0.9914 (last merge round=13)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.072633037603495, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.610366137129924, 'psi': 0.0}
[S15] START round=16 head_norm_before_train=1.556888 (no previous merge yet)
[S15] round=16 local utility u=0.654943 metrics={'f1_val': 0.28221007893139044, 'auprc': 0.28221007893139044, 'loss_val': 0.9971945831957948, 'psi': 0.28221007893139044}-{'f1_val': 0.16816249409541806, 'auprc': 0.16816249409541806, 'loss_val': 1.28065279780849, 'psi': 0.16816249409541806}
[S16] START round=16 head_norm_before_train=1.593419 (no previous merge yet)
[S16] round=16 local utility u=0.430077 metrics={'f1_val': 0.14617604617604618, 'auprc': 0.14617604617604618, 'loss_val': 2.997031545202072, 'psi': 0.14617604617604618}-{'f1_val': 0.09018100272304981, 'auprc': 0.09018100272304981, 'loss_val': 3.3532293576642216, 'psi': 0.09018100272304981}
[S17] START round=16 head_norm_before_train=0.991620 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.033693 metrics={'f1_val': 0.1538386212299256, 'auprc': 0.1538386212299256, 'loss_val': 1.0952288226469369, 'psi': 0.1538386212299256}-{'f1_val': 0.15641178813221823, 'auprc': 0.15641178813221823, 'loss_val': 1.1857725636557779, 'psi': 0.15641178813221823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:37114
[S6] not sending this round → trigger blocked (psi=0.087)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.146)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:37116
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=-0.1019
[S16] DROPPED delta from S13 (cos=-0.1019 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=-0.1504
[S9] DROPPED delta from S5 (cos=-0.1504 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=-0.0227
[S14] DROPPED delta from S10 (cos=-0.0227 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=-0.0120
[S10] DROPPED delta from S7 (cos=-0.0120 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S15
[S16] cosine check vs S15: cos=-0.0173
[S16] DROPPED delta from S15 (cos=-0.0173 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] cosine check vs S17: cos=0.0270
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.3687 head_norm=1.830343
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.038907e+00
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.3687 head_norm=1.063187 delta_norm=1.038907
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.641797 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.24597490052035506, 'auprc': 0.24597490052035506, 'loss_val': 2.3399533185370025, 'psi': 0.24597490052035506}-{'f1_val': 0.2651064392436864, 'auprc': 0.2651064392436864, 'loss_val': 2.450465886960163, 'psi': 0.2651064392436864}
[S3] START round=17 head_norm_before_train=1.818176 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.2811953250752327, 'auprc': 0.2811953250752327, 'loss_val': 2.8300315543172965, 'psi': 0.2811953250752327}-{'f1_val': 0.2820026683519416, 'auprc': 0.2820026683519416, 'loss_val': 2.7936581999963774, 'psi': 0.2820026683519416}
[S4] START round=17 head_norm_before_train=1.489115 cos_to_last_merge=0.9844 (last merge round=13)
[S4] round=17 local utility u=0.012456 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3036185023313762, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.328530352331641, 'psi': 0.0}
[S5] START round=17 head_norm_before_train=1.790746 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6628617761517637, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5813681018711985, 'psi': 0.3335071121394324}
[S6] START round=17 head_norm_before_train=1.655429 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 5.842625169368612, 'psi': 0.002619047619047619}-{'f1_val': 0.08682753164556962, 'auprc': 0.08682753164556962, 'loss_val': 4.985757815025666, 'psi': 0.08682753164556962}
[S7] START round=17 head_norm_before_train=1.637668 (no previous merge yet)
[S7] round=17 local utility u=0.003571 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9482483634012824, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9553910859846131, 'psi': 0.35976373724718097}
[S8] START round=17 head_norm_before_train=1.343993 cos_to_last_merge=0.9975 (last merge round=15)
[S8] round=17 local utility u=0.022921 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9784051780339215, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0242462192118322, 'psi': 0.30506182380216385}
[S9] START round=17 head_norm_before_train=1.063187 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.474773 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.801435045341475, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.750981360908002, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.637637 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.24952153110047848, 'auprc': 0.24952153110047848, 'loss_val': 2.563771389281532, 'psi': 0.24952153110047848}-{'f1_val': 0.33277498604131767, 'auprc': 0.33277498604131767, 'loss_val': 2.6386897305210204, 'psi': 0.33277498604131767}
[S11] START round=17 head_norm_before_train=1.602548 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.32423415225963, 'auprc': 0.32423415225963, 'loss_val': 2.5814532212520276, 'psi': 0.32423415225963}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.4373858216121467, 'psi': 0.32387008857597094}
[S13] START round=17 head_norm_before_train=1.406191 cos_to_last_merge=0.9662 (last merge round=8)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5054436556425669, 'auprc': 0.5054436556425669, 'loss_val': 1.0555173593401117, 'psi': 0.5054436556425669}-{'f1_val': 0.6634942550327166, 'auprc': 0.6634942550327166, 'loss_val': 1.126352575486337, 'psi': 0.6634942550327166}
[S14] START round=17 head_norm_before_train=1.299320 cos_to_last_merge=0.9821 (last merge round=13)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.456769382716552, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.072633037603495, 'psi': 0.0}
[S15] START round=17 head_norm_before_train=1.576325 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.2558712858440379, 'auprc': 0.2558712858440379, 'loss_val': 1.0437165479671768, 'psi': 0.2558712858440379}-{'f1_val': 0.28221007893139044, 'auprc': 0.28221007893139044, 'loss_val': 0.9971945831957948, 'psi': 0.28221007893139044}
[S16] START round=17 head_norm_before_train=1.618783 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.09069097888675624, 'auprc': 0.09069097888675624, 'loss_val': 3.6434342121848196, 'psi': 0.09069097888675624}-{'f1_val': 0.14617604617604618, 'auprc': 0.14617604617604618, 'loss_val': 2.997031545202072, 'psi': 0.14617604617604618}
[S17] START round=17 head_norm_before_train=1.034038 cos_to_last_merge=0.9978 (last merge round=15)
[S17] round=17 local utility u=0.022025 metrics={'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.0380192029576274, 'psi': 0.15237633365664405}-{'f1_val': 0.1538386212299256, 'auprc': 0.1538386212299256, 'loss_val': 1.0952288226469369, 'psi': 0.1538386212299256}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:37111
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:37113
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:37117
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.5868
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] cosine check vs S7: cos=-0.0127
[S10] DROPPED delta from S7 (cos=-0.0127 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] cosine check vs S9: cos=0.7859
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.4526
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.5054 head_norm=1.434934
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.437585e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.3976 head_norm=1.220519 delta_norm=0.443759
[S13] aggregate: ROLLBACK (f1_val pre=0.505 post=0.398 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.3687 head_norm=1.146360
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.869972e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.3687 head_norm=0.955626 delta_norm=0.586997
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.1524 head_norm=1.096100
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.806378e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.2038 head_norm=1.110127 delta_norm=0.580638
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.668710 (no previous merge yet)
[S2] round=18 local utility u=0.512316 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.40884473304661, 'psi': 0.3674775928297055}-{'f1_val': 0.24597490052035506, 'auprc': 0.24597490052035506, 'loss_val': 2.3399533185370025, 'psi': 0.24597490052035506}
[S3] START round=18 head_norm_before_train=1.838162 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.2811734229503606, 'auprc': 0.2811734229503606, 'loss_val': 2.9047357032639685, 'psi': 0.2811734229503606}-{'f1_val': 0.2811953250752327, 'auprc': 0.2811953250752327, 'loss_val': 2.8300315543172965, 'psi': 0.2811953250752327}
[S4] START round=18 head_norm_before_train=1.530187 cos_to_last_merge=0.9779 (last merge round=13)
[S4] round=18 local utility u=1.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.271168490871302, 'psi': 0.3567939207526687}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3036185023313762, 'psi': 0.0}
[S5] START round=18 head_norm_before_train=1.822730 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.698249875249672, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6628617761517637, 'psi': 0.3335071121394324}
[S6] START round=18 head_norm_before_train=1.668258 (no previous merge yet)
[S6] round=18 local utility u=0.853194 metrics={'f1_val': 0.10179184140297369, 'auprc': 0.10179184140297369, 'loss_val': 5.028792169017403, 'psi': 0.10179184140297369}-{'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 5.842625169368612, 'psi': 0.002619047619047619}
[S7] START round=18 head_norm_before_train=1.661316 (no previous merge yet)
[S7] round=18 local utility u=0.013547 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9211553470673309, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9482483634012824, 'psi': 0.35976373724718097}
[S8] START round=18 head_norm_before_train=1.391980 cos_to_last_merge=0.9913 (last merge round=15)
[S8] round=18 local utility u=0.020146 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9381124981162026, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9784051780339215, 'psi': 0.30506182380216385}
[S9] START round=18 head_norm_before_train=0.955626 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.109766 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5819029311205814, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.801435045341475, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.665535 (no previous merge yet)
[S10] round=18 local utility u=0.031069 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.501635751017983, 'psi': 0.24952175992348158}-{'f1_val': 0.24952153110047848, 'auprc': 0.24952153110047848, 'loss_val': 2.563771389281532, 'psi': 0.24952153110047848}
[S11] START round=18 head_norm_before_train=1.621033 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.962521952786992, 'psi': 0.33201273984308244}-{'f1_val': 0.32423415225963, 'auprc': 0.32423415225963, 'loss_val': 2.5814532212520276, 'psi': 0.32423415225963}
[S13] START round=18 head_norm_before_train=1.220519 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.3606931746489752, 'auprc': 0.3606931746489752, 'loss_val': 1.0891801379316832, 'psi': 0.3606931746489752}-{'f1_val': 0.5054436556425669, 'auprc': 0.5054436556425669, 'loss_val': 1.0555173593401117, 'psi': 0.5054436556425669}
[S14] START round=18 head_norm_before_train=1.338542 cos_to_last_merge=0.9725 (last merge round=13)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.718265510289004, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.456769382716552, 'psi': 0.0}
[S15] START round=18 head_norm_before_train=1.593192 (no previous merge yet)
[S15] round=18 local utility u=0.201243 metrics={'f1_val': 0.2816490331995622, 'auprc': 0.2816490331995622, 'loss_val': 0.8732294377250599, 'psi': 0.2816490331995622}-{'f1_val': 0.2558712858440379, 'auprc': 0.2558712858440379, 'loss_val': 1.0437165479671768, 'psi': 0.2558712858440379}
[S16] START round=18 head_norm_before_train=1.642272 (no previous merge yet)
[S16] round=18 local utility u=0.375740 metrics={'f1_val': 0.13840070298769772, 'auprc': 0.13840070298769772, 'loss_val': 3.321341445200741, 'psi': 0.13840070298769772}-{'f1_val': 0.09069097888675624, 'auprc': 0.09069097888675624, 'loss_val': 3.6434342121848196, 'psi': 0.09069097888675624}
[S17] START round=18 head_norm_before_train=1.110127 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.086941 metrics={'f1_val': 0.17189402865481423, 'auprc': 0.17189402865481423, 'loss_val': 1.039796751631044, 'psi': 0.17189402865481423}-{'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.0380192029576274, 'psi': 0.15237633365664405}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.138)
[S6] not sending this round → trigger blocked (psi=0.102)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:37110
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:37113
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=0.8818
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.8825
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=-0.0168
[S14] DROPPED delta from S10 (cos=-0.0168 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=-0.0129
[S10] DROPPED delta from S7 (cos=-0.0129 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S9
[S13] cosine check vs S9: cos=0.7657
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] cosine check vs S15: cos=-0.0141
[S16] DROPPED delta from S15 (cos=-0.0141 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1805) from S4
[S9] cosine check vs S4: cos=0.0037
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.6909
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.3607 head_norm=1.246798
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.055616e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.3131 head_norm=1.091868 delta_norm=0.405562
[S13] aggregate: ROLLBACK (f1_val pre=0.361 post=0.313 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.3687 head_norm=1.076479
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.627120e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.3687 head_norm=0.864950 delta_norm=0.562712
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.3051 head_norm=1.439431
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.999809e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.3051 head_norm=1.519418 delta_norm=0.399981
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.1719 head_norm=1.152004
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.436657e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.2442 head_norm=1.257550 delta_norm=0.343666
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.692711 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.2506706594297835, 'auprc': 0.2506706594297835, 'loss_val': 2.4726170912582455, 'psi': 0.2506706594297835}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.40884473304661, 'psi': 0.3674775928297055}
[S3] START round=19 head_norm_before_train=1.856713 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.2812915878685998, 'auprc': 0.2812915878685998, 'loss_val': 2.91463043412205, 'psi': 0.2812915878685998}-{'f1_val': 0.2811734229503606, 'auprc': 0.2811734229503606, 'loss_val': 2.9047357032639685, 'psi': 0.2811734229503606}
[S4] START round=19 head_norm_before_train=1.568350 cos_to_last_merge=0.9720 (last merge round=13)
[S4] round=19 local utility u=0.015469 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2402313068270654, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.271168490871302, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.858150 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.757093470090212, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.698249875249672, 'psi': 0.3335071121394324}
[S6] START round=19 head_norm_before_train=1.682931 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.170274662875359, 'psi': 0.0}-{'f1_val': 0.10179184140297369, 'auprc': 0.10179184140297369, 'loss_val': 5.028792169017403, 'psi': 0.10179184140297369}
[S7] START round=19 head_norm_before_train=1.678736 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9141178028053594, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9211553470673309, 'psi': 0.35976373724718097}
[S8] START round=19 head_norm_before_train=1.519418 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9687618039454365, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9381124981162026, 'psi': 0.30506182380216385}
[S9] START round=19 head_norm_before_train=0.864950 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.051401 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4791017075291044, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5819029311205814, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.688726 (no previous merge yet)
[S10] round=19 local utility u=0.053084 metrics={'f1_val': 0.24958163997131247, 'auprc': 0.24958163997131247, 'loss_val': 2.396006494317086, 'psi': 0.24958163997131244}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.501635751017983, 'psi': 0.24952175992348158}
[S11] START round=19 head_norm_before_train=1.636974 (no previous merge yet)
[S11] round=19 local utility u=0.090312 metrics={'f1_val': 0.3255672300898432, 'auprc': 0.3255672300898432, 'loss_val': 2.7238880462740087, 'psi': 0.3255672300898432}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.962521952786992, 'psi': 0.33201273984308244}
[S13] START round=19 head_norm_before_train=1.091868 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.022032 metrics={'f1_val': 0.36753917616594145, 'auprc': 0.36753917616594145, 'loss_val': 1.1067305228971458, 'psi': 0.36753917616594145}-{'f1_val': 0.3606931746489752, 'auprc': 0.3606931746489752, 'loss_val': 1.0891801379316832, 'psi': 0.3606931746489752}
[S14] START round=19 head_norm_before_train=1.372013 cos_to_last_merge=0.9645 (last merge round=13)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.911835173976742, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.718265510289004, 'psi': 0.0}
[S15] START round=19 head_norm_before_train=1.613372 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.2584139264990329, 'auprc': 0.2584139264990329, 'loss_val': 0.9933441213120939, 'psi': 0.2584139264990329}-{'f1_val': 0.2816490331995622, 'auprc': 0.2816490331995622, 'loss_val': 0.8732294377250599, 'psi': 0.2816490331995622}
[S16] START round=19 head_norm_before_train=1.663979 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.0751521131392863, 'auprc': 0.0751521131392863, 'loss_val': 4.263064173907382, 'psi': 0.0751521131392863}-{'f1_val': 0.13840070298769772, 'auprc': 0.13840070298769772, 'loss_val': 3.321341445200741, 'psi': 0.13840070298769772}
[S17] START round=19 head_norm_before_train=1.257550 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.007177 metrics={'f1_val': 0.17479479205944493, 'auprc': 0.17479479205944493, 'loss_val': 1.0515499312230419, 'psi': 0.17479479205944493}-{'f1_val': 0.17189402865481423, 'auprc': 0.17189402865481423, 'loss_val': 1.039796751631044, 'psi': 0.17189402865481423}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:37113
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:37114
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=-0.0147
[S14] DROPPED delta from S10 (cos=-0.0147 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S11
[S14] cosine check vs S11: cos=0.8438
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] cosine check vs S9: cos=0.8247
[S16] RECEIVED delta(kind=head bytes=1805) from S13
[S16] cosine check vs S13: cos=-0.0296
[S16] DROPPED delta from S13 (cos=-0.0296 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S4
[S9] cosine check vs S4: cos=0.3969
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S17
[S9] cosine check vs S17: cos=0.6438
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.0000 head_norm=1.400405
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.433812e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.0000 head_norm=1.465878 delta_norm=0.443381
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.000 u=0.0000 p_local=0.0482 f1=0.000 auprc=0.000 bytes=0
[S5] r=20 psi=0.334 u=0.0000 p_local=0.0917 f1=0.334 auprc=0.334 bytes=12590
[S3] r=20 psi=0.281 u=0.0000 p_local=0.0706 f1=0.281 auprc=0.281 bytes=3608
[S8] r=20 psi=0.305 u=0.0000 p_local=0.0537 f1=0.305 auprc=0.305 bytes=17962
[S2] r=20 psi=0.251 u=0.0000 p_local=0.1742 f1=0.251 auprc=0.251 bytes=5389
[S6] r=20 psi=0.000 u=0.0000 p_local=0.2706 f1=0.000 auprc=0.000 bytes=0
[S7] r=20 psi=0.240 u=0.0000 p_local=0.0930 f1=0.240 auprc=0.240 bytes=16216
[S15] r=20 psi=0.258 u=0.0000 p_local=0.1705 f1=0.258 auprc=0.258 bytes=7198
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.3687 head_norm=1.018170
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.017387e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.3687 head_norm=0.952153 delta_norm=0.401739
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] r=20 psi=0.369 u=0.0514 p_local=0.1307 f1=0.369 auprc=0.369 bytes=8991
[S10] r=20 psi=0.250 u=0.0531 p_local=0.1247 f1=0.250 auprc=0.250 bytes=12599
[S4] r=20 psi=0.357 u=0.0155 p_local=0.1894 f1=0.357 auprc=0.357 bytes=8998
[S11] r=20 psi=0.326 u=0.0903 p_local=0.1243 f1=0.326 auprc=0.326 bytes=7183
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.3675 head_norm=1.120045
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.202189e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.3648 head_norm=1.021296 delta_norm=0.320219
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.368 u=0.0220 p_local=0.1655 f1=0.368 auprc=0.368 bytes=10813
[S17] r=20 psi=0.175 u=0.0072 p_local=0.0691 f1=0.175 auprc=0.175 bytes=12605
[S16] r=20 psi=0.075 u=0.0000 p_local=0.1407 f1=0.075 auprc=0.075 bytes=0
[S2] START round=20 head_norm_before_train=1.713823 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.23668722966744662, 'auprc': 0.23668722966744662, 'loss_val': 2.877934845949138, 'psi': 0.2366872296674466}-{'f1_val': 0.2506706594297835, 'auprc': 0.2506706594297835, 'loss_val': 2.4726170912582455, 'psi': 0.2506706594297835}
[S3] START round=20 head_norm_before_train=1.873137 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.2809593734703867, 'auprc': 0.2809593734703867, 'loss_val': 2.919066338464585, 'psi': 0.2809593734703867}-{'f1_val': 0.2812915878685998, 'auprc': 0.2812915878685998, 'loss_val': 2.91463043412205, 'psi': 0.2812915878685998}
[S4] START round=20 head_norm_before_train=1.603217 cos_to_last_merge=0.9666 (last merge round=13)
[S4] round=20 local utility u=0.013077 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2140768243264706, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2402313068270654, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.890187 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.802101816407084, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.757093470090212, 'psi': 0.3335071121394324}
[S6] START round=20 head_norm_before_train=1.694855 (no previous merge yet)
[S6] round=20 local utility u=0.932922 metrics={'f1_val': 0.10179184140297369, 'auprc': 0.10179184140297369, 'loss_val': 5.220558030292173, 'psi': 0.10179184140297369}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.170274662875359, 'psi': 0.0}
[S7] START round=20 head_norm_before_train=1.690611 (no previous merge yet)
[S7] round=20 local utility u=0.518471 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9578417797516391, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9141178028053594, 'psi': 0.23968964488212474}
[S8] START round=20 head_norm_before_train=1.554612 cos_to_last_merge=0.9988 (last merge round=18)
[S8] round=20 local utility u=0.017680 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9334015239258647, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9687618039454365, 'psi': 0.30506182380216385}
[S9] START round=20 head_norm_before_train=0.952153 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.22068535825545169, 'auprc': 0.22068535825545169, 'loss_val': 1.5582228515779588, 'psi': 0.2206853582554517}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4791017075291044, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.710223 (no previous merge yet)
[S10] round=20 local utility u=0.026252 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.3429635746236204, 'psi': 0.24952175992348158}-{'f1_val': 0.24958163997131247, 'auprc': 0.24958163997131247, 'loss_val': 2.396006494317086, 'psi': 0.24958163997131244}
[S11] START round=20 head_norm_before_train=1.652162 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 2.845070925931787, 'psi': 0.33162711338607104}-{'f1_val': 0.3255672300898432, 'auprc': 0.3255672300898432, 'loss_val': 2.7238880462740087, 'psi': 0.3255672300898432}
[S13] START round=20 head_norm_before_train=1.021296 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.25915762025663897, 'auprc': 0.25915762025663897, 'loss_val': 1.102702666587467, 'psi': 0.25915762025663897}-{'f1_val': 0.36753917616594145, 'auprc': 0.36753917616594145, 'loss_val': 1.1067305228971458, 'psi': 0.36753917616594145}
[S14] START round=20 head_norm_before_train=1.465878 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.557098 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.797638506193621, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.911835173976742, 'psi': 0.0}
[S15] START round=20 head_norm_before_train=1.634904 (no previous merge yet)
[S15] round=20 local utility u=0.197122 metrics={'f1_val': 0.28346647300895667, 'auprc': 0.28346647300895667, 'loss_val': 0.8245730445590315, 'psi': 0.28346647300895667}-{'f1_val': 0.2584139264990329, 'auprc': 0.2584139264990329, 'loss_val': 0.9933441213120939, 'psi': 0.2584139264990329}
[S16] START round=20 head_norm_before_train=1.682724 (no previous merge yet)
[S16] round=20 local utility u=0.649639 metrics={'f1_val': 0.14208842350203607, 'auprc': 0.14208842350203607, 'loss_val': 3.566212022997935, 'psi': 0.14208842350203607}-{'f1_val': 0.0751521131392863, 'auprc': 0.0751521131392863, 'loss_val': 4.263064173907382, 'psi': 0.0751521131392863}
[S17] START round=20 head_norm_before_train=1.285301 cos_to_last_merge=0.9943 (last merge round=18)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.155095011824418, 'auprc': 0.155095011824418, 'loss_val': 1.0210899351990321, 'psi': 0.155095011824418}-{'f1_val': 0.17479479205944493, 'auprc': 0.17479479205944493, 'loss_val': 1.0515499312230419, 'psi': 0.17479479205944493}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:37111
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:37114
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.142)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:37117
[S6] not sending this round → trigger blocked (psi=0.102)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.9033
[S14] RECEIVED delta(kind=head bytes=1793) from S10
[S14] cosine check vs S10: cos=-0.0100
[S14] DROPPED delta from S10 (cos=-0.0100 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=-0.0132
[S10] DROPPED delta from S7 (cos=-0.0132 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=-0.0110
[S16] DROPPED delta from S15 (cos=-0.0110 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S4
[S9] cosine check vs S4: cos=0.5714
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.056 → S4@127.0.0.1:37104
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.2207 head_norm=1.093434
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.744208e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.2416 head_norm=1.214303 delta_norm=0.674421
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.105 → S13@127.0.0.1:37113
[S5] ⇄ pheromone p=0.073 → S9@127.0.0.1:37110
[S11] ⇄ pheromone p=0.099 → S14@127.0.0.1:37114
[S2] ⇄ pheromone p=0.139 → S8@127.0.0.1:37109
[S14] ⇄ pheromone p=0.150 → S4@127.0.0.1:37104
[S13] ⇄ pheromone p=0.132 → S16@127.0.0.1:37116
[S6] ⇄ pheromone p=0.403 → S11@127.0.0.1:37112
[S10] ⇄ pheromone p=0.105 → S14@127.0.0.1:37114
[S7] ⇄ pheromone p=0.178 → S10@127.0.0.1:37111
[S8] ⇄ pheromone p=0.047 → S17@127.0.0.1:37117
[S15] ⇄ pheromone p=0.176 → S16@127.0.0.1:37116
[S4] ⇄ pheromone p=0.154 → S9@127.0.0.1:37110
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.1551 head_norm=1.329198
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.459236e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.2086 head_norm=1.425435 delta_norm=0.345924
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.055 → S9@127.0.0.1:37110
[S16] ⇄ pheromone p=0.242 → S8@127.0.0.1:37109
[S2] START round=21 head_norm_before_train=1.731255 (no previous merge yet)
[S2] round=21 local utility u=0.219576 metrics={'f1_val': 0.24876176324913324, 'auprc': 0.24876176324913324, 'loss_val': 2.547454102559639, 'psi': 0.24876176324913324}-{'f1_val': 0.23668722966744662, 'auprc': 0.23668722966744662, 'loss_val': 2.877934845949138, 'psi': 0.2366872296674466}
[S3] START round=21 head_norm_before_train=1.888975 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.2755409476855656, 'auprc': 0.2755409476855656, 'loss_val': 2.9142639276717466, 'psi': 0.2755409476855656}-{'f1_val': 0.2809593734703867, 'auprc': 0.2809593734703867, 'loss_val': 2.919066338464585, 'psi': 0.2809593734703867}
[S4] START round=21 head_norm_before_train=1.631917 cos_to_last_merge=0.9620 (last merge round=13)
[S4] round=21 local utility u=0.011854 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.19036834243478, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2140768243264706, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.919075 (no previous merge yet)
[S5] round=21 local utility u=0.028222 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7456578888466057, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.802101816407084, 'psi': 0.3335071121394324}
[S6] START round=21 head_norm_before_train=1.705090 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 5.957322653109318, 'psi': 0.02109124254928932}-{'f1_val': 0.10179184140297369, 'auprc': 0.10179184140297369, 'loss_val': 5.220558030292173, 'psi': 0.10179184140297369}
[S7] START round=21 head_norm_before_train=1.703897 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.8800551944261644, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9578417797516391, 'psi': 0.35976373724718097}
[S8] START round=21 head_norm_before_train=1.592574 cos_to_last_merge=0.9958 (last merge round=18)
[S8] round=21 local utility u=0.235867 metrics={'f1_val': 0.3536695521791004, 'auprc': 0.3536695521791004, 'loss_val': 0.8991376903142128, 'psi': 0.3536695521791004}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9334015239258647, 'psi': 0.30506182380216385}
[S9] START round=21 head_norm_before_train=1.214303 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.21579743008314436, 'auprc': 0.21579743008314436, 'loss_val': 1.5376498957738238, 'psi': 0.21579743008314436}-{'f1_val': 0.22068535825545169, 'auprc': 0.22068535825545169, 'loss_val': 1.5582228515779588, 'psi': 0.2206853582554517}
[S10] START round=21 head_norm_before_train=1.729416 (no previous merge yet)
[S10] round=21 local utility u=0.028380 metrics={'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 2.2856674886415114, 'psi': 0.2494621085345446}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.3429635746236204, 'psi': 0.24952175992348158}
[S11] START round=21 head_norm_before_train=1.667425 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.3244555732604902, 'auprc': 0.3244555732604902, 'loss_val': 2.798350059725636, 'psi': 0.3244555732604902}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 2.845070925931787, 'psi': 0.33162711338607104}
[S13] START round=21 head_norm_before_train=1.052263 cos_to_last_merge=0.9960 (last merge round=19)
[S13] round=21 local utility u=0.179165 metrics={'f1_val': 0.2924057890919139, 'auprc': 0.2924057890919139, 'loss_val': 1.0436053992397898, 'psi': 0.2924057890919139}-{'f1_val': 0.25915762025663897, 'auprc': 0.25915762025663897, 'loss_val': 1.102702666587467, 'psi': 0.25915762025663897}
[S14] START round=21 head_norm_before_train=1.490127 cos_to_last_merge=0.9993 (last merge round=19)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.469478776596985, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.797638506193621, 'psi': 0.0}
[S15] START round=21 head_norm_before_train=1.657825 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.2773884175580967, 'auprc': 0.2773884175580967, 'loss_val': 0.900110282683677, 'psi': 0.2773884175580967}-{'f1_val': 0.28346647300895667, 'auprc': 0.28346647300895667, 'loss_val': 0.8245730445590315, 'psi': 0.28346647300895667}
[S16] START round=21 head_norm_before_train=1.700230 (no previous merge yet)
[S16] round=21 local utility u=0.594929 metrics={'f1_val': 0.19171769043386663, 'auprc': 0.19171769043386663, 'loss_val': 2.8230179784095215, 'psi': 0.19171769043386663}-{'f1_val': 0.14208842350203607, 'auprc': 0.14208842350203607, 'loss_val': 3.566212022997935, 'psi': 0.14208842350203607}
[S17] START round=21 head_norm_before_train=1.425435 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.044096 metrics={'f1_val': 0.16534422263152468, 'auprc': 0.16534422263152468, 'loss_val': 1.0251404598896554, 'psi': 0.16534422263152468}-{'f1_val': 0.155095011824418, 'auprc': 0.155095011824418, 'loss_val': 1.0210899351990321, 'psi': 0.155095011824418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:37109
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.192)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.9617
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=-0.0076
[S14] DROPPED delta from S10 (cos=-0.0076 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=-0.0156
[S16] DROPPED delta from S13 (cos=-0.0156 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=0.8671
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.0478
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=0.9418
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.3165
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.2158 head_norm=1.322738
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.031364e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.2201 head_norm=1.073665 delta_norm=0.503136
[S9] aggregate: ACCEPT kept=['S4', 'S5', 'S17'] (k=3/3) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.3537 head_norm=1.626981
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.935175e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.3051 head_norm=1.661438 delta_norm=0.293518
[S8] aggregate: ROLLBACK (f1_val pre=0.354 post=0.305 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.1653 head_norm=1.455380
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.295390e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.2299 head_norm=1.526405 delta_norm=0.229539
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.745277 (no previous merge yet)
[S2] round=22 local utility u=0.506570 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6027573281685483, 'psi': 0.3674775928297055}-{'f1_val': 0.24876176324913324, 'auprc': 0.24876176324913324, 'loss_val': 2.547454102559639, 'psi': 0.24876176324913324}
[S3] START round=22 head_norm_before_train=1.902864 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.27424521229469095, 'auprc': 0.27424521229469095, 'loss_val': 2.9282703706916404, 'psi': 0.27424521229469095}-{'f1_val': 0.2755409476855656, 'auprc': 0.2755409476855656, 'loss_val': 2.9142639276717466, 'psi': 0.2755409476855656}
[S4] START round=22 head_norm_before_train=1.657125 cos_to_last_merge=0.9583 (last merge round=13)
[S4] round=22 local utility u=0.010958 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1684528122905222, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.19036834243478, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.949826 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7488371020510143, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7456578888466057, 'psi': 0.3335071121394324}
[S6] START round=22 head_norm_before_train=1.713718 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.973663693573236, 'psi': 0.02153000458085204}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 5.957322653109318, 'psi': 0.02109124254928932}
[S7] START round=22 head_norm_before_train=1.717548 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9348361018193685, 'psi': 0.23968964488212474}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.8800551944261644, 'psi': 0.23968964488212474}
[S8] START round=22 head_norm_before_train=1.661438 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=1.000000 metrics={'f1_val': 0.7442374974409871, 'auprc': 0.7442374974409871, 'loss_val': 0.936598287721299, 'psi': 0.7442374974409871}-{'f1_val': 0.3536695521791004, 'auprc': 0.3536695521791004, 'loss_val': 0.8991376903142128, 'psi': 0.3536695521791004}
[S9] START round=22 head_norm_before_train=1.073665 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.746129 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.42126090579316, 'psi': 0.36867172340800847}-{'f1_val': 0.21579743008314436, 'auprc': 0.21579743008314436, 'loss_val': 1.5376498957738238, 'psi': 0.21579743008314436}
[S10] START round=22 head_norm_before_train=1.745994 (no previous merge yet)
[S10] round=22 local utility u=0.170794 metrics={'f1_val': 0.25015091934533473, 'auprc': 0.25015091934533473, 'loss_val': 1.9502778049722196, 'psi': 0.25015091934533473}-{'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 2.2856674886415114, 'psi': 0.2494621085345446}
[S11] START round=22 head_norm_before_train=1.684706 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.3240867060785205, 'auprc': 0.3240867060785205, 'loss_val': 2.8138604843276247, 'psi': 0.3240867060785205}-{'f1_val': 0.3244555732604902, 'auprc': 0.3244555732604902, 'loss_val': 2.798350059725636, 'psi': 0.3244555732604902}
[S13] START round=22 head_norm_before_train=1.090165 cos_to_last_merge=0.9865 (last merge round=19)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.24025513819985825, 'auprc': 0.24025513819985825, 'loss_val': 1.025053541776937, 'psi': 0.24025513819985825}-{'f1_val': 0.2924057890919139, 'auprc': 0.2924057890919139, 'loss_val': 1.0436053992397898, 'psi': 0.2924057890919139}
[S14] START round=22 head_norm_before_train=1.519364 cos_to_last_merge=0.9972 (last merge round=19)
[S14] round=22 local utility u=0.097264 metrics={'f1_val': 0.015482695810564663, 'auprc': 0.015482695810564663, 'loss_val': 4.41429497455424, 'psi': 0.015482695810564663}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.469478776596985, 'psi': 0.0}
[S15] START round=22 head_norm_before_train=1.679913 (no previous merge yet)
[S15] round=22 local utility u=0.057437 metrics={'f1_val': 0.2826297913634158, 'auprc': 0.2826297913634158, 'loss_val': 0.8324093015645136, 'psi': 0.2826297913634158}-{'f1_val': 0.2773884175580967, 'auprc': 0.2773884175580967, 'loss_val': 0.900110282683677, 'psi': 0.2773884175580967}
[S16] START round=22 head_norm_before_train=1.716536 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.015225666122892877, 'auprc': 0.015225666122892877, 'loss_val': 4.797300155154354, 'psi': 0.015225666122892877}-{'f1_val': 0.19171769043386663, 'auprc': 0.19171769043386663, 'loss_val': 2.8230179784095215, 'psi': 0.19171769043386663}
[S17] START round=22 head_norm_before_train=1.526405 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.279694 metrics={'f1_val': 0.22738111856554988, 'auprc': 0.22738111856554988, 'loss_val': 1.0240836162721199, 'psi': 0.22738111856554988}-{'f1_val': 0.16534422263152468, 'auprc': 0.16534422263152468, 'loss_val': 1.0251404598896554, 'psi': 0.16534422263152468}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.015)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:37109
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:37113
[S9] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S2
[S8] cosine check vs S2: cos=0.9798
[S16] RECEIVED delta(kind=head bytes=1792) from S15
[S16] cosine check vs S15: cos=-0.0086
[S16] DROPPED delta from S15 (cos=-0.0086 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9670
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=-0.0058
[S14] DROPPED delta from S10 (cos=-0.0058 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S9
[S13] cosine check vs S9: cos=0.6186
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=0.7744
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.4686
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.2403 head_norm=1.127422
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.059757e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.2402 head_norm=1.040971 delta_norm=0.505976
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.3687 head_norm=1.186669
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.093083e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.3687 head_norm=1.139599 delta_norm=0.309308
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.7442 head_norm=1.692461
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.762350e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9952 head_norm=1.716484 delta_norm=0.176235
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.2274 head_norm=1.549541
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.200292e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.2302 head_norm=1.607588 delta_norm=0.220029
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.757932 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.2593094546627945, 'auprc': 0.2593094546627945, 'loss_val': 2.6850682188034423, 'psi': 0.2593094546627945}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6027573281685483, 'psi': 0.3674775928297055}
[S3] START round=23 head_norm_before_train=1.916767 (no previous merge yet)
[S3] round=23 local utility u=0.011553 metrics={'f1_val': 0.2812915878685998, 'auprc': 0.2812915878685998, 'loss_val': 2.9685819392553467, 'psi': 0.2812915878685998}-{'f1_val': 0.27424521229469095, 'auprc': 0.27424521229469095, 'loss_val': 2.9282703706916404, 'psi': 0.27424521229469095}
[S4] START round=23 head_norm_before_train=1.680508 cos_to_last_merge=0.9553 (last merge round=13)
[S4] round=23 local utility u=0.011228 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1459964912632208, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1684528122905222, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.984679 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.768317172692052, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7488371020510143, 'psi': 0.3335071121394324}
[S6] START round=23 head_norm_before_train=1.721733 (no previous merge yet)
[S6] round=23 local utility u=0.498932 metrics={'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 5.676161374861244, 'psi': 0.09934790947449175}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.973663693573236, 'psi': 0.02153000458085204}
[S7] START round=23 head_norm_before_train=1.730064 (no previous merge yet)
[S7] round=23 local utility u=0.505897 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0037093969510584, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9348361018193685, 'psi': 0.23968964488212474}
[S8] START round=23 head_norm_before_train=1.716484 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9410291999970958, 'psi': 0.35939447907390915}-{'f1_val': 0.7442374974409871, 'auprc': 0.7442374974409871, 'loss_val': 0.936598287721299, 'psi': 0.7442374974409871}
[S9] START round=23 head_norm_before_train=1.139599 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4555851410764582, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.42126090579316, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.760968 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 2.059428650378916, 'psi': 0.2494621085345446}-{'f1_val': 0.25015091934533473, 'auprc': 0.25015091934533473, 'loss_val': 1.9502778049722196, 'psi': 0.25015091934533473}
[S11] START round=23 head_norm_before_train=1.703806 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.9536748471637746, 'psi': 0.33154997286190585}-{'f1_val': 0.3240867060785205, 'auprc': 0.3240867060785205, 'loss_val': 2.8138604843276247, 'psi': 0.3240867060785205}
[S13] START round=23 head_norm_before_train=1.040971 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.24008498583569404, 'auprc': 0.24008498583569404, 'loss_val': 1.0878982008395122, 'psi': 0.24008498583569404}-{'f1_val': 0.24025513819985825, 'auprc': 0.24025513819985825, 'loss_val': 1.025053541776937, 'psi': 0.24025513819985825}
[S14] START round=23 head_norm_before_train=1.544607 cos_to_last_merge=0.9947 (last merge round=19)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.024154589371980676, 'auprc': 0.024154589371980676, 'loss_val': 4.805460214986026, 'psi': 0.024154589371980676}-{'f1_val': 0.015482695810564663, 'auprc': 0.015482695810564663, 'loss_val': 4.41429497455424, 'psi': 0.015482695810564663}
[S15] START round=23 head_norm_before_train=1.705309 (no previous merge yet)
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.6079992028723378, 'auprc': 0.6079992028723378, 'loss_val': 0.788364806882165, 'psi': 0.6079992028723378}-{'f1_val': 0.2826297913634158, 'auprc': 0.2826297913634158, 'loss_val': 0.8324093015645136, 'psi': 0.2826297913634158}
[S16] START round=23 head_norm_before_train=1.731055 (no previous merge yet)
[S16] round=23 local utility u=1.000000 metrics={'f1_val': 0.14595062797747943, 'auprc': 0.14595062797747943, 'loss_val': 3.424297483460966, 'psi': 0.14595062797747943}-{'f1_val': 0.015225666122892877, 'auprc': 0.015225666122892877, 'loss_val': 4.797300155154354, 'psi': 0.015225666122892877}
[S17] START round=23 head_norm_before_train=1.607588 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.142848 metrics={'f1_val': 0.25861509627855994, 'auprc': 0.25861509627855994, 'loss_val': 1.0194936178318033, 'psi': 0.25861509627855994}-{'f1_val': 0.22738111856554988, 'auprc': 0.22738111856554988, 'loss_val': 1.0240836162721199, 'psi': 0.22738111856554988}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:37104
[S16] not sending this round → trigger blocked (psi=0.146)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:37116
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:37110
[S6] not sending this round → trigger blocked (psi=0.099)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:37111
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] cosine check vs S3: cos=0.8415
[S9] RECEIVED delta(kind=head bytes=1804) from S4
[S9] cosine check vs S4: cos=0.7546
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=-0.0079
[S16] DROPPED delta from S15 (cos=-0.0079 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=-0.0128
[S10] DROPPED delta from S7 (cos=-0.0128 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] cosine check vs S17: cos=0.5740
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.3687 head_norm=1.250565
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.551536e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.3687 head_norm=1.204674 delta_norm=0.255154
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.3568 head_norm=1.697230
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.221936e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.3568 head_norm=1.739606 delta_norm=0.522194
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.769391 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.20664087685364282, 'auprc': 0.20664087685364282, 'loss_val': 3.533472540099104, 'psi': 0.20664087685364282}-{'f1_val': 0.2593094546627945, 'auprc': 0.2593094546627945, 'loss_val': 2.6850682188034423, 'psi': 0.2593094546627945}
[S3] START round=24 head_norm_before_train=1.928016 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.28265817023213474, 'auprc': 0.28265817023213474, 'loss_val': 3.3110792999280028, 'psi': 0.28265817023213474}-{'f1_val': 0.2812915878685998, 'auprc': 0.2812915878685998, 'loss_val': 2.9685819392553467, 'psi': 0.2812915878685998}
[S4] START round=24 head_norm_before_train=1.739606 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.005131 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1357347810627614, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1459964912632208, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=2.006661 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.786264377413305, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.768317172692052, 'psi': 0.3335071121394324}
[S6] START round=24 head_norm_before_train=1.731246 (no previous merge yet)
[S6] round=24 local utility u=0.034078 metrics={'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 5.610769677127854, 'psi': 0.09965504024530472}-{'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 5.676161374861244, 'psi': 0.09934790947449175}
[S7] START round=24 head_norm_before_train=1.755961 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9659292314612612, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0037093969510584, 'psi': 0.35976373724718097}
[S8] START round=24 head_norm_before_train=1.749702 cos_to_last_merge=0.9990 (last merge round=22)
[S8] round=24 local utility u=0.020840 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8993500692091903, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9410291999970958, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.204674 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4917175237527285, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4555851410764582, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.777682 (no previous merge yet)
[S10] round=24 local utility u=0.106965 metrics={'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.8460378317442074, 'psi': 0.24952198852772467}-{'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 2.059428650378916, 'psi': 0.2494621085345446}
[S11] START round=24 head_norm_before_train=1.724777 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.3249734002127983, 'auprc': 0.3249734002127983, 'loss_val': 2.9448746777564727, 'psi': 0.3249734002127983}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.9536748471637746, 'psi': 0.33154997286190585}
[S13] START round=24 head_norm_before_train=1.069553 cos_to_last_merge=0.9983 (last merge round=22)
[S13] round=24 local utility u=0.018776 metrics={'f1_val': 0.24017003188097766, 'auprc': 0.24017003188097766, 'loss_val': 1.0511124849406712, 'psi': 0.24017003188097766}-{'f1_val': 0.24008498583569404, 'auprc': 0.24008498583569404, 'loss_val': 1.0878982008395122, 'psi': 0.24008498583569404}
[S14] START round=24 head_norm_before_train=1.564480 cos_to_last_merge=0.9925 (last merge round=19)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.060652465067738, 'psi': 0.0}-{'f1_val': 0.024154589371980676, 'auprc': 0.024154589371980676, 'loss_val': 4.805460214986026, 'psi': 0.024154589371980676}
[S15] START round=24 head_norm_before_train=1.733703 (no previous merge yet)
[S15] round=24 local utility u=0.055846 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7524223006772559, 'psi': 0.6164158146233559}-{'f1_val': 0.6079992028723378, 'auprc': 0.6079992028723378, 'loss_val': 0.788364806882165, 'psi': 0.6079992028723378}
[S16] START round=24 head_norm_before_train=1.744508 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.14819606152077044, 'auprc': 0.14819606152077044, 'loss_val': 3.5500223309660743, 'psi': 0.14819606152077044}-{'f1_val': 0.14595062797747943, 'auprc': 0.14595062797747943, 'loss_val': 3.424297483460966, 'psi': 0.14595062797747943}
[S17] START round=24 head_norm_before_train=1.630895 cos_to_last_merge=0.9976 (last merge round=22)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.2039951713973338, 'auprc': 0.2039951713973338, 'loss_val': 1.0730678490354484, 'psi': 0.2039951713973338}-{'f1_val': 0.25861509627855994, 'auprc': 0.25861509627855994, 'loss_val': 1.0194936178318033, 'psi': 0.25861509627855994}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:37117
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:37114
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:37110
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.100)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9679
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=-0.0038
[S14] DROPPED delta from S10 (cos=-0.0038 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S15
[S16] cosine check vs S15: cos=-0.0077
[S16] DROPPED delta from S15 (cos=-0.0077 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=0.0051
[S9] RECEIVED delta(kind=head bytes=1798) from S4
[S9] cosine check vs S4: cos=0.7341
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.3687 head_norm=1.306372
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.966276e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.3687 head_norm=1.428693 delta_norm=0.596628
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.2040 head_norm=1.662619
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.268662e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.2044 head_norm=1.710369 delta_norm=0.226866
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.1482 head_norm=1.756165
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.034693e+00
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.1491 head_norm=1.039427 delta_norm=1.034693
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.779272 (no previous merge yet)
[S2] round=25 local utility u=1.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.677736877777646, 'psi': 0.3674775928297055}-{'f1_val': 0.20664087685364282, 'auprc': 0.20664087685364282, 'loss_val': 3.533472540099104, 'psi': 0.20664087685364282}
[S3] START round=25 head_norm_before_train=1.932606 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.18398191122218255, 'auprc': 0.18398191122218255, 'loss_val': 4.195424705538228, 'psi': 0.18398191122218255}-{'f1_val': 0.28265817023213474, 'auprc': 0.28265817023213474, 'loss_val': 3.3110792999280028, 'psi': 0.28265817023213474}
[S4] START round=25 head_norm_before_train=1.757170 cos_to_last_merge=0.9998 (last merge round=23)
[S4] round=25 local utility u=0.011809 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1121163524920685, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1357347810627614, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=2.029711 (no previous merge yet)
[S5] round=25 local utility u=0.020439 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.745385670755542, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.786264377413305, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.740703 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.384597503224169, 'psi': 0.0}-{'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 5.610769677127854, 'psi': 0.09965504024530472}
[S7] START round=25 head_norm_before_train=1.774043 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 1.006394015626128, 'psi': 0.23946016959273855}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9659292314612612, 'psi': 0.23968964488212474}
[S8] START round=25 head_norm_before_train=1.785877 cos_to_last_merge=0.9964 (last merge round=22)
[S8] round=25 local utility u=0.011958 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8754349756186968, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8993500692091903, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.428693 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000475 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4907679285324886, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4917175237527285, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.804537 (no previous merge yet)
[S10] round=25 local utility u=0.052376 metrics={'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.7412866488087968, 'psi': 0.24952198852772467}-{'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.8460378317442074, 'psi': 0.24952198852772467}
[S11] START round=25 head_norm_before_train=1.744618 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.328948380644665, 'auprc': 0.328948380644665, 'loss_val': 3.0101973408122515, 'psi': 0.328948380644665}-{'f1_val': 0.3249734002127983, 'auprc': 0.3249734002127983, 'loss_val': 2.9448746777564727, 'psi': 0.3249734002127983}
[S13] START round=25 head_norm_before_train=1.103576 cos_to_last_merge=0.9934 (last merge round=22)
[S13] round=25 local utility u=0.016797 metrics={'f1_val': 0.24021257750221436, 'auprc': 0.24021257750221436, 'loss_val': 1.017901569337195, 'psi': 0.24021257750221436}-{'f1_val': 0.24017003188097766, 'auprc': 0.24017003188097766, 'loss_val': 1.0511124849406712, 'psi': 0.24017003188097766}
[S14] START round=25 head_norm_before_train=1.585898 cos_to_last_merge=0.9899 (last merge round=19)
[S14] round=25 local utility u=0.835913 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.612170324185237, 'psi': 0.13592717296421}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.060652465067738, 'psi': 0.0}
[S15] START round=25 head_norm_before_train=1.759963 (no previous merge yet)
[S15] round=25 local utility u=0.035218 metrics={'f1_val': 0.6166941009299512, 'auprc': 0.6166941009299512, 'loss_val': 0.6844907446475738, 'psi': 0.6166941009299512}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7524223006772559, 'psi': 0.6164158146233559}
[S16] START round=25 head_norm_before_train=1.039427 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.458907 metrics={'f1_val': 0.13354037267080746, 'auprc': 0.13354037267080746, 'loss_val': 2.500306953378587, 'psi': 0.13354037267080746}-{'f1_val': 0.14819606152077044, 'auprc': 0.14819606152077044, 'loss_val': 3.5500223309660743, 'psi': 0.14819606152077044}
[S17] START round=25 head_norm_before_train=1.710369 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.280117 metrics={'f1_val': 0.26014749596339004, 'auprc': 0.26014749596339004, 'loss_val': 1.018205594127165, 'psi': 0.26014749596339004}-{'f1_val': 0.2039951713973338, 'auprc': 0.2039951713973338, 'loss_val': 1.0730678490354484, 'psi': 0.2039951713973338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:37109
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:37116
[S16] not sending this round → trigger blocked (psi=0.134)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:37113
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.9864
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=-0.0035
[S14] DROPPED delta from S10 (cos=-0.0035 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] cosine check vs S9: cos=0.7337
[S16] RECEIVED delta(kind=head bytes=1803) from S15
[S16] cosine check vs S15: cos=-0.0511
[S16] DROPPED delta from S15 (cos=-0.0511 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=0.5093
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=0.9295
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=0.9776
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.0834
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.3493
[S7] ⇄ pheromone p=0.123 → S10@127.0.0.1:37111
[S14] ⇄ pheromone p=0.226 → S4@127.0.0.1:37104
[S6] ⇄ pheromone p=0.201 → S11@127.0.0.1:37112
[S3] ⇄ pheromone p=0.020 → S4@127.0.0.1:37104
[S11] ⇄ pheromone p=0.033 → S14@127.0.0.1:37114
[S2] ⇄ pheromone p=0.316 → S8@127.0.0.1:37109
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.2402 head_norm=1.138410
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.133944e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.2402 head_norm=1.235072 delta_norm=0.513394
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.064 → S16@127.0.0.1:37116
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.3687 head_norm=1.510621
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.117466e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.3687 head_norm=1.238939 delta_norm=0.511747
[S9] aggregate: ACCEPT kept=['S4', 'S5', 'S17'] (k=3/3) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.111 → S13@127.0.0.1:37113
[S4] ⇄ pheromone p=0.057 → S9@127.0.0.1:37110
[S10] ⇄ pheromone p=0.082 → S14@127.0.0.1:37114
[S5] ⇄ pheromone p=0.030 → S9@127.0.0.1:37110
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.3594 head_norm=1.822090
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.918041e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.3594 head_norm=1.794608 delta_norm=0.191804
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.143 → S17@127.0.0.1:37117
[S15] ⇄ pheromone p=0.207 → S16@127.0.0.1:37116
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.1335 head_norm=1.078911
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.497590e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.1354 head_norm=0.963213 delta_norm=0.549759
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.348 → S8@127.0.0.1:37109
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.2601 head_norm=1.733294
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.530093e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.2605 head_norm=1.771651 delta_norm=0.153009
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.125 → S9@127.0.0.1:37110
[S2] START round=26 head_norm_before_train=1.787400 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.689022530723307, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.677736877777646, 'psi': 0.3674775928297055}
[S3] START round=26 head_norm_before_train=1.937963 (no previous merge yet)
[S3] round=26 local utility u=0.934429 metrics={'f1_val': 0.2861967694566813, 'auprc': 0.2861967694566813, 'loss_val': 3.2465012039680206, 'psi': 0.2861967694566813}-{'f1_val': 0.18398191122218255, 'auprc': 0.18398191122218255, 'loss_val': 4.195424705538228, 'psi': 0.18398191122218255}
[S4] START round=26 head_norm_before_train=1.784828 cos_to_last_merge=0.9991 (last merge round=23)
[S4] round=26 local utility u=0.009080 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0939567958908487, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1121163524920685, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=2.053377 (no previous merge yet)
[S5] round=26 local utility u=0.001472 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.742441386968671, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.745385670755542, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.749231 (no previous merge yet)
[S6] round=26 local utility u=0.598631 metrics={'f1_val': 0.07280163599182005, 'auprc': 0.07280163599182005, 'loss_val': 5.8425506561264315, 'psi': 0.07280163599182005}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.384597503224169, 'psi': 0.0}
[S7] START round=26 head_norm_before_train=1.788304 (no previous merge yet)
[S7] round=26 local utility u=0.029300 metrics={'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 0.9471050045210797, 'psi': 0.23938362300662963}-{'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 1.006394015626128, 'psi': 0.23946016959273855}
[S8] START round=26 head_norm_before_train=1.794608 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9057849139992991, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8754349756186968, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.238939 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.033660 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4234488216258727, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4907679285324886, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.836664 (no previous merge yet)
[S10] round=26 local utility u=0.072687 metrics={'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.5959120789574612, 'psi': 0.24952198852772467}-{'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.7412866488087968, 'psi': 0.24952198852772467}
[S11] START round=26 head_norm_before_train=1.763621 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.3314728682170543, 'auprc': 0.3314728682170543, 'loss_val': 3.062500966008494, 'psi': 0.3314728682170543}-{'f1_val': 0.328948380644665, 'auprc': 0.328948380644665, 'loss_val': 3.0101973408122515, 'psi': 0.328948380644665}
[S13] START round=26 head_norm_before_train=1.235072 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.24021257750221436, 'auprc': 0.24021257750221436, 'loss_val': 1.0808500710792068, 'psi': 0.24021257750221436}-{'f1_val': 0.24021257750221436, 'auprc': 0.24021257750221436, 'loss_val': 1.017901569337195, 'psi': 0.24021257750221436}
[S14] START round=26 head_norm_before_train=1.604975 cos_to_last_merge=0.9873 (last merge round=19)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.12683916793505834, 'auprc': 0.12683916793505834, 'loss_val': 4.705065045588377, 'psi': 0.12683916793505834}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.612170324185237, 'psi': 0.13592717296421}
[S15] START round=26 head_norm_before_train=1.787734 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6835653971166062, 'psi': 0.6163342951580373}-{'f1_val': 0.6166941009299512, 'auprc': 0.6166941009299512, 'loss_val': 0.6844907446475738, 'psi': 0.6166941009299512}
[S16] START round=26 head_norm_before_train=0.963213 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.143926 metrics={'f1_val': 0.12307692307692308, 'auprc': 0.12307692307692308, 'loss_val': 2.1182846163526423, 'psi': 0.12307692307692308}-{'f1_val': 0.13354037267080746, 'auprc': 0.13354037267080746, 'loss_val': 2.500306953378587, 'psi': 0.13354037267080746}
[S17] START round=26 head_norm_before_train=1.771651 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.2600214678205833, 'auprc': 0.2600214678205833, 'loss_val': 1.0263381692496132, 'psi': 0.2600214678205833}-{'f1_val': 0.26014749596339004, 'auprc': 0.26014749596339004, 'loss_val': 1.018205594127165, 'psi': 0.26014749596339004}
[S16] not sending this round → trigger blocked (psi=0.123)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:37117
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:37108
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.073)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] cosine check vs S9: cos=0.4972
[S7] RECEIVED delta(kind=head bytes=1804) from S10
[S7] cosine check vs S10: cos=-0.0114
[S7] DROPPED delta from S10 (cos=-0.0114 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=-0.0844
[S14] DROPPED delta from S4 (cos=-0.0844 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.2600 head_norm=1.795005
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.083103e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.2616 head_norm=1.355356 delta_norm=0.808310
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.795298 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.25034267912772584, 'auprc': 0.25034267912772584, 'loss_val': 2.675328488053986, 'psi': 0.25034267912772584}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.689022530723307, 'psi': 0.3674775928297055}
[S3] START round=27 head_norm_before_train=1.944323 (no previous merge yet)
[S3] round=27 local utility u=0.005222 metrics={'f1_val': 0.2836056176554887, 'auprc': 0.2836056176554887, 'loss_val': 3.212735855178488, 'psi': 0.2836056176554887}-{'f1_val': 0.2861967694566813, 'auprc': 0.2861967694566813, 'loss_val': 3.2465012039680206, 'psi': 0.2861967694566813}
[S4] START round=27 head_norm_before_train=1.815808 cos_to_last_merge=0.9979 (last merge round=23)
[S4] round=27 local utility u=0.004295 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0853662644046067, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0939567958908487, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=2.076131 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.76288675421607, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.742441386968671, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.758496 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.025442980463425715, 'auprc': 0.025442980463425715, 'loss_val': 6.084151562470851, 'psi': 0.025442980463425715}-{'f1_val': 0.07280163599182005, 'auprc': 0.07280163599182005, 'loss_val': 5.8425506561264315, 'psi': 0.07280163599182005}
[S7] START round=27 head_norm_before_train=1.798837 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.9792602690254341, 'psi': 0.23953668875753775}-{'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 0.9471050045210797, 'psi': 0.23938362300662963}
[S8] START round=27 head_norm_before_train=1.827186 cos_to_last_merge=0.9995 (last merge round=25)
[S8] round=27 local utility u=0.002210 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9013642665708608, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9057849139992991, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.326147 cos_to_last_merge=0.9929 (last merge round=25)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6360886369446221, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4234488216258727, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.871099 (no previous merge yet)
[S10] round=27 local utility u=0.067089 metrics={'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.4617339329132213, 'psi': 0.24952198852772467}-{'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.5959120789574612, 'psi': 0.24952198852772467}
[S11] START round=27 head_norm_before_train=1.781294 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.32879661668589005, 'auprc': 0.32879661668589005, 'loss_val': 3.0871507910654623, 'psi': 0.32879661668589005}-{'f1_val': 0.3314728682170543, 'auprc': 0.3314728682170543, 'loss_val': 3.062500966008494, 'psi': 0.3314728682170543}
[S13] START round=27 head_norm_before_train=1.257000 cos_to_last_merge=0.9988 (last merge round=25)
[S13] round=27 local utility u=0.015026 metrics={'f1_val': 0.24017003188097766, 'auprc': 0.24017003188097766, 'loss_val': 1.0504156197141745, 'psi': 0.24017003188097766}-{'f1_val': 0.24021257750221436, 'auprc': 0.24021257750221436, 'loss_val': 1.0808500710792068, 'psi': 0.24021257750221436}
[S14] START round=27 head_norm_before_train=1.625907 cos_to_last_merge=0.9841 (last merge round=19)
[S14] round=27 local utility u=0.020203 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.744663793854741, 'psi': 0.13572854291417166}-{'f1_val': 0.12683916793505834, 'auprc': 0.12683916793505834, 'loss_val': 4.705065045588377, 'psi': 0.12683916793505834}
[S15] START round=27 head_norm_before_train=1.815295 (no previous merge yet)
[S15] round=27 local utility u=0.019694 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6441782567205425, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6835653971166062, 'psi': 0.6163342951580373}
[S16] START round=27 head_norm_before_train=1.008554 cos_to_last_merge=0.9928 (last merge round=25)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.14031245437290116, 'auprc': 0.14031245437290116, 'loss_val': 2.35305547434717, 'psi': 0.14031245437290116}-{'f1_val': 0.12307692307692308, 'auprc': 0.12307692307692308, 'loss_val': 2.1182846163526423, 'psi': 0.12307692307692308}
[S17] START round=27 head_norm_before_train=1.355356 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.2506743525795499, 'auprc': 0.2506743525795499, 'loss_val': 1.0027838417203034, 'psi': 0.2506743525795499}-{'f1_val': 0.2600214678205833, 'auprc': 0.2600214678205833, 'loss_val': 1.0263381692496132, 'psi': 0.2600214678205833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[S14] not sending this round → trigger blocked (psi=0.136)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:37108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=-0.0114
[S7] DROPPED delta from S10 (cos=-0.0114 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=-0.0842
[S14] DROPPED delta from S4 (cos=-0.0842 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=0.3528
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] cosine check vs S13: cos=0.9290
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.3687 head_norm=1.410802
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.615506e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.3687 head_norm=1.321334 delta_norm=0.261551
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.1403 head_norm=1.083230
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.966178e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.1425 head_norm=1.230960 delta_norm=0.896618
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.803611 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.20864405420575735, 'auprc': 0.20864405420575735, 'loss_val': 3.6536855570262117, 'psi': 0.20864405420575735}-{'f1_val': 0.25034267912772584, 'auprc': 0.25034267912772584, 'loss_val': 2.675328488053986, 'psi': 0.25034267912772584}
[S3] START round=28 head_norm_before_train=1.950285 (no previous merge yet)
[S3] round=28 local utility u=0.002575 metrics={'f1_val': 0.2826734780757769, 'auprc': 0.2826734780757769, 'loss_val': 3.199197217015866, 'psi': 0.2826734780757769}-{'f1_val': 0.2836056176554887, 'auprc': 0.2836056176554887, 'loss_val': 3.212735855178488, 'psi': 0.2836056176554887}
[S4] START round=28 head_norm_before_train=1.843772 cos_to_last_merge=0.9966 (last merge round=23)
[S4] round=28 local utility u=0.000762 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0838424051085613, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0853662644046067, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=2.089962 (no previous merge yet)
[S5] round=28 local utility u=0.042712 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.677463236703139, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.76288675421607, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.769360 (no previous merge yet)
[S6] round=28 local utility u=0.003001 metrics={'f1_val': 0.03140421713772992, 'auprc': 0.03140421713772992, 'loss_val': 6.131800300122736, 'psi': 0.03140421713772992}-{'f1_val': 0.025442980463425715, 'auprc': 0.025442980463425715, 'loss_val': 6.084151562470851, 'psi': 0.025442980463425715}
[S7] START round=28 head_norm_before_train=1.809437 (no previous merge yet)
[S7] round=28 local utility u=0.042589 metrics={'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 0.8927055433619647, 'psi': 0.23938362300662963}-{'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.9792602690254341, 'psi': 0.23953668875753775}
[S8] START round=28 head_norm_before_train=1.861447 cos_to_last_merge=0.9981 (last merge round=25)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.915192006658187, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9013642665708608, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.321334 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.846878936564293, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6360886369446221, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.904636 (no previous merge yet)
[S10] round=28 local utility u=0.015438 metrics={'f1_val': 0.25451263107295236, 'auprc': 0.25451263107295236, 'loss_val': 1.4757731031451244, 'psi': 0.25451263107295236}-{'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.4617339329132213, 'psi': 0.24952198852772467}
[S11] START round=28 head_norm_before_train=1.798000 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.33016755462898617, 'auprc': 0.33016755462898617, 'loss_val': 3.1269528341993267, 'psi': 0.33016755462898617}-{'f1_val': 0.32879661668589005, 'auprc': 0.32879661668589005, 'loss_val': 3.0871507910654623, 'psi': 0.32879661668589005}
[S13] START round=28 head_norm_before_train=1.279963 cos_to_last_merge=0.9959 (last merge round=25)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.24010398203946592, 'auprc': 0.24010398203946592, 'loss_val': 1.0566917250825285, 'psi': 0.24010398203946592}-{'f1_val': 0.24017003188097766, 'auprc': 0.24017003188097766, 'loss_val': 1.0504156197141745, 'psi': 0.24017003188097766}
[S14] START round=28 head_norm_before_train=1.649224 cos_to_last_merge=0.9803 (last merge round=19)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13273115042027347, 'auprc': 0.13273115042027347, 'loss_val': 4.808937420670011, 'psi': 0.13273115042027347}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.744663793854741, 'psi': 0.13572854291417166}
[S15] START round=28 head_norm_before_train=1.842486 (no previous merge yet)
[S15] round=28 local utility u=0.010956 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.62425361351953, 'psi': 0.6165550083006743}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6441782567205425, 'psi': 0.6163342951580373}
[S16] START round=28 head_norm_before_train=1.230960 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.0908945431269003, 'auprc': 0.0908945431269003, 'loss_val': 2.3553106308396465, 'psi': 0.0908945431269003}-{'f1_val': 0.14031245437290116, 'auprc': 0.14031245437290116, 'loss_val': 2.35305547434717, 'psi': 0.14031245437290116}
[S17] START round=28 head_norm_before_train=1.387245 cos_to_last_merge=0.9981 (last merge round=26)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.2506743525795499, 'auprc': 0.2506743525795499, 'loss_val': 1.0216064519666872, 'psi': 0.2506743525795499}-{'f1_val': 0.2506743525795499, 'auprc': 0.2506743525795499, 'loss_val': 1.0027838417203034, 'psi': 0.2506743525795499}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:37108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.031)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=-0.0855
[S14] DROPPED delta from S4 (cos=-0.0855 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=-0.0115
[S7] DROPPED delta from S10 (cos=-0.0115 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.811752 (no previous merge yet)
[S2] round=29 local utility u=1.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.711276013052026, 'psi': 0.3674775928297055}-{'f1_val': 0.20864405420575735, 'auprc': 0.20864405420575735, 'loss_val': 3.6536855570262117, 'psi': 0.20864405420575735}
[S3] START round=29 head_norm_before_train=1.957606 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.2877561438051484, 'auprc': 0.2877561438051484, 'loss_val': 3.266675365047363, 'psi': 0.2877561438051484}-{'f1_val': 0.2826734780757769, 'auprc': 0.2826734780757769, 'loss_val': 3.199197217015866, 'psi': 0.2826734780757769}
[S4] START round=29 head_norm_before_train=1.866244 cos_to_last_merge=0.9955 (last merge round=23)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.084388390041393, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0838424051085613, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=2.098160 (no previous merge yet)
[S5] round=29 local utility u=0.038546 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6003705654384413, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.677463236703139, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.780516 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 6.4885288048797465, 'psi': 0.020871559633027524}-{'f1_val': 0.03140421713772992, 'auprc': 0.03140421713772992, 'loss_val': 6.131800300122736, 'psi': 0.03140421713772992}
[S7] START round=29 head_norm_before_train=1.820372 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 0.9661724940009899, 'psi': 0.23946016959273855}-{'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 0.8927055433619647, 'psi': 0.23938362300662963}
[S8] START round=29 head_norm_before_train=1.892131 cos_to_last_merge=0.9964 (last merge round=25)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9497585092289752, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.915192006658187, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.386578 cos_to_last_merge=0.9988 (last merge round=27)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9477709047663372, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.846878936564293, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.934606 (no previous merge yet)
[S10] round=29 local utility u=0.018595 metrics={'f1_val': 0.2507782699347598, 'auprc': 0.2507782699347598, 'loss_val': 1.4049748030000213, 'psi': 0.2507782699347598}-{'f1_val': 0.25451263107295236, 'auprc': 0.25451263107295236, 'loss_val': 1.4757731031451244, 'psi': 0.25451263107295236}
[S11] START round=29 head_norm_before_train=1.813320 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.166967377781965, 'psi': 0.33154997286190585}-{'f1_val': 0.33016755462898617, 'auprc': 0.33016755462898617, 'loss_val': 3.1269528341993267, 'psi': 0.33016755462898617}
[S13] START round=29 head_norm_before_train=1.301795 cos_to_last_merge=0.9922 (last merge round=25)
[S13] round=29 local utility u=0.011121 metrics={'f1_val': 0.24008498583569404, 'auprc': 0.24008498583569404, 'loss_val': 1.034278955205305, 'psi': 0.24008498583569404}-{'f1_val': 0.24010398203946592, 'auprc': 0.24010398203946592, 'loss_val': 1.0566917250825285, 'psi': 0.24010398203946592}
[S14] START round=29 head_norm_before_train=1.672617 cos_to_last_merge=0.9764 (last merge round=19)
[S14] round=29 local utility u=0.003732 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.830236924250044, 'psi': 0.13592717296421}-{'f1_val': 0.13273115042027347, 'auprc': 0.13273115042027347, 'loss_val': 4.808937420670011, 'psi': 0.13273115042027347}
[S15] START round=29 head_norm_before_train=1.869110 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6519254830311952, 'psi': 0.615636807189815}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.62425361351953, 'psi': 0.6165550083006743}
[S16] START round=29 head_norm_before_train=1.280195 cos_to_last_merge=0.9934 (last merge round=27)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.08994708994708994, 'auprc': 0.08994708994708994, 'loss_val': 2.892372723968225, 'psi': 0.08994708994708994}-{'f1_val': 0.0908945431269003, 'auprc': 0.0908945431269003, 'loss_val': 2.3553106308396465, 'psi': 0.0908945431269003}
[S17] START round=29 head_norm_before_train=1.424137 cos_to_last_merge=0.9936 (last merge round=26)
[S17] round=29 local utility u=0.033094 metrics={'f1_val': 0.25981307956391514, 'auprc': 0.25981307956391514, 'loss_val': 1.037667698596901, 'psi': 0.25981307956391514}-{'f1_val': 0.2506743525795499, 'auprc': 0.2506743525795499, 'loss_val': 1.0216064519666872, 'psi': 0.2506743525795499}
[S10] not sending this round → trigger blocked (psi=0.251)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.334)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S13
[S9] cosine check vs S13: cos=0.9712
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.8753
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.3687 head_norm=1.431606
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.745328e-01
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.3687 head_norm=1.364436 delta_norm=0.174533
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.3594 head_norm=1.921012
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.776601e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.3594 head_norm=1.637414 delta_norm=0.477660
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.820142 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.752938426207591, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.711276013052026, 'psi': 0.3674775928297055}
[S3] START round=30 head_norm_before_train=1.966761 (no previous merge yet)
[S3] round=30 local utility u=0.004991 metrics={'f1_val': 0.281269707799033, 'auprc': 0.281269707799033, 'loss_val': 3.1983160723597055, 'psi': 0.281269707799033}-{'f1_val': 0.2877561438051484, 'auprc': 0.2877561438051484, 'loss_val': 3.266675365047363, 'psi': 0.2877561438051484}
[S4] START round=30 head_norm_before_train=1.885471 cos_to_last_merge=0.9940 (last merge round=23)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0923560643819576, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.084388390041393, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=2.109682 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.625455996823406, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6003705654384413, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.791239 (no previous merge yet)
[S6] round=30 local utility u=0.588546 metrics={'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 6.017724600888449, 'psi': 0.09934790947449175}-{'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 6.4885288048797465, 'psi': 0.020871559633027524}
[S7] START round=30 head_norm_before_train=1.833811 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.0296344407197335, 'psi': 0.2396131805157593}-{'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 0.9661724940009899, 'psi': 0.23946016959273855}
[S8] START round=30 head_norm_before_train=1.637414 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9659420619011678, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9497585092289752, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.364436 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9832986817784997, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9477709047663372, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.962206 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 1.5268812172870838, 'psi': 0.2494621085345446}-{'f1_val': 0.2507782699347598, 'auprc': 0.2507782699347598, 'loss_val': 1.4049748030000213, 'psi': 0.2507782699347598}
[S11] START round=30 head_norm_before_train=1.827050 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3310878823073945, 'auprc': 0.3310878823073945, 'loss_val': 3.189419702458588, 'psi': 0.3310878823073945}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.166967377781965, 'psi': 0.33154997286190585}
[S13] START round=30 head_norm_before_train=1.317119 cos_to_last_merge=0.9894 (last merge round=25)
[S13] round=30 local utility u=0.538792 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0353563586293595, 'psi': 0.3599362944611573}-{'f1_val': 0.24008498583569404, 'auprc': 0.24008498583569404, 'loss_val': 1.034278955205305, 'psi': 0.24008498583569404}
[S14] START round=30 head_norm_before_train=1.695229 cos_to_last_merge=0.9726 (last merge round=19)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 4.888599065257939, 'psi': 0.1351317597102535}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.830236924250044, 'psi': 0.13592717296421}
[S15] START round=30 head_norm_before_train=1.891290 (no previous merge yet)
[S15] round=30 local utility u=0.033031 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5933926415463219, 'psi': 0.6164734888353558}-{'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6519254830311952, 'psi': 0.615636807189815}
[S16] START round=30 head_norm_before_train=1.345189 cos_to_last_merge=0.9776 (last merge round=27)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.07588075880758807, 'auprc': 0.07588075880758807, 'loss_val': 3.3006615780528072, 'psi': 0.07588075880758807}-{'f1_val': 0.08994708994708994, 'auprc': 0.08994708994708994, 'loss_val': 2.892372723968225, 'psi': 0.08994708994708994}
[S17] START round=30 head_norm_before_train=1.458863 cos_to_last_merge=0.9886 (last merge round=26)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.2508380816003513, 'auprc': 0.2508380816003513, 'loss_val': 1.0834534540142, 'psi': 0.2508380816003513}-{'f1_val': 0.25981307956391514, 'auprc': 0.25981307956391514, 'loss_val': 1.037667698596901, 'psi': 0.25981307956391514}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.360)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.099)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.047 → S16@127.0.0.1:37116
[S16] ⇄ pheromone p=0.126 → S15@127.0.0.1:37115
[S9] ⇄ pheromone p=0.039 → S17@127.0.0.1:37117
[S10] ⇄ pheromone p=0.045 → S7@127.0.0.1:37108
[S14] ⇄ pheromone p=0.077 → S10@127.0.0.1:37111
[S13] ⇄ pheromone p=0.132 → S9@127.0.0.1:37110
[S11] ⇄ pheromone p=0.011 → S6@127.0.0.1:37107
[S4] ⇄ pheromone p=0.020 → S14@127.0.0.1:37114
[S17] ⇄ pheromone p=0.046 → S8@127.0.0.1:37109
[S2] START round=31 head_norm_before_train=1.828631 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.25043630017452007, 'auprc': 0.25043630017452007, 'loss_val': 2.7485427401966875, 'psi': 0.25043630017452007}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.752938426207591, 'psi': 0.3674775928297055}
[S3] START round=31 head_norm_before_train=1.974740 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.26778465428894654, 'auprc': 0.26778465428894654, 'loss_val': 3.0903519110759636, 'psi': 0.26778465428894654}-{'f1_val': 0.281269707799033, 'auprc': 0.281269707799033, 'loss_val': 3.1983160723597055, 'psi': 0.281269707799033}
[S4] START round=31 head_norm_before_train=1.902263 cos_to_last_merge=0.9924 (last merge round=23)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.103375702291615, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0923560643819576, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=2.116893 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6578378997877, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.625455996823406, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=1.801636 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.5282395092002306, 'psi': 0.021749084249084248}-{'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 6.017724600888449, 'psi': 0.09934790947449175}
[S7] START round=31 head_norm_before_train=1.846273 (no previous merge yet)
[S7] round=31 local utility u=0.021755 metrics={'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 0.9840584255613777, 'psi': 0.23938362300662963}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.0296344407197335, 'psi': 0.2396131805157593}
[S8] START round=31 head_norm_before_train=1.663962 cos_to_last_merge=0.9998 (last merge round=29)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.999155780261321, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9659420619011678, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.399601 cos_to_last_merge=0.9997 (last merge round=29)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0570442517469365, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9832986817784997, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.987555 (no previous merge yet)
[S10] round=31 local utility u=0.009722 metrics={'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.5079763344954462, 'psi': 0.24952198852772467}-{'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 1.5268812172870838, 'psi': 0.2494621085345446}
[S11] START round=31 head_norm_before_train=1.840313 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3271364088440058, 'auprc': 0.3271364088440058, 'loss_val': 3.2016194354927254, 'psi': 0.3271364088440058}-{'f1_val': 0.3310878823073945, 'auprc': 0.3310878823073945, 'loss_val': 3.189419702458588, 'psi': 0.3310878823073945}
[S13] START round=31 head_norm_before_train=1.336129 cos_to_last_merge=0.9861 (last merge round=25)
[S13] round=31 local utility u=0.004377 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0266013833024317, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0353563586293595, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.716217 cos_to_last_merge=0.9690 (last merge round=19)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 4.945666985070761, 'psi': 0.13413413413413414}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 4.888599065257939, 'psi': 0.1351317597102535}
[S15] START round=31 head_norm_before_train=1.909067 (no previous merge yet)
[S15] round=31 local utility u=0.001421 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5918019437052964, 'psi': 0.6166125814646326}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5933926415463219, 'psi': 0.6164734888353558}
[S16] START round=31 head_norm_before_train=1.407338 cos_to_last_merge=0.9612 (last merge round=27)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 3.4366476318735417, 'psi': 0.09008575779434158}-{'f1_val': 0.07588075880758807, 'auprc': 0.07588075880758807, 'loss_val': 3.3006615780528072, 'psi': 0.07588075880758807}
[S17] START round=31 head_norm_before_train=1.487267 cos_to_last_merge=0.9842 (last merge round=26)
[S17] round=31 local utility u=0.152407 metrics={'f1_val': 0.27883962699087744, 'auprc': 0.27883962699087744, 'loss_val': 1.0306530774216063, 'psi': 0.27883962699087744}-{'f1_val': 0.2508380816003513, 'auprc': 0.2508380816003513, 'loss_val': 1.0834534540142, 'psi': 0.2508380816003513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:37111
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:37108
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.617)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S7
[S10] cosine check vs S7: cos=-0.0108
[S10] DROPPED delta from S7 (cos=-0.0108 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.9851
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=-0.0108
[S7] DROPPED delta from S10 (cos=-0.0108 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.9511
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.3594 head_norm=1.690498
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.655718e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.3594 head_norm=1.581390 delta_norm=0.265572
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.3687 head_norm=1.430162
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.262996e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.3687 head_norm=1.386353 delta_norm=0.126300
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.836449 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.26243259436788496, 'auprc': 0.26243259436788496, 'loss_val': 2.9448555486244317, 'psi': 0.26243259436788496}-{'f1_val': 0.25043630017452007, 'auprc': 0.25043630017452007, 'loss_val': 2.7485427401966875, 'psi': 0.25043630017452007}
[S3] START round=32 head_norm_before_train=1.984480 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.26305811597045176, 'auprc': 0.26305811597045176, 'loss_val': 3.1042639082465002, 'psi': 0.26305811597045176}-{'f1_val': 0.26778465428894654, 'auprc': 0.26778465428894654, 'loss_val': 3.0903519110759636, 'psi': 0.26778465428894654}
[S4] START round=32 head_norm_before_train=1.920467 cos_to_last_merge=0.9912 (last merge round=23)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1159828883270417, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.103375702291615, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=2.121349 (no previous merge yet)
[S5] round=32 local utility u=0.011130 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6355788354695404, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6578378997877, 'psi': 0.3335071121394324}
[S6] START round=32 head_norm_before_train=1.811455 (no previous merge yet)
[S6] round=32 local utility u=0.374567 metrics={'f1_val': 0.07866075030254134, 'auprc': 0.07866075030254134, 'loss_val': 6.291311341139575, 'psi': 0.07866075030254134}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.5282395092002306, 'psi': 0.021749084249084248}
[S7] START round=32 head_norm_before_train=1.857250 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.23853979652902454, 'auprc': 0.23853979652902454, 'loss_val': 1.0345448514491022, 'psi': 0.23853979652902452}-{'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 0.9840584255613777, 'psi': 0.23938362300662963}
[S8] START round=32 head_norm_before_train=1.581390 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9996045865812286, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.999155780261321, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.386353 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.001254 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.054535482200011, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0570442517469365, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=2.010433 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.5753808537744634, 'psi': 0.24952198852772467}-{'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.5079763344954462, 'psi': 0.24952198852772467}
[S11] START round=32 head_norm_before_train=1.853037 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.24770631612545, 'psi': 0.33154997286190585}-{'f1_val': 0.3271364088440058, 'auprc': 0.3271364088440058, 'loss_val': 3.2016194354927254, 'psi': 0.3271364088440058}
[S13] START round=32 head_norm_before_train=1.352955 cos_to_last_merge=0.9831 (last merge round=25)
[S13] round=32 local utility u=0.005870 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0148615732809096, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0266013833024317, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.735643 cos_to_last_merge=0.9656 (last merge round=19)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.994421565127815, 'psi': 0.13587634006482174}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 4.945666985070761, 'psi': 0.13413413413413414}
[S15] START round=32 head_norm_before_train=1.929329 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6277094100028672, 'psi': 0.6163342951580373}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5918019437052964, 'psi': 0.6166125814646326}
[S16] START round=32 head_norm_before_train=1.460302 cos_to_last_merge=0.9482 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 3.6750390870182392, 'psi': 0.09008575779434158}-{'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 3.4366476318735417, 'psi': 0.09008575779434158}
[S17] START round=32 head_norm_before_train=1.511575 cos_to_last_merge=0.9806 (last merge round=26)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.258027718224385, 'auprc': 0.258027718224385, 'loss_val': 1.1289320574392496, 'psi': 0.258027718224385}-{'f1_val': 0.27883962699087744, 'auprc': 0.27883962699087744, 'loss_val': 1.0306530774216063, 'psi': 0.27883962699087744}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.360)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:37113
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.079)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S9
[S13] cosine check vs S9: cos=0.9937
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.3599 head_norm=1.366886
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.128724e-02
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.3599 head_norm=1.388405 delta_norm=0.081287
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.844391 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.2587586577903302, 'auprc': 0.2587586577903302, 'loss_val': 3.0873166253916384, 'psi': 0.2587586577903302}-{'f1_val': 0.26243259436788496, 'auprc': 0.26243259436788496, 'loss_val': 2.9448555486244317, 'psi': 0.26243259436788496}
[S3] START round=33 head_norm_before_train=1.993739 (no previous merge yet)
[S3] round=33 local utility u=0.008849 metrics={'f1_val': 0.2608582911966809, 'auprc': 0.2608582911966809, 'loss_val': 3.0667672997424793, 'psi': 0.2608582911966809}-{'f1_val': 0.26305811597045176, 'auprc': 0.26305811597045176, 'loss_val': 3.1042639082465002, 'psi': 0.26305811597045176}
[S4] START round=33 head_norm_before_train=1.937805 cos_to_last_merge=0.9906 (last merge round=23)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.125841644656611, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1159828883270417, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=2.129572 (no previous merge yet)
[S5] round=33 local utility u=0.051851 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5318770886828, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6355788354695404, 'psi': 0.3335071121394324}
[S6] START round=33 head_norm_before_train=1.821639 (no previous merge yet)
[S6] round=33 local utility u=0.171848 metrics={'f1_val': 0.10038240917782026, 'auprc': 0.10038240917782026, 'loss_val': 6.143109367922646, 'psi': 0.10038240917782026}-{'f1_val': 0.07866075030254134, 'auprc': 0.07866075030254134, 'loss_val': 6.291311341139575, 'psi': 0.07866075030254134}
[S7] START round=33 head_norm_before_train=1.876304 (no previous merge yet)
[S7] round=33 local utility u=0.036820 metrics={'f1_val': 0.23861664572488483, 'auprc': 0.23861664572488483, 'loss_val': 0.9615955707047741, 'psi': 0.23861664572488483}-{'f1_val': 0.23853979652902454, 'auprc': 0.23853979652902454, 'loss_val': 1.0345448514491022, 'psi': 0.23853979652902452}
[S8] START round=33 head_norm_before_train=1.612565 cos_to_last_merge=0.9997 (last merge round=31)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0310035112703464, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9996045865812286, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.414276 cos_to_last_merge=0.9998 (last merge round=31)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1047706519940323, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.054535482200011, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=2.030997 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.6031157167053183, 'psi': 0.24952198852772467}-{'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.5753808537744634, 'psi': 0.24952198852772467}
[S11] START round=33 head_norm_before_train=1.864916 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 3.2921126539295518, 'psi': 0.3317042898145993}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.24770631612545, 'psi': 0.33154997286190585}
[S13] START round=33 head_norm_before_train=1.388405 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0193082777921658, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0148615732809096, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=1.752415 cos_to_last_merge=0.9627 (last merge round=19)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.0570636887229075, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.994421565127815, 'psi': 0.13587634006482174}
[S15] START round=33 head_norm_before_train=1.949328 (no previous merge yet)
[S15] round=33 local utility u=0.008279 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6111508615452883, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6277094100028672, 'psi': 0.6163342951580373}
[S16] START round=33 head_norm_before_train=1.501355 cos_to_last_merge=0.9386 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.939
[S16] round=33 local utility u=0.643150 metrics={'f1_val': 0.15130732961851692, 'auprc': 0.15130732961851692, 'loss_val': 2.9397338379595643, 'psi': 0.15130732961851692}-{'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 3.6750390870182392, 'psi': 0.09008575779434158}
[S17] START round=33 head_norm_before_train=1.530792 cos_to_last_merge=0.9776 (last merge round=26)
[S17] round=33 local utility u=0.293499 metrics={'f1_val': 0.32923610077026166, 'auprc': 0.32923610077026166, 'loss_val': 1.1828093280492527, 'psi': 0.32923610077026166}-{'f1_val': 0.258027718224385, 'auprc': 0.258027718224385, 'loss_val': 1.1289320574392496, 'psi': 0.258027718224385}
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S16] not sending this round → trigger blocked (psi=0.151)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.334)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.100)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:37111
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=-0.0109
[S10] DROPPED delta from S7 (cos=-0.0109 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=-0.0876
[S16] DROPPED delta from S15 (cos=-0.0876 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.9804
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.3594 head_norm=1.644982
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.653845e-01
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.3594 head_norm=1.587904 delta_norm=0.165385
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] CommDone barrier timeout: have=2 need=3 — continuing
[S2] START round=34 head_norm_before_train=1.852146 (no previous merge yet)
[S2] round=34 local utility u=0.107484 metrics={'f1_val': 0.2568725226953075, 'auprc': 0.2568725226953075, 'loss_val': 2.85537409894442, 'psi': 0.2568725226953075}-{'f1_val': 0.2587586577903302, 'auprc': 0.2587586577903302, 'loss_val': 3.0873166253916384, 'psi': 0.2587586577903302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=34 head_norm_before_train=2.003130 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.2629034365608258, 'auprc': 0.2629034365608258, 'loss_val': 3.1146564481304533, 'psi': 0.2629034365608258}-{'f1_val': 0.2608582911966809, 'auprc': 0.2608582911966809, 'loss_val': 3.0667672997424793, 'psi': 0.2608582911966809}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.953886 cos_to_last_merge=0.9897 (last merge round=23)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1419951462371012, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.125841644656611, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=2.137194 (no previous merge yet)
[S5] round=34 local utility u=0.007375 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5171266511187085, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5318770886828, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=34 head_norm_before_train=1.831707 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.0743683781581092, 'auprc': 0.0743683781581092, 'loss_val': 6.376958877764782, 'psi': 0.0743683781581092}-{'f1_val': 0.10038240917782026, 'auprc': 0.10038240917782026, 'loss_val': 6.143109367922646, 'psi': 0.10038240917782026}
[S7] START round=34 head_norm_before_train=1.894012 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.236687101815122, 'auprc': 0.236687101815122, 'loss_val': 0.9645903606322844, 'psi': 0.236687101815122}-{'f1_val': 0.23861664572488483, 'auprc': 0.23861664572488483, 'loss_val': 0.9615955707047741, 'psi': 0.23861664572488483}
[S8] START round=34 head_norm_before_train=1.587904 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0317781435445461, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0310035112703464, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.440976 cos_to_last_merge=0.9994 (last merge round=31)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.154150665689253, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1047706519940323, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=2.049069 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6037759970797194, 'psi': 0.24958183990442054}-{'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.6031157167053183, 'psi': 0.24952198852772467}
[S11] START round=34 head_norm_before_train=1.875895 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.309244816721448, 'psi': 0.33154997286190585}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 3.2921126539295518, 'psi': 0.3317042898145993}
[S13] START round=34 head_norm_before_train=1.400820 cos_to_last_merge=0.9998 (last merge round=32)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0350052917209487, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0193082777921658, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=1.767411 cos_to_last_merge=0.9601 (last merge round=19)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.116352957491119, 'psi': 0.13592717296421}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.0570636887229075, 'psi': 0.13582554517133957}
[S15] START round=34 head_norm_before_train=1.967680 (no previous merge yet)
[S15] round=34 local utility u=0.027849 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5567058534055038, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6111508615452883, 'psi': 0.6163342951580373}
[S16] START round=34 head_norm_before_train=1.533570 cos_to_last_merge=0.9314 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.931
[S16] round=34 local utility u=0.105566 metrics={'f1_val': 0.16475335698879845, 'auprc': 0.16475335698879845, 'loss_val': 2.849616075494306, 'psi': 0.16475335698879845}-{'f1_val': 0.15130732961851692, 'auprc': 0.15130732961851692, 'loss_val': 2.9397338379595643, 'psi': 0.15130732961851692}
[S17] START round=34 head_norm_before_train=1.546485 cos_to_last_merge=0.9754 (last merge round=26)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.2635558998650996, 'auprc': 0.2635558998650996, 'loss_val': 1.1500360110432022, 'psi': 0.2635558998650996}-{'f1_val': 0.32923610077026166, 'auprc': 0.32923610077026166, 'loss_val': 1.1828093280492527, 'psi': 0.32923610077026166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:37116
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=-0.0863
[S16] DROPPED delta from S15 (cos=-0.0863 < 0.0)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.165)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10]  timeout peer S7
[S17]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S13]  timeout peer S9
[S4]  timeout peer S3
[S4]  timeout peer S14
[S16]  timeout peer S13
[S16]  timeout peer S15
[S11]  timeout peer S6
[S8]  timeout peer S2
[S8]  timeout peer S16
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S17
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.859597 (no previous merge yet)
[S2] round=35 local utility u=0.499791 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.851237315719203, 'psi': 0.3674775928297055}-{'f1_val': 0.2568725226953075, 'auprc': 0.2568725226953075, 'loss_val': 2.85537409894442, 'psi': 0.2568725226953075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=35 head_norm_before_train=2.011681 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.26116303219106957, 'auprc': 0.26116303219106957, 'loss_val': 3.107467215494551, 'psi': 0.26116303219106957}-{'f1_val': 0.2629034365608258, 'auprc': 0.2629034365608258, 'loss_val': 3.1146564481304533, 'psi': 0.2629034365608258}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.963336 cos_to_last_merge=0.9885 (last merge round=23)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1580370315082595, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1419951462371012, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=2.144227 (no previous merge yet)
[S5] round=35 local utility u=0.025832 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4654626467806, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5171266511187085, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=35 head_norm_before_train=1.841240 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 6.7254677499399955, 'psi': 0.02284148012791229}-{'f1_val': 0.0743683781581092, 'auprc': 0.0743683781581092, 'loss_val': 6.376958877764782, 'psi': 0.0743683781581092}
[S7] START round=35 head_norm_before_train=1.912389 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.2373837383738374, 'auprc': 0.2373837383738374, 'loss_val': 1.0508244114988166, 'psi': 0.2373837383738374}-{'f1_val': 0.236687101815122, 'auprc': 0.236687101815122, 'loss_val': 0.9645903606322844, 'psi': 0.236687101815122}
[S8] START round=35 head_norm_before_train=1.620572 cos_to_last_merge=0.9997 (last merge round=33)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0667334266819024, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0317781435445461, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.465408 cos_to_last_merge=0.9987 (last merge round=31)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2065476587170165, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.154150665689253, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=2.065808 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 1.6325022916869512, 'psi': 0.2494621085345446}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6037759970797194, 'psi': 0.24958183990442054}
[S11] START round=35 head_norm_before_train=1.886085 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.3108232524812955, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.309244816721448, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.413329 cos_to_last_merge=0.9995 (last merge round=32)
[S13] round=35 local utility u=0.008297 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.018412231279928, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0350052917209487, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=35 head_norm_before_train=1.781543 cos_to_last_merge=0.9577 (last merge round=19)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.1309164149043303, 'auprc': 0.1309164149043303, 'loss_val': 5.191406918990647, 'psi': 0.1309164149043303}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.116352957491119, 'psi': 0.13592717296421}
[S15] START round=35 head_norm_before_train=1.984912 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5724812819065381, 'psi': 0.6166125814646326}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5567058534055038, 'psi': 0.6164734888353558}
[S16] START round=35 head_norm_before_train=1.559399 cos_to_last_merge=0.9259 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 4.122474599137425, 'psi': 0.09008575779434158}-{'f1_val': 0.16475335698879845, 'auprc': 0.16475335698879845, 'loss_val': 2.849616075494306, 'psi': 0.16475335698879845}
[S17] START round=35 head_norm_before_train=1.562406 cos_to_last_merge=0.9733 (last merge round=26)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.26222101387098656, 'auprc': 0.26222101387098656, 'loss_val': 1.173156901567601, 'psi': 0.26222101387098656}-{'f1_val': 0.2635558998650996, 'auprc': 0.2635558998650996, 'loss_val': 1.1500360110432022, 'psi': 0.2635558998650996}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.866999 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8864563548608433, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.851237315719203, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.015097 (no previous merge yet)
[S3] round=36 local utility u=0.019974 metrics={'f1_val': 0.27828618968386026, 'auprc': 0.27828618968386026, 'loss_val': 3.221626736826722, 'psi': 0.27828618968386026}-{'f1_val': 0.26116303219106957, 'auprc': 0.26116303219106957, 'loss_val': 3.107467215494551, 'psi': 0.26116303219106957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=36 head_norm_before_train=1.972952 cos_to_last_merge=0.9873 (last merge round=23)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1741062508698101, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1580370315082595, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=2.156547 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4821225897278287, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4654626467806, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.850563 (no previous merge yet)
[S6] round=36 local utility u=0.529409 metrics={'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 6.357970942562241, 'psi': 0.09965504024530472}-{'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 6.7254677499399955, 'psi': 0.02284148012791229}
[S7] START round=36 head_norm_before_train=1.927044 (no previous merge yet)
[S7] round=36 local utility u=0.216561 metrics={'f1_val': 0.25858741798533386, 'auprc': 0.25858741798533386, 'loss_val': 0.8085361828903933, 'psi': 0.25858741798533386}-{'f1_val': 0.2373837383738374, 'auprc': 0.2373837383738374, 'loss_val': 1.0508244114988166, 'psi': 0.2373837383738374}
[S8] START round=36 head_norm_before_train=1.653010 cos_to_last_merge=0.9989 (last merge round=33)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1014335295585709, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0667334266819024, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=1.487776 cos_to_last_merge=0.9980 (last merge round=31)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.254703132863864, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2065476587170165, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=2.081213 (no previous merge yet)
[S10] round=36 local utility u=0.023345 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.5868889692108352, 'psi': 0.24958183990442054}-{'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 1.6325022916869512, 'psi': 0.2494621085345446}
[S11] START round=36 head_norm_before_train=1.895669 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.3309341382245956, 'auprc': 0.3309341382245956, 'loss_val': 3.325171976699159, 'psi': 0.3309341382245956}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.3108232524812955, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.424335 cos_to_last_merge=0.9991 (last merge round=32)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0459765992643462, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.018412231279928, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.794313 cos_to_last_merge=0.9555 (last merge round=19)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.2400706957976935, 'psi': 0.1355297641332834}-{'f1_val': 0.1309164149043303, 'auprc': 0.1309164149043303, 'loss_val': 5.191406918990647, 'psi': 0.1309164149043303}
[S15] START round=36 head_norm_before_train=1.999934 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5917967935973776, 'psi': 0.6163342951580373}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5724812819065381, 'psi': 0.6166125814646326}
[S16] START round=36 head_norm_before_train=1.581102 cos_to_last_merge=0.9216 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.922
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.08771929824561403, 'auprc': 0.08771929824561403, 'loss_val': 4.265498659845115, 'psi': 0.08771929824561403}-{'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 4.122474599137425, 'psi': 0.09008575779434158}
[S17] START round=36 head_norm_before_train=1.579237 cos_to_last_merge=0.9715 (last merge round=26)
[S17] round=36 local utility u=0.031691 metrics={'f1_val': 0.2673577736868876, 'auprc': 0.2673577736868876, 'loss_val': 1.1560061023850334, 'psi': 0.2673577736868876}-{'f1_val': 0.26222101387098656, 'auprc': 0.26222101387098656, 'loss_val': 1.173156901567601, 'psi': 0.26222101387098656}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.100)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.874113 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9073731624378047, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8864563548608433, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=2.018284 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.2827807486631016, 'auprc': 0.2827807486631016, 'loss_val': 3.311634502836731, 'psi': 0.2827807486631016}-{'f1_val': 0.27828618968386026, 'auprc': 0.27828618968386026, 'loss_val': 3.221626736826722, 'psi': 0.27828618968386026}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.986907 cos_to_last_merge=0.9866 (last merge round=23)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1882131459782368, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1741062508698101, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=2.166869 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.539941415615829, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4821225897278287, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.859713 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.09515503875968992, 'auprc': 0.09515503875968992, 'loss_val': 6.432189240769854, 'psi': 0.09515503875968992}-{'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 6.357970942562241, 'psi': 0.09965504024530472}
[S7] START round=37 head_norm_before_train=1.934919 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.23394066806820837, 'auprc': 0.23394066806820837, 'loss_val': 0.7570157342183889, 'psi': 0.23394066806820837}-{'f1_val': 0.25858741798533386, 'auprc': 0.25858741798533386, 'loss_val': 0.8085361828903933, 'psi': 0.25858741798533386}
[S8] START round=37 head_norm_before_train=1.681246 cos_to_last_merge=0.9979 (last merge round=33)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.140192656373831, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1014335295585709, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=1.507921 cos_to_last_merge=0.9972 (last merge round=31)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2942833751439906, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.254703132863864, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=2.095926 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6021055709197252, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.5868889692108352, 'psi': 0.24958183990442054}
[S11] START round=37 head_norm_before_train=1.904863 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.352293459316513, 'psi': 0.33154997286190585}-{'f1_val': 0.3309341382245956, 'auprc': 0.3309341382245956, 'loss_val': 3.325171976699159, 'psi': 0.3309341382245956}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.439386 cos_to_last_merge=0.9985 (last merge round=32)
[S13] round=37 local utility u=0.002442 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.041092192697935, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0459765992643462, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=37 head_norm_before_train=1.805283 cos_to_last_merge=0.9537 (last merge round=19)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.293496957681177, 'psi': 0.13582554517133957}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.2400706957976935, 'psi': 0.1355297641332834}
[S15] START round=37 head_norm_before_train=2.013958 (no previous merge yet)
[S15] round=37 local utility u=0.008937 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.575174819381138, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5917967935973776, 'psi': 0.6163342951580373}
[S16] START round=37 head_norm_before_train=1.599567 cos_to_last_merge=0.9180 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.918
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 4.346117045465258, 'psi': 0.09008575779434158}-{'f1_val': 0.08771929824561403, 'auprc': 0.08771929824561403, 'loss_val': 4.265498659845115, 'psi': 0.08771929824561403}
[S17] START round=37 head_norm_before_train=1.595945 cos_to_last_merge=0.9696 (last merge round=26)
[S17] round=37 local utility u=0.532808 metrics={'f1_val': 0.39337183790074315, 'auprc': 0.39337183790074315, 'loss_val': 1.224517545930124, 'psi': 0.39337183790074315}-{'f1_val': 0.2673577736868876, 'auprc': 0.2673577736868876, 'loss_val': 1.1560061023850334, 'psi': 0.2673577736868876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S17] not sending this round → trigger blocked (psi=0.393)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.880929 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.25991331910214116, 'auprc': 0.25991331910214116, 'loss_val': 2.975702282632446, 'psi': 0.25991331910214116}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9073731624378047, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.024712 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.26126477080898586, 'auprc': 0.26126477080898586, 'loss_val': 3.141483287193688, 'psi': 0.26126477080898586}-{'f1_val': 0.2827807486631016, 'auprc': 0.2827807486631016, 'loss_val': 3.311634502836731, 'psi': 0.2827807486631016}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=2.000128 cos_to_last_merge=0.9860 (last merge round=23)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1959618729036547, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1882131459782368, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=2.179481 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.635287195509334, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.539941415615829, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.867781 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.023494525547445255, 'auprc': 0.023494525547445255, 'loss_val': 6.874341783292152, 'psi': 0.023494525547445255}-{'f1_val': 0.09515503875968992, 'auprc': 0.09515503875968992, 'loss_val': 6.432189240769854, 'psi': 0.09515503875968992}
[S7] START round=38 head_norm_before_train=1.943244 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.1883812746756909, 'auprc': 0.1883812746756909, 'loss_val': 0.8544468000034285, 'psi': 0.1883812746756909}-{'f1_val': 0.23394066806820837, 'auprc': 0.23394066806820837, 'loss_val': 0.7570157342183889, 'psi': 0.23394066806820837}
[S8] START round=38 head_norm_before_train=1.706827 cos_to_last_merge=0.9968 (last merge round=33)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1777514053284979, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.140192656373831, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.525948 cos_to_last_merge=0.9965 (last merge round=31)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3297446221220297, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2942833751439906, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=2.109368 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.627593481344427, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6021055709197252, 'psi': 0.24958183990442054}
[S11] START round=38 head_norm_before_train=1.913507 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.33116480793060715, 'auprc': 0.33116480793060715, 'loss_val': 3.361997451819819, 'psi': 0.33116480793060715}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.352293459316513, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.454230 cos_to_last_merge=0.9976 (last merge round=32)
[S13] round=38 local utility u=0.017287 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0065174228925593, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.041092192697935, 'psi': 0.3599362944611573}
[S13] not sending this round → trigger blocked (psi=0.360)
[S14] START round=38 head_norm_before_train=1.815374 cos_to_last_merge=0.9520 (last merge round=19)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.346282128024733, 'psi': 0.13592717296421}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.293496957681177, 'psi': 0.13582554517133957}
[S15] START round=38 head_norm_before_train=2.027854 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6129514791239702, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.575174819381138, 'psi': 0.6164734888353558}
[S16] START round=38 head_norm_before_train=1.615583 cos_to_last_merge=0.9151 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.915
[S16] round=38 local utility u=0.738310 metrics={'f1_val': 0.1541631145211708, 'auprc': 0.1541631145211708, 'loss_val': 3.4461939738519116, 'psi': 0.1541631145211708}-{'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 4.346117045465258, 'psi': 0.09008575779434158}
[S17] START round=38 head_norm_before_train=1.612019 cos_to_last_merge=0.9676 (last merge round=26)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.3948132137531493, 'auprc': 0.3948132137531493, 'loss_val': 1.2562485638360923, 'psi': 0.3948132137531493}-{'f1_val': 0.39337183790074315, 'auprc': 0.39337183790074315, 'loss_val': 1.224517545930124, 'psi': 0.39337183790074315}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.154)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.886918 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.21888090963494913, 'auprc': 0.21888090963494913, 'loss_val': 3.7054809067433996, 'psi': 0.21888090963494913}-{'f1_val': 0.25991331910214116, 'auprc': 0.25991331910214116, 'loss_val': 2.975702282632446, 'psi': 0.25991331910214116}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.219 u=0.0000 p_local=0.0833 f1=0.219 auprc=0.219 bytes=16193
[S3] START round=39 head_norm_before_train=2.031981 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.26121389159363845, 'auprc': 0.26121389159363845, 'loss_val': 3.1529562105803817, 'psi': 0.26121389159363845}-{'f1_val': 0.26126477080898586, 'auprc': 0.26126477080898586, 'loss_val': 3.141483287193688, 'psi': 0.26126477080898586}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.261 u=0.0000 p_local=0.0139 f1=0.261 auprc=0.261 bytes=16220
[S4] START round=39 head_norm_before_train=2.010642 cos_to_last_merge=0.9857 (last merge round=23)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2105596659972522, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1959618729036547, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0027 f1=0.357 auprc=0.357 bytes=25203
[S5] START round=39 head_norm_before_train=2.193162 (no previous merge yet)
[S5] round=39 local utility u=0.031612 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5720629038657274, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.635287195509334, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] r=40 psi=0.334 u=0.0316 p_local=0.0150 f1=0.334 auprc=0.334 bytes=26998
[S6] START round=39 head_norm_before_train=1.875616 (no previous merge yet)
[S6] round=39 local utility u=0.277521 metrics={'f1_val': 0.060765349032800675, 'auprc': 0.060765349032800675, 'loss_val': 6.654738029355996, 'psi': 0.060765349032800675}-{'f1_val': 0.023494525547445255, 'auprc': 0.023494525547445255, 'loss_val': 6.874341783292152, 'psi': 0.023494525547445255}
[S7] START round=39 head_norm_before_train=1.950203 (no previous merge yet)
[S7] round=39 local utility u=0.379440 metrics={'f1_val': 0.2483129217695576, 'auprc': 0.2483129217695576, 'loss_val': 0.6349524909775285, 'psi': 0.2483129217695576}-{'f1_val': 0.1883812746756909, 'auprc': 0.1883812746756909, 'loss_val': 0.8544468000034285, 'psi': 0.1883812746756909}
[S8] START round=39 head_norm_before_train=1.732234 cos_to_last_merge=0.9956 (last merge round=33)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.22108677818507, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1777514053284979, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=1.542461 cos_to_last_merge=0.9958 (last merge round=31)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3624600917265552, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3297446221220297, 'psi': 0.36867172340800847}
[S10] START round=39 head_norm_before_train=2.121840 (no previous merge yet)
[S10] round=39 local utility u=0.003161 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6212711435750105, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.627593481344427, 'psi': 0.24958183990442054}
[S11] START round=39 head_norm_before_train=1.921879 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.328948380644665, 'auprc': 0.328948380644665, 'loss_val': 3.367135912060046, 'psi': 0.328948380644665}-{'f1_val': 0.33116480793060715, 'auprc': 0.33116480793060715, 'loss_val': 3.361997451819819, 'psi': 0.33116480793060715}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.329 u=0.0000 p_local=0.0014 f1=0.329 auprc=0.329 bytes=7183
[S13] START round=39 head_norm_before_train=1.467242 cos_to_last_merge=0.9966 (last merge round=32)
[S13] round=39 local utility u=0.018464 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9695896051035259, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0065174228925593, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] r=40 psi=0.360 u=0.0185 p_local=0.0256 f1=0.360 auprc=0.360 bytes=27023
[S14] START round=39 head_norm_before_train=1.825202 cos_to_last_merge=0.9504 (last merge round=19)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.12498409061982946, 'auprc': 0.12498409061982946, 'loss_val': 5.416655165215145, 'psi': 0.12498409061982946}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.346282128024733, 'psi': 0.13592717296421}
[S15] START round=39 head_norm_before_train=2.039658 (no previous merge yet)
[S15] round=39 local utility u=0.002361 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.606976732447122, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6129514791239702, 'psi': 0.6164734888353558}
[S16] START round=39 head_norm_before_train=1.630175 cos_to_last_merge=0.9125 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.912
[S16] round=39 local utility u=0.739634 metrics={'f1_val': 0.2088093424727088, 'auprc': 0.2088093424727088, 'loss_val': 2.458741188814728, 'psi': 0.2088093424727088}-{'f1_val': 0.1541631145211708, 'auprc': 0.1541631145211708, 'loss_val': 3.4461939738519116, 'psi': 0.1541631145211708}
[S17] START round=39 head_norm_before_train=1.625496 cos_to_last_merge=0.9657 (last merge round=26)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.2638231331067875, 'auprc': 0.2638231331067875, 'loss_val': 1.283544598926981, 'psi': 0.2638231331067875}-{'f1_val': 0.3948132137531493, 'auprc': 0.3948132137531493, 'loss_val': 1.2562485638360923, 'psi': 0.3948132137531493}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.061)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S10] r=40 psi=0.250 u=0.0032 p_local=0.0093 f1=0.250 auprc=0.250 bytes=32392
[S15] r=40 psi=0.616 u=0.0024 p_local=0.0144 f1=0.616 auprc=0.616 bytes=28787
[S7] r=40 psi=0.248 u=0.3794 p_local=0.1072 f1=0.248 auprc=0.248 bytes=30624
[S16] r=40 psi=0.209 u=0.7396 p_local=0.3236 f1=0.209 auprc=0.209 bytes=1799
[S14] r=40 psi=0.125 u=0.0000 p_local=0.0103 f1=0.125 auprc=0.125 bytes=0
[S6] r=40 psi=0.061 u=0.2775 p_local=0.1657 f1=0.061 auprc=0.061 bytes=0
[S17] r=40 psi=0.264 u=0.0000 p_local=0.0981 f1=0.264 auprc=0.264 bytes=27005
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0063 f1=0.359 auprc=0.359 bytes=28768
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0053 f1=0.369 auprc=0.369 bytes=16189
[S2] START round=40 head_norm_before_train=1.892876 (no previous merge yet)
[S2] round=40 local utility u=0.395866 metrics={'f1_val': 0.25518925518925517, 'auprc': 0.25518925518925517, 'loss_val': 3.240523252320081, 'psi': 0.25518925518925517}-{'f1_val': 0.21888090963494913, 'auprc': 0.21888090963494913, 'loss_val': 3.7054809067433996, 'psi': 0.21888090963494913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=40 head_norm_before_train=2.040451 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.26126477080898586, 'auprc': 0.26126477080898586, 'loss_val': 3.165199857282808, 'psi': 0.26126477080898586}-{'f1_val': 0.26121389159363845, 'auprc': 0.26121389159363845, 'loss_val': 3.1529562105803817, 'psi': 0.26121389159363845}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.024316 cos_to_last_merge=0.9852 (last merge round=23)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2320112059621262, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2105596659972522, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=2.202252 (no previous merge yet)
[S5] round=40 local utility u=0.035942 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.500178185316071, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5720629038657274, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=40 head_norm_before_train=1.883597 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 7.085650161101512, 'psi': 0.02153000458085204}-{'f1_val': 0.060765349032800675, 'auprc': 0.060765349032800675, 'loss_val': 6.654738029355996, 'psi': 0.060765349032800675}
[S7] START round=40 head_norm_before_train=1.950839 (no previous merge yet)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.2483129217695576, 'auprc': 0.2483129217695576, 'loss_val': 0.7186291121845654, 'psi': 0.2483129217695576}-{'f1_val': 0.2483129217695576, 'auprc': 0.2483129217695576, 'loss_val': 0.6349524909775285, 'psi': 0.2483129217695576}
[S8] START round=40 head_norm_before_train=1.755120 cos_to_last_merge=0.9944 (last merge round=33)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2655681133713022, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.22108677818507, 'psi': 0.35939447907390915}
[S9] START round=40 head_norm_before_train=1.557753 cos_to_last_merge=0.9951 (last merge round=31)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3925942054254072, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3624600917265552, 'psi': 0.36867172340800847}
[S10] START round=40 head_norm_before_train=2.133489 (no previous merge yet)
[S10] round=40 local utility u=0.005718 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6098342843707936, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6212711435750105, 'psi': 0.24958183990442054}
[S11] START round=40 head_norm_before_train=1.929635 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.396978425710914, 'psi': 0.33154997286190585}-{'f1_val': 0.328948380644665, 'auprc': 0.328948380644665, 'loss_val': 3.367135912060046, 'psi': 0.328948380644665}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.478234 cos_to_last_merge=0.9958 (last merge round=32)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0901998830998858, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9695896051035259, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.835019 cos_to_last_merge=0.9488 (last merge round=19)
[S14] ⚠️ Model drifted since last merge! cos=0.949
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.11785944551901999, 'auprc': 0.11785944551901999, 'loss_val': 5.488809423253955, 'psi': 0.11785944551901999}-{'f1_val': 0.12498409061982946, 'auprc': 0.12498409061982946, 'loss_val': 5.416655165215145, 'psi': 0.12498409061982946}
[S15] START round=40 head_norm_before_train=2.049853 (no previous merge yet)
[S15] round=40 local utility u=0.014154 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5786680929237831, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.606976732447122, 'psi': 0.6163342951580373}
[S16] START round=40 head_norm_before_train=1.641884 cos_to_last_merge=0.9103 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.910
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 4.488460505798568, 'psi': 0.09008575779434158}-{'f1_val': 0.2088093424727088, 'auprc': 0.2088093424727088, 'loss_val': 2.458741188814728, 'psi': 0.2088093424727088}
[S17] START round=40 head_norm_before_train=1.637591 cos_to_last_merge=0.9642 (last merge round=26)
[S17] round=40 local utility u=0.639763 metrics={'f1_val': 0.40416461735761977, 'auprc': 0.40416461735761977, 'loss_val': 1.2670912927338827, 'psi': 0.40416461735761977}-{'f1_val': 0.2638231331067875, 'auprc': 0.2638231331067875, 'loss_val': 1.283544598926981, 'psi': 0.2638231331067875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.616)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.250)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.898668 (no previous merge yet)
[S2] round=41 local utility u=0.119427 metrics={'f1_val': 0.24669982194388163, 'auprc': 0.24669982194388163, 'loss_val': 2.925263851017851, 'psi': 0.24669982194388163}-{'f1_val': 0.25518925518925517, 'auprc': 0.25518925518925517, 'loss_val': 3.240523252320081, 'psi': 0.25518925518925517}
[S2] not sending this round → trigger blocked (psi=0.247)
[S3] START round=41 head_norm_before_train=2.048920 (no previous merge yet)
[S3] round=41 local utility u=0.003517 metrics={'f1_val': 0.2607568688439606, 'auprc': 0.2607568688439606, 'loss_val': 3.1535940610740085, 'psi': 0.2607568688439606}-{'f1_val': 0.26126477080898586, 'auprc': 0.26126477080898586, 'loss_val': 3.165199857282808, 'psi': 0.26126477080898586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=41 head_norm_before_train=2.034608 cos_to_last_merge=0.9843 (last merge round=23)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.248548673371552, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2320112059621262, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=2.209544 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5852570953140197, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.500178185316071, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.891204 (no previous merge yet)
[S6] round=41 local utility u=0.505637 metrics={'f1_val': 0.08861756597085467, 'auprc': 0.08861756597085467, 'loss_val': 6.678163532209414, 'psi': 0.08861756597085467}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 7.085650161101512, 'psi': 0.02153000458085204}
[S7] START round=41 head_norm_before_train=1.953546 (no previous merge yet)
[S7] round=41 local utility u=0.066947 metrics={'f1_val': 0.24875249500998003, 'auprc': 0.24875249500998003, 'loss_val': 0.5886907987195638, 'psi': 0.24875249500998003}-{'f1_val': 0.2483129217695576, 'auprc': 0.2483129217695576, 'loss_val': 0.7186291121845654, 'psi': 0.2483129217695576}
[S8] START round=41 head_norm_before_train=1.776451 cos_to_last_merge=0.9933 (last merge round=33)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.305206386148895, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2655681133713022, 'psi': 0.35939447907390915}
[S9] START round=41 head_norm_before_train=1.571930 cos_to_last_merge=0.9944 (last merge round=31)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.418909590199293, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3925942054254072, 'psi': 0.36867172340800847}
[S10] START round=41 head_norm_before_train=2.144208 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6151920711398857, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6098342843707936, 'psi': 0.24958183990442054}
[S11] START round=41 head_norm_before_train=1.937142 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.4161464229465555, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.396978425710914, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.487486 cos_to_last_merge=0.9949 (last merge round=32)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1340689950764917, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0901998830998858, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.844216 cos_to_last_merge=0.9473 (last merge round=19)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=41 local utility u=0.000042 metrics={'f1_val': 0.12060559404670258, 'auprc': 0.12060559404670258, 'loss_val': 5.513439886109402, 'psi': 0.1206055940467026}-{'f1_val': 0.11785944551901999, 'auprc': 0.11785944551901999, 'loss_val': 5.488809423253955, 'psi': 0.11785944551901999}
[S15] START round=41 head_norm_before_train=2.060550 (no previous merge yet)
[S15] round=41 local utility u=0.003865 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5721910434884275, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5786680929237831, 'psi': 0.6163342951580373}
[S16] START round=41 head_norm_before_train=1.652436 cos_to_last_merge=0.9083 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.908
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.06613226452905811, 'auprc': 0.06613226452905811, 'loss_val': 4.639041119873427, 'psi': 0.06613226452905811}-{'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 4.488460505798568, 'psi': 0.09008575779434158}
[S17] START round=41 head_norm_before_train=1.648762 cos_to_last_merge=0.9630 (last merge round=26)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.33924109219516646, 'auprc': 0.33924109219516646, 'loss_val': 1.3978780686500787, 'psi': 0.33924109219516646}-{'f1_val': 0.40416461735761977, 'auprc': 0.40416461735761977, 'loss_val': 1.2670912927338827, 'psi': 0.40416461735761977}
[S14] not sending this round → trigger blocked (psi=0.121)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.089)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.904109 (no previous merge yet)
[S2] round=42 local utility u=0.514361 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9835413169754332, 'psi': 0.3674775928297055}-{'f1_val': 0.24669982194388163, 'auprc': 0.24669982194388163, 'loss_val': 2.925263851017851, 'psi': 0.24669982194388163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=42 head_norm_before_train=2.056420 (no previous merge yet)
[S3] round=42 local utility u=0.005293 metrics={'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 3.124451023278428, 'psi': 0.25869495339119253}-{'f1_val': 0.2607568688439606, 'auprc': 0.2607568688439606, 'loss_val': 3.1535940610740085, 'psi': 0.2607568688439606}
[S3] not sending this round → trigger blocked (psi=0.259)
[S4] START round=42 head_norm_before_train=2.043214 cos_to_last_merge=0.9836 (last merge round=23)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2616770279426832, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.248548673371552, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=2.216891 (no previous merge yet)
[S5] round=42 local utility u=0.036329 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.512599523380969, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5852570953140197, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=42 head_norm_before_train=1.898734 (no previous merge yet)
[S6] round=42 local utility u=0.122409 metrics={'f1_val': 0.10114503816793893, 'auprc': 0.10114503816793893, 'loss_val': 6.546091828647848, 'psi': 0.10114503816793893}-{'f1_val': 0.08861756597085467, 'auprc': 0.08861756597085467, 'loss_val': 6.678163532209414, 'psi': 0.08861756597085467}
[S7] START round=42 head_norm_before_train=1.959737 (no previous merge yet)
[S7] round=42 local utility u=0.192172 metrics={'f1_val': 0.287368424453173, 'auprc': 0.287368424453173, 'loss_val': 0.5518902559702076, 'psi': 0.287368424453173}-{'f1_val': 0.24875249500998003, 'auprc': 0.24875249500998003, 'loss_val': 0.5886907987195638, 'psi': 0.24875249500998003}
[S8] START round=42 head_norm_before_train=1.793741 cos_to_last_merge=0.9922 (last merge round=33)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3489739952140147, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.305206386148895, 'psi': 0.35939447907390915}
[S9] START round=42 head_norm_before_train=1.585076 cos_to_last_merge=0.9938 (last merge round=31)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4489418244123766, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.418909590199293, 'psi': 0.36867172340800847}
[S10] START round=42 head_norm_before_train=2.154424 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6308998238679748, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6151920711398857, 'psi': 0.24958183990442054}
[S11] START round=42 head_norm_before_train=1.944647 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.33016755462898617, 'auprc': 0.33016755462898617, 'loss_val': 3.4181776302794, 'psi': 0.33016755462898617}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.4161464229465555, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.496405 cos_to_last_merge=0.9938 (last merge round=32)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1765145007089581, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1340689950764917, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.852863 cos_to_last_merge=0.9459 (last merge round=19)
[S14] ⚠️ Model drifted since last merge! cos=0.946
[S14] round=42 local utility u=0.043475 metrics={'f1_val': 0.13152269583804854, 'auprc': 0.13152269583804854, 'loss_val': 5.5247439439272155, 'psi': 0.13152269583804854}-{'f1_val': 0.12060559404670258, 'auprc': 0.12060559404670258, 'loss_val': 5.513439886109402, 'psi': 0.1206055940467026}
[S15] START round=42 head_norm_before_train=2.072394 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6398346111159781, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5721910434884275, 'psi': 0.6164734888353558}
[S16] START round=42 head_norm_before_train=1.661555 cos_to_last_merge=0.9065 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.906
[S16] round=42 local utility u=0.195846 metrics={'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 4.462929827345143, 'psi': 0.09008575779434158}-{'f1_val': 0.06613226452905811, 'auprc': 0.06613226452905811, 'loss_val': 4.639041119873427, 'psi': 0.06613226452905811}
[S17] START round=42 head_norm_before_train=1.660046 cos_to_last_merge=0.9618 (last merge round=26)
[S17] round=42 local utility u=0.624580 metrics={'f1_val': 0.45707390661815245, 'auprc': 0.45707390661815245, 'loss_val': 1.2092141591730883, 'psi': 0.4570739066181525}-{'f1_val': 0.33924109219516646, 'auprc': 0.33924109219516646, 'loss_val': 1.3978780686500787, 'psi': 0.33924109219516646}
[S10]  timeout peer S14
[S15]  timeout peer S16
[S9]  timeout peer S13
[S14]  timeout peer S4
[S6]  timeout peer S11
[S8]  timeout peer S17
[S17]  timeout peer S9
[S16]  timeout peer S8
[S7]  timeout peer S10
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.132)
[S6] not sending this round → trigger blocked (psi=0.101)
[S16] not sending this round → trigger blocked (psi=0.090)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.287)
[S2] START round=43 head_norm_before_train=1.909646 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.998315862190088, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9835413169754332, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.063477 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.26045307443365695, 'auprc': 0.26045307443365695, 'loss_val': 3.1581854734748136, 'psi': 0.26045307443365695}-{'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 3.124451023278428, 'psi': 0.25869495339119253}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.052536 cos_to_last_merge=0.9830 (last merge round=23)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2705572181979035, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2616770279426832, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=2.223379 (no previous merge yet)
[S5] round=43 local utility u=0.054678 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4032431372905454, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.512599523380969, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=43 head_norm_before_train=1.905746 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.65939444322962, 'psi': 0.09904030710172745}-{'f1_val': 0.10114503816793893, 'auprc': 0.10114503816793893, 'loss_val': 6.546091828647848, 'psi': 0.10114503816793893}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.965511 (no previous merge yet)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.24856429463171037, 'auprc': 0.24856429463171037, 'loss_val': 0.6054929107226172, 'psi': 0.24856429463171037}-{'f1_val': 0.287368424453173, 'auprc': 0.287368424453173, 'loss_val': 0.5518902559702076, 'psi': 0.287368424453173}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.805436 cos_to_last_merge=0.9914 (last merge round=33)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3890608393374106, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3489739952140147, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.597741 cos_to_last_merge=0.9931 (last merge round=31)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4788422759162407, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4489418244123766, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.164054 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6374356644795893, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6308998238679748, 'psi': 0.24958183990442054}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.951927 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.33016755462898617, 'auprc': 0.33016755462898617, 'loss_val': 3.4319411733573877, 'psi': 0.33016755462898617}-{'f1_val': 0.33016755462898617, 'auprc': 0.33016755462898617, 'loss_val': 3.4181776302794, 'psi': 0.33016755462898617}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.505869 cos_to_last_merge=0.9926 (last merge round=32)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1932152827863332, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1765145007089581, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.861251 cos_to_last_merge=0.9446 (last merge round=19)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=43 local utility u=0.005850 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.54910747452417, 'psi': 0.1355297641332834}-{'f1_val': 0.13152269583804854, 'auprc': 0.13152269583804854, 'loss_val': 5.5247439439272155, 'psi': 0.13152269583804854}
[S14] not sending this round → trigger blocked (psi=0.136)
[S15] START round=43 head_norm_before_train=2.083760 (no previous merge yet)
[S15] round=43 local utility u=0.003716 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6324019020312247, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6398346111159781, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=43 head_norm_before_train=1.671117 cos_to_last_merge=0.9047 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.905
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.05774278215223097, 'auprc': 0.05774278215223097, 'loss_val': 4.735017637503435, 'psi': 0.05774278215223097}-{'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 4.462929827345143, 'psi': 0.09008575779434158}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.668250 cos_to_last_merge=0.9608 (last merge round=26)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.34960982447331534, 'auprc': 0.34960982447331534, 'loss_val': 1.4451954999081555, 'psi': 0.34960982447331534}-{'f1_val': 0.45707390661815245, 'auprc': 0.45707390661815245, 'loss_val': 1.2092141591730883, 'psi': 0.4570739066181525}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.915088 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.012171728227207, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.998315862190088, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.070486 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.2603014425253897, 'auprc': 0.2603014425253897, 'loss_val': 3.1656723419870105, 'psi': 0.2603014425253897}-{'f1_val': 0.26045307443365695, 'auprc': 0.26045307443365695, 'loss_val': 3.1581854734748136, 'psi': 0.26045307443365695}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=2.062250 cos_to_last_merge=0.9828 (last merge round=23)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2862757863970498, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2705572181979035, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=2.230067 (no previous merge yet)
[S5] round=44 local utility u=0.037163 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.328916942875516, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4032431372905454, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=44 head_norm_before_train=1.912276 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.032034050179211467, 'auprc': 0.032034050179211467, 'loss_val': 6.981831511253563, 'psi': 0.032034050179211467}-{'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.65939444322962, 'psi': 0.09904030710172745}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.972484 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.18505039193729003, 'auprc': 0.18505039193729003, 'loss_val': 0.8840667727352776, 'psi': 0.18505039193729003}-{'f1_val': 0.24856429463171037, 'auprc': 0.24856429463171037, 'loss_val': 0.6054929107226172, 'psi': 0.24856429463171037}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.820490 cos_to_last_merge=0.9905 (last merge round=33)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4238627283086573, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3890608393374106, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.609882 cos_to_last_merge=0.9925 (last merge round=31)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5085759555426357, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4788422759162407, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.173391 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.644731184592435, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6374356644795893, 'psi': 0.24958183990442054}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.958829 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.4528830638565093, 'psi': 0.33154997286190585}-{'f1_val': 0.33016755462898617, 'auprc': 0.33016755462898617, 'loss_val': 3.4319411733573877, 'psi': 0.33016755462898617}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.519243 cos_to_last_merge=0.9912 (last merge round=32)
[S13] round=44 local utility u=0.007831 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.177553350892108, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1932152827863332, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=44 head_norm_before_train=1.869305 cos_to_last_merge=0.9433 (last merge round=19)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.58508342559345, 'psi': 0.13592717296421}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.54910747452417, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.094378 (no previous merge yet)
[S15] round=44 local utility u=0.012766 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.606870861335903, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6324019020312247, 'psi': 0.6163342951580373}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=44 head_norm_before_train=1.680595 cos_to_last_merge=0.9031 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.903
[S16] round=44 local utility u=0.463053 metrics={'f1_val': 0.10526315789473684, 'auprc': 0.10526315789473684, 'loss_val': 4.236595394457949, 'psi': 0.10526315789473684}-{'f1_val': 0.05774278215223097, 'auprc': 0.05774278215223097, 'loss_val': 4.735017637503435, 'psi': 0.05774278215223097}
[S16] not sending this round → trigger blocked (psi=0.105)
[S17] START round=44 head_norm_before_train=1.677068 cos_to_last_merge=0.9598 (last merge round=26)
[S17] round=44 local utility u=0.286372 metrics={'f1_val': 0.4048147377969459, 'auprc': 0.4048147377969459, 'loss_val': 1.3692949430792927, 'psi': 0.4048147377969459}-{'f1_val': 0.34960982447331534, 'auprc': 0.34960982447331534, 'loss_val': 1.4451954999081555, 'psi': 0.34960982447331534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=45 head_norm_before_train=1.920490 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.2518017171147459, 'auprc': 0.2518017171147459, 'loss_val': 2.9763833646011735, 'psi': 0.2518017171147459}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.012171728227207, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.077504 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.26111219258970864, 'auprc': 0.26111219258970864, 'loss_val': 3.2015878208771427, 'psi': 0.26111219258970864}-{'f1_val': 0.2603014425253897, 'auprc': 0.2603014425253897, 'loss_val': 3.1656723419870105, 'psi': 0.2603014425253897}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.072029 cos_to_last_merge=0.9823 (last merge round=23)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2941936138871184, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2862757863970498, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=2.237870 (no previous merge yet)
[S5] round=45 local utility u=0.030882 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.267152746955475, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.328916942875516, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=45 head_norm_before_train=1.918811 (no previous merge yet)
[S6] round=45 local utility u=0.447268 metrics={'f1_val': 0.09980842911877395, 'auprc': 0.09980842911877395, 'loss_val': 6.697264401740083, 'psi': 0.09980842911877395}-{'f1_val': 0.032034050179211467, 'auprc': 0.032034050179211467, 'loss_val': 6.981831511253563, 'psi': 0.032034050179211467}
[S6] not sending this round → trigger blocked (psi=0.100)
[S7] START round=45 head_norm_before_train=1.980629 (no previous merge yet)
[S7] round=45 local utility u=0.418916 metrics={'f1_val': 0.24895341201073684, 'auprc': 0.24895341201073684, 'loss_val': 0.6213621463672776, 'psi': 0.24895341201073684}-{'f1_val': 0.18505039193729003, 'auprc': 0.18505039193729003, 'loss_val': 0.8840667727352776, 'psi': 0.18505039193729003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=45 head_norm_before_train=1.835666 cos_to_last_merge=0.9895 (last merge round=33)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.458954134601114, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4238627283086573, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.621441 cos_to_last_merge=0.9919 (last merge round=31)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5316901326918484, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5085759555426357, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.182925 (no previous merge yet)
[S10] round=45 local utility u=0.000456 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.643819315196894, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.644731184592435, 'psi': 0.24958183990442054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=45 head_norm_before_train=1.965300 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.4739345480781187, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.4528830638565093, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.532173 cos_to_last_merge=0.9898 (last merge round=32)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2095036261931036, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.177553350892108, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.876786 cos_to_last_merge=0.9421 (last merge round=19)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.621714271086685, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.58508342559345, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.104865 (no previous merge yet)
[S15] round=45 local utility u=0.013559 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5810060049585014, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.606870861335903, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=45 head_norm_before_train=1.689412 cos_to_last_merge=0.9016 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.902
[S16] round=45 local utility u=1.000000 metrics={'f1_val': 0.21517085993240706, 'auprc': 0.21517085993240706, 'loss_val': 2.468430954215795, 'psi': 0.21517085993240703}-{'f1_val': 0.10526315789473684, 'auprc': 0.10526315789473684, 'loss_val': 4.236595394457949, 'psi': 0.10526315789473684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=45 head_norm_before_train=1.685771 cos_to_last_merge=0.9588 (last merge round=26)
[S17] round=45 local utility u=0.071656 metrics={'f1_val': 0.4186594612652921, 'auprc': 0.4186594612652921, 'loss_val': 1.350585216366737, 'psi': 0.4186594612652921}-{'f1_val': 0.4048147377969459, 'auprc': 0.4048147377969459, 'loss_val': 1.3692949430792927, 'psi': 0.4048147377969459}
[S17] not sending this round → trigger blocked (psi=0.419)
[S2] START round=46 head_norm_before_train=1.925396 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.25652467883705204, 'auprc': 0.25652467883705204, 'loss_val': 3.288585475944454, 'psi': 0.25652467883705204}-{'f1_val': 0.2518017171147459, 'auprc': 0.2518017171147459, 'loss_val': 2.9763833646011735, 'psi': 0.2518017171147459}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.084315 (no previous merge yet)
[S3] round=46 local utility u=0.017126 metrics={'f1_val': 0.25824669490437685, 'auprc': 0.25824669490437685, 'loss_val': 3.1415468860104387, 'psi': 0.25824669490437685}-{'f1_val': 0.26111219258970864, 'auprc': 0.26111219258970864, 'loss_val': 3.2015878208771427, 'psi': 0.26111219258970864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=46 head_norm_before_train=2.080778 cos_to_last_merge=0.9819 (last merge round=23)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.296526163626527, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2941936138871184, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=2.245516 (no previous merge yet)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.372951066981694, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.267152746955475, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.925449 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.044483209768861755, 'auprc': 0.044483209768861755, 'loss_val': 6.947640919522736, 'psi': 0.044483209768861755}-{'f1_val': 0.09980842911877395, 'auprc': 0.09980842911877395, 'loss_val': 6.697264401740083, 'psi': 0.09980842911877395}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.993310 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.22812858783008036, 'auprc': 0.22812858783008036, 'loss_val': 0.8120559795137804, 'psi': 0.22812858783008036}-{'f1_val': 0.24895341201073684, 'auprc': 0.24895341201073684, 'loss_val': 0.6213621463672776, 'psi': 0.24895341201073684}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.850085 cos_to_last_merge=0.9886 (last merge round=33)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4983131991807646, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.458954134601114, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.632166 cos_to_last_merge=0.9913 (last merge round=31)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5519638036727366, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5316901326918484, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.192082 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6516468034578746, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.643819315196894, 'psi': 0.24958183990442054}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.971470 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.3269113149847095, 'auprc': 0.3269113149847095, 'loss_val': 3.4561172334529457, 'psi': 0.3269113149847095}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.4739345480781187, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.543291 cos_to_last_merge=0.9888 (last merge round=32)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2178755690346104, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2095036261931036, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.884063 cos_to_last_merge=0.9410 (last merge round=19)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.65696913574511, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.621714271086685, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.115640 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.621905504949645, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5810060049585014, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.698223 cos_to_last_merge=0.9001 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.900
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.1341310288795332, 'auprc': 0.1341310288795332, 'loss_val': 4.149512033303005, 'psi': 0.1341310288795332}-{'f1_val': 0.21517085993240706, 'auprc': 0.21517085993240706, 'loss_val': 2.468430954215795, 'psi': 0.21517085993240703}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.695427 cos_to_last_merge=0.9577 (last merge round=26)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.3603227008892912, 'auprc': 0.3603227008892912, 'loss_val': 1.4940492757485537, 'psi': 0.3603227008892912}-{'f1_val': 0.4186594612652921, 'auprc': 0.4186594612652921, 'loss_val': 1.350585216366737, 'psi': 0.4186594612652921}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.930478 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.25652467883705204, 'auprc': 0.25652467883705204, 'loss_val': 3.30120738690806, 'psi': 0.25652467883705204}-{'f1_val': 0.25652467883705204, 'auprc': 0.25652467883705204, 'loss_val': 3.288585475944454, 'psi': 0.25652467883705204}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.088718 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.26080757016008815, 'auprc': 0.26080757016008815, 'loss_val': 3.2028470499440105, 'psi': 0.26080757016008815}-{'f1_val': 0.25824669490437685, 'auprc': 0.25824669490437685, 'loss_val': 3.1415468860104387, 'psi': 0.25824669490437685}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.085120 cos_to_last_merge=0.9816 (last merge round=23)
[S4] round=47 local utility u=0.002127 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.292272810008383, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.296526163626527, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=47 head_norm_before_train=2.244731 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.566615784725538, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.372951066981694, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.931737 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 7.109458907088696, 'psi': 0.025227272727272727}-{'f1_val': 0.044483209768861755, 'auprc': 0.044483209768861755, 'loss_val': 6.947640919522736, 'psi': 0.044483209768861755}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=2.004738 (no previous merge yet)
[S7] round=47 local utility u=0.392748 metrics={'f1_val': 0.29073935683545216, 'auprc': 0.29073935683545216, 'loss_val': 0.590057221499575, 'psi': 0.29073935683545216}-{'f1_val': 0.22812858783008036, 'auprc': 0.22812858783008036, 'loss_val': 0.8120559795137804, 'psi': 0.22812858783008036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=47 head_norm_before_train=1.862331 cos_to_last_merge=0.9878 (last merge round=33)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5266481490642312, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4983131991807646, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.642300 cos_to_last_merge=0.9908 (last merge round=31)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5726765870147754, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5519638036727366, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.200627 (no previous merge yet)
[S10] round=47 local utility u=0.001905 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6478364277824769, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6516468034578746, 'psi': 0.24958183990442054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=47 head_norm_before_train=1.977689 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.3266865306746123, 'auprc': 0.3266865306746123, 'loss_val': 3.46553531081012, 'psi': 0.3266865306746123}-{'f1_val': 0.3269113149847095, 'auprc': 0.3269113149847095, 'loss_val': 3.4561172334529457, 'psi': 0.3269113149847095}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.553996 cos_to_last_merge=0.9876 (last merge round=32)
[S13] round=47 local utility u=0.009440 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1989952801404549, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2178755690346104, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=47 head_norm_before_train=1.891073 cos_to_last_merge=0.9399 (last merge round=19)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.6904007281652165, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.65696913574511, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.126254 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6705823878707475, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.621905504949645, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.706584 cos_to_last_merge=0.8987 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.899
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.09119270458363331, 'auprc': 0.09119270458363331, 'loss_val': 4.51989644899343, 'psi': 0.09119270458363331}-{'f1_val': 0.1341310288795332, 'auprc': 0.1341310288795332, 'loss_val': 4.149512033303005, 'psi': 0.1341310288795332}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.704258 cos_to_last_merge=0.9568 (last merge round=26)
[S17] round=47 local utility u=0.526871 metrics={'f1_val': 0.45596096112860235, 'auprc': 0.45596096112860235, 'loss_val': 1.3010513176657912, 'psi': 0.45596096112860235}-{'f1_val': 0.3603227008892912, 'auprc': 0.3603227008892912, 'loss_val': 1.4940492757485537, 'psi': 0.3603227008892912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=48 head_norm_before_train=1.935510 (no previous merge yet)
[S2] round=48 local utility u=0.105668 metrics={'f1_val': 0.26209463051568316, 'auprc': 0.26209463051568316, 'loss_val': 3.140000198436122, 'psi': 0.26209463051568316}-{'f1_val': 0.25652467883705204, 'auprc': 0.25652467883705204, 'loss_val': 3.30120738690806, 'psi': 0.25652467883705204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=48 head_norm_before_train=2.089158 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.26060488310342594, 'auprc': 0.26060488310342594, 'loss_val': 3.224966126508101, 'psi': 0.26060488310342594}-{'f1_val': 0.26080757016008815, 'auprc': 0.26080757016008815, 'loss_val': 3.2028470499440105, 'psi': 0.26080757016008815}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.088853 cos_to_last_merge=0.9810 (last merge round=23)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3006066686592925, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.292272810008383, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=2.248907 (no previous merge yet)
[S5] round=48 local utility u=0.029528 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.507559886932624, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.566615784725538, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=48 head_norm_before_train=1.938014 (no previous merge yet)
[S6] round=48 local utility u=0.379980 metrics={'f1_val': 0.08452665075576771, 'auprc': 0.08452665075576771, 'loss_val': 6.883193718183358, 'psi': 0.08452665075576771}-{'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 7.109458907088696, 'psi': 0.025227272727272727}
[S6] not sending this round → trigger blocked (psi=0.085)
[S7] START round=48 head_norm_before_train=2.016822 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.27899421430881266, 'auprc': 0.27899421430881266, 'loss_val': 0.5738177373243541, 'psi': 0.27899421430881266}-{'f1_val': 0.29073935683545216, 'auprc': 0.29073935683545216, 'loss_val': 0.590057221499575, 'psi': 0.29073935683545216}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.874264 cos_to_last_merge=0.9870 (last merge round=33)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5513655159719675, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5266481490642312, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.652067 cos_to_last_merge=0.9902 (last merge round=31)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.595913288455806, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5726765870147754, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.208747 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6743594926669214, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6478364277824769, 'psi': 0.24958183990442054}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.983679 (no previous merge yet)
[S11] round=48 local utility u=0.003141 metrics={'f1_val': 0.3300910915547321, 'auprc': 0.3300910915547321, 'loss_val': 3.4898936711648623, 'psi': 0.3300910915547321}-{'f1_val': 0.3266865306746123, 'auprc': 0.3266865306746123, 'loss_val': 3.46553531081012, 'psi': 0.3266865306746123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=48 head_norm_before_train=1.562019 cos_to_last_merge=0.9866 (last merge round=32)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2242103903113455, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1989952801404549, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.897985 cos_to_last_merge=0.9389 (last merge round=19)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.724568899586464, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.6904007281652165, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.136081 (no previous merge yet)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.5849788458825841, 'auprc': 0.5849788458825841, 'loss_val': 0.6935935582085836, 'psi': 0.5849788458825841}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6705823878707475, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.713727 cos_to_last_merge=0.8974 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.897
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.08980835538449201, 'auprc': 0.08980835538449201, 'loss_val': 4.722083883450137, 'psi': 0.08980835538449201}-{'f1_val': 0.09119270458363331, 'auprc': 0.09119270458363331, 'loss_val': 4.51989644899343, 'psi': 0.09119270458363331}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.713226 cos_to_last_merge=0.9558 (last merge round=26)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.4137336874130693, 'auprc': 0.4137336874130693, 'loss_val': 1.4385203605218857, 'psi': 0.4137336874130693}-{'f1_val': 0.45596096112860235, 'auprc': 0.45596096112860235, 'loss_val': 1.3010513176657912, 'psi': 0.45596096112860235}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.940500 (no previous merge yet)
[S2] round=49 local utility u=0.023179 metrics={'f1_val': 0.25746507753428166, 'auprc': 0.25746507753428166, 'loss_val': 3.0519764057999432, 'psi': 0.25746507753428166}-{'f1_val': 0.26209463051568316, 'auprc': 0.26209463051568316, 'loss_val': 3.140000198436122, 'psi': 0.26209463051568316}
[S2] not sending this round → trigger blocked (psi=0.257)
[S3] START round=49 head_norm_before_train=2.087126 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.26055426055426056, 'auprc': 0.26055426055426056, 'loss_val': 3.231770400587228, 'psi': 0.26055426055426056}-{'f1_val': 0.26060488310342594, 'auprc': 0.26060488310342594, 'loss_val': 3.224966126508101, 'psi': 0.26060488310342594}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.088920 cos_to_last_merge=0.9800 (last merge round=23)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3293769538636748, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3006066686592925, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=2.258206 (no previous merge yet)
[S5] round=49 local utility u=0.010919 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4857217623504178, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.507559886932624, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=49 head_norm_before_train=1.944155 (no previous merge yet)
[S6] round=49 local utility u=0.081086 metrics={'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.851644575647682, 'psi': 0.09904030710172745}-{'f1_val': 0.08452665075576771, 'auprc': 0.08452665075576771, 'loss_val': 6.883193718183358, 'psi': 0.08452665075576771}
[S6] not sending this round → trigger blocked (psi=0.099)
[S7] START round=49 head_norm_before_train=2.023787 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.280863550618319, 'auprc': 0.280863550618319, 'loss_val': 0.7714314045891801, 'psi': 0.280863550618319}-{'f1_val': 0.27899421430881266, 'auprc': 0.27899421430881266, 'loss_val': 0.5738177373243541, 'psi': 0.27899421430881266}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.886308 cos_to_last_merge=0.9863 (last merge round=33)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.573547925842062, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5513655159719675, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.661643 cos_to_last_merge=0.9897 (last merge round=31)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.616948889858602, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.595913288455806, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.216700 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6797913457671396, 'psi': 0.24958183990442054}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.6743594926669214, 'psi': 0.24958183990442054}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.989511 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.5145815242282126, 'psi': 0.33154997286190585}-{'f1_val': 0.3300910915547321, 'auprc': 0.3300910915547321, 'loss_val': 3.4898936711648623, 'psi': 0.3300910915547321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.569608 cos_to_last_merge=0.9858 (last merge round=32)
[S13] round=49 local utility u=0.001438 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2213345544032785, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2242103903113455, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=49 head_norm_before_train=1.904476 cos_to_last_merge=0.9379 (last merge round=19)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.759135273130054, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.724568899586464, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.144350 (no previous merge yet)
[S15] round=49 local utility u=0.269814 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4386682018080988, 'psi': 0.6166125814646326}-{'f1_val': 0.5849788458825841, 'auprc': 0.5849788458825841, 'loss_val': 0.6935935582085836, 'psi': 0.5849788458825841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=49 head_norm_before_train=1.720918 cos_to_last_merge=0.8961 (last merge round=27)
[S16] ⚠️ Model drifted since last merge! cos=0.896
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.04591748662178491, 'auprc': 0.04591748662178491, 'loss_val': 5.063700473096691, 'psi': 0.04591748662178491}-{'f1_val': 0.08980835538449201, 'auprc': 0.08980835538449201, 'loss_val': 4.722083883450137, 'psi': 0.08980835538449201}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.724634 cos_to_last_merge=0.9545 (last merge round=26)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.4085849267016768, 'auprc': 0.4085849267016768, 'loss_val': 1.5049040737320127, 'psi': 0.4085849267016768}-{'f1_val': 0.4137336874130693, 'auprc': 0.4137336874130693, 'loss_val': 1.4385203605218857, 'psi': 0.4137336874130693}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
