[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:38503
[S3] → join 127.0.0.1:38502
[S4] → join 127.0.0.1:38502
[S5] → join 127.0.0.1:38502
[S6] → join 127.0.0.1:38502
[S7] → join 127.0.0.1:38502
[S8] → join 127.0.0.1:38502
[S9] → join 127.0.0.1:38502
[S10] → join 127.0.0.1:38502
[S11] → join 127.0.0.1:38502
[S13] → join 127.0.0.1:38502
[S14] → join 127.0.0.1:38502
[S15] → join 127.0.0.1:38502
[S16] → join 127.0.0.1:38502
[S17] → join 127.0.0.1:38502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.121705 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.164856 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.112624 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.138282 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.185833 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.174707 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.152553 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.121951 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.188303 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.122258 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.125244 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.152377 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.155854 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.183027 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.182680 (no previous merge yet)
[S9]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S3] + discovered S6
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S7
[S3] + discovered S10
[S3] + discovered S16
[S3] + discovered S14
[S3] + discovered S9
[S3] + discovered S11
[S3] + discovered S17
[S3] + discovered S8
[S3] + discovered S4
[S3] + discovered S15
[S4] + discovered S5
[S4] + discovered S13
[S4] + discovered S7
[S4] + discovered S10
[S4] + discovered S17
[S4] + discovered S14
[S4] + discovered S9
[S4] + discovered S8
[S4] + discovered S11
[S4] + discovered S15
[S4] + discovered S6
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S16
[S5] + discovered S2
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S6
[S5] + discovered S13
[S5] + discovered S7
[S5] + discovered S16
[S5] + discovered S14
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S15
[S5] + discovered S8
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S2
[S7] + discovered S3
[S7] + discovered S2
[S7] + discovered S5
[S7] + discovered S4
[S7] + discovered S6
[S6] + discovered S17
[S6] + discovered S9
[S6] + discovered S7
[S6] + discovered S13
[S6] + discovered S14
[S6] + discovered S15
[S6] + discovered S10
[S6] + discovered S16
[S6] + discovered S11
[S6] + discovered S8
[S7] + discovered S8
[S7] + discovered S13
[S7] + discovered S9
[S7] + discovered S17
[S7] + discovered S16
[S7] + discovered S11
[S7] + discovered S10
[S7] + discovered S15
[S7] + discovered S14
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S2
[S9] + discovered S2
[S9] + discovered S5
[S9] + discovered S6
[S9] + discovered S7
[S9] + discovered S4
[S9] + discovered S3
[S9] + discovered S8
[S8] + discovered S11
[S8] + discovered S15
[S8] + discovered S10
[S8] + discovered S9
[S8] + discovered S13
[S8] + discovered S14
[S8] + discovered S16
[S8] + discovered S17
[S9] + discovered S10
[S9] + discovered S13
[S9] + discovered S14
[S9] + discovered S17
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S2
[S10] + discovered S3
[S10] + discovered S5
[S10] + discovered S6
[S10] + discovered S4
[S10] + discovered S8
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S15
[S11] + discovered S3
[S11] + discovered S10
[S11] + discovered S9
[S11] + discovered S2
[S11] + discovered S8
[S11] + discovered S4
[S11] + discovered S6
[S10] + discovered S16
[S10] + discovered S15
[S11] + discovered S5
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S14
[S11] + discovered S7
[S10] + discovered S17
[S11] + discovered S15
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S16
[S13] + discovered S6
[S13] + discovered S9
[S11] + discovered S14
[S13] + discovered S7
[S13] + discovered S10
[S13] + discovered S3
[S13] + discovered S4
[S13] + discovered S2
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S11
[S14] + discovered S9
[S14] + discovered S11
[S14] + discovered S10
[S14] + discovered S7
[S14] + discovered S8
[S14] + discovered S5
[S14] + discovered S2
[S14] + discovered S4
[S14] + discovered S3
[S14] + discovered S13
[S14] + discovered S6
[S13] + discovered S14
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S15
[S14] + discovered S17
[S14] + discovered S15
[S14] + discovered S16
[S15] + discovered S14
[S15] + discovered S4
[S15] + discovered S5
[S15] + discovered S10
[S15] + discovered S9
[S15] + discovered S6
[S15] + discovered S13
[S15] + discovered S3
[S15] + discovered S2
[S15] + discovered S7
[S15] + discovered S8
[S15] + discovered S11
[S16] + discovered S14
[S16] + discovered S7
[S16] + discovered S2
[S16] + discovered S13
[S16] + discovered S15
[S16] + discovered S9
[S16] + discovered S10
[S16] + discovered S4
[S16] + discovered S11
[S16] + discovered S8
[S16] + discovered S3
[S16] + discovered S6
[S16] + discovered S5
[S15] + discovered S16
[S15] + discovered S17
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S2
[S17] + discovered S5
[S17] + discovered S16
[S17] + discovered S6
[S17] + discovered S3
[S17] + discovered S8
[S17] + discovered S4
[S17] + discovered S15
[S17] + discovered S10
[S17] + discovered S13
[S17] + discovered S7
[S17] + discovered S14
[S16] + discovered S17
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=1.000 → S5@127.0.0.1:38505
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:38516
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:38514
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:38505
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:38512
[S6] ⇄ pheromone p=1.000 → S9@127.0.0.1:38510
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:38505
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:38514
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:38507
[S10] ⇄ pheromone p=1.000 → S13@127.0.0.1:38513
[S8] ⇄ pheromone p=1.000 → S7@127.0.0.1:38508
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:38511
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:38512
[S9] ⇄ pheromone p=1.000 → S6@127.0.0.1:38507
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:38510
[S2] START round=1 head_norm_before_train=1.136440 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6210635637672068, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5279260589084604, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.190957 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7529354373503896, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4160791131161319, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.119252 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4675886756738352, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4315354191725254, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.152396 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.551490532429764, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4473512748232897, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.189724 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.583886368347064, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.48265941605588, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.191590 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.695027005522212, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4880584919961677, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.154413 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4128620561612992, 'psi': 0.0}-{'f1_val': 0.22608820160366552, 'auprc': 0.22608820160366552, 'loss_val': 1.3804375127544863, 'psi': 0.22608820160366552}
[S9] START round=1 head_norm_before_train=1.130991 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6637846333722077, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4526927119771247, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.194610 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.436465586501372, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3934739442666233, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.123993 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5263296089817957, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4568653464802086, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.135013 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.47001135783746, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4452345639257826, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.170451 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6154337126509215, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5290786696410201, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.173542 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5613066655243255, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4770811540447715, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.202794 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6255205732542322, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4790421238625835, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.185498 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.492408405479853, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.456667633828824, 'psi': 0.0}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.160149 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8241694913617477, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6210635637672068, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.242644 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7115116747462626, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7529354373503896, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.136868 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5194121342766873, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4675886756738352, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.191225 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8994351054219787, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.551490532429764, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.208563 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7928415763538534, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.583886368347064, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.242376 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8944767327828758, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.695027005522212, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.166113 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4876345982850112, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4128620561612992, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.177254 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4667179621419297, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6637846333722077, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.212903 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5280926719675205, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.436465586501372, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.138840 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6384484221786575, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5263296089817957, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.152444 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5321851216285023, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.47001135783746, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.200950 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7752432253404644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6154337126509215, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.197745 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7144195578029628, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5613066655243255, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.234378 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9553735126279996, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6255205732542322, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.198662 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5679411892256523, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.492408405479853, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.195183 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.381616974756911, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8241694913617477, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.299704 (no previous merge yet)
[S3] round=3 local utility u=0.197695 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3161208766407, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7115116747462626, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.165777 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6503893829857108, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5194121342766873, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.239537 (no previous merge yet)
[S5] round=3 local utility u=0.151772 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5958915091103545, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8994351054219787, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.239685 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3269499069701984, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7928415763538534, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.279247 (no previous merge yet)
[S7] round=3 local utility u=0.094258 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7059602564372314, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8944767327828758, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.187790 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6864161590980837, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4876345982850112, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.249695 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.67627688701108, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4667179621419297, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.239988 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6930120911180944, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5280926719675205, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.164902 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.903407340205328, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6384484221786575, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.178820 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.674020883111644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5321851216285023, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.240319 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1702819626592658, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7752432253404644, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.225353 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.059186589265499, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7144195578029628, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.273885 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7474438659362006, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9553735126279996, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.225267 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7656908353523129, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5679411892256523, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.238342 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.773668796496071, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.381616974756911, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.331523 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4767206918978117, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3161208766407, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.204889 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.783796469627523, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6503893829857108, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.242163 (no previous merge yet)
[S5] round=4 local utility u=0.782040 metrics={'f1_val': 0.16026871401151632, 'auprc': 0.16026871401151632, 'loss_val': 1.4742306122777287, 'psi': 0.16026871401151632}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5958915091103545, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.277063 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9588584027528135, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3269499069701984, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.287655 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8238933593253548, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7059602564372314, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.216829 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8639140222116193, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6864161590980837, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.317509 (no previous merge yet)
[S9] round=4 local utility u=0.135485 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4053065789580965, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.67627688701108, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.268979 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.055413301038726, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6930120911180944, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.201261 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.574194992249043, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.903407340205328, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.211289 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.75493660335313, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.674020883111644, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.287477 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.097534194479357, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1702819626592658, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.254349 (no previous merge yet)
[S15] round=4 local utility u=0.043522 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9721425320566592, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.059186589265499, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.317843 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.532209532933313, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7474438659362006, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.261249 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0467722563107986, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7656908353523129, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.160)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.266328 (no previous merge yet)
[S2] round=5 local utility u=0.045139 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.683390497743148, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.773668796496071, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.377334 (no previous merge yet)
[S3] round=5 local utility u=0.269957 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.936805764381335, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4767206918978117, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.241354 (no previous merge yet)
[S4] round=5 local utility u=0.111535 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5607262078759268, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.783796469627523, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.260422 (no previous merge yet)
[S5] round=5 local utility u=0.474983 metrics={'f1_val': 0.258887171561051, 'auprc': 0.258887171561051, 'loss_val': 1.4118313329656462, 'psi': 0.258887171561051}-{'f1_val': 0.16026871401151632, 'auprc': 0.16026871401151632, 'loss_val': 1.4742306122777287, 'psi': 0.16026871401151632}
[S6] START round=5 head_norm_before_train=1.308205 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.998852924894644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9588584027528135, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.322480 (no previous merge yet)
[S7] round=5 local utility u=0.121481 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5809314487231467, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8238933593253548, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.237468 (no previous merge yet)
[S8] round=5 local utility u=0.027142 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.809629844109856, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8639140222116193, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.379703 (no previous merge yet)
[S9] round=5 local utility u=0.102251 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.200804464611285, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4053065789580965, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.299111 (no previous merge yet)
[S10] round=5 local utility u=0.061065 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.933282808789471, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.055413301038726, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.240687 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9850390673890135, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.574194992249043, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.233490 (no previous merge yet)
[S13] round=5 local utility u=0.050393 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6541496317050328, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.75493660335313, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.338061 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3726125745418294, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.097534194479357, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.262887 (no previous merge yet)
[S15] round=5 local utility u=0.073871 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8244011841274033, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9721425320566592, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.352059 (no previous merge yet)
[S16] round=5 local utility u=0.124069 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2840714394805826, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.532209532933313, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.293880 (no previous merge yet)
[S17] round=5 local utility u=0.112613 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8215454561798767, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0467722563107986, 'psi': 0.0}
[S7] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:38516
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] cosine check vs S5: cos=0.1060
[S17] not sending this round → trigger blocked (psi=0.000)
[S9] ⇄ pheromone p=0.370 → S14@127.0.0.1:38514
[S10] ⇄ pheromone p=0.340 → S5@127.0.0.1:38505
[S3] ⇄ pheromone p=0.407 → S5@127.0.0.1:38505
[S15] ⇄ pheromone p=0.349 → S5@127.0.0.1:38505
[S4] ⇄ pheromone p=0.350 → S11@127.0.0.1:38512
[S13] ⇄ pheromone p=0.338 → S9@127.0.0.1:38510
[S8] ⇄ pheromone p=0.333 → S7@127.0.0.1:38508
[S6] ⇄ pheromone p=0.328 → S4@127.0.0.1:38504
[S11] ⇄ pheromone p=0.328 → S9@127.0.0.1:38510
[S14] ⇄ pheromone p=0.328 → S5@127.0.0.1:38505
[S7] ⇄ pheromone p=0.364 → S14@127.0.0.1:38514
[S2] ⇄ pheromone p=0.337 → S5@127.0.0.1:38505
[S5] ⇄ pheromone p=0.567 → S16@127.0.0.1:38516
[S17] ⇄ pheromone p=0.350 → S9@127.0.0.1:38510
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.0000 head_norm=1.373536
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.932582e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.0000 head_norm=0.993372 delta_norm=0.893258
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.352 → S6@127.0.0.1:38507
[S2] START round=6 head_norm_before_train=1.288963 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9179617407094254, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.683390497743148, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.424817 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.101315425755447, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.936805764381335, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.256445 (no previous merge yet)
[S4] round=6 local utility u=0.055820 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.449085595520091, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5607262078759268, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.297227 (no previous merge yet)
[S5] round=6 local utility u=0.570088 metrics={'f1_val': 0.36694361333633607, 'auprc': 0.36694361333633607, 'loss_val': 1.2441632441667962, 'psi': 0.36694361333633607}-{'f1_val': 0.258887171561051, 'auprc': 0.258887171561051, 'loss_val': 1.4118313329656462, 'psi': 0.258887171561051}
[S6] START round=6 head_norm_before_train=1.330899 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1607938556799833, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.998852924894644, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.344146 (no previous merge yet)
[S7] round=6 local utility u=0.063083 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4547653533929565, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5809314487231467, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.250573 (no previous merge yet)
[S8] round=6 local utility u=0.088004 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6336209684556513, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.809629844109856, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.437409 (no previous merge yet)
[S9] round=6 local utility u=0.720297 metrics={'f1_val': 0.13457520891364902, 'auprc': 0.13457520891364902, 'loss_val': 1.9713867832150584, 'psi': 0.13457520891364902}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.200804464611285, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.310926 (no previous merge yet)
[S10] round=6 local utility u=0.028640 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8760035515011535, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.933282808789471, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.267108 (no previous merge yet)
[S11] round=6 local utility u=0.236571 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.511896199175129, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9850390673890135, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.243716 (no previous merge yet)
[S13] round=6 local utility u=0.069599 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.514952146118905, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6541496317050328, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.375425 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6216865099517332, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3726125745418294, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.270774 (no previous merge yet)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8777885068072642, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8244011841274033, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=0.993372 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.389730 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.504611718324437, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2840714394805826, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.308116 (no previous merge yet)
[S17] round=6 local utility u=0.088371 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6448031970833499, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8215454561798767, 'psi': 0.0}
[S4] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.135)
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.367)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=7 head_norm_before_train=1.320262 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.53633859165033, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9179617407094254, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.482446 (no previous merge yet)
[S3] round=7 local utility u=0.691766 metrics={'f1_val': 0.13354531001589826, 'auprc': 0.13354531001589826, 'loss_val': 1.9196903866652792, 'psi': 0.13354531001589826}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.101315425755447, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.279724 (no previous merge yet)
[S4] round=7 local utility u=0.018430 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4122258796804696, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.449085595520091, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.325872 (no previous merge yet)
[S5] round=7 local utility u=0.011990 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1517416136975878, 'psi': 0.35933890172383154}-{'f1_val': 0.36694361333633607, 'auprc': 0.36694361333633607, 'loss_val': 1.2441632441667962, 'psi': 0.36694361333633607}
[S6] START round=7 head_norm_before_train=1.357560 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4000401510526537, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1607938556799833, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.375613 (no previous merge yet)
[S7] round=7 local utility u=0.021485 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4117958304075227, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4547653533929565, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.260904 (no previous merge yet)
[S8] round=7 local utility u=0.052668 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.528285559061452, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6336209684556513, 'psi': 0.0}
[S9] START round=7 head_norm_before_train=1.495470 (no previous merge yet)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.847756715871484, 'psi': 0.36867172340800847}-{'f1_val': 0.13457520891364902, 'auprc': 0.13457520891364902, 'loss_val': 1.9713867832150584, 'psi': 0.13457520891364902}
[S10] START round=7 head_norm_before_train=1.328475 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.199940955456842, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8760035515011535, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.282504 (no previous merge yet)
[S11] round=7 local utility u=0.200089 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.11171774736979, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.511896199175129, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.253029 (no previous merge yet)
[S13] round=7 local utility u=0.037805 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4393427103115342, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.514952146118905, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.405005 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.265786214097474, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6216865099517332, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.289800 (no previous merge yet)
[S15] round=7 local utility u=0.069204 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7393810059357289, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8777885068072642, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.018534 cos_to_last_merge=0.9985 (last merge round=5)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8063079346396367, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.504611718324437, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.326493 (no previous merge yet)
[S17] round=7 local utility u=0.039433 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.565937769545786, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6448031970833499, 'psi': 0.0}
[S3] not sending this round → trigger blocked (psi=0.134)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38514
[S15] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:38516
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=-0.0770
[S14] DROPPED delta from S9 (cos=-0.0770 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.6885
[S17] not sending this round → trigger blocked (psi=0.000)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.0000 head_norm=1.052432
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.994722e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.114196 delta_norm=0.499472
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.355943 (no previous merge yet)
[S2] round=8 local utility u=0.249441 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0374556421435974, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.53633859165033, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.536746 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.14469078179696618, 'auprc': 0.14469078179696618, 'loss_val': 2.306398466612089, 'psi': 0.14469078179696618}-{'f1_val': 0.13354531001589826, 'auprc': 0.13354531001589826, 'loss_val': 1.9196903866652792, 'psi': 0.13354531001589826}
[S4] START round=8 head_norm_before_train=1.318182 (no previous merge yet)
[S4] round=8 local utility u=0.033874 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3444769498828264, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4122258796804696, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.369014 (no previous merge yet)
[S5] round=8 local utility u=0.070751 metrics={'f1_val': 0.3696860919342336, 'auprc': 0.3696860919342336, 'loss_val': 1.1033649166973165, 'psi': 0.3696860919342336}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1517416136975878, 'psi': 0.35933890172383154}
[S6] START round=8 head_norm_before_train=1.391003 (no previous merge yet)
[S6] round=8 local utility u=0.028869 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3423013085587976, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4000401510526537, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.408064 (no previous merge yet)
[S7] round=8 local utility u=0.005003 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4017895648580585, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4117958304075227, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.280413 (no previous merge yet)
[S8] round=8 local utility u=1.000000 metrics={'f1_val': 0.2677603304212109, 'auprc': 0.2677603304212109, 'loss_val': 1.3858085147402455, 'psi': 0.2677603304212109}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.528285559061452, 'psi': 0.0}
[S9] START round=8 head_norm_before_train=1.554495 (no previous merge yet)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9723776931271997, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.847756715871484, 'psi': 0.36867172340800847}
[S10] START round=8 head_norm_before_train=1.358325 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.524447423993658, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.199940955456842, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.302517 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.228685101789978, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.11171774736979, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.270746 (no previous merge yet)
[S13] round=8 local utility u=0.332027 metrics={'f1_val': 0.06453522794552989, 'auprc': 0.06453522794552989, 'loss_val': 1.3561061685813067, 'psi': 0.06453522794552989}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4393427103115342, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.433018 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.744681204671258, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.265786214097474, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.306344 (no previous merge yet)
[S15] round=8 local utility u=0.098336 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5427084779242288, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7393810059357289, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.114196 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.226103 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.35410219711288, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8063079346396367, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.354229 (no previous merge yet)
[S17] round=8 local utility u=0.041749 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4824401236325233, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.565937769545786, 'psi': 0.0}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38508
[S15] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.065)
[S5] not sending this round → trigger blocked (psi=0.370)
[S7] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] cosine check vs S8: cos=-0.0063
[S7] DROPPED delta from S8 (cos=-0.0063 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=9 head_norm_before_train=1.384644 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.967326368920811, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0374556421435974, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.585975 (no previous merge yet)
[S3] round=9 local utility u=0.715898 metrics={'f1_val': 0.264021164021164, 'auprc': 0.264021164021164, 'loss_val': 1.9485752527112103, 'psi': 0.264021164021164}-{'f1_val': 0.14469078179696618, 'auprc': 0.14469078179696618, 'loss_val': 2.306398466612089, 'psi': 0.14469078179696618}
[S4] START round=9 head_norm_before_train=1.354637 (no previous merge yet)
[S4] round=9 local utility u=0.014878 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3147203651142647, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3444769498828264, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.414303 (no previous merge yet)
[S5] round=9 local utility u=1.000000 metrics={'f1_val': 0.6640048007455907, 'auprc': 0.6640048007455907, 'loss_val': 1.064899378237825, 'psi': 0.6640048007455907}-{'f1_val': 0.3696860919342336, 'auprc': 0.3696860919342336, 'loss_val': 1.1033649166973165, 'psi': 0.3696860919342336}
[S6] START round=9 head_norm_before_train=1.426291 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.377666102182026, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3423013085587976, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.436468 (no previous merge yet)
[S7] round=9 local utility u=0.004882 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3920255287386771, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4017895648580585, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.303739 (no previous merge yet)
[S8] round=9 local utility u=0.110156 metrics={'f1_val': 0.2803690134107535, 'auprc': 0.2803690134107535, 'loss_val': 1.2789749277759355, 'psi': 0.2803690134107535}-{'f1_val': 0.2677603304212109, 'auprc': 0.2677603304212109, 'loss_val': 1.3858085147402455, 'psi': 0.2677603304212109}
[S9] START round=9 head_norm_before_train=1.606149 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.127946609800887, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9723776931271997, 'psi': 0.36867172340800847}
[S10] START round=9 head_norm_before_train=1.390174 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9382360247675927, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.524447423993658, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.332082 (no previous merge yet)
[S11] round=9 local utility u=0.149913 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9288593293276324, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.228685101789978, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.293919 (no previous merge yet)
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.2947522398976047, 'auprc': 0.2947522398976047, 'loss_val': 1.2423975469000599, 'psi': 0.2947522398976047}-{'f1_val': 0.06453522794552989, 'auprc': 0.06453522794552989, 'loss_val': 1.3561061685813067, 'psi': 0.06453522794552989}
[S14] START round=9 head_norm_before_train=1.461328 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.112787850189014, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.744681204671258, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.325210 (no previous merge yet)
[S15] round=9 local utility u=0.089287 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3641334933593778, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5427084779242288, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.143548 cos_to_last_merge=0.9980 (last merge round=7)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7137460825581945, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.35410219711288, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.385706 (no previous merge yet)
[S17] round=9 local utility u=0.037747 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4069457938355583, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4824401236325233, 'psi': 0.0}
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:38516
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.280)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[S3] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.0071
[S5] RECEIVED delta(kind=head bytes=1796) from S3
[S5] cosine check vs S3: cos=0.0140
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.8995
[S17] not sending this round → trigger blocked (psi=0.000)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.3687 head_norm=1.652493
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.052762e+00
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.3687 head_norm=1.060108 delta_norm=1.052762
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.6640 head_norm=1.462617
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.089135e+00
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.6644 head_norm=1.104391 delta_norm=1.089135
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.0000 head_norm=1.181378
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.264371e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.288755 delta_norm=0.326437
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.412162 (no previous merge yet)
[S2] round=10 local utility u=0.631768 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.703789409467664, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.967326368920811, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.634791 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.2683701750828094, 'auprc': 0.2683701750828094, 'loss_val': 2.1984073099997405, 'psi': 0.2683701750828094}-{'f1_val': 0.264021164021164, 'auprc': 0.264021164021164, 'loss_val': 1.9485752527112103, 'psi': 0.264021164021164}
[S4] START round=10 head_norm_before_train=1.389729 (no previous merge yet)
[S4] round=10 local utility u=0.001406 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3119090820737038, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3147203651142647, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.104391 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.6463360142984808, 'auprc': 0.6463360142984808, 'loss_val': 1.1535022137851445, 'psi': 0.6463360142984808}-{'f1_val': 0.6640048007455907, 'auprc': 0.6640048007455907, 'loss_val': 1.064899378237825, 'psi': 0.6640048007455907}
[S6] START round=10 head_norm_before_train=1.460100 (no previous merge yet)
[S6] round=10 local utility u=0.079242 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.219181339997091, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.377666102182026, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.471543 (no previous merge yet)
[S7] round=10 local utility u=1.000000 metrics={'f1_val': 0.2533415587086161, 'auprc': 0.2533415587086161, 'loss_val': 1.34860731309695, 'psi': 0.2533415587086161}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3920255287386771, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.334439 (no previous merge yet)
[S8] round=10 local utility u=0.036444 metrics={'f1_val': 0.27982112660132313, 'auprc': 0.27982112660132313, 'loss_val': 1.2011562942512972, 'psi': 0.27982112660132313}-{'f1_val': 0.2803690134107535, 'auprc': 0.2803690134107535, 'loss_val': 1.2789749277759355, 'psi': 0.2803690134107535}
[S9] START round=10 head_norm_before_train=1.060108 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.232923 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6621004458557165, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.127946609800887, 'psi': 0.36867172340800847}
[S10] START round=10 head_norm_before_train=1.425011 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2046877120532566, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9382360247675927, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.365733 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1008648634448126, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9288593293276324, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.316640 (no previous merge yet)
[S13] round=10 local utility u=1.000000 metrics={'f1_val': 0.6441783082271724, 'auprc': 0.6441783082271724, 'loss_val': 1.1772167965965787, 'psi': 0.6441783082271724}-{'f1_val': 0.2947522398976047, 'auprc': 0.2947522398976047, 'loss_val': 1.2423975469000599, 'psi': 0.2947522398976047}
[S14] START round=10 head_norm_before_train=1.487077 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.543383316974576, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.112787850189014, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.348110 (no previous merge yet)
[S15] round=10 local utility u=1.000000 metrics={'f1_val': 0.2494467277900727, 'auprc': 0.2494467277900727, 'loss_val': 1.2724267496322081, 'psi': 0.2494467277900727}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3641334933593778, 'psi': 0.0}
[S16] START round=10 head_norm_before_train=1.288755 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.158224 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.397297486371755, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7137460825581945, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.414361 (no previous merge yet)
[S17] round=10 local utility u=0.002205 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4025357519216584, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4069457938355583, 'psi': 0.0}
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38514
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38508
[S2] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.644)
[S16] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] cosine check vs S9: cos=-0.1173
[S14] DROPPED delta from S9 (cos=-0.1173 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] cosine check vs S8: cos=-0.0084
[S7] DROPPED delta from S8 (cos=-0.0084 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=-0.0674
[S5] DROPPED delta from S15 (cos=-0.0674 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=-0.0481
[S14] DROPPED delta from S7 (cos=-0.0481 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S5] ⇄ pheromone p=0.403 → S16@127.0.0.1:38516
[S13] ⇄ pheromone p=0.523 → S9@127.0.0.1:38510
[S14] ⇄ pheromone p=0.107 → S5@127.0.0.1:38505
[S3] ⇄ pheromone p=0.319 → S5@127.0.0.1:38505
[S6] ⇄ pheromone p=0.127 → S4@127.0.0.1:38504
[S2] ⇄ pheromone p=0.269 → S5@127.0.0.1:38505
[S10] ⇄ pheromone p=0.114 → S5@127.0.0.1:38505
[S11] ⇄ pheromone p=0.171 → S9@127.0.0.1:38510
[S4] ⇄ pheromone p=0.128 → S11@127.0.0.1:38512
[S9] ⇄ pheromone p=0.329 → S14@127.0.0.1:38514
[S15] ⇄ pheromone p=0.348 → S5@127.0.0.1:38505
[S8] ⇄ pheromone p=0.275 → S7@127.0.0.1:38508
[S7] ⇄ pheromone p=0.328 → S14@127.0.0.1:38514
[S17] ⇄ pheromone p=0.138 → S9@127.0.0.1:38510
[S16] ⇄ pheromone p=0.208 → S6@127.0.0.1:38507
[S2] START round=11 head_norm_before_train=1.434424 (no previous merge yet)
[S2] round=11 local utility u=0.522604 metrics={'f1_val': 0.13812154696132597, 'auprc': 0.13812154696132597, 'loss_val': 2.901674473773063, 'psi': 0.13812154696132597}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.703789409467664, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.679827 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.2932540754750968, 'auprc': 0.2932540754750968, 'loss_val': 3.0303688935751913, 'psi': 0.2932540754750968}-{'f1_val': 0.2683701750828094, 'auprc': 0.2683701750828094, 'loss_val': 2.1984073099997405, 'psi': 0.2683701750828094}
[S4] START round=11 head_norm_before_train=1.427749 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3356970551950085, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3119090820737038, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.144350 cos_to_last_merge=0.9958 (last merge round=9)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.33493014743065364, 'auprc': 0.33493014743065364, 'loss_val': 1.3153396470645242, 'psi': 0.33493014743065364}-{'f1_val': 0.6463360142984808, 'auprc': 0.6463360142984808, 'loss_val': 1.1535022137851445, 'psi': 0.6463360142984808}
[S6] START round=11 head_norm_before_train=1.494417 (no previous merge yet)
[S6] round=11 local utility u=0.191777 metrics={'f1_val': 0.03925893250992501, 'auprc': 0.03925893250992501, 'loss_val': 3.1889583747571346, 'psi': 0.03925893250992501}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.219181339997091, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.512138 (no previous merge yet)
[S7] round=11 local utility u=0.399732 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 1.2675784656006175, 'psi': 0.33316757831924415}-{'f1_val': 0.2533415587086161, 'auprc': 0.2533415587086161, 'loss_val': 1.34860731309695, 'psi': 0.2533415587086161}
[S8] START round=11 head_norm_before_train=1.368511 (no previous merge yet)
[S8] round=11 local utility u=0.204893 metrics={'f1_val': 0.31957188687691046, 'auprc': 0.31957188687691046, 'loss_val': 1.1491274072919468, 'psi': 0.31957188687691046}-{'f1_val': 0.27982112660132313, 'auprc': 0.27982112660132313, 'loss_val': 1.2011562942512972, 'psi': 0.27982112660132313}
[S9] START round=11 head_norm_before_train=1.148025 cos_to_last_merge=0.9961 (last merge round=9)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8090666638909745, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6621004458557165, 'psi': 0.36867172340800847}
[S10] START round=11 head_norm_before_train=1.459392 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4577278182808646, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2046877120532566, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.404618 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.293068271799414, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1008648634448126, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.341247 (no previous merge yet)
[S13] round=11 local utility u=0.137533 metrics={'f1_val': 0.6663385826771654, 'auprc': 0.6663385826771654, 'loss_val': 1.1015923397736487, 'psi': 0.6663385826771654}-{'f1_val': 0.6441783082271724, 'auprc': 0.6441783082271724, 'loss_val': 1.1772167965965787, 'psi': 0.6441783082271724}
[S14] START round=11 head_norm_before_train=1.512125 (no previous merge yet)
[S14] round=11 local utility u=0.125027 metrics={'f1_val': 0.011254019292604502, 'auprc': 0.011254019292604502, 'loss_val': 5.394614598459523, 'psi': 0.011254019292604502}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.543383316974576, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.376319 (no previous merge yet)
[S15] round=11 local utility u=0.416263 metrics={'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 1.194880280743771, 'psi': 0.3333333333333333}-{'f1_val': 0.2494467277900727, 'auprc': 0.2494467277900727, 'loss_val': 1.2724267496322081, 'psi': 0.2494467277900727}
[S16] START round=11 head_norm_before_train=1.320489 cos_to_last_merge=0.9986 (last merge round=9)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.0002318034306907742, 'auprc': 0.0002318034306907742, 'loss_val': 2.5420314059191282, 'psi': 0.0002318034306907742}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.397297486371755, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.439051 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.408183360661363, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4025357519216584, 'psi': 0.0}
[S2] not sending this round → trigger blocked (psi=0.138)
[S6] not sending this round → trigger blocked (psi=0.039)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S13] → sending delta(kind=head bytes=1810) to S9@127.0.0.1:38510
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.011)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.333)
[S7] not sending this round → trigger blocked (psi=0.333)
[S8] not sending this round → trigger blocked (psi=0.320)
[S13] sending update (kind=head size=1810 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1810) from S13
[S9] cosine check vs S13: cos=0.5334
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.3687 head_norm=1.254257
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.355568e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.3687 head_norm=1.148850 delta_norm=0.635557
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.458690 (no previous merge yet)
[S2] round=12 local utility u=0.345964 metrics={'f1_val': 0.19391668896619393, 'auprc': 0.19391668896619393, 'loss_val': 2.7119029724425547, 'psi': 0.19391668896619393}-{'f1_val': 0.13812154696132597, 'auprc': 0.13812154696132597, 'loss_val': 2.901674473773063, 'psi': 0.13812154696132597}
[S3] START round=12 head_norm_before_train=1.724375 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.26976819319925693, 'auprc': 0.26976819319925693, 'loss_val': 2.8417958394889977, 'psi': 0.26976819319925693}-{'f1_val': 0.2932540754750968, 'auprc': 0.2932540754750968, 'loss_val': 3.0303688935751913, 'psi': 0.2932540754750968}
[S4] START round=12 head_norm_before_train=1.466517 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3373221611050488, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3356970551950085, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.207799 cos_to_last_merge=0.9833 (last merge round=9)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.8330068575895315, 'psi': 0.33451196111837667}-{'f1_val': 0.33493014743065364, 'auprc': 0.33493014743065364, 'loss_val': 1.3153396470645242, 'psi': 0.33493014743065364}
[S6] START round=12 head_norm_before_train=1.529309 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.044085552160628545, 'auprc': 0.044085552160628545, 'loss_val': 3.8287042852650672, 'psi': 0.044085552160628545}-{'f1_val': 0.03925893250992501, 'auprc': 0.03925893250992501, 'loss_val': 3.1889583747571346, 'psi': 0.03925893250992501}
[S7] START round=12 head_norm_before_train=1.550090 (no previous merge yet)
[S7] round=12 local utility u=0.145618 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2157070727716104, 'psi': 0.35976373724718097}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 1.2675784656006175, 'psi': 0.33316757831924415}
[S8] START round=12 head_norm_before_train=1.404703 (no previous merge yet)
[S8] round=12 local utility u=0.089360 metrics={'f1_val': 0.3345937444537355, 'auprc': 0.3345937444537355, 'loss_val': 1.105603383969121, 'psi': 0.3345937444537355}-{'f1_val': 0.31957188687691046, 'auprc': 0.31957188687691046, 'loss_val': 1.1491274072919468, 'psi': 0.31957188687691046}
[S9] START round=12 head_norm_before_train=1.148850 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.2455583009765855, 'auprc': 0.2455583009765855, 'loss_val': 1.6197346824821093, 'psi': 0.2455583009765855}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8090666638909745, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=1.492357 (no previous merge yet)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7252916544130774, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4577278182808646, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.444313 (no previous merge yet)
[S11] round=12 local utility u=0.024282 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.24450475976977, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.293068271799414, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.369094 (no previous merge yet)
[S13] round=12 local utility u=1.000000 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 1.0173356178904838, 'psi': 0.9994382441285097}-{'f1_val': 0.6663385826771654, 'auprc': 0.6663385826771654, 'loss_val': 1.1015923397736487, 'psi': 0.6663385826771654}
[S14] START round=12 head_norm_before_train=1.532457 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0003131360576170346, 'auprc': 0.0003131360576170346, 'loss_val': 5.5725399043200605, 'psi': 0.0003131360576170346}-{'f1_val': 0.011254019292604502, 'auprc': 0.011254019292604502, 'loss_val': 5.394614598459523, 'psi': 0.011254019292604502}
[S15] START round=12 head_norm_before_train=1.407140 (no previous merge yet)
[S15] round=12 local utility u=0.047313 metrics={'f1_val': 0.33322801474460245, 'auprc': 0.33322801474460245, 'loss_val': 1.0993073318417972, 'psi': 0.33322801474460245}-{'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 1.194880280743771, 'psi': 0.3333333333333333}
[S16] START round=12 head_norm_before_train=1.356129 cos_to_last_merge=0.9951 (last merge round=9)
[S16] round=12 local utility u=0.269111 metrics={'f1_val': 0.06658692185007975, 'auprc': 0.06658692185007975, 'loss_val': 2.6010057944004052, 'psi': 0.06658692185007975}-{'f1_val': 0.0002318034306907742, 'auprc': 0.0002318034306907742, 'loss_val': 2.5420314059191282, 'psi': 0.0002318034306907742}
[S17] START round=12 head_norm_before_train=1.460850 (no previous merge yet)
[S17] round=12 local utility u=0.007967 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3922485573514278, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.408183360661363, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.194)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38508
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:38514
[S16] not sending this round → trigger blocked (psi=0.067)
[S13] not sending this round → trigger blocked (psi=0.999)
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1806) from S7
[S14] cosine check vs S7: cos=-0.0395
[S14] DROPPED delta from S7 (cos=-0.0395 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=-0.0651
[S5] DROPPED delta from S15 (cos=-0.0651 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] cosine check vs S8: cos=-0.0163
[S7] DROPPED delta from S8 (cos=-0.0163 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=13 head_norm_before_train=1.486589 (no previous merge yet)
[S2] round=13 local utility u=0.071352 metrics={'f1_val': 0.19470404984423675, 'auprc': 0.19470404984423675, 'loss_val': 2.5762859807955576, 'psi': 0.19470404984423675}-{'f1_val': 0.19391668896619393, 'auprc': 0.19391668896619393, 'loss_val': 2.7119029724425547, 'psi': 0.19391668896619393}
[S3] START round=13 head_norm_before_train=1.762902 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.289653945378525, 'auprc': 0.289653945378525, 'loss_val': 3.265778525677116, 'psi': 0.289653945378525}-{'f1_val': 0.26976819319925693, 'auprc': 0.26976819319925693, 'loss_val': 2.8417958394889977, 'psi': 0.26976819319925693}
[S4] START round=13 head_norm_before_train=1.498417 (no previous merge yet)
[S4] round=13 local utility u=0.006032 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3252583627467602, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3373221611050488, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.285156 cos_to_last_merge=0.9675 (last merge round=9)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.260525054456519, 'psi': 0.33358943696313936}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.8330068575895315, 'psi': 0.33451196111837667}
[S6] START round=13 head_norm_before_train=1.563689 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.05458422174840085, 'auprc': 0.05458422174840085, 'loss_val': 4.144603255823944, 'psi': 0.054584221748400844}-{'f1_val': 0.044085552160628545, 'auprc': 0.044085552160628545, 'loss_val': 3.8287042852650672, 'psi': 0.044085552160628545}
[S7] START round=13 head_norm_before_train=1.588353 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.2383860153256705, 'auprc': 0.2383860153256705, 'loss_val': 1.219002982760404, 'psi': 0.2383860153256705}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2157070727716104, 'psi': 0.35976373724718097}
[S8] START round=13 head_norm_before_train=1.439106 (no previous merge yet)
[S8] round=13 local utility u=0.790625 metrics={'f1_val': 0.506725471616849, 'auprc': 0.506725471616849, 'loss_val': 1.0735397795486528, 'psi': 0.506725471616849}-{'f1_val': 0.3345937444537355, 'auprc': 0.3345937444537355, 'loss_val': 1.105603383969121, 'psi': 0.3345937444537355}
[S9] START round=13 head_norm_before_train=1.246812 cos_to_last_merge=0.9907 (last merge round=11)
[S9] round=13 local utility u=0.484597 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7585622551248612, 'psi': 0.36867172340800847}-{'f1_val': 0.2455583009765855, 'auprc': 0.2455583009765855, 'loss_val': 1.6197346824821093, 'psi': 0.2455583009765855}
[S10] START round=13 head_norm_before_train=1.521601 (no previous merge yet)
[S10] round=13 local utility u=0.327639 metrics={'f1_val': 0.05010752688172043, 'auprc': 0.05010752688172043, 'loss_val': 3.5209805581693807, 'psi': 0.05010752688172043}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7252916544130774, 'psi': 0.0}
[S11] START round=13 head_norm_before_train=1.481929 (no previous merge yet)
[S11] round=13 local utility u=1.000000 metrics={'f1_val': 0.33247763516141576, 'auprc': 0.33247763516141576, 'loss_val': 2.4445019629386064, 'psi': 0.33247763516141576}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.24450475976977, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.402128 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6237741508614928, 'auprc': 0.6237741508614928, 'loss_val': 0.9554020975318649, 'psi': 0.6237741508614928}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 1.0173356178904838, 'psi': 0.9994382441285097}
[S14] START round=13 head_norm_before_train=1.552713 (no previous merge yet)
[S14] round=13 local utility u=0.264621 metrics={'f1_val': 0.04716157205240174, 'auprc': 0.04716157205240174, 'loss_val': 5.464934177440869, 'psi': 0.04716157205240174}-{'f1_val': 0.0003131360576170346, 'auprc': 0.0003131360576170346, 'loss_val': 5.5725399043200605, 'psi': 0.0003131360576170346}
[S15] START round=13 head_norm_before_train=1.441116 (no previous merge yet)
[S15] round=13 local utility u=0.004093 metrics={'f1_val': 0.3303590397280646, 'auprc': 0.3303590397280646, 'loss_val': 1.0652997633299228, 'psi': 0.3303590397280646}-{'f1_val': 0.33322801474460245, 'auprc': 0.33322801474460245, 'loss_val': 1.0993073318417972, 'psi': 0.33322801474460245}
[S16] START round=13 head_norm_before_train=1.391253 cos_to_last_merge=0.9908 (last merge round=9)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.000371298616912652, 'auprc': 0.000371298616912652, 'loss_val': 3.1590118343791445, 'psi': 0.000371298616912652}-{'f1_val': 0.06658692185007975, 'auprc': 0.06658692185007975, 'loss_val': 2.6010057944004052, 'psi': 0.06658692185007975}
[S17] START round=13 head_norm_before_train=1.477895 (no previous merge yet)
[S17] round=13 local utility u=0.478586 metrics={'f1_val': 0.10211985324092947, 'auprc': 0.10211985324092947, 'loss_val': 1.3541559532004668, 'psi': 0.10211985324092947}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3922485573514278, 'psi': 0.0}
[S14] not sending this round → trigger blocked (psi=0.047)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:38514
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.330)
[S10] not sending this round → trigger blocked (psi=0.050)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.195)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[S4] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.507)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] cosine check vs S9: cos=-0.1174
[S14] DROPPED delta from S9 (cos=-0.1174 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.0582
[S17] not sending this round → trigger blocked (psi=0.102)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.3687 head_norm=1.352855
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.857814e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.3687 head_norm=1.044562 delta_norm=0.985781
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.517232 (no previous merge yet)
[S2] round=14 local utility u=0.366289 metrics={'f1_val': 0.262, 'auprc': 0.262, 'loss_val': 2.449371440425691, 'psi': 0.262}-{'f1_val': 0.19470404984423675, 'auprc': 0.19470404984423675, 'loss_val': 2.5762859807955576, 'psi': 0.19470404984423675}
[S3] START round=14 head_norm_before_train=1.795017 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.2912082997942939, 'auprc': 0.2912082997942939, 'loss_val': 3.417433914835107, 'psi': 0.2912082997942939}-{'f1_val': 0.289653945378525, 'auprc': 0.289653945378525, 'loss_val': 3.265778525677116, 'psi': 0.289653945378525}
[S4] START round=14 head_norm_before_train=1.532394 (no previous merge yet)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3312745550269345, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3252583627467602, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.350745 cos_to_last_merge=0.9559 (last merge round=9)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3043974920707493, 'psi': 0.3335071121394324}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.260525054456519, 'psi': 0.33358943696313936}
[S6] START round=14 head_norm_before_train=1.592714 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.026065624041705, 'auprc': 0.026065624041705, 'loss_val': 4.7660394163923305, 'psi': 0.026065624041705003}-{'f1_val': 0.05458422174840085, 'auprc': 0.05458422174840085, 'loss_val': 4.144603255823944, 'psi': 0.054584221748400844}
[S7] START round=14 head_norm_before_train=1.621044 (no previous merge yet)
[S7] round=14 local utility u=0.558005 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1953933028085522, 'psi': 0.35976373724718097}-{'f1_val': 0.2383860153256705, 'auprc': 0.2383860153256705, 'loss_val': 1.219002982760404, 'psi': 0.2383860153256705}
[S8] START round=14 head_norm_before_train=1.466952 (no previous merge yet)
[S8] round=14 local utility u=0.814754 metrics={'f1_val': 0.6796387483701067, 'auprc': 0.6796387483701067, 'loss_val': 1.000250399839925, 'psi': 0.6796387483701067}-{'f1_val': 0.506725471616849, 'auprc': 0.506725471616849, 'loss_val': 1.0735397795486528, 'psi': 0.506725471616849}
[S9] START round=14 head_norm_before_train=1.044562 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.170559 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4174451904166934, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7585622551248612, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.544254 (no previous merge yet)
[S10] round=14 local utility u=0.819501 metrics={'f1_val': 0.21637744034707157, 'auprc': 0.21637744034707157, 'loss_val': 3.3784076485459367, 'psi': 0.21637744034707157}-{'f1_val': 0.05010752688172043, 'auprc': 0.05010752688172043, 'loss_val': 3.5209805581693807, 'psi': 0.05010752688172043}
[S11] START round=14 head_norm_before_train=1.515101 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.33193668528864056, 'auprc': 0.33193668528864056, 'loss_val': 2.53476871779381, 'psi': 0.33193668528864056}-{'f1_val': 0.33247763516141576, 'auprc': 0.33247763516141576, 'loss_val': 2.4445019629386064, 'psi': 0.33247763516141576}
[S13] START round=14 head_norm_before_train=1.437404 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9669108193350398, 'psi': 0.3599362944611573}-{'f1_val': 0.6237741508614928, 'auprc': 0.6237741508614928, 'loss_val': 0.9554020975318649, 'psi': 0.6237741508614928}
[S14] START round=14 head_norm_before_train=1.574135 (no previous merge yet)
[S14] round=14 local utility u=0.060611 metrics={'f1_val': 0.056487455197132615, 'auprc': 0.056487455197132615, 'loss_val': 5.427645583327703, 'psi': 0.056487455197132615}-{'f1_val': 0.04716157205240174, 'auprc': 0.04716157205240174, 'loss_val': 5.464934177440869, 'psi': 0.04716157205240174}
[S15] START round=14 head_norm_before_train=1.475703 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.2892226990939437, 'auprc': 0.2892226990939437, 'loss_val': 0.9388210568077121, 'psi': 0.2892226990939437}-{'f1_val': 0.3303590397280646, 'auprc': 0.3303590397280646, 'loss_val': 1.0652997633299228, 'psi': 0.3303590397280646}
[S16] START round=14 head_norm_before_train=1.422751 cos_to_last_merge=0.9867 (last merge round=9)
[S16] round=14 local utility u=0.620293 metrics={'f1_val': 0.09069860279441118, 'auprc': 0.09069860279441118, 'loss_val': 2.731372025794563, 'psi': 0.09069860279441118}-{'f1_val': 0.000371298616912652, 'auprc': 0.000371298616912652, 'loss_val': 3.1590118343791445, 'psi': 0.000371298616912652}
[S17] START round=14 head_norm_before_train=1.494552 (no previous merge yet)
[S17] round=14 local utility u=0.289447 metrics={'f1_val': 0.1564429396534555, 'auprc': 0.1564429396534555, 'loss_val': 1.2641706185086106, 'psi': 0.1564429396534555}-{'f1_val': 0.10211985324092947, 'auprc': 0.10211985324092947, 'loss_val': 1.3541559532004668, 'psi': 0.10211985324092947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.369)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.091)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.056)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:38508
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1808 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=-0.0486
[S5] DROPPED delta from S2 (cos=-0.0486 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.0388
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=-0.0293
[S14] DROPPED delta from S7 (cos=-0.0293 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1808) from S8
[S7] cosine check vs S8: cos=-0.0249
[S7] DROPPED delta from S8 (cos=-0.0249 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.156)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.3335 head_norm=1.403684
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.030038e+00
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.3335 head_norm=1.070519 delta_norm=1.030038
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.550538 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.25782092772384035, 'auprc': 0.25782092772384035, 'loss_val': 2.5713393041758157, 'psi': 0.25782092772384035}-{'f1_val': 0.262, 'auprc': 0.262, 'loss_val': 2.449371440425691, 'psi': 0.262}
[S3] START round=15 head_norm_before_train=1.822161 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.29690646165110746, 'auprc': 0.29690646165110746, 'loss_val': 3.8537992899215654, 'psi': 0.29690646165110746}-{'f1_val': 0.2912082997942939, 'auprc': 0.2912082997942939, 'loss_val': 3.417433914835107, 'psi': 0.2912082997942939}
[S4] START round=15 head_norm_before_train=1.565542 (no previous merge yet)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3433816129119458, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3312745550269345, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.070519 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.213537 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8773234419072955, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3043974920707493, 'psi': 0.3335071121394324}
[S6] START round=15 head_norm_before_train=1.617781 (no previous merge yet)
[S6] round=15 local utility u=0.002041 metrics={'f1_val': 0.032034050179211467, 'auprc': 0.032034050179211467, 'loss_val': 4.815673299026446, 'psi': 0.032034050179211467}-{'f1_val': 0.026065624041705, 'auprc': 0.026065624041705, 'loss_val': 4.7660394163923305, 'psi': 0.026065624041705003}
[S7] START round=15 head_norm_before_train=1.641496 (no previous merge yet)
[S7] round=15 local utility u=0.031467 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1324586065231728, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1953933028085522, 'psi': 0.35976373724718097}
[S8] START round=15 head_norm_before_train=1.490677 (no previous merge yet)
[S8] round=15 local utility u=1.000000 metrics={'f1_val': 0.9994354958690915, 'auprc': 0.9994354958690915, 'loss_val': 0.9028971711386715, 'psi': 0.9994354958690915}-{'f1_val': 0.6796387483701067, 'auprc': 0.6796387483701067, 'loss_val': 1.000250399839925, 'psi': 0.6796387483701067}
[S9] START round=15 head_norm_before_train=1.142588 cos_to_last_merge=0.9893 (last merge round=13)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6501952968316784, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4174451904166934, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.563218 (no previous merge yet)
[S10] round=15 local utility u=0.524149 metrics={'f1_val': 0.3228139381985536, 'auprc': 0.3228139381985536, 'loss_val': 3.2880377386631348, 'psi': 0.3228139381985536}-{'f1_val': 0.21637744034707157, 'auprc': 0.21637744034707157, 'loss_val': 3.3784076485459367, 'psi': 0.21637744034707157}
[S11] START round=15 head_norm_before_train=1.542878 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.32416458285974087, 'auprc': 0.32416458285974087, 'loss_val': 2.5103599044768985, 'psi': 0.32416458285974087}-{'f1_val': 0.33193668528864056, 'auprc': 0.33193668528864056, 'loss_val': 2.53476871779381, 'psi': 0.33193668528864056}
[S13] START round=15 head_norm_before_train=1.461548 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0210645481353147, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9669108193350398, 'psi': 0.3599362944611573}
[S14] START round=15 head_norm_before_train=1.599450 (no previous merge yet)
[S14] round=15 local utility u=0.291333 metrics={'f1_val': 0.10659297275957363, 'auprc': 0.10659297275957363, 'loss_val': 5.295929311883338, 'psi': 0.10659297275957363}-{'f1_val': 0.056487455197132615, 'auprc': 0.056487455197132615, 'loss_val': 5.427645583327703, 'psi': 0.056487455197132615}
[S15] START round=15 head_norm_before_train=1.506969 (no previous merge yet)
[S15] round=15 local utility u=0.017719 metrics={'f1_val': 0.28290909090909094, 'auprc': 0.28290909090909094, 'loss_val': 0.846561532108071, 'psi': 0.28290909090909094}-{'f1_val': 0.2892226990939437, 'auprc': 0.2892226990939437, 'loss_val': 0.9388210568077121, 'psi': 0.2892226990939437}
[S16] START round=15 head_norm_before_train=1.451306 cos_to_last_merge=0.9828 (last merge round=9)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.006067291781577496, 'auprc': 0.006067291781577496, 'loss_val': 3.5138374712679226, 'psi': 0.006067291781577496}-{'f1_val': 0.09069860279441118, 'auprc': 0.09069860279441118, 'loss_val': 2.731372025794563, 'psi': 0.09069860279441118}
[S17] START round=15 head_norm_before_train=1.513409 (no previous merge yet)
[S17] round=15 local utility u=0.015487 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.196330478001454, 'psi': 0.15234678044996122}-{'f1_val': 0.1564429396534555, 'auprc': 0.1564429396534555, 'loss_val': 1.2641706185086106, 'psi': 0.1564429396534555}
[S6] not sending this round → trigger blocked (psi=0.032)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.360)
[S10] not sending this round → trigger blocked (psi=0.323)
[S8] not sending this round → trigger blocked (psi=0.999)
[S14] not sending this round → trigger blocked (psi=0.107)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38516
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=-0.0281
[S5] DROPPED delta from S15 (cos=-0.0281 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.5026
[S17] not sending this round → trigger blocked (psi=0.152)
[S9] ⇄ pheromone p=0.197 → S14@127.0.0.1:38514
[S10] ⇄ pheromone p=0.315 → S5@127.0.0.1:38505
[S6] ⇄ pheromone p=0.058 → S4@127.0.0.1:38504
[S14] ⇄ pheromone p=0.147 → S5@127.0.0.1:38505
[S2] ⇄ pheromone p=0.234 → S5@127.0.0.1:38505
[S7] ⇄ pheromone p=0.251 → S14@127.0.0.1:38514
[S4] ⇄ pheromone p=0.043 → S11@127.0.0.1:38512
[S8] ⇄ pheromone p=0.547 → S7@127.0.0.1:38508
[S3] ⇄ pheromone p=0.104 → S5@127.0.0.1:38505
[S11] ⇄ pheromone p=0.187 → S9@127.0.0.1:38510
[S13] ⇄ pheromone p=0.285 → S9@127.0.0.1:38510
[S5] ⇄ pheromone p=0.175 → S16@127.0.0.1:38516
[S15] ⇄ pheromone p=0.157 → S5@127.0.0.1:38505
[S17] ⇄ pheromone p=0.157 → S9@127.0.0.1:38510
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.0061 head_norm=1.480372
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.705162e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.0210 head_norm=1.140765 delta_norm=0.670516
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.195 → S6@127.0.0.1:38507
[S2] START round=16 head_norm_before_train=1.582512 (no previous merge yet)
[S2] round=16 local utility u=0.090355 metrics={'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 2.2767199650466305, 'psi': 0.24516443956312162}-{'f1_val': 0.25782092772384035, 'auprc': 0.25782092772384035, 'loss_val': 2.5713393041758157, 'psi': 0.25782092772384035}
[S3] START round=16 head_norm_before_train=1.846315 (no previous merge yet)
[S3] round=16 local utility u=0.199294 metrics={'f1_val': 0.28259172521467607, 'auprc': 0.28259172521467607, 'loss_val': 3.3263782502865693, 'psi': 0.28259172521467607}-{'f1_val': 0.29690646165110746, 'auprc': 0.29690646165110746, 'loss_val': 3.8537992899215654, 'psi': 0.29690646165110746}
[S4] START round=16 head_norm_before_train=1.599269 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3560062974958063, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3433816129119458, 'psi': 0.0}
[S5] START round=16 head_norm_before_train=1.144715 cos_to_last_merge=0.9937 (last merge round=14)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1836290109035907, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8773234419072955, 'psi': 0.3335071121394324}
[S6] START round=16 head_norm_before_train=1.639966 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.03077268643306379, 'auprc': 0.03077268643306379, 'loss_val': 5.100652172461585, 'psi': 0.030772686433063794}-{'f1_val': 0.032034050179211467, 'auprc': 0.032034050179211467, 'loss_val': 4.815673299026446, 'psi': 0.032034050179211467}
[S7] START round=16 head_norm_before_train=1.664929 (no previous merge yet)
[S7] round=16 local utility u=0.038867 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.05472457172348, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1324586065231728, 'psi': 0.35976373724718097}
[S8] START round=16 head_norm_before_train=1.523792 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.8971678737644493, 'auprc': 0.8971678737644493, 'loss_val': 0.8178862621594599, 'psi': 0.8971678737644493}-{'f1_val': 0.9994354958690915, 'auprc': 0.9994354958690915, 'loss_val': 0.9028971711386715, 'psi': 0.9994354958690915}
[S9] START round=16 head_norm_before_train=1.248381 cos_to_last_merge=0.9680 (last merge round=13)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8422931951423007, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6501952968316784, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.583072 (no previous merge yet)
[S10] round=16 local utility u=0.100266 metrics={'f1_val': 0.3325347388596071, 'auprc': 0.3325347388596071, 'loss_val': 3.174992150125099, 'psi': 0.3325347388596071}-{'f1_val': 0.3228139381985536, 'auprc': 0.3228139381985536, 'loss_val': 3.2880377386631348, 'psi': 0.3228139381985536}
[S11] START round=16 head_norm_before_train=1.566813 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.3258683729433272, 'auprc': 0.3258683729433272, 'loss_val': 2.7017730691529414, 'psi': 0.3258683729433272}-{'f1_val': 0.32416458285974087, 'auprc': 0.32416458285974087, 'loss_val': 2.5103599044768985, 'psi': 0.32416458285974087}
[S13] START round=16 head_norm_before_train=1.479922 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0336544654079334, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0210645481353147, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.627221 (no previous merge yet)
[S14] round=16 local utility u=0.193512 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.171125822154904, 'psi': 0.13572854291417166}-{'f1_val': 0.10659297275957363, 'auprc': 0.10659297275957363, 'loss_val': 5.295929311883338, 'psi': 0.10659297275957363}
[S15] START round=16 head_norm_before_train=1.533152 (no previous merge yet)
[S15] round=16 local utility u=0.038407 metrics={'f1_val': 0.2833272793316382, 'auprc': 0.2833272793316382, 'loss_val': 0.7735109518094719, 'psi': 0.2833272793316382}-{'f1_val': 0.28290909090909094, 'auprc': 0.28290909090909094, 'loss_val': 0.846561532108071, 'psi': 0.28290909090909094}
[S16] START round=16 head_norm_before_train=1.140765 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.09042255771227735, 'auprc': 0.09042255771227735, 'loss_val': 2.2691901904157743, 'psi': 0.09042255771227735}-{'f1_val': 0.006067291781577496, 'auprc': 0.006067291781577496, 'loss_val': 3.5138374712679226, 'psi': 0.006067291781577496}
[S17] START round=16 head_norm_before_train=1.533303 (no previous merge yet)
[S17] round=16 local utility u=0.026398 metrics={'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 1.1424721382514404, 'psi': 0.15222868217054264}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.196330478001454, 'psi': 0.15234678044996122}
[S14] not sending this round → trigger blocked (psi=0.136)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:38505
[S15] not sending this round → trigger blocked (psi=0.283)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:38514
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S3
[S5] cosine check vs S3: cos=0.3927
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=0.0104
[S5] RECEIVED delta(kind=head bytes=1795) from S10
[S5] cosine check vs S10: cos=0.6593
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=-0.0168
[S14] DROPPED delta from S7 (cos=-0.0168 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.152)
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.3335 head_norm=1.237704
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.965245e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.3335 head_norm=0.998805 delta_norm=0.496525
[S5] aggregate: ACCEPT kept=['S3', 'S2', 'S10'] (k=3/3) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.612401 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.24246239944036377, 'auprc': 0.24246239944036377, 'loss_val': 2.7881342214080775, 'psi': 0.24246239944036377}-{'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 2.2767199650466305, 'psi': 0.24516443956312162}
[S3] START round=17 head_norm_before_train=1.867010 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.29579129170075447, 'auprc': 0.29579129170075447, 'loss_val': 3.851166456579836, 'psi': 0.29579129170075447}-{'f1_val': 0.28259172521467607, 'auprc': 0.28259172521467607, 'loss_val': 3.3263782502865693, 'psi': 0.28259172521467607}
[S4] START round=17 head_norm_before_train=1.632106 (no previous merge yet)
[S4] round=17 local utility u=1.000000 metrics={'f1_val': 0.23492063492063495, 'auprc': 0.23492063492063495, 'loss_val': 1.359656925829036, 'psi': 0.23492063492063495}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3560062974958063, 'psi': 0.0}
[S5] START round=17 head_norm_before_train=0.998805 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.185097 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8134349348959997, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1836290109035907, 'psi': 0.3335071121394324}
[S6] START round=17 head_norm_before_train=1.661198 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.009163533834586466, 'auprc': 0.009163533834586466, 'loss_val': 5.567946357389688, 'psi': 0.009163533834586466}-{'f1_val': 0.03077268643306379, 'auprc': 0.03077268643306379, 'loss_val': 5.100652172461585, 'psi': 0.030772686433063794}
[S7] START round=17 head_norm_before_train=1.694265 (no previous merge yet)
[S7] round=17 local utility u=0.009789 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0351475658329303, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.05472457172348, 'psi': 0.35976373724718097}
[S8] START round=17 head_norm_before_train=1.569181 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7348157086300149, 'psi': 0.35939447907390915}-{'f1_val': 0.8971678737644493, 'auprc': 0.8971678737644493, 'loss_val': 0.8178862621594599, 'psi': 0.8971678737644493}
[S9] START round=17 head_norm_before_train=1.327173 cos_to_last_merge=0.9515 (last merge round=13)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9811782169687104, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8422931951423007, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.602475 (no previous merge yet)
[S10] round=17 local utility u=0.049522 metrics={'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 3.078827301022699, 'psi': 0.3328546353917345}-{'f1_val': 0.3325347388596071, 'auprc': 0.3325347388596071, 'loss_val': 3.174992150125099, 'psi': 0.3325347388596071}
[S11] START round=17 head_norm_before_train=1.591003 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.0206200920086967, 'psi': 0.3320133550741517}-{'f1_val': 0.3258683729433272, 'auprc': 0.3258683729433272, 'loss_val': 2.7017730691529414, 'psi': 0.3258683729433272}
[S13] START round=17 head_norm_before_train=1.496305 (no previous merge yet)
[S13] round=17 local utility u=0.006215 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.021223466352274, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0336544654079334, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=1.655532 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.174447432744027, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.171125822154904, 'psi': 0.13572854291417166}
[S15] START round=17 head_norm_before_train=1.556299 (no previous merge yet)
[S15] round=17 local utility u=1.000000 metrics={'f1_val': 0.5705218753984566, 'auprc': 0.5705218753984566, 'loss_val': 0.7123625392745813, 'psi': 0.5705218753984566}-{'f1_val': 0.2833272793316382, 'auprc': 0.2833272793316382, 'loss_val': 0.7735109518094719, 'psi': 0.2833272793316382}
[S16] START round=17 head_norm_before_train=1.176686 cos_to_last_merge=0.9990 (last merge round=15)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.06514657980456026, 'auprc': 0.06514657980456026, 'loss_val': 2.7131659488419353, 'psi': 0.06514657980456026}-{'f1_val': 0.09042255771227735, 'auprc': 0.09042255771227735, 'loss_val': 2.2691901904157743, 'psi': 0.09042255771227735}
[S17] START round=17 head_norm_before_train=1.555097 (no previous merge yet)
[S17] round=17 local utility u=0.025244 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0925153883081782, 'psi': 0.152287708414114}-{'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 1.1424721382514404, 'psi': 0.15222868217054264}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:38512
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:38514
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38516
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.6996
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=-0.0239
[S5] DROPPED delta from S15 (cos=-0.0239 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S7
[S14] cosine check vs S7: cos=-0.0109
[S14] DROPPED delta from S7 (cos=-0.0109 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.1176
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] cosine check vs S13: cos=0.5002
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.6775
[S17] not sending this round → trigger blocked (psi=0.152)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.3687 head_norm=1.381417
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.266207e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.3687 head_norm=1.255259 delta_norm=0.726621
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.3320 head_norm=1.610574
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.086458e+00
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.3324 head_norm=1.222657 delta_norm=1.086458
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.0651 head_norm=1.224712
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.523121e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.0748 head_norm=1.065412 delta_norm=0.452312
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.3335 head_norm=1.086029
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.979206e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.3335 head_norm=1.246412 delta_norm=0.597921
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.638822 (no previous merge yet)
[S2] round=18 local utility u=0.216571 metrics={'f1_val': 0.24665438919582564, 'auprc': 0.24665438919582564, 'loss_val': 2.392720334079002, 'psi': 0.2466543891958256}-{'f1_val': 0.24246239944036377, 'auprc': 0.24246239944036377, 'loss_val': 2.7881342214080775, 'psi': 0.24246239944036377}
[S3] START round=18 head_norm_before_train=1.883888 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.29546899119222736, 'auprc': 0.29546899119222736, 'loss_val': 3.885114344877307, 'psi': 0.29546899119222736}-{'f1_val': 0.29579129170075447, 'auprc': 0.29579129170075447, 'loss_val': 3.851166456579836, 'psi': 0.29579129170075447}
[S4] START round=18 head_norm_before_train=1.660305 (no previous merge yet)
[S4] round=18 local utility u=0.438096 metrics={'f1_val': 0.3323160393353679, 'auprc': 0.3323160393353679, 'loss_val': 1.3600226693954125, 'psi': 0.3323160393353679}-{'f1_val': 0.23492063492063495, 'auprc': 0.23492063492063495, 'loss_val': 1.359656925829036, 'psi': 0.23492063492063495}
[S5] START round=18 head_norm_before_train=1.246412 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.8248459140234916, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8134349348959997, 'psi': 0.3335071121394324}
[S6] START round=18 head_norm_before_train=1.679757 (no previous merge yet)
[S6] round=18 local utility u=0.028467 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.58450157061959, 'psi': 0.01732902033271719}-{'f1_val': 0.009163533834586466, 'auprc': 0.009163533834586466, 'loss_val': 5.567946357389688, 'psi': 0.009163533834586466}
[S7] START round=18 head_norm_before_train=1.716529 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.064286794369583, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0351475658329303, 'psi': 0.35976373724718097}
[S8] START round=18 head_norm_before_train=1.617615 (no previous merge yet)
[S8] round=18 local utility u=0.024793 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6852290867822471, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7348157086300149, 'psi': 0.35939447907390915}
[S9] START round=18 head_norm_before_train=1.255259 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.082490 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8161977496680286, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9811782169687104, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.625621 (no previous merge yet)
[S10] round=18 local utility u=0.037310 metrics={'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 3.004206354718886, 'psi': 0.3328546353917345}-{'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 3.078827301022699, 'psi': 0.3328546353917345}
[S11] START round=18 head_norm_before_train=1.222657 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.468870 metrics={'f1_val': 0.32416458285974087, 'auprc': 0.32416458285974087, 'loss_val': 2.01224195997208, 'psi': 0.32416458285974087}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.0206200920086967, 'psi': 0.3320133550741517}
[S13] START round=18 head_norm_before_train=1.516244 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.063834134143473, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.021223466352274, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.682884 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.2514217211982706, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.174447432744027, 'psi': 0.13592717296421}
[S15] START round=18 head_norm_before_train=1.579017 (no previous merge yet)
[S15] round=18 local utility u=0.176448 metrics={'f1_val': 0.6135507681776878, 'auprc': 0.6135507681776878, 'loss_val': 0.7467264006476836, 'psi': 0.6135507681776878}-{'f1_val': 0.5705218753984566, 'auprc': 0.5705218753984566, 'loss_val': 0.7123625392745813, 'psi': 0.5705218753984566}
[S16] START round=18 head_norm_before_train=1.065412 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.053812 metrics={'f1_val': 0.03771861132863482, 'auprc': 0.03771861132863482, 'loss_val': 2.3586908624563736, 'psi': 0.03771861132863482}-{'f1_val': 0.06514657980456026, 'auprc': 0.06514657980456026, 'loss_val': 2.7131659488419353, 'psi': 0.06514657980456026}
[S17] START round=18 head_norm_before_train=1.579598 (no previous merge yet)
[S17] round=18 local utility u=0.030420 metrics={'f1_val': 0.15216970166602092, 'auprc': 0.15216970166602092, 'loss_val': 1.0306126531881612, 'psi': 0.15216970166602092}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0925153883081782, 'psi': 0.152287708414114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38514
[S6] not sending this round → trigger blocked (psi=0.017)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:38512
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S9
[S14] cosine check vs S9: cos=-0.1318
[S14] DROPPED delta from S9 (cos=-0.1318 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] cosine check vs S8: cos=-0.0321
[S7] DROPPED delta from S8 (cos=-0.0321 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S2
[S5] cosine check vs S2: cos=0.1449
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.7435
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:38510
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=0.2020
[S5] RECEIVED delta(kind=head bytes=1794) from S10
[S5] cosine check vs S10: cos=0.9106
[S16] not sending this round → trigger blocked (psi=0.038)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:38505
[S15] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S15
[S5] cosine check vs S15: cos=-0.0115
[S5] DROPPED delta from S15 (cos=-0.0115 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.152)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.3330 head_norm=1.318683
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.708162e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.3330 head_norm=1.171705 delta_norm=0.470816
[S5] aggregate: ACCEPT kept=['S2', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.3687 head_norm=1.317600
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.109157e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.3687 head_norm=0.994986 delta_norm=0.810916
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.3242 head_norm=1.248636
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.641455e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.0488 head_norm=1.372880 delta_norm=0.564146
[S11] aggregate: ROLLBACK (f1_val pre=0.324 post=0.049 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.663821 (no previous merge yet)
[S2] round=19 local utility u=0.010582 metrics={'f1_val': 0.25946015756166857, 'auprc': 0.25946015756166857, 'loss_val': 2.4868076896710054, 'psi': 0.25946015756166857}-{'f1_val': 0.24665438919582564, 'auprc': 0.24665438919582564, 'loss_val': 2.392720334079002, 'psi': 0.2466543891958256}
[S3] START round=19 head_norm_before_train=1.899847 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.29696637426900585, 'auprc': 0.29696637426900585, 'loss_val': 4.078186830241734, 'psi': 0.29696637426900585}-{'f1_val': 0.29546899119222736, 'auprc': 0.29546899119222736, 'loss_val': 3.885114344877307, 'psi': 0.29546899119222736}
[S4] START round=19 head_norm_before_train=1.687312 (no previous merge yet)
[S4] round=19 local utility u=0.003472 metrics={'f1_val': 0.3330795906284361, 'auprc': 0.3330795906284361, 'loss_val': 1.3599503907756503, 'psi': 0.3330795906284361}-{'f1_val': 0.3323160393353679, 'auprc': 0.3323160393353679, 'loss_val': 1.3600226693954125, 'psi': 0.3323160393353679}
[S5] START round=19 head_norm_before_train=1.171705 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.051444 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.7219571310798103, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.8248459140234916, 'psi': 0.33300395256917}
[S6] START round=19 head_norm_before_train=1.693438 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.011230697239120261, 'auprc': 0.011230697239120261, 'loss_val': 5.818267964680534, 'psi': 0.011230697239120261}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.58450157061959, 'psi': 0.01732902033271719}
[S7] START round=19 head_norm_before_train=1.733590 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.071195820412438, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.064286794369583, 'psi': 0.35976373724718097}
[S8] START round=19 head_norm_before_train=1.660774 (no previous merge yet)
[S8] round=19 local utility u=0.020140 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6449498172819844, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6852290867822471, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=0.994986 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.189064 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4380706820260045, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8161977496680286, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.652669 (no previous merge yet)
[S10] round=19 local utility u=0.044493 metrics={'f1_val': 0.33293451383903644, 'auprc': 0.33293451383903644, 'loss_val': 2.9159386347964187, 'psi': 0.33293451383903644}-{'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 3.004206354718886, 'psi': 0.3328546353917345}
[S11] START round=19 head_norm_before_train=1.372880 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.053900 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.975080279374689, 'psi': 0.3320133550741517}-{'f1_val': 0.32416458285974087, 'auprc': 0.32416458285974087, 'loss_val': 2.01224195997208, 'psi': 0.32416458285974087}
[S13] START round=19 head_norm_before_train=1.534685 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1306807400704144, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.063834134143473, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.708050 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.328428752211603, 'psi': 0.13587634006482174}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.2514217211982706, 'psi': 0.13572854291417166}
[S15] START round=19 head_norm_before_train=1.598229 (no previous merge yet)
[S15] round=19 local utility u=0.101872 metrics={'f1_val': 0.6206296706755453, 'auprc': 0.6206296706755453, 'loss_val': 0.6066932551793758, 'psi': 0.6206296706755453}-{'f1_val': 0.6135507681776878, 'auprc': 0.6135507681776878, 'loss_val': 0.7467264006476836, 'psi': 0.6135507681776878}
[S16] START round=19 head_norm_before_train=1.113767 cos_to_last_merge=0.9970 (last merge round=17)
[S16] round=19 local utility u=0.105725 metrics={'f1_val': 0.0800339366515837, 'auprc': 0.0800339366515837, 'loss_val': 2.528079135810424, 'psi': 0.0800339366515837}-{'f1_val': 0.03771861132863482, 'auprc': 0.03771861132863482, 'loss_val': 2.3586908624563736, 'psi': 0.03771861132863482}
[S17] START round=19 head_norm_before_train=1.604981 (no previous merge yet)
[S17] round=19 local utility u=0.017738 metrics={'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.9956665749254264, 'psi': 0.15222868217054264}-{'f1_val': 0.15216970166602092, 'auprc': 0.15216970166602092, 'loss_val': 1.0306126531881612, 'psi': 0.15216970166602092}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38516
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.6888
[S11] RECEIVED delta(kind=head bytes=1805) from S4
[S11] cosine check vs S4: cos=0.9403
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=0.4389
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38514
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S15] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S15
[S5] cosine check vs S15: cos=-0.0221
[S5] DROPPED delta from S15 (cos=-0.0221 < 0.0)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=0.5752
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.8637
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=-0.1202
[S14] DROPPED delta from S9 (cos=-0.1202 < 0.0)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.080)
[S17] not sending this round → trigger blocked (psi=0.152)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:38508
[S2] r=20 psi=0.259 u=0.0106 p_local=0.1419 f1=0.259 auprc=0.259 bytes=7197
[S8] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S8
[S7] cosine check vs S8: cos=-0.0343
[S7] DROPPED delta from S8 (cos=-0.0343 < 0.0)
[S3] r=20 psi=0.297 u=0.0000 p_local=0.0632 f1=0.297 auprc=0.297 bytes=3592
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.3330 head_norm=1.220666
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.783074e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.3330 head_norm=1.189449 delta_norm=0.278307
[S5] aggregate: ACCEPT kept=['S2', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] r=20 psi=0.333 u=0.0514 p_local=0.1055 f1=0.333 auprc=0.333 bytes=10788
[S4] r=20 psi=0.333 u=0.0035 p_local=0.2163 f1=0.333 auprc=0.333 bytes=5410
[S7] r=20 psi=0.360 u=0.0000 p_local=0.1079 f1=0.360 auprc=0.360 bytes=9015
[S10] r=20 psi=0.333 u=0.0445 p_local=0.1606 f1=0.333 auprc=0.333 bytes=8993
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.3320 head_norm=1.396427
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.104796e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.0000 head_norm=1.531554 delta_norm=0.310480
[S11] aggregate: ROLLBACK (f1_val pre=0.332 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S11] r=20 psi=0.332 u=0.0539 p_local=0.1622 f1=0.332 auprc=0.332 bytes=5394
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.3687 head_norm=1.090281
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.888899e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.3687 head_norm=1.105699 delta_norm=0.588890
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.369 u=0.1891 p_local=0.1318 f1=0.369 auprc=0.369 bytes=8991
[S13] r=20 psi=0.360 u=0.0000 p_local=0.1175 f1=0.360 auprc=0.360 bytes=5411
[S6] r=20 psi=0.011 u=0.0000 p_local=0.0282 f1=0.011 auprc=0.011 bytes=0
[S8] r=20 psi=0.359 u=0.0201 p_local=0.2323 f1=0.359 auprc=0.359 bytes=10821
[S14] r=20 psi=0.136 u=0.0000 p_local=0.0801 f1=0.136 auprc=0.136 bytes=0
[S15] r=20 psi=0.621 u=0.1019 p_local=0.2449 f1=0.621 auprc=0.621 bytes=10813
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.0800 head_norm=1.171478
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.723255e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.0725 head_norm=1.099137 delta_norm=0.472325
[S16] aggregate: ROLLBACK (f1_val pre=0.080 post=0.073 tol_abs=0.005 tol_rel=0.0)
[S16] r=20 psi=0.080 u=0.1057 p_local=0.2120 f1=0.080 auprc=0.080 bytes=0
[S17] r=20 psi=0.152 u=0.0177 p_local=0.0785 f1=0.152 auprc=0.152 bytes=0
[S2] START round=20 head_norm_before_train=1.685145 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.26118355065195586, 'auprc': 0.26118355065195586, 'loss_val': 2.9000801992181446, 'psi': 0.26118355065195586}-{'f1_val': 0.25946015756166857, 'auprc': 0.25946015756166857, 'loss_val': 2.4868076896710054, 'psi': 0.25946015756166857}
[S3] START round=20 head_norm_before_train=1.915549 (no previous merge yet)
[S3] round=20 local utility u=0.031586 metrics={'f1_val': 0.29587197672304055, 'auprc': 0.29587197672304055, 'loss_val': 4.005165252725945, 'psi': 0.29587197672304055}-{'f1_val': 0.29696637426900585, 'auprc': 0.29696637426900585, 'loss_val': 4.078186830241734, 'psi': 0.29696637426900585}
[S4] START round=20 head_norm_before_train=1.712922 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.2401656314699793, 'auprc': 0.2401656314699793, 'loss_val': 1.3473327606606949, 'psi': 0.2401656314699793}-{'f1_val': 0.3330795906284361, 'auprc': 0.3330795906284361, 'loss_val': 1.3599503907756503, 'psi': 0.3330795906284361}
[S5] START round=20 head_norm_before_train=1.189449 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.011683 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7031205437808725, 'psi': 0.3335071121394324}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.7219571310798103, 'psi': 0.33300395256917}
[S6] START round=20 head_norm_before_train=1.706328 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 5.906695472075472, 'psi': 0.017105871474803514}-{'f1_val': 0.011230697239120261, 'auprc': 0.011230697239120261, 'loss_val': 5.818267964680534, 'psi': 0.011230697239120261}
[S7] START round=20 head_norm_before_train=1.748290 (no previous merge yet)
[S7] round=20 local utility u=0.016085 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0390257167931207, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.071195820412438, 'psi': 0.35976373724718097}
[S8] START round=20 head_norm_before_train=1.703551 (no previous merge yet)
[S8] round=20 local utility u=0.013973 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6170030658802795, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6449498172819844, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.105699 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.043476 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3511185524237554, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4380706820260045, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.680544 (no previous merge yet)
[S10] round=20 local utility u=0.031307 metrics={'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 2.8526080450332865, 'psi': 0.3328548644338118}-{'f1_val': 0.33293451383903644, 'auprc': 0.33293451383903644, 'loss_val': 2.9159386347964187, 'psi': 0.33293451383903644}
[S11] START round=20 head_norm_before_train=1.531554 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.123856 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 1.725280859276739, 'psi': 0.33178150217256364}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.975080279374689, 'psi': 0.3320133550741517}
[S13] START round=20 head_norm_before_train=1.547813 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1662490103902172, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1306807400704144, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.730470 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.397013323626497, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.328428752211603, 'psi': 0.13587634006482174}
[S15] START round=20 head_norm_before_train=1.621661 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6166365676873765, 'auprc': 0.6166365676873765, 'loss_val': 0.630505376635466, 'psi': 0.6166365676873765}-{'f1_val': 0.6206296706755453, 'auprc': 0.6206296706755453, 'loss_val': 0.6066932551793758, 'psi': 0.6206296706755453}
[S16] START round=20 head_norm_before_train=1.099137 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.229360 metrics={'f1_val': 0.09018949388342529, 'auprc': 0.09018949388342529, 'loss_val': 2.1607600044941133, 'psi': 0.09018949388342529}-{'f1_val': 0.0800339366515837, 'auprc': 0.0800339366515837, 'loss_val': 2.528079135810424, 'psi': 0.0800339366515837}
[S17] START round=20 head_norm_before_train=1.630081 (no previous merge yet)
[S17] round=20 local utility u=0.250203 metrics={'f1_val': 0.20281435579654014, 'auprc': 0.20281435579654014, 'loss_val': 0.9505307996671968, 'psi': 0.20281435579654014}-{'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.9956665749254264, 'psi': 0.15222868217054264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38516
[S16] not sending this round → trigger blocked (psi=0.090)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38508
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:38514
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] cosine check vs S8: cos=-0.0356
[S7] DROPPED delta from S8 (cos=-0.0356 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] cosine check vs S11: cos=0.8068
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=0.8053
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] cosine check vs S3: cos=0.0681
[S14] RECEIVED delta(kind=head bytes=1803) from S9
[S14] cosine check vs S9: cos=-0.1069
[S14] DROPPED delta from S9 (cos=-0.1069 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.8559
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=0.0013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.0043
[S2] ⇄ pheromone p=0.113 → S5@127.0.0.1:38505
[S15] ⇄ pheromone p=0.196 → S5@127.0.0.1:38505
[S6] ⇄ pheromone p=0.023 → S4@127.0.0.1:38504
[S4] ⇄ pheromone p=0.173 → S11@127.0.0.1:38512
[S13] ⇄ pheromone p=0.094 → S9@127.0.0.1:38510
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.1358 head_norm=1.750746
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.240662e+00
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.1358 head_norm=1.242214 delta_norm=1.240662
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.064 → S5@127.0.0.1:38505
[S10] ⇄ pheromone p=0.135 → S5@127.0.0.1:38505
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.3335 head_norm=1.235533
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.787629e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.3335 head_norm=1.125316 delta_norm=0.578763
[S5] aggregate: ACCEPT kept=['S10', 'S3'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.087 → S16@127.0.0.1:38516
[S7] ⇄ pheromone p=0.090 → S14@127.0.0.1:38514
[S11] ⇄ pheromone p=0.155 → S9@127.0.0.1:38510
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.3687 head_norm=1.186486
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.397108e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.3687 head_norm=1.020516 delta_norm=0.539711
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.114 → S14@127.0.0.1:38514
[S8] ⇄ pheromone p=0.189 → S7@127.0.0.1:38508
[S3] ⇄ pheromone p=0.057 → S5@127.0.0.1:38505
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.0902 head_norm=1.147544
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.226055e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.0904 head_norm=1.147878 delta_norm=0.322605
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.215 → S6@127.0.0.1:38507
[S17] ⇄ pheromone p=0.113 → S9@127.0.0.1:38510
[S2] START round=21 head_norm_before_train=1.703040 (no previous merge yet)
[S2] round=21 local utility u=0.121937 metrics={'f1_val': 0.24602008327210387, 'auprc': 0.24602008327210387, 'loss_val': 2.519734888723825, 'psi': 0.2460200832721039}-{'f1_val': 0.26118355065195586, 'auprc': 0.26118355065195586, 'loss_val': 2.9000801992181446, 'psi': 0.26118355065195586}
[S3] START round=21 head_norm_before_train=1.930625 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.2971689497716895, 'auprc': 0.2971689497716895, 'loss_val': 4.139602917400491, 'psi': 0.2971689497716895}-{'f1_val': 0.29587197672304055, 'auprc': 0.29587197672304055, 'loss_val': 4.005165252725945, 'psi': 0.29587197672304055}
[S4] START round=21 head_norm_before_train=1.738756 (no previous merge yet)
[S4] round=21 local utility u=0.529828 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3373321607387407, 'psi': 0.3567939207526687}-{'f1_val': 0.2401656314699793, 'auprc': 0.2401656314699793, 'loss_val': 1.3473327606606949, 'psi': 0.2401656314699793}
[S5] START round=21 head_norm_before_train=1.125316 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7821959305563266, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7031205437808725, 'psi': 0.3335071121394324}
[S6] START round=21 head_norm_before_train=1.719183 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.005912961210974456, 'auprc': 0.005912961210974456, 'loss_val': 6.066060783757967, 'psi': 0.005912961210974456}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 5.906695472075472, 'psi': 0.017105871474803514}
[S7] START round=21 head_norm_before_train=1.760559 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0393654796756435, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0390257167931207, 'psi': 0.35976373724718097}
[S8] START round=21 head_norm_before_train=1.742312 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6215582752180016, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6170030658802795, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.020516 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3815750834896277, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3511185524237554, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.708925 (no previous merge yet)
[S10] round=21 local utility u=0.026420 metrics={'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 2.799768792037666, 'psi': 0.3328548644338118}-{'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 2.8526080450332865, 'psi': 0.3328548644338118}
[S11] START round=21 head_norm_before_train=1.558624 cos_to_last_merge=0.9980 (last merge round=19)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.30582350839585565, 'auprc': 0.30582350839585565, 'loss_val': 1.5016186707009453, 'psi': 0.30582350839585565}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 1.725280859276739, 'psi': 0.33178150217256364}
[S13] START round=21 head_norm_before_train=1.558135 (no previous merge yet)
[S13] round=21 local utility u=0.001456 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1633363789989786, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1662490103902172, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.242214 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=1.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.20382388534582, 'psi': 0.13592717296421}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.397013323626497, 'psi': 0.13582554517133957}
[S15] START round=21 head_norm_before_train=1.647419 (no previous merge yet)
[S15] round=21 local utility u=0.006058 metrics={'f1_val': 0.6166365676873765, 'auprc': 0.6166365676873765, 'loss_val': 0.6183897199346731, 'psi': 0.6166365676873765}-{'f1_val': 0.6166365676873765, 'auprc': 0.6166365676873765, 'loss_val': 0.630505376635466, 'psi': 0.6166365676873765}
[S16] START round=21 head_norm_before_train=1.147878 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.04318418314255983, 'auprc': 0.04318418314255983, 'loss_val': 2.1667341239403917, 'psi': 0.04318418314255983}-{'f1_val': 0.09018949388342529, 'auprc': 0.09018949388342529, 'loss_val': 2.1607600044941133, 'psi': 0.09018949388342529}
[S17] START round=21 head_norm_before_train=1.656550 (no previous merge yet)
[S17] round=21 local utility u=0.471631 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.9162270868351142, 'psi': 0.30380970798684975}-{'f1_val': 0.20281435579654014, 'auprc': 0.20281435579654014, 'loss_val': 0.9505307996671968, 'psi': 0.20281435579654014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:38512
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:38510
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=-0.0190
[S5] DROPPED delta from S15 (cos=-0.0190 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9633
[S9] RECEIVED delta(kind=head bytes=1804) from S13
[S9] cosine check vs S13: cos=0.2025
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.8069
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=0.3002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S17
[S9] cosine check vs S17: cos=0.3667
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.3687 head_norm=1.107009
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.313264e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.3687 head_norm=0.956841 delta_norm=0.631326
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.3335 head_norm=1.184605
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.213053e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.3335 head_norm=1.145038 delta_norm=0.421305
[S5] aggregate: ACCEPT kept=['S10', 'S2'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.3058 head_norm=1.600251
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.408519e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.3238 head_norm=1.664129 delta_norm=0.240852
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.719386 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.560334592169995, 'psi': 0.245119570522206}-{'f1_val': 0.24602008327210387, 'auprc': 0.24602008327210387, 'loss_val': 2.519734888723825, 'psi': 0.2460200832721039}
[S3] START round=22 head_norm_before_train=1.944748 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.2942859780300932, 'auprc': 0.2942859780300932, 'loss_val': 4.364516891395875, 'psi': 0.2942859780300932}-{'f1_val': 0.2971689497716895, 'auprc': 0.2971689497716895, 'loss_val': 4.139602917400491, 'psi': 0.2971689497716895}
[S4] START round=22 head_norm_before_train=1.758938 (no previous merge yet)
[S4] round=22 local utility u=0.008131 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.32107103273566, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3373321607387407, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.145038 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.062495 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6572059953443532, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7821959305563266, 'psi': 0.3335071121394324}
[S6] START round=22 head_norm_before_train=1.730006 (no previous merge yet)
[S6] round=22 local utility u=0.022141 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.124523871730461, 'psi': 0.01732902033271719}-{'f1_val': 0.005912961210974456, 'auprc': 0.005912961210974456, 'loss_val': 6.066060783757967, 'psi': 0.005912961210974456}
[S7] START round=22 head_norm_before_train=1.773745 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.967350908644256, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0393654796756435, 'psi': 0.35976373724718097}
[S8] START round=22 head_norm_before_train=1.772551 (no previous merge yet)
[S8] round=22 local utility u=0.003977 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6136033154208957, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6215582752180016, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=0.956841 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5386369972560732, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3815750834896277, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.732215 (no previous merge yet)
[S10] round=22 local utility u=0.036229 metrics={'f1_val': 0.33293489521077374, 'auprc': 0.33293489521077374, 'loss_val': 2.728032061296985, 'psi': 0.33293489521077374}-{'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 2.799768792037666, 'psi': 0.3328548644338118}
[S11] START round=22 head_norm_before_train=1.664129 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.087253 metrics={'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 1.4888707355910489, 'psi': 0.3237965485921889}-{'f1_val': 0.30582350839585565, 'auprc': 0.30582350839585565, 'loss_val': 1.5016186707009453, 'psi': 0.30582350839585565}
[S13] START round=22 head_norm_before_train=1.567319 (no previous merge yet)
[S13] round=22 local utility u=0.012689 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.137958362430812, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1633363789989786, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.281975 cos_to_last_merge=0.9992 (last merge round=20)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.6676608440889598, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.20382388534582, 'psi': 0.13592717296421}
[S15] START round=22 head_norm_before_train=1.676731 (no previous merge yet)
[S15] round=22 local utility u=0.022242 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.5731724026441226, 'psi': 0.6165550083006743}-{'f1_val': 0.6166365676873765, 'auprc': 0.6166365676873765, 'loss_val': 0.6183897199346731, 'psi': 0.6166365676873765}
[S16] START round=22 head_norm_before_train=1.192369 cos_to_last_merge=0.9954 (last merge round=20)
[S16] round=22 local utility u=0.245774 metrics={'f1_val': 0.09801516503122212, 'auprc': 0.09801516503122212, 'loss_val': 2.1686643766937643, 'psi': 0.09801516503122212}-{'f1_val': 0.04318418314255983, 'auprc': 0.04318418314255983, 'loss_val': 2.1667341239403917, 'psi': 0.04318418314255983}
[S17] START round=22 head_norm_before_train=1.681666 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.152081316553727, 'auprc': 0.152081316553727, 'loss_val': 0.8902545526043417, 'psi': 0.152081316553727}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.9162270868351142, 'psi': 0.30380970798684975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:38510
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.098)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:38508
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38516
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:38512
[S6] not sending this round → trigger blocked (psi=0.017)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.9082
[S7] RECEIVED delta(kind=head bytes=1806) from S8
[S7] cosine check vs S8: cos=-0.0363
[S7] DROPPED delta from S8 (cos=-0.0363 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] cosine check vs S13: cos=0.5532
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] cosine check vs S11: cos=0.3643
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=-0.0325
[S5] DROPPED delta from S15 (cos=-0.0325 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.8088
[S11] RECEIVED delta(kind=head bytes=1805) from S4
[S11] cosine check vs S4: cos=0.9825
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.3687 head_norm=1.066971
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.417622e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.3687 head_norm=0.995440 delta_norm=0.441762
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.3238 head_norm=1.700926
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.671020e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.3240 head_norm=1.731470 delta_norm=0.167102
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.3335 head_norm=1.181820
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.286245e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.3335 head_norm=1.398097 delta_norm=0.528625
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.0980 head_norm=1.248384
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.623692e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.1356 head_norm=1.186905 delta_norm=0.262369
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.734123 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.600565809940002, 'psi': 0.245119570522206}-{'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.560334592169995, 'psi': 0.245119570522206}
[S3] START round=23 head_norm_before_train=1.957815 (no previous merge yet)
[S3] round=23 local utility u=0.280416 metrics={'f1_val': 0.288422358047657, 'auprc': 0.288422358047657, 'loss_val': 3.7509123896179934, 'psi': 0.288422358047657}-{'f1_val': 0.2942859780300932, 'auprc': 0.2942859780300932, 'loss_val': 4.364516891395875, 'psi': 0.2942859780300932}
[S4] START round=23 head_norm_before_train=1.777265 (no previous merge yet)
[S4] round=23 local utility u=0.004949 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3111726215369692, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.32107103273566, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.398097 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8343626599264442, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6572059953443532, 'psi': 0.3335071121394324}
[S6] START round=23 head_norm_before_train=1.740405 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 6.237404145340454, 'psi': 0.016882516188714152}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.124523871730461, 'psi': 0.01732902033271719}
[S7] START round=23 head_norm_before_train=1.781296 (no previous merge yet)
[S7] round=23 local utility u=0.518591 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0108366726856752, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.967350908644256, 'psi': 0.23968964488212474}
[S8] START round=23 head_norm_before_train=1.800313 (no previous merge yet)
[S8] round=23 local utility u=0.001658 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6102876142237939, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6136033154208957, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=0.995440 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.007844 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5229496105649607, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5386369972560732, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.752581 (no previous merge yet)
[S10] round=23 local utility u=0.022928 metrics={'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.681460888383185, 'psi': 0.332855321861058}-{'f1_val': 0.33293489521077374, 'auprc': 0.33293489521077374, 'loss_val': 2.728032061296985, 'psi': 0.33293489521077374}
[S11] START round=23 head_norm_before_train=1.731470 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.029647 metrics={'f1_val': 0.32372740337342104, 'auprc': 0.32372740337342104, 'loss_val': 1.4289538824768035, 'psi': 0.32372740337342104}-{'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 1.4888707355910489, 'psi': 0.3237965485921889}
[S13] START round=23 head_norm_before_train=1.576126 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.158895810137261, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.137958362430812, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.338921 cos_to_last_merge=0.9961 (last merge round=20)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.061889193206391, 'psi': 0.13587634006482174}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.6676608440889598, 'psi': 0.13572854291417166}
[S15] START round=23 head_norm_before_train=1.708077 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.6159776736727354, 'psi': 0.6165550083006743}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.5731724026441226, 'psi': 0.6165550083006743}
[S16] START round=23 head_norm_before_train=1.186905 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.07970660146699267, 'auprc': 0.07970660146699267, 'loss_val': 2.212126831129877, 'psi': 0.07970660146699267}-{'f1_val': 0.09801516503122212, 'auprc': 0.09801516503122212, 'loss_val': 2.1686643766937643, 'psi': 0.09801516503122212}
[S17] START round=23 head_norm_before_train=1.706781 (no previous merge yet)
[S17] round=23 local utility u=0.023626 metrics={'f1_val': 0.15266206995750295, 'auprc': 0.15266206995750295, 'loss_val': 0.848230070176, 'psi': 0.15266206995750295}-{'f1_val': 0.152081316553727, 'auprc': 0.152081316553727, 'loss_val': 0.8902545526043417, 'psi': 0.152081316553727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38514
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:38512
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1808 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S3
[S5] cosine check vs S3: cos=0.1175
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.9530
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=0.5427
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] cosine check vs S7: cos=0.6503
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9885
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=-0.1360
[S14] DROPPED delta from S9 (cos=-0.1360 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1808) from S8
[S7] cosine check vs S8: cos=-0.0350
[S7] DROPPED delta from S8 (cos=-0.0350 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.3029
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.3335 head_norm=1.457331
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.232342e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.3335 head_norm=1.294448 delta_norm=0.523234
[S5] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.1359 head_norm=1.396176
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.919339e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.1359 head_norm=1.452693 delta_norm=0.691934
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.3687 head_norm=1.109790
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.148612e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.3687 head_norm=1.043729 delta_norm=0.514861
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.3237 head_norm=1.771560
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.353908e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.3238 head_norm=1.776999 delta_norm=0.135391
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.748067 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 2.6298137079054973, 'psi': 0.24520932503356518}-{'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.600565809940002, 'psi': 0.245119570522206}
[S3] START round=24 head_norm_before_train=1.969789 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.2972503882342194, 'auprc': 0.2972503882342194, 'loss_val': 4.299761182745427, 'psi': 0.2972503882342194}-{'f1_val': 0.288422358047657, 'auprc': 0.288422358047657, 'loss_val': 3.7509123896179934, 'psi': 0.288422358047657}
[S4] START round=24 head_norm_before_train=1.792676 (no previous merge yet)
[S4] round=24 local utility u=0.004832 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3015081085043783, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3111726215369692, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.294448 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9174987467276048, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8343626599264442, 'psi': 0.3335071121394324}
[S6] START round=24 head_norm_before_train=1.752077 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.322280159064749, 'psi': 0.017105871474803514}-{'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 6.237404145340454, 'psi': 0.016882516188714152}
[S7] START round=24 head_norm_before_train=1.796906 (no previous merge yet)
[S7] round=24 local utility u=0.001529 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.007779542179606, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0108366726856752, 'psi': 0.35976373724718097}
[S8] START round=24 head_norm_before_train=1.822518 (no previous merge yet)
[S8] round=24 local utility u=0.012198 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.585890704645584, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6102876142237939, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.043729 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.042526 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4378976923065205, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5229496105649607, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.775863 (no previous merge yet)
[S10] round=24 local utility u=0.009033 metrics={'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 2.662676184433491, 'psi': 0.33277551996175}-{'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.681460888383185, 'psi': 0.332855321861058}
[S11] START round=24 head_norm_before_train=1.776999 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.32423829013187816, 'auprc': 0.32423829013187816, 'loss_val': 1.5896717454800602, 'psi': 0.32423829013187816}-{'f1_val': 0.32372740337342104, 'auprc': 0.32372740337342104, 'loss_val': 1.4289538824768035, 'psi': 0.32372740337342104}
[S13] START round=24 head_norm_before_train=1.587873 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2202185980530407, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.158895810137261, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.452693 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.522120 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.0181060298014923, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.061889193206391, 'psi': 0.13587634006482174}
[S15] START round=24 head_norm_before_train=1.740505 (no previous merge yet)
[S15] round=24 local utility u=0.018521 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.5789366176522613, 'psi': 0.6165550083006743}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.6159776736727354, 'psi': 0.6165550083006743}
[S16] START round=24 head_norm_before_train=1.233447 cos_to_last_merge=0.9963 (last merge round=22)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.09042255771227735, 'auprc': 0.09042255771227735, 'loss_val': 2.4562648574518433, 'psi': 0.09042255771227735}-{'f1_val': 0.07970660146699267, 'auprc': 0.07970660146699267, 'loss_val': 2.212126831129877, 'psi': 0.07970660146699267}
[S17] START round=24 head_norm_before_train=1.730086 (no previous merge yet)
[S17] round=24 local utility u=0.702333 metrics={'f1_val': 0.30765964764372966, 'auprc': 0.30765964764372966, 'loss_val': 0.8385420665924295, 'psi': 0.30765964764372966}-{'f1_val': 0.15266206995750295, 'auprc': 0.15266206995750295, 'loss_val': 0.848230070176, 'psi': 0.15266206995750295}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38508
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38514
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:38512
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] cosine check vs S8: cos=-0.0342
[S7] DROPPED delta from S8 (cos=-0.0342 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.8622
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=-0.0240
[S5] DROPPED delta from S15 (cos=-0.0240 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S9
[S14] cosine check vs S9: cos=-0.0841
[S14] DROPPED delta from S9 (cos=-0.0841 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9091
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.5161
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.1359 head_norm=1.502460
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.841947e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.1359 head_norm=1.619309 delta_norm=0.384195
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.3335 head_norm=1.373471
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.628265e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.3335 head_norm=1.529584 delta_norm=0.462826
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.3242 head_norm=1.819011
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.227365e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.3266 head_norm=1.811042 delta_norm=0.122737
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.3687 head_norm=1.138279
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.590244e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.3687 head_norm=1.266821 delta_norm=0.759024
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.760885 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.21360239162929748, 'auprc': 0.21360239162929748, 'loss_val': 3.292602966969237, 'psi': 0.21360239162929748}-{'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 2.6298137079054973, 'psi': 0.24520932503356518}
[S3] START round=25 head_norm_before_train=1.981043 (no previous merge yet)
[S3] round=25 local utility u=0.186742 metrics={'f1_val': 0.28903683976919664, 'auprc': 0.28903683976919664, 'loss_val': 3.8523561797934245, 'psi': 0.28903683976919664}-{'f1_val': 0.2972503882342194, 'auprc': 0.2972503882342194, 'loss_val': 4.299761182745427, 'psi': 0.2972503882342194}
[S4] START round=25 head_norm_before_train=1.811372 (no previous merge yet)
[S4] round=25 local utility u=0.005088 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2913324771771741, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3015081085043783, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.529584 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9447304948596709, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9174987467276048, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.763961 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.374768394041316, 'psi': 0.01732902033271719}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.322280159064749, 'psi': 0.017105871474803514}
[S7] START round=25 head_norm_before_train=1.811670 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0192166463437895, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.007779542179606, 'psi': 0.35976373724718097}
[S8] START round=25 head_norm_before_train=1.842184 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6009951516592273, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.585890704645584, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.266821 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.541021596406757, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4378976923065205, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.794784 (no previous merge yet)
[S10] round=25 local utility u=0.027188 metrics={'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.6090190626165146, 'psi': 0.332855321861058}-{'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 2.662676184433491, 'psi': 0.33277551996175}
[S11] START round=25 head_norm_before_train=1.811042 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.067218 metrics={'f1_val': 0.3225563343130605, 'auprc': 0.3225563343130605, 'loss_val': 1.4400979422351128, 'psi': 0.3225563343130605}-{'f1_val': 0.32423829013187816, 'auprc': 0.32423829013187816, 'loss_val': 1.5896717454800602, 'psi': 0.32423829013187816}
[S13] START round=25 head_norm_before_train=1.598770 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2353127400631034, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2202185980530407, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.619309 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.088326 metrics={'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 2.8217166446980175, 'psi': 0.13373403456048086}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.0181060298014923, 'psi': 0.13592717296421}
[S15] START round=25 head_norm_before_train=1.768833 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5810182679718151, 'psi': 0.6164734888353558}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.5789366176522613, 'psi': 0.6165550083006743}
[S16] START round=25 head_norm_before_train=1.287559 cos_to_last_merge=0.9872 (last merge round=22)
[S16] round=25 local utility u=0.120902 metrics={'f1_val': 0.12507507507507507, 'auprc': 0.12507507507507507, 'loss_val': 2.526332826917608, 'psi': 0.12507507507507507}-{'f1_val': 0.09042255771227735, 'auprc': 0.09042255771227735, 'loss_val': 2.4562648574518433, 'psi': 0.09042255771227735}
[S17] START round=25 head_norm_before_train=1.751065 (no previous merge yet)
[S17] round=25 local utility u=0.000067 metrics={'f1_val': 0.30765964764372966, 'auprc': 0.30765964764372966, 'loss_val': 0.8384083963858984, 'psi': 0.30765964764372966}-{'f1_val': 0.30765964764372966, 'auprc': 0.30765964764372966, 'loss_val': 0.8385420665924295, 'psi': 0.30765964764372966}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.134)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:38512
[S16] not sending this round → trigger blocked (psi=0.125)
[S4] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9921
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=0.2695
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] cosine check vs S3: cos=0.2141
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.9594
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S17
[S9] cosine check vs S17: cos=0.8781
[S8] ⇄ pheromone p=0.064 → S7@127.0.0.1:38508
[S13] ⇄ pheromone p=0.032 → S9@127.0.0.1:38510
[S7] ⇄ pheromone p=0.096 → S14@127.0.0.1:38514
[S2] ⇄ pheromone p=0.047 → S5@127.0.0.1:38505
[S15] ⇄ pheromone p=0.070 → S5@127.0.0.1:38505
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.3687 head_norm=1.337173
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.925634e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.3687 head_norm=1.235699 delta_norm=0.392563
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.045 → S14@127.0.0.1:38514
[S6] ⇄ pheromone p=0.010 → S4@127.0.0.1:38504
[S14] ⇄ pheromone p=0.204 → S5@127.0.0.1:38505
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.3335 head_norm=1.591818
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.797468e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.3335 head_norm=1.397112 delta_norm=0.479747
[S5] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.035 → S16@127.0.0.1:38516
[S10] ⇄ pheromone p=0.060 → S5@127.0.0.1:38505
[S3] ⇄ pheromone p=0.092 → S5@127.0.0.1:38505
[S4] ⇄ pheromone p=0.103 → S11@127.0.0.1:38512
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.3226 head_norm=1.853020
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.161781e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.3237 head_norm=1.838222 delta_norm=0.116178
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.077 → S9@127.0.0.1:38510
[S16] ⇄ pheromone p=0.120 → S6@127.0.0.1:38507
[S17] ⇄ pheromone p=0.191 → S9@127.0.0.1:38510
[S2] START round=26 head_norm_before_train=1.771905 (no previous merge yet)
[S2] round=26 local utility u=0.510272 metrics={'f1_val': 0.2644290885159592, 'auprc': 0.2644290885159592, 'loss_val': 2.7294993742549956, 'psi': 0.2644290885159592}-{'f1_val': 0.21360239162929748, 'auprc': 0.21360239162929748, 'loss_val': 3.292602966969237, 'psi': 0.21360239162929748}
[S3] START round=26 head_norm_before_train=1.991360 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.2935406255783824, 'auprc': 0.2935406255783824, 'loss_val': 4.541785681987113, 'psi': 0.2935406255783824}-{'f1_val': 0.28903683976919664, 'auprc': 0.28903683976919664, 'loss_val': 3.8523561797934245, 'psi': 0.28903683976919664}
[S4] START round=26 head_norm_before_train=1.830693 (no previous merge yet)
[S4] round=26 local utility u=0.005602 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2801278441351693, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2913324771771741, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.397112 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.089287 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.766155949825674, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9447304948596709, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.775575 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.0016698473282442748, 'auprc': 0.0016698473282442748, 'loss_val': 6.528572126058119, 'psi': 0.0016698473282442746}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.374768394041316, 'psi': 0.01732902033271719}
[S7] START round=26 head_norm_before_train=1.822060 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0770777322330334, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0192166463437895, 'psi': 0.35976373724718097}
[S8] START round=26 head_norm_before_train=1.861268 (no previous merge yet)
[S8] round=26 local utility u=0.003817 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.593362021984092, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6009951516592273, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.235699 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5752221884379005, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.541021596406757, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.810545 (no previous merge yet)
[S10] round=26 local utility u=0.017435 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.5734332011108667, 'psi': 0.3327757865392274}-{'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.6090190626165146, 'psi': 0.332855321861058}
[S11] START round=26 head_norm_before_train=1.838222 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 1.6881750702850011, 'psi': 0.33178150217256364}-{'f1_val': 0.3225563343130605, 'auprc': 0.3225563343130605, 'loss_val': 1.4400979422351128, 'psi': 0.3225563343130605}
[S13] START round=26 head_norm_before_train=1.609565 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2511817601017816, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2353127400631034, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.668010 cos_to_last_merge=0.9965 (last merge round=24)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 3.5829402415256753, 'psi': 0.1355297641332834}-{'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 2.8217166446980175, 'psi': 0.13373403456048086}
[S15] START round=26 head_norm_before_train=1.796923 (no previous merge yet)
[S15] round=26 local utility u=0.017557 metrics={'f1_val': 0.6166941009299512, 'auprc': 0.6166941009299512, 'loss_val': 0.5478892362832503, 'psi': 0.6166941009299512}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5810182679718151, 'psi': 0.6164734888353558}
[S16] START round=26 head_norm_before_train=1.337968 cos_to_last_merge=0.9776 (last merge round=22)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.09056061332055582, 'auprc': 0.09056061332055582, 'loss_val': 2.9320758722210325, 'psi': 0.09056061332055582}-{'f1_val': 0.12507507507507507, 'auprc': 0.12507507507507507, 'loss_val': 2.526332826917608, 'psi': 0.12507507507507507}
[S17] START round=26 head_norm_before_train=1.769671 (no previous merge yet)
[S17] round=26 local utility u=0.000253 metrics={'f1_val': 0.3065619657460797, 'auprc': 0.3065619657460797, 'loss_val': 0.8280231582088691, 'psi': 0.3065619657460797}-{'f1_val': 0.30765964764372966, 'auprc': 0.30765964764372966, 'loss_val': 0.8384083963858984, 'psi': 0.30765964764372966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:38516
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:38505
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:38512
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:38505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9935
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] cosine check vs S8: cos=-0.0346
[S7] DROPPED delta from S8 (cos=-0.0346 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S2
[S5] cosine check vs S2: cos=0.0604
[S5] RECEIVED delta(kind=head bytes=1805) from S15
[S5] cosine check vs S15: cos=-0.0214
[S5] DROPPED delta from S15 (cos=-0.0214 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.8663
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.7594
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1807 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1807) from S17
[S9] cosine check vs S17: cos=0.7767
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.3687 head_norm=1.311664
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.640761e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.3687 head_norm=1.462414 delta_norm=0.564076
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.3318 head_norm=1.876550
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.071063e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.3319 head_norm=1.860092 delta_norm=0.107106
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.3335 head_norm=1.441870
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.854919e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.3335 head_norm=1.249772 delta_norm=0.585492
[S5] aggregate: ACCEPT kept=['S2', 'S10'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.0906 head_norm=1.381463
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.904493e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.0925 head_norm=1.324075 delta_norm=0.490449
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.781965 (no previous merge yet)
[S2] round=27 local utility u=0.484730 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.687476907277368, 'psi': 0.3674775928297055}-{'f1_val': 0.2644290885159592, 'auprc': 0.2644290885159592, 'loss_val': 2.7294993742549956, 'psi': 0.2644290885159592}
[S3] START round=27 head_norm_before_train=1.999714 (no previous merge yet)
[S3] round=27 local utility u=0.380797 metrics={'f1_val': 0.281037305074524, 'auprc': 0.281037305074524, 'loss_val': 3.6676615260540304, 'psi': 0.281037305074524}-{'f1_val': 0.2935406255783824, 'auprc': 0.2935406255783824, 'loss_val': 4.541785681987113, 'psi': 0.2935406255783824}
[S4] START round=27 head_norm_before_train=1.849699 (no previous merge yet)
[S4] round=27 local utility u=0.001328 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.277472777320223, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2801278441351693, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.249772 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.075506 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6151433537615287, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.766155949825674, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.784718 (no previous merge yet)
[S6] round=27 local utility u=0.087073 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.4953578586981955, 'psi': 0.01732902033271719}-{'f1_val': 0.0016698473282442748, 'auprc': 0.0016698473282442748, 'loss_val': 6.528572126058119, 'psi': 0.0016698473282442746}
[S7] START round=27 head_norm_before_train=1.834274 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0250404557939559, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0770777322330334, 'psi': 0.35976373724718097}
[S8] START round=27 head_norm_before_train=1.878652 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6005276568140722, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.593362021984092, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.462414 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6408990670200978, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5752221884379005, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.827818 (no previous merge yet)
[S10] round=27 local utility u=0.028707 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.516019424666617, 'psi': 0.3327757865392274}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.5734332011108667, 'psi': 0.3327757865392274}
[S11] START round=27 head_norm_before_train=1.860092 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.004161 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 1.6099752123333482, 'psi': 0.3240172688025449}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 1.6881750702850011, 'psi': 0.33178150217256364}
[S13] START round=27 head_norm_before_train=1.617533 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3077990328959603, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2511817601017816, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.726859 cos_to_last_merge=0.9877 (last merge round=24)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.131130797293289, 'psi': 0.13582554517133957}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 3.5829402415256753, 'psi': 0.1355297641332834}
[S15] START round=27 head_norm_before_train=1.825621 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6118013782587512, 'psi': 0.6163342951580373}-{'f1_val': 0.6166941009299512, 'auprc': 0.6166941009299512, 'loss_val': 0.5478892362832503, 'psi': 0.6166941009299512}
[S16] START round=27 head_norm_before_train=1.324075 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.295308 metrics={'f1_val': 0.09056061332055582, 'auprc': 0.09056061332055582, 'loss_val': 2.341459097658656, 'psi': 0.09056061332055582}-{'f1_val': 0.09056061332055582, 'auprc': 0.09056061332055582, 'loss_val': 2.9320758722210325, 'psi': 0.09056061332055582}
[S17] START round=27 head_norm_before_train=1.786956 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.3065619657460797, 'auprc': 0.3065619657460797, 'loss_val': 0.8668306920665807, 'psi': 0.3065619657460797}-{'f1_val': 0.3065619657460797, 'auprc': 0.3065619657460797, 'loss_val': 0.8280231582088691, 'psi': 0.3065619657460797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:38516
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.017)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[S16] not sending this round → trigger blocked (psi=0.091)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] cosine check vs S11: cos=0.2080
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=0.4023
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] cosine check vs S3: cos=0.2667
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=0.8791
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.9488
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9947
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.3687 head_norm=1.527257
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.086625e+00
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.3687 head_norm=1.335295 delta_norm=1.086625
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.3240 head_norm=1.896054
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.777314e-02
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.3241 head_norm=1.878994 delta_norm=0.097773
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.3335 head_norm=1.298365
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.758109e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.3335 head_norm=1.168818 delta_norm=0.275811
[S5] aggregate: ACCEPT kept=['S2', 'S3', 'S10'] (k=3/3) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.0906 head_norm=1.360868
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.149445e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.0907 head_norm=1.312500 delta_norm=0.214944
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.791960 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.730293314428241, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.687476907277368, 'psi': 0.3674775928297055}
[S3] START round=28 head_norm_before_train=2.009064 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.2971094035858031, 'auprc': 0.2971094035858031, 'loss_val': 4.464266688137741, 'psi': 0.2971094035858031}-{'f1_val': 0.281037305074524, 'auprc': 0.281037305074524, 'loss_val': 3.6676615260540304, 'psi': 0.281037305074524}
[S4] START round=28 head_norm_before_train=1.866905 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.278579252943924, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.277472777320223, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.168818 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.007825 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.5994935085050113, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6151433537615287, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.792722 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.551786519722041, 'psi': 0.017551963048498844}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.4953578586981955, 'psi': 0.01732902033271719}
[S7] START round=28 head_norm_before_train=1.844986 (no previous merge yet)
[S7] round=28 local utility u=0.008691 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.0083471995704238, 'psi': 0.23976608187134504}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0250404557939559, 'psi': 0.23968964488212474}
[S8] START round=28 head_norm_before_train=1.895640 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6058682344193965, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6005276568140722, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.335295 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.081623 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4776521339868294, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6408990670200978, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.852965 (no previous merge yet)
[S10] round=28 local utility u=0.030786 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.4551643327249133, 'psi': 0.3328555502468546}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.516019424666617, 'psi': 0.3327757865392274}
[S11] START round=28 head_norm_before_train=1.878994 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 1.630208033397954, 'psi': 0.3240172688025449}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 1.6099752123333482, 'psi': 0.3240172688025449}
[S13] START round=28 head_norm_before_train=1.626048 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.37357279902419, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3077990328959603, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.779691 cos_to_last_merge=0.9783 (last merge round=24)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.493962658912864, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.131130797293289, 'psi': 0.13582554517133957}
[S15] START round=28 head_norm_before_train=1.848184 (no previous merge yet)
[S15] round=28 local utility u=0.009665 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5937250884067076, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6118013782587512, 'psi': 0.6163342951580373}
[S16] START round=28 head_norm_before_train=1.312500 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.060748 metrics={'f1_val': 0.09018949388342529, 'auprc': 0.09018949388342529, 'loss_val': 2.2166226249861265, 'psi': 0.09018949388342529}-{'f1_val': 0.09056061332055582, 'auprc': 0.09056061332055582, 'loss_val': 2.341459097658656, 'psi': 0.09056061332055582}
[S17] START round=28 head_norm_before_train=1.803692 (no previous merge yet)
[S17] round=28 local utility u=0.350766 metrics={'f1_val': 0.38074476151092207, 'auprc': 0.38074476151092207, 'loss_val': 0.8329434259383199, 'psi': 0.38074476151092207}-{'f1_val': 0.3065619657460797, 'auprc': 0.3065619657460797, 'loss_val': 0.8668306920665807, 'psi': 0.3065619657460797}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:38514
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38516
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=-0.0419
[S5] DROPPED delta from S15 (cos=-0.0419 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.9652
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] cosine check vs S7: cos=0.9082
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=-0.1008
[S14] DROPPED delta from S9 (cos=-0.1008 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.7865
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S17
[S9] cosine check vs S17: cos=0.4850
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.3335 head_norm=1.228834
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.946227e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.3335 head_norm=1.474016 delta_norm=0.594623
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.1358 head_norm=1.822219
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.953730e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.1358 head_norm=1.800554 delta_norm=0.395373
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.0902 head_norm=1.352149
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.808862e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.0902 head_norm=1.279238 delta_norm=0.180886
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.3687 head_norm=1.415776
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.383721e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.3687 head_norm=1.396696 delta_norm=0.838372
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.801505 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 2.7339540311971358, 'psi': 0.24538903139123003}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.730293314428241, 'psi': 0.3674775928297055}
[S3] START round=29 head_norm_before_train=2.018341 (no previous merge yet)
[S3] round=29 local utility u=0.310703 metrics={'f1_val': 0.2821512081060015, 'auprc': 0.2821512081060015, 'loss_val': 3.708237576928286, 'psi': 0.2821512081060015}-{'f1_val': 0.2971094035858031, 'auprc': 0.2971094035858031, 'loss_val': 4.464266688137741, 'psi': 0.2971094035858031}
[S4] START round=29 head_norm_before_train=1.883363 (no previous merge yet)
[S4] round=29 local utility u=0.004330 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2699184942099973, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.278579252943924, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.474016 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8237427710341982, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.5994935085050113, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.802395 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.606031628882695, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.551786519722041, 'psi': 0.017551963048498844}
[S7] START round=29 head_norm_before_train=1.864442 (no previous merge yet)
[S7] round=29 local utility u=0.483997 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.120332772000248, 'psi': 0.35976373724718097}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.0083471995704238, 'psi': 0.23976608187134504}
[S8] START round=29 head_norm_before_train=1.910500 (no previous merge yet)
[S8] round=29 local utility u=0.014210 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5774473341628098, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6058682344193965, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.396696 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6610998203697167, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4776521339868294, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.882170 (no previous merge yet)
[S10] round=29 local utility u=0.001145 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.452155459664163, 'psi': 0.3327757865392274}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.4551643327249133, 'psi': 0.3328555502468546}
[S11] START round=29 head_norm_before_train=1.912634 cos_to_last_merge=0.9993 (last merge round=27)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 1.6419417113363501, 'psi': 0.3237965485921889}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 1.630208033397954, 'psi': 0.3240172688025449}
[S13] START round=29 head_norm_before_train=1.641250 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3981939554136154, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.37357279902419, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.800554 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.622587 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.2487885643405665, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.493962658912864, 'psi': 0.13582554517133957}
[S15] START round=29 head_norm_before_train=1.871413 (no previous merge yet)
[S15] round=29 local utility u=0.027665 metrics={'f1_val': 0.6166941009299512, 'auprc': 0.6166941009299512, 'loss_val': 0.5403812471069815, 'psi': 0.6166941009299512}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5937250884067076, 'psi': 0.6164734888353558}
[S16] START round=29 head_norm_before_train=1.279238 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.018573618249030744, 'auprc': 0.018573618249030744, 'loss_val': 2.4302939054602124, 'psi': 0.018573618249030744}-{'f1_val': 0.09018949388342529, 'auprc': 0.09018949388342529, 'loss_val': 2.2166226249861265, 'psi': 0.09018949388342529}
[S17] START round=29 head_norm_before_train=1.817369 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.9397174291997348, 'psi': 0.30380970798684975}-{'f1_val': 0.38074476151092207, 'auprc': 0.38074476151092207, 'loss_val': 0.8329434259383199, 'psi': 0.38074476151092207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38507
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:38509
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] cosine check vs S7: cos=-0.0337
[S8] DROPPED delta from S7 (cos=-0.0337 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S4
[S6] cosine check vs S4: cos=0.0088
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.136)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.0176 head_norm=1.812697
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.304755e+00
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.0176 head_norm=1.316337 delta_norm=1.304755
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.810875 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.210637177461822, 'auprc': 0.210637177461822, 'loss_val': 3.4635643582731284, 'psi': 0.210637177461822}-{'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 2.7339540311971358, 'psi': 0.24538903139123003}
[S3] START round=30 head_norm_before_train=2.026720 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.29050678087080656, 'auprc': 0.29050678087080656, 'loss_val': 4.061312618258688, 'psi': 0.29050678087080656}-{'f1_val': 0.2821512081060015, 'auprc': 0.2821512081060015, 'loss_val': 3.708237576928286, 'psi': 0.2821512081060015}
[S4] START round=30 head_norm_before_train=1.893247 (no previous merge yet)
[S4] round=30 local utility u=0.003454 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2630098449254952, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2699184942099973, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.544040 cos_to_last_merge=0.9947 (last merge round=28)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1077480704239946, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8237427710341982, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.316337 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=1.000000 metrics={'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 3.749303836220128, 'psi': 0.020871559633027524}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.606031628882695, 'psi': 0.017551963048498844}
[S7] START round=30 head_norm_before_train=1.881195 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.1215111869596253, 'psi': 0.23976608187134504}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.120332772000248, 'psi': 0.35976373724718097}
[S8] START round=30 head_norm_before_train=1.921370 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6109129216013665, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5774473341628098, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.470857 cos_to_last_merge=0.9933 (last merge round=28)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7932871472251133, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6610998203697167, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.911234 (no previous merge yet)
[S10] round=30 local utility u=0.060032 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.332809109098766, 'psi': 0.3328555502468546}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.452155459664163, 'psi': 0.3327757865392274}
[S11] START round=30 head_norm_before_train=1.944389 cos_to_last_merge=0.9976 (last merge round=27)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 1.7751825587729657, 'psi': 0.3240909090909091}-{'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 1.6419417113363501, 'psi': 0.3237965485921889}
[S13] START round=30 head_norm_before_train=1.651228 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4209461977089133, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3981939554136154, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.833071 cos_to_last_merge=0.9992 (last merge round=28)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.7053506393624387, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.2487885643405665, 'psi': 0.13582554517133957}
[S15] START round=30 head_norm_before_train=1.893988 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.5510804834733377, 'psi': 0.6165550083006743}-{'f1_val': 0.6166941009299512, 'auprc': 0.6166941009299512, 'loss_val': 0.5403812471069815, 'psi': 0.6166941009299512}
[S16] START round=30 head_norm_before_train=1.323461 cos_to_last_merge=0.9972 (last merge round=28)
[S16] round=30 local utility u=0.293713 metrics={'f1_val': 0.09013768812039706, 'auprc': 0.09013768812039706, 'loss_val': 2.4869449590045405, 'psi': 0.09013768812039706}-{'f1_val': 0.018573618249030744, 'auprc': 0.018573618249030744, 'loss_val': 2.4302939054602124, 'psi': 0.018573618249030744}
[S17] START round=30 head_norm_before_train=1.830063 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.21637484300615914, 'auprc': 0.21637484300615914, 'loss_val': 0.8938275871641038, 'psi': 0.21637484300615917}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.9397174291997348, 'psi': 0.30380970798684975}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38507
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.021)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S4
[S6] cosine check vs S4: cos=0.7057
[S11] ⇄ pheromone p=0.026 → S4@127.0.0.1:38504
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.0209 head_norm=1.348486
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.746171e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.0178 head_norm=1.505689 delta_norm=0.674617
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.212 → S16@127.0.0.1:38516
[S7] ⇄ pheromone p=0.110 → S8@127.0.0.1:38509
[S5] ⇄ pheromone p=0.027 → S14@127.0.0.1:38514
[S9] ⇄ pheromone p=0.025 → S17@127.0.0.1:38517
[S4] ⇄ pheromone p=0.036 → S11@127.0.0.1:38512
[S17] ⇄ pheromone p=0.108 → S9@127.0.0.1:38510
[S16] ⇄ pheromone p=0.136 → S6@127.0.0.1:38507
[S14] ⇄ pheromone p=0.167 → S7@127.0.0.1:38508
[S2] START round=31 head_norm_before_train=1.819134 (no previous merge yet)
[S2] round=31 local utility u=1.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7895530291748822, 'psi': 0.3674775928297055}-{'f1_val': 0.210637177461822, 'auprc': 0.210637177461822, 'loss_val': 3.4635643582731284, 'psi': 0.210637177461822}
[S3] START round=31 head_norm_before_train=2.034847 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.2917562724014337, 'auprc': 0.2917562724014337, 'loss_val': 4.1193644185759055, 'psi': 0.2917562724014337}-{'f1_val': 0.29050678087080656, 'auprc': 0.29050678087080656, 'loss_val': 4.061312618258688, 'psi': 0.29050678087080656}
[S4] START round=31 head_norm_before_train=1.904206 (no previous merge yet)
[S4] round=31 local utility u=0.002769 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2574715089278388, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2630098449254952, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.604949 cos_to_last_merge=0.9865 (last merge round=28)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.252531698924222, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1077480704239946, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=1.505689 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.331817 metrics={'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 3.049768188783103, 'psi': 0.016882516188714152}-{'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 3.749303836220128, 'psi': 0.020871559633027524}
[S7] START round=31 head_norm_before_train=1.899630 (no previous merge yet)
[S7] round=31 local utility u=0.507957 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1855767758127589, 'psi': 0.35976373724718097}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.1215111869596253, 'psi': 0.23976608187134504}
[S8] START round=31 head_norm_before_train=1.931052 (no previous merge yet)
[S8] round=31 local utility u=0.027126 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5566611621456928, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6109129216013665, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.542102 cos_to_last_merge=0.9816 (last merge round=28)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8963724449880113, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7932871472251133, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.936305 (no previous merge yet)
[S10] round=31 local utility u=0.028586 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.275637498978452, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.332809109098766, 'psi': 0.3328555502468546}
[S11] START round=31 head_norm_before_train=1.971298 cos_to_last_merge=0.9959 (last merge round=27)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3264620552756146, 'auprc': 0.3264620552756146, 'loss_val': 1.9265172751289263, 'psi': 0.3264620552756146}-{'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 1.7751825587729657, 'psi': 0.3240909090909091}
[S13] START round=31 head_norm_before_train=1.657364 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4431931844061308, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4209461977089133, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.869444 cos_to_last_merge=0.9969 (last merge round=28)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 4.11005359866875, 'psi': 0.1355297641332834}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.7053506393624387, 'psi': 0.13587634006482174}
[S15] START round=31 head_norm_before_train=1.914825 (no previous merge yet)
[S15] round=31 local utility u=0.001195 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5479572222399747, 'psi': 0.6164734888353558}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.5510804834733377, 'psi': 0.6165550083006743}
[S16] START round=31 head_norm_before_train=1.371738 cos_to_last_merge=0.9908 (last merge round=28)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.08958333333333333, 'auprc': 0.08958333333333333, 'loss_val': 2.7871809679435176, 'psi': 0.08958333333333333}-{'f1_val': 0.09013768812039706, 'auprc': 0.09013768812039706, 'loss_val': 2.4869449590045405, 'psi': 0.09013768812039706}
[S17] START round=31 head_norm_before_train=1.840675 (no previous merge yet)
[S17] round=31 local utility u=0.409405 metrics={'f1_val': 0.30984952120383036, 'auprc': 0.30984952120383036, 'loss_val': 0.9162895124623976, 'psi': 0.30984952120383036}-{'f1_val': 0.21637484300615914, 'auprc': 0.21637484300615914, 'loss_val': 0.8938275871641038, 'psi': 0.21637484300615917}
[S6] not sending this round → trigger blocked (psi=0.017)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38514
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38508
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9470
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9863
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=-0.0351
[S7] DROPPED delta from S8 (cos=-0.0351 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=0.8260
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.3265 head_norm=1.994006
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.666628e-01
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.3315 head_norm=1.947796 delta_norm=0.166663
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.1355 head_norm=1.902604
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.112234e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.1359 head_norm=1.886158 delta_norm=0.311223
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.3687 head_norm=1.594450
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.235203e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.3687 head_norm=1.648127 delta_norm=0.523520
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.827187 (no previous merge yet)
[S2] round=32 local utility u=0.002184 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.785184653359357, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7895530291748822, 'psi': 0.3674775928297055}
[S3] START round=32 head_norm_before_train=2.043101 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.29627606300646453, 'auprc': 0.29627606300646453, 'loss_val': 4.397288666863668, 'psi': 0.29627606300646453}-{'f1_val': 0.2917562724014337, 'auprc': 0.2917562724014337, 'loss_val': 4.1193644185759055, 'psi': 0.2917562724014337}
[S4] START round=32 head_norm_before_train=1.915023 (no previous merge yet)
[S4] round=32 local utility u=0.000107 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2572578189320411, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2574715089278388, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.651361 cos_to_last_merge=0.9808 (last merge round=28)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2723862635567422, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.252531698924222, 'psi': 0.3335071121394324}
[S6] START round=32 head_norm_before_train=1.540451 cos_to_last_merge=0.9967 (last merge round=30)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 3.804608787879728, 'psi': 0.01799723119520074}-{'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 3.049768188783103, 'psi': 0.016882516188714152}
[S7] START round=32 head_norm_before_train=1.920677 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.240268941499587, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1855767758127589, 'psi': 0.35976373724718097}
[S8] START round=32 head_norm_before_train=1.939563 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5644459702712026, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5566611621456928, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.648127 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9698890087576966, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8963724449880113, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=1.959733 (no previous merge yet)
[S10] round=32 local utility u=0.034765 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.2061068744689645, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.275637498978452, 'psi': 0.3328555502468546}
[S11] START round=32 head_norm_before_train=1.947796 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.065618 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 1.7732782222360755, 'psi': 0.3240172688025449}-{'f1_val': 0.3264620552756146, 'auprc': 0.3264620552756146, 'loss_val': 1.9265172751289263, 'psi': 0.3264620552756146}
[S13] START round=32 head_norm_before_train=1.661569 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4833272996433353, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4431931844061308, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.886158 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.428882 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.254078033437165, 'psi': 0.13572854291417166}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 4.11005359866875, 'psi': 0.1355297641332834}
[S15] START round=32 head_norm_before_train=1.936425 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5545488301039394, 'psi': 0.6166125814646326}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5479572222399747, 'psi': 0.6164734888353558}
[S16] START round=32 head_norm_before_train=1.417328 cos_to_last_merge=0.9838 (last merge round=28)
[S16] round=32 local utility u=0.395733 metrics={'f1_val': 0.14117132867132867, 'auprc': 0.14117132867132867, 'loss_val': 2.4600077444895248, 'psi': 0.14117132867132867}-{'f1_val': 0.08958333333333333, 'auprc': 0.08958333333333333, 'loss_val': 2.7871809679435176, 'psi': 0.08958333333333333}
[S17] START round=32 head_norm_before_train=1.854325 (no previous merge yet)
[S17] round=32 local utility u=0.455677 metrics={'f1_val': 0.40197275201501415, 'auprc': 0.40197275201501415, 'loss_val': 0.8340447850969486, 'psi': 0.40197275201501415}-{'f1_val': 0.30984952120383036, 'auprc': 0.30984952120383036, 'loss_val': 0.9162895124623976, 'psi': 0.30984952120383036}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.136)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:38512
[S16] not sending this round → trigger blocked (psi=0.141)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] cosine check vs S4: cos=0.9948
[S4] RECEIVED delta(kind=head bytes=1805) from S11
[S4] cosine check vs S11: cos=0.9948
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1806 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1806) from S17
[S9] cosine check vs S17: cos=0.9499
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S16
[S5]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.3687 head_norm=1.690485
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.952563e-01
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.3687 head_norm=1.757360 delta_norm=0.295256
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.3568 head_norm=1.928031
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.008833e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.3568 head_norm=1.945189 delta_norm=0.100883
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.3240 head_norm=1.967377
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.008833e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.3241 head_norm=1.945189 delta_norm=0.100883
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.835129 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 2.820055372780464, 'psi': 0.24516443956312162}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.785184653359357, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=2.051381 (no previous merge yet)
[S3] round=33 local utility u=0.035290 metrics={'f1_val': 0.29386796712724644, 'auprc': 0.29386796712724644, 'loss_val': 4.305036315837017, 'psi': 0.29386796712724644}-{'f1_val': 0.29627606300646453, 'auprc': 0.29627606300646453, 'loss_val': 4.397288666863668, 'psi': 0.29627606300646453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=33 head_norm_before_train=1.945189 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.282298693635365, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2572578189320411, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.691117 cos_to_last_merge=0.9773 (last merge round=28)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3211284998668953, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2723862635567422, 'psi': 0.3335071121394324}
[S6] START round=33 head_norm_before_train=1.593519 cos_to_last_merge=0.9865 (last merge round=30)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.464509354244852, 'psi': 0.017774699907663897}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 3.804608787879728, 'psi': 0.01799723119520074}
[S7] START round=33 head_norm_before_train=1.938594 (no previous merge yet)
[S7] round=33 local utility u=0.025901 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.187778264837186, 'psi': 0.2396131805157593}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.240268941499587, 'psi': 0.23968964488212474}
[S8] START round=33 head_norm_before_train=1.946370 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5664183796771376, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5644459702712026, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.757360 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.051622255301581, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9698890087576966, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=1.980826 (no previous merge yet)
[S10] round=33 local utility u=0.013748 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.1786110082608587, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.2061068744689645, 'psi': 0.3328555502468546}
[S10] not sending this round → trigger blocked (psi=0.333)
[S11] START round=33 head_norm_before_train=1.945189 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.060967 metrics={'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 1.6486953892332845, 'psi': 0.3237230419977299}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 1.7732782222360755, 'psi': 0.3240172688025449}
[S13] START round=33 head_norm_before_train=1.666127 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5409181596128751, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4833272996433353, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.915900 cos_to_last_merge=0.9993 (last merge round=31)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 3.766577967645992, 'psi': 0.1345336334083521}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.254078033437165, 'psi': 0.13572854291417166}
[S15] START round=33 head_norm_before_train=1.956674 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5705214892419499, 'psi': 0.6164734888353558}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5545488301039394, 'psi': 0.6166125814646326}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.456829 cos_to_last_merge=0.9779 (last merge round=28)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.048319147106869575, 'auprc': 0.048319147106869575, 'loss_val': 3.396367005349477, 'psi': 0.048319147106869575}-{'f1_val': 0.14117132867132867, 'auprc': 0.14117132867132867, 'loss_val': 2.4600077444895248, 'psi': 0.14117132867132867}
[S17] START round=33 head_norm_before_train=1.869021 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.3114871450549657, 'auprc': 0.3114871450549657, 'loss_val': 0.9148874124212398, 'psi': 0.3114871450549657}-{'f1_val': 0.40197275201501415, 'auprc': 0.40197275201501415, 'loss_val': 0.8340447850969486, 'psi': 0.40197275201501415}
[S11] not sending this round → trigger blocked (psi=0.324)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38514
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9711
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RoundReady barrier timeout: have=2 need=4 — continuing
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.1345 head_norm=1.949996
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.346926e-01
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.1355 head_norm=1.937418 delta_norm=0.234693
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S10
[S5]  timeout peer S14
[S5]  timeout peer S15
[S9]  timeout peer S11
[S9]  timeout peer S13
[S7]  timeout peer S8
[S16]  timeout peer S5
[S4]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S9
[S2] START round=34 head_norm_before_train=1.840487 (no previous merge yet)
[S2] round=34 local utility u=0.068120 metrics={'f1_val': 0.2644813059505003, 'auprc': 0.2644813059505003, 'loss_val': 2.857667102035284, 'psi': 0.2644813059505003}-{'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 2.820055372780464, 'psi': 0.24516443956312162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=34 head_norm_before_train=2.059136 (no previous merge yet)
[S3] round=34 local utility u=0.118642 metrics={'f1_val': 0.288422358047657, 'auprc': 0.288422358047657, 'loss_val': 4.018742052647635, 'psi': 0.288422358047657}-{'f1_val': 0.29386796712724644, 'auprc': 0.29386796712724644, 'loss_val': 4.305036315837017, 'psi': 0.29386796712724644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=34 head_norm_before_train=1.961396 cos_to_last_merge=0.9999 (last merge round=32)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2983855134605478, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.282298693635365, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=1.723100 cos_to_last_merge=0.9745 (last merge round=28)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3624290934275365, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3211284998668953, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.648879 cos_to_last_merge=0.9740 (last merge round=30)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.027161611588954276, 'auprc': 0.027161611588954276, 'loss_val': 4.588488917534809, 'psi': 0.027161611588954276}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.464509354244852, 'psi': 0.017774699907663897}
[S7] START round=34 head_norm_before_train=1.953165 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.1912833803704213, 'psi': 0.2396131805157593}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.187778264837186, 'psi': 0.2396131805157593}
[S8] START round=34 head_norm_before_train=1.956017 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6118145536941179, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5664183796771376, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.802943 cos_to_last_merge=0.9980 (last merge round=32)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2098984502131835, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.051622255301581, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=2.001168 (no previous merge yet)
[S10] round=34 local utility u=0.072916 metrics={'f1_val': 0.3323791348600509, 'auprc': 0.3323791348600509, 'loss_val': 2.0284913636798056, 'psi': 0.3323791348600509}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.1786110082608587, 'psi': 0.3328555502468546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=34 head_norm_before_train=1.965260 cos_to_last_merge=0.9998 (last merge round=32)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 1.8164939912950013, 'psi': 0.3240909090909091}-{'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 1.6486953892332845, 'psi': 0.3237230419977299}
[S13] START round=34 head_norm_before_train=1.670139 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5470529401907314, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5409181596128751, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.937418 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.125947 metrics={'f1_val': 0.11529990931467805, 'auprc': 0.11529990931467805, 'loss_val': 3.3415805407751225, 'psi': 0.11529990931467805}-{'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 3.766577967645992, 'psi': 0.1345336334083521}
[S15] START round=34 head_norm_before_train=1.975501 (no previous merge yet)
[S15] round=34 local utility u=0.023545 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5234311512125818, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5705214892419499, 'psi': 0.6164734888353558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=34 head_norm_before_train=1.488876 cos_to_last_merge=0.9733 (last merge round=28)
[S16] round=34 local utility u=0.903997 metrics={'f1_val': 0.15394456289978678, 'auprc': 0.15394456289978678, 'loss_val': 2.539001752749765, 'psi': 0.15394456289978678}-{'f1_val': 0.048319147106869575, 'auprc': 0.048319147106869575, 'loss_val': 3.396367005349477, 'psi': 0.048319147106869575}
[S17] START round=34 head_norm_before_train=1.884056 (no previous merge yet)
[S17] round=34 local utility u=0.406203 metrics={'f1_val': 0.39673011180732504, 'auprc': 0.39673011180732504, 'loss_val': 0.8696684756105844, 'psi': 0.39673011180732504}-{'f1_val': 0.3114871450549657, 'auprc': 0.3114871450549657, 'loss_val': 0.9148874124212398, 'psi': 0.3114871450549657}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.154)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.115)
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.9672
[S2] START round=35 head_norm_before_train=1.846749 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.0530622196712827, 'psi': 0.2654773703336637}-{'f1_val': 0.2644813059505003, 'auprc': 0.2644813059505003, 'loss_val': 2.857667102035284, 'psi': 0.2644813059505003}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.066895 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.2901185066381538, 'auprc': 0.2901185066381538, 'loss_val': 4.160369029855723, 'psi': 0.2901185066381538}-{'f1_val': 0.288422358047657, 'auprc': 0.288422358047657, 'loss_val': 4.018742052647635, 'psi': 0.288422358047657}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.979243 cos_to_last_merge=0.9998 (last merge round=32)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3154575625576286, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2983855134605478, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=1.752232 cos_to_last_merge=0.9719 (last merge round=28)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.421989163409868, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3624290934275365, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.696941 cos_to_last_merge=0.9630 (last merge round=30)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.388292993796904, 'psi': 0.0}-{'f1_val': 0.027161611588954276, 'auprc': 0.027161611588954276, 'loss_val': 4.588488917534809, 'psi': 0.027161611588954276}
[S7] START round=35 head_norm_before_train=1.965884 (no previous merge yet)
[S7] round=35 local utility u=0.005993 metrics={'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 1.1779211783563854, 'psi': 0.23946016959273855}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.1912833803704213, 'psi': 0.2396131805157593}
[S8] START round=35 head_norm_before_train=1.967357 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.639357515725958, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6118145536941179, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.848805 cos_to_last_merge=0.9935 (last merge round=32)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.348265939224024, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2098984502131835, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=2.019906 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.33229986485412194, 'auprc': 0.33229986485412194, 'loss_val': 2.0301365036279986, 'psi': 0.33229986485412194}-{'f1_val': 0.3323791348600509, 'auprc': 0.3323791348600509, 'loss_val': 2.0284913636798056, 'psi': 0.3323791348600509}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.985900 cos_to_last_merge=0.9994 (last merge round=32)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.32423415225963, 'auprc': 0.32423415225963, 'loss_val': 1.90668183370819, 'psi': 0.32423415225963}-{'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 1.8164939912950013, 'psi': 0.3240909090909091}
[S13] START round=35 head_norm_before_train=1.675470 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.601084413055079, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5470529401907314, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.969610 cos_to_last_merge=0.9991 (last merge round=33)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13192612137203166, 'auprc': 0.13192612137203166, 'loss_val': 3.8870590049727793, 'psi': 0.13192612137203166}-{'f1_val': 0.11529990931467805, 'auprc': 0.11529990931467805, 'loss_val': 3.3415805407751225, 'psi': 0.11529990931467805}
[S15] START round=35 head_norm_before_train=1.994231 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5414352865059813, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5234311512125818, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.516122 cos_to_last_merge=0.9697 (last merge round=28)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.1487543973005959, 'auprc': 0.1487543973005959, 'loss_val': 2.694113218941808, 'psi': 0.1487543973005959}-{'f1_val': 0.15394456289978678, 'auprc': 0.15394456289978678, 'loss_val': 2.539001752749765, 'psi': 0.15394456289978678}
[S17] START round=35 head_norm_before_train=1.897004 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.38123496285764125, 'auprc': 0.38123496285764125, 'loss_val': 0.9948478471014712, 'psi': 0.38123496285764125}-{'f1_val': 0.39673011180732504, 'auprc': 0.39673011180732504, 'loss_val': 0.8696684756105844, 'psi': 0.39673011180732504}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.097 → S16@127.0.0.1:38516
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] ⇄ pheromone p=0.010 → S7@127.0.0.1:38508
[S14] ⇄ pheromone p=0.119 → S5@127.0.0.1:38505
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=35 metric=0.3687 head_norm=1.884654
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.710220e-01
[S9] stored merged vector for next round verification (round=35)
[S9] DEBUG after merge:  round=35 metric=0.3687 head_norm=1.871315 delta_norm=0.271022
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.008 → S17@127.0.0.1:38517
[S16] ⇄ pheromone p=0.230 → S6@127.0.0.1:38507
[S17] ⇄ pheromone p=0.180 → S9@127.0.0.1:38510
[S11] ⇄ pheromone p=0.023 → S4@127.0.0.1:38504
[S4] ⇄ pheromone p=0.012 → S11@127.0.0.1:38512
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9791
[S7] ⇄ pheromone p=0.082 → S14@127.0.0.1:38514
[S2] START round=36 head_norm_before_train=1.853827 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.078127528843571, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.0530622196712827, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.074511 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2939476061427281, 'auprc': 0.2939476061427281, 'loss_val': 4.366091973733084, 'psi': 0.2939476061427281}-{'f1_val': 0.2901185066381538, 'auprc': 0.2901185066381538, 'loss_val': 4.160369029855723, 'psi': 0.2901185066381538}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.994004 cos_to_last_merge=0.9996 (last merge round=32)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3304109844940597, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3154575625576286, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=1.781209 cos_to_last_merge=0.9696 (last merge round=28)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.481848379662711, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.421989163409868, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.732642 cos_to_last_merge=0.9550 (last merge round=30)
[S6] round=36 local utility u=0.241280 metrics={'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 5.132778007533285, 'psi': 0.025227272727272727}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.388292993796904, 'psi': 0.0}
[S7] START round=36 head_norm_before_train=1.977652 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.1917890431476144, 'psi': 0.23968964488212474}-{'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 1.1779211783563854, 'psi': 0.23946016959273855}
[S8] START round=36 head_norm_before_train=1.978743 (no previous merge yet)
[S8] round=36 local utility u=0.009587 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6201842091303577, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.639357515725958, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=1.871315 cos_to_last_merge=1.0000 (last merge round=35)
[S9] round=36 local utility u=0.031089 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.286087524583359, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.348265939224024, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=2.037521 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.3324584426946632, 'auprc': 0.3324584426946632, 'loss_val': 2.074866732746662, 'psi': 0.3324584426946632}-{'f1_val': 0.33229986485412194, 'auprc': 0.33229986485412194, 'loss_val': 2.0301365036279986, 'psi': 0.33229986485412194}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=2.005952 cos_to_last_merge=0.9987 (last merge round=32)
[S11] round=36 local utility u=0.021964 metrics={'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 1.8601390665942434, 'psi': 0.323943661971831}-{'f1_val': 0.32423415225963, 'auprc': 0.32423415225963, 'loss_val': 1.90668183370819, 'psi': 0.32423415225963}
[S13] START round=36 head_norm_before_train=1.681295 (no previous merge yet)
[S13] round=36 local utility u=0.002454 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5961765943841149, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.601084413055079, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=36 head_norm_before_train=2.004508 cos_to_last_merge=0.9966 (last merge round=33)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.318501687230193, 'psi': 0.13582554517133957}-{'f1_val': 0.13192612137203166, 'auprc': 0.13192612137203166, 'loss_val': 3.8870590049727793, 'psi': 0.13192612137203166}
[S15] START round=36 head_norm_before_train=2.012541 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5631695150657208, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5414352865059813, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.538211 cos_to_last_merge=0.9669 (last merge round=28)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.09069860279441118, 'auprc': 0.09069860279441118, 'loss_val': 3.347162873878367, 'psi': 0.09069860279441118}-{'f1_val': 0.1487543973005959, 'auprc': 0.1487543973005959, 'loss_val': 2.694113218941808, 'psi': 0.1487543973005959}
[S17] START round=36 head_norm_before_train=1.911257 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.26437804334103193, 'auprc': 0.26437804334103193, 'loss_val': 1.0243439989407341, 'psi': 0.26437804334103193}-{'f1_val': 0.38123496285764125, 'auprc': 0.38123496285764125, 'loss_val': 0.9948478471014712, 'psi': 0.38123496285764125}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.025)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:38517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.1358 head_norm=2.035712
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.354298e-01
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.1358 head_norm=1.993035 delta_norm=0.235430
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1806) from S9
[S17] cosine check vs S9: cos=0.9838
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9972
[S2] START round=37 head_norm_before_train=1.860988 (no previous merge yet)
[S2] round=37 local utility u=0.019113 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.039901429470363, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.078127528843571, 'psi': 0.2654773703336637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=37 head_norm_before_train=2.081989 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.2956300536022531, 'auprc': 0.2956300536022531, 'loss_val': 4.478719251057551, 'psi': 0.2956300536022531}-{'f1_val': 0.2939476061427281, 'auprc': 0.2939476061427281, 'loss_val': 4.366091973733084, 'psi': 0.2939476061427281}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=2.006610 cos_to_last_merge=0.9994 (last merge round=32)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3451921098851791, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3304109844940597, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=1.807289 cos_to_last_merge=0.9674 (last merge round=28)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.51869124400435, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.481848379662711, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.755134 cos_to_last_merge=0.9501 (last merge round=30)
[S6] round=37 local utility u=0.376965 metrics={'f1_val': 0.10133587786259542, 'auprc': 0.10133587786259542, 'loss_val': 5.063826392923385, 'psi': 0.10133587786259542}-{'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 5.132778007533285, 'psi': 0.025227272727272727}
[S7] START round=37 head_norm_before_train=1.989787 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 1.1906499193925508, 'psi': 0.23946016959273855}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.1917890431476144, 'psi': 0.23968964488212474}
[S8] START round=37 head_norm_before_train=1.987990 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6335090057045647, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6201842091303577, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=1.900092 cos_to_last_merge=0.9994 (last merge round=35)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4385742307136384, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.286087524583359, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=2.054471 (no previous merge yet)
[S10] round=37 local utility u=0.030227 metrics={'f1_val': 0.33143038376149697, 'auprc': 0.33143038376149697, 'loss_val': 2.0051609953650966, 'psi': 0.33143038376149697}-{'f1_val': 0.3324584426946632, 'auprc': 0.3324584426946632, 'loss_val': 2.074866732746662, 'psi': 0.3324584426946632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=37 head_norm_before_train=2.024277 cos_to_last_merge=0.9980 (last merge round=32)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 1.9065925253783924, 'psi': 0.323943661971831}-{'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 1.8601390665942434, 'psi': 0.323943661971831}
[S13] START round=37 head_norm_before_train=1.687776 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6205929183569197, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5961765943841149, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.993035 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.359485 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.599989117274503, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.318501687230193, 'psi': 0.13582554517133957}
[S15] START round=37 head_norm_before_train=2.029388 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5740372341690979, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5631695150657208, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.556621 cos_to_last_merge=0.9645 (last merge round=28)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.09013768812039706, 'auprc': 0.09013768812039706, 'loss_val': 3.684928780050306, 'psi': 0.09013768812039706}-{'f1_val': 0.09069860279441118, 'auprc': 0.09069860279441118, 'loss_val': 3.347162873878367, 'psi': 0.09069860279441118}
[S17] START round=37 head_norm_before_train=1.924680 (no previous merge yet)
[S17] round=37 local utility u=0.335100 metrics={'f1_val': 0.35268862300963033, 'auprc': 0.35268862300963033, 'loss_val': 1.148938777497224, 'psi': 0.35268862300963033}-{'f1_val': 0.26437804334103193, 'auprc': 0.26437804334103193, 'loss_val': 1.0243439989407341, 'psi': 0.26437804334103193}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S6] not sending this round → trigger blocked (psi=0.101)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1801 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.3568 head_norm=2.014592
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.828012e-02
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.3568 head_norm=2.017923 delta_norm=0.078280
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.9776
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.3527 head_norm=1.936872
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.771558e-01
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.3506 head_norm=1.910374 delta_norm=0.177156
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.867853 (no previous merge yet)
[S2] round=38 local utility u=0.038075 metrics={'f1_val': 0.26531959852086634, 'auprc': 0.26531959852086634, 'loss_val': 2.9623312172953664, 'psi': 0.26531959852086634}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.039901429470363, 'psi': 0.2654773703336637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=38 head_norm_before_train=2.089105 (no previous merge yet)
[S3] round=38 local utility u=0.019263 metrics={'f1_val': 0.29410701373825016, 'auprc': 0.29410701373825016, 'loss_val': 4.426486210540384, 'psi': 0.29410701373825016}-{'f1_val': 0.2956300536022531, 'auprc': 0.2956300536022531, 'loss_val': 4.478719251057551, 'psi': 0.2956300536022531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=38 head_norm_before_train=2.017923 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3585184470956393, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3451921098851791, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=1.826669 cos_to_last_merge=0.9654 (last merge round=28)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5547448595326188, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.51869124400435, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.773232 cos_to_last_merge=0.9464 (last merge round=30)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.0011938872970391596, 'auprc': 0.0011938872970391596, 'loss_val': 5.860603747761404, 'psi': 0.0011938872970391596}-{'f1_val': 0.10133587786259542, 'auprc': 0.10133587786259542, 'loss_val': 5.063826392923385, 'psi': 0.10133587786259542}
[S7] START round=38 head_norm_before_train=2.003117 (no previous merge yet)
[S7] round=38 local utility u=0.020831 metrics={'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 1.1489874629719128, 'psi': 0.23946016959273855}-{'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 1.1906499193925508, 'psi': 0.23946016959273855}
[S8] START round=38 head_norm_before_train=1.995556 (no previous merge yet)
[S8] round=38 local utility u=0.006096 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.621316839326399, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6335090057045647, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.929799 cos_to_last_merge=0.9979 (last merge round=35)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.576420191638826, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4385742307136384, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=2.071068 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.32692006882527763, 'auprc': 0.32692006882527763, 'loss_val': 1.986247134301323, 'psi': 0.32692006882527763}-{'f1_val': 0.33143038376149697, 'auprc': 0.33143038376149697, 'loss_val': 2.0051609953650966, 'psi': 0.33143038376149697}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=2.040520 cos_to_last_merge=0.9972 (last merge round=32)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 1.9775786025156512, 'psi': 0.3240909090909091}-{'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 1.9065925253783924, 'psi': 0.323943661971831}
[S13] START round=38 head_norm_before_train=1.696238 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6391934613847405, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6205929183569197, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=2.019621 cos_to_last_merge=0.9995 (last merge round=36)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.038203224755446, 'psi': 0.1331327566754419}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.599989117274503, 'psi': 0.13587634006482174}
[S15] START round=38 head_norm_before_train=2.045676 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.607088662668592, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5740372341690979, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.572592 cos_to_last_merge=0.9624 (last merge round=28)
[S16] round=38 local utility u=0.646362 metrics={'f1_val': 0.11805849936413734, 'auprc': 0.11805849936413734, 'loss_val': 2.6434917830589333, 'psi': 0.11805849936413734}-{'f1_val': 0.09013768812039706, 'auprc': 0.09013768812039706, 'loss_val': 3.684928780050306, 'psi': 0.09013768812039706}
[S17] START round=38 head_norm_before_train=1.910374 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.516024 metrics={'f1_val': 0.4458345513214538, 'auprc': 0.4458345513214538, 'loss_val': 0.9552033082238099, 'psi': 0.4458345513214538}-{'f1_val': 0.35268862300963033, 'auprc': 0.35268862300963033, 'loss_val': 1.148938777497224, 'psi': 0.35268862300963033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.118)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=38 metric=0.3687 head_norm=1.955128
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.265205e-01
[S9] stored merged vector for next round verification (round=38)
[S9] DEBUG after merge:  round=38 metric=0.3687 head_norm=1.932793 delta_norm=0.226520
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] cosine check vs S17: cos=0.9995
[S2] START round=39 head_norm_before_train=1.874305 (no previous merge yet)
[S2] round=39 local utility u=0.025828 metrics={'f1_val': 0.2638560546361965, 'auprc': 0.2638560546361965, 'loss_val': 2.8975040147829114, 'psi': 0.2638560546361965}-{'f1_val': 0.26531959852086634, 'auprc': 0.26531959852086634, 'loss_val': 2.9623312172953664, 'psi': 0.26531959852086634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S2] r=40 psi=0.264 u=0.0258 p_local=0.0662 f1=0.264 auprc=0.264 bytes=23411
[S3] START round=39 head_norm_before_train=2.095788 (no previous merge yet)
[S3] round=39 local utility u=0.017918 metrics={'f1_val': 0.2929156539742551, 'auprc': 0.2929156539742551, 'loss_val': 4.379928875058236, 'psi': 0.2929156539742551}-{'f1_val': 0.29410701373825016, 'auprc': 0.29410701373825016, 'loss_val': 4.426486210540384, 'psi': 0.29410701373825016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] r=40 psi=0.293 u=0.0179 p_local=0.0322 f1=0.293 auprc=0.293 bytes=19796
[S4] START round=39 head_norm_before_train=2.030353 cos_to_last_merge=0.9999 (last merge round=37)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3797821011019162, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3585184470956393, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=1.847063 cos_to_last_merge=0.9635 (last merge round=28)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.565679317302172, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5547448595326188, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.334 u=0.0000 p_local=0.0037 f1=0.334 auprc=0.334 bytes=19787
[S6] START round=39 head_norm_before_train=1.786996 cos_to_last_merge=0.9436 (last merge round=30)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=39 local utility u=0.620990 metrics={'f1_val': 0.07139926138695117, 'auprc': 0.07139926138695117, 'loss_val': 5.250472210231196, 'psi': 0.07139926138695117}-{'f1_val': 0.0011938872970391596, 'auprc': 0.0011938872970391596, 'loss_val': 5.860603747761404, 'psi': 0.0011938872970391596}
[S7] START round=39 head_norm_before_train=2.011971 (no previous merge yet)
[S7] round=39 local utility u=0.007466 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.1354320612003932, 'psi': 0.2396131805157593}-{'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 1.1489874629719128, 'psi': 0.23946016959273855}
[S8] START round=39 head_norm_before_train=2.004003 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7082932697961724, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.621316839326399, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=1.932793 cos_to_last_merge=1.0000 (last merge round=38)
[S9] round=39 local utility u=0.054882 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4666553591369316, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.576420191638826, 'psi': 0.36867172340800847}
[S10] START round=39 head_norm_before_train=2.085902 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.329004329004329, 'auprc': 0.329004329004329, 'loss_val': 2.013150041284665, 'psi': 0.329004329004329}-{'f1_val': 0.32692006882527763, 'auprc': 0.32692006882527763, 'loss_val': 1.986247134301323, 'psi': 0.32692006882527763}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.329 u=0.0000 p_local=0.0172 f1=0.329 auprc=0.329 bytes=35996
[S11] START round=39 head_norm_before_train=2.055326 cos_to_last_merge=0.9965 (last merge round=32)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 1.9902061131211963, 'psi': 0.3240172688025449}-{'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 1.9775786025156512, 'psi': 0.3240909090909091}
[S13] START round=39 head_norm_before_train=1.704523 (no previous merge yet)
[S13] round=39 local utility u=0.017367 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.604460292686805, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6391934613847405, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S13] r=40 psi=0.360 u=0.0174 p_local=0.0051 f1=0.360 auprc=0.360 bytes=12626
[S14] START round=39 head_norm_before_train=2.047543 cos_to_last_merge=0.9982 (last merge round=36)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.378329511478608, 'psi': 0.1331327566754419}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.038203224755446, 'psi': 0.1331327566754419}
[S15] START round=39 head_norm_before_train=2.061569 (no previous merge yet)
[S15] round=39 local utility u=0.010925 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5852396045043113, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.607088662668592, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S15] r=40 psi=0.616 u=0.0109 p_local=0.0078 f1=0.616 auprc=0.616 bytes=27034
[S16] START round=39 head_norm_before_train=1.587137 cos_to_last_merge=0.9607 (last merge round=28)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.11798029556650247, 'auprc': 0.11798029556650247, 'loss_val': 2.889604099136122, 'psi': 0.11798029556650247}-{'f1_val': 0.11805849936413734, 'auprc': 0.11805849936413734, 'loss_val': 2.6434917830589333, 'psi': 0.11805849936413734}
[S17] START round=39 head_norm_before_train=1.920435 cos_to_last_merge=0.9999 (last merge round=37)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.3131206920684558, 'auprc': 0.3131206920684558, 'loss_val': 1.2498276994556736, 'psi': 0.3131206920684558}-{'f1_val': 0.4458345513214538, 'auprc': 0.4458345513214538, 'loss_val': 0.9552033082238099, 'psi': 0.4458345513214538}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:38517
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.071)
[S6] r=40 psi=0.071 u=0.6210 p_local=0.2368 f1=0.071 auprc=0.071 bytes=0
[S14] r=40 psi=0.133 u=0.0000 p_local=0.0946 f1=0.133 auprc=0.133 bytes=0
[S9] sending update (kind=head size=1796 to 1 peers)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0049 f1=0.357 auprc=0.357 bytes=25190
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0060 f1=0.359 auprc=0.359 bytes=27029
[S16] r=40 psi=0.118 u=0.0000 p_local=0.1975 f1=0.118 auprc=0.118 bytes=0
[S7] r=40 psi=0.240 u=0.0075 p_local=0.0385 f1=0.240 auprc=0.240 bytes=27042
[S11] r=40 psi=0.324 u=0.0000 p_local=0.0116 f1=0.324 auprc=0.324 bytes=17985
[S17] r=40 psi=0.313 u=0.0000 p_local=0.1994 f1=0.313 auprc=0.313 bytes=21641
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=0.9980
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.3687 head_norm=1.956210
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.886343e-02
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.3687 head_norm=1.937511 delta_norm=0.058863
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] r=40 psi=0.369 u=0.0549 p_local=0.0176 f1=0.369 auprc=0.369 bytes=19797
[S2] START round=40 head_norm_before_train=1.880631 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.25721784776902884, 'auprc': 0.25721784776902884, 'loss_val': 2.869523881326133, 'psi': 0.25721784776902884}-{'f1_val': 0.2638560546361965, 'auprc': 0.2638560546361965, 'loss_val': 2.8975040147829114, 'psi': 0.2638560546361965}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.102260 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.29315315315315316, 'auprc': 0.29315315315315316, 'loss_val': 4.4144749920981114, 'psi': 0.29315315315315316}-{'f1_val': 0.2929156539742551, 'auprc': 0.2929156539742551, 'loss_val': 4.379928875058236, 'psi': 0.2929156539742551}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.043790 cos_to_last_merge=0.9998 (last merge round=37)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.401270868039955, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3797821011019162, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=1.866020 cos_to_last_merge=0.9621 (last merge round=28)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.592965317101241, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.565679317302172, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.798430 cos_to_last_merge=0.9416 (last merge round=30)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=40 local utility u=0.147040 metrics={'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 5.229228378286961, 'psi': 0.10171428571428572}-{'f1_val': 0.07139926138695117, 'auprc': 0.07139926138695117, 'loss_val': 5.250472210231196, 'psi': 0.07139926138695117}
[S7] START round=40 head_norm_before_train=2.022839 (no previous merge yet)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.23923044751150147, 'auprc': 0.23923044751150147, 'loss_val': 1.1398428335797985, 'psi': 0.23923044751150147}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.1354320612003932, 'psi': 0.2396131805157593}
[S8] START round=40 head_norm_before_train=2.013760 (no previous merge yet)
[S8] round=40 local utility u=0.011277 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6857382960826514, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7082932697961724, 'psi': 0.35939447907390915}
[S9] START round=40 head_norm_before_train=1.937511 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.028061 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4105329280860386, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4666553591369316, 'psi': 0.36867172340800847}
[S10] START round=40 head_norm_before_train=2.098839 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.3216374269005848, 'auprc': 0.3216374269005848, 'loss_val': 1.9949970513370359, 'psi': 0.3216374269005848}-{'f1_val': 0.329004329004329, 'auprc': 0.329004329004329, 'loss_val': 2.013150041284665, 'psi': 0.329004329004329}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=2.068625 cos_to_last_merge=0.9957 (last merge round=32)
[S11] round=40 local utility u=0.017945 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 1.9529918437084124, 'psi': 0.32387008857597094}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 1.9902061131211963, 'psi': 0.3240172688025449}
[S13] START round=40 head_norm_before_train=1.714186 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6140776354889157, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.604460292686805, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=2.072747 cos_to_last_merge=0.9965 (last merge round=36)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.619818558711843, 'psi': 0.13592717296421}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.378329511478608, 'psi': 0.1331327566754419}
[S15] START round=40 head_norm_before_train=2.076457 (no previous merge yet)
[S15] round=40 local utility u=0.053358 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4810275638092849, 'psi': 0.6166125814646326}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5852396045043113, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] START round=40 head_norm_before_train=1.600714 cos_to_last_merge=0.9591 (last merge round=28)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.009428805684613283, 'auprc': 0.009428805684613283, 'loss_val': 4.211712119091602, 'psi': 0.009428805684613283}-{'f1_val': 0.11798029556650247, 'auprc': 0.11798029556650247, 'loss_val': 2.889604099136122, 'psi': 0.11798029556650247}
[S17] START round=40 head_norm_before_train=1.930264 cos_to_last_merge=0.9997 (last merge round=37)
[S17] round=40 local utility u=0.018129 metrics={'f1_val': 0.297190854744747, 'auprc': 0.297190854744747, 'loss_val': 1.070202151878912, 'psi': 0.297190854744747}-{'f1_val': 0.3131206920684558, 'auprc': 0.3131206920684558, 'loss_val': 1.2498276994556736, 'psi': 0.3131206920684558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38504
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:38517
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.102)
[S6] ⇄ pheromone p=0.219 → S16@127.0.0.1:38516
[S9] sending update (kind=head size=1802 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] ⇄ pheromone p=0.004 → S11@127.0.0.1:38512
[S16] ⇄ pheromone p=0.158 → S6@127.0.0.1:38507
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.9976
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9967
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.9976
[S11] ⇄ pheromone p=0.013 → S4@127.0.0.1:38504
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.2972 head_norm=1.940684
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.885199e-02
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.2972 head_norm=1.948819 delta_norm=0.068852
[S17] aggregate: ACCEPT kept=['S9', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.163 → S9@127.0.0.1:38510
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=40 metric=0.3687 head_norm=1.962497
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.784246e-02
[S9] stored merged vector for next round verification (round=40)
[S9] DEBUG after merge:  round=40 metric=0.3687 head_norm=1.950441 delta_norm=0.067842
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.020 → S17@127.0.0.1:38517
[S2] START round=41 head_norm_before_train=1.886956 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.2521335341365462, 'auprc': 0.2521335341365462, 'loss_val': 2.867603696129021, 'psi': 0.2521335341365462}-{'f1_val': 0.25721784776902884, 'auprc': 0.25721784776902884, 'loss_val': 2.869523881326133, 'psi': 0.25721784776902884}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.108561 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.2933910377783789, 'auprc': 0.2933910377783789, 'loss_val': 4.454388780131112, 'psi': 0.2933910377783789}-{'f1_val': 0.29315315315315316, 'auprc': 0.29315315315315316, 'loss_val': 4.4144749920981114, 'psi': 0.29315315315315316}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=2.054212 cos_to_last_merge=0.9997 (last merge round=37)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4147805286478905, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.401270868039955, 'psi': 0.3567939207526687}
[S5] START round=41 head_norm_before_train=1.877944 cos_to_last_merge=0.9603 (last merge round=28)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.625009588611763, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.592965317101241, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.810621 cos_to_last_merge=0.9395 (last merge round=30)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.024795268425841673, 'auprc': 0.024795268425841673, 'loss_val': 5.596475714236632, 'psi': 0.024795268425841673}-{'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 5.229228378286961, 'psi': 0.10171428571428572}
[S7] START round=41 head_norm_before_train=2.036452 (no previous merge yet)
[S7] round=41 local utility u=0.019154 metrics={'f1_val': 0.23915381857296522, 'auprc': 0.23915381857296522, 'loss_val': 1.1008456057427174, 'psi': 0.23915381857296522}-{'f1_val': 0.23923044751150147, 'auprc': 0.23923044751150147, 'loss_val': 1.1398428335797985, 'psi': 0.23923044751150147}
[S8] START round=41 head_norm_before_train=2.021307 (no previous merge yet)
[S8] round=41 local utility u=0.039039 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.607660045059902, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6857382960826514, 'psi': 0.35939447907390915}
[S9] START round=41 head_norm_before_train=1.950441 cos_to_last_merge=1.0000 (last merge round=40)
[S9] round=41 local utility u=0.004819 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4008952433085273, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4105329280860386, 'psi': 0.36867172340800847}
[S10] START round=41 head_norm_before_train=2.110766 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.319132692014048, 'auprc': 0.319132692014048, 'loss_val': 1.992829429640161, 'psi': 0.319132692014048}-{'f1_val': 0.3216374269005848, 'auprc': 0.3216374269005848, 'loss_val': 1.9949970513370359, 'psi': 0.3216374269005848}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=2.080725 cos_to_last_merge=0.9950 (last merge round=32)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.01007050922472, 'psi': 0.323943661971831}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 1.9529918437084124, 'psi': 0.32387008857597094}
[S13] START round=41 head_norm_before_train=1.722139 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6606326572254844, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6140776354889157, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.094020 cos_to_last_merge=0.9949 (last merge round=36)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.796990423731353, 'psi': 0.13582554517133957}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.619818558711843, 'psi': 0.13592717296421}
[S15] START round=41 head_norm_before_train=2.090513 (no previous merge yet)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5573056664609356, 'psi': 0.6164734888353558}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4810275638092849, 'psi': 0.6166125814646326}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.613358 cos_to_last_merge=0.9576 (last merge round=28)
[S16] round=41 local utility u=0.701917 metrics={'f1_val': 0.08552036199095023, 'auprc': 0.08552036199095023, 'loss_val': 3.4927015265707455, 'psi': 0.08552036199095023}-{'f1_val': 0.009428805684613283, 'auprc': 0.009428805684613283, 'loss_val': 4.211712119091602, 'psi': 0.009428805684613283}
[S17] START round=41 head_norm_before_train=1.948819 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.027446 metrics={'f1_val': 0.3297665112756757, 'auprc': 0.3297665112756757, 'loss_val': 1.3084907757859332, 'psi': 0.3297665112756757}-{'f1_val': 0.297190854744747, 'auprc': 0.297190854744747, 'loss_val': 1.070202151878912, 'psi': 0.297190854744747}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[S16] not sending this round → trigger blocked (psi=0.086)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:38517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.3568 head_norm=2.064990
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.856653e-02
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.3568 head_norm=2.070979 delta_norm=0.088567
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.9995
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] cosine check vs S17: cos=0.9995
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.3298 head_norm=1.959681
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.062861e-02
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.3298 head_norm=1.966840 delta_norm=0.030629
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=41 metric=0.3687 head_norm=1.974448
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.062860e-02
[S9] stored merged vector for next round verification (round=41)
[S9] DEBUG after merge:  round=41 metric=0.3687 head_norm=1.966840 delta_norm=0.030629
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.893209 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.24871556793562366, 'auprc': 0.24871556793562366, 'loss_val': 2.87698072421877, 'psi': 0.24871556793562366}-{'f1_val': 0.2521335341365462, 'auprc': 0.2521335341365462, 'loss_val': 2.867603696129021, 'psi': 0.2521335341365462}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.114578 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.2939476061427281, 'auprc': 0.2939476061427281, 'loss_val': 4.489170064535447, 'psi': 0.2939476061427281}-{'f1_val': 0.2933910377783789, 'auprc': 0.2933910377783789, 'loss_val': 4.454388780131112, 'psi': 0.2933910377783789}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=2.070979 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4153897852985629, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4147805286478905, 'psi': 0.3567939207526687}
[S5] START round=42 head_norm_before_train=1.890243 cos_to_last_merge=0.9587 (last merge round=28)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6374484656909774, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.625009588611763, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.821356 cos_to_last_merge=0.9376 (last merge round=30)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.006379962192816635, 'auprc': 0.006379962192816635, 'loss_val': 6.156550360380885, 'psi': 0.006379962192816635}-{'f1_val': 0.024795268425841673, 'auprc': 0.024795268425841673, 'loss_val': 5.596475714236632, 'psi': 0.024795268425841673}
[S7] START round=42 head_norm_before_train=2.049942 (no previous merge yet)
[S7] round=42 local utility u=0.015151 metrics={'f1_val': 0.23884702786748, 'auprc': 0.23884702786748, 'loss_val': 1.0677828155163234, 'psi': 0.23884702786748}-{'f1_val': 0.23915381857296522, 'auprc': 0.23915381857296522, 'loss_val': 1.1008456057427174, 'psi': 0.23915381857296522}
[S8] START round=42 head_norm_before_train=2.027465 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6476464253570243, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.607660045059902, 'psi': 0.35939447907390915}
[S9] START round=42 head_norm_before_train=1.966840 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4338182637412693, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4008952433085273, 'psi': 0.36867172340800847}
[S10] START round=42 head_norm_before_train=2.122707 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.3194985859512344, 'auprc': 0.3194985859512344, 'loss_val': 2.011038475378787, 'psi': 0.3194985859512344}-{'f1_val': 0.319132692014048, 'auprc': 0.319132692014048, 'loss_val': 1.992829429640161, 'psi': 0.319132692014048}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=2.091685 cos_to_last_merge=0.9944 (last merge round=32)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.077217788586901, 'psi': 0.3240172688025449}-{'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.01007050922472, 'psi': 0.323943661971831}
[S13] START round=42 head_norm_before_train=1.728201 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6729494076059, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6606326572254844, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=2.112014 cos_to_last_merge=0.9934 (last merge round=36)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.932636269166944, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.796990423731353, 'psi': 0.13582554517133957}
[S15] START round=42 head_norm_before_train=2.104572 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.574803077775775, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5573056664609356, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.625553 cos_to_last_merge=0.9562 (last merge round=28)
[S16] round=42 local utility u=0.493963 metrics={'f1_val': 0.14823965410747375, 'auprc': 0.14823965410747375, 'loss_val': 3.0692497700205625, 'psi': 0.14823965410747375}-{'f1_val': 0.08552036199095023, 'auprc': 0.08552036199095023, 'loss_val': 3.4927015265707455, 'psi': 0.08552036199095023}
[S17] START round=42 head_norm_before_train=1.966840 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=0.445081 metrics={'f1_val': 0.41652511160473904, 'auprc': 0.41652511160473904, 'loss_val': 1.1991555504432656, 'psi': 0.41652511160473904}-{'f1_val': 0.3297665112756757, 'auprc': 0.3297665112756757, 'loss_val': 1.3084907757859332, 'psi': 0.3297665112756757}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.148)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] cosine check vs S17: cos=0.9996
[S2] START round=43 head_norm_before_train=1.899313 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.2467907376696763, 'auprc': 0.2467907376696763, 'loss_val': 2.889391283354238, 'psi': 0.2467907376696763}-{'f1_val': 0.24871556793562366, 'auprc': 0.24871556793562366, 'loss_val': 2.87698072421877, 'psi': 0.24871556793562366}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.120707 (no previous merge yet)
[S3] round=43 local utility u=0.000369 metrics={'f1_val': 0.2933910377783789, 'auprc': 0.2933910377783789, 'loss_val': 4.48342291489215, 'psi': 0.2933910377783789}-{'f1_val': 0.2939476061427281, 'auprc': 0.2939476061427281, 'loss_val': 4.489170064535447, 'psi': 0.2939476061427281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=43 head_norm_before_train=2.079278 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4333766632973437, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4153897852985629, 'psi': 0.3567939207526687}
[S5] START round=43 head_norm_before_train=1.905036 cos_to_last_merge=0.9575 (last merge round=28)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6455487312762265, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6374484656909774, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.832456 cos_to_last_merge=0.9357 (last merge round=30)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=43 local utility u=0.251616 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.7936096826861, 'psi': 0.021967963386727688}-{'f1_val': 0.006379962192816635, 'auprc': 0.006379962192816635, 'loss_val': 6.156550360380885, 'psi': 0.006379962192816635}
[S7] START round=43 head_norm_before_train=2.061443 (no previous merge yet)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.18564771668219945, 'auprc': 0.18564771668219945, 'loss_val': 0.9587400320984819, 'psi': 0.18564771668219945}-{'f1_val': 0.23884702786748, 'auprc': 0.23884702786748, 'loss_val': 1.0677828155163234, 'psi': 0.23884702786748}
[S8] START round=43 head_norm_before_train=2.031612 (no previous merge yet)
[S8] round=43 local utility u=0.028812 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5900220520637295, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6476464253570243, 'psi': 0.35939447907390915}
[S9] START round=43 head_norm_before_train=1.990381 cos_to_last_merge=0.9997 (last merge round=41)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4957520792880334, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4338182637412693, 'psi': 0.36867172340800847}
[S10] START round=43 head_norm_before_train=2.134032 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.3177499049790954, 'auprc': 0.3177499049790954, 'loss_val': 2.01874938319481, 'psi': 0.3177499049790954}-{'f1_val': 0.3194985859512344, 'auprc': 0.3194985859512344, 'loss_val': 2.011038475378787, 'psi': 0.3194985859512344}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=2.101690 cos_to_last_merge=0.9938 (last merge round=32)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.105922898939248, 'psi': 0.3240909090909091}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.077217788586901, 'psi': 0.3240172688025449}
[S13] START round=43 head_norm_before_train=1.732823 (no previous merge yet)
[S13] round=43 local utility u=0.010593 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6517625142705765, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6729494076059, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=43 head_norm_before_train=2.127134 cos_to_last_merge=0.9921 (last merge round=36)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.043196495376123, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.932636269166944, 'psi': 0.13582554517133957}
[S15] START round=43 head_norm_before_train=2.116366 (no previous merge yet)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6167095449771098, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.574803077775775, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.637289 cos_to_last_merge=0.9548 (last merge round=28)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.12774030354131535, 'auprc': 0.12774030354131535, 'loss_val': 3.121112227933415, 'psi': 0.12774030354131535}-{'f1_val': 0.14823965410747375, 'auprc': 0.14823965410747375, 'loss_val': 3.0692497700205625, 'psi': 0.14823965410747375}
[S17] START round=43 head_norm_before_train=1.978336 cos_to_last_merge=0.9999 (last merge round=41)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.41186609806046076, 'auprc': 0.41186609806046076, 'loss_val': 1.2730180283245418, 'psi': 0.41186609806046076}-{'f1_val': 0.41652511160473904, 'auprc': 0.41652511160473904, 'loss_val': 1.1991555504432656, 'psi': 0.41652511160473904}
[S14]  timeout peer S5
[S7]  timeout peer S14
[S8]  timeout peer S7
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.022)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=43 metric=0.3687 head_norm=2.010930
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.984795e-02
[S9] stored merged vector for next round verification (round=43)
[S9] DEBUG after merge:  round=43 metric=0.3687 head_norm=1.994077 delta_norm=0.049848
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.905233 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.24638214373313713, 'auprc': 0.24638214373313713, 'loss_val': 2.9019571284713854, 'psi': 0.24638214373313716}-{'f1_val': 0.2467907376696763, 'auprc': 0.2467907376696763, 'loss_val': 2.889391283354238, 'psi': 0.2467907376696763}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.126560 (no previous merge yet)
[S3] round=44 local utility u=0.011727 metrics={'f1_val': 0.2929156539742551, 'auprc': 0.2929156539742551, 'loss_val': 4.455690414741364, 'psi': 0.2929156539742551}-{'f1_val': 0.2933910377783789, 'auprc': 0.2933910377783789, 'loss_val': 4.48342291489215, 'psi': 0.2933910377783789}
[S3] not sending this round → trigger blocked (psi=0.293)
[S4] START round=44 head_norm_before_train=2.085637 cos_to_last_merge=0.9998 (last merge round=41)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4457716770618816, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4333766632973437, 'psi': 0.3567939207526687}
[S5] START round=44 head_norm_before_train=1.920460 cos_to_last_merge=0.9565 (last merge round=28)
[S5] round=44 local utility u=0.001756 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.642036448161946, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6455487312762265, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=44 head_norm_before_train=1.842960 cos_to_last_merge=0.9340 (last merge round=30)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 6.081232285788863, 'psi': 0.02109124254928932}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.7936096826861, 'psi': 0.021967963386727688}
[S7] START round=44 head_norm_before_train=2.071152 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.18372993912562258, 'auprc': 0.18372993912562258, 'loss_val': 1.0024141225963248, 'psi': 0.18372993912562258}-{'f1_val': 0.18564771668219945, 'auprc': 0.18564771668219945, 'loss_val': 0.9587400320984819, 'psi': 0.18564771668219945}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=2.035895 (no previous merge yet)
[S8] round=44 local utility u=0.022714 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5445940200184858, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5900220520637295, 'psi': 0.35939447907390915}
[S8] not sending this round → trigger blocked (psi=0.359)
[S9] START round=44 head_norm_before_train=1.994077 cos_to_last_merge=1.0000 (last merge round=43)
[S9] round=44 local utility u=0.012245 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4712617235352288, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4957520792880334, 'psi': 0.36867172340800847}
[S10] START round=44 head_norm_before_train=2.144976 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.31717125730328555, 'auprc': 0.31717125730328555, 'loss_val': 2.0310968543885615, 'psi': 0.31717125730328555}-{'f1_val': 0.3177499049790954, 'auprc': 0.3177499049790954, 'loss_val': 2.01874938319481, 'psi': 0.3177499049790954}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.110832 cos_to_last_merge=0.9932 (last merge round=32)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.1164055575092124, 'psi': 0.323943661971831}-{'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.105922898939248, 'psi': 0.3240909090909091}
[S13] START round=44 head_norm_before_train=1.739115 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6739435844869222, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6517625142705765, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.140023 cos_to_last_merge=0.9910 (last merge round=36)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.135435041769518, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.043196495376123, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.126500 (no previous merge yet)
[S15] round=44 local utility u=0.006589 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6035314701306586, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6167095449771098, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=44 head_norm_before_train=1.648463 cos_to_last_merge=0.9535 (last merge round=28)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.07755150367037651, 'auprc': 0.07755150367037651, 'loss_val': 3.4358965497804923, 'psi': 0.07755150367037651}-{'f1_val': 0.12774030354131535, 'auprc': 0.12774030354131535, 'loss_val': 3.121112227933415, 'psi': 0.12774030354131535}
[S17] START round=44 head_norm_before_train=1.988206 cos_to_last_merge=0.9998 (last merge round=41)
[S17] round=44 local utility u=0.156475 metrics={'f1_val': 0.43888716346602946, 'auprc': 0.43888716346602946, 'loss_val': 1.2032582578285305, 'psi': 0.43888716346602946}-{'f1_val': 0.41186609806046076, 'auprc': 0.41186609806046076, 'loss_val': 1.2730180283245418, 'psi': 0.41186609806046076}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:38517
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:38510
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] cosine check vs S9: cos=0.9987
[S9] RECEIVED delta(kind=head bytes=1796) from S17
[S9] cosine check vs S17: cos=0.9987
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=44 metric=0.3687 head_norm=2.012352
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.072062e-02
[S9] stored merged vector for next round verification (round=44)
[S9] DEBUG after merge:  round=44 metric=0.3687 head_norm=2.004193 delta_norm=0.050721
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=44 metric=0.4389 head_norm=1.997289
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.072062e-02
[S17] stored merged vector for next round verification (round=44)
[S17] DEBUG after merge:  round=44 metric=0.4389 head_norm=2.004193 delta_norm=0.050721
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.911095 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.24624624624624625, 'auprc': 0.24624624624624625, 'loss_val': 2.9139236990830697, 'psi': 0.24624624624624625}-{'f1_val': 0.24638214373313713, 'auprc': 0.24638214373313713, 'loss_val': 2.9019571284713854, 'psi': 0.24638214373313716}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.132174 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.29307394397910475, 'auprc': 0.29307394397910475, 'loss_val': 4.479771416929933, 'psi': 0.29307394397910475}-{'f1_val': 0.2929156539742551, 'auprc': 0.2929156539742551, 'loss_val': 4.455690414741364, 'psi': 0.2929156539742551}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.091771 cos_to_last_merge=0.9997 (last merge round=41)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.45494136499083, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4457716770618816, 'psi': 0.3567939207526687}
[S5] START round=45 head_norm_before_train=1.933778 cos_to_last_merge=0.9558 (last merge round=28)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6570027554709874, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.642036448161946, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.852983 cos_to_last_merge=0.9324 (last merge round=30)
[S6] ⚠️ Model drifted since last merge! cos=0.932
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.188889483123501, 'psi': 0.017774699907663897}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 6.081232285788863, 'psi': 0.02109124254928932}
[S7] START round=45 head_norm_before_train=2.078388 (no previous merge yet)
[S7] round=45 local utility u=0.067543 metrics={'f1_val': 0.18831168831168832, 'auprc': 0.18831168831168832, 'loss_val': 0.9085636751658639, 'psi': 0.18831168831168832}-{'f1_val': 0.18372993912562258, 'auprc': 0.18372993912562258, 'loss_val': 1.0024141225963248, 'psi': 0.18372993912562258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=45 head_norm_before_train=2.041842 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5611842402621041, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5445940200184858, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.004193 cos_to_last_merge=1.0000 (last merge round=44)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.480289955509545, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4712617235352288, 'psi': 0.36867172340800847}
[S10] START round=45 head_norm_before_train=2.155164 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.3143093465674111, 'auprc': 0.3143093465674111, 'loss_val': 2.026627324763968, 'psi': 0.3143093465674111}-{'f1_val': 0.31717125730328555, 'auprc': 0.31717125730328555, 'loss_val': 2.0310968543885615, 'psi': 0.31717125730328555}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.119448 cos_to_last_merge=0.9927 (last merge round=32)
[S11] round=45 local utility u=0.001711 metrics={'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.1129829676644296, 'psi': 0.323943661971831}-{'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.1164055575092124, 'psi': 0.323943661971831}
[S13] START round=45 head_norm_before_train=1.747808 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.728989063709791, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6739435844869222, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.151281 cos_to_last_merge=0.9900 (last merge round=36)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.211525219093206, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.135435041769518, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.134595 (no previous merge yet)
[S15] round=45 local utility u=0.071050 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.46393559371541276, 'psi': 0.6166125814646326}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6035314701306586, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=45 head_norm_before_train=1.657834 cos_to_last_merge=0.9523 (last merge round=28)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.06910569105691057, 'auprc': 0.06910569105691057, 'loss_val': 3.5982130022604872, 'psi': 0.06910569105691057}-{'f1_val': 0.07755150367037651, 'auprc': 0.07755150367037651, 'loss_val': 3.4358965497804923, 'psi': 0.07755150367037651}
[S17] START round=45 head_norm_before_train=2.004193 cos_to_last_merge=1.0000 (last merge round=44)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.2932329551205825, 'auprc': 0.2932329551205825, 'loss_val': 1.2146313102500337, 'psi': 0.2932329551205825}-{'f1_val': 0.43888716346602946, 'auprc': 0.43888716346602946, 'loss_val': 1.2032582578285305, 'psi': 0.43888716346602946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38504
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.001 → S11@127.0.0.1:38512
[S17] ⇄ pheromone p=0.126 → S9@127.0.0.1:38510
[S16] ⇄ pheromone p=0.160 → S6@127.0.0.1:38507
[S6] ⇄ pheromone p=0.104 → S16@127.0.0.1:38516
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] ⇄ pheromone p=0.009 → S17@127.0.0.1:38517
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9969
[S11] ⇄ pheromone p=0.005 → S4@127.0.0.1:38504
[S2] START round=46 head_norm_before_train=1.916858 (no previous merge yet)
[S2] round=46 local utility u=0.003081 metrics={'f1_val': 0.24742902888108875, 'auprc': 0.24742902888108875, 'loss_val': 2.9184074799974025, 'psi': 0.24742902888108875}-{'f1_val': 0.24624624624624625, 'auprc': 0.24624624624624625, 'loss_val': 2.9139236990830697, 'psi': 0.24624624624624625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=46 head_norm_before_train=2.137781 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.29299477759769493, 'auprc': 0.29299477759769493, 'loss_val': 4.486698025779759, 'psi': 0.29299477759769493}-{'f1_val': 0.29307394397910475, 'auprc': 0.29307394397910475, 'loss_val': 4.479771416929933, 'psi': 0.29307394397910475}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.098017 cos_to_last_merge=0.9995 (last merge round=41)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4716541531405523, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.45494136499083, 'psi': 0.3567939207526687}
[S5] START round=46 head_norm_before_train=1.943355 cos_to_last_merge=0.9545 (last merge round=28)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6673256336110653, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6570027554709874, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.862674 cos_to_last_merge=0.9309 (last merge round=30)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=46 local utility u=0.115684 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.995260481113461, 'psi': 0.021967963386727688}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.188889483123501, 'psi': 0.017774699907663897}
[S7] START round=46 head_norm_before_train=2.088603 (no previous merge yet)
[S7] round=46 local utility u=0.119642 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.1323684502272013, 'psi': 0.23976608187134504}-{'f1_val': 0.18831168831168832, 'auprc': 0.18831168831168832, 'loss_val': 0.9085636751658639, 'psi': 0.18831168831168832}
[S7] not sending this round → trigger blocked (psi=0.240)
[S8] START round=46 head_norm_before_train=2.046938 (no previous merge yet)
[S8] round=46 local utility u=0.009393 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5423983118572244, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5611842402621041, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=46 head_norm_before_train=2.021697 cos_to_last_merge=0.9999 (last merge round=44)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.521757788384358, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.480289955509545, 'psi': 0.36867172340800847}
[S10] START round=46 head_norm_before_train=2.165360 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.31310861423220976, 'auprc': 0.31310861423220976, 'loss_val': 2.023078128754066, 'psi': 0.31310861423220976}-{'f1_val': 0.3143093465674111, 'auprc': 0.3143093465674111, 'loss_val': 2.026627324763968, 'psi': 0.3143093465674111}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.127804 cos_to_last_merge=0.9921 (last merge round=32)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.1228391082219766, 'psi': 0.323943661971831}-{'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.1129829676644296, 'psi': 0.323943661971831}
[S13] START round=46 head_norm_before_train=1.754697 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7453588233904387, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.728989063709791, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.161383 cos_to_last_merge=0.9892 (last merge round=36)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.278523155089242, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.211525219093206, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.143917 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5865604257187822, 'psi': 0.6164734888353558}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.46393559371541276, 'psi': 0.6166125814646326}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.667350 cos_to_last_merge=0.9512 (last merge round=28)
[S16] round=46 local utility u=0.124694 metrics={'f1_val': 0.08544158233670653, 'auprc': 0.08544158233670653, 'loss_val': 3.495847903059216, 'psi': 0.08544158233670653}-{'f1_val': 0.06910569105691057, 'auprc': 0.06910569105691057, 'loss_val': 3.5982130022604872, 'psi': 0.06910569105691057}
[S17] START round=46 head_norm_before_train=2.015640 cos_to_last_merge=0.9999 (last merge round=44)
[S17] round=46 local utility u=0.159387 metrics={'f1_val': 0.3230653971069682, 'auprc': 0.3230653971069682, 'loss_val': 1.1643496367235908, 'psi': 0.3230653971069682}-{'f1_val': 0.2932329551205825, 'auprc': 0.2932329551205825, 'loss_val': 1.2146313102500337, 'psi': 0.2932329551205825}
[S16] not sending this round → trigger blocked (psi=0.085)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=46 metric=0.3568 head_norm=2.104071
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.713262e-02
[S4] stored merged vector for next round verification (round=46)
[S4] DEBUG after merge:  round=46 metric=0.3568 head_norm=2.114176 delta_norm=0.087133
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.9990
[S2] START round=47 head_norm_before_train=1.922314 (no previous merge yet)
[S2] round=47 local utility u=0.009200 metrics={'f1_val': 0.25020237872843887, 'auprc': 0.25020237872843887, 'loss_val': 2.924967731360952, 'psi': 0.25020237872843887}-{'f1_val': 0.24742902888108875, 'auprc': 0.24742902888108875, 'loss_val': 2.9184074799974025, 'psi': 0.24742902888108875}
[S2] not sending this round → trigger blocked (psi=0.250)
[S3] START round=47 head_norm_before_train=2.143107 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.2929156539742551, 'auprc': 0.2929156539742551, 'loss_val': 4.492831532425474, 'psi': 0.2929156539742551}-{'f1_val': 0.29299477759769493, 'auprc': 0.29299477759769493, 'loss_val': 4.486698025779759, 'psi': 0.29299477759769493}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.114176 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.479734523915152, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4716541531405523, 'psi': 0.3567939207526687}
[S5] START round=47 head_norm_before_train=1.949006 cos_to_last_merge=0.9532 (last merge round=28)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.672618123554849, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6673256336110653, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.872437 cos_to_last_merge=0.9293 (last merge round=30)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.136421784100379, 'psi': 0.021749084249084248}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.995260481113461, 'psi': 0.021967963386727688}
[S7] START round=47 head_norm_before_train=2.093488 (no previous merge yet)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 1.1742994776231113, 'psi': 0.23946016959273855}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.1323684502272013, 'psi': 0.23976608187134504}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.051022 (no previous merge yet)
[S8] round=47 local utility u=0.010068 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5222626171137124, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5423983118572244, 'psi': 0.35939447907390915}
[S8] not sending this round → trigger blocked (psi=0.359)
[S9] START round=47 head_norm_before_train=2.038169 cos_to_last_merge=0.9996 (last merge round=44)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5602465013101745, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.521757788384358, 'psi': 0.36867172340800847}
[S10] START round=47 head_norm_before_train=2.175117 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.31310861423220976, 'auprc': 0.31310861423220976, 'loss_val': 2.0382183263905453, 'psi': 0.31310861423220976}-{'f1_val': 0.31310861423220976, 'auprc': 0.31310861423220976, 'loss_val': 2.023078128754066, 'psi': 0.31310861423220976}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.135894 cos_to_last_merge=0.9916 (last merge round=32)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.1722742771684027, 'psi': 0.323943661971831}-{'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.1228391082219766, 'psi': 0.323943661971831}
[S13] START round=47 head_norm_before_train=1.761602 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7599977841411683, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7453588233904387, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.170558 cos_to_last_merge=0.9884 (last merge round=36)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.339084084139753, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.278523155089242, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.152064 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6071214124523038, 'psi': 0.6161950003225232}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5865604257187822, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.676791 cos_to_last_merge=0.9501 (last merge round=28)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.09317115827967247, 'auprc': 0.09317115827967247, 'loss_val': 3.8113953694580744, 'psi': 0.09317115827967247}-{'f1_val': 0.08544158233670653, 'auprc': 0.08544158233670653, 'loss_val': 3.495847903059216, 'psi': 0.08544158233670653}
[S17] START round=47 head_norm_before_train=2.029938 cos_to_last_merge=0.9995 (last merge round=44)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.3444460243497071, 'auprc': 0.3444460243497071, 'loss_val': 1.5361733211107527, 'psi': 0.3444460243497071}-{'f1_val': 0.3230653971069682, 'auprc': 0.3230653971069682, 'loss_val': 1.1643496367235908, 'psi': 0.3230653971069682}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=47 metric=0.3687 head_norm=2.052908
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.687262e-02
[S9] stored merged vector for next round verification (round=47)
[S9] DEBUG after merge:  round=47 metric=0.3687 head_norm=2.040663 delta_norm=0.056873
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.927535 (no previous merge yet)
[S2] round=48 local utility u=0.010880 metrics={'f1_val': 0.2537096672349561, 'auprc': 0.2537096672349561, 'loss_val': 2.9347731012023814, 'psi': 0.2537096672349561}-{'f1_val': 0.25020237872843887, 'auprc': 0.25020237872843887, 'loss_val': 2.924967731360952, 'psi': 0.25020237872843887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=48 head_norm_before_train=2.148423 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.29283657307415406, 'auprc': 0.29283657307415406, 'loss_val': 4.499934695999318, 'psi': 0.29283657307415406}-{'f1_val': 0.2929156539742551, 'auprc': 0.2929156539742551, 'loss_val': 4.492831532425474, 'psi': 0.2929156539742551}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.121217 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4889302114041143, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.479734523915152, 'psi': 0.3567939207526687}
[S5] START round=48 head_norm_before_train=1.958478 cos_to_last_merge=0.9525 (last merge round=28)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6752613137247243, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.672618123554849, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.881401 cos_to_last_merge=0.9279 (last merge round=30)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 6.290876561851933, 'psi': 0.018663594470046084}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.136421784100379, 'psi': 0.021749084249084248}
[S7] START round=48 head_norm_before_train=2.096254 (no previous merge yet)
[S7] round=48 local utility u=0.009966 metrics={'f1_val': 0.23923044751150147, 'auprc': 0.23923044751150147, 'loss_val': 1.1522999716703641, 'psi': 0.23923044751150147}-{'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 1.1742994776231113, 'psi': 0.23946016959273855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=48 head_norm_before_train=2.058384 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5494736024464126, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5222626171137124, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.040663 cos_to_last_merge=1.0000 (last merge round=47)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5684535025442203, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5602465013101745, 'psi': 0.36867172340800847}
[S10] START round=48 head_norm_before_train=2.184269 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.31310861423220976, 'auprc': 0.31310861423220976, 'loss_val': 2.0539476074347975, 'psi': 0.31310861423220976}-{'f1_val': 0.31310861423220976, 'auprc': 0.31310861423220976, 'loss_val': 2.0382183263905453, 'psi': 0.31310861423220976}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=2.143513 cos_to_last_merge=0.9911 (last merge round=32)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.1999721713459595, 'psi': 0.323943661971831}-{'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.1722742771684027, 'psi': 0.323943661971831}
[S13] START round=48 head_norm_before_train=1.771819 (no previous merge yet)
[S13] round=48 local utility u=0.025992 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7080141739922885, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7599977841411683, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=48 head_norm_before_train=2.178928 cos_to_last_merge=0.9876 (last merge round=36)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.396060835166245, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.339084084139753, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.160669 (no previous merge yet)
[S15] round=48 local utility u=0.003506 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6013639914015949, 'psi': 0.6163342951580373}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6071214124523038, 'psi': 0.6161950003225232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=48 head_norm_before_train=1.684480 cos_to_last_merge=0.9491 (last merge round=28)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=48 local utility u=0.249171 metrics={'f1_val': 0.1265348906858341, 'auprc': 0.1265348906858341, 'loss_val': 3.6133278135036058, 'psi': 0.1265348906858341}-{'f1_val': 0.09317115827967247, 'auprc': 0.09317115827967247, 'loss_val': 3.8113953694580744, 'psi': 0.09317115827967247}
[S17] START round=48 head_norm_before_train=2.045443 cos_to_last_merge=0.9991 (last merge round=44)
[S17] round=48 local utility u=0.013445 metrics={'f1_val': 0.32464658348348313, 'auprc': 0.32464658348348313, 'loss_val': 1.3310878523211231, 'psi': 0.32464658348348313}-{'f1_val': 0.3444460243497071, 'auprc': 0.3444460243497071, 'loss_val': 1.5361733211107527, 'psi': 0.3444460243497071}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.127)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] cosine check vs S17: cos=0.9988
[S2] START round=49 head_norm_before_train=1.932623 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.2539501959297181, 'auprc': 0.2539501959297181, 'loss_val': 2.9437936587230293, 'psi': 0.2539501959297181}-{'f1_val': 0.2537096672349561, 'auprc': 0.2537096672349561, 'loss_val': 2.9347731012023814, 'psi': 0.2537096672349561}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.153411 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.29283657307415406, 'auprc': 0.29283657307415406, 'loss_val': 4.512788221540629, 'psi': 0.29283657307415406}-{'f1_val': 0.29283657307415406, 'auprc': 0.29283657307415406, 'loss_val': 4.499934695999318, 'psi': 0.29283657307415406}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.129000 cos_to_last_merge=0.9999 (last merge round=46)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5064426357222982, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4889302114041143, 'psi': 0.3567939207526687}
[S5] START round=49 head_norm_before_train=1.971412 cos_to_last_merge=0.9516 (last merge round=28)
[S5] round=49 local utility u=0.012730 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.649801585738703, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6752613137247243, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=49 head_norm_before_train=1.889825 cos_to_last_merge=0.9265 (last merge round=30)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.357812758000856, 'psi': 0.017774699907663897}-{'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 6.290876561851933, 'psi': 0.018663594470046084}
[S7] START round=49 head_norm_before_train=2.105716 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.23846291973424313, 'auprc': 0.23846291973424313, 'loss_val': 1.1718891011798385, 'psi': 0.23846291973424316}-{'f1_val': 0.23923044751150147, 'auprc': 0.23923044751150147, 'loss_val': 1.1522999716703641, 'psi': 0.23923044751150147}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.065868 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5657640934235787, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5494736024464126, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.054348 cos_to_last_merge=0.9999 (last merge round=47)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5995464898487786, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5684535025442203, 'psi': 0.36867172340800847}
[S10] START round=49 head_norm_before_train=2.193188 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.31254673246597875, 'auprc': 0.31254673246597875, 'loss_val': 2.063284748907839, 'psi': 0.31254673246597875}-{'f1_val': 0.31310861423220976, 'auprc': 0.31310861423220976, 'loss_val': 2.0539476074347975, 'psi': 0.31310861423220976}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.150802 cos_to_last_merge=0.9906 (last merge round=32)
[S11] round=49 local utility u=0.000129 metrics={'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.1997135583917213, 'psi': 0.323943661971831}-{'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 2.1999721713459595, 'psi': 0.323943661971831}
[S13] START round=49 head_norm_before_train=1.781537 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7119768026173894, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7080141739922885, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.186609 cos_to_last_merge=0.9869 (last merge round=36)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.446707734926984, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.396060835166245, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.170798 (no previous merge yet)
[S15] round=49 local utility u=0.010818 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.580980505879538, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6013639914015949, 'psi': 0.6163342951580373}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=49 head_norm_before_train=1.692731 cos_to_last_merge=0.9481 (last merge round=28)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=49 local utility u=0.172458 metrics={'f1_val': 0.13944310458232842, 'auprc': 0.13944310458232842, 'loss_val': 3.3845851345163616, 'psi': 0.13944310458232842}-{'f1_val': 0.1265348906858341, 'auprc': 0.1265348906858341, 'loss_val': 3.6133278135036058, 'psi': 0.1265348906858341}
[S17] START round=49 head_norm_before_train=2.058578 cos_to_last_merge=0.9988 (last merge round=44)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.33662300208803453, 'auprc': 0.33662300208803453, 'loss_val': 1.746104113839605, 'psi': 0.33662300208803453}-{'f1_val': 0.32464658348348313, 'auprc': 0.32464658348348313, 'loss_val': 1.3310878523211231, 'psi': 0.32464658348348313}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.139)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:38504
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=49 metric=0.3687 head_norm=2.067245
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.831490e-02
[S9] stored merged vector for next round verification (round=49)
[S9] DEBUG after merge:  round=49 metric=0.3687 head_norm=2.062092 delta_norm=0.058315
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=0.9980
[runner] rounds complete.
[runner] all agents stopped.
