[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:58303
[S3] → join 127.0.0.1:58302
[S4] → join 127.0.0.1:58302
[S5] → join 127.0.0.1:58302
[S6] → join 127.0.0.1:58302
[S7] → join 127.0.0.1:58302
[S8] → join 127.0.0.1:58302
[S9] → join 127.0.0.1:58302
[S10] → join 127.0.0.1:58302
[S11] → join 127.0.0.1:58302
[S13] → join 127.0.0.1:58302
[S14] → join 127.0.0.1:58302
[S15] → join 127.0.0.1:58302
[S16] → join 127.0.0.1:58302
[S17] → join 127.0.0.1:58302
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.192554 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.192056 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.200633 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.152122 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.206404 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.117998 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.185250 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.186906 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.164504 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.180405 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.122755 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.123877 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.166919 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.170027 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.199609 (no previous merge yet)
[S6]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3] + discovered S17
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S15
[S3] + discovered S9
[S3] + discovered S11
[S3] + discovered S10
[S3] + discovered S8
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S16
[S3] + discovered S6
[S3] + discovered S4
[S3] + discovered S7
[S3] + discovered S14
[S4] + discovered S16
[S4] + discovered S9
[S5] + discovered S3
[S4] + discovered S6
[S4] + discovered S5
[S5] + discovered S2
[S4] + discovered S11
[S4] + discovered S15
[S4] + discovered S10
[S4] + discovered S8
[S5] + discovered S4
[S4] + discovered S7
[S4] + discovered S13
[S4] + discovered S17
[S4] + discovered S14
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S5
[S6] + discovered S4
[S5] + discovered S10
[S5] + discovered S13
[S5] + discovered S11
[S5] + discovered S7
[S5] + discovered S14
[S5] + discovered S8
[S5] + discovered S9
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S15
[S5] + discovered S16
[S6] + discovered S14
[S6] + discovered S8
[S6] + discovered S15
[S6] + discovered S17
[S6] + discovered S16
[S6] + discovered S10
[S6] + discovered S11
[S6] + discovered S7
[S6] + discovered S9
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S3
[S7] + discovered S5
[S6] + discovered S13
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S13
[S7] + discovered S16
[S8] + discovered S5
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S6
[S8] + discovered S4
[S8] + discovered S2
[S7] + discovered S9
[S7] + discovered S11
[S7] + discovered S10
[S7] + discovered S17
[S7] + discovered S15
[S9] + discovered S5
[S9] + discovered S7
[S9] + discovered S4
[S9] + discovered S8
[S9] + discovered S2
[S9] + discovered S3
[S9] + discovered S6
[S8] + discovered S10
[S8] + discovered S9
[S8] + discovered S16
[S8] + discovered S13
[S8] + discovered S17
[S8] + discovered S11
[S8] + discovered S15
[S8] + discovered S14
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S9
[S10] + discovered S5
[S10] + discovered S6
[S9] + discovered S17
[S9] + discovered S11
[S9] + discovered S10
[S9] + discovered S15
[S9] + discovered S14
[S9] + discovered S13
[S9] + discovered S16
[S11] + discovered S6
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S4
[S11] + discovered S10
[S11] + discovered S2
[S11] + discovered S3
[S11] + discovered S7
[S11] + discovered S8
[S10] + discovered S13
[S10] + discovered S14
[S10] + discovered S15
[S10] + discovered S17
[S10] + discovered S16
[S10] + discovered S11
[S13] + discovered S6
[S13] + discovered S7
[S13] + discovered S2
[S13] + discovered S8
[S13] + discovered S4
[S13] + discovered S9
[S11] + discovered S17
[S13] + discovered S11
[S13] + discovered S3
[S13] + discovered S10
[S11] + discovered S16
[S11] + discovered S15
[S11] + discovered S13
[S13] + discovered S5
[S11] + discovered S14
[S14] + discovered S8
[S14] + discovered S11
[S14] + discovered S5
[S14] + discovered S2
[S14] + discovered S7
[S14] + discovered S10
[S14] + discovered S3
[S14] + discovered S13
[S14] + discovered S9
[S14] + discovered S4
[S14] + discovered S6
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S16
[S15] + discovered S8
[S15] + discovered S6
[S15] + discovered S9
[S15] + discovered S4
[S15] + discovered S13
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S7
[S15] + discovered S10
[S15] + discovered S2
[S15] + discovered S5
[S15] + discovered S11
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S16] + discovered S5
[S16] + discovered S2
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S9
[S16] + discovered S8
[S16] + discovered S11
[S16] + discovered S14
[S16] + discovered S15
[S16] + discovered S7
[S16] + discovered S10
[S16] + discovered S4
[S16] + discovered S6
[S15] + discovered S17
[S15] + discovered S16
[S17] + discovered S10
[S17] + discovered S9
[S17] + discovered S6
[S17] + discovered S5
[S16] + discovered S17
[S17] + discovered S4
[S17] + discovered S7
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S3
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S2
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:58307
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:58314
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:58314
[S8] ⇄ pheromone p=1.000 → S7@127.0.0.1:58308
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:58311
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:58312
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S10] ⇄ pheromone p=1.000 → S13@127.0.0.1:58313
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:58316
[S3] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:58312
[S6] ⇄ pheromone p=1.000 → S9@127.0.0.1:58310
[S9] ⇄ pheromone p=1.000 → S6@127.0.0.1:58307
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:58310
[S2] START round=1 head_norm_before_train=1.208500 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9200968380961856, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5173805880651763, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.198298 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4879970599017955, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3921008995374025, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.222279 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5647045239228636, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.470068572019273, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.158191 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4910311398687792, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4394864193480617, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.200952 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7191948845316012, 'psi': 0.0}-{'f1_val': 0.10647261585599388, 'auprc': 0.10647261585599388, 'loss_val': 1.412130915145601, 'psi': 0.10647261585599388}
[S7] START round=1 head_norm_before_train=1.116163 (no previous merge yet)
[S7] round=1 local utility u=0.099896 metrics={'f1_val': 0.3329084342468664, 'auprc': 0.3329084342468664, 'loss_val': 1.44707929047892, 'psi': 0.3329084342468664}-{'f1_val': 0.3046267496111975, 'auprc': 0.3046267496111975, 'loss_val': 1.3923352042413069, 'psi': 0.3046267496111975}
[S8] START round=1 head_norm_before_train=1.215952 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5688640315351394, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.441091821846058, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.189967 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5488213013279748, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4306819959602541, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.183205 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6804047991590607, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.487984736325161, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.182350 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.507913003588592, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4413646535194544, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.122191 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6840403792963607, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4984439415287834, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.126777 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.560245939160439, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4571350257514777, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.188583 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6628133026924874, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4488020030968674, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.182298 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5241702725657678, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4219526538928149, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.220007 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6255436089739976, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4534171543709975, 'psi': 0.0}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:58307
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] cosine check vs S7: cos=0.0067
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.0000 head_norm=1.234606
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.321292e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.0000 head_norm=0.837720 delta_norm=0.832129
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.258413 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6498261542684336, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9200968380961856, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.215434 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6676176308843662, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4879970599017955, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.269277 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6401376258561047, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5647045239228636, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.175459 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5865318220975393, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4910311398687792, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=0.837720 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0474642864259702, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7191948845316012, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.124356 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5471334098607552, 'psi': 0.0}-{'f1_val': 0.3329084342468664, 'auprc': 0.3329084342468664, 'loss_val': 1.44707929047892, 'psi': 0.3329084342468664}
[S8] START round=2 head_norm_before_train=1.270034 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.895374128024257, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5688640315351394, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.205091 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.813971579104219, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5488213013279748, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.223074 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1854354794537305, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6804047991590607, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.195453 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6174300857743544, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.507913003588592, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.154948 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8770102662524324, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6840403792963607, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.143438 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7598442018909317, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.560245939160439, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.235887 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0102324694372973, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6628133026924874, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.207599 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7354714051636284, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5241702725657678, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.264345 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0051594658551823, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6255436089739976, 'psi': 0.0}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.302106 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7810996208224825, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6498261542684336, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.242370 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1223755663347474, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6676176308843662, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.315897 (no previous merge yet)
[S4] round=3 local utility u=0.100662 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4388140175778852, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6401376258561047, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.200748 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7669640702565244, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5865318220975393, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=0.888969 cos_to_last_merge=0.9876 (last merge round=1)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8633251477185895, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0474642864259702, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.141784 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.787551784826062, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5471334098607552, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.328785 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.30898176463925703, 'auprc': 0.30898176463925703, 'loss_val': 1.5701474092999572, 'psi': 0.30898176463925703}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.895374128024257, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.231607 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4303756520301887, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.813971579104219, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.272967 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3706860186500593, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1854354794537305, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.219704 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8815626372158654, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6174300857743544, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.180567 (no previous merge yet)
[S13] round=3 local utility u=0.025162 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8266860736901447, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8770102662524324, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.172748 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2499127832468666, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7598442018909317, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.275681 (no previous merge yet)
[S15] round=3 local utility u=0.108829 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7925750215433638, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0102324694372973, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.244211 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2930513459916195, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7354714051636284, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.313026 (no previous merge yet)
[S17] round=3 local utility u=0.208120 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5889187890479222, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0051594658551823, 'psi': 0.0}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:58308
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] cosine check vs S8: cos=-0.1535
[S7] DROPPED delta from S8 (cos=-0.1535 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=4 head_norm_before_train=1.336051 (no previous merge yet)
[S2] round=4 local utility u=0.012608 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7558834054210717, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7810996208224825, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.276717 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6706021128051405, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1223755663347474, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.350300 (no previous merge yet)
[S4] round=4 local utility u=0.037613 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3635881330091724, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4388140175778852, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.231440 (no previous merge yet)
[S5] round=4 local utility u=0.013683 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7395971430826747, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7669640702565244, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=0.954592 cos_to_last_merge=0.9647 (last merge round=1)
[S6] round=4 local utility u=0.017891 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.827543836560723, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8633251477185895, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.168327 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.000284509374305, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.787551784826062, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.354099 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.2323767476085357, 'auprc': 0.2323767476085357, 'loss_val': 1.4204950160016514, 'psi': 0.23237674760853572}-{'f1_val': 0.30898176463925703, 'auprc': 0.30898176463925703, 'loss_val': 1.5701474092999572, 'psi': 0.30898176463925703}
[S9] START round=4 head_norm_before_train=1.263462 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9651842993643776, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4303756520301887, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.308140 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.295300080011468, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3706860186500593, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.252649 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4780168746850864, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8815626372158654, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.196888 (no previous merge yet)
[S13] round=4 local utility u=0.100676 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.625334196009478, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8266860736901447, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.211573 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1655720828185574, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2499127832468666, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.292004 (no previous merge yet)
[S15] round=4 local utility u=0.078971 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.634632104391012, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7925750215433638, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.287894 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.935085840170114, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2930513459916195, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.327402 (no previous merge yet)
[S17] round=4 local utility u=0.476764 metrics={'f1_val': 0.09391356363092568, 'auprc': 0.09391356363092568, 'loss_val': 1.480613234542645, 'psi': 0.09391356363092568}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5889187890479222, 'psi': 0.0}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.094)
[S2] START round=5 head_norm_before_train=1.381871 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7997308707942308, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7558834054210717, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.306134 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7984746759268275, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6706021128051405, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.404764 (no previous merge yet)
[S4] round=5 local utility u=0.006920 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3497478074914468, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3635881330091724, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.246224 (no previous merge yet)
[S5] round=5 local utility u=0.051357 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.636884002410169, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7395971430826747, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.009168 cos_to_last_merge=0.9482 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.941893043455904, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.827543836560723, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.186681 (no previous merge yet)
[S7] round=5 local utility u=0.021952 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9563803582536305, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.000284509374305, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.405702 (no previous merge yet)
[S8] round=5 local utility u=0.014150 metrics={'f1_val': 0.21677649643053268, 'auprc': 0.21677649643053268, 'loss_val': 1.2517936382283852, 'psi': 0.21677649643053268}-{'f1_val': 0.2323767476085357, 'auprc': 0.2323767476085357, 'loss_val': 1.4204950160016514, 'psi': 0.23237674760853572}
[S9] START round=5 head_norm_before_train=1.288134 (no previous merge yet)
[S9] round=5 local utility u=0.015947 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.933290006999824, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9651842993643776, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.364748 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5633225953513845, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.295300080011468, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.288823 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9000805008781536, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4780168746850864, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.211645 (no previous merge yet)
[S13] round=5 local utility u=0.088013 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4493082467962384, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.625334196009478, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.252731 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.494580521846145, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1655720828185574, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.324999 (no previous merge yet)
[S15] round=5 local utility u=0.119653 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.395326726474758, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.634632104391012, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.320918 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0368420752541785, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.935085840170114, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.372076 (no previous merge yet)
[S17] round=5 local utility u=0.584745 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.2926452646066102, 'psi': 0.20297157622739018}-{'f1_val': 0.09391356363092568, 'auprc': 0.09391356363092568, 'loss_val': 1.480613234542645, 'psi': 0.09391356363092568}
[S15] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:58308
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S8
[S7] cosine check vs S8: cos=-0.1460
[S7] DROPPED delta from S8 (cos=-0.1460 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=-0.0746
[S9] DROPPED delta from S17 (cos=-0.0746 < 0.0)
[S9] ⇄ pheromone p=0.331 → S14@127.0.0.1:58314
[S14] ⇄ pheromone p=0.328 → S5@127.0.0.1:58305
[S10] ⇄ pheromone p=0.328 → S5@127.0.0.1:58305
[S13] ⇄ pheromone p=0.365 → S9@127.0.0.1:58310
[S7] ⇄ pheromone p=0.340 → S14@127.0.0.1:58314
[S11] ⇄ pheromone p=0.328 → S9@127.0.0.1:58310
[S6] ⇄ pheromone p=0.331 → S4@127.0.0.1:58304
[S15] ⇄ pheromone p=0.378 → S5@127.0.0.1:58305
[S4] ⇄ pheromone p=0.348 → S11@127.0.0.1:58312
[S2] ⇄ pheromone p=0.330 → S5@127.0.0.1:58305
[S3] ⇄ pheromone p=0.328 → S5@127.0.0.1:58305
[S5] ⇄ pheromone p=0.340 → S16@127.0.0.1:58316
[S8] ⇄ pheromone p=0.459 → S7@127.0.0.1:58308
[S17] ⇄ pheromone p=0.548 → S9@127.0.0.1:58310
[S16] ⇄ pheromone p=0.328 → S6@127.0.0.1:58307
[S2] START round=6 head_norm_before_train=1.443135 (no previous merge yet)
[S2] round=6 local utility u=0.208175 metrics={'f1_val': 0.05956447480785653, 'auprc': 0.05956447480785653, 'loss_val': 2.9194618253760636, 'psi': 0.05956447480785654}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7997308707942308, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.329245 (no previous merge yet)
[S3] round=6 local utility u=0.190230 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4180152409129847, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7984746759268275, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.462585 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3645608904986943, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3497478074914468, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.258331 (no previous merge yet)
[S5] round=6 local utility u=0.060204 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.516476842348068, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.636884002410169, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.076520 cos_to_last_merge=0.9299 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.930
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.095203856991027, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.941893043455904, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.193195 (no previous merge yet)
[S7] round=6 local utility u=1.000000 metrics={'f1_val': 0.21028105431775157, 'auprc': 0.21028105431775157, 'loss_val': 1.8006962701757225, 'psi': 0.21028105431775157}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9563803582536305, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.460469 (no previous merge yet)
[S8] round=6 local utility u=0.105930 metrics={'f1_val': 0.23342030826729895, 'auprc': 0.23342030826729895, 'loss_val': 1.1897280122361047, 'psi': 0.23342030826729893}-{'f1_val': 0.21677649643053268, 'auprc': 0.21677649643053268, 'loss_val': 1.2517936382283852, 'psi': 0.21677649643053268}
[S9] START round=6 head_norm_before_train=1.304439 (no previous merge yet)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0764331686466035, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.933290006999824, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.416343 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.3328109941398045, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5633225953513845, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.318307 (no previous merge yet)
[S11] round=6 local utility u=0.191445 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5171905298049255, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9000805008781536, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.237865 (no previous merge yet)
[S13] round=6 local utility u=1.000000 metrics={'f1_val': 0.2855536818437324, 'auprc': 0.2855536818437324, 'loss_val': 1.2890444417135833, 'psi': 0.2855536818437324}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4493082467962384, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.276028 (no previous merge yet)
[S14] round=6 local utility u=0.174945 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.144690996579606, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.494580521846145, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.364937 (no previous merge yet)
[S15] round=6 local utility u=0.747924 metrics={'f1_val': 0.14909269249632173, 'auprc': 0.14909269249632173, 'loss_val': 1.24131384198525, 'psi': 0.14909269249632173}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.395326726474758, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.346648 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0841203570263733, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0368420752541785, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.415136 (no previous merge yet)
[S17] round=6 local utility u=0.028873 metrics={'f1_val': 0.20285363806572407, 'auprc': 0.20285363806572407, 'loss_val': 1.23383706130519, 'psi': 0.20285363806572407}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.2926452646066102, 'psi': 0.20297157622739018}
[S8] not sending this round → trigger blocked (psi=0.233)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:58310
[S15] not sending this round → trigger blocked (psi=0.149)
[S3] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.060)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S13
[S9] cosine check vs S13: cos=0.0208
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] cosine check vs S7: cos=-0.1130
[S14] DROPPED delta from S7 (cos=-0.1130 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.203)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.0000 head_norm=1.323843
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.103312e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.0000 head_norm=0.929415 delta_norm=0.910331
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.502398 (no previous merge yet)
[S2] round=7 local utility u=0.679865 metrics={'f1_val': 0.20004620004620002, 'auprc': 0.20004620004620002, 'loss_val': 2.824067305502991, 'psi': 0.20004620004620002}-{'f1_val': 0.05956447480785653, 'auprc': 0.05956447480785653, 'loss_val': 2.9194618253760636, 'psi': 0.05956447480785654}
[S3] START round=7 head_norm_before_train=1.349798 (no previous merge yet)
[S3] round=7 local utility u=0.064117 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2897811055067683, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4180152409129847, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.521971 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.374675205005062, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3645608904986943, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.271115 (no previous merge yet)
[S5] round=7 local utility u=0.084536 metrics={'f1_val': 0.009105450965916083, 'auprc': 0.009105450965916083, 'loss_val': 1.4293547054161952, 'psi': 0.009105450965916083}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.516476842348068, 'psi': 0.0}
[S6] START round=7 head_norm_before_train=1.145619 cos_to_last_merge=0.9124 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.912
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2499673725191904, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.095203856991027, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.194676 (no previous merge yet)
[S7] round=7 local utility u=0.449299 metrics={'f1_val': 0.307551277644093, 'auprc': 0.307551277644093, 'loss_val': 1.777529867686975, 'psi': 0.307551277644093}-{'f1_val': 0.21028105431775157, 'auprc': 0.21028105431775157, 'loss_val': 1.8006962701757225, 'psi': 0.21028105431775157}
[S8] START round=7 head_norm_before_train=1.511397 (no previous merge yet)
[S8] round=7 local utility u=0.474203 metrics={'f1_val': 0.3236150917154878, 'auprc': 0.3236150917154878, 'loss_val': 1.0530760387887106, 'psi': 0.3236150917154878}-{'f1_val': 0.23342030826729895, 'auprc': 0.23342030826729895, 'loss_val': 1.1897280122361047, 'psi': 0.23342030826729893}
[S9] START round=7 head_norm_before_train=0.929415 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.327633 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4211680001722082, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0764331686466035, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.463087 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.560819852501054, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.3328109941398045, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.337000 (no previous merge yet)
[S11] round=7 local utility u=0.079110 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3589712628284825, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5171905298049255, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.277681 (no previous merge yet)
[S13] round=7 local utility u=0.250218 metrics={'f1_val': 0.33185185185185184, 'auprc': 0.33185185185185184, 'loss_val': 1.205291376565198, 'psi': 0.33185185185185184}-{'f1_val': 0.2855536818437324, 'auprc': 0.2855536818437324, 'loss_val': 1.2890444417135833, 'psi': 0.2855536818437324}
[S14] START round=7 head_norm_before_train=1.285561 (no previous merge yet)
[S14] round=7 local utility u=0.066784 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0111239079461747, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.144690996579606, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.415249 (no previous merge yet)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.12932790224032586, 'auprc': 0.12932790224032586, 'loss_val': 1.175267143794873, 'psi': 0.12932790224032586}-{'f1_val': 0.14909269249632173, 'auprc': 0.14909269249632173, 'loss_val': 1.24131384198525, 'psi': 0.14909269249632173}
[S16] START round=7 head_norm_before_train=1.372164 (no previous merge yet)
[S16] round=7 local utility u=0.024173 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.03577486696688, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0841203570263733, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.453244 (no previous merge yet)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.2215187804212848, 'psi': 0.152287708414114}-{'f1_val': 0.20285363806572407, 'auprc': 0.20285363806572407, 'loss_val': 1.23383706130519, 'psi': 0.20285363806572407}
[S16] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.308)
[S3] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[S5] not sending this round → trigger blocked (psi=0.009)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:58308
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.332)
[S14] not sending this round → trigger blocked (psi=0.000)
[S8] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] cosine check vs S2: cos=0.0789
[S7] RECEIVED delta(kind=head bytes=1801) from S8
[S7] cosine check vs S8: cos=-0.1542
[S7] DROPPED delta from S8 (cos=-0.1542 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.0091 head_norm=1.290383
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.724091e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.0059 head_norm=1.050957 delta_norm=0.972409
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.560478 (no previous merge yet)
[S2] round=8 local utility u=0.064495 metrics={'f1_val': 0.22518389046682688, 'auprc': 0.22518389046682688, 'loss_val': 2.9213166902294176, 'psi': 0.22518389046682685}-{'f1_val': 0.20004620004620002, 'auprc': 0.20004620004620002, 'loss_val': 2.824067305502991, 'psi': 0.20004620004620002}
[S3] START round=8 head_norm_before_train=1.375893 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.309370014253743, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2897811055067683, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.579049 (no previous merge yet)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3914090798372667, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.374675205005062, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.050957 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.761294 metrics={'f1_val': 0.17376817447495962, 'auprc': 0.17376817447495962, 'loss_val': 1.3887317439822828, 'psi': 0.17376817447495962}-{'f1_val': 0.009105450965916083, 'auprc': 0.009105450965916083, 'loss_val': 1.4293547054161952, 'psi': 0.009105450965916083}
[S6] START round=8 head_norm_before_train=1.205624 cos_to_last_merge=0.8988 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.004036087369420703, 'auprc': 0.004036087369420703, 'loss_val': 3.732990456345962, 'psi': 0.004036087369420703}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2499673725191904, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.205773 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.006612090680100755, 'auprc': 0.006612090680100755, 'loss_val': 1.8368358745654916, 'psi': 0.006612090680100756}-{'f1_val': 0.307551277644093, 'auprc': 0.307551277644093, 'loss_val': 1.777529867686975, 'psi': 0.307551277644093}
[S8] START round=8 head_norm_before_train=1.546781 (no previous merge yet)
[S8] round=8 local utility u=0.687134 metrics={'f1_val': 0.4539034402010498, 'auprc': 0.4539034402010498, 'loss_val': 0.8514028546814989, 'psi': 0.4539034402010498}-{'f1_val': 0.3236150917154878, 'auprc': 0.3236150917154878, 'loss_val': 1.0530760387887106, 'psi': 0.3236150917154878}
[S9] START round=8 head_norm_before_train=0.949598 cos_to_last_merge=0.9975 (last merge round=6)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.432498400657067, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4211680001722082, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.499838 (no previous merge yet)
[S10] round=8 local utility u=0.593886 metrics={'f1_val': 0.14887546156428333, 'auprc': 0.14887546156428333, 'loss_val': 4.712927474116484, 'psi': 0.14887546156428333}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.560819852501054, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.360372 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6756696190271203, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3589712628284825, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.315071 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.24034030485643387, 'auprc': 0.24034030485643387, 'loss_val': 1.1327029728185003, 'psi': 0.24034030485643387}-{'f1_val': 0.33185185185185184, 'auprc': 0.33185185185185184, 'loss_val': 1.205291376565198, 'psi': 0.33185185185185184}
[S14] START round=8 head_norm_before_train=1.302841 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.131763059728117, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0111239079461747, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.473253 (no previous merge yet)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.1050204009224765, 'auprc': 0.1050204009224765, 'loss_val': 1.1140865545702743, 'psi': 0.1050204009224765}-{'f1_val': 0.12932790224032586, 'auprc': 0.12932790224032586, 'loss_val': 1.175267143794873, 'psi': 0.12932790224032586}
[S16] START round=8 head_norm_before_train=1.401183 (no previous merge yet)
[S16] round=8 local utility u=0.007564 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.020646849853119, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.03577486696688, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.485861 (no previous merge yet)
[S17] round=8 local utility u=0.023934 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.1733842423437664, 'psi': 0.1522581895716224}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.2215187804212848, 'psi': 0.152287708414114}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.149)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.174)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] cosine check vs S2: cos=0.7745
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=-0.1520
[S7] DROPPED delta from S8 (cos=-0.1520 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=-0.1140
[S9] DROPPED delta from S17 (cos=-0.1140 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.1738 head_norm=1.073904
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.190324e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.1710 head_norm=1.270502 delta_norm=0.519032
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.616747 (no previous merge yet)
[S2] round=9 local utility u=0.198216 metrics={'f1_val': 0.2653708845696152, 'auprc': 0.2653708845696152, 'loss_val': 2.8865667277763314, 'psi': 0.2653708845696152}-{'f1_val': 0.22518389046682688, 'auprc': 0.22518389046682688, 'loss_val': 2.9213166902294176, 'psi': 0.22518389046682685}
[S3] START round=9 head_norm_before_train=1.409016 (no previous merge yet)
[S3] round=9 local utility u=0.534717 metrics={'f1_val': 0.08950086058519795, 'auprc': 0.08950086058519795, 'loss_val': 2.0454433609251836, 'psi': 0.08950086058519795}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.309370014253743, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.629778 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3928042906395024, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3914090798372667, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.270502 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.850896 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.3570753824918016, 'psi': 0.35933890172383154}-{'f1_val': 0.17376817447495962, 'auprc': 0.17376817447495962, 'loss_val': 1.3887317439822828, 'psi': 0.17376817447495962}
[S6] START round=9 head_norm_before_train=1.260479 cos_to_last_merge=0.8882 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.888
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.523144506941749, 'psi': 0.0}-{'f1_val': 0.004036087369420703, 'auprc': 0.004036087369420703, 'loss_val': 3.732990456345962, 'psi': 0.004036087369420703}
[S7] START round=9 head_norm_before_train=1.224975 (no previous merge yet)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7988963246863132, 'psi': 0.0}-{'f1_val': 0.006612090680100755, 'auprc': 0.006612090680100755, 'loss_val': 1.8368358745654916, 'psi': 0.006612090680100756}
[S8] START round=9 head_norm_before_train=1.590618 (no previous merge yet)
[S8] round=9 local utility u=1.000000 metrics={'f1_val': 0.6663958861024543, 'auprc': 0.6663958861024543, 'loss_val': 0.7087701764244078, 'psi': 0.6663958861024543}-{'f1_val': 0.4539034402010498, 'auprc': 0.4539034402010498, 'loss_val': 0.8514028546814989, 'psi': 0.4539034402010498}
[S9] START round=9 head_norm_before_train=0.979290 cos_to_last_merge=0.9909 (last merge round=6)
[S9] round=9 local utility u=0.050173 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.332152538356444, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.432498400657067, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.528583 (no previous merge yet)
[S10] round=9 local utility u=0.369447 metrics={'f1_val': 0.17785648290729905, 'auprc': 0.17785648290729905, 'loss_val': 4.234863432744935, 'psi': 0.17785648290729905}-{'f1_val': 0.14887546156428333, 'auprc': 0.14887546156428333, 'loss_val': 4.712927474116484, 'psi': 0.14887546156428333}
[S11] START round=9 head_norm_before_train=1.392253 (no previous merge yet)
[S11] round=9 local utility u=0.274436 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.12679713986288, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6756696190271203, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.359157 (no previous merge yet)
[S13] round=9 local utility u=0.546205 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1166561207473156, 'psi': 0.3599362944611573}-{'f1_val': 0.24034030485643387, 'auprc': 0.24034030485643387, 'loss_val': 1.1327029728185003, 'psi': 0.24034030485643387}
[S14] START round=9 head_norm_before_train=1.330475 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4832513908477125, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.131763059728117, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.534182 (no previous merge yet)
[S15] round=9 local utility u=0.019100 metrics={'f1_val': 0.0989779451317913, 'auprc': 0.0989779451317913, 'loss_val': 1.021505019008957, 'psi': 0.0989779451317913}-{'f1_val': 0.1050204009224765, 'auprc': 0.1050204009224765, 'loss_val': 1.1140865545702743, 'psi': 0.1050204009224765}
[S16] START round=9 head_norm_before_train=1.427303 (no previous merge yet)
[S16] round=9 local utility u=0.032100 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9564473966833456, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.020646849853119, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.521832 (no previous merge yet)
[S17] round=9 local utility u=0.037434 metrics={'f1_val': 0.15219918620422399, 'auprc': 0.15219918620422399, 'loss_val': 1.0979849360859812, 'psi': 0.15219918620422399}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.1733842423437664, 'psi': 0.1522581895716224}
[S3] not sending this round → trigger blocked (psi=0.090)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.099)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:58310
[S2] not sending this round → trigger blocked (psi=0.265)
[S16] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.178)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.666)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:58316
[S9] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=-0.0218
[S16] DROPPED delta from S5 (cos=-0.0218 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.6317
[S17] not sending this round → trigger blocked (psi=0.152)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.0000 head_norm=1.014283
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.490236e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.096775 delta_norm=0.549024
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.671055 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.9137406392981426, 'psi': 0.2653978324081417}-{'f1_val': 0.2653708845696152, 'auprc': 0.2653708845696152, 'loss_val': 2.8865667277763314, 'psi': 0.2653708845696152}
[S3] START round=10 head_norm_before_train=1.445464 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4713756219315033, 'psi': 0.0}-{'f1_val': 0.08950086058519795, 'auprc': 0.08950086058519795, 'loss_val': 2.0454433609251836, 'psi': 0.08950086058519795}
[S4] START round=10 head_norm_before_train=1.671150 (no previous merge yet)
[S4] round=10 local utility u=0.850893 metrics={'f1_val': 0.18703636142527058, 'auprc': 0.18703636142527058, 'loss_val': 1.3743458851272687, 'psi': 0.18703636142527058}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3928042906395024, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.289235 cos_to_last_merge=0.9975 (last merge round=8)
[S5] round=10 local utility u=0.027780 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.3015149836930124, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.3570753824918016, 'psi': 0.35933890172383154}
[S6] START round=10 head_norm_before_train=1.306132 cos_to_last_merge=0.8808 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.881
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.782878308510643, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.523144506941749, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.244688 (no previous merge yet)
[S7] round=10 local utility u=0.093756 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.61138445817303, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7988963246863132, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.635066 (no previous merge yet)
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.9997177674455537, 'auprc': 0.9997177674455537, 'loss_val': 0.5928295374505305, 'psi': 0.9997177674455537}-{'f1_val': 0.6663958861024543, 'auprc': 0.6663958861024543, 'loss_val': 0.7087701764244078, 'psi': 0.6663958861024543}
[S9] START round=10 head_norm_before_train=1.096775 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.064026 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.204100265465114, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.332152538356444, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.560399 (no previous merge yet)
[S10] round=10 local utility u=0.548253 metrics={'f1_val': 0.2139732020782062, 'auprc': 0.2139732020782062, 'loss_val': 3.46340716249167, 'psi': 0.2139732020782062}-{'f1_val': 0.17785648290729905, 'auprc': 0.17785648290729905, 'loss_val': 4.234863432744935, 'psi': 0.17785648290729905}
[S11] START round=10 head_norm_before_train=1.422497 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5074317804197133, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.12679713986288, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.407095 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.157763977880989, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1166561207473156, 'psi': 0.3599362944611573}
[S14] START round=10 head_norm_before_train=1.366186 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.375460696906665, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4832513908477125, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.581482 (no previous merge yet)
[S15] round=10 local utility u=1.000000 metrics={'f1_val': 0.5718832603988848, 'auprc': 0.5718832603988848, 'loss_val': 0.873744132196871, 'psi': 0.5718832603988848}-{'f1_val': 0.0989779451317913, 'auprc': 0.0989779451317913, 'loss_val': 1.021505019008957, 'psi': 0.0989779451317913}
[S16] START round=10 head_norm_before_train=1.455376 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9737434534090688, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9564473966833456, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.559551 (no previous merge yet)
[S17] round=10 local utility u=0.016013 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.0664908922492486, 'psi': 0.1522581895716224}-{'f1_val': 0.15219918620422399, 'auprc': 0.15219918620422399, 'loss_val': 1.0979849360859812, 'psi': 0.15219918620422399}
[S5] not sending this round → trigger blocked (psi=0.359)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.187)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=-0.0408
[S5] DROPPED delta from S15 (cos=-0.0408 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.1077
[S7] RECEIVED delta(kind=head bytes=1806) from S8
[S7] cosine check vs S8: cos=-0.1487
[S7] DROPPED delta from S8 (cos=-0.1487 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] cosine check vs S17: cos=-0.1217
[S9] DROPPED delta from S17 (cos=-0.1217 < 0.0)
[S14] ⇄ pheromone p=0.129 → S5@127.0.0.1:58305
[S11] ⇄ pheromone p=0.175 → S9@127.0.0.1:58310
[S7] ⇄ pheromone p=0.258 → S14@127.0.0.1:58314
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.3593 head_norm=1.312600
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.751624e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.3593 head_norm=1.084358 delta_norm=0.975162
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.364 → S16@127.0.0.1:58316
[S13] ⇄ pheromone p=0.314 → S9@127.0.0.1:58310
[S4] ⇄ pheromone p=0.284 → S11@127.0.0.1:58312
[S6] ⇄ pheromone p=0.108 → S4@127.0.0.1:58304
[S9] ⇄ pheromone p=0.163 → S14@127.0.0.1:58314
[S2] ⇄ pheromone p=0.235 → S5@127.0.0.1:58305
[S3] ⇄ pheromone p=0.215 → S5@127.0.0.1:58305
[S15] ⇄ pheromone p=0.388 → S5@127.0.0.1:58305
[S10] ⇄ pheromone p=0.352 → S5@127.0.0.1:58305
[S8] ⇄ pheromone p=0.655 → S7@127.0.0.1:58308
[S17] ⇄ pheromone p=0.194 → S9@127.0.0.1:58310
[S16] ⇄ pheromone p=0.116 → S6@127.0.0.1:58307
[S2] START round=11 head_norm_before_train=1.718710 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.0179987748279213, 'psi': 0.2653978324081417}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.9137406392981426, 'psi': 0.2653978324081417}
[S3] START round=11 head_norm_before_train=1.479591 (no previous merge yet)
[S3] round=11 local utility u=0.628987 metrics={'f1_val': 0.12645992750704793, 'auprc': 0.12645992750704793, 'loss_val': 2.3515418228151526, 'psi': 0.12645992750704793}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4713756219315033, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.714608 (no previous merge yet)
[S4] round=11 local utility u=0.629560 metrics={'f1_val': 0.3236405454246755, 'auprc': 0.3236405454246755, 'loss_val': 1.3446629502235776, 'psi': 0.3236405454246755}-{'f1_val': 0.18703636142527058, 'auprc': 0.18703636142527058, 'loss_val': 1.3743458851272687, 'psi': 0.18703636142527058}
[S5] START round=11 head_norm_before_train=1.084358 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.3356669513220163, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.3015149836930124, 'psi': 0.35933890172383154}
[S6] START round=11 head_norm_before_train=1.340416 cos_to_last_merge=0.8758 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.876
[S6] round=11 local utility u=0.541556 metrics={'f1_val': 0.09919416730621643, 'auprc': 0.09919416730621643, 'loss_val': 4.592513514908809, 'psi': 0.09919416730621643}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.782878308510643, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.262080 (no previous merge yet)
[S7] round=11 local utility u=0.036000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5393843425395173, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.61138445817303, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.689537 (no previous merge yet)
[S8] round=11 local utility u=0.064360 metrics={'f1_val': 0.9991531851296138, 'auprc': 0.9991531851296138, 'loss_val': 0.4590288485910877, 'psi': 0.9991531851296138}-{'f1_val': 0.9997177674455537, 'auprc': 0.9997177674455537, 'loss_val': 0.5928295374505305, 'psi': 0.9997177674455537}
[S9] START round=11 head_norm_before_train=1.120926 cos_to_last_merge=0.9979 (last merge round=9)
[S9] round=11 local utility u=0.033763 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.136574393943152, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.204100265465114, 'psi': 0.0}
[S10] START round=11 head_norm_before_train=1.590795 (no previous merge yet)
[S10] round=11 local utility u=0.185970 metrics={'f1_val': 0.2297157622739018, 'auprc': 0.2297157622739018, 'loss_val': 3.233149405735063, 'psi': 0.2297157622739018}-{'f1_val': 0.2139732020782062, 'auprc': 0.2139732020782062, 'loss_val': 3.46340716249167, 'psi': 0.2139732020782062}
[S11] START round=11 head_norm_before_train=1.455412 (no previous merge yet)
[S11] round=11 local utility u=0.130499 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.246434361807321, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5074317804197133, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.456302 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2672926874850308, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.157763977880989, 'psi': 0.3599362944611573}
[S14] START round=11 head_norm_before_train=1.402964 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.661318480362044, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.375460696906665, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.624548 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.4808274025848389, 'auprc': 0.4808274025848389, 'loss_val': 0.9828219196059982, 'psi': 0.4808274025848389}-{'f1_val': 0.5718832603988848, 'auprc': 0.5718832603988848, 'loss_val': 0.873744132196871, 'psi': 0.5718832603988848}
[S16] START round=11 head_norm_before_train=1.481154 (no previous merge yet)
[S16] round=11 local utility u=0.020682 metrics={'f1_val': 0.00023020257826887662, 'auprc': 0.00023020257826887662, 'loss_val': 2.9344513774682657, 'psi': 0.00023020257826887662}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9737434534090688, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.598901 (no previous merge yet)
[S17] round=11 local utility u=0.257200 metrics={'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 1.009219228261174, 'psi': 0.20305027788548533}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.0664908922492486, 'psi': 0.1522581895716224}
[S9] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.999)
[S11] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.126)
[S6] not sending this round → trigger blocked (psi=0.099)
[S10] not sending this round → trigger blocked (psi=0.230)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:58312
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S4] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.0186
[S17] not sending this round → trigger blocked (psi=0.203)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.0000 head_norm=1.485486
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.138053e+00
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.0009 head_norm=1.159170 delta_norm=1.138053
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.756248 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.0628946362089846, 'psi': 0.2653978324081417}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.0179987748279213, 'psi': 0.2653978324081417}
[S3] START round=12 head_norm_before_train=1.511705 (no previous merge yet)
[S3] round=12 local utility u=0.777179 metrics={'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.340351296661878, 'psi': 0.29792295726964957}-{'f1_val': 0.12645992750704793, 'auprc': 0.12645992750704793, 'loss_val': 2.3515418228151526, 'psi': 0.12645992750704793}
[S4] START round=12 head_norm_before_train=1.752429 (no previous merge yet)
[S4] round=12 local utility u=0.168867 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3053087929072966, 'psi': 0.3567939207526687}-{'f1_val': 0.3236405454246755, 'auprc': 0.3236405454246755, 'loss_val': 1.3446629502235776, 'psi': 0.3236405454246755}
[S5] START round=12 head_norm_before_train=1.110030 cos_to_last_merge=0.9972 (last merge round=10)
[S5] round=12 local utility u=0.013548 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.3085713024363002, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.3356669513220163, 'psi': 0.35933890172383154}
[S6] START round=12 head_norm_before_train=1.368164 cos_to_last_merge=0.8720 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.872
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.10038240917782026, 'auprc': 0.10038240917782026, 'loss_val': 4.629557071287711, 'psi': 0.10038240917782026}-{'f1_val': 0.09919416730621643, 'auprc': 0.09919416730621643, 'loss_val': 4.592513514908809, 'psi': 0.09919416730621643}
[S7] START round=12 head_norm_before_train=1.284780 (no previous merge yet)
[S7] round=12 local utility u=0.011177 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5170309598701515, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5393843425395173, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.753804 (no previous merge yet)
[S8] round=12 local utility u=0.050881 metrics={'f1_val': 0.9991531851296138, 'auprc': 0.9991531851296138, 'loss_val': 0.35726731593169503, 'psi': 0.9991531851296138}-{'f1_val': 0.9991531851296138, 'auprc': 0.9991531851296138, 'loss_val': 0.4590288485910877, 'psi': 0.9991531851296138}
[S9] START round=12 head_norm_before_train=1.154973 cos_to_last_merge=0.9919 (last merge round=9)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2296768974460766, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.136574393943152, 'psi': 0.0}
[S10] START round=12 head_norm_before_train=1.627792 (no previous merge yet)
[S10] round=12 local utility u=0.561448 metrics={'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 3.0385035273253282, 'psi': 0.3328546353917345}-{'f1_val': 0.2297157622739018, 'auprc': 0.2297157622739018, 'loss_val': 3.233149405735063, 'psi': 0.2297157622739018}
[S11] START round=12 head_norm_before_train=1.159170 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.259872 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.726690358174971, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.246434361807321, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.496576 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.404152207063947, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2672926874850308, 'psi': 0.3599362944611573}
[S14] START round=12 head_norm_before_train=1.431520 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.96931457024018, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.661318480362044, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.670283 (no previous merge yet)
[S15] round=12 local utility u=0.156335 metrics={'f1_val': 0.5090491667639475, 'auprc': 0.5090491667639475, 'loss_val': 0.9241481752458998, 'psi': 0.5090491667639475}-{'f1_val': 0.4808274025848389, 'auprc': 0.4808274025848389, 'loss_val': 0.9828219196059982, 'psi': 0.4808274025848389}
[S16] START round=12 head_norm_before_train=1.503219 (no previous merge yet)
[S16] round=12 local utility u=0.878641 metrics={'f1_val': 0.14388489208633093, 'auprc': 0.14388489208633093, 'loss_val': 2.4700613635794983, 'psi': 0.14388489208633093}-{'f1_val': 0.00023020257826887662, 'auprc': 0.00023020257826887662, 'loss_val': 2.9344513774682657, 'psi': 0.00023020257826887662}
[S17] START round=12 head_norm_before_train=1.642730 (no previous merge yet)
[S17] round=12 local utility u=0.016709 metrics={'f1_val': 0.20285363806572407, 'auprc': 0.20285363806572407, 'loss_val': 0.9740318473610109, 'psi': 0.20285363806572407}-{'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 1.009219228261174, 'psi': 0.20305027788548533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:58305
[S4] not sending this round → trigger blocked (psi=0.357)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:58316
[S16] not sending this round → trigger blocked (psi=0.144)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:58308
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S8] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1807 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=-0.0885
[S5] DROPPED delta from S15 (cos=-0.0885 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.7723
[S5] RECEIVED delta(kind=head bytes=1807) from S3
[S5] cosine check vs S3: cos=-0.0277
[S5] DROPPED delta from S3 (cos=-0.0277 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=-0.0286
[S16] DROPPED delta from S5 (cos=-0.0286 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] cosine check vs S8: cos=-0.1449
[S7] DROPPED delta from S8 (cos=-0.1449 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=-0.1455
[S9] DROPPED delta from S17 (cos=-0.1455 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.3593 head_norm=1.140532
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.339319e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.3593 head_norm=1.323581 delta_norm=0.533932
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.786206 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.110789211172258, 'psi': 0.2654773703336637}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.0628946362089846, 'psi': 0.2653978324081417}
[S3] START round=13 head_norm_before_train=1.541515 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.27991096271563715, 'auprc': 0.27991096271563715, 'loss_val': 2.187467850550747, 'psi': 0.27991096271563715}-{'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.340351296661878, 'psi': 0.29792295726964957}
[S4] START round=13 head_norm_before_train=1.787719 (no previous merge yet)
[S4] round=13 local utility u=0.013288 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2787332101925295, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3053087929072966, 'psi': 0.3567939207526687}
[S5] START round=13 head_norm_before_train=1.323581 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.18011758417958312, 'auprc': 0.18011758417958312, 'loss_val': 1.3413389466623824, 'psi': 0.18011758417958312}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.3085713024363002, 'psi': 0.35933890172383154}
[S6] START round=13 head_norm_before_train=1.392426 cos_to_last_merge=0.8691 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.013280521901211557, 'auprc': 0.013280521901211557, 'loss_val': 5.1989321182973764, 'psi': 0.013280521901211557}-{'f1_val': 0.10038240917782026, 'auprc': 0.10038240917782026, 'loss_val': 4.629557071287711, 'psi': 0.10038240917782026}
[S7] START round=13 head_norm_before_train=1.307847 (no previous merge yet)
[S7] round=13 local utility u=0.014470 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4880919216009698, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5170309598701515, 'psi': 0.0}
[S8] START round=13 head_norm_before_train=1.808734 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.4102335108386543, 'psi': 0.9988708350860451}-{'f1_val': 0.9991531851296138, 'auprc': 0.9991531851296138, 'loss_val': 0.35726731593169503, 'psi': 0.9991531851296138}
[S9] START round=13 head_norm_before_train=1.199928 cos_to_last_merge=0.9819 (last merge round=9)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.346782487396278, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2296768974460766, 'psi': 0.0}
[S10] START round=13 head_norm_before_train=1.665258 (no previous merge yet)
[S10] round=13 local utility u=0.037607 metrics={'f1_val': 0.33293451383903644, 'auprc': 0.33293451383903644, 'loss_val': 2.9640094127581826, 'psi': 0.33293451383903644}-{'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 3.0385035273253282, 'psi': 0.3328546353917345}
[S11] START round=13 head_norm_before_train=1.179026 cos_to_last_merge=0.9990 (last merge round=11)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9522036927106465, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.726690358174971, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.527563 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4344033213221652, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.404152207063947, 'psi': 0.3599362944611573}
[S14] START round=13 head_norm_before_train=1.457014 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.320128747299471, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.96931457024018, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.722866 (no previous merge yet)
[S15] round=13 local utility u=0.337197 metrics={'f1_val': 0.5691011270735091, 'auprc': 0.5691011270735091, 'loss_val': 0.7902209693744852, 'psi': 0.5691011270735091}-{'f1_val': 0.5090491667639475, 'auprc': 0.5090491667639475, 'loss_val': 0.9241481752458998, 'psi': 0.5090491667639475}
[S16] START round=13 head_norm_before_train=1.528382 (no previous merge yet)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.050936435868331444, 'auprc': 0.050936435868331444, 'loss_val': 3.039829791974205, 'psi': 0.050936435868331444}-{'f1_val': 0.14388489208633093, 'auprc': 0.14388489208633093, 'loss_val': 2.4700613635794983, 'psi': 0.14388489208633093}
[S17] START round=13 head_norm_before_train=1.681637 (no previous merge yet)
[S17] round=13 local utility u=0.040111 metrics={'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 0.894517163720874, 'psi': 0.20293224827229864}-{'f1_val': 0.20285363806572407, 'auprc': 0.20285363806572407, 'loss_val': 0.9740318473610109, 'psi': 0.20285363806572407}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.333)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.569)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:58312
[S4] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.7258
[S17] not sending this round → trigger blocked (psi=0.203)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.0000 head_norm=1.211433
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.290769e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.413294 delta_norm=0.629077
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.810472 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.2650522694190816, 'auprc': 0.2650522694190816, 'loss_val': 3.25298031716132, 'psi': 0.2650522694190816}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.110789211172258, 'psi': 0.2654773703336637}
[S3] START round=14 head_norm_before_train=1.572394 (no previous merge yet)
[S3] round=14 local utility u=0.006575 metrics={'f1_val': 0.30954661558109836, 'auprc': 0.30954661558109836, 'loss_val': 2.4410395863793934, 'psi': 0.30954661558109836}-{'f1_val': 0.27991096271563715, 'auprc': 0.27991096271563715, 'loss_val': 2.187467850550747, 'psi': 0.27991096271563715}
[S4] START round=14 head_norm_before_train=1.821731 (no previous merge yet)
[S4] round=14 local utility u=0.018824 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2410848602303837, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2787332101925295, 'psi': 0.3567939207526687}
[S5] START round=14 head_norm_before_train=1.347137 cos_to_last_merge=0.9982 (last merge round=12)
[S5] round=14 local utility u=0.114340 metrics={'f1_val': 0.20346146105856308, 'auprc': 0.20346146105856308, 'loss_val': 1.3227534638621095, 'psi': 0.20346146105856308}-{'f1_val': 0.18011758417958312, 'auprc': 0.18011758417958312, 'loss_val': 1.3413389466623824, 'psi': 0.18011758417958312}
[S6] START round=14 head_norm_before_train=1.416583 cos_to_last_merge=0.8662 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.866
[S6] round=14 local utility u=0.052684 metrics={'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 5.201084684665782, 'psi': 0.025227272727272727}-{'f1_val': 0.013280521901211557, 'auprc': 0.013280521901211557, 'loss_val': 5.1989321182973764, 'psi': 0.013280521901211557}
[S7] START round=14 head_norm_before_train=1.320089 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5466247491069853, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4880919216009698, 'psi': 0.0}
[S8] START round=14 head_norm_before_train=1.856660 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.5852518030686773, 'auprc': 0.5852518030686773, 'loss_val': 0.446305858922217, 'psi': 0.5852518030686773}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.4102335108386543, 'psi': 0.9988708350860451}
[S9] START round=14 head_norm_before_train=1.248245 cos_to_last_merge=0.9709 (last merge round=9)
[S9] round=14 local utility u=0.795680 metrics={'f1_val': 0.13004246284501061, 'auprc': 0.13004246284501061, 'loss_val': 1.9258045198486322, 'psi': 0.13004246284501061}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.346782487396278, 'psi': 0.0}
[S10] START round=14 head_norm_before_train=1.695958 (no previous merge yet)
[S10] round=14 local utility u=0.025853 metrics={'f1_val': 0.33293470461612057, 'auprc': 0.33293470461612057, 'loss_val': 2.91230534565303, 'psi': 0.33293470461612057}-{'f1_val': 0.33293451383903644, 'auprc': 0.33293451383903644, 'loss_val': 2.9640094127581826, 'psi': 0.33293451383903644}
[S11] START round=14 head_norm_before_train=1.413294 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.152238 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6477275564111633, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9522036927106465, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.554274 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4447303924904342, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4344033213221652, 'psi': 0.3599362944611573}
[S14] START round=14 head_norm_before_train=1.480354 (no previous merge yet)
[S14] round=14 local utility u=0.030580 metrics={'f1_val': 0.006493506493506494, 'auprc': 0.006493506493506494, 'loss_val': 5.317409646157621, 'psi': 0.006493506493506494}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.320128747299471, 'psi': 0.0}
[S15] START round=14 head_norm_before_train=1.762359 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.5434119733130687, 'auprc': 0.5434119733130687, 'loss_val': 0.856008633064875, 'psi': 0.5434119733130687}-{'f1_val': 0.5691011270735091, 'auprc': 0.5691011270735091, 'loss_val': 0.7902209693744852, 'psi': 0.5691011270735091}
[S16] START round=14 head_norm_before_train=1.555373 (no previous merge yet)
[S16] round=14 local utility u=0.392578 metrics={'f1_val': 0.1240491515506144, 'auprc': 0.1240491515506144, 'loss_val': 2.9126873154005075, 'psi': 0.12404915155061438}-{'f1_val': 0.050936435868331444, 'auprc': 0.050936435868331444, 'loss_val': 3.039829791974205, 'psi': 0.050936435868331444}
[S17] START round=14 head_norm_before_train=1.707034 (no previous merge yet)
[S17] round=14 local utility u=0.011764 metrics={'f1_val': 0.20257898130238558, 'auprc': 0.20257898130238558, 'loss_val': 0.8678099734879441, 'psi': 0.20257898130238558}-{'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 0.894517163720874, 'psi': 0.20293224827229864}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:58316
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.130)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S6] not sending this round → trigger blocked (psi=0.025)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:58305
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.124)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:58312
[S14] not sending this round → trigger blocked (psi=0.006)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=-0.0277
[S16] DROPPED delta from S5 (cos=-0.0277 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9372
[S5] RECEIVED delta(kind=head bytes=1795) from S10
[S5] cosine check vs S10: cos=0.9383
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] cosine check vs S3: cos=-0.0048
[S5] DROPPED delta from S3 (cos=-0.0048 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=-0.1605
[S9] DROPPED delta from S17 (cos=-0.1605 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.0000 head_norm=1.436163
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.526825e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.613929 delta_norm=0.352682
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.2035 head_norm=1.375658
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.189943e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.0657 head_norm=1.522074 delta_norm=0.318994
[S5] aggregate: ROLLBACK (f1_val pre=0.203 post=0.066 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.830476 (no previous merge yet)
[S2] round=15 local utility u=0.038622 metrics={'f1_val': 0.2455690013445789, 'auprc': 0.2455690013445789, 'loss_val': 3.000387391457629, 'psi': 0.24556900134457893}-{'f1_val': 0.2650522694190816, 'auprc': 0.2650522694190816, 'loss_val': 3.25298031716132, 'psi': 0.2650522694190816}
[S3] START round=15 head_norm_before_train=1.600140 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.2945521698984303, 'auprc': 0.2945521698984303, 'loss_val': 3.011719368594156, 'psi': 0.2945521698984303}-{'f1_val': 0.30954661558109836, 'auprc': 0.30954661558109836, 'loss_val': 2.4410395863793934, 'psi': 0.30954661558109836}
[S4] START round=15 head_norm_before_train=1.842753 (no previous merge yet)
[S4] round=15 local utility u=0.007687 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.225710367920361, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2410848602303837, 'psi': 0.3567939207526687}
[S5] START round=15 head_norm_before_train=1.522074 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.0012321340561853129, 'auprc': 0.0012321340561853129, 'loss_val': 1.340545074436773, 'psi': 0.0012321340561853129}-{'f1_val': 0.20346146105856308, 'auprc': 0.20346146105856308, 'loss_val': 1.3227534638621095, 'psi': 0.20346146105856308}
[S6] START round=15 head_norm_before_train=1.439987 cos_to_last_merge=0.8632 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.863
[S6] round=15 local utility u=0.376422 metrics={'f1_val': 0.09857801691006918, 'auprc': 0.09857801691006918, 'loss_val': 5.108397038716162, 'psi': 0.09857801691006918}-{'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 5.201084684665782, 'psi': 0.025227272727272727}
[S7] START round=15 head_norm_before_train=1.336887 (no previous merge yet)
[S7] round=15 local utility u=0.061790 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4230454423567336, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5466247491069853, 'psi': 0.0}
[S8] START round=15 head_norm_before_train=1.901773 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.4767537357511743, 'psi': 0.35939447907390915}-{'f1_val': 0.5852518030686773, 'auprc': 0.5852518030686773, 'loss_val': 0.446305858922217, 'psi': 0.5852518030686773}
[S9] START round=15 head_norm_before_train=1.292264 cos_to_last_merge=0.9616 (last merge round=9)
[S9] round=15 local utility u=1.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6324842598385458, 'psi': 0.36867172340800847}-{'f1_val': 0.13004246284501061, 'auprc': 0.13004246284501061, 'loss_val': 1.9258045198486322, 'psi': 0.13004246284501061}
[S10] START round=15 head_norm_before_train=1.715953 (no previous merge yet)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.24964131994261118, 'auprc': 0.24964131994261118, 'loss_val': 2.8400371517438368, 'psi': 0.24964131994261118}-{'f1_val': 0.33293470461612057, 'auprc': 0.33293470461612057, 'loss_val': 2.91230534565303, 'psi': 0.33293470461612057}
[S11] START round=15 head_norm_before_train=1.613929 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.023359 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6010098321536506, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6477275564111633, 'psi': 0.0}
[S13] START round=15 head_norm_before_train=1.578526 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5018824957894914, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4447303924904342, 'psi': 0.3599362944611573}
[S14] START round=15 head_norm_before_train=1.502747 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.660538122186406, 'psi': 0.0}-{'f1_val': 0.006493506493506494, 'auprc': 0.006493506493506494, 'loss_val': 5.317409646157621, 'psi': 0.006493506493506494}
[S15] START round=15 head_norm_before_train=1.805924 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.5149087154129862, 'auprc': 0.5149087154129862, 'loss_val': 0.9445421847553156, 'psi': 0.5149087154129862}-{'f1_val': 0.5434119733130687, 'auprc': 0.5434119733130687, 'loss_val': 0.856008633064875, 'psi': 0.5434119733130687}
[S16] START round=15 head_norm_before_train=1.583367 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.0686108422071636, 'auprc': 0.0686108422071636, 'loss_val': 3.389196556223889, 'psi': 0.0686108422071636}-{'f1_val': 0.1240491515506144, 'auprc': 0.1240491515506144, 'loss_val': 2.9126873154005075, 'psi': 0.12404915155061438}
[S17] START round=15 head_norm_before_train=1.735407 (no previous merge yet)
[S17] round=15 local utility u=0.458367 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.8621516968156994, 'psi': 0.30380970798684975}-{'f1_val': 0.20257898130238558, 'auprc': 0.20257898130238558, 'loss_val': 0.8678099734879441, 'psi': 0.20257898130238558}
[S6] not sending this round → trigger blocked (psi=0.099)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:58312
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S9
[S14] cosine check vs S9: cos=0.0142
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9764
[S5] RECEIVED delta(kind=head bytes=1798) from S2
[S5] cosine check vs S2: cos=0.2263
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1806 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1806) from S17
[S9] cosine check vs S17: cos=-0.1649
[S9] DROPPED delta from S17 (cos=-0.1649 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.0000 head_norm=1.522873
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.005049e+00
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.019347 delta_norm=1.005049
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.047 → S5@127.0.0.1:58305
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.0000 head_norm=1.632722
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.261384e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.744838 delta_norm=0.226138
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.124 → S9@127.0.0.1:58310
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.0012 head_norm=1.543134
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.061238e+00
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.2498 head_norm=1.331019 delta_norm=1.061238
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.139 → S16@127.0.0.1:58316
[S6] ⇄ pheromone p=0.164 → S4@127.0.0.1:58304
[S15] ⇄ pheromone p=0.186 → S5@127.0.0.1:58305
[S7] ⇄ pheromone p=0.103 → S14@127.0.0.1:58314
[S3] ⇄ pheromone p=0.203 → S5@127.0.0.1:58305
[S13] ⇄ pheromone p=0.103 → S9@127.0.0.1:58310
[S8] ⇄ pheromone p=0.225 → S7@127.0.0.1:58308
[S10] ⇄ pheromone p=0.197 → S5@127.0.0.1:58305
[S9] ⇄ pheromone p=0.383 → S14@127.0.0.1:58314
[S4] ⇄ pheromone p=0.168 → S11@127.0.0.1:58312
[S2] ⇄ pheromone p=0.085 → S5@127.0.0.1:58305
[S16] ⇄ pheromone p=0.192 → S6@127.0.0.1:58307
[S17] ⇄ pheromone p=0.185 → S9@127.0.0.1:58310
[S2] START round=16 head_norm_before_train=1.847813 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.19188729657517611, 'auprc': 0.19188729657517611, 'loss_val': 4.194437373340809, 'psi': 0.19188729657517611}-{'f1_val': 0.2455690013445789, 'auprc': 0.2455690013445789, 'loss_val': 3.000387391457629, 'psi': 0.24556900134457893}
[S3] START round=16 head_norm_before_train=1.628531 (no previous merge yet)
[S3] round=16 local utility u=0.156331 metrics={'f1_val': 0.3006151377373629, 'auprc': 0.3006151377373629, 'loss_val': 2.753624888877711, 'psi': 0.3006151377373629}-{'f1_val': 0.2945521698984303, 'auprc': 0.2945521698984303, 'loss_val': 3.011719368594156, 'psi': 0.2945521698984303}
[S4] START round=16 head_norm_before_train=1.877609 (no previous merge yet)
[S4] round=16 local utility u=0.004689 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2163331786620184, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.225710367920361, 'psi': 0.3567939207526687}
[S5] START round=16 head_norm_before_train=1.331019 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=1.000000 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 1.2909977333575275, 'psi': 0.24981467753891773}-{'f1_val': 0.0012321340561853129, 'auprc': 0.0012321340561853129, 'loss_val': 1.340545074436773, 'psi': 0.0012321340561853129}
[S6] START round=16 head_norm_before_train=1.463628 cos_to_last_merge=0.8602 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.860
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.09992343032159265, 'auprc': 0.09992343032159265, 'loss_val': 5.155605075391325, 'psi': 0.09992343032159265}-{'f1_val': 0.09857801691006918, 'auprc': 0.09857801691006918, 'loss_val': 5.108397038716162, 'psi': 0.09857801691006918}
[S7] START round=16 head_norm_before_train=1.349984 (no previous merge yet)
[S7] round=16 local utility u=0.761769 metrics={'f1_val': 0.15617516250427643, 'auprc': 0.15617516250427643, 'loss_val': 1.3050834968654286, 'psi': 0.15617516250427643}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4230454423567336, 'psi': 0.0}
[S8] START round=16 head_norm_before_train=1.934242 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6877137442624216, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.4767537357511743, 'psi': 0.35939447907390915}
[S9] START round=16 head_norm_before_train=1.333882 cos_to_last_merge=0.9535 (last merge round=9)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6811425587683066, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6324842598385458, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.738301 (no previous merge yet)
[S10] round=16 local utility u=0.429198 metrics={'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.7305677381321316, 'psi': 0.332855321861058}-{'f1_val': 0.24964131994261118, 'auprc': 0.24964131994261118, 'loss_val': 2.8400371517438368, 'psi': 0.24964131994261118}
[S11] START round=16 head_norm_before_train=1.744838 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.753367025290035, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6010098321536506, 'psi': 0.0}
[S13] START round=16 head_norm_before_train=1.594976 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.571666006752942, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5018824957894914, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.019347 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=1.000000 metrics={'f1_val': 0.0058058522991175105, 'auprc': 0.0058058522991175105, 'loss_val': 3.1846459299598986, 'psi': 0.0058058522991175105}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.660538122186406, 'psi': 0.0}
[S15] START round=16 head_norm_before_train=1.850760 (no previous merge yet)
[S15] round=16 local utility u=0.187598 metrics={'f1_val': 0.5447886250218014, 'auprc': 0.5447886250218014, 'loss_val': 0.8382645562532332, 'psi': 0.5447886250218014}-{'f1_val': 0.5149087154129862, 'auprc': 0.5149087154129862, 'loss_val': 0.9445421847553156, 'psi': 0.5149087154129862}
[S16] START round=16 head_norm_before_train=1.610918 (no previous merge yet)
[S16] round=16 local utility u=0.048472 metrics={'f1_val': 0.0832561371005095, 'auprc': 0.0832561371005095, 'loss_val': 3.424061065956557, 'psi': 0.0832561371005095}-{'f1_val': 0.0686108422071636, 'auprc': 0.0686108422071636, 'loss_val': 3.389196556223889, 'psi': 0.0686108422071636}
[S17] START round=16 head_norm_before_train=1.761745 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.20368085218784462, 'auprc': 0.20368085218784462, 'loss_val': 0.840000895679016, 'psi': 0.20368085218784462}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.8621516968156994, 'psi': 0.30380970798684975}
[S16] not sending this round → trigger blocked (psi=0.083)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S7] not sending this round → trigger blocked (psi=0.156)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.006)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:58316
[S5] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=-0.0444
[S5] DROPPED delta from S15 (cos=-0.0444 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9864
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=0.6482
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.0014
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=-0.0228
[S5] DROPPED delta from S3 (cos=-0.0228 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.0000 head_norm=1.764246
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.669637e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.0000 head_norm=1.828925 delta_norm=0.166964
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.2498 head_norm=1.356182
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.840261e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.2498 head_norm=1.424630 delta_norm=0.684026
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.0833 head_norm=1.636238
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.061849e+00
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.1187 head_norm=1.063358 delta_norm=1.061849
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.862277 (no previous merge yet)
[S2] round=17 local utility u=1.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0931147325305792, 'psi': 0.3674775928297055}-{'f1_val': 0.19188729657517611, 'auprc': 0.19188729657517611, 'loss_val': 4.194437373340809, 'psi': 0.19188729657517611}
[S3] START round=17 head_norm_before_train=1.654223 (no previous merge yet)
[S3] round=17 local utility u=0.079352 metrics={'f1_val': 0.31113233070740826, 'auprc': 0.31113233070740826, 'loss_val': 2.6895751156342786, 'psi': 0.31113233070740826}-{'f1_val': 0.3006151377373629, 'auprc': 0.3006151377373629, 'loss_val': 2.753624888877711, 'psi': 0.3006151377373629}
[S4] START round=17 head_norm_before_train=1.906076 (no previous merge yet)
[S4] round=17 local utility u=0.000285 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2157625705602504, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2163331786620184, 'psi': 0.3567939207526687}
[S5] START round=17 head_norm_before_train=1.424630 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.009533 metrics={'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 1.272487129262865, 'psi': 0.24987642115669798}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 1.2909977333575275, 'psi': 0.24981467753891773}
[S6] START round=17 head_norm_before_train=1.486525 cos_to_last_merge=0.8572 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.857
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.04547432550043516, 'auprc': 0.04547432550043516, 'loss_val': 5.5170357303310755, 'psi': 0.04547432550043516}-{'f1_val': 0.09992343032159265, 'auprc': 0.09992343032159265, 'loss_val': 5.155605075391325, 'psi': 0.09992343032159265}
[S7] START round=17 head_norm_before_train=1.361357 (no previous merge yet)
[S7] round=17 local utility u=0.328025 metrics={'f1_val': 0.21505528777998298, 'auprc': 0.21505528777998298, 'loss_val': 1.1789555099069242, 'psi': 0.21505528777998298}-{'f1_val': 0.15617516250427643, 'auprc': 0.15617516250427643, 'loss_val': 1.3050834968654286, 'psi': 0.15617516250427643}
[S8] START round=17 head_norm_before_train=1.961963 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7810482707148717, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6877137442624216, 'psi': 0.35939447907390915}
[S9] START round=17 head_norm_before_train=1.373474 cos_to_last_merge=0.9462 (last merge round=9)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.2448137670909948, 'auprc': 0.2448137670909948, 'loss_val': 1.8626679597707025, 'psi': 0.24481376709099484}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6811425587683066, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.776428 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.24958163997131247, 'auprc': 0.24958163997131247, 'loss_val': 2.6439775374393886, 'psi': 0.24958163997131244}-{'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.7305677381321316, 'psi': 0.332855321861058}
[S11] START round=17 head_norm_before_train=1.828925 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.770421 metrics={'f1_val': 0.16087880935506732, 'auprc': 0.16087880935506732, 'loss_val': 1.6604341549208554, 'psi': 0.16087880935506732}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.753367025290035, 'psi': 0.0}
[S13] START round=17 head_norm_before_train=1.615315 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.618130314314145, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.571666006752942, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=1.040801 cos_to_last_merge=0.9993 (last merge round=15)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.023297491039426525, 'auprc': 0.023297491039426525, 'loss_val': 3.373998250967031, 'psi': 0.023297491039426525}-{'f1_val': 0.0058058522991175105, 'auprc': 0.0058058522991175105, 'loss_val': 3.1846459299598986, 'psi': 0.0058058522991175105}
[S15] START round=17 head_norm_before_train=1.894344 (no previous merge yet)
[S15] round=17 local utility u=0.005594 metrics={'f1_val': 0.5465464461970875, 'auprc': 0.5465464461970875, 'loss_val': 0.8428960198175603, 'psi': 0.5465464461970875}-{'f1_val': 0.5447886250218014, 'auprc': 0.5447886250218014, 'loss_val': 0.8382645562532332, 'psi': 0.5447886250218014}
[S16] START round=17 head_norm_before_train=1.063358 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.765258 metrics={'f1_val': 0.12883023932006263, 'auprc': 0.12883023932006263, 'loss_val': 2.303712441689413, 'psi': 0.12883023932006263}-{'f1_val': 0.0832561371005095, 'auprc': 0.0832561371005095, 'loss_val': 3.424061065956557, 'psi': 0.0832561371005095}
[S17] START round=17 head_norm_before_train=1.789340 (no previous merge yet)
[S17] round=17 local utility u=0.446048 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.849065127776053, 'psi': 0.30380970798684975}-{'f1_val': 0.20368085218784462, 'auprc': 0.20368085218784462, 'loss_val': 0.840000895679016, 'psi': 0.20368085218784462}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:58316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:58314
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.129)
[S11] not sending this round → trigger blocked (psi=0.161)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=-0.0050
[S5] DROPPED delta from S3 (cos=-0.0050 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S15
[S5] cosine check vs S15: cos=-0.0614
[S5] DROPPED delta from S15 (cos=-0.0614 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=0.4638
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.5304
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] cosine check vs S7: cos=-0.1234
[S14] DROPPED delta from S7 (cos=-0.1234 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] cosine check vs S17: cos=-0.1692
[S9] DROPPED delta from S17 (cos=-0.1692 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.1609 head_norm=1.849460
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.343714e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.2768 head_norm=1.885143 delta_norm=0.134371
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.2499 head_norm=1.450217
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.800615e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.2498 head_norm=1.426913 delta_norm=0.880062
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.1288 head_norm=1.105977
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.373617e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.1332 head_norm=1.121128 delta_norm=0.637362
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.875647 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.2567204603248436, 'psi': 0.2654773703336637}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0931147325305792, 'psi': 0.3674775928297055}
[S3] START round=18 head_norm_before_train=1.677923 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.2991266375545852, 'auprc': 0.2991266375545852, 'loss_val': 3.00605373830126, 'psi': 0.2991266375545852}-{'f1_val': 0.31113233070740826, 'auprc': 0.31113233070740826, 'loss_val': 2.6895751156342786, 'psi': 0.31113233070740826}
[S4] START round=18 head_norm_before_train=1.929544 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.223680688569513, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2157625705602504, 'psi': 0.3567939207526687}
[S5] START round=18 head_norm_before_train=1.426913 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.027198 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 1.2175349122779302, 'psi': 0.24981467753891773}-{'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 1.272487129262865, 'psi': 0.24987642115669798}
[S6] START round=18 head_norm_before_train=1.508002 cos_to_last_merge=0.8544 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=18 local utility u=0.116937 metrics={'f1_val': 0.07402120717781403, 'auprc': 0.07402120717781403, 'loss_val': 5.540084067750841, 'psi': 0.07402120717781403}-{'f1_val': 0.04547432550043516, 'auprc': 0.04547432550043516, 'loss_val': 5.5170357303310755, 'psi': 0.04547432550043516}
[S7] START round=18 head_norm_before_train=1.381490 (no previous merge yet)
[S7] round=18 local utility u=0.006240 metrics={'f1_val': 0.20767888307155322, 'auprc': 0.20767888307155322, 'loss_val': 1.100088120525651, 'psi': 0.20767888307155322}-{'f1_val': 0.21505528777998298, 'auprc': 0.21505528777998298, 'loss_val': 1.1789555099069242, 'psi': 0.21505528777998298}
[S8] START round=18 head_norm_before_train=1.988501 (no previous merge yet)
[S8] round=18 local utility u=0.057095 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.666857891136394, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7810482707148717, 'psi': 0.35939447907390915}
[S9] START round=18 head_norm_before_train=1.410860 cos_to_last_merge=0.9401 (last merge round=9)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=18 local utility u=0.528554 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9202820013322843, 'psi': 0.36867172340800847}-{'f1_val': 0.2448137670909948, 'auprc': 0.2448137670909948, 'loss_val': 1.8626679597707025, 'psi': 0.24481376709099484}
[S10] START round=18 head_norm_before_train=1.822214 (no previous merge yet)
[S10] round=18 local utility u=0.033443 metrics={'f1_val': 0.2496414913957935, 'auprc': 0.2496414913957935, 'loss_val': 2.5776293557128933, 'psi': 0.2496414913957935}-{'f1_val': 0.24958163997131247, 'auprc': 0.24958163997131247, 'loss_val': 2.6439775374393886, 'psi': 0.24958163997131244}
[S11] START round=18 head_norm_before_train=1.885143 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.705267 metrics={'f1_val': 0.32293166906705073, 'auprc': 0.32293166906705073, 'loss_val': 1.708375881746787, 'psi': 0.32293166906705073}-{'f1_val': 0.16087880935506732, 'auprc': 0.16087880935506732, 'loss_val': 1.6604341549208554, 'psi': 0.16087880935506732}
[S13] START round=18 head_norm_before_train=1.638771 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6679144889099125, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.618130314314145, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.072897 cos_to_last_merge=0.9968 (last merge round=15)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.663430324517132, 'psi': 0.0}-{'f1_val': 0.023297491039426525, 'auprc': 0.023297491039426525, 'loss_val': 3.373998250967031, 'psi': 0.023297491039426525}
[S15] START round=18 head_norm_before_train=1.932687 (no previous merge yet)
[S15] round=18 local utility u=0.176919 metrics={'f1_val': 0.5727589036365394, 'auprc': 0.5727589036365394, 'loss_val': 0.7249708885381037, 'psi': 0.5727589036365394}-{'f1_val': 0.5465464461970875, 'auprc': 0.5465464461970875, 'loss_val': 0.8428960198175603, 'psi': 0.5465464461970875}
[S16] START round=18 head_norm_before_train=1.121128 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.253191 metrics={'f1_val': 0.13653733098177542, 'auprc': 0.13653733098177542, 'loss_val': 1.8666941930482728, 'psi': 0.13653733098177542}-{'f1_val': 0.12883023932006263, 'auprc': 0.12883023932006263, 'loss_val': 2.303712441689413, 'psi': 0.12883023932006263}
[S17] START round=18 head_norm_before_train=1.813483 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.21095661496133242, 'auprc': 0.21095661496133242, 'loss_val': 0.8282335301014351, 'psi': 0.21095661496133244}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.849065127776053, 'psi': 0.30380970798684975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:58308
[S16] not sending this round → trigger blocked (psi=0.137)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:58316
[S6] not sending this round → trigger blocked (psi=0.074)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.5499
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=-0.0282
[S5] DROPPED delta from S15 (cos=-0.0282 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.8052
[S14] RECEIVED delta(kind=head bytes=1804) from S9
[S14] cosine check vs S9: cos=0.6053
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=-0.1179
[S14] DROPPED delta from S7 (cos=-0.1179 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] cosine check vs S11: cos=0.1276
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] cosine check vs S8: cos=-0.1450
[S7] DROPPED delta from S8 (cos=-0.1450 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.0000 head_norm=1.113693
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.871443e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.0000 head_norm=1.148151 delta_norm=0.587144
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.2498 head_norm=1.448606
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.092584e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.2498 head_norm=1.464843 delta_norm=0.809258
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.3687 head_norm=1.444183
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.119868e+00
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.3687 head_norm=1.266976 delta_norm=1.119868
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.1365 head_norm=1.159062
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.295666e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.1408 head_norm=1.239522 delta_norm=0.429567
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.888687 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.2650793650793651, 'auprc': 0.2650793650793651, 'loss_val': 3.3972398351113693, 'psi': 0.2650793650793651}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.2567204603248436, 'psi': 0.2654773703336637}
[S3] START round=19 head_norm_before_train=1.699447 (no previous merge yet)
[S3] round=19 local utility u=0.124381 metrics={'f1_val': 0.3077174891562321, 'auprc': 0.3077174891562321, 'loss_val': 2.8346098364182297, 'psi': 0.3077174891562321}-{'f1_val': 0.2991266375545852, 'auprc': 0.2991266375545852, 'loss_val': 3.00605373830126, 'psi': 0.2991266375545852}
[S4] START round=19 head_norm_before_train=1.960370 (no previous merge yet)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2332196930066137, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.223680688569513, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.464843 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 1.3481903991819715, 'psi': 0.24987642115669798}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 1.2175349122779302, 'psi': 0.24981467753891773}
[S6] START round=19 head_norm_before_train=1.530574 cos_to_last_merge=0.8515 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.852
[S6] round=19 local utility u=0.095317 metrics={'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 5.574622496533167, 'psi': 0.09904030710172745}-{'f1_val': 0.07402120717781403, 'auprc': 0.07402120717781403, 'loss_val': 5.540084067750841, 'psi': 0.07402120717781403}
[S7] START round=19 head_norm_before_train=1.407284 (no previous merge yet)
[S7] round=19 local utility u=0.255683 metrics={'f1_val': 0.24993779547151032, 'auprc': 0.24993779547151032, 'loss_val': 0.9690525413890289, 'psi': 0.24993779547151032}-{'f1_val': 0.20767888307155322, 'auprc': 0.20767888307155322, 'loss_val': 1.100088120525651, 'psi': 0.20767888307155322}
[S8] START round=19 head_norm_before_train=2.014816 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.687413099720796, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.666857891136394, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.266976 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.277882 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3645178461347043, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9202820013322843, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.871595 (no previous merge yet)
[S10] round=19 local utility u=0.053273 metrics={'f1_val': 0.24970131421744324, 'auprc': 0.24970131421744324, 'loss_val': 2.4716219411109046, 'psi': 0.24970131421744324}-{'f1_val': 0.2496414913957935, 'auprc': 0.2496414913957935, 'loss_val': 2.5776293557128933, 'psi': 0.2496414913957935}
[S11] START round=19 head_norm_before_train=1.906043 cos_to_last_merge=0.9990 (last merge round=17)
[S11] round=19 local utility u=0.058901 metrics={'f1_val': 0.3317050476855083, 'auprc': 0.3317050476855083, 'loss_val': 1.6695350219564287, 'psi': 0.3317050476855083}-{'f1_val': 0.32293166906705073, 'auprc': 0.32293166906705073, 'loss_val': 1.708375881746787, 'psi': 0.32293166906705073}
[S13] START round=19 head_norm_before_train=1.658586 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.711341380425544, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6679144889099125, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.148151 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.667696 metrics={'f1_val': 0.0411522633744856, 'auprc': 0.0411522633744856, 'loss_val': 2.6984089889275533, 'psi': 0.0411522633744856}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.663430324517132, 'psi': 0.0}
[S15] START round=19 head_norm_before_train=1.975213 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.5151093388564588, 'auprc': 0.5151093388564588, 'loss_val': 0.9518947939196762, 'psi': 0.5151093388564588}-{'f1_val': 0.5727589036365394, 'auprc': 0.5727589036365394, 'loss_val': 0.7249708885381037, 'psi': 0.5727589036365394}
[S16] START round=19 head_norm_before_train=1.239522 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.051398 metrics={'f1_val': 0.14311633645402425, 'auprc': 0.14311633645402425, 'loss_val': 1.823109265961556, 'psi': 0.14311633645402425}-{'f1_val': 0.13653733098177542, 'auprc': 0.13653733098177542, 'loss_val': 1.8666941930482728, 'psi': 0.13653733098177542}
[S17] START round=19 head_norm_before_train=1.837260 (no previous merge yet)
[S17] round=19 local utility u=0.384501 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.8949102825398475, 'psi': 0.30380970798684975}-{'f1_val': 0.21095661496133242, 'auprc': 0.21095661496133242, 'loss_val': 0.8282335301014351, 'psi': 0.21095661496133244}
[S6] not sending this round → trigger blocked (psi=0.099)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[S14] not sending this round → trigger blocked (psi=0.041)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:58310
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.143)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:58314
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=-0.0985
[S14] DROPPED delta from S7 (cos=-0.0985 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] cosine check vs S3: cos=-0.0036
[S5] DROPPED delta from S3 (cos=-0.0036 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.8083
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.6426
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.9068
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S17
[S9] cosine check vs S17: cos=-0.2302
[S9] DROPPED delta from S17 (cos=-0.2302 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.2499 head_norm=1.491006
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.237197e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.2502 head_norm=1.666110 delta_norm=0.423720
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.250 u=0.0000 p_local=0.1649 f1=0.250 auprc=0.250 bytes=10809
[S8] r=20 psi=0.359 u=0.0000 p_local=0.1014 f1=0.359 auprc=0.359 bytes=12599
[S2] r=20 psi=0.265 u=0.0000 p_local=0.1627 f1=0.265 auprc=0.265 bytes=7193
[S6] r=20 psi=0.099 u=0.0953 p_local=0.1048 f1=0.099 auprc=0.099 bytes=0
[S13] r=20 psi=0.360 u=0.0000 p_local=0.0422 f1=0.360 auprc=0.360 bytes=3596
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.0412 head_norm=1.185197
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.285884e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.0333 head_norm=1.127736 delta_norm=0.528588
[S14] aggregate: ROLLBACK (f1_val pre=0.041 post=0.033 tol_abs=0.005 tol_rel=0.0)
[S14] r=20 psi=0.041 u=0.6677 p_local=0.2552 f1=0.041 auprc=0.041 bytes=0
[S4] r=20 psi=0.357 u=0.0000 p_local=0.0694 f1=0.357 auprc=0.357 bytes=10799
[S15] r=20 psi=0.515 u=0.0000 p_local=0.1246 f1=0.515 auprc=0.515 bytes=9009
[S16] r=20 psi=0.143 u=0.0514 p_local=0.2325 f1=0.143 auprc=0.143 bytes=0
[S11] r=20 psi=0.332 u=0.0589 p_local=0.2739 f1=0.332 auprc=0.332 bytes=3595
[S10] r=20 psi=0.250 u=0.0533 p_local=0.1407 f1=0.250 auprc=0.250 bytes=10797
[S3] r=20 psi=0.308 u=0.1244 p_local=0.1340 f1=0.308 auprc=0.308 bytes=9007
[S7] r=20 psi=0.250 u=0.2557 p_local=0.2143 f1=0.250 auprc=0.250 bytes=9000
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.3687 head_norm=1.302957
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.833446e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.3687 head_norm=1.541188 delta_norm=0.583345
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.369 u=0.2779 p_local=0.2972 f1=0.369 auprc=0.369 bytes=5404
[S17] r=20 psi=0.304 u=0.3845 p_local=0.2098 f1=0.304 auprc=0.304 bytes=14419
[S2] START round=20 head_norm_before_train=1.901230 (no previous merge yet)
[S2] round=20 local utility u=0.009085 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.381936796320103, 'psi': 0.2653978324081417}-{'f1_val': 0.2650793650793651, 'auprc': 0.2650793650793651, 'loss_val': 3.3972398351113693, 'psi': 0.2650793650793651}
[S3] START round=20 head_norm_before_train=1.718136 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.27770876466528643, 'auprc': 0.27770876466528643, 'loss_val': 2.643297721620029, 'psi': 0.27770876466528643}-{'f1_val': 0.3077174891562321, 'auprc': 0.3077174891562321, 'loss_val': 2.8346098364182297, 'psi': 0.3077174891562321}
[S4] START round=20 head_norm_before_train=1.976023 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2360454934235203, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2332196930066137, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.666110 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 1.7424851255152942, 'psi': 0.2501920777223545}-{'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 1.3481903991819715, 'psi': 0.24987642115669798}
[S6] START round=20 head_norm_before_train=1.551876 cos_to_last_merge=0.8487 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.849
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 5.66616731958269, 'psi': 0.09934790947449175}-{'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 5.574622496533167, 'psi': 0.09904030710172745}
[S7] START round=20 head_norm_before_train=1.428073 (no previous merge yet)
[S7] round=20 local utility u=0.428059 metrics={'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.8627489738660163, 'psi': 0.3332504352151206}-{'f1_val': 0.24993779547151032, 'auprc': 0.24993779547151032, 'loss_val': 0.9690525413890289, 'psi': 0.24993779547151032}
[S8] START round=20 head_norm_before_train=2.040171 (no previous merge yet)
[S8] round=20 local utility u=0.104661 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.4780912521189579, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.687413099720796, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.541188 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.111600 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.1413187684495973, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3645178461347043, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.920370 (no previous merge yet)
[S10] round=20 local utility u=0.029143 metrics={'f1_val': 0.24970131421744324, 'auprc': 0.24970131421744324, 'loss_val': 2.4133367589932377, 'psi': 0.24970131421744324}-{'f1_val': 0.24970131421744324, 'auprc': 0.24970131421744324, 'loss_val': 2.4716219411109046, 'psi': 0.24970131421744324}
[S11] START round=20 head_norm_before_train=1.932203 cos_to_last_merge=0.9966 (last merge round=17)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.33232252546458285, 'auprc': 0.33232252546458285, 'loss_val': 1.8884329876315733, 'psi': 0.33232252546458285}-{'f1_val': 0.3317050476855083, 'auprc': 0.3317050476855083, 'loss_val': 1.6695350219564287, 'psi': 0.3317050476855083}
[S13] START round=20 head_norm_before_train=1.677508 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7187583745732273, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.711341380425544, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.127736 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6395043146516786, 'psi': 0.0}-{'f1_val': 0.0411522633744856, 'auprc': 0.0411522633744856, 'loss_val': 2.6984089889275533, 'psi': 0.0411522633744856}
[S15] START round=20 head_norm_before_train=2.011442 (no previous merge yet)
[S15] round=20 local utility u=0.038563 metrics={'f1_val': 0.5223347280100347, 'auprc': 0.5223347280100347, 'loss_val': 0.9397965242916047, 'psi': 0.5223347280100347}-{'f1_val': 0.5151093388564588, 'auprc': 0.5151093388564588, 'loss_val': 0.9518947939196762, 'psi': 0.5151093388564588}
[S16] START round=20 head_norm_before_train=1.272038 cos_to_last_merge=0.9946 (last merge round=18)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.09101796407185629, 'auprc': 0.09101796407185629, 'loss_val': 2.4037609012457577, 'psi': 0.09101796407185629}-{'f1_val': 0.14311633645402425, 'auprc': 0.14311633645402425, 'loss_val': 1.823109265961556, 'psi': 0.14311633645402425}
[S17] START round=20 head_norm_before_train=1.858871 (no previous merge yet)
[S17] round=20 local utility u=0.035291 metrics={'f1_val': 0.305462446064211, 'auprc': 0.305462446064211, 'loss_val': 0.8392020555485189, 'psi': 0.305462446064211}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.8949102825398475, 'psi': 0.30380970798684975}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:58308
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[S8] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.9783
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=-0.0555
[S5] DROPPED delta from S15 (cos=-0.0555 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S8
[S7] cosine check vs S8: cos=-0.1429
[S7] DROPPED delta from S8 (cos=-0.1429 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=0.3010
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=-0.0805
[S14] DROPPED delta from S7 (cos=-0.0805 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=0.7391
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S17
[S9] cosine check vs S17: cos=-0.2133
[S9] DROPPED delta from S17 (cos=-0.2133 < 0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.2502 head_norm=1.691751
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.278546e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.2502 head_norm=1.516081 delta_norm=0.427855
[S5] aggregate: ACCEPT kept=['S10', 'S2'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.132 → S16@127.0.0.1:58316
[S4] ⇄ pheromone p=0.056 → S11@127.0.0.1:58312
[S3] ⇄ pheromone p=0.107 → S5@127.0.0.1:58305
[S11] ⇄ pheromone p=0.219 → S9@127.0.0.1:58310
[S6] ⇄ pheromone p=0.084 → S4@127.0.0.1:58304
[S13] ⇄ pheromone p=0.034 → S9@127.0.0.1:58310
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.0000 head_norm=1.169370
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.292758e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.0006 head_norm=1.279970 delta_norm=0.529276
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.204 → S5@127.0.0.1:58305
[S8] ⇄ pheromone p=0.102 → S7@127.0.0.1:58308
[S15] ⇄ pheromone p=0.107 → S5@127.0.0.1:58305
[S10] ⇄ pheromone p=0.118 → S5@127.0.0.1:58305
[S9] ⇄ pheromone p=0.260 → S14@127.0.0.1:58314
[S2] ⇄ pheromone p=0.132 → S5@127.0.0.1:58305
[S7] ⇄ pheromone p=0.257 → S14@127.0.0.1:58314
[S16] ⇄ pheromone p=0.186 → S6@127.0.0.1:58307
[S17] ⇄ pheromone p=0.175 → S9@127.0.0.1:58310
[S2] START round=21 head_norm_before_train=1.913233 (no previous merge yet)
[S2] round=21 local utility u=0.024311 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.334030775047962, 'psi': 0.2654773703336637}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.381936796320103, 'psi': 0.2653978324081417}
[S3] START round=21 head_norm_before_train=1.734174 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.2900686168291802, 'auprc': 0.2900686168291802, 'loss_val': 2.762893016939739, 'psi': 0.2900686168291802}-{'f1_val': 0.27770876466528643, 'auprc': 0.27770876466528643, 'loss_val': 2.643297721620029, 'psi': 0.27770876466528643}
[S4] START round=21 head_norm_before_train=1.998086 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2533514531937346, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2360454934235203, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.516081 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.342892 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8065356639247623, 'psi': 0.3335071121394324}-{'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 1.7424851255152942, 'psi': 0.2501920777223545}
[S6] START round=21 head_norm_before_train=1.569937 cos_to_last_merge=0.8463 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.846
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.016658954187875982, 'auprc': 0.016658954187875982, 'loss_val': 6.147859528372201, 'psi': 0.016658954187875982}-{'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 5.66616731958269, 'psi': 0.09934790947449175}
[S7] START round=21 head_norm_before_train=1.451165 (no previous merge yet)
[S7] round=21 local utility u=0.020575 metrics={'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.8215991935287436, 'psi': 0.3332504352151206}-{'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.8627489738660163, 'psi': 0.3332504352151206}
[S8] START round=21 head_norm_before_train=2.061502 (no previous merge yet)
[S8] round=21 local utility u=0.089232 metrics={'f1_val': 0.3745495646661923, 'auprc': 0.3745495646661923, 'loss_val': 0.43602298749611573, 'psi': 0.3745495646661923}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.4780912521189579, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.571460 cos_to_last_merge=0.9980 (last merge round=19)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.2725040736948061, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.1413187684495973, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.967866 (no previous merge yet)
[S10] round=21 local utility u=0.018652 metrics={'f1_val': 0.24970145689037496, 'auprc': 0.24970145689037496, 'loss_val': 2.376034987105731, 'psi': 0.24970145689037493}-{'f1_val': 0.24970131421744324, 'auprc': 0.24970131421744324, 'loss_val': 2.4133367589932377, 'psi': 0.24970131421744324}
[S11] START round=21 head_norm_before_train=1.955585 cos_to_last_merge=0.9940 (last merge round=17)
[S11] round=21 local utility u=0.018849 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 1.8465605130015634, 'psi': 0.33185875048506014}-{'f1_val': 0.33232252546458285, 'auprc': 0.33232252546458285, 'loss_val': 1.8884329876315733, 'psi': 0.33232252546458285}
[S13] START round=21 head_norm_before_train=1.691141 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7396669624965384, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7187583745732273, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.279970 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.188476 metrics={'f1_val': 0.05910064239828694, 'auprc': 0.05910064239828694, 'loss_val': 2.7944571775996088, 'psi': 0.05910064239828694}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6395043146516786, 'psi': 0.0}
[S15] START round=21 head_norm_before_train=2.042325 (no previous merge yet)
[S15] round=21 local utility u=0.275173 metrics={'f1_val': 0.5646640644661353, 'auprc': 0.5646640644661353, 'loss_val': 0.7704154407137869, 'psi': 0.5646640644661353}-{'f1_val': 0.5223347280100347, 'auprc': 0.5223347280100347, 'loss_val': 0.9397965242916047, 'psi': 0.5223347280100347}
[S16] START round=21 head_norm_before_train=1.320997 cos_to_last_merge=0.9800 (last merge round=18)
[S16] round=21 local utility u=0.076203 metrics={'f1_val': 0.10723655443812856, 'auprc': 0.10723655443812856, 'loss_val': 2.3973221979587085, 'psi': 0.10723655443812856}-{'f1_val': 0.09101796407185629, 'auprc': 0.09101796407185629, 'loss_val': 2.4037609012457577, 'psi': 0.09101796407185629}
[S17] START round=21 head_norm_before_train=1.881879 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.9314164300583866, 'psi': 0.30380970798684975}-{'f1_val': 0.305462446064211, 'auprc': 0.305462446064211, 'loss_val': 0.8392020555485189, 'psi': 0.305462446064211}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.059)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.107)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:58310
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:58314
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=-0.1406
[S7] DROPPED delta from S8 (cos=-0.1406 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] cosine check vs S2: cos=0.5220
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=-0.0470
[S5] DROPPED delta from S15 (cos=-0.0470 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.9031
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.9366
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.8259
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=-0.0543
[S14] DROPPED delta from S7 (cos=-0.0543 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.3687 head_norm=1.613448
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.671618e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.3687 head_norm=1.768079 delta_norm=0.367162
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.3335 head_norm=1.541051
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.171542e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.2498 head_norm=1.489311 delta_norm=0.217154
[S5] aggregate: ROLLBACK (f1_val pre=0.334 post=0.250 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.1072 head_norm=1.378459
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.376884e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.1105 head_norm=1.394963 delta_norm=0.437688
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.924639 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.381843858557577, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.334030775047962, 'psi': 0.2654773703336637}
[S3] START round=22 head_norm_before_train=1.749478 (no previous merge yet)
[S3] round=22 local utility u=0.006604 metrics={'f1_val': 0.2999775129300652, 'auprc': 0.2999775129300652, 'loss_val': 2.8388659281131643, 'psi': 0.2999775129300652}-{'f1_val': 0.2900686168291802, 'auprc': 0.2900686168291802, 'loss_val': 2.762893016939739, 'psi': 0.2900686168291802}
[S4] START round=22 head_norm_before_train=2.017251 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2744107990691576, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2533514531937346, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.489311 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9355959339727238, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8065356639247623, 'psi': 0.3335071121394324}
[S6] START round=22 head_norm_before_train=1.586923 cos_to_last_merge=0.8441 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.844
[S6] round=22 local utility u=0.567564 metrics={'f1_val': 0.1003440366972477, 'auprc': 0.1003440366972477, 'loss_val': 5.7658970351155725, 'psi': 0.1003440366972477}-{'f1_val': 0.016658954187875982, 'auprc': 0.016658954187875982, 'loss_val': 6.147859528372201, 'psi': 0.016658954187875982}
[S7] START round=22 head_norm_before_train=1.473940 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.8239672184451743, 'psi': 0.3332504352151206}-{'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.8215991935287436, 'psi': 0.3332504352151206}
[S8] START round=22 head_norm_before_train=2.081172 (no previous merge yet)
[S8] round=22 local utility u=0.416865 metrics={'f1_val': 0.4648853211009174, 'auprc': 0.4648853211009174, 'loss_val': 0.41531432751749453, 'psi': 0.4648853211009174}-{'f1_val': 0.3745495646661923, 'auprc': 0.3745495646661923, 'loss_val': 0.43602298749611573, 'psi': 0.3745495646661923}
[S9] START round=22 head_norm_before_train=1.768079 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.018337 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.2358294681635367, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.2725040736948061, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=2.007109 (no previous merge yet)
[S10] round=22 local utility u=0.435592 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2546733009769837, 'psi': 0.33301496338745623}-{'f1_val': 0.24970145689037496, 'auprc': 0.24970145689037496, 'loss_val': 2.376034987105731, 'psi': 0.24970145689037493}
[S11] START round=22 head_norm_before_train=1.979548 cos_to_last_merge=0.9914 (last merge round=17)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.9090266673508165, 'psi': 0.3320133550741517}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 1.8465605130015634, 'psi': 0.33185875048506014}
[S13] START round=22 head_norm_before_train=1.703938 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7606866423148384, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7396669624965384, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.319205 cos_to_last_merge=0.9960 (last merge round=20)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.10615040168576322, 'auprc': 0.10615040168576322, 'loss_val': 3.3733657117399543, 'psi': 0.10615040168576322}-{'f1_val': 0.05910064239828694, 'auprc': 0.05910064239828694, 'loss_val': 2.7944571775996088, 'psi': 0.05910064239828694}
[S15] START round=22 head_norm_before_train=2.070172 (no previous merge yet)
[S15] round=22 local utility u=0.128036 metrics={'f1_val': 0.581885347840123, 'auprc': 0.581885347840123, 'loss_val': 0.669334707642325, 'psi': 0.581885347840123}-{'f1_val': 0.5646640644661353, 'auprc': 0.5646640644661353, 'loss_val': 0.7704154407137869, 'psi': 0.5646640644661353}
[S16] START round=22 head_norm_before_train=1.394963 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.345340 metrics={'f1_val': 0.14251412429378532, 'auprc': 0.14251412429378532, 'loss_val': 2.0241412532015843, 'psi': 0.14251412429378532}-{'f1_val': 0.10723655443812856, 'auprc': 0.10723655443812856, 'loss_val': 2.3973221979587085, 'psi': 0.10723655443812856}
[S17] START round=22 head_norm_before_train=1.908296 (no previous merge yet)
[S17] round=22 local utility u=0.157222 metrics={'f1_val': 0.3324121341527276, 'auprc': 0.3324121341527276, 'loss_val': 0.8743938222460671, 'psi': 0.3324121341527276}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.9314164300583866, 'psi': 0.30380970798684975}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.100)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.143)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:58314
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:58308
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] cosine check vs S3: cos=-0.0033
[S5] DROPPED delta from S3 (cos=-0.0033 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=-0.0389
[S5] DROPPED delta from S15 (cos=-0.0389 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.8388
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] cosine check vs S8: cos=-0.1381
[S7] DROPPED delta from S8 (cos=-0.1381 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S9
[S14] cosine check vs S9: cos=0.8823
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=-0.2063
[S9] DROPPED delta from S17 (cos=-0.2063 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.1062 head_norm=1.369573
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.382545e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.1299 head_norm=1.539353 delta_norm=0.438255
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.3331 head_norm=1.514352
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.646910e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.3331 head_norm=1.706692 delta_norm=0.564691
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.935348 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.393958336948742, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.381843858557577, 'psi': 0.2654773703336637}
[S3] START round=23 head_norm_before_train=1.764035 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.285917698989036, 'auprc': 0.285917698989036, 'loss_val': 2.8224256170276734, 'psi': 0.285917698989036}-{'f1_val': 0.2999775129300652, 'auprc': 0.2999775129300652, 'loss_val': 2.8388659281131643, 'psi': 0.2999775129300652}
[S4] START round=23 head_norm_before_train=2.033412 (no previous merge yet)
[S4] round=23 local utility u=0.001963 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2704848007260503, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2744107990691576, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.706692 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9748066997392062, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9355959339727238, 'psi': 0.33308623671855697}
[S6] START round=23 head_norm_before_train=1.600420 cos_to_last_merge=0.8423 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.842
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 5.890214823072697, 'psi': 0.09965504024530472}-{'f1_val': 0.1003440366972477, 'auprc': 0.1003440366972477, 'loss_val': 5.7658970351155725, 'psi': 0.1003440366972477}
[S7] START round=23 head_norm_before_train=1.496683 (no previous merge yet)
[S7] round=23 local utility u=0.018033 metrics={'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.7879020515751517, 'psi': 0.3332504352151206}-{'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.8239672184451743, 'psi': 0.3332504352151206}
[S8] START round=23 head_norm_before_train=2.100436 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.4604080950786761, 'psi': 0.35939447907390915}-{'f1_val': 0.4648853211009174, 'auprc': 0.4648853211009174, 'loss_val': 0.41531432751749453, 'psi': 0.4648853211009174}
[S9] START round=23 head_norm_before_train=1.802114 cos_to_last_merge=0.9981 (last merge round=21)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3935131861130712, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.2358294681635367, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=2.042078 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3194057554641905, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2546733009769837, 'psi': 0.33301496338745623}
[S11] START round=23 head_norm_before_train=1.998784 cos_to_last_merge=0.9893 (last merge round=17)
[S11] round=23 local utility u=0.013574 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 1.8784015726675318, 'psi': 0.33162711338607104}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.9090266673508165, 'psi': 0.3320133550741517}
[S13] START round=23 head_norm_before_train=1.714680 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7888141848976606, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7606866423148384, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.539353 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.05910064239828694, 'auprc': 0.05910064239828694, 'loss_val': 3.2624144567762903, 'psi': 0.05910064239828694}-{'f1_val': 0.10615040168576322, 'auprc': 0.10615040168576322, 'loss_val': 3.3733657117399543, 'psi': 0.10615040168576322}
[S15] START round=23 head_norm_before_train=2.096142 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.5260233688490973, 'auprc': 0.5260233688490973, 'loss_val': 0.8643543968927218, 'psi': 0.5260233688490973}-{'f1_val': 0.581885347840123, 'auprc': 0.581885347840123, 'loss_val': 0.669334707642325, 'psi': 0.581885347840123}
[S16] START round=23 head_norm_before_train=1.435932 cos_to_last_merge=0.9972 (last merge round=21)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.06053067993366501, 'auprc': 0.06053067993366501, 'loss_val': 2.7850010593160195, 'psi': 0.06053067993366501}-{'f1_val': 0.14251412429378532, 'auprc': 0.14251412429378532, 'loss_val': 2.0241412532015843, 'psi': 0.14251412429378532}
[S17] START round=23 head_norm_before_train=1.926824 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.0251797942734031, 'psi': 0.30380970798684975}-{'f1_val': 0.3324121341527276, 'auprc': 0.3324121341527276, 'loss_val': 0.8743938222460671, 'psi': 0.3324121341527276}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:58310
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9729
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=-0.0322
[S14] DROPPED delta from S7 (cos=-0.0322 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S11
[S9] cosine check vs S11: cos=0.9635
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.3687 head_norm=1.840670
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.746032e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.3687 head_norm=1.910972 delta_norm=0.274603
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.3316 head_norm=2.016525
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.373349e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.3316 head_norm=2.018819 delta_norm=0.237335
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.945189 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.4188762130573314, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.393958336948742, 'psi': 0.2654773703336637}
[S3] START round=24 head_norm_before_train=1.777302 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.2822025565388397, 'auprc': 0.2822025565388397, 'loss_val': 2.8305829464056242, 'psi': 0.2822025565388397}-{'f1_val': 0.285917698989036, 'auprc': 0.285917698989036, 'loss_val': 2.8224256170276734, 'psi': 0.285917698989036}
[S4] START round=24 head_norm_before_train=2.048790 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.277665312501998, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2704848007260503, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.725097 cos_to_last_merge=0.9997 (last merge round=22)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.111364850167622, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9748066997392062, 'psi': 0.33308623671855697}
[S6] START round=24 head_norm_before_train=1.614748 cos_to_last_merge=0.8404 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.840
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.09961685823754789, 'auprc': 0.09961685823754789, 'loss_val': 5.942710458031758, 'psi': 0.09961685823754789}-{'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 5.890214823072697, 'psi': 0.09965504024530472}
[S7] START round=24 head_norm_before_train=1.512707 (no previous merge yet)
[S7] round=24 local utility u=0.045168 metrics={'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.6975656851717701, 'psi': 0.3332504352151206}-{'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.7879020515751517, 'psi': 0.3332504352151206}
[S8] START round=24 head_norm_before_train=2.117013 (no previous merge yet)
[S8] round=24 local utility u=1.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.163746983102204, 'psi': 0.9988708350860451}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.4604080950786761, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.910972 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.026043 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.341427485086492, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3935131861130712, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=2.072543 (no previous merge yet)
[S10] round=24 local utility u=0.003881 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.311643090194979, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3194057554641905, 'psi': 0.33301496338745623}
[S11] START round=24 head_norm_before_train=2.018819 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.094727 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 1.6931139995656788, 'psi': 0.3320901320901321}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 1.8784015726675318, 'psi': 0.33162711338607104}
[S13] START round=24 head_norm_before_train=1.725349 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.822835741677986, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7888141848976606, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.578869 cos_to_last_merge=0.9980 (last merge round=22)
[S14] round=24 local utility u=0.108243 metrics={'f1_val': 0.12186379928315412, 'auprc': 0.12186379928315412, 'loss_val': 3.610797171117984, 'psi': 0.12186379928315413}-{'f1_val': 0.05910064239828694, 'auprc': 0.05910064239828694, 'loss_val': 3.2624144567762903, 'psi': 0.05910064239828694}
[S15] START round=24 head_norm_before_train=2.121984 (no previous merge yet)
[S15] round=24 local utility u=0.071819 metrics={'f1_val': 0.5443961443855018, 'auprc': 0.5443961443855018, 'loss_val': 0.8860711984626686, 'psi': 0.5443961443855018}-{'f1_val': 0.5260233688490973, 'auprc': 0.5260233688490973, 'loss_val': 0.8643543968927218, 'psi': 0.5260233688490973}
[S16] START round=24 head_norm_before_train=1.483551 cos_to_last_merge=0.9906 (last merge round=21)
[S16] round=24 local utility u=0.445886 metrics={'f1_val': 0.14332399626517273, 'auprc': 0.14332399626517273, 'loss_val': 2.6383687601632313, 'psi': 0.14332399626517273}-{'f1_val': 0.06053067993366501, 'auprc': 0.06053067993366501, 'loss_val': 2.7850010593160195, 'psi': 0.06053067993366501}
[S17] START round=24 head_norm_before_train=1.950159 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.1587853157441046, 'psi': 0.30380970798684975}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.0251797942734031, 'psi': 0.30380970798684975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:58314
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.122)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S16] not sending this round → trigger blocked (psi=0.143)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=-0.0517
[S5] DROPPED delta from S15 (cos=-0.0517 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.9654
[S14] RECEIVED delta(kind=head bytes=1795) from S7
[S14] cosine check vs S7: cos=-0.0315
[S14] DROPPED delta from S7 (cos=-0.0315 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=-0.1373
[S7] DROPPED delta from S8 (cos=-0.1373 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.9446
[S9] RECEIVED delta(kind=head bytes=1794) from S11
[S9] cosine check vs S11: cos=0.9825
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.1219 head_norm=1.621377
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.357304e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.1329 head_norm=1.756751 delta_norm=0.335730
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.3331 head_norm=1.744335
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.075368e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.3331 head_norm=1.904744 delta_norm=0.307537
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.3687 head_norm=1.941369
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.917410e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.3687 head_norm=1.980221 delta_norm=0.191741
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.954677 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.433960709416696, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.4188762130573314, 'psi': 0.2654773703336637}
[S3] START round=25 head_norm_before_train=1.789302 (no previous merge yet)
[S3] round=25 local utility u=0.003609 metrics={'f1_val': 0.287637874230053, 'auprc': 0.287637874230053, 'loss_val': 2.8722834691991053, 'psi': 0.287637874230053}-{'f1_val': 0.2822025565388397, 'auprc': 0.2822025565388397, 'loss_val': 2.8305829464056242, 'psi': 0.2822025565388397}
[S4] START round=25 head_norm_before_train=2.059703 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2994109919475245, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.277665312501998, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.904744 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.144370628804151, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.111364850167622, 'psi': 0.33308623671855697}
[S6] START round=25 head_norm_before_train=1.629194 cos_to_last_merge=0.8386 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.09977020298736117, 'auprc': 0.09977020298736117, 'loss_val': 6.006549186981494, 'psi': 0.09977020298736117}-{'f1_val': 0.09961685823754789, 'auprc': 0.09961685823754789, 'loss_val': 5.942710458031758, 'psi': 0.09961685823754789}
[S7] START round=25 head_norm_before_train=1.525550 (no previous merge yet)
[S7] round=25 local utility u=0.017723 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6613735755370462, 'psi': 0.33316757831924415}-{'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.6975656851717701, 'psi': 0.3332504352151206}
[S8] START round=25 head_norm_before_train=2.128857 (no previous merge yet)
[S8] round=25 local utility u=0.051495 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.06075654396727245, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.163746983102204, 'psi': 0.9988708350860451}
[S9] START round=25 head_norm_before_train=1.980221 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3659176399221247, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.341427485086492, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=2.098226 (no previous merge yet)
[S10] round=25 local utility u=0.004394 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3028552630434147, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.311643090194979, 'psi': 0.33301496338745623}
[S11] START round=25 head_norm_before_train=2.036459 cos_to_last_merge=0.9999 (last merge round=23)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.710122965084653, 'psi': 0.3319360347772085}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 1.6931139995656788, 'psi': 0.3320901320901321}
[S13] START round=25 head_norm_before_train=1.736903 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.871258423970174, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.822835741677986, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.756751 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.205637 metrics={'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 3.2937099453422114, 'psi': 0.13232893910860014}-{'f1_val': 0.12186379928315412, 'auprc': 0.12186379928315412, 'loss_val': 3.610797171117984, 'psi': 0.12186379928315413}
[S15] START round=25 head_norm_before_train=2.141243 (no previous merge yet)
[S15] round=25 local utility u=0.380603 metrics={'f1_val': 0.6015849109603107, 'auprc': 0.6015849109603107, 'loss_val': 0.6395642482533223, 'psi': 0.6015849109603107}-{'f1_val': 0.5443961443855018, 'auprc': 0.5443961443855018, 'loss_val': 0.8860711984626686, 'psi': 0.5443961443855018}
[S16] START round=25 head_norm_before_train=1.527959 cos_to_last_merge=0.9835 (last merge round=21)
[S16] round=25 local utility u=0.049593 metrics={'f1_val': 0.1529940119760479, 'auprc': 0.1529940119760479, 'loss_val': 2.6262132779836493, 'psi': 0.1529940119760479}-{'f1_val': 0.14332399626517273, 'auprc': 0.14332399626517273, 'loss_val': 2.6383687601632313, 'psi': 0.14332399626517273}
[S17] START round=25 head_norm_before_train=1.979498 (no previous merge yet)
[S17] round=25 local utility u=1.000000 metrics={'f1_val': 0.5459994612068966, 'auprc': 0.5459994612068966, 'loss_val': 0.927310983544778, 'psi': 0.5459994612068966}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.1587853157441046, 'psi': 0.30380970798684975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.153)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S14] not sending this round → trigger blocked (psi=0.132)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=-0.1363
[S7] DROPPED delta from S8 (cos=-0.1363 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=0.9911
[S5] RECEIVED delta(kind=head bytes=1804) from S3
[S5] cosine check vs S3: cos=0.0179
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=-0.0552
[S5] DROPPED delta from S15 (cos=-0.0552 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=-0.0132
[S14] DROPPED delta from S7 (cos=-0.0132 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=-0.2038
[S9] DROPPED delta from S17 (cos=-0.2038 < 0.0)
[S4] ⇄ pheromone p=0.018 → S11@127.0.0.1:58312
[S9] ⇄ pheromone p=0.091 → S14@127.0.0.1:58314
[S2] ⇄ pheromone p=0.045 → S5@127.0.0.1:58305
[S6] ⇄ pheromone p=0.086 → S4@127.0.0.1:58304
[S11] ⇄ pheromone p=0.090 → S9@127.0.0.1:58310
[S14] ⇄ pheromone p=0.141 → S5@127.0.0.1:58305
[S13] ⇄ pheromone p=0.011 → S9@127.0.0.1:58310
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.3331 head_norm=1.922190
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.254498e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.3331 head_norm=1.562897 delta_norm=0.625450
[S5] aggregate: ACCEPT kept=['S10', 'S3'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.071 → S16@127.0.0.1:58316
[S16] ⇄ pheromone p=0.184 → S6@127.0.0.1:58307
[S15] ⇄ pheromone p=0.158 → S5@127.0.0.1:58305
[S3] ⇄ pheromone p=0.037 → S5@127.0.0.1:58305
[S8] ⇄ pheromone p=0.254 → S7@127.0.0.1:58308
[S10] ⇄ pheromone p=0.086 → S5@127.0.0.1:58305
[S7] ⇄ pheromone p=0.099 → S14@127.0.0.1:58314
[S17] ⇄ pheromone p=0.273 → S9@127.0.0.1:58310
[S2] START round=26 head_norm_before_train=1.963789 (no previous merge yet)
[S2] round=26 local utility u=0.006130 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.421701027020962, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.433960709416696, 'psi': 0.2654773703336637}
[S3] START round=26 head_norm_before_train=1.801203 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.28084868788386375, 'auprc': 0.28084868788386375, 'loss_val': 2.851683568189364, 'psi': 0.28084868788386375}-{'f1_val': 0.287637874230053, 'auprc': 0.287637874230053, 'loss_val': 2.8722834691991053, 'psi': 0.287637874230053}
[S4] START round=26 head_norm_before_train=2.066564 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3101471551629853, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2994109919475245, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.562897 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.037417 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.0695360063467163, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.144370628804151, 'psi': 0.33308623671855697}
[S6] START round=26 head_norm_before_train=1.642975 cos_to_last_merge=0.8368 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.837
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.061686949223667645, 'auprc': 0.061686949223667645, 'loss_val': 6.2251322448952155, 'psi': 0.061686949223667645}-{'f1_val': 0.09977020298736117, 'auprc': 0.09977020298736117, 'loss_val': 6.006549186981494, 'psi': 0.09977020298736117}
[S7] START round=26 head_norm_before_train=1.543438 (no previous merge yet)
[S7] round=26 local utility u=0.018939 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6234959043580073, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6613735755370462, 'psi': 0.33316757831924415}
[S8] START round=26 head_norm_before_train=2.141398 (no previous merge yet)
[S8] round=26 local utility u=0.004574 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.0516084134036311, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.06075654396727245, 'psi': 0.9988708350860451}
[S9] START round=26 head_norm_before_train=2.009154 cos_to_last_merge=0.9988 (last merge round=24)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4939928940899438, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3659176399221247, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=2.121144 (no previous merge yet)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.358069265561626, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3028552630434147, 'psi': 0.33301496338745623}
[S11] START round=26 head_norm_before_train=2.054778 cos_to_last_merge=0.9995 (last merge round=23)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 1.8061575167312045, 'psi': 0.33201273984308244}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.710122965084653, 'psi': 0.3319360347772085}
[S13] START round=26 head_norm_before_train=1.752401 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9152357659208636, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.871258423970174, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.791507 cos_to_last_merge=0.9991 (last merge round=24)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.68218357562167, 'psi': 0.13572854291417166}-{'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 3.2937099453422114, 'psi': 0.13232893910860014}
[S15] START round=26 head_norm_before_train=2.157444 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.5455091951287945, 'auprc': 0.5455091951287945, 'loss_val': 0.7775697637206462, 'psi': 0.5455091951287945}-{'f1_val': 0.6015849109603107, 'auprc': 0.6015849109603107, 'loss_val': 0.6395642482533223, 'psi': 0.6015849109603107}
[S16] START round=26 head_norm_before_train=1.566223 cos_to_last_merge=0.9774 (last merge round=21)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.12383233532934132, 'auprc': 0.12383233532934132, 'loss_val': 2.7279783816441836, 'psi': 0.12383233532934132}-{'f1_val': 0.1529940119760479, 'auprc': 0.1529940119760479, 'loss_val': 2.6262132779836493, 'psi': 0.1529940119760479}
[S17] START round=26 head_norm_before_train=2.005950 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.5114829234636045, 'auprc': 0.5114829234636045, 'loss_val': 1.0238168817172586, 'psi': 0.5114829234636045}-{'f1_val': 0.5459994612068966, 'auprc': 0.5459994612068966, 'loss_val': 0.927310983544778, 'psi': 0.5459994612068966}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:58308
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:58305
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S2
[S5] cosine check vs S2: cos=0.1747
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=-0.0142
[S14] DROPPED delta from S7 (cos=-0.0142 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] cosine check vs S8: cos=-0.1346
[S7] DROPPED delta from S8 (cos=-0.1346 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.7309
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.3331 head_norm=1.577608
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.150326e+00
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.3331 head_norm=1.366343 delta_norm=1.150326
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.1238 head_norm=1.597878
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.824686e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.1213 head_norm=1.477078 delta_norm=0.582469
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.972674 (no previous merge yet)
[S2] round=27 local utility u=0.002790 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.4161204905805036, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.421701027020962, 'psi': 0.2654773703336637}
[S3] START round=27 head_norm_before_train=1.812990 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.281786941580756, 'auprc': 0.281786941580756, 'loss_val': 2.8887909582747717, 'psi': 0.281786941580756}-{'f1_val': 0.28084868788386375, 'auprc': 0.28084868788386375, 'loss_val': 2.851683568189364, 'psi': 0.28084868788386375}
[S4] START round=27 head_norm_before_train=2.070357 (no previous merge yet)
[S4] round=27 local utility u=0.011816 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2865154123141966, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3101471551629853, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.366343 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.072720 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9240965583506664, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.0695360063467163, 'psi': 0.33308623671855697}
[S6] START round=27 head_norm_before_train=1.655291 cos_to_last_merge=0.8351 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.835
[S6] round=27 local utility u=0.207187 metrics={'f1_val': 0.09961685823754789, 'auprc': 0.09961685823754789, 'loss_val': 6.152128114475038, 'psi': 0.09961685823754789}-{'f1_val': 0.061686949223667645, 'auprc': 0.061686949223667645, 'loss_val': 6.2251322448952155, 'psi': 0.061686949223667645}
[S7] START round=27 head_norm_before_train=1.565198 (no previous merge yet)
[S7] round=27 local utility u=0.003190 metrics={'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.6178619823060139, 'psi': 0.3332504352151206}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6234959043580073, 'psi': 0.33316757831924415}
[S8] START round=27 head_norm_before_train=2.153337 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.08789727814786738, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.0516084134036311, 'psi': 0.9988708350860451}
[S9] START round=27 head_norm_before_train=2.039324 cos_to_last_merge=0.9960 (last merge round=24)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5898604051639407, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4939928940899438, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=2.142035 (no previous merge yet)
[S10] round=27 local utility u=0.003852 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.35036587999111, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.358069265561626, 'psi': 0.33301496338745623}
[S11] START round=27 head_norm_before_train=2.071724 cos_to_last_merge=0.9989 (last merge round=23)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.819574383097027, 'psi': 0.3320133550741517}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 1.8061575167312045, 'psi': 0.33201273984308244}
[S13] START round=27 head_norm_before_train=1.769701 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9465639044018475, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9152357659208636, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.826659 cos_to_last_merge=0.9969 (last merge round=24)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 4.048332130681857, 'psi': 0.13373403456048086}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.68218357562167, 'psi': 0.13572854291417166}
[S15] START round=27 head_norm_before_train=2.172600 (no previous merge yet)
[S15] round=27 local utility u=0.129012 metrics={'f1_val': 0.5701525863053029, 'auprc': 0.5701525863053029, 'loss_val': 0.7413360603412155, 'psi': 0.5701525863053029}-{'f1_val': 0.5455091951287945, 'auprc': 0.5455091951287945, 'loss_val': 0.7775697637206462, 'psi': 0.5455091951287945}
[S16] START round=27 head_norm_before_train=1.477078 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.162438 metrics={'f1_val': 0.1056091148115688, 'auprc': 0.1056091148115688, 'loss_val': 2.2390927717479885, 'psi': 0.1056091148115688}-{'f1_val': 0.12383233532934132, 'auprc': 0.12383233532934132, 'loss_val': 2.7279783816441836, 'psi': 0.12383233532934132}
[S17] START round=27 head_norm_before_train=2.026887 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.4067025508849623, 'auprc': 0.4067025508849623, 'loss_val': 1.2773647112992346, 'psi': 0.4067025508849623}-{'f1_val': 0.5114829234636045, 'auprc': 0.5114829234636045, 'loss_val': 1.0238168817172586, 'psi': 0.5114829234636045}
[S6] not sending this round → trigger blocked (psi=0.100)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:58305
[S16] not sending this round → trigger blocked (psi=0.106)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S2
[S5] cosine check vs S2: cos=0.8187
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=-0.0135
[S5] DROPPED delta from S15 (cos=-0.0135 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.6351
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9842
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=-0.0151
[S14] DROPPED delta from S7 (cos=-0.0151 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1806) from S5
[S16] cosine check vs S5: cos=0.8382
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.3331 head_norm=1.389877
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.995345e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.3331 head_norm=1.456295 delta_norm=0.199534
[S5] aggregate: ACCEPT kept=['S2', 'S10'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.3320 head_norm=2.088864
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.849397e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.3320 head_norm=2.074615 delta_norm=0.184940
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.1056 head_norm=1.506221
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.156514e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.1423 head_norm=1.388331 delta_norm=0.415651
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.981085 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.5140562884570126, 'psi': 0.2653978324081417}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.4161204905805036, 'psi': 0.2654773703336637}
[S3] START round=28 head_norm_before_train=1.824084 (no previous merge yet)
[S3] round=28 local utility u=0.060412 metrics={'f1_val': 0.3085412295018264, 'auprc': 0.3085412295018264, 'loss_val': 3.008755093831371, 'psi': 0.3085412295018264}-{'f1_val': 0.281786941580756, 'auprc': 0.281786941580756, 'loss_val': 2.8887909582747717, 'psi': 0.281786941580756}
[S4] START round=28 head_norm_before_train=2.076801 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.29668863403373, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2865154123141966, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.456295 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.029511 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8650754213735325, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9240965583506664, 'psi': 0.33308623671855697}
[S6] START round=28 head_norm_before_train=1.667000 cos_to_last_merge=0.8335 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.834
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.09609435421500387, 'auprc': 0.09609435421500387, 'loss_val': 6.253798301963031, 'psi': 0.09609435421500387}-{'f1_val': 0.09961685823754789, 'auprc': 0.09961685823754789, 'loss_val': 6.152128114475038, 'psi': 0.09961685823754789}
[S7] START round=28 head_norm_before_train=1.585487 (no previous merge yet)
[S7] round=28 local utility u=0.003231 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6106548857097094, 'psi': 0.33316757831924415}-{'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.6178619823060139, 'psi': 0.3332504352151206}
[S8] START round=28 head_norm_before_train=2.168291 (no previous merge yet)
[S8] round=28 local utility u=0.011896 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.06410515268890908, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.08789727814786738, 'psi': 0.9988708350860451}
[S9] START round=28 head_norm_before_train=2.065696 cos_to_last_merge=0.9929 (last merge round=24)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6725737357191548, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5898604051639407, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=2.161352 (no previous merge yet)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3624360271669693, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.35036587999111, 'psi': 0.33301496338745623}
[S11] START round=28 head_norm_before_train=2.074615 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.083943 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.6516878014168734, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.819574383097027, 'psi': 0.3320133550741517}
[S13] START round=28 head_norm_before_train=1.779524 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.966607700801406, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9465639044018475, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.857667 cos_to_last_merge=0.9944 (last merge round=24)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 4.296754557657295, 'psi': 0.1345336334083521}-{'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 4.048332130681857, 'psi': 0.13373403456048086}
[S15] START round=28 head_norm_before_train=2.187896 (no previous merge yet)
[S15] round=28 local utility u=0.024023 metrics={'f1_val': 0.5761851859708614, 'auprc': 0.5761851859708614, 'loss_val': 0.7475840358070662, 'psi': 0.5761851859708614}-{'f1_val': 0.5701525863053029, 'auprc': 0.5701525863053029, 'loss_val': 0.7413360603412155, 'psi': 0.5701525863053029}
[S16] START round=28 head_norm_before_train=1.388331 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.117990 metrics={'f1_val': 0.13723763393512403, 'auprc': 0.13723763393512403, 'loss_val': 2.287769488826442, 'psi': 0.13723763393512403}-{'f1_val': 0.1056091148115688, 'auprc': 0.1056091148115688, 'loss_val': 2.2390927717479885, 'psi': 0.1056091148115688}
[S17] START round=28 head_norm_before_train=2.051207 (no previous merge yet)
[S17] round=28 local utility u=1.000000 metrics={'f1_val': 0.6054184733330948, 'auprc': 0.6054184733330948, 'loss_val': 0.988896963832799, 'psi': 0.6054184733330948}-{'f1_val': 0.4067025508849623, 'auprc': 0.4067025508849623, 'loss_val': 1.2773647112992346, 'psi': 0.4067025508849623}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:58310
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=-0.0208
[S5] DROPPED delta from S15 (cos=-0.0208 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=0.9738
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[S16] not sending this round → trigger blocked (psi=0.137)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:58316
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] cosine check vs S8: cos=-0.1311
[S7] DROPPED delta from S8 (cos=-0.1311 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=-0.0154
[S14] DROPPED delta from S7 (cos=-0.0154 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=-0.2059
[S9] DROPPED delta from S17 (cos=-0.2059 < 0.0)
[S5] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.9641
[S3] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] cosine check vs S3: cos=0.0685
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.3687 head_norm=2.087336
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.393142e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.3687 head_norm=2.076182 delta_norm=0.239314
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.3331 head_norm=1.477723
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.137872e+00
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.3331 head_norm=1.216765 delta_norm=1.137872
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.1372 head_norm=1.426562
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.962371e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.1391 head_norm=1.439049 delta_norm=0.196237
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.989141 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.540717279139025, 'psi': 0.2653978324081417}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.5140562884570126, 'psi': 0.2653978324081417}
[S3] START round=29 head_norm_before_train=1.834905 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.28244060171516944, 'auprc': 0.28244060171516944, 'loss_val': 2.926091602674707, 'psi': 0.28244060171516944}-{'f1_val': 0.3085412295018264, 'auprc': 0.3085412295018264, 'loss_val': 3.008755093831371, 'psi': 0.3085412295018264}
[S4] START round=29 head_norm_before_train=2.087066 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.312396991427259, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.29668863403373, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.216765 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9286140854538338, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8650754213735325, 'psi': 0.33308623671855697}
[S6] START round=29 head_norm_before_train=1.678505 cos_to_last_merge=0.8320 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.832
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.0946837407838572, 'auprc': 0.0946837407838572, 'loss_val': 6.293499970720508, 'psi': 0.0946837407838572}-{'f1_val': 0.09609435421500387, 'auprc': 0.09609435421500387, 'loss_val': 6.253798301963031, 'psi': 0.09609435421500387}
[S7] START round=29 head_norm_before_train=1.600445 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.5626232060912797, 'psi': 0.24975124378109453}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6106548857097094, 'psi': 0.33316757831924415}
[S8] START round=29 head_norm_before_train=2.181210 (no previous merge yet)
[S8] round=29 local utility u=0.007652 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.04880109307752037, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.06410515268890908, 'psi': 0.9988708350860451}
[S9] START round=29 head_norm_before_train=2.076182 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.030494 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6115848875464602, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6725737357191548, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=2.179292 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3963265178488258, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3624360271669693, 'psi': 0.33301496338745623}
[S11] START round=29 head_norm_before_train=2.092519 cos_to_last_merge=0.9999 (last merge round=27)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.7481103618053808, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.6516878014168734, 'psi': 0.3320133550741517}
[S13] START round=29 head_norm_before_train=1.787114 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.975802557290722, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.966607700801406, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.884178 cos_to_last_merge=0.9919 (last merge round=24)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.443196116361001, 'psi': 0.13572854291417166}-{'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 4.296754557657295, 'psi': 0.1345336334083521}
[S15] START round=29 head_norm_before_train=2.200989 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.564125464031104, 'auprc': 0.564125464031104, 'loss_val': 0.791260887883072, 'psi': 0.564125464031104}-{'f1_val': 0.5761851859708614, 'auprc': 0.5761851859708614, 'loss_val': 0.7475840358070662, 'psi': 0.5761851859708614}
[S16] START round=29 head_norm_before_train=1.439049 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.10685439860292513, 'auprc': 0.10685439860292513, 'loss_val': 2.290832338178661, 'psi': 0.10685439860292514}-{'f1_val': 0.13723763393512403, 'auprc': 0.13723763393512403, 'loss_val': 2.287769488826442, 'psi': 0.13723763393512403}
[S17] START round=29 head_norm_before_train=2.070750 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5737535133905454, 'auprc': 0.5737535133905454, 'loss_val': 1.0478885622867633, 'psi': 0.5737535133905454}-{'f1_val': 0.6054184733330948, 'auprc': 0.6054184733330948, 'loss_val': 0.988896963832799, 'psi': 0.6054184733330948}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:58308
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.9531
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S8
[S7] cosine check vs S8: cos=-0.1308
[S7] DROPPED delta from S8 (cos=-0.1308 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.1357 head_norm=1.907279
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.198327e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.1359 head_norm=1.976974 delta_norm=0.319833
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.996892 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.5424481305697597, 'psi': 0.2653978324081417}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.540717279139025, 'psi': 0.2653978324081417}
[S3] START round=30 head_norm_before_train=1.844717 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.2758809817633347, 'auprc': 0.2758809817633347, 'loss_val': 2.9112251873359374, 'psi': 0.2758809817633347}-{'f1_val': 0.28244060171516944, 'auprc': 0.28244060171516944, 'loss_val': 2.926091602674707, 'psi': 0.28244060171516944}
[S4] START round=30 head_norm_before_train=2.093605 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3177461423523684, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.312396991427259, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.234085 cos_to_last_merge=0.9993 (last merge round=28)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.002398398312455, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9286140854538338, 'psi': 0.33308623671855697}
[S6] START round=30 head_norm_before_train=1.689355 cos_to_last_merge=0.8306 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.831
[S6] round=30 local utility u=0.024831 metrics={'f1_val': 0.09950153374233128, 'auprc': 0.09950153374233128, 'loss_val': 6.287197268385249, 'psi': 0.09950153374233128}-{'f1_val': 0.0946837407838572, 'auprc': 0.0946837407838572, 'loss_val': 6.293499970720508, 'psi': 0.0946837407838572}
[S7] START round=30 head_norm_before_train=1.610050 (no previous merge yet)
[S7] round=30 local utility u=0.396449 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5204722776451404, 'psi': 0.33316757831924415}-{'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.5626232060912797, 'psi': 0.24975124378109453}
[S8] START round=30 head_norm_before_train=2.190841 (no previous merge yet)
[S8] round=30 local utility u=0.007676 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.033448224211227146, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.04880109307752037, 'psi': 0.9988708350860451}
[S9] START round=30 head_norm_before_train=2.093735 cos_to_last_merge=0.9998 (last merge round=28)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7007038065921023, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6115848875464602, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=2.196038 (no previous merge yet)
[S10] round=30 local utility u=0.001841 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.392643663414536, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3963265178488258, 'psi': 0.33301496338745623}
[S11] START round=30 head_norm_before_train=2.110873 cos_to_last_merge=0.9995 (last merge round=27)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.8436140014068945, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.7481103618053808, 'psi': 0.3320133550741517}
[S13] START round=30 head_norm_before_train=1.798125 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.02489551977396, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.975802557290722, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.976974 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.360301 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.722594853771304, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.443196116361001, 'psi': 0.13572854291417166}
[S15] START round=30 head_norm_before_train=2.213024 (no previous merge yet)
[S15] round=30 local utility u=0.338665 metrics={'f1_val': 0.6140933634089104, 'auprc': 0.6140933634089104, 'loss_val': 0.5636412757070453, 'psi': 0.6140933634089104}-{'f1_val': 0.564125464031104, 'auprc': 0.564125464031104, 'loss_val': 0.791260887883072, 'psi': 0.564125464031104}
[S16] START round=30 head_norm_before_train=1.481158 cos_to_last_merge=0.9980 (last merge round=28)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.11835803876852907, 'auprc': 0.11835803876852907, 'loss_val': 2.4014822834822747, 'psi': 0.11835803876852907}-{'f1_val': 0.10685439860292513, 'auprc': 0.10685439860292513, 'loss_val': 2.290832338178661, 'psi': 0.10685439860292514}
[S17] START round=30 head_norm_before_train=2.085662 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5082567348192348, 'auprc': 0.5082567348192348, 'loss_val': 1.2589735287713246, 'psi': 0.5082567348192348}-{'f1_val': 0.5737535133905454, 'auprc': 0.5737535133905454, 'loss_val': 1.0478885622867633, 'psi': 0.5737535133905454}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.100)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:58314
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=-0.0034
[S14] DROPPED delta from S7 (cos=-0.0034 < 0.0)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S14] not sending this round → trigger blocked (psi=0.136)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.4788
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] cosine check vs S8: cos=-0.1301
[S7] DROPPED delta from S8 (cos=-0.1301 < 0.0)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.0176
[S2] ⇄ pheromone p=0.016 → S5@127.0.0.1:58305
[S7] ⇄ pheromone p=0.114 → S14@127.0.0.1:58314
[S11] ⇄ pheromone p=0.040 → S9@127.0.0.1:58310
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.3331 head_norm=1.261162
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.975454e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.3335 head_norm=1.152583 delta_norm=0.797545
[S5] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.038 → S16@127.0.0.1:58316
[S10] ⇄ pheromone p=0.029 → S5@127.0.0.1:58305
[S3] ⇄ pheromone p=0.020 → S5@127.0.0.1:58305
[S8] ⇄ pheromone p=0.088 → S7@127.0.0.1:58308
[S4] ⇄ pheromone p=0.007 → S11@127.0.0.1:58312
[S9] ⇄ pheromone p=0.035 → S14@127.0.0.1:58314
[S6] ⇄ pheromone p=0.054 → S4@127.0.0.1:58304
[S15] ⇄ pheromone p=0.136 → S5@127.0.0.1:58305
[S13] ⇄ pheromone p=0.004 → S9@127.0.0.1:58310
[S14] ⇄ pheromone p=0.118 → S5@127.0.0.1:58305
[S16] ⇄ pheromone p=0.092 → S6@127.0.0.1:58307
[S17] ⇄ pheromone p=0.218 → S9@127.0.0.1:58310
[S2] START round=31 head_norm_before_train=2.004242 (no previous merge yet)
[S2] round=31 local utility u=0.003602 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.535960338957695, 'psi': 0.2654773703336637}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.5424481305697597, 'psi': 0.2653978324081417}
[S3] START round=31 head_norm_before_train=1.854155 (no previous merge yet)
[S3] round=31 local utility u=0.004515 metrics={'f1_val': 0.28214310792781405, 'auprc': 0.28214310792781405, 'loss_val': 2.958554835667206, 'psi': 0.28214310792781405}-{'f1_val': 0.2758809817633347, 'auprc': 0.2758809817633347, 'loss_val': 2.9112251873359374, 'psi': 0.2758809817633347}
[S4] START round=31 head_norm_before_train=2.099925 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.326224812105935, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3177461423523684, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.152583 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.083544 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.839097285119918, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.002398398312455, 'psi': 0.33308623671855697}
[S6] START round=31 head_norm_before_train=1.699551 cos_to_last_merge=0.8292 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.829
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 6.339130617615064, 'psi': 0.09934790947449175}-{'f1_val': 0.09950153374233128, 'auprc': 0.09950153374233128, 'loss_val': 6.287197268385249, 'psi': 0.09950153374233128}
[S7] START round=31 head_norm_before_train=1.620473 (no previous merge yet)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5216133452923913, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5204722776451404, 'psi': 0.33316757831924415}
[S8] START round=31 head_norm_before_train=2.198943 (no previous merge yet)
[S8] round=31 local utility u=0.001015 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.03141901952396433, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.033448224211227146, 'psi': 0.9988708350860451}
[S9] START round=31 head_norm_before_train=2.111937 cos_to_last_merge=0.9991 (last merge round=28)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7716109057016691, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7007038065921023, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=2.211794 (no previous merge yet)
[S10] round=31 local utility u=0.002862 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3869192369805883, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.392643663414536, 'psi': 0.33301496338745623}
[S11] START round=31 head_norm_before_train=2.128210 cos_to_last_merge=0.9989 (last merge round=27)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 1.9315530696527745, 'psi': 0.33201273984308244}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.8436140014068945, 'psi': 0.3320133550741517}
[S13] START round=31 head_norm_before_train=1.817425 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0599755912136266, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.02489551977396, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.996057 cos_to_last_merge=0.9999 (last merge round=29)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 3.9442322988976057, 'psi': 0.13533083645443197}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.722594853771304, 'psi': 0.13572854291417166}
[S15] START round=31 head_norm_before_train=2.225844 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.5632391241092519, 'auprc': 0.5632391241092519, 'loss_val': 0.7098706664684818, 'psi': 0.5632391241092519}-{'f1_val': 0.6140933634089104, 'auprc': 0.6140933634089104, 'loss_val': 0.5636412757070453, 'psi': 0.6140933634089104}
[S16] START round=31 head_norm_before_train=1.525118 cos_to_last_merge=0.9929 (last merge round=28)
[S16] round=31 local utility u=0.306922 metrics={'f1_val': 0.1749502982107356, 'auprc': 0.1749502982107356, 'loss_val': 2.2969686013657937, 'psi': 0.1749502982107356}-{'f1_val': 0.11835803876852907, 'auprc': 0.11835803876852907, 'loss_val': 2.4014822834822747, 'psi': 0.11835803876852907}
[S17] START round=31 head_norm_before_train=2.103610 (no previous merge yet)
[S17] round=31 local utility u=0.074634 metrics={'f1_val': 0.520673653364114, 'auprc': 0.520673653364114, 'loss_val': 1.2214570769853965, 'psi': 0.520673653364114}-{'f1_val': 0.5082567348192348, 'auprc': 0.5082567348192348, 'loss_val': 1.2589735287713246, 'psi': 0.5082567348192348}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.175)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:58315
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.4472
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.5632 head_norm=2.234404
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.003739e+00
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.5516 head_norm=1.481374 delta_norm=1.003739
[S15] aggregate: ROLLBACK (f1_val pre=0.563 post=0.552 tol_abs=0.005 tol_rel=0.0)
[S2] START round=32 head_norm_before_train=2.011538 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.5380680550619505, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.535960338957695, 'psi': 0.2654773703336637}
[S3] START round=32 head_norm_before_train=1.862993 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.28008630890234565, 'auprc': 0.28008630890234565, 'loss_val': 2.9544694274475605, 'psi': 0.28008630890234565}-{'f1_val': 0.28214310792781405, 'auprc': 0.28214310792781405, 'loss_val': 2.958554835667206, 'psi': 0.28214310792781405}
[S4] START round=32 head_norm_before_train=2.108784 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3411548638228588, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.326224812105935, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.188008 cos_to_last_merge=0.9980 (last merge round=30)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.977577381848204, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.839097285119918, 'psi': 0.3335071121394324}
[S6] START round=32 head_norm_before_train=1.709160 cos_to_last_merge=0.8279 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.828
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.3961831283494766, 'psi': 0.09904030710172745}-{'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 6.339130617615064, 'psi': 0.09934790947449175}
[S7] START round=32 head_norm_before_train=1.632266 (no previous merge yet)
[S7] round=32 local utility u=0.004814 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5119862728205206, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5216133452923913, 'psi': 0.33316757831924415}
[S8] START round=32 head_norm_before_train=2.205152 (no previous merge yet)
[S8] round=32 local utility u=0.005525 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.020368226555843128, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.03141901952396433, 'psi': 0.9988708350860451}
[S9] START round=32 head_norm_before_train=2.128838 cos_to_last_merge=0.9983 (last merge round=28)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8367626629915499, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7716109057016691, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=2.226754 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.40852252148933, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3869192369805883, 'psi': 0.33301496338745623}
[S11] START round=32 head_norm_before_train=2.145337 cos_to_last_merge=0.9982 (last merge round=27)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 1.9431250986345006, 'psi': 0.33185875048506014}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 1.9315530696527745, 'psi': 0.33201273984308244}
[S13] START round=32 head_norm_before_train=1.834700 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.083153964856576, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0599755912136266, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=2.015634 cos_to_last_merge=0.9995 (last merge round=29)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.151025976893675, 'psi': 0.13333333333333333}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 3.9442322988976057, 'psi': 0.13533083645443197}
[S15] START round=32 head_norm_before_train=1.481374 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.090988 metrics={'f1_val': 0.5719958544895317, 'auprc': 0.5719958544895317, 'loss_val': 0.6067060827017049, 'psi': 0.5719958544895317}-{'f1_val': 0.5632391241092519, 'auprc': 0.5632391241092519, 'loss_val': 0.7098706664684818, 'psi': 0.5632391241092519}
[S16] START round=32 head_norm_before_train=1.564476 cos_to_last_merge=0.9875 (last merge round=28)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.1724384659416142, 'auprc': 0.1724384659416142, 'loss_val': 2.4835619705375427, 'psi': 0.1724384659416142}-{'f1_val': 0.1749502982107356, 'auprc': 0.1749502982107356, 'loss_val': 2.2969686013657937, 'psi': 0.1749502982107356}
[S17] START round=32 head_norm_before_train=2.121087 (no previous merge yet)
[S17] round=32 local utility u=0.119478 metrics={'f1_val': 0.5459994612068966, 'auprc': 0.5459994612068966, 'loss_val': 1.2104324151639099, 'psi': 0.5459994612068966}-{'f1_val': 0.520673653364114, 'auprc': 0.520673653364114, 'loss_val': 1.2214570769853965, 'psi': 0.520673653364114}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:58309
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S7
[S8] cosine check vs S7: cos=-0.1286
[S8] DROPPED delta from S7 (cos=-0.1286 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=33 head_norm_before_train=2.018514 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.5396843552026813, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.5380680550619505, 'psi': 0.2654773703336637}
[S3] START round=33 head_norm_before_train=1.871363 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.2803204458376872, 'auprc': 0.2803204458376872, 'loss_val': 2.9730486716985274, 'psi': 0.2803204458376872}-{'f1_val': 0.28008630890234565, 'auprc': 0.28008630890234565, 'loss_val': 2.9544694274475605, 'psi': 0.28008630890234565}
[S4] START round=33 head_norm_before_train=2.122194 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3473504626187678, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3411548638228588, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.222640 cos_to_last_merge=0.9935 (last merge round=30)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.0521999422200543, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.977577381848204, 'psi': 0.33308623671855697}
[S6] START round=33 head_norm_before_train=1.718305 cos_to_last_merge=0.8267 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.827
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.444379903911678, 'psi': 0.09904030710172745}-{'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.3961831283494766, 'psi': 0.09904030710172745}
[S7] START round=33 head_norm_before_train=1.640822 (no previous merge yet)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.24968897735755163, 'auprc': 0.24968897735755163, 'loss_val': 0.5271276305239947, 'psi': 0.24968897735755163}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5119862728205206, 'psi': 0.33316757831924415}
[S8] START round=33 head_norm_before_train=2.215552 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.021911946198416708, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.020368226555843128, 'psi': 0.9988708350860451}
[S9] START round=33 head_norm_before_train=2.143545 cos_to_last_merge=0.9974 (last merge round=28)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8904112389448755, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8367626629915499, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=2.240332 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4289317779454387, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.40852252148933, 'psi': 0.33301496338745623}
[S11] START round=33 head_norm_before_train=2.160960 cos_to_last_merge=0.9974 (last merge round=27)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.0474581600579174, 'psi': 0.3320133550741517}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 1.9431250986345006, 'psi': 0.33185875048506014}
[S13] START round=33 head_norm_before_train=1.845011 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.112150494383075, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.083153964856576, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=2.034113 cos_to_last_merge=0.9989 (last merge round=29)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13353375923838157, 'auprc': 0.13353375923838157, 'loss_val': 4.338254043101839, 'psi': 0.13353375923838157}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.151025976893675, 'psi': 0.13333333333333333}
[S15] START round=33 head_norm_before_train=1.524364 cos_to_last_merge=0.9992 (last merge round=31)
[S15] round=33 local utility u=0.217527 metrics={'f1_val': 0.6090987996902036, 'auprc': 0.6090987996902036, 'loss_val': 0.5055785306520134, 'psi': 0.6090987996902036}-{'f1_val': 0.5719958544895317, 'auprc': 0.5719958544895317, 'loss_val': 0.6067060827017049, 'psi': 0.5719958544895317}
[S16] START round=33 head_norm_before_train=1.597070 cos_to_last_merge=0.9828 (last merge round=28)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.1146800195407914, 'auprc': 0.1146800195407914, 'loss_val': 3.0529186659597554, 'psi': 0.1146800195407914}-{'f1_val': 0.1724384659416142, 'auprc': 0.1724384659416142, 'loss_val': 2.4835619705375427, 'psi': 0.1724384659416142}
[S17] START round=33 head_norm_before_train=2.139771 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.46527223614359503, 'auprc': 0.46527223614359503, 'loss_val': 1.5729727539055987, 'psi': 0.46527223614359503}-{'f1_val': 0.5459994612068966, 'auprc': 0.5459994612068966, 'loss_val': 1.2104324151639099, 'psi': 0.5459994612068966}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=2.025391 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.5664335659516135, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.5396843552026813, 'psi': 0.2654773703336637}
[S3] START round=34 head_norm_before_train=1.879710 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.2829776744841186, 'auprc': 0.2829776744841186, 'loss_val': 3.010228993752125, 'psi': 0.2829776744841186}-{'f1_val': 0.2803204458376872, 'auprc': 0.2803204458376872, 'loss_val': 2.9730486716985274, 'psi': 0.2803204458376872}
[S4] START round=34 head_norm_before_train=2.139681 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3529568813781365, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3473504626187678, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=1.249783 cos_to_last_merge=0.9890 (last merge round=30)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1190821128943584, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.0521999422200543, 'psi': 0.33308623671855697}
[S6] START round=34 head_norm_before_train=1.727049 cos_to_last_merge=0.8255 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.826
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.0988863287250384, 'auprc': 0.0988863287250384, 'loss_val': 6.499336206994644, 'psi': 0.0988863287250384}-{'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.444379903911678, 'psi': 0.09904030710172745}
[S7] START round=34 head_norm_before_train=1.648289 (no previous merge yet)
[S7] round=34 local utility u=0.377368 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5236991416499157, 'psi': 0.33316757831924415}-{'f1_val': 0.24968897735755163, 'auprc': 0.24968897735755163, 'loss_val': 0.5271276305239947, 'psi': 0.24968897735755163}
[S8] START round=34 head_norm_before_train=2.226367 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.024172653071562463, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.021911946198416708, 'psi': 0.9988708350860451}
[S9] START round=34 head_norm_before_train=2.155925 cos_to_last_merge=0.9965 (last merge round=28)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9386367154834023, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8904112389448755, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=2.253330 (no previous merge yet)
[S10] round=34 local utility u=0.004470 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.419992107532084, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4289317779454387, 'psi': 0.33301496338745623}
[S11] START round=34 head_norm_before_train=2.175345 cos_to_last_merge=0.9967 (last merge round=27)
[S11] round=34 local utility u=0.001362 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.043343540872932, 'psi': 0.33185875048506014}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.0474581600579174, 'psi': 0.3320133550741517}
[S13] START round=34 head_norm_before_train=1.855791 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1274597988609347, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.112150494383075, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=2.050732 cos_to_last_merge=0.9982 (last merge round=29)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13212760612911328, 'auprc': 0.13212760612911328, 'loss_val': 4.501699627671383, 'psi': 0.13212760612911328}-{'f1_val': 0.13353375923838157, 'auprc': 0.13353375923838157, 'loss_val': 4.338254043101839, 'psi': 0.13353375923838157}
[S15] START round=34 head_norm_before_train=1.588990 cos_to_last_merge=0.9963 (last merge round=31)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.5964129513760107, 'auprc': 0.5964129513760107, 'loss_val': 0.590348716864206, 'psi': 0.5964129513760107}-{'f1_val': 0.6090987996902036, 'auprc': 0.6090987996902036, 'loss_val': 0.5055785306520134, 'psi': 0.6090987996902036}
[S16] START round=34 head_norm_before_train=1.623936 cos_to_last_merge=0.9789 (last merge round=28)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.07322572988369333, 'auprc': 0.07322572988369333, 'loss_val': 3.544378679600673, 'psi': 0.07322572988369333}-{'f1_val': 0.1146800195407914, 'auprc': 0.1146800195407914, 'loss_val': 3.0529186659597554, 'psi': 0.1146800195407914}
[S17] START round=34 head_norm_before_train=2.156834 (no previous merge yet)
[S17] round=34 local utility u=0.995295 metrics={'f1_val': 0.6378229719641673, 'auprc': 0.6378229719641673, 'loss_val': 1.135339173051849, 'psi': 0.6378229719641673}-{'f1_val': 0.46527223614359503, 'auprc': 0.46527223614359503, 'loss_val': 1.5729727539055987, 'psi': 0.46527223614359503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:58304
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:58309
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9831
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=-0.1278
[S8] DROPPED delta from S7 (cos=-0.1278 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S16
[S5]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.3568 head_norm=2.150345
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.000216e-01
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.3568 head_norm=2.159816 delta_norm=0.200022
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=2.032239 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.579989668598458, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.5664335659516135, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.888000 (no previous merge yet)
[S3] round=35 local utility u=0.015963 metrics={'f1_val': 0.28976082086855987, 'auprc': 0.28976082086855987, 'loss_val': 3.039351126356282, 'psi': 0.28976082086855987}-{'f1_val': 0.2829776744841186, 'auprc': 0.2829776744841186, 'loss_val': 3.010228993752125, 'psi': 0.2829776744841186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=35 head_norm_before_train=2.159816 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.003346 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3462651612408365, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3529568813781365, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=1.274080 cos_to_last_merge=0.9847 (last merge round=30)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1778411758783753, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1190821128943584, 'psi': 0.33308623671855697}
[S6] START round=35 head_norm_before_train=1.735527 cos_to_last_merge=0.8244 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.824
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.537856985441614, 'psi': 0.09904030710172745}-{'f1_val': 0.0988863287250384, 'auprc': 0.0988863287250384, 'loss_val': 6.499336206994644, 'psi': 0.0988863287250384}
[S7] START round=35 head_norm_before_train=1.655409 (no previous merge yet)
[S7] round=35 local utility u=0.017927 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.48784482442868493, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5236991416499157, 'psi': 0.33316757831924415}
[S8] START round=35 head_norm_before_train=2.237186 (no previous merge yet)
[S8] round=35 local utility u=0.002530 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.019112153821713346, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.024172653071562463, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=35 head_norm_before_train=2.166516 cos_to_last_merge=0.9957 (last merge round=28)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9771983432092912, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9386367154834023, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=2.265776 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4453330123949706, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.419992107532084, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=2.187611 cos_to_last_merge=0.9960 (last merge round=27)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.1128559853151536, 'psi': 0.3320133550741517}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.043343540872932, 'psi': 0.33185875048506014}
[S13] START round=35 head_norm_before_train=1.865457 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1359072007343887, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1274597988609347, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=2.065651 cos_to_last_merge=0.9975 (last merge round=29)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 4.623310203046649, 'psi': 0.13413413413413414}-{'f1_val': 0.13212760612911328, 'auprc': 0.13212760612911328, 'loss_val': 4.501699627671383, 'psi': 0.13212760612911328}
[S15] START round=35 head_norm_before_train=1.661021 cos_to_last_merge=0.9923 (last merge round=31)
[S15] round=35 local utility u=0.005296 metrics={'f1_val': 0.5997747308699762, 'auprc': 0.5997747308699762, 'loss_val': 0.6100131471551191, 'psi': 0.5997747308699762}-{'f1_val': 0.5964129513760107, 'auprc': 0.5964129513760107, 'loss_val': 0.590348716864206, 'psi': 0.5964129513760107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=35 head_norm_before_train=1.646293 cos_to_last_merge=0.9758 (last merge round=28)
[S16] round=35 local utility u=0.087598 metrics={'f1_val': 0.09144542772861357, 'auprc': 0.09144542772861357, 'loss_val': 3.5331606383399774, 'psi': 0.09144542772861357}-{'f1_val': 0.07322572988369333, 'auprc': 0.07322572988369333, 'loss_val': 3.544378679600673, 'psi': 0.07322572988369333}
[S17] START round=35 head_norm_before_train=2.168859 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5126887926887926, 'auprc': 0.5126887926887926, 'loss_val': 1.4868323601185036, 'psi': 0.5126887926887926}-{'f1_val': 0.6378229719641673, 'auprc': 0.6378229719641673, 'loss_val': 1.135339173051849, 'psi': 0.6378229719641673}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:58307
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.091)
[S16] ⇄ pheromone p=0.073 → S5@127.0.0.1:58305
[S4] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] ⇄ pheromone p=0.018 → S16@127.0.0.1:58316
[S11] ⇄ pheromone p=0.013 → S4@127.0.0.1:58304
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=-0.1264
[S8] DROPPED delta from S7 (cos=-0.1264 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S4
[S6] cosine check vs S4: cos=0.1754
[S7] ⇄ pheromone p=0.102 → S8@127.0.0.1:58309
[S4] ⇄ pheromone p=0.003 → S6@127.0.0.1:58307
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] CommDone barrier timeout: have=0 need=1 — continuing
[S14] ⇄ pheromone p=0.039 → S7@127.0.0.1:58308
[S9] RoundReady barrier timeout: have=1 need=2 — continuing
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RoundReady barrier timeout: have=1 need=4 — continuing
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6]  timeout peer S16
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S17
[S4]  timeout peer S6
[S16]  timeout peer S5
[S7]  timeout peer S8
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S10
[S5]  timeout peer S14
[S5]  timeout peer S15
[S11]  timeout peer S4
[S14]  timeout peer S7
[S14]  timeout peer S9
[S2] START round=36 head_norm_before_train=2.038713 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.5978467874977387, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.579989668598458, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.895994 (no previous merge yet)
[S3] round=36 local utility u=0.009782 metrics={'f1_val': 0.2945155124246434, 'auprc': 0.2945155124246434, 'loss_val': 3.06257979489123, 'psi': 0.2945155124246434}-{'f1_val': 0.28976082086855987, 'auprc': 0.28976082086855987, 'loss_val': 3.039351126356282, 'psi': 0.28976082086855987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=36 head_norm_before_train=2.164974 cos_to_last_merge=0.9999 (last merge round=34)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.357726561302296, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3462651612408365, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.296325 cos_to_last_merge=0.9810 (last merge round=30)
[S5] round=36 local utility u=0.000713 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1764146669837796, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1778411758783753, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=36 head_norm_before_train=1.743431 cos_to_last_merge=0.8233 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.823
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.09734001542020046, 'auprc': 0.09734001542020046, 'loss_val': 6.602110165387843, 'psi': 0.09734001542020046}-{'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.537856985441614, 'psi': 0.09904030710172745}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.0973 head_norm=1.751196
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.266828e+00
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.0947 head_norm=1.507331 delta_norm=1.266828
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] START round=36 head_norm_before_train=1.666886 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.2498134792340214, 'auprc': 0.2498134792340214, 'loss_val': 0.4950876332582447, 'psi': 0.2498134792340214}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.48784482442868493, 'psi': 0.33316757831924415}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=2.248231 (no previous merge yet)
[S8] round=36 local utility u=0.001060 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.016991476736979035, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.019112153821713346, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=36 head_norm_before_train=2.175751 cos_to_last_merge=0.9950 (last merge round=28)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0094465685003198, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9771983432092912, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=2.277565 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4647914686779417, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4453330123949706, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=2.199537 cos_to_last_merge=0.9953 (last merge round=27)
[S11] round=36 local utility u=0.004669 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.1021264649143143, 'psi': 0.33185875048506014}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.1128559853151536, 'psi': 0.3320133550741517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=36 head_norm_before_train=1.871279 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.148673856882323, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1359072007343887, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=2.079034 cos_to_last_merge=0.9969 (last merge round=29)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 4.741758240176386, 'psi': 0.13373403456048086}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 4.623310203046649, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.721137 cos_to_last_merge=0.9889 (last merge round=31)
[S15] round=36 local utility u=0.061098 metrics={'f1_val': 0.6102517882741235, 'auprc': 0.6102517882741235, 'loss_val': 0.5821103785307185, 'psi': 0.6102517882741235}-{'f1_val': 0.5997747308699762, 'auprc': 0.5997747308699762, 'loss_val': 0.6100131471551191, 'psi': 0.5997747308699762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=36 head_norm_before_train=1.665289 cos_to_last_merge=0.9732 (last merge round=28)
[S16] round=36 local utility u=0.153810 metrics={'f1_val': 0.10482985729967069, 'auprc': 0.10482985729967069, 'loss_val': 3.3460002711061305, 'psi': 0.10482985729967069}-{'f1_val': 0.09144542772861357, 'auprc': 0.09144542772861357, 'loss_val': 3.5331606383399774, 'psi': 0.09144542772861357}
[S16] not sending this round → trigger blocked (psi=0.105)
[S17] START round=36 head_norm_before_train=2.164498 (no previous merge yet)
[S17] round=36 local utility u=1.000000 metrics={'f1_val': 0.7374502861834273, 'auprc': 0.7374502861834273, 'loss_val': 0.9276458472699377, 'psi': 0.7374502861834273}-{'f1_val': 0.5126887926887926, 'auprc': 0.5126887926887926, 'loss_val': 1.4868323601185036, 'psi': 0.5126887926887926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=37 head_norm_before_train=2.045044 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.6102014344361897, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.5978467874977387, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.903796 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.28159350276552547, 'auprc': 0.28159350276552547, 'loss_val': 3.04654609158677, 'psi': 0.28159350276552547}-{'f1_val': 0.2945155124246434, 'auprc': 0.2945155124246434, 'loss_val': 3.06257979489123, 'psi': 0.2945155124246434}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=2.176157 cos_to_last_merge=0.9999 (last merge round=34)
[S4] round=37 local utility u=0.006337 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.345053148980313, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.357726561302296, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=37 head_norm_before_train=1.311143 cos_to_last_merge=0.9779 (last merge round=30)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1874693050886105, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1764146669837796, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.507331 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.864186 metrics={'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 4.891808790811352, 'psi': 0.09934790947449175}-{'f1_val': 0.09734001542020046, 'auprc': 0.09734001542020046, 'loss_val': 6.602110165387843, 'psi': 0.09734001542020046}
[S6] not sending this round → trigger blocked (psi=0.099)
[S7] START round=37 head_norm_before_train=1.679864 (no previous merge yet)
[S7] round=37 local utility u=0.011938 metrics={'f1_val': 0.24956435150609907, 'auprc': 0.24956435150609907, 'loss_val': 0.4689698952940616, 'psi': 0.24956435150609907}-{'f1_val': 0.2498134792340214, 'auprc': 0.2498134792340214, 'loss_val': 0.4950876332582447, 'psi': 0.2498134792340214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=37 head_norm_before_train=2.260788 (no previous merge yet)
[S8] round=37 local utility u=0.000081 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.016830056017911568, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.016991476736979035, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=37 head_norm_before_train=2.183968 cos_to_last_merge=0.9944 (last merge round=28)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.039262523206272, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0094465685003198, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.288913 (no previous merge yet)
[S10] round=37 local utility u=0.008434 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.447922942326111, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4647914686779417, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=37 head_norm_before_train=2.211229 cos_to_last_merge=0.9947 (last merge round=27)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.1990200299630067, 'psi': 0.3320133550741517}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.1021264649143143, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.878926 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1513426851826973, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.148673856882323, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=2.090778 cos_to_last_merge=0.9962 (last merge round=29)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.846392843674868, 'psi': 0.13333333333333333}-{'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 4.741758240176386, 'psi': 0.13373403456048086}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.771768 cos_to_last_merge=0.9864 (last merge round=31)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.5807276944263245, 'auprc': 0.5807276944263245, 'loss_val': 0.6840571903434578, 'psi': 0.5807276944263245}-{'f1_val': 0.6102517882741235, 'auprc': 0.6102517882741235, 'loss_val': 0.5821103785307185, 'psi': 0.6102517882741235}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.681969 cos_to_last_merge=0.9711 (last merge round=28)
[S16] round=37 local utility u=0.059933 metrics={'f1_val': 0.11117101574293724, 'auprc': 0.11117101574293724, 'loss_val': 3.2832053197267825, 'psi': 0.11117101574293724}-{'f1_val': 0.10482985729967069, 'auprc': 0.10482985729967069, 'loss_val': 3.3460002711061305, 'psi': 0.10482985729967069}
[S16] not sending this round → trigger blocked (psi=0.111)
[S17] START round=37 head_norm_before_train=2.168046 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.5142932896444516, 'auprc': 0.5142932896444516, 'loss_val': 1.5234555198601376, 'psi': 0.5142932896444516}-{'f1_val': 0.7374502861834273, 'auprc': 0.7374502861834273, 'loss_val': 0.9276458472699377, 'psi': 0.7374502861834273}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=2.051137 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.6125892398895596, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.6102014344361897, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.911347 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.27828492392807747, 'auprc': 0.27828492392807747, 'loss_val': 3.0485245905120575, 'psi': 0.27828492392807747}-{'f1_val': 0.28159350276552547, 'auprc': 0.28159350276552547, 'loss_val': 3.04654609158677, 'psi': 0.28159350276552547}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=2.176832 cos_to_last_merge=0.9994 (last merge round=34)
[S4] round=38 local utility u=0.001788 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.341476429485016, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.345053148980313, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=38 head_norm_before_train=1.322073 cos_to_last_merge=0.9760 (last merge round=30)
[S5] round=38 local utility u=0.021826 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1438177187790712, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1874693050886105, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=38 head_norm_before_train=1.536902 cos_to_last_merge=0.9997 (last merge round=36)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.0988863287250384, 'auprc': 0.0988863287250384, 'loss_val': 5.110201415823253, 'psi': 0.0988863287250384}-{'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 4.891808790811352, 'psi': 0.09934790947449175}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.691263 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.24968897735755163, 'auprc': 0.24968897735755163, 'loss_val': 0.48276857039902393, 'psi': 0.24968897735755163}-{'f1_val': 0.24956435150609907, 'auprc': 0.24956435150609907, 'loss_val': 0.4689698952940616, 'psi': 0.24956435150609907}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=2.271772 (no previous merge yet)
[S8] round=38 local utility u=0.001102 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.014626284250802197, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.016830056017911568, 'psi': 0.9988708350860451}
[S8] not sending this round → trigger blocked (psi=0.999)
[S9] START round=38 head_norm_before_train=2.191383 cos_to_last_merge=0.9939 (last merge round=28)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0705187965496594, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.039262523206272, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.300134 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4602292740662093, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.447922942326111, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=2.222988 cos_to_last_merge=0.9939 (last merge round=27)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.2536856930076956, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.1990200299630067, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.886676 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1792719182217333, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1513426851826973, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=2.101340 cos_to_last_merge=0.9957 (last merge round=29)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.935394772380459, 'psi': 0.1331327566754419}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.846392843674868, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.812044 cos_to_last_merge=0.9844 (last merge round=31)
[S15] round=38 local utility u=0.189768 metrics={'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.5984605488285402, 'psi': 0.613387689325667}-{'f1_val': 0.5807276944263245, 'auprc': 0.5807276944263245, 'loss_val': 0.6840571903434578, 'psi': 0.5807276944263245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=38 head_norm_before_train=1.696582 cos_to_last_merge=0.9692 (last merge round=28)
[S16] round=38 local utility u=0.366907 metrics={'f1_val': 0.13504464285714285, 'auprc': 0.13504464285714285, 'loss_val': 2.7642532195627214, 'psi': 0.13504464285714285}-{'f1_val': 0.11117101574293724, 'auprc': 0.11117101574293724, 'loss_val': 3.2832053197267825, 'psi': 0.11117101574293724}
[S16] not sending this round → trigger blocked (psi=0.135)
[S17] START round=38 head_norm_before_train=2.174159 (no previous merge yet)
[S17] round=38 local utility u=1.000000 metrics={'f1_val': 0.7326066816418453, 'auprc': 0.7326066816418453, 'loss_val': 0.9667938702400395, 'psi': 0.7326066816418453}-{'f1_val': 0.5142932896444516, 'auprc': 0.5142932896444516, 'loss_val': 1.5234555198601376, 'psi': 0.5142932896444516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=39 head_norm_before_train=2.057215 (no previous merge yet)
[S2] round=39 local utility u=0.004841 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.602907308713853, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.6125892398895596, 'psi': 0.2654773703336637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S2] r=40 psi=0.265 u=0.0048 p_local=0.0032 f1=0.265 auprc=0.265 bytes=17963
[S3] START round=39 head_norm_before_train=1.918553 (no previous merge yet)
[S3] round=39 local utility u=0.006465 metrics={'f1_val': 0.28375706214689267, 'auprc': 0.28375706214689267, 'loss_val': 3.084843826436913, 'psi': 0.28375706214689267}-{'f1_val': 0.27828492392807747, 'auprc': 0.27828492392807747, 'loss_val': 3.0485245905120575, 'psi': 0.27828492392807747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] r=40 psi=0.284 u=0.0065 p_local=0.0064 f1=0.284 auprc=0.284 bytes=21604
[S4] START round=39 head_norm_before_train=2.181829 cos_to_last_merge=0.9993 (last merge round=34)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3478475098544558, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.341476429485016, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0023 f1=0.357 auprc=0.357 bytes=19792
[S5] START round=39 head_norm_before_train=1.332626 cos_to_last_merge=0.9744 (last merge round=30)
[S5] round=39 local utility u=0.008970 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1296660880892087, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1438177187790712, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S5] r=40 psi=0.334 u=0.0090 p_local=0.0132 f1=0.334 auprc=0.334 bytes=25203
[S6] START round=39 head_norm_before_train=1.579119 cos_to_last_merge=0.9984 (last merge round=36)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 5.275539363427901, 'psi': 0.09934790947449175}-{'f1_val': 0.0988863287250384, 'auprc': 0.0988863287250384, 'loss_val': 5.110201415823253, 'psi': 0.0988863287250384}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.099 u=0.0000 p_local=0.1179 f1=0.099 auprc=0.099 bytes=0
[S7] START round=39 head_norm_before_train=1.702852 (no previous merge yet)
[S7] round=39 local utility u=0.364127 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5058217573001751, 'psi': 0.33316757831924415}-{'f1_val': 0.24968897735755163, 'auprc': 0.24968897735755163, 'loss_val': 0.48276857039902393, 'psi': 0.24968897735755163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] r=40 psi=0.333 u=0.3641 p_local=0.1161 f1=0.333 auprc=0.333 bytes=34209
[S8] START round=39 head_norm_before_train=2.281499 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.014824208740965192, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.014626284250802197, 'psi': 0.9988708350860451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.999 u=0.0000 p_local=0.0126 f1=0.999 auprc=0.999 bytes=37757
[S9] START round=39 head_norm_before_train=2.198192 cos_to_last_merge=0.9933 (last merge round=28)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.09626231909301, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0705187965496594, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0047 f1=0.369 auprc=0.369 bytes=12602
[S10] START round=39 head_norm_before_train=2.310624 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4856545917131085, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4602292740662093, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.333 u=0.0000 p_local=0.0054 f1=0.333 auprc=0.333 bytes=28784
[S11] START round=39 head_norm_before_train=2.234401 cos_to_last_merge=0.9932 (last merge round=27)
[S11] round=39 local utility u=0.006741 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.2388121988752943, 'psi': 0.33185875048506014}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.2536856930076956, 'psi': 0.3320133550741517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=40 psi=0.332 u=0.0067 p_local=0.0073 f1=0.332 auprc=0.332 bytes=16190
[S13] START round=39 head_norm_before_train=1.893540 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1852325099211023, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1792719182217333, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0005 f1=0.360 auprc=0.360 bytes=3596
[S14] START round=39 head_norm_before_train=2.110933 cos_to_last_merge=0.9951 (last merge round=29)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 5.008539489620425, 'psi': 0.13373403456048086}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.935394772380459, 'psi': 0.1331327566754419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.134 u=0.0000 p_local=0.0159 f1=0.134 auprc=0.134 bytes=0
[S15] START round=39 head_norm_before_train=1.846936 cos_to_last_merge=0.9826 (last merge round=31)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.5706084393338581, 'auprc': 0.5706084393338581, 'loss_val': 0.725767538452952, 'psi': 0.5706084393338581}-{'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.5984605488285402, 'psi': 0.613387689325667}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.571 u=0.0000 p_local=0.0705 f1=0.571 auprc=0.571 bytes=32429
[S16] START round=39 head_norm_before_train=1.709376 cos_to_last_merge=0.9676 (last merge round=28)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.15114401076716016, 'auprc': 0.15114401076716016, 'loss_val': 2.9901174991360717, 'psi': 0.15114401076716016}-{'f1_val': 0.13504464285714285, 'auprc': 0.13504464285714285, 'loss_val': 2.7642532195627214, 'psi': 0.13504464285714285}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.151 u=0.0000 p_local=0.1119 f1=0.151 auprc=0.151 bytes=0
[S17] START round=39 head_norm_before_train=2.186459 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5448508025209585, 'auprc': 0.5448508025209585, 'loss_val': 1.4598537329824501, 'psi': 0.5448508025209585}-{'f1_val': 0.7326066816418453, 'auprc': 0.7326066816418453, 'loss_val': 0.9667938702400395, 'psi': 0.7326066816418453}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.545 u=0.0000 p_local=0.3643 f1=0.545 auprc=0.545 bytes=30610
[S2] START round=40 head_norm_before_train=2.063081 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.634253123445941, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.602907308713853, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.925579 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.27845823818420873, 'auprc': 0.27845823818420873, 'loss_val': 3.075597852248735, 'psi': 0.27845823818420873}-{'f1_val': 0.28375706214689267, 'auprc': 0.28375706214689267, 'loss_val': 3.084843826436913, 'psi': 0.28375706214689267}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.195506 cos_to_last_merge=0.9995 (last merge round=34)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3727817345355704, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3478475098544558, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.340363 cos_to_last_merge=0.9731 (last merge round=30)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.175324561433755, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1296660880892087, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.619257 cos_to_last_merge=0.9965 (last merge round=36)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.08633663366336633, 'auprc': 0.08633663366336633, 'loss_val': 5.55587642266025, 'psi': 0.08633663366336633}-{'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 5.275539363427901, 'psi': 0.09934790947449175}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.714649 (no previous merge yet)
[S7] round=40 local utility u=0.025818 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.4541858092965106, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5058217573001751, 'psi': 0.33316757831924415}
[S7] not sending this round → trigger blocked (psi=0.333)
[S8] START round=40 head_norm_before_train=2.288067 (no previous merge yet)
[S8] round=40 local utility u=0.000477 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.013870654437182316, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.014824208740965192, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=40 head_norm_before_train=2.204371 cos_to_last_merge=0.9928 (last merge round=28)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.121979672518297, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.09626231909301, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.320738 (no previous merge yet)
[S10] round=40 local utility u=0.003043 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.47956864473967, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4856545917131085, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=40 head_norm_before_train=2.245120 cos_to_last_merge=0.9926 (last merge round=27)
[S11] round=40 local utility u=0.005372 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.228068753048545, 'psi': 0.33185875048506014}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.2388121988752943, 'psi': 0.33185875048506014}
[S11] not sending this round → trigger blocked (psi=0.332)
[S13] START round=40 head_norm_before_train=1.900862 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1982692215017425, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1852325099211023, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=2.119861 cos_to_last_merge=0.9946 (last merge round=29)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13433395872420262, 'auprc': 0.13433395872420262, 'loss_val': 5.0756636180927535, 'psi': 0.13433395872420262}-{'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 5.008539489620425, 'psi': 0.13373403456048086}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.876947 cos_to_last_merge=0.9812 (last merge round=31)
[S15] round=40 local utility u=0.248000 metrics={'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.6173242284796662, 'psi': 0.6136702686915539}-{'f1_val': 0.5706084393338581, 'auprc': 0.5706084393338581, 'loss_val': 0.725767538452952, 'psi': 0.5706084393338581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=40 head_norm_before_train=1.719620 cos_to_last_merge=0.9664 (last merge round=28)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.012761335867499321, 'auprc': 0.012761335867499321, 'loss_val': 4.789846721945741, 'psi': 0.012761335867499321}-{'f1_val': 0.15114401076716016, 'auprc': 0.15114401076716016, 'loss_val': 2.9901174991360717, 'psi': 0.15114401076716016}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=2.200292 (no previous merge yet)
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.7713626854083806, 'auprc': 0.7713626854083806, 'loss_val': 0.8604274018169672, 'psi': 0.7713626854083806}-{'f1_val': 0.5448508025209585, 'auprc': 0.5448508025209585, 'loss_val': 1.4598537329824501, 'psi': 0.5448508025209585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=41 head_norm_before_train=2.068828 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.6476325417699558, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.634253123445941, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.932133 (no previous merge yet)
[S3] round=41 local utility u=0.007980 metrics={'f1_val': 0.28375706214689267, 'auprc': 0.28375706214689267, 'loss_val': 3.107326440134527, 'psi': 0.28375706214689267}-{'f1_val': 0.27845823818420873, 'auprc': 0.27845823818420873, 'loss_val': 3.075597852248735, 'psi': 0.27845823818420873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=41 head_norm_before_train=2.207984 cos_to_last_merge=0.9994 (last merge round=34)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3749315640520328, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3727817345355704, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.350427 cos_to_last_merge=0.9716 (last merge round=30)
[S5] round=41 local utility u=0.013309 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1487072187842133, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.175324561433755, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=41 head_norm_before_train=1.652447 cos_to_last_merge=0.9947 (last merge round=36)
[S6] round=41 local utility u=0.019482 metrics={'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 5.6340136412265975, 'psi': 0.09934790947449175}-{'f1_val': 0.08633663366336633, 'auprc': 0.08633663366336633, 'loss_val': 5.55587642266025, 'psi': 0.08633663366336633}
[S6] not sending this round → trigger blocked (psi=0.099)
[S7] START round=41 head_norm_before_train=1.726805 (no previous merge yet)
[S7] round=41 local utility u=0.008368 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.436704377381647, 'psi': 0.33308476261496395}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.4541858092965106, 'psi': 0.33316757831924415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=41 head_norm_before_train=2.296605 (no previous merge yet)
[S8] round=41 local utility u=0.000198 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.0134750565991497, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.013870654437182316, 'psi': 0.9988708350860451}
[S8] not sending this round → trigger blocked (psi=0.999)
[S9] START round=41 head_norm_before_train=2.210226 cos_to_last_merge=0.9924 (last merge round=28)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1462536712668516, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.121979672518297, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.330881 (no previous merge yet)
[S10] round=41 local utility u=0.000655 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4782580830165726, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.47956864473967, 'psi': 0.33301496338745623}
[S10] not sending this round → trigger blocked (psi=0.333)
[S11] START round=41 head_norm_before_train=2.254433 cos_to_last_merge=0.9920 (last merge round=27)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.287429721793727, 'psi': 0.33185875048506014}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.228068753048545, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.907394 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.202628846224423, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1982692215017425, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.128191 cos_to_last_merge=0.9941 (last merge round=29)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.1366308745464515, 'psi': 0.1351317597102535}-{'f1_val': 0.13433395872420262, 'auprc': 0.13433395872420262, 'loss_val': 5.0756636180927535, 'psi': 0.13433395872420262}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.902621 cos_to_last_merge=0.9800 (last merge round=31)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6119685637078588, 'auprc': 0.6119685637078588, 'loss_val': 0.63595920635446, 'psi': 0.6119685637078588}-{'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.6173242284796662, 'psi': 0.6136702686915539}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.728896 cos_to_last_merge=0.9653 (last merge round=28)
[S16] round=41 local utility u=1.000000 metrics={'f1_val': 0.13078014184397163, 'auprc': 0.13078014184397163, 'loss_val': 3.49838327185519, 'psi': 0.13078014184397163}-{'f1_val': 0.012761335867499321, 'auprc': 0.012761335867499321, 'loss_val': 4.789846721945741, 'psi': 0.012761335867499321}
[S16] not sending this round → trigger blocked (psi=0.131)
[S17] START round=41 head_norm_before_train=2.210908 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.5086608506418261, 'auprc': 0.5086608506418261, 'loss_val': 1.7757658561326615, 'psi': 0.5086608506418261}-{'f1_val': 0.7713626854083806, 'auprc': 0.7713626854083806, 'loss_val': 0.8604274018169672, 'psi': 0.7713626854083806}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=2.074455 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.664043208637149, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.6476325417699558, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.938583 (no previous merge yet)
[S3] round=42 local utility u=0.037815 metrics={'f1_val': 0.2956727219022301, 'auprc': 0.2956727219022301, 'loss_val': 3.1389370857172256, 'psi': 0.2956727219022301}-{'f1_val': 0.28375706214689267, 'auprc': 0.28375706214689267, 'loss_val': 3.107326440134527, 'psi': 0.28375706214689267}
[S3] not sending this round → trigger blocked (psi=0.296)
[S4] START round=42 head_norm_before_train=2.215327 cos_to_last_merge=0.9993 (last merge round=34)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3756462729537475, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3749315640520328, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.362394 cos_to_last_merge=0.9699 (last merge round=30)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1828834587515797, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1487072187842133, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.680317 cos_to_last_merge=0.9931 (last merge round=36)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.0988863287250384, 'auprc': 0.0988863287250384, 'loss_val': 5.760355217224094, 'psi': 0.0988863287250384}-{'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 5.6340136412265975, 'psi': 0.09934790947449175}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.738130 (no previous merge yet)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.24968897735755163, 'auprc': 0.24968897735755163, 'loss_val': 0.501903865426653, 'psi': 0.24968897735755163}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.436704377381647, 'psi': 0.33308476261496395}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=2.306600 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.014216689635210797, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.0134750565991497, 'psi': 0.9988708350860451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=2.215733 cos_to_last_merge=0.9919 (last merge round=28)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1672624075528404, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1462536712668516, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.340440 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.480571831397895, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4782580830165726, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=2.263231 cos_to_last_merge=0.9915 (last merge round=27)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.3218168372366352, 'psi': 0.33185875048506014}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.287429721793727, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.913614 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.2200117050900805, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.202628846224423, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=2.135959 cos_to_last_merge=0.9937 (last merge round=29)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.1901445136669135, 'psi': 0.1351317597102535}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.1366308745464515, 'psi': 0.1351317597102535}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.927105 cos_to_last_merge=0.9787 (last merge round=31)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.6041214586050098, 'auprc': 0.6041214586050098, 'loss_val': 0.6610270943268951, 'psi': 0.6041214586050098}-{'f1_val': 0.6119685637078588, 'auprc': 0.6119685637078588, 'loss_val': 0.63595920635446, 'psi': 0.6119685637078588}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.737125 cos_to_last_merge=0.9643 (last merge round=28)
[S16] round=42 local utility u=0.514635 metrics={'f1_val': 0.18072289156626506, 'auprc': 0.18072289156626506, 'loss_val': 2.9185988886457945, 'psi': 0.18072289156626506}-{'f1_val': 0.13078014184397163, 'auprc': 0.13078014184397163, 'loss_val': 3.49838327185519, 'psi': 0.13078014184397163}
[S16] not sending this round → trigger blocked (psi=0.181)
[S17] START round=42 head_norm_before_train=2.221550 (no previous merge yet)
[S17] round=42 local utility u=1.000000 metrics={'f1_val': 0.7868131266910712, 'auprc': 0.7868131266910712, 'loss_val': 0.7979904238032794, 'psi': 0.7868131266910712}-{'f1_val': 0.5086608506418261, 'auprc': 0.5086608506418261, 'loss_val': 1.7757658561326615, 'psi': 0.5086608506418261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=43 head_norm_before_train=2.079915 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.6725167395547325, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.664043208637149, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.944764 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.26192800885243767, 'auprc': 0.26192800885243767, 'loss_val': 3.13922944095116, 'psi': 0.26192800885243767}-{'f1_val': 0.2956727219022301, 'auprc': 0.2956727219022301, 'loss_val': 3.1389370857172256, 'psi': 0.2956727219022301}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.221454 cos_to_last_merge=0.9991 (last merge round=34)
[S4] round=43 local utility u=0.004791 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3660651596747808, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3756462729537475, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=43 head_norm_before_train=1.378910 cos_to_last_merge=0.9675 (last merge round=30)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.197178828548504, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1828834587515797, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.703500 cos_to_last_merge=0.9918 (last merge round=36)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.09919416730621643, 'auprc': 0.09919416730621643, 'loss_val': 5.841652998302714, 'psi': 0.09919416730621643}-{'f1_val': 0.0988863287250384, 'auprc': 0.0988863287250384, 'loss_val': 5.760355217224094, 'psi': 0.0988863287250384}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.750448 (no previous merge yet)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.2491271820448878, 'auprc': 0.2491271820448878, 'loss_val': 0.5631881503887161, 'psi': 0.2491271820448878}-{'f1_val': 0.24968897735755163, 'auprc': 0.24968897735755163, 'loss_val': 0.501903865426653, 'psi': 0.24968897735755163}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=2.316392 (no previous merge yet)
[S8] round=43 local utility u=0.000621 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.0129743860962439, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.014216689635210797, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=43 head_norm_before_train=2.220956 cos_to_last_merge=0.9915 (last merge round=28)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1885062231822734, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1672624075528404, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.349791 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4812065828233374, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.480571831397895, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=2.271657 cos_to_last_merge=0.9909 (last merge round=27)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.3666043668534447, 'psi': 0.3319360347772085}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.3218168372366352, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.918975 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.232340890177607, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.2200117050900805, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.143420 cos_to_last_merge=0.9932 (last merge round=29)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.245216283265467, 'psi': 0.13413413413413414}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.1901445136669135, 'psi': 0.1351317597102535}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.946450 cos_to_last_merge=0.9777 (last merge round=31)
[S15] round=43 local utility u=0.043843 metrics={'f1_val': 0.6118260774459018, 'auprc': 0.6118260774459018, 'loss_val': 0.6426819752074304, 'psi': 0.6118260774459018}-{'f1_val': 0.6041214586050098, 'auprc': 0.6041214586050098, 'loss_val': 0.6610270943268951, 'psi': 0.6041214586050098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=43 head_norm_before_train=1.745276 cos_to_last_merge=0.9633 (last merge round=28)
[S16] round=43 local utility u=0.244928 metrics={'f1_val': 0.19615692554043235, 'auprc': 0.19615692554043235, 'loss_val': 2.567649693969923, 'psi': 0.19615692554043235}-{'f1_val': 0.18072289156626506, 'auprc': 0.18072289156626506, 'loss_val': 2.9185988886457945, 'psi': 0.18072289156626506}
[S16] not sending this round → trigger blocked (psi=0.196)
[S17] START round=43 head_norm_before_train=2.231582 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5722807864149562, 'auprc': 0.5722807864149562, 'loss_val': 1.4836849228322335, 'psi': 0.5722807864149562}-{'f1_val': 0.7868131266910712, 'auprc': 0.7868131266910712, 'loss_val': 0.7979904238032794, 'psi': 0.7868131266910712}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=2.085309 (no previous merge yet)
[S2] round=44 local utility u=0.000348 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.671820242134334, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.6725167395547325, 'psi': 0.2654773703336637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=44 head_norm_before_train=1.950382 (no previous merge yet)
[S3] round=44 local utility u=0.096004 metrics={'f1_val': 0.28279842342342343, 'auprc': 0.28279842342342343, 'loss_val': 3.135056033417827, 'psi': 0.28279842342342343}-{'f1_val': 0.26192800885243767, 'auprc': 0.26192800885243767, 'loss_val': 3.13922944095116, 'psi': 0.26192800885243767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=44 head_norm_before_train=2.226270 cos_to_last_merge=0.9990 (last merge round=34)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3868543861274982, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3660651596747808, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.399349 cos_to_last_merge=0.9648 (last merge round=30)
[S5] round=44 local utility u=0.012804 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.171570387609853, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.197178828548504, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=44 head_norm_before_train=1.723061 cos_to_last_merge=0.9906 (last merge round=36)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 5.9140890591406725, 'psi': 0.09934790947449175}-{'f1_val': 0.09919416730621643, 'auprc': 0.09919416730621643, 'loss_val': 5.841652998302714, 'psi': 0.09919416730621643}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.763801 (no previous merge yet)
[S7] round=44 local utility u=0.049641 metrics={'f1_val': 0.249439601494396, 'auprc': 0.249439601494396, 'loss_val': 0.46671772372044956, 'psi': 0.249439601494396}-{'f1_val': 0.2491271820448878, 'auprc': 0.2491271820448878, 'loss_val': 0.5631881503887161, 'psi': 0.2491271820448878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=44 head_norm_before_train=2.325145 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.01298329899149233, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.0129743860962439, 'psi': 0.9988708350860451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.225989 cos_to_last_merge=0.9911 (last merge round=28)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.207624659717198, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1885062231822734, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.358821 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5009151262518503, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4812065828233374, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.279568 cos_to_last_merge=0.9904 (last merge round=27)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.4090799859112844, 'psi': 0.3320133550741517}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.3666043668534447, 'psi': 0.3319360347772085}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.936325 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.258940719567738, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.232340890177607, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.150413 cos_to_last_merge=0.9928 (last merge round=29)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 5.299971971845139, 'psi': 0.13393415946927026}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.245216283265467, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.963986 cos_to_last_merge=0.9768 (last merge round=31)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6073564582055813, 'auprc': 0.6073564582055813, 'loss_val': 0.6318189012660106, 'psi': 0.6073564582055813}-{'f1_val': 0.6118260774459018, 'auprc': 0.6118260774459018, 'loss_val': 0.6426819752074304, 'psi': 0.6118260774459018}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.753651 cos_to_last_merge=0.9623 (last merge round=28)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.192090395480226, 'auprc': 0.192090395480226, 'loss_val': 2.6578722422108756, 'psi': 0.192090395480226}-{'f1_val': 0.19615692554043235, 'auprc': 0.19615692554043235, 'loss_val': 2.567649693969923, 'psi': 0.19615692554043235}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=2.243937 (no previous merge yet)
[S17] round=44 local utility u=0.857983 metrics={'f1_val': 0.7207041308729478, 'auprc': 0.7207041308729478, 'loss_val': 1.1035291095777013, 'psi': 0.7207041308729478}-{'f1_val': 0.5722807864149562, 'auprc': 0.5722807864149562, 'loss_val': 1.4836849228322335, 'psi': 0.5722807864149562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=45 head_norm_before_train=2.090772 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.6861734129658625, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.671820242134334, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.955675 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.26177465521727816, 'auprc': 0.26177465521727816, 'loss_val': 3.177111798649458, 'psi': 0.26177465521727816}-{'f1_val': 0.28279842342342343, 'auprc': 0.28279842342342343, 'loss_val': 3.135056033417827, 'psi': 0.28279842342342343}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.241017 cos_to_last_merge=0.9989 (last merge round=34)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.405851320860237, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3868543861274982, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.417609 cos_to_last_merge=0.9625 (last merge round=30)
[S5] round=45 local utility u=0.002604 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1663620071695138, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.171570387609853, 'psi': 0.33308623671855697}
[S5] not sending this round → trigger blocked (psi=0.333)
[S6] START round=45 head_norm_before_train=1.739992 cos_to_last_merge=0.9895 (last merge round=36)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.09780515979976896, 'auprc': 0.09780515979976896, 'loss_val': 6.025605651412795, 'psi': 0.09780515979976896}-{'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 5.9140890591406725, 'psi': 0.09934790947449175}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.778630 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.24975136747886623, 'auprc': 0.24975136747886623, 'loss_val': 0.5268591690412364, 'psi': 0.24975136747886623}-{'f1_val': 0.249439601494396, 'auprc': 0.249439601494396, 'loss_val': 0.46671772372044956, 'psi': 0.249439601494396}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=2.331570 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.0129855404389821, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.01298329899149233, 'psi': 0.9988708350860451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.230783 cos_to_last_merge=0.9907 (last merge round=28)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2240260425802862, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.207624659717198, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.367558 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.501827438194386, 'psi': 0.2497612225405922}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5009151262518503, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.287359 cos_to_last_merge=0.9899 (last merge round=27)
[S11] round=45 local utility u=0.029597 metrics={'f1_val': 0.33062707801747465, 'auprc': 0.33062707801747465, 'loss_val': 2.3374089270594087, 'psi': 0.33062707801747465}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.4090799859112844, 'psi': 0.3320133550741517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=45 head_norm_before_train=1.951098 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.2914094773666056, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.258940719567738, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.156900 cos_to_last_merge=0.9924 (last merge round=29)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 5.345695979594467, 'psi': 0.1345336334083521}-{'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 5.299971971845139, 'psi': 0.13393415946927026}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.978016 cos_to_last_merge=0.9763 (last merge round=31)
[S15] round=45 local utility u=0.009058 metrics={'f1_val': 0.6090987996902036, 'auprc': 0.6090987996902036, 'loss_val': 0.6293829888554222, 'psi': 0.6090987996902036}-{'f1_val': 0.6073564582055813, 'auprc': 0.6073564582055813, 'loss_val': 0.6318189012660106, 'psi': 0.6073564582055813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=45 head_norm_before_train=1.762035 cos_to_last_merge=0.9612 (last merge round=28)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.13627863487611033, 'auprc': 0.13627863487611033, 'loss_val': 3.0031605423021626, 'psi': 0.13627863487611033}-{'f1_val': 0.192090395480226, 'auprc': 0.192090395480226, 'loss_val': 2.6578722422108756, 'psi': 0.192090395480226}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=2.254830 (no previous merge yet)
[S17] round=45 local utility u=0.709785 metrics={'f1_val': 0.829131766123873, 'auprc': 0.829131766123873, 'loss_val': 0.659807198209014, 'psi': 0.829131766123873}-{'f1_val': 0.7207041308729478, 'auprc': 0.7207041308729478, 'loss_val': 1.1035291095777013, 'psi': 0.7207041308729478}
[S17] not sending this round → trigger blocked (psi=0.829)
[S2] START round=46 head_norm_before_train=2.096009 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.698692678178111, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.6861734129658625, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.960742 (no previous merge yet)
[S3] round=46 local utility u=0.099434 metrics={'f1_val': 0.2793280577537137, 'auprc': 0.2793280577537137, 'loss_val': 3.1362235876286646, 'psi': 0.2793280577537137}-{'f1_val': 0.26177465521727816, 'auprc': 0.26177465521727816, 'loss_val': 3.177111798649458, 'psi': 0.26177465521727816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=46 head_norm_before_train=2.251426 cos_to_last_merge=0.9987 (last merge round=34)
[S4] round=46 local utility u=0.007152 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3915480713900124, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.405851320860237, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=46 head_norm_before_train=1.433407 cos_to_last_merge=0.9603 (last merge round=30)
[S5] round=46 local utility u=0.004666 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1570295783634883, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1663620071695138, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=46 head_norm_before_train=1.755536 cos_to_last_merge=0.9886 (last merge round=36)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.092516623463774, 'psi': 0.09904030710172745}-{'f1_val': 0.09780515979976896, 'auprc': 0.09780515979976896, 'loss_val': 6.025605651412795, 'psi': 0.09780515979976896}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.791512 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.24925261584454408, 'auprc': 0.24925261584454408, 'loss_val': 0.6110123622909736, 'psi': 0.24925261584454406}-{'f1_val': 0.24975136747886623, 'auprc': 0.24975136747886623, 'loss_val': 0.5268591690412364, 'psi': 0.24975136747886623}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=2.338928 (no previous merge yet)
[S8] round=46 local utility u=0.000048 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.012889375572556538, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.0129855404389821, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] sending update (kind=head size=1791 to 1 peers)
[S9] START round=46 head_norm_before_train=2.235311 cos_to_last_merge=0.9904 (last merge round=28)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2389463881589737, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2240260425802862, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.376165 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.5142696100584043, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.501827438194386, 'psi': 0.2497612225405922}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.294756 cos_to_last_merge=0.9894 (last merge round=27)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.4535448916732294, 'psi': 0.3320133550741517}-{'f1_val': 0.33062707801747465, 'auprc': 0.33062707801747465, 'loss_val': 2.3374089270594087, 'psi': 0.33062707801747465}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.958240 (no previous merge yet)
[S13] round=46 local utility u=0.006192 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.27902458000576, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.2914094773666056, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=46 head_norm_before_train=2.163234 cos_to_last_merge=0.9920 (last merge round=29)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.39130003581306, 'psi': 0.1351317597102535}-{'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 5.345695979594467, 'psi': 0.1345336334083521}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.989239 cos_to_last_merge=0.9754 (last merge round=31)
[S15] round=46 local utility u=0.007184 metrics={'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.653615709511788, 'psi': 0.613387689325667}-{'f1_val': 0.6090987996902036, 'auprc': 0.6090987996902036, 'loss_val': 0.6293829888554222, 'psi': 0.6090987996902036}
[S15] not sending this round → trigger blocked (psi=0.613)
[S16] START round=46 head_norm_before_train=1.769558 cos_to_last_merge=0.9604 (last merge round=28)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.11455175400606322, 'auprc': 0.11455175400606322, 'loss_val': 3.4191246386191767, 'psi': 0.11455175400606322}-{'f1_val': 0.13627863487611033, 'auprc': 0.13627863487611033, 'loss_val': 3.0031605423021626, 'psi': 0.13627863487611033}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.257474 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.7398638011723391, 'auprc': 0.7398638011723391, 'loss_val': 1.080653936019602, 'psi': 0.7398638011723391}-{'f1_val': 0.829131766123873, 'auprc': 0.829131766123873, 'loss_val': 0.659807198209014, 'psi': 0.829131766123873}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=2.101127 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.706620392547103, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.698692678178111, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.965153 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.27010336957980935, 'auprc': 0.27010336957980935, 'loss_val': 3.1503499375311033, 'psi': 0.27010336957980935}-{'f1_val': 0.2793280577537137, 'auprc': 0.2793280577537137, 'loss_val': 3.1362235876286646, 'psi': 0.2793280577537137}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.265593 cos_to_last_merge=0.9986 (last merge round=34)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4123334833090486, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3915480713900124, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.447044 cos_to_last_merge=0.9584 (last merge round=30)
[S5] round=47 local utility u=0.010275 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.136480495532268, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1570295783634883, 'psi': 0.33308623671855697}
[S5] not sending this round → trigger blocked (psi=0.333)
[S6] START round=47 head_norm_before_train=1.769725 cos_to_last_merge=0.9877 (last merge round=36)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.168657851051905, 'psi': 0.09904030710172745}-{'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.092516623463774, 'psi': 0.09904030710172745}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.803004 (no previous merge yet)
[S7] round=47 local utility u=0.040683 metrics={'f1_val': 0.2485007496251874, 'auprc': 0.2485007496251874, 'loss_val': 0.5228793445265776, 'psi': 0.24850074962518742}-{'f1_val': 0.24925261584454408, 'auprc': 0.24925261584454408, 'loss_val': 0.6110123622909736, 'psi': 0.24925261584454406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=47 head_norm_before_train=2.347832 (no previous merge yet)
[S8] round=47 local utility u=0.000002 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.01288478670108283, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.012889375572556538, 'psi': 0.9988708350860451}
[S8] not sending this round → trigger blocked (psi=0.999)
[S9] START round=47 head_norm_before_train=2.239674 cos_to_last_merge=0.9900 (last merge round=28)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.255093560184476, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2389463881589737, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.384382 (no previous merge yet)
[S10] round=47 local utility u=0.005005 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.50425973164704, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.5142696100584043, 'psi': 0.2497612225405922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=47 head_norm_before_train=2.301483 cos_to_last_merge=0.9889 (last merge round=27)
[S11] round=47 local utility u=0.017891 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.4163711343716994, 'psi': 0.33185875048506014}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.4535448916732294, 'psi': 0.3320133550741517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=47 head_norm_before_train=1.965474 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.293733537371445, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.27902458000576, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.169283 cos_to_last_merge=0.9916 (last merge round=29)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.43501807350368, 'psi': 0.1351317597102535}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.39130003581306, 'psi': 0.1351317597102535}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.002645 cos_to_last_merge=0.9745 (last merge round=31)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.606625886093314, 'auprc': 0.606625886093314, 'loss_val': 0.6947089247042832, 'psi': 0.606625886093314}-{'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.653615709511788, 'psi': 0.613387689325667}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.776481 cos_to_last_merge=0.9595 (last merge round=28)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.10908696595098677, 'auprc': 0.10908696595098677, 'loss_val': 3.667993165253996, 'psi': 0.10908696595098677}-{'f1_val': 0.11455175400606322, 'auprc': 0.11455175400606322, 'loss_val': 3.4191246386191767, 'psi': 0.11455175400606322}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.261170 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.683449624221987, 'auprc': 0.683449624221987, 'loss_val': 1.1792869319354233, 'psi': 0.683449624221987}-{'f1_val': 0.7398638011723391, 'auprc': 0.7398638011723391, 'loss_val': 1.080653936019602, 'psi': 0.7398638011723391}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=2.106082 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.718748128782322, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.706620392547103, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.969622 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.26177465521727816, 'auprc': 0.26177465521727816, 'loss_val': 3.1957771883991417, 'psi': 0.26177465521727816}-{'f1_val': 0.27010336957980935, 'auprc': 0.27010336957980935, 'loss_val': 3.1503499375311033, 'psi': 0.27010336957980935}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.280385 cos_to_last_merge=0.9984 (last merge round=34)
[S4] round=48 local utility u=0.001389 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.409555585469389, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4123334833090486, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=48 head_norm_before_train=1.456761 cos_to_last_merge=0.9571 (last merge round=30)
[S5] round=48 local utility u=0.014127 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1120142899743746, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.136480495532268, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=48 head_norm_before_train=1.783035 cos_to_last_merge=0.9868 (last merge round=36)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 6.226788903716504, 'psi': 0.09934790947449175}-{'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 6.168657851051905, 'psi': 0.09904030710172745}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.814014 (no previous merge yet)
[S7] round=48 local utility u=0.042859 metrics={'f1_val': 0.2495022399203584, 'auprc': 0.2495022399203584, 'loss_val': 0.44617457992721904, 'psi': 0.24950223992035836}-{'f1_val': 0.2485007496251874, 'auprc': 0.2485007496251874, 'loss_val': 0.5228793445265776, 'psi': 0.24850074962518742}
[S7] not sending this round → trigger blocked (psi=0.250)
[S8] START round=48 head_norm_before_train=2.357047 (no previous merge yet)
[S8] round=48 local utility u=0.000185 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.012514616861539825, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.01288478670108283, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=48 head_norm_before_train=2.244008 cos_to_last_merge=0.9897 (last merge round=28)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.269798874417618, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.255093560184476, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.392439 (no previous merge yet)
[S10] round=48 local utility u=0.007633 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.488992763830331, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.50425973164704, 'psi': 0.2497612225405922}
[S10] not sending this round → trigger blocked (psi=0.250)
[S11] START round=48 head_norm_before_train=2.308018 cos_to_last_merge=0.9884 (last merge round=27)
[S11] round=48 local utility u=0.002979 metrics={'f1_val': 0.33139579942648995, 'auprc': 0.33139579942648995, 'loss_val': 2.406246678342089, 'psi': 0.33139579942648995}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.4163711343716994, 'psi': 0.33185875048506014}
[S11] not sending this round → trigger blocked (psi=0.331)
[S13] START round=48 head_norm_before_train=1.974787 (no previous merge yet)
[S13] round=48 local utility u=0.011077 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.2715799283757603, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.293733537371445, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=48 head_norm_before_train=2.175082 cos_to_last_merge=0.9913 (last merge round=29)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.478337849490085, 'psi': 0.13533083645443197}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.43501807350368, 'psi': 0.1351317597102535}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.018412 cos_to_last_merge=0.9736 (last merge round=31)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.5834373219943642, 'auprc': 0.5834373219943642, 'loss_val': 0.6687342763843641, 'psi': 0.5834373219943642}-{'f1_val': 0.606625886093314, 'auprc': 0.606625886093314, 'loss_val': 0.6947089247042832, 'psi': 0.606625886093314}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.783581 cos_to_last_merge=0.9587 (last merge round=28)
[S16] round=48 local utility u=0.107794 metrics={'f1_val': 0.14391304347826087, 'auprc': 0.14391304347826087, 'loss_val': 3.7658408070749494, 'psi': 0.14391304347826087}-{'f1_val': 0.10908696595098677, 'auprc': 0.10908696595098677, 'loss_val': 3.667993165253996, 'psi': 0.10908696595098677}
[S16] not sending this round → trigger blocked (psi=0.144)
[S17] START round=48 head_norm_before_train=2.267256 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6718692720265673, 'auprc': 0.6718692720265673, 'loss_val': 1.2544628446676855, 'psi': 0.6718692720265673}-{'f1_val': 0.683449624221987, 'auprc': 0.683449624221987, 'loss_val': 1.1792869319354233, 'psi': 0.683449624221987}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=2.110965 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.724382510564752, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.718748128782322, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.973932 (no previous merge yet)
[S3] round=49 local utility u=0.017127 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 3.1735391282412317, 'psi': 0.26310971622858637}-{'f1_val': 0.26177465521727816, 'auprc': 0.26177465521727816, 'loss_val': 3.1957771883991417, 'psi': 0.26177465521727816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=49 head_norm_before_train=2.287229 cos_to_last_merge=0.9980 (last merge round=34)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.413391850946417, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.409555585469389, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.468564 cos_to_last_merge=0.9555 (last merge round=30)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1270441513589042, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1120142899743746, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.794960 cos_to_last_merge=0.9861 (last merge round=36)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 6.278483677873587, 'psi': 0.09934790947449175}-{'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 6.226788903716504, 'psi': 0.09934790947449175}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.825702 (no previous merge yet)
[S7] round=49 local utility u=0.172937 metrics={'f1_val': 0.2812441857542483, 'auprc': 0.2812441857542483, 'loss_val': 0.38597785958911895, 'psi': 0.2812441857542483}-{'f1_val': 0.2495022399203584, 'auprc': 0.2495022399203584, 'loss_val': 0.44617457992721904, 'psi': 0.24950223992035836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=49 head_norm_before_train=2.365785 (no previous merge yet)
[S8] round=49 local utility u=0.000421 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.011673516805894521, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.012514616861539825, 'psi': 0.9988708350860451}
[S8] not sending this round → trigger blocked (psi=0.999)
[S9] START round=49 head_norm_before_train=2.248196 cos_to_last_merge=0.9893 (last merge round=28)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2868806090195, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.269798874417618, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.400248 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.502599228042249, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.488992763830331, 'psi': 0.2497612225405922}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.314459 cos_to_last_merge=0.9880 (last merge round=27)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.4944873551658646, 'psi': 0.3319360347772085}-{'f1_val': 0.33139579942648995, 'auprc': 0.33139579942648995, 'loss_val': 2.406246678342089, 'psi': 0.33139579942648995}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.978691 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.3048282883706905, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.2715799283757603, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.180650 cos_to_last_merge=0.9909 (last merge round=29)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.517121142059339, 'psi': 0.13533083645443197}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.478337849490085, 'psi': 0.13533083645443197}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.029162 cos_to_last_merge=0.9731 (last merge round=31)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.5759532886171536, 'auprc': 0.5759532886171536, 'loss_val': 0.7163727239221432, 'psi': 0.5759532886171536}-{'f1_val': 0.5834373219943642, 'auprc': 0.5834373219943642, 'loss_val': 0.6687342763843641, 'psi': 0.5834373219943642}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.790713 cos_to_last_merge=0.9577 (last merge round=28)
[S16] round=49 local utility u=0.090152 metrics={'f1_val': 0.12119876597620097, 'auprc': 0.12119876597620097, 'loss_val': 3.3811088284154684, 'psi': 0.12119876597620097}-{'f1_val': 0.14391304347826087, 'auprc': 0.14391304347826087, 'loss_val': 3.7658408070749494, 'psi': 0.14391304347826087}
[S16] not sending this round → trigger blocked (psi=0.121)
[S17] START round=49 head_norm_before_train=2.277916 (no previous merge yet)
[S17] round=49 local utility u=0.717027 metrics={'f1_val': 0.78710294244156, 'auprc': 0.78710294244156, 'loss_val': 0.8575109438769742, 'psi': 0.78710294244156}-{'f1_val': 0.6718692720265673, 'auprc': 0.6718692720265673, 'loss_val': 1.2544628446676855, 'psi': 0.6718692720265673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
