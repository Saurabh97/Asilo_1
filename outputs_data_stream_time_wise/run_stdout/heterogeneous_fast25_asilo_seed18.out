[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:41903
[S3] → join 127.0.0.1:41902
[S4] → join 127.0.0.1:41902
[S5] → join 127.0.0.1:41902
[S6] → join 127.0.0.1:41902
[S7] → join 127.0.0.1:41902
[S8] → join 127.0.0.1:41902
[S9] → join 127.0.0.1:41902
[S10] → join 127.0.0.1:41902
[S11] → join 127.0.0.1:41902
[S13] → join 127.0.0.1:41902
[S14] → join 127.0.0.1:41902
[S15] → join 127.0.0.1:41902
[S16] → join 127.0.0.1:41902
[S17] → join 127.0.0.1:41902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.163694 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.154044 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.169712 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.167502 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.204783 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.169973 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.200176 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.170560 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.168657 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.224103 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.212710 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.177225 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.090058 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.179056 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.113294 (no previous merge yet)
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3] + discovered S15
[S3] + discovered S5
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S10
[S3] + discovered S7
[S3] + discovered S6
[S3] + discovered S13
[S3] + discovered S4
[S3] + discovered S16
[S3] + discovered S11
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S14
[S3] + discovered S8
[S5] + discovered S3
[S5] + discovered S2
[S5] + discovered S4
[S4] + discovered S14
[S4] + discovered S17
[S4] + discovered S15
[S4] + discovered S8
[S4] + discovered S5
[S4] + discovered S9
[S4] + discovered S10
[S4] + discovered S7
[S4] + discovered S6
[S4] + discovered S13
[S4] + discovered S16
[S4] + discovered S11
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S5
[S5] + discovered S13
[S5] + discovered S10
[S5] + discovered S6
[S5] + discovered S9
[S5] + discovered S15
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S16
[S5] + discovered S7
[S5] + discovered S8
[S5] + discovered S14
[S7] + discovered S5
[S7] + discovered S3
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S4
[S6] + discovered S14
[S6] + discovered S16
[S6] + discovered S17
[S6] + discovered S10
[S6] + discovered S8
[S6] + discovered S9
[S6] + discovered S7
[S6] + discovered S11
[S6] + discovered S15
[S6] + discovered S13
[S7] + discovered S15
[S7] + discovered S11
[S7] + discovered S9
[S7] + discovered S8
[S7] + discovered S17
[S7] + discovered S13
[S7] + discovered S10
[S7] + discovered S16
[S7] + discovered S14
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S2
[S8] + discovered S5
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S3
[S9] + discovered S8
[S9] + discovered S7
[S9] + discovered S6
[S9] + discovered S4
[S8] + discovered S16
[S8] + discovered S15
[S8] + discovered S14
[S8] + discovered S10
[S8] + discovered S17
[S8] + discovered S9
[S8] + discovered S13
[S8] + discovered S11
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S10
[S9] + discovered S13
[S10] + discovered S6
[S10] + discovered S5
[S10] + discovered S3
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S4
[S10] + discovered S2
[S10] + discovered S8
[S11] + discovered S4
[S11] + discovered S5
[S11] + discovered S6
[S11] + discovered S3
[S11] + discovered S2
[S11] + discovered S8
[S11] + discovered S9
[S11] + discovered S7
[S11] + discovered S10
[S10] + discovered S14
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S17
[S10] + discovered S11
[S10] + discovered S13
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S15
[S13] + discovered S7
[S13] + discovered S9
[S13] + discovered S8
[S13] + discovered S2
[S13] + discovered S5
[S13] + discovered S10
[S13] + discovered S3
[S13] + discovered S11
[S13] + discovered S6
[S13] + discovered S4
[S13] + discovered S16
[S13] + discovered S14
[S14] + discovered S11
[S13] + discovered S17
[S14] + discovered S6
[S13] + discovered S15
[S14] + discovered S13
[S14] + discovered S8
[S14] + discovered S4
[S14] + discovered S7
[S14] + discovered S2
[S14] + discovered S9
[S14] + discovered S5
[S14] + discovered S10
[S14] + discovered S3
[S15] + discovered S6
[S15] + discovered S11
[S15] + discovered S3
[S14] + discovered S17
[S15] + discovered S8
[S15] + discovered S7
[S14] + discovered S16
[S15] + discovered S14
[S14] + discovered S15
[S15] + discovered S9
[S15] + discovered S5
[S15] + discovered S13
[S15] + discovered S10
[S15] + discovered S2
[S15] + discovered S4
[S16] + discovered S15
[S16] + discovered S3
[S16] + discovered S10
[S16] + discovered S4
[S16] + discovered S13
[S16] + discovered S9
[S16] + discovered S5
[S16] + discovered S11
[S16] + discovered S14
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S8
[S16] + discovered S2
[S15] + discovered S16
[S15] + discovered S17
[S17] + discovered S16
[S17] + discovered S7
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S5
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S4
[S17] + discovered S9
[S17] + discovered S8
[S17] + discovered S10
[S17] + discovered S3
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S6
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:41912
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:41903
[S10] ⇄ pheromone p=1.000 → S8@127.0.0.1:41909
[S7] ⇄ pheromone p=1.000 → S4@127.0.0.1:41904
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:41917
[S2] ⇄ pheromone p=1.000 → S17@127.0.0.1:41917
[S16] ⇄ pheromone p=1.000 → S15@127.0.0.1:41915
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:41914
[S15] ⇄ pheromone p=1.000 → S13@127.0.0.1:41913
[S13] ⇄ pheromone p=1.000 → S2@127.0.0.1:41902
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:41916
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:41916
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:41916
[S3] ⇄ pheromone p=1.000 → S17@127.0.0.1:41917
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:41914
[S2] START round=1 head_norm_before_train=1.169361 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5204520328429998, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.438961885148835, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.168079 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6925374051513717, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4839726919405996, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.172270 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5261031519427486, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4956392929675368, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.180801 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.658381161027016, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5404408600476325, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.215958 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6444488290933905, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5324464772411146, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.175194 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5578288745865156, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.471288100430199, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.204138 (no previous merge yet)
[S8] round=1 local utility u=0.022264 metrics={'f1_val': 0.02291061632784769, 'auprc': 0.02291061632784769, 'loss_val': 1.3918068572149245, 'psi': 0.02291061632784769}-{'f1_val': 0.015173527037933817, 'auprc': 0.015173527037933817, 'loss_val': 1.366700111906326, 'psi': 0.015173527037933817}
[S9] START round=1 head_norm_before_train=1.188261 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.773854677364699, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4760506747292192, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.178270 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.473306309756444, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.405138610597156, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.221020 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.474755976764626, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4084404679904898, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.218607 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4623983523209327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.411698198048426, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.180205 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.553333461458828, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4853982335585265, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.098178 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4784723998082214, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4280690403628846, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.183451 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.493622434806568, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4210748328494698, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.119663 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.09013164216392812, 'auprc': 0.09013164216392812, 'loss_val': 1.419095723853353, 'psi': 0.09013164216392812}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.3745473542998388, 'psi': 0.30380970798684975}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.023)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.185591 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6922726970186994, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5204520328429998, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.212469 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.387589920557683, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6925374051513717, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.187794 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5823913182404579, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5261031519427486, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.216206 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8503948744555574, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.658381161027016, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.236331 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8636547518071525, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6444488290933905, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.212624 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9482809105045213, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5578288745865156, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.219941 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4377269904131726, 'psi': 0.0}-{'f1_val': 0.02291061632784769, 'auprc': 0.02291061632784769, 'loss_val': 1.3918068572149245, 'psi': 0.02291061632784769}
[S9] START round=2 head_norm_before_train=1.240417 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8833316098855852, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.773854677364699, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.196879 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6030323066580816, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.473306309756444, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.230498 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5979667406266962, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.474755976764626, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.233425 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5497870007184202, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4623983523209327, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.196316 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6826481326844225, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.553333461458828, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.114200 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.557846347742179, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4784723998082214, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.201581 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6335583587608014, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.493622434806568, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.137985 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5060177322236104, 'psi': 0.0}-{'f1_val': 0.09013164216392812, 'auprc': 0.09013164216392812, 'loss_val': 1.419095723853353, 'psi': 0.09013164216392812}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.212117 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1497991181330343, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6922726970186994, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.273282 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5102603334918814, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.387589920557683, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.213192 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.675764982539932, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5823913182404579, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.251129 (no previous merge yet)
[S5] round=3 local utility u=0.079099 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6921960032329693, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8503948744555574, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.266873 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.405320692409905, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8636547518071525, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.257728 (no previous merge yet)
[S7] round=3 local utility u=0.066522 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.815236295338193, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9482809105045213, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.246587 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5736697292834856, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4377269904131726, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.310319 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.88615898208495, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8833316098855852, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.223210 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9338448199733287, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6030323066580816, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.252271 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.893550385319907, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5979667406266962, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.256595 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7670467520566093, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5497870007184202, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.224536 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.013157321756744, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6826481326844225, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.138846 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7478452298551217, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.557846347742179, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.233301 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9809696603114169, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6335583587608014, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.167084 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7359935785034648, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5060177322236104, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.246989 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.718012390463178, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1497991181330343, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.315037 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6051108380923207, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5102603334918814, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.244578 (no previous merge yet)
[S4] round=4 local utility u=0.003619 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.668526857717406, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.675764982539932, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.268739 (no previous merge yet)
[S5] round=4 local utility u=0.171920 metrics={'f1_val': 0.017378048780487806, 'auprc': 0.017378048780487806, 'loss_val': 1.5047586898355814, 'psi': 0.017378048780487806}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6921960032329693, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.306346 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.283703810123661, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.405320692409905, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.265373 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8228756758835019, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.815236295338193, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.279623 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6084359849922736, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5736697292834856, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.356564 (no previous merge yet)
[S9] round=4 local utility u=0.049845 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7864690139516686, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.88615898208495, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.253548 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.090557829521837, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9338448199733287, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.283472 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6531889533805844, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.893550385319907, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.284171 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0820441652619097, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7670467520566093, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.261364 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.824034392386538, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.013157321756744, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.170689 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0717010551976474, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7478452298551217, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.272765 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.86135024537481, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9809696603114169, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.203597 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.943709647900686, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7359935785034648, 'psi': 0.0}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.017)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.278618 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7854582146333793, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.718012390463178, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.358302 (no previous merge yet)
[S3] round=5 local utility u=0.017528 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5700547494819177, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6051108380923207, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.271049 (no previous merge yet)
[S4] round=5 local utility u=0.066638 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.535250493780787, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.668526857717406, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.290963 (no previous merge yet)
[S5] round=5 local utility u=1.000000 metrics={'f1_val': 0.29520122022761935, 'auprc': 0.29520122022761935, 'loss_val': 1.3722467692336522, 'psi': 0.29520122022761935}-{'f1_val': 0.017378048780487806, 'auprc': 0.017378048780487806, 'loss_val': 1.5047586898355814, 'psi': 0.017378048780487806}
[S6] START round=5 head_norm_before_train=1.347379 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.525679505754746, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.283703810123661, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.289776 (no previous merge yet)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8301033811916334, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8228756758835019, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.303437 (no previous merge yet)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.23304553169507783, 'auprc': 0.23304553169507783, 'loss_val': 1.4338549538111605, 'psi': 0.23304553169507786}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6084359849922736, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.410385 (no previous merge yet)
[S9] round=5 local utility u=0.302116 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1822379846404503, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7864690139516686, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.273620 (no previous merge yet)
[S10] round=5 local utility u=0.137414 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8157299676426282, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.090557829521837, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.319004 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6904320332661746, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6531889533805844, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.307894 (no previous merge yet)
[S13] round=5 local utility u=0.062544 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9569557271814029, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0820441652619097, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.301960 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1544052799008826, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.824034392386538, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.201185 (no previous merge yet)
[S15] round=5 local utility u=0.103439 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8648227477666406, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0717010551976474, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.313571 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2806354445426256, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.86135024537481, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.234096 (no previous merge yet)
[S17] round=5 local utility u=0.123756 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6961984612315135, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.943709647900686, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S9] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.0656
[S3] RECEIVED delta(kind=head bytes=1792) from S8
[S3] cosine check vs S8: cos=-0.0762
[S3] DROPPED delta from S8 (cos=-0.0762 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S9] ⇄ pheromone p=0.396 → S16@127.0.0.1:41916
[S14] ⇄ pheromone p=0.328 → S11@127.0.0.1:41912
[S7] ⇄ pheromone p=0.336 → S4@127.0.0.1:41904
[S13] ⇄ pheromone p=0.340 → S2@127.0.0.1:41902
[S11] ⇄ pheromone p=0.328 → S16@127.0.0.1:41916
[S6] ⇄ pheromone p=0.328 → S17@127.0.0.1:41917
[S4] ⇄ pheromone p=0.342 → S14@127.0.0.1:41914
[S3] ⇄ pheromone p=0.331 → S17@127.0.0.1:41917
[S10] ⇄ pheromone p=0.355 → S8@127.0.0.1:41909
[S15] ⇄ pheromone p=0.348 → S13@127.0.0.1:41913
[S2] ⇄ pheromone p=0.328 → S17@127.0.0.1:41917
[S8] ⇄ pheromone p=0.530 → S3@127.0.0.1:41903
[S5] ⇄ pheromone p=0.565 → S16@127.0.0.1:41916
[S17] ⇄ pheromone p=0.352 → S14@127.0.0.1:41914
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.0000 head_norm=1.341363
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.119494e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.0000 head_norm=0.973840 delta_norm=0.911949
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.328 → S15@127.0.0.1:41915
[S2] START round=6 head_norm_before_train=1.301818 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.785893615309222, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7854582146333793, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.409679 (no previous merge yet)
[S3] round=6 local utility u=0.132076 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3059037434133174, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5700547494819177, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.286866 (no previous merge yet)
[S4] round=6 local utility u=0.028615 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4780207332109014, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.535250493780787, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.326943 (no previous merge yet)
[S5] round=6 local utility u=1.000000 metrics={'f1_val': 0.9994369411582424, 'auprc': 0.9994369411582424, 'loss_val': 1.2593719952833486, 'psi': 0.9994369411582424}-{'f1_val': 0.29520122022761935, 'auprc': 0.29520122022761935, 'loss_val': 1.3722467692336522, 'psi': 0.29520122022761935}
[S6] START round=6 head_norm_before_train=1.374100 (no previous merge yet)
[S6] round=6 local utility u=0.115571 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2945379891537736, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.525679505754746, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.320475 (no previous merge yet)
[S7] round=6 local utility u=0.074937 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6802290885304658, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8301033811916334, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.320577 (no previous merge yet)
[S8] round=6 local utility u=0.030199 metrics={'f1_val': 0.22784992784992786, 'auprc': 0.22784992784992786, 'loss_val': 1.326696722859529, 'psi': 0.22784992784992786}-{'f1_val': 0.23304553169507783, 'auprc': 0.23304553169507783, 'loss_val': 1.4338549538111605, 'psi': 0.23304553169507786}
[S9] START round=6 head_norm_before_train=1.461903 (no previous merge yet)
[S9] round=6 local utility u=0.430424 metrics={'f1_val': 0.06535141800246609, 'auprc': 0.06535141800246609, 'loss_val': 1.9095521286177737, 'psi': 0.06535141800246609}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1822379846404503, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.278500 (no previous merge yet)
[S10] round=6 local utility u=0.028930 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7578696328779724, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8157299676426282, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.336602 (no previous merge yet)
[S11] round=6 local utility u=0.180054 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3303234453820156, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6904320332661746, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.313048 (no previous merge yet)
[S13] round=6 local utility u=0.115620 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7257157653465751, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9569557271814029, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.327052 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2560092895984067, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1544052799008826, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.213714 (no previous merge yet)
[S15] round=6 local utility u=0.121802 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6212184410813788, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8648227477666406, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=0.973840 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.462614 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3554069602265995, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2806354445426256, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.249334 (no previous merge yet)
[S17] round=6 local utility u=0.088055 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.520089068238508, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6961984612315135, 'psi': 0.0}
[S8] not sending this round → trigger blocked (psi=0.228)
[S10] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.065)
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.999)
[S11] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=7 head_norm_before_train=1.327924 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.033670673440502, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.785893615309222, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.473027 (no previous merge yet)
[S3] round=7 local utility u=0.022707 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2604893994288497, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3059037434133174, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.314453 (no previous merge yet)
[S4] round=7 local utility u=0.017617 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4427860545922557, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4780207332109014, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.373655 (no previous merge yet)
[S5] round=7 local utility u=0.037818 metrics={'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 1.1888026921512884, 'psi': 1.0}-{'f1_val': 0.9994369411582424, 'auprc': 0.9994369411582424, 'loss_val': 1.2593719952833486, 'psi': 0.9994369411582424}
[S6] START round=7 head_norm_before_train=1.395686 (no previous merge yet)
[S6] round=7 local utility u=0.172680 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9491786121794696, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2945379891537736, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.349129 (no previous merge yet)
[S7] round=7 local utility u=0.065889 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.548451654365621, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6802290885304658, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.348145 (no previous merge yet)
[S8] round=7 local utility u=0.293942 metrics={'f1_val': 0.28156467544606895, 'auprc': 0.28156467544606895, 'loss_val': 1.2222452996464632, 'psi': 0.28156467544606895}-{'f1_val': 0.22784992784992786, 'auprc': 0.22784992784992786, 'loss_val': 1.326696722859529, 'psi': 0.22784992784992786}
[S9] START round=7 head_norm_before_train=1.516337 (no previous merge yet)
[S9] round=7 local utility u=0.478396 metrics={'f1_val': 0.16318491946261518, 'auprc': 0.16318491946261518, 'loss_val': 1.8332616881001702, 'psi': 0.16318491946261518}-{'f1_val': 0.06535141800246609, 'auprc': 0.06535141800246609, 'loss_val': 1.9095521286177737, 'psi': 0.06535141800246609}
[S10] START round=7 head_norm_before_train=1.294556 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1972904340350694, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7578696328779724, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.351498 (no previous merge yet)
[S11] round=7 local utility u=0.003351 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.323621039851329, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3303234453820156, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.313158 (no previous merge yet)
[S13] round=7 local utility u=0.037004 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.651707624619444, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7257157653465751, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.350528 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.481291336112494, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2560092895984067, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.225856 (no previous merge yet)
[S15] round=7 local utility u=0.017251 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.586717192981317, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6212184410813788, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=0.997294 cos_to_last_merge=0.9976 (last merge round=5)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6941283420606355, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3554069602265995, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.269568 (no previous merge yet)
[S17] round=7 local utility u=1.000000 metrics={'f1_val': 0.22562509246930018, 'auprc': 0.22562509246930018, 'loss_val': 1.4583745815743618, 'psi': 0.22562509246930018}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.520089068238508, 'psi': 0.0}
[S11] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:41903
[S6] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.163)
[S7] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=-0.0505
[S3] DROPPED delta from S8 (cos=-0.0505 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.6788
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=-0.0016
[S14] DROPPED delta from S17 (cos=-0.0016 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.0000 head_norm=1.032808
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.242380e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.128658 delta_norm=0.524238
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.358976 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.101870149325931, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.033670673440502, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.531752 (no previous merge yet)
[S3] round=8 local utility u=1.000000 metrics={'f1_val': 0.259194847020934, 'auprc': 0.259194847020934, 'loss_val': 1.8505227318509563, 'psi': 0.259194847020934}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2604893994288497, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.348233 (no previous merge yet)
[S4] round=8 local utility u=0.008457 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4258729900711435, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4427860545922557, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.425025 (no previous merge yet)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.6644917878827897, 'auprc': 0.6644917878827897, 'loss_val': 1.1481530136248892, 'psi': 0.6644917878827897}-{'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 1.1888026921512884, 'psi': 1.0}
[S6] START round=8 head_norm_before_train=1.418366 (no previous merge yet)
[S6] round=8 local utility u=0.042893 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8633918398331164, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9491786121794696, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.374218 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5722029981949712, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.548451654365621, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.378548 (no previous merge yet)
[S8] round=8 local utility u=0.470136 metrics={'f1_val': 0.3791176268683886, 'auprc': 0.3791176268683886, 'loss_val': 1.1599504778042693, 'psi': 0.3791176268683886}-{'f1_val': 0.28156467544606895, 'auprc': 0.28156467544606895, 'loss_val': 1.2222452996464632, 'psi': 0.28156467544606895}
[S9] START round=8 head_norm_before_train=1.568813 (no previous merge yet)
[S9] round=8 local utility u=0.933346 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8159509344890965, 'psi': 0.36867172340800847}-{'f1_val': 0.16318491946261518, 'auprc': 0.16318491946261518, 'loss_val': 1.8332616881001702, 'psi': 0.16318491946261518}
[S10] START round=8 head_norm_before_train=1.324629 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3208112141924264, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1972904340350694, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.375474 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4453856526487203, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.323621039851329, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.323382 (no previous merge yet)
[S13] round=8 local utility u=0.002681 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6463457545970104, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.651707624619444, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.375583 (no previous merge yet)
[S14] round=8 local utility u=0.025140 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.431010507647777, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.481291336112494, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.253467 (no previous merge yet)
[S15] round=8 local utility u=0.081231 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4242555069440153, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.586717192981317, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.128658 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.177311 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3395056375363525, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6941283420606355, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.302103 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.16189200329760922, 'auprc': 0.16189200329760922, 'loss_val': 1.3814490664379604, 'psi': 0.16189200329760922}-{'f1_val': 0.22562509246930018, 'auprc': 0.22562509246930018, 'loss_val': 1.4583745815743618, 'psi': 0.22562509246930018}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[S15] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:41916
[S6] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=-0.0408
[S3] DROPPED delta from S8 (cos=-0.0408 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1805) from S9
[S16] cosine check vs S9: cos=-0.0707
[S16] DROPPED delta from S9 (cos=-0.0707 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1805) from S3
[S17] cosine check vs S3: cos=-0.0142
[S17] DROPPED delta from S3 (cos=-0.0142 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=9 head_norm_before_train=1.392945 (no previous merge yet)
[S2] round=9 local utility u=0.067264 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.967342936030313, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.101870149325931, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.579849 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.3003762227238525, 'auprc': 0.3003762227238525, 'loss_val': 2.3729426198037658, 'psi': 0.3003762227238525}-{'f1_val': 0.259194847020934, 'auprc': 0.259194847020934, 'loss_val': 1.8505227318509563, 'psi': 0.259194847020934}
[S4] START round=9 head_norm_before_train=1.380672 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4272630806489763, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4258729900711435, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.470288 (no previous merge yet)
[S5] round=9 local utility u=0.033697 metrics={'f1_val': 0.6637188901259881, 'auprc': 0.6637188901259881, 'loss_val': 1.0738039129827524, 'psi': 0.6637188901259881}-{'f1_val': 0.6644917878827897, 'auprc': 0.6644917878827897, 'loss_val': 1.1481530136248892, 'psi': 0.6644917878827897}
[S6] START round=9 head_norm_before_train=1.448968 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9704730209055077, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8633918398331164, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.386133 (no previous merge yet)
[S7] round=9 local utility u=0.028093 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.516017845952867, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5722029981949712, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.411003 (no previous merge yet)
[S8] round=9 local utility u=0.818337 metrics={'f1_val': 0.5566445081679018, 'auprc': 0.5566445081679018, 'loss_val': 1.12101892947545, 'psi': 0.5566445081679018}-{'f1_val': 0.3791176268683886, 'auprc': 0.3791176268683886, 'loss_val': 1.1599504778042693, 'psi': 0.3791176268683886}
[S9] START round=9 head_norm_before_train=1.617650 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9324266864611928, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8159509344890965, 'psi': 0.36867172340800847}
[S10] START round=9 head_norm_before_train=1.350538 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5335166125624164, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3208112141924264, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.404446 (no previous merge yet)
[S11] round=9 local utility u=0.226728 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9919296777323554, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4453856526487203, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.343840 (no previous merge yet)
[S13] round=9 local utility u=0.043790 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5587661490230922, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6463457545970104, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.400835 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.048909219875484, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.431010507647777, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.284185 (no previous merge yet)
[S15] round=9 local utility u=0.146204 metrics={'f1_val': 0.01913730255164034, 'auprc': 0.01913730255164034, 'loss_val': 1.304083620635561, 'psi': 0.01913730255164034}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4242555069440153, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.155131 cos_to_last_merge=0.9971 (last merge round=7)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4402776460602373, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3395056375363525, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.337527 (no previous merge yet)
[S17] round=9 local utility u=0.021872 metrics={'f1_val': 0.15920145926226187, 'auprc': 0.15920145926226187, 'loss_val': 1.3134901509670822, 'psi': 0.15920145926226187}-{'f1_val': 0.16189200329760922, 'auprc': 0.16189200329760922, 'loss_val': 1.3814490664379604, 'psi': 0.16189200329760922}
[S11] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.019)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.8955
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=-0.0324
[S3] DROPPED delta from S8 (cos=-0.0324 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=-0.0048
[S14] DROPPED delta from S17 (cos=-0.0048 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.0000 head_norm=1.192782
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.465835e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.318073 delta_norm=0.346584
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.428262 (no previous merge yet)
[S2] round=10 local utility u=0.008107 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.951128400372385, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.967342936030313, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.626498 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.30300266058532876, 'auprc': 0.30300266058532876, 'loss_val': 2.5224310893940194, 'psi': 0.30300266058532876}-{'f1_val': 0.3003762227238525, 'auprc': 0.3003762227238525, 'loss_val': 2.3729426198037658, 'psi': 0.3003762227238525}
[S4] START round=10 head_norm_before_train=1.415334 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4408051091098715, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4272630806489763, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.513983 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.7074290722526548, 'psi': 0.33451196111837667}-{'f1_val': 0.6637188901259881, 'auprc': 0.6637188901259881, 'loss_val': 1.0738039129827524, 'psi': 0.6637188901259881}
[S6] START round=10 head_norm_before_train=1.483413 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3775768091886764, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9704730209055077, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.402283 (no previous merge yet)
[S7] round=10 local utility u=0.021142 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4737344965500783, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.516017845952867, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.441631 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.5428587032034454, 'auprc': 0.5428587032034454, 'loss_val': 1.0886252801310965, 'psi': 0.5428587032034454}-{'f1_val': 0.5566445081679018, 'auprc': 0.5566445081679018, 'loss_val': 1.12101892947545, 'psi': 0.5566445081679018}
[S9] START round=10 head_norm_before_train=1.660440 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.147885613741442, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9324266864611928, 'psi': 0.36867172340800847}
[S10] START round=10 head_norm_before_train=1.378828 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.102160863817077, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5335166125624164, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.436427 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3160722416573916, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9919296777323554, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.367889 (no previous merge yet)
[S13] round=10 local utility u=0.089416 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3799334630709148, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5587661490230922, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.432707 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.6213568252143675, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.048909219875484, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.320514 (no previous merge yet)
[S15] round=10 local utility u=1.000000 metrics={'f1_val': 0.2779619398403929, 'auprc': 0.2779619398403929, 'loss_val': 1.1985712439987455, 'psi': 0.2779619398403929}-{'f1_val': 0.01913730255164034, 'auprc': 0.01913730255164034, 'loss_val': 1.304083620635561, 'psi': 0.01913730255164034}
[S16] START round=10 head_norm_before_train=1.318073 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.133087 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1741042684008405, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4402776460602373, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.369248 (no previous merge yet)
[S17] round=10 local utility u=0.020416 metrics={'f1_val': 0.16063394683026586, 'auprc': 0.16063394683026586, 'loss_val': 1.2855499651080817, 'psi': 0.16063394683026586}-{'f1_val': 0.15920145926226187, 'auprc': 0.15920145926226187, 'loss_val': 1.3134901509670822, 'psi': 0.15920145926226187}
[S2] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:41913
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S15
[S13] cosine check vs S15: cos=-0.0117
[S13] DROPPED delta from S15 (cos=-0.0117 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S17
[S14] cosine check vs S17: cos=-0.0081
[S14] DROPPED delta from S17 (cos=-0.0081 < 0.0)
[S14] ⇄ pheromone p=0.111 → S11@127.0.0.1:41912
[S9] ⇄ pheromone p=0.334 → S16@127.0.0.1:41916
[S11] ⇄ pheromone p=0.159 → S16@127.0.0.1:41916
[S6] ⇄ pheromone p=0.140 → S17@127.0.0.1:41917
[S2] ⇄ pheromone p=0.120 → S17@127.0.0.1:41917
[S4] ⇄ pheromone p=0.117 → S14@127.0.0.1:41914
[S10] ⇄ pheromone p=0.119 → S8@127.0.0.1:41909
[S5] ⇄ pheromone p=0.276 → S16@127.0.0.1:41916
[S8] ⇄ pheromone p=0.397 → S3@127.0.0.1:41903
[S13] ⇄ pheromone p=0.150 → S2@127.0.0.1:41902
[S7] ⇄ pheromone p=0.132 → S4@127.0.0.1:41904
[S3] ⇄ pheromone p=0.250 → S17@127.0.0.1:41917
[S15] ⇄ pheromone p=0.360 → S13@127.0.0.1:41913
[S17] ⇄ pheromone p=0.233 → S14@127.0.0.1:41914
[S16] ⇄ pheromone p=0.195 → S15@127.0.0.1:41915
[S2] START round=11 head_norm_before_train=1.461797 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3636644879311115, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.951128400372385, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.667990 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.2649285667259201, 'auprc': 0.2649285667259201, 'loss_val': 2.3724171469553075, 'psi': 0.2649285667259201}-{'f1_val': 0.30300266058532876, 'auprc': 0.30300266058532876, 'loss_val': 2.5224310893940194, 'psi': 0.30300266058532876}
[S4] START round=11 head_norm_before_train=1.450029 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4594578153358653, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4408051091098715, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.561895 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.5027585949400333, 'psi': 0.33400978131092857}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.7074290722526548, 'psi': 0.33451196111837667}
[S6] START round=11 head_norm_before_train=1.517324 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5932423502979014, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3775768091886764, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.429188 (no previous merge yet)
[S7] round=11 local utility u=0.988709 metrics={'f1_val': 0.20239857862007699, 'auprc': 0.20239857862007699, 'loss_val': 1.3179045007800565, 'psi': 0.20239857862007699}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4737344965500783, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.468587 (no previous merge yet)
[S8] round=11 local utility u=0.098023 metrics={'f1_val': 0.5596713517001433, 'auprc': 0.5596713517001433, 'loss_val': 1.0438929170715883, 'psi': 0.5596713517001433}-{'f1_val': 0.5428587032034454, 'auprc': 0.5428587032034454, 'loss_val': 1.0886252801310965, 'psi': 0.5428587032034454}
[S9] START round=11 head_norm_before_train=1.696068 (no previous merge yet)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.329271270445446, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.147885613741442, 'psi': 0.36867172340800847}
[S10] START round=11 head_norm_before_train=1.410424 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3657311303938418, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.102160863817077, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.471450 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.418960298848918, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3160722416573916, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.390813 (no previous merge yet)
[S13] round=11 local utility u=0.771711 metrics={'f1_val': 0.15521234603878767, 'auprc': 0.15521234603878767, 'loss_val': 1.233423533468716, 'psi': 0.15521234603878767}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3799334630709148, 'psi': 0.0}
[S14] START round=11 head_norm_before_train=1.468230 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.305538109353791, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.6213568252143675, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.358103 (no previous merge yet)
[S15] round=11 local utility u=0.061487 metrics={'f1_val': 0.28122717311906503, 'auprc': 0.28122717311906503, 'loss_val': 1.1049849849766984, 'psi': 0.28122717311906503}-{'f1_val': 0.2779619398403929, 'auprc': 0.2779619398403929, 'loss_val': 1.1985712439987455, 'psi': 0.2779619398403929}
[S16] START round=11 head_norm_before_train=1.349344 cos_to_last_merge=0.9979 (last merge round=9)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.00023169601482854495, 'auprc': 0.00023169601482854495, 'loss_val': 2.348378978492194, 'psi': 0.00023169601482854495}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1741042684008405, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.396106 (no previous merge yet)
[S17] round=11 local utility u=0.009034 metrics={'f1_val': 0.1624948282995449, 'auprc': 0.1624948282995449, 'loss_val': 1.2842289526397397, 'psi': 0.1624948282995449}-{'f1_val': 0.16063394683026586, 'auprc': 0.16063394683026586, 'loss_val': 1.2855499651080817, 'psi': 0.16063394683026586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:41903
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.155)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:41904
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S8
[S3] cosine check vs S8: cos=-0.0206
[S3] DROPPED delta from S8 (cos=-0.0206 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.0884
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] cosine check vs S15: cos=-0.0105
[S13] DROPPED delta from S15 (cos=-0.0105 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=-0.0116
[S14] DROPPED delta from S17 (cos=-0.0116 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.0000 head_norm=1.483738
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.936059e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.085662 delta_norm=0.993606
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.489136 (no previous merge yet)
[S2] round=12 local utility u=1.000000 metrics={'f1_val': 0.19538311778612152, 'auprc': 0.19538311778612152, 'loss_val': 2.632078807069906, 'psi': 0.19538311778612152}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3636644879311115, 'psi': 0.0}
[S3] START round=12 head_norm_before_train=1.704877 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.2778353721749948, 'auprc': 0.2778353721749948, 'loss_val': 2.533025652045533, 'psi': 0.2778353721749948}-{'f1_val': 0.2649285667259201, 'auprc': 0.2649285667259201, 'loss_val': 2.3724171469553075, 'psi': 0.2649285667259201}
[S4] START round=12 head_norm_before_train=1.085662 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4611539472278665, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4594578153358653, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.612918 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7760332881711403, 'psi': 0.3335071121394324}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.5027585949400333, 'psi': 0.33400978131092857}
[S6] START round=12 head_norm_before_train=1.548788 (no previous merge yet)
[S6] round=12 local utility u=0.062328 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.468586220761676, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5932423502979014, 'psi': 0.0}
[S7] START round=12 head_norm_before_train=1.459571 (no previous merge yet)
[S7] round=12 local utility u=0.233405 metrics={'f1_val': 0.23828125, 'auprc': 0.23828125, 'loss_val': 1.174038611108329, 'psi': 0.23828125}-{'f1_val': 0.20239857862007699, 'auprc': 0.20239857862007699, 'loss_val': 1.3179045007800565, 'psi': 0.20239857862007699}
[S8] START round=12 head_norm_before_train=1.499526 (no previous merge yet)
[S8] round=12 local utility u=1.000000 metrics={'f1_val': 0.8539615573814674, 'auprc': 0.8539615573814674, 'loss_val': 0.9821628960411926, 'psi': 0.8539615573814674}-{'f1_val': 0.5596713517001433, 'auprc': 0.5596713517001433, 'loss_val': 1.0438929170715883, 'psi': 0.5596713517001433}
[S9] START round=12 head_norm_before_train=1.724732 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.418522448392433, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.329271270445446, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=1.439812 (no previous merge yet)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5612221997384954, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3657311303938418, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.506162 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.503409292542969, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.418960298848918, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.414827 (no previous merge yet)
[S13] round=12 local utility u=1.000000 metrics={'f1_val': 0.5959078797974838, 'auprc': 0.5959078797974838, 'loss_val': 1.1429172900877873, 'psi': 0.5959078797974838}-{'f1_val': 0.15521234603878767, 'auprc': 0.15521234603878767, 'loss_val': 1.233423533468716, 'psi': 0.15521234603878767}
[S14] START round=12 head_norm_before_train=1.500387 (no previous merge yet)
[S14] round=12 local utility u=0.108144 metrics={'f1_val': 0.0220125786163522, 'auprc': 0.0220125786163522, 'loss_val': 5.287362939662979, 'psi': 0.0220125786163522}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.305538109353791, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.394703 (no previous merge yet)
[S15] round=12 local utility u=0.061728 metrics={'f1_val': 0.2842995169082126, 'auprc': 0.2842995169082126, 'loss_val': 1.009180216219691, 'psi': 0.2842995169082126}-{'f1_val': 0.28122717311906503, 'auprc': 0.28122717311906503, 'loss_val': 1.1049849849766984, 'psi': 0.28122717311906503}
[S16] START round=12 head_norm_before_train=1.388523 cos_to_last_merge=0.9926 (last merge round=9)
[S16] round=12 local utility u=0.562279 metrics={'f1_val': 0.10372534696859022, 'auprc': 0.10372534696859022, 'loss_val': 2.1552640016856133, 'psi': 0.10372534696859022}-{'f1_val': 0.00023169601482854495, 'auprc': 0.00023169601482854495, 'loss_val': 2.348378978492194, 'psi': 0.00023169601482854495}
[S17] START round=12 head_norm_before_train=1.420927 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.013336820083682008, 'auprc': 0.013336820083682008, 'loss_val': 1.3053977351873793, 'psi': 0.013336820083682008}-{'f1_val': 0.1624948282995449, 'auprc': 0.1624948282995449, 'loss_val': 1.2842289526397397, 'psi': 0.1624948282995449}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.022)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[S2] not sending this round → trigger blocked (psi=0.195)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:41902
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.104)
[S6] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=-0.0159
[S3] DROPPED delta from S8 (cos=-0.0159 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.7105
[S2] RECEIVED delta(kind=head bytes=1794) from S13
[S2] cosine check vs S13: cos=0.1306
[S13] RECEIVED delta(kind=head bytes=1801) from S15
[S13] cosine check vs S15: cos=-0.0110
[S13] DROPPED delta from S15 (cos=-0.0110 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.0000 head_norm=1.124812
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.249212e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.210568 delta_norm=0.524921
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.1954 head_norm=1.515184
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.752494e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.2050 head_norm=1.111905 delta_norm=0.975249
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.111905 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.341772 metrics={'f1_val': 0.219775330886442, 'auprc': 0.219775330886442, 'loss_val': 2.1680641778387146, 'psi': 0.21977533088644197}-{'f1_val': 0.19538311778612152, 'auprc': 0.19538311778612152, 'loss_val': 2.632078807069906, 'psi': 0.19538311778612152}
[S3] START round=13 head_norm_before_train=1.737031 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.26055426055426056, 'auprc': 0.26055426055426056, 'loss_val': 2.5041048469833944, 'psi': 0.26055426055426056}-{'f1_val': 0.2778353721749948, 'auprc': 0.2778353721749948, 'loss_val': 2.533025652045533, 'psi': 0.2778353721749948}
[S4] START round=13 head_norm_before_train=1.210568 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.002172 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4568102762974686, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4611539472278665, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.657038 (no previous merge yet)
[S5] round=13 local utility u=0.117870 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5402936072627242, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7760332881711403, 'psi': 0.3335071121394324}
[S6] START round=13 head_norm_before_train=1.576428 (no previous merge yet)
[S6] round=13 local utility u=0.282778 metrics={'f1_val': 0.04108084358523726, 'auprc': 0.04108084358523726, 'loss_val': 3.27275839879328, 'psi': 0.04108084358523726}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.468586220761676, 'psi': 0.0}
[S7] START round=13 head_norm_before_train=1.488904 (no previous merge yet)
[S7] round=13 local utility u=0.057294 metrics={'f1_val': 0.23566543924250394, 'auprc': 0.23566543924250394, 'loss_val': 1.0359081826558112, 'psi': 0.23566543924250394}-{'f1_val': 0.23828125, 'auprc': 0.23828125, 'loss_val': 1.174038611108329, 'psi': 0.23828125}
[S8] START round=13 head_norm_before_train=1.529668 (no previous merge yet)
[S8] round=13 local utility u=0.684189 metrics={'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 0.9281311444297089, 'psi': 1.0}-{'f1_val': 0.8539615573814674, 'auprc': 0.8539615573814674, 'loss_val': 0.9821628960411926, 'psi': 0.8539615573814674}
[S9] START round=13 head_norm_before_train=1.747456 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4759998356656845, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.418522448392433, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=1.468084 (no previous merge yet)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.66445172226637, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5612221997384954, 'psi': 0.0}
[S11] START round=13 head_norm_before_train=1.539317 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.661991157129037, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.503409292542969, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.441911 (no previous merge yet)
[S13] round=13 local utility u=0.229605 metrics={'f1_val': 0.631281910086028, 'auprc': 0.631281910086028, 'loss_val': 1.002074056714013, 'psi': 0.631281910086028}-{'f1_val': 0.5959078797974838, 'auprc': 0.5959078797974838, 'loss_val': 1.1429172900877873, 'psi': 0.5959078797974838}
[S14] START round=13 head_norm_before_train=1.524520 (no previous merge yet)
[S14] round=13 local utility u=0.130046 metrics={'f1_val': 0.05237694572991165, 'auprc': 0.05237694572991165, 'loss_val': 5.300550517696384, 'psi': 0.05237694572991165}-{'f1_val': 0.0220125786163522, 'auprc': 0.0220125786163522, 'loss_val': 5.287362939662979, 'psi': 0.0220125786163522}
[S15] START round=13 head_norm_before_train=1.436468 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.2681268882175227, 'auprc': 0.2681268882175227, 'loss_val': 0.96747604141755, 'psi': 0.2681268882175227}-{'f1_val': 0.2842995169082126, 'auprc': 0.2842995169082126, 'loss_val': 1.009180216219691, 'psi': 0.2842995169082126}
[S16] START round=13 head_norm_before_train=1.430071 cos_to_last_merge=0.9860 (last merge round=9)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.0004331504475887958, 'auprc': 0.0004331504475887958, 'loss_val': 2.752171686672957, 'psi': 0.0004331504475887958}-{'f1_val': 0.10372534696859022, 'auprc': 0.10372534696859022, 'loss_val': 2.1552640016856133, 'psi': 0.10372534696859022}
[S17] START round=13 head_norm_before_train=1.448632 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.008428657435279952, 'auprc': 0.008428657435279952, 'loss_val': 1.334723813022867, 'psi': 0.008428657435279952}-{'f1_val': 0.013336820083682008, 'auprc': 0.013336820083682008, 'loss_val': 1.3053977351873793, 'psi': 0.013336820083682008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:41904
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:41903
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.052)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:41916
[S6] not sending this round → trigger blocked (psi=0.041)
[S5] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=0.7221
[S16] RECEIVED delta(kind=head bytes=1806) from S5
[S16] cosine check vs S5: cos=0.9232
[S3] RECEIVED delta(kind=head bytes=1793) from S8
[S3] cosine check vs S8: cos=-0.0123
[S3] DROPPED delta from S8 (cos=-0.0123 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S7
[S4] cosine check vs S7: cos=0.9193
[S17] RECEIVED delta(kind=head bytes=1799) from S2
[S17] cosine check vs S2: cos=0.0136
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.0000 head_norm=1.248368
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.075487e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.355260 delta_norm=0.307549
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.2198 head_norm=1.147447
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.102843e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.2125 head_norm=1.215952 delta_norm=0.510284
[S2] aggregate: ROLLBACK (f1_val pre=0.220 post=0.213 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.0084 head_norm=1.474830
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.281155e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.1603 head_norm=0.940468 delta_norm=0.928116
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.0004 head_norm=1.465909
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.271518e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.0334 head_norm=1.545730 delta_norm=0.327152
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.215952 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.04106090373280943, 'auprc': 0.04106090373280943, 'loss_val': 1.8538118122434468, 'psi': 0.04106090373280943}-{'f1_val': 0.219775330886442, 'auprc': 0.219775330886442, 'loss_val': 2.1680641778387146, 'psi': 0.21977533088644197}
[S3] START round=14 head_norm_before_train=1.764043 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.27290606985418786, 'auprc': 0.27290606985418786, 'loss_val': 2.6382178197738857, 'psi': 0.27290606985418786}-{'f1_val': 0.26055426055426056, 'auprc': 0.26055426055426056, 'loss_val': 2.5041048469833944, 'psi': 0.26055426055426056}
[S4] START round=14 head_norm_before_train=1.355260 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.004925 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4469602417827294, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4568102762974686, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.686337 (no previous merge yet)
[S5] round=14 local utility u=0.012291 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.515710978626486, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5402936072627242, 'psi': 0.3335071121394324}
[S6] START round=14 head_norm_before_train=1.602162 (no previous merge yet)
[S6] round=14 local utility u=0.077072 metrics={'f1_val': 0.07349938750510412, 'auprc': 0.07349938750510412, 'loss_val': 3.4103803364429566, 'psi': 0.07349938750510412}-{'f1_val': 0.04108084358523726, 'auprc': 0.04108084358523726, 'loss_val': 3.27275839879328, 'psi': 0.04108084358523726}
[S7] START round=14 head_norm_before_train=1.517962 (no previous merge yet)
[S7] round=14 local utility u=0.519979 metrics={'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 0.87496029690456, 'psi': 0.3333333333333333}-{'f1_val': 0.23566543924250394, 'auprc': 0.23566543924250394, 'loss_val': 1.0359081826558112, 'psi': 0.23566543924250394}
[S8] START round=14 head_norm_before_train=1.558660 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.46664401687742074, 'auprc': 0.46664401687742074, 'loss_val': 0.8890010954476543, 'psi': 0.46664401687742074}-{'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 0.9281311444297089, 'psi': 1.0}
[S9] START round=14 head_norm_before_train=1.766339 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.528038540379438, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4759998356656845, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.494525 (no previous merge yet)
[S10] round=14 local utility u=0.017856 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6287393179138503, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.66445172226637, 'psi': 0.0}
[S11] START round=14 head_norm_before_train=1.569751 (no previous merge yet)
[S11] round=14 local utility u=1.000000 metrics={'f1_val': 0.33114549148304423, 'auprc': 0.33114549148304423, 'loss_val': 2.558525946630349, 'psi': 0.33114549148304423}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.661991157129037, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.470111 (no previous merge yet)
[S13] round=14 local utility u=0.207313 metrics={'f1_val': 0.6591406135708104, 'auprc': 0.6591406135708104, 'loss_val': 0.8381769875870386, 'psi': 0.6591406135708104}-{'f1_val': 0.631281910086028, 'auprc': 0.631281910086028, 'loss_val': 1.002074056714013, 'psi': 0.631281910086028}
[S14] START round=14 head_norm_before_train=1.548223 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.006821705426356589, 'auprc': 0.006821705426356589, 'loss_val': 5.410594300800418, 'psi': 0.006821705426356588}-{'f1_val': 0.05237694572991165, 'auprc': 0.05237694572991165, 'loss_val': 5.300550517696384, 'psi': 0.05237694572991165}
[S15] START round=14 head_norm_before_train=1.476386 (no previous merge yet)
[S15] round=14 local utility u=0.127200 metrics={'f1_val': 0.28038067349926793, 'auprc': 0.28038067349926793, 'loss_val': 0.8233596969946413, 'psi': 0.28038067349926793}-{'f1_val': 0.2681268882175227, 'auprc': 0.2681268882175227, 'loss_val': 0.96747604141755, 'psi': 0.2681268882175227}
[S16] START round=14 head_norm_before_train=1.545730 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.541896 metrics={'f1_val': 0.07578740157480315, 'auprc': 0.07578740157480315, 'loss_val': 2.346567928171932, 'psi': 0.07578740157480315}-{'f1_val': 0.0004331504475887958, 'auprc': 0.0004331504475887958, 'loss_val': 2.752171686672957, 'psi': 0.0004331504475887958}
[S17] START round=14 head_norm_before_train=0.940468 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.709874 metrics={'f1_val': 0.16192244224422442, 'auprc': 0.16192244224422442, 'loss_val': 1.2964191665161662, 'psi': 0.16192244224422442}-{'f1_val': 0.008428657435279952, 'auprc': 0.008428657435279952, 'loss_val': 1.334723813022867, 'psi': 0.008428657435279952}
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:41916
[S6] not sending this round → trigger blocked (psi=0.073)
[S10] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:41904
[S16] not sending this round → trigger blocked (psi=0.076)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:41902
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] cosine check vs S15: cos=-0.0140
[S13] DROPPED delta from S15 (cos=-0.0140 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] cosine check vs S11: cos=-0.0119
[S16] DROPPED delta from S11 (cos=-0.0119 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.9770
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] cosine check vs S7: cos=0.9644
[S2] RECEIVED delta(kind=head bytes=1799) from S13
[S2] cosine check vs S13: cos=0.9268
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S17
[S14] cosine check vs S17: cos=0.0322
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.0000 head_norm=1.388472
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.114810e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.455666 delta_norm=0.211481
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.0411 head_norm=1.251031
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.877225e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.0556 head_norm=1.346155 delta_norm=0.287723
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.0068 head_norm=1.573468
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.140673e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.1024 head_norm=0.940932 delta_norm=0.914067
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.0758 head_norm=1.575921
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.888858e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.0905 head_norm=1.634771 delta_norm=0.188886
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.346155 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.861506 metrics={'f1_val': 0.2335058214747736, 'auprc': 0.2335058214747736, 'loss_val': 1.8628048992736885, 'psi': 0.2335058214747736}-{'f1_val': 0.04106090373280943, 'auprc': 0.04106090373280943, 'loss_val': 1.8538118122434468, 'psi': 0.04106090373280943}
[S3] START round=15 head_norm_before_train=1.786891 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.26050365766815564, 'auprc': 0.26050365766815564, 'loss_val': 2.6256391698350225, 'psi': 0.26050365766815564}-{'f1_val': 0.27290606985418786, 'auprc': 0.27290606985418786, 'loss_val': 2.6382178197738857, 'psi': 0.27290606985418786}
[S4] START round=15 head_norm_before_train=1.455666 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4495702707799938, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4469602417827294, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.712536 (no previous merge yet)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5162054248249914, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.515710978626486, 'psi': 0.3335071121394324}
[S6] START round=15 head_norm_before_train=1.626465 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.025442980463425715, 'auprc': 0.025442980463425715, 'loss_val': 4.063410348136398, 'psi': 0.025442980463425715}-{'f1_val': 0.07349938750510412, 'auprc': 0.07349938750510412, 'loss_val': 3.4103803364429566, 'psi': 0.07349938750510412}
[S7] START round=15 head_norm_before_train=1.549038 (no previous merge yet)
[S7] round=15 local utility u=0.083638 metrics={'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.7069372429857221, 'psi': 0.3332504352151206}-{'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 0.87496029690456, 'psi': 0.3333333333333333}
[S8] START round=15 head_norm_before_train=1.593675 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8557422781049988, 'psi': 0.35939447907390915}-{'f1_val': 0.46664401687742074, 'auprc': 0.46664401687742074, 'loss_val': 0.8890010954476543, 'psi': 0.46664401687742074}
[S9] START round=15 head_norm_before_train=1.782618 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5808867169537333, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.528038540379438, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.517010 (no previous merge yet)
[S10] round=15 local utility u=0.041725 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5452889854361347, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6287393179138503, 'psi': 0.0}
[S11] START round=15 head_norm_before_train=1.596733 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.6904245326322473, 'psi': 0.3319360347772085}-{'f1_val': 0.33114549148304423, 'auprc': 0.33114549148304423, 'loss_val': 2.558525946630349, 'psi': 0.33114549148304423}
[S13] START round=15 head_norm_before_train=1.491562 (no previous merge yet)
[S13] round=15 local utility u=0.016799 metrics={'f1_val': 0.6630673451004667, 'auprc': 0.6630673451004667, 'loss_val': 0.8399190751458873, 'psi': 0.6630673451004667}-{'f1_val': 0.6591406135708104, 'auprc': 0.6591406135708104, 'loss_val': 0.8381769875870386, 'psi': 0.6591406135708104}
[S14] START round=15 head_norm_before_train=0.940932 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=1.000000 metrics={'f1_val': 0.13071401586701928, 'auprc': 0.13071401586701928, 'loss_val': 2.983388581885308, 'psi': 0.13071401586701928}-{'f1_val': 0.006821705426356589, 'auprc': 0.006821705426356589, 'loss_val': 5.410594300800418, 'psi': 0.006821705426356588}
[S15] START round=15 head_norm_before_train=1.512495 (no previous merge yet)
[S15] round=15 local utility u=0.218965 metrics={'f1_val': 0.33686842342419304, 'auprc': 0.33686842342419304, 'loss_val': 0.8938191414471814, 'psi': 0.33686842342419304}-{'f1_val': 0.28038067349926793, 'auprc': 0.28038067349926793, 'loss_val': 0.8233596969946413, 'psi': 0.28038067349926793}
[S16] START round=15 head_norm_before_train=1.634771 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.146017 metrics={'f1_val': 0.09124990029512642, 'auprc': 0.09124990029512642, 'loss_val': 2.1936968153318595, 'psi': 0.09124990029512642}-{'f1_val': 0.07578740157480315, 'auprc': 0.07578740157480315, 'loss_val': 2.346567928171932, 'psi': 0.07578740157480315}
[S17] START round=15 head_norm_before_train=0.982824 cos_to_last_merge=0.9982 (last merge round=13)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.1565676699222643, 'auprc': 0.1565676699222643, 'loss_val': 1.2498321407469126, 'psi': 0.1565676699222643}-{'f1_val': 0.16192244224422442, 'auprc': 0.16192244224422442, 'loss_val': 1.2964191665161662, 'psi': 0.16192244224422442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[S16] not sending this round → trigger blocked (psi=0.091)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:41904
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:41902
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.131)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S15
[S13] cosine check vs S15: cos=-0.0153
[S13] DROPPED delta from S15 (cos=-0.0153 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] cosine check vs S2: cos=0.4574
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.9760
[S2] RECEIVED delta(kind=head bytes=1806) from S13
[S2] cosine check vs S13: cos=0.9706
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.0000 head_norm=1.488469
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.744279e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.526156 delta_norm=0.174428
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.039 → S14@127.0.0.1:41914
[S11] ⇄ pheromone p=0.212 → S16@127.0.0.1:41916
[S5] ⇄ pheromone p=0.108 → S16@127.0.0.1:41916
[S14] ⇄ pheromone p=0.264 → S11@127.0.0.1:41912
[S3] ⇄ pheromone p=0.082 → S17@127.0.0.1:41917
[S9] ⇄ pheromone p=0.109 → S16@127.0.0.1:41916
[S8] ⇄ pheromone p=0.328 → S3@127.0.0.1:41903
[S6] ⇄ pheromone p=0.101 → S17@127.0.0.1:41917
[S10] ⇄ pheromone p=0.050 → S8@127.0.0.1:41909
[S13] ⇄ pheromone p=0.281 → S2@127.0.0.1:41902
[S7] ⇄ pheromone p=0.255 → S4@127.0.0.1:41904
[S15] ⇄ pheromone p=0.193 → S13@127.0.0.1:41913
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.2335 head_norm=1.378722
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.858675e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.2125 head_norm=1.431544 delta_norm=0.185867
[S2] aggregate: ROLLBACK (f1_val pre=0.234 post=0.213 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.358 → S17@127.0.0.1:41917
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.1566 head_norm=1.034247
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.453798e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.1523 head_norm=1.033806 delta_norm=0.645380
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.191 → S14@127.0.0.1:41914
[S16] ⇄ pheromone p=0.237 → S15@127.0.0.1:41915
[S2] START round=16 head_norm_before_train=1.431544 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.08505526189332052, 'auprc': 0.08505526189332052, 'loss_val': 1.6777542652485942, 'psi': 0.08505526189332052}-{'f1_val': 0.2335058214747736, 'auprc': 0.2335058214747736, 'loss_val': 1.8628048992736885, 'psi': 0.2335058214747736}
[S3] START round=16 head_norm_before_train=1.803132 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.2584457289659602, 'auprc': 0.2584457289659602, 'loss_val': 2.628389019063184, 'psi': 0.2584457289659602}-{'f1_val': 0.26050365766815564, 'auprc': 0.26050365766815564, 'loss_val': 2.6256391698350225, 'psi': 0.26050365766815564}
[S4] START round=16 head_norm_before_train=1.526156 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4570669146797157, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4495702707799938, 'psi': 0.0}
[S5] START round=16 head_norm_before_train=1.736503 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.689973375204409, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5162054248249914, 'psi': 0.3335071121394324}
[S6] START round=16 head_norm_before_train=1.649526 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.03946208112874779, 'auprc': 0.03946208112874779, 'loss_val': 4.391540101508275, 'psi': 0.03946208112874779}-{'f1_val': 0.025442980463425715, 'auprc': 0.025442980463425715, 'loss_val': 4.063410348136398, 'psi': 0.025442980463425715}
[S7] START round=16 head_norm_before_train=1.582283 (no previous merge yet)
[S7] round=16 local utility u=0.042974 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6202442972709703, 'psi': 0.33316757831924415}-{'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 0.7069372429857221, 'psi': 0.3332504352151206}
[S8] START round=16 head_norm_before_train=1.631604 (no previous merge yet)
[S8] round=16 local utility u=0.010869 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8340045652107029, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8557422781049988, 'psi': 0.35939447907390915}
[S9] START round=16 head_norm_before_train=1.797862 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6309652038731977, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5808867169537333, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.536319 (no previous merge yet)
[S10] round=16 local utility u=0.650975 metrics={'f1_val': 0.1261615439599714, 'auprc': 0.1261615439599714, 'loss_val': 3.378793072958863, 'psi': 0.1261615439599714}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5452889854361347, 'psi': 0.0}
[S11] START round=16 head_norm_before_train=1.624054 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.774591275603515, 'psi': 0.3317042898145993}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.6904245326322473, 'psi': 0.3319360347772085}
[S13] START round=16 head_norm_before_train=1.505608 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6428473000692149, 'auprc': 0.6428473000692149, 'loss_val': 0.8628044093881008, 'psi': 0.6428473000692149}-{'f1_val': 0.6630673451004667, 'auprc': 0.6630673451004667, 'loss_val': 0.8399190751458873, 'psi': 0.6630673451004667}
[S14] START round=16 head_norm_before_train=0.986213 cos_to_last_merge=0.9980 (last merge round=14)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.12165450121654502, 'auprc': 0.12165450121654502, 'loss_val': 3.3236180930076995, 'psi': 0.121654501216545}-{'f1_val': 0.13071401586701928, 'auprc': 0.13071401586701928, 'loss_val': 2.983388581885308, 'psi': 0.13071401586701928}
[S15] START round=16 head_norm_before_train=1.542951 (no previous merge yet)
[S15] round=16 local utility u=1.000000 metrics={'f1_val': 0.6169388989715668, 'auprc': 0.6169388989715668, 'loss_val': 0.6855198998566217, 'psi': 0.6169388989715668}-{'f1_val': 0.33686842342419304, 'auprc': 0.33686842342419304, 'loss_val': 0.8938191414471814, 'psi': 0.33686842342419304}
[S16] START round=16 head_norm_before_train=1.666504 cos_to_last_merge=0.9993 (last merge round=14)
[S16] round=16 local utility u=0.274852 metrics={'f1_val': 0.1454992053171507, 'auprc': 0.1454992053171507, 'loss_val': 2.1322372767223654, 'psi': 0.1454992053171507}-{'f1_val': 0.09124990029512642, 'auprc': 0.09124990029512642, 'loss_val': 2.1936968153318595, 'psi': 0.09124990029512642}
[S17] START round=16 head_norm_before_train=1.033806 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.036084 metrics={'f1_val': 0.15785771704180065, 'auprc': 0.15785771704180065, 'loss_val': 1.1892749644632397, 'psi': 0.15785771704180065}-{'f1_val': 0.1565676699222643, 'auprc': 0.1565676699222643, 'loss_val': 1.2498321407469126, 'psi': 0.1565676699222643}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:41913
[S10] not sending this round → trigger blocked (psi=0.126)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[S16] not sending this round → trigger blocked (psi=0.145)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:41904
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=-0.0033
[S3] DROPPED delta from S8 (cos=-0.0033 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9813
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] cosine check vs S15: cos=-0.0159
[S13] DROPPED delta from S15 (cos=-0.0159 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S17
[S14] cosine check vs S17: cos=0.4261
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.0000 head_norm=1.562831
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.562684e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.0000 head_norm=1.583075 delta_norm=0.156268
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.1217 head_norm=1.050493
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.698821e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.1357 head_norm=0.898191 delta_norm=0.569882
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.464438 cos_to_last_merge=0.9971 (last merge round=15)
[S2] round=17 local utility u=0.686009 metrics={'f1_val': 0.2447535383113714, 'auprc': 0.2447535383113714, 'loss_val': 1.743020945873181, 'psi': 0.24475353831137137}-{'f1_val': 0.08505526189332052, 'auprc': 0.08505526189332052, 'loss_val': 1.6777542652485942, 'psi': 0.08505526189332052}
[S3] START round=17 head_norm_before_train=1.819950 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.258047967166859, 'auprc': 0.258047967166859, 'loss_val': 2.6440070286073927, 'psi': 0.258047967166859}-{'f1_val': 0.2584457289659602, 'auprc': 0.2584457289659602, 'loss_val': 2.628389019063184, 'psi': 0.2584457289659602}
[S4] START round=17 head_norm_before_train=1.583075 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.46736221225992, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4570669146797157, 'psi': 0.0}
[S5] START round=17 head_norm_before_train=1.760273 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7195788138510144, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.689973375204409, 'psi': 0.3335071121394324}
[S6] START round=17 head_norm_before_train=1.670518 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.0023820867079561697, 'auprc': 0.0023820867079561697, 'loss_val': 5.077064837241993, 'psi': 0.0023820867079561697}-{'f1_val': 0.03946208112874779, 'auprc': 0.03946208112874779, 'loss_val': 4.391540101508275, 'psi': 0.03946208112874779}
[S7] START round=17 head_norm_before_train=1.618224 (no previous merge yet)
[S7] round=17 local utility u=0.009747 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6007510971689657, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6202442972709703, 'psi': 0.33316757831924415}
[S8] START round=17 head_norm_before_train=1.670224 (no previous merge yet)
[S8] round=17 local utility u=0.006188 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.82162770143536, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8340045652107029, 'psi': 0.35939447907390915}
[S9] START round=17 head_norm_before_train=1.811923 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.674339681944212, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6309652038731977, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.551780 (no previous merge yet)
[S10] round=17 local utility u=0.317774 metrics={'f1_val': 0.18303030303030304, 'auprc': 0.18303030303030304, 'loss_val': 3.2550647158255086, 'psi': 0.18303030303030304}-{'f1_val': 0.1261615439599714, 'auprc': 0.1261615439599714, 'loss_val': 3.378793072958863, 'psi': 0.1261615439599714}
[S11] START round=17 head_norm_before_train=1.647684 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.0402650126248476, 'psi': 0.3319360347772085}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.774591275603515, 'psi': 0.3317042898145993}
[S13] START round=17 head_norm_before_train=1.521750 (no previous merge yet)
[S13] round=17 local utility u=0.032134 metrics={'f1_val': 0.6432593850628522, 'auprc': 0.6432593850628522, 'loss_val': 0.8022460000825822, 'psi': 0.6432593850628522}-{'f1_val': 0.6428473000692149, 'auprc': 0.6428473000692149, 'loss_val': 0.8628044093881008, 'psi': 0.6428473000692149}
[S14] START round=17 head_norm_before_train=0.898191 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.553662 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 2.3429601462154164, 'psi': 0.13572854291417166}-{'f1_val': 0.12165450121654502, 'auprc': 0.12165450121654502, 'loss_val': 3.3236180930076995, 'psi': 0.121654501216545}
[S15] START round=17 head_norm_before_train=1.570112 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6106204920272142, 'auprc': 0.6106204920272142, 'loss_val': 0.7717835919724156, 'psi': 0.6106204920272142}-{'f1_val': 0.6169388989715668, 'auprc': 0.6169388989715668, 'loss_val': 0.6855198998566217, 'psi': 0.6169388989715668}
[S16] START round=17 head_norm_before_train=1.699640 cos_to_last_merge=0.9973 (last merge round=14)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.09152515347205613, 'auprc': 0.09152515347205613, 'loss_val': 2.667210503609215, 'psi': 0.09152515347205613}-{'f1_val': 0.1454992053171507, 'auprc': 0.1454992053171507, 'loss_val': 2.1322372767223654, 'psi': 0.1454992053171507}
[S17] START round=17 head_norm_before_train=1.076796 cos_to_last_merge=0.9952 (last merge round=15)
[S17] round=17 local utility u=0.009913 metrics={'f1_val': 0.15392906133646875, 'auprc': 0.15392906133646875, 'loss_val': 1.134091689307064, 'psi': 0.15392906133646875}-{'f1_val': 0.15785771704180065, 'auprc': 0.15785771704180065, 'loss_val': 1.1892749644632397, 'psi': 0.15785771704180065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:41903
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.183)
[S14] not sending this round → trigger blocked (psi=0.136)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:41904
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=-0.0007
[S3] DROPPED delta from S8 (cos=-0.0007 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S7
[S4] cosine check vs S7: cos=0.9845
[S17] RECEIVED delta(kind=head bytes=1798) from S2
[S17] cosine check vs S2: cos=0.8170
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=0.9672
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=0.8012
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.1357 head_norm=0.947665
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.403694e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.1359 head_norm=0.989037 delta_norm=0.340369
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.0000 head_norm=1.619766
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.449777e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.0000 head_norm=1.630146 delta_norm=0.144978
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.2448 head_norm=1.506900
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.956873e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.3675 head_norm=1.510733 delta_norm=0.195687
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.1539 head_norm=1.135792
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.370817e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.1533 head_norm=1.260692 delta_norm=0.437082
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.510733 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.197562358276644, 'auprc': 0.197562358276644, 'loss_val': 1.710518895798684, 'psi': 0.197562358276644}-{'f1_val': 0.2447535383113714, 'auprc': 0.2447535383113714, 'loss_val': 1.743020945873181, 'psi': 0.24475353831137137}
[S3] START round=18 head_norm_before_train=1.836487 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.255881978888465, 'auprc': 0.255881978888465, 'loss_val': 2.667840734431782, 'psi': 0.255881978888465}-{'f1_val': 0.258047967166859, 'auprc': 0.258047967166859, 'loss_val': 2.6440070286073927, 'psi': 0.258047967166859}
[S4] START round=18 head_norm_before_train=1.630146 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4684137475637749, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.46736221225992, 'psi': 0.0}
[S5] START round=18 head_norm_before_train=1.780849 (no previous merge yet)
[S5] round=18 local utility u=0.001082 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7174143610543187, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7195788138510144, 'psi': 0.3335071121394324}
[S6] START round=18 head_norm_before_train=1.689179 (no previous merge yet)
[S6] round=18 local utility u=0.074758 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 5.072084648596076, 'psi': 0.018441678192715538}-{'f1_val': 0.0023820867079561697, 'auprc': 0.0023820867079561697, 'loss_val': 5.077064837241993, 'psi': 0.0023820867079561697}
[S7] START round=18 head_norm_before_train=1.653223 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.5600366971085329, 'psi': 0.24968913205670232}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6007510971689657, 'psi': 0.33316757831924415}
[S8] START round=18 head_norm_before_train=1.703902 (no previous merge yet)
[S8] round=18 local utility u=0.006090 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.809448418970076, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.82162770143536, 'psi': 0.35939447907390915}
[S9] START round=18 head_norm_before_train=1.824593 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7132019761567143, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.674339681944212, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.570423 (no previous merge yet)
[S10] round=18 local utility u=0.087611 metrics={'f1_val': 0.19450934579439252, 'auprc': 0.19450934579439252, 'loss_val': 3.1831542562658717, 'psi': 0.19450934579439252}-{'f1_val': 0.18303030303030304, 'auprc': 0.18303030303030304, 'loss_val': 3.2550647158255086, 'psi': 0.18303030303030304}
[S11] START round=18 head_norm_before_train=1.670358 (no previous merge yet)
[S11] round=18 local utility u=0.074697 metrics={'f1_val': 0.3317050476855083, 'auprc': 0.3317050476855083, 'loss_val': 2.8887923979604757, 'psi': 0.3317050476855083}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.0402650126248476, 'psi': 0.3319360347772085}
[S13] START round=18 head_norm_before_train=1.539633 (no previous merge yet)
[S13] round=18 local utility u=1.000000 metrics={'f1_val': 0.9654021056328973, 'auprc': 0.9654021056328973, 'loss_val': 0.7520696136208457, 'psi': 0.9654021056328973}-{'f1_val': 0.6432593850628522, 'auprc': 0.6432593850628522, 'loss_val': 0.8022460000825822, 'psi': 0.6432593850628522}
[S14] START round=18 head_norm_before_train=0.989037 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.09277238403451997, 'auprc': 0.09277238403451997, 'loss_val': 2.0747511840094965, 'psi': 0.09277238403451997}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 2.3429601462154164, 'psi': 0.13572854291417166}
[S15] START round=18 head_norm_before_train=1.598598 (no previous merge yet)
[S15] round=18 local utility u=0.144672 metrics={'f1_val': 0.6175265408452612, 'auprc': 0.6175265408452612, 'loss_val': 0.544593503990158, 'psi': 0.6175265408452612}-{'f1_val': 0.6106204920272142, 'auprc': 0.6106204920272142, 'loss_val': 0.7717835919724156, 'psi': 0.6106204920272142}
[S16] START round=18 head_norm_before_train=1.731270 cos_to_last_merge=0.9948 (last merge round=14)
[S16] round=18 local utility u=0.400875 metrics={'f1_val': 0.14897739504843918, 'auprc': 0.14897739504843918, 'loss_val': 2.3825304995497487, 'psi': 0.14897739504843918}-{'f1_val': 0.09152515347205613, 'auprc': 0.09152515347205613, 'loss_val': 2.667210503609215, 'psi': 0.09152515347205613}
[S17] START round=18 head_norm_before_train=1.260692 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.013384 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.0928170265155712, 'psi': 0.15231723870467326}-{'f1_val': 0.15392906133646875, 'auprc': 0.15392906133646875, 'loss_val': 1.134091689307064, 'psi': 0.15392906133646875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:41902
[S10] not sending this round → trigger blocked (psi=0.195)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[S16] not sending this round → trigger blocked (psi=0.149)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:41903
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:41916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[S5] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S8
[S3] cosine check vs S8: cos=0.0021
[S16] RECEIVED delta(kind=head bytes=1800) from S11
[S16] cosine check vs S11: cos=-0.0013
[S16] DROPPED delta from S11 (cos=-0.0013 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1807) from S5
[S16] cosine check vs S5: cos=0.9734
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] cosine check vs S15: cos=-0.0178
[S13] DROPPED delta from S15 (cos=-0.0178 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S13
[S2] cosine check vs S13: cos=0.9828
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] cosine check vs S17: cos=0.8801
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.2559 head_norm=1.855062
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.269126e+00
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.2580 head_norm=1.271728 delta_norm=1.269126
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.1976 head_norm=1.547054
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.436922e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.2021 head_norm=1.543042 delta_norm=0.143692
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.0928 head_norm=1.025849
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.142760e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.1343 head_norm=1.128065 delta_norm=0.314276
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.1490 head_norm=1.759156
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.060774e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.1530 head_norm=1.767531 delta_norm=0.206077
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.543042 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.779178 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6814001710957518, 'psi': 0.3674775928297055}-{'f1_val': 0.197562358276644, 'auprc': 0.197562358276644, 'loss_val': 1.710518895798684, 'psi': 0.197562358276644}
[S3] START round=19 head_norm_before_train=1.271728 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.395324 metrics={'f1_val': 0.25024875621890547, 'auprc': 0.25024875621890547, 'loss_val': 1.8264939024523474, 'psi': 0.25024875621890547}-{'f1_val': 0.255881978888465, 'auprc': 0.255881978888465, 'loss_val': 2.667840734431782, 'psi': 0.255881978888465}
[S4] START round=19 head_norm_before_train=1.662788 cos_to_last_merge=0.9977 (last merge round=17)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4773000298677348, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4684137475637749, 'psi': 0.0}
[S5] START round=19 head_norm_before_train=1.799620 (no previous merge yet)
[S5] round=19 local utility u=0.032509 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.652396230772562, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7174143610543187, 'psi': 0.3335071121394324}
[S6] START round=19 head_norm_before_train=1.704025 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.012143858010275572, 'auprc': 0.012143858010275572, 'loss_val': 5.522524098595858, 'psi': 0.012143858010275572}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 5.072084648596076, 'psi': 0.018441678192715538}
[S7] START round=19 head_norm_before_train=1.671355 (no previous merge yet)
[S7] round=19 local utility u=0.007653 metrics={'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.5447303105835571, 'psi': 0.24968913205670232}-{'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.5600366971085329, 'psi': 0.24968913205670232}
[S8] START round=19 head_norm_before_train=1.736286 (no previous merge yet)
[S8] round=19 local utility u=0.003334 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.802779517894199, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.809448418970076, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.836428 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7519486616536137, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7132019761567143, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.588538 (no previous merge yet)
[S10] round=19 local utility u=0.122377 metrics={'f1_val': 0.21032954860149544, 'auprc': 0.21032954860149544, 'loss_val': 3.0807829590096265, 'psi': 0.21032954860149544}-{'f1_val': 0.19450934579439252, 'auprc': 0.19450934579439252, 'loss_val': 3.1831542562658717, 'psi': 0.19450934579439252}
[S11] START round=19 head_norm_before_train=1.695581 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.0943913554041624, 'psi': 0.33162711338607104}-{'f1_val': 0.3317050476855083, 'auprc': 0.3317050476855083, 'loss_val': 2.8887923979604757, 'psi': 0.3317050476855083}
[S13] START round=19 head_norm_before_train=1.552378 (no previous merge yet)
[S13] round=19 local utility u=0.006535 metrics={'f1_val': 0.9642548565620058, 'auprc': 0.9642548565620058, 'loss_val': 0.7286752992272189, 'psi': 0.9642548565620057}-{'f1_val': 0.9654021056328973, 'auprc': 0.9654021056328973, 'loss_val': 0.7520696136208457, 'psi': 0.9654021056328973}
[S14] START round=19 head_norm_before_train=1.128065 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.040091 metrics={'f1_val': 0.10236011667992574, 'auprc': 0.10236011667992574, 'loss_val': 2.0808594660893434, 'psi': 0.10236011667992574}-{'f1_val': 0.09277238403451997, 'auprc': 0.09277238403451997, 'loss_val': 2.0747511840094965, 'psi': 0.09277238403451997}
[S15] START round=19 head_norm_before_train=1.629191 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.613952434929713, 'auprc': 0.613952434929713, 'loss_val': 0.7074212824007431, 'psi': 0.613952434929713}-{'f1_val': 0.6175265408452612, 'auprc': 0.6175265408452612, 'loss_val': 0.544593503990158, 'psi': 0.6175265408452612}
[S16] START round=19 head_norm_before_train=1.767531 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.13336290382198565, 'auprc': 0.13336290382198565, 'loss_val': 2.507630667613602, 'psi': 0.13336290382198565}-{'f1_val': 0.14897739504843918, 'auprc': 0.14897739504843918, 'loss_val': 2.3825304995497487, 'psi': 0.14897739504843918}
[S17] START round=19 head_norm_before_train=1.300090 cos_to_last_merge=0.9957 (last merge round=17)
[S17] round=19 local utility u=0.078022 metrics={'f1_val': 0.16377721914167745, 'auprc': 0.16377721914167745, 'loss_val': 1.039913479595336, 'psi': 0.16377721914167745}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.0928170265155712, 'psi': 0.15231723870467326}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:41916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:41904
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.102)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:41903
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S13
[S2] cosine check vs S13: cos=0.9891
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.9896
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.6609
[S4] RECEIVED delta(kind=head bytes=1804) from S7
[S4] cosine check vs S7: cos=0.9795
[S17] RECEIVED delta(kind=head bytes=1801) from S3
[S17] cosine check vs S3: cos=-0.0896
[S17] DROPPED delta from S3 (cos=-0.0896 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] cosine check vs S2: cos=0.8938
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] cosine check vs S10: cos=0.1013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=0.9542
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0448 f1=0.369 auprc=0.369 bytes=1805
[S6] r=20 psi=0.012 u=0.0000 p_local=0.0532 f1=0.012 auprc=0.012 bytes=0
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.0000 head_norm=1.694209
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.709660e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.0000 head_norm=1.681259 delta_norm=0.170966
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.000 u=0.0000 p_local=0.0162 f1=0.000 auprc=0.000 bytes=0
[S11] r=20 psi=0.332 u=0.0000 p_local=0.0988 f1=0.332 auprc=0.332 bytes=3598
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.1024 head_norm=1.158385
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.129527e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.1353 head_norm=1.241359 delta_norm=0.212953
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.102 u=0.0401 p_local=0.1870 f1=0.102 auprc=0.102 bytes=0
[S15] r=20 psi=0.614 u=0.0000 p_local=0.2048 f1=0.614 auprc=0.614 bytes=12612
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.1334 head_norm=1.790938
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.322807e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.1348 head_norm=1.806802 delta_norm=0.132281
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.133 u=0.0000 p_local=0.1895 f1=0.133 auprc=0.133 bytes=0
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.3675 head_norm=1.576960
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.161635e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.3675 head_norm=1.565873 delta_norm=0.116163
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.367 u=0.7792 p_local=0.3902 f1=0.367 auprc=0.367 bytes=7196
[S13] r=20 psi=0.964 u=0.0065 p_local=0.2804 f1=0.964 auprc=0.964 bytes=12596
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.3594 head_norm=1.767341
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.132525e+00
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.3594 head_norm=1.253140 delta_norm=1.132525
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.359 u=0.0033 p_local=0.1380 f1=0.359 auprc=0.359 bytes=19756
[S10] r=20 psi=0.210 u=0.1224 p_local=0.1664 f1=0.210 auprc=0.210 bytes=1800
[S7] r=20 psi=0.250 u=0.0077 p_local=0.1118 f1=0.250 auprc=0.250 bytes=14399
[S5] r=20 psi=0.334 u=0.0325 p_local=0.0508 f1=0.334 auprc=0.334 bytes=12615
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.2502 head_norm=1.325472
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.677908e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.2608 head_norm=1.412176 delta_norm=0.667791
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.250 u=0.3953 p_local=0.1126 f1=0.250 auprc=0.250 bytes=3606
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.1638 head_norm=1.353066
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.547895e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.1922 head_norm=1.425805 delta_norm=0.354789
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.164 u=0.0780 p_local=0.1008 f1=0.164 auprc=0.164 bytes=16183
[S2] START round=20 head_norm_before_train=1.565873 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.004323 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6727543103962543, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6814001710957518, 'psi': 0.3674775928297055}
[S3] START round=20 head_norm_before_train=1.412176 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.170815 metrics={'f1_val': 0.2660319978844374, 'auprc': 0.2660319978844374, 'loss_val': 1.6269124600395732, 'psi': 0.2660319978844374}-{'f1_val': 0.25024875621890547, 'auprc': 0.25024875621890547, 'loss_val': 1.8264939024523474, 'psi': 0.25024875621890547}
[S4] START round=20 head_norm_before_train=1.681259 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4850610668311657, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4773000298677348, 'psi': 0.0}
[S5] START round=20 head_norm_before_train=1.832103 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.750558123351748, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.652396230772562, 'psi': 0.3335071121394324}
[S6] START round=20 head_norm_before_train=1.719149 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 5.651713031191954, 'psi': 0.017105871474803514}-{'f1_val': 0.012143858010275572, 'auprc': 0.012143858010275572, 'loss_val': 5.522524098595858, 'psi': 0.012143858010275572}
[S7] START round=20 head_norm_before_train=1.685638 (no previous merge yet)
[S7] round=20 local utility u=0.381290 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.5327118017459291, 'psi': 0.33308476261496395}-{'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.5447303105835571, 'psi': 0.24968913205670232}
[S8] START round=20 head_norm_before_train=1.253140 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9637576408315472, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.802779517894199, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.847839 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7838153086442228, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7519486616536137, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.607000 (no previous merge yet)
[S10] round=20 local utility u=0.118142 metrics={'f1_val': 0.2258191349934469, 'auprc': 0.2258191349934469, 'loss_val': 2.9839060709417855, 'psi': 0.2258191349934469}-{'f1_val': 0.21032954860149544, 'auprc': 0.21032954860149544, 'loss_val': 3.0807829590096265, 'psi': 0.21032954860149544}
[S11] START round=20 head_norm_before_train=1.720915 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.2616236852157248, 'psi': 0.3319360347772085}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.0943913554041624, 'psi': 0.33162711338607104}
[S13] START round=20 head_norm_before_train=1.563362 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.6646870960796948, 'auprc': 0.6646870960796948, 'loss_val': 0.5049650471654166, 'psi': 0.6646870960796948}-{'f1_val': 0.9642548565620058, 'auprc': 0.9642548565620058, 'loss_val': 0.7286752992272189, 'psi': 0.9642548565620057}
[S14] START round=20 head_norm_before_train=1.241359 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.145467 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 2.090240531348583, 'psi': 0.13572854291417166}-{'f1_val': 0.10236011667992574, 'auprc': 0.10236011667992574, 'loss_val': 2.0808594660893434, 'psi': 0.10236011667992574}
[S15] START round=20 head_norm_before_train=1.653022 (no previous merge yet)
[S15] round=20 local utility u=0.044450 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.6406909975545048, 'psi': 0.6164158146233559}-{'f1_val': 0.613952434929713, 'auprc': 0.613952434929713, 'loss_val': 0.7074212824007431, 'psi': 0.613952434929713}
[S16] START round=20 head_norm_before_train=1.806802 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.1299107142857143, 'auprc': 0.1299107142857143, 'loss_val': 2.5290137281742737, 'psi': 0.1299107142857143}-{'f1_val': 0.13336290382198565, 'auprc': 0.13336290382198565, 'loss_val': 2.507630667613602, 'psi': 0.13336290382198565}
[S17] START round=20 head_norm_before_train=1.425805 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.125483 metrics={'f1_val': 0.18995615381839898, 'auprc': 0.18995615381839898, 'loss_val': 1.0245575070720412, 'psi': 0.18995615381839898}-{'f1_val': 0.16377721914167745, 'auprc': 0.16377721914167745, 'loss_val': 1.039913479595336, 'psi': 0.16377721914167745}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:41913
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:41904
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S14] not sending this round → trigger blocked (psi=0.136)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S7
[S4] cosine check vs S7: cos=0.9899
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] cosine check vs S2: cos=0.9537
[S17] RECEIVED delta(kind=head bytes=1801) from S3
[S17] cosine check vs S3: cos=-0.0929
[S17] DROPPED delta from S3 (cos=-0.0929 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=0.6918
[S13] RECEIVED delta(kind=head bytes=1804) from S15
[S13] cosine check vs S15: cos=-0.0204
[S13] DROPPED delta from S15 (cos=-0.0204 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=0.9536
[S11] ⇄ pheromone p=0.079 → S16@127.0.0.1:41916
[S13] ⇄ pheromone p=0.224 → S2@127.0.0.1:41902
[S5] ⇄ pheromone p=0.041 → S16@127.0.0.1:41916
[S9] ⇄ pheromone p=0.036 → S16@127.0.0.1:41916
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.1357 head_norm=1.270281
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.298904e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.1358 head_norm=1.352352 delta_norm=0.229890
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.179 → S11@127.0.0.1:41912
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.0000 head_norm=1.708234
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.212919e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.0000 head_norm=1.698618 delta_norm=0.121292
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.013 → S14@127.0.0.1:41914
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.3594 head_norm=1.286603
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.927801e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.3594 head_norm=1.341409 delta_norm=0.592780
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.110 → S3@127.0.0.1:41903
[S6] ⇄ pheromone p=0.043 → S17@127.0.0.1:41917
[S16] ⇄ pheromone p=0.152 → S15@127.0.0.1:41915
[S3] ⇄ pheromone p=0.124 → S17@127.0.0.1:41917
[S2] ⇄ pheromone p=0.313 → S17@127.0.0.1:41917
[S7] ⇄ pheromone p=0.166 → S4@127.0.0.1:41904
[S15] ⇄ pheromone p=0.173 → S13@127.0.0.1:41913
[S10] ⇄ pheromone p=0.157 → S8@127.0.0.1:41909
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.1900 head_norm=1.466218
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.424018e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.1936 head_norm=1.515114 delta_norm=0.242402
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.106 → S14@127.0.0.1:41914
[S2] START round=21 head_norm_before_train=1.599645 cos_to_last_merge=0.9979 (last merge round=19)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.8239425761926131, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6727543103962543, 'psi': 0.3674775928297055}
[S3] START round=21 head_norm_before_train=1.501837 cos_to_last_merge=0.9883 (last merge round=19)
[S3] round=21 local utility u=0.411742 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.6866055437536807, 'psi': 0.3641628959276018}-{'f1_val': 0.2660319978844374, 'auprc': 0.2660319978844374, 'loss_val': 1.6269124600395732, 'psi': 0.2660319978844374}
[S4] START round=21 head_norm_before_train=1.698618 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.010530 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4640017877790412, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4850610668311657, 'psi': 0.0}
[S5] START round=21 head_norm_before_train=1.875352 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.957921504225372, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.750558123351748, 'psi': 0.3335071121394324}
[S6] START round=21 head_norm_before_train=1.732201 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 5.682178184978436, 'psi': 0.019770114942528734}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 5.651713031191954, 'psi': 0.017105871474803514}
[S7] START round=21 head_norm_before_train=1.697636 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.2495022399203584, 'auprc': 0.2495022399203584, 'loss_val': 0.49158303756849836, 'psi': 0.24950223992035836}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.5327118017459291, 'psi': 0.33308476261496395}
[S8] START round=21 head_norm_before_train=1.341409 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0667898614194626, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9637576408315472, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.858342 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8158096576957643, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7838153086442228, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.626710 (no previous merge yet)
[S10] round=21 local utility u=0.112752 metrics={'f1_val': 0.24096087171867261, 'auprc': 0.24096087171867261, 'loss_val': 2.8946783589484864, 'psi': 0.2409608717186726}-{'f1_val': 0.2258191349934469, 'auprc': 0.2258191349934469, 'loss_val': 2.9839060709417855, 'psi': 0.2258191349934469}
[S11] START round=21 head_norm_before_train=1.741886 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.300980195548399, 'psi': 0.3320133550741517}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.2616236852157248, 'psi': 0.3319360347772085}
[S13] START round=21 head_norm_before_train=1.573883 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6639366383821182, 'auprc': 0.6639366383821182, 'loss_val': 0.5367061075875029, 'psi': 0.6639366383821182}-{'f1_val': 0.6646870960796948, 'auprc': 0.6646870960796948, 'loss_val': 0.5049650471654166, 'psi': 0.6646870960796948}
[S14] START round=21 head_norm_before_train=1.352352 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.10879538602700223, 'auprc': 0.10879538602700223, 'loss_val': 2.1626281625648422, 'psi': 0.10879538602700223}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 2.090240531348583, 'psi': 0.13572854291417166}
[S15] START round=21 head_norm_before_train=1.672738 (no previous merge yet)
[S15] round=21 local utility u=0.162381 metrics={'f1_val': 0.6277660114989788, 'auprc': 0.6277660114989788, 'loss_val': 0.41808074064035233, 'psi': 0.6277660114989788}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.6406909975545048, 'psi': 0.6164158146233559}
[S16] START round=21 head_norm_before_train=1.830355 cos_to_last_merge=0.9997 (last merge round=19)
[S16] round=21 local utility u=0.292190 metrics={'f1_val': 0.1616967660646787, 'auprc': 0.1616967660646787, 'loss_val': 2.2307091379065955, 'psi': 0.1616967660646787}-{'f1_val': 0.1299107142857143, 'auprc': 0.1299107142857143, 'loss_val': 2.5290137281742737, 'psi': 0.1299107142857143}
[S17] START round=21 head_norm_before_train=1.515114 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.17632034146002862, 'auprc': 0.17632034146002862, 'loss_val': 1.0376085884279351, 'psi': 0.17632034146002862}-{'f1_val': 0.18995615381839898, 'auprc': 0.18995615381839898, 'loss_val': 1.0245575070720412, 'psi': 0.18995615381839898}
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:41913
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.162)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:41909
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S3
[S17] cosine check vs S3: cos=-0.0836
[S17] DROPPED delta from S3 (cos=-0.0836 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S10
[S8] cosine check vs S10: cos=0.9150
[S13] RECEIVED delta(kind=head bytes=1796) from S15
[S13] cosine check vs S15: cos=-0.0201
[S13] DROPPED delta from S15 (cos=-0.0201 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.3594 head_norm=1.375599
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.387871e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.3594 head_norm=1.479301 delta_norm=0.338787
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.639311 cos_to_last_merge=0.9925 (last merge round=19)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.24130501692828563, 'auprc': 0.24130501692828563, 'loss_val': 1.9633213453316054, 'psi': 0.24130501692828563}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.8239425761926131, 'psi': 0.3674775928297055}
[S3] START round=22 head_norm_before_train=1.592232 cos_to_last_merge=0.9692 (last merge round=19)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.8331272553386886, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.6866055437536807, 'psi': 0.3641628959276018}
[S4] START round=22 head_norm_before_train=1.724299 cos_to_last_merge=0.9991 (last merge round=20)
[S4] round=22 local utility u=0.014498 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4350054200448947, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4640017877790412, 'psi': 0.0}
[S5] START round=22 head_norm_before_train=1.912865 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0968029797437135, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.957921504225372, 'psi': 0.3335071121394324}
[S6] START round=22 head_norm_before_train=1.743861 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.004368225074, 'psi': 0.01732902033271719}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 5.682178184978436, 'psi': 0.019770114942528734}
[S7] START round=22 head_norm_before_train=1.709930 (no previous merge yet)
[S7] round=22 local utility u=0.005155 metrics={'f1_val': 0.2495019920318725, 'auprc': 0.2495019920318725, 'loss_val': 0.48126996941499106, 'psi': 0.2495019920318725}-{'f1_val': 0.2495022399203584, 'auprc': 0.2495022399203584, 'loss_val': 0.49158303756849836, 'psi': 0.24950223992035836}
[S8] START round=22 head_norm_before_train=1.479301 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1089157438092212, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0667898614194626, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.868554 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.845418076430735, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8158096576957643, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.647406 (no previous merge yet)
[S10] round=22 local utility u=0.087936 metrics={'f1_val': 0.24946133588700023, 'auprc': 0.24946133588700023, 'loss_val': 2.7953101085259533, 'psi': 0.24946133588700026}-{'f1_val': 0.24096087171867261, 'auprc': 0.24096087171867261, 'loss_val': 2.8946783589484864, 'psi': 0.2409608717186726}
[S11] START round=22 head_norm_before_train=1.755206 (no previous merge yet)
[S11] round=22 local utility u=0.005017 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.2902509175630605, 'psi': 0.3319360347772085}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.300980195548399, 'psi': 0.3320133550741517}
[S13] START round=22 head_norm_before_train=1.582100 (no previous merge yet)
[S13] round=22 local utility u=1.000000 metrics={'f1_val': 0.9969083656422735, 'auprc': 0.9969083656422735, 'loss_val': 0.46643329749721296, 'psi': 0.9969083656422735}-{'f1_val': 0.6639366383821182, 'auprc': 0.6639366383821182, 'loss_val': 0.5367061075875029, 'psi': 0.6639366383821182}
[S14] START round=22 head_norm_before_train=1.381878 cos_to_last_merge=0.9953 (last merge round=20)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.771173146124526, 'psi': 0.13582554517133957}-{'f1_val': 0.10879538602700223, 'auprc': 0.10879538602700223, 'loss_val': 2.1626281625648422, 'psi': 0.10879538602700223}
[S15] START round=22 head_norm_before_train=1.687670 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.613952434929713, 'auprc': 0.613952434929713, 'loss_val': 0.6764509811867819, 'psi': 0.613952434929713}-{'f1_val': 0.6277660114989788, 'auprc': 0.6277660114989788, 'loss_val': 0.41808074064035233, 'psi': 0.6277660114989788}
[S16] START round=22 head_norm_before_train=1.854438 cos_to_last_merge=0.9990 (last merge round=19)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.13873295910184444, 'auprc': 0.13873295910184444, 'loss_val': 2.03296300626393, 'psi': 0.13873295910184444}-{'f1_val': 0.1616967660646787, 'auprc': 0.1616967660646787, 'loss_val': 2.2307091379065955, 'psi': 0.1616967660646787}
[S17] START round=22 head_norm_before_train=1.550569 cos_to_last_merge=0.9960 (last merge round=20)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.17367001322697814, 'auprc': 0.17367001322697814, 'loss_val': 1.029469248970751, 'psi': 0.17367001322697814}-{'f1_val': 0.17632034146002862, 'auprc': 0.17632034146002862, 'loss_val': 1.0376085884279351, 'psi': 0.17632034146002862}
[S4] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:41916
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:41909
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S11
[S16] cosine check vs S11: cos=0.0056
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9893
[S8] RECEIVED delta(kind=head bytes=1798) from S10
[S8] cosine check vs S10: cos=0.9642
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=0.9719
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.0000 head_norm=1.746792
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.275089e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.0000 head_norm=1.731617 delta_norm=0.127509
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.3594 head_norm=1.513319
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.278928e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.3594 head_norm=1.579724 delta_norm=0.227893
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.2413 head_norm=1.676569
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.983636e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.2432 head_norm=1.621256 delta_norm=0.198364
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.1387 head_norm=1.876089
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.285186e+00
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.1727 head_norm=1.292438 delta_norm=1.285186
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.621256 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.594750 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.9093743602850086, 'psi': 0.3674775928297055}-{'f1_val': 0.24130501692828563, 'auprc': 0.24130501692828563, 'loss_val': 1.9633213453316054, 'psi': 0.24130501692828563}
[S3] START round=23 head_norm_before_train=1.656720 cos_to_last_merge=0.9562 (last merge round=19)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.9632576623056681, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.8331272553386886, 'psi': 0.3641628959276018}
[S4] START round=23 head_norm_before_train=1.731617 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.018427 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.39815065230807, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4350054200448947, 'psi': 0.0}
[S5] START round=23 head_norm_before_train=1.944867 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.131668173165781, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0968029797437135, 'psi': 0.3335071121394324}
[S6] START round=23 head_norm_before_train=1.755642 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.016658954187875982, 'auprc': 0.016658954187875982, 'loss_val': 6.1935068807547875, 'psi': 0.016658954187875982}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.004368225074, 'psi': 0.01732902033271719}
[S7] START round=23 head_norm_before_train=1.725756 (no previous merge yet)
[S7] round=23 local utility u=0.353547 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.5264210299657026, 'psi': 0.33308476261496395}-{'f1_val': 0.2495019920318725, 'auprc': 0.2495019920318725, 'loss_val': 0.48126996941499106, 'psi': 0.2495019920318725}
[S8] START round=23 head_norm_before_train=1.579724 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.115910062557418, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1089157438092212, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.878187 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8744700787747286, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.845418076430735, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.674751 (no previous merge yet)
[S10] round=23 local utility u=0.043728 metrics={'f1_val': 0.2494615936826992, 'auprc': 0.2494615936826992, 'loss_val': 2.707856683018534, 'psi': 0.2494615936826992}-{'f1_val': 0.24946133588700023, 'auprc': 0.24946133588700023, 'loss_val': 2.7953101085259533, 'psi': 0.24946133588700026}
[S11] START round=23 head_norm_before_train=1.767622 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.348566804077639, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.2902509175630605, 'psi': 0.3319360347772085}
[S13] START round=23 head_norm_before_train=1.588947 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.9946568086290328, 'auprc': 0.9946568086290328, 'loss_val': 0.5479520756720039, 'psi': 0.9946568086290328}-{'f1_val': 0.9969083656422735, 'auprc': 0.9969083656422735, 'loss_val': 0.46643329749721296, 'psi': 0.9969083656422735}
[S14] START round=23 head_norm_before_train=1.423697 cos_to_last_merge=0.9841 (last merge round=20)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.306698408063113, 'psi': 0.13592717296421}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.771173146124526, 'psi': 0.13582554517133957}
[S15] START round=23 head_norm_before_train=1.700820 (no previous merge yet)
[S15] round=23 local utility u=0.169376 metrics={'f1_val': 0.6192362876360602, 'auprc': 0.6192362876360602, 'loss_val': 0.38525454198439746, 'psi': 0.6192362876360602}-{'f1_val': 0.613952434929713, 'auprc': 0.613952434929713, 'loss_val': 0.6764509811867819, 'psi': 0.613952434929713}
[S16] START round=23 head_norm_before_train=1.292438 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.11815693430656933, 'auprc': 0.11815693430656933, 'loss_val': 2.074391473519156, 'psi': 0.11815693430656934}-{'f1_val': 0.13873295910184444, 'auprc': 0.13873295910184444, 'loss_val': 2.03296300626393, 'psi': 0.13873295910184444}
[S17] START round=23 head_norm_before_train=1.598181 cos_to_last_merge=0.9857 (last merge round=20)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.15757870302764798, 'auprc': 0.15757870302764798, 'loss_val': 1.0535375410383214, 'psi': 0.15757870302764798}-{'f1_val': 0.17367001322697814, 'auprc': 0.17367001322697814, 'loss_val': 1.029469248970751, 'psi': 0.17367001322697814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:41913
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:41909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:41904
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.9947
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] cosine check vs S2: cos=0.9345
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] cosine check vs S10: cos=0.9781
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] cosine check vs S15: cos=-0.0196
[S13] DROPPED delta from S15 (cos=-0.0196 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.3594 head_norm=1.613425
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.804076e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.3594 head_norm=1.652988 delta_norm=0.180408
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.0000 head_norm=1.754220
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.030526e-02
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.0000 head_norm=1.746971 delta_norm=0.090305
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.1576 head_norm=1.642746
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.982381e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.1640 head_norm=1.620362 delta_norm=0.298238
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.652400 cos_to_last_merge=0.9992 (last merge round=22)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0783444253897234, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.9093743602850086, 'psi': 0.3674775928297055}
[S3] START round=24 head_norm_before_train=1.702214 cos_to_last_merge=0.9479 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.2448582207618352, 'auprc': 0.2448582207618352, 'loss_val': 2.048920549370296, 'psi': 0.2448582207618352}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.9632576623056681, 'psi': 0.3641628959276018}
[S4] START round=24 head_norm_before_train=1.746971 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.016002 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3661475373953627, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.39815065230807, 'psi': 0.0}
[S5] START round=24 head_norm_before_train=1.973756 (no previous merge yet)
[S5] round=24 local utility u=0.002327 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.127013931021019, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.131668173165781, 'psi': 0.3335071121394324}
[S6] START round=24 head_norm_before_train=1.766726 (no previous merge yet)
[S6] round=24 local utility u=0.115138 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 5.999165999365188, 'psi': 0.02065167508031207}-{'f1_val': 0.016658954187875982, 'auprc': 0.016658954187875982, 'loss_val': 6.1935068807547875, 'psi': 0.016658954187875982}
[S7] START round=24 head_norm_before_train=1.744374 (no previous merge yet)
[S7] round=24 local utility u=0.002011 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.5223997701284452, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.5264210299657026, 'psi': 0.33308476261496395}
[S8] START round=24 head_norm_before_train=1.652988 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.007537 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1008368279414114, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.115910062557418, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.887535 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9027869355453166, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8744700787747286, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.710758 (no previous merge yet)
[S10] round=24 local utility u=0.048297 metrics={'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.610726158540982, 'psi': 0.2494019138755981}-{'f1_val': 0.2494615936826992, 'auprc': 0.2494615936826992, 'loss_val': 2.707856683018534, 'psi': 0.2494615936826992}
[S11] START round=24 head_norm_before_train=1.781508 (no previous merge yet)
[S11] round=24 local utility u=0.045506 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.2547750056668594, 'psi': 0.33162711338607104}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.348566804077639, 'psi': 0.3319360347772085}
[S13] START round=24 head_norm_before_train=1.600056 (no previous merge yet)
[S13] round=24 local utility u=0.047025 metrics={'f1_val': 0.9960643421533686, 'auprc': 0.9960643421533686, 'loss_val': 0.4665701432946992, 'psi': 0.9960643421533686}-{'f1_val': 0.9946568086290328, 'auprc': 0.9946568086290328, 'loss_val': 0.5479520756720039, 'psi': 0.9946568086290328}
[S14] START round=24 head_norm_before_train=1.469981 cos_to_last_merge=0.9717 (last merge round=20)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.6982110456877257, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.306698408063113, 'psi': 0.13592717296421}
[S15] START round=24 head_norm_before_train=1.713495 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6174450213799425, 'auprc': 0.6174450213799425, 'loss_val': 0.43579451661776664, 'psi': 0.6174450213799425}-{'f1_val': 0.6192362876360602, 'auprc': 0.6192362876360602, 'loss_val': 0.38525454198439746, 'psi': 0.6192362876360602}
[S16] START round=24 head_norm_before_train=1.326276 cos_to_last_merge=0.9990 (last merge round=22)
[S16] round=24 local utility u=0.174651 metrics={'f1_val': 0.12823347335839044, 'auprc': 0.12823347335839044, 'loss_val': 1.8157782994233242, 'psi': 0.12823347335839044}-{'f1_val': 0.11815693430656933, 'auprc': 0.11815693430656933, 'loss_val': 2.074391473519156, 'psi': 0.11815693430656934}
[S17] START round=24 head_norm_before_train=1.620362 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.125676 metrics={'f1_val': 0.1900818338385078, 'auprc': 0.1900818338385078, 'loss_val': 1.094714290419838, 'psi': 0.1900818338385078}-{'f1_val': 0.15757870302764798, 'auprc': 0.15757870302764798, 'loss_val': 1.0535375410383214, 'psi': 0.15757870302764798}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:41904
[S6] not sending this round → trigger blocked (psi=0.021)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:41903
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.128)
[S4] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:41909
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1807 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=0.6531
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=0.7348
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] cosine check vs S8: cos=0.2675
[S4] RECEIVED delta(kind=head bytes=1807) from S7
[S4] cosine check vs S7: cos=0.9965
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] cosine check vs S10: cos=0.9836
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=0.9809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S17
[S14] cosine check vs S17: cos=0.9089
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.3675 head_norm=1.684471
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.652458e-01
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.3675 head_norm=1.638880 delta_norm=0.165246
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.0000 head_norm=1.771139
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.378820e-02
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.0000 head_norm=1.760417 delta_norm=0.073788
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.1359 head_norm=1.512654
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.450406e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.1358 head_norm=1.547282 delta_norm=0.345041
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.2449 head_norm=1.733824
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.036138e+00
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.2461 head_norm=1.362875 delta_norm=1.036138
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.1282 head_norm=1.373813
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.318580e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.1269 head_norm=1.353395 delta_norm=0.131858
[S16] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.3594 head_norm=1.689933
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.585670e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.3594 head_norm=1.712709 delta_norm=0.158567
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.638880 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.030838 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0166692313122305, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0783444253897234, 'psi': 0.3674775928297055}
[S3] START round=25 head_norm_before_train=1.362875 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.818766 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.4851303754202576, 'psi': 0.3641628959276018}-{'f1_val': 0.2448582207618352, 'auprc': 0.2448582207618352, 'loss_val': 2.048920549370296, 'psi': 0.2448582207618352}
[S4] START round=25 head_norm_before_train=1.760417 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.024220 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3177066977347156, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3661475373953627, 'psi': 0.0}
[S5] START round=25 head_norm_before_train=1.999174 (no previous merge yet)
[S5] round=25 local utility u=0.009260 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1084934587836317, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.127013931021019, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.778808 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 6.400512751186666, 'psi': 0.016882516188714152}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 5.999165999365188, 'psi': 0.02065167508031207}
[S7] START round=25 head_norm_before_train=1.752739 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.4608138366848509, 'psi': 0.24968913205670232}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.5223997701284452, 'psi': 0.33308476261496395}
[S8] START round=25 head_norm_before_train=1.712709 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.007600 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0856371460336072, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1008368279414114, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.896545 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.928728810059747, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9027869355453166, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.749617 (no previous merge yet)
[S10] round=25 local utility u=0.046798 metrics={'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.517131140357605, 'psi': 0.2494019138755981}-{'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.610726158540982, 'psi': 0.2494019138755981}
[S11] START round=25 head_norm_before_train=1.794829 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.362049923944592, 'psi': 0.3319360347772085}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.2547750056668594, 'psi': 0.33162711338607104}
[S13] START round=25 head_norm_before_train=1.609044 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6641242939609954, 'auprc': 0.6641242939609954, 'loss_val': 0.4298157458478124, 'psi': 0.6641242939609954}-{'f1_val': 0.9960643421533686, 'auprc': 0.9960643421533686, 'loss_val': 0.4665701432946992, 'psi': 0.9960643421533686}
[S14] START round=25 head_norm_before_train=1.547282 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.494925 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.707446850151611, 'psi': 0.13582554517133957}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.6982110456877257, 'psi': 0.13592717296421}
[S15] START round=25 head_norm_before_train=1.725253 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5318069873903791, 'psi': 0.6166125814646326}-{'f1_val': 0.6174450213799425, 'auprc': 0.6174450213799425, 'loss_val': 0.43579451661776664, 'psi': 0.6174450213799425}
[S16] START round=25 head_norm_before_train=1.353395 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.077716 metrics={'f1_val': 0.16137844084891784, 'auprc': 0.16137844084891784, 'loss_val': 1.9586503964775115, 'psi': 0.16137844084891784}-{'f1_val': 0.12823347335839044, 'auprc': 0.12823347335839044, 'loss_val': 1.8157782994233242, 'psi': 0.12823347335839044}
[S17] START round=25 head_norm_before_train=1.654736 cos_to_last_merge=0.9986 (last merge round=23)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.17955889244513576, 'auprc': 0.17955889244513576, 'loss_val': 1.0874035284716297, 'psi': 0.17955889244513576}-{'f1_val': 0.1900818338385078, 'auprc': 0.1900818338385078, 'loss_val': 1.094714290419838, 'psi': 0.1900818338385078}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.161)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:41909
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:41903
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[S14] not sending this round → trigger blocked (psi=0.136)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.7519
[S17] RECEIVED delta(kind=head bytes=1801) from S3
[S17] cosine check vs S3: cos=-0.0241
[S17] DROPPED delta from S3 (cos=-0.0241 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] cosine check vs S10: cos=0.9870
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] cosine check vs S8: cos=0.7525
[S17] RECEIVED delta(kind=head bytes=1801) from S2
[S17] cosine check vs S2: cos=0.9601
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.158 → S11@127.0.0.1:41912
[S6] ⇄ pheromone p=0.032 → S17@127.0.0.1:41917
[S7] ⇄ pheromone p=0.100 → S4@127.0.0.1:41904
[S13] ⇄ pheromone p=0.183 → S2@127.0.0.1:41902
[S15] ⇄ pheromone p=0.092 → S13@127.0.0.1:41913
[S9] ⇄ pheromone p=0.012 → S16@127.0.0.1:41916
[S11] ⇄ pheromone p=0.034 → S16@127.0.0.1:41916
[S4] ⇄ pheromone p=0.016 → S14@127.0.0.1:41914
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.3594 head_norm=1.752157
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.428972e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.3594 head_norm=1.760350 delta_norm=0.142897
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.039 → S3@127.0.0.1:41903
[S2] ⇄ pheromone p=0.185 → S17@127.0.0.1:41917
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.3642 head_norm=1.419248
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.791647e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.3642 head_norm=1.485506 delta_norm=0.579165
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.238 → S17@127.0.0.1:41917
[S5] ⇄ pheromone p=0.016 → S16@127.0.0.1:41916
[S10] ⇄ pheromone p=0.092 → S8@127.0.0.1:41909
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.1614 head_norm=1.402885
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.674231e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.1640 head_norm=1.604216 delta_norm=0.667423
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.117 → S15@127.0.0.1:41915
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.1796 head_norm=1.690722
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.376012e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.1954 head_norm=1.662444 delta_norm=0.237601
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.055 → S14@127.0.0.1:41914
[S2] START round=26 head_norm_before_train=1.667875 cos_to_last_merge=0.9990 (last merge round=24)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.20613042583830488, 'auprc': 0.20613042583830488, 'loss_val': 2.2353757380349366, 'psi': 0.20613042583830488}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0166692313122305, 'psi': 0.3674775928297055}
[S3] START round=26 head_norm_before_train=1.485506 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.2795698924731183, 'auprc': 0.2795698924731183, 'loss_val': 1.4408555760163582, 'psi': 0.2795698924731183}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.4851303754202576, 'psi': 0.3641628959276018}
[S4] START round=26 head_norm_before_train=1.782277 cos_to_last_merge=0.9995 (last merge round=24)
[S4] round=26 local utility u=0.023790 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2701275720565823, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3177066977347156, 'psi': 0.0}
[S5] START round=26 head_norm_before_train=2.017384 (no previous merge yet)
[S5] round=26 local utility u=0.001182 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1061287573213368, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1084934587836317, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.790289 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.429536410113236, 'psi': 0.017551963048498844}-{'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 6.400512751186666, 'psi': 0.016882516188714152}
[S7] START round=26 head_norm_before_train=1.761110 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.47126810326968477, 'psi': 0.24968913205670232}-{'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.4608138366848509, 'psi': 0.24968913205670232}
[S8] START round=26 head_norm_before_train=1.760350 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.006835 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0719679786154874, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0856371460336072, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.905124 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9537606292103367, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.928728810059747, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.780013 (no previous merge yet)
[S10] round=26 local utility u=0.028536 metrics={'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.4600590194430647, 'psi': 0.2494019138755981}-{'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.517131140357605, 'psi': 0.2494019138755981}
[S11] START round=26 head_norm_before_train=1.809789 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3733628996152185, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.362049923944592, 'psi': 0.3319360347772085}
[S13] START round=26 head_norm_before_train=1.616984 (no previous merge yet)
[S13] round=26 local utility u=0.011423 metrics={'f1_val': 0.6643119220412554, 'auprc': 0.6643119220412554, 'loss_val': 0.40865792023650466, 'psi': 0.6643119220412554}-{'f1_val': 0.6641242939609954, 'auprc': 0.6641242939609954, 'loss_val': 0.4298157458478124, 'psi': 0.6641242939609954}
[S14] START round=26 head_norm_before_train=1.581585 cos_to_last_merge=0.9988 (last merge round=24)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.223871225048239, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.707446850151611, 'psi': 0.13582554517133957}
[S15] START round=26 head_norm_before_train=1.742001 (no previous merge yet)
[S15] round=26 local utility u=0.068642 metrics={'f1_val': 0.6176649292091688, 'auprc': 0.6176649292091688, 'loss_val': 0.40399323634320666, 'psi': 0.6176649292091688}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5318069873903791, 'psi': 0.6166125814646326}
[S16] START round=26 head_norm_before_train=1.604216 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.08807457409193185, 'auprc': 0.08807457409193185, 'loss_val': 3.205801205625858, 'psi': 0.08807457409193185}-{'f1_val': 0.16137844084891784, 'auprc': 0.16137844084891784, 'loss_val': 1.9586503964775115, 'psi': 0.16137844084891784}
[S17] START round=26 head_norm_before_train=1.662444 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.1649478528982943, 'auprc': 0.1649478528982943, 'loss_val': 1.1504910364143404, 'psi': 0.1649478528982943}-{'f1_val': 0.17955889244513576, 'auprc': 0.17955889244513576, 'loss_val': 1.0874035284716297, 'psi': 0.17955889244513576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[S4] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:41909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:41913
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.9555
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.9102
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] cosine check vs S10: cos=0.9898
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=-0.0205
[S13] DROPPED delta from S15 (cos=-0.0205 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=0.9838
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.2796 head_norm=1.558074
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.745947e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.2822 head_norm=1.640537 delta_norm=0.374595
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=26 metric=0.2061 head_norm=1.696895
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.541306e-01
[S2] stored merged vector for next round verification (round=26)
[S2] DEBUG after merge:  round=26 metric=0.2027 head_norm=1.652845 delta_norm=0.154131
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.0881 head_norm=1.649569
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.328828e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.0906 head_norm=1.819616 delta_norm=0.332883
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.3594 head_norm=1.798826
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.289226e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.3594 head_norm=1.798420 delta_norm=0.128923
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.652845 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=27 local utility u=0.835287 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0169263506202237, 'psi': 0.3674775928297055}-{'f1_val': 0.20613042583830488, 'auprc': 0.20613042583830488, 'loss_val': 2.2353757380349366, 'psi': 0.20613042583830488}
[S3] START round=27 head_norm_before_train=1.640537 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.009866 metrics={'f1_val': 0.27793934358122147, 'auprc': 0.27793934358122147, 'loss_val': 1.4064485565418785, 'psi': 0.27793934358122147}-{'f1_val': 0.2795698924731183, 'auprc': 0.2795698924731183, 'loss_val': 1.4408555760163582, 'psi': 0.2795698924731183}
[S4] START round=27 head_norm_before_train=1.804380 cos_to_last_merge=0.9983 (last merge round=24)
[S4] round=27 local utility u=1.000000 metrics={'f1_val': 0.3295726495726496, 'auprc': 0.3295726495726496, 'loss_val': 1.227912728222195, 'psi': 0.3295726495726496}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2701275720565823, 'psi': 0.0}
[S5] START round=27 head_norm_before_train=2.030406 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1097670905440205, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1061287573213368, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.801164 (no previous merge yet)
[S6] round=27 local utility u=0.001139 metrics={'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 6.441252238009218, 'psi': 0.01910681399631676}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.429536410113236, 'psi': 0.017551963048498844}
[S7] START round=27 head_norm_before_train=1.771979 (no previous merge yet)
[S7] round=27 local utility u=0.009096 metrics={'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.45363568268341875, 'psi': 0.24975124378109453}-{'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.47126810326968477, 'psi': 0.24968913205670232}
[S8] START round=27 head_norm_before_train=1.798420 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.003078 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0658116678807108, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0719679786154874, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.913373 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.974833219831258, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9537606292103367, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.807234 (no previous merge yet)
[S10] round=27 local utility u=0.039306 metrics={'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.3814474413774582, 'psi': 0.2494019138755981}-{'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.4600590194430647, 'psi': 0.2494019138755981}
[S11] START round=27 head_norm_before_train=1.823157 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.435363828055201, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.3733628996152185, 'psi': 0.3319360347772085}
[S13] START round=27 head_norm_before_train=1.622299 (no previous merge yet)
[S13] round=27 local utility u=0.003632 metrics={'f1_val': 0.6643119220412554, 'auprc': 0.6643119220412554, 'loss_val': 0.401393038316833, 'psi': 0.6643119220412554}-{'f1_val': 0.6643119220412554, 'auprc': 0.6643119220412554, 'loss_val': 0.40865792023650466, 'psi': 0.6643119220412554}
[S14] START round=27 head_norm_before_train=1.618223 cos_to_last_merge=0.9956 (last merge round=24)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.6094584086958665, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.223871225048239, 'psi': 0.13587634006482174}
[S15] START round=27 head_norm_before_train=1.764915 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.5794987472969532, 'psi': 0.6165550083006743}-{'f1_val': 0.6176649292091688, 'auprc': 0.6176649292091688, 'loss_val': 0.40399323634320666, 'psi': 0.6176649292091688}
[S16] START round=27 head_norm_before_train=1.819616 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.125229 metrics={'f1_val': 0.11506388187590849, 'auprc': 0.11506388187590849, 'loss_val': 3.1982466504479015, 'psi': 0.11506388187590849}-{'f1_val': 0.08807457409193185, 'auprc': 0.08807457409193185, 'loss_val': 3.205801205625858, 'psi': 0.08807457409193185}
[S17] START round=27 head_norm_before_train=1.691027 cos_to_last_merge=0.9990 (last merge round=25)
[S17] round=27 local utility u=0.164482 metrics={'f1_val': 0.19441572797991952, 'auprc': 0.19441572797991952, 'loss_val': 1.0867369287521849, 'psi': 0.19441572797991952}-{'f1_val': 0.1649478528982943, 'auprc': 0.1649478528982943, 'loss_val': 1.1504910364143404, 'psi': 0.1649478528982943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:41902
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S6] not sending this round → trigger blocked (psi=0.019)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:41909
[S16] not sending this round → trigger blocked (psi=0.115)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:41917
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S13
[S2] cosine check vs S13: cos=0.9910
[S3] RECEIVED delta(kind=head bytes=1805) from S8
[S3] cosine check vs S8: cos=0.9483
[S4] RECEIVED delta(kind=head bytes=1803) from S7
[S4] cosine check vs S7: cos=0.9929
[S17] RECEIVED delta(kind=head bytes=1806) from S3
[S17] cosine check vs S3: cos=0.0204
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] cosine check vs S2: cos=0.9745
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] cosine check vs S10: cos=0.9921
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=-0.0219
[S14] DROPPED delta from S4 (cos=-0.0219 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=0.9442
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.2779 head_norm=1.715908
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.911741e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.2784 head_norm=1.751448 delta_norm=0.291174
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.3296 head_norm=1.822920
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.095472e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.2126 head_norm=1.799454 delta_norm=0.109547
[S4] aggregate: ROLLBACK (f1_val pre=0.330 post=0.213 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.3594 head_norm=1.833130
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.147757e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.3594 head_norm=1.827303 delta_norm=0.114776
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.3675 head_norm=1.679217
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.139317e-01
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.3675 head_norm=1.650920 delta_norm=0.113932
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.1358 head_norm=1.652313
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.831872e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.1358 head_norm=1.660968 delta_norm=0.283187
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.1944 head_norm=1.716939
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.263478e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.1979 head_norm=1.351726 delta_norm=0.626348
[S17] aggregate: ACCEPT kept=['S3', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.650920 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.095853834338152, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0169263506202237, 'psi': 0.3674775928297055}
[S3] START round=28 head_norm_before_train=1.751448 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.28351177730192717, 'auprc': 0.28351177730192717, 'loss_val': 1.5202731509950724, 'psi': 0.28351177730192717}-{'f1_val': 0.27793934358122147, 'auprc': 0.27793934358122147, 'loss_val': 1.4064485565418785, 'psi': 0.27793934358122147}
[S4] START round=28 head_norm_before_train=1.799454 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.034524 metrics={'f1_val': 0.33299492385786805, 'auprc': 0.33299492385786805, 'loss_val': 1.1896642265590813, 'psi': 0.33299492385786805}-{'f1_val': 0.3295726495726496, 'auprc': 0.3295726495726496, 'loss_val': 1.227912728222195, 'psi': 0.3295726495726496}
[S5] START round=28 head_norm_before_train=2.048984 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.136737422392413, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1097670905440205, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.811881 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.014862981885740827, 'auprc': 0.014862981885740827, 'loss_val': 6.691787806905161, 'psi': 0.014862981885740829}-{'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 6.441252238009218, 'psi': 0.01910681399631676}
[S7] START round=28 head_norm_before_train=1.782423 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.24919013207077, 'auprc': 0.24919013207077, 'loss_val': 0.46999344754649186, 'psi': 0.24919013207077}-{'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.45363568268341875, 'psi': 0.24975124378109453}
[S8] START round=28 head_norm_before_train=1.827303 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.001650 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0625125783557035, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0658116678807108, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.921006 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9969618802329783, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.974833219831258, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.828676 (no previous merge yet)
[S10] round=28 local utility u=0.001578 metrics={'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.378291884313909, 'psi': 0.2494019138755981}-{'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.3814474413774582, 'psi': 0.2494019138755981}
[S11] START round=28 head_norm_before_train=1.838933 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.4610607243602236, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.435363828055201, 'psi': 0.3319360347772085}
[S13] START round=28 head_norm_before_train=1.630112 (no previous merge yet)
[S13] round=28 local utility u=1.000000 metrics={'f1_val': 0.9966270655376925, 'auprc': 0.9966270655376925, 'loss_val': 0.38712935624704425, 'psi': 0.9966270655376925}-{'f1_val': 0.6643119220412554, 'auprc': 0.6643119220412554, 'loss_val': 0.401393038316833, 'psi': 0.6643119220412554}
[S14] START round=28 head_norm_before_train=1.660968 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.410402 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.7886538002014563, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.6094584086958665, 'psi': 0.13582554517133957}
[S15] START round=28 head_norm_before_train=1.791273 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5894660725493753, 'psi': 0.6163342951580373}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.5794987472969532, 'psi': 0.6165550083006743}
[S16] START round=28 head_norm_before_train=1.852039 cos_to_last_merge=0.9997 (last merge round=26)
[S16] round=28 local utility u=0.811111 metrics={'f1_val': 0.15388312187620146, 'auprc': 0.15388312187620146, 'loss_val': 1.9253968684259748, 'psi': 0.15388312187620146}-{'f1_val': 0.11506388187590849, 'auprc': 0.11506388187590849, 'loss_val': 3.1982466504479015, 'psi': 0.11506388187590849}
[S17] START round=28 head_norm_before_train=1.351726 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.034261 metrics={'f1_val': 0.2124341926712839, 'auprc': 0.2124341926712839, 'loss_val': 1.1803806175032292, 'psi': 0.21243419267128388}-{'f1_val': 0.19441572797991952, 'auprc': 0.19441572797991952, 'loss_val': 1.0867369287521849, 'psi': 0.19441572797991952}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:41911
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:41908
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:41915
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.154)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S13
[S15] cosine check vs S13: cos=-0.0216
[S15] DROPPED delta from S13 (cos=-0.0216 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S8
[S10] cosine check vs S8: cos=0.9940
[S7] RECEIVED delta(kind=head bytes=1800) from S4
[S7] cosine check vs S4: cos=0.9965
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:41903
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.3332
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.2835 head_norm=1.827096
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.428800e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.2607 head_norm=1.314043 delta_norm=0.942880
[S3] aggregate: ROLLBACK (f1_val pre=0.284 post=0.261 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.2492 head_norm=1.787317
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.697575e-02
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.2492 head_norm=1.801971 delta_norm=0.076976
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.2494 head_norm=1.851956
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.017914e-01
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.2494 head_norm=1.853627 delta_norm=0.101791
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.677648 cos_to_last_merge=0.9989 (last merge round=27)
[S2] round=29 local utility u=0.000032 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0957900134625884, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.095853834338152, 'psi': 0.3674775928297055}
[S3] START round=29 head_norm_before_train=1.314043 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.057828 metrics={'f1_val': 0.258595205963627, 'auprc': 0.258595205963627, 'loss_val': 1.180368089329982, 'psi': 0.258595205963627}-{'f1_val': 0.28351177730192717, 'auprc': 0.28351177730192717, 'loss_val': 1.5202731509950724, 'psi': 0.28351177730192717}
[S4] START round=29 head_norm_before_train=1.819766 cos_to_last_merge=0.9998 (last merge round=27)
[S4] round=29 local utility u=0.016461 metrics={'f1_val': 0.3322371194873092, 'auprc': 0.3322371194873092, 'loss_val': 1.1499225694727462, 'psi': 0.3322371194873092}-{'f1_val': 0.33299492385786805, 'auprc': 0.33299492385786805, 'loss_val': 1.1896642265590813, 'psi': 0.33299492385786805}
[S5] START round=29 head_norm_before_train=2.058050 (no previous merge yet)
[S5] round=29 local utility u=0.045516 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0457044978957537, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.136737422392413, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.822096 (no previous merge yet)
[S6] round=29 local utility u=0.295767 metrics={'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 6.197413902443404, 'psi': 0.025658492279745686}-{'f1_val': 0.014862981885740827, 'auprc': 0.014862981885740827, 'loss_val': 6.691787806905161, 'psi': 0.014862981885740829}
[S7] START round=29 head_norm_before_train=1.801971 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.24956456830057228, 'auprc': 0.24956456830057228, 'loss_val': 0.49918592715233256, 'psi': 0.24956456830057228}-{'f1_val': 0.24919013207077, 'auprc': 0.24919013207077, 'loss_val': 0.46999344754649186, 'psi': 0.24919013207077}
[S8] START round=29 head_norm_before_train=1.860874 cos_to_last_merge=0.9990 (last merge round=27)
[S8] round=29 local utility u=0.015651 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.031211457639756, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0625125783557035, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.928671 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.01921871109491, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9969618802329783, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.853627 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.4122776962180894, 'psi': 0.2494019138755981}-{'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.378291884313909, 'psi': 0.2494019138755981}
[S11] START round=29 head_norm_before_train=1.855554 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.5152435052256066, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.4610607243602236, 'psi': 0.3319360347772085}
[S13] START round=29 head_norm_before_train=1.636508 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.9960643421533686, 'auprc': 0.9960643421533686, 'loss_val': 0.4088229626885336, 'psi': 0.9960643421533686}-{'f1_val': 0.9966270655376925, 'auprc': 0.9966270655376925, 'loss_val': 0.38712935624704425, 'psi': 0.9966270655376925}
[S14] START round=29 head_norm_before_train=1.688882 cos_to_last_merge=0.9991 (last merge round=27)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.3128339580796817, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.7886538002014563, 'psi': 0.13582554517133957}
[S15] START round=29 head_norm_before_train=1.818617 (no previous merge yet)
[S15] round=29 local utility u=0.123612 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.3534834805511326, 'psi': 0.6175834097438502}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5894660725493753, 'psi': 0.6163342951580373}
[S16] START round=29 head_norm_before_train=1.876244 cos_to_last_merge=0.9991 (last merge round=26)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.14253079062375845, 'auprc': 0.14253079062375845, 'loss_val': 2.2918866399244946, 'psi': 0.14253079062375845}-{'f1_val': 0.15388312187620146, 'auprc': 0.15388312187620146, 'loss_val': 1.9253968684259748, 'psi': 0.15388312187620146}
[S17] START round=29 head_norm_before_train=1.375929 cos_to_last_merge=0.9987 (last merge round=27)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.18729390495511347, 'auprc': 0.18729390495511347, 'loss_val': 1.1466157983202094, 'psi': 0.18729390495511347}-{'f1_val': 0.2124341926712839, 'auprc': 0.2124341926712839, 'loss_val': 1.1803806175032292, 'psi': 0.21243419267128388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:41913
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:41909
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:41911
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:41908
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.026)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S4
[S7] cosine check vs S4: cos=0.9977
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] cosine check vs S15: cos=-0.0122
[S16] DROPPED delta from S15 (cos=-0.0122 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] cosine check vs S3: cos=0.8250
[S10] RECEIVED delta(kind=head bytes=1804) from S8
[S10] cosine check vs S8: cos=0.9955
[S13] RECEIVED delta(kind=head bytes=1799) from S2
[S13] cosine check vs S2: cos=0.9873
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.9961 head_norm=1.644899
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.366963e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.9961 head_norm=1.669472 delta_norm=0.136696
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=29 metric=0.2494 head_norm=1.871776
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.967470e-02
[S10] stored merged vector for next round verification (round=29)
[S10] DEBUG after merge:  round=29 metric=0.2494 head_norm=1.881017 delta_norm=0.089675
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.2496 head_norm=1.808956
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.388936e-02
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.2496 head_norm=1.824932 delta_norm=0.063889
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.3594 head_norm=1.894463
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.411085e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.3594 head_norm=1.577592 delta_norm=0.541109
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.704686 cos_to_last_merge=0.9961 (last merge round=27)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.24459904796777734, 'auprc': 0.24459904796777734, 'loss_val': 2.1259854240999516, 'psi': 0.24459904796777732}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0957900134625884, 'psi': 0.3674775928297055}
[S3] START round=30 head_norm_before_train=1.405062 cos_to_last_merge=0.9893 (last merge round=28)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.2751866310526676, 'auprc': 0.2751866310526676, 'loss_val': 1.3617978098431416, 'psi': 0.2751866310526676}-{'f1_val': 0.258595205963627, 'auprc': 0.258595205963627, 'loss_val': 1.180368089329982, 'psi': 0.258595205963627}
[S4] START round=30 head_norm_before_train=1.842985 cos_to_last_merge=0.9990 (last merge round=27)
[S4] round=30 local utility u=0.124494 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.121946579492185, 'psi': 0.3567939207526687}-{'f1_val': 0.3322371194873092, 'auprc': 0.3322371194873092, 'loss_val': 1.1499225694727462, 'psi': 0.3322371194873092}
[S5] START round=30 head_norm_before_train=2.066901 (no previous merge yet)
[S5] round=30 local utility u=0.099358 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8469893370590613, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0457044978957537, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.830686 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 6.57949253756097, 'psi': 0.01799723119520074}-{'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 6.197413902443404, 'psi': 0.025658492279745686}
[S7] START round=30 head_norm_before_train=1.824932 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.017891 metrics={'f1_val': 0.24893988525816912, 'auprc': 0.24893988525816912, 'loss_val': 0.45778233036994315, 'psi': 0.24893988525816912}-{'f1_val': 0.24956456830057228, 'auprc': 0.24956456830057228, 'loss_val': 0.49918592715233256, 'psi': 0.24956456830057228}
[S8] START round=30 head_norm_before_train=1.577592 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.012796 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0056198634793454, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.031211457639756, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.936191 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0400334903259587, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.01921871109491, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.881017 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.41427816735332, 'psi': 0.2494019138755981}-{'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.4122776962180894, 'psi': 0.2494019138755981}
[S11] START round=30 head_norm_before_train=1.872244 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.5386903954748123, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.5152435052256066, 'psi': 0.3319360347772085}
[S13] START round=30 head_norm_before_train=1.669472 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.032673 metrics={'f1_val': 0.9966270655376925, 'auprc': 0.9966270655376925, 'loss_val': 0.34854092263530484, 'psi': 0.9966270655376925}-{'f1_val': 0.9960643421533686, 'auprc': 0.9960643421533686, 'loss_val': 0.4088229626885336, 'psi': 0.9960643421533686}
[S14] START round=30 head_norm_before_train=1.718855 cos_to_last_merge=0.9966 (last merge round=27)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.7232748974463794, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.3128339580796817, 'psi': 0.13582554517133957}
[S15] START round=30 head_norm_before_train=1.846187 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5577576632535294, 'psi': 0.6164734888353558}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.3534834805511326, 'psi': 0.6175834097438502}
[S16] START round=30 head_norm_before_train=1.894257 cos_to_last_merge=0.9985 (last merge round=26)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.1231163351416516, 'auprc': 0.1231163351416516, 'loss_val': 3.4922389106195637, 'psi': 0.1231163351416516}-{'f1_val': 0.14253079062375845, 'auprc': 0.14253079062375845, 'loss_val': 2.2918866399244946, 'psi': 0.14253079062375845}
[S17] START round=30 head_norm_before_train=1.411872 cos_to_last_merge=0.9940 (last merge round=27)
[S17] round=30 local utility u=0.086336 metrics={'f1_val': 0.19961312532370057, 'auprc': 0.19961312532370057, 'loss_val': 1.084816387703217, 'psi': 0.19961312532370057}-{'f1_val': 0.18729390495511347, 'auprc': 0.18729390495511347, 'loss_val': 1.1466157983202094, 'psi': 0.18729390495511347}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:41908
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:41911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:41915
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S4
[S7] cosine check vs S4: cos=0.9987
[S15] RECEIVED delta(kind=head bytes=1797) from S13
[S15] cosine check vs S13: cos=-0.0254
[S15] DROPPED delta from S13 (cos=-0.0254 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S8
[S10] cosine check vs S8: cos=0.9618
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.6647
[S14] ⇄ pheromone p=0.104 → S17@127.0.0.1:41917
[S2] ⇄ pheromone p=0.146 → S13@127.0.0.1:41913
[S15] ⇄ pheromone p=0.055 → S16@127.0.0.1:41916
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.2752 head_norm=1.490195
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.028217e-01
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.2586 head_norm=1.342693 delta_norm=0.602822
[S3] aggregate: ROLLBACK (f1_val pre=0.275 post=0.259 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.088 → S8@127.0.0.1:41909
[S11] ⇄ pheromone p=0.011 → S14@127.0.0.1:41914
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.2494 head_norm=1.898908
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.807937e-01
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.2494 head_norm=1.739689 delta_norm=0.280794
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.2489 head_norm=1.835151
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.887730e-02
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.2489 head_norm=1.847726 delta_norm=0.048877
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.155 → S11@127.0.0.1:41912
[S13] ⇄ pheromone p=0.196 → S15@127.0.0.1:41915
[S4] ⇄ pheromone p=0.142 → S7@127.0.0.1:41908
[S8] ⇄ pheromone p=0.019 → S10@127.0.0.1:41911
[S17] ⇄ pheromone p=0.056 → S3@127.0.0.1:41903
[S2] START round=31 head_norm_before_train=1.729991 cos_to_last_merge=0.9928 (last merge round=27)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.2428921568627451, 'auprc': 0.2428921568627451, 'loss_val': 2.1811337466026646, 'psi': 0.2428921568627451}-{'f1_val': 0.24459904796777734, 'auprc': 0.24459904796777734, 'loss_val': 2.1259854240999516, 'psi': 0.24459904796777732}
[S3] START round=31 head_norm_before_train=1.342693 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.106666 metrics={'f1_val': 0.27912824811399833, 'auprc': 0.27912824811399833, 'loss_val': 1.1839394983552094, 'psi': 0.27912824811399833}-{'f1_val': 0.2751866310526676, 'auprc': 0.2751866310526676, 'loss_val': 1.3617978098431416, 'psi': 0.2751866310526676}
[S4] START round=31 head_norm_before_train=1.861501 cos_to_last_merge=0.9982 (last merge round=27)
[S4] round=31 local utility u=0.017727 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0864922293444867, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.121946579492185, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=2.067706 (no previous merge yet)
[S5] round=31 local utility u=0.018311 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.81036760581152, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8469893370590613, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=1.839332 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 6.6414491758277014, 'psi': 0.018441678192715538}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 6.57949253756097, 'psi': 0.01799723119520074}
[S7] START round=31 head_norm_before_train=1.847726 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.24975136747886623, 'auprc': 0.24975136747886623, 'loss_val': 0.4707305034012463, 'psi': 0.24975136747886623}-{'f1_val': 0.24893988525816912, 'auprc': 0.24893988525816912, 'loss_val': 0.45778233036994315, 'psi': 0.24893988525816912}
[S8] START round=31 head_norm_before_train=1.613963 cos_to_last_merge=0.9992 (last merge round=29)
[S8] round=31 local utility u=0.006647 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9923265344193783, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0056198634793454, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.943423 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0605764073991613, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0400334903259587, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.739689 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.089310 metrics={'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.2356584672959174, 'psi': 0.2494019138755981}-{'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.41427816735332, 'psi': 0.2494019138755981}
[S11] START round=31 head_norm_before_train=1.888417 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.6045569491709664, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.5386903954748123, 'psi': 0.3319360347772085}
[S13] START round=31 head_norm_before_train=1.680251 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.9960643421533686, 'auprc': 0.9960643421533686, 'loss_val': 0.3789004094626749, 'psi': 0.9960643421533686}-{'f1_val': 0.9966270655376925, 'auprc': 0.9966270655376925, 'loss_val': 0.34854092263530484, 'psi': 0.9966270655376925}
[S14] START round=31 head_norm_before_train=1.746625 cos_to_last_merge=0.9934 (last merge round=27)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.015327758073505, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.7232748974463794, 'psi': 0.13582554517133957}
[S15] START round=31 head_norm_before_train=1.869954 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5855401256635991, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5577576632535294, 'psi': 0.6164734888353558}
[S16] START round=31 head_norm_before_train=1.908599 cos_to_last_merge=0.9979 (last merge round=26)
[S16] round=31 local utility u=0.003225 metrics={'f1_val': 0.12919088064371928, 'auprc': 0.12919088064371928, 'loss_val': 3.5404597374215694, 'psi': 0.12919088064371928}-{'f1_val': 0.1231163351416516, 'auprc': 0.1231163351416516, 'loss_val': 3.4922389106195637, 'psi': 0.1231163351416516}
[S17] START round=31 head_norm_before_train=1.453187 cos_to_last_merge=0.9868 (last merge round=27)
[S17] round=31 local utility u=0.274763 metrics={'f1_val': 0.26326721623266236, 'auprc': 0.26326721623266236, 'loss_val': 1.1081781914024802, 'psi': 0.26326721623266236}-{'f1_val': 0.19961312532370057, 'auprc': 0.19961312532370057, 'loss_val': 1.084816387703217, 'psi': 0.19961312532370057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:41908
[S16] not sending this round → trigger blocked (psi=0.129)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:41911
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:41917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] cosine check vs S4: cos=0.9990
[S17] RECEIVED delta(kind=head bytes=1804) from S3
[S17] cosine check vs S3: cos=0.8682
[S8] RECEIVED delta(kind=head bytes=1806) from S10
[S8] cosine check vs S10: cos=0.9861
[S10] RECEIVED delta(kind=head bytes=1801) from S8
[S10] cosine check vs S8: cos=0.9861
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.8682
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.2498 head_norm=1.864281
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.168042e-02
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.2498 head_norm=1.870876 delta_norm=0.041680
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S17
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S16
[S13]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.2791 head_norm=1.417275
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.746223e-01
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.2733 head_norm=1.404382 delta_norm=0.374622
[S3] aggregate: ROLLBACK (f1_val pre=0.279 post=0.273 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.3594 head_norm=1.647099
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.535391e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.3594 head_norm=1.699501 delta_norm=0.153539
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=31 metric=0.2494 head_norm=1.763751
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.535391e-01
[S10] stored merged vector for next round verification (round=31)
[S10] DEBUG after merge:  round=31 metric=0.2494 head_norm=1.699501 delta_norm=0.153539
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.2633 head_norm=1.488822
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.746223e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.2627 head_norm=1.404382 delta_norm=0.374622
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.752128 cos_to_last_merge=0.9898 (last merge round=27)
[S2] round=32 local utility u=0.533324 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2357542728665236, 'psi': 0.3674775928297055}-{'f1_val': 0.2428921568627451, 'auprc': 0.2428921568627451, 'loss_val': 2.1811337466026646, 'psi': 0.2428921568627451}
[S3] START round=32 head_norm_before_train=1.404382 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.043267 metrics={'f1_val': 0.2767555647439873, 'auprc': 0.2767555647439873, 'loss_val': 1.076051387562426, 'psi': 0.2767555647439873}-{'f1_val': 0.27912824811399833, 'auprc': 0.27912824811399833, 'loss_val': 1.1839394983552094, 'psi': 0.27912824811399833}
[S4] START round=32 head_norm_before_train=1.878372 cos_to_last_merge=0.9973 (last merge round=27)
[S4] round=32 local utility u=0.013005 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0604823673621617, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0864922293444867, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=2.073761 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8741154570536165, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.81036760581152, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.847784 (no previous merge yet)
[S6] round=32 local utility u=0.136589 metrics={'f1_val': 0.024578971324533454, 'auprc': 0.024578971324533454, 'loss_val': 6.423505927200203, 'psi': 0.024578971324533454}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 6.6414491758277014, 'psi': 0.018441678192715538}
[S6] not sending this round → trigger blocked (psi=0.025)
[S7] START round=32 head_norm_before_train=1.870876 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.310325 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.5993359529108547, 'psi': 0.3330019880715706}-{'f1_val': 0.24975136747886623, 'auprc': 0.24975136747886623, 'loss_val': 0.4707305034012463, 'psi': 0.24975136747886623}
[S8] START round=32 head_norm_before_train=1.699501 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0102344554031202, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9923265344193783, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.950503 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.081326202855022, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0605764073991613, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.699501 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=32 local utility u=0.029846 metrics={'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.175967187328623, 'psi': 0.2494019138755981}-{'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.2356584672959174, 'psi': 0.2494019138755981}
[S11] START round=32 head_norm_before_train=1.904991 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.6425316116614295, 'psi': 0.3320907114010562}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.6045569491709664, 'psi': 0.3319360347772085}
[S13] START round=32 head_norm_before_train=1.689183 cos_to_last_merge=0.9998 (last merge round=29)
[S13] round=32 local utility u=0.033332 metrics={'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.32236324505327707, 'psi': 0.9971896248751376}-{'f1_val': 0.9960643421533686, 'auprc': 0.9960643421533686, 'loss_val': 0.3789004094626749, 'psi': 0.9960643421533686}
[S14] START round=32 head_norm_before_train=1.770572 cos_to_last_merge=0.9905 (last merge round=27)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.22264367172629, 'psi': 0.13577478824115594}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.015327758073505, 'psi': 0.13582554517133957}
[S15] START round=32 head_norm_before_train=1.894073 (no previous merge yet)
[S15] round=32 local utility u=0.050720 metrics={'f1_val': 0.6168904640188789, 'auprc': 0.6168904640188789, 'loss_val': 0.48785328770214864, 'psi': 0.6168904640188789}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5855401256635991, 'psi': 0.6164734888353558}
[S16] START round=32 head_norm_before_train=1.921358 cos_to_last_merge=0.9973 (last merge round=26)
[S16] round=32 local utility u=0.356656 metrics={'f1_val': 0.15795783090050067, 'auprc': 0.15795783090050067, 'loss_val': 3.0860511527665726, 'psi': 0.15795783090050067}-{'f1_val': 0.12919088064371928, 'auprc': 0.12919088064371928, 'loss_val': 3.5404597374215694, 'psi': 0.12919088064371928}
[S17] START round=32 head_norm_before_train=1.404382 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.19022456661577467, 'auprc': 0.19022456661577467, 'loss_val': 1.194040708197899, 'psi': 0.19022456661577467}-{'f1_val': 0.26326721623266236, 'auprc': 0.26326721623266236, 'loss_val': 1.1081781914024802, 'psi': 0.26326721623266236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:41913
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:41902
[S4] RECEIVED delta(kind=head bytes=1806) from S7
[S4] cosine check vs S7: cos=0.9992
[S7] RECEIVED delta(kind=head bytes=1798) from S4
[S7] cosine check vs S4: cos=0.9992
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] cosine check vs S2: cos=0.9878
[S8] RECEIVED delta(kind=head bytes=1803) from S10
[S8] cosine check vs S10: cos=0.9993
[S13] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.3330 head_norm=1.889122
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.693321e-02
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.3330 head_norm=1.891814 delta_norm=0.036933
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.3568 head_norm=1.895222
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.693322e-02
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.3568 head_norm=1.891814 delta_norm=0.036933
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.9898
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=0.9878
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:41913
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.3594 head_norm=1.727451
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.127773e-02
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.3594 head_norm=1.727919 delta_norm=0.031278
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S15
[S13] cosine check vs S15: cos=-0.0253
[S13] DROPPED delta from S15 (cos=-0.0253 < 0.0)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.9972 head_norm=1.697054
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.405724e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.9972 head_norm=1.728790 delta_norm=0.140572
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] RoundReady barrier timeout: have=2 need=3 — continuing
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] CommDone barrier timeout: have=1 need=2 — continuing
[S16] RoundReady barrier timeout: have=2 need=3 — continuing
[S16] not sending this round → trigger blocked (psi=0.158)
[S15]  timeout peer S16
[S11]  timeout peer S14
[S16]  timeout peer S5
[S16]  timeout peer S9
[S16]  timeout peer S11
[S14]  timeout peer S4
[S14]  timeout peer S17
[S4]  timeout peer S7
[S8]  timeout peer S10
[S13]  timeout peer S15
[S2]  timeout peer S13
[S3]  timeout peer S8
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S6
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.1902 head_norm=1.436426
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.063324e-01
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.1902 head_norm=1.454389 delta_norm=0.106332
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.771146 cos_to_last_merge=0.9874 (last merge round=27)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2960243457099914, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2357542728665236, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=33 metric=0.3675 head_norm=1.787761
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.523584e-01
[S2] stored merged vector for next round verification (round=33)
[S2] DEBUG after merge:  round=33 metric=0.3675 head_norm=1.736326 delta_norm=0.152358
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] START round=33 head_norm_before_train=1.479793 cos_to_last_merge=0.9917 (last merge round=31)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.26146848602988954, 'auprc': 0.26146848602988954, 'loss_val': 1.2380582680654753, 'psi': 0.26146848602988954}-{'f1_val': 0.2767555647439873, 'auprc': 0.2767555647439873, 'loss_val': 1.076051387562426, 'psi': 0.2767555647439873}
[S4] START round=33 head_norm_before_train=1.891814 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.005585 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0493119058119353, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0604823673621617, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=33 head_norm_before_train=2.083477 (no previous merge yet)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9029758421414398, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8741154570536165, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.855640 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.013733705772811917, 'auprc': 0.013733705772811917, 'loss_val': 6.936124582290785, 'psi': 0.013733705772811917}-{'f1_val': 0.024578971324533454, 'auprc': 0.024578971324533454, 'loss_val': 6.423505927200203, 'psi': 0.024578971324533454}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.891814 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.24950248756218907, 'auprc': 0.24950248756218907, 'loss_val': 0.5872203651027783, 'psi': 0.24950248756218907}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.5993359529108547, 'psi': 0.3330019880715706}
[S8] START round=33 head_norm_before_train=1.727919 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0205891690554048, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0102344554031202, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.957482 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1011961868681115, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.081326202855022, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.728953 cos_to_last_merge=0.9998 (last merge round=31)
[S10] round=33 local utility u=0.036862 metrics={'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.1027826181167892, 'psi': 0.24946185123176273}-{'f1_val': 0.2494019138755981, 'auprc': 0.2494019138755981, 'loss_val': 2.175967187328623, 'psi': 0.2494019138755981}
[S11] START round=33 head_norm_before_train=1.921051 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.643690779689032, 'psi': 0.3319360347772085}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.6425316116614295, 'psi': 0.3320907114010562}
[S13] START round=33 head_norm_before_train=1.728790 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.9966270655376925, 'auprc': 0.9966270655376925, 'loss_val': 0.3205678756201211, 'psi': 0.9966270655376925}-{'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.32236324505327707, 'psi': 0.9971896248751376}
[S14] START round=33 head_norm_before_train=1.790517 cos_to_last_merge=0.9882 (last merge round=27)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.3733550085016, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.22264367172629, 'psi': 0.13577478824115594}
[S15] START round=33 head_norm_before_train=1.916994 (no previous merge yet)
[S15] round=33 local utility u=0.037558 metrics={'f1_val': 0.6171679436988167, 'auprc': 0.6171679436988167, 'loss_val': 0.4152336386657429, 'psi': 0.6171679436988167}-{'f1_val': 0.6168904640188789, 'auprc': 0.6168904640188789, 'loss_val': 0.48785328770214864, 'psi': 0.6168904640188789}
[S16] START round=33 head_norm_before_train=1.932815 cos_to_last_merge=0.9967 (last merge round=26)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.1595669900182764, 'auprc': 0.1595669900182764, 'loss_val': 3.1640288155257648, 'psi': 0.1595669900182764}-{'f1_val': 0.15795783090050067, 'auprc': 0.15795783090050067, 'loss_val': 3.0860511527665726, 'psi': 0.15795783090050067}
[S17] START round=33 head_norm_before_train=1.454389 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.325402 metrics={'f1_val': 0.26403398918002896, 'auprc': 0.26403398918002896, 'loss_val': 1.2075207066703932, 'psi': 0.26403398918002896}-{'f1_val': 0.19022456661577467, 'auprc': 0.19022456661577467, 'loss_val': 1.194040708197899, 'psi': 0.19022456661577467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.736326 cos_to_last_merge=1.0000 (last merge round=33)
[S2] round=34 local utility u=0.006414 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2831969727736205, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2960243457099914, 'psi': 0.3674775928297055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=34 head_norm_before_train=1.562249 cos_to_last_merge=0.9758 (last merge round=31)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.24743282297239133, 'auprc': 0.24743282297239133, 'loss_val': 1.464103206827801, 'psi': 0.24743282297239133}-{'f1_val': 0.26146848602988954, 'auprc': 0.26146848602988954, 'loss_val': 1.2380582680654753, 'psi': 0.26146848602988954}
[S4] START round=34 head_norm_before_train=1.901844 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=34 local utility u=0.008901 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0315105488507337, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0493119058119353, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=34 head_norm_before_train=2.089758 (no previous merge yet)
[S5] round=34 local utility u=0.021888 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8591989047394604, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9029758421414398, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=34 head_norm_before_train=1.862613 (no previous merge yet)
[S6] round=34 local utility u=0.310966 metrics={'f1_val': 0.026303854875283448, 'auprc': 0.026303854875283448, 'loss_val': 6.4273235991792665, 'psi': 0.026303854875283448}-{'f1_val': 0.013733705772811917, 'auprc': 0.013733705772811917, 'loss_val': 6.936124582290785, 'psi': 0.013733705772811917}
[S6] not sending this round → trigger blocked (psi=0.026)
[S7] START round=34 head_norm_before_train=1.905665 cos_to_last_merge=0.9999 (last merge round=32)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.24704699673284744, 'auprc': 0.24704699673284744, 'loss_val': 0.6265697058402467, 'psi': 0.24704699673284744}-{'f1_val': 0.24950248756218907, 'auprc': 0.24950248756218907, 'loss_val': 0.5872203651027783, 'psi': 0.24950248756218907}
[S8] START round=34 head_norm_before_train=1.754465 cos_to_last_merge=0.9997 (last merge round=32)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0384376086481182, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0205891690554048, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.964173 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1193153303254304, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1011961868681115, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.759514 cos_to_last_merge=0.9993 (last merge round=31)
[S10] round=34 local utility u=0.006172 metrics={'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.0904395001264104, 'psi': 0.24946185123176273}-{'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.1027826181167892, 'psi': 0.24946185123176273}
[S11] START round=34 head_norm_before_train=1.935818 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.6986692822917657, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.643690779689032, 'psi': 0.3319360347772085}
[S13] START round=34 head_norm_before_train=1.735566 cos_to_last_merge=0.9999 (last merge round=32)
[S13] round=34 local utility u=0.012120 metrics={'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.3013909154780106, 'psi': 0.9971896248751376}-{'f1_val': 0.9966270655376925, 'auprc': 0.9966270655376925, 'loss_val': 0.3205678756201211, 'psi': 0.9966270655376925}
[S14] START round=34 head_norm_before_train=1.807372 cos_to_last_merge=0.9863 (last merge round=27)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.492829828667958, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.3733550085016, 'psi': 0.13577478824115594}
[S15] START round=34 head_norm_before_train=1.936961 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5607002489353345, 'psi': 0.6164734888353558}-{'f1_val': 0.6171679436988167, 'auprc': 0.6171679436988167, 'loss_val': 0.4152336386657429, 'psi': 0.6171679436988167}
[S16] START round=34 head_norm_before_train=1.942633 cos_to_last_merge=0.9963 (last merge round=26)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.13816849816849816, 'auprc': 0.13816849816849816, 'loss_val': 3.6313085187773013, 'psi': 0.13816849816849816}-{'f1_val': 0.1595669900182764, 'auprc': 0.1595669900182764, 'loss_val': 3.1640288155257648, 'psi': 0.1595669900182764}
[S17] START round=34 head_norm_before_train=1.490095 cos_to_last_merge=0.9992 (last merge round=32)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.22687144009369062, 'auprc': 0.22687144009369062, 'loss_val': 1.2788048042127402, 'psi': 0.22687144009369065}-{'f1_val': 0.26403398918002896, 'auprc': 0.26403398918002896, 'loss_val': 1.2075207066703932, 'psi': 0.26403398918002896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.751739 cos_to_last_merge=0.9999 (last merge round=33)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.326601956283512, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2831969727736205, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.626317 cos_to_last_merge=0.9633 (last merge round=31)
[S3] round=35 local utility u=0.024355 metrics={'f1_val': 0.25839594169395746, 'auprc': 0.25839594169395746, 'loss_val': 1.5140615652504432, 'psi': 0.25839594169395746}-{'f1_val': 0.24743282297239133, 'auprc': 0.24743282297239133, 'loss_val': 1.464103206827801, 'psi': 0.24743282297239133}
[S4] START round=35 head_norm_before_train=1.914680 cos_to_last_merge=0.9998 (last merge round=32)
[S4] round=35 local utility u=0.006486 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0185391330551299, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0315105488507337, 'psi': 0.3567939207526687}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] START round=35 head_norm_before_train=2.097489 (no previous merge yet)
[S5] round=35 local utility u=0.031376 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.796446650323304, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8591989047394604, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=35 head_norm_before_train=1.869739 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 6.861042842797658, 'psi': 0.01910681399631676}-{'f1_val': 0.026303854875283448, 'auprc': 0.026303854875283448, 'loss_val': 6.4273235991792665, 'psi': 0.026303854875283448}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.921017 cos_to_last_merge=0.9995 (last merge round=32)
[S7] round=35 local utility u=0.044413 metrics={'f1_val': 0.24875187219171244, 'auprc': 0.24875187219171244, 'loss_val': 0.5530877353159205, 'psi': 0.24875187219171244}-{'f1_val': 0.24704699673284744, 'auprc': 0.24704699673284744, 'loss_val': 0.6265697058402467, 'psi': 0.24704699673284744}
[S8] START round=35 head_norm_before_train=1.779382 cos_to_last_merge=0.9990 (last merge round=32)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0628499454990206, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0384376086481182, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.970635 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1352149536301264, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1193153303254304, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.784800 cos_to_last_merge=0.9985 (last merge round=31)
[S10] round=35 local utility u=0.387891 metrics={'f1_val': 0.3326161447127261, 'auprc': 0.3326161447127261, 'loss_val': 2.063045927681861, 'psi': 0.3326161447127261}-{'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.0904395001264104, 'psi': 0.24946185123176273}
[S11] START round=35 head_norm_before_train=1.949257 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.7137740734463645, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.6986692822917657, 'psi': 0.3319360347772085}
[S13] START round=35 head_norm_before_train=1.742665 cos_to_last_merge=0.9997 (last merge round=32)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.9960643421533686, 'auprc': 0.9960643421533686, 'loss_val': 0.35959902596075766, 'psi': 0.9960643421533686}-{'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.3013909154780106, 'psi': 0.9971896248751376}
[S14] START round=35 head_norm_before_train=1.821591 cos_to_last_merge=0.9847 (last merge round=27)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.585173613394822, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.492829828667958, 'psi': 0.13577478824115594}
[S15] START round=35 head_norm_before_train=1.955754 (no previous merge yet)
[S15] round=35 local utility u=0.001660 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5561269187158893, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5607002489353345, 'psi': 0.6164734888353558}
[S16] START round=35 head_norm_before_train=1.951109 cos_to_last_merge=0.9958 (last merge round=26)
[S16] round=35 local utility u=1.000000 metrics={'f1_val': 0.21627021289879503, 'auprc': 0.21627021289879503, 'loss_val': 2.117276675650822, 'psi': 0.21627021289879503}-{'f1_val': 0.13816849816849816, 'auprc': 0.13816849816849816, 'loss_val': 3.6313085187773013, 'psi': 0.13816849816849816}
[S17] START round=35 head_norm_before_train=1.521328 cos_to_last_merge=0.9976 (last merge round=32)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.19793056857612687, 'auprc': 0.19793056857612687, 'loss_val': 1.2417430551613517, 'psi': 0.19793056857612687}-{'f1_val': 0.22687144009369062, 'auprc': 0.22687144009369062, 'loss_val': 1.2788048042127402, 'psi': 0.22687144009369065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.333)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S2] START round=36 head_norm_before_train=1.767676 cos_to_last_merge=0.9996 (last merge round=33)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.364218462637148, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.326601956283512, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.671867 cos_to_last_merge=0.9551 (last merge round=31)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 1.5755638278636428, 'psi': 0.2586450700604191}-{'f1_val': 0.25839594169395746, 'auprc': 0.25839594169395746, 'loss_val': 1.5140615652504432, 'psi': 0.25839594169395746}
[S4] START round=36 head_norm_before_train=1.926382 cos_to_last_merge=0.9996 (last merge round=32)
[S4] round=36 local utility u=0.001332 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0158760005646346, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0185391330551299, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=36 head_norm_before_train=2.104402 (no previous merge yet)
[S5] round=36 local utility u=0.011478 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7734907708581256, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.796446650323304, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=36 head_norm_before_train=1.875010 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 6.920241023161552, 'psi': 0.01910681399631676}-{'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 6.861042842797658, 'psi': 0.01910681399631676}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.934672 cos_to_last_merge=0.9993 (last merge round=32)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.6960986964334396, 'psi': 0.2496892866020383}-{'f1_val': 0.24875187219171244, 'auprc': 0.24875187219171244, 'loss_val': 0.5530877353159205, 'psi': 0.24875187219171244}
[S8] START round=36 head_norm_before_train=1.804897 cos_to_last_merge=0.9981 (last merge round=32)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0904511163542232, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0628499454990206, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=1.976738 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1527340103630763, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1352149536301264, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.811754 cos_to_last_merge=0.9975 (last merge round=31)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 1.9301765779786264, 'psi': 0.2494621085345446}-{'f1_val': 0.3326161447127261, 'auprc': 0.3326161447127261, 'loss_val': 2.063045927681861, 'psi': 0.3326161447127261}
[S11] START round=36 head_norm_before_train=1.961461 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.756009634751281, 'psi': 0.3320907114010562}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.7137740734463645, 'psi': 0.3319360347772085}
[S13] START round=36 head_norm_before_train=1.750781 cos_to_last_merge=0.9995 (last merge round=32)
[S13] round=36 local utility u=0.022935 metrics={'f1_val': 0.9966270655376925, 'auprc': 0.9966270655376925, 'loss_val': 0.31879365418020894, 'psi': 0.9966270655376925}-{'f1_val': 0.9960643421533686, 'auprc': 0.9960643421533686, 'loss_val': 0.35959902596075766, 'psi': 0.9960643421533686}
[S14] START round=36 head_norm_before_train=1.834102 cos_to_last_merge=0.9835 (last merge round=27)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.661664315342013, 'psi': 0.13582554517133957}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.585173613394822, 'psi': 0.13577478824115594}
[S15] START round=36 head_norm_before_train=1.974413 (no previous merge yet)
[S15] round=36 local utility u=0.039019 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.47934167487264384, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5561269187158893, 'psi': 0.6163342951580373}
[S16] START round=36 head_norm_before_train=1.959131 cos_to_last_merge=0.9954 (last merge round=26)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.10264608599779493, 'auprc': 0.10264608599779493, 'loss_val': 3.551308322255964, 'psi': 0.10264608599779493}-{'f1_val': 0.21627021289879503, 'auprc': 0.21627021289879503, 'loss_val': 2.117276675650822, 'psi': 0.21627021289879503}
[S17] START round=36 head_norm_before_train=1.546813 cos_to_last_merge=0.9958 (last merge round=32)
[S17] round=36 local utility u=0.071716 metrics={'f1_val': 0.2089247916569338, 'auprc': 0.2089247916569338, 'loss_val': 1.1972585724859677, 'psi': 0.2089247916569338}-{'f1_val': 0.19793056857612687, 'auprc': 0.19793056857612687, 'loss_val': 1.2417430551613517, 'psi': 0.19793056857612687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.616)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.783131 cos_to_last_merge=0.9992 (last merge round=33)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3961015008839888, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.364218462637148, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.705119 cos_to_last_merge=0.9499 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.950
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.25293858822050413, 'auprc': 0.25293858822050413, 'loss_val': 1.708697279714246, 'psi': 0.25293858822050413}-{'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 1.5755638278636428, 'psi': 0.2586450700604191}
[S4] START round=37 head_norm_before_train=1.941600 cos_to_last_merge=0.9992 (last merge round=32)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.016017505418475, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0158760005646346, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=2.115958 (no previous merge yet)
[S5] round=37 local utility u=0.007932 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.75762743805657, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7734907708581256, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=37 head_norm_before_train=1.880262 (no previous merge yet)
[S6] round=37 local utility u=0.059309 metrics={'f1_val': 0.024362477231329692, 'auprc': 0.024362477231329692, 'loss_val': 6.8489229999591945, 'psi': 0.024362477231329692}-{'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 6.920241023161552, 'psi': 0.01910681399631676}
[S6] not sending this round → trigger blocked (psi=0.024)
[S7] START round=37 head_norm_before_train=1.946900 cos_to_last_merge=0.9989 (last merge round=32)
[S7] round=37 local utility u=0.075770 metrics={'f1_val': 0.24787074148296592, 'auprc': 0.24787074148296592, 'loss_val': 0.5281918576759508, 'psi': 0.2478707414829659}-{'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.6960986964334396, 'psi': 0.2496892866020383}
[S8] START round=37 head_norm_before_train=1.828381 cos_to_last_merge=0.9970 (last merge round=32)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1206730242676541, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0904511163542232, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=1.982914 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1689508171519702, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1527340103630763, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.838446 cos_to_last_merge=0.9963 (last merge round=31)
[S10] round=37 local utility u=0.055220 metrics={'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 1.8197361898190538, 'psi': 0.2494621085345446}-{'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 1.9301765779786264, 'psi': 0.2494621085345446}
[S11] START round=37 head_norm_before_train=1.972790 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.7811432624485457, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.756009634751281, 'psi': 0.3320907114010562}
[S13] START round=37 head_norm_before_train=1.760033 cos_to_last_merge=0.9992 (last merge round=32)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.9963457244214116, 'auprc': 0.9963457244214116, 'loss_val': 0.343814484719973, 'psi': 0.9963457244214116}-{'f1_val': 0.9966270655376925, 'auprc': 0.9966270655376925, 'loss_val': 0.31879365418020894, 'psi': 0.9966270655376925}
[S14] START round=37 head_norm_before_train=1.845230 cos_to_last_merge=0.9824 (last merge round=27)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.7281704632441075, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.661664315342013, 'psi': 0.13582554517133957}
[S15] START round=37 head_norm_before_train=1.992439 (no previous merge yet)
[S15] round=37 local utility u=0.002969 metrics={'f1_val': 0.616751573155862, 'auprc': 0.616751573155862, 'loss_val': 0.4759063039007029, 'psi': 0.616751573155862}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.47934167487264384, 'psi': 0.6164734888353558}
[S16] START round=37 head_norm_before_train=1.966945 cos_to_last_merge=0.9950 (last merge round=26)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.058888888888888886, 'auprc': 0.058888888888888886, 'loss_val': 4.255820884735319, 'psi': 0.05888888888888888}-{'f1_val': 0.10264608599779493, 'auprc': 0.10264608599779493, 'loss_val': 3.551308322255964, 'psi': 0.10264608599779493}
[S17] START round=37 head_norm_before_train=1.570520 cos_to_last_merge=0.9940 (last merge round=32)
[S17] round=37 local utility u=0.195821 metrics={'f1_val': 0.26450450620687366, 'auprc': 0.26450450620687366, 'loss_val': 1.305833219986687, 'psi': 0.26450450620687366}-{'f1_val': 0.2089247916569338, 'auprc': 0.2089247916569338, 'loss_val': 1.1972585724859677, 'psi': 0.2089247916569338}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.265)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.797609 cos_to_last_merge=0.9987 (last merge round=33)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.2080594835026223, 'auprc': 0.2080594835026223, 'loss_val': 2.555189655482117, 'psi': 0.2080594835026223}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3961015008839888, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.729957 cos_to_last_merge=0.9463 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=38 local utility u=0.048975 metrics={'f1_val': 0.25979727548582865, 'auprc': 0.25979727548582865, 'loss_val': 1.6724762624810183, 'psi': 0.25979727548582865}-{'f1_val': 0.25293858822050413, 'auprc': 0.25293858822050413, 'loss_val': 1.708697279714246, 'psi': 0.25293858822050413}
[S4] START round=38 head_norm_before_train=1.952496 cos_to_last_merge=0.9989 (last merge round=32)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.018764196596095, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.016017505418475, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=2.127468 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.802005225278636, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.75762743805657, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.886142 (no previous merge yet)
[S6] round=38 local utility u=0.157283 metrics={'f1_val': 0.028442437923250564, 'auprc': 0.028442437923250564, 'loss_val': 6.571076813475605, 'psi': 0.02844243792325056}-{'f1_val': 0.024362477231329692, 'auprc': 0.024362477231329692, 'loss_val': 6.8489229999591945, 'psi': 0.024362477231329692}
[S6] not sending this round → trigger blocked (psi=0.028)
[S7] START round=38 head_norm_before_train=1.960454 cos_to_last_merge=0.9985 (last merge round=32)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.24755577839057408, 'auprc': 0.24755577839057408, 'loss_val': 0.6312916635906182, 'psi': 0.24755577839057408}-{'f1_val': 0.24787074148296592, 'auprc': 0.24787074148296592, 'loss_val': 0.5281918576759508, 'psi': 0.2478707414829659}
[S8] START round=38 head_norm_before_train=1.848441 cos_to_last_merge=0.9960 (last merge round=32)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1566525849183102, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1206730242676541, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.988849 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1836137717705855, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1689508171519702, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.864335 cos_to_last_merge=0.9952 (last merge round=31)
[S10] round=38 local utility u=0.082047 metrics={'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 1.6556418733232396, 'psi': 0.2494621085345446}-{'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 1.8197361898190538, 'psi': 0.2494621085345446}
[S11] START round=38 head_norm_before_train=1.983618 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.8068213052839317, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.7811432624485457, 'psi': 0.3320907114010562}
[S13] START round=38 head_norm_before_train=1.768820 cos_to_last_merge=0.9987 (last merge round=32)
[S13] round=38 local utility u=0.034828 metrics={'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.28175299926898184, 'psi': 0.9971896248751376}-{'f1_val': 0.9963457244214116, 'auprc': 0.9963457244214116, 'loss_val': 0.343814484719973, 'psi': 0.9963457244214116}
[S14] START round=38 head_norm_before_train=1.855259 cos_to_last_merge=0.9814 (last merge round=27)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.7850735638521416, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.7281704632441075, 'psi': 0.13582554517133957}
[S15] START round=38 head_norm_before_train=2.009079 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5269231216053805, 'psi': 0.6166125814646326}-{'f1_val': 0.616751573155862, 'auprc': 0.616751573155862, 'loss_val': 0.4759063039007029, 'psi': 0.616751573155862}
[S16] START round=38 head_norm_before_train=1.974502 cos_to_last_merge=0.9946 (last merge round=26)
[S16] round=38 local utility u=0.015849 metrics={'f1_val': 0.06326781326781326, 'auprc': 0.06326781326781326, 'loss_val': 4.263532411081618, 'psi': 0.06326781326781326}-{'f1_val': 0.058888888888888886, 'auprc': 0.058888888888888886, 'loss_val': 4.255820884735319, 'psi': 0.05888888888888888}
[S17] START round=38 head_norm_before_train=1.592075 cos_to_last_merge=0.9921 (last merge round=32)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.21498671600461328, 'auprc': 0.21498671600461328, 'loss_val': 1.402218627760558, 'psi': 0.21498671600461328}-{'f1_val': 0.26450450620687366, 'auprc': 0.26450450620687366, 'loss_val': 1.305833219986687, 'psi': 0.26450450620687366}
[S11]  timeout peer S16
[S3]  timeout peer S17
[S13]  timeout peer S2
[S7]  timeout peer S4
[S15]  timeout peer S13
[S8]  timeout peer S3
[S10]  timeout peer S8
[S14]  timeout peer S11
[S17]  timeout peer S14
[S16]  timeout peer S15
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.249)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.063)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.810846 cos_to_last_merge=0.9981 (last merge round=33)
[S2] round=39 local utility u=0.774006 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.441941395533874, 'psi': 0.3674775928297055}-{'f1_val': 0.2080594835026223, 'auprc': 0.2080594835026223, 'loss_val': 2.555189655482117, 'psi': 0.2080594835026223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S2] r=40 psi=0.367 u=0.7740 p_local=0.1972 f1=0.367 auprc=0.367 bytes=21598
[S3] START round=39 head_norm_before_train=1.749413 cos_to_last_merge=0.9435 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=39 local utility u=0.375980 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.8598074325891858, 'psi': 0.3641628959276018}-{'f1_val': 0.25979727548582865, 'auprc': 0.25979727548582865, 'loss_val': 1.6724762624810183, 'psi': 0.25979727548582865}
[S3] not sending this round → trigger blocked (psi=0.364)
[S3] r=40 psi=0.364 u=0.3760 p_local=0.1023 f1=0.364 auprc=0.364 bytes=19823
[S4] START round=39 head_norm_before_train=1.961378 cos_to_last_merge=0.9986 (last merge round=32)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0262998989342007, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.018764196596095, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0217 f1=0.357 auprc=0.357 bytes=16215
[S5] START round=39 head_norm_before_train=2.144518 (no previous merge yet)
[S5] round=39 local utility u=0.002868 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.796268327032239, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.802005225278636, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S5] r=40 psi=0.334 u=0.0029 p_local=0.0117 f1=0.334 auprc=0.334 bytes=30605
[S6] START round=39 head_norm_before_train=1.892883 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.143840967244127, 'psi': 0.017551963048498844}-{'f1_val': 0.028442437923250564, 'auprc': 0.028442437923250564, 'loss_val': 6.571076813475605, 'psi': 0.02844243792325056}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.018 u=0.0000 p_local=0.0667 f1=0.018 auprc=0.018 bytes=0
[S7] START round=39 head_norm_before_train=1.972070 cos_to_last_merge=0.9981 (last merge round=32)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.24925298804780877, 'auprc': 0.24925298804780877, 'loss_val': 0.6677264836360935, 'psi': 0.24925298804780877}-{'f1_val': 0.24755577839057408, 'auprc': 0.24755577839057408, 'loss_val': 0.6312916635906182, 'psi': 0.24755577839057408}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.249 u=0.0000 p_local=0.0314 f1=0.249 auprc=0.249 bytes=30620
[S8] START round=39 head_norm_before_train=1.864878 cos_to_last_merge=0.9949 (last merge round=32)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.198259357382766, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1566525849183102, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0028 f1=0.359 auprc=0.359 bytes=34175
[S9] START round=39 head_norm_before_train=1.994563 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.199124854636384, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1836137717705855, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0005 f1=0.369 auprc=0.369 bytes=1805
[S10] START round=39 head_norm_before_train=1.888226 cos_to_last_merge=0.9941 (last merge round=31)
[S10] round=39 local utility u=0.046866 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.5629868762832124, 'psi': 0.24958183990442054}-{'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 1.6556418733232396, 'psi': 0.2494621085345446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S10] r=40 psi=0.250 u=0.0469 p_local=0.0729 f1=0.250 auprc=0.250 bytes=28822
[S11] START round=39 head_norm_before_train=1.993577 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.827116266146429, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.8068213052839317, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0015 f1=0.332 auprc=0.332 bytes=7187
[S13] START round=39 head_norm_before_train=1.779893 cos_to_last_merge=0.9978 (last merge round=32)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.9969083656422735, 'auprc': 0.9969083656422735, 'loss_val': 0.2951276741854665, 'psi': 0.9969083656422735}-{'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.28175299926898184, 'psi': 0.9971896248751376}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.997 u=0.0000 p_local=0.0364 f1=0.997 auprc=0.997 bytes=30588
[S14] START round=39 head_norm_before_train=1.864574 cos_to_last_merge=0.9805 (last merge round=27)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.8348951823052335, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.7850735638521416, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0140 f1=0.136 auprc=0.136 bytes=0
[S15] START round=39 head_norm_before_train=2.025386 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5466310795836132, 'psi': 0.6164734888353558}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5269231216053805, 'psi': 0.6166125814646326}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.616 u=0.0000 p_local=0.0160 f1=0.616 auprc=0.616 bytes=28805
[S16] START round=39 head_norm_before_train=1.981282 cos_to_last_merge=0.9942 (last merge round=26)
[S16] round=39 local utility u=0.208714 metrics={'f1_val': 0.09133732534930139, 'auprc': 0.09133732534930139, 'loss_val': 4.098730666638463, 'psi': 0.09133732534930139}-{'f1_val': 0.06326781326781326, 'auprc': 0.06326781326781326, 'loss_val': 4.263532411081618, 'psi': 0.06326781326781326}
[S16] not sending this round → trigger blocked (psi=0.091)
[S16] r=40 psi=0.091 u=0.2087 p_local=0.1621 f1=0.091 auprc=0.091 bytes=1800
[S17] START round=39 head_norm_before_train=1.612096 cos_to_last_merge=0.9904 (last merge round=32)
[S17] round=39 local utility u=0.905795 metrics={'f1_val': 0.4085849267016768, 'auprc': 0.4085849267016768, 'loss_val': 1.3330130187308158, 'psi': 0.4085849267016768}-{'f1_val': 0.21498671600461328, 'auprc': 0.21498671600461328, 'loss_val': 1.402218627760558, 'psi': 0.21498671600461328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S17] r=40 psi=0.409 u=0.9058 p_local=0.2474 f1=0.409 auprc=0.409 bytes=32381
[S2] START round=40 head_norm_before_train=1.822417 cos_to_last_merge=0.9975 (last merge round=33)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4789479788973954, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.441941395533874, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.759814 cos_to_last_merge=0.9418 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.2568128151126428, 'auprc': 0.2568128151126428, 'loss_val': 1.8131208796667624, 'psi': 0.2568128151126428}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.8598074325891858, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.971669 cos_to_last_merge=0.9982 (last merge round=32)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0370372820413258, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0262998989342007, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=2.157389 (no previous merge yet)
[S5] round=40 local utility u=0.026025 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.74421786954436, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.796268327032239, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=40 head_norm_before_train=1.899060 (no previous merge yet)
[S6] round=40 local utility u=0.032727 metrics={'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.090387212361433, 'psi': 0.018885306310456013}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.143840967244127, 'psi': 0.017551963048498844}
[S6] not sending this round → trigger blocked (psi=0.019)
[S7] START round=40 head_norm_before_train=1.985456 cos_to_last_merge=0.9974 (last merge round=32)
[S7] round=40 local utility u=0.099287 metrics={'f1_val': 0.24900299102691925, 'auprc': 0.24900299102691925, 'loss_val': 0.46690312920928556, 'psi': 0.24900299102691925}-{'f1_val': 0.24925298804780877, 'auprc': 0.24925298804780877, 'loss_val': 0.6677264836360935, 'psi': 0.24925298804780877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=40 head_norm_before_train=1.883050 cos_to_last_merge=0.9937 (last merge round=32)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.238871799857889, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.198259357382766, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=2.000244 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.215055211029107, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.199124854636384, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.908794 cos_to_last_merge=0.9931 (last merge round=31)
[S10] round=40 local utility u=0.043244 metrics={'f1_val': 0.24934383202099739, 'auprc': 0.24934383202099739, 'loss_val': 1.4743575750616498, 'psi': 0.2493438320209974}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.5629868762832124, 'psi': 0.24958183990442054}
[S10] not sending this round → trigger blocked (psi=0.249)
[S11] START round=40 head_norm_before_train=2.003163 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.841807094643382, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.827116266146429, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.791643 cos_to_last_merge=0.9970 (last merge round=32)
[S13] round=40 local utility u=0.016431 metrics={'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.2647969677943206, 'psi': 0.9971896248751376}-{'f1_val': 0.9969083656422735, 'auprc': 0.9969083656422735, 'loss_val': 0.2951276741854665, 'psi': 0.9969083656422735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=40 head_norm_before_train=1.873335 cos_to_last_merge=0.9797 (last merge round=27)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.888816312088393, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.8348951823052335, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=2.040558 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.561507656804321, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5466310795836132, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.987386 cos_to_last_merge=0.9938 (last merge round=26)
[S16] round=40 local utility u=0.402366 metrics={'f1_val': 0.1370044052863436, 'auprc': 0.1370044052863436, 'loss_val': 3.7050028010051212, 'psi': 0.1370044052863436}-{'f1_val': 0.09133732534930139, 'auprc': 0.09133732534930139, 'loss_val': 4.098730666638463, 'psi': 0.09133732534930139}
[S16] not sending this round → trigger blocked (psi=0.137)
[S17] START round=40 head_norm_before_train=1.628812 cos_to_last_merge=0.9889 (last merge round=32)
[S17] round=40 local utility u=0.002312 metrics={'f1_val': 0.4104618975755421, 'auprc': 0.4104618975755421, 'loss_val': 1.3452820174381719, 'psi': 0.4104618975755421}-{'f1_val': 0.4085849267016768, 'auprc': 0.4085849267016768, 'loss_val': 1.3330130187308158, 'psi': 0.4085849267016768}
[S17] not sending this round → trigger blocked (psi=0.410)
[S2] START round=41 head_norm_before_train=1.833328 cos_to_last_merge=0.9970 (last merge round=33)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.24490791559946334, 'auprc': 0.24490791559946334, 'loss_val': 2.4825212642238252, 'psi': 0.24490791559946334}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4789479788973954, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.770398 cos_to_last_merge=0.9402 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.2499223650704925, 'auprc': 0.2499223650704925, 'loss_val': 1.8813501290696601, 'psi': 0.2499223650704925}-{'f1_val': 0.2568128151126428, 'auprc': 0.2568128151126428, 'loss_val': 1.8131208796667624, 'psi': 0.2568128151126428}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.981855 cos_to_last_merge=0.9977 (last merge round=32)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.041472008123366, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0370372820413258, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=2.160259 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7698622016794308, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.74421786954436, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.904730 (no previous merge yet)
[S6] round=41 local utility u=0.672264 metrics={'f1_val': 0.08600871977804202, 'auprc': 0.08600871977804202, 'loss_val': 6.349969309983966, 'psi': 0.08600871977804202}-{'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.090387212361433, 'psi': 0.018885306310456013}
[S6] not sending this round → trigger blocked (psi=0.086)
[S7] START round=41 head_norm_before_train=1.995831 cos_to_last_merge=0.9968 (last merge round=32)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.24894041386187982, 'auprc': 0.24894041386187982, 'loss_val': 0.6462054833803312, 'psi': 0.24894041386187982}-{'f1_val': 0.24900299102691925, 'auprc': 0.24900299102691925, 'loss_val': 0.46690312920928556, 'psi': 0.24900299102691925}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.899352 cos_to_last_merge=0.9925 (last merge round=32)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.275513034419091, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.238871799857889, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=2.005876 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2305593340163714, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.215055211029107, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.928116 cos_to_last_merge=0.9921 (last merge round=31)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.24536711236218625, 'auprc': 0.24536711236218625, 'loss_val': 1.5937004516928952, 'psi': 0.24536711236218628}-{'f1_val': 0.24934383202099739, 'auprc': 0.24934383202099739, 'loss_val': 1.4743575750616498, 'psi': 0.2493438320209974}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=2.012339 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.8587947727596688, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.841807094643382, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.799708 cos_to_last_merge=0.9964 (last merge round=32)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.273008657913347, 'psi': 0.9971896248751376}-{'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.2647969677943206, 'psi': 0.9971896248751376}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.881347 cos_to_last_merge=0.9789 (last merge round=27)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.937980699380014, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.888816312088393, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.055869 (no previous merge yet)
[S15] round=41 local utility u=0.033836 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4950872056788951, 'psi': 0.6166125814646326}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.561507656804321, 'psi': 0.6164734888353558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=41 head_norm_before_train=1.993858 cos_to_last_merge=0.9935 (last merge round=26)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.13015023055183697, 'auprc': 0.13015023055183697, 'loss_val': 3.9795405347672523, 'psi': 0.13015023055183697}-{'f1_val': 0.1370044052863436, 'auprc': 0.1370044052863436, 'loss_val': 3.7050028010051212, 'psi': 0.1370044052863436}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.641256 cos_to_last_merge=0.9879 (last merge round=32)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.2694152526601856, 'auprc': 0.2694152526601856, 'loss_val': 1.398216875496152, 'psi': 0.2694152526601856}-{'f1_val': 0.4104618975755421, 'auprc': 0.4104618975755421, 'loss_val': 1.3452820174381719, 'psi': 0.4104618975755421}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.843056 cos_to_last_merge=0.9964 (last merge round=33)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.20269997985089663, 'auprc': 0.20269997985089663, 'loss_val': 2.7989225676756098, 'psi': 0.20269997985089663}-{'f1_val': 0.24490791559946334, 'auprc': 0.24490791559946334, 'loss_val': 2.4825212642238252, 'psi': 0.24490791559946334}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.782964 cos_to_last_merge=0.9384 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=42 local utility u=0.473268 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.9629788376951407, 'psi': 0.3641628959276018}-{'f1_val': 0.2499223650704925, 'auprc': 0.2499223650704925, 'loss_val': 1.8813501290696601, 'psi': 0.2499223650704925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=42 head_norm_before_train=1.989550 cos_to_last_merge=0.9973 (last merge round=32)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0447861318062672, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.041472008123366, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=2.173151 (no previous merge yet)
[S5] round=42 local utility u=0.040280 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.689302720365314, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7698622016794308, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=42 head_norm_before_train=1.910318 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.026947463768115944, 'auprc': 0.026947463768115944, 'loss_val': 6.710136207200199, 'psi': 0.026947463768115944}-{'f1_val': 0.08600871977804202, 'auprc': 0.08600871977804202, 'loss_val': 6.349969309983966, 'psi': 0.08600871977804202}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=2.005265 cos_to_last_merge=0.9962 (last merge round=32)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.24919053549190537, 'auprc': 0.24919053549190537, 'loss_val': 0.7052891556371025, 'psi': 0.24919053549190537}-{'f1_val': 0.24894041386187982, 'auprc': 0.24894041386187982, 'loss_val': 0.6462054833803312, 'psi': 0.24894041386187982}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.913840 cos_to_last_merge=0.9914 (last merge round=32)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3077930596838034, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.275513034419091, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=2.011432 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2453201651692543, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2305593340163714, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.947594 cos_to_last_merge=0.9911 (last merge round=31)
[S10] round=42 local utility u=0.005243 metrics={'f1_val': 0.24892857142857142, 'auprc': 0.24892857142857142, 'loss_val': 1.61526759003794, 'psi': 0.24892857142857144}-{'f1_val': 0.24536711236218625, 'auprc': 0.24536711236218625, 'loss_val': 1.5937004516928952, 'psi': 0.24536711236218628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=42 head_norm_before_train=2.021194 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.8774804040465383, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.8587947727596688, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.804954 cos_to_last_merge=0.9963 (last merge round=32)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.9966270655376925, 'auprc': 0.9966270655376925, 'loss_val': 0.2944253399329188, 'psi': 0.9966270655376925}-{'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.273008657913347, 'psi': 0.9971896248751376}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.888907 cos_to_last_merge=0.9782 (last merge round=27)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.983696103666504, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.937980699380014, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.069958 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5210287591420901, 'psi': 0.6164734888353558}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4950872056788951, 'psi': 0.6166125814646326}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=2.000181 cos_to_last_merge=0.9931 (last merge round=26)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.09069097888675624, 'auprc': 0.09069097888675624, 'loss_val': 4.543547812728685, 'psi': 0.09069097888675624}-{'f1_val': 0.13015023055183697, 'auprc': 0.13015023055183697, 'loss_val': 3.9795405347672523, 'psi': 0.13015023055183697}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.653587 cos_to_last_merge=0.9867 (last merge round=32)
[S17] round=42 local utility u=0.158103 metrics={'f1_val': 0.3185366503077137, 'auprc': 0.3185366503077137, 'loss_val': 1.5241028108497712, 'psi': 0.3185366503077137}-{'f1_val': 0.2694152526601856, 'auprc': 0.2694152526601856, 'loss_val': 1.398216875496152, 'psi': 0.2694152526601856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=43 head_norm_before_train=1.852502 cos_to_last_merge=0.9959 (last merge round=33)
[S2] round=43 local utility u=0.870469 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5409832997947364, 'psi': 0.3674775928297055}-{'f1_val': 0.20269997985089663, 'auprc': 0.20269997985089663, 'loss_val': 2.7989225676756098, 'psi': 0.20269997985089663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=43 head_norm_before_train=1.796134 cos_to_last_merge=0.9365 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.2472048163165008, 'auprc': 0.2472048163165008, 'loss_val': 1.9439994441721582, 'psi': 0.2472048163165008}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.9629788376951407, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.995124 cos_to_last_merge=0.9969 (last merge round=32)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0485324911286276, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0447861318062672, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=2.176669 (no previous merge yet)
[S5] round=43 local utility u=0.064468 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.560367027121097, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.689302720365314, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=43 head_norm_before_train=1.916367 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.130953860707566, 'psi': 0.01954921803127875}-{'f1_val': 0.026947463768115944, 'auprc': 0.026947463768115944, 'loss_val': 6.710136207200199, 'psi': 0.026947463768115944}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=2.011578 cos_to_last_merge=0.9958 (last merge round=32)
[S7] round=43 local utility u=0.066976 metrics={'f1_val': 0.24868979286249066, 'auprc': 0.24868979286249066, 'loss_val': 0.5668297920297988, 'psi': 0.24868979286249066}-{'f1_val': 0.24919053549190537, 'auprc': 0.24919053549190537, 'loss_val': 0.7052891556371025, 'psi': 0.24919053549190537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=43 head_norm_before_train=1.928884 cos_to_last_merge=0.9904 (last merge round=32)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3422994758746698, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3077930596838034, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.016815 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.259559540078867, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2453201651692543, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.965883 cos_to_last_merge=0.9901 (last merge round=31)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.24892857142857142, 'auprc': 0.24892857142857142, 'loss_val': 1.6897406742284966, 'psi': 0.24892857142857144}-{'f1_val': 0.24892857142857142, 'auprc': 0.24892857142857142, 'loss_val': 1.61526759003794, 'psi': 0.24892857142857144}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=2.029902 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.895198043786822, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.8774804040465383, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.809233 cos_to_last_merge=0.9961 (last merge round=32)
[S13] round=43 local utility u=0.019938 metrics={'f1_val': 0.9974708433761899, 'auprc': 0.9974708433761899, 'loss_val': 0.2621441388165351, 'psi': 0.9974708433761899}-{'f1_val': 0.9966270655376925, 'auprc': 0.9966270655376925, 'loss_val': 0.2944253399329188, 'psi': 0.9966270655376925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=43 head_norm_before_train=1.896183 cos_to_last_merge=0.9774 (last merge round=27)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.028566796966349, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.983696103666504, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=2.083395 (no previous merge yet)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5621796321564552, 'psi': 0.6166125814646326}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5210287591420901, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=2.006103 cos_to_last_merge=0.9928 (last merge round=26)
[S16] round=43 local utility u=1.000000 metrics={'f1_val': 0.16849665078378565, 'auprc': 0.16849665078378565, 'loss_val': 3.120489580945778, 'psi': 0.16849665078378565}-{'f1_val': 0.09069097888675624, 'auprc': 0.09069097888675624, 'loss_val': 4.543547812728685, 'psi': 0.09069097888675624}
[S16] not sending this round → trigger blocked (psi=0.168)
[S17] START round=43 head_norm_before_train=1.667576 cos_to_last_merge=0.9853 (last merge round=32)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.2918240005997565, 'auprc': 0.2918240005997565, 'loss_val': 1.3453708629834262, 'psi': 0.2918240005997565}-{'f1_val': 0.3185366503077137, 'auprc': 0.3185366503077137, 'loss_val': 1.5241028108497712, 'psi': 0.3185366503077137}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.860885 cos_to_last_merge=0.9954 (last merge round=33)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.568101630583119, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5409832997947364, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.809091 cos_to_last_merge=0.9346 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=44 local utility u=0.469991 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.0566409954952003, 'psi': 0.3641628959276018}-{'f1_val': 0.2472048163165008, 'auprc': 0.2472048163165008, 'loss_val': 1.9439994441721582, 'psi': 0.2472048163165008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=44 head_norm_before_train=1.999624 cos_to_last_merge=0.9966 (last merge round=32)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0564909035463215, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0485324911286276, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=2.172756 (no previous merge yet)
[S5] round=44 local utility u=0.006587 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.547192570869411, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.560367027121097, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=44 head_norm_before_train=1.922661 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.204475111886993, 'psi': 0.01954921803127875}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.130953860707566, 'psi': 0.01954921803127875}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=2.016602 cos_to_last_merge=0.9956 (last merge round=32)
[S7] round=44 local utility u=0.002058 metrics={'f1_val': 0.24862705941088367, 'auprc': 0.24862705941088367, 'loss_val': 0.5621494293841427, 'psi': 0.2486270594108837}-{'f1_val': 0.24868979286249066, 'auprc': 0.24868979286249066, 'loss_val': 0.5668297920297988, 'psi': 0.24868979286249066}
[S7] not sending this round → trigger blocked (psi=0.249)
[S8] START round=44 head_norm_before_train=1.943208 cos_to_last_merge=0.9894 (last merge round=32)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3795708866982364, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3422994758746698, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.022062 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.274482669997735, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.259559540078867, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.983168 cos_to_last_merge=0.9893 (last merge round=31)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.24892908138981437, 'auprc': 0.24892908138981437, 'loss_val': 1.7226394066397734, 'psi': 0.2489290813898144}-{'f1_val': 0.24892857142857142, 'auprc': 0.24892857142857142, 'loss_val': 1.6897406742284966, 'psi': 0.24892857142857144}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.038049 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.9029473443495624, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.895198043786822, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.814954 cos_to_last_merge=0.9958 (last merge round=32)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.9966270655376925, 'auprc': 0.9966270655376925, 'loss_val': 0.29931193344711743, 'psi': 0.9966270655376925}-{'f1_val': 0.9974708433761899, 'auprc': 0.9974708433761899, 'loss_val': 0.2621441388165351, 'psi': 0.9974708433761899}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.903028 cos_to_last_merge=0.9767 (last merge round=27)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.071555676724501, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.028566796966349, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.095917 (no previous merge yet)
[S15] round=44 local utility u=0.052484 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4572111062258657, 'psi': 0.6166125814646326}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5621796321564552, 'psi': 0.6166125814646326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=44 head_norm_before_train=2.012138 cos_to_last_merge=0.9924 (last merge round=26)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.1421523634694814, 'auprc': 0.1421523634694814, 'loss_val': 2.9353269767798493, 'psi': 0.1421523634694814}-{'f1_val': 0.16849665078378565, 'auprc': 0.16849665078378565, 'loss_val': 3.120489580945778, 'psi': 0.16849665078378565}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.681026 cos_to_last_merge=0.9841 (last merge round=32)
[S17] round=44 local utility u=0.395538 metrics={'f1_val': 0.39673011180732504, 'auprc': 0.39673011180732504, 'loss_val': 1.4984493408607609, 'psi': 0.39673011180732504}-{'f1_val': 0.2918240005997565, 'auprc': 0.2918240005997565, 'loss_val': 1.3453708629834262, 'psi': 0.2918240005997565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=45 head_norm_before_train=1.869221 cos_to_last_merge=0.9950 (last merge round=33)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.589126464569693, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.568101630583119, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.821280 cos_to_last_merge=0.9329 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.25824669490437685, 'auprc': 0.25824669490437685, 'loss_val': 1.9129081693001975, 'psi': 0.25824669490437685}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.0566409954952003, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.004877 cos_to_last_merge=0.9962 (last merge round=32)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0589211355916774, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0564909035463215, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=2.179624 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6179490056614605, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.547192570869411, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.929316 (no previous merge yet)
[S6] round=45 local utility u=0.596851 metrics={'f1_val': 0.07883064516129032, 'auprc': 0.07883064516129032, 'loss_val': 6.544306535986096, 'psi': 0.07883064516129032}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.204475111886993, 'psi': 0.01954921803127875}
[S6] not sending this round → trigger blocked (psi=0.079)
[S7] START round=45 head_norm_before_train=2.022702 cos_to_last_merge=0.9954 (last merge round=32)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.247997997997998, 'auprc': 0.247997997997998, 'loss_val': 0.653841364821759, 'psi': 0.247997997997998}-{'f1_val': 0.24862705941088367, 'auprc': 0.24862705941088367, 'loss_val': 0.5621494293841427, 'psi': 0.2486270594108837}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.955206 cos_to_last_merge=0.9884 (last merge round=32)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4200018972808246, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3795708866982364, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.027350 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2888153932346063, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.274482669997735, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.999467 cos_to_last_merge=0.9884 (last merge round=31)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.24881065651760229, 'auprc': 0.24881065651760229, 'loss_val': 1.7581623615689017, 'psi': 0.24881065651760229}-{'f1_val': 0.24892908138981437, 'auprc': 0.24892908138981437, 'loss_val': 1.7226394066397734, 'psi': 0.2489290813898144}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.045570 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.911752082394066, 'psi': 0.3319360347772085}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.9029473443495624, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.822906 cos_to_last_merge=0.9954 (last merge round=32)
[S13] round=45 local utility u=0.013960 metrics={'f1_val': 0.9969083656422735, 'auprc': 0.9969083656422735, 'loss_val': 0.2739227776488542, 'psi': 0.9969083656422735}-{'f1_val': 0.9966270655376925, 'auprc': 0.9966270655376925, 'loss_val': 0.29931193344711743, 'psi': 0.9966270655376925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=45 head_norm_before_train=1.909567 cos_to_last_merge=0.9761 (last merge round=27)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.110925961230605, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.071555676724501, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.107044 (no previous merge yet)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5553917782738699, 'psi': 0.6164734888353558}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4572111062258657, 'psi': 0.6166125814646326}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=2.018216 cos_to_last_merge=0.9921 (last merge round=26)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.06692625943051837, 'auprc': 0.06692625943051837, 'loss_val': 4.42915531995822, 'psi': 0.06692625943051837}-{'f1_val': 0.1421523634694814, 'auprc': 0.1421523634694814, 'loss_val': 2.9353269767798493, 'psi': 0.1421523634694814}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.692709 cos_to_last_merge=0.9829 (last merge round=32)
[S17] round=45 local utility u=0.289506 metrics={'f1_val': 0.44672131147540983, 'auprc': 0.44672131147540983, 'loss_val': 1.3693571761126921, 'psi': 0.44672131147540983}-{'f1_val': 0.39673011180732504, 'auprc': 0.39673011180732504, 'loss_val': 1.4984493408607609, 'psi': 0.39673011180732504}
[S17] not sending this round → trigger blocked (psi=0.447)
[S2] START round=46 head_norm_before_train=1.877333 cos_to_last_merge=0.9945 (last merge round=33)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6052072349408104, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.589126464569693, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.832952 cos_to_last_merge=0.9312 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=46 local utility u=0.372856 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.120441780838125, 'psi': 0.3641628959276018}-{'f1_val': 0.25824669490437685, 'auprc': 0.25824669490437685, 'loss_val': 1.9129081693001975, 'psi': 0.25824669490437685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=46 head_norm_before_train=2.012659 cos_to_last_merge=0.9958 (last merge round=32)
[S4] round=46 local utility u=0.002515 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0538903526125545, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0589211355916774, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=46 head_norm_before_train=2.191346 (no previous merge yet)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.659854570060365, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6179490056614605, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.936104 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 7.287461444171523, 'psi': 0.019770114942528734}-{'f1_val': 0.07883064516129032, 'auprc': 0.07883064516129032, 'loss_val': 6.544306535986096, 'psi': 0.07883064516129032}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=2.030362 cos_to_last_merge=0.9949 (last merge round=32)
[S7] round=46 local utility u=0.083117 metrics={'f1_val': 0.24774436090225563, 'auprc': 0.24774436090225563, 'loss_val': 0.4853236504526775, 'psi': 0.2477443609022556}-{'f1_val': 0.247997997997998, 'auprc': 0.247997997997998, 'loss_val': 0.653841364821759, 'psi': 0.247997997997998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=46 head_norm_before_train=1.963943 cos_to_last_merge=0.9876 (last merge round=32)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4548807199405172, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4200018972808246, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=2.032485 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3053121723954737, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2888153932346063, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.014795 cos_to_last_merge=0.9876 (last merge round=31)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.2488698548655722, 'auprc': 0.2488698548655722, 'loss_val': 1.7828681685808923, 'psi': 0.24886985486557223}-{'f1_val': 0.24881065651760229, 'auprc': 0.24881065651760229, 'loss_val': 1.7581623615689017, 'psi': 0.24881065651760229}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.052951 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.931883878764256, 'psi': 0.3320907114010562}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.911752082394066, 'psi': 0.3319360347772085}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.835086 cos_to_last_merge=0.9947 (last merge round=32)
[S13] round=46 local utility u=0.011832 metrics={'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.25279011431964765, 'psi': 0.9971896248751376}-{'f1_val': 0.9969083656422735, 'auprc': 0.9969083656422735, 'loss_val': 0.2739227776488542, 'psi': 0.9969083656422735}
[S13] not sending this round → trigger blocked (psi=0.997)
[S14] START round=46 head_norm_before_train=1.915964 cos_to_last_merge=0.9754 (last merge round=27)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.1481204271002365, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.110925961230605, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.118785 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6143840637894653, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5553917782738699, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=2.024215 cos_to_last_merge=0.9917 (last merge round=26)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.064997533300444, 'auprc': 0.064997533300444, 'loss_val': 4.473645294747591, 'psi': 0.064997533300444}-{'f1_val': 0.06692625943051837, 'auprc': 0.06692625943051837, 'loss_val': 4.42915531995822, 'psi': 0.06692625943051837}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.704958 cos_to_last_merge=0.9817 (last merge round=32)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.38368046123710764, 'auprc': 0.38368046123710764, 'loss_val': 1.579965308335617, 'psi': 0.38368046123710764}-{'f1_val': 0.44672131147540983, 'auprc': 0.44672131147540983, 'loss_val': 1.3693571761126921, 'psi': 0.44672131147540983}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.885286 cos_to_last_merge=0.9940 (last merge round=33)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6076648457331832, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6052072349408104, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.839563 cos_to_last_merge=0.9300 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.2556868725378066, 'auprc': 0.2556868725378066, 'loss_val': 2.030709838252739, 'psi': 0.2556868725378066}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.120441780838125, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.020833 cos_to_last_merge=0.9954 (last merge round=32)
[S4] round=47 local utility u=0.002923 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0480440872801358, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0538903526125545, 'psi': 0.3567939207526687}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] START round=47 head_norm_before_train=2.204699 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.802252990909655, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.659854570060365, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.941857 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 7.307116698907859, 'psi': 0.019770114942528734}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 7.287461444171523, 'psi': 0.019770114942528734}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=2.040633 cos_to_last_merge=0.9938 (last merge round=32)
[S7] round=47 local utility u=0.011297 metrics={'f1_val': 0.24862705941088367, 'auprc': 0.24862705941088367, 'loss_val': 0.4706730859024674, 'psi': 0.2486270594108837}-{'f1_val': 0.24774436090225563, 'auprc': 0.24774436090225563, 'loss_val': 0.4853236504526775, 'psi': 0.2477443609022556}
[S7] not sending this round → trigger blocked (psi=0.249)
[S8] START round=47 head_norm_before_train=1.973888 cos_to_last_merge=0.9868 (last merge round=32)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4908526622370437, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4548807199405172, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.037742 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3190156235292387, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3053121723954737, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.029238 cos_to_last_merge=0.9868 (last merge round=31)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.24816132858837486, 'auprc': 0.24816132858837486, 'loss_val': 1.818379034696979, 'psi': 0.24816132858837486}-{'f1_val': 0.2488698548655722, 'auprc': 0.2488698548655722, 'loss_val': 1.7828681685808923, 'psi': 0.24886985486557223}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.060354 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.9570886066314004, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.931883878764256, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.847374 cos_to_last_merge=0.9937 (last merge round=32)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.9969083656422735, 'auprc': 0.9969083656422735, 'loss_val': 0.26957465349922566, 'psi': 0.9969083656422735}-{'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.25279011431964765, 'psi': 0.9971896248751376}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.922122 cos_to_last_merge=0.9748 (last merge round=27)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.184842750579822, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.1481204271002365, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.130380 (no previous merge yet)
[S15] round=47 local utility u=0.004976 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6044315196936095, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6143840637894653, 'psi': 0.6164734888353558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=47 head_norm_before_train=2.030019 cos_to_last_merge=0.9914 (last merge round=26)
[S16] round=47 local utility u=0.182640 metrics={'f1_val': 0.07031061882976161, 'auprc': 0.07031061882976161, 'loss_val': 4.1561832839543, 'psi': 0.07031061882976161}-{'f1_val': 0.064997533300444, 'auprc': 0.064997533300444, 'loss_val': 4.473645294747591, 'psi': 0.064997533300444}
[S16] not sending this round → trigger blocked (psi=0.070)
[S17] START round=47 head_norm_before_train=1.718979 cos_to_last_merge=0.9806 (last merge round=32)
[S17] round=47 local utility u=0.391513 metrics={'f1_val': 0.4511372949916719, 'auprc': 0.4511372949916719, 'loss_val': 1.4040517133372514, 'psi': 0.4511372949916719}-{'f1_val': 0.38368046123710764, 'auprc': 0.38368046123710764, 'loss_val': 1.579965308335617, 'psi': 0.38368046123710764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=48 head_norm_before_train=1.892532 cos_to_last_merge=0.9936 (last merge round=33)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.2422009334315893, 'auprc': 0.2422009334315893, 'loss_val': 2.6193360705413604, 'psi': 0.2422009334315893}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6076648457331832, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.848233 cos_to_last_merge=0.9287 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=48 local utility u=0.016331 metrics={'f1_val': 0.2580976204220384, 'auprc': 0.2580976204220384, 'loss_val': 2.019745407073955, 'psi': 0.2580976204220384}-{'f1_val': 0.2556868725378066, 'auprc': 0.2556868725378066, 'loss_val': 2.030709838252739, 'psi': 0.2556868725378066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=48 head_norm_before_train=2.028579 cos_to_last_merge=0.9951 (last merge round=32)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0487979236346299, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0480440872801358, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=2.212716 (no previous merge yet)
[S5] round=48 local utility u=0.024390 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7534725937074542, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.802252990909655, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=48 head_norm_before_train=1.947588 (no previous merge yet)
[S6] round=48 local utility u=0.124713 metrics={'f1_val': 0.02501136880400182, 'auprc': 0.02501136880400182, 'loss_val': 7.104861606231405, 'psi': 0.02501136880400182}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 7.307116698907859, 'psi': 0.019770114942528734}
[S6] not sending this round → trigger blocked (psi=0.025)
[S7] START round=48 head_norm_before_train=2.048609 cos_to_last_merge=0.9932 (last merge round=32)
[S7] round=48 local utility u=0.908149 metrics={'f1_val': 0.43672768564909137, 'auprc': 0.43672768564909137, 'loss_val': 0.34727977870857385, 'psi': 0.43672768564909137}-{'f1_val': 0.24862705941088367, 'auprc': 0.24862705941088367, 'loss_val': 0.4706730859024674, 'psi': 0.2486270594108837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=48 head_norm_before_train=1.984570 cos_to_last_merge=0.9859 (last merge round=32)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.524252841892983, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4908526622370437, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.042672 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.332806568544699, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3190156235292387, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.043169 cos_to_last_merge=0.9861 (last merge round=31)
[S10] round=48 local utility u=0.006228 metrics={'f1_val': 0.24892908138981437, 'auprc': 0.24892908138981437, 'loss_val': 1.8128332476563507, 'psi': 0.2489290813898144}-{'f1_val': 0.24816132858837486, 'auprc': 0.24816132858837486, 'loss_val': 1.818379034696979, 'psi': 0.24816132858837486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=48 head_norm_before_train=2.067334 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.9754713013522793, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.9570886066314004, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.857699 cos_to_last_merge=0.9930 (last merge round=32)
[S13] round=48 local utility u=0.017574 metrics={'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.2369577125815129, 'psi': 0.9971896248751376}-{'f1_val': 0.9969083656422735, 'auprc': 0.9969083656422735, 'loss_val': 0.26957465349922566, 'psi': 0.9969083656422735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=48 head_norm_before_train=1.928096 cos_to_last_merge=0.9742 (last merge round=27)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.221686638816856, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.184842750579822, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.140520 (no previous merge yet)
[S15] round=48 local utility u=0.043001 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5184291628951461, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6044315196936095, 'psi': 0.6164734888353558}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=48 head_norm_before_train=2.035202 cos_to_last_merge=0.9911 (last merge round=26)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.09094541676656277, 'auprc': 0.09094541676656277, 'loss_val': 4.486821070925353, 'psi': 0.09094541676656277}-{'f1_val': 0.07031061882976161, 'auprc': 0.07031061882976161, 'loss_val': 4.1561832839543, 'psi': 0.07031061882976161}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.730377 cos_to_last_merge=0.9795 (last merge round=32)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.41139836620124376, 'auprc': 0.41139836620124376, 'loss_val': 1.5341141426398688, 'psi': 0.41139836620124376}-{'f1_val': 0.4511372949916719, 'auprc': 0.4511372949916719, 'loss_val': 1.4040517133372514, 'psi': 0.4511372949916719}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.899444 cos_to_last_merge=0.9931 (last merge round=33)
[S2] round=49 local utility u=0.546706 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.65341374621047, 'psi': 0.3674775928297055}-{'f1_val': 0.2422009334315893, 'auprc': 0.2422009334315893, 'loss_val': 2.6193360705413604, 'psi': 0.2422009334315893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=49 head_norm_before_train=1.857750 cos_to_last_merge=0.9274 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.2580976204220384, 'auprc': 0.2580976204220384, 'loss_val': 2.039705718118654, 'psi': 0.2580976204220384}-{'f1_val': 0.2580976204220384, 'auprc': 0.2580976204220384, 'loss_val': 2.019745407073955, 'psi': 0.2580976204220384}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.037881 cos_to_last_merge=0.9946 (last merge round=32)
[S4] round=49 local utility u=0.004706 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.03938520831523, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0487979236346299, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=49 head_norm_before_train=2.214550 (no previous merge yet)
[S5] round=49 local utility u=0.021049 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7113744383397447, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7534725937074542, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=49 head_norm_before_train=1.953282 (no previous merge yet)
[S6] round=49 local utility u=0.134239 metrics={'f1_val': 0.029504504504504505, 'auprc': 0.029504504504504505, 'loss_val': 6.876822592415528, 'psi': 0.029504504504504505}-{'f1_val': 0.02501136880400182, 'auprc': 0.02501136880400182, 'loss_val': 7.104861606231405, 'psi': 0.02501136880400182}
[S6] not sending this round → trigger blocked (psi=0.030)
[S7] START round=49 head_norm_before_train=2.057814 cos_to_last_merge=0.9927 (last merge round=32)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.24868913857677902, 'auprc': 0.24868913857677902, 'loss_val': 0.4554022678483436, 'psi': 0.24868913857677905}-{'f1_val': 0.43672768564909137, 'auprc': 0.43672768564909137, 'loss_val': 0.34727977870857385, 'psi': 0.43672768564909137}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.994407 cos_to_last_merge=0.9851 (last merge round=32)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.550894747293507, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.524252841892983, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.047533 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.347152933104569, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.332806568544699, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.056354 cos_to_last_merge=0.9853 (last merge round=31)
[S10] round=49 local utility u=0.006990 metrics={'f1_val': 0.2489883361104499, 'auprc': 0.2489883361104499, 'loss_val': 1.7993874415150422, 'psi': 0.2489883361104499}-{'f1_val': 0.24892908138981437, 'auprc': 0.24892908138981437, 'loss_val': 1.8128332476563507, 'psi': 0.2489290813898144}
[S10] not sending this round → trigger blocked (psi=0.249)
[S11] START round=49 head_norm_before_train=2.073883 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.983760375480588, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.9754713013522793, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.864689 cos_to_last_merge=0.9925 (last merge round=32)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.24697350669550694, 'psi': 0.9971896248751376}-{'f1_val': 0.9971896248751376, 'auprc': 0.9971896248751376, 'loss_val': 0.2369577125815129, 'psi': 0.9971896248751376}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.933812 cos_to_last_merge=0.9736 (last merge round=27)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.260420672345065, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.221686638816856, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.150064 (no previous merge yet)
[S15] round=49 local utility u=0.024690 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4690489994299271, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5184291628951461, 'psi': 0.6164734888353558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=49 head_norm_before_train=2.039566 cos_to_last_merge=0.9908 (last merge round=26)
[S16] round=49 local utility u=0.291897 metrics={'f1_val': 0.12252904783461598, 'auprc': 0.12252904783461598, 'loss_val': 4.1872797367122825, 'psi': 0.12252904783461596}-{'f1_val': 0.09094541676656277, 'auprc': 0.09094541676656277, 'loss_val': 4.486821070925353, 'psi': 0.09094541676656277}
[S16] not sending this round → trigger blocked (psi=0.123)
[S17] START round=49 head_norm_before_train=1.742606 cos_to_last_merge=0.9783 (last merge round=32)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.3158342628102819, 'auprc': 0.3158342628102819, 'loss_val': 1.7338694032588111, 'psi': 0.3158342628102819}-{'f1_val': 0.41139836620124376, 'auprc': 0.41139836620124376, 'loss_val': 1.5341141426398688, 'psi': 0.41139836620124376}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
