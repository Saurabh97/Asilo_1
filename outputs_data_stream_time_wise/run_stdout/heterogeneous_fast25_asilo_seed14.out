[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:62403
[S3] → join 127.0.0.1:62402
[S4] → join 127.0.0.1:62402
[S5] → join 127.0.0.1:62402
[S6] → join 127.0.0.1:62402
[S7] → join 127.0.0.1:62402
[S8] → join 127.0.0.1:62402
[S9] → join 127.0.0.1:62402
[S10] → join 127.0.0.1:62402
[S11] → join 127.0.0.1:62402
[S13] → join 127.0.0.1:62402
[S14] → join 127.0.0.1:62402
[S15] → join 127.0.0.1:62402
[S16] → join 127.0.0.1:62402
[S17] → join 127.0.0.1:62402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.121500 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.186191 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.185674 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.190889 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.173159 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.181739 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.130571 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.168423 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.169566 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.228370 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.165447 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.132608 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.172116 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.108960 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.159149 (no previous merge yet)
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3] + discovered S4
[S3] + discovered S16
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S11
[S3] + discovered S8
[S3] + discovered S9
[S3] + discovered S10
[S3] + discovered S5
[S3] + discovered S7
[S3] + discovered S17
[S3] + discovered S6
[S3] + discovered S14
[S4] + discovered S8
[S4] + discovered S15
[S4] + discovered S11
[S4] + discovered S13
[S4] + discovered S9
[S4] + discovered S10
[S4] + discovered S5
[S4] + discovered S7
[S4] + discovered S17
[S4] + discovered S14
[S4] + discovered S6
[S5] + discovered S3
[S4] + discovered S16
[S5] + discovered S2
[S5] + discovered S4
[S5] + discovered S17
[S5] + discovered S14
[S5] + discovered S6
[S5] + discovered S9
[S5] + discovered S13
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S7
[S5] + discovered S10
[S5] + discovered S11
[S5] + discovered S8
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S3
[S7] + discovered S3
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S2
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S16
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S7
[S6] + discovered S15
[S6] + discovered S13
[S6] + discovered S14
[S6] + discovered S17
[S8] + discovered S2
[S8] + discovered S5
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S3
[S7] + discovered S14
[S7] + discovered S15
[S7] + discovered S9
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S16
[S7] + discovered S13
[S7] + discovered S10
[S7] + discovered S8
[S8] + discovered S16
[S8] + discovered S11
[S8] + discovered S15
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S17
[S8] + discovered S9
[S8] + discovered S14
[S9] + discovered S8
[S9] + discovered S7
[S9] + discovered S4
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S3
[S9] + discovered S6
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S2
[S10] + discovered S5
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S8
[S10] + discovered S3
[S9] + discovered S14
[S9] + discovered S13
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S10
[S9] + discovered S11
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S16
[S10] + discovered S15
[S10] + discovered S13
[S10] + discovered S14
[S11] + discovered S8
[S11] + discovered S4
[S11] + discovered S9
[S11] + discovered S3
[S11] + discovered S10
[S11] + discovered S7
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S6
[S13] + discovered S6
[S13] + discovered S7
[S13] + discovered S3
[S13] + discovered S2
[S13] + discovered S5
[S13] + discovered S10
[S13] + discovered S9
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S8
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S17
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S8
[S13] + discovered S14
[S14] + discovered S13
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S3
[S14] + discovered S4
[S14] + discovered S9
[S14] + discovered S10
[S14] + discovered S2
[S14] + discovered S5
[S14] + discovered S7
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S5
[S15] + discovered S10
[S15] + discovered S4
[S15] + discovered S6
[S15] + discovered S13
[S15] + discovered S8
[S15] + discovered S7
[S15] + discovered S2
[S15] + discovered S9
[S15] + discovered S11
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S16] + discovered S15
[S16] + discovered S9
[S16] + discovered S8
[S16] + discovered S13
[S16] + discovered S6
[S16] + discovered S4
[S16] + discovered S10
[S16] + discovered S5
[S16] + discovered S3
[S16] + discovered S14
[S16] + discovered S11
[S16] + discovered S2
[S16] + discovered S7
[S15] + discovered S17
[S15] + discovered S16
[S17] + discovered S14
[S17] + discovered S6
[S17] + discovered S11
[S17] + discovered S3
[S17] + discovered S10
[S17] + discovered S13
[S17] + discovered S16
[S17] + discovered S7
[S17] + discovered S2
[S17] + discovered S5
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S9
[S17] + discovered S15
[S16] + discovered S17
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=1.000 → S14@127.0.0.1:62414
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:62414
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:62405
[S7] ⇄ pheromone p=1.000 → S6@127.0.0.1:62407
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:62402
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:62407
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:62412
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:62404
[S13] ⇄ pheromone p=1.000 → S9@127.0.0.1:62410
[S8] ⇄ pheromone p=1.000 → S6@127.0.0.1:62407
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:62415
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:62410
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:62404
[S11] ⇄ pheromone p=1.000 → S9@127.0.0.1:62410
[S17] ⇄ pheromone p=1.000 → S5@127.0.0.1:62405
[S2] START round=1 head_norm_before_train=1.126501 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6132034990808282, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5030775991713632, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.217405 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9676789234243404, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5863968932306596, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.201578 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4878572063253401, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4595463078430524, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.210419 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6226479105185148, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4612896067106613, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.191616 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6907664184290332, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5569823823755073, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.190315 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.56937792649189, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4427174440075878, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.141351 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.558097392486073, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4669773918653979, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.183569 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7057445277835503, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4659233207228408, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.171994 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5189622754140955, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4637157722353362, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.232853 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5367978294688622, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4473749416529955, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.161007 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4352291748583643, 'psi': 0.0}-{'f1_val': 0.3044230769230769, 'auprc': 0.3044230769230769, 'loss_val': 1.40733945942319, 'psi': 0.3044230769230769}
[S14] START round=1 head_norm_before_train=1.140890 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5485436291220362, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4759486863903428, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.181910 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.559336041621631, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4839340204969864, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.123185 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6433272346064203, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5199916789924304, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.163802 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.470106057374866, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4174222616277443, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.143897 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8184984704209148, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6132034990808282, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.275999 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7009844079341216, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9676789234243404, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.227556 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5408821390175942, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4878572063253401, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.250180 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6968408392318028, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6226479105185148, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.219052 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0048457486922837, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6907664184290332, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.223820 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.03330324917629, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.56937792649189, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.160375 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.750159629654462, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.558097392486073, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.228825 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.466112953890008, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7057445277835503, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.186873 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6124761694802578, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5189622754140955, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.246950 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6918202773602757, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5367978294688622, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.166624 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4857600580819152, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4352291748583643, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.161128 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6874276684339407, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5485436291220362, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.201082 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.732756804416907, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.559336041621631, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.149435 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8848956955041596, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6433272346064203, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.180791 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5651605338765255, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.470106057374866, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.171639 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3153525060856643, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8184984704209148, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.328179 (no previous merge yet)
[S3] round=3 local utility u=0.126477 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4480297583208737, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7009844079341216, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.262962 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6111673351438525, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5408821390175942, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.274939 (no previous merge yet)
[S5] round=3 local utility u=1.000000 metrics={'f1_val': 0.21528371827773027, 'auprc': 0.21528371827773027, 'loss_val': 1.518223737403554, 'psi': 0.21528371827773027}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6968408392318028, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.256635 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.603934700067769, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0048457486922837, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.273828 (no previous merge yet)
[S7] round=3 local utility u=0.095346 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8426109726480366, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.03330324917629, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.185147 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.937598838967313, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.750159629654462, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.291753 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7340985871970553, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.466112953890008, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.208805 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7625958004197373, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6124761694802578, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.272304 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.046839957085033, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6918202773602757, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.182578 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6115370739397816, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4857600580819152, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.190965 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.048364907393477, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6874276684339407, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.231033 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.042731404858085, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.732756804416907, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.186655 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.431451963009065, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8848956955041596, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.209989 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8134133796116896, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5651605338765255, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:62410
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1791 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1791) from S5
[S9] cosine check vs S5: cos=-0.0669
[S9] DROPPED delta from S5 (cos=-0.0669 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.207948 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8326245513745696, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3153525060856643, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.366326 (no previous merge yet)
[S3] round=4 local utility u=0.081791 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2844478651346627, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4480297583208737, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.298493 (no previous merge yet)
[S4] round=4 local utility u=0.041501 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5281646895196288, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6111673351438525, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.287854 (no previous merge yet)
[S5] round=4 local utility u=0.146968 metrics={'f1_val': 0.2335841817913531, 'auprc': 0.2335841817913531, 'loss_val': 1.3889928865563952, 'psi': 0.2335841817913531}-{'f1_val': 0.21528371827773027, 'auprc': 0.21528371827773027, 'loss_val': 1.518223737403554, 'psi': 0.21528371827773027}
[S6] START round=4 head_norm_before_train=1.292712 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.021415368958121, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.603934700067769, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.282602 (no previous merge yet)
[S7] round=4 local utility u=0.067005 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7086010340324926, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8426109726480366, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.207132 (no previous merge yet)
[S8] round=4 local utility u=0.041615 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8543686585835153, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.937598838967313, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.343395 (no previous merge yet)
[S9] round=4 local utility u=0.068295 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5975085908308175, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7340985871970553, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.233359 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9105739196216842, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7625958004197373, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.305383 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6367784656066657, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.046839957085033, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.203837 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9001366047769368, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6115370739397816, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.228254 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.740548569762178, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.048364907393477, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.258932 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1350448797921517, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.042731404858085, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.229688 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.156570380468247, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.431451963009065, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.248325 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9631755567586697, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8134133796116896, 'psi': 0.0}
[S5] not sending this round → trigger blocked (psi=0.234)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.238676 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8760264409547838, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8326245513745696, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.418051 (no previous merge yet)
[S3] round=5 local utility u=0.035516 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2134157170792643, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2844478651346627, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.320077 (no previous merge yet)
[S4] round=5 local utility u=0.053416 metrics={'f1_val': 0.00042158516020236085, 'auprc': 0.00042158516020236085, 'loss_val': 1.425126574977079, 'psi': 0.00042158516020236085}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5281646895196288, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.314071 (no previous merge yet)
[S5] round=5 local utility u=0.381151 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.2705776937375857, 'psi': 0.3051272166538165}-{'f1_val': 0.2335841817913531, 'auprc': 0.2335841817913531, 'loss_val': 1.3889928865563952, 'psi': 0.2335841817913531}
[S6] START round=5 head_norm_before_train=1.318274 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0620860588547503, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.021415368958121, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.297686 (no previous merge yet)
[S7] round=5 local utility u=0.034823 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6389551000082494, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7086010340324926, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.218206 (no previous merge yet)
[S8] round=5 local utility u=0.088205 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6779592556849316, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8543686585835153, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.405178 (no previous merge yet)
[S9] round=5 local utility u=0.227199 metrics={'f1_val': 0.0007399186089530152, 'auprc': 0.0007399186089530152, 'loss_val': 2.149770470263226, 'psi': 0.0007399186089530152}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5975085908308175, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.256840 (no previous merge yet)
[S10] round=5 local utility u=0.103453 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7036678886199916, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9105739196216842, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.335577 (no previous merge yet)
[S11] round=5 local utility u=0.027586 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.581607228159583, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6367784656066657, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.225252 (no previous merge yet)
[S13] round=5 local utility u=0.010032 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8800723396568604, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9001366047769368, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.266572 (no previous merge yet)
[S14] round=5 local utility u=0.007336 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.72587744076221, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.740548569762178, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.275689 (no previous merge yet)
[S15] round=5 local utility u=0.059596 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.015851952878989, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1350448797921517, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.269411 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.448127933084983, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.156570380468247, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.277157 (no previous merge yet)
[S17] round=5 local utility u=0.153002 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6571707526508286, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9631755567586697, 'psi': 0.0}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:62410
[S14] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.001)
[S5] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=-0.0612
[S9] DROPPED delta from S5 (cos=-0.0612 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S3] ⇄ pheromone p=0.364 → S2@127.0.0.1:62402
[S10] ⇄ pheromone p=0.348 → S4@127.0.0.1:62404
[S8] ⇄ pheromone p=0.352 → S6@127.0.0.1:62407
[S14] ⇄ pheromone p=0.329 → S11@127.0.0.1:62412
[S2] ⇄ pheromone p=0.328 → S6@127.0.0.1:62407
[S9] ⇄ pheromone p=0.384 → S14@127.0.0.1:62414
[S4] ⇄ pheromone p=0.345 → S5@127.0.0.1:62405
[S15] ⇄ pheromone p=0.340 → S14@127.0.0.1:62414
[S6] ⇄ pheromone p=0.328 → S15@127.0.0.1:62415
[S7] ⇄ pheromone p=0.358 → S6@127.0.0.1:62407
[S13] ⇄ pheromone p=0.330 → S9@127.0.0.1:62410
[S11] ⇄ pheromone p=0.333 → S9@127.0.0.1:62410
[S5] ⇄ pheromone p=0.555 → S9@127.0.0.1:62410
[S17] ⇄ pheromone p=0.358 → S5@127.0.0.1:62405
[S16] ⇄ pheromone p=0.328 → S4@127.0.0.1:62404
[S2] START round=6 head_norm_before_train=1.261881 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9006837114585644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8760264409547838, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.479366 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4465168024694175, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2134157170792643, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.345258 (no previous merge yet)
[S4] round=6 local utility u=0.372692 metrics={'f1_val': 0.07593885011631772, 'auprc': 0.07593885011631772, 'loss_val': 1.3593980854991257, 'psi': 0.07593885011631772}-{'f1_val': 0.00042158516020236085, 'auprc': 0.00042158516020236085, 'loss_val': 1.425126574977079, 'psi': 0.00042158516020236085}
[S5] START round=6 head_norm_before_train=1.349062 (no previous merge yet)
[S5] round=6 local utility u=1.000000 metrics={'f1_val': 0.9337747066447746, 'auprc': 0.9337747066447746, 'loss_val': 1.1935463458571376, 'psi': 0.9337747066447746}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.2705776937375857, 'psi': 0.3051272166538165}
[S6] START round=6 head_norm_before_train=1.340254 (no previous merge yet)
[S6] round=6 local utility u=0.053008 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.956069763855501, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0620860588547503, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.323938 (no previous merge yet)
[S7] round=6 local utility u=0.091852 metrics={'f1_val': 0.00015137753557372085, 'auprc': 0.00015137753557372085, 'loss_val': 1.4566141444096246, 'psi': 0.00015137753557372085}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6389551000082494, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.226116 (no previous merge yet)
[S8] round=6 local utility u=0.036406 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6051473597054122, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6779592556849316, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.475514 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.18831863138198343, 'auprc': 0.18831863138198343, 'loss_val': 1.8075854450063653, 'psi': 0.18831863138198343}-{'f1_val': 0.0007399186089530152, 'auprc': 0.0007399186089530152, 'loss_val': 2.149770470263226, 'psi': 0.0007399186089530152}
[S10] START round=6 head_norm_before_train=1.266770 (no previous merge yet)
[S10] round=6 local utility u=0.039487 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6246947437482904, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7036678886199916, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.353155 (no previous merge yet)
[S11] round=6 local utility u=0.114373 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3528612448865958, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.581607228159583, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.230397 (no previous merge yet)
[S13] round=6 local utility u=0.046535 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7870018312827007, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8800723396568604, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.292044 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7618413179267023, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.72587744076221, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.288073 (no previous merge yet)
[S15] round=6 local utility u=0.056816 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9022203968232894, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.015851952878989, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.302108 (no previous merge yet)
[S16] round=6 local utility u=0.071533 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3050617765727317, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.448127933084983, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.287123 (no previous merge yet)
[S17] round=6 local utility u=0.076072 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5050264373959266, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6571707526508286, 'psi': 0.0}
[S5] not sending this round → trigger blocked (psi=0.934)
[S4] not sending this round → trigger blocked (psi=0.076)
[S10] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.188)
[S11] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=7 head_norm_before_train=1.287660 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2527322283715097, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9006837114585644, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.542632 (no previous merge yet)
[S3] round=7 local utility u=1.000000 metrics={'f1_val': 0.26280041797283177, 'auprc': 0.26280041797283177, 'loss_val': 1.9340190456479605, 'psi': 0.26280041797283177}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4465168024694175, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.381198 (no previous merge yet)
[S4] round=7 local utility u=0.514803 metrics={'f1_val': 0.1855460820138043, 'auprc': 0.1855460820138043, 'loss_val': 1.3162575625186117, 'psi': 0.1855460820138043}-{'f1_val': 0.07593885011631772, 'auprc': 0.07593885011631772, 'loss_val': 1.3593980854991257, 'psi': 0.07593885011631772}
[S5] START round=7 head_norm_before_train=1.396226 (no previous merge yet)
[S5] round=7 local utility u=0.231714 metrics={'f1_val': 0.9823320730110952, 'auprc': 0.9823320730110952, 'loss_val': 1.1671350388950212, 'psi': 0.9823320730110952}-{'f1_val': 0.9337747066447746, 'auprc': 0.9337747066447746, 'loss_val': 1.1935463458571376, 'psi': 0.9337747066447746}
[S6] START round=7 head_norm_before_train=1.364572 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1057765654402605, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.956069763855501, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.349145 (no previous merge yet)
[S7] round=7 local utility u=0.648055 metrics={'f1_val': 0.1353238265002971, 'auprc': 0.1353238265002971, 'loss_val': 1.3770561410122537, 'psi': 0.1353238265002971}-{'f1_val': 0.00015137753557372085, 'auprc': 0.00015137753557372085, 'loss_val': 1.4566141444096246, 'psi': 0.00015137753557372085}
[S8] START round=7 head_norm_before_train=1.244547 (no previous merge yet)
[S8] round=7 local utility u=1.000000 metrics={'f1_val': 0.292732665925102, 'auprc': 0.292732665925102, 'loss_val': 1.4607604858018568, 'psi': 0.292732665925102}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6051473597054122, 'psi': 0.0}
[S9] START round=7 head_norm_before_train=1.543726 (no previous merge yet)
[S9] round=7 local utility u=0.834513 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.761737728679696, 'psi': 0.36867172340800847}-{'f1_val': 0.18831863138198343, 'auprc': 0.18831863138198343, 'loss_val': 1.8075854450063653, 'psi': 0.18831863138198343}
[S10] START round=7 head_norm_before_train=1.283927 (no previous merge yet)
[S10] round=7 local utility u=0.291972 metrics={'f1_val': 0.06706792777300086, 'auprc': 0.06706792777300086, 'loss_val': 1.6443623456999248, 'psi': 0.06706792777300086}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6246947437482904, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.371107 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5457486511794505, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3528612448865958, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.233960 (no previous merge yet)
[S13] round=7 local utility u=0.047881 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6912401593937998, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7870018312827007, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.324507 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4554486403799634, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7618413179267023, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.301812 (no previous merge yet)
[S15] round=7 local utility u=0.091600 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7190199510509474, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9022203968232894, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.326316 (no previous merge yet)
[S16] round=7 local utility u=0.107449 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0901632543251125, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3050617765727317, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.306950 (no previous merge yet)
[S17] round=7 local utility u=1.000000 metrics={'f1_val': 0.26178278688524587, 'auprc': 0.26178278688524587, 'loss_val': 1.4386824441111628, 'psi': 0.26178278688524587}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5050264373959266, 'psi': 0.0}
[S15] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[S10] not sending this round → trigger blocked (psi=0.067)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.186)
[S7] not sending this round → trigger blocked (psi=0.135)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:62407
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S8] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1793) from S8
[S6] cosine check vs S8: cos=0.0502
[S2] RECEIVED delta(kind=head bytes=1795) from S3
[S2] cosine check vs S3: cos=-0.0017
[S2] DROPPED delta from S3 (cos=-0.0017 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.0540
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.0546
[S9] DROPPED delta from S5 (cos=-0.0546 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] cosine check vs S17: cos=-0.0979
[S5] DROPPED delta from S17 (cos=-0.0979 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.0000 head_norm=1.364648
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.024778e+00
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.080949 delta_norm=1.024778
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.0000 head_norm=1.395622
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.181085e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.0000 head_norm=0.965231 delta_norm=0.918108
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.321431 (no previous merge yet)
[S2] round=8 local utility u=0.011481 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2297701623249906, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2527322283715097, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.603765 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.2986222937913759, 'auprc': 0.2986222937913759, 'loss_val': 2.6435195740078425, 'psi': 0.2986222937913759}-{'f1_val': 0.26280041797283177, 'auprc': 0.26280041797283177, 'loss_val': 1.9340190456479605, 'psi': 0.26280041797283177}
[S4] START round=8 head_norm_before_train=1.418045 (no previous merge yet)
[S4] round=8 local utility u=0.009081 metrics={'f1_val': 0.1856437318178743, 'auprc': 0.1856437318178743, 'loss_val': 1.298974888227948, 'psi': 0.1856437318178743}-{'f1_val': 0.1855460820138043, 'auprc': 0.1855460820138043, 'loss_val': 1.3162575625186117, 'psi': 0.1855460820138043}
[S5] START round=8 head_norm_before_train=1.446714 (no previous merge yet)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.6645416806489012, 'auprc': 0.6645416806489012, 'loss_val': 1.1497039931087187, 'psi': 0.6645416806489012}-{'f1_val': 0.9823320730110952, 'auprc': 0.9823320730110952, 'loss_val': 1.1671350388950212, 'psi': 0.9823320730110952}
[S6] START round=8 head_norm_before_train=0.965231 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.307622 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4905330720568157, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1057765654402605, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.381943 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.11887283921382903, 'auprc': 0.11887283921382903, 'loss_val': 1.3765824471777814, 'psi': 0.11887283921382905}-{'f1_val': 0.1353238265002971, 'auprc': 0.1353238265002971, 'loss_val': 1.3770561410122537, 'psi': 0.1353238265002971}
[S8] START round=8 head_norm_before_train=1.265475 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.225942620018602, 'auprc': 0.225942620018602, 'loss_val': 1.3498205612957765, 'psi': 0.225942620018602}-{'f1_val': 0.292732665925102, 'auprc': 0.292732665925102, 'loss_val': 1.4607604858018568, 'psi': 0.292732665925102}
[S9] START round=8 head_norm_before_train=1.604673 (no previous merge yet)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1129115492316477, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.761737728679696, 'psi': 0.36867172340800847}
[S10] START round=8 head_norm_before_train=1.308452 (no previous merge yet)
[S10] round=8 local utility u=1.000000 metrics={'f1_val': 0.332294413809638, 'auprc': 0.332294413809638, 'loss_val': 1.6967263331756495, 'psi': 0.332294413809638}-{'f1_val': 0.06706792777300086, 'auprc': 0.06706792777300086, 'loss_val': 1.6443623456999248, 'psi': 0.06706792777300086}
[S11] START round=8 head_norm_before_train=1.395519 (no previous merge yet)
[S11] round=8 local utility u=0.171561 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.202626471563587, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5457486511794505, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.239054 (no previous merge yet)
[S13] round=8 local utility u=0.031579 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6280819051014084, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6912401593937998, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.080949 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.330557 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7943336898462743, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4554486403799634, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.314778 (no previous merge yet)
[S15] round=8 local utility u=0.009861 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.699297772030026, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7190199510509474, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.354521 (no previous merge yet)
[S16] round=8 local utility u=0.082231 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9257018498120133, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0901632543251125, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.338020 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.20308965160623102, 'auprc': 0.20308965160623102, 'loss_val': 1.3236643462728277, 'psi': 0.20308965160623102}-{'f1_val': 0.26178278688524587, 'auprc': 0.26178278688524587, 'loss_val': 1.4386824441111628, 'psi': 0.26178278688524587}
[S4] not sending this round → trigger blocked (psi=0.186)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[S15] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.1667
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.1856 head_norm=1.453695
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.013354e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.065906 delta_norm=0.901335
[S4] aggregate: ROLLBACK (f1_val pre=0.186 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=1.354642 (no previous merge yet)
[S2] round=9 local utility u=0.096036 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0376973533351497, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2297701623249906, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.654936 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.287741935483871, 'auprc': 0.287741935483871, 'loss_val': 2.6248569045236936, 'psi': 0.287741935483871}-{'f1_val': 0.2986222937913759, 'auprc': 0.2986222937913759, 'loss_val': 2.6435195740078425, 'psi': 0.2986222937913759}
[S4] START round=9 head_norm_before_train=1.065906 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3558721235873927, 'psi': 0.0}-{'f1_val': 0.1856437318178743, 'auprc': 0.1856437318178743, 'loss_val': 1.298974888227948, 'psi': 0.1856437318178743}
[S5] START round=9 head_norm_before_train=1.477027 (no previous merge yet)
[S5] round=9 local utility u=0.009746 metrics={'f1_val': 0.6638241754781006, 'auprc': 0.6638241754781006, 'loss_val': 1.1237539300276975, 'psi': 0.6638241754781006}-{'f1_val': 0.6645416806489012, 'auprc': 0.6645416806489012, 'loss_val': 1.1497039931087187, 'psi': 0.6645416806489012}
[S6] START round=9 head_norm_before_train=0.999164 cos_to_last_merge=0.9977 (last merge round=7)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0560129972860364, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4905330720568157, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.412153 (no previous merge yet)
[S7] round=9 local utility u=0.161619 metrics={'f1_val': 0.15177626606198033, 'auprc': 0.15177626606198033, 'loss_val': 1.3494758774610114, 'psi': 0.15177626606198033}-{'f1_val': 0.11887283921382903, 'auprc': 0.11887283921382903, 'loss_val': 1.3765824471777814, 'psi': 0.11887283921382905}
[S8] START round=9 head_norm_before_train=1.290974 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.2059609991521555, 'auprc': 0.2059609991521555, 'loss_val': 1.2842856015885793, 'psi': 0.2059609991521555}-{'f1_val': 0.225942620018602, 'auprc': 0.225942620018602, 'loss_val': 1.3498205612957765, 'psi': 0.225942620018602}
[S9] START round=9 head_norm_before_train=1.654173 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2833879956875625, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1129115492316477, 'psi': 0.36867172340800847}
[S10] START round=9 head_norm_before_train=1.335624 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.33261477045908183, 'auprc': 0.33261477045908183, 'loss_val': 2.4111312146505117, 'psi': 0.33261477045908183}-{'f1_val': 0.332294413809638, 'auprc': 0.332294413809638, 'loss_val': 1.6967263331756495, 'psi': 0.332294413809638}
[S11] START round=9 head_norm_before_train=1.419787 (no previous merge yet)
[S11] round=9 local utility u=0.010946 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1807343722228945, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.202626471563587, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.250544 (no previous merge yet)
[S13] round=9 local utility u=0.046123 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.535836064583052, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6280819051014084, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.115614 cos_to_last_merge=0.9982 (last merge round=7)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6900303200755666, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7943336898462743, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.336369 (no previous merge yet)
[S15] round=9 local utility u=0.114063 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4711715067523154, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.699297772030026, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.384195 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.00023277467411545624, 'auprc': 0.00023277467411545624, 'loss_val': 2.9460063965192815, 'psi': 0.00023277467411545624}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9257018498120133, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.365581 (no previous merge yet)
[S17] round=9 local utility u=0.025179 metrics={'f1_val': 0.20285363806572407, 'auprc': 0.20285363806572407, 'loss_val': 1.2711815655025467, 'psi': 0.20285363806572407}-{'f1_val': 0.20308965160623102, 'auprc': 0.20308965160623102, 'loss_val': 1.3236643462728277, 'psi': 0.20308965160623102}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.152)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:62410
[S5] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=-0.0546
[S9] DROPPED delta from S5 (cos=-0.0546 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=-0.1029
[S5] DROPPED delta from S17 (cos=-0.1029 < 0.0)
[S2] START round=10 head_norm_before_train=1.387217 (no previous merge yet)
[S2] round=10 local utility u=0.915068 metrics={'f1_val': 0.20418968692449355, 'auprc': 0.20418968692449355, 'loss_val': 3.0452685308410348, 'psi': 0.20418968692449355}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0376973533351497, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.701401 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.2622352557836429, 'auprc': 0.2622352557836429, 'loss_val': 2.5874072336822707, 'psi': 0.2622352557836429}-{'f1_val': 0.287741935483871, 'auprc': 0.287741935483871, 'loss_val': 2.6248569045236936, 'psi': 0.287741935483871}
[S4] START round=10 head_norm_before_train=1.100499 cos_to_last_merge=0.9983 (last merge round=8)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3624839836533715, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3558721235873927, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.507141 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.2242772722374935, 'psi': 0.33358943696313936}-{'f1_val': 0.6638241754781006, 'auprc': 0.6638241754781006, 'loss_val': 1.1237539300276975, 'psi': 0.6638241754781006}
[S6] START round=10 head_norm_before_train=1.046157 cos_to_last_merge=0.9903 (last merge round=7)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1553508393345493, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0560129972860364, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.450488 (no previous merge yet)
[S7] round=10 local utility u=0.281172 metrics={'f1_val': 0.21009636862594935, 'auprc': 0.21009636862594935, 'loss_val': 1.3120135811415856, 'psi': 0.21009636862594935}-{'f1_val': 0.15177626606198033, 'auprc': 0.15177626606198033, 'loss_val': 1.3494758774610114, 'psi': 0.15177626606198033}
[S8] START round=10 head_norm_before_train=1.320389 (no previous merge yet)
[S8] round=10 local utility u=0.008712 metrics={'f1_val': 0.20384714691453654, 'auprc': 0.20384714691453654, 'loss_val': 1.2478363276190527, 'psi': 0.20384714691453654}-{'f1_val': 0.2059609991521555, 'auprc': 0.2059609991521555, 'loss_val': 1.2842856015885793, 'psi': 0.2059609991521555}
[S9] START round=10 head_norm_before_train=1.692050 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.404472380659684, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2833879956875625, 'psi': 0.36867172340800847}
[S10] START round=10 head_norm_before_train=1.370463 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.24964097654380085, 'auprc': 0.24964097654380085, 'loss_val': 2.755768907866032, 'psi': 0.24964097654380085}-{'f1_val': 0.33261477045908183, 'auprc': 0.33261477045908183, 'loss_val': 2.4111312146505117, 'psi': 0.33261477045908183}
[S11] START round=10 head_norm_before_train=1.449119 (no previous merge yet)
[S11] round=10 local utility u=0.069881 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0409720397008755, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1807343722228945, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.262707 (no previous merge yet)
[S13] round=10 local utility u=0.030790 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4742562484643642, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.535836064583052, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.161279 cos_to_last_merge=0.9922 (last merge round=7)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.242361875814292, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6900303200755666, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.354747 (no previous merge yet)
[S15] round=10 local utility u=0.755939 metrics={'f1_val': 0.15770941438102298, 'auprc': 0.15770941438102298, 'loss_val': 1.3786784065783484, 'psi': 0.15770941438102298}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4711715067523154, 'psi': 0.0}
[S16] START round=10 head_norm_before_train=1.413538 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.415345079640529, 'psi': 0.0}-{'f1_val': 0.00023277467411545624, 'auprc': 0.00023277467411545624, 'loss_val': 2.9460063965192815, 'psi': 0.00023277467411545624}
[S17] START round=10 head_norm_before_train=1.394849 (no previous merge yet)
[S17] round=10 local utility u=0.006270 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.25970388364495, 'psi': 0.20297157622739018}-{'f1_val': 0.20285363806572407, 'auprc': 0.20285363806572407, 'loss_val': 1.2711815655025467, 'psi': 0.20285363806572407}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:62407
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.158)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:62407
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1792) from S8
[S6] cosine check vs S8: cos=0.5947
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.0045
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] cosine check vs S2: cos=0.0360
[S17] not sending this round → trigger blocked (psi=0.203)
[S13] ⇄ pheromone p=0.134 → S9@127.0.0.1:62410
[S4] ⇄ pheromone p=0.197 → S5@127.0.0.1:62405
[S11] ⇄ pheromone p=0.156 → S9@127.0.0.1:62410
[S5] ⇄ pheromone p=0.289 → S9@127.0.0.1:62410
[S10] ⇄ pheromone p=0.275 → S4@127.0.0.1:62404
[S9] ⇄ pheromone p=0.293 → S14@127.0.0.1:62414
[S3] ⇄ pheromone p=0.222 → S2@127.0.0.1:62402
[S14] ⇄ pheromone p=0.150 → S11@127.0.0.1:62412
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.0000 head_norm=1.096264
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.488130e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.0000 head_norm=0.798938 delta_norm=0.548813
[S6] aggregate: ACCEPT kept=['S8', 'S7', 'S2'] (k=3/3) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.151 → S15@127.0.0.1:62415
[S15] ⇄ pheromone p=0.296 → S14@127.0.0.1:62414
[S7] ⇄ pheromone p=0.273 → S6@127.0.0.1:62407
[S2] ⇄ pheromone p=0.307 → S6@127.0.0.1:62407
[S8] ⇄ pheromone p=0.222 → S6@127.0.0.1:62407
[S17] ⇄ pheromone p=0.231 → S5@127.0.0.1:62405
[S16] ⇄ pheromone p=0.135 → S4@127.0.0.1:62404
[S2] START round=11 head_norm_before_train=1.420203 (no previous merge yet)
[S2] round=11 local utility u=0.105418 metrics={'f1_val': 0.2019798685633475, 'auprc': 0.2019798685633475, 'loss_val': 2.8145432025401695, 'psi': 0.2019798685633475}-{'f1_val': 0.20418968692449355, 'auprc': 0.20418968692449355, 'loss_val': 3.0452685308410348, 'psi': 0.20418968692449355}
[S3] START round=11 head_norm_before_train=1.747559 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.26177465521727816, 'auprc': 0.26177465521727816, 'loss_val': 2.6444227892405374, 'psi': 0.26177465521727816}-{'f1_val': 0.2622352557836429, 'auprc': 0.2622352557836429, 'loss_val': 2.5874072336822707, 'psi': 0.2622352557836429}
[S4] START round=11 head_norm_before_train=1.144295 cos_to_last_merge=0.9927 (last merge round=8)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3728369845359223, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3624839836533715, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.555366 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 1.7338818701978478, 'psi': 0.333168561542264}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.2242772722374935, 'psi': 0.33358943696313936}
[S6] START round=11 head_norm_before_train=0.798938 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.452816 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2497181685360164, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1553508393345493, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.485038 (no previous merge yet)
[S7] round=11 local utility u=0.701764 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.255491991057712, 'psi': 0.35976373724718097}-{'f1_val': 0.21009636862594935, 'auprc': 0.21009636862594935, 'loss_val': 1.3120135811415856, 'psi': 0.21009636862594935}
[S8] START round=11 head_norm_before_train=1.350939 (no previous merge yet)
[S8] round=11 local utility u=0.006806 metrics={'f1_val': 0.2034924930730073, 'auprc': 0.2034924930730073, 'loss_val': 1.2310333840593948, 'psi': 0.2034924930730073}-{'f1_val': 0.20384714691453654, 'auprc': 0.20384714691453654, 'loss_val': 1.2478363276190527, 'psi': 0.20384714691453654}
[S9] START round=11 head_norm_before_train=1.721605 (no previous merge yet)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5070363258119395, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.404472380659684, 'psi': 0.36867172340800847}
[S10] START round=11 head_norm_before_train=1.402603 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.24934100167745027, 'auprc': 0.24934100167745027, 'loss_val': 3.023552525235892, 'psi': 0.24934100167745027}-{'f1_val': 0.24964097654380085, 'auprc': 0.24964097654380085, 'loss_val': 2.755768907866032, 'psi': 0.24964097654380085}
[S11] START round=11 head_norm_before_train=1.483121 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0574570394267386, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0409720397008755, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.278311 (no previous merge yet)
[S13] round=11 local utility u=0.043191 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.387874161315667, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4742562484643642, 'psi': 0.0}
[S14] START round=11 head_norm_before_train=1.202865 cos_to_last_merge=0.9841 (last merge round=7)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.460484339595184, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.242361875814292, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.383379 (no previous merge yet)
[S15] round=11 local utility u=0.821688 metrics={'f1_val': 0.3324931737030036, 'auprc': 0.3324931737030036, 'loss_val': 1.3083570639284354, 'psi': 0.3324931737030036}-{'f1_val': 0.15770941438102298, 'auprc': 0.15770941438102298, 'loss_val': 1.3786784065783484, 'psi': 0.15770941438102298}
[S16] START round=11 head_norm_before_train=1.440049 (no previous merge yet)
[S16] round=11 local utility u=0.294463 metrics={'f1_val': 0.043209876543209874, 'auprc': 0.043209876543209874, 'loss_val': 3.2153071331611045, 'psi': 0.043209876543209874}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.415345079640529, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.423839 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.2447430821821648, 'psi': 0.15231723870467326}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.25970388364495, 'psi': 0.20297157622739018}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.360)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.202)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.203)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[S16] not sending this round → trigger blocked (psi=0.043)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0276
[S14] DROPPED delta from S15 (cos=-0.0276 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=12 head_norm_before_train=1.455086 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.21656291265798908, 'auprc': 0.21656291265798908, 'loss_val': 3.067329974209029, 'psi': 0.21656291265798905}-{'f1_val': 0.2019798685633475, 'auprc': 0.2019798685633475, 'loss_val': 2.8145432025401695, 'psi': 0.2019798685633475}
[S3] START round=12 head_norm_before_train=1.785793 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.2810841017043867, 'auprc': 0.2810841017043867, 'loss_val': 2.832278113055297, 'psi': 0.2810841017043867}-{'f1_val': 0.26177465521727816, 'auprc': 0.26177465521727816, 'loss_val': 2.6444227892405374, 'psi': 0.26177465521727816}
[S4] START round=12 head_norm_before_train=1.190062 cos_to_last_merge=0.9844 (last merge round=8)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3754294750696636, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3728369845359223, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.606681 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.2887318674074026, 'psi': 0.333168561542264}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 1.7338818701978478, 'psi': 0.333168561542264}
[S6] START round=12 head_norm_before_train=0.844144 cos_to_last_merge=0.9959 (last merge round=10)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7017106514900617, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2497181685360164, 'psi': 0.0}
[S7] START round=12 head_norm_before_train=1.505536 (no previous merge yet)
[S7] round=12 local utility u=0.012891 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2297091790729164, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.255491991057712, 'psi': 0.35976373724718097}
[S8] START round=12 head_norm_before_train=1.380477 (no previous merge yet)
[S8] round=12 local utility u=0.015410 metrics={'f1_val': 0.20353183810260378, 'auprc': 0.20353183810260378, 'loss_val': 1.2005681401083619, 'psi': 0.20353183810260378}-{'f1_val': 0.2034924930730073, 'auprc': 0.2034924930730073, 'loss_val': 1.2310333840593948, 'psi': 0.2034924930730073}
[S9] START round=12 head_norm_before_train=1.745529 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5858643101007033, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5070363258119395, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=1.434089 (no previous merge yet)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.24940105414470531, 'auprc': 0.24940105414470531, 'loss_val': 3.117749271584443, 'psi': 0.24940105414470531}-{'f1_val': 0.24934100167745027, 'auprc': 0.24934100167745027, 'loss_val': 3.023552525235892, 'psi': 0.24934100167745027}
[S11] START round=12 head_norm_before_train=1.519174 (no previous merge yet)
[S11] round=12 local utility u=1.000000 metrics={'f1_val': 0.33247803436746753, 'auprc': 0.33247803436746753, 'loss_val': 1.843092693422735, 'psi': 0.33247803436746753}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0574570394267386, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.296308 (no previous merge yet)
[S13] round=12 local utility u=1.000000 metrics={'f1_val': 0.24011743734927127, 'auprc': 0.24011743734927127, 'loss_val': 1.3030494571333031, 'psi': 0.24011743734927127}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.387874161315667, 'psi': 0.0}
[S14] START round=12 head_norm_before_train=1.239302 cos_to_last_merge=0.9750 (last merge round=7)
[S14] round=12 local utility u=0.149370 metrics={'f1_val': 0.04354354354354354, 'auprc': 0.04354354354354354, 'loss_val': 4.553635326410404, 'psi': 0.04354354354354354}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.460484339595184, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.415114 (no previous merge yet)
[S15] round=12 local utility u=0.024782 metrics={'f1_val': 0.33270281630937365, 'auprc': 0.33270281630937365, 'loss_val': 1.2606789363662503, 'psi': 0.33270281630937365}-{'f1_val': 0.3324931737030036, 'auprc': 0.3324931737030036, 'loss_val': 1.3083570639284354, 'psi': 0.3324931737030036}
[S16] START round=12 head_norm_before_train=1.465818 (no previous merge yet)
[S16] round=12 local utility u=0.168015 metrics={'f1_val': 0.0902844359220198, 'auprc': 0.0902844359220198, 'loss_val': 3.3029473524319193, 'psi': 0.0902844359220198}-{'f1_val': 0.043209876543209874, 'auprc': 0.043209876543209874, 'loss_val': 3.2153071331611045, 'psi': 0.043209876543209874}
[S17] START round=12 head_norm_before_train=1.449034 (no previous merge yet)
[S17] round=12 local utility u=0.021519 metrics={'f1_val': 0.15216970166602092, 'auprc': 0.15216970166602092, 'loss_val': 1.2003762963324551, 'psi': 0.15216970166602092}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.2447430821821648, 'psi': 0.15231723870467326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:62414
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:62407
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.044)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:62410
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:62410
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] cosine check vs S7: cos=0.2561
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=-0.0204
[S14] DROPPED delta from S15 (cos=-0.0204 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=0.6422
[S9] RECEIVED delta(kind=head bytes=1797) from S13
[S9] cosine check vs S13: cos=0.0063
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] cosine check vs S11: cos=-0.0267
[S9] DROPPED delta from S11 (cos=-0.0267 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=-0.1076
[S5] DROPPED delta from S17 (cos=-0.1076 < 0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.0000 head_norm=0.905004
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.257225e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.0000 head_norm=0.876411 delta_norm=0.425722
[S6] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.3687 head_norm=1.765747
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.097585e+00
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.3687 head_norm=1.104272 delta_norm=1.097585
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.488908 (no previous merge yet)
[S2] round=13 local utility u=0.202032 metrics={'f1_val': 0.23243823845327605, 'auprc': 0.23243823845327605, 'loss_val': 2.806143795018593, 'psi': 0.23243823845327605}-{'f1_val': 0.21656291265798908, 'auprc': 0.21656291265798908, 'loss_val': 3.067329974209029, 'psi': 0.21656291265798905}
[S3] START round=13 head_norm_before_train=1.807869 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.2789214666943925, 'auprc': 0.2789214666943925, 'loss_val': 2.8184534107840746, 'psi': 0.2789214666943925}-{'f1_val': 0.2810841017043867, 'auprc': 0.2810841017043867, 'loss_val': 2.832278113055297, 'psi': 0.2810841017043867}
[S4] START round=13 head_norm_before_train=1.234140 cos_to_last_merge=0.9753 (last merge round=8)
[S4] round=13 local utility u=0.005230 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3649697857847027, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3754294750696636, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.649493 (no previous merge yet)
[S5] round=13 local utility u=0.075036 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1379196384968435, 'psi': 0.33308623671855697}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.2887318674074026, 'psi': 0.333168561542264}
[S6] START round=13 head_norm_before_train=0.876411 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.166850 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3680107624281064, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7017106514900617, 'psi': 0.0}
[S7] START round=13 head_norm_before_train=1.530371 (no previous merge yet)
[S7] round=13 local utility u=0.013460 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2027900967038867, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2297091790729164, 'psi': 0.35976373724718097}
[S8] START round=13 head_norm_before_train=1.409015 (no previous merge yet)
[S8] round=13 local utility u=0.040146 metrics={'f1_val': 0.20372879169085867, 'auprc': 0.20372879169085867, 'loss_val': 1.1220488496271217, 'psi': 0.20372879169085867}-{'f1_val': 0.20353183810260378, 'auprc': 0.20353183810260378, 'loss_val': 1.2005681401083619, 'psi': 0.20353183810260378}
[S9] START round=13 head_norm_before_train=1.104272 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.417402 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7510612765666254, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5858643101007033, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=1.467262 (no previous merge yet)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.24636893803809043, 'auprc': 0.24636893803809043, 'loss_val': 3.137302598731928, 'psi': 0.2463689380380904}-{'f1_val': 0.24940105414470531, 'auprc': 0.24940105414470531, 'loss_val': 3.117749271584443, 'psi': 0.24940105414470531}
[S11] START round=13 head_norm_before_train=1.553747 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.2941742236878263, 'auprc': 0.2941742236878263, 'loss_val': 1.771292108699057, 'psi': 0.2941742236878263}-{'f1_val': 0.33247803436746753, 'auprc': 0.33247803436746753, 'loss_val': 1.843092693422735, 'psi': 0.33247803436746753}
[S13] START round=13 head_norm_before_train=1.315431 (no previous merge yet)
[S13] round=13 local utility u=0.351666 metrics={'f1_val': 0.3113207547169811, 'auprc': 0.3113207547169811, 'loss_val': 1.240547686308656, 'psi': 0.3113207547169811}-{'f1_val': 0.24011743734927127, 'auprc': 0.24011743734927127, 'loss_val': 1.3030494571333031, 'psi': 0.24011743734927127}
[S14] START round=13 head_norm_before_train=1.273882 cos_to_last_merge=0.9664 (last merge round=7)
[S14] round=13 local utility u=0.094113 metrics={'f1_val': 0.08019842910293509, 'auprc': 0.08019842910293509, 'loss_val': 4.695304145436809, 'psi': 0.08019842910293509}-{'f1_val': 0.04354354354354354, 'auprc': 0.04354354354354354, 'loss_val': 4.553635326410404, 'psi': 0.04354354354354354}
[S15] START round=13 head_norm_before_train=1.447924 (no previous merge yet)
[S15] round=13 local utility u=0.013188 metrics={'f1_val': 0.33301777637530244, 'auprc': 0.33301777637530244, 'loss_val': 1.237137420252431, 'psi': 0.33301777637530244}-{'f1_val': 0.33270281630937365, 'auprc': 0.33270281630937365, 'loss_val': 1.2606789363662503, 'psi': 0.33270281630937365}
[S16] START round=13 head_norm_before_train=1.492785 (no previous merge yet)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.0744208969935929, 'auprc': 0.0744208969935929, 'loss_val': 3.6893060047414403, 'psi': 0.0744208969935929}-{'f1_val': 0.0902844359220198, 'auprc': 0.0902844359220198, 'loss_val': 3.3029473524319193, 'psi': 0.0902844359220198}
[S17] START round=13 head_norm_before_train=1.473277 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2250878842399813, 'psi': 0.15234678044996122}-{'f1_val': 0.15216970166602092, 'auprc': 0.15216970166602092, 'loss_val': 1.2003762963324551, 'psi': 0.15216970166602092}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:62410
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:62414
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[S14] not sending this round → trigger blocked (psi=0.080)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:62407
[S7] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=0.1616
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=-0.0143
[S14] DROPPED delta from S15 (cos=-0.0143 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=0.5314
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] cosine check vs S5: cos=-0.0156
[S9] DROPPED delta from S5 (cos=-0.0156 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] cosine check vs S13: cos=0.5645
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.7044
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] cosine check vs S7: cos=0.5455
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.0802 head_norm=1.309550
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.045928e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.0773 head_norm=1.088447 delta_norm=0.604593
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.0000 head_norm=0.924686
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.784317e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.0000 head_norm=0.856052 delta_norm=0.278432
[S6] aggregate: ACCEPT kept=['S2', 'S8', 'S7'] (k=3/3) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.3687 head_norm=1.177105
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.918136e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.3687 head_norm=1.113936 delta_norm=0.591814
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.518502 (no previous merge yet)
[S2] round=14 local utility u=0.183932 metrics={'f1_val': 0.2577127830158425, 'auprc': 0.2577127830158425, 'loss_val': 2.6657509516316225, 'psi': 0.2577127830158425}-{'f1_val': 0.23243823845327605, 'auprc': 0.23243823845327605, 'loss_val': 2.806143795018593, 'psi': 0.23243823845327605}
[S3] START round=14 head_norm_before_train=1.824513 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.2717450027012426, 'auprc': 0.2717450027012426, 'loss_val': 2.8018873842530323, 'psi': 0.2717450027012426}-{'f1_val': 0.2789214666943925, 'auprc': 0.2789214666943925, 'loss_val': 2.8184534107840746, 'psi': 0.2789214666943925}
[S4] START round=14 head_norm_before_train=1.278821 cos_to_last_merge=0.9661 (last merge round=8)
[S4] round=14 local utility u=0.002427 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.360116083618318, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3649697857847027, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.687634 (no previous merge yet)
[S5] round=14 local utility u=0.054873 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.028173792516258, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1379196384968435, 'psi': 0.33308623671855697}
[S6] START round=14 head_norm_before_train=0.856052 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.028454 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.311102046527756, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3680107624281064, 'psi': 0.0}
[S7] START round=14 head_norm_before_train=1.570136 (no previous merge yet)
[S7] round=14 local utility u=0.021658 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1594737684684024, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2027900967038867, 'psi': 0.35976373724718097}
[S8] START round=14 head_norm_before_train=1.437101 (no previous merge yet)
[S8] round=14 local utility u=0.504529 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0249875399161201, 'psi': 0.30506182380216385}-{'f1_val': 0.20372879169085867, 'auprc': 0.20372879169085867, 'loss_val': 1.1220488496271217, 'psi': 0.20372879169085867}
[S9] START round=14 head_norm_before_train=1.113936 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.24526080301424702, 'auprc': 0.24526080301424702, 'loss_val': 1.5382916239288402, 'psi': 0.24526080301424702}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7510612765666254, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.498884 (no previous merge yet)
[S10] round=14 local utility u=0.056814 metrics={'f1_val': 0.2498951093749812, 'auprc': 0.2498951093749812, 'loss_val': 3.0554093106070046, 'psi': 0.2498951093749812}-{'f1_val': 0.24636893803809043, 'auprc': 0.24636893803809043, 'loss_val': 3.137302598731928, 'psi': 0.2463689380380904}
[S11] START round=14 head_norm_before_train=1.585007 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.2795951681358146, 'auprc': 0.2795951681358146, 'loss_val': 1.7861335728024632, 'psi': 0.2795951681358146}-{'f1_val': 0.2941742236878263, 'auprc': 0.2941742236878263, 'loss_val': 1.771292108699057, 'psi': 0.2941742236878263}
[S13] START round=14 head_norm_before_train=1.340380 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.25893312914752425, 'auprc': 0.25893312914752425, 'loss_val': 1.1822337381046168, 'psi': 0.25893312914752425}-{'f1_val': 0.3113207547169811, 'auprc': 0.3113207547169811, 'loss_val': 1.240547686308656, 'psi': 0.3113207547169811}
[S14] START round=14 head_norm_before_train=1.088447 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.895242 metrics={'f1_val': 0.10459587955625992, 'auprc': 0.10459587955625992, 'loss_val': 3.1243968788588736, 'psi': 0.10459587955625993}-{'f1_val': 0.08019842910293509, 'auprc': 0.08019842910293509, 'loss_val': 4.695304145436809, 'psi': 0.08019842910293509}
[S15] START round=14 head_norm_before_train=1.477805 (no previous merge yet)
[S15] round=14 local utility u=0.016892 metrics={'f1_val': 0.3331226295828066, 'auprc': 0.3331226295828066, 'loss_val': 1.2042961811684805, 'psi': 0.3331226295828066}-{'f1_val': 0.33301777637530244, 'auprc': 0.33301777637530244, 'loss_val': 1.237137420252431, 'psi': 0.33301777637530244}
[S16] START round=14 head_norm_before_train=1.521802 (no previous merge yet)
[S16] round=14 local utility u=0.022984 metrics={'f1_val': 0.09042255771227735, 'auprc': 0.09042255771227735, 'loss_val': 3.787353829983775, 'psi': 0.09042255771227735}-{'f1_val': 0.0744208969935929, 'auprc': 0.0744208969935929, 'loss_val': 3.6893060047414403, 'psi': 0.0744208969935929}
[S17] START round=14 head_norm_before_train=1.498833 (no previous merge yet)
[S17] round=14 local utility u=0.012027 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.2007677896054092, 'psi': 0.15231723870467326}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2250878842399813, 'psi': 0.15234678044996122}
[S14] not sending this round → trigger blocked (psi=0.105)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:62404
[S6] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[S4] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=0.3779
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=0.6010
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.0101
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.0113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S17
[S5] cosine check vs S17: cos=-0.1090
[S5] DROPPED delta from S17 (cos=-0.1090 < 0.0)
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.6668
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=0.5565
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.0000 head_norm=0.902352
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.812161e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.0000 head_norm=0.879224 delta_norm=0.181216
[S6] aggregate: ACCEPT kept=['S2', 'S8', 'S7'] (k=3/3) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.2453 head_norm=1.212411
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.048545e+00
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.1790 head_norm=1.059785 delta_norm=1.048545
[S9] aggregate: ROLLBACK (f1_val pre=0.245 post=0.179 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.0000 head_norm=1.323292
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.430230e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.275945 delta_norm=0.643023
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.1046 head_norm=1.120214
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.351671e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.1239 head_norm=0.944214 delta_norm=0.935167
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.546834 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.2509524701767535, 'auprc': 0.2509524701767535, 'loss_val': 2.6303489527474397, 'psi': 0.2509524701767535}-{'f1_val': 0.2577127830158425, 'auprc': 0.2577127830158425, 'loss_val': 2.6657509516316225, 'psi': 0.2577127830158425}
[S3] START round=15 head_norm_before_train=1.843789 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.2618768710139268, 'auprc': 0.2618768710139268, 'loss_val': 2.8262222345217314, 'psi': 0.2618768710139268}-{'f1_val': 0.2717450027012426, 'auprc': 0.2717450027012426, 'loss_val': 2.8018873842530323, 'psi': 0.2717450027012426}
[S4] START round=15 head_norm_before_train=1.275945 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.372333066634617, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.360116083618318, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.724889 (no previous merge yet)
[S5] round=15 local utility u=0.022537 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9830999077391824, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.028173792516258, 'psi': 0.33308623671855697}
[S6] START round=15 head_norm_before_train=0.879224 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.321253935620468, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.311102046527756, 'psi': 0.0}
[S7] START round=15 head_norm_before_train=1.599311 (no previous merge yet)
[S7] round=15 local utility u=0.005000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1494733141007816, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1594737684684024, 'psi': 0.35976373724718097}
[S8] START round=15 head_norm_before_train=1.469675 (no previous merge yet)
[S8] round=15 local utility u=0.055266 metrics={'f1_val': 0.30672315326611654, 'auprc': 0.30672315326611654, 'loss_val': 0.9294076271469883, 'psi': 0.30672315326611654}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0249875399161201, 'psi': 0.30506182380216385}
[S9] START round=15 head_norm_before_train=1.059785 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.030289 metrics={'f1_val': 0.245409604519774, 'auprc': 0.245409604519774, 'loss_val': 1.479053216454428, 'psi': 0.245409604519774}-{'f1_val': 0.24526080301424702, 'auprc': 0.24526080301424702, 'loss_val': 1.5382916239288402, 'psi': 0.24526080301424702}
[S10] START round=15 head_norm_before_train=1.527064 (no previous merge yet)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.21661478308023996, 'auprc': 0.21661478308023996, 'loss_val': 3.0376021394746253, 'psi': 0.21661478308023996}-{'f1_val': 0.2498951093749812, 'auprc': 0.2498951093749812, 'loss_val': 3.0554093106070046, 'psi': 0.2498951093749812}
[S11] START round=15 head_norm_before_train=1.611200 (no previous merge yet)
[S11] round=15 local utility u=0.491128 metrics={'f1_val': 0.3720243266724587, 'auprc': 0.3720243266724587, 'loss_val': 1.6357398872469062, 'psi': 0.3720243266724587}-{'f1_val': 0.2795951681358146, 'auprc': 0.2795951681358146, 'loss_val': 1.7861335728024632, 'psi': 0.2795951681358146}
[S13] START round=15 head_norm_before_train=1.373637 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.24004248539564524, 'auprc': 0.24004248539564524, 'loss_val': 1.1398424277758568, 'psi': 0.24004248539564524}-{'f1_val': 0.25893312914752425, 'auprc': 0.25893312914752425, 'loss_val': 1.1822337381046168, 'psi': 0.25893312914752425}
[S14] START round=15 head_norm_before_train=0.944214 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.618765 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 2.1683910635552284, 'psi': 0.13587634006482174}-{'f1_val': 0.10459587955625992, 'auprc': 0.10459587955625992, 'loss_val': 3.1243968788588736, 'psi': 0.10459587955625993}
[S15] START round=15 head_norm_before_train=1.509065 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.2845763939174511, 'auprc': 0.2845763939174511, 'loss_val': 1.163247100296637, 'psi': 0.2845763939174511}-{'f1_val': 0.3331226295828066, 'auprc': 0.3331226295828066, 'loss_val': 1.2042961811684805, 'psi': 0.3331226295828066}
[S16] START round=15 head_norm_before_train=1.551331 (no previous merge yet)
[S16] round=15 local utility u=0.126045 metrics={'f1_val': 0.11323360184119678, 'auprc': 0.11323360184119678, 'loss_val': 3.740563793017962, 'psi': 0.11323360184119678}-{'f1_val': 0.09042255771227735, 'auprc': 0.09042255771227735, 'loss_val': 3.787353829983775, 'psi': 0.09042255771227735}
[S17] START round=15 head_norm_before_train=1.522456 (no previous merge yet)
[S17] round=15 local utility u=0.009947 metrics={'f1_val': 0.15299961044020258, 'auprc': 0.15299961044020258, 'loss_val': 1.1870149138443367, 'psi': 0.15299961044020258}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.2007677896054092, 'psi': 0.15231723870467326}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.113)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S11] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=0.5519
[S6] RECEIVED delta(kind=head bytes=1793) from S8
[S6] cosine check vs S8: cos=0.6321
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.1321
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.7376
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.3405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=-0.1097
[S5] DROPPED delta from S17 (cos=-0.1097 < 0.0)
[S2] ⇄ pheromone p=0.165 → S6@127.0.0.1:62407
[S4] ⇄ pheromone p=0.066 → S5@127.0.0.1:62405
[S5] ⇄ pheromone p=0.118 → S9@127.0.0.1:62410
[S3] ⇄ pheromone p=0.073 → S2@127.0.0.1:62402
[S8] ⇄ pheromone p=0.172 → S6@127.0.0.1:62407
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.0000 head_norm=0.924787
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.052801e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.0131 head_norm=0.972840 delta_norm=0.305280
[S6] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.113 → S15@127.0.0.1:62415
[S7] ⇄ pheromone p=0.155 → S6@127.0.0.1:62407
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.2454 head_norm=1.155792
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.646540e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.2453 head_norm=1.092541 delta_norm=0.564654
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.156 → S14@127.0.0.1:62414
[S10] ⇄ pheromone p=0.099 → S4@127.0.0.1:62404
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.1359 head_norm=0.979294
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.172761e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.1007 head_norm=0.875446 delta_norm=0.617276
[S14] aggregate: ROLLBACK (f1_val pre=0.136 post=0.101 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.344 → S11@127.0.0.1:62412
[S15] ⇄ pheromone p=0.171 → S14@127.0.0.1:62414
[S16] ⇄ pheromone p=0.114 → S4@127.0.0.1:62404
[S17] ⇄ pheromone p=0.082 → S5@127.0.0.1:62405
[S13] ⇄ pheromone p=0.195 → S9@127.0.0.1:62410
[S11] ⇄ pheromone p=0.252 → S9@127.0.0.1:62410
[S2] START round=16 head_norm_before_train=1.574238 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.251234915275433, 'auprc': 0.251234915275433, 'loss_val': 2.675347878367592, 'psi': 0.251234915275433}-{'f1_val': 0.2509524701767535, 'auprc': 0.2509524701767535, 'loss_val': 2.6303489527474397, 'psi': 0.2509524701767535}
[S3] START round=16 head_norm_before_train=1.864763 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.2650856389986825, 'auprc': 0.2650856389986825, 'loss_val': 2.876086897519716, 'psi': 0.2650856389986825}-{'f1_val': 0.2618768710139268, 'auprc': 0.2618768710139268, 'loss_val': 2.8262222345217314, 'psi': 0.2618768710139268}
[S4] START round=16 head_norm_before_train=1.315565 cos_to_last_merge=0.9978 (last merge round=14)
[S4] round=16 local utility u=0.005598 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.361136112428734, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.372333066634617, 'psi': 0.0}
[S5] START round=16 head_norm_before_train=1.759458 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.390007392279762, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9830999077391824, 'psi': 0.33308623671855697}
[S6] START round=16 head_norm_before_train=0.972840 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.003603 metrics={'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 2.4659895859738254, 'psi': 0.016882516188714152}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.321253935620468, 'psi': 0.0}
[S7] START round=16 head_norm_before_train=1.616022 (no previous merge yet)
[S7] round=16 local utility u=0.012551 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1243709542628995, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1494733141007816, 'psi': 0.35976373724718097}
[S8] START round=16 head_norm_before_train=1.508141 (no previous merge yet)
[S8] round=16 local utility u=0.435583 metrics={'f1_val': 0.396500985846372, 'auprc': 0.396500985846372, 'loss_val': 0.8662417392155034, 'psi': 0.396500985846372}-{'f1_val': 0.30672315326611654, 'auprc': 0.30672315326611654, 'loss_val': 0.9294076271469883, 'psi': 0.30672315326611654}
[S9] START round=16 head_norm_before_train=1.092541 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.602955 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3825025263530957, 'psi': 0.36867172340800847}-{'f1_val': 0.245409604519774, 'auprc': 0.245409604519774, 'loss_val': 1.479053216454428, 'psi': 0.245409604519774}
[S10] START round=16 head_norm_before_train=1.553687 (no previous merge yet)
[S10] round=16 local utility u=0.195475 metrics={'f1_val': 0.24952130205840115, 'auprc': 0.24952130205840115, 'loss_val': 2.9428112175065393, 'psi': 0.24952130205840112}-{'f1_val': 0.21661478308023996, 'auprc': 0.21661478308023996, 'loss_val': 3.0376021394746253, 'psi': 0.21661478308023996}
[S11] START round=16 head_norm_before_train=1.636050 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.2561617611868868, 'auprc': 0.2561617611868868, 'loss_val': 1.7743267113986343, 'psi': 0.2561617611868868}-{'f1_val': 0.3720243266724587, 'auprc': 0.3720243266724587, 'loss_val': 1.6357398872469062, 'psi': 0.3720243266724587}
[S13] START round=16 head_norm_before_train=1.409995 (no previous merge yet)
[S13] round=16 local utility u=0.530796 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1572951138315986, 'psi': 0.3599362944611573}-{'f1_val': 0.24004248539564524, 'auprc': 0.24004248539564524, 'loss_val': 1.1398424277758568, 'psi': 0.24004248539564524}
[S14] START round=16 head_norm_before_train=0.875446 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.08903365906623235, 'auprc': 0.08903365906623235, 'loss_val': 2.3785911312454795, 'psi': 0.08903365906623235}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 2.1683910635552284, 'psi': 0.13587634006482174}
[S15] START round=16 head_norm_before_train=1.533823 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.2612370341913177, 'auprc': 0.2612370341913177, 'loss_val': 1.206096176806449, 'psi': 0.2612370341913177}-{'f1_val': 0.2845763939174511, 'auprc': 0.2845763939174511, 'loss_val': 1.163247100296637, 'psi': 0.2845763939174511}
[S16] START round=16 head_norm_before_train=1.578314 (no previous merge yet)
[S16] round=16 local utility u=0.163761 metrics={'f1_val': 0.13630348478164975, 'auprc': 0.13630348478164975, 'loss_val': 3.620670633758469, 'psi': 0.13630348478164975}-{'f1_val': 0.11323360184119678, 'auprc': 0.11323360184119678, 'loss_val': 3.740563793017962, 'psi': 0.11323360184119678}
[S17] START round=16 head_norm_before_train=1.550005 (no previous merge yet)
[S17] round=16 local utility u=0.036539 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.1080610282982972, 'psi': 0.15234678044996122}-{'f1_val': 0.15299961044020258, 'auprc': 0.15299961044020258, 'loss_val': 1.1870149138443367, 'psi': 0.15299961044020258}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[S16] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:62414
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:62407
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.017)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.6755
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.6628
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.3029
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.8598
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=-0.1099
[S5] DROPPED delta from S17 (cos=-0.1099 < 0.0)
[S9] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.7236
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.0169 head_norm=1.019707
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.873423e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.0423 head_norm=1.058867 delta_norm=0.187342
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.0000 head_norm=1.366524
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.025326e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.0000 head_norm=1.419270 delta_norm=0.402533
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.3687 head_norm=1.176440
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.808502e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.3687 head_norm=1.060215 delta_norm=0.780850
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.0890 head_norm=0.916701
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.073151e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.1046 head_norm=0.972764 delta_norm=0.407315
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.601617 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.2521335341365462, 'auprc': 0.2521335341365462, 'loss_val': 2.719650914025539, 'psi': 0.2521335341365462}-{'f1_val': 0.251234915275433, 'auprc': 0.251234915275433, 'loss_val': 2.675347878367592, 'psi': 0.251234915275433}
[S3] START round=17 head_norm_before_train=1.885091 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.26116303219106957, 'auprc': 0.26116303219106957, 'loss_val': 2.875647354286666, 'psi': 0.26116303219106957}-{'f1_val': 0.2650856389986825, 'auprc': 0.2650856389986825, 'loss_val': 2.876086897519716, 'psi': 0.2650856389986825}
[S4] START round=17 head_norm_before_train=1.419270 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.003518 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3541004315940788, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.361136112428734, 'psi': 0.0}
[S5] START round=17 head_norm_before_train=1.784291 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.710845302514573, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.390007392279762, 'psi': 0.33308623671855697}
[S6] START round=17 head_norm_before_train=1.058867 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 2.627385606122253, 'psi': 0.021967963386727688}-{'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 2.4659895859738254, 'psi': 0.016882516188714152}
[S7] START round=17 head_norm_before_train=1.635789 (no previous merge yet)
[S7] round=17 local utility u=0.006124 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.112122051525781, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1243709542628995, 'psi': 0.35976373724718097}
[S8] START round=17 head_norm_before_train=1.548572 (no previous merge yet)
[S8] round=17 local utility u=1.000000 metrics={'f1_val': 0.9336264948820003, 'auprc': 0.9336264948820003, 'loss_val': 0.8206186470140245, 'psi': 0.9336264948820003}-{'f1_val': 0.396500985846372, 'auprc': 0.396500985846372, 'loss_val': 0.8662417392155034, 'psi': 0.396500985846372}
[S9] START round=17 head_norm_before_train=1.060215 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.462626166945756, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3825025263530957, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.576493 (no previous merge yet)
[S10] round=17 local utility u=0.040545 metrics={'f1_val': 0.2498963032815705, 'auprc': 0.2498963032815705, 'loss_val': 2.8650964381878343, 'psi': 0.24989630328157053}-{'f1_val': 0.24952130205840115, 'auprc': 0.24952130205840115, 'loss_val': 2.9428112175065393, 'psi': 0.24952130205840112}
[S11] START round=17 head_norm_before_train=1.657740 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.2806948541461816, 'auprc': 0.2806948541461816, 'loss_val': 2.0757696294307615, 'psi': 0.2806948541461816}-{'f1_val': 0.2561617611868868, 'auprc': 0.2561617611868868, 'loss_val': 1.7743267113986343, 'psi': 0.2561617611868868}
[S13] START round=17 head_norm_before_train=1.443452 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1729314028298834, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1572951138315986, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=0.972764 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.019955 metrics={'f1_val': 0.08405201916495551, 'auprc': 0.08405201916495551, 'loss_val': 2.293846553755718, 'psi': 0.08405201916495551}-{'f1_val': 0.08903365906623235, 'auprc': 0.08903365906623235, 'loss_val': 2.3785911312454795, 'psi': 0.08903365906623235}
[S15] START round=17 head_norm_before_train=1.552498 (no previous merge yet)
[S15] round=17 local utility u=0.170320 metrics={'f1_val': 0.28346647300895667, 'auprc': 0.28346647300895667, 'loss_val': 1.0655203741367756, 'psi': 0.28346647300895667}-{'f1_val': 0.2612370341913177, 'auprc': 0.2612370341913177, 'loss_val': 1.206096176806449, 'psi': 0.2612370341913177}
[S16] START round=17 head_norm_before_train=1.602281 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.015579710144927537, 'auprc': 0.015579710144927537, 'loss_val': 4.656360389612334, 'psi': 0.015579710144927537}-{'f1_val': 0.13630348478164975, 'auprc': 0.13630348478164975, 'loss_val': 3.620670633758469, 'psi': 0.13630348478164975}
[S17] START round=17 head_norm_before_train=1.576068 (no previous merge yet)
[S17] round=17 local utility u=0.038850 metrics={'f1_val': 0.15219918620422399, 'auprc': 0.15219918620422399, 'loss_val': 1.0290318401382548, 'psi': 0.15219918620422399}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.1080610282982972, 'psi': 0.15234678044996122}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:62407
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:62407
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[S14] not sending this round → trigger blocked (psi=0.084)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1806) from S10
[S4] cosine check vs S10: cos=0.9528
[S6] RECEIVED delta(kind=head bytes=1804) from S7
[S6] cosine check vs S7: cos=0.6938
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=0.6817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S17
[S5] cosine check vs S17: cos=-0.1102
[S5] DROPPED delta from S17 (cos=-0.1102 < 0.0)
[S15] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.2512
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.0000 head_norm=1.457037
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.459236e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.0000 head_norm=1.512057 delta_norm=0.245924
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.0220 head_norm=1.105463
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.387193e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.0482 head_norm=1.120160 delta_norm=0.138719
[S6] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.0841 head_norm=1.010295
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.197131e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.1198 head_norm=1.034507 delta_norm=0.819713
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.626999 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.25628268911851, 'auprc': 0.25628268911851, 'loss_val': 2.7584037169899123, 'psi': 0.25628268911851}-{'f1_val': 0.2521335341365462, 'auprc': 0.2521335341365462, 'loss_val': 2.719650914025539, 'psi': 0.2521335341365462}
[S3] START round=18 head_norm_before_train=1.904017 (no previous merge yet)
[S3] round=18 local utility u=0.067166 metrics={'f1_val': 0.29836725564750616, 'auprc': 0.29836725564750616, 'loss_val': 3.0761543034781105, 'psi': 0.29836725564750616}-{'f1_val': 0.26116303219106957, 'auprc': 0.26116303219106957, 'loss_val': 2.875647354286666, 'psi': 0.26116303219106957}
[S4] START round=18 head_norm_before_train=1.512057 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.008215 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3376704950294473, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3541004315940788, 'psi': 0.0}
[S5] START round=18 head_norm_before_train=1.807328 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.7480211790468503, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.710845302514573, 'psi': 0.33308623671855697}
[S6] START round=18 head_norm_before_train=1.120160 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.317248 metrics={'f1_val': 0.10148798168637925, 'auprc': 0.10148798168637925, 'loss_val': 2.708570397675893, 'psi': 0.10148798168637925}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 2.627385606122253, 'psi': 0.021967963386727688}
[S7] START round=18 head_norm_before_train=1.662510 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1150026864354636, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.112122051525781, 'psi': 0.35976373724718097}
[S8] START round=18 head_norm_before_train=1.587046 (no previous merge yet)
[S8] round=18 local utility u=0.312504 metrics={'f1_val': 0.9997177674455537, 'auprc': 0.9997177674455537, 'loss_val': 0.7904318592009668, 'psi': 0.9997177674455537}-{'f1_val': 0.9336264948820003, 'auprc': 0.9336264948820003, 'loss_val': 0.8206186470140245, 'psi': 0.9336264948820003}
[S9] START round=18 head_norm_before_train=1.167054 cos_to_last_merge=0.9813 (last merge round=16)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6587854946971459, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.462626166945756, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.603320 (no previous merge yet)
[S10] round=18 local utility u=0.054767 metrics={'f1_val': 0.24970131421744324, 'auprc': 0.24970131421744324, 'loss_val': 2.7538076909863145, 'psi': 0.24970131421744324}-{'f1_val': 0.2498963032815705, 'auprc': 0.2498963032815705, 'loss_val': 2.8650964381878343, 'psi': 0.24989630328157053}
[S11] START round=18 head_norm_before_train=1.680255 (no previous merge yet)
[S11] round=18 local utility u=0.024460 metrics={'f1_val': 0.27699074972507925, 'auprc': 0.27699074972507925, 'loss_val': 1.993513305552893, 'psi': 0.27699074972507925}-{'f1_val': 0.2806948541461816, 'auprc': 0.2806948541461816, 'loss_val': 2.0757696294307615, 'psi': 0.2806948541461816}
[S13] START round=18 head_norm_before_train=1.468651 (no previous merge yet)
[S13] round=18 local utility u=0.003444 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1660434532077313, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1729314028298834, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.034507 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.288122 metrics={'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 2.164741653348776, 'psi': 0.13373403456048086}-{'f1_val': 0.08405201916495551, 'auprc': 0.08405201916495551, 'loss_val': 2.293846553755718, 'psi': 0.08405201916495551}
[S15] START round=18 head_norm_before_train=1.569577 (no previous merge yet)
[S15] round=18 local utility u=0.031109 metrics={'f1_val': 0.2823500849720806, 'auprc': 0.2823500849720806, 'loss_val': 0.9932543326772839, 'psi': 0.2823500849720806}-{'f1_val': 0.28346647300895667, 'auprc': 0.28346647300895667, 'loss_val': 1.0655203741367756, 'psi': 0.28346647300895667}
[S16] START round=18 head_norm_before_train=1.623532 (no previous merge yet)
[S16] round=18 local utility u=1.000000 metrics={'f1_val': 0.13898032331212054, 'auprc': 0.13898032331212054, 'loss_val': 3.6582369195812072, 'psi': 0.13898032331212054}-{'f1_val': 0.015579710144927537, 'auprc': 0.015579710144927537, 'loss_val': 4.656360389612334, 'psi': 0.015579710144927537}
[S17] START round=18 head_norm_before_train=1.599236 (no previous merge yet)
[S17] round=18 local utility u=0.011273 metrics={'f1_val': 0.1551451708473237, 'auprc': 0.1551451708473237, 'loss_val': 1.0329993385250784, 'psi': 0.1551451708473237}-{'f1_val': 0.15219918620422399, 'auprc': 0.15219918620422399, 'loss_val': 1.0290318401382548, 'psi': 0.15219918620422399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:62410
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[S14] not sending this round → trigger blocked (psi=0.134)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:62402
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.101)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[S4] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:62410
[S13] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=-0.0237
[S2] DROPPED delta from S3 (cos=-0.0237 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.9757
[S9] RECEIVED delta(kind=head bytes=1792) from S13
[S9] cosine check vs S13: cos=0.7481
[S9] RECEIVED delta(kind=head bytes=1804) from S11
[S9] cosine check vs S11: cos=0.2426
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:62405
[S16] not sending this round → trigger blocked (psi=0.139)
[S17] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S17
[S5] cosine check vs S17: cos=-0.1104
[S5] DROPPED delta from S17 (cos=-0.1104 < 0.0)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=0.8566
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:62407
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.6836
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.3687 head_norm=1.275041
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.053085e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.3687 head_norm=1.108743 delta_norm=0.505309
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.1015 head_norm=1.166879
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.941517e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.1032 head_norm=1.284624 delta_norm=0.594152
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.0000 head_norm=1.552143
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.801954e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.0000 head_norm=1.583487 delta_norm=0.180195
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.1337 head_norm=1.065895
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.358125e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.1357 head_norm=1.281051 delta_norm=0.435813
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.650249 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.2596110357304387, 'auprc': 0.2596110357304387, 'loss_val': 2.8237774856160804, 'psi': 0.2596110357304387}-{'f1_val': 0.25628268911851, 'auprc': 0.25628268911851, 'loss_val': 2.7584037169899123, 'psi': 0.25628268911851}
[S3] START round=19 head_norm_before_train=1.921578 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.26070618723679945, 'auprc': 0.26070618723679945, 'loss_val': 2.9348179485908523, 'psi': 0.26070618723679945}-{'f1_val': 0.29836725564750616, 'auprc': 0.29836725564750616, 'loss_val': 3.0761543034781105, 'psi': 0.29836725564750616}
[S4] START round=19 head_norm_before_train=1.583487 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.014762 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3081460180767135, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3376704950294473, 'psi': 0.0}
[S5] START round=19 head_norm_before_train=1.821310 (no previous merge yet)
[S5] round=19 local utility u=0.044260 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6595020977478137, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.7480211790468503, 'psi': 0.33308623671855697}
[S6] START round=19 head_norm_before_train=1.284624 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.024795268425841673, 'auprc': 0.024795268425841673, 'loss_val': 2.839018825915021, 'psi': 0.024795268425841673}-{'f1_val': 0.10148798168637925, 'auprc': 0.10148798168637925, 'loss_val': 2.708570397675893, 'psi': 0.10148798168637925}
[S7] START round=19 head_norm_before_train=1.689289 (no previous merge yet)
[S7] round=19 local utility u=0.008674 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.097654842007736, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1150026864354636, 'psi': 0.35976373724718097}
[S8] START round=19 head_norm_before_train=1.626328 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7696630683047068, 'psi': 0.35939447907390915}-{'f1_val': 0.9997177674455537, 'auprc': 0.9997177674455537, 'loss_val': 0.7904318592009668, 'psi': 0.9997177674455537}
[S9] START round=19 head_norm_before_train=1.108743 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.066403 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.525979730535839, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6587854946971459, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.634215 (no previous merge yet)
[S10] round=19 local utility u=0.059324 metrics={'f1_val': 0.24970145689037496, 'auprc': 0.24970145689037496, 'loss_val': 2.6351603711701803, 'psi': 0.24970145689037493}-{'f1_val': 0.24970131421744324, 'auprc': 0.24970131421744324, 'loss_val': 2.7538076909863145, 'psi': 0.24970131421744324}
[S11] START round=19 head_norm_before_train=1.700092 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.28058449642880545, 'auprc': 0.28058449642880545, 'loss_val': 2.1790762293883703, 'psi': 0.28058449642880545}-{'f1_val': 0.27699074972507925, 'auprc': 0.27699074972507925, 'loss_val': 1.993513305552893, 'psi': 0.27699074972507925}
[S13] START round=19 head_norm_before_train=1.490886 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2154782487918003, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1660434532077313, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.281051 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.12144504227517294, 'auprc': 0.12144504227517294, 'loss_val': 2.2188244242413147, 'psi': 0.12144504227517294}-{'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 2.164741653348776, 'psi': 0.13373403456048086}
[S15] START round=19 head_norm_before_train=1.589314 (no previous merge yet)
[S15] round=19 local utility u=0.012775 metrics={'f1_val': 0.28038067349926793, 'auprc': 0.28038067349926793, 'loss_val': 0.9499789580216472, 'psi': 0.28038067349926793}-{'f1_val': 0.2823500849720806, 'auprc': 0.2823500849720806, 'loss_val': 0.9932543326772839, 'psi': 0.2823500849720806}
[S16] START round=19 head_norm_before_train=1.643189 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.09042255771227735, 'auprc': 0.09042255771227735, 'loss_val': 4.273223525617056, 'psi': 0.09042255771227735}-{'f1_val': 0.13898032331212054, 'auprc': 0.13898032331212054, 'loss_val': 3.6582369195812072, 'psi': 0.13898032331212054}
[S17] START round=19 head_norm_before_train=1.621356 (no previous merge yet)
[S17] round=19 local utility u=0.006350 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 0.9951144261831727, 'psi': 0.15234678044996122}-{'f1_val': 0.1551451708473237, 'auprc': 0.1551451708473237, 'loss_val': 1.0329993385250784, 'psi': 0.1551451708473237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:62410
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:62407
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:62414
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=0.9601
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.3035
[S6] RECEIVED delta(kind=head bytes=1805) from S7
[S6] cosine check vs S7: cos=0.3257
[S4] RECEIVED delta(kind=head bytes=1804) from S10
[S4] cosine check vs S10: cos=0.9839
[S14] RECEIVED delta(kind=head bytes=1802) from S9
[S14] cosine check vs S9: cos=0.2452
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1807 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1807) from S17
[S5] cosine check vs S17: cos=-0.1104
[S5] DROPPED delta from S17 (cos=-0.1104 < 0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.1214 head_norm=1.304813
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.190503e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.1331 head_norm=1.141776 delta_norm=0.319050
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] r=20 psi=0.121 u=0.0000 p_local=0.1894 f1=0.121 auprc=0.121 bytes=0
[S3] r=20 psi=0.261 u=0.0000 p_local=0.0405 f1=0.261 auprc=0.261 bytes=3594
[S8] r=20 psi=0.359 u=0.0000 p_local=0.2930 f1=0.359 auprc=0.359 bytes=16173
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.0248 head_norm=1.326806
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.985588e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.0217 head_norm=1.245131 delta_norm=0.898559
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] r=20 psi=0.025 u=0.0000 p_local=0.0972 f1=0.025 auprc=0.025 bytes=0
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.0000 head_norm=1.623820
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.486857e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.2003 head_norm=1.637324 delta_norm=0.148686
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.000 u=0.0148 p_local=0.0322 f1=0.000 auprc=0.000 bytes=0
[S13] r=20 psi=0.360 u=0.0000 p_local=0.1348 f1=0.360 auprc=0.360 bytes=7186
[S11] r=20 psi=0.281 u=0.0000 p_local=0.1071 f1=0.281 auprc=0.281 bytes=5407
[S2] r=20 psi=0.260 u=0.0000 p_local=0.0674 f1=0.260 auprc=0.260 bytes=5398
[S10] r=20 psi=0.250 u=0.0593 p_local=0.0865 f1=0.250 auprc=0.250 bytes=10807
[S5] r=20 psi=0.333 u=0.0443 p_local=0.0570 f1=0.333 auprc=0.333 bytes=14373
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.3687 head_norm=1.193496
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.292406e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.3687 head_norm=1.235736 delta_norm=0.929241
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.369 u=0.0664 p_local=0.1387 f1=0.369 auprc=0.369 bytes=8994
[S7] r=20 psi=0.360 u=0.0087 p_local=0.0671 f1=0.360 auprc=0.360 bytes=14417
[S15] r=20 psi=0.280 u=0.0128 p_local=0.0995 f1=0.280 auprc=0.280 bytes=12596
[S16] r=20 psi=0.090 u=0.0000 p_local=0.2236 f1=0.090 auprc=0.090 bytes=0
[S17] r=20 psi=0.152 u=0.0063 p_local=0.0453 f1=0.152 auprc=0.152 bytes=16196
[S2] START round=20 head_norm_before_train=1.670969 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.25525697223810434, 'auprc': 0.25525697223810434, 'loss_val': 2.8162616226637653, 'psi': 0.25525697223810434}-{'f1_val': 0.2596110357304387, 'auprc': 0.2596110357304387, 'loss_val': 2.8237774856160804, 'psi': 0.2596110357304387}
[S3] START round=20 head_norm_before_train=1.931898 (no previous merge yet)
[S3] round=20 local utility u=0.100393 metrics={'f1_val': 0.30359723172864855, 'auprc': 0.30359723172864855, 'loss_val': 3.1200513992113463, 'psi': 0.30359723172864855}-{'f1_val': 0.26070618723679945, 'auprc': 0.26070618723679945, 'loss_val': 2.9348179485908523, 'psi': 0.26070618723679945}
[S4] START round=20 head_norm_before_train=1.637324 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=1.000000 metrics={'f1_val': 0.33274066548133097, 'auprc': 0.33274066548133097, 'loss_val': 1.2829503873900345, 'psi': 0.33274066548133097}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3081460180767135, 'psi': 0.0}
[S5] START round=20 head_norm_before_train=1.832110 (no previous merge yet)
[S5] round=20 local utility u=0.052270 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.5549618622825654, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6595020977478137, 'psi': 0.33308623671855697}
[S6] START round=20 head_norm_before_train=1.245131 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.350667 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 2.8303043960922296, 'psi': 0.1017530487804878}-{'f1_val': 0.024795268425841673, 'auprc': 0.024795268425841673, 'loss_val': 2.839018825915021, 'psi': 0.024795268425841673}
[S7] START round=20 head_norm_before_train=1.719042 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0909884278439395, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.097654842007736, 'psi': 0.35976373724718097}
[S8] START round=20 head_norm_before_train=1.668172 (no previous merge yet)
[S8] round=20 local utility u=0.004558 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7605470748157841, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7696630683047068, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.235736 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.038392 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4491958896478183, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.525979730535839, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.664056 (no previous merge yet)
[S10] round=20 local utility u=0.032518 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.5695861497652013, 'psi': 0.24964166268514096}-{'f1_val': 0.24970145689037496, 'auprc': 0.24970145689037496, 'loss_val': 2.6351603711701803, 'psi': 0.24970145689037493}
[S11] START round=20 head_norm_before_train=1.716786 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.2630544292910677, 'auprc': 0.2630544292910677, 'loss_val': 2.0219417808400046, 'psi': 0.2630544292910677}-{'f1_val': 0.28058449642880545, 'auprc': 0.28058449642880545, 'loss_val': 2.1790762293883703, 'psi': 0.28058449642880545}
[S13] START round=20 head_norm_before_train=1.513329 (no previous merge yet)
[S13] round=20 local utility u=0.008045 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1993888010111105, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2154782487918003, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.141776 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.063018 metrics={'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 2.185304047385746, 'psi': 0.13172448466566114}-{'f1_val': 0.12144504227517294, 'auprc': 0.12144504227517294, 'loss_val': 2.2188244242413147, 'psi': 0.12144504227517294}
[S15] START round=20 head_norm_before_train=1.613939 (no previous merge yet)
[S15] round=20 local utility u=0.073167 metrics={'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.8326696764621605, 'psi': 0.2836055656382335}-{'f1_val': 0.28038067349926793, 'auprc': 0.28038067349926793, 'loss_val': 0.9499789580216472, 'psi': 0.28038067349926793}
[S16] START round=20 head_norm_before_train=1.660371 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.029755579171094584, 'auprc': 0.029755579171094584, 'loss_val': 4.847088943633289, 'psi': 0.02975557917109458}-{'f1_val': 0.09042255771227735, 'auprc': 0.09042255771227735, 'loss_val': 4.273223525617056, 'psi': 0.09042255771227735}
[S17] START round=20 head_norm_before_train=1.639842 (no previous merge yet)
[S17] round=20 local utility u=0.242406 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9652179323015141, 'psi': 0.20289293555469456}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 0.9951144261831727, 'psi': 0.15234678044996122}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:62402
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:62405
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.132)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:62414
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[S6] not sending this round → trigger blocked (psi=0.102)
[S10] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=0.9099
[S5] RECEIVED delta(kind=head bytes=1804) from S4
[S5] cosine check vs S4: cos=0.0170
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=0.9881
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.8486
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.4973
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=-0.0249
[S2] DROPPED delta from S3 (cos=-0.0249 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.3790
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.3968
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S17
[S5] cosine check vs S17: cos=-0.1109
[S5] DROPPED delta from S17 (cos=-0.1109 < 0.0)
[S11] ⇄ pheromone p=0.086 → S9@127.0.0.1:62410
[S2] ⇄ pheromone p=0.054 → S6@127.0.0.1:62407
[S7] ⇄ pheromone p=0.054 → S6@127.0.0.1:62407
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.1317 head_norm=1.171363
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.452631e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.1355 head_norm=1.106589 delta_norm=0.245263
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.164 → S11@127.0.0.1:62412
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.1018 head_norm=1.286929
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.715827e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.1018 head_norm=1.298690 delta_norm=0.771583
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.148 → S15@127.0.0.1:62415
[S16] ⇄ pheromone p=0.179 → S4@127.0.0.1:62404
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.3687 head_norm=1.311516
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.025029e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.3687 head_norm=1.231119 delta_norm=0.302503
[S9] aggregate: ACCEPT kept=['S5', 'S13'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.119 → S14@127.0.0.1:62414
[S10] ⇄ pheromone p=0.076 → S4@127.0.0.1:62404
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.3327 head_norm=1.676595
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.301788e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.3329 head_norm=1.679819 delta_norm=0.130179
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.226 → S5@127.0.0.1:62405
[S3] ⇄ pheromone p=0.052 → S2@127.0.0.1:62402
[S8] ⇄ pheromone p=0.235 → S6@127.0.0.1:62407
[S15] ⇄ pheromone p=0.094 → S14@127.0.0.1:62414
[S13] ⇄ pheromone p=0.109 → S9@127.0.0.1:62410
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.3331 head_norm=1.844064
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.235559e+00
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.3331 head_norm=1.256649 delta_norm=1.235559
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.056 → S9@127.0.0.1:62410
[S17] ⇄ pheromone p=0.085 → S5@127.0.0.1:62405
[S2] START round=21 head_norm_before_train=1.689694 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.2622186709282195, 'auprc': 0.2622186709282195, 'loss_val': 2.937977305703291, 'psi': 0.2622186709282195}-{'f1_val': 0.25525697223810434, 'auprc': 0.25525697223810434, 'loss_val': 2.8162616226637653, 'psi': 0.25525697223810434}
[S3] START round=21 head_norm_before_train=1.942169 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.28910976663785654, 'auprc': 0.28910976663785654, 'loss_val': 2.995632660629663, 'psi': 0.28910976663785654}-{'f1_val': 0.30359723172864855, 'auprc': 0.30359723172864855, 'loss_val': 3.1200513992113463, 'psi': 0.30359723172864855}
[S4] START round=21 head_norm_before_train=1.679819 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.008558 metrics={'f1_val': 0.3324052982367333, 'auprc': 0.3324052982367333, 'loss_val': 1.262816378496946, 'psi': 0.3324052982367333}-{'f1_val': 0.33274066548133097, 'auprc': 0.33274066548133097, 'loss_val': 1.2829503873900345, 'psi': 0.33274066548133097}
[S5] START round=21 head_norm_before_train=1.256649 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.391630 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.771701275106875, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.5549618622825654, 'psi': 0.33308623671855697}
[S6] START round=21 head_norm_before_train=1.298690 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.024795268425841673, 'auprc': 0.024795268425841673, 'loss_val': 2.931345151210975, 'psi': 0.024795268425841673}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 2.8303043960922296, 'psi': 0.1017530487804878}
[S7] START round=21 head_norm_before_train=1.737056 (no previous merge yet)
[S7] round=21 local utility u=0.542388 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0868791588982076, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0909884278439395, 'psi': 0.23968964488212474}
[S8] START round=21 head_norm_before_train=1.705194 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7678286489153785, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7605470748157841, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.231119 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.451206506557053, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4491958896478183, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.693075 (no previous merge yet)
[S10] round=21 local utility u=0.072657 metrics={'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 2.423195774334058, 'psi': 0.24952198852772467}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.5695861497652013, 'psi': 0.24964166268514096}
[S11] START round=21 head_norm_before_train=1.731648 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.28003400693218233, 'auprc': 0.28003400693218233, 'loss_val': 2.209379142422004, 'psi': 0.28003400693218233}-{'f1_val': 0.2630544292910677, 'auprc': 0.2630544292910677, 'loss_val': 2.0219417808400046, 'psi': 0.2630544292910677}
[S13] START round=21 head_norm_before_train=1.529455 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2602711633611805, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1993888010111105, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.106589 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 2.3071005818775823, 'psi': 0.1331327566754419}-{'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 2.185304047385746, 'psi': 0.13172448466566114}
[S15] START round=21 head_norm_before_train=1.638584 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.28066325286515487, 'auprc': 0.28066325286515487, 'loss_val': 0.8774508992935797, 'psi': 0.28066325286515487}-{'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.8326696764621605, 'psi': 0.2836055656382335}
[S16] START round=21 head_norm_before_train=1.676199 (no previous merge yet)
[S16] round=21 local utility u=0.898299 metrics={'f1_val': 0.13442526191530177, 'auprc': 0.13442526191530177, 'loss_val': 3.9925177917875985, 'psi': 0.13442526191530177}-{'f1_val': 0.029755579171094584, 'auprc': 0.029755579171094584, 'loss_val': 4.847088943633289, 'psi': 0.02975557917109458}
[S17] START round=21 head_norm_before_train=1.659121 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 0.9525201338007544, 'psi': 0.1522581895716224}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9652179323015141, 'psi': 0.20289293555469456}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:62405
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:62410
[S16] not sending this round → trigger blocked (psi=0.134)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.6172
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.4223
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=0.9908
[S5] RECEIVED delta(kind=head bytes=1805) from S4
[S5] cosine check vs S4: cos=0.6583
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.0248 head_norm=1.338636
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.480475e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.0220 head_norm=1.307122 delta_norm=0.848047
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.3687 head_norm=1.314891
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.712966e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.3687 head_norm=1.174193 delta_norm=0.571297
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.3324 head_norm=1.719081
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.167725e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.3324 head_norm=1.715016 delta_norm=0.116773
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.3331 head_norm=1.296641
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.522668e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.3331 head_norm=1.375793 delta_norm=0.652267
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.705819 (no previous merge yet)
[S2] round=22 local utility u=0.007034 metrics={'f1_val': 0.25706973768394115, 'auprc': 0.25706973768394115, 'loss_val': 2.877568874295912, 'psi': 0.25706973768394115}-{'f1_val': 0.2622186709282195, 'auprc': 0.2622186709282195, 'loss_val': 2.937977305703291, 'psi': 0.2622186709282195}
[S3] START round=22 head_norm_before_train=1.950595 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.27776627321046454, 'auprc': 0.27776627321046454, 'loss_val': 2.9946586139704894, 'psi': 0.27776627321046454}-{'f1_val': 0.28910976663785654, 'auprc': 0.28910976663785654, 'loss_val': 2.995632660629663, 'psi': 0.28910976663785654}
[S4] START round=22 head_norm_before_train=1.715016 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.32025984571660576, 'auprc': 0.32025984571660576, 'loss_val': 1.2380408725760323, 'psi': 0.32025984571660576}-{'f1_val': 0.3324052982367333, 'auprc': 0.3324052982367333, 'loss_val': 1.262816378496946, 'psi': 0.3324052982367333}
[S5] START round=22 head_norm_before_train=1.375793 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.029785 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.712131162710896, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.771701275106875, 'psi': 0.33308623671855697}
[S6] START round=22 head_norm_before_train=1.307122 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.347130 metrics={'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 2.9293565461228233, 'psi': 0.10171428571428572}-{'f1_val': 0.024795268425841673, 'auprc': 0.024795268425841673, 'loss_val': 2.931345151210975, 'psi': 0.024795268425841673}
[S7] START round=22 head_norm_before_train=1.750303 (no previous merge yet)
[S7] round=22 local utility u=0.003527 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0798255290450458, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0868791588982076, 'psi': 0.35976373724718097}
[S8] START round=22 head_norm_before_train=1.739366 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7910833515487523, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7678286489153785, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.174193 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.032473 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3862596515178633, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.451206506557053, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.718893 (no previous merge yet)
[S10] round=22 local utility u=0.406743 metrics={'f1_val': 0.2864192458725315, 'auprc': 0.2864192458725315, 'loss_val': 1.9417858154880723, 'psi': 0.2864192458725315}-{'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 2.423195774334058, 'psi': 0.24952198852772467}
[S11] START round=22 head_norm_before_train=1.746286 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.2640276236280676, 'auprc': 0.2640276236280676, 'loss_val': 2.1293708494199035, 'psi': 0.2640276236280676}-{'f1_val': 0.28003400693218233, 'auprc': 0.28003400693218233, 'loss_val': 2.209379142422004, 'psi': 0.28003400693218233}
[S13] START round=22 head_norm_before_train=1.540877 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2958447612682333, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2602711633611805, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.142910 cos_to_last_merge=0.9943 (last merge round=20)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.12290788296920914, 'auprc': 0.12290788296920914, 'loss_val': 2.936354223524042, 'psi': 0.12290788296920914}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 2.3071005818775823, 'psi': 0.1331327566754419}
[S15] START round=22 head_norm_before_train=1.658815 (no previous merge yet)
[S15] round=22 local utility u=0.009637 metrics={'f1_val': 0.28318798449612403, 'auprc': 0.28318798449612403, 'loss_val': 0.8808995669439486, 'psi': 0.28318798449612403}-{'f1_val': 0.28066325286515487, 'auprc': 0.28066325286515487, 'loss_val': 0.8774508992935797, 'psi': 0.28066325286515487}
[S16] START round=22 head_norm_before_train=1.691345 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.13170189098998888, 'auprc': 0.13170189098998888, 'loss_val': 4.157889550853651, 'psi': 0.13170189098998888}-{'f1_val': 0.13442526191530177, 'auprc': 0.13442526191530177, 'loss_val': 3.9925177917875985, 'psi': 0.13442526191530177}
[S17] START round=22 head_norm_before_train=1.674814 (no previous merge yet)
[S17] round=22 local utility u=0.008343 metrics={'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.9355676401299866, 'psi': 0.15222868217054264}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 0.9525201338007544, 'psi': 0.1522581895716224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:62414
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.102)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:62404
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:62414
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=0.9929
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.4950
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=0.8333
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.6721
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=0.8752
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=0.0222
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] cosine check vs S17: cos=0.0714
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.1017 head_norm=1.345216
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.442579e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.1017 head_norm=1.166021 delta_norm=0.544258
[S6] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.1229 head_norm=1.193436
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.306284e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.1329 head_norm=1.123816 delta_norm=0.230628
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.3203 head_norm=1.752173
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.044829e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.3210 head_norm=1.744364 delta_norm=0.104483
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.3687 head_norm=1.257305
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.478410e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.3687 head_norm=1.225743 delta_norm=0.547841
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.3331 head_norm=1.422792
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.064119e+00
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.3332 head_norm=1.141824 delta_norm=1.064119
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.720847 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.25104654795376447, 'auprc': 0.25104654795376447, 'loss_val': 2.8925641684206824, 'psi': 0.25104654795376447}-{'f1_val': 0.25706973768394115, 'auprc': 0.25706973768394115, 'loss_val': 2.877568874295912, 'psi': 0.25706973768394115}
[S3] START round=23 head_norm_before_train=1.961387 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.26080757016008815, 'auprc': 0.26080757016008815, 'loss_val': 3.01334114530933, 'psi': 0.26080757016008815}-{'f1_val': 0.27776627321046454, 'auprc': 0.27776627321046454, 'loss_val': 2.9946586139704894, 'psi': 0.27776627321046454}
[S4] START round=23 head_norm_before_train=1.744364 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.179710 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2074281405328502, 'psi': 0.3567939207526687}-{'f1_val': 0.32025984571660576, 'auprc': 0.32025984571660576, 'loss_val': 1.2380408725760323, 'psi': 0.32025984571660576}
[S5] START round=23 head_norm_before_train=1.141824 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.059525 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.593080195180306, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.712131162710896, 'psi': 0.33308623671855697}
[S6] START round=23 head_norm_before_train=1.166021 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.139161 metrics={'f1_val': 0.10148798168637925, 'auprc': 0.10148798168637925, 'loss_val': 2.6489977133875477, 'psi': 0.10148798168637925}-{'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 2.9293565461228233, 'psi': 0.10171428571428572}
[S7] START round=23 head_norm_before_train=1.762660 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0871423079629794, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0798255290450458, 'psi': 0.35976373724718097}
[S8] START round=23 head_norm_before_train=1.764653 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8212475436898856, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7910833515487523, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.225743 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4158285676605933, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3862596515178633, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.742796 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 2.317054672993956, 'psi': 0.2494621085345446}-{'f1_val': 0.2864192458725315, 'auprc': 0.2864192458725315, 'loss_val': 1.9417858154880723, 'psi': 0.2864192458725315}
[S11] START round=23 head_norm_before_train=1.761527 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.3459048214388813, 'psi': 0.28036404111831337}-{'f1_val': 0.2640276236280676, 'auprc': 0.2640276236280676, 'loss_val': 2.1293708494199035, 'psi': 0.2640276236280676}
[S13] START round=23 head_norm_before_train=1.551578 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.316922978677991, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2958447612682333, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.123816 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.150538 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 2.750663848019644, 'psi': 0.13572854291417166}-{'f1_val': 0.12290788296920914, 'auprc': 0.12290788296920914, 'loss_val': 2.936354223524042, 'psi': 0.12290788296920914}
[S15] START round=23 head_norm_before_train=1.686002 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.2820699708454811, 'auprc': 0.2820699708454811, 'loss_val': 0.9275825277231996, 'psi': 0.2820699708454811}-{'f1_val': 0.28318798449612403, 'auprc': 0.28318798449612403, 'loss_val': 0.8808995669439486, 'psi': 0.28318798449612403}
[S16] START round=23 head_norm_before_train=1.703699 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.006431459022418228, 'auprc': 0.006431459022418228, 'loss_val': 5.396302901097998, 'psi': 0.006431459022418228}-{'f1_val': 0.13170189098998888, 'auprc': 0.13170189098998888, 'loss_val': 4.157889550853651, 'psi': 0.13170189098998888}
[S17] START round=23 head_norm_before_train=1.687568 (no previous merge yet)
[S17] round=23 local utility u=0.009957 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 0.9159197717606525, 'psi': 0.1522581895716224}-{'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.9355676401299866, 'psi': 0.15222868217054264}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:62405
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] cosine check vs S4: cos=0.6341
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.101)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=0.7344
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.6155
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.3687 head_norm=1.301239
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.483839e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.3687 head_norm=1.119528 delta_norm=0.548384
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.3331 head_norm=1.189501
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.720081e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.3333 head_norm=1.220307 delta_norm=0.272008
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.734702 (no previous merge yet)
[S2] round=24 local utility u=0.006388 metrics={'f1_val': 0.25721784776902884, 'auprc': 0.25721784776902884, 'loss_val': 2.9353290872101763, 'psi': 0.25721784776902884}-{'f1_val': 0.25104654795376447, 'auprc': 0.25104654795376447, 'loss_val': 2.8925641684206824, 'psi': 0.25104654795376447}
[S3] START round=24 head_norm_before_train=1.971328 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.26070618723679945, 'auprc': 0.26070618723679945, 'loss_val': 3.032657448237111, 'psi': 0.26070618723679945}-{'f1_val': 0.26080757016008815, 'auprc': 0.26080757016008815, 'loss_val': 3.01334114530933, 'psi': 0.26080757016008815}
[S4] START round=24 head_norm_before_train=1.778976 cos_to_last_merge=0.9991 (last merge round=22)
[S4] round=24 local utility u=0.016045 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1753375657859952, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2074281405328502, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.220307 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.81955370251341, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.593080195180306, 'psi': 0.33308623671855697}
[S6] START round=24 head_norm_before_train=1.206275 cos_to_last_merge=0.9979 (last merge round=22)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.09546862896979086, 'auprc': 0.09546862896979086, 'loss_val': 3.0392425048489393, 'psi': 0.09546862896979086}-{'f1_val': 0.10148798168637925, 'auprc': 0.10148798168637925, 'loss_val': 2.6489977133875477, 'psi': 0.10148798168637925}
[S7] START round=24 head_norm_before_train=1.772242 (no previous merge yet)
[S7] round=24 local utility u=0.550373 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0670629899120405, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0871423079629794, 'psi': 0.23968964488212474}
[S8] START round=24 head_norm_before_train=1.787700 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8626158030671399, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8212475436898856, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.119528 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.054653 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3065225360029, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4158285676605933, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.765225 (no previous merge yet)
[S10] round=24 local utility u=0.186017 metrics={'f1_val': 0.25543730608687787, 'auprc': 0.25543730608687787, 'loss_val': 1.9987975794958697, 'psi': 0.25543730608687787}-{'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 2.317054672993956, 'psi': 0.2494621085345446}
[S11] START round=24 head_norm_before_train=1.777087 (no previous merge yet)
[S11] round=24 local utility u=0.020328 metrics={'f1_val': 0.27893948276985214, 'auprc': 0.27893948276985214, 'loss_val': 2.2924284520774294, 'psi': 0.27893948276985214}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.3459048214388813, 'psi': 0.28036404111831337}
[S13] START round=24 head_norm_before_train=1.565555 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.321135237804617, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.316922978677991, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.172040 cos_to_last_merge=0.9958 (last merge round=22)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.24364109593169, 'psi': 0.13587634006482174}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 2.750663848019644, 'psi': 0.13572854291417166}
[S15] START round=24 head_norm_before_train=1.712340 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.28136789582572713, 'auprc': 0.28136789582572713, 'loss_val': 0.9439647860243705, 'psi': 0.28136789582572713}-{'f1_val': 0.2820699708454811, 'auprc': 0.2820699708454811, 'loss_val': 0.9275825277231996, 'psi': 0.2820699708454811}
[S16] START round=24 head_norm_before_train=1.714418 (no previous merge yet)
[S16] round=24 local utility u=1.000000 metrics={'f1_val': 0.1514177558745804, 'auprc': 0.1514177558745804, 'loss_val': 4.0007185130614635, 'psi': 0.1514177558745804}-{'f1_val': 0.006431459022418228, 'auprc': 0.006431459022418228, 'loss_val': 5.396302901097998, 'psi': 0.006431459022418228}
[S17] START round=24 head_norm_before_train=1.703994 (no previous merge yet)
[S17] round=24 local utility u=0.008051 metrics={'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.89955197469943, 'psi': 0.15222868217054264}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 0.9159197717606525, 'psi': 0.1522581895716224}
[S16] not sending this round → trigger blocked (psi=0.151)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:62405
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S10] → sending delta(kind=head bytes=1810) to S4@127.0.0.1:62404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:62407
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1810 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.3700
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] cosine check vs S11: cos=0.0855
[S4] RECEIVED delta(kind=head bytes=1810) from S10
[S4] cosine check vs S10: cos=0.9899
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.4392
[S6] RECEIVED delta(kind=head bytes=1804) from S7
[S6] cosine check vs S7: cos=0.8564
[S5] RECEIVED delta(kind=head bytes=1802) from S4
[S5] cosine check vs S4: cos=0.6940
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=0.6946
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.0955 head_norm=1.251177
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.115999e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.0966 head_norm=1.207214 delta_norm=0.311600
[S6] aggregate: ACCEPT kept=['S2', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.1359 head_norm=1.226333
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.410700e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.1359 head_norm=1.026767 delta_norm=0.641070
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.3331 head_norm=1.287669
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.561833e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.3333 head_norm=1.282220 delta_norm=0.256183
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.3568 head_norm=1.812520
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.286297e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.3568 head_norm=1.793625 delta_norm=0.128630
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.3687 head_norm=1.194383
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.033278e+00
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.3687 head_norm=1.118324 delta_norm=1.033278
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.747587 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.26129377171879176, 'auprc': 0.26129377171879176, 'loss_val': 3.091194306521311, 'psi': 0.26129377171879176}-{'f1_val': 0.25721784776902884, 'auprc': 0.25721784776902884, 'loss_val': 2.9353290872101763, 'psi': 0.25721784776902884}
[S3] START round=25 head_norm_before_train=1.981879 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.2594957116141097, 'auprc': 0.2594957116141097, 'loss_val': 3.0439156864701165, 'psi': 0.2594957116141097}-{'f1_val': 0.26070618723679945, 'auprc': 0.26070618723679945, 'loss_val': 3.032657448237111, 'psi': 0.26070618723679945}
[S4] START round=25 head_norm_before_train=1.793625 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.008124 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1590896092543126, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1753375657859952, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.282220 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.015033542107724, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.81955370251341, 'psi': 0.33308623671855697}
[S6] START round=25 head_norm_before_train=1.207214 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.165027 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 2.7657475249975567, 'psi': 0.1017530487804878}-{'f1_val': 0.09546862896979086, 'auprc': 0.09546862896979086, 'loss_val': 3.0392425048489393, 'psi': 0.09546862896979086}
[S7] START round=25 head_norm_before_train=1.784045 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.0931982121760384, 'psi': 0.23976608187134504}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0670629899120405, 'psi': 0.35976373724718097}
[S8] START round=25 head_norm_before_train=1.812102 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9155328941159235, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8626158030671399, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.118324 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.020359 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.2658048062687322, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3065225360029, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.783828 (no previous merge yet)
[S10] round=25 local utility u=0.394343 metrics={'f1_val': 0.30485466716944587, 'auprc': 0.30485466716944587, 'loss_val': 1.6548682031549586, 'psi': 0.30485466716944587}-{'f1_val': 0.25543730608687787, 'auprc': 0.25543730608687787, 'loss_val': 1.9987975794958697, 'psi': 0.25543730608687787}
[S11] START round=25 head_norm_before_train=1.791668 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.2798144154740901, 'auprc': 0.2798144154740901, 'loss_val': 2.3783420156406843, 'psi': 0.2798144154740901}-{'f1_val': 0.27893948276985214, 'auprc': 0.27893948276985214, 'loss_val': 2.2924284520774294, 'psi': 0.27893948276985214}
[S13] START round=25 head_norm_before_train=1.583598 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.334739080424464, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.321135237804617, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.026767 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.229612 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 2.784416175876196, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.24364109593169, 'psi': 0.13587634006482174}
[S15] START round=25 head_norm_before_train=1.740347 (no previous merge yet)
[S15] round=25 local utility u=0.027315 metrics={'f1_val': 0.28290909090909094, 'auprc': 0.28290909090909094, 'loss_val': 0.903204879875, 'psi': 0.28290909090909094}-{'f1_val': 0.28136789582572713, 'auprc': 0.28136789582572713, 'loss_val': 0.9439647860243705, 'psi': 0.28136789582572713}
[S16] START round=25 head_norm_before_train=1.725154 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.1122127430635616, 'auprc': 0.1122127430635616, 'loss_val': 4.561152448108783, 'psi': 0.1122127430635616}-{'f1_val': 0.1514177558745804, 'auprc': 0.1514177558745804, 'loss_val': 4.0007185130614635, 'psi': 0.1514177558745804}
[S17] START round=25 head_norm_before_train=1.718630 (no previous merge yet)
[S17] round=25 local utility u=0.240792 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8739471841140569, 'psi': 0.20289293555469456}-{'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.89955197469943, 'psi': 0.15222868217054264}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:62404
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:62414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.102)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S9] → sending delta(kind=head bytes=1787) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:62405
[S15] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1787 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=0.9945
[S14] RECEIVED delta(kind=head bytes=1787) from S9
[S14] cosine check vs S9: cos=0.6019
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=0.5185
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] cosine check vs S4: cos=0.7119
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S17
[S5] cosine check vs S17: cos=0.6693
[S6] ⇄ pheromone p=0.135 → S15@127.0.0.1:62415
[S8] ⇄ pheromone p=0.077 → S6@127.0.0.1:62407
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.3331 head_norm=1.367246
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.665015e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.3332 head_norm=1.323139 delta_norm=0.266501
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.061 → S9@127.0.0.1:62410
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.1359 head_norm=1.076623
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.046089e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.1358 head_norm=1.022391 delta_norm=0.404609
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.119 → S11@127.0.0.1:62412
[S13] ⇄ pheromone p=0.036 → S9@127.0.0.1:62410
[S7] ⇄ pheromone p=0.150 → S6@127.0.0.1:62407
[S2] ⇄ pheromone p=0.019 → S6@127.0.0.1:62407
[S11] ⇄ pheromone p=0.031 → S9@127.0.0.1:62410
[S3] ⇄ pheromone p=0.017 → S2@127.0.0.1:62402
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.3568 head_norm=1.822127
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.570194e-02
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.3568 head_norm=1.810893 delta_norm=0.095702
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.102 → S5@127.0.0.1:62405
[S15] ⇄ pheromone p=0.037 → S14@127.0.0.1:62414
[S10] ⇄ pheromone p=0.181 → S4@127.0.0.1:62404
[S9] ⇄ pheromone p=0.055 → S14@127.0.0.1:62414
[S17] ⇄ pheromone p=0.079 → S5@127.0.0.1:62405
[S16] ⇄ pheromone p=0.292 → S4@127.0.0.1:62404
[S2] START round=26 head_norm_before_train=1.759415 (no previous merge yet)
[S2] round=26 local utility u=0.023261 metrics={'f1_val': 0.252990807203123, 'auprc': 0.252990807203123, 'loss_val': 2.9699446697260186, 'psi': 0.252990807203123}-{'f1_val': 0.26129377171879176, 'auprc': 0.26129377171879176, 'loss_val': 3.091194306521311, 'psi': 0.26129377171879176}
[S3] START round=26 head_norm_before_train=1.992885 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.2588946792768449, 'auprc': 0.2588946792768449, 'loss_val': 3.068300160503465, 'psi': 0.2588946792768449}-{'f1_val': 0.2594957116141097, 'auprc': 0.2594957116141097, 'loss_val': 3.0439156864701165, 'psi': 0.2594957116141097}
[S4] START round=26 head_norm_before_train=1.810893 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.005351 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1483871790500806, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1590896092543126, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.323139 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.011730 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9915729879751285, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.015033542107724, 'psi': 0.33308623671855697}
[S6] START round=26 head_norm_before_train=1.247026 cos_to_last_merge=0.9982 (last merge round=24)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 3.1271919131591774, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 2.7657475249975567, 'psi': 0.1017530487804878}
[S7] START round=26 head_norm_before_train=1.797003 (no previous merge yet)
[S7] round=26 local utility u=0.522751 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1276757893537082, 'psi': 0.35976373724718097}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.0931982121760384, 'psi': 0.23976608187134504}
[S8] START round=26 head_norm_before_train=1.839538 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9728298828558772, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9155328941159235, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.199930 cos_to_last_merge=0.9872 (last merge round=24)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.463616083744974, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.2658048062687322, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.804671 (no previous merge yet)
[S10] round=26 local utility u=0.072517 metrics={'f1_val': 0.29967614029442086, 'auprc': 0.29967614029442086, 'loss_val': 1.463228238643509, 'psi': 0.29967614029442086}-{'f1_val': 0.30485466716944587, 'auprc': 0.30485466716944587, 'loss_val': 1.6548682031549586, 'psi': 0.30485466716944587}
[S11] START round=26 head_norm_before_train=1.807030 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.28003400693218233, 'auprc': 0.28003400693218233, 'loss_val': 2.455553639850291, 'psi': 0.28003400693218233}-{'f1_val': 0.2798144154740901, 'auprc': 0.2798144154740901, 'loss_val': 2.3783420156406843, 'psi': 0.2798144154740901}
[S13] START round=26 head_norm_before_train=1.602018 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3386583638241072, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.334739080424464, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.022391 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.169692 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.444574164817852, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 2.784416175876196, 'psi': 0.13587634006482174}
[S15] START round=26 head_norm_before_train=1.765614 (no previous merge yet)
[S15] round=26 local utility u=1.000000 metrics={'f1_val': 0.6163002824079379, 'auprc': 0.6163002824079379, 'loss_val': 0.8114118058180834, 'psi': 0.6163002824079379}-{'f1_val': 0.28290909090909094, 'auprc': 0.28290909090909094, 'loss_val': 0.903204879875, 'psi': 0.28290909090909094}
[S16] START round=26 head_norm_before_train=1.736375 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.09097438352884846, 'auprc': 0.09097438352884846, 'loss_val': 4.710876543211388, 'psi': 0.09097438352884846}-{'f1_val': 0.1122127430635616, 'auprc': 0.1122127430635616, 'loss_val': 4.561152448108783, 'psi': 0.1122127430635616}
[S17] START round=26 head_norm_before_train=1.733068 (no previous merge yet)
[S17] round=26 local utility u=0.005904 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8621389794930792, 'psi': 0.20289293555469456}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8739471841140569, 'psi': 0.20289293555469456}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:62414
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:62407
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S10] → sending delta(kind=head bytes=1808) to S4@127.0.0.1:62404
[S5] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1807 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1808 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1808) from S10
[S4] cosine check vs S10: cos=0.9968
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=0.7256
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] cosine check vs S4: cos=0.7274
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.3982
[S6] RECEIVED delta(kind=head bytes=1807) from S7
[S6] cosine check vs S7: cos=0.7952
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] cosine check vs S2: cos=0.5301
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=0.6708
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.1358 head_norm=1.069681
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.248206e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.1358 head_norm=1.332924 delta_norm=0.624821
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.1018 head_norm=1.288577
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.122021e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.1018 head_norm=1.256876 delta_norm=0.212202
[S6] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.3687 head_norm=1.286932
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.388988e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.3687 head_norm=1.124343 delta_norm=0.738899
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.3331 head_norm=1.401443
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.463694e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.3332 head_norm=1.347651 delta_norm=0.246369
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.3568 head_norm=1.832086
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.271149e-02
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.3568 head_norm=1.828733 delta_norm=0.072711
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.770493 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.24651819130007976, 'auprc': 0.24651819130007976, 'loss_val': 2.9920889890596376, 'psi': 0.2465181913000798}-{'f1_val': 0.252990807203123, 'auprc': 0.252990807203123, 'loss_val': 2.9699446697260186, 'psi': 0.252990807203123}
[S3] START round=27 head_norm_before_train=2.003682 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.26040251083931926, 'auprc': 0.26040251083931926, 'loss_val': 3.0896515454191236, 'psi': 0.26040251083931926}-{'f1_val': 0.2588946792768449, 'auprc': 0.2588946792768449, 'loss_val': 3.068300160503465, 'psi': 0.2588946792768449}
[S4] START round=27 head_norm_before_train=1.828733 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.004605 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1391772452654916, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1483871790500806, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.347651 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.055630 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8803124498447596, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9915729879751285, 'psi': 0.33308623671855697}
[S6] START round=27 head_norm_before_train=1.256876 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.158539 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 2.810113537383776, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 3.1271919131591774, 'psi': 0.1017530487804878}
[S7] START round=27 head_norm_before_train=1.815278 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1415412089254413, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1276757893537082, 'psi': 0.35976373724718097}
[S8] START round=27 head_norm_before_train=1.863636 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0321099045631574, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9728298828558772, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.124343 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.020906 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.421804392749693, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.463616083744974, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.828268 (no previous merge yet)
[S10] round=27 local utility u=0.025929 metrics={'f1_val': 0.28869207669515345, 'auprc': 0.28869207669515345, 'loss_val': 1.3125145421973992, 'psi': 0.28869207669515345}-{'f1_val': 0.29967614029442086, 'auprc': 0.29967614029442086, 'loss_val': 1.463228238643509, 'psi': 0.29967614029442086}
[S11] START round=27 head_norm_before_train=1.822357 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.28003400693218233, 'auprc': 0.28003400693218233, 'loss_val': 2.4827703295944965, 'psi': 0.28003400693218233}-{'f1_val': 0.28003400693218233, 'auprc': 0.28003400693218233, 'loss_val': 2.455553639850291, 'psi': 0.28003400693218233}
[S13] START round=27 head_norm_before_train=1.620669 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3715920031130853, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3386583638241072, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.332924 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.7318841095146738, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.444574164817852, 'psi': 0.13582554517133957}
[S15] START round=27 head_norm_before_train=1.786045 (no previous merge yet)
[S15] round=27 local utility u=0.026701 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.7603019426953355, 'psi': 0.6165550083006743}-{'f1_val': 0.6163002824079379, 'auprc': 0.6163002824079379, 'loss_val': 0.8114118058180834, 'psi': 0.6163002824079379}
[S16] START round=27 head_norm_before_train=1.746631 (no previous merge yet)
[S16] round=27 local utility u=0.422960 metrics={'f1_val': 0.1370044052863436, 'auprc': 0.1370044052863436, 'loss_val': 4.279226419879794, 'psi': 0.1370044052863436}-{'f1_val': 0.09097438352884846, 'auprc': 0.09097438352884846, 'loss_val': 4.710876543211388, 'psi': 0.09097438352884846}
[S17] START round=27 head_norm_before_train=1.748072 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.2032213427796535, 'auprc': 0.2032213427796535, 'loss_val': 0.8797457685256566, 'psi': 0.2032213427796535}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8621389794930792, 'psi': 0.20289293555469456}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:62416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:62405
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:62407
[S6] not sending this round → trigger blocked (psi=0.102)
[S16] not sending this round → trigger blocked (psi=0.137)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S5
[S4] cosine check vs S5: cos=0.7411
[S16] RECEIVED delta(kind=head bytes=1802) from S4
[S16] cosine check vs S4: cos=-0.0804
[S16] DROPPED delta from S4 (cos=-0.0804 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] cosine check vs S9: cos=0.7967
[S6] RECEIVED delta(kind=head bytes=1804) from S15
[S6] cosine check vs S15: cos=-0.0122
[S6] DROPPED delta from S15 (cos=-0.0122 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.3331 head_norm=1.408951
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.274465e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.3331 head_norm=1.235968 delta_norm=0.427446
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.3568 head_norm=1.850946
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.216330e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.3568 head_norm=1.522874 delta_norm=0.621633
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.780695 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.24692723697148478, 'auprc': 0.24692723697148478, 'loss_val': 3.0106049787023714, 'psi': 0.24692723697148478}-{'f1_val': 0.24651819130007976, 'auprc': 0.24651819130007976, 'loss_val': 2.9920889890596376, 'psi': 0.2465181913000798}
[S3] START round=28 head_norm_before_train=2.014424 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.2607568688439606, 'auprc': 0.2607568688439606, 'loss_val': 3.106595528932912, 'psi': 0.2607568688439606}-{'f1_val': 0.26040251083931926, 'auprc': 0.26040251083931926, 'loss_val': 3.0896515454191236, 'psi': 0.26040251083931926}
[S4] START round=28 head_norm_before_train=1.522874 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.020624 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0979290145306406, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1391772452654916, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.235968 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.268354388580935, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8803124498447596, 'psi': 0.33308623671855697}
[S6] START round=28 head_norm_before_train=1.293052 cos_to_last_merge=0.9986 (last merge round=26)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 3.1827561582460673, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 2.810113537383776, 'psi': 0.1017530487804878}
[S7] START round=28 head_norm_before_train=1.834893 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.1411267362984086, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1415412089254413, 'psi': 0.35976373724718097}
[S8] START round=28 head_norm_before_train=1.883973 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1033686439399417, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0321099045631574, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.198128 cos_to_last_merge=0.9928 (last merge round=26)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5708845012116432, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.421804392749693, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.858384 (no previous merge yet)
[S10] round=28 local utility u=0.041652 metrics={'f1_val': 0.28017522993940563, 'auprc': 0.28017522993940563, 'loss_val': 1.1525587435585318, 'psi': 0.28017522993940563}-{'f1_val': 0.28869207669515345, 'auprc': 0.28869207669515345, 'loss_val': 1.3125145421973992, 'psi': 0.28869207669515345}
[S11] START round=28 head_norm_before_train=1.836736 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.593612284117977, 'psi': 0.28041912246234446}-{'f1_val': 0.28003400693218233, 'auprc': 0.28003400693218233, 'loss_val': 2.4827703295944965, 'psi': 0.28003400693218233}
[S13] START round=28 head_norm_before_train=1.631733 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.389115550465602, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3715920031130853, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.373348 cos_to_last_merge=0.9972 (last merge round=26)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.224577687440607, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.7318841095146738, 'psi': 0.13582554517133957}
[S15] START round=28 head_norm_before_train=1.808139 (no previous merge yet)
[S15] round=28 local utility u=0.002933 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7531826054774484, 'psi': 0.6164158146233559}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.7603019426953355, 'psi': 0.6165550083006743}
[S16] START round=28 head_norm_before_train=1.755852 (no previous merge yet)
[S16] round=28 local utility u=0.084441 metrics={'f1_val': 0.14163027656477437, 'auprc': 0.14163027656477437, 'loss_val': 4.151978027613256, 'psi': 0.14163027656477437}-{'f1_val': 0.1370044052863436, 'auprc': 0.1370044052863436, 'loss_val': 4.279226419879794, 'psi': 0.1370044052863436}
[S17] START round=28 head_norm_before_train=1.764695 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.1769665858360499, 'auprc': 0.1769665858360499, 'loss_val': 0.8476352976911371, 'psi': 0.1769665858360499}-{'f1_val': 0.2032213427796535, 'auprc': 0.2032213427796535, 'loss_val': 0.8797457685256566, 'psi': 0.2032213427796535}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:62416
[S16] not sending this round → trigger blocked (psi=0.142)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S4
[S16] cosine check vs S4: cos=-0.0748
[S16] DROPPED delta from S4 (cos=-0.0748 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S15
[S6] cosine check vs S15: cos=-0.0093
[S6] DROPPED delta from S15 (cos=-0.0093 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.790303 (no previous merge yet)
[S2] round=29 local utility u=0.010161 metrics={'f1_val': 0.25071758392612004, 'auprc': 0.25071758392612004, 'loss_val': 3.024396306271391, 'psi': 0.25071758392612004}-{'f1_val': 0.24692723697148478, 'auprc': 0.24692723697148478, 'loss_val': 3.0106049787023714, 'psi': 0.24692723697148478}
[S3] START round=29 head_norm_before_train=2.024603 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.26080757016008815, 'auprc': 0.26080757016008815, 'loss_val': 3.122540255789287, 'psi': 0.26080757016008815}-{'f1_val': 0.2607568688439606, 'auprc': 0.2607568688439606, 'loss_val': 3.106595528932912, 'psi': 0.2607568688439606}
[S4] START round=29 head_norm_before_train=1.557086 cos_to_last_merge=0.9993 (last merge round=27)
[S4] round=29 local utility u=0.009009 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.079911340329469, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0979290145306406, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.296302 cos_to_last_merge=0.9976 (last merge round=27)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.3427300057682023, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.268354388580935, 'psi': 0.33308623671855697}
[S6] START round=29 head_norm_before_train=1.330423 cos_to_last_merge=0.9949 (last merge round=26)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 3.4980834653674795, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 3.1827561582460673, 'psi': 0.1017530487804878}
[S7] START round=29 head_norm_before_train=1.852415 (no previous merge yet)
[S7] round=29 local utility u=0.013377 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.1136845211917443, 'psi': 0.2396131805157593}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.1411267362984086, 'psi': 0.23968964488212474}
[S8] START round=29 head_norm_before_train=1.900699 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1726937942352043, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1033686439399417, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.272714 cos_to_last_merge=0.9789 (last merge round=26)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6610179835940797, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5708845012116432, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.889460 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.2675953479255436, 'auprc': 0.2675953479255436, 'loss_val': 1.1260121404018533, 'psi': 0.2675953479255436}-{'f1_val': 0.28017522993940563, 'auprc': 0.28017522993940563, 'loss_val': 1.1525587435585318, 'psi': 0.28017522993940563}
[S11] START round=29 head_norm_before_train=1.850084 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.596827526159601, 'psi': 0.28036404111831337}-{'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.593612284117977, 'psi': 0.28041912246234446}
[S13] START round=29 head_norm_before_train=1.639463 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.417898434788547, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.389115550465602, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.417159 cos_to_last_merge=0.9904 (last merge round=26)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.627534442981062, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.224577687440607, 'psi': 0.13582554517133957}
[S15] START round=29 head_norm_before_train=1.828976 (no previous merge yet)
[S15] round=29 local utility u=0.004054 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7450755013944843, 'psi': 0.6164158146233559}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7531826054774484, 'psi': 0.6164158146233559}
[S16] START round=29 head_norm_before_train=1.765191 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 4.928725428832839, 'psi': 0.09046591544793414}-{'f1_val': 0.14163027656477437, 'auprc': 0.14163027656477437, 'loss_val': 4.151978027613256, 'psi': 0.14163027656477437}
[S17] START round=29 head_norm_before_train=1.779952 (no previous merge yet)
[S17] round=29 local utility u=0.127204 metrics={'f1_val': 0.2039558281958941, 'auprc': 0.2039558281958941, 'loss_val': 0.836131281584286, 'psi': 0.2039558281958941}-{'f1_val': 0.1769665858360499, 'auprc': 0.1769665858360499, 'loss_val': 0.8476352976911371, 'psi': 0.1769665858360499}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:62403
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:62416
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] cosine check vs S2: cos=-0.0237
[S3] DROPPED delta from S2 (cos=-0.0237 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S4
[S16] cosine check vs S4: cos=-0.0746
[S16] DROPPED delta from S4 (cos=-0.0746 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S15
[S6] cosine check vs S15: cos=-0.0076
[S6] DROPPED delta from S15 (cos=-0.0076 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=30 head_norm_before_train=1.799744 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.25156523916854495, 'auprc': 0.25156523916854495, 'loss_val': 3.0439134824705056, 'psi': 0.25156523916854495}-{'f1_val': 0.25071758392612004, 'auprc': 0.25071758392612004, 'loss_val': 3.024396306271391, 'psi': 0.25071758392612004}
[S3] START round=30 head_norm_before_train=2.034063 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.2609090319652467, 'auprc': 0.2609090319652467, 'loss_val': 3.1364335671919226, 'psi': 0.2609090319652467}-{'f1_val': 0.26080757016008815, 'auprc': 0.26080757016008815, 'loss_val': 3.122540255789287, 'psi': 0.26080757016008815}
[S4] START round=30 head_norm_before_train=1.596268 cos_to_last_merge=0.9974 (last merge round=27)
[S4] round=30 local utility u=0.007290 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0653317452181605, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.079911340329469, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.339217 cos_to_last_merge=0.9941 (last merge round=27)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.389544576680173, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.3427300057682023, 'psi': 0.33308623671855697}
[S6] START round=30 head_norm_before_train=1.365303 cos_to_last_merge=0.9904 (last merge round=26)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 3.7208033234213382, 'psi': 0.10171428571428572}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 3.4980834653674795, 'psi': 0.1017530487804878}
[S7] START round=30 head_norm_before_train=1.861297 (no previous merge yet)
[S7] round=30 local utility u=0.016149 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.0813867459370252, 'psi': 0.2396131805157593}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.1136845211917443, 'psi': 0.2396131805157593}
[S8] START round=30 head_norm_before_train=1.912478 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.224071884544935, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1726937942352043, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.328689 cos_to_last_merge=0.9676 (last merge round=26)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7308714808032308, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6610179835940797, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.922121 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.26599655804334316, 'auprc': 0.26599655804334316, 'loss_val': 1.1641949828122673, 'psi': 0.26599655804334316}-{'f1_val': 0.2675953479255436, 'auprc': 0.2675953479255436, 'loss_val': 1.1260121404018533, 'psi': 0.2675953479255436}
[S11] START round=30 head_norm_before_train=1.862397 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.6308014349905124, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.596827526159601, 'psi': 0.28036404111831337}
[S13] START round=30 head_norm_before_train=1.645813 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4490781712570067, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.417898434788547, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.456397 cos_to_last_merge=0.9827 (last merge round=26)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.9049485675439315, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.627534442981062, 'psi': 0.13582554517133957}
[S15] START round=30 head_norm_before_train=1.851786 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.7357086629258975, 'psi': 0.6152170947577895}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7450755013944843, 'psi': 0.6164158146233559}
[S16] START round=30 head_norm_before_train=1.773924 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.05828687278256462, 'auprc': 0.05828687278256462, 'loss_val': 5.241864809413626, 'psi': 0.05828687278256462}-{'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 4.928725428832839, 'psi': 0.09046591544793414}
[S17] START round=30 head_norm_before_train=1.797518 (no previous merge yet)
[S17] round=30 local utility u=0.000291 metrics={'f1_val': 0.2043226098698858, 'auprc': 0.2043226098698858, 'loss_val': 0.8388498495526592, 'psi': 0.2043226098698858}-{'f1_val': 0.2039558281958941, 'auprc': 0.2039558281958941, 'loss_val': 0.836131281584286, 'psi': 0.2039558281958941}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:62416
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S4
[S16] cosine check vs S4: cos=-0.0747
[S16] DROPPED delta from S4 (cos=-0.0747 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S6] ⇄ pheromone p=0.060 → S7@127.0.0.1:62408
[S9] ⇄ pheromone p=0.020 → S5@127.0.0.1:62405
[S14] ⇄ pheromone p=0.053 → S9@127.0.0.1:62410
[S2] ⇄ pheromone p=0.010 → S3@127.0.0.1:62403
[S15] ⇄ pheromone p=0.098 → S6@127.0.0.1:62407
[S11] ⇄ pheromone p=0.010 → S14@127.0.0.1:62414
[S5] ⇄ pheromone p=0.027 → S4@127.0.0.1:62404
[S4] ⇄ pheromone p=0.040 → S16@127.0.0.1:62416
[S2] START round=31 head_norm_before_train=1.808630 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.2513763763763764, 'auprc': 0.2513763763763764, 'loss_val': 3.063168039296677, 'psi': 0.2513763763763764}-{'f1_val': 0.25156523916854495, 'auprc': 0.25156523916854495, 'loss_val': 3.0439134824705056, 'psi': 0.25156523916854495}
[S3] START round=31 head_norm_before_train=2.043200 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.26101057274437306, 'auprc': 0.26101057274437306, 'loss_val': 3.1520084178903556, 'psi': 0.26101057274437306}-{'f1_val': 0.2609090319652467, 'auprc': 0.2609090319652467, 'loss_val': 3.1364335671919226, 'psi': 0.2609090319652467}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.629489 cos_to_last_merge=0.9952 (last merge round=27)
[S4] round=31 local utility u=0.005426 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.054480187722068, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0653317452181605, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.389397 cos_to_last_merge=0.9889 (last merge round=27)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.437382670155146, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.389544576680173, 'psi': 0.33308623671855697}
[S6] START round=31 head_norm_before_train=1.396658 cos_to_last_merge=0.9861 (last merge round=26)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 3.8954459052835215, 'psi': 0.10171428571428572}-{'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 3.7208033234213382, 'psi': 0.10171428571428572}
[S7] START round=31 head_norm_before_train=1.869547 (no previous merge yet)
[S7] round=31 local utility u=0.038453 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.004481592731963, 'psi': 0.2396131805157593}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.0813867459370252, 'psi': 0.2396131805157593}
[S7] not sending this round → trigger blocked (psi=0.240)
[S8] START round=31 head_norm_before_train=1.924425 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2630161951577497, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.224071884544935, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.368606 cos_to_last_merge=0.9600 (last merge round=26)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8265070096573834, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7308714808032308, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.956032 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.26095119800381184, 'auprc': 0.26095119800381184, 'loss_val': 1.1487860377024288, 'psi': 0.26095119800381184}-{'f1_val': 0.26599655804334316, 'auprc': 0.26599655804334316, 'loss_val': 1.1641949828122673, 'psi': 0.26599655804334316}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=1.873505 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.69339790123549, 'psi': 0.2803432239470754}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.6308014349905124, 'psi': 0.28036404111831337}
[S13] START round=31 head_norm_before_train=1.653894 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4772892417282462, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4490781712570067, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.489819 cos_to_last_merge=0.9761 (last merge round=26)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.089029794620488, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.9049485675439315, 'psi': 0.13582554517133957}
[S15] START round=31 head_norm_before_train=1.876896 (no previous merge yet)
[S15] round=31 local utility u=0.022773 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6989632077394561, 'psi': 0.6161950003225232}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.7357086629258975, 'psi': 0.6152170947577895}
[S16] START round=31 head_norm_before_train=1.782612 (no previous merge yet)
[S16] round=31 local utility u=1.000000 metrics={'f1_val': 0.15075448759207608, 'auprc': 0.15075448759207608, 'loss_val': 3.9231112089284963, 'psi': 0.15075448759207608}-{'f1_val': 0.05828687278256462, 'auprc': 0.05828687278256462, 'loss_val': 5.241864809413626, 'psi': 0.05828687278256462}
[S16] not sending this round → trigger blocked (psi=0.151)
[S17] START round=31 head_norm_before_train=1.815203 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.20760990082063083, 'auprc': 0.20760990082063083, 'loss_val': 0.871722635734009, 'psi': 0.20760990082063083}-{'f1_val': 0.2043226098698858, 'auprc': 0.2043226098698858, 'loss_val': 0.8388498495526592, 'psi': 0.2043226098698858}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:62416
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1800) from S15
[S6] cosine check vs S15: cos=-0.0071
[S6] DROPPED delta from S15 (cos=-0.0071 < 0.0)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S4
[S16] cosine check vs S4: cos=-0.0748
[S16] DROPPED delta from S4 (cos=-0.0748 < 0.0)
[S5] CommDone barrier timeout: have=0 need=1 — continuing
[S6] RoundReady barrier timeout: have=1 need=2 — continuing
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] RoundReady barrier timeout: have=1 need=2 — continuing
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5]  timeout peer S4
[S5]  timeout peer S17
[S2]  timeout peer S3
[S6]  timeout peer S2
[S6]  timeout peer S7
[S6]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S15
[S4]  timeout peer S10
[S4]  timeout peer S16
[S11]  timeout peer S14
[S15]  timeout peer S6
[S9]  timeout peer S5
[S9]  timeout peer S11
[S9]  timeout peer S13
[S2] START round=32 head_norm_before_train=1.817407 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.25109361329833774, 'auprc': 0.25109361329833774, 'loss_val': 3.079742438993783, 'psi': 0.25109361329833774}-{'f1_val': 0.2513763763763764, 'auprc': 0.2513763763763764, 'loss_val': 3.063168039296677, 'psi': 0.2513763763763764}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=2.051786 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.261061372777994, 'auprc': 0.261061372777994, 'loss_val': 3.168065210977696, 'psi': 0.261061372777994}-{'f1_val': 0.26101057274437306, 'auprc': 0.26101057274437306, 'loss_val': 3.1520084178903556, 'psi': 0.26101057274437306}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.654222 cos_to_last_merge=0.9934 (last merge round=27)
[S4] round=32 local utility u=0.006159 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0421630447102168, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.054480187722068, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=32 head_norm_before_train=1.441828 cos_to_last_merge=0.9827 (last merge round=27)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.498037393176149, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.437382670155146, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.422856 cos_to_last_merge=0.9824 (last merge round=26)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 4.026223747050763, 'psi': 0.10171428571428572}-{'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 3.8954459052835215, 'psi': 0.10171428571428572}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.883804 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0919156887971162, 'psi': 0.23968964488212474}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.004481592731963, 'psi': 0.2396131805157593}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.940655 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3009360207959486, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2630161951577497, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.399032 cos_to_last_merge=0.9543 (last merge round=26)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.897601376052704, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8265070096573834, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.986899 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.24104686680684304, 'auprc': 0.24104686680684304, 'loss_val': 1.215478871843511, 'psi': 0.241046866806843}-{'f1_val': 0.26095119800381184, 'auprc': 0.26095119800381184, 'loss_val': 1.1487860377024288, 'psi': 0.26095119800381184}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.883926 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.710465192059131, 'psi': 0.28041912246234446}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.69339790123549, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.664330 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.505058930385609, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4772892417282462, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.517981 cos_to_last_merge=0.9709 (last merge round=26)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.220847908734907, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.089029794620488, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.902328 (no previous merge yet)
[S15] round=32 local utility u=0.017713 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6635364288697293, 'psi': 0.6161950003225232}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6989632077394561, 'psi': 0.6161950003225232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=32 head_norm_before_train=1.790147 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.09056061332055582, 'auprc': 0.09056061332055582, 'loss_val': 4.733920449477364, 'psi': 0.09056061332055582}-{'f1_val': 0.15075448759207608, 'auprc': 0.15075448759207608, 'loss_val': 3.9231112089284963, 'psi': 0.15075448759207608}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.830265 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.2015165537983156, 'auprc': 0.2015165537983156, 'loss_val': 0.8761770186942145, 'psi': 0.2015165537983156}-{'f1_val': 0.20760990082063083, 'auprc': 0.20760990082063083, 'loss_val': 0.871722635734009, 'psi': 0.20760990082063083}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.825506 (no previous merge yet)
[S2] round=33 local utility u=0.015436 metrics={'f1_val': 0.2567740286298568, 'auprc': 0.2567740286298568, 'loss_val': 3.0999937289539146, 'psi': 0.2567740286298568}-{'f1_val': 0.25109361329833774, 'auprc': 0.25109361329833774, 'loss_val': 3.079742438993783, 'psi': 0.25109361329833774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=33 head_norm_before_train=2.060070 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.2609597924773022, 'auprc': 0.2609597924773022, 'loss_val': 3.1824219659620154, 'psi': 0.2609597924773022}-{'f1_val': 0.261061372777994, 'auprc': 0.261061372777994, 'loss_val': 3.168065210977696, 'psi': 0.261061372777994}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.678318 cos_to_last_merge=0.9916 (last merge round=27)
[S4] round=33 local utility u=0.006482 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0291991738144115, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0421630447102168, 'psi': 0.3567939207526687}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] START round=33 head_norm_before_train=1.487882 cos_to_last_merge=0.9772 (last merge round=27)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5437180336120293, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.498037393176149, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.445317 cos_to_last_merge=0.9792 (last merge round=26)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.1219092457106, 'psi': 0.1017530487804878}-{'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 4.026223747050763, 'psi': 0.10171428571428572}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.898979 (no previous merge yet)
[S7] round=33 local utility u=0.016061 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.0591051441048593, 'psi': 0.2396131805157593}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0919156887971162, 'psi': 0.23968964488212474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=33 head_norm_before_train=1.956891 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.344397422844885, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3009360207959486, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.422935 cos_to_last_merge=0.9499 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.950
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.948599817792461, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.897601376052704, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=2.015193 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.24023520871322154, 'auprc': 0.24023520871322154, 'loss_val': 1.2350925298781008, 'psi': 0.24023520871322157}-{'f1_val': 0.24104686680684304, 'auprc': 0.24104686680684304, 'loss_val': 1.215478871843511, 'psi': 0.241046866806843}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.893749 (no previous merge yet)
[S11] round=33 local utility u=0.002278 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.705414243095104, 'psi': 0.28036404111831337}-{'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.710465192059131, 'psi': 0.28041912246234446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=33 head_norm_before_train=1.673440 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5085982192280505, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.505058930385609, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.541013 cos_to_last_merge=0.9668 (last merge round=26)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.321109010514139, 'psi': 0.13577478824115594}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.220847908734907, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.927408 (no previous merge yet)
[S15] round=33 local utility u=0.011293 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6308890520793073, 'psi': 0.6150769866718802}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6635364288697293, 'psi': 0.6161950003225232}
[S15] not sending this round → trigger blocked (psi=0.615)
[S16] START round=33 head_norm_before_train=1.798029 (no previous merge yet)
[S16] round=33 local utility u=0.019174 metrics={'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 4.694719431015587, 'psi': 0.09046591544793414}-{'f1_val': 0.09056061332055582, 'auprc': 0.09056061332055582, 'loss_val': 4.733920449477364, 'psi': 0.09056061332055582}
[S16] not sending this round → trigger blocked (psi=0.090)
[S17] START round=33 head_norm_before_train=1.847725 (no previous merge yet)
[S17] round=33 local utility u=0.413097 metrics={'f1_val': 0.3093027372931954, 'auprc': 0.3093027372931954, 'loss_val': 1.020058889671876, 'psi': 0.3093027372931954}-{'f1_val': 0.2015165537983156, 'auprc': 0.2015165537983156, 'loss_val': 0.8761770186942145, 'psi': 0.2015165537983156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=34 head_norm_before_train=1.833219 (no previous merge yet)
[S2] round=34 local utility u=0.003702 metrics={'f1_val': 0.2623571661769507, 'auprc': 0.2623571661769507, 'loss_val': 3.142838487088321, 'psi': 0.2623571661769507}-{'f1_val': 0.2567740286298568, 'auprc': 0.2567740286298568, 'loss_val': 3.0999937289539146, 'psi': 0.2567740286298568}
[S2] not sending this round → trigger blocked (psi=0.262)
[S3] START round=34 head_norm_before_train=2.068234 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.26146848602988954, 'auprc': 0.26146848602988954, 'loss_val': 3.1948439817098966, 'psi': 0.26146848602988954}-{'f1_val': 0.2609597924773022, 'auprc': 0.2609597924773022, 'loss_val': 3.1824219659620154, 'psi': 0.2609597924773022}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.702860 cos_to_last_merge=0.9897 (last merge round=27)
[S4] round=34 local utility u=0.003951 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.021296773642847, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0291991738144115, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=34 head_norm_before_train=1.536910 cos_to_last_merge=0.9709 (last merge round=27)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.56865177327031, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5437180336120293, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.465025 cos_to_last_merge=0.9765 (last merge round=26)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.205208058607816, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.1219092457106, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.914023 (no previous merge yet)
[S7] round=34 local utility u=0.005168 metrics={'f1_val': 0.23907716215408523, 'auprc': 0.23907716215408523, 'loss_val': 1.0439441307342985, 'psi': 0.2390771621540852}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.0591051441048593, 'psi': 0.2396131805157593}
[S7] not sending this round → trigger blocked (psi=0.239)
[S8] START round=34 head_norm_before_train=1.971217 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3864780596908313, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.344397422844885, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.443305 cos_to_last_merge=0.9462 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9939160458716798, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.948599817792461, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=2.040089 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.22753969980422015, 'auprc': 0.22753969980422015, 'loss_val': 1.3064069656046735, 'psi': 0.22753969980422017}-{'f1_val': 0.24023520871322154, 'auprc': 0.24023520871322154, 'loss_val': 1.2350925298781008, 'psi': 0.24023520871322157}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.902851 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.7328858508481697, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.705414243095104, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.680600 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5384403622125247, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5085982192280505, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.559946 cos_to_last_merge=0.9634 (last merge round=26)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.40781769760222, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.321109010514139, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.950392 (no previous merge yet)
[S15] round=34 local utility u=0.018015 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.6081618414377168, 'psi': 0.6165550083006743}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6308890520793073, 'psi': 0.6150769866718802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=34 head_norm_before_train=1.805718 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 4.712544572716004, 'psi': 0.09046591544793414}-{'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 4.694719431015587, 'psi': 0.09046591544793414}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.863580 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.2647815846880903, 'auprc': 0.2647815846880903, 'loss_val': 0.9572479961719339, 'psi': 0.2647815846880903}-{'f1_val': 0.3093027372931954, 'auprc': 0.3093027372931954, 'loss_val': 1.020058889671876, 'psi': 0.3093027372931954}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.840506 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.258159856078129, 'auprc': 0.258159856078129, 'loss_val': 3.1394098591844903, 'psi': 0.258159856078129}-{'f1_val': 0.2623571661769507, 'auprc': 0.2623571661769507, 'loss_val': 3.142838487088321, 'psi': 0.2623571661769507}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.076064 (no previous merge yet)
[S3] round=35 local utility u=0.005835 metrics={'f1_val': 0.26430213464696223, 'auprc': 0.26430213464696223, 'loss_val': 3.208676276121864, 'psi': 0.26430213464696223}-{'f1_val': 0.26146848602988954, 'auprc': 0.26146848602988954, 'loss_val': 3.1948439817098966, 'psi': 0.26146848602988954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=35 head_norm_before_train=1.721461 cos_to_last_merge=0.9881 (last merge round=27)
[S4] round=35 local utility u=0.003323 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0146505395096512, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.021296773642847, 'psi': 0.3567939207526687}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] START round=35 head_norm_before_train=1.585065 cos_to_last_merge=0.9645 (last merge round=27)
[S5] round=35 local utility u=0.005266 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5619069388876436, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.56865177327031, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=35 head_norm_before_train=1.482221 cos_to_last_merge=0.9741 (last merge round=26)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.28140258277786, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.205208058607816, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.928542 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 1.0809828126074816, 'psi': 0.23938362300662963}-{'f1_val': 0.23907716215408523, 'auprc': 0.23907716215408523, 'loss_val': 1.0439441307342985, 'psi': 0.2390771621540852}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.978160 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4223907709870818, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3864780596908313, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.461293 cos_to_last_merge=0.9431 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.943
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0373596031733086, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9939160458716798, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=2.063010 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.2237433155080214, 'auprc': 0.2237433155080214, 'loss_val': 1.371995631966494, 'psi': 0.2237433155080214}-{'f1_val': 0.22753969980422015, 'auprc': 0.22753969980422015, 'loss_val': 1.3064069656046735, 'psi': 0.22753969980422017}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.911283 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.7792994487557903, 'psi': 0.2803432239470754}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.7328858508481697, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.690195 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.559318604842928, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5384403622125247, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.576019 cos_to_last_merge=0.9607 (last merge round=26)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.479325567651444, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.40781769760222, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.971309 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6138929228602734, 'auprc': 0.6138929228602734, 'loss_val': 0.6467380675179777, 'psi': 0.6138929228602734}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.6081618414377168, 'psi': 0.6165550083006743}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.813469 (no previous merge yet)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.055824213116144904, 'auprc': 0.055824213116144904, 'loss_val': 5.067158190640986, 'psi': 0.05582421311614491}-{'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 4.712544572716004, 'psi': 0.09046591544793414}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.881425 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.2631829921668391, 'auprc': 0.2631829921668391, 'loss_val': 1.0063013027111, 'psi': 0.2631829921668391}-{'f1_val': 0.2647815846880903, 'auprc': 0.2647815846880903, 'loss_val': 0.9572479961719339, 'psi': 0.2647815846880903}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.847541 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.2554030002542588, 'auprc': 0.2554030002542588, 'loss_val': 3.136007370964989, 'psi': 0.2554030002542588}-{'f1_val': 0.258159856078129, 'auprc': 0.258159856078129, 'loss_val': 3.1394098591844903, 'psi': 0.258159856078129}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.083558 (no previous merge yet)
[S3] round=36 local utility u=0.000227 metrics={'f1_val': 0.26608477154003835, 'auprc': 0.26608477154003835, 'loss_val': 3.2242650574253093, 'psi': 0.26608477154003835}-{'f1_val': 0.26430213464696223, 'auprc': 0.26430213464696223, 'loss_val': 3.208676276121864, 'psi': 0.26430213464696223}
[S3] not sending this round → trigger blocked (psi=0.266)
[S4] START round=36 head_norm_before_train=1.738886 cos_to_last_merge=0.9866 (last merge round=27)
[S4] round=36 local utility u=0.002230 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0101903421944427, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0146505395096512, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=36 head_norm_before_train=1.631509 cos_to_last_merge=0.9581 (last merge round=27)
[S5] round=36 local utility u=0.002162 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.557582625289358, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5619069388876436, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=36 head_norm_before_train=1.497280 cos_to_last_merge=0.9720 (last merge round=26)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.352983359163276, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.28140258277786, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.941149 (no previous merge yet)
[S7] round=36 local utility u=0.002900 metrics={'f1_val': 0.23907716215408523, 'auprc': 0.23907716215408523, 'loss_val': 1.0724242170416074, 'psi': 0.2390771621540852}-{'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 1.0809828126074816, 'psi': 0.23938362300662963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=36 head_norm_before_train=1.987205 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4544370719662731, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4223907709870818, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.477402 cos_to_last_merge=0.9404 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0786809604703698, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0373596031733086, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=2.084448 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.22155005604640557, 'auprc': 0.22155005604640557, 'loss_val': 1.436737481844461, 'psi': 0.22155005604640557}-{'f1_val': 0.2237433155080214, 'auprc': 0.2237433155080214, 'loss_val': 1.371995631966494, 'psi': 0.2237433155080214}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.919588 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.8125304930888593, 'psi': 0.280398322851153}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.7792994487557903, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.700465 (no previous merge yet)
[S13] round=36 local utility u=0.001683 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5559535781806502, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.559318604842928, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=36 head_norm_before_train=1.590465 cos_to_last_merge=0.9584 (last merge round=26)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.542803634952805, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.479325567651444, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.988721 (no previous merge yet)
[S15] round=36 local utility u=0.005346 metrics={'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.6391167093973488, 'psi': 0.6142341889454641}-{'f1_val': 0.6138929228602734, 'auprc': 0.6138929228602734, 'loss_val': 0.6467380675179777, 'psi': 0.6138929228602734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=36 head_norm_before_train=1.819039 (no previous merge yet)
[S16] round=36 local utility u=0.768419 metrics={'f1_val': 0.1346607669616519, 'auprc': 0.1346607669616519, 'loss_val': 4.239849432556037, 'psi': 0.1346607669616519}-{'f1_val': 0.055824213116144904, 'auprc': 0.055824213116144904, 'loss_val': 5.067158190640986, 'psi': 0.05582421311614491}
[S16] not sending this round → trigger blocked (psi=0.135)
[S17] START round=36 head_norm_before_train=1.902116 (no previous merge yet)
[S17] round=36 local utility u=0.191044 metrics={'f1_val': 0.3185366503077137, 'auprc': 0.3185366503077137, 'loss_val': 1.1223971806352262, 'psi': 0.3185366503077137}-{'f1_val': 0.2631829921668391, 'auprc': 0.2631829921668391, 'loss_val': 1.0063013027111, 'psi': 0.2631829921668391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=37 head_norm_before_train=1.854357 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.2514235654840123, 'auprc': 0.2514235654840123, 'loss_val': 3.147862427294472, 'psi': 0.2514235654840123}-{'f1_val': 0.2554030002542588, 'auprc': 0.2554030002542588, 'loss_val': 3.136007370964989, 'psi': 0.2554030002542588}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=2.090647 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.2645627876397107, 'auprc': 0.2645627876397107, 'loss_val': 3.2405177074056764, 'psi': 0.2645627876397107}-{'f1_val': 0.26608477154003835, 'auprc': 0.26608477154003835, 'loss_val': 3.2242650574253093, 'psi': 0.26608477154003835}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.753234 cos_to_last_merge=0.9853 (last merge round=27)
[S4] round=37 local utility u=0.002184 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0058228603495025, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0101903421944427, 'psi': 0.3567939207526687}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] START round=37 head_norm_before_train=1.664943 cos_to_last_merge=0.9534 (last merge round=27)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5978864143006293, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.557582625289358, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.510815 cos_to_last_merge=0.9700 (last merge round=26)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.415462144049925, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.352983359163276, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.954106 (no previous merge yet)
[S7] round=37 local utility u=0.035283 metrics={'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 1.005994155676982, 'psi': 0.23953668875753775}-{'f1_val': 0.23907716215408523, 'auprc': 0.23907716215408523, 'loss_val': 1.0724242170416074, 'psi': 0.2390771621540852}
[S7] not sending this round → trigger blocked (psi=0.240)
[S8] START round=37 head_norm_before_train=1.996421 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4860436642797998, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4544370719662731, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.492145 cos_to_last_merge=0.9379 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.938
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1152851733478633, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0786809604703698, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.104186 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.21960207320099911, 'auprc': 0.21960207320099911, 'loss_val': 1.504737533322765, 'psi': 0.21960207320099911}-{'f1_val': 0.22155005604640557, 'auprc': 0.22155005604640557, 'loss_val': 1.436737481844461, 'psi': 0.22155005604640557}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.927224 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.8315845198795975, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.8125304930888593, 'psi': 0.280398322851153}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.706173 (no previous merge yet)
[S13] round=37 local utility u=0.006391 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5431707709125757, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5559535781806502, 'psi': 0.3599362944611573}
[S13] not sending this round → trigger blocked (psi=0.360)
[S14] START round=37 head_norm_before_train=1.603233 cos_to_last_merge=0.9564 (last merge round=26)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.5986085370658545, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.542803634952805, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=2.002725 (no previous merge yet)
[S15] round=37 local utility u=0.039683 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5786522761361975, 'psi': 0.6163342951580373}-{'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.6391167093973488, 'psi': 0.6142341889454641}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=37 head_norm_before_train=1.825087 (no previous merge yet)
[S16] round=37 local utility u=0.013352 metrics={'f1_val': 0.1371210452910519, 'auprc': 0.1371210452910519, 'loss_val': 4.235288919421499, 'psi': 0.1371210452910519}-{'f1_val': 0.1346607669616519, 'auprc': 0.1346607669616519, 'loss_val': 4.239849432556037, 'psi': 0.1346607669616519}
[S16] not sending this round → trigger blocked (psi=0.137)
[S17] START round=37 head_norm_before_train=1.920359 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.2775523228567194, 'auprc': 0.2775523228567194, 'loss_val': 1.0276021978836376, 'psi': 0.2775523228567194}-{'f1_val': 0.3185366503077137, 'auprc': 0.3185366503077137, 'loss_val': 1.1223971806352262, 'psi': 0.3185366503077137}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.860920 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.2517070726054, 'auprc': 0.2517070726054, 'loss_val': 3.1601781266032676, 'psi': 0.2517070726054}-{'f1_val': 0.2514235654840123, 'auprc': 0.2514235654840123, 'loss_val': 3.147862427294472, 'psi': 0.2514235654840123}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.097486 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.2618768710139268, 'auprc': 0.2618768710139268, 'loss_val': 3.2512568929573873, 'psi': 0.2618768710139268}-{'f1_val': 0.2645627876397107, 'auprc': 0.2645627876397107, 'loss_val': 3.2405177074056764, 'psi': 0.2645627876397107}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.763515 cos_to_last_merge=0.9844 (last merge round=27)
[S4] round=38 local utility u=0.000812 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0041987030881614, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0058228603495025, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=38 head_norm_before_train=1.701088 cos_to_last_merge=0.9490 (last merge round=27)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.647102190918244, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5978864143006293, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.523173 cos_to_last_merge=0.9682 (last merge round=26)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.471087890723256, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.415462144049925, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.966337 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 1.1765551224911255, 'psi': 0.23953668875753775}-{'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 1.005994155676982, 'psi': 0.23953668875753775}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=2.006397 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5171470196540262, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4860436642797998, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.505859 cos_to_last_merge=0.9356 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.936
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.147470595101889, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1152851733478633, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.122732 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.21974007648088587, 'auprc': 0.21974007648088587, 'loss_val': 1.5285887710021762, 'psi': 0.21974007648088587}-{'f1_val': 0.21960207320099911, 'auprc': 0.21960207320099911, 'loss_val': 1.504737533322765, 'psi': 0.21960207320099911}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.934699 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.8429563085620737, 'psi': 0.2803432239470754}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.8315845198795975, 'psi': 0.280398322851153}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.709500 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5638576002892437, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5431707709125757, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.615002 cos_to_last_merge=0.9546 (last merge round=26)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.653068520323323, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.5986085370658545, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=2.018318 (no previous merge yet)
[S15] round=38 local utility u=0.004137 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5703774487378294, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5786522761361975, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=38 head_norm_before_train=1.832306 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.09083652618135378, 'auprc': 0.09083652618135378, 'loss_val': 4.760753719896382, 'psi': 0.09083652618135378}-{'f1_val': 0.1371210452910519, 'auprc': 0.1371210452910519, 'loss_val': 4.235288919421499, 'psi': 0.1371210452910519}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.933679 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 1.3143155092279442, 'psi': 0.30875549754205167}-{'f1_val': 0.2775523228567194, 'auprc': 0.2775523228567194, 'loss_val': 1.0276021978836376, 'psi': 0.2775523228567194}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.867312 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.25218100797087806, 'auprc': 0.25218100797087806, 'loss_val': 3.172993771972092, 'psi': 0.25218100797087806}-{'f1_val': 0.2517070726054, 'auprc': 0.2517070726054, 'loss_val': 3.1601781266032676, 'psi': 0.2517070726054}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.252 u=0.0000 p_local=0.0024 f1=0.252 auprc=0.252 bytes=14394
[S3] START round=39 head_norm_before_train=2.104150 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.2621839979150378, 'auprc': 0.2621839979150378, 'loss_val': 3.2619892316935735, 'psi': 0.2621839979150378}-{'f1_val': 0.2618768710139268, 'auprc': 0.2618768710139268, 'loss_val': 3.2512568929573873, 'psi': 0.2618768710139268}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.262 u=0.0000 p_local=0.0013 f1=0.262 auprc=0.262 bytes=7185
[S4] START round=39 head_norm_before_train=1.777930 cos_to_last_merge=0.9831 (last merge round=27)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0075842972081448, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0041987030881614, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0073 f1=0.357 auprc=0.357 bytes=27008
[S5] START round=39 head_norm_before_train=1.736235 cos_to_last_merge=0.9450 (last merge round=27)
[S5] ⚠️ Model drifted since last merge! cos=0.945
[S5] round=39 local utility u=0.002456 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.642189899559738, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.647102190918244, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S5] r=40 psi=0.334 u=0.0025 p_local=0.0047 f1=0.334 auprc=0.334 bytes=28772
[S6] START round=39 head_norm_before_train=1.534604 cos_to_last_merge=0.9666 (last merge round=26)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.5193018633335305, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.471087890723256, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.102 u=0.0000 p_local=0.0081 f1=0.102 auprc=0.102 bytes=0
[S7] START round=39 head_norm_before_train=1.976637 (no previous merge yet)
[S7] round=39 local utility u=0.083485 metrics={'f1_val': 0.2389237668161435, 'auprc': 0.2389237668161435, 'loss_val': 1.004069524026255, 'psi': 0.23892376681614352}-{'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 1.1765551224911255, 'psi': 0.23953668875753775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S7] r=40 psi=0.239 u=0.0835 p_local=0.0371 f1=0.239 auprc=0.239 bytes=30637
[S8] START round=39 head_norm_before_train=2.014402 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5480873110566362, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5171470196540262, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0034 f1=0.359 auprc=0.359 bytes=17970
[S9] START round=39 head_norm_before_train=1.518439 cos_to_last_merge=0.9335 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.933
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.183029550936888, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.147470595101889, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0027 f1=0.369 auprc=0.369 bytes=17980
[S10] START round=39 head_norm_before_train=2.140187 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.2165646030363138, 'auprc': 0.2165646030363138, 'loss_val': 1.6097316789572602, 'psi': 0.2165646030363138}-{'f1_val': 0.21974007648088587, 'auprc': 0.21974007648088587, 'loss_val': 1.5285887710021762, 'psi': 0.21974007648088587}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.217 u=0.0000 p_local=0.0098 f1=0.217 auprc=0.217 bytes=25233
[S11] START round=39 head_norm_before_train=1.941813 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.8495587641429707, 'psi': 0.28041912246234446}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.8429563085620737, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.280 u=0.0000 p_local=0.0015 f1=0.280 auprc=0.280 bytes=9007
[S13] START round=39 head_norm_before_train=1.714026 (no previous merge yet)
[S13] round=39 local utility u=0.002149 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5595593171766473, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5638576002892437, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S13] r=40 psi=0.360 u=0.0021 p_local=0.0030 f1=0.360 auprc=0.360 bytes=12580
[S14] START round=39 head_norm_before_train=1.625766 cos_to_last_merge=0.9529 (last merge round=26)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.7044076295934705, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.653068520323323, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0071 f1=0.136 auprc=0.136 bytes=0
[S15] START round=39 head_norm_before_train=2.035532 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5844974566510931, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5703774487378294, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.616 u=0.0000 p_local=0.0227 f1=0.616 auprc=0.616 bytes=34205
[S16] START round=39 head_norm_before_train=1.840078 (no previous merge yet)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.04733625957483432, 'auprc': 0.04733625957483432, 'loss_val': 5.475229632062659, 'psi': 0.04733625957483432}-{'f1_val': 0.09083652618135378, 'auprc': 0.09083652618135378, 'loss_val': 4.760753719896382, 'psi': 0.09083652618135378}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.047 u=0.0000 p_local=0.1351 f1=0.047 auprc=0.047 bytes=0
[S17] START round=39 head_norm_before_train=1.946890 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.25842461585273085, 'auprc': 0.25842461585273085, 'loss_val': 1.2300407193912355, 'psi': 0.25842461585273085}-{'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 1.3143155092279442, 'psi': 0.30875549754205167}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.258 u=0.0000 p_local=0.0475 f1=0.258 auprc=0.258 bytes=34200
[S2] START round=40 head_norm_before_train=1.873544 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.2517070726054, 'auprc': 0.2517070726054, 'loss_val': 3.1856650228169574, 'psi': 0.2517070726054}-{'f1_val': 0.25218100797087806, 'auprc': 0.25218100797087806, 'loss_val': 3.172993771972092, 'psi': 0.25218100797087806}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.110775 (no previous merge yet)
[S3] round=40 local utility u=0.006222 metrics={'f1_val': 0.264823955248437, 'auprc': 0.264823955248437, 'loss_val': 3.2733047878098667, 'psi': 0.264823955248437}-{'f1_val': 0.2621839979150378, 'auprc': 0.2621839979150378, 'loss_val': 3.2619892316935735, 'psi': 0.2621839979150378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=40 head_norm_before_train=1.791536 cos_to_last_merge=0.9819 (last merge round=27)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.010730237008188, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0075842972081448, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.760021 cos_to_last_merge=0.9418 (last merge round=27)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6731234897966667, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.642189899559738, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.545534 cos_to_last_merge=0.9651 (last merge round=26)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 4.558324871850654, 'psi': 0.10171428571428572}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.5193018633335305, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.988195 (no previous merge yet)
[S7] round=40 local utility u=0.091729 metrics={'f1_val': 0.23884702786748, 'auprc': 0.23884702786748, 'loss_val': 0.8199201095308178, 'psi': 0.23884702786748}-{'f1_val': 0.2389237668161435, 'auprc': 0.2389237668161435, 'loss_val': 1.004069524026255, 'psi': 0.23892376681614352}
[S7] not sending this round → trigger blocked (psi=0.239)
[S8] START round=40 head_norm_before_train=2.021949 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5784848916707117, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5480873110566362, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.530714 cos_to_last_merge=0.9314 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.931
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.211834005200214, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.183029550936888, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.156119 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.21611845131034857, 'auprc': 0.21611845131034857, 'loss_val': 1.6337922173238044, 'psi': 0.21611845131034857}-{'f1_val': 0.2165646030363138, 'auprc': 0.2165646030363138, 'loss_val': 1.6097316789572602, 'psi': 0.2165646030363138}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.948674 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.858828189993949, 'psi': 0.28036404111831337}-{'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.8495587641429707, 'psi': 0.28041912246234446}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.718747 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5803937406007642, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5595593171766473, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.635667 cos_to_last_merge=0.9514 (last merge round=26)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.752525701035627, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.7044076295934705, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=2.053483 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6054417574077889, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5844974566510931, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.846836 (no previous merge yet)
[S16] round=40 local utility u=0.860763 metrics={'f1_val': 0.1346607669616519, 'auprc': 0.1346607669616519, 'loss_val': 4.539624313309556, 'psi': 0.1346607669616519}-{'f1_val': 0.04733625957483432, 'auprc': 0.04733625957483432, 'loss_val': 5.475229632062659, 'psi': 0.04733625957483432}
[S16] not sending this round → trigger blocked (psi=0.135)
[S17] START round=40 head_norm_before_train=1.958415 (no previous merge yet)
[S17] round=40 local utility u=0.918725 metrics={'f1_val': 0.4137288458626398, 'auprc': 0.4137288458626398, 'loss_val': 0.7903296447144919, 'psi': 0.4137288458626398}-{'f1_val': 0.25842461585273085, 'auprc': 0.25842461585273085, 'loss_val': 1.2300407193912355, 'psi': 0.25842461585273085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=41 head_norm_before_train=1.879658 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.2517070726054, 'auprc': 0.2517070726054, 'loss_val': 3.1975519106272627, 'psi': 0.2517070726054}-{'f1_val': 0.2517070726054, 'auprc': 0.2517070726054, 'loss_val': 3.1856650228169574, 'psi': 0.2517070726054}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.117117 (no previous merge yet)
[S3] round=41 local utility u=0.013932 metrics={'f1_val': 0.26901992244952533, 'auprc': 0.26901992244952533, 'loss_val': 3.2832048163661094, 'psi': 0.26901992244952533}-{'f1_val': 0.264823955248437, 'auprc': 0.264823955248437, 'loss_val': 3.2733047878098667, 'psi': 0.264823955248437}
[S3] not sending this round → trigger blocked (psi=0.269)
[S4] START round=41 head_norm_before_train=1.804786 cos_to_last_merge=0.9806 (last merge round=27)
[S4] round=41 local utility u=0.000846 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0090386339039417, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.010730237008188, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=41 head_norm_before_train=1.780900 cos_to_last_merge=0.9393 (last merge round=27)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=41 local utility u=0.000197 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6727287392951866, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6731234897966667, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=41 head_norm_before_train=1.555930 cos_to_last_merge=0.9637 (last merge round=26)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 4.604014754920121, 'psi': 0.10171428571428572}-{'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 4.558324871850654, 'psi': 0.10171428571428572}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=2.001187 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.23877026137926907, 'auprc': 0.23877026137926907, 'loss_val': 1.1661632719922304, 'psi': 0.23877026137926907}-{'f1_val': 0.23884702786748, 'auprc': 0.23884702786748, 'loss_val': 0.8199201095308178, 'psi': 0.23884702786748}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=2.026601 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6046429915635905, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5784848916707117, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.542056 cos_to_last_merge=0.9295 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.238983657243777, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.211834005200214, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.170628 (no previous merge yet)
[S10] round=41 local utility u=0.001407 metrics={'f1_val': 0.21665405484254974, 'auprc': 0.21665405484254974, 'loss_val': 1.6357995523899638, 'psi': 0.21665405484254974}-{'f1_val': 0.21611845131034857, 'auprc': 0.21611845131034857, 'loss_val': 1.6337922173238044, 'psi': 0.21611845131034857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=41 head_norm_before_train=1.955183 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.8768524562640874, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.858828189993949, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.723918 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.615845937449706, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5803937406007642, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.645024 cos_to_last_merge=0.9499 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.950
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.797653422789235, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.752525701035627, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.071626 (no previous merge yet)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6272573089753777, 'psi': 0.6161950003225232}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6054417574077889, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.853369 (no previous merge yet)
[S16] round=41 local utility u=0.253102 metrics={'f1_val': 0.1521894166310084, 'auprc': 0.1521894166310084, 'loss_val': 4.191177943496968, 'psi': 0.1521894166310084}-{'f1_val': 0.1346607669616519, 'auprc': 0.1346607669616519, 'loss_val': 4.539624313309556, 'psi': 0.1346607669616519}
[S16] not sending this round → trigger blocked (psi=0.152)
[S17] START round=41 head_norm_before_train=1.968239 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.32069056703562393, 'auprc': 0.32069056703562393, 'loss_val': 1.3132830156181095, 'psi': 0.32069056703562393}-{'f1_val': 0.4137288458626398, 'auprc': 0.4137288458626398, 'loss_val': 0.7903296447144919, 'psi': 0.4137288458626398}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.885518 (no previous merge yet)
[S2] round=42 local utility u=0.004780 metrics={'f1_val': 0.25399835640685253, 'auprc': 0.25399835640685253, 'loss_val': 3.2086141412751674, 'psi': 0.25399835640685253}-{'f1_val': 0.2517070726054, 'auprc': 0.2517070726054, 'loss_val': 3.1975519106272627, 'psi': 0.2517070726054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=42 head_norm_before_train=2.123162 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.2697231717943562, 'auprc': 0.2697231717943562, 'loss_val': 3.2948165920491195, 'psi': 0.2697231717943562}-{'f1_val': 0.26901992244952533, 'auprc': 0.26901992244952533, 'loss_val': 3.2832048163661094, 'psi': 0.26901992244952533}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.820011 cos_to_last_merge=0.9792 (last merge round=27)
[S4] round=42 local utility u=0.001817 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0054056137288372, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0090386339039417, 'psi': 0.3567939207526687}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] START round=42 head_norm_before_train=1.797314 cos_to_last_merge=0.9371 (last merge round=27)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6934459700387605, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6727287392951866, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.565386 cos_to_last_merge=0.9623 (last merge round=26)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.6498910199405366, 'psi': 0.1017530487804878}-{'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 4.604014754920121, 'psi': 0.10171428571428572}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=2.008775 (no previous merge yet)
[S7] round=42 local utility u=0.004933 metrics={'f1_val': 0.2383860153256705, 'auprc': 0.2383860153256705, 'loss_val': 1.1528398901063401, 'psi': 0.2383860153256705}-{'f1_val': 0.23877026137926907, 'auprc': 0.23877026137926907, 'loss_val': 1.1661632719922304, 'psi': 0.23877026137926907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=42 head_norm_before_train=2.034575 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6257827224212011, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6046429915635905, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.552763 cos_to_last_merge=0.9277 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.928
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.265871603031443, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.238983657243777, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.184454 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.21394968296175088, 'auprc': 0.21394968296175088, 'loss_val': 1.7076132515223412, 'psi': 0.21394968296175088}-{'f1_val': 0.21665405484254974, 'auprc': 0.21665405484254974, 'loss_val': 1.6357995523899638, 'psi': 0.21665405484254974}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.961494 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.896595984394527, 'psi': 0.2803432239470754}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.8768524562640874, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.728712 (no previous merge yet)
[S13] round=42 local utility u=0.000760 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6143268577857566, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.615845937449706, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] START round=42 head_norm_before_train=1.653973 cos_to_last_merge=0.9486 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.949
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.842191973693459, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.797653422789235, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.089216 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.6147964639178166, 'auprc': 0.6147964639178166, 'loss_val': 0.6306057739589548, 'psi': 0.6147964639178166}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6272573089753777, 'psi': 0.6161950003225232}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.860064 (no previous merge yet)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.12507507507507507, 'auprc': 0.12507507507507507, 'loss_val': 4.908181958083733, 'psi': 0.12507507507507507}-{'f1_val': 0.1521894166310084, 'auprc': 0.1521894166310084, 'loss_val': 4.191177943496968, 'psi': 0.1521894166310084}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.975028 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.2912723377940157, 'auprc': 0.2912723377940157, 'loss_val': 1.1188506195705814, 'psi': 0.2912723377940157}-{'f1_val': 0.32069056703562393, 'auprc': 0.32069056703562393, 'loss_val': 1.3132830156181095, 'psi': 0.32069056703562393}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.891128 (no previous merge yet)
[S2] round=43 local utility u=0.005426 metrics={'f1_val': 0.25657726692209454, 'auprc': 0.25657726692209454, 'loss_val': 3.220971447477322, 'psi': 0.25657726692209454}-{'f1_val': 0.25399835640685253, 'auprc': 0.25399835640685253, 'loss_val': 3.2086141412751674, 'psi': 0.25399835640685253}
[S2] not sending this round → trigger blocked (psi=0.257)
[S3] START round=43 head_norm_before_train=2.129018 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.26945225659568767, 'auprc': 0.26945225659568767, 'loss_val': 3.3050785839164054, 'psi': 0.26945225659568767}-{'f1_val': 0.2697231717943562, 'auprc': 0.2697231717943562, 'loss_val': 3.2948165920491195, 'psi': 0.2697231717943562}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.832113 cos_to_last_merge=0.9781 (last merge round=27)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0067996391624714, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0054056137288372, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.813255 cos_to_last_merge=0.9351 (last merge round=27)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=43 local utility u=0.007577 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.678291852633265, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6934459700387605, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=43 head_norm_before_train=1.574659 cos_to_last_merge=0.9610 (last merge round=26)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.690130613879108, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.6498910199405366, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=2.013799 (no previous merge yet)
[S7] round=43 local utility u=0.096427 metrics={'f1_val': 0.23853979652902454, 'auprc': 0.23853979652902454, 'loss_val': 0.9613706944901282, 'psi': 0.23853979652902452}-{'f1_val': 0.2383860153256705, 'auprc': 0.2383860153256705, 'loss_val': 1.1528398901063401, 'psi': 0.2383860153256705}
[S7] not sending this round → trigger blocked (psi=0.239)
[S8] START round=43 head_norm_before_train=2.045106 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6537231989044467, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6257827224212011, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.562973 cos_to_last_merge=0.9261 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.926
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2896060889016256, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.265871603031443, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.197624 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.21355655369538587, 'auprc': 0.21355655369538587, 'loss_val': 1.7483069277614791, 'psi': 0.21355655369538587}-{'f1_val': 0.21394968296175088, 'auprc': 0.21394968296175088, 'loss_val': 1.7076132515223412, 'psi': 0.21394968296175088}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.967511 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.913166120736922, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.896595984394527, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.732556 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6368676193492298, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6143268577857566, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.662422 cos_to_last_merge=0.9472 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.884899438773725, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.842191973693459, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=2.105794 (no previous merge yet)
[S15] round=43 local utility u=0.001172 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6320473986268116, 'psi': 0.6152170947577895}-{'f1_val': 0.6147964639178166, 'auprc': 0.6147964639178166, 'loss_val': 0.6306057739589548, 'psi': 0.6147964639178166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=43 head_norm_before_train=1.866989 (no previous merge yet)
[S16] round=43 local utility u=0.116920 metrics={'f1_val': 0.13630348478164975, 'auprc': 0.13630348478164975, 'loss_val': 4.775397041998629, 'psi': 0.13630348478164975}-{'f1_val': 0.12507507507507507, 'auprc': 0.12507507507507507, 'loss_val': 4.908181958083733, 'psi': 0.12507507507507507}
[S16] not sending this round → trigger blocked (psi=0.136)
[S17] START round=43 head_norm_before_train=1.982923 (no previous merge yet)
[S17] round=43 local utility u=0.358687 metrics={'f1_val': 0.3904795038316109, 'auprc': 0.3904795038316109, 'loss_val': 1.2943417669080446, 'psi': 0.3904795038316109}-{'f1_val': 0.2912723377940157, 'auprc': 0.2912723377940157, 'loss_val': 1.1188506195705814, 'psi': 0.2912723377940157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=44 head_norm_before_train=1.896619 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.2568232662192394, 'auprc': 0.2568232662192394, 'loss_val': 3.232540256337686, 'psi': 0.2568232662192394}-{'f1_val': 0.25657726692209454, 'auprc': 0.25657726692209454, 'loss_val': 3.220971447477322, 'psi': 0.25657726692209454}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.134750 (no previous merge yet)
[S3] round=44 local utility u=0.001593 metrics={'f1_val': 0.270702993609149, 'auprc': 0.270702993609149, 'loss_val': 3.3131500847698154, 'psi': 0.270702993609149}-{'f1_val': 0.26945225659568767, 'auprc': 0.26945225659568767, 'loss_val': 3.3050785839164054, 'psi': 0.26945225659568767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=44 head_norm_before_train=1.843403 cos_to_last_merge=0.9771 (last merge round=27)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0098755295671031, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0067996391624714, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.829762 cos_to_last_merge=0.9329 (last merge round=27)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6790362999346096, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.678291852633265, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.583656 cos_to_last_merge=0.9597 (last merge round=26)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.723681253402823, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.690130613879108, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=2.020133 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.23853979652902454, 'auprc': 0.23853979652902454, 'loss_val': 1.0834769867018785, 'psi': 0.23853979652902452}-{'f1_val': 0.23853979652902454, 'auprc': 0.23853979652902454, 'loss_val': 0.9613706944901282, 'psi': 0.23853979652902452}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=2.051233 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6830905268842091, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6537231989044467, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.572698 cos_to_last_merge=0.9244 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.924
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3153913503495174, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2896060889016256, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.210045 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.21105730427764327, 'auprc': 0.21105730427764327, 'loss_val': 1.7930747116815662, 'psi': 0.21105730427764327}-{'f1_val': 0.21355655369538587, 'auprc': 0.21355655369538587, 'loss_val': 1.7483069277614791, 'psi': 0.21355655369538587}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.973385 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9302045625432425, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.913166120736922, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.736401 (no previous merge yet)
[S13] round=44 local utility u=0.006431 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6240055468130816, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6368676193492298, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=44 head_norm_before_train=1.670480 cos_to_last_merge=0.9460 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.946
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.924133312657542, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.884899438773725, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.121382 (no previous merge yet)
[S15] round=44 local utility u=0.005769 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6305635858132282, 'psi': 0.6163342951580373}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6320473986268116, 'psi': 0.6152170947577895}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=44 head_norm_before_train=1.874345 (no previous merge yet)
[S16] round=44 local utility u=0.204274 metrics={'f1_val': 0.14830782496227635, 'auprc': 0.14830782496227635, 'loss_val': 4.474887996660236, 'psi': 0.14830782496227635}-{'f1_val': 0.13630348478164975, 'auprc': 0.13630348478164975, 'loss_val': 4.775397041998629, 'psi': 0.13630348478164975}
[S16] not sending this round → trigger blocked (psi=0.148)
[S17] START round=44 head_norm_before_train=1.991026 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.3638549467475354, 'auprc': 0.3638549467475354, 'loss_val': 1.334524074481742, 'psi': 0.3638549467475354}-{'f1_val': 0.3904795038316109, 'auprc': 0.3904795038316109, 'loss_val': 1.2943417669080446, 'psi': 0.3904795038316109}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.901938 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.25672480991629926, 'auprc': 0.25672480991629926, 'loss_val': 3.241773422899453, 'psi': 0.25672480991629926}-{'f1_val': 0.2568232662192394, 'auprc': 0.2568232662192394, 'loss_val': 3.232540256337686, 'psi': 0.2568232662192394}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.140413 (no previous merge yet)
[S3] round=45 local utility u=0.001908 metrics={'f1_val': 0.27202055026025823, 'auprc': 0.27202055026025823, 'loss_val': 3.3211915164933403, 'psi': 0.27202055026025823}-{'f1_val': 0.270702993609149, 'auprc': 0.270702993609149, 'loss_val': 3.3131500847698154, 'psi': 0.270702993609149}
[S3] not sending this round → trigger blocked (psi=0.272)
[S4] START round=45 head_norm_before_train=1.852820 cos_to_last_merge=0.9762 (last merge round=27)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0121188410175541, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0098755295671031, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.846287 cos_to_last_merge=0.9309 (last merge round=27)
[S5] ⚠️ Model drifted since last merge! cos=0.931
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.703829528159019, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6790362999346096, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.592376 cos_to_last_merge=0.9585 (last merge round=26)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.762424783006017, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.723681253402823, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=2.028495 (no previous merge yet)
[S7] round=45 local utility u=0.003060 metrics={'f1_val': 0.23722912539768293, 'auprc': 0.23722912539768293, 'loss_val': 1.065560031704367, 'psi': 0.23722912539768293}-{'f1_val': 0.23853979652902454, 'auprc': 0.23853979652902454, 'loss_val': 1.0834769867018785, 'psi': 0.23853979652902452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=45 head_norm_before_train=2.055180 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7004446847178118, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6830905268842091, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.582248 cos_to_last_merge=0.9228 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.923
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3377186096885754, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3153913503495174, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.221785 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.2098294884653962, 'auprc': 0.2098294884653962, 'loss_val': 1.824146417835221, 'psi': 0.20982948846539617}-{'f1_val': 0.21105730427764327, 'auprc': 0.21105730427764327, 'loss_val': 1.7930747116815662, 'psi': 0.21105730427764327}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.979189 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9474897401850404, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9302045625432425, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.739523 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6475498080926185, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6240055468130816, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.678343 cos_to_last_merge=0.9448 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.961887541212008, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.924133312657542, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.135184 (no previous merge yet)
[S15] round=45 local utility u=0.000491 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.629581107607459, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6305635858132282, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=45 head_norm_before_train=1.881177 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.07738374823860968, 'auprc': 0.07738374823860968, 'loss_val': 4.620895430867527, 'psi': 0.07738374823860968}-{'f1_val': 0.14830782496227635, 'auprc': 0.14830782496227635, 'loss_val': 4.474887996660236, 'psi': 0.14830782496227635}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=2.000210 (no previous merge yet)
[S17] round=45 local utility u=0.250315 metrics={'f1_val': 0.41513088830790745, 'auprc': 0.41513088830790745, 'loss_val': 1.2953778882277567, 'psi': 0.41513088830790745}-{'f1_val': 0.3638549467475354, 'auprc': 0.3638549467475354, 'loss_val': 1.334524074481742, 'psi': 0.3638549467475354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=46 head_norm_before_train=1.907110 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.2554030002542588, 'auprc': 0.2554030002542588, 'loss_val': 3.250245577245102, 'psi': 0.2554030002542588}-{'f1_val': 0.25672480991629926, 'auprc': 0.25672480991629926, 'loss_val': 3.241773422899453, 'psi': 0.25672480991629926}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.145816 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.2725733252049041, 'auprc': 0.2725733252049041, 'loss_val': 3.3313874319600387, 'psi': 0.2725733252049041}-{'f1_val': 0.27202055026025823, 'auprc': 0.27202055026025823, 'loss_val': 3.3211915164933403, 'psi': 0.27202055026025823}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.863917 cos_to_last_merge=0.9752 (last merge round=27)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0126042850247532, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0121188410175541, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.860336 cos_to_last_merge=0.9293 (last merge round=27)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=46 local utility u=0.003913 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.696003835388188, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.703829528159019, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=46 head_norm_before_train=1.600438 cos_to_last_merge=0.9574 (last merge round=26)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.796380090578343, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.762424783006017, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=2.039173 (no previous merge yet)
[S7] round=46 local utility u=0.027523 metrics={'f1_val': 0.23853979652902454, 'auprc': 0.23853979652902454, 'loss_val': 1.0223102300543438, 'psi': 0.23853979652902452}-{'f1_val': 0.23722912539768293, 'auprc': 0.23722912539768293, 'loss_val': 1.065560031704367, 'psi': 0.23722912539768293}
[S7] not sending this round → trigger blocked (psi=0.239)
[S8] START round=46 head_norm_before_train=2.060809 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7209102089824233, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7004446847178118, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.591098 cos_to_last_merge=0.9214 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.921
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.35817208093943, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3377186096885754, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.232870 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.20876444296753352, 'auprc': 0.20876444296753352, 'loss_val': 1.858018536648038, 'psi': 0.20876444296753352}-{'f1_val': 0.2098294884653962, 'auprc': 0.2098294884653962, 'loss_val': 1.824146417835221, 'psi': 0.20982948846539617}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.984755 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.963844737049966, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9474897401850404, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.743469 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6601108430291747, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6475498080926185, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.685925 cos_to_last_merge=0.9436 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.998504697860597, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.961887541212008, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.148211 (no previous merge yet)
[S15] round=46 local utility u=0.002571 metrics={'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.6219303420840602, 'psi': 0.6160556042184989}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.629581107607459, 'psi': 0.6163342951580373}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=46 head_norm_before_train=1.886266 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.0008010253123998718, 'auprc': 0.0008010253123998718, 'loss_val': 5.861423911505047, 'psi': 0.0008010253123998718}-{'f1_val': 0.07738374823860968, 'auprc': 0.07738374823860968, 'loss_val': 4.620895430867527, 'psi': 0.07738374823860968}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.011874 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.31475018141724603, 'auprc': 0.31475018141724603, 'loss_val': 1.5566598073914906, 'psi': 0.31475018141724603}-{'f1_val': 0.41513088830790745, 'auprc': 0.41513088830790745, 'loss_val': 1.2953778882277567, 'psi': 0.41513088830790745}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.912207 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.25203864007025467, 'auprc': 0.25203864007025467, 'loss_val': 3.2601292009362526, 'psi': 0.25203864007025467}-{'f1_val': 0.2554030002542588, 'auprc': 0.2554030002542588, 'loss_val': 3.250245577245102, 'psi': 0.2554030002542588}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.151236 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.27329530019016574, 'auprc': 0.27329530019016574, 'loss_val': 3.34137305301813, 'psi': 0.27329530019016574}-{'f1_val': 0.2725733252049041, 'auprc': 0.2725733252049041, 'loss_val': 3.3313874319600387, 'psi': 0.2725733252049041}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.875337 cos_to_last_merge=0.9741 (last merge round=27)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0228838770645448, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0126042850247532, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.869050 cos_to_last_merge=0.9280 (last merge round=27)
[S5] ⚠️ Model drifted since last merge! cos=0.928
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.705587870638236, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.696003835388188, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.608210 cos_to_last_merge=0.9564 (last merge round=26)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.824592122139794, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.796380090578343, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=2.050169 (no previous merge yet)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.23861664572488483, 'auprc': 0.23861664572488483, 'loss_val': 1.0675376517335031, 'psi': 0.23861664572488483}-{'f1_val': 0.23853979652902454, 'auprc': 0.23853979652902454, 'loss_val': 1.0223102300543438, 'psi': 0.23853979652902452}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.065120 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7470142837183233, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7209102089824233, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.599641 cos_to_last_merge=0.9200 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.920
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3765747259769063, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.35817208093943, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.243655 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.20818449580117976, 'auprc': 0.20818449580117976, 'loss_val': 1.89082082320511, 'psi': 0.20818449580117976}-{'f1_val': 0.20876444296753352, 'auprc': 0.20876444296753352, 'loss_val': 1.858018536648038, 'psi': 0.20876444296753352}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.990215 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9762580990484095, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.963844737049966, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.748264 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6720635756266016, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6601108430291747, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.693146 cos_to_last_merge=0.9425 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.03469767045524, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.998504697860597, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.160236 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6273852007013403, 'psi': 0.6163342951580373}-{'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.6219303420840602, 'psi': 0.6160556042184989}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.890779 (no previous merge yet)
[S16] round=47 local utility u=0.888032 metrics={'f1_val': 0.10297856883399928, 'auprc': 0.10297856883399928, 'loss_val': 5.004956853614964, 'psi': 0.10297856883399928}-{'f1_val': 0.0008010253123998718, 'auprc': 0.0008010253123998718, 'loss_val': 5.861423911505047, 'psi': 0.0008010253123998718}
[S16] not sending this round → trigger blocked (psi=0.103)
[S17] START round=47 head_norm_before_train=2.023879 (no previous merge yet)
[S17] round=47 local utility u=1.000000 metrics={'f1_val': 0.5585114990007911, 'auprc': 0.5585114990007911, 'loss_val': 1.1407668249800074, 'psi': 0.5585114990007911}-{'f1_val': 0.31475018141724603, 'auprc': 0.31475018141724603, 'loss_val': 1.5566598073914906, 'psi': 0.31475018141724603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=48 head_norm_before_train=1.917249 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.2514707723119289, 'auprc': 0.2514707723119289, 'loss_val': 3.270708000922072, 'psi': 0.2514707723119289}-{'f1_val': 0.25203864007025467, 'auprc': 0.25203864007025467, 'loss_val': 3.2601292009362526, 'psi': 0.25203864007025467}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.156585 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.27346245327896707, 'auprc': 0.27346245327896707, 'loss_val': 3.351974795410606, 'psi': 0.27346245327896707}-{'f1_val': 0.27329530019016574, 'auprc': 0.27329530019016574, 'loss_val': 3.34137305301813, 'psi': 0.27329530019016574}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.885557 cos_to_last_merge=0.9731 (last merge round=27)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0294735147092309, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0228838770645448, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.880136 cos_to_last_merge=0.9265 (last merge round=27)
[S5] ⚠️ Model drifted since last merge! cos=0.927
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7194951474626876, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.705587870638236, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.616082 cos_to_last_merge=0.9553 (last merge round=26)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.856750342868308, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.824592122139794, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=2.057580 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.23900047824007653, 'auprc': 0.23900047824007653, 'loss_val': 1.129474627388629, 'psi': 0.23900047824007653}-{'f1_val': 0.23861664572488483, 'auprc': 0.23861664572488483, 'loss_val': 1.0675376517335031, 'psi': 0.23861664572488483}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.068673 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.769477605807421, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7470142837183233, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.607796 cos_to_last_merge=0.9187 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.919
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.395443862232781, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3765747259769063, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.253857 (no previous merge yet)
[S10] round=48 local utility u=0.063462 metrics={'f1_val': 0.21417705733092243, 'auprc': 0.21417705733092243, 'loss_val': 1.8178300202230548, 'psi': 0.21417705733092246}-{'f1_val': 0.20818449580117976, 'auprc': 0.20818449580117976, 'loss_val': 1.89082082320511, 'psi': 0.20818449580117976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=48 head_norm_before_train=1.995604 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9883526785668333, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9762580990484095, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.752690 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6724667489647493, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6720635756266016, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.700110 cos_to_last_merge=0.9414 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.070942691648838, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.03469767045524, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.171060 (no previous merge yet)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6315647231869702, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6273852007013403, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.894897 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.08733046642408204, 'auprc': 0.08733046642408204, 'loss_val': 4.939601181851903, 'psi': 0.08733046642408204}-{'f1_val': 0.10297856883399928, 'auprc': 0.10297856883399928, 'loss_val': 5.004956853614964, 'psi': 0.10297856883399928}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.032770 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.3643579964103533, 'auprc': 0.3643579964103533, 'loss_val': 1.5220614732940072, 'psi': 0.3643579964103533}-{'f1_val': 0.5585114990007911, 'auprc': 0.5585114990007911, 'loss_val': 1.1407668249800074, 'psi': 0.5585114990007911}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.922117 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.2517070726054, 'auprc': 0.2517070726054, 'loss_val': 3.2800034885048293, 'psi': 0.2517070726054}-{'f1_val': 0.2514707723119289, 'auprc': 0.2514707723119289, 'loss_val': 3.270708000922072, 'psi': 0.2514707723119289}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.161672 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.27290606985418786, 'auprc': 0.27290606985418786, 'loss_val': 3.3620833523479363, 'psi': 0.27290606985418786}-{'f1_val': 0.27346245327896707, 'auprc': 0.27346245327896707, 'loss_val': 3.351974795410606, 'psi': 0.27346245327896707}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.895448 cos_to_last_merge=0.9722 (last merge round=27)
[S4] round=49 local utility u=0.002281 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0249114976297113, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0294735147092309, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=49 head_norm_before_train=1.892889 cos_to_last_merge=0.9251 (last merge round=27)
[S5] ⚠️ Model drifted since last merge! cos=0.925
[S5] round=49 local utility u=0.013556 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6923833301991356, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7194951474626876, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=49 head_norm_before_train=1.623574 cos_to_last_merge=0.9542 (last merge round=26)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.895336018982685, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.856750342868308, 'psi': 0.1017530487804878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=2.063878 (no previous merge yet)
[S7] round=49 local utility u=0.069871 metrics={'f1_val': 0.23761544920235098, 'auprc': 0.23761544920235098, 'loss_val': 0.9772681705546871, 'psi': 0.23761544920235098}-{'f1_val': 0.23900047824007653, 'auprc': 0.23900047824007653, 'loss_val': 1.129474627388629, 'psi': 0.23900047824007653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=49 head_norm_before_train=2.076034 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.780308845879411, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.769477605807421, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.615666 cos_to_last_merge=0.9175 (last merge round=26)
[S9] ⚠️ Model drifted since last merge! cos=0.917
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.415603844607964, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.395443862232781, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.263581 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.2063826313585143, 'auprc': 0.2063826313585143, 'loss_val': 1.9423561447755486, 'psi': 0.2063826313585143}-{'f1_val': 0.21417705733092243, 'auprc': 0.21417705733092243, 'loss_val': 1.8178300202230548, 'psi': 0.21417705733092246}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.000825 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.99982769058941, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9883526785668333, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.759047 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6942512867937838, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6724667489647493, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.706894 cos_to_last_merge=0.9404 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.10544250580892, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.070942691648838, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.181863 (no previous merge yet)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6364511253433411, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6315647231869702, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.899889 (no previous merge yet)
[S16] round=49 local utility u=0.990675 metrics={'f1_val': 0.16802089378990134, 'auprc': 0.16802089378990134, 'loss_val': 3.684465842606114, 'psi': 0.16802089378990134}-{'f1_val': 0.08733046642408204, 'auprc': 0.08733046642408204, 'loss_val': 4.939601181851903, 'psi': 0.08733046642408204}
[S16] not sending this round → trigger blocked (psi=0.168)
[S17] START round=49 head_norm_before_train=2.039608 (no previous merge yet)
[S17] round=49 local utility u=1.000000 metrics={'f1_val': 0.616710582524145, 'auprc': 0.616710582524145, 'loss_val': 1.0131871872446545, 'psi': 0.616710582524145}-{'f1_val': 0.3643579964103533, 'auprc': 0.3643579964103533, 'loss_val': 1.5220614732940072, 'psi': 0.3643579964103533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
