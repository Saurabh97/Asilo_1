[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:42003
[S3] → join 127.0.0.1:42002
[S4] → join 127.0.0.1:42002
[S5] → join 127.0.0.1:42002
[S6] → join 127.0.0.1:42002
[S7] → join 127.0.0.1:42002
[S8] → join 127.0.0.1:42002
[S9] → join 127.0.0.1:42002
[S10] → join 127.0.0.1:42002
[S11] → join 127.0.0.1:42002
[S13] → join 127.0.0.1:42002
[S14] → join 127.0.0.1:42002
[S15] → join 127.0.0.1:42002
[S16] → join 127.0.0.1:42002
[S17] → join 127.0.0.1:42002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.141409 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.154406 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.146187 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.205048 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.089516 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.193314 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.145511 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.205023 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.196589 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.124591 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.175029 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.157056 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.199818 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.165824 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.089714 (no previous merge yet)
[S11]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4] + discovered S3
[S3] + discovered S7
[S3] + discovered S13
[S3] + discovered S11
[S3] + discovered S4
[S3] + discovered S17
[S3] + discovered S15
[S3] + discovered S5
[S3] + discovered S9
[S3] + discovered S10
[S3] + discovered S16
[S3] + discovered S6
[S3] + discovered S8
[S3] + discovered S14
[S4] + discovered S2
[S4] + discovered S7
[S4] + discovered S17
[S4] + discovered S11
[S4] + discovered S15
[S4] + discovered S9
[S4] + discovered S10
[S4] + discovered S5
[S4] + discovered S16
[S5] + discovered S4
[S4] + discovered S6
[S4] + discovered S8
[S5] + discovered S2
[S4] + discovered S13
[S4] + discovered S14
[S5] + discovered S3
[S5] + discovered S8
[S5] + discovered S14
[S5] + discovered S7
[S5] + discovered S15
[S5] + discovered S11
[S5] + discovered S13
[S5] + discovered S10
[S5] + discovered S9
[S5] + discovered S16
[S5] + discovered S6
[S5] + discovered S17
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S2
[S6] + discovered S14
[S6] + discovered S7
[S6] + discovered S8
[S6] + discovered S15
[S6] + discovered S13
[S6] + discovered S9
[S6] + discovered S16
[S6] + discovered S10
[S6] + discovered S17
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S3
[S6] + discovered S11
[S8] + discovered S2
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S3
[S8] + discovered S5
[S8] + discovered S4
[S7] + discovered S11
[S7] + discovered S13
[S7] + discovered S17
[S7] + discovered S10
[S7] + discovered S9
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S14
[S7] + discovered S8
[S8] + discovered S9
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S14
[S8] + discovered S15
[S8] + discovered S16
[S8] + discovered S17
[S8] + discovered S11
[S9] + discovered S8
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S6
[S9] + discovered S4
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S17
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S13
[S9] + discovered S10
[S9] + discovered S11
[S10] + discovered S5
[S10] + discovered S4
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S3
[S10] + discovered S8
[S10] + discovered S2
[S10] + discovered S13
[S10] + discovered S16
[S10] + discovered S17
[S10] + discovered S11
[S10] + discovered S14
[S10] + discovered S15
[S11] + discovered S10
[S11] + discovered S8
[S11] + discovered S7
[S11] + discovered S4
[S11] + discovered S2
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S6
[S11] + discovered S5
[S13] + discovered S9
[S13] + discovered S3
[S13] + discovered S2
[S13] + discovered S6
[S13] + discovered S11
[S13] + discovered S4
[S13] + discovered S8
[S13] + discovered S10
[S13] + discovered S7
[S13] + discovered S5
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S14
[S11] + discovered S16
[S14] + discovered S11
[S14] + discovered S13
[S14] + discovered S4
[S14] + discovered S5
[S14] + discovered S7
[S14] + discovered S10
[S14] + discovered S8
[S14] + discovered S2
[S14] + discovered S3
[S14] + discovered S6
[S13] + discovered S17
[S14] + discovered S9
[S13] + discovered S16
[S13] + discovered S14
[S13] + discovered S15
[S15] + discovered S9
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S2
[S15] + discovered S8
[S15] + discovered S3
[S15] + discovered S10
[S15] + discovered S7
[S15] + discovered S5
[S15] + discovered S4
[S15] + discovered S11
[S15] + discovered S13
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S16] + discovered S2
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S15
[S16] + discovered S9
[S16] + discovered S13
[S16] + discovered S5
[S16] + discovered S4
[S16] + discovered S8
[S16] + discovered S14
[S16] + discovered S11
[S16] + discovered S10
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S3
[S17] + discovered S11
[S17] + discovered S7
[S17] + discovered S10
[S17] + discovered S2
[S17] + discovered S14
[S17] + discovered S8
[S17] + discovered S4
[S17] + discovered S6
[S17] + discovered S5
[S17] + discovered S13
[S17] + discovered S16
[S17] + discovered S9
[S17] + discovered S15
[S17] + discovered S3
[S16] + discovered S17
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:42004
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:42009
[S10] ⇄ pheromone p=1.000 → S3@127.0.0.1:42003
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:42014
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:42010
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:42015
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:42016
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:42004
[S15] ⇄ pheromone p=1.000 → S11@127.0.0.1:42012
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:42013
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:42012
[S16] ⇄ pheromone p=1.000 → S17@127.0.0.1:42017
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:42017
[S2] ⇄ pheromone p=1.000 → S13@127.0.0.1:42013
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:42003
[S2] START round=1 head_norm_before_train=1.148301 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6046062667378953, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5159136426115685, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.176239 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7739438253600035, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5166059867853516, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.157697 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4949474835332066, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4495674521137336, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.223467 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6307706012720384, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4897894223956283, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.092798 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4665059556364954, 'psi': 0.0}-{'f1_val': 0.11534473820632452, 'auprc': 0.11534473820632452, 'loss_val': 1.3820347723606239, 'psi': 0.11534473820632452}
[S7] START round=1 head_norm_before_train=1.212109 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.855834390241738, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5937730625988011, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.153265 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4668439172065642, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4225978217511577, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.219542 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.781405685277096, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5497545736439693, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.199902 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5307877875202656, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4731540889278694, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.127146 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.554175256279224, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4846334524945592, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.185133 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4305155811041146, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3999664958935285, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.162734 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5118947542930308, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4351066730530906, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.208614 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4885071663356528, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.431739651332505, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.175880 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5106923009410833, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4423601204208598, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.092194 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4689477740001375, 'psi': 0.0}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.4332844080551876, 'psi': 0.30380970798684975}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.167143 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.779607181981911, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6046062667378953, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.227654 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6329003658657713, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7739438253600035, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.178021 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5864577155103912, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4949474835332066, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.262639 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9022901899125364, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6307706012720384, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.109984 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6205297838768769, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4665059556364954, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.257534 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.175910519957615, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.855834390241738, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.172603 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5598083393801945, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4668439172065642, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.256564 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.405750282516213, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.781405685277096, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.214186 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6377059271272632, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5307877875202656, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.142824 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6840225680043976, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.554175256279224, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.203851 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5019309929683862, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4305155811041146, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.181959 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.662936032556859, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5118947542930308, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.228613 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6141287678048415, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4885071663356528, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.197955 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6278004165461628, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5106923009410833, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.103903 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5280477481780004, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4689477740001375, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.196411 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2383640311909465, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.779607181981911, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.287205 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.661249814473262, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6329003658657713, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.206111 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7188411980490836, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5864577155103912, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.304963 (no previous merge yet)
[S5] round=3 local utility u=0.160188 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5819140115206005, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9022901899125364, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.140144 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0263938100986865, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6205297838768769, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.291370 (no previous merge yet)
[S7] round=3 local utility u=0.098966 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9779787873717376, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.175910519957615, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.199521 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.777421802650015, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5598083393801945, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.302484 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.70773877769614, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.405750282516213, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.238295 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8622854868181575, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6377059271272632, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.170435 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.069593968077941, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6840225680043976, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.230141 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.660180713961624, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5019309929683862, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.212695 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.016682212306001, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.662936032556859, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.256304 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9485508303777106, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6141287678048415, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.231063 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9289142381849562, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6278004165461628, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.129201 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6584555130828906, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5280477481780004, 'psi': 0.0}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.234321 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.823099247597786, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2383640311909465, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.320818 (no previous merge yet)
[S3] round=4 local utility u=0.106794 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.447662640189332, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.661249814473262, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.236943 (no previous merge yet)
[S4] round=4 local utility u=0.045741 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6273584019883585, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7188411980490836, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.304361 (no previous merge yet)
[S5] round=4 local utility u=0.028384 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5251457328424187, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5819140115206005, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.182505 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8159900233264787, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0263938100986865, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.297818 (no previous merge yet)
[S7] round=4 local utility u=0.083489 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8110005005363772, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9779787873717376, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.226593 (no previous merge yet)
[S8] round=4 local utility u=0.005128 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7671654878989689, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.777421802650015, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.344255 (no previous merge yet)
[S9] round=4 local utility u=0.092284 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.523171546159343, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.70773877769614, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.268713 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.088281083183351, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8622854868181575, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.209488 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.780315629807561, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.069593968077941, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.258249 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8190762668476481, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.660180713961624, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.250165 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.573531269585482, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.016682212306001, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.290161 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1494862187046895, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9485508303777106, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.273923 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4654789738043363, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9289142381849562, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.165934 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9238694197817388, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6584555130828906, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.266740 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.901357108898105, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.823099247597786, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.367406 (no previous merge yet)
[S3] round=5 local utility u=0.265271 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9171203259530136, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.447662640189332, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.256144 (no previous merge yet)
[S4] round=5 local utility u=0.078326 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.470705645301412, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6273584019883585, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.332999 (no previous merge yet)
[S5] round=5 local utility u=1.000000 metrics={'f1_val': 0.3335914124112951, 'auprc': 0.3335914124112951, 'loss_val': 1.3616687520392095, 'psi': 0.3335914124112951}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5251457328424187, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.224614 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9552723080489725, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8159900233264787, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.312564 (no previous merge yet)
[S7] round=5 local utility u=0.006521 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7979581649329959, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8110005005363772, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.237894 (no previous merge yet)
[S8] round=5 local utility u=0.080409 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6063478916389349, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7671654878989689, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.392105 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.805422320238103, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.523171546159343, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.295770 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0915905909411157, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.088281083183351, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.245288 (no previous merge yet)
[S11] round=5 local utility u=0.151766 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.476783287384366, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.780315629807561, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.278128 (no previous merge yet)
[S13] round=5 local utility u=0.052904 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7132689493351627, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8190762668476481, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.284177 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.161816645156217, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.573531269585482, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.310457 (no previous merge yet)
[S15] round=5 local utility u=0.154440 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8406060814696728, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1494862187046895, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.317544 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8072448079701413, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4654789738043363, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.205223 (no previous merge yet)
[S17] round=5 local utility u=0.064842 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7941851531908264, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9238694197817388, 'psi': 0.0}
[S4] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:42016
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.0527
[S17] not sending this round → trigger blocked (psi=0.000)
[S14] ⇄ pheromone p=0.328 → S15@127.0.0.1:42015
[S11] ⇄ pheromone p=0.358 → S13@127.0.0.1:42013
[S9] ⇄ pheromone p=0.342 → S17@127.0.0.1:42017
[S8] ⇄ pheromone p=0.345 → S17@127.0.0.1:42017
[S7] ⇄ pheromone p=0.355 → S14@127.0.0.1:42014
[S2] ⇄ pheromone p=0.328 → S13@127.0.0.1:42013
[S4] ⇄ pheromone p=0.351 → S10@127.0.0.1:42011
[S10] ⇄ pheromone p=0.328 → S3@127.0.0.1:42003
[S13] ⇄ pheromone p=0.338 → S4@127.0.0.1:42004
[S3] ⇄ pheromone p=0.398 → S9@127.0.0.1:42010
[S15] ⇄ pheromone p=0.359 → S11@127.0.0.1:42012
[S6] ⇄ pheromone p=0.328 → S11@127.0.0.1:42012
[S5] ⇄ pheromone p=0.553 → S16@127.0.0.1:42016
[S17] ⇄ pheromone p=0.341 → S3@127.0.0.1:42003
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.0000 head_norm=1.358971
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.355285e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.0000 head_norm=0.986191 delta_norm=0.935528
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.328 → S17@127.0.0.1:42017
[S2] START round=6 head_norm_before_train=1.291250 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0835468943424127, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.901357108898105, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.423655 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.247713341834724, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9171203259530136, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.272820 (no previous merge yet)
[S4] round=6 local utility u=0.042301 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3861042558100105, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.470705645301412, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.359696 (no previous merge yet)
[S5] round=6 local utility u=1.000000 metrics={'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 1.243138758120574, 'psi': 1.0}-{'f1_val': 0.3335914124112951, 'auprc': 0.3335914124112951, 'loss_val': 1.3616687520392095, 'psi': 0.3335914124112951}
[S6] START round=6 head_norm_before_train=1.252022 (no previous merge yet)
[S6] round=6 local utility u=0.098410 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.758452226866923, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9552723080489725, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.341782 (no previous merge yet)
[S7] round=6 local utility u=0.093485 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6109889692408481, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7979581649329959, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.242712 (no previous merge yet)
[S8] round=6 local utility u=0.895207 metrics={'f1_val': 0.19672619047619047, 'auprc': 0.19672619047619047, 'loss_val': 1.586470475845621, 'psi': 0.19672619047619047}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6063478916389349, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.454861 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1089888468858278, 'psi': 0.36867172340800847}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.805422320238103, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.317952 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.29853606497588, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0915905909411157, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.260507 (no previous merge yet)
[S11] round=6 local utility u=0.157566 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.161651689599115, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.476783287384366, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.285791 (no previous merge yet)
[S13] round=6 local utility u=0.062286 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.588696816415044, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7132689493351627, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.317863 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4584409425364893, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.161816645156217, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.315258 (no previous merge yet)
[S15] round=6 local utility u=0.076635 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6873353589949076, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8406060814696728, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=0.986191 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.219350 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.368545091920203, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8072448079701413, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.227613 (no previous merge yet)
[S17] round=6 local utility u=0.119809 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5545675548811448, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7941851531908264, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.197)
[S5] not sending this round → trigger blocked (psi=1.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[S4] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S9] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.0729
[S17] not sending this round → trigger blocked (psi=0.000)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.0000 head_norm=1.241974
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.450522e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.0000 head_norm=1.015147 delta_norm=0.945052
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.318123 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5241888055820705, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0835468943424127, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.482908 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.420626625596549, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.247713341834724, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.297996 (no previous merge yet)
[S4] round=7 local utility u=0.026766 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3325713466300604, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3861042558100105, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.397576 (no previous merge yet)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.3771660680764966, 'auprc': 0.3771660680764966, 'loss_val': 1.1660037573024453, 'psi': 0.3771660680764966}-{'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 1.243138758120574, 'psi': 1.0}
[S6] START round=7 head_norm_before_train=1.276095 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.15235106348862, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.758452226866923, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.373218 (no previous merge yet)
[S7] round=7 local utility u=0.074492 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.462004971596824, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6109889692408481, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.265146 (no previous merge yet)
[S8] round=7 local utility u=0.623356 metrics={'f1_val': 0.3320715036803365, 'auprc': 0.3320715036803365, 'loss_val': 1.55786553793677, 'psi': 0.3320715036803365}-{'f1_val': 0.19672619047619047, 'auprc': 0.19672619047619047, 'loss_val': 1.586470475845621, 'psi': 0.19672619047619047}
[S9] START round=7 head_norm_before_train=1.518154 (no previous merge yet)
[S9] round=7 local utility u=0.050879 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.007231737006358, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1089888468858278, 'psi': 0.36867172340800847}
[S10] START round=7 head_norm_before_train=1.345856 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.748238236690542, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.29853606497588, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.277349 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5652730800836703, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.161651689599115, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.294657 (no previous merge yet)
[S13] round=7 local utility u=0.073847 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4410021374874067, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.588696816415044, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.347229 (no previous merge yet)
[S14] round=7 local utility u=0.056037 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3463663608221283, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4584409425364893, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.327422 (no previous merge yet)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7344193988556051, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6873353589949076, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.027201 cos_to_last_merge=0.9974 (last merge round=5)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5346338141249847, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.368545091920203, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.015147 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.074451 metrics={'f1_val': 0.004190236748376284, 'auprc': 0.004190236748376284, 'loss_val': 1.4433767604695353, 'psi': 0.004190236748376284}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5545675548811448, 'psi': 0.0}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:42017
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.369)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S8] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=0.0887
[S17] not sending this round → trigger blocked (psi=0.004)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.0042 head_norm=1.048101
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.952814e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.0458 head_norm=0.867581 delta_norm=0.795281
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.347228 (no previous merge yet)
[S2] round=8 local utility u=0.347317 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.829555465664481, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5241888055820705, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.531477 (no previous merge yet)
[S3] round=8 local utility u=0.170454 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.07971921971127, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.420626625596549, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.329981 (no previous merge yet)
[S4] round=8 local utility u=0.016092 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3003873337615048, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3325713466300604, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.441344 (no previous merge yet)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.25157302250581814, 'auprc': 0.25157302250581814, 'loss_val': 1.1169969788323748, 'psi': 0.25157302250581814}-{'f1_val': 0.3771660680764966, 'auprc': 0.3771660680764966, 'loss_val': 1.1660037573024453, 'psi': 0.3771660680764966}
[S6] START round=8 head_norm_before_train=1.306053 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.287063923992056, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.15235106348862, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.402026 (no previous merge yet)
[S7] round=8 local utility u=0.014902 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4322004245099678, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.462004971596824, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.292990 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.2320182205569025, 'auprc': 0.2320182205569025, 'loss_val': 1.4096114406532056, 'psi': 0.23201822055690252}-{'f1_val': 0.3320715036803365, 'auprc': 0.3320715036803365, 'loss_val': 1.55786553793677, 'psi': 0.3320715036803365}
[S9] START round=8 head_norm_before_train=1.581727 (no previous merge yet)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0301909632393933, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.007231737006358, 'psi': 0.36867172340800847}
[S10] START round=8 head_norm_before_train=1.379779 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2923102241064015, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.748238236690542, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.307083 (no previous merge yet)
[S11] round=8 local utility u=0.072919 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4194342275255925, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5652730800836703, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.302305 (no previous merge yet)
[S13] round=8 local utility u=1.000000 metrics={'f1_val': 0.23877143157673295, 'auprc': 0.23877143157673295, 'loss_val': 1.3427868052741634, 'psi': 0.23877143157673295}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4410021374874067, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.371210 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5032478298376635, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3463663608221283, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.353069 (no previous merge yet)
[S15] round=8 local utility u=0.093027 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5483660255057348, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7344193988556051, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.074172 cos_to_last_merge=0.9903 (last merge round=5)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.674576634109604, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5346338141249847, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=0.867581 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=1.000000 metrics={'f1_val': 0.2517333333333333, 'auprc': 0.2517333333333333, 'loss_val': 1.4211865648051722, 'psi': 0.2517333333333333}-{'f1_val': 0.004190236748376284, 'auprc': 0.004190236748376284, 'loss_val': 1.4433767604695353, 'psi': 0.004190236748376284}
[S4] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:42004
[S11] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S13
[S4] cosine check vs S13: cos=0.0454
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S17
[S3] cosine check vs S17: cos=0.0809
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.0000 head_norm=1.363901
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.252591e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.0000 head_norm=0.968247 delta_norm=0.925259
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.0000 head_norm=1.574744
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.779035e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.0000 head_norm=0.941927 delta_norm=0.877903
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.373212 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.220493226177503, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.829555465664481, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=0.941927 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.585740 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 2.108239590616428, 'psi': 0.13333333333333333}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.07971921971127, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=0.968247 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3407218763560287, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3003873337615048, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.485630 (no previous merge yet)
[S5] round=9 local utility u=1.000000 metrics={'f1_val': 0.6637664871695811, 'auprc': 0.6637664871695811, 'loss_val': 1.0877328004168492, 'psi': 0.6637664871695811}-{'f1_val': 0.25157302250581814, 'auprc': 0.25157302250581814, 'loss_val': 1.1169969788323748, 'psi': 0.25157302250581814}
[S6] START round=9 head_norm_before_train=1.336511 (no previous merge yet)
[S6] round=9 local utility u=0.034890 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2172835249674754, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.287063923992056, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.419822 (no previous merge yet)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5113255588849615, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4322004245099678, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.317437 (no previous merge yet)
[S8] round=9 local utility u=0.005572 metrics={'f1_val': 0.22584566974182937, 'auprc': 0.22584566974182937, 'loss_val': 1.342915259139215, 'psi': 0.2258456697418294}-{'f1_val': 0.2320182205569025, 'auprc': 0.2320182205569025, 'loss_val': 1.4096114406532056, 'psi': 0.23201822055690252}
[S9] START round=9 head_norm_before_train=1.633825 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1452844535679003, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0301909632393933, 'psi': 0.36867172340800847}
[S10] START round=9 head_norm_before_train=1.419024 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5753162649804766, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2923102241064015, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.338938 (no previous merge yet)
[S11] round=9 local utility u=0.051447 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3165398878010763, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4194342275255925, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.314149 (no previous merge yet)
[S13] round=9 local utility u=0.263574 metrics={'f1_val': 0.29093931837073983, 'auprc': 0.29093931837073983, 'loss_val': 1.2851505829816836, 'psi': 0.29093931837073983}-{'f1_val': 0.23877143157673295, 'auprc': 0.23877143157673295, 'loss_val': 1.3427868052741634, 'psi': 0.23877143157673295}
[S14] START round=9 head_norm_before_train=1.399353 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6804629284388772, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5032478298376635, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.377233 (no previous merge yet)
[S15] round=9 local utility u=0.090596 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3671745693986563, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5483660255057348, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.120914 cos_to_last_merge=0.9807 (last merge round=5)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8246914620152768, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.674576634109604, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=0.914364 cos_to_last_merge=0.9944 (last merge round=7)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.20871529161684602, 'auprc': 0.20871529161684602, 'loss_val': 1.3663608952114024, 'psi': 0.20871529161684602}-{'f1_val': 0.2517333333333333, 'auprc': 0.2517333333333333, 'loss_val': 1.4211865648051722, 'psi': 0.2517333333333333}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.291)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.133)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:42016
[S5] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] cosine check vs S8: cos=0.7453
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.6319
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.2087 head_norm=0.968400
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.492860e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.2061 head_norm=1.083377 delta_norm=0.449286
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.0000 head_norm=1.164226
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.987360e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.216125 delta_norm=0.598736
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.402762 (no previous merge yet)
[S2] round=10 local utility u=0.304287 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6119197402759973, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.220493226177503, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.009228 cos_to_last_merge=0.9955 (last merge round=8)
[S3] round=10 local utility u=0.132340 metrics={'f1_val': 0.19446399249354915, 'auprc': 0.19446399249354915, 'loss_val': 2.393735957270048, 'psi': 0.19446399249354915}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 2.108239590616428, 'psi': 0.13333333333333333}
[S4] START round=10 head_norm_before_train=1.002972 cos_to_last_merge=0.9965 (last merge round=8)
[S4] round=10 local utility u=0.007138 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.326445060603657, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3407218763560287, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.522980 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.2508839708387825, 'auprc': 0.2508839708387825, 'loss_val': 1.11692381119647, 'psi': 0.2508839708387825}-{'f1_val': 0.6637664871695811, 'auprc': 0.6637664871695811, 'loss_val': 1.0877328004168492, 'psi': 0.6637664871695811}
[S6] START round=10 head_norm_before_train=1.367900 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8382189092904553, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2172835249674754, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.430272 (no previous merge yet)
[S7] round=10 local utility u=0.190903 metrics={'f1_val': 0.025271610769957487, 'auprc': 0.025271610769957487, 'loss_val': 1.356963994745391, 'psi': 0.025271610769957487}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5113255588849615, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.346598 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.21699993128564557, 'auprc': 0.21699993128564557, 'loss_val': 1.3052974273665396, 'psi': 0.2169999312856456}-{'f1_val': 0.22584566974182937, 'auprc': 0.22584566974182937, 'loss_val': 1.342915259139215, 'psi': 0.2258456697418294}
[S9] START round=10 head_norm_before_train=1.676766 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2797312937731222, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1452844535679003, 'psi': 0.36867172340800847}
[S10] START round=10 head_norm_before_train=1.455224 (no previous merge yet)
[S10] round=10 local utility u=0.351199 metrics={'f1_val': 0.0926791277258567, 'auprc': 0.0926791277258567, 'loss_val': 3.7070300740542526, 'psi': 0.0926791277258567}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5753162649804766, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.376559 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5145756438322704, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3165398878010763, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.335103 (no previous merge yet)
[S13] round=10 local utility u=0.184124 metrics={'f1_val': 0.3248509280255312, 'auprc': 0.3248509280255312, 'loss_val': 1.2221076648491267, 'psi': 0.3248509280255312}-{'f1_val': 0.29093931837073983, 'auprc': 0.29093931837073983, 'loss_val': 1.2851505829816836, 'psi': 0.29093931837073983}
[S14] START round=10 head_norm_before_train=1.428124 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.612294110117754, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6804629284388772, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.403973 (no previous merge yet)
[S15] round=10 local utility u=0.801434 metrics={'f1_val': 0.17048293089092423, 'auprc': 0.17048293089092423, 'loss_val': 1.298652010575502, 'psi': 0.17048293089092423}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3671745693986563, 'psi': 0.0}
[S16] START round=10 head_norm_before_train=1.216125 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.322555 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1795814646988663, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8246914620152768, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.083377 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.3355832258249096, 'psi': 0.20297157622739018}-{'f1_val': 0.20871529161684602, 'auprc': 0.20871529161684602, 'loss_val': 1.3663608952114024, 'psi': 0.20871529161684602}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.194)
[S15] not sending this round → trigger blocked (psi=0.170)
[S16] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:42004
[S7] not sending this round → trigger blocked (psi=0.025)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.093)
[S13] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] cosine check vs S13: cos=0.6463
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.423 → S16@127.0.0.1:42016
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.0000 head_norm=1.052125
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.252388e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.094912 delta_norm=0.525239
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.125 → S10@127.0.0.1:42011
[S3] ⇄ pheromone p=0.272 → S9@127.0.0.1:42010
[S6] ⇄ pheromone p=0.121 → S11@127.0.0.1:42012
[S7] ⇄ pheromone p=0.172 → S14@127.0.0.1:42014
[S14] ⇄ pheromone p=0.113 → S15@127.0.0.1:42015
[S11] ⇄ pheromone p=0.148 → S13@127.0.0.1:42013
[S15] ⇄ pheromone p=0.310 → S11@127.0.0.1:42012
[S2] ⇄ pheromone p=0.213 → S13@127.0.0.1:42013
[S10] ⇄ pheromone p=0.178 → S3@127.0.0.1:42003
[S9] ⇄ pheromone p=0.199 → S17@127.0.0.1:42017
[S8] ⇄ pheromone p=0.251 → S17@127.0.0.1:42017
[S13] ⇄ pheromone p=0.331 → S4@127.0.0.1:42004
[S17] ⇄ pheromone p=0.257 → S3@127.0.0.1:42003
[S16] ⇄ pheromone p=0.190 → S17@127.0.0.1:42017
[S2] START round=11 head_norm_before_train=1.433772 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.162872778012077, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6119197402759973, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.092881 cos_to_last_merge=0.9829 (last merge round=8)
[S3] round=11 local utility u=0.486844 metrics={'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.3511790826763663, 'psi': 0.29792295726964957}-{'f1_val': 0.19446399249354915, 'auprc': 0.19446399249354915, 'loss_val': 2.393735957270048, 'psi': 0.19446399249354915}
[S4] START round=11 head_norm_before_train=1.094912 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3656742699023476, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.326445060603657, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.567844 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.2509457755359395, 'auprc': 0.2509457755359395, 'loss_val': 1.836108071302913, 'psi': 0.2509457755359395}-{'f1_val': 0.2508839708387825, 'auprc': 0.2508839708387825, 'loss_val': 1.11692381119647, 'psi': 0.2508839708387825}
[S6] START round=11 head_norm_before_train=1.400927 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.04468280347532, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8382189092904553, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.438656 (no previous merge yet)
[S7] round=11 local utility u=0.136424 metrics={'f1_val': 0.052338530066815145, 'auprc': 0.052338530066815145, 'loss_val': 1.3277174972690873, 'psi': 0.052338530066815145}-{'f1_val': 0.025271610769957487, 'auprc': 0.025271610769957487, 'loss_val': 1.356963994745391, 'psi': 0.025271610769957487}
[S8] START round=11 head_norm_before_train=1.376355 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.20791362169991442, 'auprc': 0.20791362169991442, 'loss_val': 1.2845201804783755, 'psi': 0.20791362169991442}-{'f1_val': 0.21699993128564557, 'auprc': 0.21699993128564557, 'loss_val': 1.3052974273665396, 'psi': 0.2169999312856456}
[S9] START round=11 head_norm_before_train=1.710417 (no previous merge yet)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.405758006794885, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2797312937731222, 'psi': 0.36867172340800847}
[S10] START round=11 head_norm_before_train=1.483979 (no previous merge yet)
[S10] round=11 local utility u=0.488432 metrics={'f1_val': 0.2099978170705086, 'auprc': 0.2099978170705086, 'loss_val': 3.7860346585112685, 'psi': 0.20999781707050857}-{'f1_val': 0.0926791277258567, 'auprc': 0.0926791277258567, 'loss_val': 3.7070300740542526, 'psi': 0.0926791277258567}
[S11] START round=11 head_norm_before_train=1.416138 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.641582908081747, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5145756438322704, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.357369 (no previous merge yet)
[S13] round=11 local utility u=0.184513 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.168849755880269, 'psi': 0.3599362944611573}-{'f1_val': 0.3248509280255312, 'auprc': 0.3248509280255312, 'loss_val': 1.2221076648491267, 'psi': 0.3248509280255312}
[S14] START round=11 head_norm_before_train=1.456618 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.054242031328651, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.612294110117754, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.436866 (no previous merge yet)
[S15] round=11 local utility u=0.458145 metrics={'f1_val': 0.26509386098427196, 'auprc': 0.26509386098427196, 'loss_val': 1.233859769499563, 'psi': 0.26509386098427196}-{'f1_val': 0.17048293089092423, 'auprc': 0.17048293089092423, 'loss_val': 1.298652010575502, 'psi': 0.17048293089092423}
[S16] START round=11 head_norm_before_train=1.243531 cos_to_last_merge=0.9989 (last merge round=9)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.0025392428439519853, 'auprc': 0.0025392428439519853, 'loss_val': 2.2093589814002885, 'psi': 0.0025392428439519853}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1795814646988663, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.124839 cos_to_last_merge=0.9961 (last merge round=9)
[S17] round=11 local utility u=0.005143 metrics={'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 1.3260050946366624, 'psi': 0.20305027788548533}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.3355832258249096, 'psi': 0.20297157622739018}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:42012
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.360)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:42010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.052)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] cosine check vs S15: cos=0.0442
[S3] RECEIVED delta(kind=head bytes=1803) from S10
[S3] cosine check vs S10: cos=-0.0551
[S3] DROPPED delta from S10 (cos=-0.0551 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S3
[S9] cosine check vs S3: cos=0.1590
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.4533
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.0000 head_norm=1.450309
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.009176e+00
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.054766 delta_norm=1.009176
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.3687 head_norm=1.738146
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.685935e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.3687 head_norm=1.123853 delta_norm=0.968594
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.2979 head_norm=1.175281
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.131203e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.2977 head_norm=0.999633 delta_norm=0.613120
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.468322 (no previous merge yet)
[S2] round=12 local utility u=1.000000 metrics={'f1_val': 0.1895266325339082, 'auprc': 0.1895266325339082, 'loss_val': 2.7145772553204615, 'psi': 0.1895266325339082}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.162872778012077, 'psi': 0.0}
[S3] START round=12 head_norm_before_train=0.999633 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.178390 metrics={'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 1.9943988305805298, 'psi': 0.29792295726964957}-{'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.3511790826763663, 'psi': 0.29792295726964957}
[S4] START round=12 head_norm_before_train=1.127722 cos_to_last_merge=0.9951 (last merge round=10)
[S4] round=12 local utility u=0.007415 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3508438761414985, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3656742699023476, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.617516 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 2.682907595513685, 'psi': 0.33451196111837667}-{'f1_val': 0.2509457755359395, 'auprc': 0.2509457755359395, 'loss_val': 1.836108071302913, 'psi': 0.2509457755359395}
[S6] START round=12 head_norm_before_train=1.434323 (no previous merge yet)
[S6] round=12 local utility u=0.424146 metrics={'f1_val': 0.07933950865888038, 'auprc': 0.07933950865888038, 'loss_val': 3.9104458792269505, 'psi': 0.07933950865888038}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.04468280347532, 'psi': 0.0}
[S7] START round=12 head_norm_before_train=1.468292 (no previous merge yet)
[S7] round=12 local utility u=0.487624 metrics={'f1_val': 0.15019143752175426, 'auprc': 0.15019143752175426, 'loss_val': 1.233146146418866, 'psi': 0.15019143752175426}-{'f1_val': 0.052338530066815145, 'auprc': 0.052338530066815145, 'loss_val': 1.3277174972690873, 'psi': 0.052338530066815145}
[S8] START round=12 head_norm_before_train=1.406764 (no previous merge yet)
[S8] round=12 local utility u=0.016752 metrics={'f1_val': 0.21002926310188882, 'auprc': 0.21002926310188882, 'loss_val': 1.2700578288762248, 'psi': 0.2100292631018888}-{'f1_val': 0.20791362169991442, 'auprc': 0.20791362169991442, 'loss_val': 1.2845201804783755, 'psi': 0.20791362169991442}
[S9] START round=12 head_norm_before_train=1.123853 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.376551 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6526553533797899, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.405758006794885, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=1.510247 (no previous merge yet)
[S10] round=12 local utility u=0.146203 metrics={'f1_val': 0.23340581961271614, 'auprc': 0.23340581961271614, 'loss_val': 3.704300712023454, 'psi': 0.23340581961271614}-{'f1_val': 0.2099978170705086, 'auprc': 0.2099978170705086, 'loss_val': 3.7860346585112685, 'psi': 0.20999781707050857}
[S11] START round=12 head_norm_before_train=1.054766 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.187743 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2660974757676957, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.641582908081747, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.382548 (no previous merge yet)
[S13] round=12 local utility u=0.015177 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1384960017619123, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.168849755880269, 'psi': 0.3599362944611573}
[S14] START round=12 head_norm_before_train=1.479894 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.116291602854319, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.054242031328651, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.469197 (no previous merge yet)
[S15] round=12 local utility u=0.118954 metrics={'f1_val': 0.28248998907899525, 'auprc': 0.28248998907899525, 'loss_val': 1.1525177203150325, 'psi': 0.28248998907899525}-{'f1_val': 0.26509386098427196, 'auprc': 0.26509386098427196, 'loss_val': 1.233859769499563, 'psi': 0.26509386098427196}
[S16] START round=12 head_norm_before_train=1.284136 cos_to_last_merge=0.9950 (last merge round=9)
[S16] round=12 local utility u=0.002886 metrics={'f1_val': 0.03229974160206718, 'auprc': 0.03229974160206718, 'loss_val': 2.4714307868883214, 'psi': 0.03229974160206718}-{'f1_val': 0.0025392428439519853, 'auprc': 0.0025392428439519853, 'loss_val': 2.2093589814002885, 'psi': 0.0025392428439519853}
[S17] START round=12 head_norm_before_train=1.170077 cos_to_last_merge=0.9870 (last merge round=9)
[S17] round=12 local utility u=0.005637 metrics={'f1_val': 0.2031290405999483, 'auprc': 0.2031290405999483, 'loss_val': 1.3154394390485211, 'psi': 0.2031290405999483}-{'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 1.3260050946366624, 'psi': 0.20305027788548533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[S6] not sending this round → trigger blocked (psi=0.079)
[S3] not sending this round → trigger blocked (psi=0.298)
[S2] not sending this round → trigger blocked (psi=0.190)
[S7] not sending this round → trigger blocked (psi=0.150)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:42017
[S11] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.233)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.282)
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=0.8898
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.3875
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] cosine check vs S13: cos=0.8620
[S16] not sending this round → trigger blocked (psi=0.032)
[S17] not sending this round → trigger blocked (psi=0.203)
[S4] not sending this round → trigger blocked (psi=0.000)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.0000 head_norm=1.174888
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.590207e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.249201 delta_norm=0.359021
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.2031 head_norm=1.210147
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.085895e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.2031 head_norm=1.070298 delta_norm=0.308589
[S17] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.498810 (no previous merge yet)
[S2] round=13 local utility u=0.236716 metrics={'f1_val': 0.21612783351913786, 'auprc': 0.21612783351913786, 'loss_val': 2.48055613843044, 'psi': 0.21612783351913786}-{'f1_val': 0.1895266325339082, 'auprc': 0.1895266325339082, 'loss_val': 2.7145772553204615, 'psi': 0.1895266325339082}
[S3] START round=13 head_norm_before_train=1.080041 cos_to_last_merge=0.9928 (last merge round=11)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.2839506172839506, 'auprc': 0.2839506172839506, 'loss_val': 2.4606127469513797, 'psi': 0.2839506172839506}-{'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 1.9943988305805298, 'psi': 0.29792295726964957}
[S4] START round=13 head_norm_before_train=1.249201 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.382251341181, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3508438761414985, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.666590 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 2.741596359146288, 'psi': 0.24981467753891773}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 2.682907595513685, 'psi': 0.33451196111837667}
[S6] START round=13 head_norm_before_train=1.467343 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.07555178268251274, 'auprc': 0.07555178268251274, 'loss_val': 4.436662205364674, 'psi': 0.07555178268251274}-{'f1_val': 0.07933950865888038, 'auprc': 0.07933950865888038, 'loss_val': 3.9104458792269505, 'psi': 0.07933950865888038}
[S7] START round=13 head_norm_before_train=1.501824 (no previous merge yet)
[S7] round=13 local utility u=0.089324 metrics={'f1_val': 0.1651116294568477, 'auprc': 0.1651116294568477, 'loss_val': 1.188779664771696, 'psi': 0.1651116294568477}-{'f1_val': 0.15019143752175426, 'auprc': 0.15019143752175426, 'loss_val': 1.233146146418866, 'psi': 0.15019143752175426}
[S8] START round=13 head_norm_before_train=1.433661 (no previous merge yet)
[S8] round=13 local utility u=0.000933 metrics={'f1_val': 0.20689203354297694, 'auprc': 0.20689203354297694, 'loss_val': 1.2399566102482775, 'psi': 0.20689203354297694}-{'f1_val': 0.21002926310188882, 'auprc': 0.21002926310188882, 'loss_val': 1.2700578288762248, 'psi': 0.2100292631018888}
[S9] START round=13 head_norm_before_train=1.187627 cos_to_last_merge=0.9971 (last merge round=11)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7886017856801906, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6526553533797899, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=1.533992 (no previous merge yet)
[S10] round=13 local utility u=0.139020 metrics={'f1_val': 0.2562291544045517, 'auprc': 0.2562291544045517, 'loss_val': 3.631671186014039, 'psi': 0.2562291544045517}-{'f1_val': 0.23340581961271614, 'auprc': 0.23340581961271614, 'loss_val': 3.704300712023454, 'psi': 0.23340581961271614}
[S11] START round=13 head_norm_before_train=1.084291 cos_to_last_merge=0.9981 (last merge round=11)
[S11] round=13 local utility u=1.000000 metrics={'f1_val': 0.2724845806867348, 'auprc': 0.2724845806867348, 'loss_val': 2.2401433127550994, 'psi': 0.2724845806867348}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2660974757676957, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.413661 (no previous merge yet)
[S13] round=13 local utility u=0.009515 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.119465327703894, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1384960017619123, 'psi': 0.3599362944611573}
[S14] START round=13 head_norm_before_train=1.498796 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.00023485204321277596, 'auprc': 0.00023485204321277596, 'loss_val': 5.2913954601185145, 'psi': 0.00023485204321277596}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.116291602854319, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.502102 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.27273858404877444, 'auprc': 0.27273858404877444, 'loss_val': 1.1055769150064392, 'psi': 0.27273858404877444}-{'f1_val': 0.28248998907899525, 'auprc': 0.28248998907899525, 'loss_val': 1.1525177203150325, 'psi': 0.28248998907899525}
[S16] START round=13 head_norm_before_train=1.328885 cos_to_last_merge=0.9888 (last merge round=9)
[S16] round=13 local utility u=0.034216 metrics={'f1_val': 0.0675314765356734, 'auprc': 0.0675314765356734, 'loss_val': 2.72008354137764, 'psi': 0.0675314765356734}-{'f1_val': 0.03229974160206718, 'auprc': 0.03229974160206718, 'loss_val': 2.4714307868883214, 'psi': 0.03229974160206718}
[S17] START round=13 head_norm_before_train=1.070298 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.006265 metrics={'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 1.3022002543788154, 'psi': 0.20305027788548533}-{'f1_val': 0.2031290405999483, 'auprc': 0.2031290405999483, 'loss_val': 1.3154394390485211, 'psi': 0.2031290405999483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:42004
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[S7] not sending this round → trigger blocked (psi=0.165)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:42017
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.068)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:42013
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=-0.0234
[S3] DROPPED delta from S10 (cos=-0.0234 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] cosine check vs S8: cos=0.8731
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] cosine check vs S13: cos=0.9465
[S13] RECEIVED delta(kind=head bytes=1804) from S11
[S13] cosine check vs S11: cos=-0.0526
[S13] DROPPED delta from S11 (cos=-0.0526 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1790) from S2
[S13] cosine check vs S2: cos=-0.0051
[S13] DROPPED delta from S2 (cos=-0.0051 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] cosine check vs S17: cos=0.8079
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.0000 head_norm=1.280739
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.362964e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.342948 delta_norm=0.236296
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.2840 head_norm=1.183421
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.562866e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.2906 head_norm=1.086789 delta_norm=0.356287
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.2031 head_norm=1.102549
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.638430e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.2031 head_norm=1.237472 delta_norm=0.363843
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.527754 (no previous merge yet)
[S2] round=14 local utility u=0.226510 metrics={'f1_val': 0.262, 'auprc': 0.262, 'loss_val': 2.440386417566945, 'psi': 0.262}-{'f1_val': 0.21612783351913786, 'auprc': 0.21612783351913786, 'loss_val': 2.48055613843044, 'psi': 0.21612783351913786}
[S3] START round=14 head_norm_before_train=1.086789 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.194390 metrics={'f1_val': 0.2835139760410725, 'auprc': 0.2835139760410725, 'loss_val': 2.0679028526402767, 'psi': 0.2835139760410725}-{'f1_val': 0.2839506172839506, 'auprc': 0.2839506172839506, 'loss_val': 2.4606127469513797, 'psi': 0.2839506172839506}
[S4] START round=14 head_norm_before_train=1.342948 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3959251999801392, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.382251341181, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.712526 (no previous merge yet)
[S5] round=14 local utility u=0.036889 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 2.6678179719250568, 'psi': 0.24981467753891773}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 2.741596359146288, 'psi': 0.24981467753891773}
[S6] START round=14 head_norm_before_train=1.496627 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.02724211815120906, 'auprc': 0.02724211815120906, 'loss_val': 4.777543423850996, 'psi': 0.027242118151209055}-{'f1_val': 0.07555178268251274, 'auprc': 0.07555178268251274, 'loss_val': 4.436662205364674, 'psi': 0.07555178268251274}
[S7] START round=14 head_norm_before_train=1.528911 (no previous merge yet)
[S7] round=14 local utility u=0.412540 metrics={'f1_val': 0.24767762992719056, 'auprc': 0.24767762992719056, 'loss_val': 1.1067932754701195, 'psi': 0.24767762992719056}-{'f1_val': 0.1651116294568477, 'auprc': 0.1651116294568477, 'loss_val': 1.188779664771696, 'psi': 0.1651116294568477}
[S8] START round=14 head_norm_before_train=1.453211 (no previous merge yet)
[S8] round=14 local utility u=0.030895 metrics={'f1_val': 0.2077148784902094, 'auprc': 0.2077148784902094, 'loss_val': 1.1855728651875108, 'psi': 0.2077148784902094}-{'f1_val': 0.20689203354297694, 'auprc': 0.20689203354297694, 'loss_val': 1.2399566102482775, 'psi': 0.20689203354297694}
[S9] START round=14 head_norm_before_train=1.275401 cos_to_last_merge=0.9884 (last merge round=11)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9150442722710341, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7886017856801906, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.559208 (no previous merge yet)
[S10] round=14 local utility u=0.339408 metrics={'f1_val': 0.31536523929471033, 'auprc': 0.31536523929471033, 'loss_val': 3.485079625459206, 'psi': 0.31536523929471033}-{'f1_val': 0.2562291544045517, 'auprc': 0.2562291544045517, 'loss_val': 3.631671186014039, 'psi': 0.2562291544045517}
[S11] START round=14 head_norm_before_train=1.126732 cos_to_last_merge=0.9910 (last merge round=11)
[S11] round=14 local utility u=0.320690 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.133826332755754, 'psi': 0.3319360347772085}-{'f1_val': 0.2724845806867348, 'auprc': 0.2724845806867348, 'loss_val': 2.2401433127550994, 'psi': 0.2724845806867348}
[S13] START round=14 head_norm_before_train=1.441666 (no previous merge yet)
[S13] round=14 local utility u=0.005648 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1081693274297448, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.119465327703894, 'psi': 0.3599362944611573}
[S14] START round=14 head_norm_before_train=1.515643 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.804052812623498, 'psi': 0.0}-{'f1_val': 0.00023485204321277596, 'auprc': 0.00023485204321277596, 'loss_val': 5.2913954601185145, 'psi': 0.00023485204321277596}
[S15] START round=14 head_norm_before_train=1.530980 (no previous merge yet)
[S15] round=14 local utility u=0.148673 metrics={'f1_val': 0.28868194842406875, 'auprc': 0.28868194842406875, 'loss_val': 0.9517216898661572, 'psi': 0.28868194842406875}-{'f1_val': 0.27273858404877444, 'auprc': 0.27273858404877444, 'loss_val': 1.1055769150064392, 'psi': 0.27273858404877444}
[S16] START round=14 head_norm_before_train=1.372369 cos_to_last_merge=0.9819 (last merge round=9)
[S16] round=14 local utility u=0.062823 metrics={'f1_val': 0.08946700507614214, 'auprc': 0.08946700507614214, 'loss_val': 2.7918576522138987, 'psi': 0.08946700507614214}-{'f1_val': 0.0675314765356734, 'auprc': 0.0675314765356734, 'loss_val': 2.72008354137764, 'psi': 0.0675314765356734}
[S17] START round=14 head_norm_before_train=1.237472 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.297724866622601, 'psi': 0.152287708414114}-{'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 1.3022002543788154, 'psi': 0.20305027788548533}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:42013
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[S16] not sending this round → trigger blocked (psi=0.089)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] cosine check vs S10: cos=-0.0076
[S3] DROPPED delta from S10 (cos=-0.0076 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.8328
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] cosine check vs S13: cos=0.9693
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] cosine check vs S11: cos=-0.0584
[S13] DROPPED delta from S11 (cos=-0.0584 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] cosine check vs S7: cos=0.0247
[S13] RECEIVED delta(kind=head bytes=1797) from S2
[S13] cosine check vs S2: cos=-0.0067
[S13] DROPPED delta from S2 (cos=-0.0067 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] cosine check vs S3: cos=0.5512
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] cosine check vs S15: cos=0.6481
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9648
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.0000 head_norm=1.369155
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.836062e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.410242 delta_norm=0.183606
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.3687 head_norm=1.349347
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.022062e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.3687 head_norm=1.110942 delta_norm=0.602206
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.0000 head_norm=1.533658
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.078605e+00
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.105553 delta_norm=1.078605
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.0895 head_norm=1.412254
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.854574e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.0941 head_norm=1.515330 delta_norm=0.485457
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.3319 head_norm=1.178397
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.991865e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.3319 head_norm=1.244576 delta_norm=0.599186
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.1523 head_norm=1.270905
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.068689e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.1523 head_norm=1.358407 delta_norm=0.206869
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.557821 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.19446393762183237, 'auprc': 0.19446393762183237, 'loss_val': 2.798821280888746, 'psi': 0.19446393762183237}-{'f1_val': 0.262, 'auprc': 0.262, 'loss_val': 2.440386417566945, 'psi': 0.262}
[S3] START round=15 head_norm_before_train=1.171731 cos_to_last_merge=0.9937 (last merge round=13)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.207373740599158, 'psi': 0.29792295726964957}-{'f1_val': 0.2835139760410725, 'auprc': 0.2835139760410725, 'loss_val': 2.0679028526402767, 'psi': 0.2835139760410725}
[S4] START round=15 head_norm_before_train=1.410242 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000577 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3947703331303818, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3959251999801392, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.751950 (no previous merge yet)
[S5] round=15 local utility u=0.379334 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6623808960419715, 'psi': 0.3335071121394324}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 2.6678179719250568, 'psi': 0.24981467753891773}
[S6] START round=15 head_norm_before_train=1.521885 (no previous merge yet)
[S6] round=15 local utility u=0.243100 metrics={'f1_val': 0.06533499791926758, 'auprc': 0.06533499791926758, 'loss_val': 4.634179379841671, 'psi': 0.06533499791926758}-{'f1_val': 0.02724211815120906, 'auprc': 0.02724211815120906, 'loss_val': 4.777543423850996, 'psi': 0.027242118151209055}
[S7] START round=15 head_norm_before_train=1.555367 (no previous merge yet)
[S7] round=15 local utility u=0.013672 metrics={'f1_val': 0.24204720369420216, 'auprc': 0.24204720369420216, 'loss_val': 1.028774828442063, 'psi': 0.24204720369420216}-{'f1_val': 0.24767762992719056, 'auprc': 0.24767762992719056, 'loss_val': 1.1067932754701195, 'psi': 0.24767762992719056}
[S8] START round=15 head_norm_before_train=1.470010 (no previous merge yet)
[S8] round=15 local utility u=0.085069 metrics={'f1_val': 0.21868117000421816, 'auprc': 0.21868117000421816, 'loss_val': 1.114132420577294, 'psi': 0.21868117000421816}-{'f1_val': 0.2077148784902094, 'auprc': 0.2077148784902094, 'loss_val': 1.1855728651875108, 'psi': 0.2077148784902094}
[S9] START round=15 head_norm_before_train=1.110942 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.179638 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.555769128612451, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9150442722710341, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.582096 (no previous merge yet)
[S10] round=15 local utility u=0.125994 metrics={'f1_val': 0.332454668903267, 'auprc': 0.332454668903267, 'loss_val': 3.3868956219464987, 'psi': 0.332454668903267}-{'f1_val': 0.31536523929471033, 'auprc': 0.31536523929471033, 'loss_val': 3.485079625459206, 'psi': 0.31536523929471033}
[S11] START round=15 head_norm_before_train=1.244576 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.056753 metrics={'f1_val': 0.33232252546458285, 'auprc': 0.33232252546458285, 'loss_val': 2.0237979838876923, 'psi': 0.33232252546458285}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.133826332755754, 'psi': 0.3319360347772085}
[S13] START round=15 head_norm_before_train=1.473228 (no previous merge yet)
[S13] round=15 local utility u=0.002275 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.103619040616675, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1081693274297448, 'psi': 0.3599362944611573}
[S14] START round=15 head_norm_before_train=1.105553 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=1.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2636208094232337, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.804052812623498, 'psi': 0.0}
[S15] START round=15 head_norm_before_train=1.558002 (no previous merge yet)
[S15] round=15 local utility u=1.000000 metrics={'f1_val': 0.5869023662584434, 'auprc': 0.5869023662584434, 'loss_val': 0.9621886447438279, 'psi': 0.5869023662584434}-{'f1_val': 0.28868194842406875, 'auprc': 0.28868194842406875, 'loss_val': 0.9517216898661572, 'psi': 0.28868194842406875}
[S16] START round=15 head_norm_before_train=1.515330 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.05012722646310432, 'auprc': 0.05012722646310432, 'loss_val': 2.574063157639835, 'psi': 0.05012722646310432}-{'f1_val': 0.08946700507614214, 'auprc': 0.08946700507614214, 'loss_val': 2.7918576522138987, 'psi': 0.08946700507614214}
[S17] START round=15 head_norm_before_train=1.358407 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.2985873286746643, 'psi': 0.15237633365664405}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.297724866622601, 'psi': 0.152287708414114}
[S14] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:42014
[S4] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.065)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S11
[S13] cosine check vs S11: cos=-0.0187
[S13] DROPPED delta from S11 (cos=-0.0187 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S10
[S3] cosine check vs S10: cos=-0.0106
[S3] DROPPED delta from S10 (cos=-0.0106 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.9830
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.9559
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] cosine check vs S7: cos=0.7042
[S11] RECEIVED delta(kind=head bytes=1793) from S15
[S11] cosine check vs S15: cos=0.9127
[S17] RECEIVED delta(kind=head bytes=1804) from S9
[S17] cosine check vs S9: cos=0.5357
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] cosine check vs S13: cos=0.9777
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.0000 head_norm=1.129748
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.614850e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.254366 delta_norm=0.561485
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.237 → S15@127.0.0.1:42015
[S6] ⇄ pheromone p=0.132 → S11@127.0.0.1:42012
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.0000 head_norm=1.435763
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.583008e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.459915 delta_norm=0.158301
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.042 → S10@127.0.0.1:42011
[S2] ⇄ pheromone p=0.239 → S13@127.0.0.1:42013
[S3] ⇄ pheromone p=0.178 → S9@127.0.0.1:42010
[S15] ⇄ pheromone p=0.375 → S11@127.0.0.1:42012
[S9] ⇄ pheromone p=0.140 → S17@127.0.0.1:42017
[S13] ⇄ pheromone p=0.128 → S4@127.0.0.1:42004
[S7] ⇄ pheromone p=0.198 → S14@127.0.0.1:42014
[S8] ⇄ pheromone p=0.106 → S17@127.0.0.1:42017
[S10] ⇄ pheromone p=0.210 → S3@127.0.0.1:42003
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.3323 head_norm=1.277276
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.346104e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.3323 head_norm=1.399849 delta_norm=0.334610
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.258 → S13@127.0.0.1:42013
[S5] ⇄ pheromone p=0.220 → S16@127.0.0.1:42016
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.1524 head_norm=1.393608
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.800589e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.1523 head_norm=1.243091 delta_norm=0.280059
[S17] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.086 → S3@127.0.0.1:42003
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.0501 head_norm=1.547235
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.747381e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.0628 head_norm=1.649248 delta_norm=0.274738
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.077 → S17@127.0.0.1:42017
[S2] START round=16 head_norm_before_train=1.587349 (no previous merge yet)
[S2] round=16 local utility u=0.449875 metrics={'f1_val': 0.24615573117686698, 'auprc': 0.24615573117686698, 'loss_val': 2.364298295767553, 'psi': 0.24615573117686695}-{'f1_val': 0.19446393762183237, 'auprc': 0.19446393762183237, 'loss_val': 2.798821280888746, 'psi': 0.19446393762183237}
[S3] START round=16 head_norm_before_train=1.251850 cos_to_last_merge=0.9820 (last merge round=13)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.28362322973101417, 'auprc': 0.28362322973101417, 'loss_val': 2.6077459419746654, 'psi': 0.28362322973101417}-{'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.207373740599158, 'psi': 0.29792295726964957}
[S4] START round=16 head_norm_before_train=1.459915 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.006167 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.382436487681601, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3947703331303818, 'psi': 0.0}
[S5] START round=16 head_norm_before_train=1.788033 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7149746329512103, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6623808960419715, 'psi': 0.3335071121394324}
[S6] START round=16 head_norm_before_train=1.542863 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 5.022472205147168, 'psi': 0.02262340036563071}-{'f1_val': 0.06533499791926758, 'auprc': 0.06533499791926758, 'loss_val': 4.634179379841671, 'psi': 0.06533499791926758}
[S7] START round=16 head_norm_before_train=1.581477 (no previous merge yet)
[S7] round=16 local utility u=0.442054 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.9647510789877486, 'psi': 0.33316757831924415}-{'f1_val': 0.24204720369420216, 'auprc': 0.24204720369420216, 'loss_val': 1.028774828442063, 'psi': 0.24204720369420216}
[S8] START round=16 head_norm_before_train=1.490907 (no previous merge yet)
[S8] round=16 local utility u=0.219572 metrics={'f1_val': 0.2596422447595725, 'auprc': 0.2596422447595725, 'loss_val': 1.0436385160694208, 'psi': 0.2596422447595725}-{'f1_val': 0.21868117000421816, 'auprc': 0.21868117000421816, 'loss_val': 1.114132420577294, 'psi': 0.21868117000421816}
[S9] START round=16 head_norm_before_train=1.193892 cos_to_last_merge=0.9941 (last merge round=14)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6985256563296547, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.555769128612451, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.606843 (no previous merge yet)
[S10] round=16 local utility u=0.043773 metrics={'f1_val': 0.33277471869762987, 'auprc': 0.33277471869762987, 'loss_val': 3.302230097269769, 'psi': 0.33277471869762987}-{'f1_val': 0.332454668903267, 'auprc': 0.332454668903267, 'loss_val': 3.3868956219464987, 'psi': 0.332454668903267}
[S11] START round=16 head_norm_before_train=1.399849 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.023629 metrics={'f1_val': 0.32772910253374377, 'auprc': 0.32772910253374377, 'loss_val': 1.9351991695815813, 'psi': 0.32772910253374377}-{'f1_val': 0.33232252546458285, 'auprc': 0.33232252546458285, 'loss_val': 2.0237979838876923, 'psi': 0.33232252546458285}
[S13] START round=16 head_norm_before_train=1.500469 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1154522432083176, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.103619040616675, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.254366 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.250385 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7628500330091987, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2636208094232337, 'psi': 0.0}
[S15] START round=16 head_norm_before_train=1.584818 (no previous merge yet)
[S15] round=16 local utility u=0.135552 metrics={'f1_val': 0.6012969828959425, 'auprc': 0.6012969828959425, 'loss_val': 0.8206360274257222, 'psi': 0.6012969828959425}-{'f1_val': 0.5869023662584434, 'auprc': 0.5869023662584434, 'loss_val': 0.9621886447438279, 'psi': 0.5869023662584434}
[S16] START round=16 head_norm_before_train=1.649248 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.261988 metrics={'f1_val': 0.07459782044628957, 'auprc': 0.07459782044628957, 'loss_val': 2.2703217583566255, 'psi': 0.07459782044628957}-{'f1_val': 0.05012722646310432, 'auprc': 0.05012722646310432, 'loss_val': 2.574063157639835, 'psi': 0.05012722646310432}
[S17] START round=16 head_norm_before_train=1.243091 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.019452 metrics={'f1_val': 0.15450432730133754, 'auprc': 0.15450432730133754, 'loss_val': 1.2788355332688373, 'psi': 0.15450432730133754}-{'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.2985873286746643, 'psi': 0.15237633365664405}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:42003
[S14] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.075)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S15
[S11] cosine check vs S15: cos=0.9698
[S3] RECEIVED delta(kind=head bytes=1803) from S10
[S3] cosine check vs S10: cos=-0.0128
[S3] DROPPED delta from S10 (cos=-0.0128 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9449
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=0.9262
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] cosine check vs S2: cos=-0.0102
[S13] DROPPED delta from S2 (cos=-0.0102 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=-0.0027
[S13] DROPPED delta from S11 (cos=-0.0027 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S17
[S3] cosine check vs S17: cos=0.8459
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.2836 head_norm=1.326156
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.626329e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.2909 head_norm=1.253078 delta_norm=0.362633
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.0000 head_norm=1.282321
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.188018e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.0000 head_norm=1.416432 delta_norm=0.318802
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.3277 head_norm=1.422508
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.098642e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.3277 head_norm=1.507569 delta_norm=0.209864
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.1545 head_norm=1.282468
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.594507e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.1533 head_norm=1.380289 delta_norm=0.259451
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.613738 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.3633145811767737, 'psi': 0.2450298816928894}-{'f1_val': 0.24615573117686698, 'auprc': 0.24615573117686698, 'loss_val': 2.364298295767553, 'psi': 0.24615573117686695}
[S3] START round=17 head_norm_before_train=1.253078 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.240254 metrics={'f1_val': 0.28633446583616456, 'auprc': 0.28633446583616456, 'loss_val': 2.151638422710884, 'psi': 0.28633446583616456}-{'f1_val': 0.28362322973101417, 'auprc': 0.28362322973101417, 'loss_val': 2.6077459419746654, 'psi': 0.28362322973101417}
[S4] START round=17 head_norm_before_train=1.484265 cos_to_last_merge=0.9962 (last merge round=15)
[S4] round=17 local utility u=1.000000 metrics={'f1_val': 0.33129251700680273, 'auprc': 0.33129251700680273, 'loss_val': 1.329730033856268, 'psi': 0.33129251700680273}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.382436487681601, 'psi': 0.0}
[S5] START round=17 head_norm_before_train=1.817106 (no previous merge yet)
[S5] round=17 local utility u=0.029031 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.656912142639294, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7149746329512103, 'psi': 0.3335071121394324}
[S6] START round=17 head_norm_before_train=1.565198 (no previous merge yet)
[S6] round=17 local utility u=0.198199 metrics={'f1_val': 0.0611344537815126, 'auprc': 0.0611344537815126, 'loss_val': 4.9726727657642185, 'psi': 0.0611344537815126}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 5.022472205147168, 'psi': 0.02262340036563071}
[S7] START round=17 head_norm_before_train=1.603584 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.24968897735755163, 'auprc': 0.24968897735755163, 'loss_val': 0.9692253512090635, 'psi': 0.24968897735755163}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.9647510789877486, 'psi': 0.33316757831924415}
[S8] START round=17 head_norm_before_train=1.516673 (no previous merge yet)
[S8] round=17 local utility u=0.154356 metrics={'f1_val': 0.2868742323479314, 'auprc': 0.2868742323479314, 'loss_val': 0.980015207553762, 'psi': 0.2868742323479314}-{'f1_val': 0.2596422447595725, 'auprc': 0.2596422447595725, 'loss_val': 1.0436385160694208, 'psi': 0.2596422447595725}
[S9] START round=17 head_norm_before_train=1.288059 cos_to_last_merge=0.9806 (last merge round=14)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8011075467591486, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6985256563296547, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.634333 (no previous merge yet)
[S10] round=17 local utility u=0.051903 metrics={'f1_val': 0.3330941561030057, 'auprc': 0.3330941561030057, 'loss_val': 3.2012983350615247, 'psi': 0.3330941561030057}-{'f1_val': 0.33277471869762987, 'auprc': 0.33277471869762987, 'loss_val': 3.302230097269769, 'psi': 0.33277471869762987}
[S11] START round=17 head_norm_before_train=1.507569 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.007901 metrics={'f1_val': 0.3285298054964958, 'auprc': 0.3285298054964958, 'loss_val': 1.9266038606663156, 'psi': 0.3285298054964958}-{'f1_val': 0.32772910253374377, 'auprc': 0.32772910253374377, 'loss_val': 1.9351991695815813, 'psi': 0.32772910253374377}
[S13] START round=17 head_norm_before_train=1.523021 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1366438047308554, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1154522432083176, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=1.416432 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.800082810499245, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7628500330091987, 'psi': 0.0}
[S15] START round=17 head_norm_before_train=1.615577 (no previous merge yet)
[S15] round=17 local utility u=0.092783 metrics={'f1_val': 0.6124769144966106, 'auprc': 0.6124769144966106, 'loss_val': 0.735688961044675, 'psi': 0.6124769144966106}-{'f1_val': 0.6012969828959425, 'auprc': 0.6012969828959425, 'loss_val': 0.8206360274257222, 'psi': 0.6012969828959425}
[S16] START round=17 head_norm_before_train=1.680905 cos_to_last_merge=0.9992 (last merge round=15)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.06897792706333973, 'auprc': 0.06897792706333973, 'loss_val': 2.544099643807617, 'psi': 0.06897792706333973}-{'f1_val': 0.07459782044628957, 'auprc': 0.07459782044628957, 'loss_val': 2.2703217583566255, 'psi': 0.07459782044628957}
[S17] START round=17 head_norm_before_train=1.380289 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.013662 metrics={'f1_val': 0.16093264248704664, 'auprc': 0.16093264248704664, 'loss_val': 1.3093662889019373, 'psi': 0.16093264248704664}-{'f1_val': 0.15450432730133754, 'auprc': 0.15450432730133754, 'loss_val': 1.2788355332688373, 'psi': 0.15450432730133754}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:42016
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:42003
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:42011
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.061)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] cosine check vs S15: cos=0.9830
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9802
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.9765
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] cosine check vs S11: cos=0.0038
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=0.7028
[S3] RECEIVED delta(kind=head bytes=1804) from S10
[S3] cosine check vs S10: cos=0.0042
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] cosine check vs S4: cos=-0.0567
[S10] DROPPED delta from S4 (cos=-0.0567 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1806) from S17
[S3] cosine check vs S17: cos=0.9019
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.3687 head_norm=1.360676
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.170702e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.3687 head_norm=1.236904 delta_norm=0.517070
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.3599 head_norm=1.545671
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.084735e+00
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.3599 head_norm=1.088857 delta_norm=1.084735
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.3285 head_norm=1.528208
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.575474e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.3280 head_norm=1.580449 delta_norm=0.157547
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.2863 head_norm=1.320283
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.661412e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.2977 head_norm=1.081049 delta_norm=0.566141
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.0690 head_norm=1.717137
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.011546e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.0807 head_norm=1.765006 delta_norm=0.201155
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.1609 head_norm=1.416697
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.616508e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.1609 head_norm=1.475339 delta_norm=0.161651
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.637195 (no previous merge yet)
[S2] round=18 local utility u=0.001433 metrics={'f1_val': 0.26452295884610294, 'auprc': 0.26452295884610294, 'loss_val': 2.535886559740212, 'psi': 0.26452295884610294}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.3633145811767737, 'psi': 0.2450298816928894}
[S3] START round=18 head_norm_before_train=1.081049 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.18421367828482452, 'auprc': 0.18421367828482452, 'loss_val': 2.2146691427993392, 'psi': 0.18421367828482452}-{'f1_val': 0.28633446583616456, 'auprc': 0.28633446583616456, 'loss_val': 2.151638422710884, 'psi': 0.28633446583616456}
[S4] START round=18 head_norm_before_train=1.521257 cos_to_last_merge=0.9862 (last merge round=15)
[S4] round=18 local utility u=0.026640 metrics={'f1_val': 0.3330795906284361, 'auprc': 0.3330795906284361, 'loss_val': 1.292533707248405, 'psi': 0.3330795906284361}-{'f1_val': 0.33129251700680273, 'auprc': 0.33129251700680273, 'loss_val': 1.329730033856268, 'psi': 0.33129251700680273}
[S5] START round=18 head_norm_before_train=1.833810 (no previous merge yet)
[S5] round=18 local utility u=0.004427 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6480584690865783, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.656912142639294, 'psi': 0.3335071121394324}
[S6] START round=18 head_norm_before_train=1.586858 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.0620545073375262, 'auprc': 0.0620545073375262, 'loss_val': 5.045684341779902, 'psi': 0.0620545073375262}-{'f1_val': 0.0611344537815126, 'auprc': 0.0611344537815126, 'loss_val': 4.9726727657642185, 'psi': 0.0611344537815126}
[S7] START round=18 head_norm_before_train=1.628265 (no previous merge yet)
[S7] round=18 local utility u=0.011859 metrics={'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.9455090699761685, 'psi': 0.24968913205670232}-{'f1_val': 0.24968897735755163, 'auprc': 0.24968897735755163, 'loss_val': 0.9692253512090635, 'psi': 0.24968897735755163}
[S8] START round=18 head_norm_before_train=1.548704 (no previous merge yet)
[S8] round=18 local utility u=0.271052 metrics={'f1_val': 0.3409048643858137, 'auprc': 0.3409048643858137, 'loss_val': 0.9241865780153594, 'psi': 0.3409048643858137}-{'f1_val': 0.2868742323479314, 'auprc': 0.2868742323479314, 'loss_val': 0.980015207553762, 'psi': 0.2868742323479314}
[S9] START round=18 head_norm_before_train=1.236904 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.111131 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5788460399470035, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8011075467591486, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.661492 (no previous merge yet)
[S10] round=18 local utility u=0.043193 metrics={'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 3.11706487889699, 'psi': 0.3333333333333333}-{'f1_val': 0.3330941561030057, 'auprc': 0.3330941561030057, 'loss_val': 3.2012983350615247, 'psi': 0.3330941561030057}
[S11] START round=18 head_norm_before_train=1.580449 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.040672 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 1.8779997539439295, 'psi': 0.33216756042589574}-{'f1_val': 0.3285298054964958, 'auprc': 0.3285298054964958, 'loss_val': 1.9266038606663156, 'psi': 0.3285298054964958}
[S13] START round=18 head_norm_before_train=1.088857 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.001923 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1327985218585581, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1366438047308554, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.442509 cos_to_last_merge=0.9962 (last merge round=16)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5927442315222997, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.800082810499245, 'psi': 0.0}
[S15] START round=18 head_norm_before_train=1.646165 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6060394664045415, 'auprc': 0.6060394664045415, 'loss_val': 0.7477282030534466, 'psi': 0.6060394664045415}-{'f1_val': 0.6124769144966106, 'auprc': 0.6124769144966106, 'loss_val': 0.735688961044675, 'psi': 0.6124769144966106}
[S16] START round=18 head_norm_before_train=1.765006 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.204506 metrics={'f1_val': 0.1021063346644742, 'auprc': 0.1021063346644742, 'loss_val': 2.4332438164068013, 'psi': 0.1021063346644742}-{'f1_val': 0.06897792706333973, 'auprc': 0.06897792706333973, 'loss_val': 2.544099643807617, 'psi': 0.06897792706333973}
[S17] START round=18 head_norm_before_train=1.475339 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.005357 metrics={'f1_val': 0.15638064901453314, 'auprc': 0.15638064901453314, 'loss_val': 1.2576853164028217, 'psi': 0.15638064901453314}-{'f1_val': 0.16093264248704664, 'auprc': 0.16093264248704664, 'loss_val': 1.3093662889019373, 'psi': 0.16093264248704664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[S16] not sending this round → trigger blocked (psi=0.102)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:42004
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:42016
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] cosine check vs S10: cos=0.3630
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.6715
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9897
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.9900
[S4] RECEIVED delta(kind=head bytes=1798) from S13
[S4] cosine check vs S13: cos=0.7024
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9478
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] cosine check vs S2: cos=-0.0483
[S13] DROPPED delta from S2 (cos=-0.0483 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=0.6903
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] cosine check vs S4: cos=-0.0619
[S10] DROPPED delta from S4 (cos=-0.0619 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S17
[S3] cosine check vs S17: cos=0.8502
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.0000 head_norm=1.480295
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.676197e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.0000 head_norm=1.547503 delta_norm=0.267620
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.1842 head_norm=1.168905
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.473264e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.2677 head_norm=1.107700 delta_norm=0.347326
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.3599 head_norm=1.113377
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.788616e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.3599 head_norm=1.250970 delta_norm=0.578862
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.3331 head_norm=1.566352
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.574556e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.3317 head_norm=1.239265 delta_norm=0.557456
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.1021 head_norm=1.797250
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.320974e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.1111 head_norm=1.820048 delta_norm=0.132097
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.1564 head_norm=1.506065
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.582164e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.1542 head_norm=1.380959 delta_norm=0.258216
[S17] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.659423 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.24570415214333763, 'auprc': 0.24570415214333763, 'loss_val': 2.4881573695727286, 'psi': 0.24570415214333763}-{'f1_val': 0.26452295884610294, 'auprc': 0.26452295884610294, 'loss_val': 2.535886559740212, 'psi': 0.26452295884610294}
[S3] START round=19 head_norm_before_train=1.107700 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.052327 metrics={'f1_val': 0.1970385915821383, 'auprc': 0.1970385915821383, 'loss_val': 2.225438367739276, 'psi': 0.1970385915821383}-{'f1_val': 0.18421367828482452, 'auprc': 0.18421367828482452, 'loss_val': 2.2146691427993392, 'psi': 0.18421367828482452}
[S4] START round=19 head_norm_before_train=1.239265 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.33316421444275324, 'auprc': 0.33316421444275324, 'loss_val': 1.3275660148847954, 'psi': 0.33316421444275324}-{'f1_val': 0.3330795906284361, 'auprc': 0.3330795906284361, 'loss_val': 1.292533707248405, 'psi': 0.3330795906284361}
[S5] START round=19 head_norm_before_train=1.852010 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.675233585933359, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6480584690865783, 'psi': 0.3335071121394324}
[S6] START round=19 head_norm_before_train=1.604965 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.040749063670411985, 'auprc': 0.040749063670411985, 'loss_val': 5.418990344621865, 'psi': 0.040749063670411985}-{'f1_val': 0.0620545073375262, 'auprc': 0.0620545073375262, 'loss_val': 5.045684341779902, 'psi': 0.0620545073375262}
[S7] START round=19 head_norm_before_train=1.655747 (no previous merge yet)
[S7] round=19 local utility u=0.401563 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.8929443089164056, 'psi': 0.33308476261496395}-{'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.9455090699761685, 'psi': 0.24968913205670232}
[S8] START round=19 head_norm_before_train=1.580225 (no previous merge yet)
[S8] round=19 local utility u=0.091633 metrics={'f1_val': 0.3556602882197382, 'auprc': 0.3556602882197382, 'loss_val': 0.873719175283856, 'psi': 0.3556602882197382}-{'f1_val': 0.3409048643858137, 'auprc': 0.3409048643858137, 'loss_val': 0.9241865780153594, 'psi': 0.3409048643858137}
[S9] START round=19 head_norm_before_train=1.310548 cos_to_last_merge=0.9953 (last merge round=17)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7017496208669525, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5788460399470035, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.687243 (no previous merge yet)
[S10] round=19 local utility u=0.034140 metrics={'f1_val': 0.3332536837913182, 'auprc': 0.3332536837913182, 'loss_val': 3.0480675432387314, 'psi': 0.3332536837913182}-{'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 3.11706487889699, 'psi': 0.3333333333333333}
[S11] START round=19 head_norm_before_train=1.600127 cos_to_last_merge=0.9972 (last merge round=17)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.3322450248756219, 'auprc': 0.3322450248756219, 'loss_val': 1.9459380499579784, 'psi': 0.3322450248756219}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 1.8779997539439295, 'psi': 0.33216756042589574}
[S13] START round=19 head_norm_before_train=1.250970 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1760534451801463, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1327985218585581, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.547503 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.382603 metrics={'f1_val': 0.047972088966419545, 'auprc': 0.047972088966419545, 'loss_val': 3.2592877002836143, 'psi': 0.047972088966419545}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5927442315222997, 'psi': 0.0}
[S15] START round=19 head_norm_before_train=1.674638 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6000775699094484, 'auprc': 0.6000775699094484, 'loss_val': 0.7363504618468555, 'psi': 0.6000775699094484}-{'f1_val': 0.6060394664045415, 'auprc': 0.6060394664045415, 'loss_val': 0.7477282030534466, 'psi': 0.6060394664045415}
[S16] START round=19 head_norm_before_train=1.820048 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.054130 metrics={'f1_val': 0.09922770886964662, 'auprc': 0.09922770886964662, 'loss_val': 2.2990766972282852, 'psi': 0.09922770886964662}-{'f1_val': 0.1021063346644742, 'auprc': 0.1021063346644742, 'loss_val': 2.4332438164068013, 'psi': 0.1021063346644742}
[S17] START round=19 head_norm_before_train=1.380959 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.040250 metrics={'f1_val': 0.15732024834768676, 'auprc': 0.15732024834768676, 'loss_val': 1.1856424542637902, 'psi': 0.15732024834768676}-{'f1_val': 0.15638064901453314, 'auprc': 0.15638064901453314, 'loss_val': 1.2576853164028217, 'psi': 0.15638064901453314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.048)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:42010
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.099)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.5324
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9604
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9760
[S9] RECEIVED delta(kind=head bytes=1803) from S3
[S9] cosine check vs S3: cos=0.6317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=0.8071
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.3687 head_norm=1.393969
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.648926e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.3687 head_norm=1.176701 delta_norm=0.564893
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0750 f1=0.369 auprc=0.369 bytes=7202
[S2] r=20 psi=0.246 u=0.0000 p_local=0.1440 f1=0.246 auprc=0.246 bytes=7188
[S11] r=20 psi=0.332 u=0.0000 p_local=0.1157 f1=0.332 auprc=0.332 bytes=10803
[S6] r=20 psi=0.041 u=0.0000 p_local=0.0793 f1=0.041 auprc=0.041 bytes=0
[S15] r=20 psi=0.600 u=0.0000 p_local=0.1795 f1=0.600 auprc=0.600 bytes=8993
[S5] r=20 psi=0.334 u=0.0000 p_local=0.0947 f1=0.334 auprc=0.334 bytes=10802
[S4] r=20 psi=0.333 u=0.0000 p_local=0.1500 f1=0.333 auprc=0.333 bytes=3601
[S13] r=20 psi=0.360 u=0.0000 p_local=0.0526 f1=0.360 auprc=0.360 bytes=12602
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.0480 head_norm=1.575360
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.853083e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.0517 head_norm=1.616543 delta_norm=0.185308
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.048 u=0.3826 p_local=0.1993 f1=0.048 auprc=0.048 bytes=0
[S10] r=20 psi=0.333 u=0.0341 p_local=0.1111 f1=0.333 auprc=0.333 bytes=14403
[S7] r=20 psi=0.333 u=0.4016 p_local=0.2084 f1=0.333 auprc=0.333 bytes=9013
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.1970 head_norm=1.210087
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.465376e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.2802 head_norm=1.141575 delta_norm=0.246538
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] r=20 psi=0.197 u=0.0523 p_local=0.1143 f1=0.197 auprc=0.197 bytes=7195
[S8] r=20 psi=0.356 u=0.0916 p_local=0.1474 f1=0.356 auprc=0.356 bytes=17969
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.1573 head_norm=1.416334
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.339691e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.1571 head_norm=1.498877 delta_norm=0.233969
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.157 u=0.0402 p_local=0.0479 f1=0.157 auprc=0.157 bytes=12613
[S16] r=20 psi=0.099 u=0.0541 p_local=0.1019 f1=0.099 auprc=0.099 bytes=0
[S2] START round=20 head_norm_before_train=1.681013 (no previous merge yet)
[S2] round=20 local utility u=0.011356 metrics={'f1_val': 0.25399835640685253, 'auprc': 0.25399835640685253, 'loss_val': 2.5400925344444585, 'psi': 0.25399835640685253}-{'f1_val': 0.24570415214333763, 'auprc': 0.24570415214333763, 'loss_val': 2.4881573695727286, 'psi': 0.24570415214333763}
[S3] START round=20 head_norm_before_train=1.141575 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.426219 metrics={'f1_val': 0.2834046600095102, 'auprc': 0.2834046600095102, 'loss_val': 2.1502955435129354, 'psi': 0.2834046600095102}-{'f1_val': 0.1970385915821383, 'auprc': 0.1970385915821383, 'loss_val': 2.225438367739276, 'psi': 0.1970385915821383}
[S4] START round=20 head_norm_before_train=1.283590 cos_to_last_merge=0.9975 (last merge round=18)
[S4] round=20 local utility u=0.013584 metrics={'f1_val': 0.3320703881451545, 'auprc': 0.3320703881451545, 'loss_val': 1.2905530754680037, 'psi': 0.3320703881451545}-{'f1_val': 0.33316421444275324, 'auprc': 0.33316421444275324, 'loss_val': 1.3275660148847954, 'psi': 0.33316421444275324}
[S5] START round=20 head_norm_before_train=1.875604 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.710565868701496, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.675233585933359, 'psi': 0.3335071121394324}
[S6] START round=20 head_norm_before_train=1.620081 (no previous merge yet)
[S6] round=20 local utility u=0.030453 metrics={'f1_val': 0.037422497785651015, 'auprc': 0.037422497785651015, 'loss_val': 5.328146247442589, 'psi': 0.037422497785651015}-{'f1_val': 0.040749063670411985, 'auprc': 0.040749063670411985, 'loss_val': 5.418990344621865, 'psi': 0.040749063670411985}
[S7] START round=20 head_norm_before_train=1.677303 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.8110555854007748, 'psi': 0.24968913205670232}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.8929443089164056, 'psi': 0.33308476261496395}
[S8] START round=20 head_norm_before_train=1.611441 (no previous merge yet)
[S8] round=20 local utility u=0.120490 metrics={'f1_val': 0.3767725664532862, 'auprc': 0.3767725664532862, 'loss_val': 0.8227498355845364, 'psi': 0.3767725664532862}-{'f1_val': 0.3556602882197382, 'auprc': 0.3556602882197382, 'loss_val': 0.873719175283856, 'psi': 0.3556602882197382}
[S9] START round=20 head_norm_before_train=1.176701 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.125174 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4514024387717512, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7017496208669525, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.709807 (no previous merge yet)
[S10] round=20 local utility u=0.076413 metrics={'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.894525644388467, 'psi': 0.3331740723045071}-{'f1_val': 0.3332536837913182, 'auprc': 0.3332536837913182, 'loss_val': 3.0480675432387314, 'psi': 0.3332536837913182}
[S11] START round=20 head_norm_before_train=1.624918 cos_to_last_merge=0.9911 (last merge round=17)
[S11] round=20 local utility u=0.015282 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 1.9125880109767053, 'psi': 0.3319353836595216}-{'f1_val': 0.3322450248756219, 'auprc': 0.3322450248756219, 'loss_val': 1.9459380499579784, 'psi': 0.3322450248756219}
[S13] START round=20 head_norm_before_train=1.271150 cos_to_last_merge=0.9989 (last merge round=18)
[S13] round=20 local utility u=0.023036 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1299821768563125, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1760534451801463, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.616543 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.219609 metrics={'f1_val': 0.08333333333333333, 'auprc': 0.08333333333333333, 'loss_val': 3.138320384832416, 'psi': 0.08333333333333333}-{'f1_val': 0.047972088966419545, 'auprc': 0.047972088966419545, 'loss_val': 3.2592877002836143, 'psi': 0.047972088966419545}
[S15] START round=20 head_norm_before_train=1.699746 (no previous merge yet)
[S15] round=20 local utility u=0.118145 metrics={'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.640093714243933, 'psi': 0.615636807189815}-{'f1_val': 0.6000775699094484, 'auprc': 0.6000775699094484, 'loss_val': 0.7363504618468555, 'psi': 0.6000775699094484}
[S16] START round=20 head_norm_before_train=1.850467 cos_to_last_merge=0.9994 (last merge round=18)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.09853760445682451, 'auprc': 0.09853760445682451, 'loss_val': 2.4719727930327147, 'psi': 0.09853760445682451}-{'f1_val': 0.09922770886964662, 'auprc': 0.09922770886964662, 'loss_val': 2.2990766972282852, 'psi': 0.09922770886964662}
[S17] START round=20 head_norm_before_train=1.498877 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.1524058983313931, 'auprc': 0.1524058983313931, 'loss_val': 1.1466571137961867, 'psi': 0.1524058983313931}-{'f1_val': 0.15732024834768676, 'auprc': 0.15732024834768676, 'loss_val': 1.1856424542637902, 'psi': 0.15732024834768676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:42011
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:42003
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:42017
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.083)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:42004
[S6] not sending this round → trigger blocked (psi=0.037)
[S8] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S15
[S11] cosine check vs S15: cos=0.9654
[S10] RECEIVED delta(kind=head bytes=1797) from S4
[S10] cosine check vs S4: cos=-0.0589
[S10] DROPPED delta from S4 (cos=-0.0589 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1804) from S10
[S3] cosine check vs S10: cos=0.6089
[S17] RECEIVED delta(kind=head bytes=1793) from S9
[S17] cosine check vs S9: cos=0.7481
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9858
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] cosine check vs S13: cos=0.6343
[S13] RECEIVED delta(kind=head bytes=1802) from S11
[S13] cosine check vs S11: cos=0.9092
[S13] RECEIVED delta(kind=head bytes=1807) from S2
[S13] cosine check vs S2: cos=-0.0635
[S13] DROPPED delta from S2 (cos=-0.0635 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=0.8051
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.070 → S11@127.0.0.1:42012
[S14] ⇄ pheromone p=0.203 → S15@127.0.0.1:42015
[S7] ⇄ pheromone p=0.167 → S14@127.0.0.1:42014
[S5] ⇄ pheromone p=0.076 → S16@127.0.0.1:42016
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.2834 head_norm=1.249682
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.930473e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.2979 head_norm=1.340310 delta_norm=0.693047
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.177 → S9@127.0.0.1:42010
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.3687 head_norm=1.269391
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.933377e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.3687 head_norm=1.196585 delta_norm=0.393338
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.085 → S17@127.0.0.1:42017
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.3321 head_norm=1.333887
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.638695e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.3330 head_norm=1.191620 delta_norm=0.563870
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.123 → S10@127.0.0.1:42011
[S15] ⇄ pheromone p=0.167 → S11@127.0.0.1:42012
[S10] ⇄ pheromone p=0.104 → S3@127.0.0.1:42003
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.3319 head_norm=1.654021
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.247446e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.3319 head_norm=1.673856 delta_norm=0.224745
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.096 → S13@127.0.0.1:42013
[S2] ⇄ pheromone p=0.118 → S13@127.0.0.1:42013
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.3599 head_norm=1.302520
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.587449e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.3599 head_norm=1.444809 delta_norm=0.358745
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.047 → S4@127.0.0.1:42004
[S8] ⇄ pheromone p=0.142 → S17@127.0.0.1:42017
[S16] ⇄ pheromone p=0.082 → S17@127.0.0.1:42017
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.1524 head_norm=1.532012
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.098947e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.1524 head_norm=1.419793 delta_norm=0.209895
[S17] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.038 → S3@127.0.0.1:42003
[S2] START round=21 head_norm_before_train=1.699947 (no previous merge yet)
[S2] round=21 local utility u=0.014460 metrics={'f1_val': 0.26215175833496446, 'auprc': 0.26215175833496446, 'loss_val': 2.584552910561247, 'psi': 0.26215175833496446}-{'f1_val': 0.25399835640685253, 'auprc': 0.25399835640685253, 'loss_val': 2.5400925344444585, 'psi': 0.25399835640685253}
[S3] START round=21 head_norm_before_train=1.340310 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.237408 metrics={'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 1.8063200285697927, 'psi': 0.2979423868312757}-{'f1_val': 0.2834046600095102, 'auprc': 0.2834046600095102, 'loss_val': 2.1502955435129354, 'psi': 0.2834046600095102}
[S4] START round=21 head_norm_before_train=1.191620 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.2387698268555515, 'auprc': 0.2387698268555515, 'loss_val': 1.3173531817507464, 'psi': 0.2387698268555515}-{'f1_val': 0.3320703881451545, 'auprc': 0.3320703881451545, 'loss_val': 1.2905530754680037, 'psi': 0.3320703881451545}
[S5] START round=21 head_norm_before_train=1.900333 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7189430754168304, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.710565868701496, 'psi': 0.3335071121394324}
[S6] START round=21 head_norm_before_train=1.634027 (no previous merge yet)
[S6] round=21 local utility u=0.017510 metrics={'f1_val': 0.04763967085318319, 'auprc': 0.04763967085318319, 'loss_val': 5.385080626896174, 'psi': 0.04763967085318319}-{'f1_val': 0.037422497785651015, 'auprc': 0.037422497785651015, 'loss_val': 5.328146247442589, 'psi': 0.037422497785651015}
[S7] START round=21 head_norm_before_train=1.697253 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.8192258032143018, 'psi': 0.24968913205670232}-{'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.8110555854007748, 'psi': 0.24968913205670232}
[S8] START round=21 head_norm_before_train=1.647802 (no previous merge yet)
[S8] round=21 local utility u=0.154617 metrics={'f1_val': 0.4064580774983774, 'auprc': 0.4064580774983774, 'loss_val': 0.7806852348044703, 'psi': 0.4064580774983774}-{'f1_val': 0.3767725664532862, 'auprc': 0.3767725664532862, 'loss_val': 0.8227498355845364, 'psi': 0.3767725664532862}
[S9] START round=21 head_norm_before_train=1.196585 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.039456 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.372489735387783, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4514024387717512, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.729678 (no previous merge yet)
[S10] round=21 local utility u=0.010483 metrics={'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.8735588525095626, 'psi': 0.3331740723045071}-{'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.894525644388467, 'psi': 0.3331740723045071}
[S11] START round=21 head_norm_before_train=1.673856 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.013487 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 1.8856144335129421, 'psi': 0.3319353836595216}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 1.9125880109767053, 'psi': 0.3319353836595216}
[S13] START round=21 head_norm_before_train=1.444809 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1554545249930985, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1299821768563125, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.644575 cos_to_last_merge=0.9979 (last merge round=19)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.036148148148148145, 'auprc': 0.036148148148148145, 'loss_val': 3.774935635862228, 'psi': 0.036148148148148145}-{'f1_val': 0.08333333333333333, 'auprc': 0.08333333333333333, 'loss_val': 3.138320384832416, 'psi': 0.08333333333333333}
[S15] START round=21 head_norm_before_train=1.723027 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.650690891665824, 'psi': 0.612395395031292}-{'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.640093714243933, 'psi': 0.615636807189815}
[S16] START round=21 head_norm_before_train=1.879913 cos_to_last_merge=0.9981 (last merge round=18)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.09234947940244455, 'auprc': 0.09234947940244455, 'loss_val': 2.6620374789693484, 'psi': 0.09234947940244455}-{'f1_val': 0.09853760445682451, 'auprc': 0.09853760445682451, 'loss_val': 2.4719727930327147, 'psi': 0.09853760445682451}
[S17] START round=21 head_norm_before_train=1.419793 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.019970 metrics={'f1_val': 0.1525242718446602, 'auprc': 0.1525242718446602, 'loss_val': 1.1077818440593983, 'psi': 0.1525242718446602}-{'f1_val': 0.1524058983313931, 'auprc': 0.1524058983313931, 'loss_val': 1.1466571137961867, 'psi': 0.1524058983313931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:42010
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:42013
[S6] not sending this round → trigger blocked (psi=0.048)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1806) from S10
[S3] cosine check vs S10: cos=0.8876
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9637
[S17] RECEIVED delta(kind=head bytes=1803) from S9
[S17] cosine check vs S9: cos=0.8102
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] cosine check vs S11: cos=0.9711
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=-0.0612
[S13] DROPPED delta from S2 (cos=-0.0612 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] cosine check vs S3: cos=0.7094
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.4550
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.3599 head_norm=1.471252
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.210996e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.3599 head_norm=1.572734 delta_norm=0.221100
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.2979 head_norm=1.411273
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.546703e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.2996 head_norm=1.275002 delta_norm=0.254670
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.3687 head_norm=1.295962
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.187234e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.3687 head_norm=1.251611 delta_norm=0.518723
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.1525 head_norm=1.452927
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.391352e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.1525 head_norm=1.399050 delta_norm=0.139135
[S17] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.716891 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.2644018697741787, 'auprc': 0.2644018697741787, 'loss_val': 2.6443847117144563, 'psi': 0.2644018697741787}-{'f1_val': 0.26215175833496446, 'auprc': 0.26215175833496446, 'loss_val': 2.584552910561247, 'psi': 0.26215175833496446}
[S3] START round=22 head_norm_before_train=1.275002 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.29802414928649834, 'auprc': 0.29802414928649834, 'loss_val': 1.924281059823855, 'psi': 0.29802414928649834}-{'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 1.8063200285697927, 'psi': 0.2979423868312757}
[S4] START round=22 head_norm_before_train=1.230956 cos_to_last_merge=0.9976 (last merge round=20)
[S4] round=22 local utility u=0.550266 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.279037167087267, 'psi': 0.3567939207526687}-{'f1_val': 0.2387698268555515, 'auprc': 0.2387698268555515, 'loss_val': 1.3173531817507464, 'psi': 0.2387698268555515}
[S5] START round=22 head_norm_before_train=1.927363 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7461583338256643, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7189430754168304, 'psi': 0.3335071121394324}
[S6] START round=22 head_norm_before_train=1.647996 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.028655234657039712, 'auprc': 0.028655234657039712, 'loss_val': 5.7071064436248005, 'psi': 0.028655234657039716}-{'f1_val': 0.04763967085318319, 'auprc': 0.04763967085318319, 'loss_val': 5.385080626896174, 'psi': 0.04763967085318319}
[S7] START round=22 head_norm_before_train=1.716896 (no previous merge yet)
[S7] round=22 local utility u=0.013726 metrics={'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.7917736885792112, 'psi': 0.24968913205670232}-{'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.8192258032143018, 'psi': 0.24968913205670232}
[S8] START round=22 head_norm_before_train=1.678524 (no previous merge yet)
[S8] round=22 local utility u=1.000000 metrics={'f1_val': 0.6940376792935281, 'auprc': 0.6940376792935281, 'loss_val': 0.7372268048438804, 'psi': 0.6940376792935281}-{'f1_val': 0.4064580774983774, 'auprc': 0.4064580774983774, 'loss_val': 0.7806852348044703, 'psi': 0.4064580774983774}
[S9] START round=22 head_norm_before_train=1.251611 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4159122478078763, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.372489735387783, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.747012 (no previous merge yet)
[S10] round=22 local utility u=0.086501 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.6998405477426792, 'psi': 0.3330944988456333}-{'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.8735588525095626, 'psi': 0.3331740723045071}
[S11] START round=22 head_norm_before_train=1.697106 cos_to_last_merge=0.9992 (last merge round=20)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 1.9231986977417188, 'psi': 0.3319353836595216}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 1.8856144335129421, 'psi': 0.3319353836595216}
[S13] START round=22 head_norm_before_train=1.572734 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1560221550541967, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1554545249930985, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.678802 cos_to_last_merge=0.9928 (last merge round=19)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.05569910996267585, 'auprc': 0.05569910996267585, 'loss_val': 4.110140618391398, 'psi': 0.05569910996267585}-{'f1_val': 0.036148148148148145, 'auprc': 0.036148148148148145, 'loss_val': 3.774935635862228, 'psi': 0.036148148148148145}
[S15] START round=22 head_norm_before_train=1.745281 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.5888184127680618, 'auprc': 0.5888184127680618, 'loss_val': 0.5602634877816518, 'psi': 0.5888184127680618}-{'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.650690891665824, 'psi': 0.612395395031292}
[S16] START round=22 head_norm_before_train=1.906617 cos_to_last_merge=0.9965 (last merge round=18)
[S16] round=22 local utility u=0.185970 metrics={'f1_val': 0.13630348478164975, 'auprc': 0.13630348478164975, 'loss_val': 2.6856834100233637, 'psi': 0.13630348478164975}-{'f1_val': 0.09234947940244455, 'auprc': 0.09234947940244455, 'loss_val': 2.6620374789693484, 'psi': 0.09234947940244455}
[S17] START round=22 head_norm_before_train=1.399050 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.004541 metrics={'f1_val': 0.1524058983313931, 'auprc': 0.1524058983313931, 'loss_val': 1.0976337897869524, 'psi': 0.1524058983313931}-{'f1_val': 0.1525242718446602, 'auprc': 0.1525242718446602, 'loss_val': 1.1077818440593983, 'psi': 0.1525242718446602}
[S16] not sending this round → trigger blocked (psi=0.136)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:42003
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:42011
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S10
[S3] cosine check vs S10: cos=0.8089
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=0.9471
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9651
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] cosine check vs S4: cos=-0.0505
[S10] DROPPED delta from S4 (cos=-0.0505 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.6450
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.2980 head_norm=1.369000
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.744134e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.2986 head_norm=1.281100 delta_norm=0.174413
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.0557 head_norm=1.709773
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.283760e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.0588 head_norm=1.709615 delta_norm=0.228376
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.1524 head_norm=1.430572
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.877239e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.1524 head_norm=1.545648 delta_norm=0.287724
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.732546 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.24633682790754705, 'auprc': 0.24633682790754705, 'loss_val': 2.615356320313006, 'psi': 0.24633682790754702}-{'f1_val': 0.2644018697741787, 'auprc': 0.2644018697741787, 'loss_val': 2.6443847117144563, 'psi': 0.2644018697741787}
[S3] START round=23 head_norm_before_train=1.281100 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000385 metrics={'f1_val': 0.29786066922654963, 'auprc': 0.29786066922654963, 'loss_val': 1.9220392780309616, 'psi': 0.29786066922654963}-{'f1_val': 0.29802414928649834, 'auprc': 0.29802414928649834, 'loss_val': 1.924281059823855, 'psi': 0.29802414928649834}
[S4] START round=23 head_norm_before_train=1.273633 cos_to_last_merge=0.9921 (last merge round=20)
[S4] round=23 local utility u=0.017490 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2440577188053905, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.279037167087267, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.963403 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.834838117545221, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7461583338256643, 'psi': 0.3335071121394324}
[S6] START round=23 head_norm_before_train=1.662559 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.005445075757575758, 'auprc': 0.005445075757575758, 'loss_val': 5.981775436268781, 'psi': 0.005445075757575758}-{'f1_val': 0.028655234657039712, 'auprc': 0.028655234657039712, 'loss_val': 5.7071064436248005, 'psi': 0.028655234657039716}
[S7] START round=23 head_norm_before_train=1.739699 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.8032293738842594, 'psi': 0.24962705121829937}-{'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.7917736885792112, 'psi': 0.24968913205670232}
[S8] START round=23 head_norm_before_train=1.702085 (no previous merge yet)
[S8] round=23 local utility u=1.000000 metrics={'f1_val': 0.9997178063266456, 'auprc': 0.9997178063266456, 'loss_val': 0.6891605904212957, 'psi': 0.9997178063266456}-{'f1_val': 0.6940376792935281, 'auprc': 0.6940376792935281, 'loss_val': 0.7372268048438804, 'psi': 0.6940376792935281}
[S9] START round=23 head_norm_before_train=1.345294 cos_to_last_merge=0.9817 (last merge round=21)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5832389993137264, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4159122478078763, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.768484 (no previous merge yet)
[S10] round=23 local utility u=0.088927 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.52198700725449, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.6998405477426792, 'psi': 0.3330944988456333}
[S11] START round=23 head_norm_before_train=1.726057 cos_to_last_merge=0.9970 (last merge round=20)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.929037900924129, 'psi': 0.3319360347772085}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 1.9231986977417188, 'psi': 0.3319353836595216}
[S13] START round=23 head_norm_before_train=1.595225 cos_to_last_merge=0.9986 (last merge round=21)
[S13] round=23 local utility u=0.017810 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.120402188296851, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1560221550541967, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.709615 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.688994 metrics={'f1_val': 0.13353375923838157, 'auprc': 0.13353375923838157, 'loss_val': 3.432664176962218, 'psi': 0.13353375923838157}-{'f1_val': 0.05569910996267585, 'auprc': 0.05569910996267585, 'loss_val': 4.110140618391398, 'psi': 0.05569910996267585}
[S15] START round=23 head_norm_before_train=1.770336 (no previous merge yet)
[S15] round=23 local utility u=0.009625 metrics={'f1_val': 0.5862361543687412, 'auprc': 0.5862361543687412, 'loss_val': 0.517772889272906, 'psi': 0.5862361543687412}-{'f1_val': 0.5888184127680618, 'auprc': 0.5888184127680618, 'loss_val': 0.5602634877816518, 'psi': 0.5888184127680618}
[S16] START round=23 head_norm_before_train=1.929678 cos_to_last_merge=0.9948 (last merge round=18)
[S16] round=23 local utility u=0.146094 metrics={'f1_val': 0.1330412727691953, 'auprc': 0.1330412727691953, 'loss_val': 2.364134786471215, 'psi': 0.1330412727691953}-{'f1_val': 0.13630348478164975, 'auprc': 0.13630348478164975, 'loss_val': 2.6856834100233637, 'psi': 0.13630348478164975}
[S17] START round=23 head_norm_before_train=1.545648 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.15261317272197397, 'auprc': 0.15261317272197397, 'loss_val': 1.1169762026884087, 'psi': 0.15261317272197397}-{'f1_val': 0.1524058983313931, 'auprc': 0.1524058983313931, 'loss_val': 1.0976337897869524, 'psi': 0.1524058983313931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:42011
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.133)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:42004
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:42010
[S14] not sending this round → trigger blocked (psi=0.134)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:42003
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S15
[S11] cosine check vs S15: cos=0.9729
[S3] RECEIVED delta(kind=head bytes=1805) from S10
[S3] cosine check vs S10: cos=0.7774
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9838
[S4] RECEIVED delta(kind=head bytes=1806) from S13
[S4] cosine check vs S13: cos=0.7309
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] cosine check vs S3: cos=0.8663
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] cosine check vs S4: cos=-0.0550
[S10] DROPPED delta from S4 (cos=-0.0550 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.3687 head_norm=1.448830
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.662131e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.3687 head_norm=1.360745 delta_norm=0.366213
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.3319 head_norm=1.752129
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.076067e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.3320 head_norm=1.762233 delta_norm=0.207607
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.3568 head_norm=1.315887
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.567755e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.2454 head_norm=1.366883 delta_norm=0.556775
[S4] aggregate: ROLLBACK (f1_val pre=0.357 post=0.245 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.2979 head_norm=1.368345
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.662819e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.3071 head_norm=1.495002 delta_norm=0.566282
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.1526 head_norm=1.575559
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.662372e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.1526 head_norm=1.644205 delta_norm=0.166237
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.746967 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 2.655199079040441, 'psi': 0.24543399914482925}-{'f1_val': 0.24633682790754705, 'auprc': 0.24633682790754705, 'loss_val': 2.615356320313006, 'psi': 0.24633682790754702}
[S3] START round=24 head_norm_before_train=1.495002 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.28362322973101417, 'auprc': 0.28362322973101417, 'loss_val': 2.196485802077536, 'psi': 0.28362322973101417}-{'f1_val': 0.29786066922654963, 'auprc': 0.29786066922654963, 'loss_val': 1.9220392780309616, 'psi': 0.29786066922654963}
[S4] START round=24 head_norm_before_train=1.366883 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.291371026118818, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2440577188053905, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.999689 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8531947072512835, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.834838117545221, 'psi': 0.3335071121394324}
[S6] START round=24 head_norm_before_train=1.674259 (no previous merge yet)
[S6] round=24 local utility u=0.497980 metrics={'f1_val': 0.05853761622992392, 'auprc': 0.05853761622992392, 'loss_val': 5.46364739456106, 'psi': 0.05853761622992392}-{'f1_val': 0.005445075757575758, 'auprc': 0.005445075757575758, 'loss_val': 5.981775436268781, 'psi': 0.005445075757575758}
[S7] START round=24 head_norm_before_train=1.763182 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 0.8144457090896305, 'psi': 0.24944015924359295}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.8032293738842594, 'psi': 0.24962705121829937}
[S8] START round=24 head_norm_before_train=1.726182 (no previous merge yet)
[S8] round=24 local utility u=0.025947 metrics={'f1_val': 0.9994354958690915, 'auprc': 0.9994354958690915, 'loss_val': 0.6347248367106041, 'psi': 0.9994354958690915}-{'f1_val': 0.9997178063266456, 'auprc': 0.9997178063266456, 'loss_val': 0.6891605904212957, 'psi': 0.9997178063266456}
[S9] START round=24 head_norm_before_train=1.360745 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.050396 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4824475360628906, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5832389993137264, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.799734 (no previous merge yet)
[S10] round=24 local utility u=0.079117 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3630368791001177, 'psi': 0.33301496338745623}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.52198700725449, 'psi': 0.3330944988456333}
[S11] START round=24 head_norm_before_train=1.762233 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.022440 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.8841573875461488, 'psi': 0.3319360347772085}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.929037900924129, 'psi': 0.3319360347772085}
[S13] START round=24 head_norm_before_train=1.620239 cos_to_last_merge=0.9955 (last merge round=21)
[S13] round=24 local utility u=0.008555 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1032924757627263, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.120402188296851, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.736805 cos_to_last_merge=0.9993 (last merge round=22)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.08997289972899729, 'auprc': 0.08997289972899729, 'loss_val': 3.855572089836528, 'psi': 0.08997289972899729}-{'f1_val': 0.13353375923838157, 'auprc': 0.13353375923838157, 'loss_val': 3.432664176962218, 'psi': 0.13353375923838157}
[S15] START round=24 head_norm_before_train=1.796434 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.5824464808148223, 'auprc': 0.5824464808148223, 'loss_val': 0.5477526936974034, 'psi': 0.5824464808148223}-{'f1_val': 0.5862361543687412, 'auprc': 0.5862361543687412, 'loss_val': 0.517772889272906, 'psi': 0.5862361543687412}
[S16] START round=24 head_norm_before_train=1.949497 cos_to_last_merge=0.9933 (last merge round=18)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.14294134983790155, 'auprc': 0.14294134983790155, 'loss_val': 2.839384505766774, 'psi': 0.14294134983790155}-{'f1_val': 0.1330412727691953, 'auprc': 0.1330412727691953, 'loss_val': 2.364134786471215, 'psi': 0.1330412727691953}
[S17] START round=24 head_norm_before_train=1.644205 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.026248 metrics={'f1_val': 0.1574408343361412, 'auprc': 0.1574408343361412, 'loss_val': 1.1079286430535782, 'psi': 0.1574408343361412}-{'f1_val': 0.15261317272197397, 'auprc': 0.15261317272197397, 'loss_val': 1.1169762026884087, 'psi': 0.15261317272197397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:42003
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:42013
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.059)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1807) from S10
[S3] cosine check vs S10: cos=0.9313
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9927
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] cosine check vs S9: cos=0.5750
[S4] RECEIVED delta(kind=head bytes=1795) from S13
[S4] cosine check vs S13: cos=0.9383
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=0.9701
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S17
[S3] cosine check vs S17: cos=0.3392
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.3568 head_norm=1.396062
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.942573e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.2900 head_norm=1.497702 delta_norm=0.294257
[S4] aggregate: ROLLBACK (f1_val pre=0.357 post=0.290 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.2836 head_norm=1.561100
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.600456e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.2919 head_norm=1.380754 delta_norm=0.360046
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.3599 head_norm=1.646332
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.209137e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.3599 head_norm=1.702764 delta_norm=0.220914
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.1574 head_norm=1.670061
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.304679e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.1574 head_norm=1.502141 delta_norm=0.330468
[S17] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.760451 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.24534408011235267, 'auprc': 0.24534408011235267, 'loss_val': 2.6949457034279782, 'psi': 0.24534408011235267}-{'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 2.655199079040441, 'psi': 0.24543399914482925}
[S3] START round=25 head_norm_before_train=1.380754 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.125063 metrics={'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.0750568282059794, 'psi': 0.29792295726964957}-{'f1_val': 0.28362322973101417, 'auprc': 0.28362322973101417, 'loss_val': 2.196485802077536, 'psi': 0.28362322973101417}
[S4] START round=25 head_norm_before_train=1.497702 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3111725012923356, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.291371026118818, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=2.029396 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8566437322051703, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8531947072512835, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.683484 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.005912961210974456, 'auprc': 0.005912961210974456, 'loss_val': 6.072309834089729, 'psi': 0.005912961210974456}-{'f1_val': 0.05853761622992392, 'auprc': 0.05853761622992392, 'loss_val': 5.46364739456106, 'psi': 0.05853761622992392}
[S7] START round=25 head_norm_before_train=1.782098 (no previous merge yet)
[S7] round=25 local utility u=0.010259 metrics={'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.7911184811291211, 'psi': 0.2491280518186348}-{'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 0.8144457090896305, 'psi': 0.24944015924359295}
[S8] START round=25 head_norm_before_train=1.756701 (no previous merge yet)
[S8] round=25 local utility u=0.020543 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.5885573661471211, 'psi': 0.9988708350860451}-{'f1_val': 0.9994354958690915, 'auprc': 0.9994354958690915, 'loss_val': 0.6347248367106041, 'psi': 0.9994354958690915}
[S9] START round=25 head_norm_before_train=1.439157 cos_to_last_merge=0.9931 (last merge round=23)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6726325680358691, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4824475360628906, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.836014 (no previous merge yet)
[S10] round=25 local utility u=0.041195 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2806468512315394, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3630368791001177, 'psi': 0.33301496338745623}
[S11] START round=25 head_norm_before_train=1.784938 cos_to_last_merge=0.9996 (last merge round=23)
[S11] round=25 local utility u=0.007814 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 1.8650549111565502, 'psi': 0.33154997286190585}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.8841573875461488, 'psi': 0.3319360347772085}
[S13] START round=25 head_norm_before_train=1.702764 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1229880382199324, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1032924757627263, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.768596 cos_to_last_merge=0.9974 (last merge round=22)
[S14] round=25 local utility u=0.154375 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 3.9568341323293623, 'psi': 0.1355297641332834}-{'f1_val': 0.08997289972899729, 'auprc': 0.08997289972899729, 'loss_val': 3.855572089836528, 'psi': 0.08997289972899729}
[S15] START round=25 head_norm_before_train=1.822510 (no previous merge yet)
[S15] round=25 local utility u=0.220367 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4132616620967505, 'psi': 0.6164734888353558}-{'f1_val': 0.5824464808148223, 'auprc': 0.5824464808148223, 'loss_val': 0.5477526936974034, 'psi': 0.5824464808148223}
[S16] START round=25 head_norm_before_train=1.965344 cos_to_last_merge=0.9920 (last merge round=18)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.07722691364750749, 'auprc': 0.07722691364750749, 'loss_val': 3.382803322016443, 'psi': 0.07722691364750749}-{'f1_val': 0.14294134983790155, 'auprc': 0.14294134983790155, 'loss_val': 2.839384505766774, 'psi': 0.14294134983790155}
[S17] START round=25 head_norm_before_train=1.502141 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.229629 metrics={'f1_val': 0.20459843992345758, 'auprc': 0.20459843992345758, 'loss_val': 1.07308945107261, 'psi': 0.20459843992345758}-{'f1_val': 0.1574408343361412, 'auprc': 0.1574408343361412, 'loss_val': 1.1079286430535782, 'psi': 0.1574408343361412}
[S14] not sending this round → trigger blocked (psi=0.136)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:42017
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:42010
[S7] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] cosine check vs S10: cos=0.8511
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] cosine check vs S15: cos=0.9855
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.9637
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9740
[S9] RECEIVED delta(kind=head bytes=1803) from S3
[S9] cosine check vs S3: cos=0.8517
[S13] RECEIVED delta(kind=head bytes=1802) from S11
[S13] cosine check vs S11: cos=0.9883
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=0.6507
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.1355 head_norm=1.799957
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.050272e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.1355 head_norm=1.788046 delta_norm=0.205027
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.186 → S15@127.0.0.1:42015
[S5] ⇄ pheromone p=0.025 → S16@127.0.0.1:42016
[S2] ⇄ pheromone p=0.040 → S13@127.0.0.1:42013
[S6] ⇄ pheromone p=0.104 → S11@127.0.0.1:42012
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.3687 head_norm=1.513254
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.048241e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.3687 head_norm=1.426574 delta_norm=0.404824
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.039 → S17@127.0.0.1:42017
[S4] ⇄ pheromone p=0.099 → S10@127.0.0.1:42011
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.3599 head_norm=1.728812
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.409664e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.3599 head_norm=1.763573 delta_norm=0.140966
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.019 → S4@127.0.0.1:42004
[S8] ⇄ pheromone p=0.298 → S17@127.0.0.1:42017
[S10] ⇄ pheromone p=0.076 → S3@127.0.0.1:42003
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.2979 head_norm=1.451914
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.584821e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.2979 head_norm=1.379039 delta_norm=0.158482
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.102 → S9@127.0.0.1:42010
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.3315 head_norm=1.808681
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.567105e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.3315 head_norm=1.820149 delta_norm=0.156711
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.038 → S13@127.0.0.1:42013
[S7] ⇄ pheromone p=0.058 → S14@127.0.0.1:42014
[S15] ⇄ pheromone p=0.100 → S11@127.0.0.1:42012
[S16] ⇄ pheromone p=0.064 → S17@127.0.0.1:42017
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.2046 head_norm=1.525640
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.584606e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.2032 head_norm=1.642022 delta_norm=0.258461
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.065 → S3@127.0.0.1:42003
[S2] START round=26 head_norm_before_train=1.773039 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.2452542269425624, 'auprc': 0.2452542269425624, 'loss_val': 2.7267550336711093, 'psi': 0.2452542269425624}-{'f1_val': 0.24534408011235267, 'auprc': 0.24534408011235267, 'loss_val': 2.6949457034279782, 'psi': 0.24534408011235267}
[S3] START round=26 head_norm_before_train=1.379039 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.000790 metrics={'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.0736522401785376, 'psi': 0.2979423868312757}-{'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.0750568282059794, 'psi': 0.29792295726964957}
[S4] START round=26 head_norm_before_train=1.520598 cos_to_last_merge=0.9989 (last merge round=24)
[S4] round=26 local utility u=0.013459 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2842541977658222, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3111725012923356, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=2.058964 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9568737622616847, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8566437322051703, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.693134 (no previous merge yet)
[S6] round=26 local utility u=0.229529 metrics={'f1_val': 0.03077268643306379, 'auprc': 0.03077268643306379, 'loss_val': 5.836989944714884, 'psi': 0.030772686433063794}-{'f1_val': 0.005912961210974456, 'auprc': 0.005912961210974456, 'loss_val': 6.072309834089729, 'psi': 0.005912961210974456}
[S7] START round=26 head_norm_before_train=1.799568 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.24875249500998003, 'auprc': 0.24875249500998003, 'loss_val': 0.9002034984157461, 'psi': 0.24875249500998003}-{'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.7911184811291211, 'psi': 0.2491280518186348}
[S8] START round=26 head_norm_before_train=1.788435 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5941620421715499, 'psi': 0.35939447907390915}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.5885573661471211, 'psi': 0.9988708350860451}
[S9] START round=26 head_norm_before_train=1.426574 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.116636 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4393601564320069, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6726325680358691, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.870965 (no previous merge yet)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2994503670975877, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2806468512315394, 'psi': 0.33301496338745623}
[S11] START round=26 head_norm_before_train=1.820149 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 1.9445097110468612, 'psi': 0.3319353836595216}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 1.8650549111565502, 'psi': 0.33154997286190585}
[S13] START round=26 head_norm_before_train=1.763573 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1543569198510923, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1229880382199324, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.788046 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.096101 metrics={'f1_val': 0.11828372632392732, 'auprc': 0.11828372632392732, 'loss_val': 3.6094184086289705, 'psi': 0.11828372632392732}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 3.9568341323293623, 'psi': 0.1355297641332834}
[S15] START round=26 head_norm_before_train=1.844905 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.587999618486736, 'auprc': 0.587999618486736, 'loss_val': 0.44310118040877283, 'psi': 0.587999618486736}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4132616620967505, 'psi': 0.6164734888353558}
[S16] START round=26 head_norm_before_train=1.979396 cos_to_last_merge=0.9908 (last merge round=18)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.07596463022508039, 'auprc': 0.07596463022508039, 'loss_val': 3.4633211997441644, 'psi': 0.07596463022508039}-{'f1_val': 0.07722691364750749, 'auprc': 0.07722691364750749, 'loss_val': 3.382803322016443, 'psi': 0.07722691364750749}
[S17] START round=26 head_norm_before_train=1.642022 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.16074883776406615, 'auprc': 0.16074883776406615, 'loss_val': 1.0869605576727737, 'psi': 0.16074883776406615}-{'f1_val': 0.20459843992345758, 'auprc': 0.20459843992345758, 'loss_val': 1.07308945107261, 'psi': 0.20459843992345758}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:42011
[S14] not sending this round → trigger blocked (psi=0.118)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.031)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:42010
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S4
[S10] cosine check vs S4: cos=-0.0315
[S10] DROPPED delta from S4 (cos=-0.0315 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S9
[S17] cosine check vs S9: cos=0.5974
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=0.9351
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.3687 head_norm=1.490068
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.657220e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.3687 head_norm=1.447458 delta_norm=0.265722
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.1607 head_norm=1.662796
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.114920e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.1763 head_norm=1.409388 delta_norm=0.711492
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.784583 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.2453800194525497, 'auprc': 0.2453800194525497, 'loss_val': 3.0503823584232754, 'psi': 0.24538001945254972}-{'f1_val': 0.2452542269425624, 'auprc': 0.2452542269425624, 'loss_val': 2.7267550336711093, 'psi': 0.2452542269425624}
[S3] START round=27 head_norm_before_train=1.452991 cos_to_last_merge=0.9957 (last merge round=25)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.587325590056829, 'psi': 0.29792295726964957}-{'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.0736522401785376, 'psi': 0.2979423868312757}
[S4] START round=27 head_norm_before_train=1.545452 cos_to_last_merge=0.9962 (last merge round=24)
[S4] round=27 local utility u=0.013908 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2564389778930332, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2842541977658222, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=2.081857 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0450580434352976, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9568737622616847, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.700656 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 6.11536714098618, 'psi': 0.022186642268984445}-{'f1_val': 0.03077268643306379, 'auprc': 0.03077268643306379, 'loss_val': 5.836989944714884, 'psi': 0.030772686433063794}
[S7] START round=27 head_norm_before_train=1.816446 (no previous merge yet)
[S7] round=27 local utility u=0.029692 metrics={'f1_val': 0.24881516587677724, 'auprc': 0.24881516587677724, 'loss_val': 0.8413829743137202, 'psi': 0.24881516587677724}-{'f1_val': 0.24875249500998003, 'auprc': 0.24875249500998003, 'loss_val': 0.9002034984157461, 'psi': 0.24875249500998003}
[S8] START round=27 head_norm_before_train=1.817366 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6197214192126604, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5941620421715499, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.447458 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.045012 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3493357868040996, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4393601564320069, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.906471 (no previous merge yet)
[S10] round=27 local utility u=0.051639 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.1961727204612727, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2994503670975877, 'psi': 0.33301496338745623}
[S11] START round=27 head_norm_before_train=1.840468 cos_to_last_merge=0.9997 (last merge round=25)
[S11] round=27 local utility u=0.033239 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 1.8745632157139291, 'psi': 0.33154997286190585}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 1.9445097110468612, 'psi': 0.3319353836595216}
[S13] START round=27 head_norm_before_train=1.785450 cos_to_last_merge=0.9995 (last merge round=25)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1582687570386678, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1543569198510923, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.816137 cos_to_last_merge=0.9996 (last merge round=25)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.10213556174558959, 'auprc': 0.10213556174558959, 'loss_val': 3.95839034297247, 'psi': 0.10213556174558959}-{'f1_val': 0.11828372632392732, 'auprc': 0.11828372632392732, 'loss_val': 3.6094184086289705, 'psi': 0.11828372632392732}
[S15] START round=27 head_norm_before_train=1.862040 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.586168736413024, 'auprc': 0.586168736413024, 'loss_val': 0.4575218418345001, 'psi': 0.586168736413024}-{'f1_val': 0.587999618486736, 'auprc': 0.587999618486736, 'loss_val': 0.44310118040877283, 'psi': 0.587999618486736}
[S16] START round=27 head_norm_before_train=1.992372 cos_to_last_merge=0.9897 (last merge round=18)
[S16] round=27 local utility u=0.227472 metrics={'f1_val': 0.10522172658094989, 'auprc': 0.10522172658094989, 'loss_val': 3.2716919011457706, 'psi': 0.10522172658094989}-{'f1_val': 0.07596463022508039, 'auprc': 0.07596463022508039, 'loss_val': 3.4633211997441644, 'psi': 0.07596463022508039}
[S17] START round=27 head_norm_before_train=1.409388 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.174778 metrics={'f1_val': 0.19328540744144024, 'auprc': 0.19328540744144024, 'loss_val': 1.0302326945602374, 'psi': 0.19328540744144024}-{'f1_val': 0.16074883776406615, 'auprc': 0.16074883776406615, 'loss_val': 1.0869605576727737, 'psi': 0.16074883776406615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] → sending delta(kind=head bytes=1808) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:42014
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.105)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1808 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1808) from S4
[S10] cosine check vs S4: cos=-0.0358
[S10] DROPPED delta from S4 (cos=-0.0358 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] cosine check vs S10: cos=0.7984
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=0.9861
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] cosine check vs S11: cos=0.9893
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.8846
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.8613
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.2979 head_norm=1.519165
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.989743e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.2979 head_norm=1.466914 delta_norm=0.198974
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.1021 head_norm=1.844262
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.535541e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.1021 head_norm=1.831417 delta_norm=0.153554
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.3599 head_norm=1.811507
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.363885e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.3599 head_norm=1.830753 delta_norm=0.136388
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.1933 head_norm=1.429737
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.560838e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.1945 head_norm=1.429293 delta_norm=0.356084
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.794977 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.22055469727065402, 'auprc': 0.22055469727065402, 'loss_val': 3.241584716758167, 'psi': 0.22055469727065402}-{'f1_val': 0.2453800194525497, 'auprc': 0.2453800194525497, 'loss_val': 3.0503823584232754, 'psi': 0.24538001945254972}
[S3] START round=28 head_norm_before_train=1.466914 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.271888 metrics={'f1_val': 0.2987249544626594, 'auprc': 0.2987249544626594, 'loss_val': 2.0507680249646207, 'psi': 0.2987249544626594}-{'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.587325590056829, 'psi': 0.29792295726964957}
[S4] START round=28 head_norm_before_train=1.570464 cos_to_last_merge=0.9926 (last merge round=24)
[S4] round=28 local utility u=0.019319 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2178012227889783, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2564389778930332, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=2.100449 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.111721995075004, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0450580434352976, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.708367 (no previous merge yet)
[S6] round=28 local utility u=0.071202 metrics={'f1_val': 0.028442437923250564, 'auprc': 0.028442437923250564, 'loss_val': 6.0292653429146865, 'psi': 0.02844243792325056}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 6.11536714098618, 'psi': 0.022186642268984445}
[S7] START round=28 head_norm_before_train=1.831402 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.8654573921711077, 'psi': 0.2490655370047346}-{'f1_val': 0.24881516587677724, 'auprc': 0.24881516587677724, 'loss_val': 0.8413829743137202, 'psi': 0.24881516587677724}
[S8] START round=28 head_norm_before_train=1.840489 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6318635036273129, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6197214192126604, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.514991 cos_to_last_merge=0.9901 (last merge round=26)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4977688692661777, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3493357868040996, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.940577 (no previous merge yet)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.209284226916963, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.1961727204612727, 'psi': 0.33301496338745623}
[S11] START round=28 head_norm_before_train=1.859828 cos_to_last_merge=0.9989 (last merge round=25)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.996244298863984, 'psi': 0.3320133550741517}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 1.8745632157139291, 'psi': 0.33154997286190585}
[S13] START round=28 head_norm_before_train=1.830753 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.180515245131811, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1582687570386678, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.831417 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.234471 metrics={'f1_val': 0.12228191353287286, 'auprc': 0.12228191353287286, 'loss_val': 3.6707660238341653, 'psi': 0.12228191353287286}-{'f1_val': 0.10213556174558959, 'auprc': 0.10213556174558959, 'loss_val': 3.95839034297247, 'psi': 0.10213556174558959}
[S15] START round=28 head_norm_before_train=1.883352 (no previous merge yet)
[S15] round=28 local utility u=0.195203 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.34111012552561804, 'psi': 0.6166125814646326}-{'f1_val': 0.586168736413024, 'auprc': 0.586168736413024, 'loss_val': 0.4575218418345001, 'psi': 0.586168736413024}
[S16] START round=28 head_norm_before_train=2.004130 cos_to_last_merge=0.9888 (last merge round=18)
[S16] round=28 local utility u=0.248888 metrics={'f1_val': 0.14025974025974025, 'auprc': 0.14025974025974025, 'loss_val': 3.0892574410740243, 'psi': 0.14025974025974025}-{'f1_val': 0.10522172658094989, 'auprc': 0.10522172658094989, 'loss_val': 3.2716919011457706, 'psi': 0.10522172658094989}
[S17] START round=28 head_norm_before_train=1.429293 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.063604 metrics={'f1_val': 0.20881887697870996, 'auprc': 0.20881887697870996, 'loss_val': 1.0428256334968538, 'psi': 0.20881887697870996}-{'f1_val': 0.19328540744144024, 'auprc': 0.19328540744144024, 'loss_val': 1.0302326945602374, 'psi': 0.19328540744144024}
[S16] not sending this round → trigger blocked (psi=0.140)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:42011
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:42010
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.122)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.028)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] cosine check vs S15: cos=0.9884
[S9] RECEIVED delta(kind=head bytes=1805) from S3
[S9] cosine check vs S3: cos=0.9265
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=-0.0392
[S10] DROPPED delta from S4 (cos=-0.0392 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.9247
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.3687 head_norm=1.589139
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.998109e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.3687 head_norm=1.523681 delta_norm=0.299811
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.3320 head_norm=1.878944
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.442646e-01
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.3320 head_norm=1.885148 delta_norm=0.144265
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.2987 head_norm=1.515790
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.897030e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.2985 head_norm=1.456718 delta_norm=0.289703
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.805046 (no previous merge yet)
[S2] round=29 local utility u=0.871572 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8207472329604646, 'psi': 0.3674775928297055}-{'f1_val': 0.22055469727065402, 'auprc': 0.22055469727065402, 'loss_val': 3.241584716758167, 'psi': 0.22055469727065402}
[S3] START round=29 head_norm_before_train=1.456718 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.302080616659086, 'psi': 0.2979423868312757}-{'f1_val': 0.2987249544626594, 'auprc': 0.2987249544626594, 'loss_val': 2.0507680249646207, 'psi': 0.2987249544626594}
[S4] START round=29 head_norm_before_train=1.598049 cos_to_last_merge=0.9881 (last merge round=24)
[S4] round=29 local utility u=0.022477 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.172848098251723, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2178012227889783, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=2.122151 (no previous merge yet)
[S5] round=29 local utility u=0.026436 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0588491635723587, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.111721995075004, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.718676 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 6.188462039685992, 'psi': 0.02109124254928932}-{'f1_val': 0.028442437923250564, 'auprc': 0.028442437923250564, 'loss_val': 6.0292653429146865, 'psi': 0.02844243792325056}
[S7] START round=29 head_norm_before_train=1.842205 (no previous merge yet)
[S7] round=29 local utility u=0.014263 metrics={'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.836930774680887, 'psi': 0.2490655370047346}-{'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.8654573921711077, 'psi': 0.2490655370047346}
[S8] START round=29 head_norm_before_train=1.860351 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6858255597668105, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6318635036273129, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.523681 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.017052 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4636653384319707, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4977688692661777, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.971544 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2230678964336104, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.209284226916963, 'psi': 0.33301496338745623}
[S11] START round=29 head_norm_before_train=1.885148 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.041903 metrics={'f1_val': 0.3268363525185355, 'auprc': 0.3268363525185355, 'loss_val': 1.865844870930708, 'psi': 0.3268363525185355}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.996244298863984, 'psi': 0.3320133550741517}
[S13] START round=29 head_norm_before_train=1.850702 cos_to_last_merge=0.9996 (last merge round=27)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1910713131117359, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.180515245131811, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.857370 cos_to_last_merge=0.9997 (last merge round=27)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 3.8972636700483925, 'psi': 0.1345336334083521}-{'f1_val': 0.12228191353287286, 'auprc': 0.12228191353287286, 'loss_val': 3.6707660238341653, 'psi': 0.12228191353287286}
[S15] START round=29 head_norm_before_train=1.902304 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.5860294415775099, 'auprc': 0.5860294415775099, 'loss_val': 0.45429130474852125, 'psi': 0.5860294415775099}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.34111012552561804, 'psi': 0.6166125814646326}
[S16] START round=29 head_norm_before_train=2.014919 cos_to_last_merge=0.9878 (last merge round=18)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.11972371450498849, 'auprc': 0.11972371450498849, 'loss_val': 3.182631160256698, 'psi': 0.11972371450498849}-{'f1_val': 0.14025974025974025, 'auprc': 0.14025974025974025, 'loss_val': 3.0892574410740243, 'psi': 0.14025974025974025}
[S17] START round=29 head_norm_before_train=1.454060 cos_to_last_merge=0.9996 (last merge round=27)
[S17] round=29 local utility u=0.116819 metrics={'f1_val': 0.23531328003495303, 'auprc': 0.23531328003495303, 'loss_val': 1.0476373265852814, 'psi': 0.23531328003495303}-{'f1_val': 0.20881887697870996, 'auprc': 0.20881887697870996, 'loss_val': 1.0428256334968538, 'psi': 0.20881887697870996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:42016
[S9] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S9
[S17] cosine check vs S9: cos=0.9586
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] cosine check vs S5: cos=0.9615
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9913
[S13] RECEIVED delta(kind=head bytes=1799) from S2
[S13] cosine check vs S2: cos=-0.0793
[S13] DROPPED delta from S2 (cos=-0.0793 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=0.9912
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] cosine check vs S4: cos=-0.0422
[S10] DROPPED delta from S4 (cos=-0.0422 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.9759
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.1345 head_norm=1.883450
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.239957e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.1345 head_norm=1.862923 delta_norm=0.123996
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.2979 head_norm=1.502838
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.641591e-01
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.2979 head_norm=1.485261 delta_norm=0.164159
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.3599 head_norm=1.867725
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.261794e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.3599 head_norm=1.880609 delta_norm=0.126179
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.2353 head_norm=1.485724
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.257627e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.2370 head_norm=1.517740 delta_norm=0.225763
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.1197 head_norm=2.025203
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.947245e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.1278 head_norm=2.062702 delta_norm=0.294725
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.814429 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8388862067329503, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8207472329604646, 'psi': 0.3674775928297055}
[S3] START round=30 head_norm_before_train=1.485261 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.3874222232698923, 'psi': 0.29784120014635934}-{'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.302080616659086, 'psi': 0.2979423868312757}
[S4] START round=30 head_norm_before_train=1.627434 cos_to_last_merge=0.9830 (last merge round=24)
[S4] round=30 local utility u=0.023151 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1265454135756081, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.172848098251723, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=2.140503 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.071603508760243, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0588491635723587, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.728823 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 6.303558522506303, 'psi': 0.018663594470046084}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 6.188462039685992, 'psi': 0.02109124254928932}
[S7] START round=30 head_norm_before_train=1.850494 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.24937779990044798, 'auprc': 0.24937779990044798, 'loss_val': 0.8792743497530467, 'psi': 0.249377799900448}-{'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.836930774680887, 'psi': 0.2490655370047346}
[S8] START round=30 head_norm_before_train=1.875426 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7549341080036854, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6858255597668105, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.581654 cos_to_last_merge=0.9961 (last merge round=28)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.634265433444456, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4636653384319707, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.999646 (no previous merge yet)
[S10] round=30 local utility u=0.021315 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.180438270217037, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2230678964336104, 'psi': 0.33301496338745623}
[S11] START round=30 head_norm_before_train=1.901796 cos_to_last_merge=0.9998 (last merge round=28)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.0115225970218433, 'psi': 0.3320133550741517}-{'f1_val': 0.3268363525185355, 'auprc': 0.3268363525185355, 'loss_val': 1.865844870930708, 'psi': 0.3268363525185355}
[S13] START round=30 head_norm_before_train=1.880609 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2192738481597831, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1910713131117359, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.862923 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.070531 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 3.7381704168552607, 'psi': 0.13253012048192772}-{'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 3.8972636700483925, 'psi': 0.1345336334083521}
[S15] START round=30 head_norm_before_train=1.919750 (no previous merge yet)
[S15] round=30 local utility u=0.194097 metrics={'f1_val': 0.6160664893048908, 'auprc': 0.6160664893048908, 'loss_val': 0.3364301664904022, 'psi': 0.6160664893048908}-{'f1_val': 0.5860294415775099, 'auprc': 0.5860294415775099, 'loss_val': 0.45429130474852125, 'psi': 0.5860294415775099}
[S16] START round=30 head_norm_before_train=2.062702 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.08910179640718563, 'auprc': 0.08910179640718563, 'loss_val': 3.0971529056769542, 'psi': 0.08910179640718563}-{'f1_val': 0.11972371450498849, 'auprc': 0.11972371450498849, 'loss_val': 3.182631160256698, 'psi': 0.11972371450498849}
[S17] START round=30 head_norm_before_train=1.517740 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.18905614918493713, 'auprc': 0.18905614918493713, 'loss_val': 1.084987638600987, 'psi': 0.18905614918493713}-{'f1_val': 0.23531328003495303, 'auprc': 0.23531328003495303, 'loss_val': 1.0476373265852814, 'psi': 0.23531328003495303}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:42009
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] cosine check vs S4: cos=-0.0986
[S8] DROPPED delta from S4 (cos=-0.0986 < 0.0)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.133)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:42014
[S15] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=-0.1942
[S14] DROPPED delta from S15 (cos=-0.1942 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:42004
[S10] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S10
[S4] cosine check vs S10: cos=-0.0445
[S4] DROPPED delta from S10 (cos=-0.0445 < 0.0)
[S3] ⇄ pheromone p=0.068 → S10@127.0.0.1:42011
[S4] ⇄ pheromone p=0.046 → S13@127.0.0.1:42013
[S11] ⇄ pheromone p=0.022 → S6@127.0.0.1:42007
[S13] ⇄ pheromone p=0.006 → S4@127.0.0.1:42004
[S9] ⇄ pheromone p=0.030 → S3@127.0.0.1:42003
[S10] ⇄ pheromone p=0.034 → S4@127.0.0.1:42004
[S6] ⇄ pheromone p=0.062 → S11@127.0.0.1:42012
[S15] ⇄ pheromone p=0.097 → S14@127.0.0.1:42014
[S16] ⇄ pheromone p=0.076 → S5@127.0.0.1:42005
[S17] ⇄ pheromone p=0.066 → S8@127.0.0.1:42009
[S14] ⇄ pheromone p=0.113 → S15@127.0.0.1:42015
[S2] START round=31 head_norm_before_train=1.823452 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8721477889873737, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8388862067329503, 'psi': 0.3674775928297055}
[S3] START round=31 head_norm_before_train=1.522851 cos_to_last_merge=0.9995 (last merge round=29)
[S3] round=31 local utility u=0.280482 metrics={'f1_val': 0.3099648300117233, 'auprc': 0.3099648300117233, 'loss_val': 1.9355703232930406, 'psi': 0.3099648300117233}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.3874222232698923, 'psi': 0.29784120014635934}
[S4] START round=31 head_norm_before_train=1.655008 cos_to_last_merge=0.9779 (last merge round=24)
[S4] round=31 local utility u=0.016606 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.093333493705698, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1265454135756081, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=2.157491 (no previous merge yet)
[S5] round=31 local utility u=0.014318 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0429673653394014, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.071603508760243, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=1.738165 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.375613525313098, 'psi': 0.017551963048498844}-{'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 6.303558522506303, 'psi': 0.018663594470046084}
[S7] START round=31 head_norm_before_train=1.857446 (no previous merge yet)
[S7] round=31 local utility u=0.025725 metrics={'f1_val': 0.24950248756218907, 'auprc': 0.24950248756218907, 'loss_val': 0.828947232657053, 'psi': 0.24950248756218907}-{'f1_val': 0.24937779990044798, 'auprc': 0.24937779990044798, 'loss_val': 0.8792743497530467, 'psi': 0.249377799900448}
[S8] START round=31 head_norm_before_train=1.890841 (no previous merge yet)
[S8] round=31 local utility u=0.004709 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7455163652680215, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7549341080036854, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.638262 cos_to_last_merge=0.9884 (last merge round=28)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7473898418576226, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.634265433444456, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=2.025059 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.1859346665766264, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.180438270217037, 'psi': 0.33301496338745623}
[S11] START round=31 head_norm_before_train=1.918940 cos_to_last_merge=0.9994 (last merge round=28)
[S11] round=31 local utility u=0.018152 metrics={'f1_val': 0.3279644117195889, 'auprc': 0.3279644117195889, 'loss_val': 1.9387790716823783, 'psi': 0.3279644117195889}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.0115225970218433, 'psi': 0.3320133550741517}
[S13] START round=31 head_norm_before_train=1.893777 cos_to_last_merge=0.9999 (last merge round=29)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.233976478487624, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2192738481597831, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.887026 cos_to_last_merge=0.9997 (last merge round=29)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.1195526417277285, 'auprc': 0.1195526417277285, 'loss_val': 3.9966547845121614, 'psi': 0.1195526417277285}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 3.7381704168552607, 'psi': 0.13253012048192772}
[S15] START round=31 head_norm_before_train=1.939656 (no previous merge yet)
[S15] round=31 local utility u=0.007362 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.325368391080047, 'psi': 0.6164734888353558}-{'f1_val': 0.6160664893048908, 'auprc': 0.6160664893048908, 'loss_val': 0.3364301664904022, 'psi': 0.6160664893048908}
[S16] START round=31 head_norm_before_train=2.073077 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.09069097888675624, 'auprc': 0.09069097888675624, 'loss_val': 3.520065136366943, 'psi': 0.09069097888675624}-{'f1_val': 0.08910179640718563, 'auprc': 0.08910179640718563, 'loss_val': 3.0971529056769542, 'psi': 0.08910179640718563}
[S17] START round=31 head_norm_before_train=1.550249 cos_to_last_merge=0.9992 (last merge round=29)
[S17] round=31 local utility u=0.111951 metrics={'f1_val': 0.20710873840452568, 'auprc': 0.20710873840452568, 'loss_val': 1.0235587773922754, 'psi': 0.20710873840452568}-{'f1_val': 0.18905614918493713, 'auprc': 0.18905614918493713, 'loss_val': 1.084987638600987, 'psi': 0.18905614918493713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:42011
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S3
[S10] cosine check vs S3: cos=0.6590
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:42015
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] cosine check vs S4: cos=-0.0458
[S10] DROPPED delta from S4 (cos=-0.0458 < 0.0)
[S11] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S11
[S15] cosine check vs S11: cos=0.9914
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=-0.1940
[S14] DROPPED delta from S15 (cos=-0.1940 < 0.0)
[S8] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.6201
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=0.9883
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:42009
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.6201
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=31 metric=0.3330 head_norm=2.048355
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.768980e-01
[S10] stored merged vector for next round verification (round=31)
[S10] DEBUG after merge:  round=31 metric=0.3330 head_norm=1.642795 delta_norm=0.776898
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.6165 head_norm=1.959941
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.281356e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.6165 head_norm=1.943457 delta_norm=0.128136
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.3594 head_norm=1.907755
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.741427e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.3594 head_norm=1.570904 delta_norm=0.774143
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.0907 head_norm=2.083254
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.686835e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.0907 head_norm=2.121018 delta_norm=0.168683
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.2071 head_norm=1.579412
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.741427e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.1806 head_norm=1.570904 delta_norm=0.774143
[S17] aggregate: ROLLBACK (f1_val pre=0.207 post=0.181 tol_abs=0.005 tol_rel=0.0)
[S2] START round=32 head_norm_before_train=1.832219 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 2.8896378663439046, 'psi': 0.24520932503356518}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8721477889873737, 'psi': 0.3674775928297055}
[S3] START round=32 head_norm_before_train=1.552073 cos_to_last_merge=0.9985 (last merge round=29)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.3013304566702625, 'auprc': 0.3013304566702625, 'loss_val': 2.2937128947188667, 'psi': 0.3013304566702625}-{'f1_val': 0.3099648300117233, 'auprc': 0.3099648300117233, 'loss_val': 1.9355703232930406, 'psi': 0.3099648300117233}
[S4] START round=32 head_norm_before_train=1.678443 cos_to_last_merge=0.9736 (last merge round=24)
[S4] round=32 local utility u=0.010999 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0713358932630925, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.093333493705698, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=2.171265 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.087002094770871, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0429673653394014, 'psi': 0.3335071121394324}
[S6] START round=32 head_norm_before_train=1.745555 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 6.420876305735384, 'psi': 0.01910681399631676}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.375613525313098, 'psi': 0.017551963048498844}
[S7] START round=32 head_norm_before_train=1.865505 (no previous merge yet)
[S7] round=32 local utility u=0.010224 metrics={'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 0.8079372793309283, 'psi': 0.24944015924359295}-{'f1_val': 0.24950248756218907, 'auprc': 0.24950248756218907, 'loss_val': 0.828947232657053, 'psi': 0.24950248756218907}
[S8] START round=32 head_norm_before_train=1.570904 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7776825997693817, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7455163652680215, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.679959 cos_to_last_merge=0.9820 (last merge round=28)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.841517822634626, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7473898418576226, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=1.642795 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=32 local utility u=0.177696 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.8305417207993873, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.1859346665766264, 'psi': 0.33301496338745623}
[S11] START round=32 head_norm_before_train=1.935335 cos_to_last_merge=0.9987 (last merge round=28)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.071224484411938, 'psi': 0.3319360347772085}-{'f1_val': 0.3279644117195889, 'auprc': 0.3279644117195889, 'loss_val': 1.9387790716823783, 'psi': 0.3279644117195889}
[S13] START round=32 head_norm_before_train=1.904809 cos_to_last_merge=0.9995 (last merge round=29)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.253283678005384, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.233976478487624, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.910945 cos_to_last_merge=0.9991 (last merge round=29)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.12436289500509684, 'auprc': 0.12436289500509684, 'loss_val': 4.1860718334525595, 'psi': 0.12436289500509684}-{'f1_val': 0.1195526417277285, 'auprc': 0.1195526417277285, 'loss_val': 3.9966547845121614, 'psi': 0.1195526417277285}
[S15] START round=32 head_norm_before_train=1.943457 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.5969172002043431, 'auprc': 0.5969172002043431, 'loss_val': 0.3567599322231202, 'psi': 0.5969172002043431}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.325368391080047, 'psi': 0.6164734888353558}
[S16] START round=32 head_norm_before_train=2.121018 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.186618 metrics={'f1_val': 0.09783037475345167, 'auprc': 0.09783037475345167, 'loss_val': 3.2110827217152655, 'psi': 0.09783037475345167}-{'f1_val': 0.09069097888675624, 'auprc': 0.09069097888675624, 'loss_val': 3.520065136366943, 'psi': 0.09069097888675624}
[S17] START round=32 head_norm_before_train=1.570904 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.20436196832654122, 'auprc': 0.20436196832654122, 'loss_val': 1.34952742086753, 'psi': 0.20436196832654122}-{'f1_val': 0.20710873840452568, 'auprc': 0.20710873840452568, 'loss_val': 1.0235587773922754, 'psi': 0.20710873840452568}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.098)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:42004
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=-0.0603
[S4] DROPPED delta from S10 (cos=-0.0603 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] cosine check vs S4: cos=-0.0603
[S10] DROPPED delta from S4 (cos=-0.0603 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.839640 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.2289591453731774, 'auprc': 0.2289591453731774, 'loss_val': 3.3375172415544934, 'psi': 0.2289591453731774}-{'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 2.8896378663439046, 'psi': 0.24520932503356518}
[S3] START round=33 head_norm_before_train=1.574489 cos_to_last_merge=0.9976 (last merge round=29)
[S3] round=33 local utility u=0.147305 metrics={'f1_val': 0.30373582895838086, 'auprc': 0.30373582895838086, 'loss_val': 2.0207504432353187, 'psi': 0.30373582895838086}-{'f1_val': 0.3013304566702625, 'auprc': 0.3013304566702625, 'loss_val': 2.2937128947188667, 'psi': 0.3013304566702625}
[S4] START round=33 head_norm_before_train=1.698492 cos_to_last_merge=0.9700 (last merge round=24)
[S4] round=33 local utility u=0.007835 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0556664539662386, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0713358932630925, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=2.185089 (no previous merge yet)
[S5] round=33 local utility u=0.014606 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.05778938351358, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.087002094770871, 'psi': 0.3335071121394324}
[S6] START round=33 head_norm_before_train=1.754563 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.02458890425695405, 'auprc': 0.02458890425695405, 'loss_val': 6.516199887797716, 'psi': 0.02458890425695405}-{'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 6.420876305735384, 'psi': 0.01910681399631676}
[S7] START round=33 head_norm_before_train=1.873626 (no previous merge yet)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.24806104578433824, 'auprc': 0.24806104578433824, 'loss_val': 0.9355881830913751, 'psi': 0.24806104578433824}-{'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 0.8079372793309283, 'psi': 0.24944015924359295}
[S8] START round=33 head_norm_before_train=1.592566 cos_to_last_merge=0.9998 (last merge round=31)
[S8] round=33 local utility u=0.003261 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7711597201949547, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7776825997693817, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.710547 cos_to_last_merge=0.9775 (last merge round=28)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9262174310278002, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.841517822634626, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=1.671951 cos_to_last_merge=0.9998 (last merge round=31)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.8351558409326867, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.8305417207993873, 'psi': 0.33301496338745623}
[S11] START round=33 head_norm_before_train=1.949163 cos_to_last_merge=0.9980 (last merge round=28)
[S11] round=33 local utility u=0.011099 metrics={'f1_val': 0.32416041240239557, 'auprc': 0.32416041240239557, 'loss_val': 1.979046032790959, 'psi': 0.32416041240239557}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.071224484411938, 'psi': 0.3319360347772085}
[S13] START round=33 head_norm_before_train=1.919453 cos_to_last_merge=0.9989 (last merge round=29)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.285053083960725, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.253283678005384, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=1.932358 cos_to_last_merge=0.9983 (last merge round=29)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13051146384479717, 'auprc': 0.13051146384479717, 'loss_val': 4.349809802450788, 'psi': 0.13051146384479717}-{'f1_val': 0.12436289500509684, 'auprc': 0.12436289500509684, 'loss_val': 4.1860718334525595, 'psi': 0.12436289500509684}
[S15] START round=33 head_norm_before_train=1.962484 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=33 local utility u=0.019585 metrics={'f1_val': 0.5992396609102485, 'auprc': 0.5992396609102485, 'loss_val': 0.33849126439051525, 'psi': 0.5992396609102485}-{'f1_val': 0.5969172002043431, 'auprc': 0.5969172002043431, 'loss_val': 0.3567599322231202, 'psi': 0.5969172002043431}
[S16] START round=33 head_norm_before_train=2.132254 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.06551349544580931, 'auprc': 0.06551349544580931, 'loss_val': 3.752188987636635, 'psi': 0.06551349544580931}-{'f1_val': 0.09783037475345167, 'auprc': 0.09783037475345167, 'loss_val': 3.2110827217152655, 'psi': 0.09783037475345167}
[S17] START round=33 head_norm_before_train=1.592668 cos_to_last_merge=0.9998 (last merge round=31)
[S17] round=33 local utility u=0.059890 metrics={'f1_val': 0.20005826040350091, 'auprc': 0.20005826040350091, 'loss_val': 1.191014479020476, 'psi': 0.20005826040350091}-{'f1_val': 0.20436196832654122, 'auprc': 0.20436196832654122, 'loss_val': 1.34952742086753, 'psi': 0.20436196832654122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:42017
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:42011
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1805) from S3
[S10] cosine check vs S3: cos=0.8708
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.9956
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.9985
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.9955
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.1968
[S14] DROPPED delta from S15 (cos=-0.1968 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] cosine check vs S4: cos=-0.0601
[S10] DROPPED delta from S4 (cos=-0.0601 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:42009
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9985
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3]  timeout peer S2
[S2]  timeout peer S3
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.3330 head_norm=1.709570
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.236462e-01
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.3330 head_norm=1.599011 delta_norm=0.423646
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.3594 head_norm=1.622310
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.463764e-02
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.3594 head_norm=1.614457 delta_norm=0.044638
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.5992 head_norm=1.980157
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.257197e-02
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.6077 head_norm=1.969522 delta_norm=0.092572
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.0655 head_norm=2.144126
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.069032e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.0690 head_norm=2.168603 delta_norm=0.106903
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.2001 head_norm=1.607807
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.463764e-02
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.1991 head_norm=1.614457 delta_norm=0.044638
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.846882 (no previous merge yet)
[S2] round=34 local utility u=0.285061 metrics={'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 2.915667967400737, 'psi': 0.24543399914482925}-{'f1_val': 0.2289591453731774, 'auprc': 0.2289591453731774, 'loss_val': 3.3375172415544934, 'psi': 0.2289591453731774}
[S3] START round=34 head_norm_before_train=1.596870 cos_to_last_merge=0.9966 (last merge round=29)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.28131991051454136, 'auprc': 0.28131991051454136, 'loss_val': 1.969320029306334, 'psi': 0.28131991051454136}-{'f1_val': 0.30373582895838086, 'auprc': 0.30373582895838086, 'loss_val': 2.0207504432353187, 'psi': 0.30373582895838086}
[S4] START round=34 head_norm_before_train=1.714331 cos_to_last_merge=0.9672 (last merge round=24)
[S4] round=34 local utility u=0.002979 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.04970751703633, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0556664539662386, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=2.198012 (no previous merge yet)
[S5] round=34 local utility u=0.012460 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0328686290746365, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.05778938351358, 'psi': 0.3335071121394324}
[S6] START round=34 head_norm_before_train=1.763278 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 6.502342473992302, 'psi': 0.01910681399631676}-{'f1_val': 0.02458890425695405, 'auprc': 0.02458890425695405, 'loss_val': 6.516199887797716, 'psi': 0.02458890425695405}
[S7] START round=34 head_norm_before_train=1.889164 (no previous merge yet)
[S7] round=34 local utility u=0.000331 metrics={'f1_val': 0.2483129217695576, 'auprc': 0.2483129217695576, 'loss_val': 0.9371921010829551, 'psi': 0.2483129217695576}-{'f1_val': 0.24806104578433824, 'auprc': 0.24806104578433824, 'loss_val': 0.9355881830913751, 'psi': 0.24806104578433824}
[S8] START round=34 head_norm_before_train=1.614457 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.003965 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7632298127078213, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7711597201949547, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.734065 cos_to_last_merge=0.9742 (last merge round=28)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9952945465018732, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9262174310278002, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=1.599011 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.065350 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.7044557680022332, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.8351558409326867, 'psi': 0.33301496338745623}
[S11] START round=34 head_norm_before_train=1.963199 cos_to_last_merge=0.9973 (last merge round=28)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.1370708169884067, 'psi': 0.33185875048506014}-{'f1_val': 0.32416041240239557, 'auprc': 0.32416041240239557, 'loss_val': 1.979046032790959, 'psi': 0.32416041240239557}
[S13] START round=34 head_norm_before_train=1.936763 cos_to_last_merge=0.9979 (last merge round=29)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3242308193621097, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.285053083960725, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=1.951137 cos_to_last_merge=0.9975 (last merge round=29)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.12539743100597736, 'auprc': 0.12539743100597736, 'loss_val': 4.510613099610247, 'psi': 0.12539743100597736}-{'f1_val': 0.13051146384479717, 'auprc': 0.13051146384479717, 'loss_val': 4.349809802450788, 'psi': 0.13051146384479717}
[S15] START round=34 head_norm_before_train=1.969522 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.5883436109580193, 'auprc': 0.5883436109580193, 'loss_val': 0.3339053688725961, 'psi': 0.5883436109580193}-{'f1_val': 0.5992396609102485, 'auprc': 0.5992396609102485, 'loss_val': 0.33849126439051525, 'psi': 0.5992396609102485}
[S16] START round=34 head_norm_before_train=2.168603 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.447955 metrics={'f1_val': 0.11303079167626506, 'auprc': 0.11303079167626506, 'loss_val': 3.2839354348493632, 'psi': 0.11303079167626506}-{'f1_val': 0.06551349544580931, 'auprc': 0.06551349544580931, 'loss_val': 3.752188987636635, 'psi': 0.06551349544580931}
[S17] START round=34 head_norm_before_train=1.614457 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.19910382306830582, 'auprc': 0.19910382306830582, 'loss_val': 1.2046545704574745, 'psi': 0.19910382306830582}-{'f1_val': 0.20005826040350091, 'auprc': 0.20005826040350091, 'loss_val': 1.191014479020476, 'psi': 0.20005826040350091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:42004
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S4
[S10] cosine check vs S4: cos=-0.0641
[S10] DROPPED delta from S4 (cos=-0.0641 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=-0.0641
[S4] DROPPED delta from S10 (cos=-0.0641 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9995
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.9982
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.113)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.1991 head_norm=1.629655
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.686961e-02
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.1989 head_norm=1.638406 delta_norm=0.026870
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.1130 head_norm=2.181097
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.705822e-02
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.1158 head_norm=2.193781 delta_norm=0.067058
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.854274 (no previous merge yet)
[S2] round=35 local utility u=0.527775 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.958509887985937, 'psi': 0.3674775928297055}-{'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 2.915667967400737, 'psi': 0.24543399914482925}
[S3] START round=35 head_norm_before_train=1.617640 cos_to_last_merge=0.9956 (last merge round=29)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.2976157851466155, 'auprc': 0.2976157851466155, 'loss_val': 2.6210891286186384, 'psi': 0.2976157851466155}-{'f1_val': 0.28131991051454136, 'auprc': 0.28131991051454136, 'loss_val': 1.969320029306334, 'psi': 0.28131991051454136}
[S4] START round=35 head_norm_before_train=1.726131 cos_to_last_merge=0.9651 (last merge round=24)
[S4] round=35 local utility u=0.001324 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.047059614694033, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.04970751703633, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=2.208430 (no previous merge yet)
[S5] round=35 local utility u=0.000091 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.032686238531365, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0328686290746365, 'psi': 0.3335071121394324}
[S6] START round=35 head_norm_before_train=1.770466 (no previous merge yet)
[S6] round=35 local utility u=0.160943 metrics={'f1_val': 0.024362477231329692, 'auprc': 0.024362477231329692, 'loss_val': 6.227757845054876, 'psi': 0.024362477231329692}-{'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 6.502342473992302, 'psi': 0.01910681399631676}
[S7] START round=35 head_norm_before_train=1.901841 (no previous merge yet)
[S7] round=35 local utility u=0.030243 metrics={'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.8834790751757197, 'psi': 0.2490655370047346}-{'f1_val': 0.2483129217695576, 'auprc': 0.2483129217695576, 'loss_val': 0.9371921010829551, 'psi': 0.2483129217695576}
[S8] START round=35 head_norm_before_train=1.647549 cos_to_last_merge=0.9997 (last merge round=33)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7878665394795944, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7632298127078213, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.752775 cos_to_last_merge=0.9716 (last merge round=28)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0489463260617886, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9952945465018732, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=1.640898 cos_to_last_merge=0.9996 (last merge round=33)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.7508411851100372, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.7044557680022332, 'psi': 0.33301496338745623}
[S11] START round=35 head_norm_before_train=1.976142 cos_to_last_merge=0.9967 (last merge round=28)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.13504779603761, 'psi': 0.33154997286190585}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.1370708169884067, 'psi': 0.33185875048506014}
[S13] START round=35 head_norm_before_train=1.954132 cos_to_last_merge=0.9969 (last merge round=29)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.372323890439985, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3242308193621097, 'psi': 0.3599362944611573}
[S14] START round=35 head_norm_before_train=1.967676 cos_to_last_merge=0.9966 (last merge round=29)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.12060559404670258, 'auprc': 0.12060559404670258, 'loss_val': 4.647570861443932, 'psi': 0.1206055940467026}-{'f1_val': 0.12539743100597736, 'auprc': 0.12539743100597736, 'loss_val': 4.510613099610247, 'psi': 0.12539743100597736}
[S15] START round=35 head_norm_before_train=1.986750 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=35 local utility u=0.000408 metrics={'f1_val': 0.5890282665563779, 'auprc': 0.5890282665563779, 'loss_val': 0.33925042134880345, 'psi': 0.5890282665563779}-{'f1_val': 0.5883436109580193, 'auprc': 0.5883436109580193, 'loss_val': 0.3339053688725961, 'psi': 0.5883436109580193}
[S16] START round=35 head_norm_before_train=2.193781 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.895723 metrics={'f1_val': 0.19525583218976672, 'auprc': 0.19525583218976672, 'loss_val': 2.2325149268244324, 'psi': 0.19525583218976672}-{'f1_val': 0.11303079167626506, 'auprc': 0.11303079167626506, 'loss_val': 3.2839354348493632, 'psi': 0.11303079167626506}
[S17] START round=35 head_norm_before_train=1.638406 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.271765 metrics={'f1_val': 0.26332010870683026, 'auprc': 0.26332010870683026, 'loss_val': 1.2390721273328207, 'psi': 0.26332010870683026}-{'f1_val': 0.19910382306830582, 'auprc': 0.19910382306830582, 'loss_val': 1.2046545704574745, 'psi': 0.19910382306830582}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.024)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:42016
[S16] not sending this round → trigger blocked (psi=0.195)
[S5] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.9990
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=-0.1984
[S14] DROPPED delta from S15 (cos=-0.1984 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=-0.0637
[S10] DROPPED delta from S4 (cos=-0.0637 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:42009
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9990
[S3] ⇄ pheromone p=0.064 → S10@127.0.0.1:42011
[S11] ⇄ pheromone p=0.010 → S15@127.0.0.1:42015
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.3594 head_norm=1.678899
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.879738e-02
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.3594 head_norm=1.667956 delta_norm=0.038797
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.033 → S17@127.0.0.1:42017
[S14] ⇄ pheromone p=0.037 → S15@127.0.0.1:42015
[S10] ⇄ pheromone p=0.040 → S4@127.0.0.1:42004
[S9] ⇄ pheromone p=0.010 → S3@127.0.0.1:42003
[S6] ⇄ pheromone p=0.052 → S11@127.0.0.1:42012
[S13] ⇄ pheromone p=0.002 → S4@127.0.0.1:42004
[S5] ⇄ pheromone p=0.009 → S16@127.0.0.1:42016
[S4] ⇄ pheromone p=0.019 → S10@127.0.0.1:42011
[S15] ⇄ pheromone p=0.035 → S14@127.0.0.1:42014
[S17] ⇄ pheromone p=0.093 → S16@127.0.0.1:42016
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.1953 head_norm=2.206781
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.880435e-02
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.1962 head_norm=2.212807 delta_norm=0.048804
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.295 → S17@127.0.0.1:42017
[S2] START round=36 head_norm_before_train=1.861694 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9795225492454653, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.958509887985937, 'psi': 0.3674775928297055}
[S3] START round=36 head_norm_before_train=1.637419 cos_to_last_merge=0.9946 (last merge round=29)
[S3] round=36 local utility u=0.206877 metrics={'f1_val': 0.28232652774854416, 'auprc': 0.28232652774854416, 'loss_val': 2.069732163533056, 'psi': 0.28232652774854416}-{'f1_val': 0.2976157851466155, 'auprc': 0.2976157851466155, 'loss_val': 2.6210891286186384, 'psi': 0.2976157851466155}
[S4] START round=36 head_norm_before_train=1.738631 cos_to_last_merge=0.9630 (last merge round=24)
[S4] round=36 local utility u=0.000207 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0466448939526543, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.047059614694033, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=2.219891 (no previous merge yet)
[S5] round=36 local utility u=0.019433 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9938209716737543, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.032686238531365, 'psi': 0.3335071121394324}
[S6] START round=36 head_norm_before_train=1.778902 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.0023820867079561697, 'auprc': 0.0023820867079561697, 'loss_val': 6.644897066104811, 'psi': 0.0023820867079561697}-{'f1_val': 0.024362477231329692, 'auprc': 0.024362477231329692, 'loss_val': 6.227757845054876, 'psi': 0.024362477231329692}
[S7] START round=36 head_norm_before_train=1.910161 (no previous merge yet)
[S7] round=36 local utility u=0.012319 metrics={'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.8588410707250069, 'psi': 0.2490655370047346}-{'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.8834790751757197, 'psi': 0.2490655370047346}
[S8] START round=36 head_norm_before_train=1.667956 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8458717102830261, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7878665394795944, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=1.768500 cos_to_last_merge=0.9694 (last merge round=28)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0965824876185444, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0489463260617886, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=1.689398 cos_to_last_merge=0.9982 (last merge round=33)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.8877787061593545, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.7508411851100372, 'psi': 0.33301496338745623}
[S11] START round=36 head_norm_before_train=1.989165 cos_to_last_merge=0.9960 (last merge round=28)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.1799280620536834, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.13504779603761, 'psi': 0.33154997286190585}
[S13] START round=36 head_norm_before_train=1.968603 cos_to_last_merge=0.9957 (last merge round=29)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4137307150337288, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.372323890439985, 'psi': 0.3599362944611573}
[S14] START round=36 head_norm_before_train=1.982141 cos_to_last_merge=0.9958 (last merge round=29)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.12186379928315412, 'auprc': 0.12186379928315412, 'loss_val': 4.741084031575859, 'psi': 0.12186379928315413}-{'f1_val': 0.12060559404670258, 'auprc': 0.12060559404670258, 'loss_val': 4.647570861443932, 'psi': 0.1206055940467026}
[S15] START round=36 head_norm_before_train=2.004058 cos_to_last_merge=0.9998 (last merge round=33)
[S15] round=36 local utility u=0.014779 metrics={'f1_val': 0.5923578842840228, 'auprc': 0.5923578842840228, 'loss_val': 0.339658035322521, 'psi': 0.5923578842840228}-{'f1_val': 0.5890282665563779, 'auprc': 0.5890282665563779, 'loss_val': 0.33925042134880345, 'psi': 0.5890282665563779}
[S16] START round=36 head_norm_before_train=2.212807 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.06955511288180612, 'auprc': 0.06955511288180612, 'loss_val': 3.719018667112982, 'psi': 0.06955511288180612}-{'f1_val': 0.19525583218976672, 'auprc': 0.19525583218976672, 'loss_val': 2.2325149268244324, 'psi': 0.19525583218976672}
[S17] START round=36 head_norm_before_train=1.657848 cos_to_last_merge=0.9998 (last merge round=34)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.24968373733822527, 'auprc': 0.24968373733822527, 'loss_val': 1.257660800782044, 'psi': 0.2496837373382253}-{'f1_val': 0.26332010870683026, 'auprc': 0.26332010870683026, 'loss_val': 1.2390721273328207, 'psi': 0.26332010870683026}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:42016
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:42011
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:42014
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.9993
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=-0.1973
[S14] DROPPED delta from S15 (cos=-0.1973 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] cosine check vs S4: cos=-0.0634
[S10] DROPPED delta from S4 (cos=-0.0634 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:42011
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S3
[S10] cosine check vs S3: cos=0.9438
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=36 metric=0.3330 head_norm=1.735611
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.870495e-01
[S10] stored merged vector for next round verification (round=36)
[S10] DEBUG after merge:  round=36 metric=0.3330 head_norm=1.670796 delta_norm=0.287050
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.0696 head_norm=2.226789
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.126533e-02
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.0722 head_norm=2.228370 delta_norm=0.041265
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.867679 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.9862771834927497, 'psi': 0.24507471790179935}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9795225492454653, 'psi': 0.3674775928297055}
[S3] START round=37 head_norm_before_train=1.653955 cos_to_last_merge=0.9937 (last merge round=29)
[S3] round=37 local utility u=0.045643 metrics={'f1_val': 0.30972482801751094, 'auprc': 0.30972482801751094, 'loss_val': 2.2250309537013115, 'psi': 0.30972482801751094}-{'f1_val': 0.28232652774854416, 'auprc': 0.28232652774854416, 'loss_val': 2.069732163533056, 'psi': 0.28232652774854416}
[S4] START round=37 head_norm_before_train=1.750983 cos_to_last_merge=0.9611 (last merge round=24)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0467028869936614, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0466448939526543, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=2.230713 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.995202466073867, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9938209716737543, 'psi': 0.3335071121394324}
[S6] START round=37 head_norm_before_train=1.787121 (no previous merge yet)
[S6] round=37 local utility u=0.140575 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.502280361226082, 'psi': 0.017774699907663897}-{'f1_val': 0.0023820867079561697, 'auprc': 0.0023820867079561697, 'loss_val': 6.644897066104811, 'psi': 0.0023820867079561697}
[S7] START round=37 head_norm_before_train=1.924195 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.8674022233447842, 'psi': 0.2491280518186348}-{'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.8588410707250069, 'psi': 0.2490655370047346}
[S8] START round=37 head_norm_before_train=1.697890 cos_to_last_merge=0.9998 (last merge round=35)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.87586865793035, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8458717102830261, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=1.782305 cos_to_last_merge=0.9675 (last merge round=28)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.145501745039244, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0965824876185444, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=1.670796 cos_to_last_merge=1.0000 (last merge round=36)
[S10] round=37 local utility u=0.083031 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.7217159756977793, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.8877787061593545, 'psi': 0.33301496338745623}
[S11] START round=37 head_norm_before_train=2.001731 cos_to_last_merge=0.9953 (last merge round=28)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.207930127619399, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.1799280620536834, 'psi': 0.33154997286190585}
[S13] START round=37 head_norm_before_train=1.982003 cos_to_last_merge=0.9946 (last merge round=29)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4590927155603157, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4137307150337288, 'psi': 0.3599362944611573}
[S14] START round=37 head_norm_before_train=1.995430 cos_to_last_merge=0.9951 (last merge round=29)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.1288855193328279, 'auprc': 0.1288855193328279, 'loss_val': 4.810954444894463, 'psi': 0.1288855193328279}-{'f1_val': 0.12186379928315412, 'auprc': 0.12186379928315412, 'loss_val': 4.741084031575859, 'psi': 0.12186379928315413}
[S15] START round=37 head_norm_before_train=2.020967 cos_to_last_merge=0.9996 (last merge round=33)
[S15] round=37 local utility u=0.130137 metrics={'f1_val': 0.6162055819341677, 'auprc': 0.6162055819341677, 'loss_val': 0.29401330587579566, 'psi': 0.6162055819341677}-{'f1_val': 0.5923578842840228, 'auprc': 0.5923578842840228, 'loss_val': 0.339658035322521, 'psi': 0.5923578842840228}
[S16] START round=37 head_norm_before_train=2.228370 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.518181 metrics={'f1_val': 0.1347784413477844, 'auprc': 0.1347784413477844, 'loss_val': 3.269666169016792, 'psi': 0.1347784413477844}-{'f1_val': 0.06955511288180612, 'auprc': 0.06955511288180612, 'loss_val': 3.719018667112982, 'psi': 0.06955511288180612}
[S17] START round=37 head_norm_before_train=1.676296 cos_to_last_merge=0.9994 (last merge round=34)
[S17] round=37 local utility u=0.127590 metrics={'f1_val': 0.27031001911666086, 'auprc': 0.27031001911666086, 'loss_val': 1.188116688353042, 'psi': 0.27031001911666086}-{'f1_val': 0.24968373733822527, 'auprc': 0.24968373733822527, 'loss_val': 1.257660800782044, 'psi': 0.2496837373382253}
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S16
[S11]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S13]  timeout peer S3
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:42011
[S6] not sending this round → trigger blocked (psi=0.018)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.135)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:42014
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1803) from S3
[S10] cosine check vs S3: cos=0.9803
[S17] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] cosine check vs S10: cos=0.9803
[S16] RECEIVED delta(kind=head bytes=1800) from S17
[S16] cosine check vs S17: cos=-0.0950
[S16] DROPPED delta from S17 (cos=-0.0950 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=-0.1961
[S14] DROPPED delta from S15 (cos=-0.1961 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=37 metric=0.3330 head_norm=1.713365
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.693219e-01
[S10] stored merged vector for next round verification (round=37)
[S10] DEBUG after merge:  round=37 metric=0.3330 head_norm=1.681919 delta_norm=0.169322
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.3097 head_norm=1.667159
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.693219e-01
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.3060 head_norm=1.681919 delta_norm=0.169322
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] CommDone barrier timeout: have=1 need=2 — continuing
[S2] START round=38 head_norm_before_train=1.873367 (no previous merge yet)
[S2] round=38 local utility u=0.009272 metrics={'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.9717758721944465, 'psi': 0.24552398411243506}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.9862771834927497, 'psi': 0.24507471790179935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=38 head_norm_before_train=1.681919 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.28197042954242874, 'auprc': 0.28197042954242874, 'loss_val': 2.078756331834305, 'psi': 0.28197042954242874}-{'f1_val': 0.30972482801751094, 'auprc': 0.30972482801751094, 'loss_val': 2.2250309537013115, 'psi': 0.30972482801751094}
[S4] START round=38 head_norm_before_train=1.764292 cos_to_last_merge=0.9590 (last merge round=24)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0547349232989947, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0467028869936614, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=2.243496 (no previous merge yet)
[S5] round=38 local utility u=0.009643 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.975917361682416, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.995202466073867, 'psi': 0.3335071121394324}
[S6] START round=38 head_norm_before_train=1.794523 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.618563271903877, 'psi': 0.017551963048498844}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.502280361226082, 'psi': 0.017774699907663897}
[S7] START round=38 head_norm_before_train=1.936688 (no previous merge yet)
[S7] round=38 local utility u=0.012668 metrics={'f1_val': 0.24818704676169043, 'auprc': 0.24818704676169043, 'loss_val': 0.8335966055741272, 'psi': 0.24818704676169046}-{'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.8674022233447842, 'psi': 0.2491280518186348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=38 head_norm_before_train=1.725842 cos_to_last_merge=0.9993 (last merge round=35)
[S8] round=38 local utility u=0.007937 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8599943760270681, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.87586865793035, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.794966 cos_to_last_merge=0.9658 (last merge round=28)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.188275291996653, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.145501745039244, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=1.681919 cos_to_last_merge=1.0000 (last merge round=37)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.782542021994185, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.7217159756977793, 'psi': 0.33301496338745623}
[S11] START round=38 head_norm_before_train=2.013506 cos_to_last_merge=0.9946 (last merge round=28)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.302446212465356, 'psi': 0.33185875048506014}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.207930127619399, 'psi': 0.33154997286190585}
[S13] START round=38 head_norm_before_train=1.996806 cos_to_last_merge=0.9933 (last merge round=29)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4918052538624322, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4590927155603157, 'psi': 0.3599362944611573}
[S14] START round=38 head_norm_before_train=2.007262 cos_to_last_merge=0.9944 (last merge round=29)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13071401586701928, 'auprc': 0.13071401586701928, 'loss_val': 4.886012568785197, 'psi': 0.13071401586701928}-{'f1_val': 0.1288855193328279, 'auprc': 0.1288855193328279, 'loss_val': 4.810954444894463, 'psi': 0.1288855193328279}
[S15] START round=38 head_norm_before_train=2.037275 cos_to_last_merge=0.9993 (last merge round=33)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.5863079300903425, 'auprc': 0.5863079300903425, 'loss_val': 0.3869465033096187, 'psi': 0.5863079300903425}-{'f1_val': 0.6162055819341677, 'auprc': 0.6162055819341677, 'loss_val': 0.29401330587579566, 'psi': 0.6162055819341677}
[S16] START round=38 head_norm_before_train=2.242288 cos_to_last_merge=0.9999 (last merge round=36)
[S16] round=38 local utility u=0.246660 metrics={'f1_val': 0.1586027185013029, 'auprc': 0.1586027185013029, 'loss_val': 2.9907654638029246, 'psi': 0.1586027185013029}-{'f1_val': 0.1347784413477844, 'auprc': 0.1347784413477844, 'loss_val': 3.269666169016792, 'psi': 0.1347784413477844}
[S17] START round=38 head_norm_before_train=1.691736 cos_to_last_merge=0.9988 (last merge round=34)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.2649504389022128, 'auprc': 0.2649504389022128, 'loss_val': 1.274095127684468, 'psi': 0.2649504389022128}-{'f1_val': 0.27031001911666086, 'auprc': 0.27031001911666086, 'loss_val': 1.188116688353042, 'psi': 0.27031001911666086}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:42017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:42016
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.159)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.9958
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.9989
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.1586 head_norm=2.255522
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.245991e-02
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.1596 head_norm=2.254333 delta_norm=0.052460
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.2650 head_norm=1.707447
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.208419e-02
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.2640 head_norm=1.725886 delta_norm=0.082084
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9]  timeout peer S3
[S3]  timeout peer S10
[S3]  timeout peer S17
[S14]  timeout peer S7
[S17]  timeout peer S9
[S11]  timeout peer S15
[S13]  timeout peer S2
[S13]  timeout peer S11
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.879653 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.24565908535094153, 'auprc': 0.24565908535094153, 'loss_val': 2.97521674613178, 'psi': 0.24565908535094153}-{'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.9717758721944465, 'psi': 0.24552398411243506}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.246 u=0.0000 p_local=0.0839 f1=0.246 auprc=0.246 bytes=17995
[S3] START round=39 head_norm_before_train=1.696718 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.2862427087779201, 'auprc': 0.2862427087779201, 'loss_val': 2.132451419409446, 'psi': 0.2862427087779201}-{'f1_val': 0.28197042954242874, 'auprc': 0.28197042954242874, 'loss_val': 2.078756331834305, 'psi': 0.28197042954242874}
[S4] START round=39 head_norm_before_train=1.775331 cos_to_last_merge=0.9572 (last merge round=24)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0606801004155169, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0547349232989947, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=2.254365 (no previous merge yet)
[S5] round=39 local utility u=0.015592 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9447336402540825, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.975917361682416, 'psi': 0.3335071121394324}
[S6] START round=39 head_norm_before_train=1.801754 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.016435185185185185, 'auprc': 0.016435185185185185, 'loss_val': 6.7845886706310035, 'psi': 0.016435185185185185}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.618563271903877, 'psi': 0.017551963048498844}
[S7] START round=39 head_norm_before_train=1.944742 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.24787180771156736, 'auprc': 0.24787180771156736, 'loss_val': 0.8570772154427277, 'psi': 0.24787180771156736}-{'f1_val': 0.24818704676169043, 'auprc': 0.24818704676169043, 'loss_val': 0.8335966055741272, 'psi': 0.24818704676169046}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.248 u=0.0000 p_local=0.0103 f1=0.248 auprc=0.248 bytes=27034
[S8] START round=39 head_norm_before_train=1.747988 cos_to_last_merge=0.9988 (last merge round=35)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8880092672240008, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8599943760270681, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=1.806494 cos_to_last_merge=0.9642 (last merge round=28)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.228443859932876, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.188275291996653, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0040 f1=0.369 auprc=0.369 bytes=18008
[S10] START round=39 head_norm_before_train=1.727624 cos_to_last_merge=0.9994 (last merge round=37)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.818849496232489, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.782542021994185, 'psi': 0.33301496338745623}
[S11] START round=39 head_norm_before_train=2.024957 cos_to_last_merge=0.9940 (last merge round=28)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.3408325366214977, 'psi': 0.33185875048506014}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.302446212465356, 'psi': 0.33185875048506014}
[S13] START round=39 head_norm_before_train=2.007561 cos_to_last_merge=0.9922 (last merge round=29)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5012515883807778, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4918052538624322, 'psi': 0.3599362944611573}
[S14] START round=39 head_norm_before_train=2.017650 cos_to_last_merge=0.9938 (last merge round=29)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.1309164149043303, 'auprc': 0.1309164149043303, 'loss_val': 4.957206200617555, 'psi': 0.1309164149043303}-{'f1_val': 0.13071401586701928, 'auprc': 0.13071401586701928, 'loss_val': 4.886012568785197, 'psi': 0.13071401586701928}
[S15] START round=39 head_norm_before_train=2.052654 cos_to_last_merge=0.9990 (last merge round=33)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.586168736413024, 'auprc': 0.586168736413024, 'loss_val': 0.4326806994266865, 'psi': 0.586168736413024}-{'f1_val': 0.5863079300903425, 'auprc': 0.5863079300903425, 'loss_val': 0.3869465033096187, 'psi': 0.5863079300903425}
[S16] START round=39 head_norm_before_train=2.254333 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.09096722621902477, 'auprc': 0.09096722621902477, 'loss_val': 3.718028586424587, 'psi': 0.09096722621902477}-{'f1_val': 0.1586027185013029, 'auprc': 0.1586027185013029, 'loss_val': 2.9907654638029246, 'psi': 0.1586027185013029}
[S17] START round=39 head_norm_before_train=1.725886 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.040690 metrics={'f1_val': 0.27404667939840527, 'auprc': 0.27404667939840527, 'loss_val': 1.27458057464993, 'psi': 0.27404667939840527}-{'f1_val': 0.2649504389022128, 'auprc': 0.2649504389022128, 'loss_val': 1.274095127684468, 'psi': 0.2649504389022128}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:42016
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:42016
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.016 u=0.0000 p_local=0.0395 f1=0.016 auprc=0.016 bytes=0
[S3] r=40 psi=0.286 u=0.0000 p_local=0.0533 f1=0.286 auprc=0.286 bytes=25208
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0150 f1=0.359 auprc=0.359 bytes=35977
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0042 f1=0.332 auprc=0.332 bytes=25208
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0008 f1=0.360 auprc=0.360 bytes=18003
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.131 u=0.0000 p_local=0.0151 f1=0.131 auprc=0.131 bytes=0
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.9993
[S5] r=40 psi=0.334 u=0.0156 p_local=0.0104 f1=0.334 auprc=0.334 bytes=25191
[S17] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S17
[S16] cosine check vs S17: cos=-0.0963
[S16] DROPPED delta from S17 (cos=-0.0963 < 0.0)
[S10] r=40 psi=0.333 u=0.0000 p_local=0.0270 f1=0.333 auprc=0.333 bytes=34228
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.0910 head_norm=2.267570
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.259671e-02
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.0911 head_norm=2.264267 delta_norm=0.042597
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.091 u=0.0000 p_local=0.2266 f1=0.091 auprc=0.091 bytes=0
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0079 f1=0.357 auprc=0.357 bytes=28817
[S15] r=40 psi=0.586 u=0.0000 p_local=0.0324 f1=0.586 auprc=0.586 bytes=26988
[S17] r=40 psi=0.274 u=0.0407 p_local=0.0625 f1=0.274 auprc=0.274 bytes=34236
[S2] START round=40 head_norm_before_train=1.886118 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.2454789833822092, 'auprc': 0.2454789833822092, 'loss_val': 2.9985756980435956, 'psi': 0.2454789833822092}-{'f1_val': 0.24565908535094153, 'auprc': 0.24565908535094153, 'loss_val': 2.97521674613178, 'psi': 0.24565908535094153}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.713032 cos_to_last_merge=0.9999 (last merge round=37)
[S3] round=40 local utility u=0.035115 metrics={'f1_val': 0.3087425335505391, 'auprc': 0.3087425335505391, 'loss_val': 2.264720015889286, 'psi': 0.3087425335505391}-{'f1_val': 0.2862427087779201, 'auprc': 0.2862427087779201, 'loss_val': 2.132451419409446, 'psi': 0.2862427087779201}
[S4] START round=40 head_norm_before_train=1.782711 cos_to_last_merge=0.9560 (last merge round=24)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.071838736685727, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0606801004155169, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=2.261762 (no previous merge yet)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9920423140966887, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9447336402540825, 'psi': 0.3335071121394324}
[S6] START round=40 head_norm_before_train=1.809250 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.01576263328697265, 'auprc': 0.01576263328697265, 'loss_val': 6.847302938927929, 'psi': 0.01576263328697265}-{'f1_val': 0.016435185185185185, 'auprc': 0.016435185185185185, 'loss_val': 6.7845886706310035, 'psi': 0.016435185185185185}
[S7] START round=40 head_norm_before_train=1.950368 (no previous merge yet)
[S7] round=40 local utility u=0.016405 metrics={'f1_val': 0.24761904761904763, 'auprc': 0.24761904761904763, 'loss_val': 0.8219932399643386, 'psi': 0.24761904761904763}-{'f1_val': 0.24787180771156736, 'auprc': 0.24787180771156736, 'loss_val': 0.8570772154427277, 'psi': 0.24787180771156736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=40 head_norm_before_train=1.769169 cos_to_last_merge=0.9982 (last merge round=35)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9338518479051086, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8880092672240008, 'psi': 0.35939447907390915}
[S9] START round=40 head_norm_before_train=1.817280 cos_to_last_merge=0.9628 (last merge round=28)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2610829788847577, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.228443859932876, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.776972 cos_to_last_merge=0.9979 (last merge round=37)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.8954954715294552, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.818849496232489, 'psi': 0.33301496338745623}
[S11] START round=40 head_norm_before_train=2.035497 cos_to_last_merge=0.9933 (last merge round=28)
[S11] round=40 local utility u=0.003158 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.3317366535615904, 'psi': 0.33154997286190585}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.3408325366214977, 'psi': 0.33185875048506014}
[S13] START round=40 head_norm_before_train=2.015428 cos_to_last_merge=0.9915 (last merge round=29)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5151276325793406, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5012515883807778, 'psi': 0.3599362944611573}
[S14] START round=40 head_norm_before_train=2.027054 cos_to_last_merge=0.9932 (last merge round=29)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13152269583804854, 'auprc': 0.13152269583804854, 'loss_val': 5.021731834965529, 'psi': 0.13152269583804854}-{'f1_val': 0.1309164149043303, 'auprc': 0.1309164149043303, 'loss_val': 4.957206200617555, 'psi': 0.1309164149043303}
[S15] START round=40 head_norm_before_train=2.067022 cos_to_last_merge=0.9987 (last merge round=33)
[S15] round=40 local utility u=0.070112 metrics={'f1_val': 0.5878691315297063, 'auprc': 0.5878691315297063, 'loss_val': 0.3077603697278786, 'psi': 0.5878691315297063}-{'f1_val': 0.586168736413024, 'auprc': 0.586168736413024, 'loss_val': 0.4326806994266865, 'psi': 0.586168736413024}
[S16] START round=40 head_norm_before_train=2.264267 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.07600755150619716, 'auprc': 0.07600755150619716, 'loss_val': 3.9114017321288266, 'psi': 0.07600755150619716}-{'f1_val': 0.09096722621902477, 'auprc': 0.09096722621902477, 'loss_val': 3.718028586424587, 'psi': 0.09096722621902477}
[S17] START round=40 head_norm_before_train=1.740656 cos_to_last_merge=0.9999 (last merge round=38)
[S17] round=40 local utility u=0.754772 metrics={'f1_val': 0.43735018170564477, 'auprc': 0.43735018170564477, 'loss_val': 1.2347685674755657, 'psi': 0.43735018170564477}-{'f1_val': 0.27404667939840527, 'auprc': 0.27404667939840527, 'loss_val': 1.27458057464993, 'psi': 0.27404667939840527}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:42010
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:42007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.012 → S15@127.0.0.1:42015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:42014
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.437)
[S11] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S11
[S6] cosine check vs S11: cos=0.0755
[S9] RECEIVED delta(kind=head bytes=1803) from S3
[S9] cosine check vs S3: cos=0.9372
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] ⇄ pheromone p=0.004 → S6@127.0.0.1:42007
[S3] ⇄ pheromone p=0.050 → S9@127.0.0.1:42010
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=-0.1932
[S14] DROPPED delta from S15 (cos=-0.1932 < 0.0)
[S17] ⇄ pheromone p=0.201 → S16@127.0.0.1:42016
[S10] ⇄ pheromone p=0.022 → S3@127.0.0.1:42003
[S4] ⇄ pheromone p=0.006 → S10@127.0.0.1:42011
[S16] ⇄ pheromone p=0.181 → S17@127.0.0.1:42017
[S15] ⇄ pheromone p=0.040 → S14@127.0.0.1:42014
[S2] START round=41 head_norm_before_train=1.892450 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.24529914529914532, 'auprc': 0.24529914529914532, 'loss_val': 3.0236325310279293, 'psi': 0.24529914529914532}-{'f1_val': 0.2454789833822092, 'auprc': 0.2454789833822092, 'loss_val': 2.9985756980435956, 'psi': 0.2454789833822092}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.729091 cos_to_last_merge=0.9997 (last merge round=37)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.30812459858702634, 'auprc': 0.30812459858702634, 'loss_val': 2.3787768270472602, 'psi': 0.30812459858702634}-{'f1_val': 0.3087425335505391, 'auprc': 0.3087425335505391, 'loss_val': 2.264720015889286, 'psi': 0.3087425335505391}
[S4] START round=41 head_norm_before_train=1.789590 cos_to_last_merge=0.9547 (last merge round=24)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0890763884561598, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.071838736685727, 'psi': 0.3567939207526687}
[S5] START round=41 head_norm_before_train=2.271018 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0716193298947347, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9920423140966887, 'psi': 0.3335071121394324}
[S6] START round=41 head_norm_before_train=1.816482 (no previous merge yet)
[S6] round=41 local utility u=0.000016 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.861367462471526, 'psi': 0.01732902033271719}-{'f1_val': 0.01576263328697265, 'auprc': 0.01576263328697265, 'loss_val': 6.847302938927929, 'psi': 0.01576263328697265}
[S7] START round=41 head_norm_before_train=1.959653 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.24862705941088367, 'auprc': 0.24862705941088367, 'loss_val': 0.8323527912946294, 'psi': 0.2486270594108837}-{'f1_val': 0.24761904761904763, 'auprc': 0.24761904761904763, 'loss_val': 0.8219932399643386, 'psi': 0.24761904761904763}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.786434 cos_to_last_merge=0.9976 (last merge round=35)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0042375400182781, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9338518479051086, 'psi': 0.35939447907390915}
[S9] START round=41 head_norm_before_train=1.827277 cos_to_last_merge=0.9614 (last merge round=28)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2925226841863937, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2610829788847577, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=41 metric=0.3687 head_norm=1.836777
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.234037e-01
[S9] stored merged vector for next round verification (round=41)
[S9] DEBUG after merge:  round=41 metric=0.3687 head_norm=1.754184 delta_norm=0.323404
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] START round=41 head_norm_before_train=1.823039 cos_to_last_merge=0.9959 (last merge round=37)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9890216084970895, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.8954954715294552, 'psi': 0.33301496338745623}
[S11] START round=41 head_norm_before_train=2.045496 cos_to_last_merge=0.9928 (last merge round=28)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.33001466388824574, 'auprc': 0.33001466388824574, 'loss_val': 2.340548133648451, 'psi': 0.33001466388824574}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.3317366535615904, 'psi': 0.33154997286190585}
[S13] START round=41 head_norm_before_train=2.022194 cos_to_last_merge=0.9908 (last merge round=29)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5264930839103357, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5151276325793406, 'psi': 0.3599362944611573}
[S14] START round=41 head_norm_before_train=2.035715 cos_to_last_merge=0.9926 (last merge round=29)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13152269583804854, 'auprc': 0.13152269583804854, 'loss_val': 5.079946665434162, 'psi': 0.13152269583804854}-{'f1_val': 0.13152269583804854, 'auprc': 0.13152269583804854, 'loss_val': 5.021731834965529, 'psi': 0.13152269583804854}
[S15] START round=41 head_norm_before_train=2.080399 cos_to_last_merge=0.9984 (last merge round=33)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.5863753480460597, 'auprc': 0.5863753480460597, 'loss_val': 0.34292977420956117, 'psi': 0.5863753480460597}-{'f1_val': 0.5878691315297063, 'auprc': 0.5878691315297063, 'loss_val': 0.3077603697278786, 'psi': 0.5878691315297063}
[S16] START round=41 head_norm_before_train=2.277345 cos_to_last_merge=0.9999 (last merge round=39)
[S16] round=41 local utility u=0.155606 metrics={'f1_val': 0.09156895589056392, 'auprc': 0.09156895589056392, 'loss_val': 3.7402429208147336, 'psi': 0.09156895589056392}-{'f1_val': 0.07600755150619716, 'auprc': 0.07600755150619716, 'loss_val': 3.9114017321288266, 'psi': 0.07600755150619716}
[S17] START round=41 head_norm_before_train=1.756408 cos_to_last_merge=0.9997 (last merge round=38)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.28085996657204054, 'auprc': 0.28085996657204054, 'loss_val': 1.379329892460347, 'psi': 0.28085996657204054}-{'f1_val': 0.43735018170564477, 'auprc': 0.43735018170564477, 'loss_val': 1.2347685674755657, 'psi': 0.43735018170564477}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.017)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.0173 head_norm=1.821788
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.317250e+00
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.0173 head_norm=1.419977 delta_norm=1.317250
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.092)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.898683 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 3.045633789945949, 'psi': 0.24516443956312162}-{'f1_val': 0.24529914529914532, 'auprc': 0.24529914529914532, 'loss_val': 3.0236325310279293, 'psi': 0.24529914529914532}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.744824 cos_to_last_merge=0.9995 (last merge round=37)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.3028354764259809, 'auprc': 0.3028354764259809, 'loss_val': 2.448123532776501, 'psi': 0.3028354764259809}-{'f1_val': 0.30812459858702634, 'auprc': 0.30812459858702634, 'loss_val': 2.3787768270472602, 'psi': 0.30812459858702634}
[S4] START round=42 head_norm_before_train=1.799247 cos_to_last_merge=0.9530 (last merge round=24)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.108872342259524, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0890763884561598, 'psi': 0.3567939207526687}
[S5] START round=42 head_norm_before_train=2.281548 (no previous merge yet)
[S5] round=42 local utility u=0.030577 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0104658236924307, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0716193298947347, 'psi': 0.3335071121394324}
[S6] START round=42 head_norm_before_train=1.419977 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.03680709534368071, 'auprc': 0.03680709534368071, 'loss_val': 3.6352468154734257, 'psi': 0.03680709534368071}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.861367462471526, 'psi': 0.01732902033271719}
[S7] START round=42 head_norm_before_train=1.969984 (no previous merge yet)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.24856429463171037, 'auprc': 0.24856429463171037, 'loss_val': 0.9056952364182639, 'psi': 0.24856429463171037}-{'f1_val': 0.24862705941088367, 'auprc': 0.24862705941088367, 'loss_val': 0.8323527912946294, 'psi': 0.2486270594108837}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.803231 cos_to_last_merge=0.9970 (last merge round=35)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0842169918052722, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0042375400182781, 'psi': 0.35939447907390915}
[S9] START round=42 head_norm_before_train=1.754184 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=42 local utility u=0.168720 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9550834897792007, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2925226841863937, 'psi': 0.36867172340800847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=42 head_norm_before_train=1.863585 cos_to_last_merge=0.9939 (last merge round=37)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.0339508867996745, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9890216084970895, 'psi': 0.33301496338745623}
[S11] START round=42 head_norm_before_train=2.054916 cos_to_last_merge=0.9922 (last merge round=28)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3314728682170543, 'auprc': 0.3314728682170543, 'loss_val': 2.381833516390118, 'psi': 0.3314728682170543}-{'f1_val': 0.33001466388824574, 'auprc': 0.33001466388824574, 'loss_val': 2.340548133648451, 'psi': 0.33001466388824574}
[S13] START round=42 head_norm_before_train=2.028390 cos_to_last_merge=0.9903 (last merge round=29)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5321774014853329, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5264930839103357, 'psi': 0.3599362944611573}
[S14] START round=42 head_norm_before_train=2.043931 cos_to_last_merge=0.9921 (last merge round=29)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13152269583804854, 'auprc': 0.13152269583804854, 'loss_val': 5.133879633299242, 'psi': 0.13152269583804854}-{'f1_val': 0.13152269583804854, 'auprc': 0.13152269583804854, 'loss_val': 5.079946665434162, 'psi': 0.13152269583804854}
[S15] START round=42 head_norm_before_train=2.093359 cos_to_last_merge=0.9981 (last merge round=33)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.5863753480460597, 'auprc': 0.5863753480460597, 'loss_val': 0.35248487195588823, 'psi': 0.5863753480460597}-{'f1_val': 0.5863753480460597, 'auprc': 0.5863753480460597, 'loss_val': 0.34292977420956117, 'psi': 0.5863753480460597}
[S16] START round=42 head_norm_before_train=2.290107 cos_to_last_merge=0.9997 (last merge round=39)
[S16] round=42 local utility u=0.554932 metrics={'f1_val': 0.1540538620052583, 'auprc': 0.1540538620052583, 'loss_val': 3.1927429638005522, 'psi': 0.1540538620052583}-{'f1_val': 0.09156895589056392, 'auprc': 0.09156895589056392, 'loss_val': 3.7402429208147336, 'psi': 0.09156895589056392}
[S17] START round=42 head_norm_before_train=1.773169 cos_to_last_merge=0.9995 (last merge round=38)
[S17] round=42 local utility u=0.006736 metrics={'f1_val': 0.31637563216510584, 'auprc': 0.31637563216510584, 'loss_val': 1.685499024052568, 'psi': 0.31637563216510584}-{'f1_val': 0.28085996657204054, 'auprc': 0.28085996657204054, 'loss_val': 1.379329892460347, 'psi': 0.28085996657204054}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.037)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.154)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:42016
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=-0.0972
[S16] DROPPED delta from S17 (cos=-0.0972 < 0.0)
[S2] START round=43 head_norm_before_train=1.904912 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 3.061098419559226, 'psi': 0.24507471790179935}-{'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 3.045633789945949, 'psi': 0.24516443956312162}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.759352 cos_to_last_merge=0.9993 (last merge round=37)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.30003330003330003, 'auprc': 0.30003330003330003, 'loss_val': 2.501680659046246, 'psi': 0.30003330003330003}-{'f1_val': 0.3028354764259809, 'auprc': 0.3028354764259809, 'loss_val': 2.448123532776501, 'psi': 0.3028354764259809}
[S4] START round=43 head_norm_before_train=1.808376 cos_to_last_merge=0.9514 (last merge round=24)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1237391082185437, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.108872342259524, 'psi': 0.3567939207526687}
[S5] START round=43 head_norm_before_train=2.287436 (no previous merge yet)
[S5] round=43 local utility u=0.027463 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9555397230112477, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0104658236924307, 'psi': 0.3335071121394324}
[S6] START round=43 head_norm_before_train=1.442933 cos_to_last_merge=0.9996 (last merge round=41)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.006846081208687441, 'auprc': 0.006846081208687441, 'loss_val': 4.424752743728288, 'psi': 0.006846081208687441}-{'f1_val': 0.03680709534368071, 'auprc': 0.03680709534368071, 'loss_val': 3.6352468154734257, 'psi': 0.03680709534368071}
[S7] START round=43 head_norm_before_train=1.980977 (no previous merge yet)
[S7] round=43 local utility u=0.107416 metrics={'f1_val': 0.24749247743229688, 'auprc': 0.24749247743229688, 'loss_val': 0.681216083909716, 'psi': 0.24749247743229688}-{'f1_val': 0.24856429463171037, 'auprc': 0.24856429463171037, 'loss_val': 0.9056952364182639, 'psi': 0.24856429463171037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=43 head_norm_before_train=1.818947 cos_to_last_merge=0.9963 (last merge round=35)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1864076982587006, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0842169918052722, 'psi': 0.35939447907390915}
[S9] START round=43 head_norm_before_train=1.767538 cos_to_last_merge=0.9999 (last merge round=41)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9973825402481433, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9550834897792007, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.897846 cos_to_last_merge=0.9919 (last merge round=37)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.0754156999536235, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.0339508867996745, 'psi': 0.33301496338745623}
[S11] START round=43 head_norm_before_train=2.063615 cos_to_last_merge=0.9916 (last merge round=28)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.432881731600518, 'psi': 0.3317042898145993}-{'f1_val': 0.3314728682170543, 'auprc': 0.3314728682170543, 'loss_val': 2.381833516390118, 'psi': 0.3314728682170543}
[S13] START round=43 head_norm_before_train=2.035398 cos_to_last_merge=0.9896 (last merge round=29)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5560679064342564, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5321774014853329, 'psi': 0.3599362944611573}
[S14] START round=43 head_norm_before_train=2.051646 cos_to_last_merge=0.9916 (last merge round=29)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13152269583804854, 'auprc': 0.13152269583804854, 'loss_val': 5.183974711488595, 'psi': 0.13152269583804854}-{'f1_val': 0.13152269583804854, 'auprc': 0.13152269583804854, 'loss_val': 5.133879633299242, 'psi': 0.13152269583804854}
[S15] START round=43 head_norm_before_train=2.105111 cos_to_last_merge=0.9977 (last merge round=33)
[S15] round=43 local utility u=0.007089 metrics={'f1_val': 0.5867168747642452, 'auprc': 0.5867168747642452, 'loss_val': 0.34138128932716016, 'psi': 0.5867168747642452}-{'f1_val': 0.5863753480460597, 'auprc': 0.5863753480460597, 'loss_val': 0.35248487195588823, 'psi': 0.5863753480460597}
[S16] START round=43 head_norm_before_train=2.301735 cos_to_last_merge=0.9995 (last merge round=39)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.14763652061299373, 'auprc': 0.14763652061299373, 'loss_val': 3.35414001712259, 'psi': 0.14763652061299373}-{'f1_val': 0.1540538620052583, 'auprc': 0.1540538620052583, 'loss_val': 3.1927429638005522, 'psi': 0.1540538620052583}
[S17] START round=43 head_norm_before_train=1.787534 cos_to_last_merge=0.9992 (last merge round=38)
[S17] round=43 local utility u=0.068287 metrics={'f1_val': 0.32870526006464884, 'auprc': 0.32870526006464884, 'loss_val': 1.6598926580267195, 'psi': 0.32870526006464884}-{'f1_val': 0.31637563216510584, 'auprc': 0.31637563216510584, 'loss_val': 1.685499024052568, 'psi': 0.31637563216510584}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.334)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:42014
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.329)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=-0.1906
[S14] DROPPED delta from S15 (cos=-0.1906 < 0.0)
[S2] START round=44 head_norm_before_train=1.910845 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 3.0761380728672014, 'psi': 0.24507471790179935}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 3.061098419559226, 'psi': 0.24507471790179935}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.773088 cos_to_last_merge=0.9990 (last merge round=37)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.2997416020671835, 'auprc': 0.2997416020671835, 'loss_val': 2.5369098720850376, 'psi': 0.2997416020671835}-{'f1_val': 0.30003330003330003, 'auprc': 0.30003330003330003, 'loss_val': 2.501680659046246, 'psi': 0.30003330003330003}
[S4] START round=44 head_norm_before_train=1.819076 cos_to_last_merge=0.9499 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.950
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1464748958705138, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1237391082185437, 'psi': 0.3567939207526687}
[S5] START round=44 head_norm_before_train=2.294681 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9576859821000268, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9555397230112477, 'psi': 0.3335071121394324}
[S6] START round=44 head_norm_before_train=1.475541 cos_to_last_merge=0.9982 (last merge round=41)
[S6] round=44 local utility u=0.416433 metrics={'f1_val': 0.07315079689415611, 'auprc': 0.07315079689415611, 'loss_val': 4.1886295349874425, 'psi': 0.07315079689415611}-{'f1_val': 0.006846081208687441, 'auprc': 0.006846081208687441, 'loss_val': 4.424752743728288, 'psi': 0.006846081208687441}
[S7] START round=44 head_norm_before_train=1.996934 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.24950248756218907, 'auprc': 0.24950248756218907, 'loss_val': 0.7305875588005079, 'psi': 0.24950248756218907}-{'f1_val': 0.24749247743229688, 'auprc': 0.24749247743229688, 'loss_val': 0.681216083909716, 'psi': 0.24749247743229688}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.835551 cos_to_last_merge=0.9956 (last merge round=35)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2587241346329976, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1864076982587006, 'psi': 0.35939447907390915}
[S9] START round=44 head_norm_before_train=1.784938 cos_to_last_merge=0.9997 (last merge round=41)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0428406611799814, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9973825402481433, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.926095 cos_to_last_merge=0.9903 (last merge round=37)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.1041377626365305, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.0754156999536235, 'psi': 0.33301496338745623}
[S11] START round=44 head_norm_before_train=2.071792 cos_to_last_merge=0.9911 (last merge round=28)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.4606131219967864, 'psi': 0.3317042898145993}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.432881731600518, 'psi': 0.3317042898145993}
[S13] START round=44 head_norm_before_train=2.040484 cos_to_last_merge=0.9891 (last merge round=29)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5785883476056606, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5560679064342564, 'psi': 0.3599362944611573}
[S14] START round=44 head_norm_before_train=2.058943 cos_to_last_merge=0.9911 (last merge round=29)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 5.228563125725584, 'psi': 0.13172448466566114}-{'f1_val': 0.13152269583804854, 'auprc': 0.13152269583804854, 'loss_val': 5.183974711488595, 'psi': 0.13152269583804854}
[S15] START round=44 head_norm_before_train=2.115598 cos_to_last_merge=0.9975 (last merge round=33)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.586168736413024, 'auprc': 0.586168736413024, 'loss_val': 0.46460857289067087, 'psi': 0.586168736413024}-{'f1_val': 0.5867168747642452, 'auprc': 0.5867168747642452, 'loss_val': 0.34138128932716016, 'psi': 0.5867168747642452}
[S16] START round=44 head_norm_before_train=2.312644 cos_to_last_merge=0.9992 (last merge round=39)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.12144585601935874, 'auprc': 0.12144585601935874, 'loss_val': 3.804558420525442, 'psi': 0.12144585601935874}-{'f1_val': 0.14763652061299373, 'auprc': 0.14763652061299373, 'loss_val': 3.35414001712259, 'psi': 0.14763652061299373}
[S17] START round=44 head_norm_before_train=1.798175 cos_to_last_merge=0.9990 (last merge round=38)
[S17] round=44 local utility u=0.156105 metrics={'f1_val': 0.3252939339077061, 'auprc': 0.3252939339077061, 'loss_val': 1.3169809015661424, 'psi': 0.3252939339077061}-{'f1_val': 0.32870526006464884, 'auprc': 0.32870526006464884, 'loss_val': 1.6598926580267195, 'psi': 0.32870526006464884}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.073)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:42016
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=-0.0985
[S16] DROPPED delta from S17 (cos=-0.0985 < 0.0)
[S2] START round=45 head_norm_before_train=1.916763 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.0890517187442605, 'psi': 0.2450298816928894}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 3.0761380728672014, 'psi': 0.24507471790179935}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.786113 cos_to_last_merge=0.9987 (last merge round=37)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.29693148381672974, 'auprc': 0.29693148381672974, 'loss_val': 2.5764860891125667, 'psi': 0.29693148381672974}-{'f1_val': 0.2997416020671835, 'auprc': 0.2997416020671835, 'loss_val': 2.5369098720850376, 'psi': 0.2997416020671835}
[S4] START round=45 head_norm_before_train=1.830321 cos_to_last_merge=0.9482 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.948
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1759032214174148, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1464748958705138, 'psi': 0.3567939207526687}
[S5] START round=45 head_norm_before_train=2.296811 (no previous merge yet)
[S5] round=45 local utility u=0.022743 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9122008673664252, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9576859821000268, 'psi': 0.3335071121394324}
[S6] START round=45 head_norm_before_train=1.512211 cos_to_last_merge=0.9958 (last merge round=41)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 4.980987173615104, 'psi': 0.021310724106324473}-{'f1_val': 0.07315079689415611, 'auprc': 0.07315079689415611, 'loss_val': 4.1886295349874425, 'psi': 0.07315079689415611}
[S7] START round=45 head_norm_before_train=2.003476 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.8015518230012167, 'psi': 0.2491280518186348}-{'f1_val': 0.24950248756218907, 'auprc': 0.24950248756218907, 'loss_val': 0.7305875588005079, 'psi': 0.24950248756218907}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.850472 cos_to_last_merge=0.9950 (last merge round=35)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3372749244143838, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2587241346329976, 'psi': 0.35939447907390915}
[S9] START round=45 head_norm_before_train=1.802322 cos_to_last_merge=0.9992 (last merge round=41)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.085434666665441, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0428406611799814, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.950516 cos_to_last_merge=0.9888 (last merge round=37)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.1430567571671926, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.1041377626365305, 'psi': 0.33301496338745623}
[S11] START round=45 head_norm_before_train=2.079714 cos_to_last_merge=0.9906 (last merge round=28)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.470313740820685, 'psi': 0.33154997286190585}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.4606131219967864, 'psi': 0.3317042898145993}
[S13] START round=45 head_norm_before_train=2.045061 cos_to_last_merge=0.9886 (last merge round=29)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5850035773406201, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5785883476056606, 'psi': 0.3599362944611573}
[S14] START round=45 head_norm_before_train=2.065880 cos_to_last_merge=0.9907 (last merge round=29)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13212760612911328, 'auprc': 0.13212760612911328, 'loss_val': 5.273648951302938, 'psi': 0.13212760612911328}-{'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 5.228563125725584, 'psi': 0.13172448466566114}
[S15] START round=45 head_norm_before_train=2.125545 cos_to_last_merge=0.9972 (last merge round=33)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.586168736413024, 'auprc': 0.586168736413024, 'loss_val': 0.46658044585336045, 'psi': 0.586168736413024}-{'f1_val': 0.586168736413024, 'auprc': 0.586168736413024, 'loss_val': 0.46460857289067087, 'psi': 0.586168736413024}
[S16] START round=45 head_norm_before_train=2.322826 cos_to_last_merge=0.9989 (last merge round=39)
[S16] round=45 local utility u=0.092945 metrics={'f1_val': 0.1341895482728078, 'auprc': 0.1341895482728078, 'loss_val': 3.733361537679349, 'psi': 0.1341895482728078}-{'f1_val': 0.12144585601935874, 'auprc': 0.12144585601935874, 'loss_val': 3.804558420525442, 'psi': 0.12144585601935874}
[S17] START round=45 head_norm_before_train=1.808373 cos_to_last_merge=0.9988 (last merge round=38)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.34651644480134386, 'auprc': 0.34651644480134386, 'loss_val': 1.6674942423379675, 'psi': 0.34651644480134386}-{'f1_val': 0.3252939339077061, 'auprc': 0.3252939339077061, 'loss_val': 1.3169809015661424, 'psi': 0.3252939339077061}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.016 → S9@127.0.0.1:42010
[S16] not sending this round → trigger blocked (psi=0.134)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.001 → S6@127.0.0.1:42007
[S14] ⇄ pheromone p=0.004 → S15@127.0.0.1:42015
[S6] ⇄ pheromone p=0.179 → S11@127.0.0.1:42012
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.002 → S10@127.0.0.1:42011
[S16] ⇄ pheromone p=0.148 → S17@127.0.0.1:42017
[S10] ⇄ pheromone p=0.007 → S3@127.0.0.1:42003
[S15] ⇄ pheromone p=0.014 → S11@127.0.0.1:42012
[S17] ⇄ pheromone p=0.100 → S16@127.0.0.1:42016
[S2] START round=46 head_norm_before_train=1.922336 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.1003726458558147, 'psi': 0.2450298816928894}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.0890517187442605, 'psi': 0.2450298816928894}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.798453 cos_to_last_merge=0.9985 (last merge round=37)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.2933196826209368, 'auprc': 0.2933196826209368, 'loss_val': 2.62555261655065, 'psi': 0.2933196826209368}-{'f1_val': 0.29693148381672974, 'auprc': 0.29693148381672974, 'loss_val': 2.5764860891125667, 'psi': 0.29693148381672974}
[S4] START round=46 head_norm_before_train=1.839702 cos_to_last_merge=0.9469 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.188033332157248, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1759032214174148, 'psi': 0.3567939207526687}
[S5] START round=46 head_norm_before_train=2.300811 (no previous merge yet)
[S5] round=46 local utility u=0.040242 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8317170397781104, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9122008673664252, 'psi': 0.3335071121394324}
[S6] START round=46 head_norm_before_train=1.544532 cos_to_last_merge=0.9931 (last merge round=41)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.304604931050424, 'psi': 0.01732902033271719}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 4.980987173615104, 'psi': 0.021310724106324473}
[S7] START round=46 head_norm_before_train=2.005751 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.24711200401808137, 'auprc': 0.24711200401808137, 'loss_val': 0.9293628599591419, 'psi': 0.24711200401808137}-{'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.8015518230012167, 'psi': 0.2491280518186348}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.865092 cos_to_last_merge=0.9944 (last merge round=35)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.415722156841357, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3372749244143838, 'psi': 0.35939447907390915}
[S9] START round=46 head_norm_before_train=1.818298 cos_to_last_merge=0.9987 (last merge round=41)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1182416208523804, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.085434666665441, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.971039 cos_to_last_merge=0.9876 (last merge round=37)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.1852329701793023, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.1430567571671926, 'psi': 0.33301496338745623}
[S11] START round=46 head_norm_before_train=2.087210 cos_to_last_merge=0.9901 (last merge round=28)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.496456147650588, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.470313740820685, 'psi': 0.33154997286190585}
[S13] START round=46 head_norm_before_train=2.049989 cos_to_last_merge=0.9882 (last merge round=29)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5909052791854768, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5850035773406201, 'psi': 0.3599362944611573}
[S14] START round=46 head_norm_before_train=2.072350 cos_to_last_merge=0.9903 (last merge round=29)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.314741457160098, 'psi': 0.13253012048192772}-{'f1_val': 0.13212760612911328, 'auprc': 0.13212760612911328, 'loss_val': 5.273648951302938, 'psi': 0.13212760612911328}
[S15] START round=46 head_norm_before_train=2.135434 cos_to_last_merge=0.9969 (last merge round=33)
[S15] round=46 local utility u=0.054785 metrics={'f1_val': 0.5863753480460597, 'auprc': 0.5863753480460597, 'loss_val': 0.35887072817466104, 'psi': 0.5863753480460597}-{'f1_val': 0.586168736413024, 'auprc': 0.586168736413024, 'loss_val': 0.46658044585336045, 'psi': 0.586168736413024}
[S16] START round=46 head_norm_before_train=2.332052 cos_to_last_merge=0.9985 (last merge round=39)
[S16] round=46 local utility u=0.885937 metrics={'f1_val': 0.1928407224958949, 'auprc': 0.1928407224958949, 'loss_val': 2.489348866422244, 'psi': 0.1928407224958949}-{'f1_val': 0.1341895482728078, 'auprc': 0.1341895482728078, 'loss_val': 3.733361537679349, 'psi': 0.1341895482728078}
[S17] START round=46 head_norm_before_train=1.821108 cos_to_last_merge=0.9985 (last merge round=38)
[S17] round=46 local utility u=0.468387 metrics={'f1_val': 0.43393306592908154, 'auprc': 0.43393306592908154, 'loss_val': 1.5174689148271694, 'psi': 0.43393306592908154}-{'f1_val': 0.34651644480134386, 'auprc': 0.34651644480134386, 'loss_val': 1.6674942423379675, 'psi': 0.34651644480134386}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.334)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:42012
[S16] not sending this round → trigger blocked (psi=0.193)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:42016
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S15
[S11] cosine check vs S15: cos=0.9879
[S16] RECEIVED delta(kind=head bytes=1803) from S17
[S16] cosine check vs S17: cos=-0.0996
[S16] DROPPED delta from S17 (cos=-0.0996 < 0.0)
[S2] START round=47 head_norm_before_train=1.927670 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.112339813999571, 'psi': 0.2450298816928894}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.1003726458558147, 'psi': 0.2450298816928894}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.809984 cos_to_last_merge=0.9982 (last merge round=37)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.2929553264604811, 'auprc': 0.2929553264604811, 'loss_val': 2.67396684108411, 'psi': 0.2929553264604811}-{'f1_val': 0.2933196826209368, 'auprc': 0.2933196826209368, 'loss_val': 2.62555261655065, 'psi': 0.2933196826209368}
[S4] START round=47 head_norm_before_train=1.846014 cos_to_last_merge=0.9460 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=47 local utility u=0.000508 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1870178882131843, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.188033332157248, 'psi': 0.3567939207526687}
[S5] START round=47 head_norm_before_train=2.305831 (no previous merge yet)
[S5] round=47 local utility u=0.041162 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.74939250300664, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8317170397781104, 'psi': 0.3335071121394324}
[S6] START round=47 head_norm_before_train=1.572009 cos_to_last_merge=0.9905 (last merge round=41)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 5.350007913451195, 'psi': 0.01799723119520074}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.304604931050424, 'psi': 0.01732902033271719}
[S7] START round=47 head_norm_before_train=2.010311 (no previous merge yet)
[S7] round=47 local utility u=0.072046 metrics={'f1_val': 0.24723895582329317, 'auprc': 0.24723895582329317, 'loss_val': 0.7864128394595095, 'psi': 0.24723895582329317}-{'f1_val': 0.24711200401808137, 'auprc': 0.24711200401808137, 'loss_val': 0.9293628599591419, 'psi': 0.24711200401808137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=47 head_norm_before_train=1.879666 cos_to_last_merge=0.9938 (last merge round=35)
[S8] round=47 local utility u=0.035642 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.344437203694731, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.415722156841357, 'psi': 0.35939447907390915}
[S9] START round=47 head_norm_before_train=1.832465 cos_to_last_merge=0.9981 (last merge round=41)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1558369605809635, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1182416208523804, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.989438 cos_to_last_merge=0.9864 (last merge round=37)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2201795098316803, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.1852329701793023, 'psi': 0.33301496338745623}
[S11] START round=47 head_norm_before_train=2.094501 cos_to_last_merge=0.9896 (last merge round=28)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.54167889111073, 'psi': 0.3317042898145993}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.496456147650588, 'psi': 0.33154997286190585}
[S13] START round=47 head_norm_before_train=2.055372 cos_to_last_merge=0.9878 (last merge round=29)
[S13] round=47 local utility u=0.000335 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5902358743398752, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5909052791854768, 'psi': 0.3599362944611573}
[S14] START round=47 head_norm_before_train=2.078642 cos_to_last_merge=0.9898 (last merge round=29)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.356041472292137, 'psi': 0.13253012048192772}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.314741457160098, 'psi': 0.13253012048192772}
[S15] START round=47 head_norm_before_train=2.144877 cos_to_last_merge=0.9966 (last merge round=33)
[S15] round=47 local utility u=0.135257 metrics={'f1_val': 0.6091072227208228, 'auprc': 0.6091072227208228, 'loss_val': 0.29294440041037606, 'psi': 0.6091072227208228}-{'f1_val': 0.5863753480460597, 'auprc': 0.5863753480460597, 'loss_val': 0.35887072817466104, 'psi': 0.5863753480460597}
[S16] START round=47 head_norm_before_train=2.340235 cos_to_last_merge=0.9983 (last merge round=39)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.10904872389791183, 'auprc': 0.10904872389791183, 'loss_val': 3.9674867420648625, 'psi': 0.10904872389791181}-{'f1_val': 0.1928407224958949, 'auprc': 0.1928407224958949, 'loss_val': 2.489348866422244, 'psi': 0.1928407224958949}
[S17] START round=47 head_norm_before_train=1.830793 cos_to_last_merge=0.9983 (last merge round=38)
[S17] round=47 local utility u=0.753841 metrics={'f1_val': 0.5694663568139178, 'auprc': 0.5694663568139178, 'loss_val': 1.2295874450461388, 'psi': 0.5694663568139178}-{'f1_val': 0.43393306592908154, 'auprc': 0.43393306592908154, 'loss_val': 1.5174689148271694, 'psi': 0.43393306592908154}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.609)
[S17] not sending this round → trigger blocked (psi=0.569)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=47 metric=0.3317 head_norm=2.101417
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.690492e-01
[S11] stored merged vector for next round verification (round=47)
[S11] DEBUG after merge:  round=47 metric=0.3317 head_norm=2.116518 delta_norm=0.169049
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:42011
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] cosine check vs S4: cos=-0.0534
[S10] DROPPED delta from S4 (cos=-0.0534 < 0.0)
[S2] START round=48 head_norm_before_train=1.932975 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.1237500504345537, 'psi': 0.2450298816928894}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.112339813999571, 'psi': 0.2450298816928894}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.820998 cos_to_last_merge=0.9979 (last merge round=37)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.2929214929214929, 'auprc': 0.2929214929214929, 'loss_val': 2.694501830755871, 'psi': 0.2929214929214929}-{'f1_val': 0.2929553264604811, 'auprc': 0.2929553264604811, 'loss_val': 2.67396684108411, 'psi': 0.2929553264604811}
[S4] START round=48 head_norm_before_train=1.852766 cos_to_last_merge=0.9451 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1937351441120274, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1870178882131843, 'psi': 0.3567939207526687}
[S5] START round=48 head_norm_before_train=2.314984 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8253267514863483, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.74939250300664, 'psi': 0.3335071121394324}
[S6] START round=48 head_norm_before_train=1.597845 cos_to_last_merge=0.9880 (last merge round=41)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.556140319092818, 'psi': 0.017774699907663897}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 5.350007913451195, 'psi': 0.01799723119520074}
[S7] START round=48 head_norm_before_train=2.025305 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.24856429463171037, 'auprc': 0.24856429463171037, 'loss_val': 0.9225226310855913, 'psi': 0.24856429463171037}-{'f1_val': 0.24723895582329317, 'auprc': 0.24723895582329317, 'loss_val': 0.7864128394595095, 'psi': 0.24723895582329317}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.892757 cos_to_last_merge=0.9932 (last merge round=35)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3626666325687213, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.344437203694731, 'psi': 0.35939447907390915}
[S9] START round=48 head_norm_before_train=1.845594 cos_to_last_merge=0.9976 (last merge round=41)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.193477568759088, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1558369605809635, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.005937 cos_to_last_merge=0.9854 (last merge round=37)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.241783105735072, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2201795098316803, 'psi': 0.33301496338745623}
[S11] START round=48 head_norm_before_train=2.116518 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=48 local utility u=0.039176 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.464716845781712, 'psi': 0.33185875048506014}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.54167889111073, 'psi': 0.3317042898145993}
[S13] START round=48 head_norm_before_train=2.059557 cos_to_last_merge=0.9875 (last merge round=29)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5943052899351295, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5902358743398752, 'psi': 0.3599362944611573}
[S14] START round=48 head_norm_before_train=2.084788 cos_to_last_merge=0.9894 (last merge round=29)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.397083180626315, 'psi': 0.13253012048192772}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.356041472292137, 'psi': 0.13253012048192772}
[S15] START round=48 head_norm_before_train=2.154052 cos_to_last_merge=0.9963 (last merge round=33)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.5861013484608475, 'auprc': 0.5861013484608475, 'loss_val': 0.49492957265903276, 'psi': 0.5861013484608475}-{'f1_val': 0.6091072227208228, 'auprc': 0.6091072227208228, 'loss_val': 0.29294440041037606, 'psi': 0.6091072227208228}
[S16] START round=48 head_norm_before_train=2.347609 cos_to_last_merge=0.9980 (last merge round=39)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.06309254132058058, 'auprc': 0.06309254132058058, 'loss_val': 4.660097703333201, 'psi': 0.06309254132058058}-{'f1_val': 0.10904872389791183, 'auprc': 0.10904872389791183, 'loss_val': 3.9674867420648625, 'psi': 0.10904872389791181}
[S17] START round=48 head_norm_before_train=1.841331 cos_to_last_merge=0.9980 (last merge round=38)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.47892538314067157, 'auprc': 0.47892538314067157, 'loss_val': 1.4553887444263205, 'psi': 0.47892538314067157}-{'f1_val': 0.5694663568139178, 'auprc': 0.5694663568139178, 'loss_val': 1.2295874450461388, 'psi': 0.5694663568139178}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:42007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1803 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1803) from S11
[S6] cosine check vs S11: cos=0.6841
[S2] START round=49 head_norm_before_train=1.938107 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.13522963114329, 'psi': 0.2450298816928894}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.1237500504345537, 'psi': 0.2450298816928894}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.831424 cos_to_last_merge=0.9976 (last merge round=37)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.2929214929214929, 'auprc': 0.2929214929214929, 'loss_val': 2.720295490818081, 'psi': 0.2929214929214929}-{'f1_val': 0.2929214929214929, 'auprc': 0.2929214929214929, 'loss_val': 2.694501830755871, 'psi': 0.2929214929214929}
[S4] START round=49 head_norm_before_train=1.861049 cos_to_last_merge=0.9439 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2022107024685984, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1937351441120274, 'psi': 0.3567939207526687}
[S5] START round=49 head_norm_before_train=2.321920 (no previous merge yet)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.910183702434764, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8253267514863483, 'psi': 0.3335071121394324}
[S6] START round=49 head_norm_before_train=1.622273 cos_to_last_merge=0.9856 (last merge round=41)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.769799698519269, 'psi': 0.017551963048498844}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.556140319092818, 'psi': 0.017774699907663897}
[S7] START round=49 head_norm_before_train=2.032648 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.9317810477557551, 'psi': 0.2490655370047346}-{'f1_val': 0.24856429463171037, 'auprc': 0.24856429463171037, 'loss_val': 0.9225226310855913, 'psi': 0.24856429463171037}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.904814 cos_to_last_merge=0.9927 (last merge round=35)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4168755628342078, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3626666325687213, 'psi': 0.35939447907390915}
[S9] START round=49 head_norm_before_train=1.857663 cos_to_last_merge=0.9970 (last merge round=41)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.229135994854861, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.193477568759088, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.021388 cos_to_last_merge=0.9844 (last merge round=37)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2640183063563333, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.241783105735072, 'psi': 0.33301496338745623}
[S11] START round=49 head_norm_before_train=2.123134 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.466207692534069, 'psi': 0.3317042898145993}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.464716845781712, 'psi': 0.33185875048506014}
[S13] START round=49 head_norm_before_train=2.063268 cos_to_last_merge=0.9871 (last merge round=29)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5959548964395138, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5943052899351295, 'psi': 0.3599362944611573}
[S14] START round=49 head_norm_before_train=2.090728 cos_to_last_merge=0.9890 (last merge round=29)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.434483991419933, 'psi': 0.13253012048192772}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.397083180626315, 'psi': 0.13253012048192772}
[S15] START round=49 head_norm_before_train=2.162508 cos_to_last_merge=0.9960 (last merge round=33)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.5861013484608475, 'auprc': 0.5861013484608475, 'loss_val': 0.5189081311129661, 'psi': 0.5861013484608475}-{'f1_val': 0.5861013484608475, 'auprc': 0.5861013484608475, 'loss_val': 0.49492957265903276, 'psi': 0.5861013484608475}
[S16] START round=49 head_norm_before_train=2.354379 cos_to_last_merge=0.9977 (last merge round=39)
[S16] round=49 local utility u=1.000000 metrics={'f1_val': 0.2459025955088947, 'auprc': 0.2459025955088947, 'loss_val': 2.139012846430033, 'psi': 0.2459025955088947}-{'f1_val': 0.06309254132058058, 'auprc': 0.06309254132058058, 'loss_val': 4.660097703333201, 'psi': 0.06309254132058058}
[S17] START round=49 head_norm_before_train=1.852666 cos_to_last_merge=0.9977 (last merge round=38)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.3313551682692308, 'auprc': 0.3313551682692308, 'loss_val': 1.8160884429395894, 'psi': 0.3313551682692308}-{'f1_val': 0.47892538314067157, 'auprc': 0.47892538314067157, 'loss_val': 1.4553887444263205, 'psi': 0.47892538314067157}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.0176 head_norm=1.646193
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.888883e-01
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.0176 head_norm=1.728143 delta_norm=0.788888
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:42017
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S16
[S17] cosine check vs S16: cos=-0.0996
[S17] DROPPED delta from S16 (cos=-0.0996 < 0.0)
[runner] rounds complete.
[runner] all agents stopped.
