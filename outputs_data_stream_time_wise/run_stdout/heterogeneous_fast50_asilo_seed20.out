[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:49303
[S3] → join 127.0.0.1:49302
[S4] → join 127.0.0.1:49302
[S5] → join 127.0.0.1:49302
[S6] → join 127.0.0.1:49302
[S7] → join 127.0.0.1:49302
[S8] → join 127.0.0.1:49302
[S9] → join 127.0.0.1:49302
[S10] → join 127.0.0.1:49302
[S11] → join 127.0.0.1:49302
[S13] → join 127.0.0.1:49302
[S14] → join 127.0.0.1:49302
[S15] → join 127.0.0.1:49302
[S16] → join 127.0.0.1:49302
[S17] → join 127.0.0.1:49302
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.145255 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.138187 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.176279 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.239314 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.178103 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.147692 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.173754 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.156425 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.145273 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.192794 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.110839 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.145146 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.187915 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.214290 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.189333 (no previous merge yet)
[S8]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3] + discovered S15
[S3] + discovered S10
[S3] + discovered S5
[S3] + discovered S8
[S3] + discovered S14
[S3] + discovered S4
[S3] + discovered S9
[S3] + discovered S11
[S3] + discovered S16
[S3] + discovered S17
[S3] + discovered S13
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S7
[S3] + discovered S6
[S5] + discovered S4
[S5] + discovered S3
[S5] + discovered S2
[S4] + discovered S17
[S4] + discovered S5
[S4] + discovered S10
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S8
[S4] + discovered S11
[S4] + discovered S9
[S4] + discovered S16
[S4] + discovered S7
[S4] + discovered S13
[S6] + discovered S3
[S6] + discovered S2
[S6] + discovered S4
[S6] + discovered S5
[S5] + discovered S16
[S5] + discovered S8
[S5] + discovered S11
[S5] + discovered S14
[S5] + discovered S15
[S5] + discovered S7
[S5] + discovered S13
[S5] + discovered S17
[S5] + discovered S9
[S5] + discovered S6
[S5] + discovered S10
[S6] + discovered S9
[S6] + discovered S13
[S6] + discovered S7
[S6] + discovered S14
[S6] + discovered S8
[S6] + discovered S10
[S6] + discovered S17
[S6] + discovered S15
[S6] + discovered S11
[S6] + discovered S16
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S4
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S3
[S8] + discovered S2
[S7] + discovered S16
[S7] + discovered S17
[S7] + discovered S11
[S7] + discovered S15
[S7] + discovered S10
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S13
[S7] + discovered S9
[S9] + discovered S2
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S8
[S9] + discovered S6
[S8] + discovered S13
[S8] + discovered S10
[S8] + discovered S11
[S8] + discovered S9
[S8] + discovered S14
[S8] + discovered S15
[S8] + discovered S17
[S8] + discovered S16
[S9] + discovered S15
[S9] + discovered S14
[S9] + discovered S17
[S10] + discovered S2
[S9] + discovered S11
[S9] + discovered S16
[S9] + discovered S10
[S10] + discovered S6
[S10] + discovered S8
[S10] + discovered S4
[S10] + discovered S5
[S10] + discovered S7
[S10] + discovered S3
[S9] + discovered S13
[S10] + discovered S9
[S10] + discovered S17
[S10] + discovered S11
[S10] + discovered S16
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S13
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S5
[S11] + discovered S3
[S11] + discovered S10
[S11] + discovered S4
[S11] + discovered S7
[S11] + discovered S2
[S11] + discovered S9
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S13
[S13] + discovered S2
[S13] + discovered S11
[S13] + discovered S7
[S13] + discovered S10
[S13] + discovered S9
[S13] + discovered S6
[S11] + discovered S16
[S13] + discovered S8
[S13] + discovered S5
[S11] + discovered S17
[S13] + discovered S3
[S13] + discovered S4
[S14] + discovered S13
[S14] + discovered S8
[S14] + discovered S2
[S14] + discovered S6
[S14] + discovered S3
[S14] + discovered S7
[S14] + discovered S5
[S14] + discovered S9
[S14] + discovered S10
[S14] + discovered S4
[S14] + discovered S11
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S14
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S5
[S15] + discovered S7
[S15] + discovered S3
[S15] + discovered S11
[S15] + discovered S8
[S15] + discovered S4
[S15] + discovered S14
[S15] + discovered S2
[S15] + discovered S6
[S15] + discovered S13
[S14] + discovered S15
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S16
[S16] + discovered S6
[S16] + discovered S10
[S15] + discovered S17
[S16] + discovered S2
[S16] + discovered S4
[S16] + discovered S11
[S16] + discovered S8
[S16] + discovered S3
[S16] + discovered S7
[S16] + discovered S15
[S16] + discovered S9
[S16] + discovered S5
[S16] + discovered S13
[S16] + discovered S14
[S17] + discovered S6
[S17] + discovered S10
[S17] + discovered S5
[S17] + discovered S13
[S17] + discovered S9
[S17] + discovered S7
[S17] + discovered S3
[S17] + discovered S11
[S17] + discovered S8
[S17] + discovered S4
[S17] + discovered S16
[S17] + discovered S14
[S17] + discovered S2
[S16] + discovered S17
[S17] + discovered S15
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:49309
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:49305
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:49316
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:49302
[S7] ⇄ pheromone p=1.000 → S3@127.0.0.1:49303
[S8] ⇄ pheromone p=1.000 → S9@127.0.0.1:49310
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:49309
[S2] ⇄ pheromone p=1.000 → S15@127.0.0.1:49315
[S11] ⇄ pheromone p=1.000 → S15@127.0.0.1:49315
[S10] ⇄ pheromone p=1.000 → S9@127.0.0.1:49310
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:49314
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:49312
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:49311
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:49316
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:49303
[S2] START round=1 head_norm_before_train=1.158342 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9482003727501493, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4931026825392832, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.142104 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5468348562837824, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4651115613399628, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.189025 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5204055734121253, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.45695369374916, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.242219 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4508468798258487, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4009532569719718, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.212252 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.016367808748943, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5435050780810307, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.150722 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4383962356478004, 'psi': 0.0}-{'f1_val': 0.0002486325211337643, 'auprc': 0.0002486325211337643, 'loss_val': 1.4034714046709522, 'psi': 0.0002486325211337643}
[S8] START round=1 head_norm_before_train=1.189569 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5321153230723306, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3712094906948826, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.163241 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.563509139294327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4711696805410317, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.161915 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6755293268316582, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4802561750409884, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.202330 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5015922953566254, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4260333813585944, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.115488 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4829596062910482, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3691256845056554, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.155652 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5455411475880836, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4603202001960303, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.218071 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9056386644119443, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5897806074797645, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.220836 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5370981541456399, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4793464018983795, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.209671 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6989350007969501, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5189122202505725, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.203738 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6890834330917994, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9482003727501493, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.160478 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7056230271304962, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5468348562837824, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.227249 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.746632033308568, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5204055734121253, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.255187 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.553263437897722, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4508468798258487, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.275859 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.255241025912799, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.016367808748943, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.168549 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5063547685472234, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4383962356478004, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.230125 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8690101393804848, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5321153230723306, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.181770 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7374831955394818, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.563509139294327, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.209804 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9711916823754063, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6755293268316582, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.223892 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6535039721971818, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5015922953566254, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.150560 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9064748433195826, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4829596062910482, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.179251 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.694984357614631, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5455411475880836, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.269878 (no previous merge yet)
[S15] round=2 local utility u=0.022666 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8603059010479583, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9056386644119443, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.240051 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6434326665499768, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5370981541456399, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.252191 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9466715981436822, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6989350007969501, 'psi': 0.0}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.247324 (no previous merge yet)
[S2] round=3 local utility u=0.049065 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5909538331099187, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6890834330917994, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.191928 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1660281334904625, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7056230271304962, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.282450 (no previous merge yet)
[S4] round=3 local utility u=0.036077 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.674479014133503, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.746632033308568, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.275830 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7798268664379078, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.553263437897722, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.343234 (no previous merge yet)
[S6] round=3 local utility u=0.266633 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7219756791372194, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.255241025912799, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.194802 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7359928465193892, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5063547685472234, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.265955 (no previous merge yet)
[S8] round=3 local utility u=0.119922 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6291656457297068, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8690101393804848, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.209591 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.165089157363398, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7374831955394818, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.254278 (no previous merge yet)
[S10] round=3 local utility u=0.066996 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8371999803857708, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9711916823754063, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.255308 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.104289906989013, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6535039721971818, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.195497 (no previous merge yet)
[S13] round=3 local utility u=0.045467 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.815540279736759, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9064748433195826, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.212550 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.056907902372258, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.694984357614631, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.288241 (no previous merge yet)
[S15] round=3 local utility u=0.014262 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8317810849929363, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8603059010479583, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.270952 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9126497582334014, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6434326665499768, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.295717 (no previous merge yet)
[S17] round=3 local utility u=0.158498 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6296756767498355, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9466715981436822, 'psi': 0.0}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=4 head_norm_before_train=1.286997 (no previous merge yet)
[S2] round=4 local utility u=0.061365 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.468224666621794, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5909538331099187, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.233086 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.792494667240716, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1660281334904625, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.330323 (no previous merge yet)
[S4] round=4 local utility u=0.112639 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4492017068187253, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.674479014133503, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.303379 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8934641172173292, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7798268664379078, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.375983 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.088475830906713, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7219756791372194, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.224674 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9802803082378602, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7359928465193892, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.277481 (no previous merge yet)
[S8] round=4 local utility u=1.000000 metrics={'f1_val': 0.32245374211111727, 'auprc': 0.32245374211111727, 'loss_val': 1.418088400894349, 'psi': 0.32245374211111727}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6291656457297068, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.246884 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.848923789746201, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.165089157363398, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.282846 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2662474320385058, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8371999803857708, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.295735 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.851954706365531, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.104289906989013, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.217033 (no previous merge yet)
[S13] round=4 local utility u=0.134095 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5473493971674694, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.815540279736759, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.253879 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.054848389758837, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.056907902372258, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.316923 (no previous merge yet)
[S15] round=4 local utility u=0.091463 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6488551741153894, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8317810849929363, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.311975 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6132625886960517, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9126497582334014, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.323300 (no previous merge yet)
[S17] round=4 local utility u=1.000000 metrics={'f1_val': 0.22513279487739213, 'auprc': 0.22513279487739213, 'loss_val': 1.4287114393910718, 'psi': 0.22513279487739213}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6296756767498355, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49310
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=0.0491
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=-0.0087
[S3] DROPPED delta from S17 (cos=-0.0087 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.0000 head_norm=1.285518
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.935038e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.0000 head_norm=0.938498 delta_norm=0.893504
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.339562 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6793898263412506, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.468224666621794, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.265782 (no previous merge yet)
[S3] round=5 local utility u=0.076867 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.638760144048057, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.792494667240716, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.391464 (no previous merge yet)
[S4] round=5 local utility u=0.035789 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3776231963756955, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4492017068187253, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.317235 (no previous merge yet)
[S5] round=5 local utility u=0.090877 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7117110671146618, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8934641172173292, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.432049 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4697888701597, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.088475830906713, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.240664 (no previous merge yet)
[S7] round=5 local utility u=0.048276 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8837281719525747, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9802803082378602, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.306024 (no previous merge yet)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.2196955576265921, 'auprc': 0.2196955576265921, 'loss_val': 1.2384747825635842, 'psi': 0.2196955576265921}-{'f1_val': 0.32245374211111727, 'auprc': 0.32245374211111727, 'loss_val': 1.418088400894349, 'psi': 0.32245374211111727}
[S9] START round=5 head_norm_before_train=0.938498 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.167539 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.513846012145789, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.848923789746201, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.336386 (no previous merge yet)
[S10] round=5 local utility u=0.889092 metrics={'f1_val': 0.26909920182440134, 'auprc': 0.26909920182440134, 'loss_val': 2.9099559070529644, 'psi': 0.26909920182440134}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2662474320385058, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.331730 (no previous merge yet)
[S11] round=5 local utility u=0.097112 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6577306899254607, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.851954706365531, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.237230 (no previous merge yet)
[S13] round=5 local utility u=0.046959 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4534309636595861, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5473493971674694, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.300105 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4792356975659366, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.054848389758837, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.354500 (no previous merge yet)
[S15] round=5 local utility u=0.132046 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3847624306539799, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6488551741153894, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.359905 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.139927320446867, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6132625886960517, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.369573 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.15249466123082897, 'auprc': 0.15249466123082897, 'loss_val': 1.3299653841769419, 'psi': 0.15249466123082897}-{'f1_val': 0.22513279487739213, 'auprc': 0.22513279487739213, 'loss_val': 1.4287114393910718, 'psi': 0.22513279487739213}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:49310
[S10] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S10
[S9] cosine check vs S10: cos=0.0962
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.0000 head_norm=0.972064
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.122861e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.0000 head_norm=0.889188 delta_norm=0.812286
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.361 → S16@127.0.0.1:49316
[S15] ⇄ pheromone p=0.373 → S5@127.0.0.1:49305
[S2] ⇄ pheromone p=0.344 → S15@127.0.0.1:49315
[S8] ⇄ pheromone p=0.503 → S9@127.0.0.1:49310
[S4] ⇄ pheromone p=0.357 → S11@127.0.0.1:49312
[S3] ⇄ pheromone p=0.343 → S2@127.0.0.1:49302
[S6] ⇄ pheromone p=0.362 → S8@127.0.0.1:49309
[S7] ⇄ pheromone p=0.337 → S3@127.0.0.1:49303
[S5] ⇄ pheromone p=0.346 → S16@127.0.0.1:49316
[S11] ⇄ pheromone p=0.347 → S15@127.0.0.1:49315
[S13] ⇄ pheromone p=0.364 → S10@127.0.0.1:49311
[S14] ⇄ pheromone p=0.328 → S8@127.0.0.1:49309
[S10] ⇄ pheromone p=0.514 → S9@127.0.0.1:49310
[S16] ⇄ pheromone p=0.328 → S14@127.0.0.1:49314
[S17] ⇄ pheromone p=0.508 → S3@127.0.0.1:49303
[S2] START round=6 head_norm_before_train=1.403719 (no previous merge yet)
[S2] round=6 local utility u=0.837868 metrics={'f1_val': 0.18119322366805793, 'auprc': 0.18119322366805793, 'loss_val': 2.634392044221112, 'psi': 0.18119322366805793}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6793898263412506, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.282187 (no previous merge yet)
[S3] round=6 local utility u=0.080807 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.477146294209614, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.638760144048057, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.460576 (no previous merge yet)
[S4] round=6 local utility u=0.048518 metrics={'f1_val': 0.004699563611950319, 'auprc': 0.004699563611950319, 'loss_val': 1.3228840296831488, 'psi': 0.004699563611950319}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3776231963756955, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.315885 (no previous merge yet)
[S5] round=6 local utility u=0.043745 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.624220422978013, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7117110671146618, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.484878 (no previous merge yet)
[S6] round=6 local utility u=0.076846 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.316097464736167, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4697888701597, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.242997 (no previous merge yet)
[S7] round=6 local utility u=0.020741 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8422465843453766, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8837281719525747, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.350755 (no previous merge yet)
[S8] round=6 local utility u=0.683015 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1297350321939446, 'psi': 0.35939447907390915}-{'f1_val': 0.2196955576265921, 'auprc': 0.2196955576265921, 'loss_val': 1.2384747825635842, 'psi': 0.2196955576265921}
[S9] START round=6 head_norm_before_train=0.889188 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.101977 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3098928424678786, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.513846012145789, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.398579 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.24455205811138014, 'auprc': 0.24455205811138014, 'loss_val': 3.240026699529094, 'psi': 0.24455205811138014}-{'f1_val': 0.26909920182440134, 'auprc': 0.26909920182440134, 'loss_val': 2.9099559070529644, 'psi': 0.26909920182440134}
[S11] START round=6 head_norm_before_train=1.351461 (no previous merge yet)
[S11] round=6 local utility u=0.143725 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3702808052040147, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6577306899254607, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.275639 (no previous merge yet)
[S13] round=6 local utility u=1.000000 metrics={'f1_val': 0.29778745012694957, 'auprc': 0.29778745012694957, 'loss_val': 1.2584974544069387, 'psi': 0.29778745012694957}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4534309636595861, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.330881 (no previous merge yet)
[S14] round=6 local utility u=0.117655 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2439257585411867, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4792356975659366, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.406354 (no previous merge yet)
[S15] round=6 local utility u=1.000000 metrics={'f1_val': 0.2815085158150851, 'auprc': 0.2815085158150851, 'loss_val': 1.2411464327117105, 'psi': 0.2815085158150851}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3847624306539799, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.405108 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4682306670383265, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.139927320446867, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.420995 (no previous merge yet)
[S17] round=6 local utility u=0.019807 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2890197490016906, 'psi': 0.15234678044996122}-{'f1_val': 0.15249466123082897, 'auprc': 0.15249466123082897, 'loss_val': 1.3299653841769419, 'psi': 0.15249466123082897}
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:49305
[S6] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:49310
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.005)
[S14] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.181)
[S8] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=-0.0204
[S10] DROPPED delta from S13 (cos=-0.0204 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1806) from S8
[S9] cosine check vs S8: cos=0.4677
[S5] RECEIVED delta(kind=head bytes=1805) from S15
[S5] cosine check vs S15: cos=0.0192
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=-0.0001
[S3] DROPPED delta from S17 (cos=-0.0001 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.0000 head_norm=0.919996
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.353032e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.0000 head_norm=1.004367 delta_norm=0.635303
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.0000 head_norm=1.321905
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.782798e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.0000 head_norm=0.997149 delta_norm=0.978280
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.467539 (no previous merge yet)
[S2] round=7 local utility u=0.471648 metrics={'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 2.4494116607272516, 'psi': 0.2654504593826426}-{'f1_val': 0.18119322366805793, 'auprc': 0.18119322366805793, 'loss_val': 2.634392044221112, 'psi': 0.18119322366805793}
[S3] START round=7 head_norm_before_train=1.302592 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5972748414013305, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.477146294209614, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.520245 (no previous merge yet)
[S4] round=7 local utility u=1.000000 metrics={'f1_val': 0.32733721814035976, 'auprc': 0.32733721814035976, 'loss_val': 1.2677688160953853, 'psi': 0.32733721814035976}-{'f1_val': 0.004699563611950319, 'auprc': 0.004699563611950319, 'loss_val': 1.3228840296831488, 'psi': 0.004699563611950319}
[S5] START round=7 head_norm_before_train=0.997149 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.020704 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.582812654102993, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.624220422978013, 'psi': 0.0}
[S6] START round=7 head_norm_before_train=1.530010 (no previous merge yet)
[S6] round=7 local utility u=0.051723 metrics={'f1_val': 0.006146572104018913, 'auprc': 0.006146572104018913, 'loss_val': 3.267970007730045, 'psi': 0.006146572104018913}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.316097464736167, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.251438 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.846753707360071, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8422465843453766, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.406533 (no previous merge yet)
[S8] round=7 local utility u=1.000000 metrics={'f1_val': 0.9940818815255938, 'auprc': 0.9940818815255938, 'loss_val': 1.0505767073571857, 'psi': 0.9940818815255938}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1297350321939446, 'psi': 0.35939447907390915}
[S9] START round=7 head_norm_before_train=1.004367 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.398657719186958, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3098928424678786, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.461683 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.22531512605042017, 'auprc': 0.22531512605042017, 'loss_val': 3.1528359505441954, 'psi': 0.22531512605042017}-{'f1_val': 0.24455205811138014, 'auprc': 0.24455205811138014, 'loss_val': 3.240026699529094, 'psi': 0.24455205811138014}
[S11] START round=7 head_norm_before_train=1.369775 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.395846139534313, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3702808052040147, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.319035 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.2703140830800405, 'auprc': 0.2703140830800405, 'loss_val': 1.2533077184325252, 'psi': 0.2703140830800405}-{'f1_val': 0.29778745012694957, 'auprc': 0.29778745012694957, 'loss_val': 1.2584974544069387, 'psi': 0.29778745012694957}
[S14] START round=7 head_norm_before_train=1.349316 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.598183585313185, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2439257585411867, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.468074 (no previous merge yet)
[S15] round=7 local utility u=0.054274 metrics={'f1_val': 0.2826297913634158, 'auprc': 0.2826297913634158, 'loss_val': 1.1426897372080953, 'psi': 0.2826297913634158}-{'f1_val': 0.2815085158150851, 'auprc': 0.2815085158150851, 'loss_val': 1.2411464327117105, 'psi': 0.2815085158150851}
[S16] START round=7 head_norm_before_train=1.447109 (no previous merge yet)
[S16] round=7 local utility u=0.105488 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.257254335312451, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4682306670383265, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.469488 (no previous merge yet)
[S17] round=7 local utility u=0.014118 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2607839463445079, 'psi': 0.15234678044996122}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2890197490016906, 'psi': 0.15234678044996122}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[S16] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:49312
[S5] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.006)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49315
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.0182
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=0.8965
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=0.0180
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.7397
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=0.0037
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.0000 head_norm=1.030518
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.539088e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.215950 delta_norm=0.353909
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.0000 head_norm=1.010320
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.189358e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.189034 delta_norm=0.518936
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.0000 head_norm=1.331197
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.003140e+00
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.006797 delta_norm=1.003140
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.0000 head_norm=1.392277
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.034808e+00
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.053651 delta_norm=1.034808
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.2826 head_norm=1.531484
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.071650e+00
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.2714 head_norm=1.091156 delta_norm=1.071650
[S15] aggregate: ROLLBACK (f1_val pre=0.283 post=0.271 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=1.527306 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.2653708845696152, 'auprc': 0.2653708845696152, 'loss_val': 2.563597332894543, 'psi': 0.2653708845696152}-{'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 2.4494116607272516, 'psi': 0.2654504593826426}
[S3] START round=8 head_norm_before_train=1.006797 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.235398 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1264797636974024, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5972748414013305, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.556785 (no previous merge yet)
[S4] round=8 local utility u=0.002500 metrics={'f1_val': 0.3219854682014858, 'auprc': 0.3219854682014858, 'loss_val': 1.2146029261036089, 'psi': 0.3219854682014858}-{'f1_val': 0.32733721814035976, 'auprc': 0.32733721814035976, 'loss_val': 1.2677688160953853, 'psi': 0.32733721814035976}
[S5] START round=8 head_norm_before_train=1.189034 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5989882451919477, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.582812654102993, 'psi': 0.0}
[S6] START round=8 head_norm_before_train=1.574496 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.032452999104744855, 'auprc': 0.032452999104744855, 'loss_val': 3.981362660004295, 'psi': 0.032452999104744855}-{'f1_val': 0.006146572104018913, 'auprc': 0.006146572104018913, 'loss_val': 3.267970007730045, 'psi': 0.006146572104018913}
[S7] START round=8 head_norm_before_train=1.264849 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9648187085564597, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.846753707360071, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.464788 (no previous merge yet)
[S8] round=8 local utility u=0.073359 metrics={'f1_val': 0.9988713027870695, 'auprc': 0.9988713027870695, 'loss_val': 0.9469644968977532, 'psi': 0.9988713027870695}-{'f1_val': 0.9940818815255938, 'auprc': 0.9940818815255938, 'loss_val': 1.0505767073571857, 'psi': 0.9940818815255938}
[S9] START round=8 head_norm_before_train=1.215950 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.013868 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.370921282243614, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.398657719186958, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.522368 (no previous merge yet)
[S10] round=8 local utility u=0.200490 metrics={'f1_val': 0.24970088537927734, 'auprc': 0.24970088537927734, 'loss_val': 2.9713279473004057, 'psi': 0.24970088537927732}-{'f1_val': 0.22531512605042017, 'auprc': 0.22531512605042017, 'loss_val': 3.1528359505441954, 'psi': 0.22531512605042017}
[S11] START round=8 head_norm_before_train=1.053651 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.076139 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2435685946780857, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.395846139534313, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.375051 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.24427941797983457, 'auprc': 0.24427941797983457, 'loss_val': 1.3544350993692942, 'psi': 0.24427941797983457}-{'f1_val': 0.2703140830800405, 'auprc': 0.2703140830800405, 'loss_val': 1.2533077184325252, 'psi': 0.2703140830800405}
[S14] START round=8 head_norm_before_train=1.373059 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8472611073206076, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.598183585313185, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.091156 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.011380 metrics={'f1_val': 0.2817894480914174, 'auprc': 0.2817894480914174, 'loss_val': 1.1123668995681002, 'psi': 0.2817894480914174}-{'f1_val': 0.2826297913634158, 'auprc': 0.2826297913634158, 'loss_val': 1.1426897372080953, 'psi': 0.2826297913634158}
[S16] START round=8 head_norm_before_train=1.480016 (no previous merge yet)
[S16] round=8 local utility u=0.049788 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.157678094934131, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.257254335312451, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.505913 (no previous merge yet)
[S17] round=8 local utility u=0.035817 metrics={'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.1894150608497127, 'psi': 0.15237633365664405}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2607839463445079, 'psi': 0.15234678044996122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:49305
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49310
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:49312
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=0.2567
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] cosine check vs S8: cos=0.9690
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.7216
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.7323
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.7276
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.0000 head_norm=1.040892
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.284981e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.1322 head_norm=1.201238 delta_norm=0.528498
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.0000 head_norm=1.199655
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.427521e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.100682 delta_norm=0.442752
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.0000 head_norm=1.236097
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.703455e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.140599 delta_norm=0.370346
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.0000 head_norm=1.081032
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.473844e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.252105 delta_norm=0.547384
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.581552 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.640365928482361, 'psi': 0.26531826293872696}-{'f1_val': 0.2653708845696152, 'auprc': 0.2653708845696152, 'loss_val': 2.563597332894543, 'psi': 0.2653708845696152}
[S3] START round=9 head_norm_before_train=1.201238 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.965619 metrics={'f1_val': 0.16377005347593582, 'auprc': 0.16377005347593582, 'loss_val': 1.6691722106436895, 'psi': 0.16377005347593582}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1264797636974024, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.601924 (no previous merge yet)
[S4] round=9 local utility u=0.162650 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2025790302802957, 'psi': 0.3567939207526687}-{'f1_val': 0.3219854682014858, 'auprc': 0.3219854682014858, 'loss_val': 1.2146029261036089, 'psi': 0.3219854682014858}
[S5] START round=9 head_norm_before_train=1.100682 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.012313 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5743624977735522, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5989882451919477, 'psi': 0.0}
[S6] START round=9 head_norm_before_train=1.617588 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.010543580131208997, 'auprc': 0.010543580131208997, 'loss_val': 4.992237960375381, 'psi': 0.010543580131208997}-{'f1_val': 0.032452999104744855, 'auprc': 0.032452999104744855, 'loss_val': 3.981362660004295, 'psi': 0.032452999104744855}
[S7] START round=9 head_norm_before_train=1.283519 (no previous merge yet)
[S7] round=9 local utility u=0.135123 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6945736137859448, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9648187085564597, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.524640 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8863871988597524, 'psi': 0.35939447907390915}-{'f1_val': 0.9988713027870695, 'auprc': 0.9988713027870695, 'loss_val': 0.9469644968977532, 'psi': 0.9988713027870695}
[S9] START round=9 head_norm_before_train=1.140599 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.003850 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.363222163956644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.370921282243614, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.580295 (no previous merge yet)
[S10] round=9 local utility u=0.440482 metrics={'f1_val': 0.33293470461612057, 'auprc': 0.33293470461612057, 'loss_val': 2.8394679939907124, 'psi': 0.33293470461612057}-{'f1_val': 0.24970088537927734, 'auprc': 0.24970088537927734, 'loss_val': 2.9713279473004057, 'psi': 0.24970088537927732}
[S11] START round=9 head_norm_before_train=1.252105 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.094698 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.05417198567646, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2435685946780857, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.421954 (no previous merge yet)
[S13] round=9 local utility u=0.499382 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3965823103061172, 'psi': 0.3599362944611573}-{'f1_val': 0.24427941797983457, 'auprc': 0.24427941797983457, 'loss_val': 1.3544350993692942, 'psi': 0.24427941797983457}
[S14] START round=9 head_norm_before_train=1.401575 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.678266851589477, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8472611073206076, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.172983 cos_to_last_merge=0.9956 (last merge round=7)
[S15] round=9 local utility u=0.060136 metrics={'f1_val': 0.2816490331995622, 'auprc': 0.2816490331995622, 'loss_val': 0.9908315463068017, 'psi': 0.2816490331995622}-{'f1_val': 0.2817894480914174, 'auprc': 0.2817894480914174, 'loss_val': 1.1123668995681002, 'psi': 0.2817894480914174}
[S16] START round=9 head_norm_before_train=1.504398 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.303680239549518, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.157678094934131, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.536590 (no previous merge yet)
[S17] round=9 local utility u=0.045183 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.098251466905816, 'psi': 0.152287708414114}-{'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.1894150608497127, 'psi': 0.15237633365664405}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:49312
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.9396
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:49311
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=-0.0148
[S10] DROPPED delta from S13 (cos=-0.0148 < 0.0)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:49305
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.9263
[S3] not sending this round → trigger blocked (psi=0.164)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[S5] not sending this round → trigger blocked (psi=0.000)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=0.5128
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.9361
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.1638 head_norm=1.222551
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.057683e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.2233 head_norm=1.378735 delta_norm=0.305768
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.0000 head_norm=1.118053
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.408274e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.171448 delta_norm=0.240827
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.0000 head_norm=1.166167
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.206840e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.223553 delta_norm=0.720684
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.0000 head_norm=1.275688
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.183240e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.446952 delta_norm=0.318324
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.628301 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.26393312101910826, 'auprc': 0.26393312101910826, 'loss_val': 2.7589179684597096, 'psi': 0.26393312101910826}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.640365928482361, 'psi': 0.26531826293872696}
[S3] START round=10 head_norm_before_train=1.378735 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.325972 metrics={'f1_val': 0.22364085667215816, 'auprc': 0.22364085667215816, 'loss_val': 1.5560657843879395, 'psi': 0.22364085667215816}-{'f1_val': 0.16377005347593582, 'auprc': 0.16377005347593582, 'loss_val': 1.6691722106436895, 'psi': 0.16377005347593582}
[S4] START round=10 head_norm_before_train=1.662113 (no previous merge yet)
[S4] round=10 local utility u=0.011675 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.179229291232918, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2025790302802957, 'psi': 0.3567939207526687}
[S5] START round=10 head_norm_before_train=1.171448 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.040202 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.493959008807586, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5743624977735522, 'psi': 0.0}
[S6] START round=10 head_norm_before_train=1.654205 (no previous merge yet)
[S6] round=10 local utility u=0.113641 metrics={'f1_val': 0.028229448961156277, 'auprc': 0.028229448961156277, 'loss_val': 4.924128608913246, 'psi': 0.028229448961156277}-{'f1_val': 0.010543580131208997, 'auprc': 0.010543580131208997, 'loss_val': 4.992237960375381, 'psi': 0.010543580131208997}
[S7] START round=10 head_norm_before_train=1.294438 (no previous merge yet)
[S7] round=10 local utility u=0.056203 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5821675036600082, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6945736137859448, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.582289 (no previous merge yet)
[S8] round=10 local utility u=0.002054 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8822797894032266, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8863871988597524, 'psi': 0.35939447907390915}
[S9] START round=10 head_norm_before_train=1.223553 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.174156 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.014909434201539, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.363222163956644, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.634928 (no previous merge yet)
[S10] round=10 local utility u=0.059666 metrics={'f1_val': 0.33293489521077374, 'auprc': 0.33293489521077374, 'loss_val': 2.7201377197282217, 'psi': 0.33293489521077374}-{'f1_val': 0.33293470461612057, 'auprc': 0.33293470461612057, 'loss_val': 2.8394679939907124, 'psi': 0.33293470461612057}
[S11] START round=10 head_norm_before_train=1.446952 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.161474 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7312232086654942, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.05417198567646, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.467765 (no previous merge yet)
[S13] round=10 local utility u=0.018943 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3586963911297854, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3965823103061172, 'psi': 0.3599362944611573}
[S14] START round=10 head_norm_before_train=1.433054 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.917372267247015, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.678266851589477, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.269068 cos_to_last_merge=0.9844 (last merge round=7)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.22749341101401024, 'auprc': 0.22749341101401024, 'loss_val': 1.1124597935036145, 'psi': 0.22749341101401024}-{'f1_val': 0.2816490331995622, 'auprc': 0.2816490331995622, 'loss_val': 0.9908315463068017, 'psi': 0.2816490331995622}
[S16] START round=10 head_norm_before_train=1.525139 (no previous merge yet)
[S16] round=10 local utility u=0.035809 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.232061817542588, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.303680239549518, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.579297 (no previous merge yet)
[S17] round=10 local utility u=0.030870 metrics={'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.0373089054028575, 'psi': 0.15237633365664405}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.098251466905816, 'psi': 0.152287708414114}
[S6] not sending this round → trigger blocked (psi=0.028)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:49310
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S8] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=0.8985
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9778
[S9] RECEIVED delta(kind=head bytes=1806) from S8
[S9] cosine check vs S8: cos=0.5026
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:49311
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1805 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1805) from S13
[S10] cosine check vs S13: cos=-0.0140
[S10] DROPPED delta from S13 (cos=-0.0140 < 0.0)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:49303
[S16] not sending this round → trigger blocked (psi=0.000)
[S3] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=0.0151
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] cosine check vs S17: cos=0.9728
[S7] ⇄ pheromone p=0.145 → S3@127.0.0.1:49303
[S5] ⇄ pheromone p=0.129 → S16@127.0.0.1:49316
[S6] ⇄ pheromone p=0.153 → S8@127.0.0.1:49309
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.0000 head_norm=1.248287
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.065798e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.226829 delta_norm=0.206580
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.164 → S16@127.0.0.1:49316
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.0000 head_norm=1.469772
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.101908e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.587604 delta_norm=0.210191
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.183 → S15@127.0.0.1:49315
[S10] ⇄ pheromone p=0.277 → S9@127.0.0.1:49310
[S8] ⇄ pheromone p=0.333 → S9@127.0.0.1:49310
[S4] ⇄ pheromone p=0.252 → S11@127.0.0.1:49312
[S13] ⇄ pheromone p=0.285 → S10@127.0.0.1:49311
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.2639 head_norm=1.665504
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.077784e+00
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.2603 head_norm=1.093939 delta_norm=1.077784
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.230 → S15@127.0.0.1:49315
[S17] ⇄ pheromone p=0.188 → S3@127.0.0.1:49303
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.2236 head_norm=1.393821
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.114350e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.2160 head_norm=1.501218 delta_norm=0.211435
[S3] aggregate: ROLLBACK (f1_val pre=0.224 post=0.216 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.369 → S2@127.0.0.1:49302
[S14] ⇄ pheromone p=0.117 → S8@127.0.0.1:49309
[S15] ⇄ pheromone p=0.221 → S5@127.0.0.1:49305
[S16] ⇄ pheromone p=0.132 → S14@127.0.0.1:49314
[S2] START round=11 head_norm_before_train=1.093939 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.461157 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 1.8490709734430941, 'psi': 0.26531826293872696}-{'f1_val': 0.26393312101910826, 'auprc': 0.26393312101910826, 'loss_val': 2.7589179684597096, 'psi': 0.26393312101910826}
[S3] START round=11 head_norm_before_train=1.501218 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.21797028315110736, 'auprc': 0.21797028315110736, 'loss_val': 1.6291536321157198, 'psi': 0.21797028315110736}-{'f1_val': 0.22364085667215816, 'auprc': 0.22364085667215816, 'loss_val': 1.5560657843879395, 'psi': 0.22364085667215816}
[S4] START round=11 head_norm_before_train=1.723108 (no previous merge yet)
[S4] round=11 local utility u=0.012325 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1545783397431768, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.179229291232918, 'psi': 0.3567939207526687}
[S5] START round=11 head_norm_before_train=1.187185 cos_to_last_merge=0.9984 (last merge round=9)
[S5] round=11 local utility u=0.026692 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4405751912838298, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.493959008807586, 'psi': 0.0}
[S6] START round=11 head_norm_before_train=1.685014 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 5.560341498088382, 'psi': 0.01799723119520074}-{'f1_val': 0.028229448961156277, 'auprc': 0.028229448961156277, 'loss_val': 4.924128608913246, 'psi': 0.028229448961156277}
[S7] START round=11 head_norm_before_train=1.309983 (no previous merge yet)
[S7] round=11 local utility u=0.029663 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5228407081859394, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5821675036600082, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.647407 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9007312676715894, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8822797894032266, 'psi': 0.35939447907390915}
[S9] START round=11 head_norm_before_train=1.226829 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.050129 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9146509148421273, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.014909434201539, 'psi': 0.0}
[S10] START round=11 head_norm_before_train=1.686206 (no previous merge yet)
[S10] round=11 local utility u=0.060636 metrics={'f1_val': 0.33293508562325763, 'auprc': 0.33293508562325763, 'loss_val': 2.5988666511051854, 'psi': 0.33293508562325763}-{'f1_val': 0.33293489521077374, 'auprc': 0.33293489521077374, 'loss_val': 2.7201377197282217, 'psi': 0.33293489521077374}
[S11] START round=11 head_norm_before_train=1.587604 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7745998966334293, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7312232086654942, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.500141 (no previous merge yet)
[S13] round=11 local utility u=0.000891 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3569144514829692, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3586963911297854, 'psi': 0.3599362944611573}
[S14] START round=11 head_norm_before_train=1.461062 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.093434438357037, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.917372267247015, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.344810 cos_to_last_merge=0.9736 (last merge round=7)
[S15] round=11 local utility u=0.197287 metrics={'f1_val': 0.26108121957468616, 'auprc': 0.26108121957468616, 'loss_val': 1.0201770366568463, 'psi': 0.26108121957468616}-{'f1_val': 0.22749341101401024, 'auprc': 0.22749341101401024, 'loss_val': 1.1124597935036145, 'psi': 0.22749341101401024}
[S16] START round=11 head_norm_before_train=1.546362 (no previous merge yet)
[S16] round=11 local utility u=0.574030 metrics={'f1_val': 0.0718562874251497, 'auprc': 0.0718562874251497, 'loss_val': 2.730708249204363, 'psi': 0.0718562874251497}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.232061817542588, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.629104 (no previous merge yet)
[S17] round=11 local utility u=0.238068 metrics={'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 1.0161761367009183, 'psi': 0.20293224827229864}-{'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.0373089054028575, 'psi': 0.15237633365664405}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49312
[S7] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49311
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:49315
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:49310
[S16] not sending this round → trigger blocked (psi=0.072)
[S5] not sending this round → trigger blocked (psi=0.000)
[S10] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=0.8252
[S15] RECEIVED delta(kind=head bytes=1796) from S2
[S15] cosine check vs S2: cos=0.4898
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.9681
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=-0.0108
[S10] DROPPED delta from S13 (cos=-0.0108 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9866
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.9815
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.0000 head_norm=1.205584
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.896918e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.290945 delta_norm=0.189692
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.0000 head_norm=1.255851
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.943714e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.0031 head_norm=1.425498 delta_norm=0.494371
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.2180 head_norm=1.516519
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.711950e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.2237 head_norm=1.585747 delta_norm=0.171195
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.0000 head_norm=1.613199
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.620976e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.691385 delta_norm=0.162098
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.2611 head_norm=1.397002
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.550578e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.2433 head_norm=1.107933 delta_norm=0.655058
[S15] aggregate: ROLLBACK (f1_val pre=0.261 post=0.243 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.166884 cos_to_last_merge=0.9957 (last merge round=10)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.2614863985422361, 'auprc': 0.2614863985422361, 'loss_val': 1.8403274040683275, 'psi': 0.2614863985422361}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 1.8490709734430941, 'psi': 0.26531826293872696}
[S3] START round=12 head_norm_before_train=1.585747 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.17411726595400065, 'auprc': 0.17411726595400065, 'loss_val': 1.7744982466238644, 'psi': 0.17411726595400065}-{'f1_val': 0.21797028315110736, 'auprc': 0.21797028315110736, 'loss_val': 1.6291536321157198, 'psi': 0.21797028315110736}
[S4] START round=12 head_norm_before_train=1.780928 (no previous merge yet)
[S4] round=12 local utility u=0.008679 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1372201626092642, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1545783397431768, 'psi': 0.3567939207526687}
[S5] START round=12 head_norm_before_train=1.290945 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.019167 metrics={'f1_val': 0.0010361620557455186, 'auprc': 0.0010361620557455186, 'loss_val': 1.411566438556455, 'psi': 0.0010361620557455186}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4405751912838298, 'psi': 0.0}
[S6] START round=12 head_norm_before_train=1.707977 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.003492063492063492, 'auprc': 0.003492063492063492, 'loss_val': 6.005444342174562, 'psi': 0.0034920634920634925}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 5.560341498088382, 'psi': 0.01799723119520074}
[S7] START round=12 head_norm_before_train=1.328300 (no previous merge yet)
[S7] round=12 local utility u=0.014449 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4939431067223308, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5228407081859394, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.709881 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9356805587114793, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9007312676715894, 'psi': 0.35939447907390915}
[S9] START round=12 head_norm_before_train=1.425498 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.049787 metrics={'f1_val': 0.004145555043758637, 'auprc': 0.004145555043758637, 'loss_val': 1.8523859263716047, 'psi': 0.004145555043758637}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9146509148421273, 'psi': 0.0}
[S10] START round=12 head_norm_before_train=1.725031 (no previous merge yet)
[S10] round=12 local utility u=0.069936 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.458996111997317, 'psi': 0.33293527585383326}-{'f1_val': 0.33293508562325763, 'auprc': 0.33293508562325763, 'loss_val': 2.5988666511051854, 'psi': 0.33293508562325763}
[S11] START round=12 head_norm_before_train=1.691385 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.849723503026012, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7745998966334293, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.521902 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3577002138167167, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3569144514829692, 'psi': 0.3599362944611573}
[S14] START round=12 head_norm_before_train=1.484601 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.004666355576294914, 'auprc': 0.004666355576294914, 'loss_val': 5.16229243468805, 'psi': 0.004666355576294914}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.093434438357037, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.107933 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.127060 metrics={'f1_val': 0.28080438756855575, 'auprc': 0.28080438756855575, 'loss_val': 0.9435649888468514, 'psi': 0.28080438756855575}-{'f1_val': 0.26108121957468616, 'auprc': 0.26108121957468616, 'loss_val': 1.0201770366568463, 'psi': 0.26108121957468616}
[S16] START round=12 head_norm_before_train=1.568729 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.56621490573656, 'psi': 0.0}-{'f1_val': 0.0718562874251497, 'auprc': 0.0718562874251497, 'loss_val': 2.730708249204363, 'psi': 0.0718562874251497}
[S17] START round=12 head_norm_before_train=1.669723 (no previous merge yet)
[S17] round=12 local utility u=0.032072 metrics={'f1_val': 0.20337868511044424, 'auprc': 0.20337868511044424, 'loss_val': 0.9560510669535703, 'psi': 0.20337868511044424}-{'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 1.0161761367009183, 'psi': 0.20293224827229864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[S9] not sending this round → trigger blocked (psi=0.004)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:49310
[S7] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.001)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S10
[S9] cosine check vs S10: cos=0.9608
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.8900
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9906
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.9861
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.0000 head_norm=1.721013
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.294574e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.763242 delta_norm=0.129457
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.1741 head_norm=1.604811
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.451501e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.2981 head_norm=1.645790 delta_norm=0.145150
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.0010 head_norm=1.311977
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.991639e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.0006 head_norm=1.208076 delta_norm=0.299164
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.0041 head_norm=1.452172
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.725328e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.0098 head_norm=1.591848 delta_norm=0.272533
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.264121 cos_to_last_merge=0.9841 (last merge round=10)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.19070059692114358, 'auprc': 0.19070059692114358, 'loss_val': 2.651514848511316, 'psi': 0.19070059692114358}-{'f1_val': 0.2614863985422361, 'auprc': 0.2614863985422361, 'loss_val': 1.8403274040683275, 'psi': 0.2614863985422361}
[S3] START round=13 head_norm_before_train=1.645790 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.1012683313515656, 'auprc': 0.1012683313515656, 'loss_val': 1.9374158576047442, 'psi': 0.1012683313515656}-{'f1_val': 0.17411726595400065, 'auprc': 0.17411726595400065, 'loss_val': 1.7744982466238644, 'psi': 0.17411726595400065}
[S4] START round=13 head_norm_before_train=1.813746 (no previous merge yet)
[S4] round=13 local utility u=0.005387 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1264460096957, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1372201626092642, 'psi': 0.3567939207526687}
[S5] START round=13 head_norm_before_train=1.208076 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.016500 metrics={'f1_val': 0.0020819981870962667, 'auprc': 0.0020819981870962667, 'loss_val': 1.3879780031157463, 'psi': 0.0020819981870962667}-{'f1_val': 0.0010361620557455186, 'auprc': 0.0010361620557455186, 'loss_val': 1.411566438556455, 'psi': 0.0010361620557455186}
[S6] START round=13 head_norm_before_train=1.727113 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.005445075757575758, 'auprc': 0.005445075757575758, 'loss_val': 6.059985124583407, 'psi': 0.005445075757575758}-{'f1_val': 0.003492063492063492, 'auprc': 0.003492063492063492, 'loss_val': 6.005444342174562, 'psi': 0.0034920634920634925}
[S7] START round=13 head_norm_before_train=1.347760 (no previous merge yet)
[S7] round=13 local utility u=0.000913 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4921174920497544, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4939431067223308, 'psi': 0.0}
[S8] START round=13 head_norm_before_train=1.760031 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9797790113553956, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9356805587114793, 'psi': 0.35939447907390915}
[S9] START round=13 head_norm_before_train=1.591848 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.452976 metrics={'f1_val': 0.09283276450511946, 'auprc': 0.09283276450511946, 'loss_val': 1.744618768434023, 'psi': 0.09283276450511946}-{'f1_val': 0.004145555043758637, 'auprc': 0.004145555043758637, 'loss_val': 1.8523859263716047, 'psi': 0.004145555043758637}
[S10] START round=13 head_norm_before_train=1.762869 (no previous merge yet)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.24970145689037496, 'auprc': 0.24970145689037496, 'loss_val': 2.3145019294553326, 'psi': 0.24970145689037493}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.458996111997317, 'psi': 0.33293527585383326}
[S11] START round=13 head_norm_before_train=1.763242 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.019439 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8108461432668872, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.849723503026012, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.545566 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3902477652196228, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3577002138167167, 'psi': 0.3599362944611573}
[S14] START round=13 head_norm_before_train=1.506806 (no previous merge yet)
[S14] round=13 local utility u=0.068637 metrics={'f1_val': 0.016200519639309185, 'auprc': 0.016200519639309185, 'loss_val': 5.128825812276855, 'psi': 0.016200519639309185}-{'f1_val': 0.004666355576294914, 'auprc': 0.004666355576294914, 'loss_val': 5.16229243468805, 'psi': 0.004666355576294914}
[S15] START round=13 head_norm_before_train=1.173290 cos_to_last_merge=0.9970 (last merge round=11)
[S15] round=13 local utility u=0.043929 metrics={'f1_val': 0.2820699708454811, 'auprc': 0.2820699708454811, 'loss_val': 0.8670962664538622, 'psi': 0.2820699708454811}-{'f1_val': 0.28080438756855575, 'auprc': 0.28080438756855575, 'loss_val': 0.9435649888468514, 'psi': 0.28080438756855575}
[S16] START round=13 head_norm_before_train=1.595047 (no previous merge yet)
[S16] round=13 local utility u=0.672928 metrics={'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 3.0213218286167844, 'psi': 0.08899598393574297}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.56621490573656, 'psi': 0.0}
[S17] START round=13 head_norm_before_train=1.698225 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.16510561839344326, 'auprc': 0.16510561839344326, 'loss_val': 0.9601316927685073, 'psi': 0.16510561839344326}-{'f1_val': 0.20337868511044424, 'auprc': 0.20337868511044424, 'loss_val': 0.9560510669535703, 'psi': 0.20337868511044424}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[S14] not sending this round → trigger blocked (psi=0.016)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.002)
[S7] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.089)
[S9] not sending this round → trigger blocked (psi=0.093)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.9709
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9933
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.0000 head_norm=1.790762
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.076246e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.812284 delta_norm=0.107625
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.0021 head_norm=1.234138
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.519171e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.0035 head_norm=1.242143 delta_norm=0.151917
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.341062 cos_to_last_merge=0.9736 (last merge round=10)
[S2] round=14 local utility u=0.529664 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.081150496493017, 'psi': 0.2450298816928894}-{'f1_val': 0.19070059692114358, 'auprc': 0.19070059692114358, 'loss_val': 2.651514848511316, 'psi': 0.19070059692114358}
[S3] START round=14 head_norm_before_train=1.667315 cos_to_last_merge=0.9981 (last merge round=12)
[S3] round=14 local utility u=0.863570 metrics={'f1_val': 0.2981059566291518, 'auprc': 0.2981059566291518, 'loss_val': 1.9818143928634222, 'psi': 0.2981059566291518}-{'f1_val': 0.1012683313515656, 'auprc': 0.1012683313515656, 'loss_val': 1.9374158576047442, 'psi': 0.1012683313515656}
[S4] START round=14 head_norm_before_train=1.839859 (no previous merge yet)
[S4] round=14 local utility u=0.003426 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1195943903608312, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1264460096957, 'psi': 0.3567939207526687}
[S5] START round=14 head_norm_before_train=1.242143 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.735935 metrics={'f1_val': 0.16261824611606507, 'auprc': 0.16261824611606507, 'loss_val': 1.3609342945450926, 'psi': 0.16261824611606507}-{'f1_val': 0.0020819981870962667, 'auprc': 0.0020819981870962667, 'loss_val': 1.3879780031157463, 'psi': 0.0020819981870962667}
[S6] START round=14 head_norm_before_train=1.741500 (no previous merge yet)
[S6] round=14 local utility u=0.067538 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.0358751315693056, 'psi': 0.017774699907663897}-{'f1_val': 0.005445075757575758, 'auprc': 0.005445075757575758, 'loss_val': 6.059985124583407, 'psi': 0.005445075757575758}
[S7] START round=14 head_norm_before_train=1.365716 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5128723960138757, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4921174920497544, 'psi': 0.0}
[S8] START round=14 head_norm_before_train=1.801860 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0489796915582876, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9797790113553956, 'psi': 0.35939447907390915}
[S9] START round=14 head_norm_before_train=1.619399 cos_to_last_merge=0.9990 (last merge round=12)
[S9] round=14 local utility u=0.777555 metrics={'f1_val': 0.24518636283342166, 'auprc': 0.24518636283342166, 'loss_val': 1.560690513106088, 'psi': 0.24518636283342166}-{'f1_val': 0.09283276450511946, 'auprc': 0.09283276450511946, 'loss_val': 1.744618768434023, 'psi': 0.09283276450511946}
[S10] START round=14 head_norm_before_train=1.800698 (no previous merge yet)
[S10] round=14 local utility u=0.571448 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9214269950666125, 'psi': 0.33301496338745623}-{'f1_val': 0.24970145689037496, 'auprc': 0.24970145689037496, 'loss_val': 2.3145019294553326, 'psi': 0.24970145689037493}
[S11] START round=14 head_norm_before_train=1.812284 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0305102819604266, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8108461432668872, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.568438 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4208384228703446, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3902477652196228, 'psi': 0.3599362944611573}
[S14] START round=14 head_norm_before_train=1.530672 (no previous merge yet)
[S14] round=14 local utility u=0.390688 metrics={'f1_val': 0.08879837067209777, 'auprc': 0.08879837067209777, 'loss_val': 5.000830549751917, 'psi': 0.08879837067209777}-{'f1_val': 0.016200519639309185, 'auprc': 0.016200519639309185, 'loss_val': 5.128825812276855, 'psi': 0.016200519639309185}
[S15] START round=14 head_norm_before_train=1.268424 cos_to_last_merge=0.9871 (last merge round=11)
[S15] round=14 local utility u=0.001623 metrics={'f1_val': 0.28038067349926793, 'auprc': 0.28038067349926793, 'loss_val': 0.8486474323783253, 'psi': 0.28038067349926793}-{'f1_val': 0.2820699708454811, 'auprc': 0.2820699708454811, 'loss_val': 0.8670962664538622, 'psi': 0.2820699708454811}
[S16] START round=14 head_norm_before_train=1.621033 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.870596510972876, 'psi': 0.0}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 3.0213218286167844, 'psi': 0.08899598393574297}
[S17] START round=14 head_norm_before_train=1.728499 (no previous merge yet)
[S17] round=14 local utility u=0.174678 metrics={'f1_val': 0.20444073104100421, 'auprc': 0.20444073104100421, 'loss_val': 0.9647920094464983, 'psi': 0.20444073104100421}-{'f1_val': 0.16510561839344326, 'auprc': 0.16510561839344326, 'loss_val': 0.9601316927685073, 'psi': 0.16510561839344326}
[S14] not sending this round → trigger blocked (psi=0.089)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:49305
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:49302
[S5] not sending this round → trigger blocked (psi=0.163)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49312
[S6] not sending this round → trigger blocked (psi=0.018)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=0.9790
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=0.7242
[S5] RECEIVED delta(kind=head bytes=1805) from S15
[S5] cosine check vs S15: cos=0.9883
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.1326
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9953
[S2] RECEIVED delta(kind=head bytes=1806) from S3
[S2] cosine check vs S3: cos=0.4883
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] cosine check vs S17: cos=0.9795
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.1626 head_norm=1.264932
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.109046e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.0033 head_norm=1.308099 delta_norm=0.110905
[S5] aggregate: ROLLBACK (f1_val pre=0.163 post=0.003 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.0000 head_norm=1.834103
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.105609e-02
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.848227 delta_norm=0.091056
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.2450 head_norm=1.396871
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.939060e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.2450 head_norm=1.337742 delta_norm=0.793906
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.2452 head_norm=1.649632
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.059830e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.3687 head_norm=1.742161 delta_norm=0.205983
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.2804 head_norm=1.358967
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.119699e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.4879 head_norm=1.279417 delta_norm=0.511970
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.2981 head_norm=1.699538
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.771021e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.2960 head_norm=1.718436 delta_norm=0.177102
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.0000 head_norm=1.644783
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.084766e+00
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.239589 delta_norm=1.084766
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.337742 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.21792878821526387, 'auprc': 0.21792878821526387, 'loss_val': 1.936069589803195, 'psi': 0.21792878821526387}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.081150496493017, 'psi': 0.2450298816928894}
[S3] START round=15 head_norm_before_train=1.718436 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.29802414928649834, 'auprc': 0.29802414928649834, 'loss_val': 2.050732378839406, 'psi': 0.29802414928649834}-{'f1_val': 0.2981059566291518, 'auprc': 0.2981059566291518, 'loss_val': 1.9818143928634222, 'psi': 0.2981059566291518}
[S4] START round=15 head_norm_before_train=1.866691 (no previous merge yet)
[S4] round=15 local utility u=0.003000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1135949348087024, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1195943903608312, 'psi': 0.3567939207526687}
[S5] START round=15 head_norm_before_train=1.308099 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.349785 metrics={'f1_val': 0.23834758447883153, 'auprc': 0.23834758447883153, 'loss_val': 1.3429288528976737, 'psi': 0.23834758447883153}-{'f1_val': 0.16261824611606507, 'auprc': 0.16261824611606507, 'loss_val': 1.3609342945450926, 'psi': 0.16261824611606507}
[S6] START round=15 head_norm_before_train=1.757473 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.362760887048857, 'psi': 0.017551963048498844}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.0358751315693056, 'psi': 0.017774699907663897}
[S7] START round=15 head_norm_before_train=1.386070 (no previous merge yet)
[S7] round=15 local utility u=0.010915 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4910425367160294, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5128723960138757, 'psi': 0.0}
[S8] START round=15 head_norm_before_train=1.835595 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1231381231917876, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0489796915582876, 'psi': 0.35939447907390915}
[S9] START round=15 head_norm_before_train=1.742161 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.17823268509041282, 'auprc': 0.17823268509041282, 'loss_val': 1.7298980743721681, 'psi': 0.17823268509041282}-{'f1_val': 0.24518636283342166, 'auprc': 0.24518636283342166, 'loss_val': 1.560690513106088, 'psi': 0.24518636283342166}
[S10] START round=15 head_norm_before_train=1.853057 (no previous merge yet)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.24904761904761905, 'auprc': 0.24904761904761905, 'loss_val': 1.5086352664471847, 'psi': 0.24904761904761902}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9214269950666125, 'psi': 0.33301496338745623}
[S11] START round=15 head_norm_before_train=1.848227 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.190328 metrics={'f1_val': 0.0003112356053532524, 'auprc': 0.0003112356053532524, 'loss_val': 1.6526550564135265, 'psi': 0.0003112356053532524}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0305102819604266, 'psi': 0.0}
[S13] START round=15 head_norm_before_train=1.591574 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4464258295372872, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4208384228703446, 'psi': 0.3599362944611573}
[S14] START round=15 head_norm_before_train=1.555929 (no previous merge yet)
[S14] round=15 local utility u=0.119013 metrics={'f1_val': 0.10747602154775981, 'auprc': 0.10747602154775981, 'loss_val': 4.930903040086049, 'psi': 0.10747602154775981}-{'f1_val': 0.08879837067209777, 'auprc': 0.08879837067209777, 'loss_val': 5.000830549751917, 'psi': 0.08879837067209777}
[S15] START round=15 head_norm_before_train=1.279417 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=1.000000 metrics={'f1_val': 0.6123347418506996, 'auprc': 0.6123347418506996, 'loss_val': 0.828446216381551, 'psi': 0.6123347418506996}-{'f1_val': 0.28038067349926793, 'auprc': 0.28038067349926793, 'loss_val': 0.8486474323783253, 'psi': 0.28038067349926793}
[S16] START round=15 head_norm_before_train=1.239589 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=1.000000 metrics={'f1_val': 0.1106731586675941, 'auprc': 0.1106731586675941, 'loss_val': 2.281249005284227, 'psi': 0.11067315866759408}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.870596510972876, 'psi': 0.0}
[S17] START round=15 head_norm_before_train=1.755090 (no previous merge yet)
[S17] round=15 local utility u=0.008160 metrics={'f1_val': 0.2072853430246294, 'auprc': 0.2072853430246294, 'loss_val': 0.9740736865125277, 'psi': 0.2072853430246294}-{'f1_val': 0.20444073104100421, 'auprc': 0.20444073104100421, 'loss_val': 0.9647920094464983, 'psi': 0.20444073104100421}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:49305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[S16] not sending this round → trigger blocked (psi=0.111)
[S14] not sending this round → trigger blocked (psi=0.107)
[S7] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:49316
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.9384
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.1653
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9963
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.9887
[S6] ⇄ pheromone p=0.061 → S8@127.0.0.1:49309
[S9] ⇄ pheromone p=0.245 → S16@127.0.0.1:49316
[S13] ⇄ pheromone p=0.093 → S10@127.0.0.1:49311
[S14] ⇄ pheromone p=0.133 → S8@127.0.0.1:49309
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.2980 head_norm=1.746008
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.336862e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.2988 head_norm=1.757269 delta_norm=0.133686
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.259 → S2@127.0.0.1:49302
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.0003 head_norm=1.868074
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.122749e-02
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.877150 delta_norm=0.081227
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.100 → S15@127.0.0.1:49315
[S8] ⇄ pheromone p=0.109 → S9@127.0.0.1:49310
[S7] ⇄ pheromone p=0.054 → S3@127.0.0.1:49303
[S2] ⇄ pheromone p=0.198 → S15@127.0.0.1:49315
[S10] ⇄ pheromone p=0.194 → S9@127.0.0.1:49310
[S15] ⇄ pheromone p=0.307 → S5@127.0.0.1:49305
[S4] ⇄ pheromone p=0.086 → S11@127.0.0.1:49312
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.2383 head_norm=1.333068
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.356479e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.0081 head_norm=1.321249 delta_norm=0.235648
[S5] aggregate: ROLLBACK (f1_val pre=0.238 post=0.008 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.236 → S16@127.0.0.1:49316
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.1107 head_norm=1.267783
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.404617e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.1467 head_norm=0.992873 delta_norm=0.840462
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.376 → S14@127.0.0.1:49314
[S17] ⇄ pheromone p=0.114 → S3@127.0.0.1:49303
[S2] START round=16 head_norm_before_train=1.402153 cos_to_last_merge=0.9960 (last merge round=14)
[S2] round=16 local utility u=0.252304 metrics={'f1_val': 0.24624624624624625, 'auprc': 0.24624624624624625, 'loss_val': 1.6863183157199104, 'psi': 0.24624624624624625}-{'f1_val': 0.21792878821526387, 'auprc': 0.21792878821526387, 'loss_val': 1.936069589803195, 'psi': 0.21792878821526387}
[S3] START round=16 head_norm_before_train=1.757269 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.2973964063072974, 'auprc': 0.2973964063072974, 'loss_val': 2.2547165320077567, 'psi': 0.2973964063072974}-{'f1_val': 0.29802414928649834, 'auprc': 0.29802414928649834, 'loss_val': 2.050732378839406, 'psi': 0.29802414928649834}
[S4] START round=16 head_norm_before_train=1.889677 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1274538083399028, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1135949348087024, 'psi': 0.3567939207526687}
[S5] START round=16 head_norm_before_train=1.321249 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.23034961817366584, 'auprc': 0.23034961817366584, 'loss_val': 1.3239281817717141, 'psi': 0.23034961817366584}-{'f1_val': 0.23834758447883153, 'auprc': 0.23834758447883153, 'loss_val': 1.3429288528976737, 'psi': 0.23834758447883153}
[S6] START round=16 head_norm_before_train=1.776568 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.442690031748039, 'psi': 0.017105871474803514}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.362760887048857, 'psi': 0.017551963048498844}
[S7] START round=16 head_norm_before_train=1.404869 (no previous merge yet)
[S7] round=16 local utility u=0.042762 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4055177558316467, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4910425367160294, 'psi': 0.0}
[S8] START round=16 head_norm_before_train=1.871303 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1985993703833013, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1231381231917876, 'psi': 0.35939447907390915}
[S9] START round=16 head_norm_before_train=1.769664 cos_to_last_merge=0.9995 (last merge round=14)
[S9] round=16 local utility u=0.930788 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5822737769294284, 'psi': 0.36867172340800847}-{'f1_val': 0.17823268509041282, 'auprc': 0.17823268509041282, 'loss_val': 1.7298980743721681, 'psi': 0.17823268509041282}
[S10] START round=16 head_norm_before_train=1.909252 (no previous merge yet)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.2455975581122329, 'auprc': 0.2455975581122329, 'loss_val': 1.5019992383958327, 'psi': 0.2455975581122329}-{'f1_val': 0.24904761904761905, 'auprc': 0.24904761904761905, 'loss_val': 1.5086352664471847, 'psi': 0.24904761904761902}
[S11] START round=16 head_norm_before_train=1.877150 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=1.000000 metrics={'f1_val': 0.3129117259552042, 'auprc': 0.3129117259552042, 'loss_val': 1.6914094036740788, 'psi': 0.3129117259552042}-{'f1_val': 0.0003112356053532524, 'auprc': 0.0003112356053532524, 'loss_val': 1.6526550564135265, 'psi': 0.0003112356053532524}
[S13] START round=16 head_norm_before_train=1.614422 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4824422032944882, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4464258295372872, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.583454 (no previous merge yet)
[S14] round=16 local utility u=0.159164 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.866847938585781, 'psi': 0.13572854291417166}-{'f1_val': 0.10747602154775981, 'auprc': 0.10747602154775981, 'loss_val': 4.930903040086049, 'psi': 0.10747602154775981}
[S15] START round=16 head_norm_before_train=1.351068 cos_to_last_merge=0.9965 (last merge round=14)
[S15] round=16 local utility u=0.059384 metrics={'f1_val': 0.6148779833831352, 'auprc': 0.6148779833831352, 'loss_val': 0.7325668226265234, 'psi': 0.6148779833831352}-{'f1_val': 0.6123347418506996, 'auprc': 0.6123347418506996, 'loss_val': 0.828446216381551, 'psi': 0.6123347418506996}
[S16] START round=16 head_norm_before_train=0.992873 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.0016759776536312849, 'auprc': 0.0016759776536312849, 'loss_val': 2.4070853663155836, 'psi': 0.0016759776536312849}-{'f1_val': 0.1106731586675941, 'auprc': 0.1106731586675941, 'loss_val': 2.281249005284227, 'psi': 0.11067315866759408}
[S17] START round=16 head_norm_before_train=1.778535 (no previous merge yet)
[S17] round=16 local utility u=0.086122 metrics={'f1_val': 0.23557332055226043, 'auprc': 0.23557332055226043, 'loss_val': 1.0564206239516118, 'psi': 0.23557332055226043}-{'f1_val': 0.2072853430246294, 'auprc': 0.2072853430246294, 'loss_val': 0.9740736865125277, 'psi': 0.2072853430246294}
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:49315
[S7] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:49305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=-0.0433
[S15] DROPPED delta from S11 (cos=-0.0433 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S2
[S15] cosine check vs S2: cos=0.7502
[S5] RECEIVED delta(kind=head bytes=1807) from S15
[S5] cosine check vs S15: cos=0.9875
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.5588
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.9927
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.2303 head_norm=1.348464
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.205264e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.2008 head_norm=1.392915 delta_norm=0.120526
[S5] aggregate: ROLLBACK (f1_val pre=0.230 post=0.201 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.2974 head_norm=1.781223
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.086971e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.2979 head_norm=1.789761 delta_norm=0.108697
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.6149 head_norm=1.446072
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.176839e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.6143 head_norm=1.369511 delta_norm=0.517684
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.0017 head_norm=1.031677
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.459000e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.0000 head_norm=1.262289 delta_norm=0.745900
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.481887 cos_to_last_merge=0.9853 (last merge round=14)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.2454789833822092, 'auprc': 0.2454789833822092, 'loss_val': 1.8337926865180751, 'psi': 0.2454789833822092}-{'f1_val': 0.24624624624624625, 'auprc': 0.24624624624624625, 'loss_val': 1.6863183157199104, 'psi': 0.24624624624624625}
[S3] START round=17 head_norm_before_train=1.789761 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.004534 metrics={'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.250386935776787, 'psi': 0.29792295726964957}-{'f1_val': 0.2973964063072974, 'auprc': 0.2973964063072974, 'loss_val': 2.2547165320077567, 'psi': 0.2973964063072974}
[S4] START round=17 head_norm_before_train=1.908724 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1495753665815367, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1274538083399028, 'psi': 0.3567939207526687}
[S5] START round=17 head_norm_before_train=1.392915 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=1.000000 metrics={'f1_val': 0.4626371037819541, 'auprc': 0.4626371037819541, 'loss_val': 1.2988953862303672, 'psi': 0.4626371037819541}-{'f1_val': 0.23034961817366584, 'auprc': 0.23034961817366584, 'loss_val': 1.3239281817717141, 'psi': 0.23034961817366584}
[S6] START round=17 head_norm_before_train=1.791778 (no previous merge yet)
[S6] round=17 local utility u=0.017058 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 6.446416758507859, 'psi': 0.021310724106324473}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.442690031748039, 'psi': 0.017105871474803514}
[S7] START round=17 head_norm_before_train=1.417069 (no previous merge yet)
[S7] round=17 local utility u=0.916125 metrics={'f1_val': 0.1985602879424115, 'auprc': 0.1985602879424115, 'loss_val': 1.360309647977744, 'psi': 0.1985602879424115}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4055177558316467, 'psi': 0.0}
[S8] START round=17 head_norm_before_train=1.896163 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2610024826540835, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1985993703833013, 'psi': 0.35939447907390915}
[S9] START round=17 head_norm_before_train=1.798645 cos_to_last_merge=0.9981 (last merge round=14)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7602166895183184, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5822737769294284, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.959716 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.23343003793796027, 'auprc': 0.23343003793796027, 'loss_val': 1.4387454021382173, 'psi': 0.23343003793796027}-{'f1_val': 0.2455975581122329, 'auprc': 0.2455975581122329, 'loss_val': 1.5019992383958327, 'psi': 0.2455975581122329}
[S11] START round=17 head_norm_before_train=1.899400 cos_to_last_merge=0.9993 (last merge round=15)
[S11] round=17 local utility u=0.175515 metrics={'f1_val': 0.3315508021390374, 'auprc': 0.3315508021390374, 'loss_val': 1.508131255191569, 'psi': 0.3315508021390374}-{'f1_val': 0.3129117259552042, 'auprc': 0.3129117259552042, 'loss_val': 1.6914094036740788, 'psi': 0.3129117259552042}
[S13] START round=17 head_norm_before_train=1.636305 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5223729847401852, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4824422032944882, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=1.611569 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 4.929442631411331, 'psi': 0.13253012048192772}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.866847938585781, 'psi': 0.13572854291417166}
[S15] START round=17 head_norm_before_train=1.369511 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6133277639015066, 'auprc': 0.6133277639015066, 'loss_val': 0.7980905149237469, 'psi': 0.6133277639015066}-{'f1_val': 0.6148779833831352, 'auprc': 0.6148779833831352, 'loss_val': 0.7325668226265234, 'psi': 0.6148779833831352}
[S16] START round=17 head_norm_before_train=1.262289 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.455666 metrics={'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 2.282212143915732, 'psi': 0.0890603649224339}-{'f1_val': 0.0016759776536312849, 'auprc': 0.0016759776536312849, 'loss_val': 2.4070853663155836, 'psi': 0.0016759776536312849}
[S17] START round=17 head_norm_before_train=1.804817 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.20974822592727568, 'auprc': 0.20974822592727568, 'loss_val': 1.1570182994797629, 'psi': 0.20974822592727566}-{'f1_val': 0.23557332055226043, 'auprc': 0.23557332055226043, 'loss_val': 1.0564206239516118, 'psi': 0.23557332055226043}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.199)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.021)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:49302
[S16] not sending this round → trigger blocked (psi=0.089)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] cosine check vs S11: cos=-0.0212
[S15] DROPPED delta from S11 (cos=-0.0212 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.4055
[S2] RECEIVED delta(kind=head bytes=1804) from S3
[S2] cosine check vs S3: cos=0.7593
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.2455 head_norm=1.546783
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.957081e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.2455 head_norm=1.575667 delta_norm=0.595708
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.0891 head_norm=1.301242
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.436162e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.0890 head_norm=1.141279 delta_norm=0.743616
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.575667 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.129351 metrics={'f1_val': 0.24534408011235267, 'auprc': 0.24534408011235267, 'loss_val': 1.5738757807119848, 'psi': 0.24534408011235267}-{'f1_val': 0.2454789833822092, 'auprc': 0.2454789833822092, 'loss_val': 1.8337926865180751, 'psi': 0.2454789833822092}
[S3] START round=18 head_norm_before_train=1.811808 cos_to_last_merge=0.9993 (last merge round=16)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.29802414928649834, 'auprc': 0.29802414928649834, 'loss_val': 2.3368884458124337, 'psi': 0.29802414928649834}-{'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.250386935776787, 'psi': 0.29792295726964957}
[S4] START round=18 head_norm_before_train=1.925249 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1654575701331418, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1495753665815367, 'psi': 0.3567939207526687}
[S5] START round=18 head_norm_before_train=1.420469 cos_to_last_merge=0.9992 (last merge round=16)
[S5] round=18 local utility u=0.167606 metrics={'f1_val': 0.49643421814677163, 'auprc': 0.49643421814677163, 'loss_val': 1.2678575069095797, 'psi': 0.49643421814677163}-{'f1_val': 0.4626371037819541, 'auprc': 0.4626371037819541, 'loss_val': 1.2988953862303672, 'psi': 0.4626371037819541}
[S6] START round=18 head_norm_before_train=1.808154 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 6.7906155271773185, 'psi': 0.016882516188714152}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 6.446416758507859, 'psi': 0.021310724106324473}
[S7] START round=18 head_norm_before_train=1.428108 (no previous merge yet)
[S7] round=18 local utility u=0.035110 metrics={'f1_val': 0.2056239015817223, 'auprc': 0.2056239015817223, 'loss_val': 1.3536630398585319, 'psi': 0.2056239015817223}-{'f1_val': 0.1985602879424115, 'auprc': 0.1985602879424115, 'loss_val': 1.360309647977744, 'psi': 0.1985602879424115}
[S8] START round=18 head_norm_before_train=1.915465 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.313484055299036, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2610024826540835, 'psi': 0.35939447907390915}
[S9] START round=18 head_norm_before_train=1.826651 cos_to_last_merge=0.9963 (last merge round=14)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8403635604909911, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7602166895183184, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=2.003317 (no previous merge yet)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.23244444444444445, 'auprc': 0.23244444444444445, 'loss_val': 1.4461688314238106, 'psi': 0.23244444444444445}-{'f1_val': 0.23343003793796027, 'auprc': 0.23343003793796027, 'loss_val': 1.4387454021382173, 'psi': 0.23343003793796027}
[S11] START round=18 head_norm_before_train=1.918648 cos_to_last_merge=0.9978 (last merge round=15)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.3315508021390374, 'auprc': 0.3315508021390374, 'loss_val': 1.6137623522196791, 'psi': 0.3315508021390374}-{'f1_val': 0.3315508021390374, 'auprc': 0.3315508021390374, 'loss_val': 1.508131255191569, 'psi': 0.3315508021390374}
[S13] START round=18 head_norm_before_train=1.657222 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5279245647825996, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5223729847401852, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.638650 (no previous merge yet)
[S14] round=18 local utility u=0.002703 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.952821449184583, 'psi': 0.13572854291417166}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 4.929442631411331, 'psi': 0.13253012048192772}
[S15] START round=18 head_norm_before_train=1.463936 cos_to_last_merge=0.9934 (last merge round=16)
[S15] round=18 local utility u=0.079972 metrics={'f1_val': 0.6146560490259613, 'auprc': 0.6146560490259613, 'loss_val': 0.6501008829641286, 'psi': 0.6146560490259613}-{'f1_val': 0.6133277639015066, 'auprc': 0.6133277639015066, 'loss_val': 0.7980905149237469, 'psi': 0.6133277639015066}
[S16] START round=18 head_norm_before_train=1.141279 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 2.373916628189783, 'psi': 0.0890603649224339}-{'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 2.282212143915732, 'psi': 0.0890603649224339}
[S17] START round=18 head_norm_before_train=1.837539 (no previous merge yet)
[S17] round=18 local utility u=0.363921 metrics={'f1_val': 0.2751182058656057, 'auprc': 0.2751182058656057, 'loss_val': 1.0175052699284384, 'psi': 0.2751182058656057}-{'f1_val': 0.20974822592727568, 'auprc': 0.20974822592727568, 'loss_val': 1.1570182994797629, 'psi': 0.20974822592727566}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] cosine check vs S7: cos=-0.0575
[S3] DROPPED delta from S7 (cos=-0.0575 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] cosine check vs S2: cos=0.7801
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.9469
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.8322
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.9894
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.2980 head_norm=1.837020
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.344695e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.2979 head_norm=1.840901 delta_norm=0.134469
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.4964 head_norm=1.449037
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.513272e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.4980 head_norm=1.484633 delta_norm=0.251327
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.6147 head_norm=1.560414
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.315705e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.6142 head_norm=1.508749 delta_norm=0.531570
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.0891 head_norm=1.186817
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.018146e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.0891 head_norm=1.262009 delta_norm=0.401815
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.637954 cos_to_last_merge=0.9963 (last merge round=17)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 1.8907146799991048, 'psi': 0.26531826293872696}-{'f1_val': 0.24534408011235267, 'auprc': 0.24534408011235267, 'loss_val': 1.5738757807119848, 'psi': 0.24534408011235267}
[S3] START round=19 head_norm_before_train=1.840901 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.080906 metrics={'f1_val': 0.2999554962171785, 'auprc': 0.2999554962171785, 'loss_val': 2.1924591121946255, 'psi': 0.2999554962171785}-{'f1_val': 0.29802414928649834, 'auprc': 0.29802414928649834, 'loss_val': 2.3368884458124337, 'psi': 0.29802414928649834}
[S4] START round=19 head_norm_before_train=1.945787 (no previous merge yet)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2039347071508173, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1654575701331418, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.484633 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.009124 metrics={'f1_val': 0.4947215055131589, 'auprc': 0.4947215055131589, 'loss_val': 1.2341958408874718, 'psi': 0.49472150551315897}-{'f1_val': 0.49643421814677163, 'auprc': 0.49643421814677163, 'loss_val': 1.2678575069095797, 'psi': 0.49643421814677163}
[S6] START round=19 head_norm_before_train=1.823872 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.831922707391769, 'psi': 0.017551963048498844}-{'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 6.7906155271773185, 'psi': 0.016882516188714152}
[S7] START round=19 head_norm_before_train=1.436379 (no previous merge yet)
[S7] round=19 local utility u=0.230915 metrics={'f1_val': 0.24837255883825737, 'auprc': 0.24837255883825737, 'loss_val': 1.2765715128691224, 'psi': 0.24837255883825737}-{'f1_val': 0.2056239015817223, 'auprc': 0.2056239015817223, 'loss_val': 1.3536630398585319, 'psi': 0.2056239015817223}
[S8] START round=19 head_norm_before_train=1.936749 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3491172702380907, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.313484055299036, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.851961 cos_to_last_merge=0.9944 (last merge round=14)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8531532680510931, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8403635604909911, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=2.042670 (no previous merge yet)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.23369079535299375, 'auprc': 0.23369079535299375, 'loss_val': 1.4873432598122094, 'psi': 0.23369079535299375}-{'f1_val': 0.23244444444444445, 'auprc': 0.23244444444444445, 'loss_val': 1.4461688314238106, 'psi': 0.23244444444444445}
[S11] START round=19 head_norm_before_train=1.934175 cos_to_last_merge=0.9962 (last merge round=15)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 1.9787259135180002, 'psi': 0.33185875048506014}-{'f1_val': 0.3315508021390374, 'auprc': 0.3315508021390374, 'loss_val': 1.6137623522196791, 'psi': 0.3315508021390374}
[S13] START round=19 head_norm_before_train=1.667684 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.545896349116458, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5279245647825996, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.664850 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.028846602050944, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.952821449184583, 'psi': 0.13572854291417166}
[S15] START round=19 head_norm_before_train=1.508749 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6134692087909857, 'auprc': 0.6134692087909857, 'loss_val': 0.7416673373655227, 'psi': 0.6134692087909857}-{'f1_val': 0.6146560490259613, 'auprc': 0.6146560490259613, 'loss_val': 0.6501008829641286, 'psi': 0.6146560490259613}
[S16] START round=19 head_norm_before_train=1.262009 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 2.5101767626626263, 'psi': 0.0890603649224339}-{'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 2.373916628189783, 'psi': 0.0890603649224339}
[S17] START round=19 head_norm_before_train=1.854551 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.26370718435499735, 'auprc': 0.26370718435499735, 'loss_val': 1.0967665697153948, 'psi': 0.26370718435499735}-{'f1_val': 0.2751182058656057, 'auprc': 0.2751182058656057, 'loss_val': 1.0175052699284384, 'psi': 0.2751182058656057}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49316
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:49302
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=-0.0612
[S3] DROPPED delta from S7 (cos=-0.0612 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.9414
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=0.8879
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=20 psi=0.234 u=0.0000 p_local=0.0795 f1=0.234 auprc=0.234 bytes=12608
[S13] r=20 psi=0.360 u=0.0000 p_local=0.0383 f1=0.360 auprc=0.360 bytes=7206
[S6] r=20 psi=0.018 u=0.0000 p_local=0.0271 f1=0.018 auprc=0.018 bytes=0
[S9] r=20 psi=0.369 u=0.0000 p_local=0.1958 f1=0.369 auprc=0.369 bytes=3601
[S15] r=20 psi=0.613 u=0.0000 p_local=0.1448 f1=0.613 auprc=0.613 bytes=19816
[S14] r=20 psi=0.136 u=0.0000 p_local=0.0714 f1=0.136 auprc=0.136 bytes=0
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.2653 head_norm=1.706545
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.291746e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.2653 head_norm=1.733661 delta_norm=0.429175
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.265 u=0.0000 p_local=0.1275 f1=0.265 auprc=0.265 bytes=8996
[S4] r=20 psi=0.357 u=0.0000 p_local=0.0354 f1=0.357 auprc=0.357 bytes=16194
[S11] r=20 psi=0.332 u=0.0000 p_local=0.1660 f1=0.332 auprc=0.332 bytes=3602
[S8] r=20 psi=0.359 u=0.0000 p_local=0.0447 f1=0.359 auprc=0.359 bytes=9009
[S5] r=20 psi=0.495 u=0.0091 p_local=0.2534 f1=0.495 auprc=0.495 bytes=7187
[S3] r=20 psi=0.300 u=0.0809 p_local=0.1229 f1=0.300 auprc=0.300 bytes=7208
[S7] r=20 psi=0.248 u=0.2309 p_local=0.1955 f1=0.248 auprc=0.248 bytes=3596
[S17] r=20 psi=0.264 u=0.0000 p_local=0.1137 f1=0.264 auprc=0.264 bytes=21582
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.0891 head_norm=1.307069
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.618397e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.0891 head_norm=1.389477 delta_norm=0.261840
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.089 u=0.0000 p_local=0.2125 f1=0.089 auprc=0.089 bytes=0
[S2] START round=20 head_norm_before_train=1.733661 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.040945 metrics={'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 1.629866099227513, 'psi': 0.24543399914482925}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 1.8907146799991048, 'psi': 0.26531826293872696}
[S3] START round=20 head_norm_before_train=1.862054 cos_to_last_merge=0.9994 (last merge round=18)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.5434700932126435, 'psi': 0.29792295726964957}-{'f1_val': 0.2999554962171785, 'auprc': 0.2999554962171785, 'loss_val': 2.1924591121946255, 'psi': 0.2999554962171785}
[S4] START round=20 head_norm_before_train=1.966965 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2039678312168562, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2039347071508173, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.513270 cos_to_last_merge=0.9994 (last merge round=18)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.33319408286411983, 'auprc': 0.33319408286411983, 'loss_val': 1.2572209640780687, 'psi': 0.33319408286411983}-{'f1_val': 0.4947215055131589, 'auprc': 0.4947215055131589, 'loss_val': 1.2341958408874718, 'psi': 0.49472150551315897}
[S6] START round=20 head_norm_before_train=1.838349 (no previous merge yet)
[S6] round=20 local utility u=0.122399 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 6.630803926539692, 'psi': 0.02240512117055327}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.831922707391769, 'psi': 0.017551963048498844}
[S7] START round=20 head_norm_before_train=1.447925 (no previous merge yet)
[S7] round=20 local utility u=0.006578 metrics={'f1_val': 0.24627619288058572, 'auprc': 0.24627619288058572, 'loss_val': 1.2445491778865192, 'psi': 0.24627619288058572}-{'f1_val': 0.24837255883825737, 'auprc': 0.24837255883825737, 'loss_val': 1.2765715128691224, 'psi': 0.24837255883825737}
[S8] START round=20 head_norm_before_train=1.955202 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4058247238624817, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3491172702380907, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.874750 cos_to_last_merge=0.9927 (last merge round=14)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9376241204190805, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8531532680510931, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=2.076599 (no previous merge yet)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.22878390201224846, 'auprc': 0.22878390201224846, 'loss_val': 1.4739782971401512, 'psi': 0.22878390201224846}-{'f1_val': 0.23369079535299375, 'auprc': 0.23369079535299375, 'loss_val': 1.4873432598122094, 'psi': 0.23369079535299375}
[S11] START round=20 head_norm_before_train=1.947504 cos_to_last_merge=0.9946 (last merge round=15)
[S11] round=20 local utility u=0.043974 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 1.8879997360984386, 'psi': 0.33154997286190585}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 1.9787259135180002, 'psi': 0.33185875048506014}
[S13] START round=20 head_norm_before_train=1.676032 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5611898915676545, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.545896349116458, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.688317 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.125894281584698, 'psi': 0.13533083645443197}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.028846602050944, 'psi': 0.13572854291417166}
[S15] START round=20 head_norm_before_train=1.579669 cos_to_last_merge=0.9966 (last merge round=18)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.5993196106670667, 'auprc': 0.5993196106670667, 'loss_val': 0.722747809703672, 'psi': 0.5993196106670667}-{'f1_val': 0.6134692087909857, 'auprc': 0.6134692087909857, 'loss_val': 0.7416673373655227, 'psi': 0.6134692087909857}
[S16] START round=20 head_norm_before_train=1.389477 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.046759 metrics={'f1_val': 0.0894132755437836, 'auprc': 0.0894132755437836, 'loss_val': 2.4198354640361326, 'psi': 0.0894132755437836}-{'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 2.5101767626626263, 'psi': 0.0890603649224339}
[S17] START round=20 head_norm_before_train=1.872051 (no previous merge yet)
[S17] round=20 local utility u=0.582694 metrics={'f1_val': 0.3986413991697077, 'auprc': 0.3986413991697077, 'loss_val': 1.1457869321718717, 'psi': 0.3986413991697077}-{'f1_val': 0.26370718435499735, 'auprc': 0.26370718435499735, 'loss_val': 1.0967665697153948, 'psi': 0.26370718435499735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:49315
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:49303
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.089)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[S6] not sending this round → trigger blocked (psi=0.022)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S7
[S3] cosine check vs S7: cos=-0.0636
[S3] DROPPED delta from S7 (cos=-0.0636 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] cosine check vs S2: cos=0.8620
[S15] RECEIVED delta(kind=head bytes=1807) from S11
[S15] cosine check vs S11: cos=-0.0077
[S15] DROPPED delta from S11 (cos=-0.0077 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.9898
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.2979 head_norm=1.885817
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.352009e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.2979 head_norm=1.886347 delta_norm=0.135201
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.098 → S2@127.0.0.1:49302
[S5] ⇄ pheromone p=0.203 → S16@127.0.0.1:49316
[S6] ⇄ pheromone p=0.046 → S8@127.0.0.1:49309
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.5993 head_norm=1.657458
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.579843e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.5981 head_norm=1.664839 delta_norm=0.457984
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.116 → S5@127.0.0.1:49305
[S14] ⇄ pheromone p=0.057 → S8@127.0.0.1:49309
[S8] ⇄ pheromone p=0.036 → S9@127.0.0.1:49310
[S9] ⇄ pheromone p=0.157 → S16@127.0.0.1:49316
[S10] ⇄ pheromone p=0.064 → S9@127.0.0.1:49310
[S4] ⇄ pheromone p=0.028 → S11@127.0.0.1:49312
[S13] ⇄ pheromone p=0.031 → S10@127.0.0.1:49311
[S7] ⇄ pheromone p=0.158 → S3@127.0.0.1:49303
[S2] ⇄ pheromone p=0.110 → S15@127.0.0.1:49315
[S11] ⇄ pheromone p=0.142 → S15@127.0.0.1:49315
[S17] ⇄ pheromone p=0.207 → S3@127.0.0.1:49303
[S16] ⇄ pheromone p=0.179 → S14@127.0.0.1:49314
[S2] START round=21 head_norm_before_train=1.793241 cos_to_last_merge=0.9966 (last merge round=19)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.25706973768394115, 'auprc': 0.25706973768394115, 'loss_val': 1.7583794064645104, 'psi': 0.25706973768394115}-{'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 1.629866099227513, 'psi': 0.24543399914482925}
[S3] START round=21 head_norm_before_train=1.886347 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.063363 metrics={'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.4169188297762374, 'psi': 0.2979423868312757}-{'f1_val': 0.29792295726964957, 'auprc': 0.29792295726964957, 'loss_val': 2.5434700932126435, 'psi': 0.29792295726964957}
[S4] START round=21 head_norm_before_train=1.980835 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2236077468753337, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2039678312168562, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.542095 cos_to_last_merge=0.9980 (last merge round=18)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.33501365259399285, 'auprc': 0.33501365259399285, 'loss_val': 1.7691489824179965, 'psi': 0.33501365259399285}-{'f1_val': 0.33319408286411983, 'auprc': 0.33319408286411983, 'loss_val': 1.2572209640780687, 'psi': 0.33319408286411983}
[S6] START round=21 head_norm_before_train=1.851870 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 7.00054236874166, 'psi': 0.01732902033271719}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 6.630803926539692, 'psi': 0.02240512117055327}
[S7] START round=21 head_norm_before_train=1.463236 (no previous merge yet)
[S7] round=21 local utility u=0.018400 metrics={'f1_val': 0.24672708962739173, 'auprc': 0.24672708962739173, 'loss_val': 1.2118063229368068, 'psi': 0.24672708962739173}-{'f1_val': 0.24627619288058572, 'auprc': 0.24627619288058572, 'loss_val': 1.2445491778865192, 'psi': 0.24627619288058572}
[S8] START round=21 head_norm_before_train=1.971580 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4608307307201258, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4058247238624817, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.895254 cos_to_last_merge=0.9910 (last merge round=14)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0419338610196083, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9376241204190805, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=2.107307 (no previous merge yet)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.22451169778922517, 'auprc': 0.22451169778922517, 'loss_val': 1.4976774942920839, 'psi': 0.22451169778922517}-{'f1_val': 0.22878390201224846, 'auprc': 0.22878390201224846, 'loss_val': 1.4739782971401512, 'psi': 0.22878390201224846}
[S11] START round=21 head_norm_before_train=1.963896 cos_to_last_merge=0.9926 (last merge round=15)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.30341698567985254, 'auprc': 0.30341698567985254, 'loss_val': 1.6899847957900633, 'psi': 0.30341698567985254}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 1.8879997360984386, 'psi': 0.33154997286190585}
[S13] START round=21 head_norm_before_train=1.690888 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5870413353930253, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5611898915676545, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.709044 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.227051804341975, 'psi': 0.13592717296421}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.125894281584698, 'psi': 0.13533083645443197}
[S15] START round=21 head_norm_before_train=1.664839 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.044517 metrics={'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.7628705723445811, 'psi': 0.6136702686915539}-{'f1_val': 0.5993196106670667, 'auprc': 0.5993196106670667, 'loss_val': 0.722747809703672, 'psi': 0.5993196106670667}
[S16] START round=21 head_norm_before_train=1.432169 cos_to_last_merge=0.9958 (last merge round=19)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 2.7750849394474244, 'psi': 0.08899598393574297}-{'f1_val': 0.0894132755437836, 'auprc': 0.0894132755437836, 'loss_val': 2.4198354640361326, 'psi': 0.0894132755437836}
[S17] START round=21 head_norm_before_train=1.896539 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.25124794494138597, 'auprc': 0.25124794494138597, 'loss_val': 1.2768699738186604, 'psi': 0.25124794494138597}-{'f1_val': 0.3986413991697077, 'auprc': 0.3986413991697077, 'loss_val': 1.1457869321718717, 'psi': 0.3986413991697077}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:49302
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:49305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=-0.0649
[S3] DROPPED delta from S7 (cos=-0.0649 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.8112
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] cosine check vs S3: cos=0.9300
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.3350 head_norm=1.568719
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.131007e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.2483 head_norm=1.570843 delta_norm=0.513101
[S5] aggregate: ROLLBACK (f1_val pre=0.335 post=0.248 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.2571 head_norm=1.854955
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.529287e-01
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.2564 head_norm=1.848146 delta_norm=0.352929
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.848146 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.003509 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.826314219015831, 'psi': 0.2653978324081417}-{'f1_val': 0.25706973768394115, 'auprc': 0.25706973768394115, 'loss_val': 1.7583794064645104, 'psi': 0.25706973768394115}
[S3] START round=22 head_norm_before_train=1.907760 cos_to_last_merge=0.9996 (last merge round=20)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.2977789964354264, 'auprc': 0.2977789964354264, 'loss_val': 2.482063207521015, 'psi': 0.2977789964354264}-{'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.4169188297762374, 'psi': 0.2979423868312757}
[S4] START round=22 head_norm_before_train=1.995421 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2434235191727696, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2236077468753337, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.570843 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.7919762502588568, 'psi': 0.33451196111837667}-{'f1_val': 0.33501365259399285, 'auprc': 0.33501365259399285, 'loss_val': 1.7691489824179965, 'psi': 0.33501365259399285}
[S6] START round=22 head_norm_before_train=1.863610 (no previous merge yet)
[S6] round=22 local utility u=0.125391 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 6.797410175478594, 'psi': 0.02262340036563071}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 7.00054236874166, 'psi': 0.01732902033271719}
[S7] START round=22 head_norm_before_train=1.476053 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.23484449130205587, 'auprc': 0.23484449130205587, 'loss_val': 1.1808331340450238, 'psi': 0.23484449130205587}-{'f1_val': 0.24672708962739173, 'auprc': 0.24672708962739173, 'loss_val': 1.2118063229368068, 'psi': 0.24672708962739173}
[S8] START round=22 head_norm_before_train=1.991038 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.510763698532863, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4608307307201258, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.913405 cos_to_last_merge=0.9895 (last merge round=14)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0966678570439403, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0419338610196083, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=2.133273 (no previous merge yet)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.22307528257624226, 'auprc': 0.22307528257624226, 'loss_val': 1.5146933473745143, 'psi': 0.22307528257624226}-{'f1_val': 0.22451169778922517, 'auprc': 0.22451169778922517, 'loss_val': 1.4976774942920839, 'psi': 0.22451169778922517}
[S11] START round=22 head_norm_before_train=1.977774 cos_to_last_merge=0.9910 (last merge round=15)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.3002244668911335, 'auprc': 0.3002244668911335, 'loss_val': 1.7331290808342406, 'psi': 0.3002244668911335}-{'f1_val': 0.30341698567985254, 'auprc': 0.30341698567985254, 'loss_val': 1.6899847957900633, 'psi': 0.30341698567985254}
[S13] START round=22 head_norm_before_train=1.707913 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.614210136440197, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5870413353930253, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.727004 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.332858758567469, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.227051804341975, 'psi': 0.13592717296421}
[S15] START round=22 head_norm_before_train=1.732271 cos_to_last_merge=0.9970 (last merge round=20)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6039731450602449, 'auprc': 0.6039731450602449, 'loss_val': 0.7423791063900064, 'psi': 0.6039731450602449}-{'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.7628705723445811, 'psi': 0.6136702686915539}
[S16] START round=22 head_norm_before_train=1.481358 cos_to_last_merge=0.9866 (last merge round=19)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 3.102418053713418, 'psi': 0.08899598393574297}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 2.7750849394474244, 'psi': 0.08899598393574297}
[S17] START round=22 head_norm_before_train=1.922697 (no previous merge yet)
[S17] round=22 local utility u=0.556320 metrics={'f1_val': 0.3773030022629202, 'auprc': 0.3773030022629202, 'loss_val': 1.29872587315886, 'psi': 0.3773030022629202}-{'f1_val': 0.25124794494138597, 'auprc': 0.25124794494138597, 'loss_val': 1.2768699738186604, 'psi': 0.25124794494138597}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.023)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=0.9128
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.9910
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.6040 head_norm=1.795306
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.885629e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.6029 head_norm=1.805242 delta_norm=0.388563
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.2978 head_norm=1.927666
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.301277e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.3005 head_norm=1.930733 delta_norm=0.130128
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.896479 cos_to_last_merge=0.9979 (last merge round=21)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.2635844293875382, 'auprc': 0.2635844293875382, 'loss_val': 2.0430012253648253, 'psi': 0.2635844293875382}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.826314219015831, 'psi': 0.2653978324081417}
[S3] START round=23 head_norm_before_train=1.930733 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.060776 metrics={'f1_val': 0.3013080739738385, 'auprc': 0.3013080739738385, 'loss_val': 2.392272615084683, 'psi': 0.3013080739738385}-{'f1_val': 0.2977789964354264, 'auprc': 0.2977789964354264, 'loss_val': 2.482063207521015, 'psi': 0.2977789964354264}
[S4] START round=23 head_norm_before_train=2.009997 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2464298477538787, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2434235191727696, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.595533 cos_to_last_merge=0.9994 (last merge round=21)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.0597517883337826, 'psi': 0.33409214683912186}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.7919762502588568, 'psi': 0.33451196111837667}
[S6] START round=23 head_norm_before_train=1.874934 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 7.175009391178639, 'psi': 0.01732902033271719}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 6.797410175478594, 'psi': 0.02262340036563071}
[S7] START round=23 head_norm_before_train=1.490786 (no previous merge yet)
[S7] round=23 local utility u=0.090872 metrics={'f1_val': 0.2485007496251874, 'auprc': 0.2485007496251874, 'loss_val': 1.1219960978582582, 'psi': 0.24850074962518742}-{'f1_val': 0.23484449130205587, 'auprc': 0.23484449130205587, 'loss_val': 1.1808331340450238, 'psi': 0.23484449130205587}
[S8] START round=23 head_norm_before_train=2.004433 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.558015901308994, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.510763698532863, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.929816 cos_to_last_merge=0.9882 (last merge round=14)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1327146032090205, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0966678570439403, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=2.157237 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.22048903878583473, 'auprc': 0.22048903878583473, 'loss_val': 1.524294121904654, 'psi': 0.22048903878583476}-{'f1_val': 0.22307528257624226, 'auprc': 0.22307528257624226, 'loss_val': 1.5146933473745143, 'psi': 0.22307528257624226}
[S11] START round=23 head_norm_before_train=1.990727 cos_to_last_merge=0.9895 (last merge round=15)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.28844857797546836, 'auprc': 0.28844857797546836, 'loss_val': 1.7268452685926619, 'psi': 0.28844857797546836}-{'f1_val': 0.3002244668911335, 'auprc': 0.3002244668911335, 'loss_val': 1.7331290808342406, 'psi': 0.3002244668911335}
[S13] START round=23 head_norm_before_train=1.723305 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.639291862639855, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.614210136440197, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.742934 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.4395235565168925, 'psi': 0.13413413413413414}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.332858758567469, 'psi': 0.13587634006482174}
[S15] START round=23 head_norm_before_train=1.805242 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6000775699094484, 'auprc': 0.6000775699094484, 'loss_val': 0.8335453457150678, 'psi': 0.6000775699094484}-{'f1_val': 0.6039731450602449, 'auprc': 0.6039731450602449, 'loss_val': 0.7423791063900064, 'psi': 0.6039731450602449}
[S16] START round=23 head_norm_before_train=1.526880 cos_to_last_merge=0.9770 (last merge round=19)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 3.6446853476520897, 'psi': 0.0890603649224339}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 3.102418053713418, 'psi': 0.08899598393574297}
[S17] START round=23 head_norm_before_train=1.942532 (no previous merge yet)
[S17] round=23 local utility u=0.152584 metrics={'f1_val': 0.40981369735297535, 'auprc': 0.40981369735297535, 'loss_val': 1.2861536054401639, 'psi': 0.40981369735297535}-{'f1_val': 0.3773030022629202, 'auprc': 0.3773030022629202, 'loss_val': 1.29872587315886, 'psi': 0.3773030022629202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:49302
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=-0.0667
[S3] DROPPED delta from S7 (cos=-0.0667 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1805) from S3
[S2] cosine check vs S3: cos=0.9540
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.9957
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.2636 head_norm=1.944365
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.950955e-01
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.2642 head_norm=1.923514 delta_norm=0.295096
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.3013 head_norm=1.947671
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.071111e-02
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.3010 head_norm=1.952303 delta_norm=0.090711
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.923514 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 1.9443580352512155, 'psi': 0.2450298816928894}-{'f1_val': 0.2635844293875382, 'auprc': 0.2635844293875382, 'loss_val': 2.0430012253648253, 'psi': 0.2635844293875382}
[S3] START round=24 head_norm_before_train=1.952303 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.5341122018619044, 'psi': 0.2979423868312757}-{'f1_val': 0.3013080739738385, 'auprc': 0.3013080739738385, 'loss_val': 2.392272615084683, 'psi': 0.3013080739738385}
[S4] START round=24 head_norm_before_train=2.027852 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2720302574757336, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2464298477538787, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.625136 cos_to_last_merge=0.9979 (last merge round=21)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.2527275933364797, 'psi': 0.33358943696313936}-{'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.0597517883337826, 'psi': 0.33409214683912186}
[S6] START round=24 head_norm_before_train=1.886103 (no previous merge yet)
[S6] round=24 local utility u=0.236733 metrics={'f1_val': 0.026947463768115944, 'auprc': 0.026947463768115944, 'loss_val': 6.788110329149686, 'psi': 0.026947463768115944}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 7.175009391178639, 'psi': 0.01732902033271719}
[S7] START round=24 head_norm_before_train=1.504432 (no previous merge yet)
[S7] round=24 local utility u=0.399684 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0838846962443716, 'psi': 0.33308476261496395}-{'f1_val': 0.2485007496251874, 'auprc': 0.2485007496251874, 'loss_val': 1.1219960978582582, 'psi': 0.24850074962518742}
[S8] START round=24 head_norm_before_train=2.018194 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.620414327440078, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.558015901308994, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.944376 cos_to_last_merge=0.9869 (last merge round=14)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1784875746986345, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1327146032090205, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=2.178771 (no previous merge yet)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.21791666666666668, 'auprc': 0.21791666666666668, 'loss_val': 1.537690982221832, 'psi': 0.21791666666666668}-{'f1_val': 0.22048903878583473, 'auprc': 0.22048903878583473, 'loss_val': 1.524294121904654, 'psi': 0.22048903878583476}
[S11] START round=24 head_norm_before_train=2.005621 cos_to_last_merge=0.9879 (last merge round=15)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.29403682330310527, 'auprc': 0.29403682330310527, 'loss_val': 1.7969905100567376, 'psi': 0.29403682330310527}-{'f1_val': 0.28844857797546836, 'auprc': 0.28844857797546836, 'loss_val': 1.7268452685926619, 'psi': 0.28844857797546836}
[S13] START round=24 head_norm_before_train=1.740430 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.677396481978724, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.639291862639855, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.757642 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.12039532794249776, 'auprc': 0.12039532794249776, 'loss_val': 5.561444020607903, 'psi': 0.12039532794249776}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.4395235565168925, 'psi': 0.13413413413413414}
[S15] START round=24 head_norm_before_train=1.860894 cos_to_last_merge=0.9980 (last merge round=22)
[S15] round=24 local utility u=0.128732 metrics={'f1_val': 0.6128212875761547, 'auprc': 0.6128212875761547, 'loss_val': 0.690773965104145, 'psi': 0.6128212875761547}-{'f1_val': 0.6000775699094484, 'auprc': 0.6000775699094484, 'loss_val': 0.8335453457150678, 'psi': 0.6000775699094484}
[S16] START round=24 head_norm_before_train=1.564549 cos_to_last_merge=0.9693 (last merge round=19)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 3.749823429990697, 'psi': 0.0890603649224339}-{'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 3.6446853476520897, 'psi': 0.0890603649224339}
[S17] START round=24 head_norm_before_train=1.961123 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.3986413991697077, 'auprc': 0.3986413991697077, 'loss_val': 1.387563874109817, 'psi': 0.3986413991697077}-{'f1_val': 0.40981369735297535, 'auprc': 0.40981369735297535, 'loss_val': 1.2861536054401639, 'psi': 0.40981369735297535}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:49303
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:49305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.027)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S7
[S3] cosine check vs S7: cos=-0.0670
[S3] DROPPED delta from S7 (cos=-0.0670 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S15
[S5] cosine check vs S15: cos=0.9094
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.3336 head_norm=1.653493
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.033521e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.3340 head_norm=1.748653 delta_norm=0.403352
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.964841 cos_to_last_merge=0.9986 (last merge round=23)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.058670682804452, 'psi': 0.2450298816928894}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 1.9443580352512155, 'psi': 0.2450298816928894}
[S3] START round=25 head_norm_before_train=1.971089 cos_to_last_merge=0.9996 (last merge round=23)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.6961462099434685, 'psi': 0.2979423868312757}-{'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.5341122018619044, 'psi': 0.2979423868312757}
[S4] START round=25 head_norm_before_train=2.037882 (no previous merge yet)
[S4] round=25 local utility u=0.006442 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2591467305605764, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2720302574757336, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.748653 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.140172 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9723826282384875, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.2527275933364797, 'psi': 0.33358943696313936}
[S6] START round=25 head_norm_before_train=1.896954 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.299491499030773, 'psi': 0.017551963048498844}-{'f1_val': 0.026947463768115944, 'auprc': 0.026947463768115944, 'loss_val': 6.788110329149686, 'psi': 0.026947463768115944}
[S7] START round=25 head_norm_before_train=1.518518 (no previous merge yet)
[S7] round=25 local utility u=0.021527 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0408307904177259, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0838846962443716, 'psi': 0.33308476261496395}
[S8] START round=25 head_norm_before_train=2.032099 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6739950961007593, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.620414327440078, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.957359 cos_to_last_merge=0.9858 (last merge round=14)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2202167831622535, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1784875746986345, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=2.198853 (no previous merge yet)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.21642871922201531, 'auprc': 0.21642871922201531, 'loss_val': 1.5512522250132321, 'psi': 0.21642871922201531}-{'f1_val': 0.21791666666666668, 'auprc': 0.21791666666666668, 'loss_val': 1.537690982221832, 'psi': 0.21791666666666668}
[S11] START round=25 head_norm_before_train=2.021501 cos_to_last_merge=0.9862 (last merge round=15)
[S11] round=25 local utility u=0.062078 metrics={'f1_val': 0.32167832167832167, 'auprc': 0.32167832167832167, 'loss_val': 1.9216078936782763, 'psi': 0.32167832167832167}-{'f1_val': 0.29403682330310527, 'auprc': 0.29403682330310527, 'loss_val': 1.7969905100567376, 'psi': 0.29403682330310527}
[S13] START round=25 head_norm_before_train=1.757982 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7125751968133374, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.677396481978724, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.770927 (no previous merge yet)
[S14] round=25 local utility u=0.045287 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.608869776746604, 'psi': 0.13572854291417166}-{'f1_val': 0.12039532794249776, 'auprc': 0.12039532794249776, 'loss_val': 5.561444020607903, 'psi': 0.12039532794249776}
[S15] START round=25 head_norm_before_train=1.925336 cos_to_last_merge=0.9925 (last merge round=22)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.5984062553701254, 'auprc': 0.5984062553701254, 'loss_val': 0.7006660807113448, 'psi': 0.5984062553701254}-{'f1_val': 0.6128212875761547, 'auprc': 0.6128212875761547, 'loss_val': 0.690773965104145, 'psi': 0.6128212875761547}
[S16] START round=25 head_norm_before_train=1.595752 cos_to_last_merge=0.9633 (last merge round=19)
[S16] round=25 local utility u=0.468227 metrics={'f1_val': 0.131876300921796, 'auprc': 0.131876300921796, 'loss_val': 3.198713371165886, 'psi': 0.131876300921796}-{'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 3.749823429990697, 'psi': 0.0890603649224339}
[S17] START round=25 head_norm_before_train=1.976899 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.34028539973540767, 'auprc': 0.34028539973540767, 'loss_val': 1.4102617429170172, 'psi': 0.34028539973540767}-{'f1_val': 0.3986413991697077, 'auprc': 0.3986413991697077, 'loss_val': 1.387563874109817, 'psi': 0.3986413991697077}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.132)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49312
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S5] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=0.8103
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=-0.0709
[S3] DROPPED delta from S7 (cos=-0.0709 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.0066
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9752
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.5984 head_norm=1.978959
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.415161e+00
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.5917 head_norm=1.424592 delta_norm=1.415161
[S15] aggregate: ROLLBACK (f1_val pre=0.598 post=0.592 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.062 → S5@127.0.0.1:49305
[S8] ⇄ pheromone p=0.012 → S9@127.0.0.1:49310
[S2] ⇄ pheromone p=0.036 → S15@127.0.0.1:49315
[S3] ⇄ pheromone p=0.045 → S2@127.0.0.1:49302
[S14] ⇄ pheromone p=0.028 → S8@127.0.0.1:49309
[S9] ⇄ pheromone p=0.051 → S16@127.0.0.1:49316
[S10] ⇄ pheromone p=0.021 → S9@127.0.0.1:49310
[S6] ⇄ pheromone p=0.066 → S8@127.0.0.1:49309
[S13] ⇄ pheromone p=0.010 → S10@127.0.0.1:49311
[S4] ⇄ pheromone p=0.011 → S11@127.0.0.1:49312
[S5] ⇄ pheromone p=0.094 → S16@127.0.0.1:49316
[S7] ⇄ pheromone p=0.133 → S3@127.0.0.1:49303
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.3217 head_norm=2.036665
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.273530e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.3241 head_norm=2.027720 delta_norm=0.227353
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.059 → S15@127.0.0.1:49315
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.1319 head_norm=1.620806
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.270559e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.1334 head_norm=1.613228 delta_norm=0.527056
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.152 → S14@127.0.0.1:49314
[S17] ⇄ pheromone p=0.144 → S3@127.0.0.1:49303
[S2] START round=26 head_norm_before_train=2.007349 cos_to_last_merge=0.9952 (last merge round=23)
[S2] round=26 local utility u=0.008245 metrics={'f1_val': 0.24624624624624625, 'auprc': 0.24624624624624625, 'loss_val': 2.0531271414499495, 'psi': 0.24624624624624625}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.058670682804452, 'psi': 0.2450298816928894}
[S3] START round=26 head_norm_before_train=1.991251 cos_to_last_merge=0.9984 (last merge round=23)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.757889451155892, 'psi': 0.2979423868312757}-{'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.6961462099434685, 'psi': 0.2979423868312757}
[S4] START round=26 head_norm_before_train=2.044180 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2682094148515388, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2591467305605764, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.770191 cos_to_last_merge=0.9996 (last merge round=24)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0792113240235635, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9723826282384875, 'psi': 0.33358943696313936}
[S6] START round=26 head_norm_before_train=1.907911 (no previous merge yet)
[S6] round=26 local utility u=0.069984 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 7.19729709287919, 'psi': 0.021749084249084248}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.299491499030773, 'psi': 0.017551963048498844}
[S7] START round=26 head_norm_before_train=1.527272 (no previous merge yet)
[S7] round=26 local utility u=0.016175 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0084805036460167, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0408307904177259, 'psi': 0.33308476261496395}
[S8] START round=26 head_norm_before_train=2.048054 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.723635754687178, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6739950961007593, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.968919 cos_to_last_merge=0.9849 (last merge round=14)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.261953328384604, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2202167831622535, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=2.217448 (no previous merge yet)
[S10] round=26 local utility u=0.302421 metrics={'f1_val': 0.2859681498188777, 'auprc': 0.2859681498188777, 'loss_val': 1.5722654470285373, 'psi': 0.2859681498188777}-{'f1_val': 0.21642871922201531, 'auprc': 0.21642871922201531, 'loss_val': 1.5512522250132321, 'psi': 0.21642871922201531}
[S11] START round=26 head_norm_before_train=2.027720 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.2975942149909609, 'auprc': 0.2975942149909609, 'loss_val': 1.7937442974507423, 'psi': 0.2975942149909609}-{'f1_val': 0.32167832167832167, 'auprc': 0.32167832167832167, 'loss_val': 1.9216078936782763, 'psi': 0.32167832167832167}
[S13] START round=26 head_norm_before_train=1.770025 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7340504898111588, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7125751968133374, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.783347 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.687017236913442, 'psi': 0.13582554517133957}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.608869776746604, 'psi': 0.13572854291417166}
[S15] START round=26 head_norm_before_train=1.424592 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.8893396514708497, 'psi': 0.6136702686915539}-{'f1_val': 0.5984062553701254, 'auprc': 0.5984062553701254, 'loss_val': 0.7006660807113448, 'psi': 0.5984062553701254}
[S16] START round=26 head_norm_before_train=1.613228 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.529623 metrics={'f1_val': 0.17215815485996708, 'auprc': 0.17215815485996708, 'loss_val': 2.502004212974642, 'psi': 0.17215815485996708}-{'f1_val': 0.131876300921796, 'auprc': 0.131876300921796, 'loss_val': 3.198713371165886, 'psi': 0.131876300921796}
[S17] START round=26 head_norm_before_train=1.986615 (no previous merge yet)
[S17] round=26 local utility u=0.983637 metrics={'f1_val': 0.524413669655545, 'auprc': 0.524413669655545, 'loss_val': 1.1001421603485417, 'psi': 0.524413669655545}-{'f1_val': 0.34028539973540767, 'auprc': 0.34028539973540767, 'loss_val': 1.4102617429170172, 'psi': 0.34028539973540767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.172)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:49315
[S6] not sending this round → trigger blocked (psi=0.022)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1793) from S2
[S15] cosine check vs S2: cos=0.6848
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=-0.0743
[S3] DROPPED delta from S7 (cos=-0.0743 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=0.9564
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.9923
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.3687 head_norm=1.979477
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.358317e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.3687 head_norm=2.083936 delta_norm=0.335832
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.6137 head_norm=1.484542
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.450494e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.6137 head_norm=1.621851 delta_norm=0.745049
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.2979 head_norm=2.011010
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.247255e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.2979 head_norm=1.999184 delta_norm=0.124725
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=2.041356 cos_to_last_merge=0.9918 (last merge round=23)
[S2] round=27 local utility u=0.012100 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.2015340416460245, 'psi': 0.26542475888492534}-{'f1_val': 0.24624624624624625, 'auprc': 0.24624624624624625, 'loss_val': 2.0531271414499495, 'psi': 0.24624624624624625}
[S3] START round=27 head_norm_before_train=1.999184 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.077955 metrics={'f1_val': 0.2976973684210526, 'auprc': 0.2976973684210526, 'loss_val': 2.5997747115284633, 'psi': 0.2976973684210526}-{'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.757889451155892, 'psi': 0.2979423868312757}
[S4] START round=27 head_norm_before_train=2.051366 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2893447934897024, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2682094148515388, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.790408 cos_to_last_merge=0.9989 (last merge round=24)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.113581576077331, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0792113240235635, 'psi': 0.33358943696313936}
[S6] START round=27 head_norm_before_train=1.917957 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 7.304455442951848, 'psi': 0.02153000458085204}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 7.19729709287919, 'psi': 0.021749084249084248}
[S7] START round=27 head_norm_before_train=1.535055 (no previous merge yet)
[S7] round=27 local utility u=0.002930 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.002621234140502, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0084805036460167, 'psi': 0.33308476261496395}
[S8] START round=27 head_norm_before_train=2.060889 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7585575983618096, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.723635754687178, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=2.083936 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.072459 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1170345533913233, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.261953328384604, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=2.234462 (no previous merge yet)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.28485838779956424, 'auprc': 0.28485838779956424, 'loss_val': 1.5885642448673618, 'psi': 0.28485838779956424}-{'f1_val': 0.2859681498188777, 'auprc': 0.2859681498188777, 'loss_val': 1.5722654470285373, 'psi': 0.2859681498188777}
[S11] START round=27 head_norm_before_train=2.042929 cos_to_last_merge=0.9999 (last merge round=25)
[S11] round=27 local utility u=0.008852 metrics={'f1_val': 0.3108108108108108, 'auprc': 0.3108108108108108, 'loss_val': 1.8949905913126994, 'psi': 0.3108108108108108}-{'f1_val': 0.2975942149909609, 'auprc': 0.2975942149909609, 'loss_val': 1.7937442974507423, 'psi': 0.2975942149909609}
[S13] START round=27 head_norm_before_train=1.781754 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7562050821309927, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7340504898111588, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.794933 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.744793533801133, 'psi': 0.13572854291417166}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.687017236913442, 'psi': 0.13582554517133957}
[S15] START round=27 head_norm_before_train=1.621851 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6023343250633469, 'auprc': 0.6023343250633469, 'loss_val': 0.7924801760302892, 'psi': 0.6023343250633469}-{'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.8893396514708497, 'psi': 0.6136702686915539}
[S16] START round=27 head_norm_before_train=1.634368 cos_to_last_merge=0.9998 (last merge round=25)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.09803921568627451, 'auprc': 0.09803921568627451, 'loss_val': 3.3039928725943692, 'psi': 0.09803921568627451}-{'f1_val': 0.17215815485996708, 'auprc': 0.17215815485996708, 'loss_val': 2.502004212974642, 'psi': 0.17215815485996708}
[S17] START round=27 head_norm_before_train=1.995101 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.3413280415922333, 'auprc': 0.3413280415922333, 'loss_val': 1.4559954735229979, 'psi': 0.3413280415922333}-{'f1_val': 0.524413669655545, 'auprc': 0.524413669655545, 'loss_val': 1.1001421603485417, 'psi': 0.524413669655545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49311
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:49317
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S2
[S3] cosine check vs S2: cos=0.9550
[S17] RECEIVED delta(kind=head bytes=1802) from S3
[S17] cosine check vs S3: cos=0.9963
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=0.9904
[S10] RECEIVED delta(kind=head bytes=1802) from S9
[S10] cosine check vs S9: cos=0.9894
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.3568 head_norm=2.065946
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.427613e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.3568 head_norm=2.057901 delta_norm=0.142761
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=27 metric=0.2849 head_norm=2.249655
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.765013e-01
[S10] stored merged vector for next round verification (round=27)
[S10] DEBUG after merge:  round=27 metric=0.2851 head_norm=2.165928 delta_norm=0.176501
[S10] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.2977 head_norm=2.016951
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.072010e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.2977 head_norm=2.018668 delta_norm=0.307201
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.3413 head_norm=2.005708
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.704248e-02
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.3439 head_norm=2.009453 delta_norm=0.087042
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=2.066567 cos_to_last_merge=0.9892 (last merge round=23)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.25623365856769337, 'auprc': 0.25623365856769337, 'loss_val': 2.1744898143140325, 'psi': 0.25623365856769337}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.2015340416460245, 'psi': 0.26542475888492534}
[S3] START round=28 head_norm_before_train=2.018668 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.29771689497716897, 'auprc': 0.29771689497716897, 'loss_val': 2.761080259876466, 'psi': 0.29771689497716897}-{'f1_val': 0.2976973684210526, 'auprc': 0.2976973684210526, 'loss_val': 2.5997747115284633, 'psi': 0.2976973684210526}
[S4] START round=28 head_norm_before_train=2.057901 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.009943 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2694595391915897, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2893447934897024, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.805212 cos_to_last_merge=0.9982 (last merge round=24)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1323695344607176, 'psi': 0.33308623671855697}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.113581576077331, 'psi': 0.33358943696313936}
[S6] START round=28 head_norm_before_train=1.927412 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 7.4158446300983, 'psi': 0.02109124254928932}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 7.304455442951848, 'psi': 0.02153000458085204}
[S7] START round=28 head_norm_before_train=1.541352 (no previous merge yet)
[S7] round=28 local utility u=0.003912 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.9940521055698978, 'psi': 0.3330019880715706}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.002621234140502, 'psi': 0.33308476261496395}
[S8] START round=28 head_norm_before_train=2.066180 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7845414279668668, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7585575983618096, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=2.093765 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.142459146946825, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1170345533913233, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=2.165928 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=28 local utility u=0.009282 metrics={'f1_val': 0.2841619125237707, 'auprc': 0.2841619125237707, 'loss_val': 1.5637327998604607, 'psi': 0.2841619125237707}-{'f1_val': 0.28485838779956424, 'auprc': 0.28485838779956424, 'loss_val': 1.5885642448673618, 'psi': 0.28485838779956424}
[S11] START round=28 head_norm_before_train=2.059742 cos_to_last_merge=0.9996 (last merge round=25)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.28763440860215056, 'auprc': 0.28763440860215056, 'loss_val': 1.851109203127816, 'psi': 0.28763440860215056}-{'f1_val': 0.3108108108108108, 'auprc': 0.3108108108108108, 'loss_val': 1.8949905913126994, 'psi': 0.3108108108108108}
[S13] START round=28 head_norm_before_train=1.796358 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7735559192765542, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7562050821309927, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.806384 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.807325022465357, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.744793533801133, 'psi': 0.13572854291417166}
[S15] START round=28 head_norm_before_train=1.716312 cos_to_last_merge=0.9937 (last merge round=26)
[S15] round=28 local utility u=0.107278 metrics={'f1_val': 0.613952434929713, 'auprc': 0.613952434929713, 'loss_val': 0.6824865148326247, 'psi': 0.613952434929713}-{'f1_val': 0.6023343250633469, 'auprc': 0.6023343250633469, 'loss_val': 0.7924801760302892, 'psi': 0.6023343250633469}
[S16] START round=28 head_norm_before_train=1.656904 cos_to_last_merge=0.9993 (last merge round=25)
[S16] round=28 local utility u=0.319001 metrics={'f1_val': 0.13928597610145885, 'auprc': 0.13928597610145885, 'loss_val': 3.037211827372856, 'psi': 0.13928597610145885}-{'f1_val': 0.09803921568627451, 'auprc': 0.09803921568627451, 'loss_val': 3.3039928725943692, 'psi': 0.09803921568627451}
[S17] START round=28 head_norm_before_train=2.009453 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.556827 metrics={'f1_val': 0.44868473885036386, 'auprc': 0.44868473885036386, 'loss_val': 1.308551293078221, 'psi': 0.44868473885036386}-{'f1_val': 0.3413280415922333, 'auprc': 0.3413280415922333, 'loss_val': 1.4559954735229979, 'psi': 0.3413280415922333}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:49312
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.333)
[S16] not sending this round → trigger blocked (psi=0.139)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:49313
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.0289
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] cosine check vs S15: cos=0.2718
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.2876 head_norm=2.075669
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.174229e+00
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.2929 head_norm=1.547146 delta_norm=1.174229
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.3599 head_norm=1.814704
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.398640e+00
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.3599 head_norm=1.438896 delta_norm=1.398640
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=2.085389 cos_to_last_merge=0.9872 (last merge round=23)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.388375152003408, 'psi': 0.2450298816928894}-{'f1_val': 0.25623365856769337, 'auprc': 0.25623365856769337, 'loss_val': 2.1744898143140325, 'psi': 0.25623365856769337}
[S3] START round=29 head_norm_before_train=2.036512 cos_to_last_merge=0.9998 (last merge round=27)
[S3] round=29 local utility u=0.064293 metrics={'f1_val': 0.2984599044078598, 'auprc': 0.2984599044078598, 'loss_val': 2.6391819362134195, 'psi': 0.2984599044078598}-{'f1_val': 0.29771689497716897, 'auprc': 0.29771689497716897, 'loss_val': 2.761080259876466, 'psi': 0.29771689497716897}
[S4] START round=29 head_norm_before_train=2.069165 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=29 local utility u=0.002242 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2649746273138218, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2694595391915897, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.820293 cos_to_last_merge=0.9974 (last merge round=24)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1506099176354305, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1323695344607176, 'psi': 0.33308623671855697}
[S6] START round=29 head_norm_before_train=1.936557 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.452659432814199, 'psi': 0.021310724106324473}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 7.4158446300983, 'psi': 0.02109124254928932}
[S7] START round=29 head_norm_before_train=1.547981 (no previous merge yet)
[S7] round=29 local utility u=0.017836 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.9591252886858224, 'psi': 0.33308476261496395}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.9940521055698978, 'psi': 0.3330019880715706}
[S8] START round=29 head_norm_before_train=2.074889 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8109016008065115, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7845414279668668, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=2.104154 cos_to_last_merge=0.9999 (last merge round=26)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.167947754063785, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.142459146946825, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=2.181762 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.28509130553284273, 'auprc': 0.28509130553284273, 'loss_val': 1.5848009680034962, 'psi': 0.28509130553284273}-{'f1_val': 0.2841619125237707, 'auprc': 0.2841619125237707, 'loss_val': 1.5637327998604607, 'psi': 0.2841619125237707}
[S11] START round=29 head_norm_before_train=1.547146 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.337502 metrics={'f1_val': 0.299782867549205, 'auprc': 0.299782867549205, 'loss_val': 1.285441765720958, 'psi': 0.299782867549205}-{'f1_val': 0.28763440860215056, 'auprc': 0.28763440860215056, 'loss_val': 1.851109203127816, 'psi': 0.28763440860215056}
[S13] START round=29 head_norm_before_train=1.438896 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.224865 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3238257535897846, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7735559192765542, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.816821 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.867130785794163, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.807325022465357, 'psi': 0.13572854291417166}
[S15] START round=29 head_norm_before_train=1.799041 cos_to_last_merge=0.9832 (last merge round=26)
[S15] round=29 local utility u=0.004293 metrics={'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.6688172637914654, 'psi': 0.613387689325667}-{'f1_val': 0.613952434929713, 'auprc': 0.613952434929713, 'loss_val': 0.6824865148326247, 'psi': 0.613952434929713}
[S16] START round=29 head_norm_before_train=1.678958 cos_to_last_merge=0.9984 (last merge round=25)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.10296191819464035, 'auprc': 0.10296191819464035, 'loss_val': 3.436478347114366, 'psi': 0.10296191819464035}-{'f1_val': 0.13928597610145885, 'auprc': 0.13928597610145885, 'loss_val': 3.037211827372856, 'psi': 0.13928597610145885}
[S17] START round=29 head_norm_before_train=2.025917 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=29 local utility u=1.000000 metrics={'f1_val': 0.691839982832311, 'auprc': 0.691839982832311, 'loss_val': 0.8630860950710512, 'psi': 0.691839982832311}-{'f1_val': 0.44868473885036386, 'auprc': 0.44868473885036386, 'loss_val': 1.308551293078221, 'psi': 0.44868473885036386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:49317
[S15] not sending this round → trigger blocked (psi=0.613)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.357)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S3
[S17] cosine check vs S3: cos=0.9821
[S4] RECEIVED delta(kind=head bytes=1802) from S11
[S4] cosine check vs S11: cos=0.8233
[S17] not sending this round → trigger blocked (psi=0.692)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.3568 head_norm=2.079221
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.941464e-01
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.3568 head_norm=1.745342 delta_norm=0.594146
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.6918 head_norm=2.043175
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.936958e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.6909 head_norm=2.038416 delta_norm=0.193696
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=2.101058 cos_to_last_merge=0.9856 (last merge round=23)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.23503452203003772, 'auprc': 0.23503452203003772, 'loss_val': 2.643683991570085, 'psi': 0.23503452203003772}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.388375152003408, 'psi': 0.2450298816928894}
[S3] START round=30 head_norm_before_train=2.052011 cos_to_last_merge=0.9995 (last merge round=27)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.30092968679483706, 'auprc': 0.30092968679483706, 'loss_val': 2.8463569069878014, 'psi': 0.30092968679483706}-{'f1_val': 0.2984599044078598, 'auprc': 0.2984599044078598, 'loss_val': 2.6391819362134195, 'psi': 0.2984599044078598}
[S4] START round=30 head_norm_before_train=1.745342 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.068514 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1279468905156007, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2649746273138218, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.834948 cos_to_last_merge=0.9966 (last merge round=24)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.164165787575452, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1506099176354305, 'psi': 0.33308623671855697}
[S6] START round=30 head_norm_before_train=1.945202 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.500381010976154, 'psi': 0.021310724106324473}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.452659432814199, 'psi': 0.021310724106324473}
[S7] START round=30 head_norm_before_train=1.554747 (no previous merge yet)
[S7] round=30 local utility u=0.018089 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.9229470390163979, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.9591252886858224, 'psi': 0.33308476261496395}
[S8] START round=30 head_norm_before_train=2.086799 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8298702147214523, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8109016008065115, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=2.114497 cos_to_last_merge=0.9998 (last merge round=26)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.191086802036089, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.167947754063785, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=2.199440 cos_to_last_merge=0.9999 (last merge round=27)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.20733399405351832, 'auprc': 0.20733399405351832, 'loss_val': 1.5955360890199062, 'psi': 0.20733399405351832}-{'f1_val': 0.28509130553284273, 'auprc': 0.28509130553284273, 'loss_val': 1.5848009680034962, 'psi': 0.28509130553284273}
[S11] START round=30 head_norm_before_train=1.573309 cos_to_last_merge=0.9996 (last merge round=28)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.2915134177904917, 'auprc': 0.2915134177904917, 'loss_val': 1.3958100121817534, 'psi': 0.2915134177904917}-{'f1_val': 0.299782867549205, 'auprc': 0.299782867549205, 'loss_val': 1.285441765720958, 'psi': 0.299782867549205}
[S13] START round=30 head_norm_before_train=1.476347 cos_to_last_merge=0.9987 (last merge round=28)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3609544083484217, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3238257535897846, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.826448 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.922492693980771, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.867130785794163, 'psi': 0.13592717296421}
[S15] START round=30 head_norm_before_train=1.853940 cos_to_last_merge=0.9756 (last merge round=26)
[S15] round=30 local utility u=0.018709 metrics={'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.6390175543821973, 'psi': 0.6142341889454641}-{'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.6688172637914654, 'psi': 0.613387689325667}
[S16] START round=30 head_norm_before_train=1.700146 cos_to_last_merge=0.9973 (last merge round=25)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 4.102887135648556, 'psi': 0.0890603649224339}-{'f1_val': 0.10296191819464035, 'auprc': 0.10296191819464035, 'loss_val': 3.436478347114366, 'psi': 0.10296191819464035}
[S17] START round=30 head_norm_before_train=2.038416 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.3233730440338465, 'auprc': 0.3233730440338465, 'loss_val': 1.611281039680996, 'psi': 0.3233730440338465}-{'f1_val': 0.691839982832311, 'auprc': 0.691839982832311, 'loss_val': 0.8630860950710512, 'psi': 0.691839982832311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.333)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S15
[S11] cosine check vs S15: cos=0.7320
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.2915 head_norm=1.608773
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.536047e-01
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.3031 head_norm=1.628877 delta_norm=0.653605
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.074 → S4@127.0.0.1:49304
[S10] ⇄ pheromone p=0.033 → S13@127.0.0.1:49313
[S3] ⇄ pheromone p=0.033 → S17@127.0.0.1:49317
[S9] ⇄ pheromone p=0.024 → S10@127.0.0.1:49311
[S14] ⇄ pheromone p=0.009 → S16@127.0.0.1:49316
[S2] ⇄ pheromone p=0.014 → S3@127.0.0.1:49303
[S8] ⇄ pheromone p=0.004 → S6@127.0.0.1:49307
[S5] ⇄ pheromone p=0.031 → S15@127.0.0.1:49315
[S15] ⇄ pheromone p=0.039 → S11@127.0.0.1:49312
[S17] ⇄ pheromone p=0.359 → S3@127.0.0.1:49303
[S16] ⇄ pheromone p=0.134 → S5@127.0.0.1:49305
[S2] START round=31 head_norm_before_train=2.113633 cos_to_last_merge=0.9843 (last merge round=23)
[S2] round=31 local utility u=0.178250 metrics={'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.381589686848547, 'psi': 0.24552398411243506}-{'f1_val': 0.23503452203003772, 'auprc': 0.23503452203003772, 'loss_val': 2.643683991570085, 'psi': 0.23503452203003772}
[S3] START round=31 head_norm_before_train=2.065081 cos_to_last_merge=0.9991 (last merge round=27)
[S3] round=31 local utility u=0.181702 metrics={'f1_val': 0.2952802359882006, 'auprc': 0.2952802359882006, 'loss_val': 2.432107789621648, 'psi': 0.2952802359882006}-{'f1_val': 0.30092968679483706, 'auprc': 0.30092968679483706, 'loss_val': 2.8463569069878014, 'psi': 0.30092968679483706}
[S4] START round=31 head_norm_before_train=1.765373 cos_to_last_merge=0.9997 (last merge round=29)
[S4] round=31 local utility u=0.005181 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1175840163724653, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1279468905156007, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.846860 cos_to_last_merge=0.9958 (last merge round=24)
[S5] round=31 local utility u=0.002880 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1584066957958, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.164165787575452, 'psi': 0.33308623671855697}
[S6] START round=31 head_norm_before_train=1.953281 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.554190451623589, 'psi': 0.021310724106324473}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.500381010976154, 'psi': 0.021310724106324473}
[S7] START round=31 head_norm_before_train=1.564319 (no previous merge yet)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.24824912456228115, 'auprc': 0.24824912456228115, 'loss_val': 0.9271040222494338, 'psi': 0.24824912456228115}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.9229470390163979, 'psi': 0.33308476261496395}
[S8] START round=31 head_norm_before_train=2.098575 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8457219477072628, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8298702147214523, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=2.124264 cos_to_last_merge=0.9996 (last merge round=26)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2151952015943297, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.191086802036089, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=2.217116 cos_to_last_merge=0.9998 (last merge round=27)
[S10] round=31 local utility u=0.338902 metrics={'f1_val': 0.28456777528395566, 'auprc': 0.28456777528395566, 'loss_val': 1.6128352504979828, 'psi': 0.28456777528395566}-{'f1_val': 0.20733399405351832, 'auprc': 0.20733399405351832, 'loss_val': 1.5955360890199062, 'psi': 0.20733399405351832}
[S11] START round=31 head_norm_before_train=1.628877 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.215416 metrics={'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 1.2568495121189363, 'psi': 0.323943661971831}-{'f1_val': 0.2915134177904917, 'auprc': 0.2915134177904917, 'loss_val': 1.3958100121817534, 'psi': 0.2915134177904917}
[S13] START round=31 head_norm_before_train=1.509498 cos_to_last_merge=0.9960 (last merge round=28)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.387422489803182, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3609544083484217, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.835505 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.980005805190524, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.922492693980771, 'psi': 0.13587634006482174}
[S15] START round=31 head_norm_before_train=1.890166 cos_to_last_merge=0.9707 (last merge round=26)
[S15] round=31 local utility u=0.009488 metrics={'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.6200407787503152, 'psi': 0.6142341889454641}-{'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.6390175543821973, 'psi': 0.6142341889454641}
[S16] START round=31 head_norm_before_train=1.719197 cos_to_last_merge=0.9963 (last merge round=25)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.0534905579765872, 'auprc': 0.0534905579765872, 'loss_val': 4.388000620714044, 'psi': 0.0534905579765872}-{'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 4.102887135648556, 'psi': 0.0890603649224339}
[S17] START round=31 head_norm_before_train=2.055724 cos_to_last_merge=0.9999 (last merge round=29)
[S17] round=31 local utility u=1.000000 metrics={'f1_val': 0.6977717570531825, 'auprc': 0.6977717570531825, 'loss_val': 0.8650069918370165, 'psi': 0.6977717570531825}-{'f1_val': 0.3233730440338465, 'auprc': 0.3233730440338465, 'loss_val': 1.611281039680996, 'psi': 0.3233730440338465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:49315
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.614)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:49317
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.357)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S2
[S3] cosine check vs S2: cos=0.9832
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=0.9938
[S15] RECEIVED delta(kind=head bytes=1807) from S11
[S15] cosine check vs S11: cos=0.9271
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.9937
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.9386
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.9937
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.3687 head_norm=2.133581
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.313366e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.3687 head_norm=2.180118 delta_norm=0.131337
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.2953 head_norm=2.075587
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.238366e-02
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.2941 head_norm=2.076827 delta_norm=0.072384
[S3] aggregate: ACCEPT kept=['S2', 'S17'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.6978 head_norm=2.073484
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.160554e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.6981 head_norm=2.071287 delta_norm=0.116055
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.6142 head_norm=1.917698
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.640827e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.6142 head_norm=1.757232 delta_norm=0.364083
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.0535 head_norm=1.735920
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.205100e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.0547 head_norm=1.768884 delta_norm=0.320510
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=2.126256 cos_to_last_merge=0.9829 (last merge round=23)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.2621857704874308, 'auprc': 0.2621857704874308, 'loss_val': 2.5369423717224184, 'psi': 0.2621857704874308}-{'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.381589686848547, 'psi': 0.24552398411243506}
[S3] START round=32 head_norm_before_train=2.076827 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.29866229866229865, 'auprc': 0.29866229866229865, 'loss_val': 2.9035118118380296, 'psi': 0.29866229866229865}-{'f1_val': 0.2952802359882006, 'auprc': 0.2952802359882006, 'loss_val': 2.432107789621648, 'psi': 0.2952802359882006}
[S4] START round=32 head_norm_before_train=1.790257 cos_to_last_merge=0.9991 (last merge round=29)
[S4] round=32 local utility u=0.007977 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1016303828453653, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1175840163724653, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.857399 cos_to_last_merge=0.9952 (last merge round=24)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1597139864271044, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1584066957958, 'psi': 0.33308623671855697}
[S6] START round=32 head_norm_before_train=1.961266 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.603786309095773, 'psi': 0.021310724106324473}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.554190451623589, 'psi': 0.021310724106324473}
[S7] START round=32 head_norm_before_train=1.572392 (no previous merge yet)
[S7] round=32 local utility u=0.398495 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8928904977237194, 'psi': 0.3330019880715706}-{'f1_val': 0.24824912456228115, 'auprc': 0.24824912456228115, 'loss_val': 0.9271040222494338, 'psi': 0.24824912456228115}
[S8] START round=32 head_norm_before_train=2.108167 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8731868101379374, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8457219477072628, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=2.180118 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.006449 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.202297050216837, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2151952015943297, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=2.233418 cos_to_last_merge=0.9996 (last merge round=27)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.20606776989755712, 'auprc': 0.20606776989755712, 'loss_val': 1.6350278498593, 'psi': 0.20606776989755712}-{'f1_val': 0.28456777528395566, 'auprc': 0.28456777528395566, 'loss_val': 1.6128352504979828, 'psi': 0.28456777528395566}
[S11] START round=32 head_norm_before_train=1.662310 cos_to_last_merge=0.9983 (last merge round=30)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.28751847373370953, 'auprc': 0.28751847373370953, 'loss_val': 1.4694569446881365, 'psi': 0.28751847373370953}-{'f1_val': 0.323943661971831, 'auprc': 0.323943661971831, 'loss_val': 1.2568495121189363, 'psi': 0.323943661971831}
[S13] START round=32 head_norm_before_train=1.541559 cos_to_last_merge=0.9928 (last merge round=28)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4313657608287595, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.387422489803182, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.843613 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.031421653499402, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.980005805190524, 'psi': 0.13587634006482174}
[S15] START round=32 head_norm_before_train=1.757232 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.6253493533681016, 'psi': 0.6136702686915539}-{'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.6200407787503152, 'psi': 0.6142341889454641}
[S16] START round=32 head_norm_before_train=1.768884 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.396438 metrics={'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 3.9152538148690623, 'psi': 0.0890603649224339}-{'f1_val': 0.0534905579765872, 'auprc': 0.0534905579765872, 'loss_val': 4.388000620714044, 'psi': 0.0534905579765872}
[S17] START round=32 head_norm_before_train=2.071287 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5689559997996927, 'auprc': 0.5689559997996927, 'loss_val': 1.1807793641962265, 'psi': 0.5689559997996927}-{'f1_val': 0.6977717570531825, 'auprc': 0.6977717570531825, 'loss_val': 0.8650069918370165, 'psi': 0.6977717570531825}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:49311
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:49312
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.089)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.7567
[S10] RECEIVED delta(kind=head bytes=1800) from S9
[S10] cosine check vs S9: cos=0.9980
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=32 metric=0.2061 head_norm=2.247983
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.547826e-02
[S10] stored merged vector for next round verification (round=32)
[S10] DEBUG after merge:  round=32 metric=0.2062 head_norm=2.217315 delta_norm=0.075478
[S10] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.2875 head_norm=1.700884
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.157812e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.2805 head_norm=1.648398 delta_norm=0.615781
[S11] aggregate: ROLLBACK (f1_val pre=0.288 post=0.280 tol_abs=0.005 tol_rel=0.0)
[S2] START round=33 head_norm_before_train=2.137014 cos_to_last_merge=0.9818 (last merge round=23)
[S2] round=33 local utility u=0.019733 metrics={'f1_val': 0.25024912805181865, 'auprc': 0.25024912805181865, 'loss_val': 2.3900463406400885, 'psi': 0.25024912805181865}-{'f1_val': 0.2621857704874308, 'auprc': 0.2621857704874308, 'loss_val': 2.5369423717224184, 'psi': 0.2621857704874308}
[S3] START round=33 head_norm_before_train=2.084742 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=33 local utility u=0.231574 metrics={'f1_val': 0.3089852340559221, 'auprc': 0.3089852340559221, 'loss_val': 2.533270657258732, 'psi': 0.3089852340559221}-{'f1_val': 0.29866229866229865, 'auprc': 0.29866229866229865, 'loss_val': 2.9035118118380296, 'psi': 0.29866229866229865}
[S4] START round=33 head_norm_before_train=1.816534 cos_to_last_merge=0.9984 (last merge round=29)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1159756314669906, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1016303828453653, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.870012 cos_to_last_merge=0.9945 (last merge round=24)
[S5] round=33 local utility u=0.010578 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1385585033333196, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1597139864271044, 'psi': 0.33308623671855697}
[S6] START round=33 head_norm_before_train=1.968820 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.642305635173422, 'psi': 0.021310724106324473}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.603786309095773, 'psi': 0.021310724106324473}
[S7] START round=33 head_norm_before_train=1.588064 (no previous merge yet)
[S7] round=33 local utility u=0.022116 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.8494041493197529, 'psi': 0.33308476261496395}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8928904977237194, 'psi': 0.3330019880715706}
[S8] START round=33 head_norm_before_train=2.116815 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8947843163712121, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8731868101379374, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=2.188821 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2265321144631085, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.202297050216837, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=2.217315 cos_to_last_merge=1.0000 (last merge round=32)
[S10] round=33 local utility u=0.000773 metrics={'f1_val': 0.20643378725083877, 'auprc': 0.20643378725083877, 'loss_val': 1.6367765843213813, 'psi': 0.20643378725083877}-{'f1_val': 0.20606776989755712, 'auprc': 0.20606776989755712, 'loss_val': 1.6350278498593, 'psi': 0.20606776989755712}
[S11] START round=33 head_norm_before_train=1.648398 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.3152774707052841, 'auprc': 0.3152774707052841, 'loss_val': 1.7257147940431121, 'psi': 0.3152774707052841}-{'f1_val': 0.28751847373370953, 'auprc': 0.28751847373370953, 'loss_val': 1.4694569446881365, 'psi': 0.28751847373370953}
[S13] START round=33 head_norm_before_train=1.586416 cos_to_last_merge=0.9887 (last merge round=28)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4749085854799797, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4313657608287595, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=1.851431 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.080345201221556, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.031421653499402, 'psi': 0.13592717296421}
[S15] START round=33 head_norm_before_train=1.790789 cos_to_last_merge=0.9997 (last merge round=31)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.6418593356701873, 'psi': 0.612395395031292}-{'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.6253493533681016, 'psi': 0.6136702686915539}
[S16] START round=33 head_norm_before_train=1.784545 cos_to_last_merge=0.9999 (last merge round=31)
[S16] round=33 local utility u=0.268488 metrics={'f1_val': 0.10096720924746404, 'auprc': 0.10096720924746404, 'loss_val': 3.4854389020587773, 'psi': 0.10096720924746404}-{'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 3.9152538148690623, 'psi': 0.0890603649224339}
[S17] START round=33 head_norm_before_train=2.088862 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=33 local utility u=0.285192 metrics={'f1_val': 0.6172984497288626, 'auprc': 0.6172984497288626, 'loss_val': 1.0454764721296357, 'psi': 0.6172984497288626}-{'f1_val': 0.5689559997996927, 'auprc': 0.5689559997996927, 'loss_val': 1.1807793641962265, 'psi': 0.5689559997996927}
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S16
[S11]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S15
[S16]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:49303
[S7] not sending this round → trigger blocked (psi=0.333)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:49317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49316
[S16] not sending this round → trigger blocked (psi=0.101)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=0.9992
[S3] RECEIVED delta(kind=head bytes=1793) from S2
[S3] cosine check vs S2: cos=0.9858
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=0.9968
[S17] RECEIVED delta(kind=head bytes=1802) from S3
[S17] cosine check vs S3: cos=0.9968
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.9813
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.6173 head_norm=2.106140
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.401692e-02
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.6173 head_norm=2.097808 delta_norm=0.084017
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=33 metric=0.3090 head_norm=2.092819
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.665403e-02
[S3] stored merged vector for next round verification (round=33)
[S3] DEBUG after merge:  round=33 metric=0.3090 head_norm=2.101369 delta_norm=0.056654
[S3] aggregate: ACCEPT kept=['S2', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=33 metric=0.3687 head_norm=2.197457
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.846512e-02
[S9] stored merged vector for next round verification (round=33)
[S9] DEBUG after merge:  round=33 metric=0.3687 head_norm=2.214314 delta_norm=0.048465
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.1010 head_norm=1.802859
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.829154e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.1019 head_norm=1.835024 delta_norm=0.182915
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=2.147798 cos_to_last_merge=0.9807 (last merge round=23)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.5977088781514044, 'psi': 0.2450298816928894}-{'f1_val': 0.25024912805181865, 'auprc': 0.25024912805181865, 'loss_val': 2.3900463406400885, 'psi': 0.25024912805181865}
[S3] START round=34 head_norm_before_train=2.101369 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.29836725564750616, 'auprc': 0.29836725564750616, 'loss_val': 2.472658076289321, 'psi': 0.29836725564750616}-{'f1_val': 0.3089852340559221, 'auprc': 0.3089852340559221, 'loss_val': 2.533270657258732, 'psi': 0.3089852340559221}
[S4] START round=34 head_norm_before_train=1.834422 cos_to_last_merge=0.9971 (last merge round=29)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1227241213604466, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1159756314669906, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=1.884475 cos_to_last_merge=0.9937 (last merge round=24)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1420454499942534, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1385585033333196, 'psi': 0.33308623671855697}
[S6] START round=34 head_norm_before_train=1.976182 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.699208794022178, 'psi': 0.021310724106324473}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.642305635173422, 'psi': 0.021310724106324473}
[S7] START round=34 head_norm_before_train=1.604831 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.8015832194286783, 'psi': 0.24962705121829937}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.8494041493197529, 'psi': 0.33308476261496395}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=2.125113 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9065661494041266, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8947843163712121, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=2.214314 cos_to_last_merge=1.0000 (last merge round=33)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.246297313839685, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2265321144631085, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=2.232097 cos_to_last_merge=1.0000 (last merge round=32)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.20643378725083877, 'auprc': 0.20643378725083877, 'loss_val': 1.6514927732102263, 'psi': 0.20643378725083877}-{'f1_val': 0.20643378725083877, 'auprc': 0.20643378725083877, 'loss_val': 1.6367765843213813, 'psi': 0.20643378725083877}
[S11] START round=34 head_norm_before_train=1.688428 cos_to_last_merge=0.9993 (last merge round=32)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.2791577025881739, 'auprc': 0.2791577025881739, 'loss_val': 1.6595650345769148, 'psi': 0.2791577025881739}-{'f1_val': 0.3152774707052841, 'auprc': 0.3152774707052841, 'loss_val': 1.7257147940431121, 'psi': 0.3152774707052841}
[S13] START round=34 head_norm_before_train=1.628498 cos_to_last_merge=0.9843 (last merge round=28)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.507274821610534, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4749085854799797, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=1.858981 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.1261726887393335, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.080345201221556, 'psi': 0.13592717296421}
[S15] START round=34 head_norm_before_train=1.827709 cos_to_last_merge=0.9987 (last merge round=31)
[S15] round=34 local utility u=0.012652 metrics={'f1_val': 0.613952434929713, 'auprc': 0.613952434929713, 'loss_val': 0.6305693883130242, 'psi': 0.613952434929713}-{'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.6418593356701873, 'psi': 0.612395395031292}
[S16] START round=34 head_norm_before_train=1.835024 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.450191 metrics={'f1_val': 0.14210756449497158, 'auprc': 0.14210756449497158, 'loss_val': 2.9553191677130415, 'psi': 0.14210756449497158}-{'f1_val': 0.10096720924746404, 'auprc': 0.10096720924746404, 'loss_val': 3.4854389020587773, 'psi': 0.10096720924746404}
[S17] START round=34 head_norm_before_train=2.097808 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.576323517674241, 'auprc': 0.576323517674241, 'loss_val': 1.2026819706150786, 'psi': 0.576323517674241}-{'f1_val': 0.6172984497288626, 'auprc': 0.6172984497288626, 'loss_val': 1.0454764721296357, 'psi': 0.6172984497288626}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:49312
[S16] not sending this round → trigger blocked (psi=0.142)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] cosine check vs S15: cos=0.7972
[S2] START round=35 head_norm_before_train=2.158481 cos_to_last_merge=0.9796 (last merge round=23)
[S2] round=35 local utility u=0.081513 metrics={'f1_val': 0.24656357388316152, 'auprc': 0.24656357388316152, 'loss_val': 2.4484856725721382, 'psi': 0.24656357388316152}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.5977088781514044, 'psi': 0.2450298816928894}
[S3] START round=35 head_norm_before_train=2.109968 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.29511246406223574, 'auprc': 0.29511246406223574, 'loss_val': 2.6880393189022067, 'psi': 0.29511246406223574}-{'f1_val': 0.29836725564750616, 'auprc': 0.29836725564750616, 'loss_val': 2.472658076289321, 'psi': 0.29836725564750616}
[S4] START round=35 head_norm_before_train=1.846457 cos_to_last_merge=0.9961 (last merge round=29)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.16237721586986, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1227241213604466, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=1.897972 cos_to_last_merge=0.9928 (last merge round=24)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.165626261141649, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1420454499942534, 'psi': 0.33308623671855697}
[S6] START round=35 head_norm_before_train=1.983391 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 7.7625478853457315, 'psi': 0.020871559633027524}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.699208794022178, 'psi': 0.021310724106324473}
[S7] START round=35 head_norm_before_train=1.617541 (no previous merge yet)
[S7] round=35 local utility u=0.003912 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7937589822302556, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.8015832194286783, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=35 head_norm_before_train=2.135102 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9257712642016172, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9065661494041266, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=2.222625 cos_to_last_merge=1.0000 (last merge round=33)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2684529954245924, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.246297313839685, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=2.246632 cos_to_last_merge=0.9999 (last merge round=32)
[S10] round=35 local utility u=0.290191 metrics={'f1_val': 0.2726088089653375, 'auprc': 0.2726088089653375, 'loss_val': 1.6666862408848413, 'psi': 0.2726088089653375}-{'f1_val': 0.20643378725083877, 'auprc': 0.20643378725083877, 'loss_val': 1.6514927732102263, 'psi': 0.20643378725083877}
[S11] START round=35 head_norm_before_train=1.717356 cos_to_last_merge=0.9982 (last merge round=32)
[S11] round=35 local utility u=0.019902 metrics={'f1_val': 0.30739383487820654, 'auprc': 0.30739383487820654, 'loss_val': 1.87388557508944, 'psi': 0.30739383487820654}-{'f1_val': 0.2791577025881739, 'auprc': 0.2791577025881739, 'loss_val': 1.6595650345769148, 'psi': 0.2791577025881739}
[S13] START round=35 head_norm_before_train=1.659733 cos_to_last_merge=0.9810 (last merge round=28)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5315364397046989, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.507274821610534, 'psi': 0.3599362944611573}
[S14] START round=35 head_norm_before_train=1.866135 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.168926203119901, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.1261726887393335, 'psi': 0.13592717296421}
[S15] START round=35 head_norm_before_train=1.857651 cos_to_last_merge=0.9977 (last merge round=31)
[S15] round=35 local utility u=0.009759 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6236938551911487, 'psi': 0.6153571007984797}-{'f1_val': 0.613952434929713, 'auprc': 0.613952434929713, 'loss_val': 0.6305693883130242, 'psi': 0.613952434929713}
[S16] START round=35 head_norm_before_train=1.853395 cos_to_last_merge=0.9998 (last merge round=33)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.1419928566222028, 'auprc': 0.1419928566222028, 'loss_val': 3.05382598887637, 'psi': 0.1419928566222028}-{'f1_val': 0.14210756449497158, 'auprc': 0.14210756449497158, 'loss_val': 2.9553191677130415, 'psi': 0.14210756449497158}
[S17] START round=35 head_norm_before_train=2.113911 cos_to_last_merge=0.9999 (last merge round=33)
[S17] round=35 local utility u=0.247226 metrics={'f1_val': 0.6155630772896168, 'auprc': 0.6155630772896168, 'loss_val': 1.061386192387679, 'psi': 0.6155630772896168}-{'f1_val': 0.576323517674241, 'auprc': 0.576323517674241, 'loss_val': 1.2026819706150786, 'psi': 0.576323517674241}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.013 → S10@127.0.0.1:49311
[S4] ⇄ pheromone p=0.007 → S11@127.0.0.1:49312
[S6] ⇄ pheromone p=0.009 → S8@127.0.0.1:49309
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49310
[S14] ⇄ pheromone p=0.003 → S16@127.0.0.1:49316
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] cosine check vs S2: cos=0.9882
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] cosine check vs S17: cos=0.9974
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.615)
[S2] ⇄ pheromone p=0.038 → S3@127.0.0.1:49303
[S17] ⇄ pheromone p=0.286 → S3@127.0.0.1:49303
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=0.9993
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] cosine check vs S11: cos=0.7895
[S8] ⇄ pheromone p=0.001 → S14@127.0.0.1:49314
[S10] ⇄ pheromone p=0.097 → S9@127.0.0.1:49310
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=35 metric=0.3074 head_norm=1.739295
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.808244e-01
[S11] stored merged vector for next round verification (round=35)
[S11] DEBUG after merge:  round=35 metric=0.3190 head_norm=1.703130 delta_norm=0.580824
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.046 → S15@127.0.0.1:49315
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.6154 head_norm=1.880915
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.910819e-01
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.6152 head_norm=1.712342 delta_norm=0.591082
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.017 → S11@127.0.0.1:49312
[S16] ⇄ pheromone p=0.191 → S5@127.0.0.1:49305
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=35 metric=0.2951 head_norm=2.118849
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.198385e-02
[S3] stored merged vector for next round verification (round=35)
[S3] DEBUG after merge:  round=35 metric=0.2951 head_norm=2.127133 delta_norm=0.051984
[S3] aggregate: ACCEPT kept=['S2', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.055 → S17@127.0.0.1:49317
[S5] ⇄ pheromone p=0.012 → S16@127.0.0.1:49316
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=35 metric=0.3687 head_norm=2.230739
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.546593e-02
[S9] stored merged vector for next round verification (round=35)
[S9] DEBUG after merge:  round=35 metric=0.3687 head_norm=2.245394 delta_norm=0.045466
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.009 → S10@127.0.0.1:49311
[S2] START round=36 head_norm_before_train=2.167608 cos_to_last_merge=0.9787 (last merge round=23)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.2652386619066508, 'auprc': 0.2652386619066508, 'loss_val': 2.6278092340333656, 'psi': 0.2652386619066508}-{'f1_val': 0.24656357388316152, 'auprc': 0.24656357388316152, 'loss_val': 2.4484856725721382, 'psi': 0.24656357388316152}
[S3] START round=36 head_norm_before_train=2.127133 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2995375311277126, 'auprc': 0.2995375311277126, 'loss_val': 2.869095647533691, 'psi': 0.2995375311277126}-{'f1_val': 0.29511246406223574, 'auprc': 0.29511246406223574, 'loss_val': 2.6880393189022067, 'psi': 0.29511246406223574}
[S4] START round=36 head_norm_before_train=1.859612 cos_to_last_merge=0.9950 (last merge round=29)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.194874400253092, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.16237721586986, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=1.909187 cos_to_last_merge=0.9920 (last merge round=24)
[S5] round=36 local utility u=0.003046 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.159535143991855, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.165626261141649, 'psi': 0.33308623671855697}
[S6] START round=36 head_norm_before_train=1.990345 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.784332471730398, 'psi': 0.021310724106324473}-{'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 7.7625478853457315, 'psi': 0.020871559633027524}
[S7] START round=36 head_norm_before_train=1.631987 (no previous merge yet)
[S7] round=36 local utility u=0.382143 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7798477260013845, 'psi': 0.3330019880715706}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7937589822302556, 'psi': 0.24962705121829937}
[S7] not sending this round → trigger blocked (psi=0.333)
[S8] START round=36 head_norm_before_train=2.148266 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.948112631506093, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9257712642016172, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=2.245394 cos_to_last_merge=1.0000 (last merge round=35)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.293319417086263, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2684529954245924, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=2.260869 cos_to_last_merge=0.9998 (last merge round=32)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.2704414711395514, 'auprc': 0.2704414711395514, 'loss_val': 1.6914504195198679, 'psi': 0.2704414711395514}-{'f1_val': 0.2726088089653375, 'auprc': 0.2726088089653375, 'loss_val': 1.6666862408848413, 'psi': 0.2726088089653375}
[S11] START round=36 head_norm_before_train=1.703130 cos_to_last_merge=1.0000 (last merge round=35)
[S11] round=36 local utility u=0.043692 metrics={'f1_val': 0.28228465901596095, 'auprc': 0.28228465901596095, 'loss_val': 1.5605180267184817, 'psi': 0.28228465901596095}-{'f1_val': 0.30739383487820654, 'auprc': 0.30739383487820654, 'loss_val': 1.87388557508944, 'psi': 0.30739383487820654}
[S13] START round=36 head_norm_before_train=1.676848 cos_to_last_merge=0.9791 (last merge round=28)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.56366351585665, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5315364397046989, 'psi': 0.3599362944611573}
[S14] START round=36 head_norm_before_train=1.873189 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.21186815809361, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.168926203119901, 'psi': 0.13592717296421}
[S15] START round=36 head_norm_before_train=1.712342 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6356046410600734, 'psi': 0.6161950003225232}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6236938551911487, 'psi': 0.6153571007984797}
[S16] START round=36 head_norm_before_train=1.873526 cos_to_last_merge=0.9993 (last merge round=33)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.11349480968858132, 'auprc': 0.11349480968858132, 'loss_val': 3.4828786597782977, 'psi': 0.11349480968858133}-{'f1_val': 0.1419928566222028, 'auprc': 0.1419928566222028, 'loss_val': 3.05382598887637, 'psi': 0.1419928566222028}
[S17] START round=36 head_norm_before_train=2.131974 cos_to_last_merge=0.9998 (last merge round=33)
[S17] round=36 local utility u=0.591238 metrics={'f1_val': 0.722237962561391, 'auprc': 0.722237962561391, 'loss_val': 0.8389848538386622, 'psi': 0.722237962561391}-{'f1_val': 0.6155630772896168, 'auprc': 0.6155630772896168, 'loss_val': 1.061386192387679, 'psi': 0.6155630772896168}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.722)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49316
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.282)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.9895
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.1135 head_norm=1.893283
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.388838e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.1140 head_norm=1.900516 delta_norm=0.138884
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=2.176036 cos_to_last_merge=0.9777 (last merge round=23)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.24922466195261136, 'auprc': 0.24922466195261136, 'loss_val': 2.4841822871413424, 'psi': 0.24922466195261136}-{'f1_val': 0.2652386619066508, 'auprc': 0.2652386619066508, 'loss_val': 2.6278092340333656, 'psi': 0.2652386619066508}
[S3] START round=37 head_norm_before_train=2.135884 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=37 local utility u=0.021850 metrics={'f1_val': 0.2925327174749807, 'auprc': 0.2925327174749807, 'loss_val': 2.76235192172044, 'psi': 0.2925327174749807}-{'f1_val': 0.2995375311277126, 'auprc': 0.2995375311277126, 'loss_val': 2.869095647533691, 'psi': 0.2995375311277126}
[S4] START round=37 head_norm_before_train=1.884428 cos_to_last_merge=0.9940 (last merge round=29)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2389317985131483, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.194874400253092, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=1.917806 cos_to_last_merge=0.9913 (last merge round=24)
[S5] round=37 local utility u=0.002045 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.155445882318587, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.159535143991855, 'psi': 0.33308623671855697}
[S6] START round=37 head_norm_before_train=1.997221 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.831773275608262, 'psi': 0.021310724106324473}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.784332471730398, 'psi': 0.021310724106324473}
[S7] START round=37 head_norm_before_train=1.642432 (no previous merge yet)
[S7] round=37 local utility u=0.004388 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7710710071506739, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7798477260013845, 'psi': 0.3330019880715706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=37 head_norm_before_train=2.161580 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.973527956490527, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.948112631506093, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=2.253071 cos_to_last_merge=1.0000 (last merge round=35)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3098241528213355, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.293319417086263, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=2.274497 cos_to_last_merge=0.9997 (last merge round=32)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.2710722384191772, 'auprc': 0.2710722384191772, 'loss_val': 1.7047140662548492, 'psi': 0.2710722384191772}-{'f1_val': 0.2704414711395514, 'auprc': 0.2704414711395514, 'loss_val': 1.6914504195198679, 'psi': 0.2704414711395514}
[S11] START round=37 head_norm_before_train=1.721909 cos_to_last_merge=0.9998 (last merge round=35)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.28030898140874577, 'auprc': 0.28030898140874577, 'loss_val': 1.6249180236062521, 'psi': 0.28030898140874577}-{'f1_val': 0.28228465901596095, 'auprc': 0.28228465901596095, 'loss_val': 1.5605180267184817, 'psi': 0.28228465901596095}
[S13] START round=37 head_norm_before_train=1.691256 cos_to_last_merge=0.9773 (last merge round=28)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5980320304887632, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.56366351585665, 'psi': 0.3599362944611573}
[S14] START round=37 head_norm_before_train=1.879911 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.251905386499665, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.21186815809361, 'psi': 0.13592717296421}
[S15] START round=37 head_norm_before_train=1.747461 cos_to_last_merge=0.9996 (last merge round=35)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.6006818740494615, 'auprc': 0.6006818740494615, 'loss_val': 0.7107855776339199, 'psi': 0.6006818740494615}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6356046410600734, 'psi': 0.6161950003225232}
[S16] START round=37 head_norm_before_train=1.900516 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 3.714021306878977, 'psi': 0.08899598393574297}-{'f1_val': 0.11349480968858132, 'auprc': 0.11349480968858132, 'loss_val': 3.4828786597782977, 'psi': 0.11349480968858133}
[S17] START round=37 head_norm_before_train=2.150806 cos_to_last_merge=0.9996 (last merge round=33)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.5577595192196497, 'auprc': 0.5577595192196497, 'loss_val': 1.2263416847939783, 'psi': 0.5577595192196497}-{'f1_val': 0.722237962561391, 'auprc': 0.722237962561391, 'loss_val': 0.8389848538386622, 'psi': 0.722237962561391}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.333)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:49317
[S3] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S3
[S17] cosine check vs S3: cos=0.9949
[S2] START round=38 head_norm_before_train=2.184947 cos_to_last_merge=0.9768 (last merge round=23)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.2322515939537216, 'auprc': 0.2322515939537216, 'loss_val': 2.965256349057816, 'psi': 0.2322515939537216}-{'f1_val': 0.24922466195261136, 'auprc': 0.24922466195261136, 'loss_val': 2.4841822871413424, 'psi': 0.24922466195261136}
[S3] START round=38 head_norm_before_train=2.144398 cos_to_last_merge=0.9999 (last merge round=35)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.29293187037509566, 'auprc': 0.29293187037509566, 'loss_val': 2.770267667292794, 'psi': 0.29293187037509566}-{'f1_val': 0.2925327174749807, 'auprc': 0.2925327174749807, 'loss_val': 2.76235192172044, 'psi': 0.2925327174749807}
[S4] START round=38 head_norm_before_train=1.907195 cos_to_last_merge=0.9931 (last merge round=29)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2476254011503802, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2389317985131483, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=1.928461 cos_to_last_merge=0.9905 (last merge round=24)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.175498041874989, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.155445882318587, 'psi': 0.33308623671855697}
[S6] START round=38 head_norm_before_train=2.003825 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.862834116666627, 'psi': 0.021310724106324473}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.831773275608262, 'psi': 0.021310724106324473}
[S7] START round=38 head_norm_before_train=1.652255 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.7071187446301953, 'psi': 0.2496892866020383}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7710710071506739, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=2.170712 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9964026533830905, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.973527956490527, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=2.260524 cos_to_last_merge=0.9999 (last merge round=35)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.324946613360199, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3098241528213355, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=2.287404 cos_to_last_merge=0.9996 (last merge round=32)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.2707564874134472, 'auprc': 0.2707564874134472, 'loss_val': 1.7241150688795608, 'psi': 0.2707564874134472}-{'f1_val': 0.2710722384191772, 'auprc': 0.2710722384191772, 'loss_val': 1.7047140662548492, 'psi': 0.2710722384191772}
[S11] START round=38 head_norm_before_train=1.744378 cos_to_last_merge=0.9993 (last merge round=35)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.28063966443832744, 'auprc': 0.28063966443832744, 'loss_val': 1.689952380184878, 'psi': 0.28063966443832744}-{'f1_val': 0.28030898140874577, 'auprc': 0.28030898140874577, 'loss_val': 1.6249180236062521, 'psi': 0.28030898140874577}
[S13] START round=38 head_norm_before_train=1.710177 cos_to_last_merge=0.9754 (last merge round=28)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6127254965260354, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5980320304887632, 'psi': 0.3599362944611573}
[S14] START round=38 head_norm_before_train=1.886482 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.288877643060623, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.251905386499665, 'psi': 0.13592717296421}
[S15] START round=38 head_norm_before_train=1.786364 cos_to_last_merge=0.9983 (last merge round=35)
[S15] round=38 local utility u=0.121080 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6007020367040399, 'psi': 0.6153571007984797}-{'f1_val': 0.6006818740494615, 'auprc': 0.6006818740494615, 'loss_val': 0.7107855776339199, 'psi': 0.6006818740494615}
[S16] START round=38 head_norm_before_train=1.918788 cos_to_last_merge=0.9998 (last merge round=36)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.08901743391982003, 'auprc': 0.08901743391982003, 'loss_val': 3.9749753893418416, 'psi': 0.08901743391982003}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 3.714021306878977, 'psi': 0.08899598393574297}
[S17] START round=38 head_norm_before_train=2.169676 cos_to_last_merge=0.9994 (last merge round=33)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5410081569016987, 'auprc': 0.5410081569016987, 'loss_val': 1.3186787698779074, 'psi': 0.5410081569016987}-{'f1_val': 0.5577595192196497, 'auprc': 0.5577595192196497, 'loss_val': 1.2263416847939783, 'psi': 0.5577595192196497}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.5410 head_norm=2.189608
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.172165e-01
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.5406 head_norm=2.163949 delta_norm=0.117217
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:49312
[S15] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S15
[S11] cosine check vs S15: cos=0.9929
[S2] START round=39 head_norm_before_train=2.193114 cos_to_last_merge=0.9759 (last merge round=23)
[S2] round=39 local utility u=0.184699 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.7116692472755184, 'psi': 0.245119570522206}-{'f1_val': 0.2322515939537216, 'auprc': 0.2322515939537216, 'loss_val': 2.965256349057816, 'psi': 0.2322515939537216}
[S3] START round=39 head_norm_before_train=2.152519 cos_to_last_merge=0.9998 (last merge round=35)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.2922116782080875, 'auprc': 0.2922116782080875, 'loss_val': 2.811869338757999, 'psi': 0.2922116782080875}-{'f1_val': 0.29293187037509566, 'auprc': 0.29293187037509566, 'loss_val': 2.770267667292794, 'psi': 0.29293187037509566}
[S4] START round=39 head_norm_before_train=1.917520 cos_to_last_merge=0.9922 (last merge round=29)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.261391808027292, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2476254011503802, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=1.939413 cos_to_last_merge=0.9897 (last merge round=24)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.183811271968158, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.175498041874989, 'psi': 0.33308623671855697}
[S6] START round=39 head_norm_before_train=2.010084 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.918548550843596, 'psi': 0.02065167508031207}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.862834116666627, 'psi': 0.021310724106324473}
[S7] START round=39 head_norm_before_train=1.664219 (no previous merge yet)
[S7] round=39 local utility u=0.016362 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6738341722674388, 'psi': 0.24962705121829937}-{'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.7071187446301953, 'psi': 0.2496892866020383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S7] r=40 psi=0.250 u=0.0164 p_local=0.0682 f1=0.250 auprc=0.250 bytes=25176
[S8] START round=39 head_norm_before_train=2.180604 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0197348725504476, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9964026533830905, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=2.267664 cos_to_last_merge=0.9998 (last merge round=35)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3402114400370477, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.324946613360199, 'psi': 0.36867172340800847}
[S10] START round=39 head_norm_before_train=2.299206 cos_to_last_merge=0.9995 (last merge round=32)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.2678445682094616, 'auprc': 0.2678445682094616, 'loss_val': 1.753938785165269, 'psi': 0.2678445682094616}-{'f1_val': 0.2707564874134472, 'auprc': 0.2707564874134472, 'loss_val': 1.7241150688795608, 'psi': 0.2707564874134472}
[S11] START round=39 head_norm_before_train=1.767822 cos_to_last_merge=0.9983 (last merge round=35)
[S11] round=39 local utility u=0.001203 metrics={'f1_val': 0.28815727462465496, 'auprc': 0.28815727462465496, 'loss_val': 1.755204881820973, 'psi': 0.28815727462465496}-{'f1_val': 0.28063966443832744, 'auprc': 0.28063966443832744, 'loss_val': 1.689952380184878, 'psi': 0.28063966443832744}
[S13] START round=39 head_norm_before_train=1.725484 cos_to_last_merge=0.9738 (last merge round=28)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6381769257543726, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6127254965260354, 'psi': 0.3599362944611573}
[S14] START round=39 head_norm_before_train=1.892901 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.324230981040235, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.288877643060623, 'psi': 0.13592717296421}
[S15] START round=39 head_norm_before_train=1.822936 cos_to_last_merge=0.9966 (last merge round=35)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6184589874424752, 'psi': 0.6152170947577895}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6007020367040399, 'psi': 0.6153571007984797}
[S16] START round=39 head_norm_before_train=1.937328 cos_to_last_merge=0.9994 (last merge round=36)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.08901743391982003, 'auprc': 0.08901743391982003, 'loss_val': 4.1487060720895075, 'psi': 0.08901743391982003}-{'f1_val': 0.08901743391982003, 'auprc': 0.08901743391982003, 'loss_val': 3.9749753893418416, 'psi': 0.08901743391982003}
[S17] START round=39 head_norm_before_train=2.163949 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.787933 metrics={'f1_val': 0.6821705172879795, 'auprc': 0.6821705172879795, 'loss_val': 1.0132735701334714, 'psi': 0.6821705172879795}-{'f1_val': 0.5410081569016987, 'auprc': 0.5410081569016987, 'loss_val': 1.3186787698779074, 'psi': 0.5410081569016987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0030 f1=0.357 auprc=0.357 bytes=23393
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S6] r=40 psi=0.021 u=0.0000 p_local=0.0037 f1=0.021 auprc=0.021 bytes=0
[S2] sending update (kind=head size=1796 to 1 peers)
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0053 f1=0.360 auprc=0.360 bytes=9008
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0012 f1=0.136 auprc=0.136 bytes=0
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=0.9887
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.9982
[S17] r=40 psi=0.682 u=0.7879 p_local=0.3351 f1=0.682 auprc=0.682 bytes=37766
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.245 u=0.1847 p_local=0.0525 f1=0.245 auprc=0.245 bytes=23379
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=0.9889
[S10] r=40 psi=0.268 u=0.0000 p_local=0.0396 f1=0.268 auprc=0.268 bytes=21602
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0005 f1=0.359 auprc=0.359 bytes=9009
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0035 f1=0.369 auprc=0.369 bytes=7203
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=39 metric=0.2882 head_norm=1.790955
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.204151e-01
[S11] stored merged vector for next round verification (round=39)
[S11] DEBUG after merge:  round=39 metric=0.2884 head_norm=1.803000 delta_norm=0.120415
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] r=40 psi=0.288 u=0.0012 p_local=0.0235 f1=0.288 auprc=0.288 bytes=16215
[S16] r=40 psi=0.089 u=0.0000 p_local=0.0782 f1=0.089 auprc=0.089 bytes=0
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.6152 head_norm=1.856323
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.396794e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.6152 head_norm=1.818576 delta_norm=0.139679
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.615 u=0.0000 p_local=0.0265 f1=0.615 auprc=0.615 bytes=30625
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=39 metric=0.2922 head_norm=2.160220
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.188011e-02
[S3] stored merged vector for next round verification (round=39)
[S3] DEBUG after merge:  round=39 metric=0.2922 head_norm=2.169011 delta_norm=0.061880
[S3] aggregate: ACCEPT kept=['S2', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] r=40 psi=0.292 u=0.0000 p_local=0.0255 f1=0.292 auprc=0.292 bytes=19808
[S5] r=40 psi=0.333 u=0.0000 p_local=0.0054 f1=0.333 auprc=0.333 bytes=14388
[S2] START round=40 head_norm_before_train=2.201626 cos_to_last_merge=0.9751 (last merge round=23)
[S2] round=40 local utility u=0.003999 metrics={'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 2.7044799467170977, 'psi': 0.24520932503356518}-{'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.7116692472755184, 'psi': 0.245119570522206}
[S3] START round=40 head_norm_before_train=2.169011 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=40 local utility u=0.081910 metrics={'f1_val': 0.3014167073766488, 'auprc': 0.3014167073766488, 'loss_val': 2.730894334782016, 'psi': 0.3014167073766488}-{'f1_val': 0.2922116782080875, 'auprc': 0.2922116782080875, 'loss_val': 2.811869338757999, 'psi': 0.2922116782080875}
[S4] START round=40 head_norm_before_train=1.928062 cos_to_last_merge=0.9920 (last merge round=29)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2800486103845885, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.261391808027292, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=1.951841 cos_to_last_merge=0.9889 (last merge round=24)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1839021498283344, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.183811271968158, 'psi': 0.33308623671855697}
[S6] START round=40 head_norm_before_train=2.016274 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 7.960388155060529, 'psi': 0.01999080882352941}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.918548550843596, 'psi': 0.02065167508031207}
[S7] START round=40 head_norm_before_train=1.675668 (no previous merge yet)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7025029189500739, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6738341722674388, 'psi': 0.24962705121829937}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=2.191639 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0429894562510773, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0197348725504476, 'psi': 0.35939447907390915}
[S9] START round=40 head_norm_before_train=2.274647 cos_to_last_merge=0.9997 (last merge round=35)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3596710114883996, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3402114400370477, 'psi': 0.36867172340800847}
[S10] START round=40 head_norm_before_train=2.310638 cos_to_last_merge=0.9993 (last merge round=32)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.2684632659608598, 'auprc': 0.2684632659608598, 'loss_val': 1.7618904997873015, 'psi': 0.2684632659608598}-{'f1_val': 0.2678445682094616, 'auprc': 0.2678445682094616, 'loss_val': 1.753938785165269, 'psi': 0.2678445682094616}
[S11] START round=40 head_norm_before_train=1.803000 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.28556178275954097, 'auprc': 0.28556178275954097, 'loss_val': 1.73982862533048, 'psi': 0.28556178275954097}-{'f1_val': 0.28815727462465496, 'auprc': 0.28815727462465496, 'loss_val': 1.755204881820973, 'psi': 0.28815727462465496}
[S13] START round=40 head_norm_before_train=1.737395 cos_to_last_merge=0.9726 (last merge round=28)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6649626682680791, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6381769257543726, 'psi': 0.3599362944611573}
[S14] START round=40 head_norm_before_train=1.899123 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.359394857252333, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.324230981040235, 'psi': 0.13592717296421}
[S15] START round=40 head_norm_before_train=1.818576 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.002519 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6134205568663672, 'psi': 0.6152170947577895}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6184589874424752, 'psi': 0.6152170947577895}
[S16] START round=40 head_norm_before_train=1.954672 cos_to_last_merge=0.9988 (last merge round=36)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.08903889424622308, 'auprc': 0.08903889424622308, 'loss_val': 4.339947978580484, 'psi': 0.08903889424622308}-{'f1_val': 0.08901743391982003, 'auprc': 0.08901743391982003, 'loss_val': 4.1487060720895075, 'psi': 0.08901743391982003}
[S17] START round=40 head_norm_before_train=2.179368 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=40 local utility u=0.466530 metrics={'f1_val': 0.7631807937657273, 'auprc': 0.7631807937657273, 'loss_val': 0.8093054615409419, 'psi': 0.7631807937657273}-{'f1_val': 0.6821705172879795, 'auprc': 0.6821705172879795, 'loss_val': 1.0132735701334714, 'psi': 0.6821705172879795}
[S2] not sending this round → trigger blocked (psi=0.245)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.763)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.004 → S10@127.0.0.1:49311
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.001 → S16@127.0.0.1:49316
[S17] ⇄ pheromone p=0.361 → S3@127.0.0.1:49303
[S6] ⇄ pheromone p=0.003 → S8@127.0.0.1:49309
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.002 → S11@127.0.0.1:49312
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.043 → S3@127.0.0.1:49303
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:49317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:49312
[S15] sending update (kind=head size=1803 to 1 peers)
[S9] ⇄ pheromone p=0.003 → S10@127.0.0.1:49311
[S10] ⇄ pheromone p=0.032 → S9@127.0.0.1:49310
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] ⇄ pheromone p=0.000 → S14@127.0.0.1:49314
[S11] ⇄ pheromone p=0.019 → S15@127.0.0.1:49315
[S11] RECEIVED delta(kind=head bytes=1803) from S15
[S11] cosine check vs S15: cos=0.9991
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.9966
[S16] ⇄ pheromone p=0.063 → S9@127.0.0.1:49310
[S15] ⇄ pheromone p=0.022 → S2@127.0.0.1:49302
[S3] ⇄ pheromone p=0.037 → S17@127.0.0.1:49317
[S5] ⇄ pheromone p=0.004 → S16@127.0.0.1:49316
[S2] START round=41 head_norm_before_train=2.209175 cos_to_last_merge=0.9743 (last merge round=23)
[S2] round=41 local utility u=0.075021 metrics={'f1_val': 0.26526704958077507, 'auprc': 0.26526704958077507, 'loss_val': 2.7349576057474723, 'psi': 0.26526704958077507}-{'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 2.7044799467170977, 'psi': 0.24520932503356518}
[S3] START round=41 head_norm_before_train=2.176378 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.29893004115226335, 'auprc': 0.29893004115226335, 'loss_val': 2.7724109831971506, 'psi': 0.29893004115226335}-{'f1_val': 0.3014167073766488, 'auprc': 0.3014167073766488, 'loss_val': 2.730894334782016, 'psi': 0.3014167073766488}
[S4] START round=41 head_norm_before_train=1.940455 cos_to_last_merge=0.9914 (last merge round=29)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2914080117542048, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2800486103845885, 'psi': 0.3567939207526687}
[S5] START round=41 head_norm_before_train=1.960595 cos_to_last_merge=0.9882 (last merge round=24)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1979387913564206, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1839021498283344, 'psi': 0.33308623671855697}
[S6] START round=41 head_norm_before_train=2.022455 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.998924515969802, 'psi': 0.01954921803127875}-{'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 7.960388155060529, 'psi': 0.01999080882352941}
[S7] START round=41 head_norm_before_train=1.688121 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7118607949624045, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7025029189500739, 'psi': 0.24962705121829937}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=2.203608 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.052790780790766, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0429894562510773, 'psi': 0.35939447907390915}
[S9] START round=41 head_norm_before_train=2.281384 cos_to_last_merge=0.9996 (last merge round=35)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.383044143404719, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3596710114883996, 'psi': 0.36867172340800847}
[S10] START round=41 head_norm_before_train=2.322085 cos_to_last_merge=0.9992 (last merge round=32)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.2691367554354818, 'auprc': 0.2691367554354818, 'loss_val': 1.77244087544996, 'psi': 0.2691367554354818}-{'f1_val': 0.2684632659608598, 'auprc': 0.2684632659608598, 'loss_val': 1.7618904997873015, 'psi': 0.2684632659608598}
[S11] START round=41 head_norm_before_train=1.823945 cos_to_last_merge=0.9998 (last merge round=39)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.28095050544833927, 'auprc': 0.28095050544833927, 'loss_val': 1.7908037434017112, 'psi': 0.28095050544833927}-{'f1_val': 0.28556178275954097, 'auprc': 0.28556178275954097, 'loss_val': 1.73982862533048, 'psi': 0.28556178275954097}
[S13] START round=41 head_norm_before_train=1.752275 cos_to_last_merge=0.9713 (last merge round=28)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6892221299345573, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6649626682680791, 'psi': 0.3599362944611573}
[S14] START round=41 head_norm_before_train=1.904985 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.393779360952678, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.359394857252333, 'psi': 0.13592717296421}
[S15] START round=41 head_norm_before_train=1.853933 cos_to_last_merge=0.9997 (last merge round=39)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.613892760610502, 'psi': 0.613387689325667}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6134205568663672, 'psi': 0.6152170947577895}
[S16] START round=41 head_norm_before_train=1.969583 cos_to_last_merge=0.9982 (last merge round=36)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 4.452701624948702, 'psi': 0.0890603649224339}-{'f1_val': 0.08903889424622308, 'auprc': 0.08903889424622308, 'loss_val': 4.339947978580484, 'psi': 0.08903889424622308}
[S17] START round=41 head_norm_before_train=2.196765 cos_to_last_merge=0.9999 (last merge round=38)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6141719145504752, 'auprc': 0.6141719145504752, 'loss_val': 1.245900103297488, 'psi': 0.6141719145504752}-{'f1_val': 0.7631807937657273, 'auprc': 0.7631807937657273, 'loss_val': 0.8093054615409419, 'psi': 0.7631807937657273}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:49303
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1795 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.6142 head_norm=2.215393
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.880391e-02
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.6142 head_norm=2.193748 delta_norm=0.098804
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1795) from S2
[S3] cosine check vs S2: cos=0.9912
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=41 metric=0.2810 head_norm=1.844150
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.976790e-02
[S11] stored merged vector for next round verification (round=41)
[S11] DEBUG after merge:  round=41 metric=0.2810 head_norm=1.848378 delta_norm=0.049768
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=41 metric=0.2989 head_norm=2.183585
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.467192e-01
[S3] stored merged vector for next round verification (round=41)
[S3] DEBUG after merge:  round=41 metric=0.2983 head_norm=2.194976 delta_norm=0.146719
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=2.216044 cos_to_last_merge=0.9735 (last merge round=23)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.802386730272411, 'psi': 0.24507471790179935}-{'f1_val': 0.26526704958077507, 'auprc': 0.26526704958077507, 'loss_val': 2.7349576057474723, 'psi': 0.26526704958077507}
[S3] START round=42 head_norm_before_train=2.194976 cos_to_last_merge=1.0000 (last merge round=41)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.2941483803552769, 'auprc': 0.2941483803552769, 'loss_val': 2.8661588191011886, 'psi': 0.2941483803552769}-{'f1_val': 0.29893004115226335, 'auprc': 0.29893004115226335, 'loss_val': 2.7724109831971506, 'psi': 0.29893004115226335}
[S4] START round=42 head_norm_before_train=1.954546 cos_to_last_merge=0.9905 (last merge round=29)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2956126747882089, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2914080117542048, 'psi': 0.3567939207526687}
[S5] START round=42 head_norm_before_train=1.967397 cos_to_last_merge=0.9876 (last merge round=24)
[S5] round=42 local utility u=0.001428 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.1996118536303393, 'psi': 0.33358943696313936}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1979387913564206, 'psi': 0.33308623671855697}
[S6] START round=42 head_norm_before_train=2.028401 (no previous merge yet)
[S6] round=42 local utility u=0.001362 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 8.01205318209948, 'psi': 0.021310724106324473}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.998924515969802, 'psi': 0.01954921803127875}
[S7] START round=42 head_norm_before_train=1.697359 (no previous merge yet)
[S7] round=42 local utility u=0.374079 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7140782260919208, 'psi': 0.3330019880715706}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7118607949624045, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=42 head_norm_before_train=2.211949 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0705222620464228, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.052790780790766, 'psi': 0.35939447907390915}
[S9] START round=42 head_norm_before_train=2.287909 cos_to_last_merge=0.9995 (last merge round=35)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4046814066193902, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.383044143404719, 'psi': 0.36867172340800847}
[S10] START round=42 head_norm_before_train=2.333019 cos_to_last_merge=0.9990 (last merge round=32)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.2687219010918433, 'auprc': 0.2687219010918433, 'loss_val': 1.7881252105424714, 'psi': 0.2687219010918433}-{'f1_val': 0.2691367554354818, 'auprc': 0.2691367554354818, 'loss_val': 1.77244087544996, 'psi': 0.2691367554354818}
[S11] START round=42 head_norm_before_train=1.848378 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.28061893522161024, 'auprc': 0.28061893522161024, 'loss_val': 1.8073281880743357, 'psi': 0.28061893522161024}-{'f1_val': 0.28095050544833927, 'auprc': 0.28095050544833927, 'loss_val': 1.7908037434017112, 'psi': 0.28095050544833927}
[S13] START round=42 head_norm_before_train=1.763621 cos_to_last_merge=0.9704 (last merge round=28)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7146791672023634, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6892221299345573, 'psi': 0.3599362944611573}
[S14] START round=42 head_norm_before_train=1.910641 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.4274736660083365, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.393779360952678, 'psi': 0.13592717296421}
[S15] START round=42 head_norm_before_train=1.885304 cos_to_last_merge=0.9991 (last merge round=39)
[S15] round=42 local utility u=0.027031 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5850961881682021, 'psi': 0.6161950003225232}-{'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.613892760610502, 'psi': 0.613387689325667}
[S16] START round=42 head_norm_before_train=1.983217 cos_to_last_merge=0.9976 (last merge round=36)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 4.509388544131525, 'psi': 0.0890603649224339}-{'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 4.452701624948702, 'psi': 0.0890603649224339}
[S17] START round=42 head_norm_before_train=2.193748 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=0.211277 metrics={'f1_val': 0.6515460127139445, 'auprc': 0.6515460127139445, 'loss_val': 1.1597128327983939, 'psi': 0.6515460127139445}-{'f1_val': 0.6141719145504752, 'auprc': 0.6141719145504752, 'loss_val': 1.245900103297488, 'psi': 0.6141719145504752}
[S6] not sending this round → trigger blocked (psi=0.021)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.9938
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:49302
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.9882
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S15
[S2] cosine check vs S15: cos=0.6982
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=42 metric=0.2941 head_norm=2.201840
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.230886e-01
[S3] stored merged vector for next round verification (round=42)
[S3] DEBUG after merge:  round=42 metric=0.2937 head_norm=2.203495 delta_norm=0.123089
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.0891 head_norm=1.996236
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.531884e-01
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.0891 head_norm=1.980462 delta_norm=0.153188
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=2.223059 cos_to_last_merge=0.9728 (last merge round=23)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.8533745034375766, 'psi': 0.2450298816928894}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.802386730272411, 'psi': 0.24507471790179935}
[S3] START round=43 head_norm_before_train=2.203495 cos_to_last_merge=1.0000 (last merge round=42)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.2997942938914229, 'auprc': 0.2997942938914229, 'loss_val': 3.1025303921948066, 'psi': 0.2997942938914229}-{'f1_val': 0.2941483803552769, 'auprc': 0.2941483803552769, 'loss_val': 2.8661588191011886, 'psi': 0.2941483803552769}
[S4] START round=43 head_norm_before_train=1.974545 cos_to_last_merge=0.9896 (last merge round=29)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3541843788534107, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2956126747882089, 'psi': 0.3567939207526687}
[S5] START round=43 head_norm_before_train=1.976469 cos_to_last_merge=0.9869 (last merge round=24)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.2056005551016886, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.1996118536303393, 'psi': 0.33358943696313936}
[S6] START round=43 head_norm_before_train=2.034104 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 8.030492676344311, 'psi': 0.021310724106324473}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 8.01205318209948, 'psi': 0.021310724106324473}
[S7] START round=43 head_norm_before_train=1.707571 (no previous merge yet)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.6871779081146203, 'psi': 0.2496892866020383}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7140782260919208, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=2.220727 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.088863525420481, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0705222620464228, 'psi': 0.35939447907390915}
[S9] START round=43 head_norm_before_train=2.294046 cos_to_last_merge=0.9994 (last merge round=35)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4235980334447436, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4046814066193902, 'psi': 0.36867172340800847}
[S10] START round=43 head_norm_before_train=2.343185 cos_to_last_merge=0.9988 (last merge round=32)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.2678445682094616, 'auprc': 0.2678445682094616, 'loss_val': 1.8083508318559556, 'psi': 0.2678445682094616}-{'f1_val': 0.2687219010918433, 'auprc': 0.2687219010918433, 'loss_val': 1.7881252105424714, 'psi': 0.2687219010918433}
[S11] START round=43 head_norm_before_train=1.867107 cos_to_last_merge=0.9999 (last merge round=41)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.2816160021055402, 'auprc': 0.2816160021055402, 'loss_val': 1.8575940059407028, 'psi': 0.2816160021055402}-{'f1_val': 0.28061893522161024, 'auprc': 0.28061893522161024, 'loss_val': 1.8073281880743357, 'psi': 0.28061893522161024}
[S13] START round=43 head_norm_before_train=1.777705 cos_to_last_merge=0.9690 (last merge round=28)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7464403730321496, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7146791672023634, 'psi': 0.3599362944611573}
[S14] START round=43 head_norm_before_train=1.916237 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.459825640733506, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.4274736660083365, 'psi': 0.13592717296421}
[S15] START round=43 head_norm_before_train=1.912965 cos_to_last_merge=0.9984 (last merge round=39)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.6455879413030887, 'psi': 0.613387689325667}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5850961881682021, 'psi': 0.6161950003225232}
[S16] START round=43 head_norm_before_train=1.980462 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.121151 metrics={'f1_val': 0.08901743391982003, 'auprc': 0.08901743391982003, 'loss_val': 4.266700054824283, 'psi': 0.08901743391982003}-{'f1_val': 0.0890603649224339, 'auprc': 0.0890603649224339, 'loss_val': 4.509388544131525, 'psi': 0.0890603649224339}
[S17] START round=43 head_norm_before_train=2.212009 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=43 local utility u=0.177603 metrics={'f1_val': 0.6869576185590686, 'auprc': 0.6869576185590686, 'loss_val': 1.1232106084421514, 'psi': 0.6869576185590686}-{'f1_val': 0.6515460127139445, 'auprc': 0.6515460127139445, 'loss_val': 1.1597128327983939, 'psi': 0.6515460127139445}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.687)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=43 metric=0.2450 head_norm=2.229811
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.178964e-01
[S2] stored merged vector for next round verification (round=43)
[S2] DEBUG after merge:  round=43 metric=0.3675 head_norm=1.909657 delta_norm=0.817896
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.089)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.909657 cos_to_last_merge=1.0000 (last merge round=43)
[S2] round=44 local utility u=0.196773 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.4602316915439224, 'psi': 0.24507471790179935}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.8533745034375766, 'psi': 0.2450298816928894}
[S3] START round=44 head_norm_before_train=2.210313 cos_to_last_merge=1.0000 (last merge round=42)
[S3] round=44 local utility u=0.121268 metrics={'f1_val': 0.29725470680932237, 'auprc': 0.29725470680932237, 'loss_val': 2.837137436229212, 'psi': 0.29725470680932237}-{'f1_val': 0.2997942938914229, 'auprc': 0.2997942938914229, 'loss_val': 3.1025303921948066, 'psi': 0.2997942938914229}
[S4] START round=44 head_norm_before_train=1.989404 cos_to_last_merge=0.9885 (last merge round=29)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3548122648756846, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3541843788534107, 'psi': 0.3567939207526687}
[S5] START round=44 head_norm_before_train=1.986797 cos_to_last_merge=0.9859 (last merge round=24)
[S5] round=44 local utility u=0.004443 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1921864808645224, 'psi': 0.33308623671855697}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.2056005551016886, 'psi': 0.33358943696313936}
[S6] START round=44 head_norm_before_train=2.039672 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 8.048862820343684, 'psi': 0.021310724106324473}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 8.030492676344311, 'psi': 0.021310724106324473}
[S7] START round=44 head_norm_before_train=1.718117 (no previous merge yet)
[S7] round=44 local utility u=0.018326 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6499648490896749, 'psi': 0.24962705121829937}-{'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.6871779081146203, 'psi': 0.2496892866020383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=44 head_norm_before_train=2.230156 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1054421993286225, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.088863525420481, 'psi': 0.35939447907390915}
[S9] START round=44 head_norm_before_train=2.299757 cos_to_last_merge=0.9993 (last merge round=35)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.43890905367313, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4235980334447436, 'psi': 0.36867172340800847}
[S10] START round=44 head_norm_before_train=2.352868 cos_to_last_merge=0.9987 (last merge round=32)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.26671766430802574, 'auprc': 0.26671766430802574, 'loss_val': 1.828109844066333, 'psi': 0.26671766430802574}-{'f1_val': 0.2678445682094616, 'auprc': 0.2678445682094616, 'loss_val': 1.8083508318559556, 'psi': 0.2678445682094616}
[S11] START round=44 head_norm_before_train=1.884733 cos_to_last_merge=0.9996 (last merge round=41)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.2833498841443231, 'auprc': 0.2833498841443231, 'loss_val': 1.9017060241584571, 'psi': 0.2833498841443231}-{'f1_val': 0.2816160021055402, 'auprc': 0.2816160021055402, 'loss_val': 1.8575940059407028, 'psi': 0.2816160021055402}
[S13] START round=44 head_norm_before_train=1.789058 cos_to_last_merge=0.9679 (last merge round=28)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7692402118200696, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7464403730321496, 'psi': 0.3599362944611573}
[S14] START round=44 head_norm_before_train=1.921683 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.490468808515829, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.459825640733506, 'psi': 0.13592717296421}
[S15] START round=44 head_norm_before_train=1.939272 cos_to_last_merge=0.9975 (last merge round=39)
[S15] round=44 local utility u=0.017200 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6364527857149976, 'psi': 0.6161950003225232}-{'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.6455879413030887, 'psi': 0.613387689325667}
[S16] START round=44 head_norm_before_train=1.992922 cos_to_last_merge=0.9999 (last merge round=42)
[S16] round=44 local utility u=1.000000 metrics={'f1_val': 0.1755605533973966, 'auprc': 0.1755605533973966, 'loss_val': 2.882749084719392, 'psi': 0.1755605533973966}-{'f1_val': 0.08901743391982003, 'auprc': 0.08901743391982003, 'loss_val': 4.266700054824283, 'psi': 0.08901743391982003}
[S17] START round=44 head_norm_before_train=2.226648 cos_to_last_merge=0.9998 (last merge round=41)
[S17] round=44 local utility u=0.136169 metrics={'f1_val': 0.7121205225069409, 'auprc': 0.7121205225069409, 'loss_val': 1.0773390776688403, 'psi': 0.7121205225069409}-{'f1_val': 0.6869576185590686, 'auprc': 0.6869576185590686, 'loss_val': 1.1232106084421514, 'psi': 0.6869576185590686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:49303
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1794 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] cosine check vs S17: cos=0.9979
[S16] not sending this round → trigger blocked (psi=0.176)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:49317
[S5] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.9950
[S3] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S3
[S17] cosine check vs S3: cos=0.9979
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=44 metric=0.1756 head_norm=2.006384
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.000561e-01
[S16] stored merged vector for next round verification (round=44)
[S16] DEBUG after merge:  round=44 metric=0.1757 head_norm=1.998293 delta_norm=0.100056
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:49302
[S15] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S15
[S2] cosine check vs S15: cos=0.9051
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S2
[S3] cosine check vs S2: cos=0.9312
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=44 metric=0.2451 head_norm=1.923755
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.237421e-01
[S2] stored merged vector for next round verification (round=44)
[S2] DEBUG after merge:  round=44 metric=0.2450 head_norm=1.896361 delta_norm=0.423742
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=44 metric=0.2973 head_norm=2.216483
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.983091e-01
[S3] stored merged vector for next round verification (round=44)
[S3] DEBUG after merge:  round=44 metric=0.2998 head_norm=2.122938 delta_norm=0.198309
[S3] aggregate: ACCEPT kept=['S17', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.896361 cos_to_last_merge=1.0000 (last merge round=44)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.23159707275075334, 'auprc': 0.23159707275075334, 'loss_val': 2.6040823422999044, 'psi': 0.23159707275075336}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.4602316915439224, 'psi': 0.24507471790179935}
[S3] START round=45 head_norm_before_train=2.122938 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.2992753623188406, 'auprc': 0.2992753623188406, 'loss_val': 3.033938395167129, 'psi': 0.2992753623188406}-{'f1_val': 0.29725470680932237, 'auprc': 0.29725470680932237, 'loss_val': 2.837137436229212, 'psi': 0.29725470680932237}
[S4] START round=45 head_norm_before_train=1.998632 cos_to_last_merge=0.9872 (last merge round=29)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4081752135883594, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3548122648756846, 'psi': 0.3567939207526687}
[S5] START round=45 head_norm_before_train=1.995193 cos_to_last_merge=0.9852 (last merge round=24)
[S5] round=45 local utility u=0.006529 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.179128154473852, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1921864808645224, 'psi': 0.33308623671855697}
[S6] START round=45 head_norm_before_train=2.045211 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 8.106048482783217, 'psi': 0.021310724106324473}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 8.048862820343684, 'psi': 0.021310724106324473}
[S7] START round=45 head_norm_before_train=1.727292 (no previous merge yet)
[S7] round=45 local utility u=0.016991 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6159836625677283, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6499648490896749, 'psi': 0.24962705121829937}
[S7] not sending this round → trigger blocked (psi=0.250)
[S8] START round=45 head_norm_before_train=2.240543 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.12735120043596, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1054421993286225, 'psi': 0.35939447907390915}
[S9] START round=45 head_norm_before_train=2.305079 cos_to_last_merge=0.9991 (last merge round=35)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4538831751670824, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.43890905367313, 'psi': 0.36867172340800847}
[S10] START round=45 head_norm_before_train=2.362658 cos_to_last_merge=0.9985 (last merge round=32)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.26646287097185073, 'auprc': 0.26646287097185073, 'loss_val': 1.8404269165394482, 'psi': 0.26646287097185073}-{'f1_val': 0.26671766430802574, 'auprc': 0.26671766430802574, 'loss_val': 1.828109844066333, 'psi': 0.26671766430802574}
[S11] START round=45 head_norm_before_train=1.900862 cos_to_last_merge=0.9993 (last merge round=41)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.282788239180707, 'auprc': 0.282788239180707, 'loss_val': 1.9358849378805192, 'psi': 0.282788239180707}-{'f1_val': 0.2833498841443231, 'auprc': 0.2833498841443231, 'loss_val': 1.9017060241584571, 'psi': 0.2833498841443231}
[S13] START round=45 head_norm_before_train=1.798333 cos_to_last_merge=0.9669 (last merge round=28)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7860329969694966, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7692402118200696, 'psi': 0.3599362944611573}
[S14] START round=45 head_norm_before_train=1.927080 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.52085184864355, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.490468808515829, 'psi': 0.13592717296421}
[S15] START round=45 head_norm_before_train=1.962307 cos_to_last_merge=0.9966 (last merge round=39)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.6594762311390442, 'psi': 0.6142341889454641}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6364527857149976, 'psi': 0.6161950003225232}
[S16] START round=45 head_norm_before_train=1.998293 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.09448818897637795, 'auprc': 0.09448818897637795, 'loss_val': 3.8037385857723756, 'psi': 0.09448818897637795}-{'f1_val': 0.1755605533973966, 'auprc': 0.1755605533973966, 'loss_val': 2.882749084719392, 'psi': 0.1755605533973966}
[S17] START round=45 head_norm_before_train=2.244606 cos_to_last_merge=0.9997 (last merge round=41)
[S17] round=45 local utility u=0.198490 metrics={'f1_val': 0.7446746682710313, 'auprc': 0.7446746682710313, 'loss_val': 0.9733457065105717, 'psi': 0.7446746682710313}-{'f1_val': 0.7121205225069409, 'auprc': 0.7121205225069409, 'loss_val': 1.0773390776688403, 'psi': 0.7121205225069409}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49316
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.001 → S8@127.0.0.1:49309
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.000 → S16@127.0.0.1:49316
[S4] ⇄ pheromone p=0.001 → S11@127.0.0.1:49312
[S13] ⇄ pheromone p=0.001 → S10@127.0.0.1:49311
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.9943
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=45 metric=0.7447 head_norm=2.260492
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.146153e-02
[S17] stored merged vector for next round verification (round=45)
[S17] DEBUG after merge:  round=45 metric=0.7456 head_norm=2.237113 delta_norm=0.081462
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.224 → S3@127.0.0.1:49303
[S5] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=0.9980
[S8] ⇄ pheromone p=0.000 → S14@127.0.0.1:49314
[S10] ⇄ pheromone p=0.010 → S9@127.0.0.1:49310
[S11] ⇄ pheromone p=0.006 → S15@127.0.0.1:49315
[S5] ⇄ pheromone p=0.004 → S16@127.0.0.1:49316
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=45 metric=0.0945 head_norm=2.012484
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.333960e-02
[S16] stored merged vector for next round verification (round=45)
[S16] DEBUG after merge:  round=45 metric=0.0945 head_norm=2.007776 delta_norm=0.063340
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.196 → S9@127.0.0.1:49310
[S15] ⇄ pheromone p=0.013 → S2@127.0.0.1:49302
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.052 → S3@127.0.0.1:49303
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.001 → S8@127.0.0.1:49309
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=45 metric=0.2993 head_norm=2.129422
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.342629e-01
[S3] stored merged vector for next round verification (round=45)
[S3] DEBUG after merge:  round=45 metric=0.2993 head_norm=2.191827 delta_norm=0.134263
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.031 → S17@127.0.0.1:49317
[S2] START round=46 head_norm_before_train=1.923089 cos_to_last_merge=0.9985 (last merge round=44)
[S2] round=46 local utility u=0.299113 metrics={'f1_val': 0.26518753301637615, 'auprc': 0.26518753301637615, 'loss_val': 2.3081709969676196, 'psi': 0.26518753301637615}-{'f1_val': 0.23159707275075334, 'auprc': 0.23159707275075334, 'loss_val': 2.6040823422999044, 'psi': 0.23159707275075336}
[S3] START round=46 head_norm_before_train=2.191827 cos_to_last_merge=1.0000 (last merge round=45)
[S3] round=46 local utility u=0.046681 metrics={'f1_val': 0.29215786776012304, 'auprc': 0.29215786776012304, 'loss_val': 2.8765196475445323, 'psi': 0.29215786776012304}-{'f1_val': 0.2992753623188406, 'auprc': 0.2992753623188406, 'loss_val': 3.033938395167129, 'psi': 0.2992753623188406}
[S4] START round=46 head_norm_before_train=2.015026 cos_to_last_merge=0.9861 (last merge round=29)
[S4] round=46 local utility u=0.015777 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.376620714451548, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4081752135883594, 'psi': 0.3567939207526687}
[S5] START round=46 head_norm_before_train=2.005059 cos_to_last_merge=0.9845 (last merge round=24)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.196140103294566, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.179128154473852, 'psi': 0.33308623671855697}
[S6] START round=46 head_norm_before_train=2.050644 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 8.14912324166343, 'psi': 0.020871559633027524}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 8.106048482783217, 'psi': 0.021310724106324473}
[S7] START round=46 head_norm_before_train=1.736145 (no previous merge yet)
[S7] round=46 local utility u=0.002759 metrics={'f1_val': 0.24950248756218907, 'auprc': 0.24950248756218907, 'loss_val': 0.6093444365518766, 'psi': 0.24950248756218907}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6159836625677283, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=46 head_norm_before_train=2.250566 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1449472294783023, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.12735120043596, 'psi': 0.35939447907390915}
[S9] START round=46 head_norm_before_train=2.310292 cos_to_last_merge=0.9990 (last merge round=35)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4707527708454093, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4538831751670824, 'psi': 0.36867172340800847}
[S10] START round=46 head_norm_before_train=2.371881 cos_to_last_merge=0.9983 (last merge round=32)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.26625938653430065, 'auprc': 0.26625938653430065, 'loss_val': 1.85247805995536, 'psi': 0.26625938653430065}-{'f1_val': 0.26646287097185073, 'auprc': 0.26646287097185073, 'loss_val': 1.8404269165394482, 'psi': 0.26646287097185073}
[S11] START round=46 head_norm_before_train=1.915598 cos_to_last_merge=0.9988 (last merge round=41)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.28072937163846257, 'auprc': 0.28072937163846257, 'loss_val': 1.9598976415075853, 'psi': 0.28072937163846257}-{'f1_val': 0.282788239180707, 'auprc': 0.282788239180707, 'loss_val': 1.9358849378805192, 'psi': 0.282788239180707}
[S13] START round=46 head_norm_before_train=1.805647 cos_to_last_merge=0.9661 (last merge round=28)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.797997555058127, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7860329969694966, 'psi': 0.3599362944611573}
[S14] START round=46 head_norm_before_train=1.932309 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.550175450913962, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.52085184864355, 'psi': 0.13592717296421}
[S15] START round=46 head_norm_before_train=1.984512 cos_to_last_merge=0.9957 (last merge round=39)
[S15] round=46 local utility u=0.016187 metrics={'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6422404783359755, 'psi': 0.61591610673549}-{'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.6594762311390442, 'psi': 0.6142341889454641}
[S16] START round=46 head_norm_before_train=2.007776 cos_to_last_merge=1.0000 (last merge round=45)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.06624843161856964, 'auprc': 0.06624843161856964, 'loss_val': 4.488879395347892, 'psi': 0.06624843161856964}-{'f1_val': 0.09448818897637795, 'auprc': 0.09448818897637795, 'loss_val': 3.8037385857723756, 'psi': 0.09448818897637795}
[S17] START round=46 head_norm_before_train=2.237113 cos_to_last_merge=1.0000 (last merge round=45)
[S17] round=46 local utility u=0.429041 metrics={'f1_val': 0.8135502170718605, 'auprc': 0.8135502170718605, 'loss_val': 0.7351445507171558, 'psi': 0.8135502170718605}-{'f1_val': 0.7446746682710313, 'auprc': 0.7446746682710313, 'loss_val': 0.9733457065105717, 'psi': 0.7446746682710313}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.814)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.7619
[S3] RECEIVED delta(kind=head bytes=1799) from S2
[S3] cosine check vs S2: cos=0.8622
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:49317
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=46 metric=0.2807 head_norm=1.928893
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.827182e-01
[S11] stored merged vector for next round verification (round=46)
[S11] DEBUG after merge:  round=46 metric=0.2804 head_norm=1.853715 delta_norm=0.682718
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] RECEIVED delta(kind=head bytes=1799) from S15
[S2] cosine check vs S15: cos=0.9614
[S17] RECEIVED delta(kind=head bytes=1797) from S3
[S17] cosine check vs S3: cos=0.9992
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=46 metric=0.2922 head_norm=2.198326
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.577070e-01
[S3] stored merged vector for next round verification (round=46)
[S3] DEBUG after merge:  round=46 metric=0.2948 head_norm=2.004981 delta_norm=0.557707
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.956868 cos_to_last_merge=0.9949 (last merge round=44)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.251234915275433, 'auprc': 0.251234915275433, 'loss_val': 2.188596497394962, 'psi': 0.251234915275433}-{'f1_val': 0.26518753301637615, 'auprc': 0.26518753301637615, 'loss_val': 2.3081709969676196, 'psi': 0.26518753301637615}
[S3] START round=47 head_norm_before_train=2.004981 cos_to_last_merge=1.0000 (last merge round=46)
[S3] round=47 local utility u=0.377408 metrics={'f1_val': 0.30794623909455315, 'auprc': 0.30794623909455315, 'loss_val': 2.2637986793882985, 'psi': 0.30794623909455315}-{'f1_val': 0.29215786776012304, 'auprc': 0.29215786776012304, 'loss_val': 2.8765196475445323, 'psi': 0.29215786776012304}
[S4] START round=47 head_norm_before_train=2.020915 cos_to_last_merge=0.9855 (last merge round=29)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4273291367854797, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.376620714451548, 'psi': 0.3567939207526687}
[S5] START round=47 head_norm_before_train=2.016392 cos_to_last_merge=0.9835 (last merge round=24)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.223688145816965, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.196140103294566, 'psi': 0.33308623671855697}
[S6] START round=47 head_norm_before_train=2.056142 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 8.197317545760397, 'psi': 0.018219557195571955}-{'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 8.14912324166343, 'psi': 0.020871559633027524}
[S7] START round=47 head_norm_before_train=1.744446 (no previous merge yet)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.6463739491342337, 'psi': 0.24956478487938324}-{'f1_val': 0.24950248756218907, 'auprc': 0.24950248756218907, 'loss_val': 0.6093444365518766, 'psi': 0.24950248756218907}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.259395 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.16077015160646, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1449472294783023, 'psi': 0.35939447907390915}
[S9] START round=47 head_norm_before_train=2.315351 cos_to_last_merge=0.9989 (last merge round=35)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4869425398982243, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4707527708454093, 'psi': 0.36867172340800847}
[S10] START round=47 head_norm_before_train=2.380940 cos_to_last_merge=0.9981 (last merge round=32)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.26595474192728197, 'auprc': 0.26595474192728197, 'loss_val': 1.8645407664782119, 'psi': 0.26595474192728197}-{'f1_val': 0.26625938653430065, 'auprc': 0.26625938653430065, 'loss_val': 1.85247805995536, 'psi': 0.26625938653430065}
[S11] START round=47 head_norm_before_train=1.853715 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.28047422545359274, 'auprc': 0.28047422545359274, 'loss_val': 1.9825146575900678, 'psi': 0.28047422545359274}-{'f1_val': 0.28072937163846257, 'auprc': 0.28072937163846257, 'loss_val': 1.9598976415075853, 'psi': 0.28072937163846257}
[S13] START round=47 head_norm_before_train=1.812884 cos_to_last_merge=0.9655 (last merge round=28)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8143880847988618, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.797997555058127, 'psi': 0.3599362944611573}
[S14] START round=47 head_norm_before_train=1.937387 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.578070168843309, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.550175450913962, 'psi': 0.13592717296421}
[S15] START round=47 head_norm_before_train=2.004325 cos_to_last_merge=0.9949 (last merge round=39)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6140933634089104, 'auprc': 0.6140933634089104, 'loss_val': 0.656901633475287, 'psi': 0.6140933634089104}-{'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6422404783359755, 'psi': 0.61591610673549}
[S16] START round=47 head_norm_before_train=2.022340 cos_to_last_merge=0.9999 (last merge round=45)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.054901960784313725, 'auprc': 0.054901960784313725, 'loss_val': 4.641013822325029, 'psi': 0.054901960784313725}-{'f1_val': 0.06624843161856964, 'auprc': 0.06624843161856964, 'loss_val': 4.488879395347892, 'psi': 0.06624843161856964}
[S17] START round=47 head_norm_before_train=2.251069 cos_to_last_merge=1.0000 (last merge round=45)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5324784243130196, 'auprc': 0.5324784243130196, 'loss_val': 1.6556329997388874, 'psi': 0.5324784243130196}-{'f1_val': 0.8135502170718605, 'auprc': 0.8135502170718605, 'loss_val': 0.7351445507171558, 'psi': 0.8135502170718605}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=47 metric=0.5325 head_norm=2.261866
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.430943e-02
[S17] stored merged vector for next round verification (round=47)
[S17] DEBUG after merge:  round=47 metric=0.5325 head_norm=2.229661 delta_norm=0.054309
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=47 metric=0.2512 head_norm=1.985053
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.964959e-01
[S2] stored merged vector for next round verification (round=47)
[S2] DEBUG after merge:  round=47 metric=0.2495 head_norm=1.972553 delta_norm=0.296496
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.308)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.972553 cos_to_last_merge=1.0000 (last merge round=47)
[S2] round=48 local utility u=0.035411 metrics={'f1_val': 0.2554030002542588, 'auprc': 0.2554030002542588, 'loss_val': 2.1552867159204636, 'psi': 0.2554030002542588}-{'f1_val': 0.251234915275433, 'auprc': 0.251234915275433, 'loss_val': 2.188596497394962, 'psi': 0.251234915275433}
[S3] START round=48 head_norm_before_train=2.013437 cos_to_last_merge=1.0000 (last merge round=46)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.2976157851466155, 'auprc': 0.2976157851466155, 'loss_val': 2.8559753719415024, 'psi': 0.2976157851466155}-{'f1_val': 0.30794623909455315, 'auprc': 0.30794623909455315, 'loss_val': 2.2637986793882985, 'psi': 0.30794623909455315}
[S4] START round=48 head_norm_before_train=2.024313 cos_to_last_merge=0.9841 (last merge round=29)
[S4] round=48 local utility u=0.013939 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3994510904070827, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4273291367854797, 'psi': 0.3567939207526687}
[S5] START round=48 head_norm_before_train=2.029631 cos_to_last_merge=0.9823 (last merge round=24)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.2304751354873678, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.223688145816965, 'psi': 0.33308623671855697}
[S6] START round=48 head_norm_before_train=2.061350 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.220760197855718, 'psi': 0.019770114942528734}-{'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 8.197317545760397, 'psi': 0.018219557195571955}
[S7] START round=48 head_norm_before_train=1.751795 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6993962613960946, 'psi': 0.24962705121829937}-{'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.6463739491342337, 'psi': 0.24956478487938324}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.267945 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.180817810466402, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.16077015160646, 'psi': 0.35939447907390915}
[S9] START round=48 head_norm_before_train=2.320203 cos_to_last_merge=0.9987 (last merge round=35)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.502082748223413, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4869425398982243, 'psi': 0.36867172340800847}
[S10] START round=48 head_norm_before_train=2.389637 cos_to_last_merge=0.9980 (last merge round=32)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.2658026808970205, 'auprc': 0.2658026808970205, 'loss_val': 1.8835569696065577, 'psi': 0.2658026808970205}-{'f1_val': 0.26595474192728197, 'auprc': 0.26595474192728197, 'loss_val': 1.8645407664782119, 'psi': 0.26595474192728197}
[S11] START round=48 head_norm_before_train=1.866609 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.28222881635344543, 'auprc': 0.28222881635344543, 'loss_val': 2.023725594938911, 'psi': 0.28222881635344543}-{'f1_val': 0.28047422545359274, 'auprc': 0.28047422545359274, 'loss_val': 1.9825146575900678, 'psi': 0.28047422545359274}
[S13] START round=48 head_norm_before_train=1.824144 cos_to_last_merge=0.9643 (last merge round=28)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.827679154707724, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8143880847988618, 'psi': 0.3599362944611573}
[S14] START round=48 head_norm_before_train=1.942405 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.605593984511584, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.578070168843309, 'psi': 0.13587634006482174}
[S15] START round=48 head_norm_before_train=2.021548 cos_to_last_merge=0.9940 (last merge round=39)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.6700287471646926, 'psi': 0.6136702686915539}-{'f1_val': 0.6140933634089104, 'auprc': 0.6140933634089104, 'loss_val': 0.656901633475287, 'psi': 0.6140933634089104}
[S16] START round=48 head_norm_before_train=2.037237 cos_to_last_merge=0.9996 (last merge round=45)
[S16] round=48 local utility u=0.210712 metrics={'f1_val': 0.08903889424622308, 'auprc': 0.08903889424622308, 'loss_val': 4.526822572052844, 'psi': 0.08903889424622308}-{'f1_val': 0.054901960784313725, 'auprc': 0.054901960784313725, 'loss_val': 4.641013822325029, 'psi': 0.054901960784313725}
[S17] START round=48 head_norm_before_train=2.229661 cos_to_last_merge=1.0000 (last merge round=47)
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.7914800629597284, 'auprc': 0.7914800629597284, 'loss_val': 0.8284030360732441, 'psi': 0.7914800629597284}-{'f1_val': 0.5324784243130196, 'auprc': 0.5324784243130196, 'loss_val': 1.6556329997388874, 'psi': 0.5324784243130196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:49312
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:49303
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1796 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=0.9257
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.9388
[S16] not sending this round → trigger blocked (psi=0.089)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S17
[S3] cosine check vs S17: cos=0.9646
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=48 metric=0.2976 head_norm=2.023327
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.066537e-02
[S3] stored merged vector for next round verification (round=48)
[S3] DEBUG after merge:  round=48 metric=0.2976 head_norm=2.015554 delta_norm=0.050665
[S3] aggregate: ACCEPT kept=['S2', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=48 metric=0.2822 head_norm=1.878641
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.511559e-01
[S11] stored merged vector for next round verification (round=48)
[S11] DEBUG after merge:  round=48 metric=0.2807 head_norm=1.927355 delta_norm=0.351156
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.997698 cos_to_last_merge=0.9996 (last merge round=47)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.25711908875663914, 'auprc': 0.25711908875663914, 'loss_val': 2.186710019537932, 'psi': 0.25711908875663914}-{'f1_val': 0.2554030002542588, 'auprc': 0.2554030002542588, 'loss_val': 2.1552867159204636, 'psi': 0.2554030002542588}
[S3] START round=49 head_norm_before_train=2.015554 cos_to_last_merge=1.0000 (last merge round=48)
[S3] round=49 local utility u=0.131273 metrics={'f1_val': 0.29958144091192446, 'auprc': 0.29958144091192446, 'loss_val': 2.611120414784299, 'psi': 0.29958144091192446}-{'f1_val': 0.2976157851466155, 'auprc': 0.2976157851466155, 'loss_val': 2.8559753719415024, 'psi': 0.2976157851466155}
[S4] START round=49 head_norm_before_train=2.036352 cos_to_last_merge=0.9827 (last merge round=29)
[S4] round=49 local utility u=0.002118 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3952142751673495, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3994510904070827, 'psi': 0.3567939207526687}
[S5] START round=49 head_norm_before_train=2.040230 cos_to_last_merge=0.9814 (last merge round=24)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.247945851685167, 'psi': 0.33358943696313936}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.2304751354873678, 'psi': 0.33308623671855697}
[S6] START round=49 head_norm_before_train=2.066329 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 8.247838091935769, 'psi': 0.020211299954065228}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.220760197855718, 'psi': 0.019770114942528734}
[S7] START round=49 head_norm_before_train=1.758667 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.71315156079802, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6993962613960946, 'psi': 0.24962705121829937}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.275970 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.198285977371075, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.180817810466402, 'psi': 0.35939447907390915}
[S9] START round=49 head_norm_before_train=2.324868 cos_to_last_merge=0.9986 (last merge round=35)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5164988892209257, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.502082748223413, 'psi': 0.36867172340800847}
[S10] START round=49 head_norm_before_train=2.397786 cos_to_last_merge=0.9978 (last merge round=32)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.2650449765615102, 'auprc': 0.2650449765615102, 'loss_val': 1.9084015512009123, 'psi': 0.2650449765615102}-{'f1_val': 0.2658026808970205, 'auprc': 0.2658026808970205, 'loss_val': 1.8835569696065577, 'psi': 0.2658026808970205}
[S11] START round=49 head_norm_before_train=1.927355 cos_to_last_merge=1.0000 (last merge round=48)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.29026788741946424, 'auprc': 0.29026788741946424, 'loss_val': 2.0960944554686143, 'psi': 0.29026788741946424}-{'f1_val': 0.28222881635344543, 'auprc': 0.28222881635344543, 'loss_val': 2.023725594938911, 'psi': 0.28222881635344543}
[S13] START round=49 head_norm_before_train=1.836349 cos_to_last_merge=0.9629 (last merge round=28)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8432295911066978, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.827679154707724, 'psi': 0.3599362944611573}
[S14] START round=49 head_norm_before_train=1.947259 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.633662643021894, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.605593984511584, 'psi': 0.13587634006482174}
[S15] START round=49 head_norm_before_train=2.038369 cos_to_last_merge=0.9932 (last merge round=39)
[S15] round=49 local utility u=0.016823 metrics={'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6540816139890933, 'psi': 0.615636807189815}-{'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.6700287471646926, 'psi': 0.6136702686915539}
[S16] START round=49 head_norm_before_train=2.051892 cos_to_last_merge=0.9992 (last merge round=45)
[S16] round=49 local utility u=0.015934 metrics={'f1_val': 0.08901743391982003, 'auprc': 0.08901743391982003, 'loss_val': 4.4947608741238865, 'psi': 0.08901743391982003}-{'f1_val': 0.08903889424622308, 'auprc': 0.08903889424622308, 'loss_val': 4.526822572052844, 'psi': 0.08903889424622308}
[S17] START round=49 head_norm_before_train=2.243118 cos_to_last_merge=1.0000 (last merge round=47)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.5696961826820456, 'auprc': 0.5696961826820456, 'loss_val': 1.4896368122276467, 'psi': 0.5696961826820456}-{'f1_val': 0.7914800629597284, 'auprc': 0.7914800629597284, 'loss_val': 0.8284030360732441, 'psi': 0.7914800629597284}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9850
[S16] not sending this round → trigger blocked (psi=0.089)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:49317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:49302
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=49 metric=0.2903 head_norm=1.938483
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.807300e-01
[S11] stored merged vector for next round verification (round=49)
[S11] DEBUG after merge:  round=49 metric=0.2884 head_norm=1.985259 delta_norm=0.180730
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.9597
[S2] RECEIVED delta(kind=head bytes=1802) from S15
[S2] cosine check vs S15: cos=0.9817
[runner] rounds complete.
[runner] all agents stopped.
