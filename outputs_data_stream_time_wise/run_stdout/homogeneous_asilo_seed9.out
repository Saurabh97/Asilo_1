[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:39003
[S3] → join 127.0.0.1:39002
[S4] → join 127.0.0.1:39002
[S5] → join 127.0.0.1:39002
[S6] → join 127.0.0.1:39002
[S7] → join 127.0.0.1:39002
[S8] → join 127.0.0.1:39002
[S9] → join 127.0.0.1:39002
[S10] → join 127.0.0.1:39002
[S11] → join 127.0.0.1:39002
[S13] → join 127.0.0.1:39002
[S14] → join 127.0.0.1:39002
[S15] → join 127.0.0.1:39002
[S16] → join 127.0.0.1:39002
[S17] → join 127.0.0.1:39002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.179462 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.173110 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.175292 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.153635 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.143086 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.170244 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.180274 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.133033 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.177285 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.167056 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.143264 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.192266 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.144146 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.126524 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.165286 (no previous merge yet)
[S13]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3] + discovered S9
[S3] + discovered S5
[S3] + discovered S4
[S3] + discovered S14
[S3] + discovered S15
[S3] + discovered S17
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S7
[S3] + discovered S8
[S3] + discovered S11
[S3] + discovered S10
[S3] + discovered S13
[S3] + discovered S16
[S3] + discovered S6
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S7
[S4] + discovered S8
[S4] + discovered S10
[S4] + discovered S6
[S4] + discovered S11
[S4] + discovered S13
[S4] + discovered S16
[S4] + discovered S9
[S4] + discovered S5
[S4] + discovered S17
[S4] + discovered S15
[S4] + discovered S14
[S6] + discovered S3
[S6] + discovered S2
[S5] + discovered S9
[S6] + discovered S5
[S5] + discovered S15
[S6] + discovered S4
[S5] + discovered S7
[S5] + discovered S8
[S5] + discovered S13
[S5] + discovered S6
[S5] + discovered S14
[S5] + discovered S17
[S5] + discovered S10
[S5] + discovered S16
[S5] + discovered S11
[S6] + discovered S15
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S4
[S7] + discovered S2
[S6] + discovered S9
[S6] + discovered S14
[S6] + discovered S17
[S6] + discovered S10
[S6] + discovered S16
[S6] + discovered S11
[S6] + discovered S7
[S6] + discovered S8
[S7] + discovered S6
[S6] + discovered S13
[S7] + discovered S11
[S7] + discovered S8
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S14
[S7] + discovered S17
[S7] + discovered S13
[S8] + discovered S5
[S8] + discovered S4
[S8] + discovered S2
[S8] + discovered S7
[S8] + discovered S6
[S8] + discovered S3
[S7] + discovered S10
[S7] + discovered S16
[S9] + discovered S4
[S9] + discovered S6
[S8] + discovered S16
[S8] + discovered S10
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S14
[S9] + discovered S3
[S9] + discovered S2
[S8] + discovered S15
[S8] + discovered S9
[S8] + discovered S13
[S9] + discovered S5
[S9] + discovered S7
[S9] + discovered S8
[S10] + discovered S9
[S10] + discovered S2
[S9] + discovered S10
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S17
[S10] + discovered S5
[S10] + discovered S8
[S9] + discovered S13
[S9] + discovered S14
[S10] + discovered S6
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S3
[S11] + discovered S10
[S11] + discovered S6
[S11] + discovered S2
[S10] + discovered S11
[S10] + discovered S16
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S13
[S11] + discovered S5
[S10] + discovered S14
[S11] + discovered S4
[S11] + discovered S7
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S8
[S11] + discovered S17
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S16
[S11] + discovered S15
[S13] + discovered S10
[S13] + discovered S6
[S13] + discovered S9
[S13] + discovered S8
[S13] + discovered S7
[S13] + discovered S5
[S13] + discovered S3
[S13] + discovered S11
[S13] + discovered S4
[S13] + discovered S2
[S14] + discovered S2
[S14] + discovered S10
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S4
[S14] + discovered S3
[S14] + discovered S5
[S14] + discovered S7
[S13] + discovered S17
[S14] + discovered S13
[S14] + discovered S8
[S13] + discovered S16
[S13] + discovered S14
[S14] + discovered S9
[S13] + discovered S15
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S15] + discovered S7
[S15] + discovered S5
[S15] + discovered S3
[S15] + discovered S10
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S9
[S15] + discovered S2
[S15] + discovered S4
[S15] + discovered S8
[S15] + discovered S13
[S15] + discovered S11
[S16] + discovered S13
[S15] + discovered S17
[S16] + discovered S3
[S16] + discovered S8
[S16] + discovered S15
[S16] + discovered S4
[S15] + discovered S16
[S16] + discovered S7
[S16] + discovered S5
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S6
[S16] + discovered S11
[S17] + discovered S4
[S17] + discovered S6
[S17] + discovered S7
[S17] + discovered S9
[S17] + discovered S16
[S17] + discovered S10
[S17] + discovered S13
[S17] + discovered S14
[S17] + discovered S15
[S17] + discovered S5
[S17] + discovered S2
[S17] + discovered S3
[S17] + discovered S8
[S17] + discovered S11
[S16] + discovered S17
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S14] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S3] ⇄ pheromone p=1.000 → S8@127.0.0.1:39009
[S7] ⇄ pheromone p=1.000 → S2@127.0.0.1:39002
[S9] ⇄ pheromone p=1.000 → S15@127.0.0.1:39015
[S4] ⇄ pheromone p=1.000 → S10@127.0.0.1:39011
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:39014
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:39008
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:39010
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:39005
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:39005
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:39004
[S15] ⇄ pheromone p=1.000 → S6@127.0.0.1:39007
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:39016
[S2] START round=1 head_norm_before_train=1.179961 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4894952240567532, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3948239419385935, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.176453 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6086481887837096, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5105500613539955, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.179424 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5883262936121403, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5481307150475003, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.159508 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.508751238780827, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4842989018085841, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.149734 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5792196658076554, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4900270435504985, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.170273 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.09549845088390742, 'auprc': 0.09549845088390742, 'loss_val': 1.3709105785846862, 'psi': 0.09549845088390742}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.333212974043623, 'psi': 0.35976373724718097}
[S8] START round=1 head_norm_before_train=1.176847 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5004617798724054, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.451232754701604, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.142056 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5954741016388416, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4670833006036152, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.189004 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5025502902030972, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.429624745399755, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.171467 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5056596007731724, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4295738989275886, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.149564 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.502159145502888, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4539583135720746, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.190333 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.565051013211381, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4737302692669658, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.143545 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.472225924037909, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.416277626456206, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.129179 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5171080663901748, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.455480697888336, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.175389 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.461074889126119, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4201840389037266, 'psi': 0.0}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.196596 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.673563166595276, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4894952240567532, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.195407 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8351091538125393, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6086481887837096, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.192987 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.643467269652208, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5883262936121403, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.177026 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.549729077931544, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.508751238780827, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.169605 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7481815092182662, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5792196658076554, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.181490 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4441107961620434, 'psi': 0.0}-{'f1_val': 0.09549845088390742, 'auprc': 0.09549845088390742, 'loss_val': 1.3709105785846862, 'psi': 0.09549845088390742}
[S8] START round=2 head_norm_before_train=1.185144 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5949176014491733, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5004617798724054, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.163963 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8859466629820207, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5954741016388416, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.211427 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.61630243276456, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5025502902030972, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.186759 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6747204293651403, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5056596007731724, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.164032 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5759615151113833, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.502159145502888, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.201062 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7385044310558, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.565051013211381, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.156067 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5998376748923857, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.472225924037909, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.143984 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6152080916618634, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5171080663901748, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.196766 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.541863583560989, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.461074889126119, 'psi': 0.0}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.224790 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1864869158091422, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.673563166595276, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.231625 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4258429577329763, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8351091538125393, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.217476 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7421848442245984, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.643467269652208, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.203402 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6364229421668173, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.549729077931544, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.199992 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.164421349022172, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7481815092182662, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.203430 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6222415207429741, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4441107961620434, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.201889 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7580903711589115, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5949176014491733, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.195987 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4204477851097304, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8859466629820207, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.241841 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8661419365169019, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.61630243276456, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.213016 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.135199354270382, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6747204293651403, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.187182 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7287333849781703, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5759615151113833, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.223932 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1459146038171353, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7385044310558, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.180533 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.936544335999988, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5998376748923857, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.172456 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8505047759314823, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6152080916618634, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.228185 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.72558648995512, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.541863583560989, 'psi': 0.0}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.263493 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.061405071284025, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1864869158091422, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.274065 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8150254070634158, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4258429577329763, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.251466 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8649414350627265, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7421848442245984, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.236854 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7616344017669066, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6364229421668173, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.239120 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.998378458748258, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.164421349022172, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.234867 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9377357264402815, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6222415207429741, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.221103 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8787491908782805, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7580903711589115, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.230302 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7006500267150693, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4204477851097304, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.277376 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.16540484806511, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8661419365169019, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.247362 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6629461962199117, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.135199354270382, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.215643 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8805736692628745, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7287333849781703, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.256826 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.73381902887786, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1459146038171353, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.211635 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2000745427493964, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.936544335999988, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.215097 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.392939220383991, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8505047759314823, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.265654 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8507554670339414, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.72558648995512, 'psi': 0.0}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.303498 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3019290004318966, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.061405071284025, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.299018 (no previous merge yet)
[S3] round=5 local utility u=0.148059 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5189077006320835, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8150254070634158, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.286741 (no previous merge yet)
[S4] round=5 local utility u=0.087194 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6905531056133813, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8649414350627265, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.269062 (no previous merge yet)
[S5] round=5 local utility u=0.075949 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6097368393041378, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7616344017669066, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.282372 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3228165562949226, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.998378458748258, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.261809 (no previous merge yet)
[S7] round=5 local utility u=0.039515 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8587055479928833, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9377357264402815, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.239079 (no previous merge yet)
[S8] round=5 local utility u=0.074672 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7294050619470878, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8787491908782805, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.255901 (no previous merge yet)
[S9] round=5 local utility u=0.036652 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.627346233320818, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7006500267150693, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.303402 (no previous merge yet)
[S10] round=5 local utility u=0.064472 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0364615775877715, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.16540484806511, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.275987 (no previous merge yet)
[S11] round=5 local utility u=0.077725 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.507496184968858, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6629461962199117, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.234745 (no previous merge yet)
[S13] round=5 local utility u=0.044825 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7909236546304623, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8805736692628745, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.289672 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1155319176465106, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.73381902887786, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.231473 (no previous merge yet)
[S15] round=5 local utility u=0.139030 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9220152822515109, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2000745427493964, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.266496 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9713716420293173, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.392939220383991, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.295663 (no previous merge yet)
[S17] round=5 local utility u=0.090832 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6690917812766697, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8507554670339414, 'psi': 0.0}
[S13] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S6] ⇄ pheromone p=0.328 → S17@127.0.0.1:39017
[S16] ⇄ pheromone p=0.328 → S7@127.0.0.1:39008
[S11] ⇄ pheromone p=0.343 → S5@127.0.0.1:39005
[S13] ⇄ pheromone p=0.337 → S4@127.0.0.1:39004
[S4] ⇄ pheromone p=0.345 → S10@127.0.0.1:39011
[S15] ⇄ pheromone p=0.355 → S6@127.0.0.1:39007
[S3] ⇄ pheromone p=0.357 → S8@127.0.0.1:39009
[S5] ⇄ pheromone p=0.343 → S17@127.0.0.1:39017
[S10] ⇄ pheromone p=0.341 → S14@127.0.0.1:39014
[S9] ⇄ pheromone p=0.335 → S15@127.0.0.1:39015
[S2] ⇄ pheromone p=0.328 → S9@127.0.0.1:39010
[S7] ⇄ pheromone p=0.336 → S2@127.0.0.1:39002
[S14] ⇄ pheromone p=0.328 → S17@127.0.0.1:39017
[S8] ⇄ pheromone p=0.343 → S5@127.0.0.1:39005
[S17] ⇄ pheromone p=0.346 → S16@127.0.0.1:39016
[S2] START round=6 head_norm_before_train=1.328316 (no previous merge yet)
[S2] round=6 local utility u=0.000004 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3019204576577925, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3019290004318966, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.313300 (no previous merge yet)
[S3] round=6 local utility u=0.131182 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2565444286669525, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5189077006320835, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.298079 (no previous merge yet)
[S4] round=6 local utility u=0.055778 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5789965878615089, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6905531056133813, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.272251 (no previous merge yet)
[S5] round=6 local utility u=0.041089 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5275590502280059, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6097368393041378, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.317932 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.567738810545081, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3228165562949226, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.267431 (no previous merge yet)
[S7] round=6 local utility u=0.038527 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7816517277443766, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8587055479928833, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.245742 (no previous merge yet)
[S8] round=6 local utility u=0.075149 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5791064753036719, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7294050619470878, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.277550 (no previous merge yet)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6526419959346916, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.627346233320818, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.313905 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.163677587721267, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0364615775877715, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.293728 (no previous merge yet)
[S11] round=6 local utility u=0.156046 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1954046749667224, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.507496184968858, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.241952 (no previous merge yet)
[S13] round=6 local utility u=0.057931 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6750624990490373, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7909236546304623, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.318013 (no previous merge yet)
[S14] round=6 local utility u=0.014427 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.086678435379864, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1155319176465106, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.233279 (no previous merge yet)
[S15] round=6 local utility u=0.077838 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7663398165854762, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9220152822515109, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.315309 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.255589100869129, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9713716420293173, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.317725 (no previous merge yet)
[S17] round=6 local utility u=0.054480 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5601309729240984, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6690917812766697, 'psi': 0.0}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=7 head_norm_before_train=1.349614 (no previous merge yet)
[S2] round=7 local utility u=0.090754 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.120411790817408, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3019204576577925, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.330609 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4354964470417357, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2565444286669525, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.316508 (no previous merge yet)
[S4] round=7 local utility u=0.028820 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5213573713307595, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5789965878615089, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.280662 (no previous merge yet)
[S5] round=7 local utility u=0.018664 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.490231633064671, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5275590502280059, 'psi': 0.0}
[S6] START round=7 head_norm_before_train=1.344471 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8775711999984193, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.567738810545081, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.276558 (no previous merge yet)
[S7] round=7 local utility u=0.318467 metrics={'f1_val': 0.07185792349726776, 'auprc': 0.07185792349726776, 'loss_val': 1.7914381818754863, 'psi': 0.07185792349726776}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7816517277443766, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.251994 (no previous merge yet)
[S8] round=7 local utility u=0.015231 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.54864465497732, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5791064753036719, 'psi': 0.0}
[S9] START round=7 head_norm_before_train=1.302840 (no previous merge yet)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.982080651997229, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6526419959346916, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.334059 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9323903095099477, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.163677587721267, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.311464 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.382396038146886, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1954046749667224, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.250558 (no previous merge yet)
[S13] round=7 local utility u=0.016557 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6419487662610945, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6750624990490373, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.343141 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.293879747867378, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.086678435379864, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.240001 (no previous merge yet)
[S15] round=7 local utility u=0.008749 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7488410978065274, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7663398165854762, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.357065 (no previous merge yet)
[S16] round=7 local utility u=0.112647 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.030294814353702, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.255589100869129, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.346267 (no previous merge yet)
[S17] round=7 local utility u=0.036091 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4879485211864423, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5601309729240984, 'psi': 0.0}
[S5] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.072)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=8 head_norm_before_train=1.369524 (no previous merge yet)
[S2] round=8 local utility u=0.082735 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.954942676575859, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.120411790817408, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.357036 (no previous merge yet)
[S3] round=8 local utility u=0.130679 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1741378966090017, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4354964470417357, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.349495 (no previous merge yet)
[S4] round=8 local utility u=0.023622 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4741129666700077, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5213573713307595, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.302756 (no previous merge yet)
[S5] round=8 local utility u=0.038129 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4139730218443596, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.490231633064671, 'psi': 0.0}
[S6] START round=8 head_norm_before_train=1.371098 (no previous merge yet)
[S6] round=8 local utility u=0.461730 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.954110256523095, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8775711999984193, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.293254 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6533824100926142, 'psi': 0.0}-{'f1_val': 0.07185792349726776, 'auprc': 0.07185792349726776, 'loss_val': 1.7914381818754863, 'psi': 0.07185792349726776}
[S8] START round=8 head_norm_before_train=1.274992 (no previous merge yet)
[S8] round=8 local utility u=1.000000 metrics={'f1_val': 0.33186212694409417, 'auprc': 0.33186212694409417, 'loss_val': 1.4947642465481827, 'psi': 0.33186212694409417}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.54864465497732, 'psi': 0.0}
[S9] START round=8 head_norm_before_train=1.335413 (no previous merge yet)
[S9] round=8 local utility u=0.259010 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4640609089278, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.982080651997229, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.366892 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1454685254081025, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9323903095099477, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.337826 (no previous merge yet)
[S11] round=8 local utility u=0.062924 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.256547245061594, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.382396038146886, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.269176 (no previous merge yet)
[S13] round=8 local utility u=0.032953 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5760432546474996, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6419487662610945, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.370998 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.68934280582485, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.293879747867378, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.257510 (no previous merge yet)
[S15] round=8 local utility u=0.055473 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6378943294122272, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7488410978065274, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.390198 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1975936490621044, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.030294814353702, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.381596 (no previous merge yet)
[S17] round=8 local utility u=0.044712 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.398524800521384, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4879485211864423, 'psi': 0.0}
[S5] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:39005
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S8] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S8
[S5] cosine check vs S8: cos=0.0002
[S17] not sending this round → trigger blocked (psi=0.000)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.0000 head_norm=1.323473
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.291922e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.0042 head_norm=0.929338 delta_norm=0.929192
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.393583 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2646847504545096, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.954942676575859, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.385189 (no previous merge yet)
[S3] round=9 local utility u=0.087963 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9982114417471197, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1741378966090017, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.383371 (no previous merge yet)
[S4] round=9 local utility u=0.008021 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4580704402821658, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4741129666700077, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=0.929338 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=1.000000 metrics={'f1_val': 0.24326224513709868, 'auprc': 0.24326224513709868, 'loss_val': 1.4132608991383713, 'psi': 0.2432622451370987}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4139730218443596, 'psi': 0.0}
[S6] START round=9 head_norm_before_train=1.390590 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.261035612918616, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.954110256523095, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.307840 (no previous merge yet)
[S7] round=9 local utility u=0.043335 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5667117690297696, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6533824100926142, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.304820 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.2256520185780636, 'auprc': 0.2256520185780636, 'loss_val': 1.372198353031555, 'psi': 0.2256520185780636}-{'f1_val': 0.33186212694409417, 'auprc': 0.33186212694409417, 'loss_val': 1.4947642465481827, 'psi': 0.33186212694409417}
[S9] START round=9 head_norm_before_train=1.366744 (no previous merge yet)
[S9] round=9 local utility u=0.039541 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.384979679025734, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4640609089278, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.397168 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.32136585103366, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1454685254081025, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.366777 (no previous merge yet)
[S11] round=9 local utility u=0.213152 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8302441175941113, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.256547245061594, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.288322 (no previous merge yet)
[S13] round=9 local utility u=0.041992 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.492058462997975, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5760432546474996, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.407302 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.374599669722886, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.68934280582485, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.276643 (no previous merge yet)
[S15] round=9 local utility u=0.050396 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5371027632085346, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6378943294122272, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.418593 (no previous merge yet)
[S16] round=9 local utility u=0.059882 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.077829376160972, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1975936490621044, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.411715 (no previous merge yet)
[S17] round=9 local utility u=0.014239 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3700476611943815, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.398524800521384, 'psi': 0.0}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S5
[S17] cosine check vs S5: cos=-0.0220
[S17] DROPPED delta from S5 (cos=-0.0220 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=10 head_norm_before_train=1.421932 (no previous merge yet)
[S2] round=10 local utility u=0.255771 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.753142218084959, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2646847504545096, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.417511 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0577599369774497, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9982114417471197, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.418091 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4648440385313928, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4580704402821658, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=0.954476 cos_to_last_merge=0.9982 (last merge round=8)
[S5] round=10 local utility u=0.300719 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.3686077880953653, 'psi': 0.3051272166538165}-{'f1_val': 0.24326224513709868, 'auprc': 0.24326224513709868, 'loss_val': 1.4132608991383713, 'psi': 0.2432622451370987}
[S6] START round=10 head_norm_before_train=1.410872 (no previous merge yet)
[S6] round=10 local utility u=0.049727 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1615820473891976, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.261035612918616, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.325590 (no previous merge yet)
[S7] round=10 local utility u=0.042516 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4816787766101909, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5667117690297696, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.334063 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.21223118279569894, 'auprc': 0.21223118279569894, 'loss_val': 1.3141220272257366, 'psi': 0.21223118279569894}-{'f1_val': 0.2256520185780636, 'auprc': 0.2256520185780636, 'loss_val': 1.372198353031555, 'psi': 0.2256520185780636}
[S9] START round=10 head_norm_before_train=1.400074 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4357280736892895, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.384979679025734, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.427822 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6122566820164814, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.32136585103366, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.399152 (no previous merge yet)
[S11] round=10 local utility u=0.432009 metrics={'f1_val': 0.08265139116202946, 'auprc': 0.08265139116202946, 'loss_val': 1.7100881723567525, 'psi': 0.08265139116202946}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8302441175941113, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.308133 (no previous merge yet)
[S13] round=10 local utility u=0.074083 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3438929640044943, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.492058462997975, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.447333 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.931923600614177, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.374599669722886, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.301847 (no previous merge yet)
[S15] round=10 local utility u=0.059336 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.418431372420496, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5371027632085346, 'psi': 0.0}
[S16] START round=10 head_norm_before_train=1.444430 (no previous merge yet)
[S16] round=10 local utility u=0.061351 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.955127924114806, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.077829376160972, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.439875 (no previous merge yet)
[S17] round=10 local utility u=0.011194 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3476596412180266, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3700476611943815, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.083)
[S15] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S5
[S17] cosine check vs S5: cos=-0.0150
[S17] DROPPED delta from S5 (cos=-0.0150 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S15] ⇄ pheromone p=0.151 → S6@127.0.0.1:39007
[S8] ⇄ pheromone p=0.248 → S5@127.0.0.1:39005
[S11] ⇄ pheromone p=0.254 → S5@127.0.0.1:39005
[S9] ⇄ pheromone p=0.149 → S15@127.0.0.1:39015
[S7] ⇄ pheromone p=0.161 → S2@127.0.0.1:39002
[S3] ⇄ pheromone p=0.159 → S8@127.0.0.1:39009
[S2] ⇄ pheromone p=0.178 → S9@127.0.0.1:39010
[S14] ⇄ pheromone p=0.109 → S17@127.0.0.1:39017
[S4] ⇄ pheromone p=0.125 → S10@127.0.0.1:39011
[S6] ⇄ pheromone p=0.176 → S17@127.0.0.1:39017
[S10] ⇄ pheromone p=0.112 → S14@127.0.0.1:39014
[S13] ⇄ pheromone p=0.143 → S4@127.0.0.1:39004
[S5] ⇄ pheromone p=0.343 → S17@127.0.0.1:39017
[S17] ⇄ pheromone p=0.132 → S16@127.0.0.1:39016
[S16] ⇄ pheromone p=0.141 → S7@127.0.0.1:39008
[S2] START round=11 head_norm_before_train=1.447372 (no previous merge yet)
[S2] round=11 local utility u=0.350695 metrics={'f1_val': 0.08543128353281057, 'auprc': 0.08543128353281057, 'loss_val': 2.820634641225451, 'psi': 0.08543128353281057}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.753142218084959, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.452909 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1626644505621084, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0577599369774497, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.453923 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4905243742991385, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4648440385313928, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=0.987615 cos_to_last_merge=0.9923 (last merge round=8)
[S5] round=11 local utility u=1.000000 metrics={'f1_val': 0.911965750930523, 'auprc': 0.911965750930523, 'loss_val': 1.3256976411970858, 'psi': 0.911965750930523}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.3686077880953653, 'psi': 0.3051272166538165}
[S6] START round=11 head_norm_before_train=1.438816 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.879318824074332, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1615820473891976, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.344050 (no previous merge yet)
[S7] round=11 local utility u=0.029564 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.422550369892556, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4816787766101909, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.370964 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.20372879169085867, 'auprc': 0.20372879169085867, 'loss_val': 1.25723662084389, 'psi': 0.20372879169085867}-{'f1_val': 0.21223118279569894, 'auprc': 0.21223118279569894, 'loss_val': 1.3141220272257366, 'psi': 0.21223118279569894}
[S9] START round=11 head_norm_before_train=1.433071 (no previous merge yet)
[S9] round=11 local utility u=0.493071 metrics={'f1_val': 0.09961685823754789, 'auprc': 0.09961685823754789, 'loss_val': 2.346137452588121, 'psi': 0.09961685823754789}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4357280736892895, 'psi': 0.0}
[S10] START round=11 head_norm_before_train=1.460060 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8105915854404246, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6122566820164814, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.437036 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.876533813157347, 'psi': 0.0}-{'f1_val': 0.08265139116202946, 'auprc': 0.08265139116202946, 'loss_val': 1.7100881723567525, 'psi': 0.08265139116202946}
[S13] START round=11 head_norm_before_train=1.333214 (no previous merge yet)
[S13] round=11 local utility u=1.000000 metrics={'f1_val': 0.23135366506153024, 'auprc': 0.23135366506153024, 'loss_val': 1.2765378824680336, 'psi': 0.23135366506153024}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3438929640044943, 'psi': 0.0}
[S14] START round=11 head_norm_before_train=1.480869 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.181305375625521, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.931923600614177, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.332249 (no previous merge yet)
[S15] round=11 local utility u=1.000000 metrics={'f1_val': 0.21600287047003947, 'auprc': 0.21600287047003947, 'loss_val': 1.2680825687988555, 'psi': 0.21600287047003947}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.418431372420496, 'psi': 0.0}
[S16] START round=11 head_norm_before_train=1.466250 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.00021240441801189465, 'auprc': 0.00021240441801189465, 'loss_val': 3.043280051430277, 'psi': 0.00021240441801189465}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.955127924114806, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.458653 (no previous merge yet)
[S17] round=11 local utility u=0.002381 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3428980147829896, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3476596412180266, 'psi': 0.0}
[S9] not sending this round → trigger blocked (psi=0.100)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.085)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:39017
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39007
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] cosine check vs S15: cos=-0.0715
[S6] DROPPED delta from S15 (cos=-0.0715 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] cosine check vs S13: cos=0.0407
[S17] RECEIVED delta(kind=head bytes=1802) from S5
[S17] cosine check vs S5: cos=-0.0090
[S17] DROPPED delta from S5 (cos=-0.0090 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.0000 head_norm=1.488887
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.886972e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.029617 delta_norm=0.988697
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.472229 (no previous merge yet)
[S2] round=12 local utility u=0.624421 metrics={'f1_val': 0.1952662721893491, 'auprc': 0.1952662721893491, 'loss_val': 2.560306826396588, 'psi': 0.1952662721893491}-{'f1_val': 0.08543128353281057, 'auprc': 0.08543128353281057, 'loss_val': 2.820634641225451, 'psi': 0.08543128353281057}
[S3] START round=12 head_norm_before_train=1.489204 (no previous merge yet)
[S3] round=12 local utility u=0.536113 metrics={'f1_val': 0.13370399788191686, 'auprc': 0.13370399788191686, 'loss_val': 2.2937738757120503, 'psi': 0.13370399788191686}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1626644505621084, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.029617 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.029685 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4311544898329331, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4905243742991385, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.016718 cos_to_last_merge=0.9851 (last merge round=8)
[S5] round=12 local utility u=0.413470 metrics={'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 1.2910653384147412, 'psi': 1.0}-{'f1_val': 0.911965750930523, 'auprc': 0.911965750930523, 'loss_val': 1.3256976411970858, 'psi': 0.911965750930523}
[S6] START round=12 head_norm_before_train=1.471096 (no previous merge yet)
[S6] round=12 local utility u=0.123802 metrics={'f1_val': 0.013280521901211557, 'auprc': 0.013280521901211557, 'loss_val': 3.751240488980207, 'psi': 0.013280521901211557}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.879318824074332, 'psi': 0.0}
[S7] START round=12 head_norm_before_train=1.361632 (no previous merge yet)
[S7] round=12 local utility u=0.008718 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.405113554998883, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.422550369892556, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.407949 (no previous merge yet)
[S8] round=12 local utility u=0.012609 metrics={'f1_val': 0.2036893704850361, 'auprc': 0.2036893704850361, 'loss_val': 1.2316633808581527, 'psi': 0.2036893704850361}-{'f1_val': 0.20372879169085867, 'auprc': 0.20372879169085867, 'loss_val': 1.25723662084389, 'psi': 0.20372879169085867}
[S9] START round=12 head_norm_before_train=1.463583 (no previous merge yet)
[S9] round=12 local utility u=0.554393 metrics={'f1_val': 0.19367531331973187, 'auprc': 0.19367531331973187, 'loss_val': 2.0838770080173794, 'psi': 0.19367531331973187}-{'f1_val': 0.09961685823754789, 'auprc': 0.09961685823754789, 'loss_val': 2.346137452588121, 'psi': 0.09961685823754789}
[S10] START round=12 head_norm_before_train=1.489540 (no previous merge yet)
[S10] round=12 local utility u=0.782307 metrics={'f1_val': 0.1611597019760285, 'auprc': 0.1611597019760285, 'loss_val': 3.696414328078407, 'psi': 0.1611597019760285}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8105915854404246, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.476541 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.12135110884203, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.876533813157347, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.363262 (no previous merge yet)
[S13] round=12 local utility u=0.357132 metrics={'f1_val': 0.30419673883988235, 'auprc': 0.30419673883988235, 'loss_val': 1.2178624211020905, 'psi': 0.30419673883988235}-{'f1_val': 0.23135366506153024, 'auprc': 0.23135366506153024, 'loss_val': 1.2765378824680336, 'psi': 0.23135366506153024}
[S14] START round=12 head_norm_before_train=1.508843 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.34740505780233, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.181305375625521, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.365025 (no previous merge yet)
[S15] round=12 local utility u=0.472390 metrics={'f1_val': 0.3124090858229831, 'auprc': 0.3124090858229831, 'loss_val': 1.1909583917466473, 'psi': 0.3124090858229831}-{'f1_val': 0.21600287047003947, 'auprc': 0.21600287047003947, 'loss_val': 1.2680825687988555, 'psi': 0.21600287047003947}
[S16] START round=12 head_norm_before_train=1.490651 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.00015723270440251572, 'auprc': 0.00015723270440251572, 'loss_val': 3.2811644529844854, 'psi': 0.00015723270440251572}-{'f1_val': 0.00021240441801189465, 'auprc': 0.00021240441801189465, 'loss_val': 3.043280051430277, 'psi': 0.00021240441801189465}
[S17] START round=12 head_norm_before_train=1.476532 (no previous merge yet)
[S17] round=12 local utility u=0.002465 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3379683120063146, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3428980147829896, 'psi': 0.0}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.134)
[S10] not sending this round → trigger blocked (psi=0.161)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39007
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.195)
[S6] not sending this round → trigger blocked (psi=0.013)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39005
[S9] not sending this round → trigger blocked (psi=0.194)
[S7] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] cosine check vs S8: cos=0.6099
[S6] RECEIVED delta(kind=head bytes=1796) from S15
[S6] cosine check vs S15: cos=-0.0760
[S6] DROPPED delta from S15 (cos=-0.0760 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S13
[S4] cosine check vs S13: cos=0.6662
[S17] RECEIVED delta(kind=head bytes=1800) from S5
[S17] cosine check vs S5: cos=-0.0026
[S17] DROPPED delta from S5 (cos=-0.0026 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.0000 head_norm=1.068882
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.236287e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.124644 delta_norm=0.523629
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=1.0000 head_norm=1.053547
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.791692e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.2018 head_norm=1.124385 delta_norm=0.579169
[S5] aggregate: ROLLBACK (f1_val pre=1.000 post=0.202 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.498255 (no previous merge yet)
[S2] round=13 local utility u=0.314490 metrics={'f1_val': 0.2500171715090322, 'auprc': 0.2500171715090322, 'loss_val': 2.424084761131045, 'psi': 0.2500171715090322}-{'f1_val': 0.1952662721893491, 'auprc': 0.1952662721893491, 'loss_val': 2.560306826396588, 'psi': 0.1952662721893491}
[S3] START round=13 head_norm_before_train=1.525022 (no previous merge yet)
[S3] round=13 local utility u=0.943911 metrics={'f1_val': 0.293719806763285, 'auprc': 0.293719806763285, 'loss_val': 1.846094057540563, 'psi': 0.293719806763285}-{'f1_val': 0.13370399788191686, 'auprc': 0.13370399788191686, 'loss_val': 2.2937738757120503, 'psi': 0.13370399788191686}
[S4] START round=13 head_norm_before_train=1.124644 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.021620 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3879147345396605, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4311544898329331, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.124385 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.3062330323811905, 'auprc': 0.3062330323811905, 'loss_val': 1.3408344527748748, 'psi': 0.3062330323811905}-{'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 1.2910653384147412, 'psi': 1.0}
[S6] START round=13 head_norm_before_train=1.498206 (no previous merge yet)
[S6] round=13 local utility u=0.239655 metrics={'f1_val': 0.04881209503239741, 'auprc': 0.04881209503239741, 'loss_val': 3.5917142882358832, 'psi': 0.04881209503239741}-{'f1_val': 0.013280521901211557, 'auprc': 0.013280521901211557, 'loss_val': 3.751240488980207, 'psi': 0.013280521901211557}
[S7] START round=13 head_norm_before_train=1.379813 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4215378581416056, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.405113554998883, 'psi': 0.0}
[S8] START round=13 head_norm_before_train=1.445475 (no previous merge yet)
[S8] round=13 local utility u=0.468197 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.2076222528983944, 'psi': 0.30506182380216385}-{'f1_val': 0.2036893704850361, 'auprc': 0.2036893704850361, 'loss_val': 1.2316633808581527, 'psi': 0.2036893704850361}
[S9] START round=13 head_norm_before_train=1.493038 (no previous merge yet)
[S9] round=13 local utility u=0.826787 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0052701659315377, 'psi': 0.36867172340800847}-{'f1_val': 0.19367531331973187, 'auprc': 0.19367531331973187, 'loss_val': 2.0838770080173794, 'psi': 0.19367531331973187}
[S10] START round=13 head_norm_before_train=1.516480 (no previous merge yet)
[S10] round=13 local utility u=0.254834 metrics={'f1_val': 0.20114285714285715, 'auprc': 0.20114285714285715, 'loss_val': 3.5465939376892077, 'psi': 0.20114285714285715}-{'f1_val': 0.1611597019760285, 'auprc': 0.1611597019760285, 'loss_val': 3.696414328078407, 'psi': 0.1611597019760285}
[S11] START round=13 head_norm_before_train=1.514107 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.305004387257035, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.12135110884203, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.391228 (no previous merge yet)
[S13] round=13 local utility u=0.100691 metrics={'f1_val': 0.33185185185185184, 'auprc': 0.33185185185185184, 'loss_val': 1.265377263294972, 'psi': 0.33185185185185184}-{'f1_val': 0.30419673883988235, 'auprc': 0.30419673883988235, 'loss_val': 1.2178624211020905, 'psi': 0.30419673883988235}
[S14] START round=13 head_norm_before_train=1.534342 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.0024968789013732834, 'auprc': 0.0024968789013732834, 'loss_val': 5.553209247864786, 'psi': 0.0024968789013732834}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.34740505780233, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.401402 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.2911032028469751, 'auprc': 0.2911032028469751, 'loss_val': 1.1378521778465482, 'psi': 0.2911032028469751}-{'f1_val': 0.3124090858229831, 'auprc': 0.3124090858229831, 'loss_val': 1.1909583917466473, 'psi': 0.3124090858229831}
[S16] START round=13 head_norm_before_train=1.518069 (no previous merge yet)
[S16] round=13 local utility u=0.502823 metrics={'f1_val': 0.09265964450296248, 'auprc': 0.09265964450296248, 'loss_val': 3.108039638498445, 'psi': 0.09265964450296248}-{'f1_val': 0.00015723270440251572, 'auprc': 0.00015723270440251572, 'loss_val': 3.2811644529844854, 'psi': 0.00015723270440251572}
[S17] START round=13 head_norm_before_train=1.495465 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3723882816131072, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3379683120063146, 'psi': 0.0}
[S6] not sending this round → trigger blocked (psi=0.049)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:39004
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39014
[S16] not sending this round → trigger blocked (psi=0.093)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39010
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.0135
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] cosine check vs S3: cos=-0.0861
[S8] DROPPED delta from S3 (cos=-0.0861 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S2
[S9] cosine check vs S2: cos=-0.0457
[S9] DROPPED delta from S2 (cos=-0.0457 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S8
[S5] cosine check vs S8: cos=0.9078
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.0985
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] cosine check vs S13: cos=0.9071
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.0025 head_norm=1.559727
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.041597e+00
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.149817 delta_norm=1.041597
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.0000 head_norm=1.160996
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.041072e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.258051 delta_norm=0.304107
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.2911 head_norm=1.437662
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.040153e+00
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.2861 head_norm=1.054224 delta_norm=1.040153
[S15] aggregate: ROLLBACK (f1_val pre=0.291 post=0.286 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.3062 head_norm=1.150075
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.246318e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.2102 head_norm=1.284243 delta_norm=0.324632
[S5] aggregate: ROLLBACK (f1_val pre=0.306 post=0.210 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.526928 (no previous merge yet)
[S2] round=14 local utility u=0.101710 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.359806140827854, 'psi': 0.2654773703336637}-{'f1_val': 0.2500171715090322, 'auprc': 0.2500171715090322, 'loss_val': 2.424084761131045, 'psi': 0.2500171715090322}
[S3] START round=14 head_norm_before_train=1.554294 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.29684364167122784, 'auprc': 0.29684364167122784, 'loss_val': 2.3862723207158454, 'psi': 0.29684364167122784}-{'f1_val': 0.293719806763285, 'auprc': 0.293719806763285, 'loss_val': 1.846094057540563, 'psi': 0.293719806763285}
[S4] START round=14 head_norm_before_train=1.258051 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.009531 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3688519792911327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3879147345396605, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.284243 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.20315011250401802, 'auprc': 0.20315011250401802, 'loss_val': 1.3559338472416118, 'psi': 0.20315011250401802}-{'f1_val': 0.3062330323811905, 'auprc': 0.3062330323811905, 'loss_val': 1.3408344527748748, 'psi': 0.3062330323811905}
[S6] START round=14 head_norm_before_train=1.525263 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.007775683317624882, 'auprc': 0.007775683317624882, 'loss_val': 4.480090174675421, 'psi': 0.007775683317624882}-{'f1_val': 0.04881209503239741, 'auprc': 0.04881209503239741, 'loss_val': 3.5917142882358832, 'psi': 0.04881209503239741}
[S7] START round=14 head_norm_before_train=1.396102 (no previous merge yet)
[S7] round=14 local utility u=0.003806 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4139253609716624, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4215378581416056, 'psi': 0.0}
[S8] START round=14 head_norm_before_train=1.478735 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.20361057382333977, 'auprc': 0.20361057382333977, 'loss_val': 1.1447736027246647, 'psi': 0.20361057382333977}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.2076222528983944, 'psi': 0.30506182380216385}
[S9] START round=14 head_norm_before_train=1.523069 (no previous merge yet)
[S9] round=14 local utility u=0.030177 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9449159542024776, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0052701659315377, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.543133 (no previous merge yet)
[S10] round=14 local utility u=0.103303 metrics={'f1_val': 0.2130315500685871, 'auprc': 0.2130315500685871, 'loss_val': 3.4469862331011094, 'psi': 0.2130315500685871}-{'f1_val': 0.20114285714285715, 'auprc': 0.20114285714285715, 'loss_val': 3.5465939376892077, 'psi': 0.20114285714285715}
[S11] START round=14 head_norm_before_train=1.545144 (no previous merge yet)
[S11] round=14 local utility u=1.000000 metrics={'f1_val': 0.3322450248756219, 'auprc': 0.3322450248756219, 'loss_val': 2.033975648092484, 'psi': 0.3322450248756219}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.305004387257035, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.415075 (no previous merge yet)
[S13] round=14 local utility u=0.066045 metrics={'f1_val': 0.3332514131236176, 'auprc': 0.3332514131236176, 'loss_val': 1.145883772872241, 'psi': 0.3332514131236176}-{'f1_val': 0.33185185185185184, 'auprc': 0.33185185185185184, 'loss_val': 1.265377263294972, 'psi': 0.33185185185185184}
[S14] START round=14 head_norm_before_train=1.149817 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=1.000000 metrics={'f1_val': 0.00922509225092251, 'auprc': 0.00922509225092251, 'loss_val': 3.5636441560027254, 'psi': 0.00922509225092251}-{'f1_val': 0.0024968789013732834, 'auprc': 0.0024968789013732834, 'loss_val': 5.553209247864786, 'psi': 0.0024968789013732834}
[S15] START round=14 head_norm_before_train=1.054224 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.28540462427745666, 'auprc': 0.28540462427745666, 'loss_val': 1.1594029020775658, 'psi': 0.28540462427745666}-{'f1_val': 0.2911032028469751, 'auprc': 0.2911032028469751, 'loss_val': 1.1378521778465482, 'psi': 0.2911032028469751}
[S16] START round=14 head_norm_before_train=1.545718 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.08170890188434048, 'auprc': 0.08170890188434048, 'loss_val': 3.475911530881516, 'psi': 0.08170890188434048}-{'f1_val': 0.09265964450296248, 'auprc': 0.09265964450296248, 'loss_val': 3.108039638498445, 'psi': 0.09265964450296248}
[S17] START round=14 head_norm_before_train=1.516009 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.407289191566674, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3723882816131072, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.009)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39014
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:39004
[S4] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:39010
[S2] sending update (kind=head size=1807 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1807) from S2
[S9] cosine check vs S2: cos=-0.0507
[S9] DROPPED delta from S2 (cos=-0.0507 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.7219
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=-0.0097
[S5] DROPPED delta from S11 (cos=-0.0097 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S9
[S15] cosine check vs S9: cos=0.7040
[S4] RECEIVED delta(kind=head bytes=1797) from S13
[S4] cosine check vs S13: cos=0.9583
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.0092 head_norm=1.183829
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.434907e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.279216 delta_norm=0.543491
[S14] aggregate: ROLLBACK (f1_val pre=0.009 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.2854 head_norm=1.096311
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.516611e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.2839 head_norm=1.226122 delta_norm=0.551661
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.0000 head_norm=1.293545
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.107132e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.353254 delta_norm=0.210713
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.557483 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.2648401826484018, 'auprc': 0.2648401826484018, 'loss_val': 2.465227139013856, 'psi': 0.2648401826484018}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.359806140827854, 'psi': 0.2654773703336637}
[S3] START round=15 head_norm_before_train=1.580778 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.2901839436135465, 'auprc': 0.2901839436135465, 'loss_val': 2.437862332860278, 'psi': 0.2901839436135465}-{'f1_val': 0.29684364167122784, 'auprc': 0.29684364167122784, 'loss_val': 2.3862723207158454, 'psi': 0.29684364167122784}
[S4] START round=15 head_norm_before_train=1.353254 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.380005702650401, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3688519792911327, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.307623 cos_to_last_merge=0.9972 (last merge round=13)
[S5] round=15 local utility u=0.042332 metrics={'f1_val': 0.2067474924730396, 'auprc': 0.2067474924730396, 'loss_val': 1.3036462082250098, 'psi': 0.2067474924730396}-{'f1_val': 0.20315011250401802, 'auprc': 0.20315011250401802, 'loss_val': 1.3559338472416118, 'psi': 0.20315011250401802}
[S6] START round=15 head_norm_before_train=1.547591 (no previous merge yet)
[S6] round=15 local utility u=0.868387 metrics={'f1_val': 0.08650039588281869, 'auprc': 0.08650039588281869, 'loss_val': 3.4518377583814104, 'psi': 0.08650039588281869}-{'f1_val': 0.007775683317624882, 'auprc': 0.007775683317624882, 'loss_val': 4.480090174675421, 'psi': 0.007775683317624882}
[S7] START round=15 head_norm_before_train=1.408272 (no previous merge yet)
[S7] round=15 local utility u=0.905712 metrics={'f1_val': 0.19254060005505091, 'auprc': 0.19254060005505091, 'loss_val': 1.3353669128101555, 'psi': 0.19254060005505091}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4139253609716624, 'psi': 0.0}
[S8] START round=15 head_norm_before_train=1.507915 (no previous merge yet)
[S8] round=15 local utility u=0.500727 metrics={'f1_val': 0.3056160676472066, 'auprc': 0.3056160676472066, 'loss_val': 1.0613680793759102, 'psi': 0.3056160676472066}-{'f1_val': 0.20361057382333977, 'auprc': 0.20361057382333977, 'loss_val': 1.1447736027246647, 'psi': 0.20361057382333977}
[S9] START round=15 head_norm_before_train=1.553550 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.19549763033175357, 'auprc': 0.19549763033175357, 'loss_val': 2.313027524892998, 'psi': 0.19549763033175357}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9449159542024776, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.569107 (no previous merge yet)
[S10] round=15 local utility u=0.161917 metrics={'f1_val': 0.229366106080207, 'auprc': 0.229366106080207, 'loss_val': 3.2701627527441977, 'psi': 0.229366106080207}-{'f1_val': 0.2130315500685871, 'auprc': 0.2130315500685871, 'loss_val': 3.4469862331011094, 'psi': 0.2130315500685871}
[S11] START round=15 head_norm_before_train=1.570442 (no previous merge yet)
[S11] round=15 local utility u=0.059450 metrics={'f1_val': 0.32387438516836925, 'auprc': 0.32387438516836925, 'loss_val': 1.8397396821682594, 'psi': 0.32387438516836925}-{'f1_val': 0.3322450248756219, 'auprc': 0.3322450248756219, 'loss_val': 2.033975648092484, 'psi': 0.3322450248756219}
[S13] START round=15 head_norm_before_train=1.441574 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.2012339090924053, 'psi': 0.3330058939096267}-{'f1_val': 0.3332514131236176, 'auprc': 0.3332514131236176, 'loss_val': 1.145883772872241, 'psi': 0.3332514131236176}
[S14] START round=15 head_norm_before_train=1.279216 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.100772 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.279074520894365, 'psi': 0.0}-{'f1_val': 0.00922509225092251, 'auprc': 0.00922509225092251, 'loss_val': 3.5636441560027254, 'psi': 0.00922509225092251}
[S15] START round=15 head_norm_before_train=1.226122 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.28388344819247974, 'auprc': 0.28388344819247974, 'loss_val': 1.1736813038434513, 'psi': 0.28388344819247974}-{'f1_val': 0.28540462427745666, 'auprc': 0.28540462427745666, 'loss_val': 1.1594029020775658, 'psi': 0.28540462427745666}
[S16] START round=15 head_norm_before_train=1.572615 (no previous merge yet)
[S16] round=15 local utility u=0.012317 metrics={'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 3.530089658094047, 'psi': 0.09046591544793414}-{'f1_val': 0.08170890188434048, 'auprc': 0.08170890188434048, 'loss_val': 3.475911530881516, 'psi': 0.08170890188434048}
[S17] START round=15 head_norm_before_train=1.532422 (no previous merge yet)
[S17] round=15 local utility u=0.007157 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3929754376149666, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.407289191566674, 'psi': 0.0}
[S16] not sending this round → trigger blocked (psi=0.090)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:39005
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39014
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.087)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39005
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.193)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S8
[S5] cosine check vs S8: cos=0.9480
[S5] RECEIVED delta(kind=head bytes=1805) from S11
[S5] cosine check vs S11: cos=-0.0136
[S5] DROPPED delta from S11 (cos=-0.0136 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9286
[S17] RECEIVED delta(kind=head bytes=1800) from S5
[S17] cosine check vs S5: cos=-0.0487
[S17] DROPPED delta from S5 (cos=-0.0487 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S13] ⇄ pheromone p=0.189 → S4@127.0.0.1:39004
[S4] ⇄ pheromone p=0.048 → S10@127.0.0.1:39011
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.0000 head_norm=1.315581
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.077257e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.429990 delta_norm=0.307726
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.216 → S17@127.0.0.1:39017
[S6] ⇄ pheromone p=0.275 → S17@127.0.0.1:39017
[S3] ⇄ pheromone p=0.228 → S8@127.0.0.1:39009
[S7] ⇄ pheromone p=0.238 → S2@127.0.0.1:39002
[S9] ⇄ pheromone p=0.257 → S15@127.0.0.1:39015
[S2] ⇄ pheromone p=0.208 → S9@127.0.0.1:39010
[S15] ⇄ pheromone p=0.180 → S6@127.0.0.1:39007
[S16] ⇄ pheromone p=0.113 → S7@127.0.0.1:39008
[S11] ⇄ pheromone p=0.255 → S5@127.0.0.1:39005
[S10] ⇄ pheromone p=0.198 → S14@127.0.0.1:39014
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.2067 head_norm=1.340367
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.526625e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.1535 head_norm=1.422047 delta_norm=0.252663
[S5] aggregate: ROLLBACK (f1_val pre=0.207 post=0.154 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.245 → S17@127.0.0.1:39017
[S8] ⇄ pheromone p=0.243 → S5@127.0.0.1:39005
[S17] ⇄ pheromone p=0.045 → S16@127.0.0.1:39016
[S2] START round=16 head_norm_before_train=1.587491 (no previous merge yet)
[S2] round=16 local utility u=0.028648 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.412719616924793, 'psi': 0.26537216828478966}-{'f1_val': 0.2648401826484018, 'auprc': 0.2648401826484018, 'loss_val': 2.465227139013856, 'psi': 0.2648401826484018}
[S3] START round=16 head_norm_before_train=1.609326 (no previous merge yet)
[S3] round=16 local utility u=0.026921 metrics={'f1_val': 0.2967425256581883, 'auprc': 0.2967425256581883, 'loss_val': 2.443046878265799, 'psi': 0.2967425256581883}-{'f1_val': 0.2901839436135465, 'auprc': 0.2901839436135465, 'loss_val': 2.437862332860278, 'psi': 0.2901839436135465}
[S4] START round=16 head_norm_before_train=1.388212 cos_to_last_merge=0.9948 (last merge round=14)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.393224343307193, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.380005702650401, 'psi': 0.0}
[S5] START round=16 head_norm_before_train=1.422047 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.2027219465702352, 'auprc': 0.2027219465702352, 'loss_val': 1.2841864261023548, 'psi': 0.2027219465702352}-{'f1_val': 0.2067474924730396, 'auprc': 0.2067474924730396, 'loss_val': 1.3036462082250098, 'psi': 0.2067474924730396}
[S6] START round=16 head_norm_before_train=1.565577 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.04685466377440347, 'auprc': 0.04685466377440347, 'loss_val': 4.358365403266959, 'psi': 0.04685466377440347}-{'f1_val': 0.08650039588281869, 'auprc': 0.08650039588281869, 'loss_val': 3.4518377583814104, 'psi': 0.08650039588281869}
[S7] START round=16 head_norm_before_train=1.422046 (no previous merge yet)
[S7] round=16 local utility u=0.772275 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2958258002675531, 'psi': 0.35976373724718097}-{'f1_val': 0.19254060005505091, 'auprc': 0.19254060005505091, 'loss_val': 1.3353669128101555, 'psi': 0.19254060005505091}
[S8] START round=16 head_norm_before_train=1.541274 (no previous merge yet)
[S8] round=16 local utility u=0.060098 metrics={'f1_val': 0.31058330870713613, 'auprc': 0.31058330870713613, 'loss_val': 0.9858762910978861, 'psi': 0.31058330870713613}-{'f1_val': 0.3056160676472066, 'auprc': 0.3056160676472066, 'loss_val': 1.0613680793759102, 'psi': 0.3056160676472066}
[S9] START round=16 head_norm_before_train=1.582553 (no previous merge yet)
[S9] round=16 local utility u=0.860501 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.150592726776543, 'psi': 0.36867172340800847}-{'f1_val': 0.19549763033175357, 'auprc': 0.19549763033175357, 'loss_val': 2.313027524892998, 'psi': 0.19549763033175357}
[S10] START round=16 head_norm_before_train=1.596365 (no previous merge yet)
[S10] round=16 local utility u=0.145804 metrics={'f1_val': 0.2462396894711305, 'auprc': 0.2462396894711305, 'loss_val': 3.1304163739522988, 'psi': 0.2462396894711305}-{'f1_val': 0.229366106080207, 'auprc': 0.229366106080207, 'loss_val': 3.2701627527441977, 'psi': 0.229366106080207}
[S11] START round=16 head_norm_before_train=1.592412 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.3315508021390374, 'auprc': 0.3315508021390374, 'loss_val': 2.0292253056082137, 'psi': 0.3315508021390374}-{'f1_val': 0.32387438516836925, 'auprc': 0.32387438516836925, 'loss_val': 1.8397396821682594, 'psi': 0.32387438516836925}
[S13] START round=16 head_norm_before_train=1.467003 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.24785231219155546, 'auprc': 0.24785231219155546, 'loss_val': 1.2705613844713572, 'psi': 0.24785231219155546}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.2012339090924053, 'psi': 0.3330058939096267}
[S14] START round=16 head_norm_before_train=1.429990 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.001033 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.277008089839365, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.279074520894365, 'psi': 0.0}
[S15] START round=16 head_norm_before_train=1.256057 cos_to_last_merge=0.9958 (last merge round=14)
[S15] round=16 local utility u=0.013535 metrics={'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 1.144110482028511, 'psi': 0.2836055656382335}-{'f1_val': 0.28388344819247974, 'auprc': 0.28388344819247974, 'loss_val': 1.1736813038434513, 'psi': 0.28388344819247974}
[S16] START round=16 head_norm_before_train=1.600456 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.0900727941764659, 'auprc': 0.0900727941764659, 'loss_val': 3.90028134826118, 'psi': 0.0900727941764659}-{'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 3.530089658094047, 'psi': 0.09046591544793414}
[S17] START round=16 head_norm_before_train=1.544471 (no previous merge yet)
[S17] round=16 local utility u=0.277963 metrics={'f1_val': 0.05363720073664825, 'auprc': 0.05363720073664825, 'loss_val': 1.3197835566785552, 'psi': 0.05363720073664825}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3929754376149666, 'psi': 0.0}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39014
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:39010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:39007
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S8
[S5] cosine check vs S8: cos=0.9774
[S6] RECEIVED delta(kind=head bytes=1805) from S15
[S6] cosine check vs S15: cos=-0.0093
[S6] DROPPED delta from S15 (cos=-0.0093 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S7
[S2] cosine check vs S7: cos=0.0431
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9719
[S15] RECEIVED delta(kind=head bytes=1803) from S9
[S15] cosine check vs S9: cos=0.8938
[S9] RECEIVED delta(kind=head bytes=1803) from S2
[S9] cosine check vs S2: cos=-0.0570
[S9] DROPPED delta from S2 (cos=-0.0570 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] cosine check vs S3: cos=-0.0858
[S8] DROPPED delta from S3 (cos=-0.0858 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.054)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.0000 head_norm=1.465130
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.998256e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.0000 head_norm=1.534654 delta_norm=0.199826
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.2027 head_norm=1.444741
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.735111e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.1672 head_norm=1.502202 delta_norm=0.173511
[S5] aggregate: ROLLBACK (f1_val pre=0.203 post=0.167 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.2836 head_norm=1.298621
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.672506e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.2818 head_norm=1.414744 delta_norm=0.367251
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.2654 head_norm=1.615426
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.057208e+00
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.2654 head_norm=1.103507 delta_norm=1.057208
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.103507 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.287916 metrics={'f1_val': 0.2602163072339874, 'auprc': 0.2602163072339874, 'loss_val': 1.7904858590451802, 'psi': 0.2602163072339874}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.412719616924793, 'psi': 0.26537216828478966}
[S3] START round=17 head_norm_before_train=1.639313 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.30006311423676857, 'auprc': 0.30006311423676857, 'loss_val': 2.883196677532545, 'psi': 0.30006311423676857}-{'f1_val': 0.2967425256581883, 'auprc': 0.2967425256581883, 'loss_val': 2.443046878265799, 'psi': 0.2967425256581883}
[S4] START round=17 head_norm_before_train=1.432554 cos_to_last_merge=0.9839 (last merge round=14)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4281083334072684, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.393224343307193, 'psi': 0.0}
[S5] START round=17 head_norm_before_train=1.502202 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.16976462878618842, 'auprc': 0.16976462878618842, 'loss_val': 1.2395361236299263, 'psi': 0.16976462878618842}-{'f1_val': 0.2027219465702352, 'auprc': 0.2027219465702352, 'loss_val': 1.2841864261023548, 'psi': 0.2027219465702352}
[S6] START round=17 head_norm_before_train=1.585359 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.06515403830141549, 'auprc': 0.06515403830141549, 'loss_val': 4.528696737287349, 'psi': 0.06515403830141549}-{'f1_val': 0.04685466377440347, 'auprc': 0.04685466377440347, 'loss_val': 4.358365403266959, 'psi': 0.04685466377440347}
[S7] START round=17 head_norm_before_train=1.435699 (no previous merge yet)
[S7] round=17 local utility u=0.015013 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2657996982167177, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2958258002675531, 'psi': 0.35976373724718097}
[S8] START round=17 head_norm_before_train=1.576756 (no previous merge yet)
[S8] round=17 local utility u=0.532708 metrics={'f1_val': 0.4224881337648328, 'auprc': 0.4224881337648328, 'loss_val': 0.927603124767234, 'psi': 0.4224881337648328}-{'f1_val': 0.31058330870713613, 'auprc': 0.31058330870713613, 'loss_val': 0.9858762910978861, 'psi': 0.31058330870713613}
[S9] START round=17 head_norm_before_train=1.608207 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.195253759255375, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.150592726776543, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.625910 (no previous merge yet)
[S10] round=17 local utility u=0.050593 metrics={'f1_val': 0.248859543817527, 'auprc': 0.248859543817527, 'loss_val': 3.05281000753362, 'psi': 0.248859543817527}-{'f1_val': 0.2462396894711305, 'auprc': 0.2462396894711305, 'loss_val': 3.1304163739522988, 'psi': 0.2462396894711305}
[S11] START round=17 head_norm_before_train=1.612114 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.3316279069767442, 'auprc': 0.3316279069767442, 'loss_val': 2.127390336559463, 'psi': 0.3316279069767442}-{'f1_val': 0.3315508021390374, 'auprc': 0.3315508021390374, 'loss_val': 2.0292253056082137, 'psi': 0.3315508021390374}
[S13] START round=17 head_norm_before_train=1.495414 (no previous merge yet)
[S13] round=17 local utility u=0.477547 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3242225610945, 'psi': 0.3599362944611573}-{'f1_val': 0.24785231219155546, 'auprc': 0.24785231219155546, 'loss_val': 1.2705613844713572, 'psi': 0.24785231219155546}
[S14] START round=17 head_norm_before_train=1.534654 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.148691 metrics={'f1_val': 0.05279099956728689, 'auprc': 0.05279099956728689, 'loss_val': 3.4547455085473553, 'psi': 0.05279099956728689}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.277008089839365, 'psi': 0.0}
[S15] START round=17 head_norm_before_train=1.414744 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.020153 metrics={'f1_val': 0.28416092787241753, 'auprc': 0.28416092787241753, 'loss_val': 1.1088027859733003, 'psi': 0.28416092787241753}-{'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 1.144110482028511, 'psi': 0.2836055656382335}
[S16] START round=17 head_norm_before_train=1.627852 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.09060402684563758, 'auprc': 0.09060402684563758, 'loss_val': 4.053404474650415, 'psi': 0.09060402684563758}-{'f1_val': 0.0900727941764659, 'auprc': 0.0900727941764659, 'loss_val': 3.90028134826118, 'psi': 0.0900727941764659}
[S17] START round=17 head_norm_before_train=1.553100 (no previous merge yet)
[S17] round=17 local utility u=0.503429 metrics={'f1_val': 0.15849475383373687, 'auprc': 0.15849475383373687, 'loss_val': 1.2566441567507218, 'psi': 0.15849475383373687}-{'f1_val': 0.05363720073664825, 'auprc': 0.05363720073664825, 'loss_val': 1.3197835566785552, 'psi': 0.05363720073664825}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:39010
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.053)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:39007
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39014
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=0.9878
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9839
[S6] RECEIVED delta(kind=head bytes=1805) from S15
[S6] cosine check vs S15: cos=0.0136
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] cosine check vs S13: cos=0.9320
[S9] RECEIVED delta(kind=head bytes=1802) from S2
[S9] cosine check vs S2: cos=0.0292
[S2] RECEIVED delta(kind=head bytes=1800) from S7
[S2] cosine check vs S7: cos=0.6576
[S17] not sending this round → trigger blocked (psi=0.158)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.1698 head_norm=1.520352
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.315227e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.1676 head_norm=1.563517 delta_norm=0.131523
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.0528 head_norm=1.569668
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.506146e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.0588 head_norm=1.605374 delta_norm=0.150615
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.3687 head_norm=1.630823
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.815280e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.3687 head_norm=1.008803 delta_norm=0.981528
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.0652 head_norm=1.606892
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.072906e+00
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.0609 head_norm=1.087561 delta_norm=1.072906
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.0000 head_norm=1.475971
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.771530e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.0000 head_norm=1.472440 delta_norm=0.277153
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.2602 head_norm=1.141306
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.544935e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.2648 head_norm=1.181696 delta_norm=0.554493
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.181696 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.097187 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 1.6425154821407912, 'psi': 0.26537216828478966}-{'f1_val': 0.2602163072339874, 'auprc': 0.2602163072339874, 'loss_val': 1.7904858590451802, 'psi': 0.2602163072339874}
[S3] START round=18 head_norm_before_train=1.664882 (no previous merge yet)
[S3] round=18 local utility u=0.053756 metrics={'f1_val': 0.2791344882766298, 'auprc': 0.2791344882766298, 'loss_val': 2.5873266288981696, 'psi': 0.2791344882766298}-{'f1_val': 0.30006311423676857, 'auprc': 0.30006311423676857, 'loss_val': 2.883196677532545, 'psi': 0.30006311423676857}
[S4] START round=18 head_norm_before_train=1.472440 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4506557309761166, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4281083334072684, 'psi': 0.0}
[S5] START round=18 head_norm_before_train=1.563517 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=1.000000 metrics={'f1_val': 0.41532051831134187, 'auprc': 0.41532051831134187, 'loss_val': 1.1966507369683628, 'psi': 0.41532051831134187}-{'f1_val': 0.16976462878618842, 'auprc': 0.16976462878618842, 'loss_val': 1.2395361236299263, 'psi': 0.16976462878618842}
[S6] START round=18 head_norm_before_train=1.087561 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.413035 metrics={'f1_val': 0.01100187265917603, 'auprc': 0.01100187265917603, 'loss_val': 3.215257798151117, 'psi': 0.01100187265917603}-{'f1_val': 0.06515403830141549, 'auprc': 0.06515403830141549, 'loss_val': 4.528696737287349, 'psi': 0.06515403830141549}
[S7] START round=18 head_norm_before_train=1.450917 (no previous merge yet)
[S7] round=18 local utility u=0.014677 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2364448658978382, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2657996982167177, 'psi': 0.35976373724718097}
[S8] START round=18 head_norm_before_train=1.616259 (no previous merge yet)
[S8] round=18 local utility u=0.511883 metrics={'f1_val': 0.5311567523941241, 'auprc': 0.5311567523941241, 'loss_val': 0.8818550609468201, 'psi': 0.5311567523941241}-{'f1_val': 0.4224881337648328, 'auprc': 0.4224881337648328, 'loss_val': 0.927603124767234, 'psi': 0.4224881337648328}
[S9] START round=18 head_norm_before_train=1.008803 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.24444051200377515, 'auprc': 0.24444051200377515, 'loss_val': 1.5319617058711188, 'psi': 0.24444051200377515}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.195253759255375, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.654073 (no previous merge yet)
[S10] round=18 local utility u=0.038931 metrics={'f1_val': 0.24964097654380085, 'auprc': 0.24964097654380085, 'loss_val': 2.9819802997276126, 'psi': 0.24964097654380085}-{'f1_val': 0.248859543817527, 'auprc': 0.248859543817527, 'loss_val': 3.05281000753362, 'psi': 0.248859543817527}
[S11] START round=18 head_norm_before_train=1.631257 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.311901269987877, 'psi': 0.3317042898145993}-{'f1_val': 0.3316279069767442, 'auprc': 0.3316279069767442, 'loss_val': 2.127390336559463, 'psi': 0.3316279069767442}
[S13] START round=18 head_norm_before_train=1.520295 (no previous merge yet)
[S13] round=18 local utility u=0.008690 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3068428630073243, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3242225610945, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.605374 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.372256 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 3.442321773032029, 'psi': 0.13413413413413414}-{'f1_val': 0.05279099956728689, 'auprc': 0.05279099956728689, 'loss_val': 3.4547455085473553, 'psi': 0.05279099956728689}
[S15] START round=18 head_norm_before_train=1.444206 cos_to_last_merge=0.9971 (last merge round=16)
[S15] round=18 local utility u=0.064804 metrics={'f1_val': 0.289087656529517, 'auprc': 0.289087656529517, 'loss_val': 1.0235357518512394, 'psi': 0.289087656529517}-{'f1_val': 0.28416092787241753, 'auprc': 0.28416092787241753, 'loss_val': 1.1088027859733003, 'psi': 0.28416092787241753}
[S16] START round=18 head_norm_before_train=1.651358 (no previous merge yet)
[S16] round=18 local utility u=0.134859 metrics={'f1_val': 0.11878180299232931, 'auprc': 0.11878180299232931, 'loss_val': 4.037285711305144, 'psi': 0.11878180299232931}-{'f1_val': 0.09060402684563758, 'auprc': 0.09060402684563758, 'loss_val': 4.053404474650415, 'psi': 0.09060402684563758}
[S17] START round=18 head_norm_before_train=1.568397 (no previous merge yet)
[S17] round=18 local utility u=0.015933 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.1691803213326324, 'psi': 0.15231723870467326}-{'f1_val': 0.15849475383373687, 'auprc': 0.15849475383373687, 'loss_val': 1.2566441567507218, 'psi': 0.15849475383373687}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:39010
[S6] not sending this round → trigger blocked (psi=0.011)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39002
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:39017
[S14] not sending this round → trigger blocked (psi=0.134)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:39004
[S16] not sending this round → trigger blocked (psi=0.119)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S8
[S5] cosine check vs S8: cos=0.9923
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9886
[S9] RECEIVED delta(kind=head bytes=1800) from S2
[S9] cosine check vs S2: cos=0.5580
[S6] RECEIVED delta(kind=head bytes=1794) from S15
[S6] cosine check vs S15: cos=0.6484
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] cosine check vs S13: cos=0.9726
[S17] RECEIVED delta(kind=head bytes=1798) from S5
[S17] cosine check vs S5: cos=-0.0660
[S17] DROPPED delta from S5 (cos=-0.0660 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S7
[S2] cosine check vs S7: cos=0.9042
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] cosine check vs S3: cos=-0.0862
[S8] DROPPED delta from S3 (cos=-0.0862 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.152)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.2444 head_norm=1.049807
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.364310e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.2127 head_norm=0.998813 delta_norm=0.536431
[S9] aggregate: ROLLBACK (f1_val pre=0.244 post=0.213 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.1341 head_norm=1.643272
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.265753e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.1347 head_norm=1.655914 delta_norm=0.126575
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.0000 head_norm=1.508487
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.795810e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.0000 head_norm=1.515506 delta_norm=0.179581
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.0110 head_norm=1.124247
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.698622e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.0026 head_norm=1.185215 delta_norm=0.569862
[S6] aggregate: ROLLBACK (f1_val pre=0.011 post=0.003 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.4153 head_norm=1.579171
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.075091e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.3480 head_norm=1.614328 delta_norm=0.107509
[S5] aggregate: ROLLBACK (f1_val pre=0.415 post=0.348 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.2654 head_norm=1.211890
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.174565e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.2654 head_norm=1.305585 delta_norm=0.317456
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.305585 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 1.644378133715148, 'psi': 0.26542475888492534}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 1.6425154821407912, 'psi': 0.26537216828478966}
[S3] START round=19 head_norm_before_train=1.687419 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.30018731167033147, 'auprc': 0.30018731167033147, 'loss_val': 2.815823506564667, 'psi': 0.30018731167033147}-{'f1_val': 0.2791344882766298, 'auprc': 0.2791344882766298, 'loss_val': 2.5873266288981696, 'psi': 0.2791344882766298}
[S4] START round=19 head_norm_before_train=1.515506 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.460874890360836, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4506557309761166, 'psi': 0.0}
[S5] START round=19 head_norm_before_train=1.614328 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.34964592817400103, 'auprc': 0.34964592817400103, 'loss_val': 1.1944759581031605, 'psi': 0.34964592817400103}-{'f1_val': 0.41532051831134187, 'auprc': 0.41532051831134187, 'loss_val': 1.1966507369683628, 'psi': 0.41532051831134187}
[S6] START round=19 head_norm_before_train=1.185215 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.337175 metrics={'f1_val': 0.013959981386691484, 'auprc': 0.013959981386691484, 'loss_val': 2.567530833594611, 'psi': 0.013959981386691484}-{'f1_val': 0.01100187265917603, 'auprc': 0.01100187265917603, 'loss_val': 3.215257798151117, 'psi': 0.01100187265917603}
[S7] START round=19 head_norm_before_train=1.463553 (no previous merge yet)
[S7] round=19 local utility u=0.006206 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2240320315662627, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2364448658978382, 'psi': 0.35976373724718097}
[S8] START round=19 head_norm_before_train=1.655730 (no previous merge yet)
[S8] round=19 local utility u=1.000000 metrics={'f1_val': 0.985935030712231, 'auprc': 0.985935030712231, 'loss_val': 0.8398767882183508, 'psi': 0.985935030712231}-{'f1_val': 0.5311567523941241, 'auprc': 0.5311567523941241, 'loss_val': 0.8818550609468201, 'psi': 0.5311567523941241}
[S9] START round=19 head_norm_before_train=0.998813 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.618826 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.412390396351948, 'psi': 0.36867172340800847}-{'f1_val': 0.24444051200377515, 'auprc': 0.24444051200377515, 'loss_val': 1.5319617058711188, 'psi': 0.24444051200377515}
[S10] START round=19 head_norm_before_train=1.678035 (no previous merge yet)
[S10] round=19 local utility u=0.019450 metrics={'f1_val': 0.24970088537927734, 'auprc': 0.24970088537927734, 'loss_val': 2.943618866708929, 'psi': 0.24970088537927732}-{'f1_val': 0.24964097654380085, 'auprc': 0.24964097654380085, 'loss_val': 2.9819802997276126, 'psi': 0.24964097654380085}
[S11] START round=19 head_norm_before_train=1.649656 (no previous merge yet)
[S11] round=19 local utility u=0.016462 metrics={'f1_val': 0.3316279069767442, 'auprc': 0.3316279069767442, 'loss_val': 2.2782902044338487, 'psi': 0.3316279069767442}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.311901269987877, 'psi': 0.3317042898145993}
[S13] START round=19 head_norm_before_train=1.543530 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.2895579756566304, 'auprc': 0.2895579756566304, 'loss_val': 1.0091445412894522, 'psi': 0.2895579756566304}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3068428630073243, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.655914 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.0869091404440812, 'auprc': 0.0869091404440812, 'loss_val': 3.641295053939679, 'psi': 0.0869091404440812}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 3.442321773032029, 'psi': 0.13413413413413414}
[S15] START round=19 head_norm_before_train=1.481562 cos_to_last_merge=0.9896 (last merge round=16)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 1.0379483841285921, 'psi': 0.2836055656382335}-{'f1_val': 0.289087656529517, 'auprc': 0.289087656529517, 'loss_val': 1.0235357518512394, 'psi': 0.289087656529517}
[S16] START round=19 head_norm_before_train=1.672851 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.08647342995169083, 'auprc': 0.08647342995169083, 'loss_val': 4.562811270824656, 'psi': 0.08647342995169083}-{'f1_val': 0.11878180299232931, 'auprc': 0.11878180299232931, 'loss_val': 4.037285711305144, 'psi': 0.11878180299232931}
[S17] START round=19 head_norm_before_train=1.584072 (no previous merge yet)
[S17] round=19 local utility u=0.021626 metrics={'f1_val': 0.1544739429695182, 'auprc': 0.1544739429695182, 'loss_val': 1.1453389381980628, 'psi': 0.1544739429695182}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.1691803213326324, 'psi': 0.15231723870467326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39005
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.014)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:39014
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39005
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39002
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=0.0019
[S5] RECEIVED delta(kind=head bytes=1803) from S8
[S5] cosine check vs S8: cos=0.9942
[S14] RECEIVED delta(kind=head bytes=1806) from S10
[S14] cosine check vs S10: cos=0.9910
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=0.9599
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.4958
[S17] not sending this round → trigger blocked (psi=0.154)
[S4] r=20 psi=0.000 u=0.0000 p_local=0.0198 f1=0.000 auprc=0.000 bytes=0
[S13] r=20 psi=0.290 u=0.0000 p_local=0.1398 f1=0.290 auprc=0.290 bytes=10796
[S3] r=20 psi=0.300 u=0.0000 p_local=0.1046 f1=0.300 auprc=0.300 bytes=5400
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.2654 head_norm=1.329032
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.107239e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.2654 head_norm=1.386816 delta_norm=0.210724
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.265 u=0.0000 p_local=0.1404 f1=0.265 auprc=0.265 bytes=9011
[S6] r=20 psi=0.014 u=0.3372 p_local=0.2461 f1=0.014 auprc=0.014 bytes=0
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.3496 head_norm=1.633250
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.792625e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.4978 head_norm=1.307828 delta_norm=0.579262
[S5] aggregate: ACCEPT kept=['S11', 'S8'] (k=2/2) mode=median trim_p=0.1
[S5] r=20 psi=0.350 u=0.0000 p_local=0.2604 f1=0.350 auprc=0.350 bytes=10795
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.2836 head_norm=1.521479
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.762395e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.2836 head_norm=1.115443 delta_norm=0.676239
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.284 u=0.0000 p_local=0.0879 f1=0.284 auprc=0.284 bytes=8997
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.0869 head_norm=1.696425
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.138815e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.0904 head_norm=1.694580 delta_norm=0.113882
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.087 u=0.0000 p_local=0.1671 f1=0.087 auprc=0.087 bytes=0
[S16] r=20 psi=0.086 u=0.0000 p_local=0.0678 f1=0.086 auprc=0.086 bytes=0
[S9] r=20 psi=0.369 u=0.6188 p_local=0.3170 f1=0.369 auprc=0.369 bytes=7196
[S7] r=20 psi=0.360 u=0.0062 p_local=0.1820 f1=0.360 auprc=0.360 bytes=7199
[S8] r=20 psi=0.986 u=1.0000 p_local=0.4556 f1=0.986 auprc=0.986 bytes=14400
[S10] r=20 psi=0.250 u=0.0195 p_local=0.1127 f1=0.250 auprc=0.250 bytes=12613
[S11] r=20 psi=0.332 u=0.0165 p_local=0.1078 f1=0.332 auprc=0.332 bytes=5409
[S17] r=20 psi=0.154 u=0.0216 p_local=0.1182 f1=0.154 auprc=0.154 bytes=0
[S2] START round=20 head_norm_before_train=1.386816 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.005236 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.633663398082654, 'psi': 0.2653978324081417}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 1.644378133715148, 'psi': 0.26542475888492534}
[S3] START round=20 head_norm_before_train=1.707841 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.2917638924898453, 'auprc': 0.2917638924898453, 'loss_val': 2.932790425093734, 'psi': 0.2917638924898453}-{'f1_val': 0.30018731167033147, 'auprc': 0.30018731167033147, 'loss_val': 2.815823506564667, 'psi': 0.30018731167033147}
[S4] START round=20 head_norm_before_train=1.549822 cos_to_last_merge=0.9982 (last merge round=18)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4853952571853204, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.460874890360836, 'psi': 0.0}
[S5] START round=20 head_norm_before_train=1.307828 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.3204400583182065, 'psi': 0.33400978131092857}-{'f1_val': 0.34964592817400103, 'auprc': 0.34964592817400103, 'loss_val': 1.1944759581031605, 'psi': 0.34964592817400103}
[S6] START round=20 head_norm_before_train=1.215942 cos_to_last_merge=0.9976 (last merge round=18)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.027161611588954276, 'auprc': 0.027161611588954276, 'loss_val': 3.1383413995754963, 'psi': 0.027161611588954276}-{'f1_val': 0.013959981386691484, 'auprc': 0.013959981386691484, 'loss_val': 2.567530833594611, 'psi': 0.013959981386691484}
[S7] START round=20 head_norm_before_train=1.472752 (no previous merge yet)
[S7] round=20 local utility u=0.010291 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2034498571179724, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2240320315662627, 'psi': 0.35976373724718097}
[S8] START round=20 head_norm_before_train=1.690242 (no previous merge yet)
[S8] round=20 local utility u=0.072431 metrics={'f1_val': 0.9994354958690915, 'auprc': 0.9994354958690915, 'loss_val': 0.816518595944614, 'psi': 0.9994354958690915}-{'f1_val': 0.985935030712231, 'auprc': 0.985935030712231, 'loss_val': 0.8398767882183508, 'psi': 0.985935030712231}
[S9] START round=20 head_norm_before_train=1.043134 cos_to_last_merge=0.9949 (last merge round=18)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4198194899882157, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.412390396351948, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.700377 (no previous merge yet)
[S10] round=20 local utility u=0.021356 metrics={'f1_val': 0.24976076555023924, 'auprc': 0.24976076555023924, 'loss_val': 2.9014454400547387, 'psi': 0.24976076555023924}-{'f1_val': 0.24970088537927734, 'auprc': 0.24970088537927734, 'loss_val': 2.943618866708929, 'psi': 0.24970088537927732}
[S11] START round=20 head_norm_before_train=1.670006 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.32423829013187816, 'auprc': 0.32423829013187816, 'loss_val': 2.275173073728881, 'psi': 0.32423829013187816}-{'f1_val': 0.3316279069767442, 'auprc': 0.3316279069767442, 'loss_val': 2.2782902044338487, 'psi': 0.3316279069767442}
[S13] START round=20 head_norm_before_train=1.559315 (no previous merge yet)
[S13] round=20 local utility u=0.169584 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3033818670900676, 'psi': 0.3599362944611573}-{'f1_val': 0.2895579756566304, 'auprc': 0.2895579756566304, 'loss_val': 1.0091445412894522, 'psi': 0.2895579756566304}
[S14] START round=20 head_norm_before_train=1.694580 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.240173 metrics={'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 3.584173309423826, 'psi': 0.13393415946927026}-{'f1_val': 0.0869091404440812, 'auprc': 0.0869091404440812, 'loss_val': 3.641295053939679, 'psi': 0.0869091404440812}
[S15] START round=20 head_norm_before_train=1.115443 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.223049 metrics={'f1_val': 0.3229098805646037, 'auprc': 0.3229098805646037, 'loss_val': 0.9455885940730141, 'psi': 0.3229098805646037}-{'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 1.0379483841285921, 'psi': 0.2836055656382335}
[S16] START round=20 head_norm_before_train=1.692733 (no previous merge yet)
[S16] round=20 local utility u=0.029906 metrics={'f1_val': 0.09048760991207035, 'auprc': 0.09048760991207035, 'loss_val': 4.539127368631689, 'psi': 0.09048760991207035}-{'f1_val': 0.08647342995169083, 'auprc': 0.08647342995169083, 'loss_val': 4.562811270824656, 'psi': 0.08647342995169083}
[S17] START round=20 head_norm_before_train=1.599646 (no previous merge yet)
[S17] round=20 local utility u=0.014835 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.0965238759391578, 'psi': 0.15234678044996122}-{'f1_val': 0.1544739429695182, 'auprc': 0.1544739429695182, 'loss_val': 1.1453389381980628, 'psi': 0.1544739429695182}
[S14] not sending this round → trigger blocked (psi=0.134)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:39004
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:39010
[S15] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=0.9445
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=0.9930
[S6] RECEIVED delta(kind=head bytes=1791) from S15
[S6] cosine check vs S15: cos=0.8189
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] cosine check vs S13: cos=0.9737
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=0.9748
[S9] RECEIVED delta(kind=head bytes=1801) from S2
[S9] cosine check vs S2: cos=0.7780
[S17] not sending this round → trigger blocked (psi=0.152)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.3340 head_norm=1.332472
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.176940e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.2509 head_norm=1.504729 delta_norm=0.317694
[S5] aggregate: ROLLBACK (f1_val pre=0.334 post=0.251 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.208 → S17@127.0.0.1:39017
[S3] ⇄ pheromone p=0.084 → S8@127.0.0.1:39009
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.0000 head_norm=1.591218
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.815286e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.0000 head_norm=1.569960 delta_norm=0.181529
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.016 → S10@127.0.0.1:39011
[S11] ⇄ pheromone p=0.086 → S5@127.0.0.1:39005
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.3687 head_norm=1.108985
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.416702e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.3687 head_norm=1.186502 delta_norm=0.441670
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.254 → S15@127.0.0.1:39015
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.1339 head_norm=1.732732
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.024509e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.1343 head_norm=1.725156 delta_norm=0.102451
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.182 → S17@127.0.0.1:39017
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.0272 head_norm=1.265270
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.679430e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.0010 head_norm=1.154238 delta_norm=0.367943
[S6] aggregate: ROLLBACK (f1_val pre=0.027 post=0.001 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.197 → S17@127.0.0.1:39017
[S16] ⇄ pheromone p=0.060 → S7@127.0.0.1:39008
[S7] ⇄ pheromone p=0.148 → S2@127.0.0.1:39002
[S15] ⇄ pheromone p=0.115 → S6@127.0.0.1:39007
[S10] ⇄ pheromone p=0.094 → S14@127.0.0.1:39014
[S13] ⇄ pheromone p=0.146 → S4@127.0.0.1:39004
[S8] ⇄ pheromone p=0.379 → S5@127.0.0.1:39005
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.2654 head_norm=1.405656
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.668960e-01
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.2654 head_norm=1.436115 delta_norm=0.166896
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.113 → S9@127.0.0.1:39010
[S17] ⇄ pheromone p=0.098 → S16@127.0.0.1:39016
[S2] START round=21 head_norm_before_train=1.436115 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 1.5362460425082838, 'psi': 0.24507471790179935}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.633663398082654, 'psi': 0.2653978324081417}
[S3] START round=21 head_norm_before_train=1.728081 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.2897732135216089, 'auprc': 0.2897732135216089, 'loss_val': 2.962160521450421, 'psi': 0.2897732135216089}-{'f1_val': 0.2917638924898453, 'auprc': 0.2917638924898453, 'loss_val': 2.932790425093734, 'psi': 0.2917638924898453}
[S4] START round=21 head_norm_before_train=1.569960 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.002136 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.481123543376703, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4853952571853204, 'psi': 0.0}
[S5] START round=21 head_norm_before_train=1.504729 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.5450789185382927, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.3204400583182065, 'psi': 0.33400978131092857}
[S6] START round=21 head_norm_before_train=1.154238 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.001431980906921241, 'auprc': 0.001431980906921241, 'loss_val': 3.0596358341618166, 'psi': 0.001431980906921241}-{'f1_val': 0.027161611588954276, 'auprc': 0.027161611588954276, 'loss_val': 3.1383413995754963, 'psi': 0.027161611588954276}
[S7] START round=21 head_norm_before_train=1.484820 (no previous merge yet)
[S7] round=21 local utility u=0.005084 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.193282015317354, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2034498571179724, 'psi': 0.35976373724718097}
[S8] START round=21 head_norm_before_train=1.718953 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.798032055158882, 'psi': 0.35939447907390915}-{'f1_val': 0.9994354958690915, 'auprc': 0.9994354958690915, 'loss_val': 0.816518595944614, 'psi': 0.9994354958690915}
[S9] START round=21 head_norm_before_train=1.186502 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.013436 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3929483934556406, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4198194899882157, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.723647 (no previous merge yet)
[S10] round=21 local utility u=0.399064 metrics={'f1_val': 0.3330942704597976, 'auprc': 0.3330942704597976, 'loss_val': 2.8533187467300243, 'psi': 0.3330942704597976}-{'f1_val': 0.24976076555023924, 'auprc': 0.24976076555023924, 'loss_val': 2.9014454400547387, 'psi': 0.24976076555023924}
[S11] START round=21 head_norm_before_train=1.692532 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.32416458285974087, 'auprc': 0.32416458285974087, 'loss_val': 2.3319576729113423, 'psi': 0.32416458285974087}-{'f1_val': 0.32423829013187816, 'auprc': 0.32423829013187816, 'loss_val': 2.275173073728881, 'psi': 0.32423829013187816}
[S13] START round=21 head_norm_before_train=1.569548 (no previous merge yet)
[S13] round=21 local utility u=0.082501 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1383794892128465, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3033818670900676, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.725156 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.11785944551901999, 'auprc': 0.11785944551901999, 'loss_val': 3.6484896329307155, 'psi': 0.11785944551901999}-{'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 3.584173309423826, 'psi': 0.13393415946927026}
[S15] START round=21 head_norm_before_train=1.155156 cos_to_last_merge=0.9970 (last merge round=19)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.2844380055535434, 'auprc': 0.2844380055535434, 'loss_val': 0.9481603274890942, 'psi': 0.2844380055535434}-{'f1_val': 0.3229098805646037, 'auprc': 0.3229098805646037, 'loss_val': 0.9455885940730141, 'psi': 0.3229098805646037}
[S16] START round=21 head_norm_before_train=1.710783 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.09021113243761997, 'auprc': 0.09021113243761997, 'loss_val': 4.705623233330439, 'psi': 0.09021113243761997}-{'f1_val': 0.09048760991207035, 'auprc': 0.09048760991207035, 'loss_val': 4.539127368631689, 'psi': 0.09048760991207035}
[S17] START round=21 head_norm_before_train=1.610889 (no previous merge yet)
[S17] round=21 local utility u=0.017721 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0605509273230647, 'psi': 0.152287708414114}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.0965238759391578, 'psi': 0.15234678044996122}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:39004
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39002
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39014
[S10] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9947
[S15] RECEIVED delta(kind=head bytes=1796) from S9
[S15] cosine check vs S9: cos=0.6513
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] cosine check vs S13: cos=0.9867
[S2] RECEIVED delta(kind=head bytes=1795) from S7
[S2] cosine check vs S7: cos=0.9801
[S17] not sending this round → trigger blocked (psi=0.152)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.0000 head_norm=1.603813
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.302157e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.0000 head_norm=1.584681 delta_norm=0.130216
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.1179 head_norm=1.759123
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.073450e-02
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.1187 head_norm=1.749256 delta_norm=0.090735
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.2451 head_norm=1.457157
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.488636e-01
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.2451 head_norm=1.470359 delta_norm=0.148864
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.2844 head_norm=1.207412
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.097148e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.6171 head_norm=1.108943 delta_norm=0.509715
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.470359 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.056339 metrics={'f1_val': 0.2548198883815322, 'auprc': 0.2548198883815322, 'loss_val': 1.511273882710877, 'psi': 0.2548198883815322}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 1.5362460425082838, 'psi': 0.24507471790179935}
[S3] START round=22 head_norm_before_train=1.747537 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.2904257109204106, 'auprc': 0.2904257109204106, 'loss_val': 2.972685713915987, 'psi': 0.2904257109204106}-{'f1_val': 0.2897732135216089, 'auprc': 0.2897732135216089, 'loss_val': 2.962160521450421, 'psi': 0.2897732135216089}
[S4] START round=22 head_norm_before_train=1.584681 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.018440 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.444242581643045, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.481123543376703, 'psi': 0.0}
[S5] START round=22 head_norm_before_train=1.539530 cos_to_last_merge=0.9981 (last merge round=20)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.7433094094119752, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.5450789185382927, 'psi': 0.33400978131092857}
[S6] START round=22 head_norm_before_train=1.198897 cos_to_last_merge=0.9944 (last merge round=20)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.025442980463425715, 'auprc': 0.025442980463425715, 'loss_val': 3.4733396718540814, 'psi': 0.025442980463425715}-{'f1_val': 0.001431980906921241, 'auprc': 0.001431980906921241, 'loss_val': 3.0596358341618166, 'psi': 0.001431980906921241}
[S7] START round=22 head_norm_before_train=1.498309 (no previous merge yet)
[S7] round=22 local utility u=0.005733 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1818169799493252, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.193282015317354, 'psi': 0.35976373724718097}
[S8] START round=22 head_norm_before_train=1.747386 (no previous merge yet)
[S8] round=22 local utility u=0.008716 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7805994940649018, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.798032055158882, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.233403 cos_to_last_merge=0.9947 (last merge round=20)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3964858646048686, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3929483934556406, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.744061 (no previous merge yet)
[S10] round=22 local utility u=0.017177 metrics={'f1_val': 0.3330146590184831, 'auprc': 0.3330146590184831, 'loss_val': 2.818247355243437, 'psi': 0.3330146590184831}-{'f1_val': 0.3330942704597976, 'auprc': 0.3330942704597976, 'loss_val': 2.8533187467300243, 'psi': 0.3330942704597976}
[S11] START round=22 head_norm_before_train=1.714128 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.5249927724479844, 'psi': 0.33185875048506014}-{'f1_val': 0.32416458285974087, 'auprc': 0.32416458285974087, 'loss_val': 2.3319576729113423, 'psi': 0.32416458285974087}
[S13] START round=22 head_norm_before_train=1.576111 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2926541335821964, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1383794892128465, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.749256 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.059532 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.691119878136638, 'psi': 0.13582554517133957}-{'f1_val': 0.11785944551901999, 'auprc': 0.11785944551901999, 'loss_val': 3.6484896329307155, 'psi': 0.11785944551901999}
[S15] START round=22 head_norm_before_train=1.108943 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.018873 metrics={'f1_val': 0.2845763939174511, 'auprc': 0.2845763939174511, 'loss_val': 0.9116592909088375, 'psi': 0.2845763939174511}-{'f1_val': 0.2844380055535434, 'auprc': 0.2844380055535434, 'loss_val': 0.9481603274890942, 'psi': 0.2844380055535434}
[S16] START round=22 head_norm_before_train=1.726713 (no previous merge yet)
[S16] round=22 local utility u=0.216065 metrics={'f1_val': 0.11131639722863741, 'auprc': 0.11131639722863741, 'loss_val': 4.463440525823867, 'psi': 0.1113163972286374}-{'f1_val': 0.09021113243761997, 'auprc': 0.09021113243761997, 'loss_val': 4.705623233330439, 'psi': 0.09021113243761997}
[S17] START round=22 head_norm_before_train=1.625735 (no previous merge yet)
[S17] round=22 local utility u=0.002468 metrics={'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.056412000969408, 'psi': 0.15237633365664405}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0605509273230647, 'psi': 0.152287708414114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:39010
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39014
[S16] not sending this round → trigger blocked (psi=0.111)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39002
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39005
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S2
[S9] cosine check vs S2: cos=0.8841
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] cosine check vs S8: cos=0.9793
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9958
[S6] RECEIVED delta(kind=head bytes=1798) from S15
[S6] cosine check vs S15: cos=0.7722
[S2] RECEIVED delta(kind=head bytes=1795) from S7
[S2] cosine check vs S7: cos=0.9829
[S17] not sending this round → trigger blocked (psi=0.152)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.3340 head_norm=1.574481
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.971886e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.3340 head_norm=1.665563 delta_norm=0.197189
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.3687 head_norm=1.294000
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.496828e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.3687 head_norm=1.353870 delta_norm=0.349683
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.0254 head_norm=1.251951
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.086766e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.0000 head_norm=1.132686 delta_norm=0.408677
[S6] aggregate: ROLLBACK (f1_val pre=0.025 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.1358 head_norm=1.781510
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.171580e-02
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.1358 head_norm=1.771442 delta_norm=0.081716
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.2548 head_norm=1.495342
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.396259e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.2521 head_norm=1.498298 delta_norm=0.139626
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.498298 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.009593 metrics={'f1_val': 0.26534522629666335, 'auprc': 0.26534522629666335, 'loss_val': 1.586816540427409, 'psi': 0.26534522629666335}-{'f1_val': 0.2548198883815322, 'auprc': 0.2548198883815322, 'loss_val': 1.511273882710877, 'psi': 0.2548198883815322}
[S3] START round=23 head_norm_before_train=1.764948 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.2971074003102473, 'auprc': 0.2971074003102473, 'loss_val': 3.1853449547587274, 'psi': 0.2971074003102473}-{'f1_val': 0.2904257109204106, 'auprc': 0.2904257109204106, 'loss_val': 2.972685713915987, 'psi': 0.2904257109204106}
[S4] START round=23 head_norm_before_train=1.614618 cos_to_last_merge=0.9989 (last merge round=21)
[S4] round=23 local utility u=0.341827 metrics={'f1_val': 0.07357279194863786, 'auprc': 0.07357279194863786, 'loss_val': 1.4227440870049888, 'psi': 0.07357279194863786}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.444242581643045, 'psi': 0.0}
[S5] START round=23 head_norm_before_train=1.665563 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7867161564176461, 'psi': 0.3335071121394324}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.7433094094119752, 'psi': 0.33400978131092857}
[S6] START round=23 head_norm_before_train=1.132686 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.0009555661729574773, 'auprc': 0.0009555661729574773, 'loss_val': 3.254869078648382, 'psi': 0.0009555661729574773}-{'f1_val': 0.025442980463425715, 'auprc': 0.025442980463425715, 'loss_val': 3.4733396718540814, 'psi': 0.025442980463425715}
[S7] START round=23 head_norm_before_train=1.514177 (no previous merge yet)
[S7] round=23 local utility u=0.011639 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1585384190927661, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1818169799493252, 'psi': 0.35976373724718097}
[S8] START round=23 head_norm_before_train=1.773971 (no previous merge yet)
[S8] round=23 local utility u=0.005378 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7698431170224702, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7805994940649018, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.353870 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.028944 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3385981464269974, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3964858646048686, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.765104 (no previous merge yet)
[S10] round=23 local utility u=0.013682 metrics={'f1_val': 0.3330146590184831, 'auprc': 0.3330146590184831, 'loss_val': 2.790883469137147, 'psi': 0.3330146590184831}-{'f1_val': 0.3330146590184831, 'auprc': 0.3330146590184831, 'loss_val': 2.818247355243437, 'psi': 0.3330146590184831}
[S11] START round=23 head_norm_before_train=1.734895 (no previous merge yet)
[S11] round=23 local utility u=0.074324 metrics={'f1_val': 0.32088768930874195, 'auprc': 0.32088768930874195, 'loss_val': 2.2776047945757703, 'psi': 0.32088768930874195}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.5249927724479844, 'psi': 0.33185875048506014}
[S13] START round=23 head_norm_before_train=1.584077 (no previous merge yet)
[S13] round=23 local utility u=0.081988 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1286787051009655, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2926541335821964, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.771442 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.7839600706459704, 'psi': 0.13572854291417166}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.691119878136638, 'psi': 0.13582554517133957}
[S15] START round=23 head_norm_before_train=1.154387 cos_to_last_merge=0.9957 (last merge round=21)
[S15] round=23 local utility u=0.086554 metrics={'f1_val': 0.2945463093559003, 'auprc': 0.2945463093559003, 'loss_val': 0.8282809479273703, 'psi': 0.2945463093559003}-{'f1_val': 0.2845763939174511, 'auprc': 0.2845763939174511, 'loss_val': 0.9116592909088375, 'psi': 0.2845763939174511}
[S16] START round=23 head_norm_before_train=1.739742 (no previous merge yet)
[S16] round=23 local utility u=0.252876 metrics={'f1_val': 0.13851672889669817, 'auprc': 0.13851672889669817, 'loss_val': 4.202490609325244, 'psi': 0.13851672889669817}-{'f1_val': 0.11131639722863741, 'auprc': 0.11131639722863741, 'loss_val': 4.463440525823867, 'psi': 0.1113163972286374}
[S17] START round=23 head_norm_before_train=1.643362 (no previous merge yet)
[S17] round=23 local utility u=0.228636 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 1.0537889110350798, 'psi': 0.20289293555469456}-{'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.056412000969408, 'psi': 0.15237633365664405}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39014
[S4] not sending this round → trigger blocked (psi=0.074)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:39005
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:39004
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39010
[S16] not sending this round → trigger blocked (psi=0.139)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39007
[S15] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S9
[S15] cosine check vs S9: cos=0.8045
[S5] RECEIVED delta(kind=head bytes=1806) from S8
[S5] cosine check vs S8: cos=0.9926
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9965
[S6] RECEIVED delta(kind=head bytes=1800) from S15
[S6] cosine check vs S15: cos=0.9099
[S5] RECEIVED delta(kind=head bytes=1804) from S11
[S5] cosine check vs S11: cos=0.0705
[S4] RECEIVED delta(kind=head bytes=1797) from S13
[S4] cosine check vs S13: cos=0.9858
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=0.9854
[S9] RECEIVED delta(kind=head bytes=1799) from S2
[S9] cosine check vs S2: cos=0.9526
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1807 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1807) from S17
[S16] cosine check vs S17: cos=0.0445
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.0010 head_norm=1.176257
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.543218e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.0000 head_norm=1.168044 delta_norm=0.254322
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.1357 head_norm=1.802305
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.564709e-02
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.1357 head_norm=1.792338 delta_norm=0.075647
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.0736 head_norm=1.642239
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.387360e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.2090 head_norm=1.611072 delta_norm=0.138736
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.3335 head_norm=1.690007
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.551946e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.3335 head_norm=1.386470 delta_norm=0.555195
[S5] aggregate: ACCEPT kept=['S8', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.1385 head_norm=1.751789
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.179549e+00
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.1393 head_norm=1.233200 delta_norm=1.179549
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.2945 head_norm=1.214261
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.174393e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.6254 head_norm=1.240825 delta_norm=0.417439
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.2653 head_norm=1.526209
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.306287e-01
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.2654 head_norm=1.520899 delta_norm=0.130629
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.3687 head_norm=1.397631
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.338272e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.3687 head_norm=1.444530 delta_norm=0.233827
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.520899 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.017565 metrics={'f1_val': 0.263544536271809, 'auprc': 0.263544536271809, 'loss_val': 1.5354806174667546, 'psi': 0.263544536271809}-{'f1_val': 0.26534522629666335, 'auprc': 0.26534522629666335, 'loss_val': 1.586816540427409, 'psi': 0.26534522629666335}
[S3] START round=24 head_norm_before_train=1.779878 (no previous merge yet)
[S3] round=24 local utility u=0.030189 metrics={'f1_val': 0.29104091144484723, 'auprc': 0.29104091144484723, 'loss_val': 3.070367560752875, 'psi': 0.29104091144484723}-{'f1_val': 0.2971074003102473, 'auprc': 0.2971074003102473, 'loss_val': 3.1853449547587274, 'psi': 0.2971074003102473}
[S4] START round=24 head_norm_before_train=1.611072 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=1.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3976975625906916, 'psi': 0.3567939207526687}-{'f1_val': 0.07357279194863786, 'auprc': 0.07357279194863786, 'loss_val': 1.4227440870049888, 'psi': 0.07357279194863786}
[S5] START round=24 head_norm_before_train=1.386470 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.087935 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6108456180456954, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7867161564176461, 'psi': 0.3335071121394324}
[S6] START round=24 head_norm_before_train=1.168044 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.065451 metrics={'f1_val': 0.003564638783269962, 'auprc': 0.003564638783269962, 'loss_val': 3.14744875151051, 'psi': 0.003564638783269962}-{'f1_val': 0.0009555661729574773, 'auprc': 0.0009555661729574773, 'loss_val': 3.254869078648382, 'psi': 0.0009555661729574773}
[S7] START round=24 head_norm_before_train=1.526788 (no previous merge yet)
[S7] round=24 local utility u=0.006817 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1449039778156045, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1585384190927661, 'psi': 0.35976373724718097}
[S8] START round=24 head_norm_before_train=1.799898 (no previous merge yet)
[S8] round=24 local utility u=0.002418 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7650067230708897, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7698431170224702, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.444530 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.24518636283342166, 'auprc': 0.24518636283342166, 'loss_val': 1.320884616745988, 'psi': 0.24518636283342166}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3385981464269974, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.785522 (no previous merge yet)
[S10] round=24 local utility u=0.012451 metrics={'f1_val': 0.3330146590184831, 'auprc': 0.3330146590184831, 'loss_val': 2.765981951038404, 'psi': 0.3330146590184831}-{'f1_val': 0.3330146590184831, 'auprc': 0.3330146590184831, 'loss_val': 2.790883469137147, 'psi': 0.3330146590184831}
[S11] START round=24 head_norm_before_train=1.752345 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 2.562589184775192, 'psi': 0.33162711338607104}-{'f1_val': 0.32088768930874195, 'auprc': 0.32088768930874195, 'loss_val': 2.2776047945757703, 'psi': 0.32088768930874195}
[S13] START round=24 head_norm_before_train=1.591432 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3363435320036223, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1286787051009655, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.792338 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 3.8332233646450358, 'psi': 0.1355297641332834}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.7839600706459704, 'psi': 0.13572854291417166}
[S15] START round=24 head_norm_before_train=1.240825 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.2845763939174511, 'auprc': 0.2845763939174511, 'loss_val': 0.9277458671114429, 'psi': 0.2845763939174511}-{'f1_val': 0.2945463093559003, 'auprc': 0.2945463093559003, 'loss_val': 0.8282809479273703, 'psi': 0.2945463093559003}
[S16] START round=24 head_norm_before_train=1.233200 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.708453 metrics={'f1_val': 0.1346607669616519, 'auprc': 0.1346607669616519, 'loss_val': 2.7508818806293704, 'psi': 0.1346607669616519}-{'f1_val': 0.13851672889669817, 'auprc': 0.13851672889669817, 'loss_val': 4.202490609325244, 'psi': 0.13851672889669817}
[S17] START round=24 head_norm_before_train=1.659962 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0310032932675888, 'psi': 0.152287708414114}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 1.0537889110350798, 'psi': 0.20289293555469456}
[S6] not sending this round → trigger blocked (psi=0.004)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[S16] not sending this round → trigger blocked (psi=0.135)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:39014
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39002
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:39010
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39005
[S2] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S2
[S9] cosine check vs S2: cos=0.9732
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] cosine check vs S4: cos=-0.1138
[S10] DROPPED delta from S4 (cos=-0.1138 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1805) from S10
[S14] cosine check vs S10: cos=0.9970
[S17] RECEIVED delta(kind=head bytes=1799) from S5
[S17] cosine check vs S5: cos=-0.0916
[S17] DROPPED delta from S5 (cos=-0.0916 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S7
[S2] cosine check vs S7: cos=0.9874
[S5] RECEIVED delta(kind=head bytes=1803) from S8
[S5] cosine check vs S8: cos=0.9352
[S8] RECEIVED delta(kind=head bytes=1802) from S3
[S8] cosine check vs S3: cos=-0.0906
[S8] DROPPED delta from S3 (cos=-0.0906 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.1355 head_norm=1.821620
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.052110e-02
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.1355 head_norm=1.810922 delta_norm=0.070521
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.2452 head_norm=1.482697
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.785637e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.3687 head_norm=1.506011 delta_norm=0.178564
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.2635 head_norm=1.549684
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.227647e-01
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.2614 head_norm=1.538170 delta_norm=0.122765
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.3335 head_norm=1.408798
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.558250e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.2498 head_norm=1.590885 delta_norm=0.355825
[S5] aggregate: ROLLBACK (f1_val pre=0.334 post=0.250 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.538170 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 1.5637855124779838, 'psi': 0.26542475888492534}-{'f1_val': 0.263544536271809, 'auprc': 0.263544536271809, 'loss_val': 1.5354806174667546, 'psi': 0.263544536271809}
[S3] START round=25 head_norm_before_train=1.794085 (no previous merge yet)
[S3] round=25 local utility u=0.018438 metrics={'f1_val': 0.2912912912912913, 'auprc': 0.2912912912912913, 'loss_val': 3.035745042411292, 'psi': 0.2912912912912913}-{'f1_val': 0.29104091144484723, 'auprc': 0.29104091144484723, 'loss_val': 3.070367560752875, 'psi': 0.29104091144484723}
[S4] START round=25 head_norm_before_train=1.638768 cos_to_last_merge=0.9992 (last merge round=23)
[S4] round=25 local utility u=0.019748 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3582011923005923, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3976975625906916, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.590885 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.773594236303936, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6108456180456954, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.207327 cos_to_last_merge=0.9951 (last merge round=23)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 3.566413039488823, 'psi': 0.017105871474803514}-{'f1_val': 0.003564638783269962, 'auprc': 0.003564638783269962, 'loss_val': 3.14744875151051, 'psi': 0.003564638783269962}
[S7] START round=25 head_norm_before_train=1.536410 (no previous merge yet)
[S7] round=25 local utility u=0.010551 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.123802910627857, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1449039778156045, 'psi': 0.35976373724718097}
[S8] START round=25 head_norm_before_train=1.824922 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.767908785627037, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7650067230708897, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.506011 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.568423 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.2954070516285237, 'psi': 0.36867172340800847}-{'f1_val': 0.24518636283342166, 'auprc': 0.24518636283342166, 'loss_val': 1.320884616745988, 'psi': 0.24518636283342166}
[S10] START round=25 head_norm_before_train=1.802920 (no previous merge yet)
[S10] round=25 local utility u=0.012576 metrics={'f1_val': 0.33301481127568083, 'auprc': 0.33301481127568083, 'loss_val': 2.740831600569112, 'psi': 0.33301481127568083}-{'f1_val': 0.3330146590184831, 'auprc': 0.3330146590184831, 'loss_val': 2.765981951038404, 'psi': 0.3330146590184831}
[S11] START round=25 head_norm_before_train=1.767355 (no previous merge yet)
[S11] round=25 local utility u=0.026741 metrics={'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.438632390918118, 'psi': 0.3237965485921889}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 2.562589184775192, 'psi': 0.33162711338607104}
[S13] START round=25 head_norm_before_train=1.599349 (no previous merge yet)
[S13] round=25 local utility u=0.026578 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2831884737439228, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3363435320036223, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.810922 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.865274530885517, 'psi': 0.13572854291417166}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 3.8332233646450358, 'psi': 0.1355297641332834}
[S15] START round=25 head_norm_before_train=1.283373 cos_to_last_merge=0.9962 (last merge round=23)
[S15] round=25 local utility u=0.028656 metrics={'f1_val': 0.2845763939174511, 'auprc': 0.2845763939174511, 'loss_val': 0.8704347443175283, 'psi': 0.2845763939174511}-{'f1_val': 0.2845763939174511, 'auprc': 0.2845763939174511, 'loss_val': 0.9277458671114429, 'psi': 0.2845763939174511}
[S16] START round=25 head_norm_before_train=1.263473 cos_to_last_merge=0.9991 (last merge round=23)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.048625429553264606, 'auprc': 0.048625429553264606, 'loss_val': 3.5398197335162935, 'psi': 0.048625429553264606}-{'f1_val': 0.1346607669616519, 'auprc': 0.1346607669616519, 'loss_val': 2.7508818806293704, 'psi': 0.1346607669616519}
[S17] START round=25 head_norm_before_train=1.672154 (no previous merge yet)
[S17] round=25 local utility u=0.012474 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0060558400270705, 'psi': 0.152287708414114}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0310032932675888, 'psi': 0.152287708414114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39002
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:39009
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:39007
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] cosine check vs S11: cos=0.1670
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] cosine check vs S9: cos=0.8681
[S8] RECEIVED delta(kind=head bytes=1805) from S3
[S8] cosine check vs S3: cos=-0.0913
[S8] DROPPED delta from S3 (cos=-0.0913 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=-0.1093
[S10] DROPPED delta from S4 (cos=-0.1093 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S7
[S2] cosine check vs S7: cos=0.9890
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9975
[S4] RECEIVED delta(kind=head bytes=1794) from S13
[S4] cosine check vs S13: cos=0.9865
[S6] RECEIVED delta(kind=head bytes=1804) from S15
[S6] cosine check vs S15: cos=0.8795
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S17
[S16] cosine check vs S17: cos=0.6596
[S8] ⇄ pheromone p=0.126 → S5@127.0.0.1:39005
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=25 metric=0.2654 head_norm=1.566968
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.157667e-01
[S2] stored merged vector for next round verification (round=25)
[S2] DEBUG after merge:  round=25 metric=0.2654 head_norm=1.552278 delta_norm=0.115767
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.047 → S9@127.0.0.1:39010
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.3335 head_norm=1.616111
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.097334e+00
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.3335 head_norm=1.297853 delta_norm=1.097334
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.082 → S17@127.0.0.1:39017
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.0171 head_norm=1.258522
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.195966e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.0017 head_norm=1.254826 delta_norm=0.319597
[S6] aggregate: ROLLBACK (f1_val pre=0.017 post=0.002 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.075 → S17@127.0.0.1:39017
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.1357 head_norm=1.838218
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.525499e-02
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.1357 head_norm=1.827597 delta_norm=0.065255
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.066 → S17@127.0.0.1:39017
[S9] ⇄ pheromone p=0.202 → S15@127.0.0.1:39015
[S3] ⇄ pheromone p=0.036 → S8@127.0.0.1:39009
[S7] ⇄ pheromone p=0.054 → S2@127.0.0.1:39002
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.3568 head_norm=1.673319
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.385378e-01
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.3568 head_norm=1.635059 delta_norm=0.138538
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.215 → S10@127.0.0.1:39011
[S11] ⇄ pheromone p=0.043 → S5@127.0.0.1:39005
[S10] ⇄ pheromone p=0.072 → S14@127.0.0.1:39014
[S13] ⇄ pheromone p=0.070 → S4@127.0.0.1:39004
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.2846 head_norm=1.330256
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.825754e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.6171 head_norm=1.387893 delta_norm=0.382575
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.056 → S6@127.0.0.1:39007
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.0486 head_norm=1.313277
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.403893e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.0489 head_norm=1.366549 delta_norm=0.640389
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.188 → S7@127.0.0.1:39008
[S17] ⇄ pheromone p=0.065 → S16@127.0.0.1:39016
[S2] START round=26 head_norm_before_train=1.552278 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.2558420885068449, 'auprc': 0.2558420885068449, 'loss_val': 1.4926789374064837, 'psi': 0.2558420885068449}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 1.5637855124779838, 'psi': 0.26542475888492534}
[S3] START round=26 head_norm_before_train=1.806724 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.29666029666029664, 'auprc': 0.29666029666029664, 'loss_val': 3.249150661378223, 'psi': 0.29666029666029664}-{'f1_val': 0.2912912912912913, 'auprc': 0.2912912912912913, 'loss_val': 3.035745042411292, 'psi': 0.2912912912912913}
[S4] START round=26 head_norm_before_train=1.635059 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.026001 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.306200018333085, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3582011923005923, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.297853 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.183350 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.4068933219739075, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.773594236303936, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.254826 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 3.48751367865395, 'psi': 0.002619047619047619}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 3.566413039488823, 'psi': 0.017105871474803514}
[S7] START round=26 head_norm_before_train=1.546140 (no previous merge yet)
[S7] round=26 local utility u=0.005909 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1119842026644409, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.123802910627857, 'psi': 0.35976373724718097}
[S8] START round=26 head_norm_before_train=1.847665 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7761361254326864, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.767908785627037, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.541310 cos_to_last_merge=0.9968 (last merge round=24)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3343694544567861, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.2954070516285237, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.819256 (no previous merge yet)
[S10] round=26 local utility u=0.005977 metrics={'f1_val': 0.33293508562325763, 'auprc': 0.33293508562325763, 'loss_val': 2.728160665065015, 'psi': 0.33293508562325763}-{'f1_val': 0.33301481127568083, 'auprc': 0.33301481127568083, 'loss_val': 2.740831600569112, 'psi': 0.33301481127568083}
[S11] START round=26 head_norm_before_train=1.779132 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.5086145418629138, 'psi': 0.3240172688025449}-{'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.438632390918118, 'psi': 0.3237965485921889}
[S13] START round=26 head_norm_before_train=1.607863 (no previous merge yet)
[S13] round=26 local utility u=0.000988 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2812130588855946, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2831884737439228, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.827597 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.12560386473429952, 'auprc': 0.12560386473429952, 'loss_val': 3.926115861116562, 'psi': 0.12560386473429952}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.865274530885517, 'psi': 0.13572854291417166}
[S15] START round=26 head_norm_before_train=1.387893 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=1.000000 metrics={'f1_val': 0.626694965216366, 'auprc': 0.626694965216366, 'loss_val': 0.765200526658562, 'psi': 0.626694965216366}-{'f1_val': 0.2845763939174511, 'auprc': 0.2845763939174511, 'loss_val': 0.8704347443175283, 'psi': 0.2845763939174511}
[S16] START round=26 head_norm_before_train=1.366549 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.641409 metrics={'f1_val': 0.09143130684538057, 'auprc': 0.09143130684538057, 'loss_val': 2.6422541211114883, 'psi': 0.09143130684538057}-{'f1_val': 0.048625429553264606, 'auprc': 0.048625429553264606, 'loss_val': 3.5398197335162935, 'psi': 0.048625429553264606}
[S17] START round=26 head_norm_before_train=1.682383 (no previous merge yet)
[S17] round=26 local utility u=0.243597 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9743087950385628, 'psi': 0.20289293555469456}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0060558400270705, 'psi': 0.152287708414114}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:39017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.091)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39014
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39011
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:39004
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1807 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=0.9979
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] cosine check vs S4: cos=-0.1119
[S10] DROPPED delta from S4 (cos=-0.1119 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1806) from S15
[S6] cosine check vs S15: cos=0.9002
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] cosine check vs S13: cos=0.9923
[S17] RECEIVED delta(kind=head bytes=1807) from S5
[S17] cosine check vs S5: cos=-0.1091
[S17] DROPPED delta from S5 (cos=-0.1091 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S7
[S2] cosine check vs S7: cos=0.9913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=0.9028
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.0026 head_norm=1.292218
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.098311e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.0000 head_norm=1.323153 delta_norm=0.309831
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=26 metric=0.2558 head_norm=1.583464
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.041392e-01
[S2] stored merged vector for next round verification (round=26)
[S2] DEBUG after merge:  round=26 metric=0.2545 head_norm=1.566783 delta_norm=0.104139
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.1256 head_norm=1.853050
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.089329e-02
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.1268 head_norm=1.844246 delta_norm=0.060893
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.0914 head_norm=1.407229
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.693400e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.0917 head_norm=1.512833 delta_norm=0.369340
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.3568 head_norm=1.665757
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.046708e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.3568 head_norm=1.638033 delta_norm=0.104671
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.566783 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.5858419521269487, 'psi': 0.2653978324081417}-{'f1_val': 0.2558420885068449, 'auprc': 0.2558420885068449, 'loss_val': 1.4926789374064837, 'psi': 0.2558420885068449}
[S3] START round=27 head_norm_before_train=1.819151 (no previous merge yet)
[S3] round=27 local utility u=0.029114 metrics={'f1_val': 0.2959048877146631, 'auprc': 0.2959048877146631, 'loss_val': 3.184123797816913, 'psi': 0.2959048877146631}-{'f1_val': 0.29666029666029664, 'auprc': 0.29666029666029664, 'loss_val': 3.249150661378223, 'psi': 0.29666029666029664}
[S4] START round=27 head_norm_before_train=1.638033 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.014055 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.27809094434117, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.306200018333085, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.318724 cos_to_last_merge=0.9988 (last merge round=25)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.5538460244662966, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.4068933219739075, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.323153 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.086710 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 3.4484908171594677, 'psi': 0.017551963048498844}-{'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 3.48751367865395, 'psi': 0.002619047619047619}
[S7] START round=27 head_norm_before_train=1.556903 (no previous merge yet)
[S7] round=27 local utility u=0.007542 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0969004887953708, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1119842026644409, 'psi': 0.35976373724718097}
[S8] START round=27 head_norm_before_train=1.872312 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7902459512383395, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7761361254326864, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.585289 cos_to_last_merge=0.9887 (last merge round=24)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.370426009092488, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3343694544567861, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.837420 (no previous merge yet)
[S10] round=27 local utility u=0.012633 metrics={'f1_val': 0.33301481127568083, 'auprc': 0.33301481127568083, 'loss_val': 2.7036113608784627, 'psi': 0.33301481127568083}-{'f1_val': 0.33293508562325763, 'auprc': 0.33293508562325763, 'loss_val': 2.728160665065015, 'psi': 0.33293508562325763}
[S11] START round=27 head_norm_before_train=1.788720 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.562400630847453, 'psi': 0.3240909090909091}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.5086145418629138, 'psi': 0.3240172688025449}
[S13] START round=27 head_norm_before_train=1.616622 (no previous merge yet)
[S13] round=27 local utility u=0.102694 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0758244009856273, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2812130588855946, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.844246 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.12081569834551752, 'auprc': 0.12081569834551752, 'loss_val': 3.9792963407886295, 'psi': 0.12081569834551753}-{'f1_val': 0.12560386473429952, 'auprc': 0.12560386473429952, 'loss_val': 3.926115861116562, 'psi': 0.12560386473429952}
[S15] START round=27 head_norm_before_train=1.422544 cos_to_last_merge=0.9976 (last merge round=25)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6176081002319632, 'auprc': 0.6176081002319632, 'loss_val': 0.7862358108708103, 'psi': 0.6176081002319632}-{'f1_val': 0.626694965216366, 'auprc': 0.626694965216366, 'loss_val': 0.765200526658562, 'psi': 0.626694965216366}
[S16] START round=27 head_norm_before_train=1.512833 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.177199 metrics={'f1_val': 0.11348822943025842, 'auprc': 0.11348822943025842, 'loss_val': 2.486369113573183, 'psi': 0.11348822943025842}-{'f1_val': 0.09143130684538057, 'auprc': 0.09143130684538057, 'loss_val': 2.6422541211114883, 'psi': 0.09143130684538057}
[S17] START round=27 head_norm_before_train=1.694065 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 0.939159541406845, 'psi': 0.152287708414114}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9743087950385628, 'psi': 0.20289293555469456}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:39016
[S16] not sending this round → trigger blocked (psi=0.113)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S10] → sending delta(kind=head bytes=1809) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:39013
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1809 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S4
[S13] cosine check vs S4: cos=0.9945
[S16] RECEIVED delta(kind=head bytes=1803) from S7
[S16] cosine check vs S7: cos=-0.0377
[S16] DROPPED delta from S7 (cos=-0.0377 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1809) from S10
[S4] cosine check vs S10: cos=-0.1132
[S4] DROPPED delta from S10 (cos=-0.1132 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.3599 head_norm=1.623140
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.888778e-02
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.3599 head_norm=1.643543 delta_norm=0.088888
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.598820 cos_to_last_merge=0.9987 (last merge round=26)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.24837953385739897, 'auprc': 0.24837953385739897, 'loss_val': 1.819128710563071, 'psi': 0.24837953385739897}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.5858419521269487, 'psi': 0.2653978324081417}
[S3] START round=28 head_norm_before_train=1.830947 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.2939821214634596, 'auprc': 0.2939821214634596, 'loss_val': 3.4028060979324506, 'psi': 0.2939821214634596}-{'f1_val': 0.2959048877146631, 'auprc': 0.2959048877146631, 'loss_val': 3.184123797816913, 'psi': 0.2959048877146631}
[S4] START round=28 head_norm_before_train=1.668439 cos_to_last_merge=0.9991 (last merge round=26)
[S4] round=28 local utility u=0.006358 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2653751536077913, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.27809094434117, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.343439 cos_to_last_merge=0.9954 (last merge round=25)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7211276366416592, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.5538460244662966, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.356360 cos_to_last_merge=0.9976 (last merge round=26)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 3.89830455364763, 'psi': 0.01732902033271719}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 3.4484908171594677, 'psi': 0.017551963048498844}
[S7] START round=28 head_norm_before_train=1.568381 (no previous merge yet)
[S7] round=28 local utility u=0.006546 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0838075020783247, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0969004887953708, 'psi': 0.35976373724718097}
[S8] START round=28 head_norm_before_train=1.897774 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8053206801777056, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7902459512383395, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.627940 cos_to_last_merge=0.9797 (last merge round=24)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4812241487848379, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.370426009092488, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.852642 (no previous merge yet)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.24970131421744324, 'auprc': 0.24970131421744324, 'loss_val': 2.6921561083690815, 'psi': 0.24970131421744324}-{'f1_val': 0.33301481127568083, 'auprc': 0.33301481127568083, 'loss_val': 2.7036113608784627, 'psi': 0.33301481127568083}
[S11] START round=28 head_norm_before_train=1.799034 (no previous merge yet)
[S11] round=28 local utility u=0.006314 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.5491091726720447, 'psi': 0.3240172688025449}-{'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.562400630847453, 'psi': 0.3240909090909091}
[S13] START round=28 head_norm_before_train=1.643543 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2013715691053843, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0758244009856273, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.868139 cos_to_last_merge=0.9996 (last merge round=26)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.190389698315042, 'psi': 0.13333333333333333}-{'f1_val': 0.12081569834551752, 'auprc': 0.12081569834551752, 'loss_val': 3.9792963407886295, 'psi': 0.12081569834551753}
[S15] START round=28 head_norm_before_train=1.461678 cos_to_last_merge=0.9918 (last merge round=25)
[S15] round=28 local utility u=0.084762 metrics={'f1_val': 0.6184931595691743, 'auprc': 0.6184931595691743, 'loss_val': 0.6246783022427917, 'psi': 0.6184931595691743}-{'f1_val': 0.6176081002319632, 'auprc': 0.6176081002319632, 'loss_val': 0.7862358108708103, 'psi': 0.6176081002319632}
[S16] START round=28 head_norm_before_train=1.546901 cos_to_last_merge=0.9941 (last merge round=26)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.047348484848484855, 'auprc': 0.047348484848484855, 'loss_val': 3.256855251630137, 'psi': 0.047348484848484855}-{'f1_val': 0.11348822943025842, 'auprc': 0.11348822943025842, 'loss_val': 2.486369113573183, 'psi': 0.11348822943025842}
[S17] START round=28 head_norm_before_train=1.710948 (no previous merge yet)
[S17] round=28 local utility u=0.246435 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.901737206389488, 'psi': 0.20289293555469456}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 0.939159541406845, 'psi': 0.152287708414114}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:39016
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:39013
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S4
[S13] cosine check vs S4: cos=0.9962
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=0.9380
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=-0.0272
[S16] DROPPED delta from S7 (cos=-0.0272 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39005
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] cosine check vs S17: cos=-0.1033
[S5] DROPPED delta from S17 (cos=-0.1033 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.3599 head_norm=1.650541
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.703121e-02
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.3599 head_norm=1.673980 delta_norm=0.077031
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.3687 head_norm=1.664556
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.899584e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.3687 head_norm=1.558464 delta_norm=0.289958
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.629609 cos_to_last_merge=0.9959 (last merge round=26)
[S2] round=29 local utility u=0.075701 metrics={'f1_val': 0.2455690013445789, 'auprc': 0.2455690013445789, 'loss_val': 1.6424326690356732, 'psi': 0.24556900134457893}-{'f1_val': 0.24837953385739897, 'auprc': 0.24837953385739897, 'loss_val': 1.819128710563071, 'psi': 0.24837953385739897}
[S3] START round=29 head_norm_before_train=1.841974 (no previous merge yet)
[S3] round=29 local utility u=0.079391 metrics={'f1_val': 0.2914720636568068, 'auprc': 0.2914720636568068, 'loss_val': 3.221433088221532, 'psi': 0.2914720636568068}-{'f1_val': 0.2939821214634596, 'auprc': 0.2939821214634596, 'loss_val': 3.4028060979324506, 'psi': 0.2939821214634596}
[S4] START round=29 head_norm_before_train=1.700587 cos_to_last_merge=0.9970 (last merge round=26)
[S4] round=29 local utility u=0.001221 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2629323903229417, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2653751536077913, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.364903 cos_to_last_merge=0.9918 (last merge round=25)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.740214996882863, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7211276366416592, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.392162 cos_to_last_merge=0.9919 (last merge round=26)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 4.2714642927746675, 'psi': 0.017105871474803514}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 3.89830455364763, 'psi': 0.01732902033271719}
[S7] START round=29 head_norm_before_train=1.582349 (no previous merge yet)
[S7] round=29 local utility u=0.005731 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.072345471921261, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0838075020783247, 'psi': 0.35976373724718097}
[S8] START round=29 head_norm_before_train=1.920573 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8198486256608274, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8053206801777056, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.558464 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5088859396773089, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4812241487848379, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.867224 (no previous merge yet)
[S10] round=29 local utility u=0.005377 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.680865466899129, 'psi': 0.24964166268514096}-{'f1_val': 0.24970131421744324, 'auprc': 0.24970131421744324, 'loss_val': 2.6921561083690815, 'psi': 0.24970131421744324}
[S11] START round=29 head_norm_before_train=1.811703 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.3245334547109695, 'auprc': 0.3245334547109695, 'loss_val': 2.649755383293883, 'psi': 0.3245334547109695}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.5491091726720447, 'psi': 0.3240172688025449}
[S13] START round=29 head_norm_before_train=1.673980 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2789209599022642, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2013715691053843, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.890495 cos_to_last_merge=0.9988 (last merge round=26)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 4.386526519008796, 'psi': 0.13533083645443197}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.190389698315042, 'psi': 0.13333333333333333}
[S15] START round=29 head_norm_before_train=1.501675 cos_to_last_merge=0.9849 (last merge round=25)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6171679436988167, 'auprc': 0.6171679436988167, 'loss_val': 0.7017310969237539, 'psi': 0.6171679436988167}-{'f1_val': 0.6184931595691743, 'auprc': 0.6184931595691743, 'loss_val': 0.6246783022427917, 'psi': 0.6184931595691743}
[S16] START round=29 head_norm_before_train=1.598741 cos_to_last_merge=0.9791 (last merge round=26)
[S16] round=29 local utility u=0.430719 metrics={'f1_val': 0.11977863694943523, 'auprc': 0.11977863694943523, 'loss_val': 3.047288610122929, 'psi': 0.11977863694943523}-{'f1_val': 0.047348484848484855, 'auprc': 0.047348484848484855, 'loss_val': 3.256855251630137, 'psi': 0.047348484848484855}
[S17] START round=29 head_norm_before_train=1.728989 (no previous merge yet)
[S17] round=29 local utility u=0.013839 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8740587449122545, 'psi': 0.20289293555469456}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.901737206389488, 'psi': 0.20289293555469456}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:39008
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:39013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:39016
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:39004
[S16] not sending this round → trigger blocked (psi=0.120)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1806 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1806) from S2
[S7] cosine check vs S2: cos=0.9822
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=-0.0215
[S16] DROPPED delta from S7 (cos=-0.0215 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=-0.1076
[S4] DROPPED delta from S10 (cos=-0.1076 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S4
[S13] cosine check vs S4: cos=0.9977
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39005
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S17
[S5] cosine check vs S17: cos=-0.1015
[S5] DROPPED delta from S17 (cos=-0.1015 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.3599 head_norm=1.685222
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.063716e-02
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.3599 head_norm=1.703374 delta_norm=0.060637
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.3598 head_norm=1.595495
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.564655e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.3598 head_norm=1.619210 delta_norm=0.156466
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.657420 cos_to_last_merge=0.9928 (last merge round=26)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.26205241048209643, 'auprc': 0.26205241048209643, 'loss_val': 1.9121557316942082, 'psi': 0.26205241048209643}-{'f1_val': 0.2455690013445789, 'auprc': 0.2455690013445789, 'loss_val': 1.6424326690356732, 'psi': 0.24556900134457893}
[S3] START round=30 head_norm_before_train=1.852244 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.294188081422124, 'auprc': 0.294188081422124, 'loss_val': 3.4829311649663053, 'psi': 0.294188081422124}-{'f1_val': 0.2914720636568068, 'auprc': 0.2914720636568068, 'loss_val': 3.221433088221532, 'psi': 0.2914720636568068}
[S4] START round=30 head_norm_before_train=1.723469 cos_to_last_merge=0.9952 (last merge round=26)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2635202526385063, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2629323903229417, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.383723 cos_to_last_merge=0.9887 (last merge round=25)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8015337959845006, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.740214996882863, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.427877 cos_to_last_merge=0.9849 (last merge round=26)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.004976303317535545, 'auprc': 0.004976303317535545, 'loss_val': 4.578215946308235, 'psi': 0.004976303317535545}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 4.2714642927746675, 'psi': 0.017105871474803514}
[S7] START round=30 head_norm_before_train=1.619210 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0737419880189942, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.072345471921261, 'psi': 0.35976373724718097}
[S8] START round=30 head_norm_before_train=1.942061 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8352314797458914, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8198486256608274, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.589344 cos_to_last_merge=0.9996 (last merge round=28)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5630613884406466, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5088859396773089, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.886876 (no previous merge yet)
[S10] round=30 local utility u=0.002881 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.6751028907874956, 'psi': 0.24964166268514096}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.680865466899129, 'psi': 0.24964166268514096}
[S11] START round=30 head_norm_before_train=1.824984 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3290243151738997, 'auprc': 0.3290243151738997, 'loss_val': 2.701496925419814, 'psi': 0.3290243151738997}-{'f1_val': 0.3245334547109695, 'auprc': 0.3245334547109695, 'loss_val': 2.649755383293883, 'psi': 0.3245334547109695}
[S13] START round=30 head_norm_before_train=1.703374 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3478469791917889, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2789209599022642, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.910841 cos_to_last_merge=0.9977 (last merge round=26)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 4.553051041520593, 'psi': 0.1345336334083521}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 4.386526519008796, 'psi': 0.13533083645443197}
[S15] START round=30 head_norm_before_train=1.542184 cos_to_last_merge=0.9777 (last merge round=25)
[S15] round=30 local utility u=0.073210 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.5590496129604828, 'psi': 0.6175834097438502}-{'f1_val': 0.6171679436988167, 'auprc': 0.6171679436988167, 'loss_val': 0.7017310969237539, 'psi': 0.6171679436988167}
[S16] START round=30 head_norm_before_train=1.649575 cos_to_last_merge=0.9645 (last merge round=26)
[S16] round=30 local utility u=0.550245 metrics={'f1_val': 0.17721690752425537, 'auprc': 0.17721690752425537, 'loss_val': 2.463743303297049, 'psi': 0.17721690752425537}-{'f1_val': 0.11977863694943523, 'auprc': 0.11977863694943523, 'loss_val': 3.047288610122929, 'psi': 0.11977863694943523}
[S17] START round=30 head_norm_before_train=1.744693 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.8468540092250767, 'psi': 0.15222868217054264}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8740587449122545, 'psi': 0.20289293555469456}
[S16] not sending this round → trigger blocked (psi=0.177)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:39010
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:39004
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S15
[S9] cosine check vs S15: cos=0.9676
[S4] RECEIVED delta(kind=head bytes=1794) from S10
[S4] cosine check vs S10: cos=-0.1039
[S4] DROPPED delta from S10 (cos=-0.1039 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.021 → S16@127.0.0.1:39016
[S4] ⇄ pheromone p=0.075 → S13@127.0.0.1:39013
[S14] ⇄ pheromone p=0.022 → S10@127.0.0.1:39011
[S5] ⇄ pheromone p=0.042 → S8@127.0.0.1:39009
[S6] ⇄ pheromone p=0.033 → S15@127.0.0.1:39015
[S8] ⇄ pheromone p=0.041 → S3@127.0.0.1:39003
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.3687 head_norm=1.615460
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.040011e-01
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.3687 head_norm=1.584895 delta_norm=0.204001
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.066 → S2@127.0.0.1:39002
[S2] ⇄ pheromone p=0.027 → S7@127.0.0.1:39008
[S16] ⇄ pheromone p=0.311 → S17@127.0.0.1:39017
[S10] ⇄ pheromone p=0.027 → S4@127.0.0.1:39004
[S15] ⇄ pheromone p=0.126 → S9@127.0.0.1:39010
[S17] ⇄ pheromone p=0.075 → S16@127.0.0.1:39016
[S2] START round=31 head_norm_before_train=1.682491 cos_to_last_merge=0.9899 (last merge round=26)
[S2] round=31 local utility u=0.044955 metrics={'f1_val': 0.2528475237555849, 'auprc': 0.2528475237555849, 'loss_val': 1.7394013004133968, 'psi': 0.2528475237555849}-{'f1_val': 0.26205241048209643, 'auprc': 0.26205241048209643, 'loss_val': 1.9121557316942082, 'psi': 0.26205241048209643}
[S3] START round=31 head_norm_before_train=1.861867 (no previous merge yet)
[S3] round=31 local utility u=0.059476 metrics={'f1_val': 0.29687924016282224, 'auprc': 0.29687924016282224, 'loss_val': 3.3881987942855525, 'psi': 0.29687924016282224}-{'f1_val': 0.294188081422124, 'auprc': 0.294188081422124, 'loss_val': 3.4829311649663053, 'psi': 0.294188081422124}
[S4] START round=31 head_norm_before_train=1.746582 cos_to_last_merge=0.9934 (last merge round=26)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2649603973814803, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2635202526385063, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.411208 cos_to_last_merge=0.9846 (last merge round=25)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8201490854181317, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8015337959845006, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=1.463315 cos_to_last_merge=0.9775 (last merge round=26)
[S6] round=31 local utility u=0.010764 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.671873998114912, 'psi': 0.017774699907663897}-{'f1_val': 0.004976303317535545, 'auprc': 0.004976303317535545, 'loss_val': 4.578215946308235, 'psi': 0.004976303317535545}
[S7] START round=31 head_norm_before_train=1.632568 cos_to_last_merge=0.9999 (last merge round=29)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0741821262526396, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0737419880189942, 'psi': 0.35976373724718097}
[S8] START round=31 head_norm_before_train=1.961748 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8435282088623315, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8352314797458914, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.584895 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5848599317188916, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5630613884406466, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.909109 (no previous merge yet)
[S10] round=31 local utility u=0.002929 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.6692439756411295, 'psi': 0.24964166268514096}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.6751028907874956, 'psi': 0.24964166268514096}
[S11] START round=31 head_norm_before_train=1.837670 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.32416458285974087, 'auprc': 0.32416458285974087, 'loss_val': 2.6757665531335015, 'psi': 0.32416458285974087}-{'f1_val': 0.3290243151738997, 'auprc': 0.3290243151738997, 'loss_val': 2.701496925419814, 'psi': 0.3290243151738997}
[S13] START round=31 head_norm_before_train=1.712626 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=31 local utility u=0.058528 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2307903993945277, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3478469791917889, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.928750 cos_to_last_merge=0.9965 (last merge round=26)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.685725670012051, 'psi': 0.13333333333333333}-{'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 4.553051041520593, 'psi': 0.1345336334083521}
[S15] START round=31 head_norm_before_train=1.580287 cos_to_last_merge=0.9711 (last merge round=25)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6181610530870998, 'auprc': 0.6181610530870998, 'loss_val': 0.5768155051747869, 'psi': 0.6181610530870998}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.5590496129604828, 'psi': 0.6175834097438502}
[S16] START round=31 head_norm_before_train=1.692784 cos_to_last_merge=0.9531 (last merge round=26)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.15731130410223823, 'auprc': 0.15731130410223823, 'loss_val': 3.037951478410547, 'psi': 0.15731130410223823}-{'f1_val': 0.17721690752425537, 'auprc': 0.17721690752425537, 'loss_val': 2.463743303297049, 'psi': 0.17721690752425537}
[S17] START round=31 head_norm_before_train=1.759008 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.15216970166602092, 'auprc': 0.15216970166602092, 'loss_val': 0.847909127247033, 'psi': 0.15216970166602092}-{'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.8468540092250767, 'psi': 0.15222868217054264}
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S8
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S16
[S6]  timeout peer S17
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:39010
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:39004
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39009
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:39004
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S13
[S4] cosine check vs S13: cos=0.9977
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=-0.1009
[S4] DROPPED delta from S10 (cos=-0.1009 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S2
[S9] cosine check vs S2: cos=0.8698
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] cosine check vs S3: cos=-0.0901
[S8] DROPPED delta from S3 (cos=-0.0901 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.3568 head_norm=1.768331
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.423892e-02
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.3568 head_norm=1.742829 delta_norm=0.064239
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.3687 head_norm=1.606500
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.250576e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.3687 head_norm=1.600796 delta_norm=0.425058
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S2] START round=32 head_norm_before_train=1.704583 cos_to_last_merge=0.9872 (last merge round=26)
[S2] round=32 local utility u=0.474898 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.8212755630288513, 'psi': 0.3674775928297055}-{'f1_val': 0.2528475237555849, 'auprc': 0.2528475237555849, 'loss_val': 1.7394013004133968, 'psi': 0.2528475237555849}
[S3] START round=32 head_norm_before_train=1.870978 (no previous merge yet)
[S3] round=32 local utility u=0.048815 metrics={'f1_val': 0.2877673514244653, 'auprc': 0.2877673514244653, 'loss_val': 3.208561666566915, 'psi': 0.2877673514244653}-{'f1_val': 0.29687924016282224, 'auprc': 0.29687924016282224, 'loss_val': 3.3881987942855525, 'psi': 0.29687924016282224}
[S4] START round=32 head_norm_before_train=1.742829 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.000490 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2639809775047997, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2649603973814803, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.441807 cos_to_last_merge=0.9800 (last merge round=25)
[S5] round=32 local utility u=0.003788 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8125734099965696, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8201490854181317, 'psi': 0.3335071121394324}
[S6] START round=32 head_norm_before_train=1.492153 cos_to_last_merge=0.9712 (last merge round=26)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.0016698473282442748, 'auprc': 0.0016698473282442748, 'loss_val': 4.9595014435235, 'psi': 0.0016698473282442746}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.671873998114912, 'psi': 0.017774699907663897}
[S7] START round=32 head_norm_before_train=1.646246 cos_to_last_merge=0.9996 (last merge round=29)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0744705223702478, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0741821262526396, 'psi': 0.35976373724718097}
[S8] START round=32 head_norm_before_train=1.981029 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8560826532756237, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8435282088623315, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.600796 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.057069 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.470722542865575, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5848599317188916, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=1.935599 (no previous merge yet)
[S10] round=32 local utility u=0.002433 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.664378685860012, 'psi': 0.24964166268514096}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.6692439756411295, 'psi': 0.24964166268514096}
[S11] START round=32 head_norm_before_train=1.849837 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.7670170788833968, 'psi': 0.33154997286190585}-{'f1_val': 0.32416458285974087, 'auprc': 0.32416458285974087, 'loss_val': 2.6757665531335015, 'psi': 0.32416458285974087}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.719350 cos_to_last_merge=0.9999 (last merge round=29)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3671744492342772, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2307903993945277, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.944803 cos_to_last_merge=0.9953 (last merge round=26)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 4.793881420457109, 'psi': 0.13413413413413414}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.685725670012051, 'psi': 0.13333333333333333}
[S15] START round=32 head_norm_before_train=1.612346 cos_to_last_merge=0.9657 (last merge round=25)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6162055819341677, 'auprc': 0.6162055819341677, 'loss_val': 0.5753816181033038, 'psi': 0.6162055819341677}-{'f1_val': 0.6181610530870998, 'auprc': 0.6181610530870998, 'loss_val': 0.5768155051747869, 'psi': 0.6181610530870998}
[S16] START round=32 head_norm_before_train=1.728456 cos_to_last_merge=0.9444 (last merge round=26)
[S16] ⚠️ Model drifted since last merge! cos=0.944
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.12287049600482436, 'auprc': 0.12287049600482436, 'loss_val': 3.7944517831383697, 'psi': 0.12287049600482436}-{'f1_val': 0.15731130410223823, 'auprc': 0.15731130410223823, 'loss_val': 3.037951478410547, 'psi': 0.15731130410223823}
[S17] START round=32 head_norm_before_train=1.776973 (no previous merge yet)
[S17] round=32 local utility u=0.033933 metrics={'f1_val': 0.1577311786507849, 'auprc': 0.1577311786507849, 'loss_val': 0.8300968131512635, 'psi': 0.1577311786507849}-{'f1_val': 0.15216970166602092, 'auprc': 0.15216970166602092, 'loss_val': 0.847909127247033, 'psi': 0.15216970166602092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39009
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:39013
[S8] RECEIVED delta(kind=head bytes=1802) from S3
[S8] cosine check vs S3: cos=-0.0893
[S8] DROPPED delta from S3 (cos=-0.0893 < 0.0)
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=-0.1003
[S4] DROPPED delta from S10 (cos=-0.1003 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S5
[S8] cosine check vs S5: cos=0.6735
[S13] RECEIVED delta(kind=head bytes=1795) from S4
[S13] cosine check vs S4: cos=0.9987
[S9] RECEIVED delta(kind=head bytes=1804) from S2
[S9] cosine check vs S2: cos=0.9644
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.3594 head_norm=1.999933
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.417210e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.3594 head_norm=1.590423 delta_norm=0.741721
[S8] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:39015
[S9] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S9
[S15] cosine check vs S9: cos=0.9310
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.3687 head_norm=1.622772
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.288236e-01
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.3687 head_norm=1.658464 delta_norm=0.228824
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] RoundReady barrier timeout: have=1 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] cosine check vs S17: cos=0.8543
[S5]  timeout peer S8
[S5]  timeout peer S11
[S6]  timeout peer S15
[S9]  timeout peer S2
[S15]  timeout peer S9
[S8]  timeout peer S3
[S14]  timeout peer S10
[S10]  timeout peer S4
[S4]  timeout peer S13
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S14
[S7]  timeout peer S16
[S2]  timeout peer S7
[S2] START round=33 head_norm_before_train=1.724046 cos_to_last_merge=0.9848 (last merge round=26)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.26534522629666335, 'auprc': 0.26534522629666335, 'loss_val': 1.970856668118353, 'psi': 0.26534522629666335}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.8212755630288513, 'psi': 0.3674775928297055}
[S3] START round=33 head_norm_before_train=1.879882 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.2939821214634596, 'auprc': 0.2939821214634596, 'loss_val': 3.5557665246862675, 'psi': 0.2939821214634596}-{'f1_val': 0.2877673514244653, 'auprc': 0.2877673514244653, 'loss_val': 3.208561666566915, 'psi': 0.2877673514244653}
[S4] START round=33 head_norm_before_train=1.764221 cos_to_last_merge=0.9999 (last merge round=31)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2665538795618116, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2639809775047997, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.469508 cos_to_last_merge=0.9759 (last merge round=25)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 1.8289525857263502, 'psi': 0.2501303341045743}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8125734099965696, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.516345 cos_to_last_merge=0.9661 (last merge round=26)
[S6] round=33 local utility u=0.133199 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.838047008408248, 'psi': 0.017774699907663897}-{'f1_val': 0.0016698473282442748, 'auprc': 0.0016698473282442748, 'loss_val': 4.9595014435235, 'psi': 0.0016698473282442746}
[S6] not sending this round → trigger blocked (psi=0.018)
[S7] START round=33 head_norm_before_train=1.663494 cos_to_last_merge=0.9991 (last merge round=29)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0780439296246165, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0744705223702478, 'psi': 0.35976373724718097}
[S8] START round=33 head_norm_before_train=1.590423 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.025167 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8057491743743521, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8560826532756237, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.658464 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4965489359495403, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.470722542865575, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=1.962568 (no previous merge yet)
[S10] round=33 local utility u=0.369597 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.6741104896372403, 'psi': 0.3328555502468546}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.664378685860012, 'psi': 0.24964166268514096}
[S11] START round=33 head_norm_before_train=1.861549 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.326536846124475, 'auprc': 0.326536846124475, 'loss_val': 2.7666143265256937, 'psi': 0.326536846124475}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.7670170788833968, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.725140 cos_to_last_merge=0.9999 (last merge round=29)
[S13] round=33 local utility u=0.048171 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2708316988045831, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3671744492342772, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=1.958984 cos_to_last_merge=0.9942 (last merge round=26)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 4.8884986912050055, 'psi': 0.13533083645443197}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 4.793881420457109, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.637969 cos_to_last_merge=0.9614 (last merge round=25)
[S15] round=33 local utility u=0.009103 metrics={'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.5670846353655977, 'psi': 0.6173065327346117}-{'f1_val': 0.6162055819341677, 'auprc': 0.6162055819341677, 'loss_val': 0.5753816181033038, 'psi': 0.6162055819341677}
[S16] START round=33 head_norm_before_train=1.756537 cos_to_last_merge=0.9379 (last merge round=26)
[S16] ⚠️ Model drifted since last merge! cos=0.938
[S16] round=33 local utility u=0.065249 metrics={'f1_val': 0.1356007067137809, 'auprc': 0.1356007067137809, 'loss_val': 3.7785260860742267, 'psi': 0.1356007067137809}-{'f1_val': 0.12287049600482436, 'auprc': 0.12287049600482436, 'loss_val': 3.7944517831383697, 'psi': 0.12287049600482436}
[S17] START round=33 head_norm_before_train=1.797394 (no previous merge yet)
[S17] round=33 local utility u=0.197112 metrics={'f1_val': 0.2042832666684461, 'auprc': 0.2042832666684461, 'loss_val': 0.8548408370600095, 'psi': 0.2042832666684461}-{'f1_val': 0.1577311786507849, 'auprc': 0.1577311786507849, 'loss_val': 0.8300968131512635, 'psi': 0.1577311786507849}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.6173 head_norm=1.662359
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.153183e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.6172 head_norm=1.612138 delta_norm=0.315318
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.3599 head_norm=1.734205
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.764039e-02
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.3599 head_norm=1.748629 delta_norm=0.047640
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → trigger blocked (psi=0.136)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.1356 head_norm=1.778303
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.942248e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.1363 head_norm=1.718207 delta_norm=0.494225
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.740641 cos_to_last_merge=0.9827 (last merge round=26)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.19711761971176198, 'auprc': 0.19711761971176198, 'loss_val': 2.7417363103045647, 'psi': 0.19711761971176198}-{'f1_val': 0.26534522629666335, 'auprc': 0.26534522629666335, 'loss_val': 1.970856668118353, 'psi': 0.26534522629666335}
[S3] START round=34 head_norm_before_train=1.888017 (no previous merge yet)
[S3] round=34 local utility u=0.129743 metrics={'f1_val': 0.2880258899676375, 'auprc': 0.2880258899676375, 'loss_val': 3.2426754021977966, 'psi': 0.2880258899676375}-{'f1_val': 0.2939821214634596, 'auprc': 0.2939821214634596, 'loss_val': 3.5557665246862675, 'psi': 0.2939821214634596}
[S4] START round=34 head_norm_before_train=1.782054 cos_to_last_merge=0.9995 (last merge round=31)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2792987695784301, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2665538795618116, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=1.497270 cos_to_last_merge=0.9722 (last merge round=25)
[S5] round=34 local utility u=0.302336 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9746714729524268, 'psi': 0.3335071121394324}-{'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 1.8289525857263502, 'psi': 0.2501303341045743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=34 head_norm_before_train=1.533601 cos_to_last_merge=0.9624 (last merge round=26)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 4.925617192125666, 'psi': 0.017551963048498844}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.838047008408248, 'psi': 0.017774699907663897}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.679361 cos_to_last_merge=0.9986 (last merge round=29)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.084979539641801, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0780439296246165, 'psi': 0.35976373724718097}
[S8] START round=34 head_norm_before_train=1.610940 cos_to_last_merge=0.9999 (last merge round=32)
[S8] round=34 local utility u=0.005453 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7948441151238038, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8057491743743521, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.685234 cos_to_last_merge=0.9992 (last merge round=32)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5829314705123076, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4965489359495403, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=1.987630 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.68676229374133, 'psi': 0.24964166268514096}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.6741104896372403, 'psi': 0.3328555502468546}
[S11] START round=34 head_norm_before_train=1.873086 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.3245334547109695, 'auprc': 0.3245334547109695, 'loss_val': 2.7703550865021285, 'psi': 0.3245334547109695}-{'f1_val': 0.326536846124475, 'auprc': 0.326536846124475, 'loss_val': 2.7666143265256937, 'psi': 0.326536846124475}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.748629 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4409370365855505, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2708316988045831, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=1.971424 cos_to_last_merge=0.9932 (last merge round=26)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.967757803040169, 'psi': 0.13572854291417166}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 4.8884986912050055, 'psi': 0.13533083645443197}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.612138 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.085737 metrics={'f1_val': 0.6187684390221629, 'auprc': 0.6187684390221629, 'loss_val': 0.4087678717260232, 'psi': 0.6187684390221629}-{'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.5670846353655977, 'psi': 0.6173065327346117}
[S16] START round=34 head_norm_before_train=1.718207 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.386959 metrics={'f1_val': 0.1399050748448339, 'auprc': 0.1399050748448339, 'loss_val': 3.04334749362777, 'psi': 0.1399050748448339}-{'f1_val': 0.1356007067137809, 'auprc': 0.1356007067137809, 'loss_val': 3.7785260860742267, 'psi': 0.1356007067137809}
[S17] START round=34 head_norm_before_train=1.816958 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.20453174250323602, 'auprc': 0.20453174250323602, 'loss_val': 0.8908124035643704, 'psi': 0.20453174250323602}-{'f1_val': 0.2042832666684461, 'auprc': 0.2042832666684461, 'loss_val': 0.8548408370600095, 'psi': 0.2042832666684461}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.619)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.359)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.140)
[S2] START round=35 head_norm_before_train=1.755536 cos_to_last_merge=0.9808 (last merge round=26)
[S2] round=35 local utility u=0.606869 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 1.95920906253076, 'psi': 0.2450298816928894}-{'f1_val': 0.19711761971176198, 'auprc': 0.19711761971176198, 'loss_val': 2.7417363103045647, 'psi': 0.19711761971176198}
[S3] START round=35 head_norm_before_train=1.895394 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.29671513193322563, 'auprc': 0.29671513193322563, 'loss_val': 3.3941456452827308, 'psi': 0.29671513193322563}-{'f1_val': 0.2880258899676375, 'auprc': 0.2880258899676375, 'loss_val': 3.2426754021977966, 'psi': 0.2880258899676375}
[S4] START round=35 head_norm_before_train=1.800945 cos_to_last_merge=0.9991 (last merge round=31)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.288622500184795, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2792987695784301, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=1.530088 cos_to_last_merge=0.9676 (last merge round=25)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.083734671924704, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9746714729524268, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.548666 cos_to_last_merge=0.9594 (last merge round=26)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.0018976766005325, 'psi': 0.01732902033271719}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 4.925617192125666, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.689777 cos_to_last_merge=0.9981 (last merge round=29)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0862534055236057, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.084979539641801, 'psi': 0.35976373724718097}
[S8] START round=35 head_norm_before_train=1.637499 cos_to_last_merge=0.9996 (last merge round=32)
[S8] round=35 local utility u=0.004237 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7863705907252655, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7948441151238038, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.716172 cos_to_last_merge=0.9967 (last merge round=32)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.637107925958082, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5829314705123076, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=2.010380 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.7002810287969, 'psi': 0.24964166268514096}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.68676229374133, 'psi': 0.24964166268514096}
[S11] START round=35 head_norm_before_train=1.884577 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.32460335534806045, 'auprc': 0.32460335534806045, 'loss_val': 2.7960565703371927, 'psi': 0.32460335534806045}-{'f1_val': 0.3245334547109695, 'auprc': 0.3245334547109695, 'loss_val': 2.7703550865021285, 'psi': 0.3245334547109695}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.762175 cos_to_last_merge=0.9999 (last merge round=33)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4589865407897722, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4409370365855505, 'psi': 0.3599362944611573}
[S14] START round=35 head_norm_before_train=1.982755 cos_to_last_merge=0.9923 (last merge round=26)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.042795890868237, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.967757803040169, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.636659 cos_to_last_merge=0.9998 (last merge round=33)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.4664282662200134, 'psi': 0.6175834097438502}-{'f1_val': 0.6187684390221629, 'auprc': 0.6187684390221629, 'loss_val': 0.4087678717260232, 'psi': 0.6187684390221629}
[S16] START round=35 head_norm_before_train=1.738547 cos_to_last_merge=0.9996 (last merge round=33)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.06799667497921862, 'auprc': 0.06799667497921862, 'loss_val': 3.866962719938625, 'psi': 0.06799667497921862}-{'f1_val': 0.1399050748448339, 'auprc': 0.1399050748448339, 'loss_val': 3.04334749362777, 'psi': 0.1399050748448339}
[S17] START round=35 head_norm_before_train=1.834179 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.2043226098698858, 'auprc': 0.2043226098698858, 'loss_val': 0.8979298320799375, 'psi': 0.2043226098698858}-{'f1_val': 0.20453174250323602, 'auprc': 0.20453174250323602, 'loss_val': 0.8908124035643704, 'psi': 0.20453174250323602}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.767496 cos_to_last_merge=0.9792 (last merge round=26)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 1.9744206193912135, 'psi': 0.24516443956312162}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 1.95920906253076, 'psi': 0.2450298816928894}
[S3] START round=36 head_norm_before_train=1.902510 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2943174515744056, 'auprc': 0.2943174515744056, 'loss_val': 3.504362216861293, 'psi': 0.2943174515744056}-{'f1_val': 0.29671513193322563, 'auprc': 0.29671513193322563, 'loss_val': 3.3941456452827308, 'psi': 0.29671513193322563}
[S4] START round=36 head_norm_before_train=1.817641 cos_to_last_merge=0.9986 (last merge round=31)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3022981769010655, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.288622500184795, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=1.562123 cos_to_last_merge=0.9629 (last merge round=25)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1365510779318577, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.083734671924704, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.559619 cos_to_last_merge=0.9572 (last merge round=26)
[S6] round=36 local utility u=0.078963 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 4.887691035497886, 'psi': 0.022186642268984445}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.0018976766005325, 'psi': 0.01732902033271719}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=36 head_norm_before_train=1.697241 cos_to_last_merge=0.9977 (last merge round=29)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.095285076566074, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0862534055236057, 'psi': 0.35976373724718097}
[S8] START round=36 head_norm_before_train=1.668733 cos_to_last_merge=0.9989 (last merge round=32)
[S8] round=36 local utility u=0.006024 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7743222951106277, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7863705907252655, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=1.745429 cos_to_last_merge=0.9936 (last merge round=32)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6914897306887355, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.637107925958082, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=2.030357 (no previous merge yet)
[S10] round=36 local utility u=0.363546 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.7221134205132005, 'psi': 0.3328555502468546}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.7002810287969, 'psi': 0.24964166268514096}
[S11] START round=36 head_norm_before_train=1.895404 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.3266865306746123, 'auprc': 0.3266865306746123, 'loss_val': 2.8345168259776545, 'psi': 0.3266865306746123}-{'f1_val': 0.32460335534806045, 'auprc': 0.32460335534806045, 'loss_val': 2.7960565703371927, 'psi': 0.32460335534806045}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.773796 cos_to_last_merge=0.9998 (last merge round=33)
[S13] round=36 local utility u=0.009858 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4392710883983577, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4589865407897722, 'psi': 0.3599362944611573}
[S14] START round=36 head_norm_before_train=1.992823 cos_to_last_merge=0.9914 (last merge round=26)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.111377064401893, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.042795890868237, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.661898 cos_to_last_merge=0.9992 (last merge round=33)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.616751573155862, 'auprc': 0.616751573155862, 'loss_val': 0.6031453029472189, 'psi': 0.616751573155862}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.4664282662200134, 'psi': 0.6175834097438502}
[S16] START round=36 head_norm_before_train=1.764398 cos_to_last_merge=0.9982 (last merge round=33)
[S16] round=36 local utility u=0.019734 metrics={'f1_val': 0.08351541636319494, 'auprc': 0.08351541636319494, 'loss_val': 3.9671636322101325, 'psi': 0.08351541636319494}-{'f1_val': 0.06799667497921862, 'auprc': 0.06799667497921862, 'loss_val': 3.866962719938625, 'psi': 0.06799667497921862}
[S17] START round=36 head_norm_before_train=1.848163 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.2042832666684461, 'auprc': 0.2042832666684461, 'loss_val': 0.9866128811614185, 'psi': 0.2042832666684461}-{'f1_val': 0.2043226098698858, 'auprc': 0.2043226098698858, 'loss_val': 0.8979298320799375, 'psi': 0.2043226098698858}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.359)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.084)
[S2] START round=37 head_norm_before_train=1.779429 cos_to_last_merge=0.9777 (last merge round=26)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.2457492354740061, 'auprc': 0.2457492354740061, 'loss_val': 1.996134705765128, 'psi': 0.2457492354740061}-{'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 1.9744206193912135, 'psi': 0.24516443956312162}
[S3] START round=37 head_norm_before_train=1.909899 (no previous merge yet)
[S3] round=37 local utility u=0.032681 metrics={'f1_val': 0.2963365977511788, 'auprc': 0.2963365977511788, 'loss_val': 3.4571730814825687, 'psi': 0.2963365977511788}-{'f1_val': 0.2943174515744056, 'auprc': 0.2943174515744056, 'loss_val': 3.504362216861293, 'psi': 0.2943174515744056}
[S4] START round=37 head_norm_before_train=1.834102 cos_to_last_merge=0.9981 (last merge round=31)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.314382367687176, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3022981769010655, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=1.595581 cos_to_last_merge=0.9585 (last merge round=25)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 2.180543444886603, 'psi': 0.2501303341045743}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1365510779318577, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.570467 cos_to_last_merge=0.9550 (last merge round=26)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 5.195459019971686, 'psi': 0.016882516188714152}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 4.887691035497886, 'psi': 0.022186642268984445}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.705861 cos_to_last_merge=0.9971 (last merge round=29)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0985684789226553, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.095285076566074, 'psi': 0.35976373724718097}
[S8] START round=37 head_norm_before_train=1.701469 cos_to_last_merge=0.9978 (last merge round=32)
[S8] round=37 local utility u=0.003058 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7682065992470922, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7743222951106277, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=1.770823 cos_to_last_merge=0.9908 (last merge round=32)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7499549384869109, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6914897306887355, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=2.048196 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.7305430358935405, 'psi': 0.24964166268514096}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.7221134205132005, 'psi': 0.3328555502468546}
[S11] START round=37 head_norm_before_train=1.905472 (no previous merge yet)
[S11] round=37 local utility u=0.000665 metrics={'f1_val': 0.3310109924136863, 'auprc': 0.3310109924136863, 'loss_val': 2.872107648550095, 'psi': 0.3310109924136863}-{'f1_val': 0.3266865306746123, 'auprc': 0.3266865306746123, 'loss_val': 2.8345168259776545, 'psi': 0.3266865306746123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=37 head_norm_before_train=1.781000 cos_to_last_merge=0.9997 (last merge round=33)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.457976910904638, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4392710883983577, 'psi': 0.3599362944611573}
[S14] START round=37 head_norm_before_train=2.002071 cos_to_last_merge=0.9907 (last merge round=26)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.173914516596293, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.111377064401893, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.687264 cos_to_last_merge=0.9982 (last merge round=33)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.5867128885798653, 'auprc': 0.5867128885798653, 'loss_val': 0.5233590769032981, 'psi': 0.5867128885798653}-{'f1_val': 0.616751573155862, 'auprc': 0.616751573155862, 'loss_val': 0.6031453029472189, 'psi': 0.616751573155862}
[S16] START round=37 head_norm_before_train=1.791347 cos_to_last_merge=0.9960 (last merge round=33)
[S16] round=37 local utility u=0.556922 metrics={'f1_val': 0.14572501444251876, 'auprc': 0.14572501444251876, 'loss_val': 3.4132057604580637, 'psi': 0.14572501444251876}-{'f1_val': 0.08351541636319494, 'auprc': 0.08351541636319494, 'loss_val': 3.9671636322101325, 'psi': 0.08351541636319494}
[S17] START round=37 head_norm_before_train=1.864207 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.20505525357183296, 'auprc': 0.20505525357183296, 'loss_val': 1.0284519760333033, 'psi': 0.20505525357183296}-{'f1_val': 0.2042832666684461, 'auprc': 0.2042832666684461, 'loss_val': 0.9866128811614185, 'psi': 0.2042832666684461}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.146)
[S2] START round=38 head_norm_before_train=1.791137 cos_to_last_merge=0.9762 (last merge round=26)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 2.0512353809772903, 'psi': 0.24543399914482925}-{'f1_val': 0.2457492354740061, 'auprc': 0.2457492354740061, 'loss_val': 1.996134705765128, 'psi': 0.2457492354740061}
[S3] START round=38 head_norm_before_train=1.917367 (no previous merge yet)
[S3] round=38 local utility u=0.011659 metrics={'f1_val': 0.2966934763181412, 'auprc': 0.2966934763181412, 'loss_val': 3.4370671878399586, 'psi': 0.2966934763181412}-{'f1_val': 0.2963365977511788, 'auprc': 0.2963365977511788, 'loss_val': 3.4571730814825687, 'psi': 0.2963365977511788}
[S4] START round=38 head_norm_before_train=1.846113 cos_to_last_merge=0.9976 (last merge round=31)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3335217521408944, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.314382367687176, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=1.627618 cos_to_last_merge=0.9542 (last merge round=25)
[S5] round=38 local utility u=0.017501 metrics={'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 2.145540917889704, 'psi': 0.2501303341045743}-{'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 2.180543444886603, 'psi': 0.2501303341045743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=38 head_norm_before_train=1.582175 cos_to_last_merge=0.9530 (last merge round=26)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.231864584944775, 'psi': 0.017551963048498844}-{'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 5.195459019971686, 'psi': 0.016882516188714152}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.714720 cos_to_last_merge=0.9966 (last merge round=29)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0948076280235663, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0985684789226553, 'psi': 0.35976373724718097}
[S8] START round=38 head_norm_before_train=1.734168 cos_to_last_merge=0.9966 (last merge round=32)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7710523222190769, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7682065992470922, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.792328 cos_to_last_merge=0.9885 (last merge round=32)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8048307381319408, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7499549384869109, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=2.064431 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.7448223726806145, 'psi': 0.24964166268514096}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.7305430358935405, 'psi': 0.24964166268514096}
[S11] START round=38 head_norm_before_train=1.915297 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.8934178498480696, 'psi': 0.33154997286190585}-{'f1_val': 0.3310109924136863, 'auprc': 0.3310109924136863, 'loss_val': 2.872107648550095, 'psi': 0.3310109924136863}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.788776 cos_to_last_merge=0.9995 (last merge round=33)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4983845455332125, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.457976910904638, 'psi': 0.3599362944611573}
[S14] START round=38 head_norm_before_train=2.010805 cos_to_last_merge=0.9899 (last merge round=26)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.2312789463920835, 'psi': 0.1355297641332834}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.173914516596293, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.710781 cos_to_last_merge=0.9971 (last merge round=33)
[S15] round=38 local utility u=0.287562 metrics={'f1_val': 0.6229034813744176, 'auprc': 0.6229034813744176, 'loss_val': 0.2739510568194349, 'psi': 0.6229034813744176}-{'f1_val': 0.5867128885798653, 'auprc': 0.5867128885798653, 'loss_val': 0.5233590769032981, 'psi': 0.5867128885798653}
[S16] START round=38 head_norm_before_train=1.817647 cos_to_last_merge=0.9935 (last merge round=33)
[S16] round=38 local utility u=0.644451 metrics={'f1_val': 0.19153000065863135, 'auprc': 0.19153000065863135, 'loss_val': 2.5365489562186188, 'psi': 0.19153000065863135}-{'f1_val': 0.14572501444251876, 'auprc': 0.14572501444251876, 'loss_val': 3.4132057604580637, 'psi': 0.14572501444251876}
[S17] START round=38 head_norm_before_train=1.877981 (no previous merge yet)
[S17] round=38 local utility u=0.550407 metrics={'f1_val': 0.32122794182002345, 'auprc': 0.32122794182002345, 'loss_val': 0.9731923431607624, 'psi': 0.32122794182002345}-{'f1_val': 0.20505525357183296, 'auprc': 0.20505525357183296, 'loss_val': 1.0284519760333033, 'psi': 0.20505525357183296}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S3] not sending this round → trigger blocked (psi=0.297)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.192)
[S2] START round=39 head_norm_before_train=1.802417 cos_to_last_merge=0.9747 (last merge round=26)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.112875617742759, 'psi': 0.245119570522206}-{'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 2.0512353809772903, 'psi': 0.24543399914482925}
[S3] START round=39 head_norm_before_train=1.924860 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.29607577807848445, 'auprc': 0.29607577807848445, 'loss_val': 3.488991897892356, 'psi': 0.29607577807848445}-{'f1_val': 0.2966934763181412, 'auprc': 0.2966934763181412, 'loss_val': 3.4370671878399586, 'psi': 0.2966934763181412}
[S4] START round=39 head_norm_before_train=1.857899 cos_to_last_merge=0.9972 (last merge round=31)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3385133586992815, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3335217521408944, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=1.654023 cos_to_last_merge=0.9509 (last merge round=25)
[S5] round=39 local utility u=0.298010 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.29991216716919, 'psi': 0.3335071121394324}-{'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 2.145540917889704, 'psi': 0.2501303341045743}
[S5] not sending this round → trigger blocked (psi=0.334)
[S5] r=40 psi=0.334 u=0.2980 p_local=0.0880 f1=0.334 auprc=0.334 bytes=19809
[S6] START round=39 head_norm_before_train=1.593017 cos_to_last_merge=0.9511 (last merge round=26)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.285519433636572, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.231864584944775, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.018 u=0.0000 p_local=0.0199 f1=0.018 auprc=0.018 bytes=0
[S7] START round=39 head_norm_before_train=1.724360 cos_to_last_merge=0.9963 (last merge round=29)
[S7] round=39 local utility u=0.003518 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0877720260118606, 'psi': 0.23968964488212474}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0948076280235663, 'psi': 0.23968964488212474}
[S8] START round=39 head_norm_before_train=1.762482 cos_to_last_merge=0.9955 (last merge round=32)
[S8] round=39 local utility u=0.001627 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7677979154304928, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7710523222190769, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=1.810058 cos_to_last_merge=0.9865 (last merge round=32)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8562271688658603, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8048307381319408, 'psi': 0.36867172340800847}
[S10] START round=39 head_norm_before_train=2.080052 (no previous merge yet)
[S10] round=39 local utility u=0.364957 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.7638342468557946, 'psi': 0.3328555502468546}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.7448223726806145, 'psi': 0.24964166268514096}
[S11] START round=39 head_norm_before_train=1.924569 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.33131876646520997, 'auprc': 0.33131876646520997, 'loss_val': 2.911184154884662, 'psi': 0.33131876646520997}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.8934178498480696, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.331 u=0.0000 p_local=0.0021 f1=0.331 auprc=0.331 bytes=12607
[S13] START round=39 head_norm_before_train=1.798475 cos_to_last_merge=0.9993 (last merge round=33)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5252622638314257, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4983845455332125, 'psi': 0.3599362944611573}
[S14] START round=39 head_norm_before_train=2.019014 cos_to_last_merge=0.9892 (last merge round=26)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.2855357655011295, 'psi': 0.13533083645443197}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.2312789463920835, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.135 u=0.0000 p_local=0.0029 f1=0.135 auprc=0.135 bytes=0
[S15] START round=39 head_norm_before_train=1.733074 cos_to_last_merge=0.9959 (last merge round=33)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.5228534506610992, 'psi': 0.6175834097438502}-{'f1_val': 0.6229034813744176, 'auprc': 0.6229034813744176, 'loss_val': 0.2739510568194349, 'psi': 0.6229034813744176}
[S16] START round=39 head_norm_before_train=1.840545 cos_to_last_merge=0.9910 (last merge round=33)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.1364204336640941, 'auprc': 0.1364204336640941, 'loss_val': 3.771616503396835, 'psi': 0.1364204336640941}-{'f1_val': 0.19153000065863135, 'auprc': 0.19153000065863135, 'loss_val': 2.5365489562186188, 'psi': 0.19153000065863135}
[S17] START round=39 head_norm_before_train=1.890289 (no previous merge yet)
[S17] round=39 local utility u=0.389033 metrics={'f1_val': 0.3976864547246121, 'auprc': 0.3976864547246121, 'loss_val': 0.8832521610815689, 'psi': 0.3976864547246121}-{'f1_val': 0.32122794182002345, 'auprc': 0.32122794182002345, 'loss_val': 0.9731923431607624, 'psi': 0.32122794182002345}
[S17] not sending this round → trigger blocked (psi=0.398)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.333 u=0.3650 p_local=0.1334 f1=0.333 auprc=0.333 bytes=39631
[S7] r=40 psi=0.240 u=0.0035 p_local=0.0035 f1=0.240 auprc=0.240 bytes=26986
[S2] r=40 psi=0.245 u=0.0000 p_local=0.0748 f1=0.245 auprc=0.245 bytes=23420
[S3] r=40 psi=0.296 u=0.0000 p_local=0.0223 f1=0.296 auprc=0.296 bytes=19815
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0113 f1=0.369 auprc=0.369 bytes=14401
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0101 f1=0.357 auprc=0.357 bytes=12591
[S15] r=40 psi=0.618 u=0.0000 p_local=0.0690 f1=0.618 auprc=0.618 bytes=25205
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0100 f1=0.360 auprc=0.360 bytes=26991
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.398 u=0.3890 p_local=0.1877 f1=0.398 auprc=0.398 bytes=14414
[S8] r=40 psi=0.359 u=0.0016 p_local=0.0089 f1=0.359 auprc=0.359 bytes=28827
[S16] r=40 psi=0.136 u=0.0000 p_local=0.2470 f1=0.136 auprc=0.136 bytes=0
[S2] START round=40 head_norm_before_train=1.812985 cos_to_last_merge=0.9733 (last merge round=26)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.1574070452892546, 'psi': 0.24507471790179935}-{'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.112875617742759, 'psi': 0.245119570522206}
[S3] START round=40 head_norm_before_train=1.932081 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.29615489500954456, 'auprc': 0.29615489500954456, 'loss_val': 3.540213334388066, 'psi': 0.29615489500954456}-{'f1_val': 0.29607577807848445, 'auprc': 0.29607577807848445, 'loss_val': 3.488991897892356, 'psi': 0.29607577807848445}
[S4] START round=40 head_norm_before_train=1.863554 cos_to_last_merge=0.9965 (last merge round=31)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3437395500949536, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3385133586992815, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=1.680137 cos_to_last_merge=0.9475 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.39383289525204, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.29991216716919, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.603755 cos_to_last_merge=0.9492 (last merge round=26)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.005679129200189304, 'auprc': 0.005679129200189304, 'loss_val': 5.435534849496, 'psi': 0.005679129200189304}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.285519433636572, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.731780 cos_to_last_merge=0.9960 (last merge round=29)
[S7] round=40 local utility u=0.000051 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0876701544121146, 'psi': 0.23968964488212474}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0877720260118606, 'psi': 0.23968964488212474}
[S8] START round=40 head_norm_before_train=1.787143 cos_to_last_merge=0.9944 (last merge round=32)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7717460133648854, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7677979154304928, 'psi': 0.35939447907390915}
[S9] START round=40 head_norm_before_train=1.825178 cos_to_last_merge=0.9849 (last merge round=32)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9043634239379432, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8562271688658603, 'psi': 0.36867172340800847}
[S10] START round=40 head_norm_before_train=2.095384 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.776576713746113, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.7638342468557946, 'psi': 0.3328555502468546}
[S11] START round=40 head_norm_before_train=1.933204 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.3309341382245956, 'auprc': 0.3309341382245956, 'loss_val': 2.9247454969440363, 'psi': 0.3309341382245956}-{'f1_val': 0.33131876646520997, 'auprc': 0.33131876646520997, 'loss_val': 2.911184154884662, 'psi': 0.33131876646520997}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.812295 cos_to_last_merge=0.9989 (last merge round=33)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6110674379149241, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5252622638314257, 'psi': 0.3599362944611573}
[S14] START round=40 head_norm_before_train=2.026717 cos_to_last_merge=0.9885 (last merge round=26)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13493253373313344, 'auprc': 0.13493253373313344, 'loss_val': 5.337112395166159, 'psi': 0.13493253373313344}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.2855357655011295, 'psi': 0.13533083645443197}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.754186 cos_to_last_merge=0.9946 (last merge round=33)
[S15] round=40 local utility u=0.010532 metrics={'f1_val': 0.6168904640188789, 'auprc': 0.6168904640188789, 'loss_val': 0.49555231632745966, 'psi': 0.6168904640188789}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.5228534506610992, 'psi': 0.6175834097438502}
[S16] START round=40 head_norm_before_train=1.860411 cos_to_last_merge=0.9887 (last merge round=33)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.08896369319547968, 'auprc': 0.08896369319547968, 'loss_val': 4.451663664674383, 'psi': 0.08896369319547968}-{'f1_val': 0.1364204336640941, 'auprc': 0.1364204336640941, 'loss_val': 3.771616503396835, 'psi': 0.1364204336640941}
[S17] START round=40 head_norm_before_train=1.905258 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.30984952120383036, 'auprc': 0.30984952120383036, 'loss_val': 1.0389478807040664, 'psi': 0.30984952120383036}-{'f1_val': 0.3976864547246121, 'auprc': 0.3976864547246121, 'loss_val': 0.8832521610815689, 'psi': 0.3976864547246121}
[S16]  timeout peer S7
[S16]  timeout peer S17
[S2]  timeout peer S9
[S13]  timeout peer S4
[S7]  timeout peer S2
[S17]  timeout peer S16
[S3]  timeout peer S8
[S10]  timeout peer S14
[S8]  timeout peer S5
[S9]  timeout peer S15
[S15]  timeout peer S6
[S4]  timeout peer S10
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.240)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.822825 cos_to_last_merge=0.9720 (last merge round=26)
[S2] round=41 local utility u=0.036387 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.267540148266684, 'psi': 0.2653978324081417}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.1574070452892546, 'psi': 0.24507471790179935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=41 head_norm_before_train=1.939352 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.2960532312460122, 'auprc': 0.2960532312460122, 'loss_val': 3.5783799148523188, 'psi': 0.2960532312460122}-{'f1_val': 0.29615489500954456, 'auprc': 0.29615489500954456, 'loss_val': 3.540213334388066, 'psi': 0.29615489500954456}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.870942 cos_to_last_merge=0.9957 (last merge round=31)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3629434290773172, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3437395500949536, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.707084 cos_to_last_merge=0.9442 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.439022429437175, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.39383289525204, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.612006 cos_to_last_merge=0.9478 (last merge round=26)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=41 local utility u=0.174702 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.230759668684803, 'psi': 0.021749084249084248}-{'f1_val': 0.005679129200189304, 'auprc': 0.005679129200189304, 'loss_val': 5.435534849496, 'psi': 0.005679129200189304}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=41 head_norm_before_train=1.737546 cos_to_last_merge=0.9957 (last merge round=29)
[S7] round=41 local utility u=0.541446 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0854454578901092, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.0876701544121146, 'psi': 0.23968964488212474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=41 head_norm_before_train=1.809826 cos_to_last_merge=0.9934 (last merge round=32)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7835504500956872, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7717460133648854, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.838398 cos_to_last_merge=0.9836 (last merge round=32)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.945550193876348, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9043634239379432, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.110499 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.7890118026621122, 'psi': 0.24964166268514096}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.776576713746113, 'psi': 0.3328555502468546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.941332 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.32993827160493827, 'auprc': 0.32993827160493827, 'loss_val': 2.936392718133373, 'psi': 0.32993827160493827}-{'f1_val': 0.3309341382245956, 'auprc': 0.3309341382245956, 'loss_val': 2.9247454969440363, 'psi': 0.3309341382245956}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.823378 cos_to_last_merge=0.9987 (last merge round=33)
[S13] round=41 local utility u=0.042588 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5258916846489663, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6110674379149241, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=41 head_norm_before_train=2.033960 cos_to_last_merge=0.9879 (last merge round=26)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 5.388490397845981, 'psi': 0.1347331583552056}-{'f1_val': 0.13493253373313344, 'auprc': 0.13493253373313344, 'loss_val': 5.337112395166159, 'psi': 0.13493253373313344}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.773322 cos_to_last_merge=0.9935 (last merge round=33)
[S15] round=41 local utility u=0.030439 metrics={'f1_val': 0.6174450213799425, 'auprc': 0.6174450213799425, 'loss_val': 0.43966617341030156, 'psi': 0.6174450213799425}-{'f1_val': 0.6168904640188789, 'auprc': 0.6168904640188789, 'loss_val': 0.49555231632745966, 'psi': 0.6168904640188789}
[S15] not sending this round → trigger blocked (psi=0.617)
[S16] START round=41 head_norm_before_train=1.876790 cos_to_last_merge=0.9869 (last merge round=33)
[S16] round=41 local utility u=0.437097 metrics={'f1_val': 0.13630348478164975, 'auprc': 0.13630348478164975, 'loss_val': 4.003526998617996, 'psi': 0.13630348478164975}-{'f1_val': 0.08896369319547968, 'auprc': 0.08896369319547968, 'loss_val': 4.451663664674383, 'psi': 0.08896369319547968}
[S16] not sending this round → trigger blocked (psi=0.136)
[S17] START round=41 head_norm_before_train=1.921788 (no previous merge yet)
[S17] round=41 local utility u=0.222674 metrics={'f1_val': 0.35930996691840156, 'auprc': 0.35930996691840156, 'loss_val': 1.0387448046264272, 'psi': 0.35930996691840156}-{'f1_val': 0.30984952120383036, 'auprc': 0.30984952120383036, 'loss_val': 1.0389478807040664, 'psi': 0.30984952120383036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=42 head_norm_before_train=1.831655 cos_to_last_merge=0.9709 (last merge round=26)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.2619428876434481, 'auprc': 0.2619428876434481, 'loss_val': 2.370113718403742, 'psi': 0.2619428876434481}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.267540148266684, 'psi': 0.2653978324081417}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.946459 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.29440322432902816, 'auprc': 0.29440322432902816, 'loss_val': 3.613300680501577, 'psi': 0.29440322432902816}-{'f1_val': 0.2960532312460122, 'auprc': 0.2960532312460122, 'loss_val': 3.5783799148523188, 'psi': 0.2960532312460122}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.880624 cos_to_last_merge=0.9953 (last merge round=31)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3841819077193298, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3629434290773172, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.730301 cos_to_last_merge=0.9416 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=42 local utility u=0.061231 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3165606709129194, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.439022429437175, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=42 head_norm_before_train=1.618696 cos_to_last_merge=0.9466 (last merge round=26)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.0023820867079561697, 'auprc': 0.0023820867079561697, 'loss_val': 5.488146191108139, 'psi': 0.0023820867079561697}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.230759668684803, 'psi': 0.021749084249084248}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.744526 cos_to_last_merge=0.9954 (last merge round=29)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0906698556627825, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0854454578901092, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.830059 cos_to_last_merge=0.9924 (last merge round=32)
[S8] round=42 local utility u=0.003402 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7767458373402045, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7835504500956872, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=42 head_norm_before_train=1.850247 cos_to_last_merge=0.9825 (last merge round=32)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.982700574149658, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.945550193876348, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.124949 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.807024559053241, 'psi': 0.24964166268514096}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.7890118026621122, 'psi': 0.24964166268514096}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.949086 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.32970930680854343, 'auprc': 0.32970930680854343, 'loss_val': 2.949385756949613, 'psi': 0.32970930680854343}-{'f1_val': 0.32993827160493827, 'auprc': 0.32993827160493827, 'loss_val': 2.936392718133373, 'psi': 0.32993827160493827}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.831739 cos_to_last_merge=0.9985 (last merge round=33)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.645592465518542, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5258916846489663, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=2.040787 cos_to_last_merge=0.9873 (last merge round=26)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.436636747381376, 'psi': 0.13533083645443197}-{'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 5.388490397845981, 'psi': 0.1347331583552056}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.790298 cos_to_last_merge=0.9924 (last merge round=33)
[S15] round=42 local utility u=0.115093 metrics={'f1_val': 0.6215535343979983, 'auprc': 0.6215535343979983, 'loss_val': 0.24645734889891985, 'psi': 0.6215535343979983}-{'f1_val': 0.6174450213799425, 'auprc': 0.6174450213799425, 'loss_val': 0.43966617341030156, 'psi': 0.6174450213799425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=42 head_norm_before_train=1.891127 cos_to_last_merge=0.9853 (last merge round=33)
[S16] round=42 local utility u=0.834746 metrics={'f1_val': 0.18955026455026455, 'auprc': 0.18955026455026455, 'loss_val': 2.8132553459909486, 'psi': 0.18955026455026455}-{'f1_val': 0.13630348478164975, 'auprc': 0.13630348478164975, 'loss_val': 4.003526998617996, 'psi': 0.13630348478164975}
[S16] not sending this round → trigger blocked (psi=0.190)
[S17] START round=42 head_norm_before_train=1.939275 (no previous merge yet)
[S17] round=42 local utility u=0.184465 metrics={'f1_val': 0.39529296611086967, 'auprc': 0.39529296611086967, 'loss_val': 0.9936613624715437, 'psi': 0.39529296611086967}-{'f1_val': 0.35930996691840156, 'auprc': 0.35930996691840156, 'loss_val': 1.0387448046264272, 'psi': 0.35930996691840156}
[S17] not sending this round → trigger blocked (psi=0.395)
[S2] START round=43 head_norm_before_train=1.840343 cos_to_last_merge=0.9697 (last merge round=26)
[S2] round=43 local utility u=0.063143 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.275164869026329, 'psi': 0.26542475888492534}-{'f1_val': 0.2619428876434481, 'auprc': 0.2619428876434481, 'loss_val': 2.370113718403742, 'psi': 0.2619428876434481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] sending update (kind=head size=1808 to 1 peers)
[S3] START round=43 head_norm_before_train=1.953039 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.2937821927888153, 'auprc': 0.2937821927888153, 'loss_val': 3.654209700682006, 'psi': 0.2937821927888153}-{'f1_val': 0.29440322432902816, 'auprc': 0.29440322432902816, 'loss_val': 3.613300680501577, 'psi': 0.29440322432902816}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.891323 cos_to_last_merge=0.9949 (last merge round=31)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3940517652696556, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3841819077193298, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.750354 cos_to_last_merge=0.9394 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 2.250569824261619, 'psi': 0.2501303341045743}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3165606709129194, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.625947 cos_to_last_merge=0.9453 (last merge round=26)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=43 local utility u=0.126892 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.372896373105044, 'psi': 0.017774699907663897}-{'f1_val': 0.0023820867079561697, 'auprc': 0.0023820867079561697, 'loss_val': 5.488146191108139, 'psi': 0.0023820867079561697}
[S6] not sending this round → trigger blocked (psi=0.018)
[S7] START round=43 head_norm_before_train=1.751804 cos_to_last_merge=0.9949 (last merge round=29)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 1.0836835311427888, 'psi': 0.23930704898446833}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0906698556627825, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.846293 cos_to_last_merge=0.9917 (last merge round=32)
[S8] round=43 local utility u=0.003052 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7706415761514754, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7767458373402045, 'psi': 0.35939447907390915}
[S8] not sending this round → trigger blocked (psi=0.359)
[S9] START round=43 head_norm_before_train=1.861145 cos_to_last_merge=0.9815 (last merge round=32)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.015856458930762, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.982700574149658, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.137123 (no previous merge yet)
[S10] round=43 local utility u=0.365405 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.825139121801478, 'psi': 0.3328555502468546}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.807024559053241, 'psi': 0.24964166268514096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=43 head_norm_before_train=1.956500 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.32993827160493827, 'auprc': 0.32993827160493827, 'loss_val': 2.9670042525576976, 'psi': 0.32993827160493827}-{'f1_val': 0.32970930680854343, 'auprc': 0.32970930680854343, 'loss_val': 2.949385756949613, 'psi': 0.32970930680854343}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.838712 cos_to_last_merge=0.9982 (last merge round=33)
[S13] round=43 local utility u=0.007623 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.630345601274368, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.645592465518542, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=43 head_norm_before_train=2.047418 cos_to_last_merge=0.9868 (last merge round=26)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.477833347213636, 'psi': 0.1355297641332834}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.436636747381376, 'psi': 0.13533083645443197}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.808780 cos_to_last_merge=0.9911 (last merge round=33)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.5072251610735372, 'psi': 0.6173065327346117}-{'f1_val': 0.6215535343979983, 'auprc': 0.6215535343979983, 'loss_val': 0.24645734889891985, 'psi': 0.6215535343979983}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.903565 cos_to_last_merge=0.9838 (last merge round=33)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.009868421052631578, 'auprc': 0.009868421052631578, 'loss_val': 5.443776544911298, 'psi': 0.009868421052631578}-{'f1_val': 0.18955026455026455, 'auprc': 0.18955026455026455, 'loss_val': 2.8132553459909486, 'psi': 0.18955026455026455}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.953725 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.1393109363075016, 'psi': 0.30380970798684975}-{'f1_val': 0.39529296611086967, 'auprc': 0.39529296611086967, 'loss_val': 0.9936613624715437, 'psi': 0.39529296611086967}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.848931 cos_to_last_merge=0.9686 (last merge round=26)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.24602008327210387, 'auprc': 0.24602008327210387, 'loss_val': 2.2418262326688736, 'psi': 0.2460200832721039}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.275164869026329, 'psi': 0.26542475888492534}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.959211 (no previous merge yet)
[S3] round=44 local utility u=0.006868 metrics={'f1_val': 0.29440322432902816, 'auprc': 0.29440322432902816, 'loss_val': 3.646063193395115, 'psi': 0.29440322432902816}-{'f1_val': 0.2937821927888153, 'auprc': 0.2937821927888153, 'loss_val': 3.654209700682006, 'psi': 0.2937821927888153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=44 head_norm_before_train=1.898618 cos_to_last_merge=0.9942 (last merge round=31)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4154164649312013, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3940517652696556, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.768543 cos_to_last_merge=0.9372 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=44 local utility u=0.302901 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3951588079755437, 'psi': 0.3335071121394324}-{'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 2.250569824261619, 'psi': 0.2501303341045743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=44 head_norm_before_train=1.633396 cos_to_last_merge=0.9440 (last merge round=26)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.484998819719931, 'psi': 0.017551963048498844}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.372896373105044, 'psi': 0.017774699907663897}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.755724 cos_to_last_merge=0.9946 (last merge round=29)
[S7] round=44 local utility u=0.000237 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.0859641150961867, 'psi': 0.2396131805157593}-{'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 1.0836835311427888, 'psi': 0.23930704898446833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=44 head_norm_before_train=1.861555 cos_to_last_merge=0.9909 (last merge round=32)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7768010440493411, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7706415761514754, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.870986 cos_to_last_merge=0.9806 (last merge round=32)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.047226918562587, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.015856458930762, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.148543 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.8412318802423093, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.825139121801478, 'psi': 0.3328555502468546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.963920 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.33116480793060715, 'auprc': 0.33116480793060715, 'loss_val': 2.98843105786058, 'psi': 0.33116480793060715}-{'f1_val': 0.32993827160493827, 'auprc': 0.32993827160493827, 'loss_val': 2.9670042525576976, 'psi': 0.32993827160493827}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.844307 cos_to_last_merge=0.9980 (last merge round=33)
[S13] round=44 local utility u=0.098246 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4338530101585136, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.630345601274368, 'psi': 0.3599362944611573}
[S13] not sending this round → trigger blocked (psi=0.360)
[S14] START round=44 head_norm_before_train=2.053827 cos_to_last_merge=0.9862 (last merge round=26)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.5147830451083895, 'psi': 0.1355297641332834}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.477833347213636, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.826821 cos_to_last_merge=0.9899 (last merge round=33)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5213503783182132, 'psi': 0.6164734888353558}-{'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.5072251610735372, 'psi': 0.6173065327346117}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.914307 cos_to_last_merge=0.9825 (last merge round=33)
[S16] round=44 local utility u=1.000000 metrics={'f1_val': 0.13793608912342423, 'auprc': 0.13793608912342423, 'loss_val': 3.9843953237725414, 'psi': 0.13793608912342423}-{'f1_val': 0.009868421052631578, 'auprc': 0.009868421052631578, 'loss_val': 5.443776544911298, 'psi': 0.009868421052631578}
[S16] not sending this round → trigger blocked (psi=0.138)
[S17] START round=44 head_norm_before_train=1.965361 (no previous merge yet)
[S17] round=44 local utility u=0.682816 metrics={'f1_val': 0.42939666238767654, 'auprc': 0.42939666238767654, 'loss_val': 0.9039619302163634, 'psi': 0.42939666238767654}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.1393109363075016, 'psi': 0.30380970798684975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=45 head_norm_before_train=1.857358 cos_to_last_merge=0.9674 (last merge round=26)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.25740703246271174, 'auprc': 0.25740703246271174, 'loss_val': 2.50996071857457, 'psi': 0.25740703246271174}-{'f1_val': 0.24602008327210387, 'auprc': 0.24602008327210387, 'loss_val': 2.2418262326688736, 'psi': 0.2460200832721039}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.965358 (no previous merge yet)
[S3] round=45 local utility u=0.010296 metrics={'f1_val': 0.2958504331965344, 'auprc': 0.2958504331965344, 'loss_val': 3.6384964220382483, 'psi': 0.2958504331965344}-{'f1_val': 0.29440322432902816, 'auprc': 0.29440322432902816, 'loss_val': 3.646063193395115, 'psi': 0.29440322432902816}
[S3] not sending this round → trigger blocked (psi=0.296)
[S4] START round=45 head_norm_before_train=1.909440 cos_to_last_merge=0.9938 (last merge round=31)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4352055289889178, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4154164649312013, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.784761 cos_to_last_merge=0.9351 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.450517815063131, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3951588079755437, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.641142 cos_to_last_merge=0.9427 (last merge round=26)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=45 local utility u=0.015154 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 5.482588598321007, 'psi': 0.02065167508031207}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.484998819719931, 'psi': 0.017551963048498844}
[S6] not sending this round → trigger blocked (psi=0.021)
[S7] START round=45 head_norm_before_train=1.757588 cos_to_last_merge=0.9943 (last merge round=29)
[S7] round=45 local utility u=0.519537 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1282460252722666, 'psi': 0.35976373724718097}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.0859641150961867, 'psi': 0.2396131805157593}
[S7] not sending this round → trigger blocked (psi=0.360)
[S8] START round=45 head_norm_before_train=1.875894 cos_to_last_merge=0.9902 (last merge round=32)
[S8] round=45 local utility u=0.001711 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7733795555553516, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7768010440493411, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=45 head_norm_before_train=1.880089 cos_to_last_merge=0.9797 (last merge round=32)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.073827757899181, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.047226918562587, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.159790 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.8572121351773823, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.8412318802423093, 'psi': 0.3328555502468546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.971164 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0050893884673537, 'psi': 0.33154997286190585}-{'f1_val': 0.33116480793060715, 'auprc': 0.33116480793060715, 'loss_val': 2.98843105786058, 'psi': 0.33116480793060715}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.849454 cos_to_last_merge=0.9980 (last merge round=33)
[S13] round=45 local utility u=0.060185 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3134820391758317, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4338530101585136, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] START round=45 head_norm_before_train=2.060235 cos_to_last_merge=0.9856 (last merge round=26)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.552138653888627, 'psi': 0.1355297641332834}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.5147830451083895, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.844819 cos_to_last_merge=0.9886 (last merge round=33)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5250163236262112, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5213503783182132, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.924834 cos_to_last_merge=0.9813 (last merge round=33)
[S16] round=45 local utility u=0.591657 metrics={'f1_val': 0.177615076943936, 'auprc': 0.177615076943936, 'loss_val': 3.158192839983277, 'psi': 0.177615076943936}-{'f1_val': 0.13793608912342423, 'auprc': 0.13793608912342423, 'loss_val': 3.9843953237725414, 'psi': 0.13793608912342423}
[S16] not sending this round → trigger blocked (psi=0.178)
[S17] START round=45 head_norm_before_train=1.975728 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.31094172436985384, 'auprc': 0.31094172436985384, 'loss_val': 1.1787313611068049, 'psi': 0.31094172436985384}-{'f1_val': 0.42939666238767654, 'auprc': 0.42939666238767654, 'loss_val': 0.9039619302163634, 'psi': 0.42939666238767654}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.864707 cos_to_last_merge=0.9665 (last merge round=26)
[S2] round=46 local utility u=0.103733 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.374653861613942, 'psi': 0.26542475888492534}-{'f1_val': 0.25740703246271174, 'auprc': 0.25740703246271174, 'loss_val': 2.50996071857457, 'psi': 0.25740703246271174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=46 head_norm_before_train=1.971423 (no previous merge yet)
[S3] round=46 local utility u=0.004124 metrics={'f1_val': 0.29621542940320233, 'auprc': 0.29621542940320233, 'loss_val': 3.6335340594724577, 'psi': 0.29621542940320233}-{'f1_val': 0.2958504331965344, 'auprc': 0.2958504331965344, 'loss_val': 3.6384964220382483, 'psi': 0.2958504331965344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=46 head_norm_before_train=1.917432 cos_to_last_merge=0.9933 (last merge round=31)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4549748723719877, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4352055289889178, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.801924 cos_to_last_merge=0.9331 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.500634398881164, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.450517815063131, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.650319 cos_to_last_merge=0.9410 (last merge round=26)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 5.667585775732502, 'psi': 0.002619047619047619}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 5.482588598321007, 'psi': 0.02065167508031207}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.759876 cos_to_last_merge=0.9938 (last merge round=29)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1341644753454636, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1282460252722666, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.890264 cos_to_last_merge=0.9896 (last merge round=32)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7742171069233251, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7733795555553516, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.888507 cos_to_last_merge=0.9789 (last merge round=32)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.099654893315058, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.073827757899181, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.170635 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.870940405325912, 'psi': 0.24964166268514096}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.8572121351773823, 'psi': 0.3328555502468546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.978132 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0198939452602183, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0050893884673537, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.851933 cos_to_last_merge=0.9979 (last merge round=33)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5940260890004925, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3134820391758317, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.066395 cos_to_last_merge=0.9851 (last merge round=26)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.588427528200472, 'psi': 0.1355297641332834}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.552138653888627, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.862689 cos_to_last_merge=0.9874 (last merge round=33)
[S15] round=46 local utility u=0.052451 metrics={'f1_val': 0.6174450213799425, 'auprc': 0.6174450213799425, 'loss_val': 0.42885814908856673, 'psi': 0.6174450213799425}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5250163236262112, 'psi': 0.6164734888353558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=46 head_norm_before_train=1.934703 cos_to_last_merge=0.9801 (last merge round=33)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.17691785471826205, 'auprc': 0.17691785471826205, 'loss_val': 3.231736787681523, 'psi': 0.17691785471826205}-{'f1_val': 0.177615076943936, 'auprc': 0.177615076943936, 'loss_val': 3.158192839983277, 'psi': 0.177615076943936}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.987421 (no previous merge yet)
[S17] round=46 local utility u=0.030236 metrics={'f1_val': 0.3179970632674342, 'auprc': 0.3179970632674342, 'loss_val': 1.1817579290587885, 'psi': 0.3179970632674342}-{'f1_val': 0.31094172436985384, 'auprc': 0.31094172436985384, 'loss_val': 1.1787313611068049, 'psi': 0.31094172436985384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=47 head_norm_before_train=1.872015 cos_to_last_merge=0.9655 (last merge round=26)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.2455690013445789, 'auprc': 0.2455690013445789, 'loss_val': 2.31652051965645, 'psi': 0.24556900134457893}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.374653861613942, 'psi': 0.26542475888492534}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.977382 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.2961142961142961, 'auprc': 0.2961142961142961, 'loss_val': 3.6503668843928962, 'psi': 0.2961142961142961}-{'f1_val': 0.29621542940320233, 'auprc': 0.29621542940320233, 'loss_val': 3.6335340594724577, 'psi': 0.29621542940320233}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.926197 cos_to_last_merge=0.9928 (last merge round=31)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4649897762592217, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4549748723719877, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.817966 cos_to_last_merge=0.9313 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.931
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.529590065443635, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.500634398881164, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.659582 cos_to_last_merge=0.9394 (last merge round=26)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=47 local utility u=0.127061 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.549865600524836, 'psi': 0.017774699907663897}-{'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 5.667585775732502, 'psi': 0.002619047619047619}
[S6] not sending this round → trigger blocked (psi=0.018)
[S7] START round=47 head_norm_before_train=1.762874 cos_to_last_merge=0.9933 (last merge round=29)
[S7] round=47 local utility u=0.017699 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0987673602613575, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1341644753454636, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=47 head_norm_before_train=1.903839 cos_to_last_merge=0.9889 (last merge round=32)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7779470735767785, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7742171069233251, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.896582 cos_to_last_merge=0.9781 (last merge round=32)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.124218668439563, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.099654893315058, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.181498 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.8853710506258983, 'psi': 0.24964166268514096}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.870940405325912, 'psi': 0.24964166268514096}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.984679 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0350745859062025, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0198939452602183, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.854357 cos_to_last_merge=0.9979 (last merge round=33)
[S13] round=47 local utility u=0.007009 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5800087185400615, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5940260890004925, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=47 head_norm_before_train=2.072232 cos_to_last_merge=0.9845 (last merge round=26)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.625122884096081, 'psi': 0.1355297641332834}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.588427528200472, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.879089 cos_to_last_merge=0.9861 (last merge round=33)
[S15] round=47 local utility u=0.052037 metrics={'f1_val': 0.617721697935218, 'auprc': 0.617721697935218, 'loss_val': 0.32727498339497696, 'psi': 0.617721697935218}-{'f1_val': 0.6174450213799425, 'auprc': 0.6174450213799425, 'loss_val': 0.42885814908856673, 'psi': 0.6174450213799425}
[S15] not sending this round → trigger blocked (psi=0.618)
[S16] START round=47 head_norm_before_train=1.944359 cos_to_last_merge=0.9790 (last merge round=33)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.1557963317045535, 'auprc': 0.1557963317045535, 'loss_val': 3.7906511718834537, 'psi': 0.1557963317045535}-{'f1_val': 0.17691785471826205, 'auprc': 0.17691785471826205, 'loss_val': 3.231736787681523, 'psi': 0.17691785471826205}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.996431 (no previous merge yet)
[S17] round=47 local utility u=0.302188 metrics={'f1_val': 0.3773030022629202, 'auprc': 0.3773030022629202, 'loss_val': 1.1111356213847468, 'psi': 0.3773030022629202}-{'f1_val': 0.3179970632674342, 'auprc': 0.3179970632674342, 'loss_val': 1.1817579290587885, 'psi': 0.3179970632674342}
[S17] not sending this round → trigger blocked (psi=0.377)
[S2] START round=48 head_norm_before_train=1.879303 cos_to_last_merge=0.9645 (last merge round=26)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.3691056932893804, 'psi': 0.245119570522206}-{'f1_val': 0.2455690013445789, 'auprc': 0.2455690013445789, 'loss_val': 2.31652051965645, 'psi': 0.24556900134457893}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.983183 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.2958504331965344, 'auprc': 0.2958504331965344, 'loss_val': 3.6873290643187726, 'psi': 0.2958504331965344}-{'f1_val': 0.2961142961142961, 'auprc': 0.2961142961142961, 'loss_val': 3.6503668843928962, 'psi': 0.2961142961142961}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.933410 cos_to_last_merge=0.9922 (last merge round=31)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4759496519161737, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4649897762592217, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.830940 cos_to_last_merge=0.9297 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.930
[S5] round=48 local utility u=0.000677 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.52823531689255, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.529590065443635, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=48 head_norm_before_train=1.666708 cos_to_last_merge=0.9381 (last merge round=26)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=48 local utility u=0.064591 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 5.46039075836885, 'psi': 0.022186642268984445}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.549865600524836, 'psi': 0.017774699907663897}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=48 head_norm_before_train=1.768045 cos_to_last_merge=0.9931 (last merge round=29)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 1.0455876404750026, 'psi': 0.23946016959273855}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0987673602613575, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.917779 cos_to_last_merge=0.9882 (last merge round=32)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7826284472429328, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7779470735767785, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.904386 cos_to_last_merge=0.9774 (last merge round=32)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1473459248488016, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.124218668439563, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.191758 (no previous merge yet)
[S10] round=48 local utility u=0.366544 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.901207202538161, 'psi': 0.3328555502468546}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.8853710506258983, 'psi': 0.24964166268514096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=48 head_norm_before_train=1.991094 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.046598287281754, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0350745859062025, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.859109 cos_to_last_merge=0.9977 (last merge round=33)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7184126577193126, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5800087185400615, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.077897 cos_to_last_merge=0.9840 (last merge round=26)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.659912589761357, 'psi': 0.1355297641332834}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.625122884096081, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.894009 cos_to_last_merge=0.9850 (last merge round=33)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.35915740553233644, 'psi': 0.6175834097438502}-{'f1_val': 0.617721697935218, 'auprc': 0.617721697935218, 'loss_val': 0.32727498339497696, 'psi': 0.617721697935218}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.953643 cos_to_last_merge=0.9779 (last merge round=33)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.1148105625717566, 'auprc': 0.1148105625717566, 'loss_val': 4.578097406106176, 'psi': 0.11481056257175659}-{'f1_val': 0.1557963317045535, 'auprc': 0.1557963317045535, 'loss_val': 3.7906511718834537, 'psi': 0.1557963317045535}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.006810 (no previous merge yet)
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.6057705802973389, 'auprc': 0.6057705802973389, 'loss_val': 0.8635190079566089, 'psi': 0.6057705802973389}-{'f1_val': 0.3773030022629202, 'auprc': 0.3773030022629202, 'loss_val': 1.1111356213847468, 'psi': 0.3773030022629202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=49 head_norm_before_train=1.886523 cos_to_last_merge=0.9635 (last merge round=26)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.3948041993786253, 'psi': 0.245119570522206}-{'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.3691056932893804, 'psi': 0.245119570522206}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.988731 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.2947098663737873, 'auprc': 0.2947098663737873, 'loss_val': 3.710088410394809, 'psi': 0.2947098663737873}-{'f1_val': 0.2958504331965344, 'auprc': 0.2958504331965344, 'loss_val': 3.6873290643187726, 'psi': 0.2958504331965344}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.941339 cos_to_last_merge=0.9919 (last merge round=31)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4908564549934944, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4759496519161737, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.842615 cos_to_last_merge=0.9285 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.60211414786439, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.52823531689255, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.673023 cos_to_last_merge=0.9370 (last merge round=26)
[S6] ⚠️ Model drifted since last merge! cos=0.937
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.745026180156482, 'psi': 0.01732902033271719}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 5.46039075836885, 'psi': 0.022186642268984445}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.774963 cos_to_last_merge=0.9930 (last merge round=29)
[S7] round=49 local utility u=0.013159 metrics={'f1_val': 0.2389237668161435, 'auprc': 0.2389237668161435, 'loss_val': 1.0144411824677715, 'psi': 0.23892376681614352}-{'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 1.0455876404750026, 'psi': 0.23946016959273855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=49 head_norm_before_train=1.931185 cos_to_last_merge=0.9875 (last merge round=32)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7852352241444267, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7826284472429328, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.911750 cos_to_last_merge=0.9767 (last merge round=32)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1694801045632053, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1473459248488016, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.201211 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.9171127240161923, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.901207202538161, 'psi': 0.3328555502468546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.997417 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0601503444671567, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.046598287281754, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.861277 cos_to_last_merge=0.9975 (last merge round=33)
[S13] round=49 local utility u=0.080436 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5575407313403111, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7184126577193126, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=49 head_norm_before_train=2.083411 cos_to_last_merge=0.9835 (last merge round=26)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.691958367728501, 'psi': 0.1355297641332834}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.659912589761357, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.907846 cos_to_last_merge=0.9840 (last merge round=33)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.39469586974855897, 'psi': 0.6175834097438502}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.35915740553233644, 'psi': 0.6175834097438502}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.961584 cos_to_last_merge=0.9770 (last merge round=33)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.03629668595476065, 'auprc': 0.03629668595476065, 'loss_val': 5.53861743286126, 'psi': 0.03629668595476065}-{'f1_val': 0.1148105625717566, 'auprc': 0.1148105625717566, 'loss_val': 4.578097406106176, 'psi': 0.11481056257175659}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=2.018237 (no previous merge yet)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.3142074679736025, 'auprc': 0.3142074679736025, 'loss_val': 1.397515039921133, 'psi': 0.3142074679736025}-{'f1_val': 0.6057705802973389, 'auprc': 0.6057705802973389, 'loss_val': 0.8635190079566089, 'psi': 0.6057705802973389}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
