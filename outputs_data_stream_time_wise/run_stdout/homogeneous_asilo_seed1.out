[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:36603
[S3] → join 127.0.0.1:36602
[S4] → join 127.0.0.1:36602
[S5] → join 127.0.0.1:36602
[S6] → join 127.0.0.1:36602
[S7] → join 127.0.0.1:36602
[S8] → join 127.0.0.1:36602
[S9] → join 127.0.0.1:36602
[S10] → join 127.0.0.1:36602
[S11] → join 127.0.0.1:36602
[S13] → join 127.0.0.1:36602
[S14] → join 127.0.0.1:36602
[S15] → join 127.0.0.1:36602
[S16] → join 127.0.0.1:36602
[S17] → join 127.0.0.1:36602
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.126359 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.150134 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.142386 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.182619 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.109947 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.190914 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.167009 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.190167 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.143565 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.156642 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.191669 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.180492 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.194657 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.115552 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.155797 (no previous merge yet)
[S14]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4] + discovered S2
[S3] + discovered S5
[S4] + discovered S3
[S3] + discovered S11
[S3] + discovered S15
[S3] + discovered S16
[S3] + discovered S7
[S3] + discovered S8
[S3] + discovered S9
[S3] + discovered S10
[S3] + discovered S4
[S3] + discovered S17
[S3] + discovered S14
[S3] + discovered S13
[S3] + discovered S6
[S4] + discovered S8
[S5] + discovered S4
[S4] + discovered S11
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S14
[S4] + discovered S10
[S4] + discovered S7
[S4] + discovered S6
[S4] + discovered S9
[S5] + discovered S2
[S4] + discovered S5
[S5] + discovered S3
[S4] + discovered S17
[S4] + discovered S15
[S6] + discovered S2
[S6] + discovered S3
[S5] + discovered S15
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S13
[S5] + discovered S14
[S5] + discovered S9
[S5] + discovered S17
[S5] + discovered S10
[S5] + discovered S16
[S5] + discovered S7
[S5] + discovered S8
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S13
[S7] + discovered S4
[S6] + discovered S11
[S7] + discovered S5
[S6] + discovered S10
[S6] + discovered S7
[S6] + discovered S8
[S6] + discovered S15
[S7] + discovered S3
[S6] + discovered S9
[S6] + discovered S17
[S7] + discovered S6
[S6] + discovered S14
[S7] + discovered S2
[S6] + discovered S16
[S7] + discovered S15
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S2
[S7] + discovered S13
[S7] + discovered S14
[S7] + discovered S10
[S7] + discovered S17
[S7] + discovered S9
[S8] + discovered S6
[S7] + discovered S8
[S7] + discovered S16
[S8] + discovered S5
[S8] + discovered S3
[S7] + discovered S11
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S6
[S9] + discovered S3
[S9] + discovered S4
[S9] + discovered S5
[S9] + discovered S8
[S8] + discovered S13
[S8] + discovered S9
[S8] + discovered S16
[S8] + discovered S17
[S8] + discovered S11
[S8] + discovered S14
[S8] + discovered S15
[S8] + discovered S10
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S10
[S9] + discovered S13
[S9] + discovered S15
[S10] + discovered S4
[S10] + discovered S2
[S10] + discovered S5
[S10] + discovered S9
[S10] + discovered S3
[S10] + discovered S8
[S10] + discovered S6
[S10] + discovered S7
[S11] + discovered S4
[S11] + discovered S3
[S10] + discovered S15
[S11] + discovered S2
[S11] + discovered S10
[S11] + discovered S9
[S10] + discovered S13
[S11] + discovered S7
[S11] + discovered S8
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S16
[S11] + discovered S6
[S10] + discovered S14
[S11] + discovered S5
[S13] + discovered S3
[S11] + discovered S15
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S13
[S11] + discovered S14
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S8
[S13] + discovered S6
[S13] + discovered S2
[S13] + discovered S10
[S13] + discovered S9
[S13] + discovered S11
[S13] + discovered S5
[S14] + discovered S7
[S14] + discovered S10
[S13] + discovered S15
[S14] + discovered S2
[S14] + discovered S9
[S13] + discovered S14
[S14] + discovered S11
[S14] + discovered S4
[S14] + discovered S5
[S14] + discovered S3
[S13] + discovered S16
[S14] + discovered S13
[S14] + discovered S8
[S14] + discovered S6
[S13] + discovered S17
[S15] + discovered S6
[S15] + discovered S5
[S15] + discovered S8
[S15] + discovered S9
[S14] + discovered S16
[S15] + discovered S4
[S14] + discovered S17
[S15] + discovered S11
[S15] + discovered S10
[S15] + discovered S7
[S14] + discovered S15
[S15] + discovered S13
[S15] + discovered S14
[S15] + discovered S2
[S15] + discovered S3
[S16] + discovered S8
[S16] + discovered S5
[S16] + discovered S6
[S16] + discovered S9
[S16] + discovered S4
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S7
[S16] + discovered S3
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S13
[S16] + discovered S15
[S16] + discovered S2
[S16] + discovered S11
[S17] + discovered S9
[S17] + discovered S15
[S16] + discovered S17
[S17] + discovered S5
[S17] + discovered S8
[S17] + discovered S2
[S17] + discovered S14
[S17] + discovered S13
[S17] + discovered S4
[S17] + discovered S10
[S17] + discovered S11
[S17] + discovered S16
[S17] + discovered S6
[S17] + discovered S3
[S17] + discovered S7
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=1.000 → S5@127.0.0.1:36605
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:36607
[S8] ⇄ pheromone p=1.000 → S9@127.0.0.1:36610
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S15] ⇄ pheromone p=1.000 → S4@127.0.0.1:36604
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S6] ⇄ pheromone p=1.000 → S4@127.0.0.1:36604
[S4] ⇄ pheromone p=1.000 → S16@127.0.0.1:36616
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S11] ⇄ pheromone p=1.000 → S2@127.0.0.1:36602
[S10] ⇄ pheromone p=1.000 → S6@127.0.0.1:36607
[S5] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S2] ⇄ pheromone p=1.000 → S4@127.0.0.1:36604
[S7] ⇄ pheromone p=1.000 → S6@127.0.0.1:36607
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:36613
[S2] START round=1 head_norm_before_train=1.133086 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.545430040746649, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4749551597307344, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.150984 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4488080032636859, 'psi': 0.0}-{'f1_val': 0.29936178699641003, 'auprc': 0.29936178699641003, 'loss_val': 1.3951223088871525, 'psi': 0.29936178699641003}
[S4] START round=1 head_norm_before_train=1.151681 (no previous merge yet)
[S4] round=1 local utility u=0.270863 metrics={'f1_val': 0.3323854660347551, 'auprc': 0.3323854660347551, 'loss_val': 1.378825360479173, 'psi': 0.3323854660347551}-{'f1_val': 0.2703210382513661, 'auprc': 0.2703210382513661, 'loss_val': 1.3619722694430312, 'psi': 0.2703210382513661}
[S5] START round=1 head_norm_before_train=1.182685 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4851522475907661, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4741170508738892, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.108721 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5668043353757242, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4788022705474375, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.189287 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4920306953215807, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4260116476585274, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.167176 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4625925361345038, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4145832131880924, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.187344 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.470452485070433, 'psi': 0.0}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3799888213880585, 'psi': 0.36867172340800847}
[S10] START round=1 head_norm_before_train=1.146791 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.46352639482384, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4189947292393978, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.159306 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4644284793427025, 'psi': 0.0}-{'f1_val': 0.26342197691921726, 'auprc': 0.26342197691921726, 'loss_val': 1.3987901588888365, 'psi': 0.26342197691921726}
[S13] START round=1 head_norm_before_train=1.202194 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.49846862985535, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4338387927516376, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.183547 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4684649468703699, 'psi': 0.0}-{'f1_val': 0.24698235840297122, 'auprc': 0.24698235840297122, 'loss_val': 1.3785741255804602, 'psi': 0.24698235840297122}
[S15] START round=1 head_norm_before_train=1.202585 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5530406495221138, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4869878542370094, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.110934 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4335643457478957, 'psi': 0.0}-{'f1_val': 0.2899606299212598, 'auprc': 0.2899606299212598, 'loss_val': 1.3708434808887637, 'psi': 0.2899606299212598}
[S17] START round=1 head_norm_before_train=1.149867 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4810639187768544, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4385418132871162, 'psi': 0.0}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:36613
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1790 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1790) from S4
[S13] cosine check vs S4: cos=-0.0162
[S13] DROPPED delta from S4 (cos=-0.0162 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.152494 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.701537434844962, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.545430040746649, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.164847 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5404953475468885, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4488080032636859, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.169833 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.3190789473684211, 'auprc': 0.3190789473684211, 'loss_val': 1.4091575332499078, 'psi': 0.3190789473684211}-{'f1_val': 0.3323854660347551, 'auprc': 0.3323854660347551, 'loss_val': 1.378825360479173, 'psi': 0.3323854660347551}
[S5] START round=2 head_norm_before_train=1.195813 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.513409692380737, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4851522475907661, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.120914 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.703828386546941, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5668043353757242, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.196797 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5987380225649779, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4920306953215807, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.179329 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5579641820554062, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4625925361345038, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.197647 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.627048204071293, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.470452485070433, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.158826 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5252661479952923, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.46352639482384, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.173244 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.578738879043092, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4644284793427025, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.224669 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6445226290747876, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.49846862985535, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.196918 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6570052239567699, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4684649468703699, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.218967 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6883380303828714, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5530406495221138, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.119152 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.531899323319019, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4335643457478957, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.155602 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5488115862973413, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4810639187768544, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.185156 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1550786823314425, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.701537434844962, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.191644 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7637682141082258, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5404953475468885, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.198557 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.31848674804794896, 'auprc': 0.31848674804794896, 'loss_val': 1.4856217303614419, 'psi': 0.31848674804794896}-{'f1_val': 0.3190789473684211, 'auprc': 0.3190789473684211, 'loss_val': 1.4091575332499078, 'psi': 0.3190789473684211}
[S5] START round=3 head_norm_before_train=1.218972 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5993938640838625, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.513409692380737, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.145830 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.024477669662049, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.703828386546941, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.213957 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8410344981050257, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5987380225649779, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.203108 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7437982116539614, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5579641820554062, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.221646 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9809039173621232, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.627048204071293, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.180429 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.650517864924534, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5252661479952923, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.197182 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.898095340546426, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.578738879043092, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.256425 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8645570617069571, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6445226290747876, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.221023 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1902758595501477, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6570052239567699, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.243142 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9884642806198918, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6883380303828714, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.141397 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7466543037729745, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.531899323319019, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.173743 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6933140276823886, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5488115862973413, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.226733 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5867881800560593, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1550786823314425, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.229858 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4355397284345135, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7637682141082258, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.235536 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.3190601668862538, 'auprc': 0.3190601668862538, 'loss_val': 1.6169443560722012, 'psi': 0.3190601668862538}-{'f1_val': 0.31848674804794896, 'auprc': 0.31848674804794896, 'loss_val': 1.4856217303614419, 'psi': 0.31848674804794896}
[S5] START round=4 head_norm_before_train=1.249696 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6983196032865837, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5993938640838625, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.182267 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.557607153784662, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.024477669662049, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.239527 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.143300251631814, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8410344981050257, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.231863 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9851191719929686, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7437982116539614, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.256888 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6762468311745216, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9809039173621232, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.213349 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9438671143966175, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.650517864924534, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.230790 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7065633863473653, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.898095340546426, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.283531 (no previous merge yet)
[S13] round=4 local utility u=0.057712 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.749132742625466, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8645570617069571, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.254863 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.189996409142815, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1902758595501477, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.270581 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1202362426224104, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9884642806198918, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.176463 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.316397002262971, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7466543037729745, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.203512 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9338732148336657, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6933140276823886, 'psi': 0.0}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.258792 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6124079203373305, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5867881800560593, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.275197 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1820400317543704, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4355397284345135, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.268634 (no previous merge yet)
[S4] round=5 local utility u=0.040888 metrics={'f1_val': 0.32247557003257327, 'auprc': 0.32247557003257327, 'loss_val': 1.5659072051791985, 'psi': 0.32247557003257327}-{'f1_val': 0.3190601668862538, 'auprc': 0.3190601668862538, 'loss_val': 1.6169443560722012, 'psi': 0.3190601668862538}
[S5] START round=5 head_norm_before_train=1.275177 (no previous merge yet)
[S5] round=5 local utility u=0.045301 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6077170649556327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6983196032865837, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.216969 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.810631700828112, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.557607153784662, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.260689 (no previous merge yet)
[S7] round=5 local utility u=0.051807 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.039686363074611, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.143300251631814, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.259641 (no previous merge yet)
[S8] round=5 local utility u=0.090360 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.804399937495198, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9851191719929686, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.293325 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.856333243014186, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6762468311745216, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.248376 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9796294849579512, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9438671143966175, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.269510 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.181127824809644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7065633863473653, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.290329 (no previous merge yet)
[S13] round=5 local utility u=0.075122 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5988889597288984, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.749132742625466, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.291670 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.304068157917631, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.189996409142815, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.286846 (no previous merge yet)
[S15] round=5 local utility u=0.132271 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8556932898863265, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1202362426224104, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.219801 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9493248200064106, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.316397002262971, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.236196 (no previous merge yet)
[S17] round=5 local utility u=0.070962 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7919500799883932, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9338732148336657, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:36616
[S15] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S4
[S16] cosine check vs S4: cos=0.1017
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] ⇄ pheromone p=0.328 → S4@127.0.0.1:36604
[S9] ⇄ pheromone p=0.328 → S5@127.0.0.1:36605
[S3] ⇄ pheromone p=0.328 → S6@127.0.0.1:36607
[S13] ⇄ pheromone p=0.352 → S7@127.0.0.1:36608
[S14] ⇄ pheromone p=0.328 → S7@127.0.0.1:36608
[S15] ⇄ pheromone p=0.354 → S4@127.0.0.1:36604
[S6] ⇄ pheromone p=0.328 → S4@127.0.0.1:36604
[S5] ⇄ pheromone p=0.337 → S7@127.0.0.1:36608
[S10] ⇄ pheromone p=0.328 → S6@127.0.0.1:36607
[S11] ⇄ pheromone p=0.328 → S2@127.0.0.1:36602
[S7] ⇄ pheromone p=0.338 → S6@127.0.0.1:36607
[S8] ⇄ pheromone p=0.346 → S9@127.0.0.1:36610
[S4] ⇄ pheromone p=0.358 → S16@127.0.0.1:36616
[S17] ⇄ pheromone p=0.342 → S13@127.0.0.1:36613
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.0000 head_norm=1.257738
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.527790e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.0000 head_norm=0.944389 delta_norm=0.852779
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.328 → S7@127.0.0.1:36608
[S2] START round=6 head_norm_before_train=1.288409 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7858588004555833, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6124079203373305, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.312103 (no previous merge yet)
[S3] round=6 local utility u=0.104083 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9738749700562614, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1820400317543704, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.286974 (no previous merge yet)
[S4] round=6 local utility u=0.097508 metrics={'f1_val': 0.3318658280922432, 'auprc': 0.3318658280922432, 'loss_val': 1.4554044857860613, 'psi': 0.3318658280922432}-{'f1_val': 0.32247557003257327, 'auprc': 0.32247557003257327, 'loss_val': 1.5659072051791985, 'psi': 0.32247557003257327}
[S5] START round=6 head_norm_before_train=1.284983 (no previous merge yet)
[S5] round=6 local utility u=0.041879 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5239598207438472, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6077170649556327, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.244735 (no previous merge yet)
[S6] round=6 local utility u=0.050272 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7100882087442146, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.810631700828112, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.266224 (no previous merge yet)
[S7] round=6 local utility u=0.094462 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8507614034840176, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.039686363074611, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.268827 (no previous merge yet)
[S8] round=6 local utility u=0.095410 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6135798627036568, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.804399937495198, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.314029 (no previous merge yet)
[S9] round=6 local utility u=0.106554 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.643225319388792, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.856333243014186, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.270111 (no previous merge yet)
[S10] round=6 local utility u=0.105203 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7692228108344081, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9796294849579512, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.298310 (no previous merge yet)
[S11] round=6 local utility u=0.122351 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9364265179984614, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.181127824809644, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.293456 (no previous merge yet)
[S13] round=6 local utility u=0.028134 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5426210892643406, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5988889597288984, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.309904 (no previous merge yet)
[S14] round=6 local utility u=0.000680 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.302709151817026, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.304068157917631, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.289813 (no previous merge yet)
[S15] round=6 local utility u=0.028559 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7985745406197216, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8556932898863265, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=0.944389 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.325721 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2978832884505156, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9493248200064106, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.250164 (no previous merge yet)
[S17] round=6 local utility u=0.079364 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6332222793704407, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7919500799883932, 'psi': 0.0}
[S14] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:36616
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S4] sending update (kind=head size=1791 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1791) from S4
[S16] cosine check vs S4: cos=0.7308
[S17] not sending this round → trigger blocked (psi=0.000)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.0000 head_norm=0.971649
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.467406e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.0000 head_norm=1.062466 delta_norm=0.446741
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.326551 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.229172566802557, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7858588004555833, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.334315 (no previous merge yet)
[S3] round=7 local utility u=0.277187 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4195000358784675, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9738749700562614, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.308710 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.2339466489322397, 'auprc': 0.2339466489322397, 'loss_val': 1.3821015756893373, 'psi': 0.2339466489322397}-{'f1_val': 0.3318658280922432, 'auprc': 0.3318658280922432, 'loss_val': 1.4554044857860613, 'psi': 0.3318658280922432}
[S5] START round=7 head_norm_before_train=1.302727 (no previous merge yet)
[S5] round=7 local utility u=0.105653 metrics={'f1_val': 0.011830033800096573, 'auprc': 0.011830033800096573, 'loss_val': 1.4191237097016656, 'psi': 0.011830033800096573}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5239598207438472, 'psi': 0.0}
[S6] START round=7 head_norm_before_train=1.272857 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2019940249689225, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7100882087442146, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.268594 (no previous merge yet)
[S7] round=7 local utility u=0.073585 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7035912436335197, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8507614034840176, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.279345 (no previous merge yet)
[S8] round=7 local utility u=0.051833 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5099138965490766, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6135798627036568, 'psi': 0.0}
[S9] START round=7 head_norm_before_train=1.330989 (no previous merge yet)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6652976921773295, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.643225319388792, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.282873 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9917847396088546, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7692228108344081, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.314892 (no previous merge yet)
[S11] round=7 local utility u=0.103375 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.729676122200266, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9364265179984614, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.308232 (no previous merge yet)
[S13] round=7 local utility u=0.000016 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5425887986841307, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5426210892643406, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.329314 (no previous merge yet)
[S14] round=7 local utility u=0.024755 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2531996023128786, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.302709151817026, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.303532 (no previous merge yet)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8187341079348043, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7985745406197216, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.062466 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.068200 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.161482591029272, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2978832884505156, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.265820 (no previous merge yet)
[S17] round=7 local utility u=0.033364 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.566494758653228, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6332222793704407, 'psi': 0.0}
[S14] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.012)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=8 head_norm_before_train=1.371413 (no previous merge yet)
[S2] round=8 local utility u=0.187363 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8544464561903857, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.229172566802557, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.354996 (no previous merge yet)
[S3] round=8 local utility u=0.014915 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3896701931508515, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4195000358784675, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.340786 (no previous merge yet)
[S4] round=8 local utility u=0.366052 metrics={'f1_val': 0.3080965356169716, 'auprc': 0.3080965356169716, 'loss_val': 1.3173467723097565, 'psi': 0.3080965356169716}-{'f1_val': 0.2339466489322397, 'auprc': 0.2339466489322397, 'loss_val': 1.3821015756893373, 'psi': 0.2339466489322397}
[S5] START round=8 head_norm_before_train=1.320251 (no previous merge yet)
[S5] round=8 local utility u=0.864753 metrics={'f1_val': 0.1965251768622555, 'auprc': 0.1965251768622555, 'loss_val': 1.3518748748322544, 'psi': 0.1965251768622555}-{'f1_val': 0.011830033800096573, 'auprc': 0.011830033800096573, 'loss_val': 1.4191237097016656, 'psi': 0.011830033800096573}
[S6] START round=8 head_norm_before_train=1.310220 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4526500848760904, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2019940249689225, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.271556 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7488457732064893, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7035912436335197, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.302611 (no previous merge yet)
[S8] round=8 local utility u=1.000000 metrics={'f1_val': 0.24038995601194255, 'auprc': 0.24038995601194255, 'loss_val': 1.3803235413086332, 'psi': 0.24038995601194255}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5099138965490766, 'psi': 0.0}
[S9] START round=8 head_norm_before_train=1.358643 (no previous merge yet)
[S9] round=8 local utility u=0.040405 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5844871915945586, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6652976921773295, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.315467 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.515932014586442, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9917847396088546, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.332900 (no previous merge yet)
[S11] round=8 local utility u=0.112915 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5038451306516483, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.729676122200266, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.331611 (no previous merge yet)
[S13] round=8 local utility u=0.073330 metrics={'f1_val': 0.0061698327650592626, 'auprc': 0.0061698327650592626, 'loss_val': 1.4514565578587513, 'psi': 0.0061698327650592626}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5425887986841307, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.346540 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4631666194773563, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2531996023128786, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.325602 (no previous merge yet)
[S15] round=8 local utility u=0.122093 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5745475637137765, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8187341079348043, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.087627 cos_to_last_merge=0.9972 (last merge round=6)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3860137030282984, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.161482591029272, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.294944 (no previous merge yet)
[S17] round=8 local utility u=0.079246 metrics={'f1_val': 0.004917184265010352, 'auprc': 0.004917184265010352, 'loss_val': 1.4522581574810052, 'psi': 0.004917184265010352}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.566494758653228, 'psi': 0.0}
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.197)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:36610
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.006)
[S15] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] cosine check vs S8: cos=0.0563
[S16] RECEIVED delta(kind=head bytes=1793) from S4
[S16] cosine check vs S4: cos=0.9106
[S17] not sending this round → trigger blocked (psi=0.005)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.0000 head_norm=1.389761
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.345126e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.0000 head_norm=0.988670 delta_norm=0.934513
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.0000 head_norm=1.123677
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.909485e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.220889 delta_norm=0.290949
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.413131 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.270512166814458, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8544464561903857, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.385757 (no previous merge yet)
[S3] round=9 local utility u=0.026533 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3366034052630575, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3896701931508515, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.373969 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.22241038667795654, 'auprc': 0.22241038667795654, 'loss_val': 1.292762952013782, 'psi': 0.22241038667795654}-{'f1_val': 0.3080965356169716, 'auprc': 0.3080965356169716, 'loss_val': 1.3173467723097565, 'psi': 0.3080965356169716}
[S5] START round=9 head_norm_before_train=1.340012 (no previous merge yet)
[S5] round=9 local utility u=0.756974 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.3032499723247855, 'psi': 0.35933890172383154}-{'f1_val': 0.1965251768622555, 'auprc': 0.1965251768622555, 'loss_val': 1.3518748748322544, 'psi': 0.1965251768622555}
[S6] START round=9 head_norm_before_train=1.351099 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.9012216584119495, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4526500848760904, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.287930 (no previous merge yet)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8698925399691213, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7488457732064893, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.330462 (no previous merge yet)
[S8] round=9 local utility u=0.329401 metrics={'f1_val': 0.3020274028204328, 'auprc': 0.3020274028204328, 'loss_val': 1.2762575768951472, 'psi': 0.3020274028204328}-{'f1_val': 0.24038995601194255, 'auprc': 0.24038995601194255, 'loss_val': 1.3803235413086332, 'psi': 0.24038995601194255}
[S9] START round=9 head_norm_before_train=0.988670 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.291296 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.001895286002194, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5844871915945586, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.355933 (no previous merge yet)
[S10] round=9 local utility u=0.087533 metrics={'f1_val': 0.039207048458149776, 'auprc': 0.039207048458149776, 'loss_val': 2.693729343428784, 'psi': 0.039207048458149776}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.515932014586442, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.355114 (no previous merge yet)
[S11] round=9 local utility u=0.051697 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.400450251266344, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5038451306516483, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.349347 (no previous merge yet)
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.27248062015503877, 'auprc': 0.27248062015503877, 'loss_val': 1.3321422399567002, 'psi': 0.27248062015503877}-{'f1_val': 0.0061698327650592626, 'auprc': 0.0061698327650592626, 'loss_val': 1.4514565578587513, 'psi': 0.0061698327650592626}
[S14] START round=9 head_norm_before_train=1.369652 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8113690244807596, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4631666194773563, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.344359 (no previous merge yet)
[S15] round=9 local utility u=0.061526 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4514952642584231, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5745475637137765, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.220889 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.075134 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2357463691516495, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3860137030282984, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.327639 (no previous merge yet)
[S17] round=9 local utility u=0.919806 metrics={'f1_val': 0.1989111167384148, 'auprc': 0.1989111167384148, 'loss_val': 1.3585913880705665, 'psi': 0.1989111167384148}-{'f1_val': 0.004917184265010352, 'auprc': 0.004917184265010352, 'loss_val': 1.4522581574810052, 'psi': 0.004917184265010352}
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:36608
[S15] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:36610
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.039)
[S13] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S5
[S7] cosine check vs S5: cos=-0.0101
[S7] DROPPED delta from S5 (cos=-0.0101 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] cosine check vs S13: cos=-0.0470
[S7] DROPPED delta from S13 (cos=-0.0470 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S8
[S9] cosine check vs S8: cos=0.6925
[S17] not sending this round → trigger blocked (psi=0.199)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.0000 head_norm=1.026665
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.926214e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.100032 delta_norm=0.492621
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.447599 (no previous merge yet)
[S2] round=10 local utility u=1.000000 metrics={'f1_val': 0.14657182835820895, 'auprc': 0.14657182835820895, 'loss_val': 2.2793661003564756, 'psi': 0.14657182835820895}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.270512166814458, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.420152 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5032242774864093, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3366034052630575, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.408916 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.17259675405742822, 'auprc': 0.17259675405742822, 'loss_val': 1.2957126026094477, 'psi': 0.17259675405742822}-{'f1_val': 0.22241038667795654, 'auprc': 0.22241038667795654, 'loss_val': 1.292762952013782, 'psi': 0.22241038667795654}
[S5] START round=10 head_norm_before_train=1.364763 (no previous merge yet)
[S5] round=10 local utility u=0.020259 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2627319672781567, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.3032499723247855, 'psi': 0.35933890172383154}
[S6] START round=10 head_norm_before_train=1.394917 (no previous merge yet)
[S6] round=10 local utility u=0.328901 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2434205604703803, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.9012216584119495, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.308689 (no previous merge yet)
[S7] round=10 local utility u=0.082892 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7041076747349597, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8698925399691213, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.360680 (no previous merge yet)
[S8] round=10 local utility u=0.272712 metrics={'f1_val': 0.3553355912646084, 'auprc': 0.3553355912646084, 'loss_val': 1.2106080211738286, 'psi': 0.3553355912646084}-{'f1_val': 0.3020274028204328, 'auprc': 0.3020274028204328, 'loss_val': 1.2762575768951472, 'psi': 0.3020274028204328}
[S9] START round=10 head_norm_before_train=1.100032 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.040889 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9201182578887208, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.001895286002194, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.391375 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1407183382497093, 'psi': 0.0}-{'f1_val': 0.039207048458149776, 'auprc': 0.039207048458149776, 'loss_val': 2.693729343428784, 'psi': 0.039207048458149776}
[S11] START round=10 head_norm_before_train=1.386170 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.42398393564701, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.400450251266344, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.363806 (no previous merge yet)
[S13] round=10 local utility u=0.189756 metrics={'f1_val': 0.30888302550571684, 'auprc': 0.30888302550571684, 'loss_val': 1.2802525416672343, 'psi': 0.30888302550571684}-{'f1_val': 0.27248062015503877, 'auprc': 0.27248062015503877, 'loss_val': 1.3321422399567002, 'psi': 0.27248062015503877}
[S14] START round=10 head_norm_before_train=1.397575 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.5944975961544765, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8113690244807596, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.369361 (no previous merge yet)
[S15] round=10 local utility u=1.000000 metrics={'f1_val': 0.2311792625045637, 'auprc': 0.2311792625045637, 'loss_val': 1.298103136724542, 'psi': 0.23117926250456372}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4514952642584231, 'psi': 0.0}
[S16] START round=10 head_norm_before_train=1.252044 cos_to_last_merge=0.9974 (last merge round=8)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.451300167485675, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2357463691516495, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.359722 (no previous merge yet)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.1553599683544304, 'auprc': 0.1553599683544304, 'loss_val': 1.316598624381717, 'psi': 0.1553599683544304}-{'f1_val': 0.1989111167384148, 'auprc': 0.1989111167384148, 'loss_val': 1.3585913880705665, 'psi': 0.1989111167384148}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:36610
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.147)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[S9] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] cosine check vs S8: cos=0.9203
[S4] RECEIVED delta(kind=head bytes=1793) from S15
[S4] cosine check vs S15: cos=-0.0113
[S4] DROPPED delta from S15 (cos=-0.0113 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S5
[S7] cosine check vs S5: cos=-0.0117
[S7] DROPPED delta from S5 (cos=-0.0117 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=-0.0450
[S7] DROPPED delta from S13 (cos=-0.0450 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.331 → S4@127.0.0.1:36604
[S3] ⇄ pheromone p=0.150 → S6@127.0.0.1:36607
[S6] ⇄ pheromone p=0.177 → S4@127.0.0.1:36604
[S10] ⇄ pheromone p=0.130 → S6@127.0.0.1:36607
[S7] ⇄ pheromone p=0.143 → S6@127.0.0.1:36607
[S4] ⇄ pheromone p=0.172 → S16@127.0.0.1:36616
[S11] ⇄ pheromone p=0.151 → S2@127.0.0.1:36602
[S14] ⇄ pheromone p=0.110 → S7@127.0.0.1:36608
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.0000 head_norm=1.132527
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.823552e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.237432 delta_norm=0.282355
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.176 → S5@127.0.0.1:36605
[S8] ⇄ pheromone p=0.362 → S9@127.0.0.1:36610
[S15] ⇄ pheromone p=0.344 → S4@127.0.0.1:36604
[S5] ⇄ pheromone p=0.360 → S7@127.0.0.1:36608
[S13] ⇄ pheromone p=0.325 → S7@127.0.0.1:36608
[S16] ⇄ pheromone p=0.153 → S7@127.0.0.1:36608
[S17] ⇄ pheromone p=0.279 → S13@127.0.0.1:36613
[S2] START round=11 head_norm_before_train=1.474889 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1060101202701946, 'psi': 0.0}-{'f1_val': 0.14657182835820895, 'auprc': 0.14657182835820895, 'loss_val': 2.2793661003564756, 'psi': 0.14657182835820895}
[S3] START round=11 head_norm_before_train=1.456438 (no previous merge yet)
[S3] round=11 local utility u=0.144674 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.21387607031007, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5032242774864093, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.443679 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3142265403874982, 'psi': 0.0}-{'f1_val': 0.17259675405742822, 'auprc': 0.17259675405742822, 'loss_val': 1.2957126026094477, 'psi': 0.17259675405742822}
[S5] START round=11 head_norm_before_train=1.387994 (no previous merge yet)
[S5] round=11 local utility u=0.014730 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.233271638945405, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2627319672781567, 'psi': 0.35933890172383154}
[S6] START round=11 head_norm_before_train=1.434592 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.013280521901211557, 'auprc': 0.013280521901211557, 'loss_val': 3.480879737395013, 'psi': 0.013280521901211557}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2434205604703803, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.322710 (no previous merge yet)
[S7] round=11 local utility u=0.077187 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.549733473136381, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7041076747349597, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.392589 (no previous merge yet)
[S8] round=11 local utility u=0.006895 metrics={'f1_val': 0.34891595187276314, 'auprc': 0.34891595187276314, 'loss_val': 1.1390419197050061, 'psi': 0.34891595187276314}-{'f1_val': 0.3553355912646084, 'auprc': 0.3553355912646084, 'loss_val': 1.2106080211738286, 'psi': 0.3553355912646084}
[S9] START round=11 head_norm_before_train=1.237432 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.151863 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6163921826303727, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9201182578887208, 'psi': 0.0}
[S10] START round=11 head_norm_before_train=1.431865 (no previous merge yet)
[S10] round=11 local utility u=0.129011 metrics={'f1_val': 0.05920775389801938, 'auprc': 0.05920775389801938, 'loss_val': 3.415566561644542, 'psi': 0.05920775389801938}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1407183382497093, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.422321 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.619978314190933, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.42398393564701, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.384160 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.2886509635974304, 'auprc': 0.2886509635974304, 'loss_val': 1.2322698694300294, 'psi': 0.2886509635974304}-{'f1_val': 0.30888302550571684, 'auprc': 0.30888302550571684, 'loss_val': 1.2802525416672343, 'psi': 0.30888302550571684}
[S14] START round=11 head_norm_before_train=1.429670 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.009056400951533, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.5944975961544765, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.397512 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.22198850091151312, 'auprc': 0.22198850091151312, 'loss_val': 1.24144174080431, 'psi': 0.22198850091151312}-{'f1_val': 0.2311792625045637, 'auprc': 0.2311792625045637, 'loss_val': 1.298103136724542, 'psi': 0.23117926250456372}
[S16] START round=11 head_norm_before_train=1.288894 cos_to_last_merge=0.9913 (last merge round=8)
[S16] round=11 local utility u=0.335832 metrics={'f1_val': 0.08696490551484767, 'auprc': 0.08696490551484767, 'loss_val': 2.5623202222811785, 'psi': 0.08696490551484767}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.451300167485675, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.392182 (no previous merge yet)
[S17] round=11 local utility u=0.036207 metrics={'f1_val': 0.16310215946843853, 'auprc': 0.16310215946843853, 'loss_val': 1.3138642147626656, 'psi': 0.16310215946843853}-{'f1_val': 0.1553599683544304, 'auprc': 0.1553599683544304, 'loss_val': 1.316598624381717, 'psi': 0.1553599683544304}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:36610
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.059)
[S16] not sending this round → trigger blocked (psi=0.087)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S8
[S9] cosine check vs S8: cos=0.9678
[S7] RECEIVED delta(kind=head bytes=1799) from S5
[S7] cosine check vs S5: cos=-0.0146
[S7] DROPPED delta from S5 (cos=-0.0146 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.163)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.0000 head_norm=1.266422
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.888312e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.336385 delta_norm=0.188831
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.501028 (no previous merge yet)
[S2] round=12 local utility u=1.000000 metrics={'f1_val': 0.26526704958077507, 'auprc': 0.26526704958077507, 'loss_val': 2.262558524353895, 'psi': 0.26526704958077507}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1060101202701946, 'psi': 0.0}
[S3] START round=12 head_norm_before_train=1.485593 (no previous merge yet)
[S3] round=12 local utility u=0.044922 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1240319124519185, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.21387607031007, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.476504 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3353164155857646, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3142265403874982, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.416597 (no previous merge yet)
[S5] round=12 local utility u=0.017239 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1987945742391195, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.233271638945405, 'psi': 0.35933890172383154}
[S6] START round=12 head_norm_before_train=1.473994 (no previous merge yet)
[S6] round=12 local utility u=0.214807 metrics={'f1_val': 0.0656964656964657, 'auprc': 0.0656964656964657, 'loss_val': 3.523008862255537, 'psi': 0.0656964656964657}-{'f1_val': 0.013280521901211557, 'auprc': 0.013280521901211557, 'loss_val': 3.480879737395013, 'psi': 0.013280521901211557}
[S7] START round=12 head_norm_before_train=1.336151 (no previous merge yet)
[S7] round=12 local utility u=0.044990 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4597535591749444, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.549733473136381, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.428055 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.32657432674478176, 'auprc': 0.32657432674478176, 'loss_val': 1.0602140658936636, 'psi': 0.32657432674478176}-{'f1_val': 0.34891595187276314, 'auprc': 0.34891595187276314, 'loss_val': 1.1390419197050061, 'psi': 0.34891595187276314}
[S9] START round=12 head_norm_before_train=1.336385 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.080333 metrics={'f1_val': 0.006285819929746719, 'auprc': 0.006285819929746719, 'loss_val': 1.512297598743585, 'psi': 0.006285819929746719}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6163921826303727, 'psi': 0.0}
[S10] START round=12 head_norm_before_train=1.469945 (no previous merge yet)
[S10] round=12 local utility u=0.260213 metrics={'f1_val': 0.1388121546961326, 'auprc': 0.1388121546961326, 'loss_val': 3.611579773850891, 'psi': 0.1388121546961326}-{'f1_val': 0.05920775389801938, 'auprc': 0.05920775389801938, 'loss_val': 3.415566561644542, 'psi': 0.05920775389801938}
[S11] START round=12 head_norm_before_train=1.457332 (no previous merge yet)
[S11] round=12 local utility u=0.137968 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.344043048139811, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.619978314190933, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.410887 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.240468168114914, 'auprc': 0.240468168114914, 'loss_val': 1.1876862704395341, 'psi': 0.240468168114914}-{'f1_val': 0.2886509635974304, 'auprc': 0.2886509635974304, 'loss_val': 1.2322698694300294, 'psi': 0.2886509635974304}
[S14] START round=12 head_norm_before_train=1.461765 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.185680877184075, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.009056400951533, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.427216 (no previous merge yet)
[S15] round=12 local utility u=0.107622 metrics={'f1_val': 0.24177166857579227, 'auprc': 0.24177166857579227, 'loss_val': 1.2042468340934243, 'psi': 0.24177166857579227}-{'f1_val': 0.22198850091151312, 'auprc': 0.22198850091151312, 'loss_val': 1.24144174080431, 'psi': 0.22198850091151312}
[S16] START round=12 head_norm_before_train=1.324725 cos_to_last_merge=0.9842 (last merge round=8)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.00018611576400521124, 'auprc': 0.00018611576400521124, 'loss_val': 3.3134201741754046, 'psi': 0.00018611576400521124}-{'f1_val': 0.08696490551484767, 'auprc': 0.08696490551484767, 'loss_val': 2.5623202222811785, 'psi': 0.08696490551484767}
[S17] START round=12 head_norm_before_train=1.422029 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2648654609455414, 'psi': 0.15234678044996122}-{'f1_val': 0.16310215946843853, 'auprc': 0.16310215946843853, 'loss_val': 1.3138642147626656, 'psi': 0.16310215946843853}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.066)
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.139)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:36604
[S9] not sending this round → trigger blocked (psi=0.006)
[S5] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] cosine check vs S2: cos=0.0468
[S4] RECEIVED delta(kind=head bytes=1801) from S15
[S4] cosine check vs S15: cos=-0.0037
[S4] DROPPED delta from S15 (cos=-0.0037 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S5
[S7] cosine check vs S5: cos=-0.0181
[S7] DROPPED delta from S5 (cos=-0.0181 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.0000 head_norm=1.507134
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.046871e+00
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.097104 delta_norm=1.046871
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.525680 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.19729282305969423, 'auprc': 0.19729282305969423, 'loss_val': 2.941741006204626, 'psi': 0.19729282305969423}-{'f1_val': 0.26526704958077507, 'auprc': 0.26526704958077507, 'loss_val': 2.262558524353895, 'psi': 0.26526704958077507}
[S3] START round=13 head_norm_before_train=1.510219 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.222553853062148, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1240319124519185, 'psi': 0.0}
[S4] START round=13 head_norm_before_train=1.097104 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.001377 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3325629870470121, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3353164155857646, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.446729 (no previous merge yet)
[S5] round=13 local utility u=0.075032 metrics={'f1_val': 0.3724165228557028, 'auprc': 0.3724165228557028, 'loss_val': 1.1664297602633376, 'psi': 0.3724165228557028}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1987945742391195, 'psi': 0.35933890172383154}
[S6] START round=13 head_norm_before_train=1.510966 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.028229448961156277, 'auprc': 0.028229448961156277, 'loss_val': 4.257959815340453, 'psi': 0.028229448961156277}-{'f1_val': 0.0656964656964657, 'auprc': 0.0656964656964657, 'loss_val': 3.523008862255537, 'psi': 0.0656964656964657}
[S7] START round=13 head_norm_before_train=1.352924 (no previous merge yet)
[S7] round=13 local utility u=0.541560 metrics={'f1_val': 0.1123731271145481, 'auprc': 0.1123731271145481, 'loss_val': 1.3879916842794842, 'psi': 0.1123731271145481}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4597535591749444, 'psi': 0.0}
[S8] START round=13 head_norm_before_train=1.458532 (no previous merge yet)
[S8] round=13 local utility u=0.900298 metrics={'f1_val': 0.5184500977427644, 'auprc': 0.5184500977427644, 'loss_val': 0.9864993999333206, 'psi': 0.5184500977427644}-{'f1_val': 0.32657432674478176, 'auprc': 0.32657432674478176, 'loss_val': 1.0602140658936636, 'psi': 0.32657432674478176}
[S9] START round=13 head_norm_before_train=1.367367 cos_to_last_merge=0.9970 (last merge round=11)
[S9] round=13 local utility u=1.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.367163801322213, 'psi': 0.36867172340800847}-{'f1_val': 0.006285819929746719, 'auprc': 0.006285819929746719, 'loss_val': 1.512297598743585, 'psi': 0.006285819929746719}
[S10] START round=13 head_norm_before_train=1.503178 (no previous merge yet)
[S10] round=13 local utility u=0.331816 metrics={'f1_val': 0.20190937589056712, 'auprc': 0.20190937589056712, 'loss_val': 3.5158220190509817, 'psi': 0.20190937589056712}-{'f1_val': 0.1388121546961326, 'auprc': 0.1388121546961326, 'loss_val': 3.611579773850891, 'psi': 0.1388121546961326}
[S11] START round=13 head_norm_before_train=1.485239 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5301186192859735, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.344043048139811, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.440556 (no previous merge yet)
[S13] round=13 local utility u=0.540516 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1818678968510465, 'psi': 0.3599362944611573}-{'f1_val': 0.240468168114914, 'auprc': 0.240468168114914, 'loss_val': 1.1876862704395341, 'psi': 0.240468168114914}
[S14] START round=13 head_norm_before_train=1.489030 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.339612949175881, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.185680877184075, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.457274 (no previous merge yet)
[S15] round=13 local utility u=0.054877 metrics={'f1_val': 0.250019742557056, 'auprc': 0.250019742557056, 'loss_val': 1.1687257827718456, 'psi': 0.250019742557056}-{'f1_val': 0.24177166857579227, 'auprc': 0.24177166857579227, 'loss_val': 1.2042468340934243, 'psi': 0.24177166857579227}
[S16] START round=13 head_norm_before_train=1.356676 cos_to_last_merge=0.9780 (last merge round=8)
[S16] round=13 local utility u=1.000000 metrics={'f1_val': 0.20050424628450106, 'auprc': 0.20050424628450106, 'loss_val': 2.0338135948475933, 'psi': 0.20050424628450106}-{'f1_val': 0.00018611576400521124, 'auprc': 0.00018611576400521124, 'loss_val': 3.3134201741754046, 'psi': 0.00018611576400521124}
[S17] START round=13 head_norm_before_train=1.450864 (no previous merge yet)
[S17] round=13 local utility u=0.029142 metrics={'f1_val': 0.15891159215051587, 'auprc': 0.15891159215051587, 'loss_val': 1.265665533450682, 'psi': 0.15891159215051587}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2648654609455414, 'psi': 0.15234678044996122}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[S7] not sending this round → trigger blocked (psi=0.112)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=0.0835
[S6] RECEIVED delta(kind=head bytes=1805) from S10
[S6] cosine check vs S10: cos=-0.0282
[S6] DROPPED delta from S10 (cos=-0.0282 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] cosine check vs S13: cos=-0.0447
[S7] DROPPED delta from S13 (cos=-0.0447 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S5
[S7] cosine check vs S5: cos=-0.0224
[S7] DROPPED delta from S5 (cos=-0.0224 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=-0.0276
[S7] DROPPED delta from S16 (cos=-0.0276 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S15
[S4] cosine check vs S15: cos=-0.0107
[S4] DROPPED delta from S15 (cos=-0.0107 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S8
[S9] cosine check vs S8: cos=0.9615
[S17] not sending this round → trigger blocked (psi=0.159)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.3724 head_norm=1.478861
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.773521e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.2405 head_norm=1.062591 delta_norm=0.977352
[S5] aggregate: ROLLBACK (f1_val pre=0.372 post=0.240 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.3687 head_norm=1.407695
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.050246e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.3687 head_norm=1.434277 delta_norm=0.205025
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.550851 (no previous merge yet)
[S2] round=14 local utility u=0.628018 metrics={'f1_val': 0.26521452145214525, 'auprc': 0.26521452145214525, 'loss_val': 2.2970011156842975, 'psi': 0.26521452145214525}-{'f1_val': 0.19729282305969423, 'auprc': 0.19729282305969423, 'loss_val': 2.941741006204626, 'psi': 0.19729282305969423}
[S3] START round=14 head_norm_before_train=1.535294 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2870769274379934, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.222553853062148, 'psi': 0.0}
[S4] START round=14 head_norm_before_train=1.134903 cos_to_last_merge=0.9983 (last merge round=12)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3454775223627466, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3325629870470121, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.062591 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.2342669645337725, 'psi': 0.33308623671855697}-{'f1_val': 0.3724165228557028, 'auprc': 0.3724165228557028, 'loss_val': 1.1664297602633376, 'psi': 0.3724165228557028}
[S6] START round=14 head_norm_before_train=1.546045 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 4.811613336603238, 'psi': 0.021749084249084248}-{'f1_val': 0.028229448961156277, 'auprc': 0.028229448961156277, 'loss_val': 4.257959815340453, 'psi': 0.028229448961156277}
[S7] START round=14 head_norm_before_train=1.370848 (no previous merge yet)
[S7] round=14 local utility u=0.424029 metrics={'f1_val': 0.20371462264150944, 'auprc': 0.20371462264150944, 'loss_val': 1.36200619145479, 'psi': 0.20371462264150944}-{'f1_val': 0.1123731271145481, 'auprc': 0.1123731271145481, 'loss_val': 1.3879916842794842, 'psi': 0.1123731271145481}
[S8] START round=14 head_norm_before_train=1.488881 (no previous merge yet)
[S8] round=14 local utility u=0.746475 metrics={'f1_val': 0.6751099752615823, 'auprc': 0.6751099752615823, 'loss_val': 0.9034881582265277, 'psi': 0.6751099752615823}-{'f1_val': 0.5184500977427644, 'auprc': 0.5184500977427644, 'loss_val': 0.9864993999333206, 'psi': 0.5184500977427644}
[S9] START round=14 head_norm_before_train=1.434277 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.044341 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.27848167840054, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.367163801322213, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.532049 (no previous merge yet)
[S10] round=14 local utility u=0.150414 metrics={'f1_val': 0.22795838751625488, 'auprc': 0.22795838751625488, 'loss_val': 3.449434801695824, 'psi': 0.22795838751625488}-{'f1_val': 0.20190937589056712, 'auprc': 0.20190937589056712, 'loss_val': 3.5158220190509817, 'psi': 0.20190937589056712}
[S11] START round=14 head_norm_before_train=1.510504 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.151458320225177, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5301186192859735, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.469892 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2407522205200472, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1818678968510465, 'psi': 0.3599362944611573}
[S14] START round=14 head_norm_before_train=1.510724 (no previous merge yet)
[S14] round=14 local utility u=0.230778 metrics={'f1_val': 0.03555846422338569, 'auprc': 0.03555846422338569, 'loss_val': 5.198082574775413, 'psi': 0.03555846422338569}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.339612949175881, 'psi': 0.0}
[S15] START round=14 head_norm_before_train=1.488027 (no previous merge yet)
[S15] round=14 local utility u=0.394922 metrics={'f1_val': 0.33072182179045234, 'auprc': 0.33072182179045234, 'loss_val': 1.1051995297472723, 'psi': 0.33072182179045234}-{'f1_val': 0.250019742557056, 'auprc': 0.250019742557056, 'loss_val': 1.1687257827718456, 'psi': 0.250019742557056}
[S16] START round=14 head_norm_before_train=1.385586 cos_to_last_merge=0.9724 (last merge round=8)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.024492714758201483, 'auprc': 0.024492714758201483, 'loss_val': 3.258062077427625, 'psi': 0.024492714758201483}-{'f1_val': 0.20050424628450106, 'auprc': 0.20050424628450106, 'loss_val': 2.0338135948475933, 'psi': 0.20050424628450106}
[S17] START round=14 head_norm_before_train=1.474848 (no previous merge yet)
[S17] round=14 local utility u=0.025354 metrics={'f1_val': 0.15890688259109312, 'auprc': 0.15890688259109312, 'loss_val': 1.21491500013424, 'psi': 0.15890688259109312}-{'f1_val': 0.15891159215051587, 'auprc': 0.15891159215051587, 'loss_val': 1.265665533450682, 'psi': 0.15891159215051587}
[S14] not sending this round → trigger blocked (psi=0.036)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:36604
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:36604
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:36610
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S2
[S4] cosine check vs S2: cos=0.6882
[S6] RECEIVED delta(kind=head bytes=1797) from S10
[S6] cosine check vs S10: cos=-0.0265
[S6] DROPPED delta from S10 (cos=-0.0265 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=0.9795
[S6] RECEIVED delta(kind=head bytes=1792) from S7
[S6] cosine check vs S7: cos=0.0275
[S4] RECEIVED delta(kind=head bytes=1795) from S15
[S4] cosine check vs S15: cos=-0.0079
[S4] DROPPED delta from S15 (cos=-0.0079 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] cosine check vs S9: cos=0.7016
[S17] not sending this round → trigger blocked (psi=0.159)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.3331 head_norm=1.096591
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.249951e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.3332 head_norm=1.186270 delta_norm=0.524995
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.0000 head_norm=1.189498
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.731713e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.0002 head_norm=1.271386 delta_norm=0.573171
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.0217 head_norm=1.575846
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.036149e+00
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.0176 head_norm=1.064821 delta_norm=1.036149
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.3687 head_norm=1.470783
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.530211e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.3687 head_norm=1.486918 delta_norm=0.153021
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.573210 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.26521452145214525, 'auprc': 0.26521452145214525, 'loss_val': 2.3732333807152313, 'psi': 0.26521452145214525}-{'f1_val': 0.26521452145214525, 'auprc': 0.26521452145214525, 'loss_val': 2.2970011156842975, 'psi': 0.26521452145214525}
[S3] START round=15 head_norm_before_train=1.557713 (no previous merge yet)
[S3] round=15 local utility u=0.056571 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.173934839684559, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2870769274379934, 'psi': 0.0}
[S4] START round=15 head_norm_before_train=1.271386 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.017223 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3110319725123323, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3454775223627466, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.186270 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.33325092707045734, 'auprc': 0.33325092707045734, 'loss_val': 1.2645115879248956, 'psi': 0.33325092707045734}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.2342669645337725, 'psi': 0.33308623671855697}
[S6] START round=15 head_norm_before_train=1.064821 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.475622 metrics={'f1_val': 0.00047824007651841227, 'auprc': 0.00047824007651841227, 'loss_val': 3.668932277704288, 'psi': 0.00047824007651841227}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 4.811613336603238, 'psi': 0.021749084249084248}
[S7] START round=15 head_norm_before_train=1.389823 (no previous merge yet)
[S7] round=15 local utility u=0.436875 metrics={'f1_val': 0.2963986368241687, 'auprc': 0.2963986368241687, 'loss_val': 1.3224122314275055, 'psi': 0.2963986368241687}-{'f1_val': 0.20371462264150944, 'auprc': 0.20371462264150944, 'loss_val': 1.36200619145479, 'psi': 0.20371462264150944}
[S8] START round=15 head_norm_before_train=1.518379 (no previous merge yet)
[S8] round=15 local utility u=1.000000 metrics={'f1_val': 0.9912693798791021, 'auprc': 0.9912693798791021, 'loss_val': 0.8498364553511084, 'psi': 0.9912693798791021}-{'f1_val': 0.6751099752615823, 'auprc': 0.6751099752615823, 'loss_val': 0.9034881582265277, 'psi': 0.6751099752615823}
[S9] START round=15 head_norm_before_train=1.486918 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.023247 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.231987052307408, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.27848167840054, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.562354 (no previous merge yet)
[S10] round=15 local utility u=0.557479 metrics={'f1_val': 0.33261477045908183, 'auprc': 0.33261477045908183, 'loss_val': 3.276383852229875, 'psi': 0.33261477045908183}-{'f1_val': 0.22795838751625488, 'auprc': 0.22795838751625488, 'loss_val': 3.449434801695824, 'psi': 0.22795838751625488}
[S11] START round=15 head_norm_before_train=1.530178 (no previous merge yet)
[S11] round=15 local utility u=0.852581 metrics={'f1_val': 0.10472440944881889, 'auprc': 0.10472440944881889, 'loss_val': 2.3888160731315184, 'psi': 0.10472440944881889}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.151458320225177, 'psi': 0.0}
[S13] START round=15 head_norm_before_train=1.491506 (no previous merge yet)
[S13] round=15 local utility u=0.002274 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2362047731966836, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2407522205200472, 'psi': 0.3599362944611573}
[S14] START round=15 head_norm_before_train=1.531557 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.412119995165965, 'psi': 0.0}-{'f1_val': 0.03555846422338569, 'auprc': 0.03555846422338569, 'loss_val': 5.198082574775413, 'psi': 0.03555846422338569}
[S15] START round=15 head_norm_before_train=1.517534 (no previous merge yet)
[S15] round=15 local utility u=0.021370 metrics={'f1_val': 0.3329116592873709, 'auprc': 0.3329116592873709, 'loss_val': 1.0821675724568154, 'psi': 0.3329116592873709}-{'f1_val': 0.33072182179045234, 'auprc': 0.33072182179045234, 'loss_val': 1.1051995297472723, 'psi': 0.33072182179045234}
[S16] START round=15 head_norm_before_train=1.413809 cos_to_last_merge=0.9672 (last merge round=8)
[S16] round=15 local utility u=1.000000 metrics={'f1_val': 0.19488588058334969, 'auprc': 0.19488588058334969, 'loss_val': 2.1077186057720376, 'psi': 0.19488588058334969}-{'f1_val': 0.024492714758201483, 'auprc': 0.024492714758201483, 'loss_val': 3.258062077427625, 'psi': 0.024492714758201483}
[S17] START round=15 head_norm_before_train=1.495411 (no previous merge yet)
[S17] round=15 local utility u=0.024940 metrics={'f1_val': 0.1545651318378591, 'auprc': 0.1545651318378591, 'loss_val': 1.1259601820514775, 'psi': 0.1545651318378591}-{'f1_val': 0.15890688259109312, 'auprc': 0.15890688259109312, 'loss_val': 1.21491500013424, 'psi': 0.15890688259109312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:36608
[S6] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[S11] not sending this round → trigger blocked (psi=0.105)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S7
[S6] cosine check vs S7: cos=0.6507
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=-0.0542
[S7] DROPPED delta from S13 (cos=-0.0542 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S16
[S7] cosine check vs S16: cos=-0.0293
[S7] DROPPED delta from S16 (cos=-0.0293 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] cosine check vs S8: cos=0.9865
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=-0.0105
[S4] DROPPED delta from S15 (cos=-0.0105 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] cosine check vs S9: cos=0.9239
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=-0.0186
[S6] DROPPED delta from S10 (cos=-0.0186 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.155)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.3333 head_norm=1.213673
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.073807e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.3333 head_norm=1.342905 delta_norm=0.307381
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.131 → S7@127.0.0.1:36608
[S2] ⇄ pheromone p=0.311 → S4@127.0.0.1:36604
[S3] ⇄ pheromone p=0.077 → S6@127.0.0.1:36607
[S4] ⇄ pheromone p=0.060 → S16@127.0.0.1:36616
[S14] ⇄ pheromone p=0.073 → S7@127.0.0.1:36608
[S11] ⇄ pheromone p=0.234 → S2@127.0.0.1:36602
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.0005 head_norm=1.102942
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.437347e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.143925 delta_norm=0.543735
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.175 → S4@127.0.0.1:36604
[S16] ⇄ pheromone p=0.406 → S7@127.0.0.1:36608
[S10] ⇄ pheromone p=0.258 → S6@127.0.0.1:36607
[S13] ⇄ pheromone p=0.176 → S7@127.0.0.1:36608
[S15] ⇄ pheromone p=0.198 → S4@127.0.0.1:36604
[S8] ⇄ pheromone p=0.554 → S9@127.0.0.1:36610
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.3687 head_norm=1.524058
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.267142e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.3687 head_norm=1.530050 delta_norm=0.126714
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.218 → S5@127.0.0.1:36605
[S7] ⇄ pheromone p=0.282 → S6@127.0.0.1:36607
[S17] ⇄ pheromone p=0.107 → S13@127.0.0.1:36613
[S2] START round=16 head_norm_before_train=1.596789 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.26531959852086634, 'auprc': 0.26531959852086634, 'loss_val': 2.469563966897514, 'psi': 0.26531959852086634}-{'f1_val': 0.26521452145214525, 'auprc': 0.26521452145214525, 'loss_val': 2.3732333807152313, 'psi': 0.26521452145214525}
[S3] START round=16 head_norm_before_train=1.578881 (no previous merge yet)
[S3] round=16 local utility u=1.000000 metrics={'f1_val': 0.2226325101930918, 'auprc': 0.2226325101930918, 'loss_val': 1.8996570340318781, 'psi': 0.22263251019309177}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.173934839684559, 'psi': 0.0}
[S4] START round=16 head_norm_before_train=1.310266 cos_to_last_merge=0.9980 (last merge round=14)
[S4] round=16 local utility u=0.004501 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.302030768507509, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3110319725123323, 'psi': 0.0}
[S5] START round=16 head_norm_before_train=1.342905 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.25, 'auprc': 0.25, 'loss_val': 1.278381654850957, 'psi': 0.25}-{'f1_val': 0.33325092707045734, 'auprc': 0.33325092707045734, 'loss_val': 1.2645115879248956, 'psi': 0.33325092707045734}
[S6] START round=16 head_norm_before_train=1.143925 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.387875 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 3.0468449452496547, 'psi': 0.017551963048498844}-{'f1_val': 0.00047824007651841227, 'auprc': 0.00047824007651841227, 'loss_val': 3.668932277704288, 'psi': 0.00047824007651841227}
[S7] START round=16 head_norm_before_train=1.411362 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.2857684290316468, 'auprc': 0.2857684290316468, 'loss_val': 1.3153801163100218, 'psi': 0.2857684290316468}-{'f1_val': 0.2963986368241687, 'auprc': 0.2963986368241687, 'loss_val': 1.3224122314275055, 'psi': 0.2963986368241687}
[S8] START round=16 head_norm_before_train=1.546437 (no previous merge yet)
[S8] round=16 local utility u=0.059801 metrics={'f1_val': 0.9991531851296138, 'auprc': 0.9991531851296138, 'loss_val': 0.8011886744895184, 'psi': 0.9991531851296138}-{'f1_val': 0.9912693798791021, 'auprc': 0.9912693798791021, 'loss_val': 0.8498364553511084, 'psi': 0.9912693798791021}
[S9] START round=16 head_norm_before_train=1.530050 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.2579329508946049, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.231987052307408, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.586732 (no previous merge yet)
[S10] round=16 local utility u=0.048938 metrics={'f1_val': 0.3326947637292465, 'auprc': 0.3326947637292465, 'loss_val': 3.1792282648402055, 'psi': 0.3326947637292465}-{'f1_val': 0.33261477045908183, 'auprc': 0.33261477045908183, 'loss_val': 3.276383852229875, 'psi': 0.33261477045908183}
[S11] START round=16 head_norm_before_train=1.543116 (no previous merge yet)
[S11] round=16 local utility u=0.970380 metrics={'f1_val': 0.33271057138408844, 'auprc': 0.33271057138408844, 'loss_val': 2.499930766555033, 'psi': 0.33271057138408844}-{'f1_val': 0.10472440944881889, 'auprc': 0.10472440944881889, 'loss_val': 2.3888160731315184, 'psi': 0.10472440944881889}
[S13] START round=16 head_norm_before_train=1.509056 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2707771176005207, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2362047731966836, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.551946 (no previous merge yet)
[S14] round=16 local utility u=0.721213 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.191251462603522, 'psi': 0.13572854291417166}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.412119995165965, 'psi': 0.0}
[S15] START round=16 head_norm_before_train=1.546620 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.28346647300895667, 'auprc': 0.28346647300895667, 'loss_val': 0.9887862474016113, 'psi': 0.28346647300895667}-{'f1_val': 0.3329116592873709, 'auprc': 0.3329116592873709, 'loss_val': 1.0821675724568154, 'psi': 0.3329116592873709}
[S16] START round=16 head_norm_before_train=1.441837 cos_to_last_merge=0.9622 (last merge round=8)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.13238349658652418, 'auprc': 0.13238349658652418, 'loss_val': 2.964509678102885, 'psi': 0.13238349658652418}-{'f1_val': 0.19488588058334969, 'auprc': 0.19488588058334969, 'loss_val': 2.1077186057720376, 'psi': 0.19488588058334969}
[S17] START round=16 head_norm_before_train=1.519629 (no previous merge yet)
[S17] round=16 local utility u=0.020078 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.0655730938023957, 'psi': 0.15231723870467326}-{'f1_val': 0.1545651318378591, 'auprc': 0.1545651318378591, 'loss_val': 1.1259601820514775, 'psi': 0.1545651318378591}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:36610
[S14] not sending this round → trigger blocked (psi=0.136)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:36602
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=-0.0097
[S6] DROPPED delta from S10 (cos=-0.0097 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.0649
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=-0.0279
[S6] DROPPED delta from S3 (cos=-0.0279 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S8
[S9] cosine check vs S8: cos=0.9896
[S17] not sending this round → trigger blocked (psi=0.152)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.2653 head_norm=1.622086
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.086801e+00
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.2651 head_norm=1.159707 delta_norm=1.086801
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.3687 head_norm=1.567169
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.135479e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.3687 head_norm=1.570725 delta_norm=0.113548
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.159707 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.332779 metrics={'f1_val': 0.256626429073258, 'auprc': 0.256626429073258, 'loss_val': 1.7257683100916181, 'psi': 0.256626429073258}-{'f1_val': 0.26531959852086634, 'auprc': 0.26531959852086634, 'loss_val': 2.469563966897514, 'psi': 0.26531959852086634}
[S3] START round=17 head_norm_before_train=1.599743 (no previous merge yet)
[S3] round=17 local utility u=0.149148 metrics={'f1_val': 0.25789912196372494, 'auprc': 0.25789912196372494, 'loss_val': 1.918761468494668, 'psi': 0.25789912196372494}-{'f1_val': 0.2226325101930918, 'auprc': 0.2226325101930918, 'loss_val': 1.8996570340318781, 'psi': 0.22263251019309177}
[S4] START round=17 head_norm_before_train=1.355174 cos_to_last_merge=0.9918 (last merge round=14)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3073361053922479, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.302030768507509, 'psi': 0.0}
[S5] START round=17 head_norm_before_train=1.368876 cos_to_last_merge=0.9964 (last merge round=15)
[S5] round=17 local utility u=0.012861 metrics={'f1_val': 0.249938195302843, 'auprc': 0.249938195302843, 'loss_val': 1.252102920988488, 'psi': 0.249938195302843}-{'f1_val': 0.25, 'auprc': 0.25, 'loss_val': 1.278381654850957, 'psi': 0.25}
[S6] START round=17 head_norm_before_train=1.182129 cos_to_last_merge=0.9968 (last merge round=15)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.822467754673896, 'psi': 0.0}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 3.0468449452496547, 'psi': 0.017551963048498844}
[S7] START round=17 head_norm_before_train=1.431516 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.28116609129267356, 'auprc': 0.28116609129267356, 'loss_val': 1.315786730362854, 'psi': 0.28116609129267356}-{'f1_val': 0.2857684290316468, 'auprc': 0.2857684290316468, 'loss_val': 1.3153801163100218, 'psi': 0.2857684290316468}
[S8] START round=17 head_norm_before_train=1.582441 (no previous merge yet)
[S8] round=17 local utility u=0.025441 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.7477646977289899, 'psi': 0.9988708350860451}-{'f1_val': 0.9991531851296138, 'auprc': 0.9991531851296138, 'loss_val': 0.8011886744895184, 'psi': 0.9991531851296138}
[S9] START round=17 head_norm_before_train=1.570725 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3033214085616789, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.2579329508946049, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.613267 (no previous merge yet)
[S10] round=17 local utility u=0.056572 metrics={'f1_val': 0.3330145066156544, 'auprc': 0.3330145066156544, 'loss_val': 3.0689610518157813, 'psi': 0.3330145066156544}-{'f1_val': 0.3326947637292465, 'auprc': 0.3326947637292465, 'loss_val': 3.1792282648402055, 'psi': 0.3326947637292465}
[S11] START round=17 head_norm_before_train=1.555941 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.33247763516141576, 'auprc': 0.33247763516141576, 'loss_val': 2.767751202288679, 'psi': 0.33247763516141576}-{'f1_val': 0.33271057138408844, 'auprc': 0.33271057138408844, 'loss_val': 2.499930766555033, 'psi': 0.33271057138408844}
[S13] START round=17 head_norm_before_train=1.531473 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2834716272660023, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2707771176005207, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=1.569932 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.10879538602700223, 'auprc': 0.10879538602700223, 'loss_val': 5.21557711284919, 'psi': 0.10879538602700223}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.191251462603522, 'psi': 0.13572854291417166}
[S15] START round=17 head_norm_before_train=1.576477 (no previous merge yet)
[S15] round=17 local utility u=0.023588 metrics={'f1_val': 0.28094541910331383, 'auprc': 0.28094541910331383, 'loss_val': 0.9189209715208564, 'psi': 0.28094541910331383}-{'f1_val': 0.28346647300895667, 'auprc': 0.28346647300895667, 'loss_val': 0.9887862474016113, 'psi': 0.28346647300895667}
[S16] START round=17 head_norm_before_train=1.469955 cos_to_last_merge=0.9571 (last merge round=8)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 3.4066816994062874, 'psi': 0.09036289353520788}-{'f1_val': 0.13238349658652418, 'auprc': 0.13238349658652418, 'loss_val': 2.964509678102885, 'psi': 0.13238349658652418}
[S17] START round=17 head_norm_before_train=1.548819 (no previous merge yet)
[S17] round=17 local utility u=0.017624 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0300584197901983, 'psi': 0.152287708414114}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.0655730938023957, 'psi': 0.15231723870467326}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:36610
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S5
[S7] cosine check vs S5: cos=-0.0485
[S7] DROPPED delta from S5 (cos=-0.0485 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=0.9917
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=-0.0146
[S6] DROPPED delta from S3 (cos=-0.0146 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S2
[S4] cosine check vs S2: cos=0.6876
[S4] RECEIVED delta(kind=head bytes=1801) from S15
[S4] cosine check vs S15: cos=-0.0034
[S4] DROPPED delta from S15 (cos=-0.0034 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S10
[S6] cosine check vs S10: cos=-0.0124
[S6] DROPPED delta from S10 (cos=-0.0124 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.152)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.0000 head_norm=1.393693
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.200809e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.3568 head_norm=1.191244 delta_norm=0.520081
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.3687 head_norm=1.606166
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.045832e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.3687 head_norm=1.611461 delta_norm=0.104583
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.198629 cos_to_last_merge=0.9983 (last merge round=16)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.26534522629666335, 'auprc': 0.26534522629666335, 'loss_val': 1.8833055674423695, 'psi': 0.26534522629666335}-{'f1_val': 0.256626429073258, 'auprc': 0.256626429073258, 'loss_val': 1.7257683100916181, 'psi': 0.256626429073258}
[S3] START round=18 head_norm_before_train=1.622592 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.2564798071127185, 'auprc': 0.2564798071127185, 'loss_val': 2.2669217254824803, 'psi': 0.2564798071127185}-{'f1_val': 0.25789912196372494, 'auprc': 0.25789912196372494, 'loss_val': 1.918761468494668, 'psi': 0.25789912196372494}
[S4] START round=18 head_norm_before_train=1.191244 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.771457 metrics={'f1_val': 0.16845350711232568, 'auprc': 0.16845350711232568, 'loss_val': 1.2805032912650585, 'psi': 0.16845350711232568}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3073361053922479, 'psi': 0.0}
[S5] START round=18 head_norm_before_train=1.403284 cos_to_last_merge=0.9879 (last merge round=15)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.249938195302843, 'auprc': 0.249938195302843, 'loss_val': 1.3591416574728603, 'psi': 0.249938195302843}-{'f1_val': 0.249938195302843, 'auprc': 0.249938195302843, 'loss_val': 1.252102920988488, 'psi': 0.249938195302843}
[S6] START round=18 head_norm_before_train=1.237503 cos_to_last_merge=0.9860 (last merge round=15)
[S6] round=18 local utility u=0.113977 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 3.7922247705331045, 'psi': 0.021967963386727688}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.822467754673896, 'psi': 0.0}
[S7] START round=18 head_norm_before_train=1.452076 (no previous merge yet)
[S7] round=18 local utility u=0.259676 metrics={'f1_val': 0.3331674133067861, 'auprc': 0.3331674133067861, 'loss_val': 1.2644466534173369, 'psi': 0.3331674133067861}-{'f1_val': 0.28116609129267356, 'auprc': 0.28116609129267356, 'loss_val': 1.315786730362854, 'psi': 0.28116609129267356}
[S8] START round=18 head_norm_before_train=1.623490 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.701795794028947, 'psi': 0.35939447907390915}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.7477646977289899, 'psi': 0.9988708350860451}
[S9] START round=18 head_norm_before_train=1.611461 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3635695992631365, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3033214085616789, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.637055 (no previous merge yet)
[S10] round=18 local utility u=0.016716 metrics={'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 3.034092958973491, 'psi': 0.3328548644338118}-{'f1_val': 0.3330145066156544, 'auprc': 0.3330145066156544, 'loss_val': 3.0689610518157813, 'psi': 0.3330145066156544}
[S11] START round=18 head_norm_before_train=1.568115 (no previous merge yet)
[S11] round=18 local utility u=0.099130 metrics={'f1_val': 0.3317050476855083, 'auprc': 0.3317050476855083, 'loss_val': 2.5625388632626542, 'psi': 0.3317050476855083}-{'f1_val': 0.33247763516141576, 'auprc': 0.33247763516141576, 'loss_val': 2.767751202288679, 'psi': 0.33247763516141576}
[S13] START round=18 head_norm_before_train=1.547946 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.283739054909323, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2834716272660023, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.592671 (no previous merge yet)
[S14] round=18 local utility u=0.153053 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.153200332518254, 'psi': 0.13587634006482174}-{'f1_val': 0.10879538602700223, 'auprc': 0.10879538602700223, 'loss_val': 5.21557711284919, 'psi': 0.10879538602700223}
[S15] START round=18 head_norm_before_train=1.610406 (no previous merge yet)
[S15] round=18 local utility u=0.038910 metrics={'f1_val': 0.28122717311906503, 'auprc': 0.28122717311906503, 'loss_val': 0.8436377316334719, 'psi': 0.28122717311906503}-{'f1_val': 0.28094541910331383, 'auprc': 0.28094541910331383, 'loss_val': 0.9189209715208564, 'psi': 0.28094541910331383}
[S16] START round=18 head_norm_before_train=1.496533 cos_to_last_merge=0.9524 (last merge round=8)
[S16] round=18 local utility u=0.614422 metrics={'f1_val': 0.15669636543628906, 'auprc': 0.15669636543628906, 'loss_val': 2.7748379677245825, 'psi': 0.15669636543628906}-{'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 3.4066816994062874, 'psi': 0.09036289353520788}
[S17] START round=18 head_norm_before_train=1.573960 (no previous merge yet)
[S17] round=18 local utility u=0.001413 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.027232447126123, 'psi': 0.152287708414114}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0300584197901983, 'psi': 0.152287708414114}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:36602
[S14] not sending this round → trigger blocked (psi=0.136)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:36607
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.168)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.6589
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=-0.0348
[S4] DROPPED delta from S15 (cos=-0.0348 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S16
[S7] cosine check vs S16: cos=-0.0330
[S7] DROPPED delta from S16 (cos=-0.0330 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=-0.0144
[S6] DROPPED delta from S10 (cos=-0.0144 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1792) from S7
[S6] cosine check vs S7: cos=0.8406
[S17] not sending this round → trigger blocked (psi=0.152)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.2653 head_norm=1.256442
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.055476e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.2653 head_norm=1.295768 delta_norm=0.605548
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.0220 head_norm=1.284654
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.982348e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.0207 head_norm=1.320385 delta_norm=0.398235
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.295768 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.24646716541978386, 'auprc': 0.24646716541978386, 'loss_val': 1.7419747836002142, 'psi': 0.24646716541978386}-{'f1_val': 0.26534522629666335, 'auprc': 0.26534522629666335, 'loss_val': 1.8833055674423695, 'psi': 0.26534522629666335}
[S3] START round=19 head_norm_before_train=1.645173 (no previous merge yet)
[S3] round=19 local utility u=0.119983 metrics={'f1_val': 0.2501087699670583, 'auprc': 0.2501087699670583, 'loss_val': 1.9696173660507323, 'psi': 0.2501087699670583}-{'f1_val': 0.2564798071127185, 'auprc': 0.2564798071127185, 'loss_val': 2.2669217254824803, 'psi': 0.2564798071127185}
[S4] START round=19 head_norm_before_train=1.221800 cos_to_last_merge=0.9986 (last merge round=17)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.001311598276185123, 'auprc': 0.001311598276185123, 'loss_val': 1.2842326305460172, 'psi': 0.001311598276185123}-{'f1_val': 0.16845350711232568, 'auprc': 0.16845350711232568, 'loss_val': 1.2805032912650585, 'psi': 0.16845350711232568}
[S5] START round=19 head_norm_before_train=1.439218 cos_to_last_merge=0.9776 (last merge round=15)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 2.153087385014716, 'psi': 0.24987642115669798}-{'f1_val': 0.249938195302843, 'auprc': 0.249938195302843, 'loss_val': 1.3591416574728603, 'psi': 0.249938195302843}
[S6] START round=19 head_norm_before_train=1.320385 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.235932 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 3.314446345691271, 'psi': 0.021310724106324473}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 3.7922247705331045, 'psi': 0.021967963386727688}
[S7] START round=19 head_norm_before_train=1.467541 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.32359333494325043, 'auprc': 0.32359333494325043, 'loss_val': 1.238989499930002, 'psi': 0.32359333494325043}-{'f1_val': 0.3331674133067861, 'auprc': 0.3331674133067861, 'loss_val': 1.2644466534173369, 'psi': 0.3331674133067861}
[S8] START round=19 head_norm_before_train=1.666581 (no previous merge yet)
[S8] round=19 local utility u=0.011685 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6784255508887904, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.701795794028947, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.644209 cos_to_last_merge=0.9990 (last merge round=17)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4746532703964648, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3635695992631365, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.656600 (no previous merge yet)
[S10] round=19 local utility u=0.033373 metrics={'f1_val': 0.33293489521077374, 'auprc': 0.33293489521077374, 'loss_val': 2.968067378176386, 'psi': 0.33293489521077374}-{'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 3.034092958973491, 'psi': 0.3328548644338118}
[S11] START round=19 head_norm_before_train=1.585168 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 2.6882756113681965, 'psi': 0.33162711338607104}-{'f1_val': 0.3317050476855083, 'auprc': 0.3317050476855083, 'loss_val': 2.5625388632626542, 'psi': 0.3317050476855083}
[S13] START round=19 head_norm_before_train=1.560480 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2930390710294541, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.283739054909323, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.615155 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.165627339843638, 'psi': 0.13572854291417166}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.153200332518254, 'psi': 0.13587634006482174}
[S15] START round=19 head_norm_before_train=1.644366 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.28066325286515487, 'auprc': 0.28066325286515487, 'loss_val': 0.8398934637362417, 'psi': 0.28066325286515487}-{'f1_val': 0.28122717311906503, 'auprc': 0.28122717311906503, 'loss_val': 0.8436377316334719, 'psi': 0.28122717311906503}
[S16] START round=19 head_norm_before_train=1.521668 cos_to_last_merge=0.9479 (last merge round=8)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.09174458563094383, 'auprc': 0.09174458563094383, 'loss_val': 3.4473847354403757, 'psi': 0.09174458563094383}-{'f1_val': 0.15669636543628906, 'auprc': 0.15669636543628906, 'loss_val': 2.7748379677245825, 'psi': 0.15669636543628906}
[S17] START round=19 head_norm_before_train=1.600361 (no previous merge yet)
[S17] round=19 local utility u=0.235440 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.0125066997735654, 'psi': 0.20297157622739018}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.027232447126123, 'psi': 0.152287708414114}
[S6] not sending this round → trigger blocked (psi=0.021)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:36607
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:36610
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S10
[S6] cosine check vs S10: cos=-0.0057
[S6] DROPPED delta from S10 (cos=-0.0057 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] cosine check vs S3: cos=-0.0542
[S6] DROPPED delta from S3 (cos=-0.0542 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1805) from S8
[S9] cosine check vs S8: cos=0.9874
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.0240
[S7] r=20 psi=0.324 u=0.0000 p_local=0.1571 f1=0.324 auprc=0.324 bytes=5380
[S15] r=20 psi=0.281 u=0.0000 p_local=0.0904 f1=0.281 auprc=0.281 bytes=12585
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.3599 head_norm=1.575808
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.116298e+00
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.3599 head_norm=1.143461 delta_norm=1.116298
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.360 u=0.0000 p_local=0.0721 f1=0.360 auprc=0.360 bytes=7192
[S6] r=20 psi=0.021 u=0.2359 p_local=0.1769 f1=0.021 auprc=0.021 bytes=0
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.3687 head_norm=1.675217
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.347142e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.3687 head_norm=1.684119 delta_norm=0.134714
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0893 f1=0.369 auprc=0.369 bytes=5394
[S4] r=20 psi=0.001 u=0.0000 p_local=0.1485 f1=0.001 auprc=0.001 bytes=7167
[S14] r=20 psi=0.136 u=0.0000 p_local=0.1282 f1=0.136 auprc=0.136 bytes=0
[S11] r=20 psi=0.332 u=0.0000 p_local=0.2111 f1=0.332 auprc=0.332 bytes=3598
[S2] r=20 psi=0.246 u=0.0000 p_local=0.1702 f1=0.246 auprc=0.246 bytes=5398
[S5] r=20 psi=0.250 u=0.0000 p_local=0.0552 f1=0.250 auprc=0.250 bytes=10792
[S10] r=20 psi=0.333 u=0.0334 p_local=0.1272 f1=0.333 auprc=0.333 bytes=12589
[S3] r=20 psi=0.250 u=0.1200 p_local=0.1771 f1=0.250 auprc=0.250 bytes=5395
[S8] r=20 psi=0.359 u=0.0117 p_local=0.2385 f1=0.359 auprc=0.359 bytes=18002
[S17] r=20 psi=0.203 u=0.2354 p_local=0.0956 f1=0.203 auprc=0.203 bytes=1800
[S16] r=20 psi=0.092 u=0.0000 p_local=0.2645 f1=0.092 auprc=0.092 bytes=5394
[S2] START round=20 head_norm_before_train=1.337834 cos_to_last_merge=0.9963 (last merge round=18)
[S2] round=20 local utility u=0.047563 metrics={'f1_val': 0.26534522629666335, 'auprc': 0.26534522629666335, 'loss_val': 1.8167503892870025, 'psi': 0.26534522629666335}-{'f1_val': 0.24646716541978386, 'auprc': 0.24646716541978386, 'loss_val': 1.7419747836002142, 'psi': 0.24646716541978386}
[S3] START round=20 head_norm_before_train=1.667787 (no previous merge yet)
[S3] round=20 local utility u=0.526266 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.9435719791814867, 'psi': 0.3641628959276018}-{'f1_val': 0.2501087699670583, 'auprc': 0.2501087699670583, 'loss_val': 1.9696173660507323, 'psi': 0.2501087699670583}
[S4] START round=20 head_norm_before_train=1.263580 cos_to_last_merge=0.9939 (last merge round=17)
[S4] round=20 local utility u=0.000613 metrics={'f1_val': 0.0011254924029262803, 'auprc': 0.0011254924029262803, 'loss_val': 1.2813317178462582, 'psi': 0.0011254924029262803}-{'f1_val': 0.001311598276185123, 'auprc': 0.001311598276185123, 'loss_val': 1.2842326305460172, 'psi': 0.001311598276185123}
[S5] START round=20 head_norm_before_train=1.476870 cos_to_last_merge=0.9679 (last merge round=15)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 2.8092459874385485, 'psi': 0.24987642115669798}-{'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 2.153087385014716, 'psi': 0.24987642115669798}
[S6] START round=20 head_norm_before_train=1.355579 cos_to_last_merge=0.9979 (last merge round=18)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.005210800568450971, 'auprc': 0.005210800568450971, 'loss_val': 3.9516076388018377, 'psi': 0.005210800568450971}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 3.314446345691271, 'psi': 0.021310724106324473}
[S7] START round=20 head_norm_before_train=1.484786 (no previous merge yet)
[S7] round=20 local utility u=0.179175 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2061736219222534, 'psi': 0.35976373724718097}-{'f1_val': 0.32359333494325043, 'auprc': 0.32359333494325043, 'loss_val': 1.238989499930002, 'psi': 0.32359333494325043}
[S8] START round=20 head_norm_before_train=1.703660 (no previous merge yet)
[S8] round=20 local utility u=0.008774 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6608775220222148, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6784255508887904, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.684119 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5004462649990669, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4746532703964648, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.675213 (no previous merge yet)
[S10] round=20 local utility u=0.020625 metrics={'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 2.9260974817739736, 'psi': 0.3328548644338118}-{'f1_val': 0.33293489521077374, 'auprc': 0.33293489521077374, 'loss_val': 2.968067378176386, 'psi': 0.33293489521077374}
[S11] START round=20 head_norm_before_train=1.606158 (no previous merge yet)
[S11] round=20 local utility u=0.056454 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.505554452099317, 'psi': 0.32387008857597094}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 2.6882756113681965, 'psi': 0.33162711338607104}
[S13] START round=20 head_norm_before_train=1.143461 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2955345731858927, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2930390710294541, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.637422 (no previous merge yet)
[S14] round=20 local utility u=0.014749 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.1370015710838715, 'psi': 0.13582554517133957}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.165627339843638, 'psi': 0.13572854291417166}
[S15] START round=20 head_norm_before_train=1.676476 (no previous merge yet)
[S15] round=20 local utility u=0.022290 metrics={'f1_val': 0.2823500849720806, 'auprc': 0.2823500849720806, 'loss_val': 0.8104957886027983, 'psi': 0.2823500849720806}-{'f1_val': 0.28066325286515487, 'auprc': 0.28066325286515487, 'loss_val': 0.8398934637362417, 'psi': 0.28066325286515487}
[S16] START round=20 head_norm_before_train=1.544418 cos_to_last_merge=0.9439 (last merge round=8)
[S16] ⚠️ Model drifted since last merge! cos=0.944
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 3.7790827806624434, 'psi': 0.09022435897435897}-{'f1_val': 0.09174458563094383, 'auprc': 0.09174458563094383, 'loss_val': 3.4473847354403757, 'psi': 0.09174458563094383}
[S17] START round=20 head_norm_before_train=1.619901 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.15261317272197397, 'auprc': 0.15261317272197397, 'loss_val': 0.9990311937788079, 'psi': 0.15261317272197397}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.0125066997735654, 'psi': 0.20297157622739018}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:36610
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:36604
[S14] not sending this round → trigger blocked (psi=0.136)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:36602
[S4] not sending this round → trigger blocked (psi=0.001)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[S2] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.9246
[S6] RECEIVED delta(kind=head bytes=1801) from S10
[S6] cosine check vs S10: cos=-0.0070
[S6] DROPPED delta from S10 (cos=-0.0070 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=0.9935
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.8694
[S4] RECEIVED delta(kind=head bytes=1793) from S2
[S4] cosine check vs S2: cos=0.7069
[S4] RECEIVED delta(kind=head bytes=1805) from S15
[S4] cosine check vs S15: cos=-0.0262
[S4] DROPPED delta from S15 (cos=-0.0262 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=-0.0461
[S6] DROPPED delta from S3 (cos=-0.0461 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.0052 head_norm=1.400972
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.869819e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.0005 head_norm=1.426385 delta_norm=0.286982
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.142 → S4@127.0.0.1:36604
[S14] ⇄ pheromone p=0.106 → S7@127.0.0.1:36608
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.0011 head_norm=1.315493
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.202171e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.3568 head_norm=1.252380 delta_norm=0.520217
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.119 → S16@127.0.0.1:36616
[S5] ⇄ pheromone p=0.044 → S7@127.0.0.1:36608
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.3687 head_norm=1.709417
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.931652e-02
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.3687 head_norm=1.721776 delta_norm=0.099317
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.071 → S5@127.0.0.1:36605
[S13] ⇄ pheromone p=0.058 → S7@127.0.0.1:36608
[S8] ⇄ pheromone p=0.193 → S9@127.0.0.1:36610
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.2653 head_norm=1.395578
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.024675e-01
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.2652 head_norm=1.462053 delta_norm=0.402467
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.146 → S4@127.0.0.1:36604
[S7] ⇄ pheromone p=0.162 → S6@127.0.0.1:36607
[S3] ⇄ pheromone p=0.247 → S6@127.0.0.1:36607
[S10] ⇄ pheromone p=0.106 → S6@127.0.0.1:36607
[S11] ⇄ pheromone p=0.180 → S2@127.0.0.1:36602
[S15] ⇄ pheromone p=0.077 → S4@127.0.0.1:36604
[S16] ⇄ pheromone p=0.212 → S7@127.0.0.1:36608
[S17] ⇄ pheromone p=0.076 → S13@127.0.0.1:36613
[S2] START round=21 head_norm_before_train=1.462053 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.076149 metrics={'f1_val': 0.26524007661316956, 'auprc': 0.26524007661316956, 'loss_val': 1.6635062980585864, 'psi': 0.26524007661316956}-{'f1_val': 0.26534522629666335, 'auprc': 0.26534522629666335, 'loss_val': 1.8167503892870025, 'psi': 0.26534522629666335}
[S3] START round=21 head_norm_before_train=1.691477 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.9746373323756472, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.9435719791814867, 'psi': 0.3641628959276018}
[S4] START round=21 head_norm_before_train=1.252380 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=1.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2217052874955803, 'psi': 0.3567939207526687}-{'f1_val': 0.0011254924029262803, 'auprc': 0.0011254924029262803, 'loss_val': 1.2813317178462582, 'psi': 0.0011254924029262803}
[S5] START round=21 head_norm_before_train=1.513305 cos_to_last_merge=0.9586 (last merge round=15)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 2.9555143933045898, 'psi': 0.24987642115669798}-{'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 2.8092459874385485, 'psi': 0.24987642115669798}
[S6] START round=21 head_norm_before_train=1.426385 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.278420 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 3.5058373759254793, 'psi': 0.017551963048498844}-{'f1_val': 0.005210800568450971, 'auprc': 0.005210800568450971, 'loss_val': 3.9516076388018377, 'psi': 0.005210800568450971}
[S7] START round=21 head_norm_before_train=1.507030 (no previous merge yet)
[S7] round=21 local utility u=0.018841 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1684912252257666, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2061736219222534, 'psi': 0.35976373724718097}
[S8] START round=21 head_norm_before_train=1.739727 (no previous merge yet)
[S8] round=21 local utility u=0.003864 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6531504922035556, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6608775220222148, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.721776 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5629635559299757, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5004462649990669, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.695552 (no previous merge yet)
[S10] round=21 local utility u=0.042126 metrics={'f1_val': 0.33293489521077374, 'auprc': 0.33293489521077374, 'loss_val': 2.8425656783160664, 'psi': 0.33293489521077374}-{'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 2.9260974817739736, 'psi': 0.3328548644338118}
[S11] START round=21 head_norm_before_train=1.628348 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.5699121853785143, 'psi': 0.3237965485921889}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.505554452099317, 'psi': 0.32387008857597094}
[S13] START round=21 head_norm_before_train=1.161889 cos_to_last_merge=0.9994 (last merge round=19)
[S13] round=21 local utility u=0.012202 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.27112967053963, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2955345731858927, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.661498 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.17678953049321, 'psi': 0.13592717296421}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.1370015710838715, 'psi': 0.13582554517133957}
[S15] START round=21 head_norm_before_train=1.707828 (no previous merge yet)
[S15] round=21 local utility u=0.193141 metrics={'f1_val': 0.3235359963359353, 'auprc': 0.3235359963359353, 'loss_val': 0.7948876987377859, 'psi': 0.3235359963359353}-{'f1_val': 0.2823500849720806, 'auprc': 0.2823500849720806, 'loss_val': 0.8104957886027983, 'psi': 0.2823500849720806}
[S16] START round=21 head_norm_before_train=1.565666 cos_to_last_merge=0.9402 (last merge round=8)
[S16] ⚠️ Model drifted since last merge! cos=0.940
[S16] round=21 local utility u=0.377516 metrics={'f1_val': 0.13348131705512392, 'auprc': 0.13348131705512392, 'loss_val': 3.413363984447485, 'psi': 0.13348131705512392}-{'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 3.7790827806624434, 'psi': 0.09022435897435897}
[S17] START round=21 head_norm_before_train=1.640672 (no previous merge yet)
[S17] round=21 local utility u=0.025420 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 0.9452626759814386, 'psi': 0.152287708414114}-{'f1_val': 0.15261317272197397, 'auprc': 0.15261317272197397, 'loss_val': 0.9990311937788079, 'psi': 0.15261317272197397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:36616
[S6] not sending this round → trigger blocked (psi=0.018)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:36608
[S4] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S4
[S16] cosine check vs S4: cos=0.2789
[S6] RECEIVED delta(kind=head bytes=1794) from S7
[S6] cosine check vs S7: cos=0.9684
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=0.8293
[S7] RECEIVED delta(kind=head bytes=1804) from S16
[S7] cosine check vs S16: cos=-0.0336
[S7] DROPPED delta from S16 (cos=-0.0336 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=-0.0273
[S7] DROPPED delta from S13 (cos=-0.0273 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1806) from S8
[S9] cosine check vs S8: cos=0.9960
[S4] RECEIVED delta(kind=head bytes=1796) from S15
[S4] cosine check vs S15: cos=-0.0567
[S4] DROPPED delta from S15 (cos=-0.0567 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S10
[S6] cosine check vs S10: cos=-0.0002
[S6] DROPPED delta from S10 (cos=-0.0002 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.6863
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.0176 head_norm=1.462033
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.909497e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.0173 head_norm=1.483607 delta_norm=0.190950
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.3687 head_norm=1.744723
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.870468e-02
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.3687 head_norm=1.752383 delta_norm=0.078705
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.3599 head_norm=1.197366
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.042557e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.3319 head_norm=1.314934 delta_norm=0.604256
[S13] aggregate: ROLLBACK (f1_val pre=0.360 post=0.332 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.1335 head_norm=1.584817
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.730243e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.1258 head_norm=1.155836 delta_norm=0.873024
[S16] aggregate: ROLLBACK (f1_val pre=0.133 post=0.126 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.3568 head_norm=1.297926
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.210563e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.3568 head_norm=1.340252 delta_norm=0.421056
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.504167 cos_to_last_merge=0.9966 (last merge round=20)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.2469904524699045, 'auprc': 0.2469904524699045, 'loss_val': 1.911435892047209, 'psi': 0.2469904524699045}-{'f1_val': 0.26524007661316956, 'auprc': 0.26524007661316956, 'loss_val': 1.6635062980585864, 'psi': 0.26524007661316956}
[S3] START round=22 head_norm_before_train=1.715504 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.1182100524104848, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.9746373323756472, 'psi': 0.3641628959276018}
[S4] START round=22 head_norm_before_train=1.340252 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.011559 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.198587689528319, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2217052874955803, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.543087 cos_to_last_merge=0.9519 (last merge round=15)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 3.034499939585346, 'psi': 0.24987642115669798}-{'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 2.9555143933045898, 'psi': 0.24987642115669798}
[S6] START round=22 head_norm_before_train=1.483607 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.008943 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 3.4859454475771035, 'psi': 0.01732902033271719}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 3.5058373759254793, 'psi': 0.017551963048498844}
[S7] START round=22 head_norm_before_train=1.528909 (no previous merge yet)
[S7] round=22 local utility u=0.012661 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1431689990091163, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1684912252257666, 'psi': 0.35976373724718097}
[S8] START round=22 head_norm_before_train=1.763526 (no previous merge yet)
[S8] round=22 local utility u=0.006904 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6393432222109511, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6531504922035556, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.752383 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.632259952748249, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5629635559299757, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.712260 (no previous merge yet)
[S10] round=22 local utility u=0.013428 metrics={'f1_val': 0.3328550932568149, 'auprc': 0.3328550932568149, 'loss_val': 2.8149922532099154, 'psi': 0.3328550932568149}-{'f1_val': 0.33293489521077374, 'auprc': 0.33293489521077374, 'loss_val': 2.8425656783160664, 'psi': 0.33293489521077374}
[S11] START round=22 head_norm_before_train=1.645878 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.705109495562943, 'psi': 0.3240909090909091}-{'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.5699121853785143, 'psi': 0.3237965485921889}
[S13] START round=22 head_norm_before_train=1.314934 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2878490179674873, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.27112967053963, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.685407 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13192612137203166, 'auprc': 0.13192612137203166, 'loss_val': 5.229416350326728, 'psi': 0.13192612137203166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.17678953049321, 'psi': 0.13592717296421}
[S15] START round=22 head_norm_before_train=1.736242 (no previous merge yet)
[S15] round=22 local utility u=1.000000 metrics={'f1_val': 0.6144788671349031, 'auprc': 0.6144788671349031, 'loss_val': 0.7843288900404775, 'psi': 0.6144788671349031}-{'f1_val': 0.3235359963359353, 'auprc': 0.3235359963359353, 'loss_val': 0.7948876987377859, 'psi': 0.3235359963359353}
[S16] START round=22 head_norm_before_train=1.155836 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.687724 metrics={'f1_val': 0.15658816040738383, 'auprc': 0.15658816040738383, 'loss_val': 2.2458783152720323, 'psi': 0.15658816040738383}-{'f1_val': 0.13348131705512392, 'auprc': 0.13348131705512392, 'loss_val': 3.413363984447485, 'psi': 0.13348131705512392}
[S17] START round=22 head_norm_before_train=1.659719 (no previous merge yet)
[S17] round=22 local utility u=0.036641 metrics={'f1_val': 0.15283914874144325, 'auprc': 0.15283914874144325, 'loss_val': 0.8769437575558815, 'psi': 0.15283914874144325}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 0.9452626759814386, 'psi': 0.152287708414114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:36616
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:36607
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:36610
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[S6] not sending this round → trigger blocked (psi=0.017)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[S16] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=-0.0749
[S4] DROPPED delta from S15 (cos=-0.0749 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=0.0029
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] cosine check vs S7: cos=0.9818
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=-0.0023
[S7] DROPPED delta from S16 (cos=-0.0023 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S4
[S16] cosine check vs S4: cos=0.6689
[S9] RECEIVED delta(kind=head bytes=1803) from S8
[S9] cosine check vs S8: cos=0.9972
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] cosine check vs S17: cos=0.9246
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.3599 head_norm=1.339044
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.369164e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.0690 head_norm=1.480408 delta_norm=0.336916
[S13] aggregate: ROLLBACK (f1_val pre=0.360 post=0.069 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.0173 head_norm=1.520430
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.805303e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.0176 head_norm=1.222921 delta_norm=0.580530
[S6] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.3687 head_norm=1.773770
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.643485e-02
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.3687 head_norm=1.777748 delta_norm=0.066435
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.1566 head_norm=1.183136
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.291968e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.1411 head_norm=1.171518 delta_norm=0.529197
[S16] aggregate: ROLLBACK (f1_val pre=0.157 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.557229 cos_to_last_merge=0.9881 (last merge round=20)
[S2] round=23 local utility u=0.110680 metrics={'f1_val': 0.26526704958077507, 'auprc': 0.26526704958077507, 'loss_val': 1.8545657715322068, 'psi': 0.26526704958077507}-{'f1_val': 0.2469904524699045, 'auprc': 0.2469904524699045, 'loss_val': 1.911435892047209, 'psi': 0.2469904524699045}
[S3] START round=23 head_norm_before_train=1.738512 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.2856550015297175, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.1182100524104848, 'psi': 0.3641628959276018}
[S4] START round=23 head_norm_before_train=1.380288 cos_to_last_merge=0.9968 (last merge round=21)
[S4] round=23 local utility u=0.004764 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1890606448448722, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.198587689528319, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.563500 cos_to_last_merge=0.9477 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 3.0629072419058256, 'psi': 0.24987642115669798}-{'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 3.034499939585346, 'psi': 0.24987642115669798}
[S6] START round=23 head_norm_before_train=1.222921 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.303319 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 2.8833189065174465, 'psi': 0.017774699907663897}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 3.4859454475771035, 'psi': 0.01732902033271719}
[S7] START round=23 head_norm_before_train=1.547105 (no previous merge yet)
[S7] round=23 local utility u=0.012349 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1184713557380683, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1431689990091163, 'psi': 0.35976373724718097}
[S8] START round=23 head_norm_before_train=1.784191 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6685543552351143, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6393432222109511, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.777748 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.688437022802137, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.632259952748249, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.726325 (no previous merge yet)
[S10] round=23 local utility u=0.035410 metrics={'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.7441744381898867, 'psi': 0.332855321861058}-{'f1_val': 0.3328550932568149, 'auprc': 0.3328550932568149, 'loss_val': 2.8149922532099154, 'psi': 0.3328550932568149}
[S11] START round=23 head_norm_before_train=1.665414 (no previous merge yet)
[S11] round=23 local utility u=0.072306 metrics={'f1_val': 0.32335600907029477, 'auprc': 0.32335600907029477, 'loss_val': 2.5538841697585495, 'psi': 0.32335600907029477}-{'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.705109495562943, 'psi': 0.3240909090909091}
[S13] START round=23 head_norm_before_train=1.480408 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000974 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2859002729851456, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2878490179674873, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.708021 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.2653683723239535, 'psi': 0.13587634006482174}-{'f1_val': 0.13192612137203166, 'auprc': 0.13192612137203166, 'loss_val': 5.229416350326728, 'psi': 0.13192612137203166}
[S15] START round=23 head_norm_before_train=1.760337 (no previous merge yet)
[S15] round=23 local utility u=0.026032 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7496974257025406, 'psi': 0.6164158146233559}-{'f1_val': 0.6144788671349031, 'auprc': 0.6144788671349031, 'loss_val': 0.7843288900404775, 'psi': 0.6144788671349031}
[S16] START round=23 head_norm_before_train=1.171518 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.291472 metrics={'f1_val': 0.14798906677079265, 'auprc': 0.14798906677079265, 'loss_val': 1.5855429424753444, 'psi': 0.14798906677079265}-{'f1_val': 0.15658816040738383, 'auprc': 0.15658816040738383, 'loss_val': 2.2458783152720323, 'psi': 0.15658816040738383}
[S17] START round=23 head_norm_before_train=1.678453 (no previous merge yet)
[S17] round=23 local utility u=0.183452 metrics={'f1_val': 0.18893428506222226, 'auprc': 0.18893428506222226, 'loss_val': 0.8348953478316632, 'psi': 0.18893428506222226}-{'f1_val': 0.15283914874144325, 'auprc': 0.15283914874144325, 'loss_val': 0.8769437575558815, 'psi': 0.15283914874144325}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:36616
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:36607
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.0275
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] cosine check vs S2: cos=0.9425
[S16] RECEIVED delta(kind=head bytes=1795) from S4
[S16] cosine check vs S4: cos=0.9224
[S6] RECEIVED delta(kind=head bytes=1792) from S7
[S6] cosine check vs S7: cos=0.9204
[S4] RECEIVED delta(kind=head bytes=1799) from S15
[S4] cosine check vs S15: cos=-0.0679
[S4] DROPPED delta from S15 (cos=-0.0679 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S10
[S6] cosine check vs S10: cos=0.3448
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=0.0018
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=0.9074
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=0.9735
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.0178 head_norm=1.260262
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.141504e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.0178 head_norm=1.177205 delta_norm=0.314150
[S6] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.2653 head_norm=1.608192
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.560988e-01
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.2590 head_norm=1.607694 delta_norm=0.356099
[S2] aggregate: ROLLBACK (f1_val pre=0.265 post=0.259 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.3598 head_norm=1.567214
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.888641e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.3598 head_norm=0.904524 delta_norm=0.888864
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.1480 head_norm=1.205995
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.823229e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.0000 head_norm=1.293232 delta_norm=0.282323
[S16] aggregate: ROLLBACK (f1_val pre=0.148 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.3599 head_norm=1.498629
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.088700e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.1160 head_norm=1.587658 delta_norm=0.208870
[S13] aggregate: ROLLBACK (f1_val pre=0.360 post=0.116 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.3568 head_norm=1.431741
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.718983e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.3568 head_norm=1.498050 delta_norm=0.271898
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.607694 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.031223 metrics={'f1_val': 0.2468817204301075, 'auprc': 0.2468817204301075, 'loss_val': 1.626652091394615, 'psi': 0.24688172043010753}-{'f1_val': 0.26526704958077507, 'auprc': 0.26526704958077507, 'loss_val': 1.8545657715322068, 'psi': 0.26526704958077507}
[S3] START round=24 head_norm_before_train=1.760643 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.3459157612294836, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.2856550015297175, 'psi': 0.3641628959276018}
[S4] START round=24 head_norm_before_train=1.498050 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.023185 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1426898797192842, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1890606448448722, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.578276 cos_to_last_merge=0.9451 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.945
[S5] round=24 local utility u=0.014104 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.0341427556255236, 'psi': 0.24981467753891773}-{'f1_val': 0.24987642115669798, 'auprc': 0.24987642115669798, 'loss_val': 3.0629072419058256, 'psi': 0.24987642115669798}
[S6] START round=24 head_norm_before_train=1.177205 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.020685 metrics={'f1_val': 0.01576263328697265, 'auprc': 0.01576263328697265, 'loss_val': 2.8238400842564926, 'psi': 0.01576263328697265}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 2.8833189065174465, 'psi': 0.017774699907663897}
[S7] START round=24 head_norm_before_train=0.904524 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2016737758146112, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1184713557380683, 'psi': 0.35976373724718097}
[S8] START round=24 head_norm_before_train=1.805076 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6800658219265115, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6685543552351143, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.797392 cos_to_last_merge=0.9996 (last merge round=22)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7580369798213138, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.688437022802137, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.740392 (no previous merge yet)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 2.7438282322674596, 'psi': 0.33277551996175}-{'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.7441744381898867, 'psi': 0.332855321861058}
[S11] START round=24 head_norm_before_train=1.684248 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.764438520091463, 'psi': 0.32387008857597094}-{'f1_val': 0.32335600907029477, 'auprc': 0.32335600907029477, 'loss_val': 2.5538841697585495, 'psi': 0.32335600907029477}
[S13] START round=24 head_norm_before_train=1.587658 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.013611 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2586781426366622, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2859002729851456, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.728460 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.329959883470572, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.2653683723239535, 'psi': 0.13587634006482174}
[S15] START round=24 head_norm_before_train=1.780749 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6087461862735628, 'auprc': 0.6087461862735628, 'loss_val': 0.7756497487376518, 'psi': 0.6087461862735628}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7496974257025406, 'psi': 0.6164158146233559}
[S16] START round=24 head_norm_before_train=1.293232 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.16222641773302568, 'auprc': 0.16222641773302568, 'loss_val': 1.8631127367112263, 'psi': 0.16222641773302568}-{'f1_val': 0.14798906677079265, 'auprc': 0.14798906677079265, 'loss_val': 1.5855429424753444, 'psi': 0.14798906677079265}
[S17] START round=24 head_norm_before_train=1.697846 (no previous merge yet)
[S17] round=24 local utility u=0.044533 metrics={'f1_val': 0.20366741048413925, 'auprc': 0.20366741048413925, 'loss_val': 0.8784273934706236, 'psi': 0.20366741048413925}-{'f1_val': 0.18893428506222226, 'auprc': 0.18893428506222226, 'loss_val': 0.8348953478316632, 'psi': 0.18893428506222226}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.016)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:36612
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.9474
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] cosine check vs S2: cos=0.9654
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:36617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S13
[S17] cosine check vs S13: cos=0.9856
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.8604
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.3687 head_norm=1.816169
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.630230e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.3687 head_norm=1.642843 delta_norm=0.463023
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.2469 head_norm=1.648243
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.640820e-01
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.2490 head_norm=1.572642 delta_norm=0.264082
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.3239 head_norm=1.700726
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.217010e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.3239 head_norm=1.659950 delta_norm=0.221701
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.2037 head_norm=1.715136
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.508952e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.2037 head_norm=1.654845 delta_norm=0.150895
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.572642 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.2513763763763764, 'auprc': 0.2513763763763764, 'loss_val': 1.839538492095171, 'psi': 0.2513763763763764}-{'f1_val': 0.2468817204301075, 'auprc': 0.2468817204301075, 'loss_val': 1.626652091394615, 'psi': 0.24688172043010753}
[S3] START round=25 head_norm_before_train=1.780038 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.413163737940278, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.3459157612294836, 'psi': 0.3641628959276018}
[S4] START round=25 head_norm_before_train=1.539214 cos_to_last_merge=0.9979 (last merge round=23)
[S4] round=25 local utility u=0.009207 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1242763371697553, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1426898797192842, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.590024 cos_to_last_merge=0.9434 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=25 local utility u=0.358148 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 3.0672905917723194, 'psi': 0.33308623671855697}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.0341427556255236, 'psi': 0.24981467753891773}
[S6] START round=25 head_norm_before_train=1.218580 cos_to_last_merge=0.9957 (last merge round=23)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 3.3659788184742445, 'psi': 0.02153000458085204}-{'f1_val': 0.01576263328697265, 'auprc': 0.01576263328697265, 'loss_val': 2.8238400842564926, 'psi': 0.01576263328697265}
[S7] START round=25 head_norm_before_train=0.939116 cos_to_last_merge=0.9985 (last merge round=23)
[S7] round=25 local utility u=0.010601 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1804716991127886, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2016737758146112, 'psi': 0.35976373724718097}
[S8] START round=25 head_norm_before_train=1.824299 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6966548026420825, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6800658219265115, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.642843 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.106629 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5447793423345428, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7580369798213138, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.757007 (no previous merge yet)
[S10] round=25 local utility u=0.028458 metrics={'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.6876298087077335, 'psi': 0.332855321861058}-{'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 2.7438282322674596, 'psi': 0.33277551996175}
[S11] START round=25 head_norm_before_train=1.659950 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.010325 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.7457759594491837, 'psi': 0.3240909090909091}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.764438520091463, 'psi': 0.32387008857597094}
[S13] START round=25 head_norm_before_train=1.606509 cos_to_last_merge=0.9980 (last merge round=23)
[S13] round=25 local utility u=0.031473 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1957324660972128, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2586781426366622, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.746940 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.397703882363899, 'psi': 0.13572854291417166}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.329959883470572, 'psi': 0.13587634006482174}
[S15] START round=25 head_norm_before_train=1.799700 (no previous merge yet)
[S15] round=25 local utility u=0.076457 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.6917632000844302, 'psi': 0.6164158146233559}-{'f1_val': 0.6087461862735628, 'auprc': 0.6087461862735628, 'loss_val': 0.7756497487376518, 'psi': 0.6087461862735628}
[S16] START round=25 head_norm_before_train=1.328300 cos_to_last_merge=0.9967 (last merge round=23)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.11505649066174775, 'auprc': 0.11505649066174775, 'loss_val': 2.3347783117108265, 'psi': 0.11505649066174775}-{'f1_val': 0.16222641773302568, 'auprc': 0.16222641773302568, 'loss_val': 1.8631127367112263, 'psi': 0.16222641773302568}
[S17] START round=25 head_norm_before_train=1.654845 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.18778245889914072, 'auprc': 0.18778245889914072, 'loss_val': 0.8517271918772992, 'psi': 0.18778245889914072}-{'f1_val': 0.20366741048413925, 'auprc': 0.20366741048413925, 'loss_val': 0.8784273934706236, 'psi': 0.20366741048413925}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:36616
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:36617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:36609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:36602
[S13] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S7
[S16] cosine check vs S7: cos=0.2637
[S17] RECEIVED delta(kind=head bytes=1804) from S13
[S17] cosine check vs S13: cos=0.9905
[S2] RECEIVED delta(kind=head bytes=1795) from S4
[S2] cosine check vs S4: cos=0.9813
[S8] RECEIVED delta(kind=head bytes=1804) from S9
[S8] cosine check vs S9: cos=0.9597
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.9577
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.3594 head_norm=1.838926
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.633866e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.3594 head_norm=1.732515 delta_norm=0.263387
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.112 → S3@127.0.0.1:36603
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=25 metric=0.2514 head_norm=1.619989
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.559927e-01
[S2] stored merged vector for next round verification (round=25)
[S2] DEBUG after merge:  round=25 metric=0.2518 head_norm=1.593318 delta_norm=0.155993
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.073 → S11@127.0.0.1:36612
[S4] ⇄ pheromone p=0.128 → S2@127.0.0.1:36602
[S5] ⇄ pheromone p=0.088 → S9@127.0.0.1:36610
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.3687 head_norm=1.661418
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.391835e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.3687 head_norm=1.614274 delta_norm=0.239184
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.045 → S8@127.0.0.1:36609
[S7] ⇄ pheromone p=0.059 → S16@127.0.0.1:36616
[S11] ⇄ pheromone p=0.070 → S2@127.0.0.1:36602
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.1151 head_norm=1.374706
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.322649e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.1191 head_norm=0.945029 delta_norm=0.732265
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.208 → S4@127.0.0.1:36604
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.1878 head_norm=1.668931
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.150991e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.1869 head_norm=1.645213 delta_norm=0.115099
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.029 → S17@127.0.0.1:36617
[S2] START round=26 head_norm_before_train=1.593318 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.26463808206546796, 'auprc': 0.26463808206546796, 'loss_val': 2.055194925867444, 'psi': 0.26463808206546796}-{'f1_val': 0.2513763763763764, 'auprc': 0.2513763763763764, 'loss_val': 1.839538492095171, 'psi': 0.2513763763763764}
[S3] START round=26 head_norm_before_train=1.797071 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.470555803287234, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.413163737940278, 'psi': 0.3641628959276018}
[S4] START round=26 head_norm_before_train=1.581654 cos_to_last_merge=0.9932 (last merge round=23)
[S4] round=26 local utility u=0.009852 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1045722292623117, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1242763371697553, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.601833 cos_to_last_merge=0.9420 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.032161171696665, 'psi': 0.24981467753891773}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 3.0672905917723194, 'psi': 0.33308623671855697}
[S6] START round=26 head_norm_before_train=1.275118 cos_to_last_merge=0.9836 (last merge round=23)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.01576263328697265, 'auprc': 0.01576263328697265, 'loss_val': 4.0661280709757, 'psi': 0.01576263328697265}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 3.3659788184742445, 'psi': 0.02153000458085204}
[S7] START round=26 head_norm_before_train=0.984259 cos_to_last_merge=0.9937 (last merge round=23)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.229032850064232, 'auprc': 0.229032850064232, 'loss_val': 1.165856055612964, 'psi': 0.22903285006423202}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1804716991127886, 'psi': 0.35976373724718097}
[S8] START round=26 head_norm_before_train=1.732515 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7061395107649683, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6966548026420825, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.614274 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.043199 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4583815473707338, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5447793423345428, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.775006 (no previous merge yet)
[S10] round=26 local utility u=0.025944 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.6350268009313584, 'psi': 0.3327757865392274}-{'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.6876298087077335, 'psi': 0.332855321861058}
[S11] START round=26 head_norm_before_train=1.678588 cos_to_last_merge=0.9999 (last merge round=24)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.744938284371092, 'psi': 0.32387008857597094}-{'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.7457759594491837, 'psi': 0.3240909090909091}
[S13] START round=26 head_norm_before_train=1.629298 cos_to_last_merge=0.9937 (last merge round=23)
[S13] round=26 local utility u=0.026844 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1420452251010191, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1957324660972128, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.763807 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.12663367592945057, 'auprc': 0.12663367592945057, 'loss_val': 5.476673065232685, 'psi': 0.12663367592945057}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.397703882363899, 'psi': 0.13572854291417166}
[S15] START round=26 head_norm_before_train=1.821765 (no previous merge yet)
[S15] round=26 local utility u=0.006723 metrics={'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6738191737387598, 'psi': 0.61591610673549}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.6917632000844302, 'psi': 0.6164158146233559}
[S16] START round=26 head_norm_before_train=0.945029 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.323820 metrics={'f1_val': 0.15144307009197588, 'auprc': 0.15144307009197588, 'loss_val': 2.014617718094382, 'psi': 0.15144307009197588}-{'f1_val': 0.11505649066174775, 'auprc': 0.11505649066174775, 'loss_val': 2.3347783117108265, 'psi': 0.11505649066174775}
[S17] START round=26 head_norm_before_train=1.645213 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.329178 metrics={'f1_val': 0.2595319441648671, 'auprc': 0.2595319441648671, 'loss_val': 0.8391160364081139, 'psi': 0.2595319441648671}-{'f1_val': 0.18778245889914072, 'auprc': 0.18778245889914072, 'loss_val': 0.8517271918772992, 'psi': 0.18778245889914072}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:36613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:36617
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:36616
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:36609
[S13] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S13
[S17] cosine check vs S13: cos=0.9943
[S4] RECEIVED delta(kind=head bytes=1794) from S16
[S4] cosine check vs S16: cos=0.7997
[S13] RECEIVED delta(kind=head bytes=1804) from S17
[S13] cosine check vs S17: cos=0.9943
[S9] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S9
[S8] cosine check vs S9: cos=0.9589
[S16] RECEIVED delta(kind=head bytes=1804) from S4
[S16] cosine check vs S4: cos=0.7997
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.2595 head_norm=1.657007
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.836988e-02
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.2599 head_norm=1.650249 delta_norm=0.088370
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.3599 head_norm=1.648208
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.836989e-02
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.3599 head_norm=1.650249 delta_norm=0.088370
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.3568 head_norm=1.612324
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.059118e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.3568 head_norm=1.240580 delta_norm=0.505912
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.1514 head_norm=0.995181
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.059118e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.0960 head_norm=1.240580 delta_norm=0.505912
[S16] aggregate: ROLLBACK (f1_val pre=0.151 post=0.096 tol_abs=0.005 tol_rel=0.0)
[S2] START round=27 head_norm_before_train=1.633557 cos_to_last_merge=0.9995 (last merge round=25)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.20695929042528996, 'auprc': 0.20695929042528996, 'loss_val': 2.522497475728063, 'psi': 0.20695929042528996}-{'f1_val': 0.26463808206546796, 'auprc': 0.26463808206546796, 'loss_val': 2.055194925867444, 'psi': 0.26463808206546796}
[S3] START round=27 head_norm_before_train=1.812021 (no previous merge yet)
[S3] round=27 local utility u=0.003103 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.464349280357365, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.470555803287234, 'psi': 0.3641628959276018}
[S4] START round=27 head_norm_before_train=1.240580 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1404787112208263, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1045722292623117, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.613299 cos_to_last_merge=0.9408 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=27 local utility u=0.004678 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.02280426323408, 'psi': 0.24981467753891773}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.032161171696665, 'psi': 0.24981467753891773}
[S6] START round=27 head_norm_before_train=1.332845 cos_to_last_merge=0.9694 (last merge round=23)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 4.3770267363175375, 'psi': 0.01954921803127875}-{'f1_val': 0.01576263328697265, 'auprc': 0.01576263328697265, 'loss_val': 4.0661280709757, 'psi': 0.01576263328697265}
[S7] START round=27 head_norm_before_train=1.025813 cos_to_last_merge=0.9877 (last merge round=23)
[S7] round=27 local utility u=0.615913 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1106086092299803, 'psi': 0.35976373724718097}-{'f1_val': 0.229032850064232, 'auprc': 0.229032850064232, 'loss_val': 1.165856055612964, 'psi': 0.22903285006423202}
[S8] START round=27 head_norm_before_train=1.747366 cos_to_last_merge=0.9999 (last merge round=25)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7084778204497763, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7061395107649683, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.633399 cos_to_last_merge=0.9998 (last merge round=25)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5133537062385267, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4583815473707338, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.797160 (no previous merge yet)
[S10] round=27 local utility u=0.033512 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.5680018131265516, 'psi': 0.3327757865392274}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.6350268009313584, 'psi': 0.3327757865392274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=27 head_norm_before_train=1.698781 cos_to_last_merge=0.9996 (last merge round=24)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.790087194658377, 'psi': 0.32387008857597094}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.744938284371092, 'psi': 0.32387008857597094}
[S13] START round=27 head_norm_before_train=1.650249 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.021203 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0996398604698332, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1420452251010191, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.779428 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.12539743100597736, 'auprc': 0.12539743100597736, 'loss_val': 5.530118377731917, 'psi': 0.12539743100597736}-{'f1_val': 0.12663367592945057, 'auprc': 0.12663367592945057, 'loss_val': 5.476673065232685, 'psi': 0.12663367592945057}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=1.837803 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.670137855463371, 'psi': 0.6136702686915539}-{'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6738191737387598, 'psi': 0.61591610673549}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.240580 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.15065224307986, 'auprc': 0.15065224307986, 'loss_val': 2.164446035933746, 'psi': 0.15065224307986}-{'f1_val': 0.15144307009197588, 'auprc': 0.15144307009197588, 'loss_val': 2.014617718094382, 'psi': 0.15144307009197588}
[S17] START round=27 head_norm_before_train=1.650249 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.008459 metrics={'f1_val': 0.26135209350927074, 'auprc': 0.26135209350927074, 'loss_val': 0.8385795549062799, 'psi': 0.26135209350927074}-{'f1_val': 0.2595319441648671, 'auprc': 0.2595319441648671, 'loss_val': 0.8391160364081139, 'psi': 0.2595319441648671}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:36617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:36613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:36610
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[S5] sending update (kind=head size=1804 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.3594 head_norm=1.762254
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.564165e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.3594 head_norm=1.679588 delta_norm=0.256417
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.9852
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] cosine check vs S3: cos=-0.0274
[S6] DROPPED delta from S3 (cos=-0.0274 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.9990
[S17] RECEIVED delta(kind=head bytes=1803) from S13
[S17] cosine check vs S13: cos=0.9990
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.3599 head_norm=1.667596
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.796032e-02
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.3599 head_norm=1.665436 delta_norm=0.037960
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.3687 head_norm=1.652715
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.415333e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.3687 head_norm=1.634033 delta_norm=0.141533
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.2614 head_norm=1.664138
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.796032e-02
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.2617 head_norm=1.665436 delta_norm=0.037960
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] RoundReady barrier timeout: have=2 need=3 — continuing
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:36616
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.4200
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.1507 head_norm=1.287350
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.391725e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.1169 head_norm=0.990653 delta_norm=0.639172
[S16] aggregate: ROLLBACK (f1_val pre=0.151 post=0.117 tol_abs=0.005 tol_rel=0.0)
[S5]  timeout peer S9
[S9]  timeout peer S8
[S16]  timeout peer S4
[S4]  timeout peer S2
[S4]  timeout peer S6
[S4]  timeout peer S15
[S7]  timeout peer S5
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S6]  timeout peer S3
[S6]  timeout peer S7
[S6]  timeout peer S10
[S13]  timeout peer S17
[S2] START round=28 head_norm_before_train=1.663293 cos_to_last_merge=0.9987 (last merge round=25)
[S2] round=28 local utility u=0.454300 metrics={'f1_val': 0.2550625277724878, 'auprc': 0.2550625277724878, 'loss_val': 2.046827365712542, 'psi': 0.2550625277724878}-{'f1_val': 0.20695929042528996, 'auprc': 0.20695929042528996, 'loss_val': 2.522497475728063, 'psi': 0.20695929042528996}
[S3] START round=28 head_norm_before_train=1.824907 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.492697925081495, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.464349280357365, 'psi': 0.3641628959276018}
[S4] START round=28 head_norm_before_train=1.273959 cos_to_last_merge=0.9994 (last merge round=26)
[S4] round=28 local utility u=0.010594 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1192913628564467, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1404787112208263, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.627489 cos_to_last_merge=0.9392 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.0482233821726212, 'psi': 0.24981467753891773}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.02280426323408, 'psi': 0.24981467753891773}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.380378 cos_to_last_merge=0.9575 (last merge round=23)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 4.758730478637933, 'psi': 0.017551963048498844}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 4.3770267363175375, 'psi': 0.01954921803127875}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.059527 cos_to_last_merge=0.9815 (last merge round=23)
[S7] round=28 local utility u=0.016366 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.077875673664895, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1106086092299803, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=28 head_norm_before_train=1.679588 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.725527463873934, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7084778204497763, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.634033 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.008521 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.496310912859059, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5133537062385267, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.830024 (no previous merge yet)
[S10] round=28 local utility u=0.022308 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.5233862464251637, 'psi': 0.3327757865392274}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.5680018131265516, 'psi': 0.3327757865392274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=28 head_norm_before_train=1.719441 cos_to_last_merge=0.9992 (last merge round=24)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.32401303326513603, 'auprc': 0.32401303326513603, 'loss_val': 2.8970795324417593, 'psi': 0.32401303326513603}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.790087194658377, 'psi': 0.32387008857597094}
[S13] START round=28 head_norm_before_train=1.665436 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.020442 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0587563648091947, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0996398604698332, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=28 head_norm_before_train=1.793643 (no previous merge yet)
[S14] round=28 local utility u=0.019690 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.56216146252314, 'psi': 0.13333333333333333}-{'f1_val': 0.12539743100597736, 'auprc': 0.12539743100597736, 'loss_val': 5.530118377731917, 'psi': 0.12539743100597736}
[S14] not sending this round → trigger blocked (psi=0.133)
[S15] START round=28 head_norm_before_train=1.854542 (no previous merge yet)
[S15] round=28 local utility u=0.027061 metrics={'f1_val': 0.6159976262008086, 'auprc': 0.6159976262008086, 'loss_val': 0.6369625581927671, 'psi': 0.6159976262008086}-{'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.670137855463371, 'psi': 0.6136702686915539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=28 head_norm_before_train=0.990653 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.145757 metrics={'f1_val': 0.15588513726727674, 'auprc': 0.15588513726727674, 'loss_val': 1.9200274420726269, 'psi': 0.15588513726727674}-{'f1_val': 0.15065224307986, 'auprc': 0.15065224307986, 'loss_val': 2.164446035933746, 'psi': 0.15065224307986}
[S17] START round=28 head_norm_before_train=1.665436 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.2519501104644402, 'auprc': 0.2519501104644402, 'loss_val': 0.8621831532610111, 'psi': 0.2519501104644402}-{'f1_val': 0.26135209350927074, 'auprc': 0.26135209350927074, 'loss_val': 0.8385795549062799, 'psi': 0.26135209350927074}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:36608
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[S4] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1792) from S16
[S7] cosine check vs S16: cos=0.7735
[S16] RECEIVED delta(kind=head bytes=1805) from S4
[S16] cosine check vs S4: cos=0.8764
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.1559 head_norm=1.037588
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.206460e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.1551 head_norm=1.138054 delta_norm=0.320646
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=0.9465
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:36605
[S9] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S9
[S5] cosine check vs S9: cos=0.9948
[S2] START round=29 head_norm_before_train=1.686154 cos_to_last_merge=0.9979 (last merge round=25)
[S2] round=29 local utility u=0.487278 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0840063639080824, 'psi': 0.3674775928297055}-{'f1_val': 0.2550625277724878, 'auprc': 0.2550625277724878, 'loss_val': 2.046827365712542, 'psi': 0.2550625277724878}
[S3] START round=29 head_norm_before_train=1.835967 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.527706322582347, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.492697925081495, 'psi': 0.3641628959276018}
[S4] START round=29 head_norm_before_train=1.311249 cos_to_last_merge=0.9977 (last merge round=26)
[S4] round=29 local utility u=0.011215 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0968607343268328, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1192913628564467, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.642821 cos_to_last_merge=0.9376 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.938
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.0867903293903725, 'psi': 0.24981467753891773}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.0482233821726212, 'psi': 0.24981467753891773}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.2498 head_norm=1.657673
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.821789e-02
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.2498 head_norm=1.652797 delta_norm=0.088218
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] START round=29 head_norm_before_train=1.418814 cos_to_last_merge=0.9483 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=29 local utility u=0.077075 metrics={'f1_val': 0.027161611588954276, 'auprc': 0.027161611588954276, 'loss_val': 4.691066659076525, 'psi': 0.027161611588954276}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 4.758730478637933, 'psi': 0.017551963048498844}
[S6] not sending this round → trigger blocked (psi=0.027)
[S7] START round=29 head_norm_before_train=1.092068 cos_to_last_merge=0.9749 (last merge round=23)
[S7] round=29 local utility u=0.015462 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.046951417401888, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.077875673664895, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.3598 head_norm=1.125166
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.704172e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.3598 head_norm=1.016900 delta_norm=0.370417
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] START round=29 head_norm_before_train=1.694598 cos_to_last_merge=0.9998 (last merge round=27)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.743973368516887, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.725527463873934, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.652621 cos_to_last_merge=0.9998 (last merge round=27)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5691862565485357, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.496310912859059, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.868327 (no previous merge yet)
[S10] round=29 local utility u=0.011243 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.5009004104406016, 'psi': 0.3327757865392274}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.5233862464251637, 'psi': 0.3327757865392274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=29 head_norm_before_train=1.739162 cos_to_last_merge=0.9985 (last merge round=24)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.3240867060785205, 'auprc': 0.3240867060785205, 'loss_val': 2.9469097396524147, 'psi': 0.3240867060785205}-{'f1_val': 0.32401303326513603, 'auprc': 0.32401303326513603, 'loss_val': 2.8970795324417593, 'psi': 0.32401303326513603}
[S13] START round=29 head_norm_before_train=1.686711 cos_to_last_merge=0.9993 (last merge round=27)
[S13] round=29 local utility u=0.011309 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0361391298338385, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0587563648091947, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=29 head_norm_before_train=1.806538 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.610549542030235, 'psi': 0.13572854291417166}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.56216146252314, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=1.874818 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6106824059234626, 'auprc': 0.6106824059234626, 'loss_val': 0.6634513997880979, 'psi': 0.6106824059234626}-{'f1_val': 0.6159976262008086, 'auprc': 0.6159976262008086, 'loss_val': 0.6369625581927671, 'psi': 0.6159976262008086}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.138054 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.1398371437519574, 'auprc': 0.1398371437519574, 'loss_val': 2.2975040399489406, 'psi': 0.1398371437519574}-{'f1_val': 0.15588513726727674, 'auprc': 0.15588513726727674, 'loss_val': 1.9200274420726269, 'psi': 0.15588513726727674}
[S17] START round=29 head_norm_before_train=1.679918 cos_to_last_merge=0.9999 (last merge round=27)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.19556272206497605, 'auprc': 0.19556272206497605, 'loss_val': 0.8906745039125938, 'psi': 0.19556272206497605}-{'f1_val': 0.2519501104644402, 'auprc': 0.2519501104644402, 'loss_val': 0.8621831532610111, 'psi': 0.2519501104644402}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:36616
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[S4] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S4
[S16] cosine check vs S4: cos=0.9688
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.3568 head_norm=1.341315
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.076860e-01
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.3568 head_norm=1.492129 delta_norm=0.307686
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.9885
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.1398 head_norm=1.195064
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.743003e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.1363 head_norm=1.258281 delta_norm=0.174300
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.705477 cos_to_last_merge=0.9971 (last merge round=25)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.1338276457345584, 'psi': 0.2450298816928894}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0840063639080824, 'psi': 0.3674775928297055}
[S3] START round=30 head_norm_before_train=1.847674 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.5508828029706017, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.527706322582347, 'psi': 0.3641628959276018}
[S4] START round=30 head_norm_before_train=1.492129 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.029079 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0387031847545194, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0968607343268328, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.652797 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.051900 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 2.9829911803248916, 'psi': 0.24981467753891773}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.0867903293903725, 'psi': 0.24981467753891773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=30 head_norm_before_train=1.451443 cos_to_last_merge=0.9409 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.15402923644447, 'psi': 0.017551963048498844}-{'f1_val': 0.027161611588954276, 'auprc': 0.027161611588954276, 'loss_val': 4.691066659076525, 'psi': 0.027161611588954276}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.016900 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.001622 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.04370802606825, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.046951417401888, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=30 head_norm_before_train=1.717278 cos_to_last_merge=0.9994 (last merge round=27)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7780546919032599, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.743973368516887, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.671214 cos_to_last_merge=0.9993 (last merge round=27)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6348246490202052, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5691862565485357, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.906604 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.5039043039195272, 'psi': 0.3326959847036329}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.5009004104406016, 'psi': 0.3327757865392274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=30 head_norm_before_train=1.756648 cos_to_last_merge=0.9979 (last merge round=24)
[S11] round=30 local utility u=0.039781 metrics={'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.8640749811367443, 'psi': 0.3237230419977299}-{'f1_val': 0.3240867060785205, 'auprc': 0.3240867060785205, 'loss_val': 2.9469097396524147, 'psi': 0.3240867060785205}
[S13] START round=30 head_norm_before_train=1.708493 cos_to_last_merge=0.9980 (last merge round=27)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.057894919567826, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0361391298338385, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.818252 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.666117917579506, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.610549542030235, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.895676 (no previous merge yet)
[S15] round=30 local utility u=0.059443 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5966845407203022, 'psi': 0.6164734888353558}-{'f1_val': 0.6106824059234626, 'auprc': 0.6106824059234626, 'loss_val': 0.6634513997880979, 'psi': 0.6106824059234626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=30 head_norm_before_train=1.258281 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.06851251351126632, 'auprc': 0.06851251351126632, 'loss_val': 2.924073089081621, 'psi': 0.06851251351126632}-{'f1_val': 0.1398371437519574, 'auprc': 0.1398371437519574, 'loss_val': 2.2975040399489406, 'psi': 0.1398371437519574}
[S17] START round=30 head_norm_before_train=1.701670 cos_to_last_merge=0.9996 (last merge round=27)
[S17] round=30 local utility u=0.210591 metrics={'f1_val': 0.2506743525795499, 'auprc': 0.2506743525795499, 'loss_val': 0.9654965892804024, 'psi': 0.2506743525795499}-{'f1_val': 0.19556272206497605, 'auprc': 0.19556272206497605, 'loss_val': 0.8906745039125938, 'psi': 0.19556272206497605}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.3568 head_norm=1.513830
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.624008e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.3568 head_norm=1.604305 delta_norm=0.162401
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=31 head_norm_before_train=1.721196 cos_to_last_merge=0.9963 (last merge round=25)
[S2] round=31 local utility u=0.017290 metrics={'f1_val': 0.2588583945367865, 'auprc': 0.2588583945367865, 'loss_val': 2.2237046131827234, 'psi': 0.2588583945367865}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.1338276457345584, 'psi': 0.2450298816928894}
[S3] START round=31 head_norm_before_train=1.858895 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.558924558505031, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.5508828029706017, 'psi': 0.3641628959276018}
[S4] START round=31 head_norm_before_train=1.604305 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.021365 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9959721873787819, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0387031847545194, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.664165 cos_to_last_merge=0.9999 (last merge round=29)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.0130883680977583, 'psi': 0.24981467753891773}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 2.9829911803248916, 'psi': 0.24981467753891773}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.477062 cos_to_last_merge=0.9353 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.935
[S6] round=31 local utility u=0.019144 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 5.143637952145834, 'psi': 0.02065167508031207}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.15402923644447, 'psi': 0.017551963048498844}
[S6] not sending this round → trigger blocked (psi=0.021)
[S7] START round=31 head_norm_before_train=1.049023 cos_to_last_merge=0.9991 (last merge round=29)
[S7] round=31 local utility u=0.015679 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0123496309116065, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.04370802606825, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=31 head_norm_before_train=1.741705 cos_to_last_merge=0.9986 (last merge round=27)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8061235087963147, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7780546919032599, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.688480 cos_to_last_merge=0.9986 (last merge round=27)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7006479963211025, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6348246490202052, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.941749 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.5086464187831163, 'psi': 0.3326959847036329}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.5039043039195272, 'psi': 0.3326959847036329}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=1.772135 cos_to_last_merge=0.9973 (last merge round=24)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.8799197867130966, 'psi': 0.3237230419977299}-{'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.8640749811367443, 'psi': 0.3237230419977299}
[S13] START round=31 head_norm_before_train=1.727182 cos_to_last_merge=0.9966 (last merge round=27)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0639842000407231, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.057894919567826, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.829147 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.718207848481358, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.666117917579506, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=1.916470 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6143749116521263, 'auprc': 0.6143749116521263, 'loss_val': 0.605300810774041, 'psi': 0.6143749116521263}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5966845407203022, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.309370 cos_to_last_merge=0.9979 (last merge round=29)
[S16] round=31 local utility u=0.286622 metrics={'f1_val': 0.11435579060320379, 'auprc': 0.11435579060320379, 'loss_val': 2.7634190792609155, 'psi': 0.1143557906032038}-{'f1_val': 0.06851251351126632, 'auprc': 0.06851251351126632, 'loss_val': 2.924073089081621, 'psi': 0.06851251351126632}
[S17] START round=31 head_norm_before_train=1.724933 cos_to_last_merge=0.9991 (last merge round=27)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.21091233215773397, 'auprc': 0.21091233215773397, 'loss_val': 1.0432339087866445, 'psi': 0.21091233215773397}-{'f1_val': 0.2506743525795499, 'auprc': 0.2506743525795499, 'loss_val': 0.9654965892804024, 'psi': 0.2506743525795499}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S2] START round=32 head_norm_before_train=1.734416 cos_to_last_merge=0.9956 (last merge round=25)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.25821217016693593, 'auprc': 0.25821217016693593, 'loss_val': 2.4797978001862964, 'psi': 0.25821217016693593}-{'f1_val': 0.2588583945367865, 'auprc': 0.2588583945367865, 'loss_val': 2.2237046131827234, 'psi': 0.2588583945367865}
[S3] START round=32 head_norm_before_train=1.869305 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.6012152362821275, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.558924558505031, 'psi': 0.3641628959276018}
[S4] START round=32 head_norm_before_train=1.627533 cos_to_last_merge=0.9998 (last merge round=30)
[S4] round=32 local utility u=0.009319 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9773339580694426, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9959721873787819, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.679528 cos_to_last_merge=0.9997 (last merge round=29)
[S5] round=32 local utility u=0.010640 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 2.9918087732520813, 'psi': 0.24981467753891773}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.0130883680977583, 'psi': 0.24981467753891773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=32 head_norm_before_train=1.499594 cos_to_last_merge=0.9307 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.3216423723009365, 'psi': 0.01732902033271719}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 5.143637952145834, 'psi': 0.02065167508031207}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.080014 cos_to_last_merge=0.9968 (last merge round=29)
[S7] round=32 local utility u=0.012715 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9869190044829816, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0123496309116065, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=32 head_norm_before_train=1.765774 cos_to_last_merge=0.9977 (last merge round=27)
[S8] round=32 local utility u=0.009027 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7880686569602479, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8061235087963147, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.704723 cos_to_last_merge=0.9979 (last merge round=27)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7559748489528173, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7006479963211025, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=1.975080 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.511853757155034, 'psi': 0.3326959847036329}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.5086464187831163, 'psi': 0.3326959847036329}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.786564 cos_to_last_merge=0.9967 (last merge round=24)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.32401303326513603, 'auprc': 0.32401303326513603, 'loss_val': 3.0153976336232997, 'psi': 0.32401303326513603}-{'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.8799197867130966, 'psi': 0.3237230419977299}
[S13] START round=32 head_norm_before_train=1.739102 cos_to_last_merge=0.9954 (last merge round=27)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0969736727544168, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0639842000407231, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.839580 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.77089206455929, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.718207848481358, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.934849 (no previous merge yet)
[S15] round=32 local utility u=0.020569 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5817972553969997, 'psi': 0.6163342951580373}-{'f1_val': 0.6143749116521263, 'auprc': 0.6143749116521263, 'loss_val': 0.605300810774041, 'psi': 0.6143749116521263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=32 head_norm_before_train=1.354996 cos_to_last_merge=0.9935 (last merge round=29)
[S16] round=32 local utility u=0.119433 metrics={'f1_val': 0.14031245437290116, 'auprc': 0.14031245437290116, 'loss_val': 2.758163462012325, 'psi': 0.14031245437290116}-{'f1_val': 0.11435579060320379, 'auprc': 0.11435579060320379, 'loss_val': 2.7634190792609155, 'psi': 0.1143557906032038}
[S17] START round=32 head_norm_before_train=1.744563 cos_to_last_merge=0.9985 (last merge round=27)
[S17] round=32 local utility u=0.251669 metrics={'f1_val': 0.2625948019497088, 'auprc': 0.2625948019497088, 'loss_val': 1.0050379727707097, 'psi': 0.2625948019497088}-{'f1_val': 0.21091233215773397, 'auprc': 0.21091233215773397, 'loss_val': 1.0432339087866445, 'psi': 0.21091233215773397}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S2] START round=33 head_norm_before_train=1.746653 cos_to_last_merge=0.9949 (last merge round=25)
[S2] round=33 local utility u=0.073025 metrics={'f1_val': 0.2652926410358039, 'auprc': 0.2652926410358039, 'loss_val': 2.39747146948355, 'psi': 0.2652926410358039}-{'f1_val': 0.25821217016693593, 'auprc': 0.25821217016693593, 'loss_val': 2.4797978001862964, 'psi': 0.25821217016693593}
[S3] START round=33 head_norm_before_train=1.878112 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.612176115290347, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.6012152362821275, 'psi': 0.3641628959276018}
[S4] START round=33 head_norm_before_train=1.652557 cos_to_last_merge=0.9993 (last merge round=30)
[S4] round=33 local utility u=0.005247 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9668398867488461, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9773339580694426, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.694668 cos_to_last_merge=0.9993 (last merge round=29)
[S5] round=33 local utility u=0.000426 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 2.990956139860649, 'psi': 0.24981467753891773}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 2.9918087732520813, 'psi': 0.24981467753891773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=33 head_norm_before_train=1.519276 cos_to_last_merge=0.9268 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=33 local utility u=0.059035 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.245322326667945, 'psi': 0.021967963386727688}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.3216423723009365, 'psi': 0.01732902033271719}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=33 head_norm_before_train=1.112613 cos_to_last_merge=0.9930 (last merge round=29)
[S7] round=33 local utility u=0.012671 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9615772000604287, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9869190044829816, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=33 head_norm_before_train=1.783605 cos_to_last_merge=0.9968 (last merge round=27)
[S8] round=33 local utility u=0.007615 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7728394768692544, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7880686569602479, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.719229 cos_to_last_merge=0.9971 (last merge round=27)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8019395130225306, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7559748489528173, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=2.004793 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.5287757659914663, 'psi': 0.3326959847036329}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.511853757155034, 'psi': 0.3326959847036329}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.800333 cos_to_last_merge=0.9961 (last merge round=24)
[S11] round=33 local utility u=0.017849 metrics={'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.9777517785948424, 'psi': 0.3237965485921889}-{'f1_val': 0.32401303326513603, 'auprc': 0.32401303326513603, 'loss_val': 3.0153976336232997, 'psi': 0.32401303326513603}
[S13] START round=33 head_norm_before_train=1.750331 cos_to_last_merge=0.9943 (last merge round=27)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0969835308751972, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0969736727544168, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.849297 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.818258743633825, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.77089206455929, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.953548 (no previous merge yet)
[S15] round=33 local utility u=0.006927 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.5686778982565682, 'psi': 0.6164158146233559}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5817972553969997, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=33 head_norm_before_train=1.393195 cos_to_last_merge=0.9888 (last merge round=29)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.09282296650717703, 'auprc': 0.09282296650717703, 'loss_val': 3.2556860534685033, 'psi': 0.09282296650717703}-{'f1_val': 0.14031245437290116, 'auprc': 0.14031245437290116, 'loss_val': 2.758163462012325, 'psi': 0.14031245437290116}
[S17] START round=33 head_norm_before_train=1.758346 cos_to_last_merge=0.9979 (last merge round=27)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.20898396704848318, 'auprc': 0.20898396704848318, 'loss_val': 1.0698233122672607, 'psi': 0.20898396704848318}-{'f1_val': 0.2625948019497088, 'auprc': 0.2625948019497088, 'loss_val': 1.0050379727707097, 'psi': 0.2625948019497088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] sending update (kind=head size=1790 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S2] START round=34 head_norm_before_train=1.757711 cos_to_last_merge=0.9942 (last merge round=25)
[S2] round=34 local utility u=0.520559 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2760185393247347, 'psi': 0.3674775928297055}-{'f1_val': 0.2652926410358039, 'auprc': 0.2652926410358039, 'loss_val': 2.39747146948355, 'psi': 0.2652926410358039}
[S3] START round=34 head_norm_before_train=1.886486 (no previous merge yet)
[S3] round=34 local utility u=0.001096 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.609983321838372, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.612176115290347, 'psi': 0.3641628959276018}
[S4] START round=34 head_norm_before_train=1.674070 cos_to_last_merge=0.9986 (last merge round=30)
[S4] round=34 local utility u=0.002673 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9614934457273971, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9668398867488461, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=1.709743 cos_to_last_merge=0.9988 (last merge round=29)
[S5] round=34 local utility u=0.007237 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 2.9764813430619084, 'psi': 0.24981467753891773}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 2.990956139860649, 'psi': 0.24981467753891773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=34 head_norm_before_train=1.535015 cos_to_last_merge=0.9236 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.924
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 5.441294376712208, 'psi': 0.02065167508031207}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.245322326667945, 'psi': 0.021967963386727688}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.143314 cos_to_last_merge=0.9898 (last merge round=29)
[S7] round=34 local utility u=0.017504 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9265695488155166, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9615772000604287, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=34 head_norm_before_train=1.797892 cos_to_last_merge=0.9956 (last merge round=27)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8419311191012733, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7728394768692544, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.732184 cos_to_last_merge=0.9963 (last merge round=27)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8451276876996667, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8019395130225306, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=2.032271 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.552499825919221, 'psi': 0.3326959847036329}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.5287757659914663, 'psi': 0.3326959847036329}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.813083 cos_to_last_merge=0.9954 (last merge round=24)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 3.0388227155579464, 'psi': 0.32387008857597094}-{'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.9777517785948424, 'psi': 0.3237965485921889}
[S13] START round=34 head_norm_before_train=1.757890 cos_to_last_merge=0.9934 (last merge round=27)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1405618126358228, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0969835308751972, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.858724 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.863070166193616, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.818258743633825, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.973090 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6157765077628609, 'auprc': 0.6157765077628609, 'loss_val': 0.5788106958688797, 'psi': 0.6157765077628609}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.5686778982565682, 'psi': 0.6164158146233559}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.425439 cos_to_last_merge=0.9844 (last merge round=29)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.09172259507829977, 'auprc': 0.09172259507829977, 'loss_val': 3.4042383342041607, 'psi': 0.09172259507829977}-{'f1_val': 0.09282296650717703, 'auprc': 0.09282296650717703, 'loss_val': 3.2556860534685033, 'psi': 0.09282296650717703}
[S17] START round=34 head_norm_before_train=1.771848 cos_to_last_merge=0.9972 (last merge round=27)
[S17] round=34 local utility u=0.374731 metrics={'f1_val': 0.27405473107524847, 'auprc': 0.27405473107524847, 'loss_val': 0.9059977746356389, 'psi': 0.27405473107524847}-{'f1_val': 0.20898396704848318, 'auprc': 0.20898396704848318, 'loss_val': 1.0698233122672607, 'psi': 0.20898396704848318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S2] START round=35 head_norm_before_train=1.768063 cos_to_last_merge=0.9936 (last merge round=25)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.26531959852086634, 'auprc': 0.26531959852086634, 'loss_val': 2.385022658213821, 'psi': 0.26531959852086634}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2760185393247347, 'psi': 0.3674775928297055}
[S3] START round=35 head_norm_before_train=1.894438 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.646747085129265, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.609983321838372, 'psi': 0.3641628959276018}
[S4] START round=35 head_norm_before_train=1.692357 cos_to_last_merge=0.9979 (last merge round=30)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9616577836691437, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9614934457273971, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=1.725774 cos_to_last_merge=0.9982 (last merge round=29)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.0111647163079747, 'psi': 0.24981467753891773}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 2.9764813430619084, 'psi': 0.24981467753891773}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.548946 cos_to_last_merge=0.9209 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.921
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.007543611504007544, 'auprc': 0.007543611504007544, 'loss_val': 5.681262649194748, 'psi': 0.007543611504007544}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 5.441294376712208, 'psi': 0.02065167508031207}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.173737 cos_to_last_merge=0.9867 (last merge round=29)
[S7] round=35 local utility u=0.021448 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8836732949130351, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9265695488155166, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=35 head_norm_before_train=1.813902 cos_to_last_merge=0.9946 (last merge round=27)
[S8] round=35 local utility u=0.031239 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7794530228770928, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8419311191012733, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.744146 cos_to_last_merge=0.9956 (last merge round=27)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8790825847337438, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8451276876996667, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=2.056727 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.585869012448868, 'psi': 0.3326959847036329}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.552499825919221, 'psi': 0.3326959847036329}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.825212 cos_to_last_merge=0.9948 (last merge round=24)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 3.1052163389928285, 'psi': 0.323865788078467}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 3.0388227155579464, 'psi': 0.32387008857597094}
[S13] START round=35 head_norm_before_train=1.763429 cos_to_last_merge=0.9927 (last merge round=27)
[S13] round=35 local utility u=0.007094 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1263742487886848, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1405618126358228, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=35 head_norm_before_train=1.867800 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.910863281413158, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.863070166193616, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.990617 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5875350443336742, 'psi': 0.6150769866718802}-{'f1_val': 0.6157765077628609, 'auprc': 0.6157765077628609, 'loss_val': 0.5788106958688797, 'psi': 0.6157765077628609}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.453079 cos_to_last_merge=0.9804 (last merge round=29)
[S16] round=35 local utility u=1.000000 metrics={'f1_val': 0.21736422521175883, 'auprc': 0.21736422521175883, 'loss_val': 1.7586500157452927, 'psi': 0.21736422521175883}-{'f1_val': 0.09172259507829977, 'auprc': 0.09172259507829977, 'loss_val': 3.4042383342041607, 'psi': 0.09172259507829977}
[S17] START round=35 head_norm_before_train=1.783819 cos_to_last_merge=0.9967 (last merge round=27)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.20922793321349578, 'auprc': 0.20922793321349578, 'loss_val': 1.087475807211756, 'psi': 0.20922793321349578}-{'f1_val': 0.27405473107524847, 'auprc': 0.27405473107524847, 'loss_val': 0.9059977746356389, 'psi': 0.27405473107524847}
[S2]  timeout peer S4
[S2]  timeout peer S11
[S16]  timeout peer S7
[S17]  timeout peer S13
[S8]  timeout peer S9
[S11]  timeout peer S2
[S3]  timeout peer S6
[S4]  timeout peer S16
[S9]  timeout peer S5
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.777468 cos_to_last_merge=0.9930 (last merge round=25)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.25333878440992097, 'auprc': 0.25333878440992097, 'loss_val': 2.5733743639662747, 'psi': 0.25333878440992097}-{'f1_val': 0.26531959852086634, 'auprc': 0.26531959852086634, 'loss_val': 2.385022658213821, 'psi': 0.26531959852086634}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.903088 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.675617055190359, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.646747085129265, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.714399 cos_to_last_merge=0.9970 (last merge round=30)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9619744604472891, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9616577836691437, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.743175 cos_to_last_merge=0.9974 (last merge round=29)
[S5] round=36 local utility u=0.372322 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0197521163759373, 'psi': 0.3335071121394324}-{'f1_val': 0.24981467753891773, 'auprc': 0.24981467753891773, 'loss_val': 3.0111647163079747, 'psi': 0.24981467753891773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=36 head_norm_before_train=1.562023 cos_to_last_merge=0.9184 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.918
[S6] round=36 local utility u=0.094961 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 5.585423185082655, 'psi': 0.01799723119520074}-{'f1_val': 0.007543611504007544, 'auprc': 0.007543611504007544, 'loss_val': 5.681262649194748, 'psi': 0.007543611504007544}
[S6] not sending this round → trigger blocked (psi=0.018)
[S7] START round=36 head_norm_before_train=1.200058 cos_to_last_merge=0.9838 (last merge round=29)
[S7] round=36 local utility u=0.018818 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8460371912650854, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8836732949130351, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] sending update (kind=head size=1792 to 1 peers)
[S8] START round=36 head_norm_before_train=1.827549 cos_to_last_merge=0.9940 (last merge round=27)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7962836244812038, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7794530228770928, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.754842 cos_to_last_merge=0.9949 (last merge round=27)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9047689919416746, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8790825847337438, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=2.078098 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.6159955205606495, 'psi': 0.3326959847036329}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.585869012448868, 'psi': 0.3326959847036329}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.836299 cos_to_last_merge=0.9942 (last merge round=24)
[S11] round=36 local utility u=0.022459 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 3.0603369081780643, 'psi': 0.32387008857597094}-{'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 3.1052163389928285, 'psi': 0.323865788078467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=36 head_norm_before_train=1.768560 cos_to_last_merge=0.9920 (last merge round=27)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1705785437715162, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1263742487886848, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.876156 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.95876611432779, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.910863281413158, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=2.008183 (no previous merge yet)
[S15] round=36 local utility u=0.008052 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5814934061634002, 'psi': 0.6161950003225232}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5875350443336742, 'psi': 0.6150769866718802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=36 head_norm_before_train=1.476262 cos_to_last_merge=0.9772 (last merge round=29)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.16180278535936735, 'auprc': 0.16180278535936735, 'loss_val': 2.6439837591721695, 'psi': 0.16180278535936735}-{'f1_val': 0.21736422521175883, 'auprc': 0.21736422521175883, 'loss_val': 1.7586500157452927, 'psi': 0.21736422521175883}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.795323 cos_to_last_merge=0.9963 (last merge round=27)
[S17] round=36 local utility u=0.283463 metrics={'f1_val': 0.26506856222293973, 'auprc': 0.26506856222293973, 'loss_val': 1.0231159217167987, 'psi': 0.26506856222293973}-{'f1_val': 0.20922793321349578, 'auprc': 0.20922793321349578, 'loss_val': 1.087475807211756, 'psi': 0.20922793321349578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=37 head_norm_before_train=1.785277 cos_to_last_merge=0.9925 (last merge round=25)
[S2] round=37 local utility u=0.642843 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.31493817275274, 'psi': 0.3674775928297055}-{'f1_val': 0.25333878440992097, 'auprc': 0.25333878440992097, 'loss_val': 2.5733743639662747, 'psi': 0.25333878440992097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=37 head_norm_before_train=1.911432 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7011078359610754, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.675617055190359, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.734568 cos_to_last_merge=0.9962 (last merge round=30)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9624785953679037, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9619744604472891, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.759916 cos_to_last_merge=0.9967 (last merge round=29)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0568328203062882, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0197521163759373, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.574336 cos_to_last_merge=0.9161 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.916
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.717897298856481, 'psi': 0.017551963048498844}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 5.585423185082655, 'psi': 0.01799723119520074}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.227055 cos_to_last_merge=0.9808 (last merge round=29)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7943005026189138, 'psi': 0.24962705121829937}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8460371912650854, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.841675 cos_to_last_merge=0.9936 (last merge round=27)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8357108367041552, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7962836244812038, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.764461 cos_to_last_merge=0.9942 (last merge round=27)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9301407850024508, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9047689919416746, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.097227 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.644914846451432, 'psi': 0.3327757865392274}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.6159955205606495, 'psi': 0.3326959847036329}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.846881 cos_to_last_merge=0.9936 (last merge round=24)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 3.0633665218198747, 'psi': 0.3237965485921889}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 3.0603369081780643, 'psi': 0.32387008857597094}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.776494 cos_to_last_merge=0.9912 (last merge round=27)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1786066772045594, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1705785437715162, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.884112 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.000753108725445, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.95876611432779, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=2.025727 (no previous merge yet)
[S15] round=37 local utility u=0.003944 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5748584075390537, 'psi': 0.6163342951580373}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5814934061634002, 'psi': 0.6161950003225232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=37 head_norm_before_train=1.496667 cos_to_last_merge=0.9744 (last merge round=29)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.07631708517971443, 'auprc': 0.07631708517971443, 'loss_val': 3.9444625825713002, 'psi': 0.07631708517971443}-{'f1_val': 0.16180278535936735, 'auprc': 0.16180278535936735, 'loss_val': 2.6439837591721695, 'psi': 0.16180278535936735}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.809569 cos_to_last_merge=0.9955 (last merge round=27)
[S17] round=37 local utility u=0.103233 metrics={'f1_val': 0.30984952120383036, 'auprc': 0.30984952120383036, 'loss_val': 1.219678729216558, 'psi': 0.30984952120383036}-{'f1_val': 0.26506856222293973, 'auprc': 0.26506856222293973, 'loss_val': 1.0231159217167987, 'psi': 0.26506856222293973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=38 head_norm_before_train=1.792525 cos_to_last_merge=0.9921 (last merge round=25)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3342063704671143, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.31493817275274, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.919192 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7267164954416185, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7011078359610754, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.750312 cos_to_last_merge=0.9955 (last merge round=30)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9630426321204035, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9624785953679037, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.784298 cos_to_last_merge=0.9954 (last merge round=29)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.093513848366273, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0568328203062882, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.585922 cos_to_last_merge=0.9139 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.914
[S6] round=38 local utility u=0.052418 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.650835670569051, 'psi': 0.021749084249084248}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.717897298856481, 'psi': 0.017551963048498844}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=38 head_norm_before_train=1.245090 cos_to_last_merge=0.9778 (last merge round=29)
[S7] round=38 local utility u=0.074610 metrics={'f1_val': 0.26746506986027946, 'auprc': 0.26746506986027946, 'loss_val': 0.8056229910128142, 'psi': 0.26746506986027946}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7943005026189138, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=38 head_norm_before_train=1.853569 cos_to_last_merge=0.9929 (last merge round=27)
[S8] round=38 local utility u=0.002605 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8305010515990003, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8357108367041552, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=38 head_norm_before_train=1.773580 cos_to_last_merge=0.9936 (last merge round=27)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9567494813362898, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9301407850024508, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.114694 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.673283455296834, 'psi': 0.3326959847036329}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.644914846451432, 'psi': 0.3327757865392274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.856986 cos_to_last_merge=0.9930 (last merge round=24)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 3.1364767713335526, 'psi': 0.3237922156595487}-{'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 3.0633665218198747, 'psi': 0.3237965485921889}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.783795 cos_to_last_merge=0.9904 (last merge round=27)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.19969114798866, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1786066772045594, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.891835 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.039056517650323, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.000753108725445, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=2.043596 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5793546239673546, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5748584075390537, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.514931 cos_to_last_merge=0.9719 (last merge round=29)
[S16] round=38 local utility u=1.000000 metrics={'f1_val': 0.13262599469496023, 'auprc': 0.13262599469496023, 'loss_val': 2.4208768222842436, 'psi': 0.13262599469496023}-{'f1_val': 0.07631708517971443, 'auprc': 0.07631708517971443, 'loss_val': 3.9444625825713002, 'psi': 0.07631708517971443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=38 head_norm_before_train=1.824009 cos_to_last_merge=0.9946 (last merge round=27)
[S17] round=38 local utility u=0.183210 metrics={'f1_val': 0.3449642448464592, 'auprc': 0.3449642448464592, 'loss_val': 1.169290689607067, 'psi': 0.3449642448464592}-{'f1_val': 0.30984952120383036, 'auprc': 0.30984952120383036, 'loss_val': 1.219678729216558, 'psi': 0.30984952120383036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=39 head_norm_before_train=1.799761 cos_to_last_merge=0.9916 (last merge round=25)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.26534522629666335, 'auprc': 0.26534522629666335, 'loss_val': 2.4761414372902064, 'psi': 0.26534522629666335}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3342063704671143, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.265 u=0.0000 p_local=0.1423 f1=0.265 auprc=0.265 bytes=23392
[S3] START round=39 head_norm_before_train=1.926562 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7522639782761162, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7267164954416185, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.364 u=0.0000 p_local=0.0037 f1=0.364 auprc=0.364 bytes=10793
[S4] START round=39 head_norm_before_train=1.764024 cos_to_last_merge=0.9948 (last merge round=30)
[S4] round=39 local utility u=0.000782 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.961478610219166, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9630426321204035, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] r=40 psi=0.357 u=0.0008 p_local=0.0087 f1=0.357 auprc=0.357 bytes=32353
[S5] START round=39 head_norm_before_train=1.809533 cos_to_last_merge=0.9939 (last merge round=29)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1201844362577393, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.093513848366273, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.334 u=0.0000 p_local=0.0444 f1=0.334 auprc=0.334 bytes=25206
[S6] START round=39 head_norm_before_train=1.597012 cos_to_last_merge=0.9118 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.912
[S6] round=39 local utility u=0.504179 metrics={'f1_val': 0.08715415019762845, 'auprc': 0.08715415019762845, 'loss_val': 5.231123788805181, 'psi': 0.08715415019762845}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.650835670569051, 'psi': 0.021749084249084248}
[S6] not sending this round → trigger blocked (psi=0.087)
[S6] r=40 psi=0.087 u=0.5042 p_local=0.1293 f1=0.087 auprc=0.087 bytes=0
[S7] START round=39 head_norm_before_train=1.256778 cos_to_last_merge=0.9745 (last merge round=29)
[S7] round=39 local utility u=0.416178 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.803955130517516, 'psi': 0.35976373724718097}-{'f1_val': 0.26746506986027946, 'auprc': 0.26746506986027946, 'loss_val': 0.8056229910128142, 'psi': 0.26746506986027946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S7] r=40 psi=0.360 u=0.4162 p_local=0.1135 f1=0.360 auprc=0.360 bytes=35956
[S8] START round=39 head_norm_before_train=1.863456 cos_to_last_merge=0.9921 (last merge round=27)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8554099622645589, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8305010515990003, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0066 f1=0.359 auprc=0.359 bytes=30615
[S9] START round=39 head_norm_before_train=1.782333 cos_to_last_merge=0.9930 (last merge round=27)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.982153506251849, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9567494813362898, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0026 f1=0.369 auprc=0.369 bytes=10804
[S10] START round=39 head_norm_before_train=2.131383 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.7012596478436817, 'psi': 0.3326959847036329}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.673283455296834, 'psi': 0.3326959847036329}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.333 u=0.0000 p_local=0.0036 f1=0.333 auprc=0.333 bytes=28776
[S11] START round=39 head_norm_before_train=1.866659 cos_to_last_merge=0.9925 (last merge round=24)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 3.182486100874138, 'psi': 0.323865788078467}-{'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 3.1364767713335526, 'psi': 0.3237922156595487}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.324 u=0.0000 p_local=0.0074 f1=0.324 auprc=0.324 bytes=14387
[S13] START round=39 head_norm_before_train=1.790668 cos_to_last_merge=0.9896 (last merge round=27)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2218756079479691, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.19969114798866, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0030 f1=0.360 auprc=0.360 bytes=23400
[S14] START round=39 head_norm_before_train=1.899176 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.07772879185023, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.039056517650323, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0019 f1=0.136 auprc=0.136 bytes=0
[S15] START round=39 head_norm_before_train=2.060632 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.6008658343359126, 'psi': 0.6160556042184989}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5793546239673546, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.616 u=0.0000 p_local=0.0118 f1=0.616 auprc=0.616 bytes=34178
[S16] START round=39 head_norm_before_train=1.530590 cos_to_last_merge=0.9697 (last merge round=29)
[S16] round=39 local utility u=0.252907 metrics={'f1_val': 0.15726069025396136, 'auprc': 0.15726069025396136, 'loss_val': 2.1367755470283347, 'psi': 0.15726069025396136}-{'f1_val': 0.13262599469496023, 'auprc': 0.13262599469496023, 'loss_val': 2.4208768222842436, 'psi': 0.13262599469496023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S16] r=40 psi=0.157 u=0.2529 p_local=0.3223 f1=0.157 auprc=0.157 bytes=23390
[S17] START round=39 head_norm_before_train=1.834111 cos_to_last_merge=0.9940 (last merge round=27)
[S17] round=39 local utility u=0.174983 metrics={'f1_val': 0.34860095579033407, 'auprc': 0.34860095579033407, 'loss_val': 0.8520546229821647, 'psi': 0.34860095579033407}-{'f1_val': 0.3449642448464592, 'auprc': 0.3449642448464592, 'loss_val': 1.169290689607067, 'psi': 0.3449642448464592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S17] r=40 psi=0.349 u=0.1750 p_local=0.1538 f1=0.349 auprc=0.349 bytes=25233
[S2] START round=40 head_norm_before_train=1.807181 cos_to_last_merge=0.9911 (last merge round=25)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.20821047856656838, 'auprc': 0.20821047856656838, 'loss_val': 2.8748936784910484, 'psi': 0.20821047856656838}-{'f1_val': 0.26534522629666335, 'auprc': 0.26534522629666335, 'loss_val': 2.4761414372902064, 'psi': 0.26534522629666335}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.933643 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7800888330644424, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7522639782761162, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.775855 cos_to_last_merge=0.9941 (last merge round=30)
[S4] round=40 local utility u=0.000941 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9595956737606891, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.961478610219166, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=40 head_norm_before_train=1.835413 cos_to_last_merge=0.9922 (last merge round=29)
[S5] round=40 local utility u=0.008312 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1035608827132353, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1201844362577393, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=40 head_norm_before_train=1.607633 cos_to_last_merge=0.9098 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.910
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 5.737962108065326, 'psi': 0.022186642268984445}-{'f1_val': 0.08715415019762845, 'auprc': 0.08715415019762845, 'loss_val': 5.231123788805181, 'psi': 0.08715415019762845}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.277150 cos_to_last_merge=0.9714 (last merge round=29)
[S7] round=40 local utility u=0.004356 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.7952434794224529, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.803955130517516, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=40 head_norm_before_train=1.874971 cos_to_last_merge=0.9915 (last merge round=27)
[S8] round=40 local utility u=0.011695 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8320198095632474, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8554099622645589, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=40 head_norm_before_train=1.790551 cos_to_last_merge=0.9924 (last merge round=27)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.00485341855553, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.982153506251849, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.146539 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.7283471390129432, 'psi': 0.3326959847036329}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.7012596478436817, 'psi': 0.3326959847036329}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.875556 cos_to_last_merge=0.9920 (last merge round=24)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 3.1879351633633752, 'psi': 0.323865788078467}-{'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 3.182486100874138, 'psi': 0.323865788078467}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.797757 cos_to_last_merge=0.9887 (last merge round=27)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2258337071412027, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2218756079479691, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.906160 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.111917016865363, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.07772879185023, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=2.076625 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6217989487461104, 'psi': 0.6153571007984797}-{'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.6008658343359126, 'psi': 0.6160556042184989}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.544329 cos_to_last_merge=0.9677 (last merge round=29)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.13715124816446403, 'auprc': 0.13715124816446403, 'loss_val': 3.3300929910228594, 'psi': 0.13715124816446403}-{'f1_val': 0.15726069025396136, 'auprc': 0.15726069025396136, 'loss_val': 2.1367755470283347, 'psi': 0.15726069025396136}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.841219 cos_to_last_merge=0.9933 (last merge round=27)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.31907579351121845, 'auprc': 0.31907579351121845, 'loss_val': 1.2335763390040912, 'psi': 0.31907579351121845}-{'f1_val': 0.34860095579033407, 'auprc': 0.34860095579033407, 'loss_val': 0.8520546229821647, 'psi': 0.34860095579033407}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.815189 cos_to_last_merge=0.9906 (last merge round=25)
[S2] round=41 local utility u=0.972053 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.364191583896636, 'psi': 0.3674775928297055}-{'f1_val': 0.20821047856656838, 'auprc': 0.20821047856656838, 'loss_val': 2.8748936784910484, 'psi': 0.20821047856656838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=41 head_norm_before_train=1.940779 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7848062229657837, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7800888330644424, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.786802 cos_to_last_merge=0.9935 (last merge round=30)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9626218773238564, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9595956737606891, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.861763 cos_to_last_merge=0.9904 (last merge round=29)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.11823187071155, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1035608827132353, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.617394 cos_to_last_merge=0.9080 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.908
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.011230697239120261, 'auprc': 0.011230697239120261, 'loss_val': 6.037883255858253, 'psi': 0.011230697239120261}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 5.737962108065326, 'psi': 0.022186642268984445}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.293415 cos_to_last_merge=0.9690 (last merge round=29)
[S7] round=41 local utility u=0.004234 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.7867758377828844, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.7952434794224529, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=41 head_norm_before_train=1.887213 cos_to_last_merge=0.9911 (last merge round=27)
[S8] round=41 local utility u=0.012684 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8066513536427152, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8320198095632474, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=41 head_norm_before_train=1.798210 cos_to_last_merge=0.9919 (last merge round=27)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0279455634274557, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.00485341855553, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.160584 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.7516120179229167, 'psi': 0.3327757865392274}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.7283471390129432, 'psi': 0.3326959847036329}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.884033 cos_to_last_merge=0.9914 (last merge round=24)
[S11] round=41 local utility u=0.004383 metrics={'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 3.1785077139628113, 'psi': 0.3237922156595487}-{'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 3.1879351633633752, 'psi': 0.323865788078467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=41 head_norm_before_train=1.805303 cos_to_last_merge=0.9879 (last merge round=27)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2507185741918383, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2258337071412027, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.912982 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.143054438049648, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.111917016865363, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.091531 (no previous merge yet)
[S15] round=41 local utility u=0.000209 metrics={'f1_val': 0.6157765077628609, 'auprc': 0.6157765077628609, 'loss_val': 0.6251551951972282, 'psi': 0.6157765077628609}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6217989487461104, 'psi': 0.6153571007984797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=41 head_norm_before_train=1.557422 cos_to_last_merge=0.9660 (last merge round=29)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.08476906899619834, 'auprc': 0.08476906899619834, 'loss_val': 4.106046171752733, 'psi': 0.08476906899619834}-{'f1_val': 0.13715124816446403, 'auprc': 0.13715124816446403, 'loss_val': 3.3300929910228594, 'psi': 0.13715124816446403}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.850046 cos_to_last_merge=0.9925 (last merge round=27)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.2794067189973943, 'auprc': 0.2794067189973943, 'loss_val': 1.0879280492683683, 'psi': 0.2794067189973943}-{'f1_val': 0.31907579351121845, 'auprc': 0.31907579351121845, 'loss_val': 1.2335763390040912, 'psi': 0.31907579351121845}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.822926 cos_to_last_merge=0.9900 (last merge round=25)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4117110461229307, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.364191583896636, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.947386 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8176730931347893, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7848062229657837, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.797883 cos_to_last_merge=0.9929 (last merge round=30)
[S4] round=42 local utility u=0.000726 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.961169177640331, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9626218773238564, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=42 head_norm_before_train=1.886681 cos_to_last_merge=0.9887 (last merge round=29)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1484659898124643, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.11823187071155, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.626308 cos_to_last_merge=0.9064 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.906
[S6] round=42 local utility u=0.227277 metrics={'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 5.713178912855454, 'psi': 0.025658492279745686}-{'f1_val': 0.011230697239120261, 'auprc': 0.011230697239120261, 'loss_val': 6.037883255858253, 'psi': 0.011230697239120261}
[S6] not sending this round → trigger blocked (psi=0.026)
[S7] START round=42 head_norm_before_train=1.309109 cos_to_last_merge=0.9668 (last merge round=29)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.32157427405807537, 'auprc': 0.32157427405807537, 'loss_val': 0.7478146785135193, 'psi': 0.32157427405807537}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.7867758377828844, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.895519 cos_to_last_merge=0.9903 (last merge round=27)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8378371627500592, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8066513536427152, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.805517 cos_to_last_merge=0.9913 (last merge round=27)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0505279059671984, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0279455634274557, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.173690 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.774651210647678, 'psi': 0.3327757865392274}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.7516120179229167, 'psi': 0.3327757865392274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.892033 cos_to_last_merge=0.9910 (last merge round=24)
[S11] round=42 local utility u=0.000878 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 3.177452574634837, 'psi': 0.32387008857597094}-{'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 3.1785077139628113, 'psi': 0.3237922156595487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=42 head_norm_before_train=1.811472 cos_to_last_merge=0.9872 (last merge round=27)
[S13] round=42 local utility u=0.002471 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2457773461622474, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2507185741918383, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=42 head_norm_before_train=1.919789 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.175764349118127, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.143054438049648, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.103663 (no previous merge yet)
[S15] round=42 local utility u=0.016241 metrics={'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.5851163858680681, 'psi': 0.6149367764291455}-{'f1_val': 0.6157765077628609, 'auprc': 0.6157765077628609, 'loss_val': 0.6251551951972282, 'psi': 0.6157765077628609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=42 head_norm_before_train=1.569112 cos_to_last_merge=0.9643 (last merge round=29)
[S16] round=42 local utility u=0.707894 metrics={'f1_val': 0.14908882192567083, 'auprc': 0.14908882192567083, 'loss_val': 3.2691364485528975, 'psi': 0.14908882192567083}-{'f1_val': 0.08476906899619834, 'auprc': 0.08476906899619834, 'loss_val': 4.106046171752733, 'psi': 0.08476906899619834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=42 head_norm_before_train=1.863085 cos_to_last_merge=0.9916 (last merge round=27)
[S17] round=42 local utility u=0.073090 metrics={'f1_val': 0.3196144935720579, 'auprc': 0.3196144935720579, 'loss_val': 1.3036185438886234, 'psi': 0.3196144935720579}-{'f1_val': 0.2794067189973943, 'auprc': 0.2794067189973943, 'loss_val': 1.0879280492683683, 'psi': 0.2794067189973943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=43 head_norm_before_train=1.830582 cos_to_last_merge=0.9895 (last merge round=25)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.419739301387652, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4117110461229307, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.953439 (no previous merge yet)
[S3] round=43 local utility u=0.003377 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.810919787538273, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8176730931347893, 'psi': 0.3641628959276018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=43 head_norm_before_train=1.808266 cos_to_last_merge=0.9922 (last merge round=30)
[S4] round=43 local utility u=0.001360 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9584490343154076, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.961169177640331, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=43 head_norm_before_train=1.908791 cos_to_last_merge=0.9873 (last merge round=29)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 3.131538978879089, 'psi': 0.2501303341045743}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1484659898124643, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.634815 cos_to_last_merge=0.9048 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.905
[S6] round=43 local utility u=0.094700 metrics={'f1_val': 0.03701241134751773, 'auprc': 0.03701241134751773, 'loss_val': 5.625964525514519, 'psi': 0.03701241134751773}-{'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 5.713178912855454, 'psi': 0.025658492279745686}
[S6] not sending this round → trigger blocked (psi=0.037)
[S7] START round=43 head_norm_before_train=1.326886 cos_to_last_merge=0.9651 (last merge round=29)
[S7] round=43 local utility u=0.063230 metrics={'f1_val': 0.3325062034739454, 'auprc': 0.3325062034739454, 'loss_val': 0.7197419371709566, 'psi': 0.3325062034739454}-{'f1_val': 0.32157427405807537, 'auprc': 0.32157427405807537, 'loss_val': 0.7478146785135193, 'psi': 0.32157427405807537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=43 head_norm_before_train=1.904107 cos_to_last_merge=0.9898 (last merge round=27)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9240822015638401, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8378371627500592, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.812502 cos_to_last_merge=0.9908 (last merge round=27)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0757097771533743, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0505279059671984, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.185903 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.797465053929037, 'psi': 0.3327757865392274}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.774651210647678, 'psi': 0.3327757865392274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.899825 cos_to_last_merge=0.9905 (last merge round=24)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 3.1855910129670604, 'psi': 0.3237965485921889}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 3.177452574634837, 'psi': 0.32387008857597094}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.816750 cos_to_last_merge=0.9866 (last merge round=27)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.279512687078729, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2457773461622474, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.926241 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.210050224178741, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.175764349118127, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=2.115279 (no previous merge yet)
[S15] round=43 local utility u=0.004245 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5904565180084701, 'psi': 0.6164734888353558}-{'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.5851163858680681, 'psi': 0.6149367764291455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=43 head_norm_before_train=1.580546 cos_to_last_merge=0.9627 (last merge round=29)
[S16] round=43 local utility u=1.000000 metrics={'f1_val': 0.24037590579710144, 'auprc': 0.24037590579710144, 'loss_val': 1.6775436651158393, 'psi': 0.24037590579710144}-{'f1_val': 0.14908882192567083, 'auprc': 0.14908882192567083, 'loss_val': 3.2691364485528975, 'psi': 0.14908882192567083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=43 head_norm_before_train=1.876217 cos_to_last_merge=0.9902 (last merge round=27)
[S17] round=43 local utility u=0.517590 metrics={'f1_val': 0.4197667939857651, 'auprc': 0.4197667939857651, 'loss_val': 1.1698092150993622, 'psi': 0.4197667939857651}-{'f1_val': 0.3196144935720579, 'auprc': 0.3196144935720579, 'loss_val': 1.3036185438886234, 'psi': 0.3196144935720579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=44 head_norm_before_train=1.836814 cos_to_last_merge=0.9891 (last merge round=25)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.411090752412994, 'psi': 0.2450298816928894}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.419739301387652, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.959199 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.846594478147065, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.810919787538273, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.816076 cos_to_last_merge=0.9916 (last merge round=30)
[S4] round=44 local utility u=0.003951 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9505469901246996, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9584490343154076, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=44 head_norm_before_train=1.925824 cos_to_last_merge=0.9862 (last merge round=29)
[S5] round=44 local utility u=0.357630 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.166670469445518, 'psi': 0.3335071121394324}-{'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 3.131538978879089, 'psi': 0.2501303341045743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=44 head_norm_before_train=1.643186 cos_to_last_merge=0.9033 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.903
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.1937836658156415, 'psi': 0.01732902033271719}-{'f1_val': 0.03701241134751773, 'auprc': 0.03701241134751773, 'loss_val': 5.625964525514519, 'psi': 0.03701241134751773}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.348745 cos_to_last_merge=0.9623 (last merge round=29)
[S7] round=44 local utility u=0.020459 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6832855667872536, 'psi': 0.3330019880715706}-{'f1_val': 0.3325062034739454, 'auprc': 0.3325062034739454, 'loss_val': 0.7197419371709566, 'psi': 0.3325062034739454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=44 head_norm_before_train=1.915078 cos_to_last_merge=0.9895 (last merge round=27)
[S8] round=44 local utility u=0.000683 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9227160757358505, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9240822015638401, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=44 head_norm_before_train=1.819396 cos_to_last_merge=0.9903 (last merge round=27)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0996351702204032, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0757097771533743, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.197375 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.8204443748339054, 'psi': 0.3327757865392274}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.797465053929037, 'psi': 0.3327757865392274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.907348 cos_to_last_merge=0.9900 (last merge round=24)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 3.2242230512237104, 'psi': 0.32387008857597094}-{'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 3.1855910129670604, 'psi': 0.3237965485921889}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.824195 cos_to_last_merge=0.9856 (last merge round=27)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2856532707939814, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.279512687078729, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.932287 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.243866500553223, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.210050224178741, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.126178 (no previous merge yet)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6309516275121076, 'psi': 0.615636807189815}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5904565180084701, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.591593 cos_to_last_merge=0.9612 (last merge round=29)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.08306968443254643, 'auprc': 0.08306968443254643, 'loss_val': 4.0981568782247795, 'psi': 0.08306968443254643}-{'f1_val': 0.24037590579710144, 'auprc': 0.24037590579710144, 'loss_val': 1.6775436651158393, 'psi': 0.24037590579710144}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.884589 cos_to_last_merge=0.9889 (last merge round=27)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.3125766281934837, 'auprc': 0.3125766281934837, 'loss_val': 1.4229544519159958, 'psi': 0.3125766281934837}-{'f1_val': 0.4197667939857651, 'auprc': 0.4197667939857651, 'loss_val': 1.1698092150993622, 'psi': 0.4197667939857651}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.843464 cos_to_last_merge=0.9886 (last merge round=25)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.26534522629666335, 'auprc': 0.26534522629666335, 'loss_val': 2.5994838790281234, 'psi': 0.26534522629666335}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.411090752412994, 'psi': 0.2450298816928894}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.965058 (no previous merge yet)
[S3] round=45 local utility u=0.011351 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.823891774026788, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.846594478147065, 'psi': 0.3641628959276018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=45 head_norm_before_train=1.822510 cos_to_last_merge=0.9910 (last merge round=30)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9587254106456896, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9505469901246996, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.939192 cos_to_last_merge=0.9853 (last merge round=29)
[S5] round=45 local utility u=0.002248 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1621738214239405, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.166670469445518, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=45 head_norm_before_train=1.650601 cos_to_last_merge=0.9020 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.902
[S6] round=45 local utility u=0.426412 metrics={'f1_val': 0.05344164172723386, 'auprc': 0.05344164172723386, 'loss_val': 5.665973824512858, 'psi': 0.05344164172723386}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.1937836658156415, 'psi': 0.01732902033271719}
[S6] not sending this round → trigger blocked (psi=0.053)
[S7] START round=45 head_norm_before_train=1.371661 cos_to_last_merge=0.9601 (last merge round=29)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6283081568768668, 'psi': 0.24962705121829937}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6832855667872536, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.929575 cos_to_last_merge=0.9893 (last merge round=27)
[S8] round=45 local utility u=0.008229 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9062586735323869, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9227160757358505, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=45 head_norm_before_train=1.825995 cos_to_last_merge=0.9898 (last merge round=27)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.119015777324966, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0996351702204032, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.208148 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.840297103222973, 'psi': 0.3328555502468546}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.8204443748339054, 'psi': 0.3327757865392274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.914453 cos_to_last_merge=0.9895 (last merge round=24)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 3.2779004130646165, 'psi': 0.323865788078467}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 3.2242230512237104, 'psi': 0.32387008857597094}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.829473 cos_to_last_merge=0.9849 (last merge round=27)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2898812100021118, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2856532707939814, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.938174 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.273648433530795, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.243866500553223, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.135692 (no previous merge yet)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6095319696156781, 'auprc': 0.6095319696156781, 'loss_val': 0.6794072145921969, 'psi': 0.6095319696156781}-{'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6309516275121076, 'psi': 0.615636807189815}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.602283 cos_to_last_merge=0.9597 (last merge round=29)
[S16] round=45 local utility u=0.796289 metrics={'f1_val': 0.13096610560295135, 'auprc': 0.13096610560295135, 'loss_val': 2.93664648872812, 'psi': 0.13096610560295135}-{'f1_val': 0.08306968443254643, 'auprc': 0.08306968443254643, 'loss_val': 4.0981568782247795, 'psi': 0.08306968443254643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=45 head_norm_before_train=1.892995 cos_to_last_merge=0.9879 (last merge round=27)
[S17] round=45 local utility u=0.685131 metrics={'f1_val': 0.4366399327008884, 'auprc': 0.4366399327008884, 'loss_val': 1.169262893105031, 'psi': 0.4366399327008884}-{'f1_val': 0.3125766281934837, 'auprc': 0.3125766281934837, 'loss_val': 1.4229544519159958, 'psi': 0.3125766281934837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=46 head_norm_before_train=1.849133 cos_to_last_merge=0.9881 (last merge round=25)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.654451286324131, 'psi': 0.2653978324081417}-{'f1_val': 0.26534522629666335, 'auprc': 0.26534522629666335, 'loss_val': 2.5994838790281234, 'psi': 0.26534522629666335}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.970165 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.836001846623423, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.823891774026788, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.829502 cos_to_last_merge=0.9904 (last merge round=30)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9682006918100077, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9587254106456896, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.954253 cos_to_last_merge=0.9843 (last merge round=29)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 3.112569578432706, 'psi': 0.2501303341045743}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1621738214239405, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.657855 cos_to_last_merge=0.9007 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.901
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.024145785876993165, 'auprc': 0.024145785876993165, 'loss_val': 5.955227976918221, 'psi': 0.024145785876993165}-{'f1_val': 0.05344164172723386, 'auprc': 0.05344164172723386, 'loss_val': 5.665973824512858, 'psi': 0.05344164172723386}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.388955 cos_to_last_merge=0.9582 (last merge round=29)
[S7] round=46 local utility u=0.389640 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.5994034387349046, 'psi': 0.3330019880715706}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6283081568768668, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=46 head_norm_before_train=1.942465 cos_to_last_merge=0.9889 (last merge round=27)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9106813675334599, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9062586735323869, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.832136 cos_to_last_merge=0.9893 (last merge round=27)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.138365878002925, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.119015777324966, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.218540 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.857730943685097, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.840297103222973, 'psi': 0.3328555502468546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.921323 cos_to_last_merge=0.9891 (last merge round=24)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 3.303196419767087, 'psi': 0.323865788078467}-{'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 3.2779004130646165, 'psi': 0.323865788078467}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.836727 cos_to_last_merge=0.9841 (last merge round=27)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3291759644670214, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2898812100021118, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.944078 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.301643783486214, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.273648433530795, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.146658 (no previous merge yet)
[S15] round=46 local utility u=0.050303 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6387683155817486, 'psi': 0.6161950003225232}-{'f1_val': 0.6095319696156781, 'auprc': 0.6095319696156781, 'loss_val': 0.6794072145921969, 'psi': 0.6095319696156781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=46 head_norm_before_train=1.611977 cos_to_last_merge=0.9584 (last merge round=29)
[S16] round=46 local utility u=0.320112 metrics={'f1_val': 0.15028901734104047, 'auprc': 0.15028901734104047, 'loss_val': 2.470328334764724, 'psi': 0.15028901734104047}-{'f1_val': 0.13096610560295135, 'auprc': 0.13096610560295135, 'loss_val': 2.93664648872812, 'psi': 0.13096610560295135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=46 head_norm_before_train=1.898537 cos_to_last_merge=0.9874 (last merge round=27)
[S17] round=46 local utility u=0.205470 metrics={'f1_val': 0.47681048634694667, 'auprc': 0.47681048634694667, 'loss_val': 1.119858634513722, 'psi': 0.47681048634694667}-{'f1_val': 0.4366399327008884, 'auprc': 0.4366399327008884, 'loss_val': 1.169262893105031, 'psi': 0.4366399327008884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=47 head_norm_before_train=1.855423 cos_to_last_merge=0.9877 (last merge round=25)
[S2] round=47 local utility u=0.036141 metrics={'f1_val': 0.26531959852086634, 'auprc': 0.26531959852086634, 'loss_val': 2.5814657037353395, 'psi': 0.26531959852086634}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.654451286324131, 'psi': 0.2653978324081417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=47 head_norm_before_train=1.974346 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.873940796238454, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.836001846623423, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.839399 cos_to_last_merge=0.9898 (last merge round=30)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9694410730443159, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9682006918100077, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.967255 cos_to_last_merge=0.9834 (last merge round=29)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 3.119463900290381, 'psi': 0.2501303341045743}-{'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 3.112569578432706, 'psi': 0.2501303341045743}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.665129 cos_to_last_merge=0.8994 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.007311320754716981, 'auprc': 0.007311320754716981, 'loss_val': 6.3792752089835, 'psi': 0.007311320754716981}-{'f1_val': 0.024145785876993165, 'auprc': 0.024145785876993165, 'loss_val': 5.955227976918221, 'psi': 0.024145785876993165}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.405062 cos_to_last_merge=0.9554 (last merge round=29)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6400907235306802, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.5994034387349046, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.950533 cos_to_last_merge=0.9883 (last merge round=27)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9926889926016534, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9106813675334599, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.838139 cos_to_last_merge=0.9888 (last merge round=27)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.158254129034083, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.138365878002925, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.228455 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.877114634414133, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.857730943685097, 'psi': 0.3328555502468546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.928087 cos_to_last_merge=0.9887 (last merge round=24)
[S11] round=47 local utility u=0.004299 metrics={'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 3.2945985618377307, 'psi': 0.323865788078467}-{'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 3.303196419767087, 'psi': 0.323865788078467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=47 head_norm_before_train=1.844399 cos_to_last_merge=0.9832 (last merge round=27)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3379386867792225, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3291759644670214, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.949879 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.330942200900887, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.301643783486214, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.156392 (no previous merge yet)
[S15] round=47 local utility u=0.002822 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6343786298473456, 'psi': 0.6163342951580373}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6387683155817486, 'psi': 0.6161950003225232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=47 head_norm_before_train=1.621590 cos_to_last_merge=0.9572 (last merge round=29)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.15042221268069272, 'auprc': 0.15042221268069272, 'loss_val': 3.236330277329586, 'psi': 0.15042221268069272}-{'f1_val': 0.15028901734104047, 'auprc': 0.15028901734104047, 'loss_val': 2.470328334764724, 'psi': 0.15028901734104047}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.904213 cos_to_last_merge=0.9868 (last merge round=27)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.3381951138142555, 'auprc': 0.3381951138142555, 'loss_val': 1.3998528725357682, 'psi': 0.3381951138142555}-{'f1_val': 0.47681048634694667, 'auprc': 0.47681048634694667, 'loss_val': 1.119858634513722, 'psi': 0.47681048634694667}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.862329 cos_to_last_merge=0.9872 (last merge round=25)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.25859401278170197, 'auprc': 0.25859401278170197, 'loss_val': 2.7822056041421632, 'psi': 0.25859401278170197}-{'f1_val': 0.26531959852086634, 'auprc': 0.26531959852086634, 'loss_val': 2.5814657037353395, 'psi': 0.26531959852086634}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.979068 (no previous merge yet)
[S3] round=48 local utility u=0.016675 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8405903493298257, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.873940796238454, 'psi': 0.3641628959276018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=48 head_norm_before_train=1.850219 cos_to_last_merge=0.9891 (last merge round=30)
[S4] round=48 local utility u=0.007144 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9551531815720853, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9694410730443159, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] sending update (kind=head size=1808 to 1 peers)
[S5] START round=48 head_norm_before_train=1.980562 cos_to_last_merge=0.9825 (last merge round=29)
[S5] round=48 local utility u=0.341181 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.187492426220061, 'psi': 0.3335071121394324}-{'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 3.119463900290381, 'psi': 0.2501303341045743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=48 head_norm_before_train=1.672428 cos_to_last_merge=0.8981 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.898
[S6] round=48 local utility u=0.128791 metrics={'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 6.237792833141398, 'psi': 0.020211299954065228}-{'f1_val': 0.007311320754716981, 'auprc': 0.007311320754716981, 'loss_val': 6.3792752089835, 'psi': 0.007311320754716981}
[S6] not sending this round → trigger blocked (psi=0.020)
[S7] START round=48 head_norm_before_train=1.414244 cos_to_last_merge=0.9529 (last merge round=29)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6505019942041268, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6400907235306802, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.953513 cos_to_last_merge=0.9876 (last merge round=27)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0457399783938444, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9926889926016534, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.844037 cos_to_last_merge=0.9884 (last merge round=27)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1782090940078134, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.158254129034083, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.237693 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.900310691265785, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.877114634414133, 'psi': 0.3328555502468546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.934746 cos_to_last_merge=0.9882 (last merge round=24)
[S11] round=48 local utility u=0.003450 metrics={'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 3.2870363280301675, 'psi': 0.3237922156595487}-{'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 3.2945985618377307, 'psi': 0.323865788078467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=48 head_norm_before_train=1.851541 cos_to_last_merge=0.9825 (last merge round=27)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3598957167301107, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3379386867792225, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.955397 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.362066175952385, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.330942200900887, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.166105 (no previous merge yet)
[S15] round=48 local utility u=0.017857 metrics={'f1_val': 0.6149501012680147, 'auprc': 0.6149501012680147, 'loss_val': 0.5862065742192212, 'psi': 0.6149501012680147}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6343786298473456, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=48 head_norm_before_train=1.630160 cos_to_last_merge=0.9560 (last merge round=29)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.1487543973005959, 'auprc': 0.1487543973005959, 'loss_val': 3.3277448153056737, 'psi': 0.1487543973005959}-{'f1_val': 0.15042221268069272, 'auprc': 0.15042221268069272, 'loss_val': 3.236330277329586, 'psi': 0.15042221268069272}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.912024 cos_to_last_merge=0.9862 (last merge round=27)
[S17] round=48 local utility u=0.195474 metrics={'f1_val': 0.37384299319570546, 'auprc': 0.37384299319570546, 'loss_val': 1.3297349272503274, 'psi': 0.37384299319570546}-{'f1_val': 0.3381951138142555, 'auprc': 0.3381951138142555, 'loss_val': 1.3998528725357682, 'psi': 0.3381951138142555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=49 head_norm_before_train=1.868608 cos_to_last_merge=0.9867 (last merge round=25)
[S2] round=49 local utility u=0.136079 metrics={'f1_val': 0.2631820265933058, 'auprc': 0.2631820265933058, 'loss_val': 2.551339702538262, 'psi': 0.2631820265933058}-{'f1_val': 0.25859401278170197, 'auprc': 0.25859401278170197, 'loss_val': 2.7822056041421632, 'psi': 0.25859401278170197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=49 head_norm_before_train=1.983357 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8668776584889386, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8405903493298257, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.860489 cos_to_last_merge=0.9884 (last merge round=30)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.24060517325524647, 'auprc': 0.24060517325524647, 'loss_val': 0.9370689437864226, 'psi': 0.2406051732552465}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.9551531815720853, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.994320 cos_to_last_merge=0.9817 (last merge round=29)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2220992322954505, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.187492426220061, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.679496 cos_to_last_merge=0.8969 (last merge round=23)
[S6] ⚠️ Model drifted since last merge! cos=0.897
[S6] round=49 local utility u=0.002484 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 6.21289900428519, 'psi': 0.01799723119520074}-{'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 6.237792833141398, 'psi': 0.020211299954065228}
[S6] not sending this round → trigger blocked (psi=0.018)
[S7] START round=49 head_norm_before_train=1.424073 cos_to_last_merge=0.9502 (last merge round=29)
[S7] round=49 local utility u=0.008527 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6334489526661878, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6505019942041268, 'psi': 0.3330019880715706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=49 head_norm_before_train=1.960183 cos_to_last_merge=0.9871 (last merge round=27)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0466672283924172, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0457399783938444, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.849800 cos_to_last_merge=0.9879 (last merge round=27)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.198497476188592, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1782090940078134, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.246767 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.9218406152632284, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.900310691265785, 'psi': 0.3328555502468546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.941168 cos_to_last_merge=0.9878 (last merge round=24)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 3.2897236214885384, 'psi': 0.3237922156595487}-{'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 3.2870363280301675, 'psi': 0.3237922156595487}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.859563 cos_to_last_merge=0.9818 (last merge round=27)
[S13] round=49 local utility u=0.000737 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3584209699912022, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3598957167301107, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=49 head_norm_before_train=1.960648 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.390778016458257, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.362066175952385, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.176049 (no previous merge yet)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6337986961347446, 'psi': 0.6163342951580373}-{'f1_val': 0.6149501012680147, 'auprc': 0.6149501012680147, 'loss_val': 0.5862065742192212, 'psi': 0.6149501012680147}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.638534 cos_to_last_merge=0.9549 (last merge round=29)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.14323030039181542, 'auprc': 0.14323030039181542, 'loss_val': 3.4903545990058187, 'psi': 0.14323030039181542}-{'f1_val': 0.1487543973005959, 'auprc': 0.1487543973005959, 'loss_val': 3.3277448153056737, 'psi': 0.1487543973005959}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.918934 cos_to_last_merge=0.9858 (last merge round=27)
[S17] round=49 local utility u=1.000000 metrics={'f1_val': 0.6112513289608925, 'auprc': 0.6112513289608925, 'loss_val': 0.9206156670308268, 'psi': 0.6112513289608925}-{'f1_val': 0.37384299319570546, 'auprc': 0.37384299319570546, 'loss_val': 1.3297349272503274, 'psi': 0.37384299319570546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
