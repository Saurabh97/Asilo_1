[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:33203
[S3] → join 127.0.0.1:33202
[S4] → join 127.0.0.1:33202
[S5] → join 127.0.0.1:33202
[S6] → join 127.0.0.1:33202
[S7] → join 127.0.0.1:33202
[S8] → join 127.0.0.1:33202
[S9] → join 127.0.0.1:33202
[S10] → join 127.0.0.1:33202
[S11] → join 127.0.0.1:33202
[S13] → join 127.0.0.1:33202
[S14] → join 127.0.0.1:33202
[S15] → join 127.0.0.1:33202
[S16] → join 127.0.0.1:33202
[S17] → join 127.0.0.1:33202
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.188594 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.122873 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.158615 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.158411 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.169794 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.189080 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.159132 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.119836 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.140402 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.135673 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.132365 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.182314 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.181674 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.173419 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.185200 (no previous merge yet)
[S6]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S4] + discovered S3
[S3] + discovered S4
[S3] + discovered S13
[S3] + discovered S17
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S7
[S3] + discovered S8
[S3] + discovered S15
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S16
[S3] + discovered S11
[S4] + discovered S2
[S4] + discovered S13
[S4] + discovered S17
[S4] + discovered S9
[S4] + discovered S10
[S4] + discovered S7
[S4] + discovered S8
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S11
[S4] + discovered S16
[S5] + discovered S4
[S5] + discovered S2
[S5] + discovered S3
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S3
[S5] + discovered S14
[S5] + discovered S6
[S5] + discovered S17
[S5] + discovered S8
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S16
[S5] + discovered S11
[S5] + discovered S15
[S5] + discovered S7
[S5] + discovered S13
[S6] + discovered S13
[S6] + discovered S15
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S9
[S6] + discovered S17
[S6] + discovered S7
[S6] + discovered S16
[S6] + discovered S10
[S6] + discovered S14
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S3
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S14
[S7] + discovered S10
[S7] + discovered S11
[S7] + discovered S16
[S7] + discovered S13
[S7] + discovered S17
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S8
[S8] + discovered S2
[S8] + discovered S7
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S4
[S9] + discovered S8
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S6
[S8] + discovered S13
[S8] + discovered S10
[S8] + discovered S15
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S11
[S8] + discovered S16
[S8] + discovered S14
[S10] + discovered S4
[S10] + discovered S2
[S10] + discovered S7
[S10] + discovered S3
[S10] + discovered S5
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S8
[S9] + discovered S15
[S9] + discovered S11
[S9] + discovered S17
[S9] + discovered S14
[S9] + discovered S16
[S9] + discovered S10
[S9] + discovered S13
[S10] + discovered S16
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S13
[S10] + discovered S14
[S10] + discovered S11
[S11] + discovered S8
[S11] + discovered S10
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S7
[S11] + discovered S4
[S11] + discovered S2
[S11] + discovered S6
[S11] + discovered S3
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S14
[S11] + discovered S16
[S11] + discovered S15
[S13] + discovered S3
[S13] + discovered S8
[S13] + discovered S6
[S13] + discovered S10
[S13] + discovered S11
[S13] + discovered S2
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S5
[S13] + discovered S9
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S16
[S13] + discovered S17
[S14] + discovered S9
[S14] + discovered S7
[S14] + discovered S4
[S14] + discovered S10
[S14] + discovered S13
[S14] + discovered S3
[S14] + discovered S5
[S14] + discovered S2
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S8
[S15] + discovered S5
[S15] + discovered S11
[S15] + discovered S3
[S15] + discovered S10
[S15] + discovered S4
[S15] + discovered S8
[S15] + discovered S6
[S15] + discovered S2
[S15] + discovered S13
[S15] + discovered S14
[S15] + discovered S7
[S15] + discovered S9
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S16] + discovered S11
[S16] + discovered S10
[S16] + discovered S15
[S16] + discovered S13
[S16] + discovered S7
[S16] + discovered S9
[S16] + discovered S3
[S16] + discovered S4
[S16] + discovered S8
[S16] + discovered S2
[S16] + discovered S14
[S16] + discovered S6
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S5
[S17] + discovered S11
[S17] + discovered S10
[S17] + discovered S5
[S17] + discovered S15
[S17] + discovered S13
[S17] + discovered S7
[S17] + discovered S9
[S17] + discovered S16
[S17] + discovered S3
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S2
[S17] + discovered S6
[S16] + discovered S17
[S17] + discovered S14
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:33217
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:33210
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:33209
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:33204
[S10] ⇄ pheromone p=1.000 → S3@127.0.0.1:33203
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:33213
[S15] ⇄ pheromone p=1.000 → S11@127.0.0.1:33212
[S16] ⇄ pheromone p=1.000 → S17@127.0.0.1:33217
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:33216
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:33212
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:33204
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:33214
[S2] ⇄ pheromone p=1.000 → S13@127.0.0.1:33213
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:33215
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:33203
[S2] START round=1 head_norm_before_train=1.208068 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9110570637911646, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5394364927619573, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.131397 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.483926610295613, 'psi': 0.0}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.393209638112468, 'psi': 0.3641628959276018}
[S4] START round=1 head_norm_before_train=1.188847 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.3331228956228956, 'auprc': 0.3331228956228956, 'loss_val': 1.5427208639896564, 'psi': 0.3331228956228956}-{'f1_val': 0.3329127234490011, 'auprc': 0.3329127234490011, 'loss_val': 1.4183842596331944, 'psi': 0.3329127234490011}
[S5] START round=1 head_norm_before_train=1.166126 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.10382222222222222, 'auprc': 0.10382222222222222, 'loss_val': 1.461461919722607, 'psi': 0.10382222222222222}-{'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 1.405902727775733, 'psi': 0.3333333333333333}
[S6] START round=1 head_norm_before_train=1.193995 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.190233556037326, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6364200546793002, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.193158 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5251349445364548, 'psi': 0.0}-{'f1_val': 0.3046267496111975, 'auprc': 0.3046267496111975, 'loss_val': 1.4520737403989061, 'psi': 0.3046267496111975}
[S8] START round=1 head_norm_before_train=1.164554 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4859939417252273, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4176054115172985, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.120704 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6107212885335642, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5210025454489033, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.157051 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6049333592061557, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4516995129140806, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.139550 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5385374535092806, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4637605583332907, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.128375 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.57970932551103, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4892745231454478, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.189252 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6376348116483763, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.533327115092548, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.210607 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7341063096362304, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.498574721575332, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.170915 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.548501906518883, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.483423195788337, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.199416 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5450929162763072, 'psi': 0.0}-{'f1_val': 0.051188299817184646, 'auprc': 0.051188299817184646, 'loss_val': 1.3868247073563265, 'psi': 0.051188299817184646}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.255481 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8010180666978073, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9110570637911646, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.147319 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.715264028493404, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.483926610295613, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.244663 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.2495259165613148, 'auprc': 0.2495259165613148, 'loss_val': 1.656034250276805, 'psi': 0.2495259165613148}-{'f1_val': 0.3331228956228956, 'auprc': 0.3331228956228956, 'loss_val': 1.5427208639896564, 'psi': 0.3331228956228956}
[S5] START round=2 head_norm_before_train=1.182243 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5525042217245562, 'psi': 0.0}-{'f1_val': 0.10382222222222222, 'auprc': 0.10382222222222222, 'loss_val': 1.461461919722607, 'psi': 0.10382222222222222}
[S6] START round=2 head_norm_before_train=1.250090 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2825658223441803, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.190233556037326, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.207229 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6632379527429435, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5251349445364548, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.192790 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7057805127539445, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4859939417252273, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.141398 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7758713974818603, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6107212885335642, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.202228 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9304259974511027, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6049333592061557, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.156421 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6780914130494267, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5385374535092806, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.155934 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9695263981038749, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.57970932551103, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.208692 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8409110887496585, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6376348116483763, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.258192 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0183515181730507, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7341063096362304, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.187420 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6633374332485817, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.548501906518883, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.241087 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8795609872932306, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5450929162763072, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.309468 (no previous merge yet)
[S2] round=3 local utility u=0.003790 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.793439055042695, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8010180666978073, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.174080 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4432773903330403, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.715264028493404, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.300823 (no previous merge yet)
[S4] round=3 local utility u=0.014069 metrics={'f1_val': 0.22605090077209036, 'auprc': 0.22605090077209036, 'loss_val': 1.4166201411568928, 'psi': 0.22605090077209036}-{'f1_val': 0.2495259165613148, 'auprc': 0.2495259165613148, 'loss_val': 1.656034250276805, 'psi': 0.2495259165613148}
[S5] START round=3 head_norm_before_train=1.207857 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7007997888961754, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5525042217245562, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.309930 (no previous merge yet)
[S6] round=3 local utility u=0.342273 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5980195947204687, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2825658223441803, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.230015 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0107713121154838, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6632379527429435, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.236841 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.27003265511178093, 'auprc': 0.27003265511178093, 'loss_val': 1.6107717223035527, 'psi': 0.27003265511178093}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7057805127539445, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.176910 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1481936035017775, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7758713974818603, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.244544 (no previous merge yet)
[S10] round=3 local utility u=0.099012 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7324026655896525, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9304259974511027, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.185476 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0793249484004113, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6780914130494267, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.205273 (no previous merge yet)
[S13] round=3 local utility u=0.050223 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8690808230148441, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9695263981038749, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.238790 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.357973220517488, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8409110887496585, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.299802 (no previous merge yet)
[S15] round=3 local utility u=0.134843 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7486654938517374, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0183515181730507, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.217553 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9361257671960692, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6633374332485817, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.292819 (no previous merge yet)
[S17] round=3 local utility u=0.162517 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5545268329473372, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8795609872932306, 'psi': 0.0}
[S15] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.1311
[S10] RECEIVED delta(kind=head bytes=1791) from S4
[S10] cosine check vs S4: cos=-0.0710
[S10] DROPPED delta from S4 (cos=-0.0710 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.0000 head_norm=1.330911
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.590276e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.0000 head_norm=0.979972 delta_norm=0.859028
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.348578 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9096758502709257, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.793439055042695, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.209070 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.99386665852393, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4432773903330403, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.340992 (no previous merge yet)
[S4] round=4 local utility u=0.505634 metrics={'f1_val': 0.32748538011695905, 'auprc': 0.32748538011695905, 'loss_val': 1.3182619811442353, 'psi': 0.32748538011695905}-{'f1_val': 0.22605090077209036, 'auprc': 0.22605090077209036, 'loss_val': 1.4166201411568928, 'psi': 0.22605090077209036}
[S5] START round=4 head_norm_before_train=1.235484 (no previous merge yet)
[S5] round=4 local utility u=0.027789 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6452223447145735, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7007997888961754, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.342277 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9545898389011263, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5980195947204687, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.257228 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.095404112469787, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0107713121154838, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.274843 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.22189432265317596, 'auprc': 0.22189432265317596, 'loss_val': 1.3748256623751058, 'psi': 0.22189432265317596}-{'f1_val': 0.27003265511178093, 'auprc': 0.27003265511178093, 'loss_val': 1.6107717223035527, 'psi': 0.27003265511178093}
[S9] START round=4 head_norm_before_train=1.218960 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7362833812011655, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1481936035017775, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.267039 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0947352699280644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7324026655896525, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.225198 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.697944285688075, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0793249484004113, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.219645 (no previous merge yet)
[S13] round=4 local utility u=0.130323 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6084340800050991, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8690808230148441, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.276999 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9535755224207874, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.357973220517488, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.333809 (no previous merge yet)
[S15] round=4 local utility u=0.132065 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4845350127825934, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7486654938517374, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.257934 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.468210188907815, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9361257671960692, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=0.979972 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.067932 metrics={'f1_val': 0.0031625553447185324, 'auprc': 0.0031625553447185324, 'loss_val': 1.4471263210880643, 'psi': 0.0031625553447185324}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5545268329473372, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.327)
[S15] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.003)
[S2] START round=5 head_norm_before_train=1.401519 (no previous merge yet)
[S2] round=5 local utility u=0.101438 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.706800606879774, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9096758502709257, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.231478 (no previous merge yet)
[S3] round=5 local utility u=0.054083 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8856997675363525, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.99386665852393, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.399086 (no previous merge yet)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3405761863746037, 'psi': 0.0}-{'f1_val': 0.32748538011695905, 'auprc': 0.32748538011695905, 'loss_val': 1.3182619811442353, 'psi': 0.32748538011695905}
[S5] START round=5 head_norm_before_train=1.244534 (no previous merge yet)
[S5] round=5 local utility u=0.950836 metrics={'f1_val': 0.20135214579659025, 'auprc': 0.20135214579659025, 'loss_val': 1.5557196305637357, 'psi': 0.20135214579659025}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6452223447145735, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.400688 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.623452446164018, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9545898389011263, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.270617 (no previous merge yet)
[S7] round=5 local utility u=0.128186 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8390315088402995, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.095404112469787, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.322442 (no previous merge yet)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.20361057382333977, 'auprc': 0.20361057382333977, 'loss_val': 1.2433736066223315, 'psi': 0.20361057382333977}-{'f1_val': 0.22189432265317596, 'auprc': 0.22189432265317596, 'loss_val': 1.3748256623751058, 'psi': 0.22189432265317596}
[S9] START round=5 head_norm_before_train=1.255919 (no previous merge yet)
[S9] round=5 local utility u=0.064505 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6072736581121414, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7362833812011655, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.318203 (no previous merge yet)
[S10] round=5 local utility u=0.678648 metrics={'f1_val': 0.20190937589056712, 'auprc': 0.20190937589056712, 'loss_val': 2.55462411210648, 'psi': 0.20190937589056712}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0947352699280644, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.260627 (no previous merge yet)
[S11] round=5 local utility u=0.005608 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6867291334818315, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.697944285688075, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.237192 (no previous merge yet)
[S13] round=5 local utility u=0.051289 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.505855381672972, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6084340800050991, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.306383 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0691616498511447, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9535755224207874, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.385869 (no previous merge yet)
[S15] round=5 local utility u=1.000000 metrics={'f1_val': 0.3332280812546048, 'auprc': 0.3332280812546048, 'loss_val': 1.3487909323596752, 'psi': 0.3332280812546048}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4845350127825934, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.296433 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.871232580967014, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.468210188907815, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.045030 cos_to_last_merge=0.9930 (last merge round=3)
[S17] round=5 local utility u=0.967134 metrics={'f1_val': 0.20714662447257384, 'auprc': 0.20714662447257384, 'loss_val': 1.3487146200419167, 'psi': 0.20714662447257384}-{'f1_val': 0.0031625553447185324, 'auprc': 0.0031625553447185324, 'loss_val': 1.4471263210880643, 'psi': 0.0031625553447185324}
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:33216
[S13] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33203
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] cosine check vs S10: cos=-0.0806
[S3] DROPPED delta from S10 (cos=-0.0806 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S15
[S11] cosine check vs S15: cos=0.0134
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0391
[S16] DROPPED delta from S5 (cos=-0.0391 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S17
[S3] cosine check vs S17: cos=0.0163
[S7] ⇄ pheromone p=0.353 → S14@127.0.0.1:33214
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.0000 head_norm=1.282052
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.590400e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.0000 head_norm=0.971882 delta_norm=0.959040
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.329 → S13@127.0.0.1:33213
[S2] ⇄ pheromone p=0.348 → S13@127.0.0.1:33213
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.0000 head_norm=1.244521
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.304575e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.0000 head_norm=0.844065 delta_norm=0.830458
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.338 → S9@127.0.0.1:33210
[S9] ⇄ pheromone p=0.341 → S17@127.0.0.1:33217
[S6] ⇄ pheromone p=0.371 → S11@127.0.0.1:33212
[S4] ⇄ pheromone p=0.410 → S10@127.0.0.1:33211
[S8] ⇄ pheromone p=0.456 → S17@127.0.0.1:33217
[S13] ⇄ pheromone p=0.365 → S4@127.0.0.1:33204
[S14] ⇄ pheromone p=0.328 → S15@127.0.0.1:33215
[S10] ⇄ pheromone p=0.476 → S3@127.0.0.1:33203
[S15] ⇄ pheromone p=0.566 → S11@127.0.0.1:33212
[S5] ⇄ pheromone p=0.522 → S16@127.0.0.1:33216
[S17] ⇄ pheromone p=0.553 → S3@127.0.0.1:33203
[S16] ⇄ pheromone p=0.328 → S17@127.0.0.1:33217
[S2] START round=6 head_norm_before_train=1.454501 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7296427527742013, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.706800606879774, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=0.844065 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.313892 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2579165788601836, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8856997675363525, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.459297 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4019515672502407, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3405761863746037, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.253505 (no previous merge yet)
[S5] round=6 local utility u=0.477596 metrics={'f1_val': 0.3003586717574916, 'auprc': 0.3003586717574916, 'loss_val': 1.4915863377381051, 'psi': 0.3003586717574916}-{'f1_val': 0.20135214579659025, 'auprc': 0.20135214579659025, 'loss_val': 1.5557196305637357, 'psi': 0.20135214579659025}
[S6] START round=6 head_norm_before_train=1.464415 (no previous merge yet)
[S6] round=6 local utility u=0.316688 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9900769312146664, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.623452446164018, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.270857 (no previous merge yet)
[S7] round=6 local utility u=0.046051 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7469296174513442, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8390315088402995, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.380891 (no previous merge yet)
[S8] round=6 local utility u=0.030505 metrics={'f1_val': 0.2034924930730073, 'auprc': 0.2034924930730073, 'loss_val': 1.181301490237945, 'psi': 0.2034924930730073}-{'f1_val': 0.20361057382333977, 'auprc': 0.20361057382333977, 'loss_val': 1.2433736066223315, 'psi': 0.20361057382333977}
[S9] START round=6 head_norm_before_train=1.281271 (no previous merge yet)
[S9] round=6 local utility u=0.124970 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.357333493193639, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6072736581121414, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.370891 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.1784506609283738, 'auprc': 0.1784506609283738, 'loss_val': 3.2318971445611844, 'psi': 0.1784506609283738}-{'f1_val': 0.20190937589056712, 'auprc': 0.20190937589056712, 'loss_val': 2.55462411210648, 'psi': 0.20190937589056712}
[S11] START round=6 head_norm_before_train=0.971882 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.264051 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1586275218506605, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6867291334818315, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.276552 (no previous merge yet)
[S13] round=6 local utility u=1.000000 metrics={'f1_val': 0.31038710807496933, 'auprc': 0.31038710807496933, 'loss_val': 1.2224814516051405, 'psi': 0.31038710807496933}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.505855381672972, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.327871 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2294248941640458, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0691616498511447, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.443942 (no previous merge yet)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.25998715478484263, 'auprc': 0.25998715478484263, 'loss_val': 1.3372523207280367, 'psi': 0.25998715478484263}-{'f1_val': 0.3332280812546048, 'auprc': 0.3332280812546048, 'loss_val': 1.3487909323596752, 'psi': 0.3332280812546048}
[S16] START round=6 head_norm_before_train=1.329860 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2342881585766503, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.871232580967014, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.120437 cos_to_last_merge=0.9772 (last merge round=3)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.0012698412698412698, 'auprc': 0.0012698412698412698, 'loss_val': 1.3697666040389052, 'psi': 0.0012698412698412698}-{'f1_val': 0.20714662447257384, 'auprc': 0.20714662447257384, 'loss_val': 1.3487146200419167, 'psi': 0.20714662447257384}
[S7] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:33204
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.300)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.6520
[S4] RECEIVED delta(kind=head bytes=1806) from S13
[S4] cosine check vs S13: cos=-0.0508
[S4] DROPPED delta from S13 (cos=-0.0508 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.0013 head_norm=1.182367
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.588858e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.0127 head_norm=1.192170 delta_norm=0.558886
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.496949 (no previous merge yet)
[S2] round=7 local utility u=0.167530 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3945825849894904, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7296427527742013, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=0.865077 cos_to_last_merge=0.9985 (last merge round=5)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5054458823629555, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2579165788601836, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.512794 (no previous merge yet)
[S4] round=7 local utility u=0.040825 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3203024763436935, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4019515672502407, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.269117 (no previous merge yet)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.26676777890124703, 'auprc': 0.26676777890124703, 'loss_val': 1.4215229585253437, 'psi': 0.26676777890124703}-{'f1_val': 0.3003586717574916, 'auprc': 0.3003586717574916, 'loss_val': 1.4915863377381051, 'psi': 0.3003586717574916}
[S6] START round=7 head_norm_before_train=1.514173 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2294668987148154, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9900769312146664, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.279398 (no previous merge yet)
[S7] round=7 local utility u=0.026058 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6948127564040911, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7469296174513442, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.438491 (no previous merge yet)
[S8] round=7 local utility u=0.520587 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.054252251181247, 'psi': 0.30506182380216385}-{'f1_val': 0.2034924930730073, 'auprc': 0.2034924930730073, 'loss_val': 1.181301490237945, 'psi': 0.2034924930730073}
[S9] START round=7 head_norm_before_train=1.312854 (no previous merge yet)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3683252536988335, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.357333493193639, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.429738 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.07148709545268332, 'auprc': 0.07148709545268332, 'loss_val': 3.4426427557541683, 'psi': 0.07148709545268332}-{'f1_val': 0.1784506609283738, 'auprc': 0.1784506609283738, 'loss_val': 3.2318971445611844, 'psi': 0.1784506609283738}
[S11] START round=7 head_norm_before_train=0.996238 cos_to_last_merge=0.9982 (last merge round=5)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.347348238630451, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1586275218506605, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.318311 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.24038291083141286, 'auprc': 0.24038291083141286, 'loss_val': 1.1027017240949193, 'psi': 0.24038291083141286}-{'f1_val': 0.31038710807496933, 'auprc': 0.31038710807496933, 'loss_val': 1.2224814516051405, 'psi': 0.31038710807496933}
[S14] START round=7 head_norm_before_train=1.353648 (no previous merge yet)
[S14] round=7 local utility u=0.041826 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1457733486392936, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2294248941640458, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.496588 (no previous merge yet)
[S15] round=7 local utility u=0.389281 metrics={'f1_val': 0.33301717778480344, 'auprc': 0.33301717778480344, 'loss_val': 1.2159605633564072, 'psi': 0.33301717778480344}-{'f1_val': 0.25998715478484263, 'auprc': 0.25998715478484263, 'loss_val': 1.3372523207280367, 'psi': 0.25998715478484263}
[S16] START round=7 head_norm_before_train=1.366454 (no previous merge yet)
[S16] round=7 local utility u=0.039684 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1549204605027903, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2342881585766503, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.192170 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.584138 metrics={'f1_val': 0.12849872773536897, 'auprc': 0.12849872773536897, 'loss_val': 1.3465513068808503, 'psi': 0.12849872773536897}-{'f1_val': 0.0012698412698412698, 'auprc': 0.0012698412698412698, 'loss_val': 1.3697666040389052, 'psi': 0.0012698412698412698}
[S14] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=0.7035
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.9010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.5735
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.0000 head_norm=0.894720
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.172601e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.0000 head_norm=0.951591 delta_norm=0.517260
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.0000 head_norm=1.029670
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.507483e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.193435 delta_norm=0.550748
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.1285 head_norm=1.243239
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.242197e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.1710 head_norm=1.327703 delta_norm=0.324220
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.540610 (no previous merge yet)
[S2] round=8 local utility u=0.883687 metrics={'f1_val': 0.1859756097560976, 'auprc': 0.1859756097560976, 'loss_val': 2.3009894266879467, 'psi': 0.1859756097560976}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3945825849894904, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=0.951591 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.218658 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0681301508494063, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5054458823629555, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.550472 (no previous merge yet)
[S4] round=8 local utility u=0.034945 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.25041211199259, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3203024763436935, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.288570 (no previous merge yet)
[S5] round=8 local utility u=0.222065 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.322628813110323, 'psi': 0.3051272166538165}-{'f1_val': 0.26676777890124703, 'auprc': 0.26676777890124703, 'loss_val': 1.4215229585253437, 'psi': 0.26676777890124703}
[S6] START round=8 head_norm_before_train=1.564483 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8475600291268366, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2294668987148154, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.295138 (no previous merge yet)
[S7] round=8 local utility u=0.075337 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5441386868563554, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6948127564040911, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.479927 (no previous merge yet)
[S8] round=8 local utility u=0.061669 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9309149845181502, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.054252251181247, 'psi': 0.30506182380216385}
[S9] START round=8 head_norm_before_train=1.350814 (no previous merge yet)
[S9] round=8 local utility u=0.150418 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0674899715981976, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3683252536988335, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.485710 (no previous merge yet)
[S10] round=8 local utility u=1.000000 metrics={'f1_val': 0.3326947637292465, 'auprc': 0.3326947637292465, 'loss_val': 3.360579241819351, 'psi': 0.3326947637292465}-{'f1_val': 0.07148709545268332, 'auprc': 0.07148709545268332, 'loss_val': 3.4426427557541683, 'psi': 0.07148709545268332}
[S11] START round=8 head_norm_before_train=1.193435 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.128372 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0906048115299343, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.347348238630451, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.363605 (no previous merge yet)
[S13] round=8 local utility u=0.007021 metrics={'f1_val': 0.24021257750221436, 'auprc': 0.24021257750221436, 'loss_val': 1.0871259486561378, 'psi': 0.24021257750221436}-{'f1_val': 0.24038291083141286, 'auprc': 0.24038291083141286, 'loss_val': 1.1027017240949193, 'psi': 0.24038291083141286}
[S14] START round=8 head_norm_before_train=1.378467 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1557409958350746, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1457733486392936, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.547580 (no previous merge yet)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.2848528702363724, 'auprc': 0.2848528702363724, 'loss_val': 0.988353306602999, 'psi': 0.2848528702363724}-{'f1_val': 0.33301717778480344, 'auprc': 0.33301717778480344, 'loss_val': 1.2159605633564072, 'psi': 0.33301717778480344}
[S16] START round=8 head_norm_before_train=1.401264 (no previous merge yet)
[S16] round=8 local utility u=0.021064 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1127918529094107, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1549204605027903, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.327703 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.328862 metrics={'f1_val': 0.19114363681468619, 'auprc': 0.19114363681468619, 'loss_val': 1.2526305320100684, 'psi': 0.19114363681468619}-{'f1_val': 0.12849872773536897, 'auprc': 0.12849872773536897, 'loss_val': 1.3465513068808503, 'psi': 0.12849872773536897}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S8] not sending this round → trigger blocked (psi=0.305)
[S11] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.186)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:33204
[S5] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=-0.0284
[S16] DROPPED delta from S5 (cos=-0.0284 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.0253
[S4] RECEIVED delta(kind=head bytes=1802) from S13
[S4] cosine check vs S13: cos=-0.0480
[S4] DROPPED delta from S13 (cos=-0.0480 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.191)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.0000 head_norm=0.970960
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.955147e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.0000 head_norm=0.916254 delta_norm=0.895515
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.593302 (no previous merge yet)
[S2] round=9 local utility u=0.021795 metrics={'f1_val': 0.1941974730931212, 'auprc': 0.1941974730931212, 'loss_val': 2.3313968722441936, 'psi': 0.1941974730931212}-{'f1_val': 0.1859756097560976, 'auprc': 0.1859756097560976, 'loss_val': 2.3009894266879467, 'psi': 0.1859756097560976}
[S3] START round=9 head_norm_before_train=0.916254 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.076508 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9151145767598945, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0681301508494063, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.588539 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2922463420874983, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.25041211199259, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.305575 (no previous merge yet)
[S5] round=9 local utility u=0.031969 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.258689880161642, 'psi': 0.3051272166538165}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.322628813110323, 'psi': 0.3051272166538165}
[S6] START round=9 head_norm_before_train=1.610430 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 4.513317354662643, 'psi': 0.01732902033271719}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8475600291268366, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.307740 (no previous merge yet)
[S7] round=9 local utility u=0.029616 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.484906848518074, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5441386868563554, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.531224 (no previous merge yet)
[S8] round=9 local utility u=0.308749 metrics={'f1_val': 0.36540296199545896, 'auprc': 0.36540296199545896, 'loss_val': 0.8564871367937474, 'psi': 0.36540296199545896}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9309149845181502, 'psi': 0.30506182380216385}
[S9] START round=9 head_norm_before_train=1.390294 (no previous merge yet)
[S9] round=9 local utility u=0.083795 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8998993452400719, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0674899715981976, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.529762 (no previous merge yet)
[S10] round=9 local utility u=0.068168 metrics={'f1_val': 0.33293451383903644, 'auprc': 0.33293451383903644, 'loss_val': 3.226401184068053, 'psi': 0.33293451383903644}-{'f1_val': 0.3326947637292465, 'auprc': 0.3326947637292465, 'loss_val': 3.360579241819351, 'psi': 0.3326947637292465}
[S11] START round=9 head_norm_before_train=1.218178 cos_to_last_merge=0.9977 (last merge round=7)
[S11] round=9 local utility u=0.056627 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9773510541335295, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0906048115299343, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.417537 (no previous merge yet)
[S13] round=9 local utility u=0.524175 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.116288403153119, 'psi': 0.3599362944611573}-{'f1_val': 0.24021257750221436, 'auprc': 0.24021257750221436, 'loss_val': 1.0871259486561378, 'psi': 0.24021257750221436}
[S14] START round=9 head_norm_before_train=1.406325 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8187724385053907, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1557409958350746, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.579449 (no previous merge yet)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.26092528514673846, 'auprc': 0.26092528514673846, 'loss_val': 0.9587031426624724, 'psi': 0.26092528514673846}-{'f1_val': 0.2848528702363724, 'auprc': 0.2848528702363724, 'loss_val': 0.988353306602999, 'psi': 0.2848528702363724}
[S16] START round=9 head_norm_before_train=1.433642 (no previous merge yet)
[S16] round=9 local utility u=0.053601 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.005590095384776, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1127918529094107, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.379096 cos_to_last_merge=0.9964 (last merge round=7)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.1599103687105317, 'auprc': 0.1599103687105317, 'loss_val': 1.207597496008147, 'psi': 0.1599103687105317}-{'f1_val': 0.19114363681468619, 'auprc': 0.19114363681468619, 'loss_val': 1.2526305320100684, 'psi': 0.19114363681468619}
[S9] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.194)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[S11] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.333)
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.360)
[S3] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.305)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9421
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.1599 head_norm=1.422750
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.675100e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.1572 head_norm=1.480764 delta_norm=0.267510
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.644453 (no previous merge yet)
[S2] round=10 local utility u=0.426620 metrics={'f1_val': 0.2511877969492373, 'auprc': 0.2511877969492373, 'loss_val': 1.9910693773861585, 'psi': 0.2511877969492373}-{'f1_val': 0.1941974730931212, 'auprc': 0.1941974730931212, 'loss_val': 2.3313968722441936, 'psi': 0.1941974730931212}
[S3] START round=10 head_norm_before_train=0.933409 cos_to_last_merge=0.9958 (last merge round=8)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.279360630381689, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9151145767598945, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.636733 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.002358093313121105, 'auprc': 0.002358093313121105, 'loss_val': 1.3306350913273306, 'psi': 0.002358093313121105}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2922463420874983, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.327192 (no previous merge yet)
[S5] round=10 local utility u=1.000000 metrics={'f1_val': 0.5797482052802535, 'auprc': 0.5797482052802535, 'loss_val': 1.218604329198957, 'psi': 0.5797482052802535}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.258689880161642, 'psi': 0.3051272166538165}
[S6] START round=10 head_norm_before_train=1.651419 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 4.941624838570313, 'psi': 0.021749084249084248}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 4.513317354662643, 'psi': 0.01732902033271719}
[S7] START round=10 head_norm_before_train=1.327918 (no previous merge yet)
[S7] round=10 local utility u=0.034153 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4166002389054564, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.484906848518074, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.582476 (no previous merge yet)
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.9997177674455537, 'auprc': 0.9997177674455537, 'loss_val': 0.8175587397419565, 'psi': 0.9997177674455537}-{'f1_val': 0.36540296199545896, 'auprc': 0.36540296199545896, 'loss_val': 0.8564871367937474, 'psi': 0.36540296199545896}
[S9] START round=10 head_norm_before_train=1.429618 (no previous merge yet)
[S9] round=10 local utility u=0.150389 metrics={'f1_val': 0.0016378100140383716, 'auprc': 0.0016378100140383716, 'loss_val': 1.6138624207688705, 'psi': 0.0016378100140383716}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8998993452400719, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.577696 (no previous merge yet)
[S10] round=10 local utility u=0.079569 metrics={'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 3.066545852453896, 'psi': 0.3328548644338118}-{'f1_val': 0.33293451383903644, 'auprc': 0.33293451383903644, 'loss_val': 3.226401184068053, 'psi': 0.33293451383903644}
[S11] START round=10 head_norm_before_train=1.252839 cos_to_last_merge=0.9913 (last merge round=7)
[S11] round=10 local utility u=0.004292 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9687675954592994, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9773510541335295, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.463800 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1896492057114016, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.116288403153119, 'psi': 0.3599362944611573}
[S14] START round=10 head_norm_before_train=1.439546 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.346185497049411, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8187724385053907, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.620037 (no previous merge yet)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.25539101065211745, 'auprc': 0.25539101065211745, 'loss_val': 0.9744596775589807, 'psi': 0.25539101065211745}-{'f1_val': 0.26092528514673846, 'auprc': 0.26092528514673846, 'loss_val': 0.9587031426624724, 'psi': 0.26092528514673846}
[S16] START round=10 head_norm_before_train=1.464258 (no previous merge yet)
[S16] round=10 local utility u=0.046707 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9121751112088723, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.005590095384776, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.480764 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.15243547448088493, 'auprc': 0.15243547448088493, 'loss_val': 1.1427060182523068, 'psi': 0.15243547448088493}-{'f1_val': 0.1599103687105317, 'auprc': 0.1599103687105317, 'loss_val': 1.207597496008147, 'psi': 0.1599103687105317}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.002)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=1.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[S16] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] cosine check vs S2: cos=0.0073
[S3] RECEIVED delta(kind=head bytes=1806) from S10
[S3] cosine check vs S10: cos=0.7994
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=-0.0213
[S16] DROPPED delta from S5 (cos=-0.0213 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.112 → S15@127.0.0.1:33215
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.3599 head_norm=1.497989
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.125729e+00
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.3599 head_norm=1.133903 delta_norm=1.125729
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.286 → S4@127.0.0.1:33204
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.0000 head_norm=0.961079
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.182885e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.233053 delta_norm=0.518288
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.177 → S9@127.0.0.1:33210
[S9] ⇄ pheromone p=0.185 → S17@127.0.0.1:33217
[S8] ⇄ pheromone p=0.462 → S17@127.0.0.1:33217
[S11] ⇄ pheromone p=0.156 → S13@127.0.0.1:33213
[S6] ⇄ pheromone p=0.148 → S11@127.0.0.1:33212
[S4] ⇄ pheromone p=0.143 → S10@127.0.0.1:33211
[S15] ⇄ pheromone p=0.225 → S11@127.0.0.1:33212
[S7] ⇄ pheromone p=0.143 → S14@127.0.0.1:33214
[S2] ⇄ pheromone p=0.333 → S13@127.0.0.1:33213
[S10] ⇄ pheromone p=0.311 → S3@127.0.0.1:33203
[S5] ⇄ pheromone p=0.444 → S16@127.0.0.1:33216
[S17] ⇄ pheromone p=0.283 → S3@127.0.0.1:33203
[S16] ⇄ pheromone p=0.132 → S17@127.0.0.1:33217
[S2] START round=11 head_norm_before_train=1.691755 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 2.4240384243137254, 'psi': 0.2654504593826426}-{'f1_val': 0.2511877969492373, 'auprc': 0.2511877969492373, 'loss_val': 1.9910693773861585, 'psi': 0.2511877969492373}
[S3] START round=11 head_norm_before_train=1.233053 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.134423 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0105140141828364, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.279360630381689, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.691142 (no previous merge yet)
[S4] round=11 local utility u=1.000000 metrics={'f1_val': 0.33324879533350243, 'auprc': 0.33324879533350243, 'loss_val': 1.2897023680103594, 'psi': 0.33324879533350243}-{'f1_val': 0.002358093313121105, 'auprc': 0.002358093313121105, 'loss_val': 1.3306350913273306, 'psi': 0.002358093313121105}
[S5] START round=11 head_norm_before_train=1.355650 (no previous merge yet)
[S5] round=11 local utility u=1.000000 metrics={'f1_val': 0.9868065537170307, 'auprc': 0.9868065537170307, 'loss_val': 1.1768722808722063, 'psi': 0.9868065537170307}-{'f1_val': 0.5797482052802535, 'auprc': 0.5797482052802535, 'loss_val': 1.218604329198957, 'psi': 0.5797482052802535}
[S6] START round=11 head_norm_before_train=1.689326 (no previous merge yet)
[S6] round=11 local utility u=0.242733 metrics={'f1_val': 0.0662375415282392, 'auprc': 0.0662375415282392, 'loss_val': 4.856555577204219, 'psi': 0.0662375415282392}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 4.941624838570313, 'psi': 0.021749084249084248}
[S7] START round=11 head_norm_before_train=1.350030 (no previous merge yet)
[S7] round=11 local utility u=0.026012 metrics={'f1_val': 0.00019918334827208445, 'auprc': 0.00019918334827208445, 'loss_val': 1.3663698026035287, 'psi': 0.00019918334827208445}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4166002389054564, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.637139 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8137135850961192, 'psi': 0.35939447907390915}-{'f1_val': 0.9997177674455537, 'auprc': 0.9997177674455537, 'loss_val': 0.8175587397419565, 'psi': 0.9997177674455537}
[S9] START round=11 head_norm_before_train=1.464288 (no previous merge yet)
[S9] round=11 local utility u=0.964395 metrics={'f1_val': 0.19428496007391274, 'auprc': 0.19428496007391274, 'loss_val': 1.4188966195064916, 'psi': 0.19428496007391274}-{'f1_val': 0.0016378100140383716, 'auprc': 0.0016378100140383716, 'loss_val': 1.6138624207688705, 'psi': 0.0016378100140383716}
[S10] START round=11 head_norm_before_train=1.629237 (no previous merge yet)
[S10] round=11 local utility u=0.079640 metrics={'f1_val': 0.3328550932568149, 'auprc': 0.3328550932568149, 'loss_val': 2.907268911631018, 'psi': 0.3328550932568149}-{'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 3.066545852453896, 'psi': 0.3328548644338118}
[S11] START round=11 head_norm_before_train=1.292113 cos_to_last_merge=0.9833 (last merge round=7)
[S11] round=11 local utility u=0.017069 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9346286064131737, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9687675954592994, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.133903 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.019376 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.150896445837442, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1896492057114016, 'psi': 0.3599362944611573}
[S14] START round=11 head_norm_before_train=1.471008 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.550491614356053, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.346185497049411, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.663331 (no previous merge yet)
[S15] round=11 local utility u=0.172562 metrics={'f1_val': 0.28038067349926793, 'auprc': 0.28038067349926793, 'loss_val': 0.854243441424601, 'psi': 0.28038067349926793}-{'f1_val': 0.25539101065211745, 'auprc': 0.25539101065211745, 'loss_val': 0.9744596775589807, 'psi': 0.25539101065211745}
[S16] START round=11 head_norm_before_train=1.494708 (no previous merge yet)
[S16] round=11 local utility u=0.002406 metrics={'f1_val': 0.010061668289516391, 'auprc': 0.010061668289516391, 'loss_val': 2.9979181585558163, 'psi': 0.010061668289516391}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9121751112088723, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.534256 cos_to_last_merge=0.9980 (last merge round=9)
[S17] round=11 local utility u=0.046357 metrics={'f1_val': 0.15286870194812607, 'auprc': 0.15286870194812607, 'loss_val': 1.0538908619865934, 'psi': 0.15286870194812607}-{'f1_val': 0.15243547448088493, 'auprc': 0.15243547448088493, 'loss_val': 1.1427060182523068, 'psi': 0.15243547448088493}
[S6] not sending this round → trigger blocked (psi=0.066)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.333)
[S3] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.194)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.010)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:33212
[S5] not sending this round → trigger blocked (psi=0.987)
[S4] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S13
[S4] cosine check vs S13: cos=-0.0515
[S4] DROPPED delta from S13 (cos=-0.0515 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S4
[S10] cosine check vs S4: cos=-0.0436
[S10] DROPPED delta from S4 (cos=-0.0436 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S15
[S11] cosine check vs S15: cos=0.8691
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.2094
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.0000 head_norm=1.251582
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.043256e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.111549 delta_norm=0.904326
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.0000 head_norm=1.333970
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.257654e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.465967 delta_norm=0.425765
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.731736 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.449511747166342, 'psi': 0.2654773703336637}-{'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 2.4240384243137254, 'psi': 0.2654504593826426}
[S3] START round=12 head_norm_before_train=1.111549 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.196939 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6166366644463035, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0105140141828364, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.730639 (no previous merge yet)
[S4] round=12 local utility u=0.120929 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2597497380349736, 'psi': 0.3567939207526687}-{'f1_val': 0.33324879533350243, 'auprc': 0.33324879533350243, 'loss_val': 1.2897023680103594, 'psi': 0.33324879533350243}
[S5] START round=12 head_norm_before_train=1.381119 (no previous merge yet)
[S5] round=12 local utility u=0.068175 metrics={'f1_val': 0.9985916746367596, 'auprc': 0.9985916746367596, 'loss_val': 1.146588944923632, 'psi': 0.9985916746367596}-{'f1_val': 0.9868065537170307, 'auprc': 0.9868065537170307, 'loss_val': 1.1768722808722063, 'psi': 0.9868065537170307}
[S6] START round=12 head_norm_before_train=1.716340 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.818664390360247, 'psi': 0.017774699907663897}-{'f1_val': 0.0662375415282392, 'auprc': 0.0662375415282392, 'loss_val': 4.856555577204219, 'psi': 0.0662375415282392}
[S7] START round=12 head_norm_before_train=1.363128 (no previous merge yet)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3787349610042194, 'psi': 0.0}-{'f1_val': 0.00019918334827208445, 'auprc': 0.00019918334827208445, 'loss_val': 1.3663698026035287, 'psi': 0.00019918334827208445}
[S8] START round=12 head_norm_before_train=1.689725 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8268919612458846, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8137135850961192, 'psi': 0.35939447907390915}
[S9] START round=12 head_norm_before_train=1.496906 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.16029994340690437, 'auprc': 0.16029994340690437, 'loss_val': 1.5934549610283133, 'psi': 0.16029994340690437}-{'f1_val': 0.19428496007391274, 'auprc': 0.19428496007391274, 'loss_val': 1.4188966195064916, 'psi': 0.19428496007391274}
[S10] START round=12 head_norm_before_train=1.672796 (no previous merge yet)
[S10] round=12 local utility u=0.095886 metrics={'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.715499885522375, 'psi': 0.332855321861058}-{'f1_val': 0.3328550932568149, 'auprc': 0.3328550932568149, 'loss_val': 2.907268911631018, 'psi': 0.3328550932568149}
[S11] START round=12 head_norm_before_train=1.465967 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.063540 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8075495226507765, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9346286064131737, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.174091 cos_to_last_merge=0.9975 (last merge round=10)
[S13] round=12 local utility u=0.004565 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1417663766865365, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.150896445837442, 'psi': 0.3599362944611573}
[S14] START round=12 head_norm_before_train=1.500478 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.697954645885978, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.550491614356053, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.697409 (no previous merge yet)
[S15] round=12 local utility u=0.377594 metrics={'f1_val': 0.36072389310255026, 'auprc': 0.36072389310255026, 'loss_val': 0.8221443426987324, 'psi': 0.36072389310255026}-{'f1_val': 0.28038067349926793, 'auprc': 0.28038067349926793, 'loss_val': 0.854243441424601, 'psi': 0.28038067349926793}
[S16] START round=12 head_norm_before_train=1.522701 (no previous merge yet)
[S16] round=12 local utility u=0.007020 metrics={'f1_val': 0.027733333333333332, 'auprc': 0.027733333333333332, 'loss_val': 3.1429228663972304, 'psi': 0.027733333333333332}-{'f1_val': 0.010061668289516391, 'auprc': 0.010061668289516391, 'loss_val': 2.9979181585558163, 'psi': 0.010061668289516391}
[S17] START round=12 head_norm_before_train=1.593812 cos_to_last_merge=0.9935 (last merge round=9)
[S17] round=12 local utility u=0.211066 metrics={'f1_val': 0.20370676894079467, 'auprc': 0.20370676894079467, 'loss_val': 1.0893010852594784, 'psi': 0.20370676894079467}-{'f1_val': 0.15286870194812607, 'auprc': 0.15286870194812607, 'loss_val': 1.0538908619865934, 'psi': 0.15286870194812607}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33204
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:33216
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.028)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33212
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=-0.0137
[S16] DROPPED delta from S5 (cos=-0.0137 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S13
[S4] cosine check vs S13: cos=-0.0483
[S4] DROPPED delta from S13 (cos=-0.0483 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] cosine check vs S4: cos=-0.0446
[S10] DROPPED delta from S4 (cos=-0.0446 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1804) from S10
[S3] cosine check vs S10: cos=0.5569
[S11] RECEIVED delta(kind=head bytes=1799) from S15
[S11] cosine check vs S15: cos=0.9647
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.8260
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.0000 head_norm=1.134285
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.770348e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.160055 delta_norm=0.177035
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.0000 head_norm=1.498296
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.423279e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.598405 delta_norm=0.242328
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.763144 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 2.6411308936781803, 'psi': 0.2654504593826426}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.449511747166342, 'psi': 0.2654773703336637}
[S3] START round=13 head_norm_before_train=1.160055 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8316990502877888, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6166366644463035, 'psi': 0.0}
[S4] START round=13 head_norm_before_train=1.765809 (no previous merge yet)
[S4] round=13 local utility u=0.016750 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2262495101051503, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2597497380349736, 'psi': 0.3567939207526687}
[S5] START round=13 head_norm_before_train=1.411253 (no previous merge yet)
[S5] round=13 local utility u=0.014189 metrics={'f1_val': 0.9983098921706517, 'auprc': 0.9983098921706517, 'loss_val': 1.1156740235050986, 'psi': 0.9983098921706517}-{'f1_val': 0.9985916746367596, 'auprc': 0.9985916746367596, 'loss_val': 1.146588944923632, 'psi': 0.9985916746367596}
[S6] START round=13 head_norm_before_train=1.737954 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.258783624446371, 'psi': 0.0}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.818664390360247, 'psi': 0.017774699907663897}
[S7] START round=13 head_norm_before_train=1.381116 (no previous merge yet)
[S7] round=13 local utility u=0.001114 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3765078309419387, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3787349610042194, 'psi': 0.0}
[S8] START round=13 head_norm_before_train=1.734950 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8589143349002446, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8268919612458846, 'psi': 0.35939447907390915}
[S9] START round=13 head_norm_before_train=1.527291 (no previous merge yet)
[S9] round=13 local utility u=0.943906 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5809893360762046, 'psi': 0.36867172340800847}-{'f1_val': 0.16029994340690437, 'auprc': 0.16029994340690437, 'loss_val': 1.5934549610283133, 'psi': 0.16029994340690437}
[S10] START round=13 head_norm_before_train=1.714827 (no previous merge yet)
[S10] round=13 local utility u=0.191535 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.3317142456827122, 'psi': 0.3327757865392274}-{'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.715499885522375, 'psi': 0.332855321861058}
[S11] START round=13 head_norm_before_train=1.598405 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.012961 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7816272882300992, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8075495226507765, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.216727 cos_to_last_merge=0.9916 (last merge round=10)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1935454803594658, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1417663766865365, 'psi': 0.3599362944611573}
[S14] START round=13 head_norm_before_train=1.530561 (no previous merge yet)
[S14] round=13 local utility u=0.092622 metrics={'f1_val': 0.024154589371980676, 'auprc': 0.024154589371980676, 'loss_val': 4.730102431397828, 'psi': 0.024154589371980676}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.697954645885978, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.726950 (no previous merge yet)
[S15] round=13 local utility u=1.000000 metrics={'f1_val': 0.614174882874229, 'auprc': 0.614174882874229, 'loss_val': 0.8033350492227407, 'psi': 0.614174882874229}-{'f1_val': 0.36072389310255026, 'auprc': 0.36072389310255026, 'loss_val': 0.8221443426987324, 'psi': 0.36072389310255026}
[S16] START round=13 head_norm_before_train=1.548373 (no previous merge yet)
[S16] round=13 local utility u=0.155096 metrics={'f1_val': 0.07260726072607261, 'auprc': 0.07260726072607261, 'loss_val': 3.23659679076232, 'psi': 0.07260726072607261}-{'f1_val': 0.027733333333333332, 'auprc': 0.027733333333333332, 'loss_val': 3.1429228663972304, 'psi': 0.027733333333333332}
[S17] START round=13 head_norm_before_train=1.649600 cos_to_last_merge=0.9886 (last merge round=9)
[S17] round=13 local utility u=0.168284 metrics={'f1_val': 0.216988053010653, 'auprc': 0.216988053010653, 'loss_val': 0.8722641243467562, 'psi': 0.216988053010653}-{'f1_val': 0.20370676894079467, 'auprc': 0.20370676894079467, 'loss_val': 1.0893010852594784, 'psi': 0.20370676894079467}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:33216
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[S16] not sending this round → trigger blocked (psi=0.073)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33203
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S14] not sending this round → trigger blocked (psi=0.024)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=-0.0087
[S16] DROPPED delta from S5 (cos=-0.0087 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] cosine check vs S4: cos=-0.0465
[S10] DROPPED delta from S4 (cos=-0.0465 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] cosine check vs S10: cos=0.6472
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] cosine check vs S15: cos=0.9861
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.0592
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S17
[S3] cosine check vs S17: cos=0.7660
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.0000 head_norm=1.186058
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.237894e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.205675 delta_norm=0.123789
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.0000 head_norm=1.628185
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.553855e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.687940 delta_norm=0.155386
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.2170 head_norm=1.689121
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.113659e+00
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.2046 head_norm=1.181452 delta_norm=1.113659
[S17] aggregate: ROLLBACK (f1_val pre=0.217 post=0.205 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.787759 (no previous merge yet)
[S2] round=14 local utility u=0.040454 metrics={'f1_val': 0.24830058089234952, 'auprc': 0.24830058089234952, 'loss_val': 2.4058733618607926, 'psi': 0.24830058089234952}-{'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 2.6411308936781803, 'psi': 0.2654504593826426}
[S3] START round=14 head_norm_before_train=1.205675 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.030916 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.769867913337648, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8316990502877888, 'psi': 0.0}
[S4] START round=14 head_norm_before_train=1.796298 (no previous merge yet)
[S4] round=14 local utility u=0.020493 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1852644240472558, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2262495101051503, 'psi': 0.3567939207526687}
[S5] START round=14 head_norm_before_train=1.442852 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.6649974625618357, 'auprc': 0.6649974625618357, 'loss_val': 1.0897984306675663, 'psi': 0.6649974625618357}-{'f1_val': 0.9983098921706517, 'auprc': 0.9983098921706517, 'loss_val': 1.1156740235050986, 'psi': 0.9983098921706517}
[S6] START round=14 head_norm_before_train=1.754209 (no previous merge yet)
[S6] round=14 local utility u=0.073000 metrics={'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 6.264725333472516, 'psi': 0.016882516188714152}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.258783624446371, 'psi': 0.0}
[S7] START round=14 head_norm_before_train=1.400378 (no previous merge yet)
[S7] round=14 local utility u=0.010179 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3561488402181563, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3765078309419387, 'psi': 0.0}
[S8] START round=14 head_norm_before_train=1.775075 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9125017587303503, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8589143349002446, 'psi': 0.35939447907390915}
[S9] START round=14 head_norm_before_train=1.555314 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.21443012383118523, 'auprc': 0.21443012383118523, 'loss_val': 1.8938334096396223, 'psi': 0.2144301238311852}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5809893360762046, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.748331 (no previous merge yet)
[S10] round=14 local utility u=0.214384 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.9036638747989785, 'psi': 0.3328555502468546}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 2.3317142456827122, 'psi': 0.3327757865392274}
[S11] START round=14 head_norm_before_train=1.687940 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=1.000000 metrics={'f1_val': 0.31027881814398667, 'auprc': 0.31027881814398667, 'loss_val': 1.6840615267097543, 'psi': 0.31027881814398667}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7816272882300992, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.267236 cos_to_last_merge=0.9839 (last merge round=10)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.26882362144925, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1935454803594658, 'psi': 0.3599362944611573}
[S14] START round=14 head_norm_before_train=1.559469 (no previous merge yet)
[S14] round=14 local utility u=0.436509 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 4.859460170057114, 'psi': 0.1355297641332834}-{'f1_val': 0.024154589371980676, 'auprc': 0.024154589371980676, 'loss_val': 4.730102431397828, 'psi': 0.024154589371980676}
[S15] START round=14 head_norm_before_train=1.759428 (no previous merge yet)
[S15] round=14 local utility u=0.014151 metrics={'f1_val': 0.6137517881568725, 'auprc': 0.6137517881568725, 'loss_val': 0.7712247738251978, 'psi': 0.6137517881568725}-{'f1_val': 0.614174882874229, 'auprc': 0.614174882874229, 'loss_val': 0.8033350492227407, 'psi': 0.614174882874229}
[S16] START round=14 head_norm_before_train=1.576313 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.08476628723661904, 'auprc': 0.08476628723661904, 'loss_val': 3.4291967827521943, 'psi': 0.08476628723661904}-{'f1_val': 0.07260726072607261, 'auprc': 0.07260726072607261, 'loss_val': 3.23659679076232, 'psi': 0.07260726072607261}
[S17] START round=14 head_norm_before_train=1.181452 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.20480725182406687, 'auprc': 0.20480725182406687, 'loss_val': 1.0716245631724253, 'psi': 0.20480725182406687}-{'f1_val': 0.216988053010653, 'auprc': 0.216988053010653, 'loss_val': 0.8722641243467562, 'psi': 0.216988053010653}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33203
[S6] not sending this round → trigger blocked (psi=0.017)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:33213
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:33211
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=0.0068
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] cosine check vs S4: cos=-0.0487
[S10] DROPPED delta from S4 (cos=-0.0487 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] cosine check vs S10: cos=0.6866
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=0.9928
[S13] RECEIVED delta(kind=head bytes=1804) from S2
[S13] cosine check vs S2: cos=0.6456
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.0000 head_norm=1.237033
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.480284e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.390722 delta_norm=0.648028
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.3599 head_norm=1.315057
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.483068e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.3599 head_norm=1.093458 delta_norm=0.648307
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.3103 head_norm=1.715330
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.120243e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.3157 head_norm=1.750523 delta_norm=0.112024
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.808258 (no previous merge yet)
[S2] round=15 local utility u=0.029491 metrics={'f1_val': 0.26484740623558106, 'auprc': 0.26484740623558106, 'loss_val': 2.495812136212883, 'psi': 0.26484740623558106}-{'f1_val': 0.24830058089234952, 'auprc': 0.24830058089234952, 'loss_val': 2.4058733618607926, 'psi': 0.24830058089234952}
[S3] START round=15 head_norm_before_train=1.390722 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.870812170263624, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.769867913337648, 'psi': 0.0}
[S4] START round=15 head_norm_before_train=1.825851 (no previous merge yet)
[S4] round=15 local utility u=0.009999 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1652661172959882, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1852644240472558, 'psi': 0.3567939207526687}
[S5] START round=15 head_norm_before_train=1.475029 (no previous merge yet)
[S5] round=15 local utility u=0.006628 metrics={'f1_val': 0.664120517716953, 'auprc': 0.664120517716953, 'loss_val': 1.0686502451483897, 'psi': 0.664120517716953}-{'f1_val': 0.6649974625618357, 'auprc': 0.6649974625618357, 'loss_val': 1.0897984306675663, 'psi': 0.6649974625618357}
[S6] START round=15 head_norm_before_train=1.765910 (no previous merge yet)
[S6] round=15 local utility u=0.728871 metrics={'f1_val': 0.10148798168637925, 'auprc': 0.10148798168637925, 'loss_val': 5.5684322237265205, 'psi': 0.10148798168637925}-{'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 6.264725333472516, 'psi': 0.016882516188714152}
[S7] START round=15 head_norm_before_train=1.420426 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3741089762430185, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3561488402181563, 'psi': 0.0}
[S8] START round=15 head_norm_before_train=1.813992 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.985540001003018, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9125017587303503, 'psi': 0.35939447907390915}
[S9] START round=15 head_norm_before_train=1.582418 (no previous merge yet)
[S9] round=15 local utility u=0.078958 metrics={'f1_val': 0.24067130869487594, 'auprc': 0.24067130869487594, 'loss_val': 1.9720885318288366, 'psi': 0.24067130869487596}-{'f1_val': 0.21443012383118523, 'auprc': 0.21443012383118523, 'loss_val': 1.8938334096396223, 'psi': 0.2144301238311852}
[S10] START round=15 head_norm_before_train=1.782651 (no previous merge yet)
[S10] round=15 local utility u=0.091679 metrics={'f1_val': 0.30615981835494027, 'auprc': 0.30615981835494027, 'loss_val': 1.480045068732266, 'psi': 0.30615981835494027}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.9036638747989785, 'psi': 0.3328555502468546}
[S11] START round=15 head_norm_before_train=1.750523 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.086921 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 1.7072190710012272, 'psi': 0.33216756042589574}-{'f1_val': 0.31027881814398667, 'auprc': 0.31027881814398667, 'loss_val': 1.6840615267097543, 'psi': 0.31027881814398667}
[S13] START round=15 head_norm_before_train=1.093458 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.061662 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1455003983372185, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.26882362144925, 'psi': 0.3599362944611573}
[S14] START round=15 head_norm_before_train=1.590766 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.11891891891891893, 'auprc': 0.11891891891891893, 'loss_val': 5.227220764944049, 'psi': 0.11891891891891893}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 4.859460170057114, 'psi': 0.1355297641332834}
[S15] START round=15 head_norm_before_train=1.792038 (no previous merge yet)
[S15] round=15 local utility u=0.039097 metrics={'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.7036961868140608, 'psi': 0.6149367764291455}-{'f1_val': 0.6137517881568725, 'auprc': 0.6137517881568725, 'loss_val': 0.7712247738251978, 'psi': 0.6137517881568725}
[S16] START round=15 head_norm_before_train=1.602549 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.09018949388342529, 'auprc': 0.09018949388342529, 'loss_val': 3.5432791621660145, 'psi': 0.09018949388342529}-{'f1_val': 0.08476628723661904, 'auprc': 0.08476628723661904, 'loss_val': 3.4291967827521943, 'psi': 0.08476628723661904}
[S17] START round=15 head_norm_before_train=1.224052 cos_to_last_merge=0.9985 (last merge round=13)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.20444073104100421, 'auprc': 0.20444073104100421, 'loss_val': 1.10327265769883, 'psi': 0.20444073104100421}-{'f1_val': 0.20480725182406687, 'auprc': 0.20480725182406687, 'loss_val': 1.0716245631724253, 'psi': 0.20480725182406687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:33204
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.101)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=0.3635
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] cosine check vs S13: cos=-0.0241
[S4] DROPPED delta from S13 (cos=-0.0241 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] cosine check vs S4: cos=-0.0501
[S10] DROPPED delta from S4 (cos=-0.0501 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.9378
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] cosine check vs S2: cos=0.7648
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] cosine check vs S15: cos=0.9950
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.6447
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0026
[S16] DROPPED delta from S5 (cos=-0.0026 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.226 → S11@127.0.0.1:33212
[S14] ⇄ pheromone p=0.118 → S15@127.0.0.1:33215
[S8] ⇄ pheromone p=0.152 → S17@127.0.0.1:33217
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.0000 head_norm=1.418342
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.507183e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.598916 delta_norm=0.350718
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.094 → S9@127.0.0.1:33210
[S7] ⇄ pheromone p=0.051 → S14@127.0.0.1:33214
[S2] ⇄ pheromone p=0.122 → S13@127.0.0.1:33213
[S4] ⇄ pheromone p=0.149 → S10@127.0.0.1:33211
[S10] ⇄ pheromone p=0.195 → S3@127.0.0.1:33203
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.3322 head_norm=1.776651
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.413788e-02
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.3322 head_norm=1.801963 delta_norm=0.094138
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.238 → S13@127.0.0.1:33213
[S5] ⇄ pheromone p=0.237 → S16@127.0.0.1:33216
[S9] ⇄ pheromone p=0.276 → S17@127.0.0.1:33217
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.3599 head_norm=1.142856
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.673168e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.3599 head_norm=1.141077 delta_norm=0.367317
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.108 → S4@127.0.0.1:33204
[S15] ⇄ pheromone p=0.265 → S11@127.0.0.1:33212
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.2044 head_norm=1.289675
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.271474e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.2041 head_norm=1.315006 delta_norm=0.627147
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.140 → S3@127.0.0.1:33203
[S16] ⇄ pheromone p=0.064 → S17@127.0.0.1:33217
[S2] START round=16 head_norm_before_train=1.826316 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.690126827832005, 'psi': 0.2654773703336637}-{'f1_val': 0.26484740623558106, 'auprc': 0.26484740623558106, 'loss_val': 2.495812136212883, 'psi': 0.26484740623558106}
[S3] START round=16 head_norm_before_train=1.598916 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.026113 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8185863936676763, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.870812170263624, 'psi': 0.0}
[S4] START round=16 head_norm_before_train=1.860922 (no previous merge yet)
[S4] round=16 local utility u=0.004559 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.156147529382217, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1652661172959882, 'psi': 0.3567939207526687}
[S5] START round=16 head_norm_before_train=1.506133 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.33501365259399285, 'auprc': 0.33501365259399285, 'loss_val': 1.1136995913721932, 'psi': 0.33501365259399285}-{'f1_val': 0.664120517716953, 'auprc': 0.664120517716953, 'loss_val': 1.0686502451483897, 'psi': 0.664120517716953}
[S6] START round=16 head_norm_before_train=1.776129 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.439254981306614, 'psi': 0.017105871474803514}-{'f1_val': 0.10148798168637925, 'auprc': 0.10148798168637925, 'loss_val': 5.5684322237265205, 'psi': 0.10148798168637925}
[S7] START round=16 head_norm_before_train=1.441429 (no previous merge yet)
[S7] round=16 local utility u=0.804911 metrics={'f1_val': 0.17347564715985767, 'auprc': 0.17347564715985767, 'loss_val': 1.3255684895005628, 'psi': 0.17347564715985767}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3741089762430185, 'psi': 0.0}
[S8] START round=16 head_norm_before_train=1.841508 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0944073762145283, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.985540001003018, 'psi': 0.35939447907390915}
[S9] START round=16 head_norm_before_train=1.606813 (no previous merge yet)
[S9] round=16 local utility u=0.571377 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9813374538072903, 'psi': 0.36867172340800847}-{'f1_val': 0.24067130869487594, 'auprc': 0.24067130869487594, 'loss_val': 1.9720885318288366, 'psi': 0.24067130869487596}
[S10] START round=16 head_norm_before_train=1.829583 (no previous merge yet)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.27049763799909404, 'auprc': 0.27049763799909404, 'loss_val': 1.3791204299650868, 'psi': 0.27049763799909404}-{'f1_val': 0.30615981835494027, 'auprc': 0.30615981835494027, 'loss_val': 1.480045068732266, 'psi': 0.30615981835494027}
[S11] START round=16 head_norm_before_train=1.801963 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.005638 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.6938596540411723, 'psi': 0.3319360347772085}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 1.7072190710012272, 'psi': 0.33216756042589574}
[S13] START round=16 head_norm_before_train=1.141077 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.025779 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.093942876094726, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1455003983372185, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.621953 (no previous merge yet)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.1278642866185593, 'auprc': 0.1278642866185593, 'loss_val': 5.437567082931625, 'psi': 0.1278642866185593}-{'f1_val': 0.11891891891891893, 'auprc': 0.11891891891891893, 'loss_val': 5.227220764944049, 'psi': 0.11891891891891893}
[S15] START round=16 head_norm_before_train=1.831768 (no previous merge yet)
[S15] round=16 local utility u=0.017512 metrics={'f1_val': 0.6147964639178166, 'auprc': 0.6147964639178166, 'loss_val': 0.6674097657044944, 'psi': 0.6147964639178166}-{'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.7036961868140608, 'psi': 0.6149367764291455}
[S16] START round=16 head_norm_before_train=1.626990 (no previous merge yet)
[S16] round=16 local utility u=0.184265 metrics={'f1_val': 0.12446448703494926, 'auprc': 0.12446448703494926, 'loss_val': 3.4832249853990462, 'psi': 0.12446448703494926}-{'f1_val': 0.09018949388342529, 'auprc': 0.09018949388342529, 'loss_val': 3.5432791621660145, 'psi': 0.09018949388342529}
[S17] START round=16 head_norm_before_train=1.315006 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.239924 metrics={'f1_val': 0.25794821424190034, 'auprc': 0.25794821424190034, 'loss_val': 1.104991719058832, 'psi': 0.25794821424190034}-{'f1_val': 0.20444073104100421, 'auprc': 0.20444073104100421, 'loss_val': 1.10327265769883, 'psi': 0.20444073104100421}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:33212
[S7] not sending this round → trigger blocked (psi=0.173)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:33211
[S16] not sending this round → trigger blocked (psi=0.124)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:33217
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33204
[S3] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=0.5316
[S10] RECEIVED delta(kind=head bytes=1804) from S4
[S10] cosine check vs S4: cos=-0.0519
[S10] DROPPED delta from S4 (cos=-0.0519 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S13
[S4] cosine check vs S13: cos=-0.0054
[S4] DROPPED delta from S13 (cos=-0.0054 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S9
[S17] cosine check vs S9: cos=0.8952
[S11] RECEIVED delta(kind=head bytes=1798) from S15
[S11] cosine check vs S15: cos=0.9963
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.1599
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.0000 head_norm=1.624977
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.739367e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.1409 head_norm=1.141536 delta_norm=0.973937
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.3319 head_norm=1.824877
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.349343e-02
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.3319 head_norm=1.847934 delta_norm=0.083493
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.3599 head_norm=1.189354
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.805775e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.3599 head_norm=1.327806 delta_norm=0.780578
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.2579 head_norm=1.364830
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.660283e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.2596 head_norm=1.457421 delta_norm=0.366028
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.842765 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.2535595067783909, 'auprc': 0.2535595067783909, 'loss_val': 2.9626925497952037, 'psi': 0.2535595067783909}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.690126827832005, 'psi': 0.2654773703336637}
[S3] START round=17 head_norm_before_train=1.141536 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8844390718728243, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8185863936676763, 'psi': 0.0}
[S4] START round=17 head_norm_before_train=1.897190 (no previous merge yet)
[S4] round=17 local utility u=0.004987 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.146173591210108, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.156147529382217, 'psi': 0.3567939207526687}
[S5] START round=17 head_norm_before_train=1.539696 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.2592303314875497, 'psi': 0.33451196111837667}-{'f1_val': 0.33501365259399285, 'auprc': 0.33501365259399285, 'loss_val': 1.1136995913721932, 'psi': 0.33501365259399285}
[S6] START round=17 head_norm_before_train=1.787885 (no previous merge yet)
[S6] round=17 local utility u=0.271469 metrics={'f1_val': 0.03287119856887299, 'auprc': 0.03287119856887299, 'loss_val': 6.038205910211555, 'psi': 0.03287119856887299}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.439254981306614, 'psi': 0.017105871474803514}
[S7] START round=17 head_norm_before_train=1.459135 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.15744790326730126, 'auprc': 0.15744790326730126, 'loss_val': 1.3197555952813527, 'psi': 0.15744790326730126}-{'f1_val': 0.17347564715985767, 'auprc': 0.17347564715985767, 'loss_val': 1.3255684895005628, 'psi': 0.17347564715985767}
[S8] START round=17 head_norm_before_train=1.864477 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.193789576129107, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0944073762145283, 'psi': 0.35939447907390915}
[S9] START round=17 head_norm_before_train=1.628909 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1221820426112554, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9813374538072903, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.885664 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.2610216060946672, 'auprc': 0.2610216060946672, 'loss_val': 1.4179711115919185, 'psi': 0.2610216060946672}-{'f1_val': 0.27049763799909404, 'auprc': 0.27049763799909404, 'loss_val': 1.3791204299650868, 'psi': 0.27049763799909404}
[S11] START round=17 head_norm_before_train=1.847934 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.7675770716587147, 'psi': 0.3320133550741517}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.6938596540411723, 'psi': 0.3319360347772085}
[S13] START round=17 head_norm_before_train=1.327806 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1405430795352625, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.093942876094726, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=1.651819 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.13493253373313344, 'auprc': 0.13493253373313344, 'loss_val': 5.581571210310486, 'psi': 0.13493253373313344}-{'f1_val': 0.1278642866185593, 'auprc': 0.1278642866185593, 'loss_val': 5.437567082931625, 'psi': 0.1278642866185593}
[S15] START round=17 head_norm_before_train=1.874430 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6132462444361879, 'auprc': 0.6132462444361879, 'loss_val': 0.6589467431130465, 'psi': 0.6132462444361879}-{'f1_val': 0.6147964639178166, 'auprc': 0.6147964639178166, 'loss_val': 0.6674097657044944, 'psi': 0.6147964639178166}
[S16] START round=17 head_norm_before_train=1.651203 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.08979591836734695, 'auprc': 0.08979591836734695, 'loss_val': 4.042668212741389, 'psi': 0.08979591836734695}-{'f1_val': 0.12446448703494926, 'auprc': 0.12446448703494926, 'loss_val': 3.4832249853990462, 'psi': 0.12446448703494926}
[S17] START round=17 head_norm_before_train=1.457421 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.2569801675058428, 'auprc': 0.2569801675058428, 'loss_val': 1.1260732897180532, 'psi': 0.2569801675058428}-{'f1_val': 0.25794821424190034, 'auprc': 0.25794821424190034, 'loss_val': 1.104991719058832, 'psi': 0.25794821424190034}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.033)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:33211
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1806 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1806) from S4
[S10] cosine check vs S4: cos=-0.0549
[S10] DROPPED delta from S4 (cos=-0.0549 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=18 head_norm_before_train=1.857401 (no previous merge yet)
[S2] round=18 local utility u=0.100426 metrics={'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 2.8688589001117357, 'psi': 0.2654504593826426}-{'f1_val': 0.2535595067783909, 'auprc': 0.2535595067783909, 'loss_val': 2.9626925497952037, 'psi': 0.2535595067783909}
[S3] START round=18 head_norm_before_train=1.174984 cos_to_last_merge=0.9980 (last merge round=16)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.026587665921212, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8844390718728243, 'psi': 0.0}
[S4] START round=18 head_norm_before_train=1.915019 (no previous merge yet)
[S4] round=18 local utility u=0.000033 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1461083389276996, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.146173591210108, 'psi': 0.3567939207526687}
[S5] START round=18 head_norm_before_train=1.572078 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.102505874358141, 'psi': 0.33409214683912186}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.2592303314875497, 'psi': 0.33451196111837667}
[S6] START round=18 head_norm_before_train=1.801603 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 6.397280405202469, 'psi': 0.025227272727272727}-{'f1_val': 0.03287119856887299, 'auprc': 0.03287119856887299, 'loss_val': 6.038205910211555, 'psi': 0.03287119856887299}
[S7] START round=18 head_norm_before_train=1.478274 (no previous merge yet)
[S7] round=18 local utility u=0.089797 metrics={'f1_val': 0.17477997799779976, 'auprc': 0.17477997799779976, 'loss_val': 1.2961507201822868, 'psi': 0.17477997799779976}-{'f1_val': 0.15744790326730126, 'auprc': 0.15744790326730126, 'loss_val': 1.3197555952813527, 'psi': 0.15744790326730126}
[S8] START round=18 head_norm_before_train=1.891536 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.291077344320559, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.193789576129107, 'psi': 0.35939447907390915}
[S9] START round=18 head_norm_before_train=1.649329 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2444491468356094, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1221820426112554, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.938975 (no previous merge yet)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.24858757062146894, 'auprc': 0.24858757062146894, 'loss_val': 1.483997181432076, 'psi': 0.24858757062146894}-{'f1_val': 0.2610216060946672, 'auprc': 0.2610216060946672, 'loss_val': 1.4179711115919185, 'psi': 0.2610216060946672}
[S11] START round=18 head_norm_before_train=1.864974 cos_to_last_merge=0.9998 (last merge round=16)
[S11] round=18 local utility u=0.034029 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 1.6282175474074323, 'psi': 0.3240909090909091}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.7675770716587147, 'psi': 0.3320133550741517}
[S13] START round=18 head_norm_before_train=1.364367 cos_to_last_merge=0.9943 (last merge round=16)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1568710466377587, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1405430795352625, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.679685 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.701374661328915, 'psi': 0.13582554517133957}-{'f1_val': 0.13493253373313344, 'auprc': 0.13493253373313344, 'loss_val': 5.581571210310486, 'psi': 0.13493253373313344}
[S15] START round=18 head_norm_before_train=1.911782 (no previous merge yet)
[S15] round=18 local utility u=0.012177 metrics={'f1_val': 0.6132462444361879, 'auprc': 0.6132462444361879, 'loss_val': 0.6345934692530976, 'psi': 0.6132462444361879}-{'f1_val': 0.6132462444361879, 'auprc': 0.6132462444361879, 'loss_val': 0.6589467431130465, 'psi': 0.6132462444361879}
[S16] START round=18 head_norm_before_train=1.673856 (no previous merge yet)
[S16] round=18 local utility u=0.463203 metrics={'f1_val': 0.13886450102429032, 'auprc': 0.13886450102429032, 'loss_val': 3.5578796605082674, 'psi': 0.13886450102429032}-{'f1_val': 0.08979591836734695, 'auprc': 0.08979591836734695, 'loss_val': 4.042668212741389, 'psi': 0.08979591836734695}
[S17] START round=18 head_norm_before_train=1.510990 cos_to_last_merge=0.9917 (last merge round=16)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.21026858820126107, 'auprc': 0.21026858820126107, 'loss_val': 1.1943881123911382, 'psi': 0.21026858820126107}-{'f1_val': 0.2569801675058428, 'auprc': 0.2569801675058428, 'loss_val': 1.1260732897180532, 'psi': 0.2569801675058428}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.175)
[S16] not sending this round → trigger blocked (psi=0.139)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=-0.0575
[S10] DROPPED delta from S4 (cos=-0.0575 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=0.9955
[S13] RECEIVED delta(kind=head bytes=1798) from S2
[S13] cosine check vs S2: cos=0.3328
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=0.8727
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.3599 head_norm=1.405404
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.466085e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.3599 head_norm=1.308658 delta_norm=0.346608
[S13] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.3241 head_norm=1.883985
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.583600e-02
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.3242 head_norm=1.911595 delta_norm=0.095836
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.869177 (no previous merge yet)
[S2] round=19 local utility u=0.072755 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.7226444386423303, 'psi': 0.26537216828478966}-{'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 2.8688589001117357, 'psi': 0.2654504593826426}
[S3] START round=19 head_norm_before_train=1.210394 cos_to_last_merge=0.9937 (last merge round=16)
[S3] round=19 local utility u=0.803988 metrics={'f1_val': 0.18857617860111628, 'auprc': 0.18857617860111628, 'loss_val': 2.1157967479871993, 'psi': 0.18857617860111628}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.026587665921212, 'psi': 0.0}
[S4] START round=19 head_norm_before_train=1.935060 (no previous merge yet)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1482528901149343, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1461083389276996, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.602224 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.204476295036962, 'psi': 0.33358943696313936}-{'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.102505874358141, 'psi': 0.33409214683912186}
[S6] START round=19 head_norm_before_train=1.816459 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.024145785876993165, 'auprc': 0.024145785876993165, 'loss_val': 6.680611213829037, 'psi': 0.024145785876993165}-{'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 6.397280405202469, 'psi': 0.025227272727272727}
[S7] START round=19 head_norm_before_train=1.499823 (no previous merge yet)
[S7] round=19 local utility u=0.321778 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.2367822970306341, 'psi': 0.23968964488212474}-{'f1_val': 0.17477997799779976, 'auprc': 0.17477997799779976, 'loss_val': 1.2961507201822868, 'psi': 0.17477997799779976}
[S8] START round=19 head_norm_before_train=1.918730 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.375717530327957, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.291077344320559, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.667890 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.332159345562464, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2444491468356094, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.983612 (no previous merge yet)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.2417722251142345, 'auprc': 0.2417722251142345, 'loss_val': 1.5932735542394003, 'psi': 0.2417722251142345}-{'f1_val': 0.24858757062146894, 'auprc': 0.24858757062146894, 'loss_val': 1.483997181432076, 'psi': 0.24858757062146894}
[S11] START round=19 head_norm_before_train=1.911595 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.3315508021390374, 'auprc': 0.3315508021390374, 'loss_val': 1.7151969737436086, 'psi': 0.3315508021390374}-{'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 1.6282175474074323, 'psi': 0.3240909090909091}
[S13] START round=19 head_norm_before_train=1.308658 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.020955 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1149610957958678, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1568710466377587, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.703755 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.838862264525164, 'psi': 0.13572854291417166}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.701374661328915, 'psi': 0.13582554517133957}
[S15] START round=19 head_norm_before_train=1.943544 (no previous merge yet)
[S15] round=19 local utility u=0.018618 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6138347980576002, 'psi': 0.6150769866718802}-{'f1_val': 0.6132462444361879, 'auprc': 0.6132462444361879, 'loss_val': 0.6345934692530976, 'psi': 0.6132462444361879}
[S16] START round=19 head_norm_before_train=1.694374 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.033315705975674244, 'auprc': 0.033315705975674244, 'loss_val': 4.672934954585067, 'psi': 0.033315705975674244}-{'f1_val': 0.13886450102429032, 'auprc': 0.13886450102429032, 'loss_val': 3.5578796605082674, 'psi': 0.13886450102429032}
[S17] START round=19 head_norm_before_train=1.587307 cos_to_last_merge=0.9734 (last merge round=16)
[S17] round=19 local utility u=0.375467 metrics={'f1_val': 0.2829222359896753, 'auprc': 0.2829222359896753, 'loss_val': 1.0973364150849743, 'psi': 0.2829222359896753}-{'f1_val': 0.21026858820126107, 'auprc': 0.21026858820126107, 'loss_val': 1.1943881123911382, 'psi': 0.21026858820126107}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:33214
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.189)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:33204
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S2
[S13] cosine check vs S2: cos=0.5220
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.0211
[S4] RECEIVED delta(kind=head bytes=1807) from S13
[S4] cosine check vs S13: cos=0.0238
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=0.9976
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.6750
[S10] r=20 psi=0.242 u=0.0000 p_local=0.0800 f1=0.242 auprc=0.242 bytes=12610
[S9] r=20 psi=0.369 u=0.0000 p_local=0.1716 f1=0.369 auprc=0.369 bytes=5392
[S8] r=20 psi=0.359 u=0.0000 p_local=0.0621 f1=0.359 auprc=0.359 bytes=7198
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.3316 head_norm=1.929359
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.178273e-02
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.3316 head_norm=1.952274 delta_norm=0.071783
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.332 u=0.0000 p_local=0.1035 f1=0.332 auprc=0.332 bytes=7194
[S6] r=20 psi=0.024 u=0.0000 p_local=0.1272 f1=0.024 auprc=0.024 bytes=0
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.1357 head_norm=1.724498
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.136186e+00
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.1357 head_norm=1.160206 delta_norm=1.136186
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.136 u=0.0000 p_local=0.0484 f1=0.136 auprc=0.136 bytes=0
[S5] r=20 psi=0.334 u=0.0000 p_local=0.0973 f1=0.334 auprc=0.334 bytes=10794
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.3568 head_norm=1.955947
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.173999e+00
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.3568 head_norm=1.200367 delta_norm=1.173999
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.357 u=0.0000 p_local=0.0620 f1=0.357 auprc=0.357 bytes=16211
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.1886 head_norm=1.244976
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.122766e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.2980 head_norm=1.327222 delta_norm=0.612277
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.189 u=0.8040 p_local=0.2020 f1=0.189 auprc=0.189 bytes=0
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.3599 head_norm=1.346322
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.225622e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.3599 head_norm=1.413630 delta_norm=0.822562
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.360 u=0.0210 p_local=0.0512 f1=0.360 auprc=0.360 bytes=12603
[S15] r=20 psi=0.615 u=0.0186 p_local=0.1159 f1=0.615 auprc=0.615 bytes=17991
[S7] r=20 psi=0.240 u=0.3218 p_local=0.1820 f1=0.240 auprc=0.240 bytes=1801
[S2] r=20 psi=0.265 u=0.0728 p_local=0.0804 f1=0.265 auprc=0.265 bytes=9001
[S16] r=20 psi=0.033 u=0.0000 p_local=0.1192 f1=0.033 auprc=0.033 bytes=0
[S17] r=20 psi=0.283 u=0.3755 p_local=0.1569 f1=0.283 auprc=0.283 bytes=12598
[S2] START round=20 head_norm_before_train=1.880781 (no previous merge yet)
[S2] round=20 local utility u=0.510600 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6203934569180642, 'psi': 0.3674775928297055}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.7226444386423303, 'psi': 0.26537216828478966}
[S3] START round=20 head_norm_before_train=1.327222 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.755343 metrics={'f1_val': 0.28157175877285145, 'auprc': 0.28157175877285145, 'loss_val': 1.4420701322745553, 'psi': 0.28157175877285145}-{'f1_val': 0.18857617860111628, 'auprc': 0.18857617860111628, 'loss_val': 2.1157967479871993, 'psi': 0.18857617860111628}
[S4] START round=20 head_norm_before_train=1.200367 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1588276414024852, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1482528901149343, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.627568 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.613511480530427, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.204476295036962, 'psi': 0.33358943696313936}
[S6] START round=20 head_norm_before_train=1.831221 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.9907944107474576, 'psi': 0.017551963048498844}-{'f1_val': 0.024145785876993165, 'auprc': 0.024145785876993165, 'loss_val': 6.680611213829037, 'psi': 0.024145785876993165}
[S7] START round=20 head_norm_before_train=1.516609 (no previous merge yet)
[S7] round=20 local utility u=0.012720 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.2113425928169712, 'psi': 0.23968964488212474}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.2367822970306341, 'psi': 0.23968964488212474}
[S8] START round=20 head_norm_before_train=1.937287 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4538097711394677, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.375717530327957, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.683620 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4030809327322658, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.332159345562464, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=2.020769 (no previous merge yet)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.2417722251142345, 'auprc': 0.2417722251142345, 'loss_val': 1.6791632992458372, 'psi': 0.2417722251142345}-{'f1_val': 0.2417722251142345, 'auprc': 0.2417722251142345, 'loss_val': 1.5932735542394003, 'psi': 0.2417722251142345}
[S11] START round=20 head_norm_before_train=1.952274 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 1.81642496369483, 'psi': 0.33162711338607104}-{'f1_val': 0.3315508021390374, 'auprc': 0.3315508021390374, 'loss_val': 1.7151969737436086, 'psi': 0.3315508021390374}
[S13] START round=20 head_norm_before_train=1.413630 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.012118 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0907249183252996, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1149610957958678, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.160206 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=1.000000 metrics={'f1_val': 0.13030875866414618, 'auprc': 0.13030875866414618, 'loss_val': 3.600769028864605, 'psi': 0.13030875866414618}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.838862264525164, 'psi': 0.13572854291417166}
[S15] START round=20 head_norm_before_train=1.977531 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6126794275120121, 'auprc': 0.6126794275120121, 'loss_val': 0.6286326076192397, 'psi': 0.6126794275120121}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6138347980576002, 'psi': 0.6150769866718802}
[S16] START round=20 head_norm_before_train=1.712264 (no previous merge yet)
[S16] round=20 local utility u=0.844621 metrics={'f1_val': 0.13134461264470168, 'auprc': 0.13134461264470168, 'loss_val': 3.865953755565712, 'psi': 0.13134461264470168}-{'f1_val': 0.033315705975674244, 'auprc': 0.033315705975674244, 'loss_val': 4.672934954585067, 'psi': 0.033315705975674244}
[S17] START round=20 head_norm_before_train=1.650102 cos_to_last_merge=0.9597 (last merge round=16)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.27586123241582117, 'auprc': 0.27586123241582117, 'loss_val': 1.204365443780625, 'psi': 0.27586123241582117}-{'f1_val': 0.2829222359896753, 'auprc': 0.2829222359896753, 'loss_val': 1.0973364150849743, 'psi': 0.2829222359896753}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:33204
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:33214
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[S14] not sending this round → trigger blocked (psi=0.130)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:33210
[S16] not sending this round → trigger blocked (psi=0.131)
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=0.7987
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=0.6395
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] cosine check vs S2: cos=0.9015
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] cosine check vs S13: cos=0.4330
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.1303 head_norm=1.197664
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.990505e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.1254 head_norm=1.237952 delta_norm=0.599051
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.239 → S15@127.0.0.1:33215
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.3568 head_norm=1.247943
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.244664e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.3568 head_norm=1.144676 delta_norm=0.724466
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.050 → S10@127.0.0.1:33211
[S10] ⇄ pheromone p=0.064 → S3@127.0.0.1:33203
[S6] ⇄ pheromone p=0.102 → S11@127.0.0.1:33212
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.3687 head_norm=1.698093
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.109094e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.3687 head_norm=1.449702 delta_norm=0.510909
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.137 → S17@127.0.0.1:33217
[S8] ⇄ pheromone p=0.050 → S17@127.0.0.1:33217
[S15] ⇄ pheromone p=0.093 → S11@127.0.0.1:33212
[S5] ⇄ pheromone p=0.078 → S16@127.0.0.1:33216
[S11] ⇄ pheromone p=0.083 → S13@127.0.0.1:33213
[S2] ⇄ pheromone p=0.166 → S13@127.0.0.1:33213
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.3599 head_norm=1.453584
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.285977e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.3599 head_norm=1.632039 delta_norm=0.428598
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.043 → S4@127.0.0.1:33204
[S3] ⇄ pheromone p=0.313 → S9@127.0.0.1:33210
[S7] ⇄ pheromone p=0.148 → S14@127.0.0.1:33214
[S17] ⇄ pheromone p=0.126 → S3@127.0.0.1:33203
[S16] ⇄ pheromone p=0.264 → S17@127.0.0.1:33217
[S2] START round=21 head_norm_before_train=1.892508 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.2622666666666667, 'auprc': 0.2622666666666667, 'loss_val': 2.9730837407246313, 'psi': 0.2622666666666667}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6203934569180642, 'psi': 0.3674775928297055}
[S3] START round=21 head_norm_before_train=1.357132 cos_to_last_merge=0.9991 (last merge round=19)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.2909904868494684, 'auprc': 0.2909904868494684, 'loss_val': 1.874919431992528, 'psi': 0.2909904868494684}-{'f1_val': 0.28157175877285145, 'auprc': 0.28157175877285145, 'loss_val': 1.4420701322745553, 'psi': 0.28157175877285145}
[S4] START round=21 head_norm_before_train=1.144676 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2216195933226894, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1588276414024852, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.651223 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.812703900087357, 'psi': 0.33308623671855697}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.613511480530427, 'psi': 0.33358943696313936}
[S6] START round=21 head_norm_before_train=1.845416 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 7.197378758972073, 'psi': 0.016882516188714152}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.9907944107474576, 'psi': 0.017551963048498844}
[S7] START round=21 head_norm_before_train=1.532441 (no previous merge yet)
[S7] round=21 local utility u=0.556698 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1786139478530178, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.2113425928169712, 'psi': 0.23968964488212474}
[S8] START round=21 head_norm_before_train=1.950422 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5247573737027473, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4538097711394677, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.449702 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.2448883389311178, 'auprc': 0.2448883389311178, 'loss_val': 2.0407057971091307, 'psi': 0.2448883389311178}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4030809327322658, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=2.054416 (no previous merge yet)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.2417722251142345, 'auprc': 0.2417722251142345, 'loss_val': 1.7761876591595875, 'psi': 0.2417722251142345}-{'f1_val': 0.2417722251142345, 'auprc': 0.2417722251142345, 'loss_val': 1.6791632992458372, 'psi': 0.2417722251142345}
[S11] START round=21 head_norm_before_train=1.971229 cos_to_last_merge=0.9998 (last merge round=19)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 1.821152916244198, 'psi': 0.33154997286190585}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 1.81642496369483, 'psi': 0.33162711338607104}
[S13] START round=21 head_norm_before_train=1.632039 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0993002923112605, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0907249183252996, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.237952 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.338647 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 2.957902967481189, 'psi': 0.13413413413413414}-{'f1_val': 0.13030875866414618, 'auprc': 0.13030875866414618, 'loss_val': 3.600769028864605, 'psi': 0.13030875866414618}
[S15] START round=21 head_norm_before_train=2.010235 (no previous merge yet)
[S15] round=21 local utility u=0.017626 metrics={'f1_val': 0.6138114033949549, 'auprc': 0.6138114033949549, 'loss_val': 0.6035683720857999, 'psi': 0.6138114033949549}-{'f1_val': 0.6126794275120121, 'auprc': 0.6126794275120121, 'loss_val': 0.6286326076192397, 'psi': 0.6126794275120121}
[S16] START round=21 head_norm_before_train=1.727597 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.1352486187845304, 'auprc': 0.1352486187845304, 'loss_val': 3.938635717803386, 'psi': 0.1352486187845304}-{'f1_val': 0.13134461264470168, 'auprc': 0.13134461264470168, 'loss_val': 3.865953755565712, 'psi': 0.13134461264470168}
[S17] START round=21 head_norm_before_train=1.693208 cos_to_last_merge=0.9512 (last merge round=16)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.21271461714007153, 'auprc': 0.21271461714007153, 'loss_val': 1.4368918117814578, 'psi': 0.2127146171400715}-{'f1_val': 0.27586123241582117, 'auprc': 0.27586123241582117, 'loss_val': 1.204365443780625, 'psi': 0.27586123241582117}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:33214
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.134)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] cosine check vs S15: cos=0.9970
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.8974
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.1341 head_norm=1.262998
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.469204e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.0997 head_norm=1.368844 delta_norm=0.346920
[S14] aggregate: ROLLBACK (f1_val pre=0.134 post=0.100 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.3315 head_norm=1.991556
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.172920e-02
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.3315 head_norm=2.013165 delta_norm=0.081729
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.902954 (no previous merge yet)
[S2] round=22 local utility u=0.104052 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.7934033405507672, 'psi': 0.26542475888492534}-{'f1_val': 0.2622666666666667, 'auprc': 0.2622666666666667, 'loss_val': 2.9730837407246313, 'psi': 0.2622666666666667}
[S3] START round=22 head_norm_before_train=1.385820 cos_to_last_merge=0.9970 (last merge round=19)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.2835139760410725, 'auprc': 0.2835139760410725, 'loss_val': 2.0175870643807783, 'psi': 0.2835139760410725}-{'f1_val': 0.2909904868494684, 'auprc': 0.2909904868494684, 'loss_val': 1.874919431992528, 'psi': 0.2909904868494684}
[S4] START round=22 head_norm_before_train=1.239652 cos_to_last_merge=0.9850 (last merge round=20)
[S4] round=22 local utility u=0.025931 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1697580726107744, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2216195933226894, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.675908 (no previous merge yet)
[S5] round=22 local utility u=0.002912 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.8068789126650997, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.812703900087357, 'psi': 0.33308623671855697}
[S6] START round=22 head_norm_before_train=1.859199 (no previous merge yet)
[S6] round=22 local utility u=0.220748 metrics={'f1_val': 0.026733121884911646, 'auprc': 0.026733121884911646, 'loss_val': 6.844539071038163, 'psi': 0.026733121884911643}-{'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 7.197378758972073, 'psi': 0.016882516188714152}
[S7] START round=22 head_norm_before_train=1.546936 (no previous merge yet)
[S7] round=22 local utility u=0.020119 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.13837499332497, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1786139478530178, 'psi': 0.35976373724718097}
[S8] START round=22 head_norm_before_train=1.969750 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.578535404136906, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5247573737027473, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.465628 cos_to_last_merge=0.9999 (last merge round=20)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.2267699115044248, 'auprc': 0.2267699115044248, 'loss_val': 2.163084700617272, 'psi': 0.22676991150442483}-{'f1_val': 0.2448883389311178, 'auprc': 0.2448883389311178, 'loss_val': 2.0407057971091307, 'psi': 0.2448883389311178}
[S10] START round=22 head_norm_before_train=2.083546 (no previous merge yet)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.2417722251142345, 'auprc': 0.2417722251142345, 'loss_val': 1.8704697698274775, 'psi': 0.2417722251142345}-{'f1_val': 0.2417722251142345, 'auprc': 0.2417722251142345, 'loss_val': 1.7761876591595875, 'psi': 0.2417722251142345}
[S11] START round=22 head_norm_before_train=2.013165 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.924484569683073, 'psi': 0.3319360347772085}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 1.821152916244198, 'psi': 0.33154997286190585}
[S13] START round=22 head_norm_before_train=1.666156 cos_to_last_merge=0.9976 (last merge round=20)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1859583512743428, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0993002923112605, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.368844 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.075317 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 2.8234068640138092, 'psi': 0.13592717296421}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 2.957902967481189, 'psi': 0.13413413413413414}
[S15] START round=22 head_norm_before_train=2.037825 (no previous merge yet)
[S15] round=22 local utility u=0.013213 metrics={'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.5935706897032367, 'psi': 0.615636807189815}-{'f1_val': 0.6138114033949549, 'auprc': 0.6138114033949549, 'loss_val': 0.6035683720857999, 'psi': 0.6138114033949549}
[S16] START round=22 head_norm_before_train=1.739838 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.04576856649395509, 'auprc': 0.04576856649395509, 'loss_val': 4.956577728589825, 'psi': 0.04576856649395509}-{'f1_val': 0.1352486187845304, 'auprc': 0.1352486187845304, 'loss_val': 3.938635717803386, 'psi': 0.1352486187845304}
[S17] START round=22 head_norm_before_train=1.721163 cos_to_last_merge=0.9464 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=22 local utility u=0.294367 metrics={'f1_val': 0.2695941581962286, 'auprc': 0.2695941581962286, 'loss_val': 1.3600726950078972, 'psi': 0.2695941581962286}-{'f1_val': 0.21271461714007153, 'auprc': 0.21271461714007153, 'loss_val': 1.4368918117814578, 'psi': 0.2127146171400715}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:33214
[S14] not sending this round → trigger blocked (psi=0.136)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:33211
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.027)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=0.9983
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.0079
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] cosine check vs S2: cos=0.9637
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9561
[S10] RECEIVED delta(kind=head bytes=1805) from S4
[S10] cosine check vs S4: cos=0.0492
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.9128
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.1359 head_norm=1.385826
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.350145e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.1019 head_norm=1.457771 delta_norm=0.235014
[S14] aggregate: ROLLBACK (f1_val pre=0.136 post=0.102 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.3319 head_norm=2.030968
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.242920e-02
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.3319 head_norm=2.047221 delta_norm=0.062429
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.3599 head_norm=1.697660
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.656887e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.3599 head_norm=1.788953 delta_norm=0.265689
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.2418 head_norm=2.109382
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.226328e+00
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.2418 head_norm=1.282563 delta_norm=1.226328
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.2835 head_norm=1.417498
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.682369e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.2955 head_norm=1.548653 delta_norm=0.368237
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.0458 head_norm=1.751496
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.213624e+00
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.0623 head_norm=1.223210 delta_norm=1.213624
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.913070 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.24647282542019386, 'auprc': 0.24647282542019386, 'loss_val': 2.6301354733779134, 'psi': 0.24647282542019386}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.7934033405507672, 'psi': 0.26542475888492534}
[S3] START round=23 head_norm_before_train=1.548653 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.190895 metrics={'f1_val': 0.2956825922857406, 'auprc': 0.2956825922857406, 'loss_val': 1.745315604886736, 'psi': 0.2956825922857406}-{'f1_val': 0.2835139760410725, 'auprc': 0.2835139760410725, 'loss_val': 2.0175870643807783, 'psi': 0.2835139760410725}
[S4] START round=23 head_norm_before_train=1.359488 cos_to_last_merge=0.9560 (last merge round=20)
[S4] round=23 local utility u=0.019564 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1306298011047105, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1697580726107744, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.694260 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.9421336071079787, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.8068789126650997, 'psi': 0.33308623671855697}
[S6] START round=23 head_norm_before_train=1.872457 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 7.207155636288735, 'psi': 0.021749084249084248}-{'f1_val': 0.026733121884911646, 'auprc': 0.026733121884911646, 'loss_val': 6.844539071038163, 'psi': 0.026733121884911643}
[S7] START round=23 head_norm_before_train=1.562095 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.23753824005758503, 'auprc': 0.23753824005758503, 'loss_val': 1.1246042476892333, 'psi': 0.23753824005758503}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.13837499332497, 'psi': 0.35976373724718097}
[S8] START round=23 head_norm_before_train=1.985197 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.628671679154991, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.578535404136906, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.485288 cos_to_last_merge=0.9996 (last merge round=20)
[S9] round=23 local utility u=0.051567 metrics={'f1_val': 0.23883808499193115, 'auprc': 0.23883808499193115, 'loss_val': 2.1685650641266196, 'psi': 0.23883808499193115}-{'f1_val': 0.2267699115044248, 'auprc': 0.2267699115044248, 'loss_val': 2.163084700617272, 'psi': 0.22676991150442483}
[S10] START round=23 head_norm_before_train=1.282563 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.271254 metrics={'f1_val': 0.2417722251142345, 'auprc': 0.2417722251142345, 'loss_val': 1.327961486022928, 'psi': 0.2417722251142345}-{'f1_val': 0.2417722251142345, 'auprc': 0.2417722251142345, 'loss_val': 1.8704697698274775, 'psi': 0.2417722251142345}
[S11] START round=23 head_norm_before_train=2.047221 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.012180 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 1.8295178087305166, 'psi': 0.3240909090909091}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.924484569683073, 'psi': 0.3319360347772085}
[S13] START round=23 head_norm_before_train=1.788953 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.010956 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1640464554030072, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1859583512743428, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.457771 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.900034055900252, 'psi': 0.13582554517133957}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 2.8234068640138092, 'psi': 0.13592717296421}
[S15] START round=23 head_norm_before_train=2.065234 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6135290307062625, 'auprc': 0.6135290307062625, 'loss_val': 0.6134283114895591, 'psi': 0.6135290307062625}-{'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.5935706897032367, 'psi': 0.615636807189815}
[S16] START round=23 head_norm_before_train=1.223210 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=1.000000 metrics={'f1_val': 0.07947776417788657, 'auprc': 0.07947776417788657, 'loss_val': 2.8227517231976273, 'psi': 0.07947776417788657}-{'f1_val': 0.04576856649395509, 'auprc': 0.04576856649395509, 'loss_val': 4.956577728589825, 'psi': 0.04576856649395509}
[S17] START round=23 head_norm_before_train=1.748872 cos_to_last_merge=0.9420 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=23 local utility u=0.228030 metrics={'f1_val': 0.30440071888764036, 'auprc': 0.30440071888764036, 'loss_val': 1.2172722981591204, 'psi': 0.30440071888764036}-{'f1_val': 0.2695941581962286, 'auprc': 0.2695941581962286, 'loss_val': 1.3600726950078972, 'psi': 0.2695941581962286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:33210
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.079)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:33211
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S3
[S9] cosine check vs S3: cos=0.9440
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] cosine check vs S11: cos=0.0441
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.3020
[S4] RECEIVED delta(kind=head bytes=1798) from S13
[S4] cosine check vs S13: cos=0.5852
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] cosine check vs S4: cos=0.5264
[S17] RECEIVED delta(kind=head bytes=1794) from S9
[S17] cosine check vs S9: cos=0.9316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1807 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1807) from S17
[S3] cosine check vs S17: cos=0.9782
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.2957 head_norm=1.571729
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.679055e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.2938 head_norm=1.348876 delta_norm=0.367905
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.2418 head_norm=1.365333
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.864271e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.2418 head_norm=1.230713 delta_norm=0.686427
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.3568 head_norm=1.451736
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.611158e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.3568 head_norm=1.456310 delta_norm=0.761116
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.2388 head_norm=1.505431
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.595584e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.2395 head_norm=1.516891 delta_norm=0.259558
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.3599 head_norm=1.814589
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.343700e+00
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.3599 head_norm=1.403881 delta_norm=1.343700
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.3044 head_norm=1.769341
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.294724e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.3098 head_norm=1.609315 delta_norm=0.329472
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.923014 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.2619953286619953, 'auprc': 0.2619953286619953, 'loss_val': 3.0703159577438313, 'psi': 0.2619953286619953}-{'f1_val': 0.24647282542019386, 'auprc': 0.24647282542019386, 'loss_val': 2.6301354733779134, 'psi': 0.24647282542019386}
[S3] START round=24 head_norm_before_train=1.348876 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.2893258426966292, 'auprc': 0.2893258426966292, 'loss_val': 1.8585413730317861, 'psi': 0.2893258426966292}-{'f1_val': 0.2956825922857406, 'auprc': 0.2956825922857406, 'loss_val': 1.745315604886736, 'psi': 0.2956825922857406}
[S4] START round=24 head_norm_before_train=1.456310 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000169 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1302927176502644, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1306298011047105, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.712634 (no previous merge yet)
[S5] round=24 local utility u=0.009408 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.923318180112599, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.9421336071079787, 'psi': 0.33308623671855697}
[S6] START round=24 head_norm_before_train=1.884125 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 7.415575452094066, 'psi': 0.01732902033271719}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 7.207155636288735, 'psi': 0.021749084249084248}
[S7] START round=24 head_norm_before_train=1.578878 (no previous merge yet)
[S7] round=24 local utility u=0.585154 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.054324900525704, 'psi': 0.35976373724718097}-{'f1_val': 0.23753824005758503, 'auprc': 0.23753824005758503, 'loss_val': 1.1246042476892333, 'psi': 0.23753824005758503}
[S8] START round=24 head_norm_before_train=1.996604 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.670982696408556, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.628671679154991, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.516891 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.653987 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0290939047287937, 'psi': 0.36867172340800847}-{'f1_val': 0.23883808499193115, 'auprc': 0.23883808499193115, 'loss_val': 2.1685650641266196, 'psi': 0.23883808499193115}
[S10] START round=24 head_norm_before_train=1.230713 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.055529 metrics={'f1_val': 0.2417722251142345, 'auprc': 0.2417722251142345, 'loss_val': 1.2169041063720718, 'psi': 0.2417722251142345}-{'f1_val': 0.2417722251142345, 'auprc': 0.2417722251142345, 'loss_val': 1.327961486022928, 'psi': 0.2417722251142345}
[S11] START round=24 head_norm_before_train=2.063999 cos_to_last_merge=0.9999 (last merge round=22)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.0124763252089064, 'psi': 0.3319360347772085}-{'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 1.8295178087305166, 'psi': 0.3240909090909091}
[S13] START round=24 head_norm_before_train=1.403881 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.018174 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.12769826331105, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1640464554030072, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.474276 cos_to_last_merge=0.9951 (last merge round=22)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.4571638461113308, 'psi': 0.13572854291417166}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.900034055900252, 'psi': 0.13582554517133957}
[S15] START round=24 head_norm_before_train=2.089347 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6135290307062625, 'auprc': 0.6135290307062625, 'loss_val': 0.6150745793487256, 'psi': 0.6135290307062625}-{'f1_val': 0.6135290307062625, 'auprc': 0.6135290307062625, 'loss_val': 0.6134283114895591, 'psi': 0.6135290307062625}
[S16] START round=24 head_norm_before_train=1.256391 cos_to_last_merge=0.9990 (last merge round=22)
[S16] round=24 local utility u=0.481378 metrics={'f1_val': 0.1502004581901489, 'auprc': 0.1502004581901489, 'loss_val': 2.496499115945841, 'psi': 0.1502004581901489}-{'f1_val': 0.07947776417788657, 'auprc': 0.07947776417788657, 'loss_val': 2.8227517231976273, 'psi': 0.07947776417788657}
[S17] START round=24 head_norm_before_train=1.609315 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.274529490124275, 'auprc': 0.274529490124275, 'loss_val': 1.3024793211130878, 'psi': 0.274529490124275}-{'f1_val': 0.30440071888764036, 'auprc': 0.30440071888764036, 'loss_val': 1.2172722981591204, 'psi': 0.30440071888764036}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:33214
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.150)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S13] → sending delta(kind=head bytes=1810) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:33211
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1810 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1810) from S13
[S4] cosine check vs S13: cos=0.7466
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9479
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.4534
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.9925
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.6545
[S10] RECEIVED delta(kind=head bytes=1806) from S4
[S10] cosine check vs S4: cos=0.7623
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.2893 head_norm=1.378605
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.150113e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.2840 head_norm=1.165798 delta_norm=0.715011
[S3] aggregate: ROLLBACK (f1_val pre=0.289 post=0.284 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.1357 head_norm=1.512732
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.540414e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.1357 head_norm=1.533775 delta_norm=0.254041
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.1502 head_norm=1.309345
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.585779e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.1580 head_norm=1.383079 delta_norm=0.658578
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.3568 head_norm=1.523695
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.294612e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.3568 head_norm=1.386783 delta_norm=0.529461
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.2418 head_norm=1.356503
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.026583e-01
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.2418 head_norm=1.352113 delta_norm=0.502658
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.2745 head_norm=1.636356
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.090240e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.2752 head_norm=1.583807 delta_norm=0.109024
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.932786 (no previous merge yet)
[S2] round=25 local utility u=0.068959 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.9637369444149333, 'psi': 0.2654773703336637}-{'f1_val': 0.2619953286619953, 'auprc': 0.2619953286619953, 'loss_val': 3.0703159577438313, 'psi': 0.2619953286619953}
[S3] START round=25 head_norm_before_train=1.165798 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.148059 metrics={'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 1.6399722081914065, 'psi': 0.2979423868312757}-{'f1_val': 0.2893258426966292, 'auprc': 0.2893258426966292, 'loss_val': 1.8585413730317861, 'psi': 0.2893258426966292}
[S4] START round=25 head_norm_before_train=1.386783 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1644861689541677, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1302927176502644, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.725943 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.936089330174404, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.923318180112599, 'psi': 0.33308623671855697}
[S6] START round=25 head_norm_before_train=1.895154 (no previous merge yet)
[S6] round=25 local utility u=0.088884 metrics={'f1_val': 0.024362477231329692, 'auprc': 0.024362477231329692, 'loss_val': 7.301108304422217, 'psi': 0.024362477231329692}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 7.415575452094066, 'psi': 0.01732902033271719}
[S7] START round=25 head_norm_before_train=1.595509 (no previous merge yet)
[S7] round=25 local utility u=0.018077 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0181700945520933, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.054324900525704, 'psi': 0.35976373724718097}
[S8] START round=25 head_norm_before_train=2.011471 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7089594094663045, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.670982696408556, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.537207 cos_to_last_merge=0.9999 (last merge round=23)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.24466454427543924, 'auprc': 0.24466454427543924, 'loss_val': 2.1134872244590954, 'psi': 0.24466454427543927}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0290939047287937, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.352113 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.015547 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.1850543762003152, 'psi': 0.24168834923388266}-{'f1_val': 0.2417722251142345, 'auprc': 0.2417722251142345, 'loss_val': 1.2169041063720718, 'psi': 0.2417722251142345}
[S11] START round=25 head_norm_before_train=2.077156 cos_to_last_merge=0.9996 (last merge round=22)
[S11] round=25 local utility u=0.017254 metrics={'f1_val': 0.3268393307357323, 'auprc': 0.3268393307357323, 'loss_val': 1.9320989697224287, 'psi': 0.3268393307357323}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.0124763252089064, 'psi': 0.3319360347772085}
[S13] START round=25 head_norm_before_train=1.444072 cos_to_last_merge=0.9983 (last merge round=23)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1789221027618733, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.12769826331105, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.533775 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.104936 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.247291226665706, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.4571638461113308, 'psi': 0.13572854291417166}
[S15] START round=25 head_norm_before_train=2.110733 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6132462444361879, 'auprc': 0.6132462444361879, 'loss_val': 0.6129380353246789, 'psi': 0.6132462444361879}-{'f1_val': 0.6135290307062625, 'auprc': 0.6135290307062625, 'loss_val': 0.6150745793487256, 'psi': 0.6135290307062625}
[S16] START round=25 head_norm_before_train=1.383079 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.014883383247118612, 'auprc': 0.014883383247118612, 'loss_val': 2.6919811239086284, 'psi': 0.014883383247118612}-{'f1_val': 0.1502004581901489, 'auprc': 0.1502004581901489, 'loss_val': 2.496499115945841, 'psi': 0.1502004581901489}
[S17] START round=25 head_norm_before_train=1.583807 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.458339 metrics={'f1_val': 0.3885441367038267, 'auprc': 0.3885441367038267, 'loss_val': 1.4119323789581144, 'psi': 0.3885441367038267}-{'f1_val': 0.274529490124275, 'auprc': 0.274529490124275, 'loss_val': 1.3024793211130878, 'psi': 0.274529490124275}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:33213
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:33210
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.024)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=0.7401
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9721
[S13] RECEIVED delta(kind=head bytes=1799) from S2
[S13] cosine check vs S2: cos=0.6083
[S3] RECEIVED delta(kind=head bytes=1803) from S10
[S3] cosine check vs S10: cos=0.8007
[S9] RECEIVED delta(kind=head bytes=1797) from S3
[S9] cosine check vs S3: cos=0.7169
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.7014
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.1357 head_norm=1.568941
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.894115e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.1357 head_norm=1.580410 delta_norm=0.189411
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.135 → S15@127.0.0.1:33215
[S8] ⇄ pheromone p=0.016 → S17@127.0.0.1:33217
[S5] ⇄ pheromone p=0.027 → S16@127.0.0.1:33216
[S4] ⇄ pheromone p=0.021 → S10@127.0.0.1:33211
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.3599 head_norm=1.490938
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.461109e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.3599 head_norm=1.433374 delta_norm=0.146111
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.019 → S4@127.0.0.1:33204
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.2447 head_norm=1.557754
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.447116e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.2451 head_norm=1.280478 delta_norm=0.544712
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.156 → S17@127.0.0.1:33217
[S15] ⇄ pheromone p=0.033 → S11@127.0.0.1:33212
[S6] ⇄ pheromone p=0.074 → S11@127.0.0.1:33212
[S2] ⇄ pheromone p=0.079 → S13@127.0.0.1:33213
[S7] ⇄ pheromone p=0.193 → S14@127.0.0.1:33214
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.2979 head_norm=1.202528
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.703813e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.2979 head_norm=1.193784 delta_norm=0.170381
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.157 → S9@127.0.0.1:33210
[S11] ⇄ pheromone p=0.032 → S13@127.0.0.1:33213
[S10] ⇄ pheromone p=0.068 → S3@127.0.0.1:33203
[S16] ⇄ pheromone p=0.292 → S17@127.0.0.1:33217
[S17] ⇄ pheromone p=0.192 → S3@127.0.0.1:33203
[S2] START round=26 head_norm_before_train=1.942287 (no previous merge yet)
[S2] round=26 local utility u=0.051590 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.859609584960032, 'psi': 0.26537216828478966}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.9637369444149333, 'psi': 0.2654773703336637}
[S3] START round=26 head_norm_before_train=1.193784 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.29782170968332417, 'auprc': 0.29782170968332417, 'loss_val': 1.8079156912274716, 'psi': 0.29782170968332417}-{'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 1.6399722081914065, 'psi': 0.2979423868312757}
[S4] START round=26 head_norm_before_train=1.451639 cos_to_last_merge=0.9939 (last merge round=24)
[S4] round=26 local utility u=0.017267 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1299531386337716, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1644861689541677, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.738845 (no previous merge yet)
[S5] round=26 local utility u=0.019427 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.901023307463681, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.936089330174404, 'psi': 0.33308623671855697}
[S6] START round=26 head_norm_before_train=1.905403 (no previous merge yet)
[S6] round=26 local utility u=0.002770 metrics={'f1_val': 0.02501136880400182, 'auprc': 0.02501136880400182, 'loss_val': 7.301408447969817, 'psi': 0.02501136880400182}-{'f1_val': 0.024362477231329692, 'auprc': 0.024362477231329692, 'loss_val': 7.301108304422217, 'psi': 0.024362477231329692}
[S7] START round=26 head_norm_before_train=1.614177 (no previous merge yet)
[S7] round=26 local utility u=0.015329 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9875120243253559, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0181700945520933, 'psi': 0.35976373724718097}
[S8] START round=26 head_norm_before_train=2.028676 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7465728553561966, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7089594094663045, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.280478 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.19475210970464132, 'auprc': 0.19475210970464132, 'loss_val': 2.0247768601477567, 'psi': 0.19475210970464132}-{'f1_val': 0.24466454427543924, 'auprc': 0.24466454427543924, 'loss_val': 2.1134872244590954, 'psi': 0.24466454427543927}
[S10] START round=26 head_norm_before_train=1.477789 cos_to_last_merge=0.9846 (last merge round=24)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.3282245770194, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.1850543762003152, 'psi': 0.24168834923388266}
[S11] START round=26 head_norm_before_train=2.088934 cos_to_last_merge=0.9993 (last merge round=22)
[S11] round=26 local utility u=0.007640 metrics={'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 1.8887714116801884, 'psi': 0.3237230419977299}-{'f1_val': 0.3268393307357323, 'auprc': 0.3268393307357323, 'loss_val': 1.9320989697224287, 'psi': 0.3268393307357323}
[S13] START round=26 head_norm_before_train=1.433374 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.026604 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1257142802791862, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1789221027618733, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.580410 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.035975 metrics={'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 3.16458652563015, 'psi': 0.1345336334083521}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.247291226665706, 'psi': 0.13572854291417166}
[S15] START round=26 head_norm_before_train=2.129853 (no previous merge yet)
[S15] round=26 local utility u=0.005702 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6192711228549844, 'psi': 0.6152170947577895}-{'f1_val': 0.6132462444361879, 'auprc': 0.6132462444361879, 'loss_val': 0.6129380353246789, 'psi': 0.6132462444361879}
[S16] START round=26 head_norm_before_train=1.427302 cos_to_last_merge=0.9969 (last merge round=24)
[S16] round=26 local utility u=0.565273 metrics={'f1_val': 0.12483100495718792, 'auprc': 0.12483100495718792, 'loss_val': 2.5509644028673906, 'psi': 0.12483100495718792}-{'f1_val': 0.014883383247118612, 'auprc': 0.014883383247118612, 'loss_val': 2.6919811239086284, 'psi': 0.014883383247118612}
[S17] START round=26 head_norm_before_train=1.623355 cos_to_last_merge=0.9995 (last merge round=24)
[S17] round=26 local utility u=0.045276 metrics={'f1_val': 0.4029214548868113, 'auprc': 0.4029214548868113, 'loss_val': 1.4507752797555962, 'psi': 0.4029214548868113}-{'f1_val': 0.3885441367038267, 'auprc': 0.3885441367038267, 'loss_val': 1.4119323789581144, 'psi': 0.3885441367038267}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.025)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:33213
[S14] not sending this round → trigger blocked (psi=0.135)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:33212
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:33216
[S16] not sending this round → trigger blocked (psi=0.125)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1807) from S13
[S4] cosine check vs S13: cos=0.8772
[S11] RECEIVED delta(kind=head bytes=1791) from S15
[S11] cosine check vs S15: cos=0.9963
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.8777
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] cosine check vs S7: cos=0.9824
[S13] RECEIVED delta(kind=head bytes=1799) from S2
[S13] cosine check vs S2: cos=0.6384
[S13] RECEIVED delta(kind=head bytes=1802) from S11
[S13] cosine check vs S11: cos=0.7232
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] cosine check vs S4: cos=0.8171
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.7622
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.2417 head_norm=1.601692
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.760324e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.2417 head_norm=1.497560 delta_norm=0.476032
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.2978 head_norm=1.229460
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.377856e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.2978 head_norm=1.358395 delta_norm=0.537786
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.1345 head_norm=1.614008
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.521436e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.1353 head_norm=1.614298 delta_norm=0.152144
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.3599 head_norm=1.469215
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.056861e-01
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.3599 head_norm=1.429288 delta_norm=0.105686
[S13] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.3568 head_norm=1.540509
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.744573e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.3568 head_norm=1.457965 delta_norm=0.374457
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.3237 head_norm=2.101446
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.390800e-02
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.3237 head_norm=2.122534 delta_norm=0.093908
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.1248 head_norm=1.490108
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.202835e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.1324 head_norm=1.570834 delta_norm=0.420284
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.951513 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.034213114843273, 'psi': 0.2654773703336637}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.859609584960032, 'psi': 0.26537216828478966}
[S3] START round=27 head_norm_before_train=1.358395 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.010778 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 1.7865342445482766, 'psi': 0.29784120014635934}-{'f1_val': 0.29782170968332417, 'auprc': 0.29782170968332417, 'loss_val': 1.8079156912274716, 'psi': 0.29782170968332417}
[S4] START round=27 head_norm_before_train=1.457965 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1310313128842981, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1299531386337716, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.751541 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9181357041747993, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.901023307463681, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.914912 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.024578971324533454, 'auprc': 0.024578971324533454, 'loss_val': 7.423801534284343, 'psi': 0.024578971324533454}-{'f1_val': 0.02501136880400182, 'auprc': 0.02501136880400182, 'loss_val': 7.301408447969817, 'psi': 0.02501136880400182}
[S7] START round=27 head_norm_before_train=1.628862 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9656987519881631, 'psi': 0.23976608187134504}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9875120243253559, 'psi': 0.35976373724718097}
[S8] START round=27 head_norm_before_train=2.044510 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7789076309142433, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7465728553561966, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.311372 cos_to_last_merge=0.9995 (last merge round=25)
[S9] round=27 local utility u=0.143632 metrics={'f1_val': 0.21766403211642205, 'auprc': 0.21766403211642205, 'loss_val': 1.9437210663278204, 'psi': 0.21766403211642205}-{'f1_val': 0.19475210970464132, 'auprc': 0.19475210970464132, 'loss_val': 2.0247768601477567, 'psi': 0.19475210970464132}
[S10] START round=27 head_norm_before_train=1.497560 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.012214 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.3037973437984929, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.3282245770194, 'psi': 0.24168834923388266}
[S11] START round=27 head_norm_before_train=2.122534 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.3243120309301797, 'auprc': 0.3243120309301797, 'loss_val': 2.0011255390507094, 'psi': 0.3243120309301797}-{'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 1.8887714116801884, 'psi': 0.3237230419977299}
[S13] START round=27 head_norm_before_train=1.429288 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1333772020515593, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1257142802791862, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.614298 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.003990 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.1673604793375776, 'psi': 0.13572854291417166}-{'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 3.16458652563015, 'psi': 0.1345336334083521}
[S15] START round=27 head_norm_before_train=2.147525 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6236912905790908, 'psi': 0.6153571007984797}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6192711228549844, 'psi': 0.6152170947577895}
[S16] START round=27 head_norm_before_train=1.570834 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 2.438065606618594, 'psi': 0.09046591544793414}-{'f1_val': 0.12483100495718792, 'auprc': 0.12483100495718792, 'loss_val': 2.5509644028673906, 'psi': 0.12483100495718792}
[S17] START round=27 head_norm_before_train=1.660520 cos_to_last_merge=0.9982 (last merge round=24)
[S17] round=27 local utility u=0.042308 metrics={'f1_val': 0.4144842668466669, 'auprc': 0.4144842668466669, 'loss_val': 1.4702250677404745, 'psi': 0.4144842668466669}-{'f1_val': 0.4029214548868113, 'auprc': 0.4029214548868113, 'loss_val': 1.4507752797555962, 'psi': 0.4029214548868113}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S3] → sending delta(kind=head bytes=1808) to S9@127.0.0.1:33210
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:33217
[S10] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1808 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S9
[S17] cosine check vs S9: cos=0.9383
[S9] RECEIVED delta(kind=head bytes=1808) from S3
[S9] cosine check vs S3: cos=0.9933
[S3] RECEIVED delta(kind=head bytes=1803) from S10
[S3] cosine check vs S10: cos=0.4713
[S17] not sending this round → trigger blocked (psi=0.414)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.2177 head_norm=1.351876
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.243164e-02
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.2211 head_norm=1.371946 delta_norm=0.082432
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.2978 head_norm=1.396599
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.749429e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.2978 head_norm=1.285728 delta_norm=0.774943
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.4145 head_norm=1.697898
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.174216e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.4154 head_norm=1.501485 delta_norm=0.317422
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.960598 (no previous merge yet)
[S2] round=28 local utility u=0.032198 metrics={'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 2.7894276766712665, 'psi': 0.24543399914482925}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.034213114843273, 'psi': 0.2654773703336637}
[S3] START round=28 head_norm_before_train=1.285728 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.077748 metrics={'f1_val': 0.2976157851466155, 'auprc': 0.2976157851466155, 'loss_val': 1.6290098742614119, 'psi': 0.2976157851466155}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 1.7865342445482766, 'psi': 0.29784120014635934}
[S4] START round=28 head_norm_before_train=1.534527 cos_to_last_merge=0.9945 (last merge round=26)
[S4] round=28 local utility u=0.015278 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1004745785948524, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1310313128842981, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.766016 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9619146881397245, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9181357041747993, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.923964 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.565167757445084, 'psi': 0.02065167508031207}-{'f1_val': 0.024578971324533454, 'auprc': 0.024578971324533454, 'loss_val': 7.423801534284343, 'psi': 0.024578971324533454}
[S7] START round=28 head_norm_before_train=1.643686 (no previous merge yet)
[S7] round=28 local utility u=0.006283 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9524447431045665, 'psi': 0.23968964488212474}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9656987519881631, 'psi': 0.23976608187134504}
[S8] START round=28 head_norm_before_train=2.060170 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8139891105410397, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7789076309142433, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.371946 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.019897 metrics={'f1_val': 0.22846648301193753, 'auprc': 0.22846648301193753, 'loss_val': 2.001148486509268, 'psi': 0.22846648301193753}-{'f1_val': 0.21766403211642205, 'auprc': 0.21766403211642205, 'loss_val': 1.9437210663278204, 'psi': 0.21766403211642205}
[S10] START round=28 head_norm_before_train=1.598992 cos_to_last_merge=0.9947 (last merge round=26)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.4797620729292902, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.3037973437984929, 'psi': 0.24168834923388266}
[S11] START round=28 head_norm_before_train=2.134107 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.3266116712496181, 'auprc': 0.3266116712496181, 'loss_val': 2.0641132319567412, 'psi': 0.3266116712496181}-{'f1_val': 0.3243120309301797, 'auprc': 0.3243120309301797, 'loss_val': 2.0011255390507094, 'psi': 0.3243120309301797}
[S13] START round=28 head_norm_before_train=1.467178 cos_to_last_merge=0.9987 (last merge round=26)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1459367994821372, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1333772020515593, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.652955 cos_to_last_merge=0.9977 (last merge round=26)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13030875866414618, 'auprc': 0.13030875866414618, 'loss_val': 3.6899805243175416, 'psi': 0.13030875866414618}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.1673604793375776, 'psi': 0.13572854291417166}
[S15] START round=28 head_norm_before_train=2.165137 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.6340222540333935, 'psi': 0.6149367764291455}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6236912905790908, 'psi': 0.6153571007984797}
[S16] START round=28 head_norm_before_train=1.622207 cos_to_last_merge=0.9967 (last merge round=26)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.07706181341203476, 'auprc': 0.07706181341203476, 'loss_val': 2.9976744987616066, 'psi': 0.07706181341203476}-{'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 2.438065606618594, 'psi': 0.09046591544793414}
[S17] START round=28 head_norm_before_train=1.501485 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.405287202589438, 'auprc': 0.405287202589438, 'loss_val': 1.4257985327830318, 'psi': 0.405287202589438}-{'f1_val': 0.4144842668466669, 'auprc': 0.4144842668466669, 'loss_val': 1.4702250677404745, 'psi': 0.4144842668466669}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:33214
[S9] not sending this round → trigger blocked (psi=0.228)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:33211
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.298)
[S4] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] cosine check vs S4: cos=0.8685
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9772
[S13] RECEIVED delta(kind=head bytes=1798) from S2
[S13] cosine check vs S2: cos=0.6518
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.1303 head_norm=1.696294
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.800922e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.1329 head_norm=1.667457 delta_norm=0.180092
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.2417 head_norm=1.696276
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.264449e-01
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.2417 head_norm=1.600397 delta_norm=0.426445
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.3599 head_norm=1.502472
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.544405e-01
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.3599 head_norm=1.580210 delta_norm=0.754441
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.968518 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.8404931440151433, 'psi': 0.2450298816928894}-{'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 2.7894276766712665, 'psi': 0.24543399914482925}
[S3] START round=29 head_norm_before_train=1.316222 cos_to_last_merge=0.9992 (last merge round=27)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 1.9182928830439743, 'psi': 0.29784120014635934}-{'f1_val': 0.2976157851466155, 'auprc': 0.2976157851466155, 'loss_val': 1.6290098742614119, 'psi': 0.2976157851466155}
[S4] START round=29 head_norm_before_train=1.615209 cos_to_last_merge=0.9842 (last merge round=26)
[S4] round=29 local utility u=0.000121 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1002322192071594, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1004745785948524, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.785125 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0122592598238, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9619146881397245, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.932678 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 7.688290615365435, 'psi': 0.018441678192715538}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.565167757445084, 'psi': 0.02065167508031207}
[S7] START round=29 head_norm_before_train=1.657794 (no previous merge yet)
[S7] round=29 local utility u=0.549558 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9339955564219267, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9524447431045665, 'psi': 0.23968964488212474}
[S8] START round=29 head_norm_before_train=2.070616 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8439228411201665, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8139891105410397, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.411558 cos_to_last_merge=0.9995 (last merge round=27)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.2140870005058169, 'auprc': 0.2140870005058169, 'loss_val': 2.1981844136255604, 'psi': 0.21408700050581692}-{'f1_val': 0.22846648301193753, 'auprc': 0.22846648301193753, 'loss_val': 2.001148486509268, 'psi': 0.22846648301193753}
[S10] START round=29 head_norm_before_train=1.600397 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.025853 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.428055348118179, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.4797620729292902, 'psi': 0.24168834923388266}
[S11] START round=29 head_norm_before_train=2.146381 cos_to_last_merge=0.9998 (last merge round=26)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.174691582347957, 'psi': 0.33154997286190585}-{'f1_val': 0.3266116712496181, 'auprc': 0.3266116712496181, 'loss_val': 2.0641132319567412, 'psi': 0.3266116712496181}
[S13] START round=29 head_norm_before_train=1.580210 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.168396224098676, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1459367994821372, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.667457 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.134491 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.469775661609407, 'psi': 0.13572854291417166}-{'f1_val': 0.13030875866414618, 'auprc': 0.13030875866414618, 'loss_val': 3.6899805243175416, 'psi': 0.13030875866414618}
[S15] START round=29 head_norm_before_train=2.182248 (no previous merge yet)
[S15] round=29 local utility u=0.005199 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6362016757908424, 'psi': 0.6163342951580373}-{'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.6340222540333935, 'psi': 0.6149367764291455}
[S16] START round=29 head_norm_before_train=1.682823 cos_to_last_merge=0.9886 (last merge round=26)
[S16] round=29 local utility u=0.901418 metrics={'f1_val': 0.1771172638436482, 'auprc': 0.1771172638436482, 'loss_val': 2.09533748219621, 'psi': 0.1771172638436482}-{'f1_val': 0.07706181341203476, 'auprc': 0.07706181341203476, 'loss_val': 2.9976744987616066, 'psi': 0.07706181341203476}
[S17] START round=29 head_norm_before_train=1.537680 cos_to_last_merge=0.9997 (last merge round=27)
[S17] round=29 local utility u=0.282591 metrics={'f1_val': 0.45421097770833546, 'auprc': 0.45421097770833546, 'loss_val': 1.3009306360624353, 'psi': 0.4542109777083355}-{'f1_val': 0.405287202589438, 'auprc': 0.405287202589438, 'loss_val': 1.4257985327830318, 'psi': 0.405287202589438}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.357)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33212
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.177)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:33203
[S7] not sending this round → trigger blocked (psi=0.360)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S15
[S11] cosine check vs S15: cos=0.9971
[S3] RECEIVED delta(kind=head bytes=1806) from S10
[S3] cosine check vs S10: cos=0.8393
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.7537
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.2978 head_norm=1.346459
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.181255e-01
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.2978 head_norm=1.329135 delta_norm=0.118126
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.3315 head_norm=2.159118
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.464587e-02
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.3315 head_norm=2.177179 delta_norm=0.084646
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.976509 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.0397183551595495, 'psi': 0.2654773703336637}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.8404931440151433, 'psi': 0.2450298816928894}
[S3] START round=30 head_norm_before_train=1.329135 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.082492 metrics={'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 1.7542199254538238, 'psi': 0.2979423868312757}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 1.9182928830439743, 'psi': 0.29784120014635934}
[S4] START round=30 head_norm_before_train=1.676054 cos_to_last_merge=0.9758 (last merge round=26)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1178065471694352, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1002322192071594, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.811466 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1277473301867404, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0122592598238, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.940979 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.756475375802798, 'psi': 0.017774699907663897}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 7.688290615365435, 'psi': 0.018441678192715538}
[S7] START round=30 head_norm_before_train=1.667935 (no previous merge yet)
[S7] round=30 local utility u=0.018084 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8978280869365404, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9339955564219267, 'psi': 0.35976373724718097}
[S8] START round=30 head_norm_before_train=2.082118 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8673422868106564, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8439228411201665, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.448074 cos_to_last_merge=0.9982 (last merge round=27)
[S9] round=30 local utility u=0.132059 metrics={'f1_val': 0.2368342040473188, 'auprc': 0.2368342040473188, 'loss_val': 2.138790903798311, 'psi': 0.2368342040473188}-{'f1_val': 0.2140870005058169, 'auprc': 0.2140870005058169, 'loss_val': 2.1981844136255604, 'psi': 0.21408700050581692}
[S10] START round=30 head_norm_before_train=1.683749 cos_to_last_merge=0.9972 (last merge round=28)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.5650415195122507, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.428055348118179, 'psi': 0.24168834923388266}
[S11] START round=30 head_norm_before_train=2.177179 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.32512165450121655, 'auprc': 0.32512165450121655, 'loss_val': 2.1492491516363192, 'psi': 0.32512165450121655}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.174691582347957, 'psi': 0.33154997286190585}
[S13] START round=30 head_norm_before_train=1.611035 cos_to_last_merge=0.9994 (last merge round=28)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2107897934438525, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.168396224098676, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.704575 cos_to_last_merge=0.9990 (last merge round=28)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.8231905060030114, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.469775661609407, 'psi': 0.13572854291417166}
[S15] START round=30 head_norm_before_train=2.198352 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.6231365696506551, 'psi': 0.6136702686915539}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6362016757908424, 'psi': 0.6163342951580373}
[S16] START round=30 head_norm_before_train=1.736731 cos_to_last_merge=0.9800 (last merge round=26)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.11264791762717075, 'auprc': 0.11264791762717075, 'loss_val': 3.1458731426528406, 'psi': 0.11264791762717075}-{'f1_val': 0.1771172638436482, 'auprc': 0.1771172638436482, 'loss_val': 2.09533748219621, 'psi': 0.1771172638436482}
[S17] START round=30 head_norm_before_train=1.579042 cos_to_last_merge=0.9986 (last merge round=27)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.40623110862484324, 'auprc': 0.40623110862484324, 'loss_val': 1.5507989477264037, 'psi': 0.40623110862484324}-{'f1_val': 0.45421097770833546, 'auprc': 0.45421097770833546, 'loss_val': 1.3009306360624353, 'psi': 0.4542109777083355}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:33203
[S3] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1806) from S9
[S3] cosine check vs S9: cos=0.8542
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.7820
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.2979 head_norm=1.360638
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.878490e-01
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.2976 head_norm=1.367729 delta_norm=0.387849
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.079 → S17@127.0.0.1:33217
[S10] ⇄ pheromone p=0.028 → S4@127.0.0.1:33204
[S9] ⇄ pheromone p=0.095 → S3@127.0.0.1:33203
[S11] ⇄ pheromone p=0.011 → S6@127.0.0.1:33207
[S13] ⇄ pheromone p=0.008 → S2@127.0.0.1:33202
[S4] ⇄ pheromone p=0.010 → S10@127.0.0.1:33211
[S15] ⇄ pheromone p=0.012 → S14@127.0.0.1:33214
[S14] ⇄ pheromone p=0.069 → S7@127.0.0.1:33208
[S16] ⇄ pheromone p=0.286 → S5@127.0.0.1:33205
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.4062 head_norm=1.609520
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.041546e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.4062 head_norm=1.402417 delta_norm=0.504155
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.116 → S16@127.0.0.1:33216
[S6] ⇄ pheromone p=0.024 → S11@127.0.0.1:33212
[S2] START round=31 head_norm_before_train=1.984640 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.2648927720413026, 'auprc': 0.2648927720413026, 'loss_val': 3.159158614211452, 'psi': 0.2648927720413026}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.0397183551595495, 'psi': 0.2654773703336637}
[S3] START round=31 head_norm_before_train=1.367729 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 1.9853825108182817, 'psi': 0.29784120014635934}-{'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 1.7542199254538238, 'psi': 0.2979423868312757}
[S4] START round=31 head_norm_before_train=1.718109 cos_to_last_merge=0.9700 (last merge round=26)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1315989541264597, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1178065471694352, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.838076 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.1981713117988226, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1277473301867404, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=1.949068 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 7.8038257221528315, 'psi': 0.018219557195571955}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.756475375802798, 'psi': 0.017774699907663897}
[S7] START round=31 head_norm_before_train=1.682619 (no previous merge yet)
[S7] round=31 local utility u=0.007347 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.883133273536342, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8978280869365404, 'psi': 0.35976373724718097}
[S8] START round=31 head_norm_before_train=2.093617 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8920711539889188, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8673422868106564, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.480164 cos_to_last_merge=0.9967 (last merge round=27)
[S9] round=31 local utility u=0.592028 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.141271997152708, 'psi': 0.36867172340800847}-{'f1_val': 0.2368342040473188, 'auprc': 0.2368342040473188, 'loss_val': 2.138790903798311, 'psi': 0.2368342040473188}
[S10] START round=31 head_norm_before_train=1.764520 cos_to_last_merge=0.9917 (last merge round=28)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.691267886070851, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.5650415195122507, 'psi': 0.24168834923388266}
[S11] START round=31 head_norm_before_train=2.188928 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.32438580527752503, 'auprc': 0.32438580527752503, 'loss_val': 2.1630874021898907, 'psi': 0.32438580527752503}-{'f1_val': 0.32512165450121655, 'auprc': 0.32512165450121655, 'loss_val': 2.1492491516363192, 'psi': 0.32512165450121655}
[S13] START round=31 head_norm_before_train=1.633720 cos_to_last_merge=0.9982 (last merge round=28)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.263569001527009, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2107897934438525, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.740947 cos_to_last_merge=0.9965 (last merge round=28)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.100251193296141, 'psi': 0.13587634006482174}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.8231905060030114, 'psi': 0.13572854291417166}
[S15] START round=31 head_norm_before_train=2.212675 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6528669199715015, 'psi': 0.6163342951580373}-{'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.6231365696506551, 'psi': 0.6136702686915539}
[S16] START round=31 head_norm_before_train=1.778976 cos_to_last_merge=0.9729 (last merge round=26)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 3.6982425641009513, 'psi': 0.09022435897435897}-{'f1_val': 0.11264791762717075, 'auprc': 0.11264791762717075, 'loss_val': 3.1458731426528406, 'psi': 0.11264791762717075}
[S17] START round=31 head_norm_before_train=1.402417 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.189257 metrics={'f1_val': 0.428485604579821, 'auprc': 0.428485604579821, 'loss_val': 1.3725757107111005, 'psi': 0.428485604579821}-{'f1_val': 0.40623110862484324, 'auprc': 0.40623110862484324, 'loss_val': 1.5507989477264037, 'psi': 0.40623110862484324}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:33214
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9758
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.9636
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:33216
[S17] sending update (kind=head size=1806 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1806) from S17
[S16] cosine check vs S17: cos=-0.0170
[S16] DROPPED delta from S17 (cos=-0.0170 < 0.0)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.2978 head_norm=1.404627
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.030995e-01
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.2978 head_norm=1.442877 delta_norm=0.203099
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.1359 head_norm=1.773462
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.945627e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.1359 head_norm=1.725865 delta_norm=0.194563
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.991992 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 3.166508413828219, 'psi': 0.2654504593826426}-{'f1_val': 0.2648927720413026, 'auprc': 0.2648927720413026, 'loss_val': 3.159158614211452, 'psi': 0.2648927720413026}
[S3] START round=32 head_norm_before_train=1.442877 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.0114459869912578, 'psi': 0.29784120014635934}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 1.9853825108182817, 'psi': 0.29784120014635934}
[S4] START round=32 head_norm_before_train=1.747409 cos_to_last_merge=0.9661 (last merge round=26)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1476713054683174, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1315989541264597, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.869917 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.270966709975724, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.1981713117988226, 'psi': 0.33300395256917}
[S6] START round=32 head_norm_before_train=1.956376 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 7.835267372277965, 'psi': 0.018663594470046084}-{'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 7.8038257221528315, 'psi': 0.018219557195571955}
[S7] START round=32 head_norm_before_train=1.699341 (no previous merge yet)
[S7] round=32 local utility u=0.008902 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8653294344666854, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.883133273536342, 'psi': 0.35976373724718097}
[S8] START round=32 head_norm_before_train=2.103793 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9042315760272839, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8920711539889188, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.507751 cos_to_last_merge=0.9953 (last merge round=27)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.24451521585279545, 'auprc': 0.24451521585279545, 'loss_val': 2.239036572775106, 'psi': 0.24451521585279545}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.141271997152708, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=1.826778 cos_to_last_merge=0.9869 (last merge round=28)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.781093986926242, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.691267886070851, 'psi': 0.24168834923388266}
[S11] START round=32 head_norm_before_train=2.201002 cos_to_last_merge=0.9998 (last merge round=29)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.3246772968868641, 'auprc': 0.3246772968868641, 'loss_val': 2.2111928046873923, 'psi': 0.3246772968868641}-{'f1_val': 0.32438580527752503, 'auprc': 0.32438580527752503, 'loss_val': 2.1630874021898907, 'psi': 0.32438580527752503}
[S13] START round=32 head_norm_before_train=1.650514 cos_to_last_merge=0.9970 (last merge round=28)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2815360269811011, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.263569001527009, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.725865 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.215238 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.6684445962133116, 'psi': 0.13572854291417166}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.100251193296141, 'psi': 0.13587634006482174}
[S15] START round=32 head_norm_before_train=2.226851 (no previous merge yet)
[S15] round=32 local utility u=0.017461 metrics={'f1_val': 0.6138114033949549, 'auprc': 0.6138114033949549, 'loss_val': 0.5952387191679632, 'psi': 0.6138114033949549}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6528669199715015, 'psi': 0.6163342951580373}
[S16] START round=32 head_norm_before_train=1.812303 cos_to_last_merge=0.9674 (last merge round=26)
[S16] round=32 local utility u=0.114580 metrics={'f1_val': 0.09863704404002206, 'auprc': 0.09863704404002206, 'loss_val': 3.5447964827673073, 'psi': 0.09863704404002206}-{'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 3.6982425641009513, 'psi': 0.09022435897435897}
[S17] START round=32 head_norm_before_train=1.448997 cos_to_last_merge=0.9994 (last merge round=30)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.3827033613397014, 'auprc': 0.3827033613397014, 'loss_val': 1.5468013241284944, 'psi': 0.3827033613397014}-{'f1_val': 0.428485604579821, 'auprc': 0.428485604579821, 'loss_val': 1.3725757107111005, 'psi': 0.428485604579821}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:33214
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.099)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:33214
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9899
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.0494
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.1357 head_norm=1.753472
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.015626e-01
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.1357 head_norm=1.441265 delta_norm=0.701563
[S14] aggregate: ACCEPT kept=['S7', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.999210 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.1665055320522995, 'psi': 0.2653978324081417}-{'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 3.166508413828219, 'psi': 0.2654504593826426}
[S3] START round=33 head_norm_before_train=1.474442 cos_to_last_merge=0.9996 (last merge round=31)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.1659444905112375, 'psi': 0.29773995791014735}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.0114459869912578, 'psi': 0.29784120014635934}
[S4] START round=33 head_norm_before_train=1.766457 cos_to_last_merge=0.9633 (last merge round=26)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.171305123076568, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1476713054683174, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.900464 (no previous merge yet)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.3611993439308794, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.270966709975724, 'psi': 0.33300395256917}
[S6] START round=33 head_norm_before_train=1.963575 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 7.870959467205841, 'psi': 0.01910681399631676}-{'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 7.835267372277965, 'psi': 0.018663594470046084}
[S7] START round=33 head_norm_before_train=1.714461 (no previous merge yet)
[S7] round=33 local utility u=0.008469 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8483918469378806, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8653294344666854, 'psi': 0.35976373724718097}
[S8] START round=33 head_norm_before_train=2.113068 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9308644498237328, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9042315760272839, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.531219 cos_to_last_merge=0.9939 (last merge round=27)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.2423380164799336, 'auprc': 0.2423380164799336, 'loss_val': 2.3252610923996038, 'psi': 0.24233801647993364}-{'f1_val': 0.24451521585279545, 'auprc': 0.24451521585279545, 'loss_val': 2.239036572775106, 'psi': 0.24451521585279545}
[S10] START round=33 head_norm_before_train=1.872445 cos_to_last_merge=0.9832 (last merge round=28)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.24164643311365475, 'auprc': 0.24164643311365475, 'loss_val': 1.8622358942813049, 'psi': 0.24164643311365475}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.781093986926242, 'psi': 0.24168834923388266}
[S11] START round=33 head_norm_before_train=2.212263 cos_to_last_merge=0.9996 (last merge round=29)
[S11] round=33 local utility u=0.011536 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.182179590821336, 'psi': 0.3240172688025449}-{'f1_val': 0.3246772968868641, 'auprc': 0.3246772968868641, 'loss_val': 2.2111928046873923, 'psi': 0.3246772968868641}
[S13] START round=33 head_norm_before_train=1.666034 cos_to_last_merge=0.9959 (last merge round=28)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2942703508611937, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2815360269811011, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=1.441265 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.241056 metrics={'f1_val': 0.13273115042027347, 'auprc': 0.13273115042027347, 'loss_val': 3.159355435343928, 'psi': 0.13273115042027347}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.6684445962133116, 'psi': 0.13572854291417166}
[S15] START round=33 head_norm_before_train=2.238528 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6429852973410095, 'psi': 0.6163342951580373}-{'f1_val': 0.6138114033949549, 'auprc': 0.6138114033949549, 'loss_val': 0.5952387191679632, 'psi': 0.6138114033949549}
[S16] START round=33 head_norm_before_train=1.836851 cos_to_last_merge=0.9635 (last merge round=26)
[S16] round=33 local utility u=0.243266 metrics={'f1_val': 0.13571796570250974, 'auprc': 0.13571796570250974, 'loss_val': 3.3919931053042367, 'psi': 0.13571796570250974}-{'f1_val': 0.09863704404002206, 'auprc': 0.09863704404002206, 'loss_val': 3.5447964827673073, 'psi': 0.09863704404002206}
[S17] START round=33 head_norm_before_train=1.493342 cos_to_last_merge=0.9977 (last merge round=30)
[S17] round=33 local utility u=0.253007 metrics={'f1_val': 0.4298517170623549, 'auprc': 0.4298517170623549, 'loss_val': 1.4651226253028002, 'psi': 0.4298517170623549}-{'f1_val': 0.3827033613397014, 'auprc': 0.3827033613397014, 'loss_val': 1.5468013241284944, 'psi': 0.3827033613397014}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:33214
[S14] not sending this round → trigger blocked (psi=0.133)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9126
[S16] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:33216
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S17
[S16] cosine check vs S17: cos=-0.0084
[S16] DROPPED delta from S17 (cos=-0.0084 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:33215
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=0.9969
[S17]  timeout peer S2
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S16
[S11]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.1327 head_norm=1.476944
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.547426e-01
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.1333 head_norm=1.563544 delta_norm=0.354743
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.6163 head_norm=2.251205
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.857930e-02
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.6163 head_norm=2.234709 delta_norm=0.088579
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=2.006414 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.1677063123855884, 'psi': 0.2654773703336637}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.1665055320522995, 'psi': 0.2653978324081417}
[S3] START round=34 head_norm_before_train=1.502120 cos_to_last_merge=0.9988 (last merge round=31)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.2503755670542263, 'psi': 0.29784120014635934}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.1659444905112375, 'psi': 0.29773995791014735}
[S4] START round=34 head_norm_before_train=1.782070 cos_to_last_merge=0.9612 (last merge round=26)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1932228537259302, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.171305123076568, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=1.927729 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.428028557643702, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.3611993439308794, 'psi': 0.33300395256917}
[S6] START round=34 head_norm_before_train=1.970568 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 7.931930417831046, 'psi': 0.018441678192715538}-{'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 7.870959467205841, 'psi': 0.01910681399631676}
[S7] START round=34 head_norm_before_train=1.720366 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.8553357410919519, 'psi': 0.23953668875753775}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8483918469378806, 'psi': 0.35976373724718097}
[S8] START round=34 head_norm_before_train=2.126732 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9656553701618114, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9308644498237328, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.551568 cos_to_last_merge=0.9927 (last merge round=27)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.24361702127659576, 'auprc': 0.24361702127659576, 'loss_val': 2.3615690333243697, 'psi': 0.24361702127659576}-{'f1_val': 0.2423380164799336, 'auprc': 0.2423380164799336, 'loss_val': 2.3252610923996038, 'psi': 0.24233801647993364}
[S10] START round=34 head_norm_before_train=1.908466 cos_to_last_merge=0.9804 (last merge round=28)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.9375970950224146, 'psi': 0.24168834923388266}-{'f1_val': 0.24164643311365475, 'auprc': 0.24164643311365475, 'loss_val': 1.8622358942813049, 'psi': 0.24164643311365475}
[S11] START round=34 head_norm_before_train=2.221624 cos_to_last_merge=0.9994 (last merge round=29)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.34665428537525, 'psi': 0.33154997286190585}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.182179590821336, 'psi': 0.3240172688025449}
[S13] START round=34 head_norm_before_train=1.678925 cos_to_last_merge=0.9949 (last merge round=28)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3096914827968857, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2942703508611937, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=1.563544 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.3405863834764555, 'psi': 0.13572854291417166}-{'f1_val': 0.13273115042027347, 'auprc': 0.13273115042027347, 'loss_val': 3.159355435343928, 'psi': 0.13273115042027347}
[S15] START round=34 head_norm_before_train=2.234709 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.6733283545958163, 'psi': 0.612395395031292}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6429852973410095, 'psi': 0.6163342951580373}
[S16] START round=34 head_norm_before_train=1.856642 cos_to_last_merge=0.9604 (last merge round=26)
[S16] round=34 local utility u=0.046535 metrics={'f1_val': 0.1415156147630487, 'auprc': 0.1415156147630487, 'loss_val': 3.3511018590218877, 'psi': 0.1415156147630487}-{'f1_val': 0.13571796570250974, 'auprc': 0.13571796570250974, 'loss_val': 3.3919931053042367, 'psi': 0.13571796570250974}
[S17] START round=34 head_norm_before_train=1.526567 cos_to_last_merge=0.9960 (last merge round=30)
[S17] round=34 local utility u=1.000000 metrics={'f1_val': 0.6417067391165674, 'auprc': 0.6417067391165674, 'loss_val': 0.9855560295677269, 'psi': 0.6417067391165674}-{'f1_val': 0.4298517170623549, 'auprc': 0.4298517170623549, 'loss_val': 1.4651226253028002, 'psi': 0.4298517170623549}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.142)
[S3] CommDone barrier timeout: have=1 need=2 — continuing
[S17] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:33216
[S17] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S17
[S16] cosine check vs S17: cos=-0.0056
[S16] DROPPED delta from S17 (cos=-0.0056 < 0.0)
[S3]  timeout peer S10
[S3]  timeout peer S17
[S14]  timeout peer S7
[S16]  timeout peer S5
[S11]  timeout peer S15
[S15]  timeout peer S14
[S13]  timeout peer S2
[S13]  timeout peer S11
[S4]  timeout peer S13
[S9]  timeout peer S3
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S16
[S2] START round=35 head_norm_before_train=2.013245 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.173622579237208, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.1677063123855884, 'psi': 0.2654773703336637}
[S3] START round=35 head_norm_before_train=1.527938 cos_to_last_merge=0.9976 (last merge round=31)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.3655594344968582, 'psi': 0.29773995791014735}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.2503755670542263, 'psi': 0.29784120014635934}
[S4] START round=35 head_norm_before_train=1.794845 cos_to_last_merge=0.9605 (last merge round=26)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.217920247446856, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1932228537259302, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=1.955025 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.435588911044581, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.428028557643702, 'psi': 0.33300395256917}
[S6] START round=35 head_norm_before_train=1.977487 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 7.9790958618445424, 'psi': 0.018441678192715538}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 7.931930417831046, 'psi': 0.018441678192715538}
[S7] START round=35 head_norm_before_train=1.723557 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.862108953812589, 'psi': 0.23976608187134504}-{'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.8553357410919519, 'psi': 0.23953668875753775}
[S8] START round=35 head_norm_before_train=2.136744 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9843147031041286, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9656553701618114, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.569051 cos_to_last_merge=0.9916 (last merge round=27)
[S9] round=35 local utility u=0.004625 metrics={'f1_val': 0.24526080301424702, 'auprc': 0.24526080301424702, 'loss_val': 2.367112911476041, 'psi': 0.24526080301424702}-{'f1_val': 0.24361702127659576, 'auprc': 0.24361702127659576, 'loss_val': 2.3615690333243697, 'psi': 0.24361702127659576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=35 head_norm_before_train=1.938513 cos_to_last_merge=0.9780 (last merge round=28)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.9966033820478875, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.9375970950224146, 'psi': 0.24168834923388266}
[S11] START round=35 head_norm_before_train=2.230057 cos_to_last_merge=0.9991 (last merge round=29)
[S11] round=35 local utility u=0.044822 metrics={'f1_val': 0.31987438313144906, 'auprc': 0.31987438313144906, 'loss_val': 2.151929112522065, 'psi': 0.31987438313144906}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.34665428537525, 'psi': 0.33154997286190585}
[S13] START round=35 head_norm_before_train=1.694459 cos_to_last_merge=0.9938 (last merge round=28)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3204169918902375, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3096914827968857, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.603269 cos_to_last_merge=0.9989 (last merge round=33)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13433395872420262, 'auprc': 0.13433395872420262, 'loss_val': 3.7036181615250268, 'psi': 0.13433395872420262}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.3405863834764555, 'psi': 0.13572854291417166}
[S15] START round=35 head_norm_before_train=2.246761 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=35 local utility u=0.027504 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6537712832354811, 'psi': 0.6163342951580373}-{'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.6733283545958163, 'psi': 0.612395395031292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=35 head_norm_before_train=1.873356 cos_to_last_merge=0.9578 (last merge round=26)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.14277414669571534, 'auprc': 0.14277414669571534, 'loss_val': 3.3990128453931088, 'psi': 0.14277414669571534}-{'f1_val': 0.1415156147630487, 'auprc': 0.1415156147630487, 'loss_val': 3.3511018590218877, 'psi': 0.1415156147630487}
[S17] START round=35 head_norm_before_train=1.562741 cos_to_last_merge=0.9941 (last merge round=30)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.44112673500411675, 'auprc': 0.44112673500411675, 'loss_val': 1.5386189540273711, 'psi': 0.44112673500411675}-{'f1_val': 0.6417067391165674, 'auprc': 0.6417067391165674, 'loss_val': 0.9855560295677269, 'psi': 0.6417067391165674}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:33207
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.011 → S13@127.0.0.1:33213
[S7] ⇄ pheromone p=0.054 → S14@127.0.0.1:33214
[S16] ⇄ pheromone p=0.144 → S17@127.0.0.1:33217
[S5] ⇄ pheromone p=0.003 → S16@127.0.0.1:33216
[S11] sending update (kind=head size=1794 to 1 peers)
[S6] ⇄ pheromone p=0.008 → S11@127.0.0.1:33212
[S10] ⇄ pheromone p=0.009 → S4@127.0.0.1:33204
[S14] ⇄ pheromone p=0.076 → S15@127.0.0.1:33215
[S6] RECEIVED delta(kind=head bytes=1794) from S11
[S6] cosine check vs S11: cos=-0.0192
[S6] DROPPED delta from S11 (cos=-0.0192 < 0.0)
[S11] ⇄ pheromone p=0.014 → S6@127.0.0.1:33207
[S2] START round=36 head_norm_before_train=2.020053 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.1941913195225835, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.173622579237208, 'psi': 0.2654773703336637}
[S3] START round=36 head_norm_before_train=1.551199 cos_to_last_merge=0.9964 (last merge round=31)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.4252622723820876, 'psi': 0.29784120014635934}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.3655594344968582, 'psi': 0.29773995791014735}
[S4] START round=36 head_norm_before_train=1.810786 cos_to_last_merge=0.9587 (last merge round=26)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2449010297211325, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.217920247446856, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=1.979026 (no previous merge yet)
[S5] round=36 local utility u=0.033779 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.368031326102326, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.435588911044581, 'psi': 0.33300395256917}
[S6] START round=36 head_norm_before_train=1.984206 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 8.039440497766767, 'psi': 0.01799723119520074}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 7.9790958618445424, 'psi': 0.018441678192715538}
[S7] START round=36 head_norm_before_train=1.727675 (no previous merge yet)
[S7] round=36 local utility u=0.529651 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8827856839717855, 'psi': 0.35976373724718097}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.862108953812589, 'psi': 0.23976608187134504}
[S8] START round=36 head_norm_before_train=2.148479 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0091767639533216, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9843147031041286, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.584286 cos_to_last_merge=0.9907 (last merge round=27)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.245409604519774, 'auprc': 0.245409604519774, 'loss_val': 2.404671458698395, 'psi': 0.245409604519774}-{'f1_val': 0.24526080301424702, 'auprc': 0.24526080301424702, 'loss_val': 2.367112911476041, 'psi': 0.24526080301424702}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.963102 cos_to_last_merge=0.9761 (last merge round=28)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.0472905879489107, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.9966033820478875, 'psi': 0.24168834923388266}
[S11] START round=36 head_norm_before_train=2.237483 cos_to_last_merge=0.9989 (last merge round=29)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.32335600907029477, 'auprc': 0.32335600907029477, 'loss_val': 2.1860178179554826, 'psi': 0.32335600907029477}-{'f1_val': 0.31987438313144906, 'auprc': 0.31987438313144906, 'loss_val': 2.151929112522065, 'psi': 0.31987438313144906}
[S13] START round=36 head_norm_before_train=1.709928 cos_to_last_merge=0.9926 (last merge round=28)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4023599237822166, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3204169918902375, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.641826 cos_to_last_merge=0.9964 (last merge round=33)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.1329320290945573, 'auprc': 0.1329320290945573, 'loss_val': 4.004789889296019, 'psi': 0.1329320290945573}-{'f1_val': 0.13433395872420262, 'auprc': 0.13433395872420262, 'loss_val': 3.7036181615250268, 'psi': 0.13433395872420262}
[S15] START round=36 head_norm_before_train=2.256366 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=36 local utility u=0.005688 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6423958569661858, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6537712832354811, 'psi': 0.6163342951580373}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=36 head_norm_before_train=1.887477 cos_to_last_merge=0.9557 (last merge round=26)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.1409415537093718, 'auprc': 0.1409415537093718, 'loss_val': 3.5083066530311617, 'psi': 0.1409415537093718}-{'f1_val': 0.14277414669571534, 'auprc': 0.14277414669571534, 'loss_val': 3.3990128453931088, 'psi': 0.14277414669571534}
[S17] START round=36 head_norm_before_train=1.594367 cos_to_last_merge=0.9925 (last merge round=30)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.35063770414427076, 'auprc': 0.35063770414427076, 'loss_val': 1.7341270039286454, 'psi': 0.35063770414427076}-{'f1_val': 0.44112673500411675, 'auprc': 0.44112673500411675, 'loss_val': 1.5386189540273711, 'psi': 0.44112673500411675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=2.026434 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.209183278916678, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.1941913195225835, 'psi': 0.2654773703336637}
[S3] START round=37 head_norm_before_train=1.572816 cos_to_last_merge=0.9952 (last merge round=31)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.4472678306133444, 'psi': 0.29784120014635934}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.4252622723820876, 'psi': 0.29784120014635934}
[S4] START round=37 head_norm_before_train=1.829667 cos_to_last_merge=0.9567 (last merge round=26)
[S4] round=37 local utility u=0.007202 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.230496215739845, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2449010297211325, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=1.995570 (no previous merge yet)
[S5] round=37 local utility u=0.024026 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.3199799003575055, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.368031326102326, 'psi': 0.33300395256917}
[S6] START round=37 head_norm_before_train=1.990681 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 8.080754568395124, 'psi': 0.018219557195571955}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 8.039440497766767, 'psi': 0.01799723119520074}
[S7] START round=37 head_norm_before_train=1.731046 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8962568940313269, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8827856839717855, 'psi': 0.35976373724718097}
[S8] START round=37 head_norm_before_train=2.161502 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0361217387157544, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0091767639533216, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.598486 cos_to_last_merge=0.9898 (last merge round=27)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.2448883389311178, 'auprc': 0.2448883389311178, 'loss_val': 2.463995207547286, 'psi': 0.2448883389311178}-{'f1_val': 0.245409604519774, 'auprc': 0.245409604519774, 'loss_val': 2.404671458698395, 'psi': 0.245409604519774}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.984778 cos_to_last_merge=0.9743 (last merge round=28)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.099522574126239, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.0472905879489107, 'psi': 0.24168834923388266}
[S11] START round=37 head_norm_before_train=2.244883 cos_to_last_merge=0.9986 (last merge round=29)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.2956059330424057, 'psi': 0.3240909090909091}-{'f1_val': 0.32335600907029477, 'auprc': 0.32335600907029477, 'loss_val': 2.1860178179554826, 'psi': 0.32335600907029477}
[S13] START round=37 head_norm_before_train=1.725630 cos_to_last_merge=0.9912 (last merge round=28)
[S13] round=37 local utility u=0.009778 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.382803466901807, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4023599237822166, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=37 head_norm_before_train=1.675732 cos_to_last_merge=0.9934 (last merge round=33)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 4.222024681300581, 'psi': 0.1347331583552056}-{'f1_val': 0.1329320290945573, 'auprc': 0.1329320290945573, 'loss_val': 4.004789889296019, 'psi': 0.1329320290945573}
[S15] START round=37 head_norm_before_train=2.266248 cos_to_last_merge=0.9999 (last merge round=33)
[S15] round=37 local utility u=0.012549 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6085039629766592, 'psi': 0.6153571007984797}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6423958569661858, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=37 head_norm_before_train=1.899474 cos_to_last_merge=0.9539 (last merge round=26)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.1371210452910519, 'auprc': 0.1371210452910519, 'loss_val': 3.6508857566906485, 'psi': 0.1371210452910519}-{'f1_val': 0.1409415537093718, 'auprc': 0.1409415537093718, 'loss_val': 3.5083066530311617, 'psi': 0.1409415537093718}
[S17] START round=37 head_norm_before_train=1.616389 cos_to_last_merge=0.9912 (last merge round=30)
[S17] round=37 local utility u=1.000000 metrics={'f1_val': 0.7584513705291457, 'auprc': 0.7584513705291457, 'loss_val': 0.7714548547357859, 'psi': 0.7584513705291457}-{'f1_val': 0.35063770414427076, 'auprc': 0.35063770414427076, 'loss_val': 1.7341270039286454, 'psi': 0.35063770414427076}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:33211
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.333)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] cosine check vs S4: cos=0.8819
[S2] START round=38 head_norm_before_train=2.032596 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.2212553254018332, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.209183278916678, 'psi': 0.2654773703336637}
[S3] START round=38 head_norm_before_train=1.591834 cos_to_last_merge=0.9941 (last merge round=31)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.466338666661045, 'psi': 0.29784120014635934}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.4472678306133444, 'psi': 0.29784120014635934}
[S4] START round=38 head_norm_before_train=1.847812 cos_to_last_merge=0.9548 (last merge round=26)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.238661978379616, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.230496215739845, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=2.008361 (no previous merge yet)
[S5] round=38 local utility u=0.009073 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.301834808658471, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.3199799003575055, 'psi': 0.33300395256917}
[S6] START round=38 head_norm_before_train=1.996936 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 8.11111143596082, 'psi': 0.018441678192715538}-{'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 8.080754568395124, 'psi': 0.018219557195571955}
[S7] START round=38 head_norm_before_train=1.735096 (no previous merge yet)
[S7] round=38 local utility u=0.006163 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8839305980505444, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8962568940313269, 'psi': 0.35976373724718097}
[S8] START round=38 head_norm_before_train=2.172174 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.054843238219355, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0361217387157544, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.611488 cos_to_last_merge=0.9889 (last merge round=27)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.24436578171091447, 'auprc': 0.24436578171091447, 'loss_val': 2.502988696607746, 'psi': 0.24436578171091447}-{'f1_val': 0.2448883389311178, 'auprc': 0.2448883389311178, 'loss_val': 2.463995207547286, 'psi': 0.2448883389311178}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.005054 cos_to_last_merge=0.9727 (last merge round=28)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.1460107505972905, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.099522574126239, 'psi': 0.24168834923388266}
[S11] START round=38 head_norm_before_train=2.252318 cos_to_last_merge=0.9984 (last merge round=29)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.32438580527752503, 'auprc': 0.32438580527752503, 'loss_val': 2.3327253006233133, 'psi': 0.32438580527752503}-{'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.2956059330424057, 'psi': 0.3240909090909091}
[S13] START round=38 head_norm_before_train=1.733713 cos_to_last_merge=0.9905 (last merge round=28)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4158867495472547, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.382803466901807, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.704569 cos_to_last_merge=0.9905 (last merge round=33)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.398219572148083, 'psi': 0.13572854291417166}-{'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 4.222024681300581, 'psi': 0.1347331583552056}
[S15] START round=38 head_norm_before_train=2.277348 cos_to_last_merge=0.9999 (last merge round=33)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6429820567182616, 'psi': 0.6161950003225232}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6085039629766592, 'psi': 0.6153571007984797}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.908956 cos_to_last_merge=0.9526 (last merge round=26)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.13548339592077166, 'auprc': 0.13548339592077166, 'loss_val': 3.7584742674215197, 'psi': 0.13548339592077166}-{'f1_val': 0.1371210452910519, 'auprc': 0.1371210452910519, 'loss_val': 3.6508857566906485, 'psi': 0.1371210452910519}
[S17] START round=38 head_norm_before_train=1.639441 cos_to_last_merge=0.9899 (last merge round=30)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.3841684631158315, 'auprc': 0.3841684631158315, 'loss_val': 1.7280006716462728, 'psi': 0.3841684631158315}-{'f1_val': 0.7584513705291457, 'auprc': 0.7584513705291457, 'loss_val': 0.7714548547357859, 'psi': 0.7584513705291457}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=38 metric=0.2417 head_norm=2.023270
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.827126e-01
[S10] stored merged vector for next round verification (round=38)
[S10] DEBUG after merge:  round=38 metric=0.2417 head_norm=1.876433 delta_norm=0.482713
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=2.038911 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.23668792636624, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.2212553254018332, 'psi': 0.2654773703336637}
[S3] START round=39 head_norm_before_train=1.608704 cos_to_last_merge=0.9930 (last merge round=31)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.5053919726882428, 'psi': 0.29784120014635934}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.466338666661045, 'psi': 0.29784120014635934}
[S4] START round=39 head_norm_before_train=1.868223 cos_to_last_merge=0.9524 (last merge round=26)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.257398155290195, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.238661978379616, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=2.021759 (no previous merge yet)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.302550541199839, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.301834808658471, 'psi': 0.33300395256917}
[S6] START round=39 head_norm_before_train=2.002954 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 8.1376812425219, 'psi': 0.01910681399631676}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 8.11111143596082, 'psi': 0.018441678192715538}
[S7] START round=39 head_norm_before_train=1.741037 (no previous merge yet)
[S7] round=39 local utility u=0.002494 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8789425034538974, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8839305980505444, 'psi': 0.35976373724718097}
[S8] START round=39 head_norm_before_train=2.182281 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.071764291009961, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.054843238219355, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0007 f1=0.359 auprc=0.359 bytes=7198
[S9] START round=39 head_norm_before_train=1.623164 cos_to_last_merge=0.9881 (last merge round=27)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.24518636283342166, 'auprc': 0.24518636283342166, 'loss_val': 2.5115916650200916, 'psi': 0.24518636283342166}-{'f1_val': 0.24436578171091447, 'auprc': 0.24436578171091447, 'loss_val': 2.502988696607746, 'psi': 0.24436578171091447}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.245 u=0.0000 p_local=0.0330 f1=0.245 auprc=0.245 bytes=16200
[S10] START round=39 head_norm_before_train=1.876433 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=39 local utility u=0.155722 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.8345672964340987, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.1460107505972905, 'psi': 0.24168834923388266}
[S11] START round=39 head_norm_before_train=2.259664 cos_to_last_merge=0.9981 (last merge round=29)
[S11] round=39 local utility u=0.013176 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.303056876591472, 'psi': 0.3240172688025449}-{'f1_val': 0.32438580527752503, 'auprc': 0.32438580527752503, 'loss_val': 2.3327253006233133, 'psi': 0.32438580527752503}
[S13] START round=39 head_norm_before_train=1.738656 cos_to_last_merge=0.9902 (last merge round=28)
[S13] round=39 local utility u=0.015332 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3852231277342388, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4158867495472547, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] r=40 psi=0.360 u=0.0153 p_local=0.0054 f1=0.360 auprc=0.360 bytes=23418
[S14] START round=39 head_norm_before_train=1.728345 cos_to_last_merge=0.9881 (last merge round=33)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.543447512724651, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.398219572148083, 'psi': 0.13572854291417166}
[S15] START round=39 head_norm_before_train=2.288098 cos_to_last_merge=0.9998 (last merge round=33)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6645046394767057, 'psi': 0.6163342951580373}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6429820567182616, 'psi': 0.6161950003225232}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.616 u=0.0000 p_local=0.0068 f1=0.616 auprc=0.616 bytes=30592
[S16] START round=39 head_norm_before_train=1.918551 cos_to_last_merge=0.9512 (last merge round=26)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.13548339592077166, 'auprc': 0.13548339592077166, 'loss_val': 3.8075751246509024, 'psi': 0.13548339592077166}-{'f1_val': 0.13548339592077166, 'auprc': 0.13548339592077166, 'loss_val': 3.7584742674215197, 'psi': 0.13548339592077166}
[S17] START round=39 head_norm_before_train=1.660115 cos_to_last_merge=0.9887 (last merge round=30)
[S17] round=39 local utility u=0.004805 metrics={'f1_val': 0.3885441367038267, 'auprc': 0.3885441367038267, 'loss_val': 1.7577717257575163, 'psi': 0.3885441367038267}-{'f1_val': 0.3841684631158315, 'auprc': 0.3841684631158315, 'loss_val': 1.7280006716462728, 'psi': 0.3841684631158315}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.360)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:33207
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.298 u=0.0000 p_local=0.0106 f1=0.298 auprc=0.298 bytes=9005
[S5] r=40 psi=0.333 u=0.0000 p_local=0.0094 f1=0.333 auprc=0.333 bytes=19805
[S2] r=40 psi=0.265 u=0.0000 p_local=0.0046 f1=0.265 auprc=0.265 bytes=17998
[S11] sending update (kind=head size=1804 to 1 peers)
[S17] r=40 psi=0.389 u=0.0048 p_local=0.2297 f1=0.389 auprc=0.389 bytes=30622
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0023 f1=0.357 auprc=0.357 bytes=27024
[S10] r=40 psi=0.242 u=0.1557 p_local=0.0348 f1=0.242 auprc=0.242 bytes=23422
[S6] r=40 psi=0.019 u=0.0000 p_local=0.0033 f1=0.019 auprc=0.019 bytes=0
[S7] r=40 psi=0.360 u=0.0025 p_local=0.0779 f1=0.360 auprc=0.360 bytes=25206
[S16] r=40 psi=0.135 u=0.0000 p_local=0.0590 f1=0.135 auprc=0.135 bytes=0
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0309 f1=0.136 auprc=0.136 bytes=0
[S6] RECEIVED delta(kind=head bytes=1804) from S11
[S6] cosine check vs S11: cos=-0.0202
[S6] DROPPED delta from S11 (cos=-0.0202 < 0.0)
[S11] r=40 psi=0.324 u=0.0132 p_local=0.0084 f1=0.324 auprc=0.324 bytes=17992
[S2] START round=40 head_norm_before_train=2.045038 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.2495302281597427, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.23668792636624, 'psi': 0.2654773703336637}
[S3] START round=40 head_norm_before_train=1.623816 cos_to_last_merge=0.9919 (last merge round=31)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.5661452880334132, 'psi': 0.29784120014635934}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.5053919726882428, 'psi': 0.29784120014635934}
[S4] START round=40 head_norm_before_train=1.883526 cos_to_last_merge=0.9503 (last merge round=26)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2877004513155634, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.257398155290195, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=2.037373 (no previous merge yet)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.325662251201139, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.302550541199839, 'psi': 0.33300395256917}
[S6] START round=40 head_norm_before_train=2.008755 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 8.197990733100767, 'psi': 0.018219557195571955}-{'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 8.1376812425219, 'psi': 0.01910681399631676}
[S7] START round=40 head_norm_before_train=1.745462 (no previous merge yet)
[S7] round=40 local utility u=0.011391 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8561605496745519, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8789425034538974, 'psi': 0.35976373724718097}
[S8] START round=40 head_norm_before_train=2.193397 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0961845537282717, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.071764291009961, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.633816 cos_to_last_merge=0.9874 (last merge round=27)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.24548396587231539, 'auprc': 0.24548396587231539, 'loss_val': 2.5214641187799294, 'psi': 0.24548396587231539}-{'f1_val': 0.24518636283342166, 'auprc': 0.24518636283342166, 'loss_val': 2.5115916650200916, 'psi': 0.24518636283342166}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.907587 cos_to_last_merge=0.9998 (last merge round=38)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.9168972436865102, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.8345672964340987, 'psi': 0.24168834923388266}
[S11] START round=40 head_norm_before_train=2.266646 cos_to_last_merge=0.9978 (last merge round=29)
[S11] round=40 local utility u=0.017847 metrics={'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.265376136563347, 'psi': 0.3237965485921889}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.303056876591472, 'psi': 0.3240172688025449}
[S13] START round=40 head_norm_before_train=1.743990 cos_to_last_merge=0.9898 (last merge round=28)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4550684753420169, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3852231277342388, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.748343 cos_to_last_merge=0.9859 (last merge round=33)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.665123020160934, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.543447512724651, 'psi': 0.13572854291417166}
[S15] START round=40 head_norm_before_train=2.298386 cos_to_last_merge=0.9998 (last merge round=33)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.671568536008531, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6645046394767057, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.927854 cos_to_last_merge=0.9498 (last merge round=26)
[S16] ⚠️ Model drifted since last merge! cos=0.950
[S16] round=40 local utility u=0.007214 metrics={'f1_val': 0.13688771388705295, 'auprc': 0.13688771388705295, 'loss_val': 3.805786753754357, 'psi': 0.13688771388705295}-{'f1_val': 0.13548339592077166, 'auprc': 0.13548339592077166, 'loss_val': 3.8075751246509024, 'psi': 0.13548339592077166}
[S17] START round=40 head_norm_before_train=1.681323 cos_to_last_merge=0.9875 (last merge round=30)
[S17] round=40 local utility u=0.499264 metrics={'f1_val': 0.47723400373376934, 'auprc': 0.47723400373376934, 'loss_val': 1.557452751755843, 'psi': 0.47723400373376934}-{'f1_val': 0.3885441367038267, 'auprc': 0.3885441367038267, 'loss_val': 1.7577717257575163, 'psi': 0.3885441367038267}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.477)
[S16] not sending this round → trigger blocked (psi=0.137)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] not sending this round → trigger blocked (psi=0.324)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.002 → S10@127.0.0.1:33211
[S11] ⇄ pheromone p=0.010 → S6@127.0.0.1:33207
[S6] ⇄ pheromone p=0.003 → S11@127.0.0.1:33212
[S2] START round=41 head_norm_before_train=2.050960 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.2581972679342956, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.2495302281597427, 'psi': 0.2654773703336637}
[S3] START round=41 head_norm_before_train=1.637918 cos_to_last_merge=0.9910 (last merge round=31)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.6222764704405797, 'psi': 0.29784120014635934}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.5661452880334132, 'psi': 0.29784120014635934}
[S4] START round=41 head_norm_before_train=1.892367 cos_to_last_merge=0.9485 (last merge round=26)
[S4] ⚠️ Model drifted since last merge! cos=0.948
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3360181210070858, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2877004513155634, 'psi': 0.3567939207526687}
[S5] START round=41 head_norm_before_train=2.055044 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.337446396644028, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.325662251201139, 'psi': 0.33300395256917}
[S6] START round=41 head_norm_before_train=2.014600 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 8.239358984403511, 'psi': 0.018219557195571955}-{'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 8.197990733100767, 'psi': 0.018219557195571955}
[S7] START round=41 head_norm_before_train=1.750477 (no previous merge yet)
[S7] round=41 local utility u=0.012872 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8304162790543458, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8561605496745519, 'psi': 0.35976373724718097}
[S8] START round=41 head_norm_before_train=2.205241 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.116789628398039, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0961845537282717, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.643481 cos_to_last_merge=0.9867 (last merge round=27)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.245409604519774, 'auprc': 0.245409604519774, 'loss_val': 2.5424561753586983, 'psi': 0.245409604519774}-{'f1_val': 0.24548396587231539, 'auprc': 0.24548396587231539, 'loss_val': 2.5214641187799294, 'psi': 0.24548396587231539}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.949668 cos_to_last_merge=0.9991 (last merge round=38)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.9837212123595767, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.9168972436865102, 'psi': 0.24168834923388266}
[S11] START round=41 head_norm_before_train=2.273446 cos_to_last_merge=0.9976 (last merge round=29)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.297410468390066, 'psi': 0.3237965485921889}-{'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.265376136563347, 'psi': 0.3237965485921889}
[S13] START round=41 head_norm_before_train=1.754474 cos_to_last_merge=0.9888 (last merge round=28)
[S13] round=41 local utility u=0.005766 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4435372709622378, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4550684753420169, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=41 head_norm_before_train=1.765583 cos_to_last_merge=0.9841 (last merge round=33)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.766410082302566, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.665123020160934, 'psi': 0.13572854291417166}
[S15] START round=41 head_norm_before_train=2.309531 cos_to_last_merge=0.9997 (last merge round=33)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.686650765156505, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.671568536008531, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.936822 cos_to_last_merge=0.9485 (last merge round=26)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.1371210452910519, 'auprc': 0.1371210452910519, 'loss_val': 3.8372120046673746, 'psi': 0.1371210452910519}-{'f1_val': 0.13688771388705295, 'auprc': 0.13688771388705295, 'loss_val': 3.805786753754357, 'psi': 0.13688771388705295}
[S17] START round=41 head_norm_before_train=1.705746 cos_to_last_merge=0.9860 (last merge round=30)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.4669943221445109, 'auprc': 0.4669943221445109, 'loss_val': 1.63701990175896, 'psi': 0.4669943221445109}-{'f1_val': 0.47723400373376934, 'auprc': 0.47723400373376934, 'loss_val': 1.557452751755843, 'psi': 0.47723400373376934}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.360)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=2.056835 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.2633039794574388, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.2581972679342956, 'psi': 0.2654773703336637}
[S3] START round=42 head_norm_before_train=1.650899 cos_to_last_merge=0.9900 (last merge round=31)
[S3] round=42 local utility u=0.015124 metrics={'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.592939961441203, 'psi': 0.2979423868312757}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.6222764704405797, 'psi': 0.29784120014635934}
[S4] START round=42 head_norm_before_train=1.894217 cos_to_last_merge=0.9471 (last merge round=26)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3712110329309624, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3360181210070858, 'psi': 0.3567939207526687}
[S5] START round=42 head_norm_before_train=2.071291 (no previous merge yet)
[S5] round=42 local utility u=0.012880 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.311685808121058, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.337446396644028, 'psi': 0.33300395256917}
[S6] START round=42 head_norm_before_train=2.020285 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 8.284934986533484, 'psi': 0.017774699907663897}-{'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 8.239358984403511, 'psi': 0.018219557195571955}
[S7] START round=42 head_norm_before_train=1.754121 (no previous merge yet)
[S7] round=42 local utility u=0.014624 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8011673215942308, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8304162790543458, 'psi': 0.35976373724718097}
[S8] START round=42 head_norm_before_train=2.216451 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1364366795259104, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.116789628398039, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.652641 cos_to_last_merge=0.9861 (last merge round=27)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.24526080301424702, 'auprc': 0.24526080301424702, 'loss_val': 2.5678347714792418, 'psi': 0.24526080301424702}-{'f1_val': 0.245409604519774, 'auprc': 0.245409604519774, 'loss_val': 2.5424561753586983, 'psi': 0.245409604519774}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.988993 cos_to_last_merge=0.9980 (last merge round=38)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.059427707766574, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 1.9837212123595767, 'psi': 0.24168834923388266}
[S11] START round=42 head_norm_before_train=2.279864 cos_to_last_merge=0.9973 (last merge round=29)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.3584205219402516, 'psi': 0.3240172688025449}-{'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.297410468390066, 'psi': 0.3237965485921889}
[S13] START round=42 head_norm_before_train=1.769417 cos_to_last_merge=0.9873 (last merge round=28)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.45637764597111, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4435372709622378, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.780666 cos_to_last_merge=0.9825 (last merge round=33)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.8524758269293695, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.766410082302566, 'psi': 0.13572854291417166}
[S15] START round=42 head_norm_before_train=2.320445 cos_to_last_merge=0.9996 (last merge round=33)
[S15] round=42 local utility u=0.002342 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6819676286252183, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.686650765156505, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=42 head_norm_before_train=1.944319 cos_to_last_merge=0.9475 (last merge round=26)
[S16] ⚠️ Model drifted since last merge! cos=0.947
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.13828462608950412, 'auprc': 0.13828462608950412, 'loss_val': 3.851502198181095, 'psi': 0.13828462608950412}-{'f1_val': 0.1371210452910519, 'auprc': 0.1371210452910519, 'loss_val': 3.8372120046673746, 'psi': 0.1371210452910519}
[S17] START round=42 head_norm_before_train=1.729481 cos_to_last_merge=0.9848 (last merge round=30)
[S17] round=42 local utility u=0.359810 metrics={'f1_val': 0.5236242114830921, 'auprc': 0.5236242114830921, 'loss_val': 1.4270688383288508, 'psi': 0.5236242114830921}-{'f1_val': 0.4669943221445109, 'auprc': 0.4669943221445109, 'loss_val': 1.63701990175896, 'psi': 0.4669943221445109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=2.062661 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.271305483848388, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.2633039794574388, 'psi': 0.2654773703336637}
[S3] START round=43 head_norm_before_train=1.662803 cos_to_last_merge=0.9892 (last merge round=31)
[S3] round=43 local utility u=0.001452 metrics={'f1_val': 0.2976973684210526, 'auprc': 0.2976973684210526, 'loss_val': 2.5878312441133846, 'psi': 0.2976973684210526}-{'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.592939961441203, 'psi': 0.2979423868312757}
[S4] START round=43 head_norm_before_train=1.902368 cos_to_last_merge=0.9453 (last merge round=26)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4024558890428624, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3712110329309624, 'psi': 0.3567939207526687}
[S5] START round=43 head_norm_before_train=2.080079 (no previous merge yet)
[S5] round=43 local utility u=0.026721 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.258243096672593, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.311685808121058, 'psi': 0.33300395256917}
[S6] START round=43 head_norm_before_train=2.025806 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 8.32445066325219, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 8.284934986533484, 'psi': 0.017774699907663897}
[S7] START round=43 head_norm_before_train=1.757850 (no previous merge yet)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.7998466270871192, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8011673215942308, 'psi': 0.35976373724718097}
[S8] START round=43 head_norm_before_train=2.227238 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.157502185526352, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1364366795259104, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.661574 cos_to_last_merge=0.9855 (last merge round=27)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.24511189634864547, 'auprc': 0.24511189634864547, 'loss_val': 2.599475511214164, 'psi': 0.2451118963486455}-{'f1_val': 0.24526080301424702, 'auprc': 0.24526080301424702, 'loss_val': 2.5678347714792418, 'psi': 0.24526080301424702}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.024142 cos_to_last_merge=0.9967 (last merge round=38)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.1306111312716545, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.059427707766574, 'psi': 0.24168834923388266}
[S11] START round=43 head_norm_before_train=2.286131 cos_to_last_merge=0.9971 (last merge round=29)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.4065748618682306, 'psi': 0.3240909090909091}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.3584205219402516, 'psi': 0.3240172688025449}
[S13] START round=43 head_norm_before_train=1.780821 cos_to_last_merge=0.9862 (last merge round=28)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.511245197529138, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.45637764597111, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.794141 cos_to_last_merge=0.9810 (last merge round=33)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.927924192453927, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.8524758269293695, 'psi': 0.13572854291417166}
[S15] START round=43 head_norm_before_train=2.330214 cos_to_last_merge=0.9995 (last merge round=33)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6986472202513564, 'psi': 0.6153571007984797}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6819676286252183, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.951163 cos_to_last_merge=0.9465 (last merge round=26)
[S16] ⚠️ Model drifted since last merge! cos=0.947
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.13944310458232842, 'auprc': 0.13944310458232842, 'loss_val': 3.8647345415438403, 'psi': 0.13944310458232842}-{'f1_val': 0.13828462608950412, 'auprc': 0.13828462608950412, 'loss_val': 3.851502198181095, 'psi': 0.13828462608950412}
[S17] START round=43 head_norm_before_train=1.751527 cos_to_last_merge=0.9834 (last merge round=30)
[S17] round=43 local utility u=1.000000 metrics={'f1_val': 0.7027875786885573, 'auprc': 0.7027875786885573, 'loss_val': 0.9888402858857541, 'psi': 0.7027875786885573}-{'f1_val': 0.5236242114830921, 'auprc': 0.5236242114830921, 'loss_val': 1.4270688383288508, 'psi': 0.5236242114830921}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.703)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.333)
[S3] not sending this round → trigger blocked (psi=0.298)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=2.068171 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.292778649365324, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.271305483848388, 'psi': 0.2654773703336637}
[S3] START round=44 head_norm_before_train=1.673764 cos_to_last_merge=0.9884 (last merge round=31)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.702848591548138, 'psi': 0.29784120014635934}-{'f1_val': 0.2976973684210526, 'auprc': 0.2976973684210526, 'loss_val': 2.5878312441133846, 'psi': 0.2976973684210526}
[S4] START round=44 head_norm_before_train=1.917230 cos_to_last_merge=0.9436 (last merge round=26)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=44 local utility u=0.016603 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3692503091242179, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4024558890428624, 'psi': 0.3567939207526687}
[S5] START round=44 head_norm_before_train=2.088365 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.2760595724675174, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.258243096672593, 'psi': 0.33300395256917}
[S6] START round=44 head_norm_before_train=2.031008 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 8.355418432947223, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 8.32445066325219, 'psi': 0.017774699907663897}
[S7] START round=44 head_norm_before_train=1.763160 (no previous merge yet)
[S7] round=44 local utility u=0.533338 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8138382939154879, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.7998466270871192, 'psi': 0.23968964488212474}
[S8] START round=44 head_norm_before_train=2.237860 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.174819677920124, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.157502185526352, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.670151 cos_to_last_merge=0.9848 (last merge round=27)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.2448883389311178, 'auprc': 0.2448883389311178, 'loss_val': 2.6270511219790573, 'psi': 0.2448883389311178}-{'f1_val': 0.24511189634864547, 'auprc': 0.24511189634864547, 'loss_val': 2.599475511214164, 'psi': 0.2451118963486455}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.054151 cos_to_last_merge=0.9956 (last merge round=38)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.1917056054892727, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.1306111312716545, 'psi': 0.24168834923388266}
[S11] START round=44 head_norm_before_train=2.292042 cos_to_last_merge=0.9968 (last merge round=29)
[S11] round=44 local utility u=0.014191 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.376204957218195, 'psi': 0.32387008857597094}-{'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.4065748618682306, 'psi': 0.3240909090909091}
[S13] START round=44 head_norm_before_train=1.790510 cos_to_last_merge=0.9852 (last merge round=28)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5402181631799632, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.511245197529138, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.806252 cos_to_last_merge=0.9797 (last merge round=33)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.9941105327607005, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.927924192453927, 'psi': 0.13592717296421}
[S15] START round=44 head_norm_before_train=2.339682 cos_to_last_merge=0.9994 (last merge round=33)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.7044880911086028, 'psi': 0.6152170947577895}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6986472202513564, 'psi': 0.6153571007984797}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.958374 cos_to_last_merge=0.9455 (last merge round=26)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.1399050748448339, 'auprc': 0.1399050748448339, 'loss_val': 3.8918858771520237, 'psi': 0.1399050748448339}-{'f1_val': 0.13944310458232842, 'auprc': 0.13944310458232842, 'loss_val': 3.8647345415438403, 'psi': 0.13944310458232842}
[S17] START round=44 head_norm_before_train=1.770809 cos_to_last_merge=0.9821 (last merge round=30)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.32923610077026166, 'auprc': 0.32923610077026166, 'loss_val': 2.1011664186059744, 'psi': 0.32923610077026166}-{'f1_val': 0.7027875786885573, 'auprc': 0.7027875786885573, 'loss_val': 0.9888402858857541, 'psi': 0.7027875786885573}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:33207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:33211
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] cosine check vs S11: cos=-0.0208
[S6] DROPPED delta from S11 (cos=-0.0208 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S4
[S10] cosine check vs S4: cos=0.9324
[S2] START round=45 head_norm_before_train=2.073627 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.3119003905682427, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.292778649365324, 'psi': 0.2654773703336637}
[S3] START round=45 head_norm_before_train=1.684283 cos_to_last_merge=0.9876 (last merge round=31)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.7572074639190407, 'psi': 0.29784120014635934}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.702848591548138, 'psi': 0.29784120014635934}
[S4] START round=45 head_norm_before_train=1.928407 cos_to_last_merge=0.9427 (last merge round=26)
[S4] ⚠️ Model drifted since last merge! cos=0.943
[S4] round=45 local utility u=0.006858 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.355534813940127, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3692503091242179, 'psi': 0.3567939207526687}
[S5] START round=45 head_norm_before_train=2.095666 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.3002429242830185, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.2760595724675174, 'psi': 0.33300395256917}
[S6] START round=45 head_norm_before_train=2.036358 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 8.372689287747924, 'psi': 0.018219557195571955}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 8.355418432947223, 'psi': 0.017774699907663897}
[S7] START round=45 head_norm_before_train=1.769809 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.7935224935657169, 'psi': 0.2396131805157593}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8138382939154879, 'psi': 0.35976373724718097}
[S8] START round=45 head_norm_before_train=2.247699 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.19616554979163, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.174819677920124, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.678544 cos_to_last_merge=0.9842 (last merge round=27)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.24526080301424702, 'auprc': 0.24526080301424702, 'loss_val': 2.634590144779487, 'psi': 0.24526080301424702}-{'f1_val': 0.2448883389311178, 'auprc': 0.2448883389311178, 'loss_val': 2.6270511219790573, 'psi': 0.2448883389311178}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.079690 cos_to_last_merge=0.9945 (last merge round=38)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.240712284820756, 'psi': 0.24168834923388266}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.1917056054892727, 'psi': 0.24168834923388266}
[S11] START round=45 head_norm_before_train=2.297608 cos_to_last_merge=0.9966 (last merge round=29)
[S11] round=45 local utility u=0.006647 metrics={'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.3622499555078953, 'psi': 0.3237965485921889}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.376204957218195, 'psi': 0.32387008857597094}
[S13] START round=45 head_norm_before_train=1.795683 cos_to_last_merge=0.9847 (last merge round=28)
[S13] round=45 local utility u=0.001860 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5364975406895973, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5402181631799632, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=45 head_norm_before_train=1.817472 cos_to_last_merge=0.9785 (last merge round=33)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.057403494122791, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.9941105327607005, 'psi': 0.13592717296421}
[S15] START round=45 head_norm_before_train=2.349523 cos_to_last_merge=0.9993 (last merge round=33)
[S15] round=45 local utility u=0.006576 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7026438484974359, 'psi': 0.6164734888353558}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.7044880911086028, 'psi': 0.6152170947577895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=45 head_norm_before_train=1.965718 cos_to_last_merge=0.9444 (last merge round=26)
[S16] ⚠️ Model drifted since last merge! cos=0.944
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.13921181545660596, 'auprc': 0.13921181545660596, 'loss_val': 3.9344836048747043, 'psi': 0.13921181545660596}-{'f1_val': 0.1399050748448339, 'auprc': 0.1399050748448339, 'loss_val': 3.8918858771520237, 'psi': 0.1399050748448339}
[S17] START round=45 head_norm_before_train=1.787965 cos_to_last_merge=0.9810 (last merge round=30)
[S17] round=45 local utility u=0.908761 metrics={'f1_val': 0.4294198280788457, 'auprc': 0.4294198280788457, 'loss_val': 1.1852970172728807, 'psi': 0.4294198280788457}-{'f1_val': 0.32923610077026166, 'auprc': 0.32923610077026166, 'loss_val': 2.1011664186059744, 'psi': 0.32923610077026166}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.357)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.324)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S6] ⇄ pheromone p=0.001 → S11@127.0.0.1:33212
[S11] ⇄ pheromone p=0.007 → S6@127.0.0.1:33207
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=45 metric=0.2417 head_norm=2.102196
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.879932e-01
[S10] stored merged vector for next round verification (round=45)
[S10] DEBUG after merge:  round=45 metric=0.2416 head_norm=1.979508 delta_norm=0.387993
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.009 → S4@127.0.0.1:33204
[S4] ⇄ pheromone p=0.005 → S10@127.0.0.1:33211
[S2] START round=46 head_norm_before_train=2.078882 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.3195912009344717, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.3119003905682427, 'psi': 0.2654773703336637}
[S3] START round=46 head_norm_before_train=1.694269 cos_to_last_merge=0.9868 (last merge round=31)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.793349924912307, 'psi': 0.29784120014635934}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.7572074639190407, 'psi': 0.29784120014635934}
[S4] START round=46 head_norm_before_train=1.936662 cos_to_last_merge=0.9419 (last merge round=26)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3677176990744797, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.355534813940127, 'psi': 0.3567939207526687}
[S5] START round=46 head_norm_before_train=2.104312 (no previous merge yet)
[S5] round=46 local utility u=0.030515 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.2392121128811473, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.3002429242830185, 'psi': 0.33300395256917}
[S6] START round=46 head_norm_before_train=2.041431 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 8.39962450253044, 'psi': 0.018441678192715538}-{'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 8.372689287747924, 'psi': 0.018219557195571955}
[S7] START round=46 head_norm_before_train=1.776259 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.8329091700940183, 'psi': 0.23976608187134504}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.7935224935657169, 'psi': 0.2396131805157593}
[S8] START round=46 head_norm_before_train=2.256431 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.2132771457776386, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.19616554979163, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.686642 cos_to_last_merge=0.9837 (last merge round=27)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.24548396587231539, 'auprc': 0.24548396587231539, 'loss_val': 2.644285856269181, 'psi': 0.24548396587231539}-{'f1_val': 0.24526080301424702, 'auprc': 0.24526080301424702, 'loss_val': 2.634590144779487, 'psi': 0.24526080301424702}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.979508 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=46 local utility u=0.122880 metrics={'f1_val': 0.24164643311365475, 'auprc': 0.24164643311365475, 'loss_val': 1.9945759708701356, 'psi': 0.24164643311365475}-{'f1_val': 0.24168834923388263, 'auprc': 0.24168834923388263, 'loss_val': 2.240712284820756, 'psi': 0.24168834923388266}
[S11] START round=46 head_norm_before_train=2.302992 cos_to_last_merge=0.9964 (last merge round=29)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.407137648277218, 'psi': 0.32387008857597094}-{'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.3622499555078953, 'psi': 0.3237965485921889}
[S13] START round=46 head_norm_before_train=1.799860 cos_to_last_merge=0.9843 (last merge round=28)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5441960572349256, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5364975406895973, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.827872 cos_to_last_merge=0.9774 (last merge round=33)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.116166204271298, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.057403494122791, 'psi': 0.13592717296421}
[S15] START round=46 head_norm_before_train=2.358652 cos_to_last_merge=0.9992 (last merge round=33)
[S15] round=46 local utility u=0.029786 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6418197325472077, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7026438484974359, 'psi': 0.6164734888353558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=46 head_norm_before_train=1.972857 cos_to_last_merge=0.9434 (last merge round=26)
[S16] ⚠️ Model drifted since last merge! cos=0.943
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.1371210452910519, 'auprc': 0.1371210452910519, 'loss_val': 4.016271981803325, 'psi': 0.1371210452910519}-{'f1_val': 0.13921181545660596, 'auprc': 0.13921181545660596, 'loss_val': 3.9344836048747043, 'psi': 0.13921181545660596}
[S17] START round=46 head_norm_before_train=1.804830 cos_to_last_merge=0.9799 (last merge round=30)
[S17] round=46 local utility u=0.455648 metrics={'f1_val': 0.5588871878087347, 'auprc': 0.5588871878087347, 'loss_val': 1.4392064682924683, 'psi': 0.5588871878087347}-{'f1_val': 0.4294198280788457, 'auprc': 0.4294198280788457, 'loss_val': 1.1852970172728807, 'psi': 0.4294198280788457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:33204
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=0.9764
[S2] START round=47 head_norm_before_train=2.084028 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.321875790092382, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.3195912009344717, 'psi': 0.2654773703336637}
[S3] START round=47 head_norm_before_train=1.703733 cos_to_last_merge=0.9861 (last merge round=31)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.8298214592187914, 'psi': 0.29784120014635934}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.793349924912307, 'psi': 0.29784120014635934}
[S4] START round=47 head_norm_before_train=1.945922 cos_to_last_merge=0.9408 (last merge round=26)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3906443792830372, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3677176990744797, 'psi': 0.3567939207526687}
[S5] START round=47 head_norm_before_train=2.110442 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.2497954517067202, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.2392121128811473, 'psi': 0.33300395256917}
[S6] START round=47 head_norm_before_train=2.046468 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 8.451666326650136, 'psi': 0.017774699907663897}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 8.39962450253044, 'psi': 0.018441678192715538}
[S7] START round=47 head_norm_before_train=1.785593 (no previous merge yet)
[S7] round=47 local utility u=0.002938 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.8270339969268732, 'psi': 0.23976608187134504}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.8329091700940183, 'psi': 0.23976608187134504}
[S8] START round=47 head_norm_before_train=2.263729 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.2252401755076106, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.2132771457776386, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.694213 cos_to_last_merge=0.9831 (last merge round=27)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.24518636283342166, 'auprc': 0.24518636283342166, 'loss_val': 2.6737703556952153, 'psi': 0.24518636283342166}-{'f1_val': 0.24548396587231539, 'auprc': 0.24548396587231539, 'loss_val': 2.644285856269181, 'psi': 0.24548396587231539}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.012167 cos_to_last_merge=0.9998 (last merge round=45)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.24164643311365475, 'auprc': 0.24164643311365475, 'loss_val': 2.0664177634744827, 'psi': 0.24164643311365475}-{'f1_val': 0.24164643311365475, 'auprc': 0.24164643311365475, 'loss_val': 1.9945759708701356, 'psi': 0.24164643311365475}
[S11] START round=47 head_norm_before_train=2.308159 cos_to_last_merge=0.9961 (last merge round=29)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.4534937360677413, 'psi': 0.3240172688025449}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.407137648277218, 'psi': 0.32387008857597094}
[S13] START round=47 head_norm_before_train=1.806224 cos_to_last_merge=0.9837 (last merge round=28)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.555615454889017, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5441960572349256, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.837589 cos_to_last_merge=0.9763 (last merge round=33)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.17207937939788, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.116166204271298, 'psi': 0.13592717296421}
[S15] START round=47 head_norm_before_train=2.365834 cos_to_last_merge=0.9991 (last merge round=33)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6066125871415647, 'auprc': 0.6066125871415647, 'loss_val': 0.615366128378437, 'psi': 0.6066125871415647}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6418197325472077, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.978023 cos_to_last_merge=0.9428 (last merge round=26)
[S16] ⚠️ Model drifted since last merge! cos=0.943
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.13665417676878996, 'auprc': 0.13665417676878996, 'loss_val': 4.064303546813885, 'psi': 0.13665417676878996}-{'f1_val': 0.1371210452910519, 'auprc': 0.1371210452910519, 'loss_val': 4.016271981803325, 'psi': 0.1371210452910519}
[S17] START round=47 head_norm_before_train=1.816535 cos_to_last_merge=0.9790 (last merge round=30)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.33350810791085045, 'auprc': 0.33350810791085045, 'loss_val': 1.595665339368446, 'psi': 0.33350810791085045}-{'f1_val': 0.5588871878087347, 'auprc': 0.5588871878087347, 'loss_val': 1.4392064682924683, 'psi': 0.5588871878087347}
[S7]  timeout peer S14
[S5]  timeout peer S16
[S3]  timeout peer S9
[S2]  timeout peer S13
[S17]  timeout peer S3
[S16]  timeout peer S17
[S14]  timeout peer S15
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=47 metric=0.3568 head_norm=1.955131
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.175687e-01
[S4] stored merged vector for next round verification (round=47)
[S4] DEBUG after merge:  round=47 metric=0.3568 head_norm=1.971887 delta_norm=0.217569
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=2.089304 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.332690118509853, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.321875790092382, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.712521 cos_to_last_merge=0.9854 (last merge round=31)
[S3] round=48 local utility u=0.036443 metrics={'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.757846739747981, 'psi': 0.2979423868312757}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 2.8298214592187914, 'psi': 0.29784120014635934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=48 head_norm_before_train=1.971887 cos_to_last_merge=1.0000 (last merge round=47)
[S4] round=48 local utility u=0.019505 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3516333857259508, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3906443792830372, 'psi': 0.3567939207526687}
[S5] START round=48 head_norm_before_train=2.119693 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.2575743649388107, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.2497954517067202, 'psi': 0.33300395256917}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=2.051391 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 8.485495035297046, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 8.451666326650136, 'psi': 0.017774699907663897}
[S7] START round=48 head_norm_before_train=1.795236 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.8536396387758406, 'psi': 0.2396131805157593}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.8270339969268732, 'psi': 0.23976608187134504}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.271972 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.239866691297683, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.2252401755076106, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.701668 cos_to_last_merge=0.9826 (last merge round=27)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.24511189634864547, 'auprc': 0.24511189634864547, 'loss_val': 2.700409570121282, 'psi': 0.2451118963486455}-{'f1_val': 0.24518636283342166, 'auprc': 0.24518636283342166, 'loss_val': 2.6737703556952153, 'psi': 0.24518636283342166}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.053322 cos_to_last_merge=0.9990 (last merge round=45)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.24164643311365475, 'auprc': 0.24164643311365475, 'loss_val': 2.1343276636614745, 'psi': 0.24164643311365475}-{'f1_val': 0.24164643311365475, 'auprc': 0.24164643311365475, 'loss_val': 2.0664177634744827, 'psi': 0.24164643311365475}
[S11] START round=48 head_norm_before_train=2.313075 cos_to_last_merge=0.9959 (last merge round=29)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.479254896733894, 'psi': 0.3240909090909091}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.4534937360677413, 'psi': 0.3240172688025449}
[S13] START round=48 head_norm_before_train=1.812980 cos_to_last_merge=0.9831 (last merge round=28)
[S13] round=48 local utility u=0.005966 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5436838970640827, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.555615454889017, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=48 head_norm_before_train=1.846647 cos_to_last_merge=0.9753 (last merge round=33)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.2238723488824865, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.17207937939788, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.374156 cos_to_last_merge=0.9990 (last merge round=33)
[S15] round=48 local utility u=0.034639 metrics={'f1_val': 0.615334085621722, 'auprc': 0.615334085621722, 'loss_val': 0.6245807145523691, 'psi': 0.615334085621722}-{'f1_val': 0.6066125871415647, 'auprc': 0.6066125871415647, 'loss_val': 0.615366128378437, 'psi': 0.6066125871415647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=48 head_norm_before_train=1.983634 cos_to_last_merge=0.9420 (last merge round=26)
[S16] ⚠️ Model drifted since last merge! cos=0.942
[S16] round=48 local utility u=0.042104 metrics={'f1_val': 0.14025102159953298, 'auprc': 0.14025102159953298, 'loss_val': 4.012467166518566, 'psi': 0.14025102159953298}-{'f1_val': 0.13665417676878996, 'auprc': 0.13665417676878996, 'loss_val': 4.064303546813885, 'psi': 0.13665417676878996}
[S16] not sending this round → trigger blocked (psi=0.140)
[S17] START round=48 head_norm_before_train=1.827796 cos_to_last_merge=0.9782 (last merge round=30)
[S17] round=48 local utility u=0.689297 metrics={'f1_val': 0.4346963652839632, 'auprc': 0.4346963652839632, 'loss_val': 1.1277662934853299, 'psi': 0.43469636528396327}-{'f1_val': 0.33350810791085045, 'auprc': 0.33350810791085045, 'loss_val': 1.595665339368446, 'psi': 0.33350810791085045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:33211
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] cosine check vs S4: cos=0.9883
[S2] START round=49 head_norm_before_train=2.094493 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.335044696403127, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.332690118509853, 'psi': 0.2654773703336637}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.720791 cos_to_last_merge=0.9847 (last merge round=31)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.2976973684210526, 'auprc': 0.2976973684210526, 'loss_val': 2.768488767699085, 'psi': 0.2976973684210526}-{'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.757846739747981, 'psi': 0.2979423868312757}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.980113 cos_to_last_merge=1.0000 (last merge round=47)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.373944630946309, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3516333857259508, 'psi': 0.3567939207526687}
[S5] START round=49 head_norm_before_train=2.128438 (no previous merge yet)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.2824635577739136, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.2575743649388107, 'psi': 0.33300395256917}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=2.056059 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 8.522397531718587, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 8.485495035297046, 'psi': 0.017774699907663897}
[S7] START round=49 head_norm_before_train=1.805039 (no previous merge yet)
[S7] round=49 local utility u=0.030725 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.7928772816911244, 'psi': 0.23968964488212474}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.8536396387758406, 'psi': 0.2396131805157593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=49 head_norm_before_train=2.280728 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.257324808497294, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.239866691297683, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.708993 cos_to_last_merge=0.9821 (last merge round=27)
[S9] round=49 local utility u=0.001054 metrics={'f1_val': 0.2455583009765855, 'auprc': 0.2455583009765855, 'loss_val': 2.7023182495524196, 'psi': 0.2455583009765855}-{'f1_val': 0.24511189634864547, 'auprc': 0.24511189634864547, 'loss_val': 2.700409570121282, 'psi': 0.2451118963486455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=49 head_norm_before_train=2.092392 cos_to_last_merge=0.9978 (last merge round=45)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.24164643311365475, 'auprc': 0.24164643311365475, 'loss_val': 2.198328855577409, 'psi': 0.24164643311365475}-{'f1_val': 0.24164643311365475, 'auprc': 0.24164643311365475, 'loss_val': 2.1343276636614745, 'psi': 0.24164643311365475}
[S11] START round=49 head_norm_before_train=2.317911 cos_to_last_merge=0.9957 (last merge round=29)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.4911156301265565, 'psi': 0.3240909090909091}-{'f1_val': 0.3240909090909091, 'auprc': 0.3240909090909091, 'loss_val': 2.479254896733894, 'psi': 0.3240909090909091}
[S13] START round=49 head_norm_before_train=1.818362 cos_to_last_merge=0.9826 (last merge round=28)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6067164853101767, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5436838970640827, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.855317 cos_to_last_merge=0.9744 (last merge round=33)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.271066280121716, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.2238723488824865, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.382305 cos_to_last_merge=0.9989 (last merge round=33)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6713111520988551, 'psi': 0.615636807189815}-{'f1_val': 0.615334085621722, 'auprc': 0.615334085621722, 'loss_val': 0.6245807145523691, 'psi': 0.615334085621722}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.989922 cos_to_last_merge=0.9411 (last merge round=26)
[S16] ⚠️ Model drifted since last merge! cos=0.941
[S16] round=49 local utility u=0.021079 metrics={'f1_val': 0.14220283533260633, 'auprc': 0.14220283533260633, 'loss_val': 3.987874951820366, 'psi': 0.14220283533260633}-{'f1_val': 0.14025102159953298, 'auprc': 0.14025102159953298, 'loss_val': 4.012467166518566, 'psi': 0.14025102159953298}
[S16] not sending this round → trigger blocked (psi=0.142)
[S17] START round=49 head_norm_before_train=1.842769 cos_to_last_merge=0.9771 (last merge round=30)
[S17] round=49 local utility u=0.064665 metrics={'f1_val': 0.44899484618585744, 'auprc': 0.44899484618585744, 'loss_val': 1.1271226652382047, 'psi': 0.4489948461858575}-{'f1_val': 0.4346963652839632, 'auprc': 0.4346963652839632, 'loss_val': 1.1277662934853299, 'psi': 0.43469636528396327}
[S17] not sending this round → trigger blocked (psi=0.449)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=49 metric=0.2416 head_norm=2.126157
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.883245e-01
[S10] stored merged vector for next round verification (round=49)
[S10] DEBUG after merge:  round=49 metric=0.2416 head_norm=2.045783 delta_norm=0.188325
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
