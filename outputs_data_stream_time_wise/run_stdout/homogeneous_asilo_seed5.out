[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:31603
[S3] → join 127.0.0.1:31602
[S4] → join 127.0.0.1:31602
[S5] → join 127.0.0.1:31602
[S6] → join 127.0.0.1:31602
[S7] → join 127.0.0.1:31602
[S8] → join 127.0.0.1:31602
[S9] → join 127.0.0.1:31602
[S10] → join 127.0.0.1:31602
[S11] → join 127.0.0.1:31602
[S13] → join 127.0.0.1:31602
[S14] → join 127.0.0.1:31602
[S15] → join 127.0.0.1:31602
[S16] → join 127.0.0.1:31602
[S17] → join 127.0.0.1:31602
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.159734 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.129168 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.126248 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.168081 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.170471 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.160906 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.100769 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.140473 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.145754 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.233703 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.224748 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.142001 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.181872 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.159590 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.112159 (no previous merge yet)
[S15]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S7
[S3] + discovered S17
[S3] + discovered S8
[S3] + discovered S6
[S3] + discovered S5
[S3] + discovered S4
[S3] + discovered S9
[S3] + discovered S16
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S14
[S3] + discovered S10
[S3] + discovered S11
[S4] + discovered S13
[S4] + discovered S8
[S4] + discovered S11
[S4] + discovered S16
[S5] + discovered S2
[S4] + discovered S9
[S4] + discovered S5
[S5] + discovered S4
[S4] + discovered S14
[S4] + discovered S17
[S5] + discovered S3
[S4] + discovered S7
[S4] + discovered S10
[S4] + discovered S6
[S4] + discovered S15
[S5] + discovered S16
[S5] + discovered S9
[S5] + discovered S13
[S5] + discovered S17
[S5] + discovered S15
[S5] + discovered S6
[S5] + discovered S8
[S5] + discovered S10
[S5] + discovered S11
[S5] + discovered S14
[S5] + discovered S7
[S6] + discovered S3
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S15
[S6] + discovered S9
[S7] + discovered S5
[S7] + discovered S6
[S6] + discovered S16
[S6] + discovered S13
[S6] + discovered S14
[S6] + discovered S17
[S6] + discovered S10
[S7] + discovered S4
[S7] + discovered S3
[S6] + discovered S7
[S7] + discovered S2
[S6] + discovered S8
[S6] + discovered S11
[S7] + discovered S9
[S7] + discovered S16
[S7] + discovered S11
[S7] + discovered S17
[S8] + discovered S4
[S8] + discovered S5
[S7] + discovered S13
[S7] + discovered S10
[S7] + discovered S14
[S7] + discovered S8
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S6
[S7] + discovered S15
[S8] + discovered S2
[S9] + discovered S8
[S9] + discovered S4
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S6
[S8] + discovered S15
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S9
[S8] + discovered S16
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S14
[S9] + discovered S15
[S9] + discovered S10
[S10] + discovered S5
[S10] + discovered S7
[S10] + discovered S9
[S10] + discovered S6
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S4
[S10] + discovered S8
[S9] + discovered S14
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S11
[S9] + discovered S13
[S11] + discovered S2
[S11] + discovered S4
[S11] + discovered S10
[S11] + discovered S3
[S11] + discovered S6
[S11] + discovered S7
[S11] + discovered S5
[S11] + discovered S8
[S11] + discovered S9
[S10] + discovered S15
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S14
[S10] + discovered S17
[S10] + discovered S16
[S11] + discovered S17
[S13] + discovered S9
[S11] + discovered S14
[S13] + discovered S4
[S13] + discovered S8
[S13] + discovered S7
[S13] + discovered S10
[S13] + discovered S6
[S13] + discovered S5
[S13] + discovered S3
[S13] + discovered S2
[S11] + discovered S16
[S13] + discovered S11
[S11] + discovered S15
[S11] + discovered S13
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S3
[S14] + discovered S13
[S13] + discovered S17
[S14] + discovered S7
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S4
[S13] + discovered S14
[S14] + discovered S8
[S14] + discovered S9
[S14] + discovered S10
[S14] + discovered S2
[S14] + discovered S5
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S15] + discovered S10
[S15] + discovered S6
[S15] + discovered S8
[S15] + discovered S2
[S15] + discovered S3
[S15] + discovered S9
[S15] + discovered S14
[S15] + discovered S11
[S15] + discovered S5
[S15] + discovered S13
[S15] + discovered S7
[S15] + discovered S4
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S13
[S16] + discovered S10
[S16] + discovered S11
[S16] + discovered S3
[S16] + discovered S14
[S16] + discovered S15
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S4
[S16] + discovered S6
[S16] + discovered S7
[S16] + discovered S8
[S16] + discovered S5
[S17] + discovered S15
[S17] + discovered S3
[S17] + discovered S7
[S17] + discovered S6
[S17] + discovered S8
[S17] + discovered S5
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S16
[S17] + discovered S9
[S17] + discovered S14
[S17] + discovered S11
[S17] + discovered S10
[S17] + discovered S13
[S16] + discovered S17
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S14@127.0.0.1:31614
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:31617
[S15] ⇄ pheromone p=1.000 → S10@127.0.0.1:31611
[S2] ⇄ pheromone p=1.000 → S11@127.0.0.1:31612
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:31613
[S13] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S9] ⇄ pheromone p=1.000 → S4@127.0.0.1:31604
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:31602
[S6] ⇄ pheromone p=1.000 → S4@127.0.0.1:31604
[S10] ⇄ pheromone p=1.000 → S16@127.0.0.1:31616
[S14] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:31617
[S3] ⇄ pheromone p=1.000 → S8@127.0.0.1:31609
[S17] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S2] START round=1 head_norm_before_train=1.165100 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5910052030912651, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4970220425935528, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.139184 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5407578224391552, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4363544926024678, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.132529 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.3186015831134565, 'auprc': 0.3186015831134565, 'loss_val': 1.4388321771435237, 'psi': 0.3186015831134565}-{'f1_val': 0.33301777637530244, 'auprc': 0.33301777637530244, 'loss_val': 1.4082046971322772, 'psi': 0.33301777637530244}
[S5] START round=1 head_norm_before_train=1.175976 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4739434037489303, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.427988775398859, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.185396 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.579342033389688, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4853274547502213, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.159648 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4662950458906403, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4244194572839728, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.107258 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4135672900618335, 'psi': 0.0}-{'f1_val': 0.20771929824561405, 'auprc': 0.20771929824561405, 'loss_val': 1.364046766228471, 'psi': 0.20771929824561405}
[S9] START round=1 head_norm_before_train=1.148183 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5869104552803763, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4810957970469696, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.148899 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4510542132811493, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3959709950875623, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.236375 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.566747840491735, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.494114892189796, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.225702 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5454725984063444, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4749722441394422, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.153012 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4612116280558072, 'psi': 0.0}-{'f1_val': 0.20330514988470408, 'auprc': 0.20330514988470408, 'loss_val': 1.3616079912045336, 'psi': 0.20330514988470408}
[S15] START round=1 head_norm_before_train=1.181637 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4645412476327342, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4105466395651889, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.162688 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5178839533273234, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.426747118225772, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.116864 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4671462838997809, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.417636513344237, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.178358 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7662685128743045, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5910052030912651, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.161485 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7605300148669616, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5407578224391552, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.150218 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0004208754208754209, 'auprc': 0.0004208754208754209, 'loss_val': 1.490949244098795, 'psi': 0.0004208754208754209}-{'f1_val': 0.3186015831134565, 'auprc': 0.3186015831134565, 'loss_val': 1.4388321771435237, 'psi': 0.3186015831134565}
[S5] START round=2 head_norm_before_train=1.195271 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5510886249217521, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4739434037489303, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.211650 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.793135593168519, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.579342033389688, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.169378 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5443321226958455, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4662950458906403, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.124438 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5090165349554638, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4135672900618335, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.167867 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8051128743001597, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5869104552803763, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.162948 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5458604905754778, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4510542132811493, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.249184 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.708331315769296, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.566747840491735, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.239435 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6731681004789107, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5454725984063444, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.177376 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6739756014436935, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4612116280558072, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.193899 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.554043512023855, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4645412476327342, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.176882 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6908591168799185, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5178839533273234, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.130584 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5498234337941577, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4671462838997809, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.202659 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2325042103576527, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7662685128743045, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.193569 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2943157204718774, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7605300148669616, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.177736 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5946797373390682, 'psi': 0.0}-{'f1_val': 0.0004208754208754209, 'auprc': 0.0004208754208754209, 'loss_val': 1.490949244098795, 'psi': 0.0004208754208754209}
[S5] START round=3 head_norm_before_train=1.224338 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.703994632326477, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5510886249217521, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.247956 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3793942074972105, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.793135593168519, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.189648 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7588466868246198, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5443321226958455, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.151228 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7104105044618074, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5090165349554638, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.200096 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3212151430717927, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8051128743001597, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.187998 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.735857608871028, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5458604905754778, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.272588 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.072483150928661, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.708331315769296, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.262210 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9364877940869523, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6731681004789107, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.213419 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2907431148995085, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6739756014436935, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.215408 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7584193781994206, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.554043512023855, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.202689 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1509687879684636, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6908591168799185, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.153355 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7295889993740932, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5498234337941577, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.238018 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9469321290060937, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2325042103576527, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.230088 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9218517655231016, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2943157204718774, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.213250 (no previous merge yet)
[S4] round=4 local utility u=1.000000 metrics={'f1_val': 0.2365179760319574, 'auprc': 0.2365179760319574, 'loss_val': 1.6456887371770486, 'psi': 0.2365179760319574}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5946797373390682, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.258103 (no previous merge yet)
[S5] round=4 local utility u=0.023837 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6563198019560545, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.703994632326477, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.289819 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7213268217707975, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3793942074972105, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.218991 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0228789585584743, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7588466868246198, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.182044 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7946968058994746, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7104105044618074, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.237384 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5417755416315075, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3212151430717927, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.218545 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.246276458637193, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.735857608871028, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.305952 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6409811423141556, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.072483150928661, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.287581 (no previous merge yet)
[S13] round=4 local utility u=0.016640 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.903207149561726, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9364877940869523, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.259540 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.259349724393502, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2907431148995085, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.244264 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0925238824437873, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7584193781994206, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.238105 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6802252019294563, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1509687879684636, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.184509 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0500672530392543, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7295889993740932, 'psi': 0.0}
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:31605
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S4
[S5] cosine check vs S4: cos=-0.0576
[S5] DROPPED delta from S4 (cos=-0.0576 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.273721 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0645834007187363, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9469321290060937, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.259534 (no previous merge yet)
[S3] round=5 local utility u=0.107051 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7077503536398475, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9218517655231016, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.245982 (no previous merge yet)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.1416930737890448, 'auprc': 0.1416930737890448, 'loss_val': 1.5644734184244076, 'psi': 0.1416930737890448}-{'f1_val': 0.2365179760319574, 'auprc': 0.2365179760319574, 'loss_val': 1.6456887371770486, 'psi': 0.2365179760319574}
[S5] START round=5 head_norm_before_train=1.272462 (no previous merge yet)
[S5] round=5 local utility u=0.924908 metrics={'f1_val': 0.18914027149321266, 'auprc': 0.18914027149321266, 'loss_val': 1.5087658748528743, 'psi': 0.18914027149321266}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6563198019560545, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.319589 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.848075988163607, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7213268217707975, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.237599 (no previous merge yet)
[S7] round=5 local utility u=0.071404 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8800702038332227, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0228789585584743, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.203472 (no previous merge yet)
[S8] round=5 local utility u=0.095293 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6041104109538287, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7946968058994746, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.260968 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.552670063059715, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5417755416315075, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.254184 (no previous merge yet)
[S10] round=5 local utility u=0.048991 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.148294192020114, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.246276458637193, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.337504 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6604373047617655, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6409811423141556, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.293803 (no previous merge yet)
[S13] round=5 local utility u=0.045039 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8131292391485097, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.903207149561726, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.299132 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4076748169206876, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.259349724393502, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.270883 (no previous merge yet)
[S15] round=5 local utility u=0.008311 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0759018561467086, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0925238824437873, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.267247 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.685308255282186, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6802252019294563, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.217277 (no previous merge yet)
[S17] round=5 local utility u=0.126810 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7964477601369087, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0500672530392543, 'psi': 0.0}
[S13] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.189)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S6] ⇄ pheromone p=0.328 → S4@127.0.0.1:31604
[S3] ⇄ pheromone p=0.349 → S8@127.0.0.1:31609
[S14] ⇄ pheromone p=0.328 → S15@127.0.0.1:31615
[S16] ⇄ pheromone p=0.328 → S2@127.0.0.1:31602
[S2] ⇄ pheromone p=0.328 → S11@127.0.0.1:31612
[S10] ⇄ pheromone p=0.337 → S16@127.0.0.1:31616
[S11] ⇄ pheromone p=0.328 → S13@127.0.0.1:31613
[S8] ⇄ pheromone p=0.347 → S17@127.0.0.1:31617
[S4] ⇄ pheromone p=0.488 → S5@127.0.0.1:31605
[S13] ⇄ pheromone p=0.339 → S5@127.0.0.1:31605
[S7] ⇄ pheromone p=0.342 → S17@127.0.0.1:31617
[S5] ⇄ pheromone p=0.516 → S10@127.0.0.1:31611
[S9] ⇄ pheromone p=0.328 → S4@127.0.0.1:31604
[S15] ⇄ pheromone p=0.329 → S10@127.0.0.1:31611
[S17] ⇄ pheromone p=0.353 → S5@127.0.0.1:31605
[S2] START round=6 head_norm_before_train=1.300841 (no previous merge yet)
[S2] round=6 local utility u=0.028891 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.006801580901684, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0645834007187363, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.275113 (no previous merge yet)
[S3] round=6 local utility u=0.183676 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3403984680928334, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7077503536398475, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.274561 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4288706743103343, 'psi': 0.0}-{'f1_val': 0.1416930737890448, 'auprc': 0.1416930737890448, 'loss_val': 1.5644734184244076, 'psi': 0.1416930737890448}
[S5] START round=6 head_norm_before_train=1.278169 (no previous merge yet)
[S5] round=6 local utility u=0.688502 metrics={'f1_val': 0.3328077367812467, 'auprc': 0.3328077367812467, 'loss_val': 1.424769357297155, 'psi': 0.3328077367812467}-{'f1_val': 0.18914027149321266, 'auprc': 0.18914027149321266, 'loss_val': 1.5087658748528743, 'psi': 0.18914027149321266}
[S6] START round=6 head_norm_before_train=1.349972 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3075729066964543, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.848075988163607, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.237520 (no previous merge yet)
[S7] round=6 local utility u=0.051388 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7772948159585327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8800702038332227, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.214209 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.2548262548262548, 'auprc': 0.2548262548262548, 'loss_val': 1.4529383801789315, 'psi': 0.2548262548262548}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6041104109538287, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.284182 (no previous merge yet)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.733812603048806, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.552670063059715, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.260512 (no previous merge yet)
[S10] round=6 local utility u=0.101898 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9444982223889524, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.148294192020114, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.357752 (no previous merge yet)
[S11] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.708941871919535, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6604373047617655, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.300135 (no previous merge yet)
[S13] round=6 local utility u=0.035970 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7411902122466558, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8131292391485097, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.321479 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4326887097686707, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4076748169206876, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.283345 (no previous merge yet)
[S15] round=6 local utility u=0.086818 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9022664931113062, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0759018561467086, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.291655 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.920392518899636, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.685308255282186, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.230581 (no previous merge yet)
[S17] round=6 local utility u=0.100689 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5950692922971557, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7964477601369087, 'psi': 0.0}
[S15] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:31611
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:31617
[S3] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.0603
[S10] RECEIVED delta(kind=head bytes=1796) from S5
[S10] cosine check vs S5: cos=0.1047
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.0000 head_norm=1.262498
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.553641e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.0000 head_norm=0.950086 delta_norm=0.855364
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.0000 head_norm=1.244241
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.464085e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.0000 head_norm=0.899049 delta_norm=0.846408
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.327651 (no previous merge yet)
[S2] round=7 local utility u=0.016103 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9745962952581824, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.006801580901684, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.293335 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.389130856985374, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3403984680928334, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.302601 (no previous merge yet)
[S4] round=7 local utility u=0.033348 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3621756038693649, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4288706743103343, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.294109 (no previous merge yet)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.23327438844680223, 'auprc': 0.23327438844680223, 'loss_val': 1.353025923552883, 'psi': 0.2332743884468022}-{'f1_val': 0.3328077367812467, 'auprc': 0.3328077367812467, 'loss_val': 1.424769357297155, 'psi': 0.3328077367812467}
[S6] START round=7 head_norm_before_train=1.386121 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3900527847975, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3075729066964543, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.241825 (no previous merge yet)
[S7] round=7 local utility u=0.017895 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7415043581024188, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7772948159585327, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.225258 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.24154695099139545, 'auprc': 0.24154695099139545, 'loss_val': 1.4086345147333321, 'psi': 0.24154695099139545}-{'f1_val': 0.2548262548262548, 'auprc': 0.2548262548262548, 'loss_val': 1.4529383801789315, 'psi': 0.2548262548262548}
[S9] START round=7 head_norm_before_train=1.313516 (no previous merge yet)
[S9] round=7 local utility u=0.105736 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.522341192406212, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.733812603048806, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=0.950086 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.077755 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.788987877128726, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9444982223889524, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.381919 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.935249059863414, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.708941871919535, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.309995 (no previous merge yet)
[S13] round=7 local utility u=0.052945 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6353010899797173, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7411902122466558, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.340720 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6929223601316274, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4326887097686707, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.293487 (no previous merge yet)
[S15] round=7 local utility u=0.063271 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7757243022525941, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9022664931113062, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.323195 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1389731166643555, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.920392518899636, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=0.899049 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.068764 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.45754135101527, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5950692922971557, 'psi': 0.0}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=8 head_norm_before_train=1.359483 (no previous merge yet)
[S2] round=8 local utility u=0.046019 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8825588280734546, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9745962952581824, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.320733 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.408175800953984, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.389130856985374, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.340609 (no previous merge yet)
[S4] round=8 local utility u=0.016549 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3290776156315092, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3621756038693649, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.318073 (no previous merge yet)
[S5] round=8 local utility u=1.000000 metrics={'f1_val': 0.7424953914164012, 'auprc': 0.7424953914164012, 'loss_val': 1.273420197431013, 'psi': 0.7424953914164012}-{'f1_val': 0.23327438844680223, 'auprc': 0.23327438844680223, 'loss_val': 1.353025923552883, 'psi': 0.2332743884468022}
[S6] START round=8 head_norm_before_train=1.417579 (no previous merge yet)
[S6] round=8 local utility u=0.046980 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2960931311828845, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3900527847975, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.253204 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8169804877175593, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7415043581024188, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.248948 (no previous merge yet)
[S8] round=8 local utility u=0.882012 metrics={'f1_val': 0.4287686959119367, 'auprc': 0.4287686959119367, 'loss_val': 1.3296058116400407, 'psi': 0.4287686959119367}-{'f1_val': 0.24154695099139545, 'auprc': 0.24154695099139545, 'loss_val': 1.4086345147333321, 'psi': 0.24154695099139545}
[S9] START round=8 head_norm_before_train=1.345608 (no previous merge yet)
[S9] round=8 local utility u=0.064926 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3924884404448976, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.522341192406212, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=0.969497 cos_to_last_merge=0.9992 (last merge round=6)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.086633128260897, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.788987877128726, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.407468 (no previous merge yet)
[S11] round=8 local utility u=0.203715 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.527818547818073, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.935249059863414, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.318520 (no previous merge yet)
[S13] round=8 local utility u=0.043555 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5481920171590395, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6353010899797173, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.362170 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8285037604105816, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6929223601316274, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.309951 (no previous merge yet)
[S15] round=8 local utility u=0.080543 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6146373064096842, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7757243022525941, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.351705 (no previous merge yet)
[S16] round=8 local utility u=0.104984 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9290059507074804, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1389731166643555, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=0.930319 cos_to_last_merge=0.9975 (last merge round=6)
[S17] round=8 local utility u=0.001835 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4538714698519202, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.45754135101527, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:31617
[S2] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:31611
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.6806
[S10] RECEIVED delta(kind=head bytes=1802) from S5
[S10] cosine check vs S5: cos=0.7271
[S17] not sending this round → trigger blocked (psi=0.000)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.0000 head_norm=1.003665
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.596605e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.089924 delta_norm=0.459661
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.0000 head_norm=0.975490
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.696490e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.0905 head_norm=1.032476 delta_norm=0.469649
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.399550 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7647948495476276, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8825588280734546, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.351494 (no previous merge yet)
[S3] round=9 local utility u=0.081764 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.244648556219498, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.408175800953984, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.382948 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3380479054342023, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3290776156315092, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.338320 (no previous merge yet)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.5880753869755111, 'auprc': 0.5880753869755111, 'loss_val': 1.2212112792924108, 'psi': 0.5880753869755111}-{'f1_val': 0.7424953914164012, 'auprc': 0.7424953914164012, 'loss_val': 1.273420197431013, 'psi': 0.7424953914164012}
[S6] START round=9 head_norm_before_train=1.449788 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.041078039857836, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2960931311828845, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.273524 (no previous merge yet)
[S7] round=9 local utility u=0.054481 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.708018302024855, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8169804877175593, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.273409 (no previous merge yet)
[S8] round=9 local utility u=0.098350 metrics={'f1_val': 0.44107738096418886, 'auprc': 0.44107738096418886, 'loss_val': 1.2436836173023993, 'psi': 0.4410773809641888}-{'f1_val': 0.4287686959119367, 'auprc': 0.4287686959119367, 'loss_val': 1.3296058116400407, 'psi': 0.4287686959119367}
[S9] START round=9 head_norm_before_train=1.383521 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5346313334010455, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3924884404448976, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.089924 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.254466791611895, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.086633128260897, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.433322 (no previous merge yet)
[S11] round=9 local utility u=0.083331 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3611561453393772, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.527818547818073, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.328943 (no previous merge yet)
[S13] round=9 local utility u=0.023655 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5008824570093622, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5481920171590395, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.385588 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.379804816628452, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8285037604105816, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.331195 (no previous merge yet)
[S15] round=9 local utility u=0.090248 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4341421111019645, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6146373064096842, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.379869 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.411190699904214, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9290059507074804, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.032476 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=1.000000 metrics={'f1_val': 0.221480244852532, 'auprc': 0.221480244852532, 'loss_val': 1.3414257239706562, 'psi': 0.221480244852532}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4538714698519202, 'psi': 0.0}
[S13] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:31617
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9159
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] cosine check vs S17: cos=0.0364
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.5881 head_norm=1.365571
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.511585e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.9351 head_norm=0.881781 delta_norm=0.851158
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.2215 head_norm=1.067349
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.671053e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.2391 head_norm=1.157050 delta_norm=0.267105
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.437613 (no previous merge yet)
[S2] round=10 local utility u=0.512700 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7393945676285973, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7647948495476276, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.385396 (no previous merge yet)
[S3] round=10 local utility u=0.187072 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8705055429302921, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.244648556219498, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.424515 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.338774885251662, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3380479054342023, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=0.881781 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.495181 metrics={'f1_val': 0.7025242476014302, 'auprc': 0.7025242476014302, 'loss_val': 1.2608893060474484, 'psi': 0.7025242476014302}-{'f1_val': 0.5880753869755111, 'auprc': 0.5880753869755111, 'loss_val': 1.2212112792924108, 'psi': 0.5880753869755111}
[S6] START round=10 head_norm_before_train=1.482919 (no previous merge yet)
[S6] round=10 local utility u=0.157211 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7266558170347976, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.041078039857836, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.287144 (no previous merge yet)
[S7] round=10 local utility u=0.101125 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.505768714444229, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.708018302024855, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.296528 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.24945845694574917, 'auprc': 0.24945845694574917, 'loss_val': 1.2026049280436415, 'psi': 0.24945845694574917}-{'f1_val': 0.44107738096418886, 'auprc': 0.44107738096418886, 'loss_val': 1.2436836173023993, 'psi': 0.4410773809641888}
[S9] START round=10 head_norm_before_train=1.423167 (no previous merge yet)
[S9] round=10 local utility u=0.125863 metrics={'f1_val': 0.0002376425855513308, 'auprc': 0.0002376425855513308, 'loss_val': 2.2850451159797482, 'psi': 0.00023764258555133082}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5346313334010455, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.123048 cos_to_last_merge=0.9974 (last merge round=8)
[S10] round=10 local utility u=0.006373 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.24172140824309, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.254466791611895, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.461777 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5552010393692206, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3611561453393772, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.348084 (no previous merge yet)
[S13] round=10 local utility u=0.055344 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3901954389426394, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5008824570093622, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.415218 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.71715739814086, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.379804816628452, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.358119 (no previous merge yet)
[S15] round=10 local utility u=0.665142 metrics={'f1_val': 0.13220260223048327, 'auprc': 0.13220260223048327, 'loss_val': 1.2936825085021737, 'psi': 0.13220260223048327}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4341421111019645, 'psi': 0.0}
[S16] START round=10 head_norm_before_train=1.409336 (no previous merge yet)
[S16] round=10 local utility u=0.151719 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1077522746925785, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.411190699904214, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.157050 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.096746 metrics={'f1_val': 0.23924013060255267, 'auprc': 0.23924013060255267, 'loss_val': 1.3077727510139034, 'psi': 0.23924013060255267}-{'f1_val': 0.221480244852532, 'auprc': 0.221480244852532, 'loss_val': 1.3414257239706562, 'psi': 0.221480244852532}
[S10] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.132)
[S3] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:31611
[S16] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S5
[S10] cosine check vs S5: cos=0.7359
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] cosine check vs S17: cos=0.5925
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.0000 head_norm=1.158322
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.934052e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.0000 head_norm=0.967014 delta_norm=0.393405
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.128 → S16@127.0.0.1:31616
[S8] ⇄ pheromone p=0.324 → S17@127.0.0.1:31617
[S4] ⇄ pheromone p=0.165 → S5@127.0.0.1:31605
[S3] ⇄ pheromone p=0.180 → S8@127.0.0.1:31609
[S15] ⇄ pheromone p=0.279 → S10@127.0.0.1:31611
[S6] ⇄ pheromone p=0.145 → S4@127.0.0.1:31604
[S13] ⇄ pheromone p=0.140 → S5@127.0.0.1:31605
[S2] ⇄ pheromone p=0.220 → S11@127.0.0.1:31612
[S9] ⇄ pheromone p=0.152 → S4@127.0.0.1:31604
[S11] ⇄ pheromone p=0.147 → S13@127.0.0.1:31613
[S7] ⇄ pheromone p=0.147 → S17@127.0.0.1:31617
[S14] ⇄ pheromone p=0.107 → S15@127.0.0.1:31615
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7025 head_norm=0.915456
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.910890e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.9989 head_norm=0.941956 delta_norm=0.491089
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.453 → S10@127.0.0.1:31611
[S16] ⇄ pheromone p=0.151 → S2@127.0.0.1:31602
[S17] ⇄ pheromone p=0.311 → S5@127.0.0.1:31605
[S2] START round=11 head_norm_before_train=1.465114 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9100586617232644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7393945676285973, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.422240 (no previous merge yet)
[S3] round=11 local utility u=0.371056 metrics={'f1_val': 0.09369215434999288, 'auprc': 0.09369215434999288, 'loss_val': 1.9716224172614087, 'psi': 0.09369215434999288}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8705055429302921, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.462942 (no previous merge yet)
[S4] round=11 local utility u=0.001546 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.335683608408865, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.338774885251662, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=0.941956 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=1.000000 metrics={'f1_val': 0.9969003851557722, 'auprc': 0.9969003851557722, 'loss_val': 1.2848589893792188, 'psi': 0.9969003851557722}-{'f1_val': 0.7025242476014302, 'auprc': 0.7025242476014302, 'loss_val': 1.2608893060474484, 'psi': 0.7025242476014302}
[S6] START round=11 head_norm_before_train=1.510991 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.007311320754716981, 'auprc': 0.007311320754716981, 'loss_val': 3.962093843889219, 'psi': 0.007311320754716981}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7266558170347976, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.296948 (no previous merge yet)
[S7] round=11 local utility u=0.022538 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.460693312223444, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.505768714444229, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.328627 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.20341384863123993, 'auprc': 0.20341384863123993, 'loss_val': 1.1572793122212224, 'psi': 0.20341384863123993}-{'f1_val': 0.24945845694574917, 'auprc': 0.24945845694574917, 'loss_val': 1.2026049280436415, 'psi': 0.24945845694574917}
[S9] START round=11 head_norm_before_train=1.460518 (no previous merge yet)
[S9] round=11 local utility u=0.663569 metrics={'f1_val': 0.11879781420765027, 'auprc': 0.11879781420765027, 'loss_val': 2.0249490610433343, 'psi': 0.11879781420765026}-{'f1_val': 0.0002376425855513308, 'auprc': 0.0002376425855513308, 'loss_val': 2.2850451159797482, 'psi': 0.00023764258555133082}
[S10] START round=11 head_norm_before_train=0.967014 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.027275 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1871716115793265, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.24172140824309, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.491796 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.592143341721806, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5552010393692206, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.366936 (no previous merge yet)
[S13] round=11 local utility u=1.000000 metrics={'f1_val': 0.27645083932853715, 'auprc': 0.27645083932853715, 'loss_val': 1.279885373715666, 'psi': 0.27645083932853715}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3901954389426394, 'psi': 0.0}
[S14] START round=11 head_norm_before_train=1.445466 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.776014232211667, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.71715739814086, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.389528 (no previous merge yet)
[S15] round=11 local utility u=0.157812 metrics={'f1_val': 0.16419176919813322, 'auprc': 0.16419176919813322, 'loss_val': 1.2659609123545152, 'psi': 0.16419176919813322}-{'f1_val': 0.13220260223048327, 'auprc': 0.13220260223048327, 'loss_val': 1.2936825085021737, 'psi': 0.13220260223048327}
[S16] START round=11 head_norm_before_train=1.434447 (no previous merge yet)
[S16] round=11 local utility u=0.080402 metrics={'f1_val': 0.00023245002324500232, 'auprc': 0.00023245002324500232, 'loss_val': 2.9490403186222816, 'psi': 0.00023245002324500232}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1077522746925785, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.191150 cos_to_last_merge=0.9949 (last merge round=9)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.1796085429775746, 'auprc': 0.1796085429775746, 'loss_val': 1.2948730611607329, 'psi': 0.1796085429775746}-{'f1_val': 0.23924013060255267, 'auprc': 0.23924013060255267, 'loss_val': 1.3077727510139034, 'psi': 0.23924013060255267}
[S4] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.164)
[S3] not sending this round → trigger blocked (psi=0.094)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:31611
[S9] not sending this round → trigger blocked (psi=0.119)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:31605
[S16] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S5
[S10] cosine check vs S5: cos=0.6465
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S13
[S5] cosine check vs S13: cos=-0.0732
[S5] DROPPED delta from S13 (cos=-0.0732 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.0000 head_norm=1.003314
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.144482e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.0000 head_norm=0.893698 delta_norm=0.414448
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.488514 (no previous merge yet)
[S2] round=12 local utility u=1.000000 metrics={'f1_val': 0.1936685288640596, 'auprc': 0.1936685288640596, 'loss_val': 2.4734810485398464, 'psi': 0.1936685288640596}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9100586617232644, 'psi': 0.0}
[S3] START round=12 head_norm_before_train=1.460796 (no previous merge yet)
[S3] round=12 local utility u=0.039170 metrics={'f1_val': 0.13312118801378944, 'auprc': 0.13312118801378944, 'loss_val': 2.248143822023387, 'psi': 0.13312118801378944}-{'f1_val': 0.09369215434999288, 'auprc': 0.09369215434999288, 'loss_val': 1.9716224172614087, 'psi': 0.09369215434999288}
[S4] START round=12 head_norm_before_train=1.499795 (no previous merge yet)
[S4] round=12 local utility u=0.010845 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3139945454576798, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.335683608408865, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=0.966585 cos_to_last_merge=0.9955 (last merge round=10)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7640431212917538, 'auprc': 0.7640431212917538, 'loss_val': 1.2554769661486689, 'psi': 0.7640431212917538}-{'f1_val': 0.9969003851557722, 'auprc': 0.9969003851557722, 'loss_val': 1.2848589893792188, 'psi': 0.9969003851557722}
[S6] START round=12 head_norm_before_train=1.541580 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.0070788107597923545, 'auprc': 0.0070788107597923545, 'loss_val': 4.494993957306148, 'psi': 0.0070788107597923545}-{'f1_val': 0.007311320754716981, 'auprc': 0.007311320754716981, 'loss_val': 3.962093843889219, 'psi': 0.007311320754716981}
[S7] START round=12 head_norm_before_train=1.316745 (no previous merge yet)
[S7] round=12 local utility u=0.030356 metrics={'f1_val': 0.0001987083954297069, 'auprc': 0.0001987083954297069, 'loss_val': 1.4017691751040313, 'psi': 0.0001987083954297069}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.460693312223444, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.359681 (no previous merge yet)
[S8] round=12 local utility u=0.473672 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1247676852979676, 'psi': 0.30506182380216385}-{'f1_val': 0.20341384863123993, 'auprc': 0.20341384863123993, 'loss_val': 1.1572793122212224, 'psi': 0.20341384863123993}
[S9] START round=12 head_norm_before_train=1.496683 (no previous merge yet)
[S9] round=12 local utility u=0.514663 metrics={'f1_val': 0.23142405448133285, 'auprc': 0.23142405448133285, 'loss_val': 2.0092588759648624, 'psi': 0.23142405448133285}-{'f1_val': 0.11879781420765027, 'auprc': 0.11879781420765027, 'loss_val': 2.0249490610433343, 'psi': 0.11879781420765026}
[S10] START round=12 head_norm_before_train=0.893698 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.009150633505396527, 'auprc': 0.009150633505396527, 'loss_val': 2.30785123493657, 'psi': 0.009150633505396527}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1871716115793265, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.523767 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.886084451833394, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.592143341721806, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.385313 (no previous merge yet)
[S13] round=12 local utility u=0.208033 metrics={'f1_val': 0.31518921721099014, 'auprc': 0.31518921721099014, 'loss_val': 1.2124657530608578, 'psi': 0.31518921721099014}-{'f1_val': 0.27645083932853715, 'auprc': 0.27645083932853715, 'loss_val': 1.279885373715666, 'psi': 0.27645083932853715}
[S14] START round=12 head_norm_before_train=1.471736 (no previous merge yet)
[S14] round=12 local utility u=0.030518 metrics={'f1_val': 0.022111161593215203, 'auprc': 0.022111161593215203, 'loss_val': 4.913978458408014, 'psi': 0.022111161593215203}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.776014232211667, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.423826 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.14756517461878996, 'auprc': 0.14756517461878996, 'loss_val': 1.25414009070138, 'psi': 0.14756517461878996}-{'f1_val': 0.16419176919813322, 'auprc': 0.16419176919813322, 'loss_val': 1.2659609123545152, 'psi': 0.16419176919813322}
[S16] START round=12 head_norm_before_train=1.459930 (no previous merge yet)
[S16] round=12 local utility u=0.177857 metrics={'f1_val': 0.041875, 'auprc': 0.041875, 'loss_val': 2.96810979560335, 'psi': 0.041875}-{'f1_val': 0.00023245002324500232, 'auprc': 0.00023245002324500232, 'loss_val': 2.9490403186222816, 'psi': 0.00023245002324500232}
[S17] START round=12 head_norm_before_train=1.236296 cos_to_last_merge=0.9815 (last merge round=9)
[S17] round=12 local utility u=0.792565 metrics={'f1_val': 0.353686790673474, 'auprc': 0.353686790673474, 'loss_val': 1.276447673743824, 'psi': 0.353686790673474}-{'f1_val': 0.1796085429775746, 'auprc': 0.1796085429775746, 'loss_val': 1.2948730611607329, 'psi': 0.1796085429775746}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.194)
[S4] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.042)
[S3] not sending this round → trigger blocked (psi=0.133)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:31604
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:31605
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:31605
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9159
[S5] RECEIVED delta(kind=head bytes=1793) from S13
[S5] cosine check vs S13: cos=-0.0743
[S5] DROPPED delta from S13 (cos=-0.0743 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S9
[S4] cosine check vs S9: cos=-0.0072
[S4] DROPPED delta from S9 (cos=-0.0072 < 0.0)
[S17] sending update (kind=head size=1807 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1807) from S17
[S5] cosine check vs S17: cos=0.8617
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7640 head_norm=1.003168
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.278300e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.3079 head_norm=1.100795 delta_norm=0.327830
[S5] aggregate: ROLLBACK (f1_val pre=0.764 post=0.308 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3537 head_norm=1.277537
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.788693e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3640 head_norm=1.305173 delta_norm=0.278869
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.512331 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.1839373830185469, 'auprc': 0.1839373830185469, 'loss_val': 2.52551716378935, 'psi': 0.1839373830185469}-{'f1_val': 0.1936685288640596, 'auprc': 0.1936685288640596, 'loss_val': 2.4734810485398464, 'psi': 0.1936685288640596}
[S3] START round=13 head_norm_before_train=1.494655 (no previous merge yet)
[S3] round=13 local utility u=0.240320 metrics={'f1_val': 0.17448680351906157, 'auprc': 0.17448680351906157, 'loss_val': 2.1397950427751034, 'psi': 0.17448680351906157}-{'f1_val': 0.13312118801378944, 'auprc': 0.13312118801378944, 'loss_val': 2.248143822023387, 'psi': 0.13312118801378944}
[S4] START round=13 head_norm_before_train=1.531211 (no previous merge yet)
[S4] round=13 local utility u=0.011315 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2913652615591062, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3139945454576798, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.100795 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.2808831181487932, 'psi': 0.3051272166538165}-{'f1_val': 0.7640431212917538, 'auprc': 0.7640431212917538, 'loss_val': 1.2554769661486689, 'psi': 0.7640431212917538}
[S6] START round=13 head_norm_before_train=1.573641 (no previous merge yet)
[S6] round=13 local utility u=0.066759 metrics={'f1_val': 0.026518585675430643, 'auprc': 0.026518585675430643, 'loss_val': 4.5364331359140655, 'psi': 0.026518585675430643}-{'f1_val': 0.0070788107597923545, 'auprc': 0.0070788107597923545, 'loss_val': 4.494993957306148, 'psi': 0.0070788107597923545}
[S7] START round=13 head_norm_before_train=1.332388 (no previous merge yet)
[S7] round=13 local utility u=0.356032 metrics={'f1_val': 0.07508475977838419, 'auprc': 0.07508475977838419, 'loss_val': 1.3636803581013937, 'psi': 0.07508475977838419}-{'f1_val': 0.0001987083954297069, 'auprc': 0.0001987083954297069, 'loss_val': 1.4017691751040313, 'psi': 0.0001987083954297069}
[S8] START round=13 head_norm_before_train=1.389384 (no previous merge yet)
[S8] round=13 local utility u=0.087682 metrics={'f1_val': 0.317692428446043, 'auprc': 0.317692428446043, 'loss_val': 1.0630793573445814, 'psi': 0.317692428446043}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1247676852979676, 'psi': 0.30506182380216385}
[S9] START round=13 head_norm_before_train=1.533889 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.22660764785442025, 'auprc': 0.22660764785442025, 'loss_val': 2.1714701317263634, 'psi': 0.22660764785442028}-{'f1_val': 0.23142405448133285, 'auprc': 0.23142405448133285, 'loss_val': 2.0092588759648624, 'psi': 0.23142405448133285}
[S10] START round=13 head_norm_before_train=0.933074 cos_to_last_merge=0.9935 (last merge round=11)
[S10] round=13 local utility u=0.466291 metrics={'f1_val': 0.1412894375857339, 'auprc': 0.1412894375857339, 'loss_val': 2.5645191040179083, 'psi': 0.1412894375857339}-{'f1_val': 0.009150633505396527, 'auprc': 0.009150633505396527, 'loss_val': 2.30785123493657, 'psi': 0.009150633505396527}
[S11] START round=13 head_norm_before_train=1.549286 (no previous merge yet)
[S11] round=13 local utility u=0.226675 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4327350709909, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.886084451833394, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.414139 (no previous merge yet)
[S13] round=13 local utility u=1.000000 metrics={'f1_val': 0.6495347165816073, 'auprc': 0.6495347165816073, 'loss_val': 1.1494955595635916, 'psi': 0.6495347165816073}-{'f1_val': 0.31518921721099014, 'auprc': 0.31518921721099014, 'loss_val': 1.2124657530608578, 'psi': 0.31518921721099014}
[S14] START round=13 head_norm_before_train=1.500237 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.024154589371980676, 'auprc': 0.024154589371980676, 'loss_val': 4.974772172834803, 'psi': 0.024154589371980676}-{'f1_val': 0.022111161593215203, 'auprc': 0.022111161593215203, 'loss_val': 4.913978458408014, 'psi': 0.022111161593215203}
[S15] START round=13 head_norm_before_train=1.455916 (no previous merge yet)
[S15] round=13 local utility u=0.618892 metrics={'f1_val': 0.2715587170847373, 'auprc': 0.2715587170847373, 'loss_val': 1.1322970874702554, 'psi': 0.2715587170847373}-{'f1_val': 0.14756517461878996, 'auprc': 0.14756517461878996, 'loss_val': 1.25414009070138, 'psi': 0.14756517461878996}
[S16] START round=13 head_norm_before_train=1.489053 (no previous merge yet)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.02945688861613992, 'auprc': 0.02945688861613992, 'loss_val': 3.2718587560053654, 'psi': 0.02945688861613992}-{'f1_val': 0.041875, 'auprc': 0.041875, 'loss_val': 2.96810979560335, 'psi': 0.041875}
[S17] START round=13 head_norm_before_train=1.305173 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.16513007584314326, 'auprc': 0.16513007584314326, 'loss_val': 1.2602079893788745, 'psi': 0.16513007584314326}-{'f1_val': 0.353686790673474, 'auprc': 0.353686790673474, 'loss_val': 1.276447673743824, 'psi': 0.353686790673474}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:31611
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.174)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:31617
[S6] not sending this round → trigger blocked (psi=0.027)
[S7] not sending this round → trigger blocked (psi=0.075)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.141)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S15] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S13
[S5] cosine check vs S13: cos=-0.0822
[S5] DROPPED delta from S13 (cos=-0.0822 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] cosine check vs S8: cos=0.9671
[S10] RECEIVED delta(kind=head bytes=1805) from S15
[S10] cosine check vs S15: cos=0.0611
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.1413 head_norm=0.980925
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.660812e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.2188 head_norm=0.916161 delta_norm=0.866081
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.1651 head_norm=1.334923
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.813789e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.1759 head_norm=1.365218 delta_norm=0.181379
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.541542 (no previous merge yet)
[S2] round=14 local utility u=0.447723 metrics={'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 2.3636887010453425, 'psi': 0.2654504593826426}-{'f1_val': 0.1839373830185469, 'auprc': 0.1839373830185469, 'loss_val': 2.52551716378935, 'psi': 0.1839373830185469}
[S3] START round=14 head_norm_before_train=1.525257 (no previous merge yet)
[S3] round=14 local utility u=0.668108 metrics={'f1_val': 0.2577504483730464, 'auprc': 0.2577504483730464, 'loss_val': 1.5529518446104915, 'psi': 0.2577504483730464}-{'f1_val': 0.17448680351906157, 'auprc': 0.17448680351906157, 'loss_val': 2.1397950427751034, 'psi': 0.17448680351906157}
[S4] START round=14 head_norm_before_train=1.563472 (no previous merge yet)
[S4] round=14 local utility u=1.000000 metrics={'f1_val': 0.3318903318903319, 'auprc': 0.3318903318903319, 'loss_val': 1.2758213115718458, 'psi': 0.3318903318903319}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2913652615591062, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.127787 cos_to_last_merge=0.9959 (last merge round=12)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.20381686693759674, 'auprc': 0.20381686693759674, 'loss_val': 1.2563226580205364, 'psi': 0.20381686693759674}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.2808831181487932, 'psi': 0.3051272166538165}
[S6] START round=14 head_norm_before_train=1.601624 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.006613131790269249, 'auprc': 0.006613131790269249, 'loss_val': 5.175243511551246, 'psi': 0.006613131790269249}-{'f1_val': 0.026518585675430643, 'auprc': 0.026518585675430643, 'loss_val': 4.5364331359140655, 'psi': 0.026518585675430643}
[S7] START round=14 head_norm_before_train=1.347515 (no previous merge yet)
[S7] round=14 local utility u=0.024261 metrics={'f1_val': 0.08060948636028507, 'auprc': 0.08060948636028507, 'loss_val': 1.3648803394841909, 'psi': 0.08060948636028507}-{'f1_val': 0.07508475977838419, 'auprc': 0.07508475977838419, 'loss_val': 1.3636803581013937, 'psi': 0.07508475977838419}
[S8] START round=14 head_norm_before_train=1.418244 (no previous merge yet)
[S8] round=14 local utility u=1.000000 metrics={'f1_val': 0.613824162489346, 'auprc': 0.613824162489346, 'loss_val': 0.9919928032430543, 'psi': 0.613824162489346}-{'f1_val': 0.317692428446043, 'auprc': 0.317692428446043, 'loss_val': 1.0630793573445814, 'psi': 0.317692428446043}
[S9] START round=14 head_norm_before_train=1.569254 (no previous merge yet)
[S9] round=14 local utility u=0.643583 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1628806085459953, 'psi': 0.36867172340800847}-{'f1_val': 0.22660764785442025, 'auprc': 0.22660764785442025, 'loss_val': 2.1714701317263634, 'psi': 0.22660764785442028}
[S10] START round=14 head_norm_before_train=0.916161 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.451086 metrics={'f1_val': 0.19865771812080538, 'auprc': 0.19865771812080538, 'loss_val': 2.1786613967269313, 'psi': 0.19865771812080538}-{'f1_val': 0.1412894375857339, 'auprc': 0.1412894375857339, 'loss_val': 2.5645191040179083, 'psi': 0.1412894375857339}
[S11] START round=14 head_norm_before_train=1.570969 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.728045480943629, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4327350709909, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.442516 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.24400555656217915, 'auprc': 0.24400555656217915, 'loss_val': 1.113097199690075, 'psi': 0.24400555656217915}-{'f1_val': 0.6495347165816073, 'auprc': 0.6495347165816073, 'loss_val': 1.1494955595635916, 'psi': 0.6495347165816073}
[S14] START round=14 head_norm_before_train=1.529080 (no previous merge yet)
[S14] round=14 local utility u=0.525270 metrics={'f1_val': 0.13353375923838157, 'auprc': 0.13353375923838157, 'loss_val': 4.9086447082112805, 'psi': 0.13353375923838157}-{'f1_val': 0.024154589371980676, 'auprc': 0.024154589371980676, 'loss_val': 4.974772172834803, 'psi': 0.024154589371980676}
[S15] START round=14 head_norm_before_train=1.488852 (no previous merge yet)
[S15] round=14 local utility u=0.240939 metrics={'f1_val': 0.3100146445871353, 'auprc': 0.3100146445871353, 'loss_val': 0.9965226539729831, 'psi': 0.3100146445871353}-{'f1_val': 0.2715587170847373, 'auprc': 0.2715587170847373, 'loss_val': 1.1322970874702554, 'psi': 0.2715587170847373}
[S16] START round=14 head_norm_before_train=1.520934 (no previous merge yet)
[S16] round=14 local utility u=0.276080 metrics={'f1_val': 0.09246347941567065, 'auprc': 0.09246347941567065, 'loss_val': 3.2867579661753226, 'psi': 0.09246347941567065}-{'f1_val': 0.02945688861613992, 'auprc': 0.02945688861613992, 'loss_val': 3.2718587560053654, 'psi': 0.02945688861613992}
[S17] START round=14 head_norm_before_train=1.365218 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.1526522037501123, 'auprc': 0.1526522037501123, 'loss_val': 1.246324172686651, 'psi': 0.1526522037501123}-{'f1_val': 0.16513007584314326, 'auprc': 0.16513007584314326, 'loss_val': 1.2602079893788745, 'psi': 0.16513007584314326}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:31604
[S7] not sending this round → trigger blocked (psi=0.081)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.134)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:31612
[S10] not sending this round → trigger blocked (psi=0.199)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:31617
[S4] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S2
[S11] cosine check vs S2: cos=0.0960
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] cosine check vs S15: cos=0.8119
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.9814
[S4] RECEIVED delta(kind=head bytes=1801) from S9
[S4] cosine check vs S9: cos=-0.0056
[S4] DROPPED delta from S9 (cos=-0.0056 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S3
[S8] cosine check vs S3: cos=0.0098
[S5] RECEIVED delta(kind=head bytes=1805) from S4
[S5] cosine check vs S4: cos=-0.0004
[S5] DROPPED delta from S4 (cos=-0.0004 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.092)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.0000 head_norm=1.588632
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.062671e+00
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.170076 delta_norm=1.062671
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.1987 head_norm=0.953188
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.670513e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.2651 head_norm=1.182252 delta_norm=0.467051
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.6138 head_norm=1.452533
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.058342e+00
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.3051 head_norm=1.068697 delta_norm=1.058342
[S8] aggregate: ROLLBACK (f1_val pre=0.614 post=0.305 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.1527 head_norm=1.395690
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.401512e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.1534 head_norm=1.417483 delta_norm=0.140151
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.572560 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.18236982369823698, 'auprc': 0.18236982369823698, 'loss_val': 2.7888096001478218, 'psi': 0.18236982369823698}-{'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 2.3636887010453425, 'psi': 0.2654504593826426}
[S3] START round=15 head_norm_before_train=1.553882 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.2613156698486915, 'auprc': 0.2613156698486915, 'loss_val': 1.7994848065858944, 'psi': 0.2613156698486915}-{'f1_val': 0.2577504483730464, 'auprc': 0.2577504483730464, 'loss_val': 1.5529518446104915, 'psi': 0.2577504483730464}
[S4] START round=15 head_norm_before_train=1.594472 (no previous merge yet)
[S4] round=15 local utility u=0.009084 metrics={'f1_val': 0.33324879533350243, 'auprc': 0.33324879533350243, 'loss_val': 1.2698793606730379, 'psi': 0.33324879533350243}-{'f1_val': 0.3318903318903319, 'auprc': 0.3318903318903319, 'loss_val': 1.2758213115718458, 'psi': 0.3318903318903319}
[S5] START round=15 head_norm_before_train=1.161026 cos_to_last_merge=0.9861 (last merge round=12)
[S5] round=15 local utility u=0.001169 metrics={'f1_val': 0.20171535435609725, 'auprc': 0.20171535435609725, 'loss_val': 1.2350702967675975, 'psi': 0.20171535435609725}-{'f1_val': 0.20381686693759674, 'auprc': 0.20381686693759674, 'loss_val': 1.2563226580205364, 'psi': 0.20381686693759674}
[S6] START round=15 head_norm_before_train=1.625214 (no previous merge yet)
[S6] round=15 local utility u=0.187257 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 4.933006949666357, 'psi': 0.021310724106324473}-{'f1_val': 0.006613131790269249, 'auprc': 0.006613131790269249, 'loss_val': 5.175243511551246, 'psi': 0.006613131790269249}
[S7] START round=15 head_norm_before_train=1.365631 (no previous merge yet)
[S7] round=15 local utility u=0.151711 metrics={'f1_val': 0.11337973704563031, 'auprc': 0.11337973704563031, 'loss_val': 1.3563897392527269, 'psi': 0.11337973704563031}-{'f1_val': 0.08060948636028507, 'auprc': 0.08060948636028507, 'loss_val': 1.3648803394841909, 'psi': 0.08060948636028507}
[S8] START round=15 head_norm_before_train=1.068697 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.3182361024084292, 'auprc': 0.3182361024084292, 'loss_val': 1.121765161976018, 'psi': 0.3182361024084292}-{'f1_val': 0.613824162489346, 'auprc': 0.613824162489346, 'loss_val': 0.9919928032430543, 'psi': 0.613824162489346}
[S9] START round=15 head_norm_before_train=1.601790 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3325987398405568, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1628806085459953, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.182252 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.12797734002832498, 'auprc': 0.12797734002832498, 'loss_val': 2.099153921286614, 'psi': 0.12797734002832498}-{'f1_val': 0.19865771812080538, 'auprc': 0.19865771812080538, 'loss_val': 2.1786613967269313, 'psi': 0.19865771812080538}
[S11] START round=15 head_norm_before_train=1.170076 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.248170 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.231704539346038, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.728045480943629, 'psi': 0.0}
[S13] START round=15 head_norm_before_train=1.472806 (no previous merge yet)
[S13] round=15 local utility u=0.001610 metrics={'f1_val': 0.2449680903289151, 'auprc': 0.2449680903289151, 'loss_val': 1.1185395484491816, 'psi': 0.2449680903289151}-{'f1_val': 0.24400555656217915, 'auprc': 0.24400555656217915, 'loss_val': 1.113097199690075, 'psi': 0.24400555656217915}
[S14] START round=15 head_norm_before_train=1.557029 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.10747602154775981, 'auprc': 0.10747602154775981, 'loss_val': 4.978632245666129, 'psi': 0.10747602154775981}-{'f1_val': 0.13353375923838157, 'auprc': 0.13353375923838157, 'loss_val': 4.9086447082112805, 'psi': 0.13353375923838157}
[S15] START round=15 head_norm_before_train=1.524187 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.2762362806757923, 'auprc': 0.2762362806757923, 'loss_val': 0.9585419276850605, 'psi': 0.2762362806757923}-{'f1_val': 0.3100146445871353, 'auprc': 0.3100146445871353, 'loss_val': 0.9965226539729831, 'psi': 0.3100146445871353}
[S16] START round=15 head_norm_before_train=1.553687 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.05688622754491018, 'auprc': 0.05688622754491018, 'loss_val': 3.538645690513096, 'psi': 0.056886227544910184}-{'f1_val': 0.09246347941567065, 'auprc': 0.09246347941567065, 'loss_val': 3.2867579661753226, 'psi': 0.09246347941567065}
[S17] START round=15 head_norm_before_train=1.417483 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.020498 metrics={'f1_val': 0.15597696584590945, 'auprc': 0.15597696584590945, 'loss_val': 1.235251704957286, 'psi': 0.15597696584590945}-{'f1_val': 0.1526522037501123, 'auprc': 0.1526522037501123, 'loss_val': 1.246324172686651, 'psi': 0.1526522037501123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:31605
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.021)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:31605
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.113)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:31611
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S4
[S5] cosine check vs S4: cos=-0.0045
[S5] DROPPED delta from S4 (cos=-0.0045 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S5
[S10] cosine check vs S5: cos=0.2277
[S5] RECEIVED delta(kind=head bytes=1798) from S13
[S5] cosine check vs S13: cos=-0.0786
[S5] DROPPED delta from S13 (cos=-0.0786 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S17
[S5] cosine check vs S17: cos=0.8744
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.1280 head_norm=1.208550
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.477022e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.0446 head_norm=0.942685 delta_norm=0.747702
[S10] aggregate: ROLLBACK (f1_val pre=0.128 post=0.045 tol_abs=0.005 tol_rel=0.0)
[S10] ⇄ pheromone p=0.176 → S16@127.0.0.1:31616
[S2] ⇄ pheromone p=0.246 → S16@127.0.0.1:31616
[S15] ⇄ pheromone p=0.222 → S10@127.0.0.1:31611
[S14] ⇄ pheromone p=0.122 → S15@127.0.0.1:31615
[S8] ⇄ pheromone p=0.326 → S17@127.0.0.1:31617
[S9] ⇄ pheromone p=0.260 → S4@127.0.0.1:31604
[S6] ⇄ pheromone p=0.093 → S4@127.0.0.1:31604
[S7] ⇄ pheromone p=0.133 → S17@127.0.0.1:31617
[S11] ⇄ pheromone p=0.127 → S13@127.0.0.1:31613
[S4] ⇄ pheromone p=0.219 → S9@127.0.0.1:31610
[S13] ⇄ pheromone p=0.277 → S5@127.0.0.1:31605
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.2017 head_norm=1.197845
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.531263e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.2017 head_norm=1.281512 delta_norm=0.353126
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.230 → S14@127.0.0.1:31614
[S16] ⇄ pheromone p=0.119 → S8@127.0.0.1:31609
[S17] ⇄ pheromone p=0.187 → S5@127.0.0.1:31605
[S2] START round=16 head_norm_before_train=1.602144 (no previous merge yet)
[S2] round=16 local utility u=0.616663 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.302504309802321, 'psi': 0.26537216828478966}-{'f1_val': 0.18236982369823698, 'auprc': 0.18236982369823698, 'loss_val': 2.7888096001478218, 'psi': 0.18236982369823698}
[S3] START round=16 head_norm_before_train=1.579951 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.2616725191832488, 'auprc': 0.2616725191832488, 'loss_val': 1.922337736560359, 'psi': 0.2616725191832488}-{'f1_val': 0.2613156698486915, 'auprc': 0.2613156698486915, 'loss_val': 1.7994848065858944, 'psi': 0.2613156698486915}
[S4] START round=16 head_norm_before_train=1.625356 (no previous merge yet)
[S4] round=16 local utility u=0.109938 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2619086589489414, 'psi': 0.3567939207526687}-{'f1_val': 0.33324879533350243, 'auprc': 0.33324879533350243, 'loss_val': 1.2698793606730379, 'psi': 0.33324879533350243}
[S5] START round=16 head_norm_before_train=1.281512 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.20135527589545013, 'auprc': 0.20135527589545013, 'loss_val': 1.2689104520699648, 'psi': 0.20135527589545013}-{'f1_val': 0.20171535435609725, 'auprc': 0.20171535435609725, 'loss_val': 1.2350702967675975, 'psi': 0.20171535435609725}
[S6] START round=16 head_norm_before_train=1.642715 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.0021448999046711154, 'auprc': 0.0021448999046711154, 'loss_val': 5.516311529213576, 'psi': 0.0021448999046711154}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 4.933006949666357, 'psi': 0.021310724106324473}
[S7] START round=16 head_norm_before_train=1.388038 (no previous merge yet)
[S7] round=16 local utility u=0.291945 metrics={'f1_val': 0.17477997799779976, 'auprc': 0.17477997799779976, 'loss_val': 1.3251012766805383, 'psi': 0.17477997799779976}-{'f1_val': 0.11337973704563031, 'auprc': 0.11337973704563031, 'loss_val': 1.3563897392527269, 'psi': 0.11337973704563031}
[S8] START round=16 head_norm_before_train=1.105685 cos_to_last_merge=0.9982 (last merge round=14)
[S8] round=16 local utility u=0.929142 metrics={'f1_val': 0.5180491646208822, 'auprc': 0.5180491646208822, 'loss_val': 1.0617982545709477, 'psi': 0.5180491646208822}-{'f1_val': 0.3182361024084292, 'auprc': 0.3182361024084292, 'loss_val': 1.121765161976018, 'psi': 0.3182361024084292}
[S9] START round=16 head_norm_before_train=1.631018 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4430117561737585, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3325987398405568, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=0.942685 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3435224405750477, 'psi': 0.0}-{'f1_val': 0.12797734002832498, 'auprc': 0.12797734002832498, 'loss_val': 2.099153921286614, 'psi': 0.12797734002832498}
[S11] START round=16 head_norm_before_train=1.196848 cos_to_last_merge=0.9990 (last merge round=14)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3921196453754257, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.231704539346038, 'psi': 0.0}
[S13] START round=16 head_norm_before_train=1.502638 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.23885028802185404, 'auprc': 0.23885028802185404, 'loss_val': 1.1507506482370276, 'psi': 0.23885028802185404}-{'f1_val': 0.2449680903289151, 'auprc': 0.2449680903289151, 'loss_val': 1.1185395484491816, 'psi': 0.2449680903289151}
[S14] START round=16 head_norm_before_train=1.584682 (no previous merge yet)
[S14] round=16 local utility u=0.042062 metrics={'f1_val': 0.12039532794249776, 'auprc': 0.12039532794249776, 'loss_val': 5.010782426449367, 'psi': 0.12039532794249776}-{'f1_val': 0.10747602154775981, 'auprc': 0.10747602154775981, 'loss_val': 4.978632245666129, 'psi': 0.10747602154775981}
[S15] START round=16 head_norm_before_train=1.556393 (no previous merge yet)
[S15] round=16 local utility u=0.074220 metrics={'f1_val': 0.2800976800976801, 'auprc': 0.2800976800976801, 'loss_val': 0.8448553766177064, 'psi': 0.2800976800976801}-{'f1_val': 0.2762362806757923, 'auprc': 0.2762362806757923, 'loss_val': 0.9585419276850605, 'psi': 0.2762362806757923}
[S16] START round=16 head_norm_before_train=1.584381 (no previous merge yet)
[S16] round=16 local utility u=0.286492 metrics={'f1_val': 0.11272364278584045, 'auprc': 0.11272364278584045, 'loss_val': 3.468197825861449, 'psi': 0.11272364278584045}-{'f1_val': 0.05688622754491018, 'auprc': 0.05688622754491018, 'loss_val': 3.538645690513096, 'psi': 0.056886227544910184}
[S17] START round=16 head_norm_before_train=1.448830 cos_to_last_merge=0.9976 (last merge round=14)
[S17] round=16 local utility u=0.017928 metrics={'f1_val': 0.15823932312651087, 'auprc': 0.15823932312651087, 'loss_val': 1.2197573598449, 'psi': 0.15823932312651087}-{'f1_val': 0.15597696584590945, 'auprc': 0.15597696584590945, 'loss_val': 1.235251704957286, 'psi': 0.15597696584590945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:31616
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:31614
[S14] not sending this round → trigger blocked (psi=0.120)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.175)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:31603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:31610
[S16] not sending this round → trigger blocked (psi=0.113)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.6729
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=-0.0279
[S14] DROPPED delta from S15 (cos=-0.0279 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S4
[S9] cosine check vs S4: cos=-0.0037
[S9] DROPPED delta from S4 (cos=-0.0037 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S2
[S16] cosine check vs S2: cos=-0.0046
[S16] DROPPED delta from S2 (cos=-0.0046 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:31609
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.7039
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.2617 head_norm=1.605255
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.950949e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.2620 head_norm=1.267996 delta_norm=0.595095
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.5180 head_norm=1.160629
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.303865e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.7292 head_norm=1.222344 delta_norm=0.530387
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.629514 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.2577472379412557, 'auprc': 0.2577472379412557, 'loss_val': 2.5487994003744094, 'psi': 0.2577472379412557}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.302504309802321, 'psi': 0.26537216828478966}
[S3] START round=17 head_norm_before_train=1.267996 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.113023 metrics={'f1_val': 0.26121389159363845, 'auprc': 0.26121389159363845, 'loss_val': 1.69216356100663, 'psi': 0.26121389159363845}-{'f1_val': 0.2616725191832488, 'auprc': 0.2616725191832488, 'loss_val': 1.922337736560359, 'psi': 0.2616725191832488}
[S4] START round=17 head_norm_before_train=1.652092 (no previous merge yet)
[S4] round=17 local utility u=0.001406 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2590971292579838, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2619086589489414, 'psi': 0.3567939207526687}
[S5] START round=17 head_norm_before_train=1.307340 cos_to_last_merge=0.9983 (last merge round=15)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.142644726407613, 'auprc': 0.142644726407613, 'loss_val': 1.25925858348534, 'psi': 0.142644726407613}-{'f1_val': 0.20135527589545013, 'auprc': 0.20135527589545013, 'loss_val': 1.2689104520699648, 'psi': 0.20135527589545013}
[S6] START round=17 head_norm_before_train=1.657071 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.010543580131208997, 'auprc': 0.010543580131208997, 'loss_val': 5.6008985586614735, 'psi': 0.010543580131208997}-{'f1_val': 0.0021448999046711154, 'auprc': 0.0021448999046711154, 'loss_val': 5.516311529213576, 'psi': 0.0021448999046711154}
[S7] START round=17 head_norm_before_train=1.410057 (no previous merge yet)
[S7] round=17 local utility u=0.180124 metrics={'f1_val': 0.21166444062837883, 'auprc': 0.21166444062837883, 'loss_val': 1.2968143115484978, 'psi': 0.2116644406283788}-{'f1_val': 0.17477997799779976, 'auprc': 0.17477997799779976, 'loss_val': 1.3251012766805383, 'psi': 0.17477997799779976}
[S8] START round=17 head_norm_before_train=1.222344 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=1.000000 metrics={'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 0.9566848215493443, 'psi': 1.0}-{'f1_val': 0.5180491646208822, 'auprc': 0.5180491646208822, 'loss_val': 1.0617982545709477, 'psi': 0.5180491646208822}
[S9] START round=17 head_norm_before_train=1.657021 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.519562197740999, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4430117561737585, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=0.985585 cos_to_last_merge=0.9930 (last merge round=15)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.812468580131147, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3435224405750477, 'psi': 0.0}
[S11] START round=17 head_norm_before_train=1.235940 cos_to_last_merge=0.9950 (last merge round=14)
[S11] round=17 local utility u=0.090392 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.211335549494251, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3921196453754257, 'psi': 0.0}
[S13] START round=17 head_norm_before_train=1.533716 (no previous merge yet)
[S13] round=17 local utility u=0.005703 metrics={'f1_val': 0.24, 'auprc': 0.24, 'loss_val': 1.1496928633705443, 'psi': 0.24}-{'f1_val': 0.23885028802185404, 'auprc': 0.23885028802185404, 'loss_val': 1.1507506482370276, 'psi': 0.23885028802185404}
[S14] START round=17 head_norm_before_train=1.612849 (no previous merge yet)
[S14] round=17 local utility u=0.038395 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.050434872870735, 'psi': 0.13333333333333333}-{'f1_val': 0.12039532794249776, 'auprc': 0.12039532794249776, 'loss_val': 5.010782426449367, 'psi': 0.12039532794249776}
[S15] START round=17 head_norm_before_train=1.588788 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.23219431864965004, 'auprc': 0.23219431864965004, 'loss_val': 0.9695707790156245, 'psi': 0.23219431864965}-{'f1_val': 0.2800976800976801, 'auprc': 0.2800976800976801, 'loss_val': 0.8448553766177064, 'psi': 0.2800976800976801}
[S16] START round=17 head_norm_before_train=1.612055 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.11195693963860054, 'auprc': 0.11195693963860054, 'loss_val': 3.6606428024801407, 'psi': 0.11195693963860054}-{'f1_val': 0.11272364278584045, 'auprc': 0.11272364278584045, 'loss_val': 3.468197825861449, 'psi': 0.11272364278584045}
[S17] START round=17 head_norm_before_train=1.484524 cos_to_last_merge=0.9920 (last merge round=14)
[S17] round=17 local utility u=0.014452 metrics={'f1_val': 0.1600407747196738, 'auprc': 0.1600407747196738, 'loss_val': 1.2070657185513356, 'psi': 0.1600407747196738}-{'f1_val': 0.15823932312651087, 'auprc': 0.15823932312651087, 'loss_val': 1.2197573598449, 'psi': 0.15823932312651087}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:31603
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:31610
[S14] not sending this round → trigger blocked (psi=0.133)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S13
[S11] cosine check vs S13: cos=0.0059
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=-0.0032
[S9] DROPPED delta from S4 (cos=-0.0032 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=0.5901
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:31609
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9376
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.2612 head_norm=1.296871
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.847873e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.2618 head_norm=1.151807 delta_norm=0.584787
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.0000 head_norm=1.270242
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.004365e+00
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.0000 head_norm=1.010151 delta_norm=1.004365
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=1.0000 head_norm=1.286622
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.721033e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9994 head_norm=1.379454 delta_norm=0.272103
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.651659 (no previous merge yet)
[S2] round=18 local utility u=0.042260 metrics={'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 2.5336084295088117, 'psi': 0.2654504593826426}-{'f1_val': 0.2577472379412557, 'auprc': 0.2577472379412557, 'loss_val': 2.5487994003744094, 'psi': 0.2577472379412557}
[S3] START round=18 head_norm_before_train=1.151807 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.092088 metrics={'f1_val': 0.2785739010038076, 'auprc': 0.2785739010038076, 'loss_val': 1.6642266988946257, 'psi': 0.2785739010038076}-{'f1_val': 0.26121389159363845, 'auprc': 0.26121389159363845, 'loss_val': 1.69216356100663, 'psi': 0.26121389159363845}
[S4] START round=18 head_norm_before_train=1.673589 (no previous merge yet)
[S4] round=18 local utility u=0.000156 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2587845772168786, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2590971292579838, 'psi': 0.3567939207526687}
[S5] START round=18 head_norm_before_train=1.334125 cos_to_last_merge=0.9943 (last merge round=15)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.0007388935069733075, 'auprc': 0.0007388935069733075, 'loss_val': 1.425540772522254, 'psi': 0.0007388935069733075}-{'f1_val': 0.142644726407613, 'auprc': 0.142644726407613, 'loss_val': 1.25925858348534, 'psi': 0.142644726407613}
[S6] START round=18 head_norm_before_train=1.671344 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.9045770273890446, 'psi': 0.0}-{'f1_val': 0.010543580131208997, 'auprc': 0.010543580131208997, 'loss_val': 5.6008985586614735, 'psi': 0.010543580131208997}
[S7] START round=18 head_norm_before_train=1.430691 (no previous merge yet)
[S7] round=18 local utility u=0.001886 metrics={'f1_val': 0.21227134146341464, 'auprc': 0.21227134146341464, 'loss_val': 1.298503483934843, 'psi': 0.21227134146341464}-{'f1_val': 0.21166444062837883, 'auprc': 0.21166444062837883, 'loss_val': 1.2968143115484978, 'psi': 0.2116644406283788}
[S8] START round=18 head_norm_before_train=1.379454 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9198807328954748, 'psi': 0.35939447907390915}-{'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 0.9566848215493443, 'psi': 1.0}
[S9] START round=18 head_norm_before_train=1.679572 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5961693443878, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.519562197740999, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.032527 cos_to_last_merge=0.9782 (last merge round=15)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1001316201135114, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.812468580131147, 'psi': 0.0}
[S11] START round=18 head_norm_before_train=1.010151 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.459504 metrics={'f1_val': 0.07219214216298765, 'auprc': 0.07219214216298765, 'loss_val': 1.9420561468013589, 'psi': 0.07219214216298765}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.211335549494251, 'psi': 0.0}
[S13] START round=18 head_norm_before_train=1.563584 (no previous merge yet)
[S13] round=18 local utility u=0.518690 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1917399158055366, 'psi': 0.3599362944611573}-{'f1_val': 0.24, 'auprc': 0.24, 'loss_val': 1.1496928633705443, 'psi': 0.24}
[S14] START round=18 head_norm_before_train=1.639889 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.13433395872420262, 'auprc': 0.13433395872420262, 'loss_val': 5.114439312040507, 'psi': 0.13433395872420262}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.050434872870735, 'psi': 0.13333333333333333}
[S15] START round=18 head_norm_before_train=1.618708 (no previous merge yet)
[S15] round=18 local utility u=0.403357 metrics={'f1_val': 0.2926276374925915, 'auprc': 0.2926276374925915, 'loss_val': 0.7067558943428406, 'psi': 0.2926276374925915}-{'f1_val': 0.23219431864965004, 'auprc': 0.23219431864965004, 'loss_val': 0.9695707790156245, 'psi': 0.23219431864965}
[S16] START round=18 head_norm_before_train=1.637496 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.09966202939558282, 'auprc': 0.09966202939558282, 'loss_val': 3.8411042396533515, 'psi': 0.09966202939558282}-{'f1_val': 0.11195693963860054, 'auprc': 0.11195693963860054, 'loss_val': 3.6606428024801407, 'psi': 0.11195693963860054}
[S17] START round=18 head_norm_before_train=1.516072 cos_to_last_merge=0.9863 (last merge round=14)
[S17] round=18 local utility u=0.003006 metrics={'f1_val': 0.1554522066099347, 'auprc': 0.1554522066099347, 'loss_val': 1.1597568428790308, 'psi': 0.1554522066099347}-{'f1_val': 0.1600407747196738, 'auprc': 0.1600407747196738, 'loss_val': 1.2070657185513356, 'psi': 0.1600407747196738}
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:31612
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:31614
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.072)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:31610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S4
[S9] cosine check vs S4: cos=-0.0028
[S9] DROPPED delta from S4 (cos=-0.0028 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S2
[S16] cosine check vs S2: cos=-0.0070
[S16] DROPPED delta from S2 (cos=-0.0070 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=-0.0299
[S14] DROPPED delta from S15 (cos=-0.0299 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S13
[S11] cosine check vs S13: cos=0.7541
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:31609
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=0.9826
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S16
[S10]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S17
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.0722 head_norm=1.044794
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.284222e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.0003 head_norm=1.238288 delta_norm=0.528422
[S11] aggregate: ROLLBACK (f1_val pre=0.072 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.3594 head_norm=1.431457
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.494892e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.3594 head_norm=1.480633 delta_norm=0.149489
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.674169 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.5616426800705705, 'psi': 0.2653978324081417}-{'f1_val': 0.2654504593826426, 'auprc': 0.2654504593826426, 'loss_val': 2.5336084295088117, 'psi': 0.2654504593826426}
[S3] START round=19 head_norm_before_train=1.186842 cos_to_last_merge=0.9977 (last merge round=17)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.2609597924773022, 'auprc': 0.2609597924773022, 'loss_val': 1.5785236269481573, 'psi': 0.2609597924773022}-{'f1_val': 0.2785739010038076, 'auprc': 0.2785739010038076, 'loss_val': 1.6642266988946257, 'psi': 0.2785739010038076}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=20 psi=0.261 u=0.0000 p_local=0.1238 f1=0.261 auprc=0.261 bytes=5409
[S4] START round=19 head_norm_before_train=1.700438 (no previous merge yet)
[S4] round=19 local utility u=0.002140 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2545046580702675, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2587845772168786, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.363059 cos_to_last_merge=0.9889 (last merge round=15)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.0007388935069733075, 'auprc': 0.0007388935069733075, 'loss_val': 2.069018682158301, 'psi': 0.0007388935069733075}-{'f1_val': 0.0007388935069733075, 'auprc': 0.0007388935069733075, 'loss_val': 1.425540772522254, 'psi': 0.0007388935069733075}
[S6] START round=19 head_norm_before_train=1.683793 (no previous merge yet)
[S6] round=19 local utility u=0.436943 metrics={'f1_val': 0.02737556561085973, 'auprc': 0.02737556561085973, 'loss_val': 5.277071424768234, 'psi': 0.02737556561085973}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.9045770273890446, 'psi': 0.0}
[S6] not sending this round → trigger blocked (psi=0.027)
[S6] r=20 psi=0.027 u=0.4369 p_local=0.1257 f1=0.027 auprc=0.027 bytes=0
[S7] START round=19 head_norm_before_train=1.446626 (no previous merge yet)
[S7] round=19 local utility u=0.687000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2519346792311137, 'psi': 0.35976373724718097}-{'f1_val': 0.21227134146341464, 'auprc': 0.21227134146341464, 'loss_val': 1.298503483934843, 'psi': 0.21227134146341464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S7] r=20 psi=0.360 u=0.6870 p_local=0.2451 f1=0.360 auprc=0.360 bytes=5391
[S8] START round=19 head_norm_before_train=1.480633 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.005078 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9097237750440533, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9198807328954748, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.699994 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.660942258422156, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5961693443878, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.075482 cos_to_last_merge=0.9637 (last merge round=15)
[S10] round=19 local utility u=0.025598 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.048935306404109, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1001316201135114, 'psi': 0.0}
[S11] START round=19 head_norm_before_train=1.238288 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.870988 metrics={'f1_val': 0.25639551595286003, 'auprc': 0.25639551595286003, 'loss_val': 1.8579098298039447, 'psi': 0.25639551595286003}-{'f1_val': 0.07219214216298765, 'auprc': 0.07219214216298765, 'loss_val': 1.9420561468013589, 'psi': 0.07219214216298765}
[S13] START round=19 head_norm_before_train=1.591722 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2073151603719343, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1917399158055366, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.665461 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.11828372632392732, 'auprc': 0.11828372632392732, 'loss_val': 5.234825640377122, 'psi': 0.11828372632392732}-{'f1_val': 0.13433395872420262, 'auprc': 0.13433395872420262, 'loss_val': 5.114439312040507, 'psi': 0.13433395872420262}
[S15] START round=19 head_norm_before_train=1.643041 (no previous merge yet)
[S15] round=19 local utility u=1.000000 metrics={'f1_val': 0.5730582081724691, 'auprc': 0.5730582081724691, 'loss_val': 0.9072375648596733, 'psi': 0.5730582081724691}-{'f1_val': 0.2926276374925915, 'auprc': 0.2926276374925915, 'loss_val': 0.7067558943428406, 'psi': 0.2926276374925915}
[S16] START round=19 head_norm_before_train=1.660786 (no previous merge yet)
[S16] round=19 local utility u=0.074634 metrics={'f1_val': 0.12039981826442527, 'auprc': 0.12039981826442527, 'loss_val': 3.8784758684746006, 'psi': 0.12039981826442527}-{'f1_val': 0.09966202939558282, 'auprc': 0.09966202939558282, 'loss_val': 3.8411042396533515, 'psi': 0.09966202939558282}
[S17] START round=19 head_norm_before_train=1.542781 cos_to_last_merge=0.9815 (last merge round=14)
[S17] round=19 local utility u=0.019475 metrics={'f1_val': 0.15414050235478807, 'auprc': 0.15414050235478807, 'loss_val': 1.109001080105933, 'psi': 0.15414050235478807}-{'f1_val': 0.1554522066099347, 'auprc': 0.1554522066099347, 'loss_val': 1.1597568428790308, 'psi': 0.1554522066099347}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:31614
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:31602
[S14] r=20 psi=0.118 u=0.0000 p_local=0.0593 f1=0.118 auprc=0.118 bytes=0
[S9] r=20 psi=0.369 u=0.0000 p_local=0.1064 f1=0.369 auprc=0.369 bytes=3604
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.120)
[S11] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:31610
[S2] r=20 psi=0.265 u=0.0000 p_local=0.1707 f1=0.265 auprc=0.265 bytes=5400
[S13] r=20 psi=0.360 u=0.0000 p_local=0.1974 f1=0.360 auprc=0.360 bytes=10783
[S2] RECEIVED delta(kind=head bytes=1791) from S11
[S2] cosine check vs S11: cos=0.1834
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=-0.0302
[S14] DROPPED delta from S15 (cos=-0.0302 < 0.0)
[S15] r=20 psi=0.573 u=1.0000 p_local=0.3632 f1=0.573 auprc=0.573 bytes=9008
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] r=20 psi=0.256 u=0.8710 p_local=0.3112 f1=0.256 auprc=0.256 bytes=1791
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] cosine check vs S4: cos=-0.0022
[S9] DROPPED delta from S4 (cos=-0.0022 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:31603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:31609
[S10] not sending this round → trigger blocked (psi=0.000)
[S4] r=20 psi=0.357 u=0.0021 p_local=0.1015 f1=0.357 auprc=0.357 bytes=12607
[S8] sending update (kind=head size=1806 to 1 peers)
[S17] sending update (kind=head size=1808 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1806) from S8
[S3] cosine check vs S8: cos=0.6899
[S8] RECEIVED delta(kind=head bytes=1808) from S17
[S8] cosine check vs S17: cos=0.9927
[S17] r=20 psi=0.154 u=0.0195 p_local=0.0847 f1=0.154 auprc=0.154 bytes=14418
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.3594 head_norm=1.520770
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.568819e-02
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.3594 head_norm=1.540630 delta_norm=0.095688
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.359 u=0.0051 p_local=0.3577 f1=0.359 auprc=0.359 bytes=16199
[S16] r=20 psi=0.120 u=0.0746 p_local=0.0928 f1=0.120 auprc=0.120 bytes=0
[S10] r=20 psi=0.000 u=0.0256 p_local=0.0772 f1=0.000 auprc=0.000 bytes=0
[S5] r=20 psi=0.001 u=0.0000 p_local=0.0944 f1=0.001 auprc=0.001 bytes=8992
[S2] START round=20 head_norm_before_train=1.695764 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.209709030604553, 'auprc': 0.209709030604553, 'loss_val': 2.8573800724998453, 'psi': 0.20970903060455304}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.5616426800705705, 'psi': 0.2653978324081417}
[S3] START round=20 head_norm_before_train=1.230957 cos_to_last_merge=0.9911 (last merge round=17)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.2616214810480463, 'auprc': 0.2616214810480463, 'loss_val': 1.710450679022419, 'psi': 0.2616214810480463}-{'f1_val': 0.2609597924773022, 'auprc': 0.2609597924773022, 'loss_val': 1.5785236269481573, 'psi': 0.2609597924773022}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.2616 head_norm=1.274720
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.833175e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.2619 head_norm=1.276154 delta_norm=0.583317
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=20 head_norm_before_train=1.725499 (no previous merge yet)
[S4] round=20 local utility u=0.002331 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2498417706465987, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2545046580702675, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.394065 cos_to_last_merge=0.9824 (last merge round=15)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.0015424393417920925, 'auprc': 0.0015424393417920925, 'loss_val': 2.7125716768726145, 'psi': 0.0015424393417920925}-{'f1_val': 0.0007388935069733075, 'auprc': 0.0007388935069733075, 'loss_val': 2.069018682158301, 'psi': 0.0007388935069733075}
[S6] START round=20 head_norm_before_train=1.694135 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 6.091945567863015, 'psi': 0.002619047619047619}-{'f1_val': 0.02737556561085973, 'auprc': 0.02737556561085973, 'loss_val': 5.277071424768234, 'psi': 0.02737556561085973}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=1.464172 (no previous merge yet)
[S7] round=20 local utility u=0.024576 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2027817764061834, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2519346792311137, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=20 head_norm_before_train=1.540630 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000282 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9091596685998147, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9097237750440533, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.717252 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.715181779472053, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.660942258422156, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.110186 cos_to_last_merge=0.9521 (last merge round=15)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.475619104391498, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.048935306404109, 'psi': 0.0}
[S11] START round=20 head_norm_before_train=1.271589 cos_to_last_merge=0.9960 (last merge round=18)
[S11] round=20 local utility u=0.259198 metrics={'f1_val': 0.32861412616013846, 'auprc': 0.32861412616013846, 'loss_val': 1.989481887959925, 'psi': 0.32861412616013846}-{'f1_val': 0.25639551595286003, 'auprc': 0.25639551595286003, 'loss_val': 1.8579098298039447, 'psi': 0.25639551595286003}
[S13] START round=20 head_norm_before_train=1.615837 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.229012404059686, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2073151603719343, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.689146 (no previous merge yet)
[S14] round=20 local utility u=0.023370 metrics={'f1_val': 0.12990288813217304, 'auprc': 0.12990288813217304, 'loss_val': 5.292658156791173, 'psi': 0.12990288813217304}-{'f1_val': 0.11828372632392732, 'auprc': 0.11828372632392732, 'loss_val': 5.234825640377122, 'psi': 0.11828372632392732}
[S15] START round=20 head_norm_before_train=1.661452 (no previous merge yet)
[S15] round=20 local utility u=0.285109 metrics={'f1_val': 0.6155201796505004, 'auprc': 0.6155201796505004, 'loss_val': 0.7191765634639725, 'psi': 0.6155201796505004}-{'f1_val': 0.5730582081724691, 'auprc': 0.5730582081724691, 'loss_val': 0.9072375648596733, 'psi': 0.5730582081724691}
[S16] START round=20 head_norm_before_train=1.681746 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.0829284094590217, 'auprc': 0.0829284094590217, 'loss_val': 4.361536750703481, 'psi': 0.0829284094590217}-{'f1_val': 0.12039981826442527, 'auprc': 0.12039981826442527, 'loss_val': 3.8784758684746006, 'psi': 0.12039981826442527}
[S17] START round=20 head_norm_before_train=1.566094 cos_to_last_merge=0.9775 (last merge round=14)
[S17] round=20 local utility u=0.020813 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.0512311322153465, 'psi': 0.15234678044996122}-{'f1_val': 0.15414050235478807, 'auprc': 0.15414050235478807, 'loss_val': 1.109001080105933, 'psi': 0.15414050235478807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:31602
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:31614
[S14] not sending this round → trigger blocked (psi=0.130)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.085 → S4@127.0.0.1:31604
[S15] sending update (kind=head size=1806 to 1 peers)
[S14] ⇄ pheromone p=0.052 → S5@127.0.0.1:31605
[S13] ⇄ pheromone p=0.158 → S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:31610
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.2097 head_norm=1.714892
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.702323e-01
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.2094 head_norm=1.156523 delta_norm=0.970232
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.137 → S16@127.0.0.1:31616
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1806) from S15
[S14] cosine check vs S15: cos=-0.0300
[S14] DROPPED delta from S15 (cos=-0.0300 < 0.0)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:31603
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.348 → S14@127.0.0.1:31614
[S9] RECEIVED delta(kind=head bytes=1797) from S4
[S9] cosine check vs S4: cos=-0.0014
[S9] DROPPED delta from S4 (cos=-0.0014 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:31609
[S8] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] cosine check vs S8: cos=0.9125
[S16] ⇄ pheromone p=0.074 → S10@127.0.0.1:31611
[S11] sending update (kind=head size=1797 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=0.9957
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.6828
[S10] ⇄ pheromone p=0.062 → S5@127.0.0.1:31605
[S4] ⇄ pheromone p=0.082 → S6@127.0.0.1:31607
[S11] ⇄ pheromone p=0.301 → S2@127.0.0.1:31602
[S5] ⇄ pheromone p=0.076 → S13@127.0.0.1:31613
[S17] ⇄ pheromone p=0.072 → S8@127.0.0.1:31609
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.3594 head_norm=1.573495
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.381485e-02
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.3594 head_norm=1.580314 delta_norm=0.073815
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.286 → S3@127.0.0.1:31603
[S2] START round=21 head_norm_before_train=1.156523 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.771236 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.8161075558764923, 'psi': 0.2653978324081417}-{'f1_val': 0.209709030604553, 'auprc': 0.209709030604553, 'loss_val': 2.8573800724998453, 'psi': 0.20970903060455304}
[S3] START round=21 head_norm_before_train=1.276154 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.099746 metrics={'f1_val': 0.26080757016008815, 'auprc': 0.26080757016008815, 'loss_val': 1.5036340347348216, 'psi': 0.26080757016008815}-{'f1_val': 0.2616214810480463, 'auprc': 0.2616214810480463, 'loss_val': 1.710450679022419, 'psi': 0.2616214810480463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.2608 head_norm=1.308875
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.645662e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.2611 head_norm=1.400576 delta_norm=0.364566
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=21 head_norm_before_train=1.749793 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2517009876594012, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2498417706465987, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.424549 cos_to_last_merge=0.9760 (last merge round=15)
[S5] round=21 local utility u=0.894264 metrics={'f1_val': 0.22677768949287125, 'auprc': 0.22677768949287125, 'loss_val': 2.9511611571671863, 'psi': 0.22677768949287125}-{'f1_val': 0.0015424393417920925, 'auprc': 0.0015424393417920925, 'loss_val': 2.7125716768726145, 'psi': 0.0015424393417920925}
[S6] START round=21 head_norm_before_train=1.703484 (no previous merge yet)
[S6] round=21 local utility u=0.411303 metrics={'f1_val': 0.03140421713772992, 'auprc': 0.03140421713772992, 'loss_val': 5.528406091765994, 'psi': 0.03140421713772992}-{'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 6.091945567863015, 'psi': 0.002619047619047619}
[S6] not sending this round → trigger blocked (psi=0.031)
[S7] START round=21 head_norm_before_train=1.487124 (no previous merge yet)
[S7] round=21 local utility u=0.007575 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1876313263046698, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2027817764061834, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=21 head_norm_before_train=1.580314 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000896 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9073677138309498, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9091596685998147, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.732353 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7619144898997137, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.715181779472053, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.137026 cos_to_last_merge=0.9428 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=21 local utility u=0.061357 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3529046193640553, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.475619104391498, 'psi': 0.0}
[S11] START round=21 head_norm_before_train=1.318577 cos_to_last_merge=0.9854 (last merge round=18)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.3317035312378735, 'auprc': 0.3317035312378735, 'loss_val': 2.048766720469754, 'psi': 0.3317035312378735}-{'f1_val': 0.32861412616013846, 'auprc': 0.32861412616013846, 'loss_val': 1.989481887959925, 'psi': 0.32861412616013846}
[S13] START round=21 head_norm_before_train=1.634155 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2744239551846803, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.229012404059686, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.711564 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.348772977725517, 'psi': 0.13572854291417166}-{'f1_val': 0.12990288813217304, 'auprc': 0.12990288813217304, 'loss_val': 5.292658156791173, 'psi': 0.12990288813217304}
[S15] START round=21 head_norm_before_train=1.678583 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6119075969112203, 'auprc': 0.6119075969112203, 'loss_val': 0.7330192759908195, 'psi': 0.6119075969112203}-{'f1_val': 0.6155201796505004, 'auprc': 0.6155201796505004, 'loss_val': 0.7191765634639725, 'psi': 0.6155201796505004}
[S16] START round=21 head_norm_before_train=1.699470 (no previous merge yet)
[S16] round=21 local utility u=0.569260 metrics={'f1_val': 0.14436721691282942, 'auprc': 0.14436721691282942, 'loss_val': 3.7759660761971277, 'psi': 0.14436721691282942}-{'f1_val': 0.0829284094590217, 'auprc': 0.0829284094590217, 'loss_val': 4.361536750703481, 'psi': 0.0829284094590217}
[S17] START round=21 head_norm_before_train=1.590534 cos_to_last_merge=0.9736 (last merge round=14)
[S17] round=21 local utility u=0.024686 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.0010625704735063, 'psi': 0.1522581895716224}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.0512311322153465, 'psi': 0.15234678044996122}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:31616
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.144)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] cosine check vs S2: cos=0.0285
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.2654 head_norm=1.192086
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.171463e-01
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.2654 head_norm=1.145608 delta_norm=0.517146
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:31603
[S8] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S8
[S3] cosine check vs S8: cos=0.9715
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:31613
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S5
[S13] cosine check vs S5: cos=-0.0677
[S13] DROPPED delta from S5 (cos=-0.0677 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.1444 head_norm=1.714308
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.029994e+00
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.1449 head_norm=1.057862 delta_norm=1.029994
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:31609
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9969
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.3594 head_norm=1.609488
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.382095e-02
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.3594 head_norm=1.609809 delta_norm=0.063821
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.145608 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.086131 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.6438458890283822, 'psi': 0.2653978324081417}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.8161075558764923, 'psi': 0.2653978324081417}
[S3] START round=22 head_norm_before_train=1.400576 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.026331 metrics={'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 1.4328565257684072, 'psi': 0.2587947777992154}-{'f1_val': 0.26080757016008815, 'auprc': 0.26080757016008815, 'loss_val': 1.5036340347348216, 'psi': 0.26080757016008815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.2588 head_norm=1.424204
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.485646e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.2593 head_norm=1.499206 delta_norm=0.248565
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=22 head_norm_before_train=1.772274 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.260344559905485, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2517009876594012, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.449676 cos_to_last_merge=0.9710 (last merge round=15)
[S5] round=22 local utility u=0.441292 metrics={'f1_val': 0.33384309419441793, 'auprc': 0.33384309419441793, 'loss_val': 3.032165809297641, 'psi': 0.33384309419441793}-{'f1_val': 0.22677768949287125, 'auprc': 0.22677768949287125, 'loss_val': 2.9511611571671863, 'psi': 0.22677768949287125}
[S6] START round=22 head_norm_before_train=1.713000 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.135655843889143, 'psi': 0.01732902033271719}-{'f1_val': 0.03140421713772992, 'auprc': 0.03140421713772992, 'loss_val': 5.528406091765994, 'psi': 0.03140421713772992}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=22 head_norm_before_train=1.506945 (no previous merge yet)
[S7] round=22 local utility u=0.006476 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1746798922419115, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1876313263046698, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=22 head_norm_before_train=1.609809 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.001948 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9034716181541536, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9073677138309498, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.745872 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7982703311641877, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7619144898997137, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.159430 cos_to_last_merge=0.9348 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=22 local utility u=0.038623 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2756592464437295, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3529046193640553, 'psi': 0.0}
[S11] START round=22 head_norm_before_train=1.366969 cos_to_last_merge=0.9736 (last merge round=18)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.100675761930554, 'psi': 0.3317042898145993}-{'f1_val': 0.3317035312378735, 'auprc': 0.3317035312378735, 'loss_val': 2.048766720469754, 'psi': 0.3317035312378735}
[S13] START round=22 head_norm_before_train=1.652681 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3584278719126124, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2744239551846803, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.732423 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.4344820190041805, 'psi': 0.1351317597102535}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.348772977725517, 'psi': 0.13572854291417166}
[S15] START round=22 head_norm_before_train=1.698773 (no previous merge yet)
[S15] round=22 local utility u=0.031543 metrics={'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.6743240447456725, 'psi': 0.612395395031292}-{'f1_val': 0.6119075969112203, 'auprc': 0.6119075969112203, 'loss_val': 0.7330192759908195, 'psi': 0.6119075969112203}
[S16] START round=22 head_norm_before_train=1.057862 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.292825 metrics={'f1_val': 0.09032773780975219, 'auprc': 0.09032773780975219, 'loss_val': 2.7039603533354057, 'psi': 0.09032773780975219}-{'f1_val': 0.14436721691282942, 'auprc': 0.14436721691282942, 'loss_val': 3.7759660761971277, 'psi': 0.14436721691282942}
[S17] START round=22 head_norm_before_train=1.612658 cos_to_last_merge=0.9698 (last merge round=14)
[S17] round=22 local utility u=0.018650 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 0.9640275165565478, 'psi': 0.152287708414114}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.0010625704735063, 'psi': 0.1522581895716224}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:31614
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:31616
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1795 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.090)
[S16] RECEIVED delta(kind=head bytes=1795) from S2
[S16] cosine check vs S2: cos=0.5414
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=-0.0291
[S14] DROPPED delta from S15 (cos=-0.0291 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:31603
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.0903 head_norm=1.090678
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.477334e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.0683 head_norm=1.001271 delta_norm=0.547733
[S16] aggregate: ROLLBACK (f1_val pre=0.090 post=0.068 tol_abs=0.005 tol_rel=0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S5
[S13] cosine check vs S5: cos=-0.0647
[S13] DROPPED delta from S5 (cos=-0.0647 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:31609
[S10] not sending this round → trigger blocked (psi=0.000)
[S8] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] cosine check vs S8: cos=0.9873
[S17] sending update (kind=head size=1808 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1808) from S17
[S8] cosine check vs S17: cos=0.9975
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.3594 head_norm=1.635139
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.829653e-02
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.3594 head_norm=1.633215 delta_norm=0.058297
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.189761 cos_to_last_merge=0.9963 (last merge round=21)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.24747684225079494, 'auprc': 0.24747684225079494, 'loss_val': 1.8158546824472783, 'psi': 0.24747684225079494}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.6438458890283822, 'psi': 0.2653978324081417}
[S3] START round=23 head_norm_before_train=1.499206 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.26192800885243767, 'auprc': 0.26192800885243767, 'loss_val': 1.5083551460224671, 'psi': 0.26192800885243767}-{'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 1.4328565257684072, 'psi': 0.2587947777992154}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.2619 head_norm=1.518987
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.912950e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.2620 head_norm=1.566495 delta_norm=0.191295
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=23 head_norm_before_train=1.792487 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2702271053253178, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.260344559905485, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.469023 cos_to_last_merge=0.9672 (last merge round=15)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 3.090213729953114, 'psi': 0.33409214683912186}-{'f1_val': 0.33384309419441793, 'auprc': 0.33384309419441793, 'loss_val': 3.032165809297641, 'psi': 0.33384309419441793}
[S6] START round=23 head_norm_before_train=1.721568 (no previous merge yet)
[S6] round=23 local utility u=0.054289 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 6.056982354194094, 'psi': 0.02065167508031207}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.135655843889143, 'psi': 0.01732902033271719}
[S6] not sending this round → trigger blocked (psi=0.021)
[S7] START round=23 head_norm_before_train=1.523275 (no previous merge yet)
[S7] round=23 local utility u=0.004104 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.166472055316979, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1746798922419115, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=23 head_norm_before_train=1.633215 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.001602 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9002678285443061, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9034716181541536, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.757656 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.82997614678457, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7982703311641877, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.180834 cos_to_last_merge=0.9270 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=23 local utility u=0.533994 metrics={'f1_val': 0.14697941275734053, 'auprc': 0.14697941275734053, 'loss_val': 3.53048678082941, 'psi': 0.14697941275734053}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2756592464437295, 'psi': 0.0}
[S11] START round=23 head_norm_before_train=1.406511 cos_to_last_merge=0.9640 (last merge round=18)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.32845681925436526, 'auprc': 0.32845681925436526, 'loss_val': 2.3793314512550094, 'psi': 0.32845681925436526}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.100675761930554, 'psi': 0.3317042898145993}
[S13] START round=23 head_norm_before_train=1.671292 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4140980800200056, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3584278719126124, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.751544 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.509509057522545, 'psi': 0.13572854291417166}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.4344820190041805, 'psi': 0.1351317597102535}
[S15] START round=23 head_norm_before_train=1.724430 (no previous merge yet)
[S15] round=23 local utility u=0.045125 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6107296570651376, 'psi': 0.6153571007984797}-{'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.6743240447456725, 'psi': 0.612395395031292}
[S16] START round=23 head_norm_before_train=1.001271 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.0012959363139868555, 'auprc': 0.0012959363139868555, 'loss_val': 2.4125974913168475, 'psi': 0.0012959363139868555}-{'f1_val': 0.09032773780975219, 'auprc': 0.09032773780975219, 'loss_val': 2.7039603533354057, 'psi': 0.09032773780975219}
[S17] START round=23 head_norm_before_train=1.633371 cos_to_last_merge=0.9663 (last merge round=14)
[S17] round=23 local utility u=0.045593 metrics={'f1_val': 0.1573032096447338, 'auprc': 0.1573032096447338, 'loss_val': 0.9179813816225048, 'psi': 0.1573032096447338}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 0.9640275165565478, 'psi': 0.152287708414114}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:31614
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0277
[S14] DROPPED delta from S15 (cos=-0.0277 < 0.0)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:31603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:31609
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9979
[S3] RECEIVED delta(kind=head bytes=1804) from S8
[S3] cosine check vs S8: cos=0.9922
[S10] not sending this round → trigger blocked (psi=0.147)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.3594 head_norm=1.656048
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.348455e-02
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.3594 head_norm=1.653818 delta_norm=0.053485
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.254724 cos_to_last_merge=0.9848 (last merge round=21)
[S2] round=24 local utility u=0.041959 metrics={'f1_val': 0.2653708845696152, 'auprc': 0.2653708845696152, 'loss_val': 1.8929827610152221, 'psi': 0.2653708845696152}-{'f1_val': 0.24747684225079494, 'auprc': 0.24747684225079494, 'loss_val': 1.8158546824472783, 'psi': 0.24747684225079494}
[S3] START round=24 head_norm_before_train=1.566495 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.053107 metrics={'f1_val': 0.2812126327635929, 'auprc': 0.2812126327635929, 'loss_val': 1.5757022123614879, 'psi': 0.2812126327635929}-{'f1_val': 0.26192800885243767, 'auprc': 0.26192800885243767, 'loss_val': 1.5083551460224671, 'psi': 0.26192800885243767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.2812 head_norm=1.587321
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.682249e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.2812 head_norm=1.613302 delta_norm=0.168225
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=24 head_norm_before_train=1.814981 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2820454719657846, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2702271053253178, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.489685 cos_to_last_merge=0.9637 (last merge round=15)
[S5] round=24 local utility u=0.021335 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.0468023803198725, 'psi': 0.33400978131092857}-{'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 3.090213729953114, 'psi': 0.33409214683912186}
[S6] START round=24 head_norm_before_train=1.729873 (no previous merge yet)
[S6] round=24 local utility u=0.064655 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.935577640763537, 'psi': 0.02153000458085204}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 6.056982354194094, 'psi': 0.02065167508031207}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=24 head_norm_before_train=1.540730 (no previous merge yet)
[S7] round=24 local utility u=0.002066 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1623395734150543, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.166472055316979, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=24 head_norm_before_train=1.653818 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9007120439671722, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9002678285443061, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.768577 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.858249795148731, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.82997614678457, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.204395 cos_to_last_merge=0.9193 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=24 local utility u=0.261455 metrics={'f1_val': 0.18061068702290076, 'auprc': 0.18061068702290076, 'loss_val': 3.310258893703523, 'psi': 0.18061068702290076}-{'f1_val': 0.14697941275734053, 'auprc': 0.14697941275734053, 'loss_val': 3.53048678082941, 'psi': 0.14697941275734053}
[S11] START round=24 head_norm_before_train=1.434004 cos_to_last_merge=0.9576 (last merge round=18)
[S11] round=24 local utility u=0.089978 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 2.2279084103672044, 'psi': 0.33162711338607104}-{'f1_val': 0.32845681925436526, 'auprc': 0.32845681925436526, 'loss_val': 2.3793314512550094, 'psi': 0.32845681925436526}
[S13] START round=24 head_norm_before_train=1.688154 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4375785467927003, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4140980800200056, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.769190 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.585991661078667, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.509509057522545, 'psi': 0.13572854291417166}
[S15] START round=24 head_norm_before_train=1.752725 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.6187125504654664, 'psi': 0.613387689325667}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6107296570651376, 'psi': 0.6153571007984797}
[S16] START round=24 head_norm_before_train=1.033288 cos_to_last_merge=0.9954 (last merge round=22)
[S16] round=24 local utility u=0.599421 metrics={'f1_val': 0.12202097235462345, 'auprc': 0.12202097235462345, 'loss_val': 2.300280603420723, 'psi': 0.12202097235462345}-{'f1_val': 0.0012959363139868555, 'auprc': 0.0012959363139868555, 'loss_val': 2.4125974913168475, 'psi': 0.0012959363139868555}
[S17] START round=24 head_norm_before_train=1.653317 cos_to_last_merge=0.9630 (last merge round=14)
[S17] round=24 local utility u=0.360365 metrics={'f1_val': 0.2333393096490883, 'auprc': 0.2333393096490883, 'loss_val': 0.881576858317537, 'psi': 0.23333930964908833}-{'f1_val': 0.1573032096447338, 'auprc': 0.1573032096447338, 'loss_val': 0.9179813816225048, 'psi': 0.1573032096447338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:31616
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:31602
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.122)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1804) from S2
[S16] cosine check vs S2: cos=0.8093
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] cosine check vs S11: cos=0.8218
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:31613
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.2654 head_norm=1.320662
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.203321e-01
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.2654 head_norm=1.327112 delta_norm=0.420332
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] not sending this round → trigger blocked (psi=0.181)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:31609
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.1220 head_norm=1.086356
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.879442e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.1500 head_norm=1.145277 delta_norm=0.387944
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] RECEIVED delta(kind=head bytes=1800) from S5
[S13] cosine check vs S5: cos=-0.0604
[S13] DROPPED delta from S5 (cos=-0.0604 < 0.0)
[S17] sending update (kind=head size=1807 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1807) from S17
[S8] cosine check vs S17: cos=0.9982
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.3594 head_norm=1.673727
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.000857e-02
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.3594 head_norm=1.670660 delta_norm=0.050009
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.327112 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.121597 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.650030968930248, 'psi': 0.2653978324081417}-{'f1_val': 0.2653708845696152, 'auprc': 0.2653708845696152, 'loss_val': 1.8929827610152221, 'psi': 0.2653708845696152}
[S3] START round=25 head_norm_before_train=1.613302 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.2903397027600849, 'auprc': 0.2903397027600849, 'loss_val': 1.6639241570273495, 'psi': 0.2903397027600849}-{'f1_val': 0.2812126327635929, 'auprc': 0.2812126327635929, 'loss_val': 1.5757022123614879, 'psi': 0.2812126327635929}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.835725 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2970903028648029, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2820454719657846, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.506592 cos_to_last_merge=0.9607 (last merge round=15)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 3.141903162537465, 'psi': 0.33358943696313936}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.0468023803198725, 'psi': 0.33400978131092857}
[S6] START round=25 head_norm_before_train=1.738462 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.294192000386763, 'psi': 0.01732902033271719}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.935577640763537, 'psi': 0.02153000458085204}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=1.561573 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.186918187187501, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1623395734150543, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=25 head_norm_before_train=1.670660 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9014647987880539, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9007120439671722, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.778836 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.884031818682803, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.858249795148731, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.226138 cos_to_last_merge=0.9119 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=25 local utility u=0.206991 metrics={'f1_val': 0.2097669256381798, 'auprc': 0.2097669256381798, 'loss_val': 3.158682642022766, 'psi': 0.2097669256381798}-{'f1_val': 0.18061068702290076, 'auprc': 0.18061068702290076, 'loss_val': 3.310258893703523, 'psi': 0.18061068702290076}
[S11] START round=25 head_norm_before_train=1.460022 cos_to_last_merge=0.9525 (last merge round=18)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.33162631905648665, 'auprc': 0.33162631905648665, 'loss_val': 2.3198541624217417, 'psi': 0.33162631905648665}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 2.2279084103672044, 'psi': 0.33162711338607104}
[S13] START round=25 head_norm_before_train=1.701722 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4614527825428398, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4375785467927003, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.785205 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.6612796923399555, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.585991661078667, 'psi': 0.13592717296421}
[S15] START round=25 head_norm_before_train=1.781407 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6105389725618956, 'auprc': 0.6105389725618956, 'loss_val': 0.6357251141305824, 'psi': 0.6105389725618956}-{'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.6187125504654664, 'psi': 0.613387689325667}
[S16] START round=25 head_norm_before_train=1.145277 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.05056320400500626, 'auprc': 0.05056320400500626, 'loss_val': 2.348818591144361, 'psi': 0.05056320400500626}-{'f1_val': 0.12202097235462345, 'auprc': 0.12202097235462345, 'loss_val': 2.300280603420723, 'psi': 0.12202097235462345}
[S17] START round=25 head_norm_before_train=1.669086 cos_to_last_merge=0.9604 (last merge round=14)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.1550653551643477, 'auprc': 0.1550653551643477, 'loss_val': 0.9005550138661504, 'psi': 0.1550653551643477}-{'f1_val': 0.2333393096490883, 'auprc': 0.2333393096490883, 'loss_val': 0.881576858317537, 'psi': 0.23333930964908833}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:31616
[S9] ⇄ pheromone p=0.028 → S4@127.0.0.1:31604
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] ⇄ pheromone p=0.052 → S11@127.0.0.1:31612
[S11] ⇄ pheromone p=0.113 → S2@127.0.0.1:31602
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.017 → S5@127.0.0.1:31605
[S15] ⇄ pheromone p=0.123 → S14@127.0.0.1:31614
[S16] RECEIVED delta(kind=head bytes=1798) from S2
[S16] cosine check vs S2: cos=0.8975
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.148 → S16@127.0.0.1:31616
[S4] ⇄ pheromone p=0.027 → S6@127.0.0.1:31607
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.0506 head_norm=1.185892
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.051621e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.1055 head_norm=1.249177 delta_norm=0.305162
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.197 → S10@127.0.0.1:31611
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:31605
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=0.6466
[S17] ⇄ pheromone p=0.091 → S8@127.0.0.1:31609
[S10] ⇄ pheromone p=0.181 → S5@127.0.0.1:31605
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.3336 head_norm=1.517633
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.941161e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.3336 head_norm=1.256329 delta_norm=0.594116
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.147 → S13@127.0.0.1:31613
[S8] ⇄ pheromone p=0.094 → S3@127.0.0.1:31603
[S2] START round=26 head_norm_before_train=1.378694 cos_to_last_merge=0.9973 (last merge round=24)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.7870722535399353, 'psi': 0.2653978324081417}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.650030968930248, 'psi': 0.2653978324081417}
[S3] START round=26 head_norm_before_train=1.635569 cos_to_last_merge=0.9966 (last merge round=24)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.2894084307474318, 'auprc': 0.2894084307474318, 'loss_val': 1.7694404135953552, 'psi': 0.2894084307474318}-{'f1_val': 0.2903397027600849, 'auprc': 0.2903397027600849, 'loss_val': 1.6639241570273495, 'psi': 0.2903397027600849}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.855693 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3095595584318727, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2970903028648029, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.256329 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.202039 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.7416089057834117, 'psi': 0.33400978131092857}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 3.141903162537465, 'psi': 0.33358943696313936}
[S6] START round=26 head_norm_before_train=1.748664 (no previous merge yet)
[S6] round=26 local utility u=0.025675 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.24685277406435, 'psi': 0.017774699907663897}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.294192000386763, 'psi': 0.01732902033271719}
[S6] not sending this round → trigger blocked (psi=0.018)
[S7] START round=26 head_norm_before_train=1.582206 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.214458845384921, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.186918187187501, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.691564 cos_to_last_merge=0.9998 (last merge round=24)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9093230759588329, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9014647987880539, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.788327 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9076182291786834, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.884031818682803, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.248785 cos_to_last_merge=0.9048 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.905
[S10] round=26 local utility u=0.097435 metrics={'f1_val': 0.2237919197253763, 'auprc': 0.2237919197253763, 'loss_val': 3.0900385463832984, 'psi': 0.22379191972537626}-{'f1_val': 0.2097669256381798, 'auprc': 0.2097669256381798, 'loss_val': 3.158682642022766, 'psi': 0.2097669256381798}
[S11] START round=26 head_norm_before_train=1.485223 cos_to_last_merge=0.9482 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.33162631905648665, 'auprc': 0.33162631905648665, 'loss_val': 2.3300214674548503, 'psi': 0.33162631905648665}-{'f1_val': 0.33162631905648665, 'auprc': 0.33162631905648665, 'loss_val': 2.3198541624217417, 'psi': 0.33162631905648665}
[S13] START round=26 head_norm_before_train=1.712703 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4861945406826942, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4614527825428398, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.799899 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.732362591412753, 'psi': 0.13582554517133957}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.6612796923399555, 'psi': 0.13592717296421}
[S15] START round=26 head_norm_before_train=1.813866 (no previous merge yet)
[S15] round=26 local utility u=0.023942 metrics={'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.6160225876903067, 'psi': 0.6136702686915539}-{'f1_val': 0.6105389725618956, 'auprc': 0.6105389725618956, 'loss_val': 0.6357251141305824, 'psi': 0.6105389725618956}
[S16] START round=26 head_norm_before_train=1.249177 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.0009264406151565685, 'auprc': 0.0009264406151565685, 'loss_val': 2.4670046209776255, 'psi': 0.0009264406151565684}-{'f1_val': 0.05056320400500626, 'auprc': 0.05056320400500626, 'loss_val': 2.348818591144361, 'psi': 0.05056320400500626}
[S17] START round=26 head_norm_before_train=1.683495 cos_to_last_merge=0.9582 (last merge round=14)
[S17] round=26 local utility u=0.144832 metrics={'f1_val': 0.1867358622062923, 'auprc': 0.1867358622062923, 'loss_val': 0.8959252829377172, 'psi': 0.1867358622062923}-{'f1_val': 0.1550653551643477, 'auprc': 0.1550653551643477, 'loss_val': 0.9005550138661504, 'psi': 0.1550653551643477}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:31614
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1805 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S15
[S14] cosine check vs S15: cos=-0.0239
[S14] DROPPED delta from S15 (cos=-0.0239 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S13@127.0.0.1:31613
[S5] sending update (kind=head size=1807 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1807) from S5
[S13] cosine check vs S5: cos=-0.0261
[S13] DROPPED delta from S5 (cos=-0.0261 < 0.0)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:31615
[S17] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S10
[S15] cosine check vs S10: cos=0.4982
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] cosine check vs S17: cos=0.9969
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.3594 head_norm=1.715858
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.832802e-02
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.3594 head_norm=1.705367 delta_norm=0.068328
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.435328 cos_to_last_merge=0.9907 (last merge round=24)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 1.9427414486513361, 'psi': 0.26531826293872696}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.7870722535399353, 'psi': 0.2653978324081417}
[S3] START round=27 head_norm_before_train=1.670002 cos_to_last_merge=0.9886 (last merge round=24)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.2616214810480463, 'auprc': 0.2616214810480463, 'loss_val': 1.6449473423125056, 'psi': 0.2616214810480463}-{'f1_val': 0.2894084307474318, 'auprc': 0.2894084307474318, 'loss_val': 1.7694404135953552, 'psi': 0.2894084307474318}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.869889 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3246733070833931, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3095595584318727, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.262959 cos_to_last_merge=0.9999 (last merge round=25)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.8953447989094094, 'psi': 0.2501920777223545}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.7416089057834117, 'psi': 0.33400978131092857}
[S6] START round=27 head_norm_before_train=1.759643 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.385698467079247, 'psi': 0.017551963048498844}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.24685277406435, 'psi': 0.017774699907663897}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=1.602729 (no previous merge yet)
[S7] round=27 local utility u=0.014780 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1848979153001449, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.214458845384921, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=27 head_norm_before_train=1.705367 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9117574360631008, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9093230759588329, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.797461 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.929466389497657, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9076182291786834, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.271796 cos_to_last_merge=0.8988 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.899
[S10] round=27 local utility u=0.153593 metrics={'f1_val': 0.24964097654380085, 'auprc': 0.24964097654380085, 'loss_val': 3.015493380818471, 'psi': 0.24964097654380085}-{'f1_val': 0.2237919197253763, 'auprc': 0.2237919197253763, 'loss_val': 3.0900385463832984, 'psi': 0.22379191972537626}
[S11] START round=27 head_norm_before_train=1.512016 cos_to_last_merge=0.9438 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.429606860633037, 'psi': 0.33201273984308244}-{'f1_val': 0.33162631905648665, 'auprc': 0.33162631905648665, 'loss_val': 2.3300214674548503, 'psi': 0.33162631905648665}
[S13] START round=27 head_norm_before_train=1.725049 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5209169765906094, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4861945406826942, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.812458 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.812693284255353, 'psi': 0.1331327566754419}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.732362591412753, 'psi': 0.13582554517133957}
[S15] START round=27 head_norm_before_train=1.843675 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6095319696156781, 'auprc': 0.6095319696156781, 'loss_val': 0.6186968198441537, 'psi': 0.6095319696156781}-{'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.6160225876903067, 'psi': 0.6136702686915539}
[S16] START round=27 head_norm_before_train=1.284825 cos_to_last_merge=0.9947 (last merge round=25)
[S16] round=27 local utility u=0.659325 metrics={'f1_val': 0.1356007067137809, 'auprc': 0.1356007067137809, 'loss_val': 2.360423044992777, 'psi': 0.1356007067137809}-{'f1_val': 0.0009264406151565685, 'auprc': 0.0009264406151565685, 'loss_val': 2.4670046209776255, 'psi': 0.0009264406151565684}
[S17] START round=27 head_norm_before_train=1.697564 cos_to_last_merge=0.9561 (last merge round=14)
[S17] round=27 local utility u=0.223215 metrics={'f1_val': 0.2356549060805353, 'auprc': 0.2356549060805353, 'loss_val': 0.8897671427074958, 'psi': 0.2356549060805353}-{'f1_val': 0.1867358622062923, 'auprc': 0.1867358622062923, 'loss_val': 0.8959252829377172, 'psi': 0.1867358622062923}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.136)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.6095 head_norm=1.871521
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.304108e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.6105 head_norm=1.367642 delta_norm=0.830411
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:31615
[S10] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:31609
[S15] RECEIVED delta(kind=head bytes=1803) from S10
[S15] cosine check vs S10: cos=0.8026
[S17] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] cosine check vs S17: cos=0.9980
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.3594 head_norm=1.728747
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.578549e-02
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.3594 head_norm=1.717954 delta_norm=0.055785
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.485327 cos_to_last_merge=0.9835 (last merge round=24)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.066571488695567, 'psi': 0.26531826293872696}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 1.9427414486513361, 'psi': 0.26531826293872696}
[S3] START round=28 head_norm_before_train=1.709973 cos_to_last_merge=0.9797 (last merge round=24)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.2501087699670583, 'auprc': 0.2501087699670583, 'loss_val': 1.6038766692086552, 'psi': 0.2501087699670583}-{'f1_val': 0.2616214810480463, 'auprc': 0.2616214810480463, 'loss_val': 1.6449473423125056, 'psi': 0.2616214810480463}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.884126 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3427734450763933, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3246733070833931, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.268971 cos_to_last_merge=0.9997 (last merge round=25)
[S5] round=28 local utility u=0.014831 metrics={'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.865681954099684, 'psi': 0.2501920777223545}-{'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.8953447989094094, 'psi': 0.2501920777223545}
[S6] START round=28 head_norm_before_train=1.771257 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.447440507683737, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.385698467079247, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.623962 (no previous merge yet)
[S7] round=28 local utility u=0.007097 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1707034291360543, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1848979153001449, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=28 head_norm_before_train=1.717954 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9168965736293303, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9117574360631008, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.806138 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.952258289425693, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.929466389497657, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.294474 cos_to_last_merge=0.8935 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.893
[S10] round=28 local utility u=0.023944 metrics={'f1_val': 0.24976076555023924, 'auprc': 0.24976076555023924, 'loss_val': 2.9686836771477703, 'psi': 0.24976076555023924}-{'f1_val': 0.24964097654380085, 'auprc': 0.24964097654380085, 'loss_val': 3.015493380818471, 'psi': 0.24964097654380085}
[S11] START round=28 head_norm_before_train=1.534781 cos_to_last_merge=0.9403 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=28 local utility u=0.030223 metrics={'f1_val': 0.33162631905648665, 'auprc': 0.33162631905648665, 'loss_val': 2.3656821004809605, 'psi': 0.33162631905648665}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.429606860633037, 'psi': 0.33201273984308244}
[S13] START round=28 head_norm_before_train=1.736980 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5284070852033174, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5209169765906094, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.824804 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.866011554397173, 'psi': 0.13572854291417166}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.812693284255353, 'psi': 0.1331327566754419}
[S15] START round=28 head_norm_before_train=1.367642 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.041467 metrics={'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.5844051447353525, 'psi': 0.6149367764291455}-{'f1_val': 0.6095319696156781, 'auprc': 0.6095319696156781, 'loss_val': 0.6186968198441537, 'psi': 0.6095319696156781}
[S16] START round=28 head_norm_before_train=1.333388 cos_to_last_merge=0.9826 (last merge round=25)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.1347784413477844, 'auprc': 0.1347784413477844, 'loss_val': 2.6414777465508554, 'psi': 0.1347784413477844}-{'f1_val': 0.1356007067137809, 'auprc': 0.1356007067137809, 'loss_val': 2.360423044992777, 'psi': 0.1356007067137809}
[S17] START round=28 head_norm_before_train=1.708915 cos_to_last_merge=0.9545 (last merge round=14)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.20476784754848976, 'auprc': 0.20476784754848976, 'loss_val': 0.931347068413031, 'psi': 0.20476784754848976}-{'f1_val': 0.2356549060805353, 'auprc': 0.2356549060805353, 'loss_val': 0.8897671427074958, 'psi': 0.2356549060805353}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:31614
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=-0.0287
[S14] DROPPED delta from S15 (cos=-0.0287 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.6149 head_norm=1.404711
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.374964e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.6152 head_norm=1.277903 delta_norm=0.437496
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:31613
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:31615
[S5] sending update (kind=head size=1806 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1806) from S5
[S13] cosine check vs S5: cos=-0.0268
[S13] DROPPED delta from S5 (cos=-0.0268 < 0.0)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S10
[S15] cosine check vs S10: cos=0.9409
[S2] START round=29 head_norm_before_train=1.527617 cos_to_last_merge=0.9771 (last merge round=24)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.1621256643601834, 'psi': 0.26531826293872696}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.066571488695567, 'psi': 0.26531826293872696}
[S3] START round=29 head_norm_before_train=1.744717 cos_to_last_merge=0.9723 (last merge round=24)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.2499223650704925, 'auprc': 0.2499223650704925, 'loss_val': 1.6819026902606542, 'psi': 0.2499223650704925}-{'f1_val': 0.2501087699670583, 'auprc': 0.2501087699670583, 'loss_val': 1.6038766692086552, 'psi': 0.2501087699670583}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.898210 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3615593571245865, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3427734450763933, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.274715 cos_to_last_merge=0.9995 (last merge round=25)
[S5] round=29 local utility u=0.399102 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.82183777442176, 'psi': 0.33400978131092857}-{'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.865681954099684, 'psi': 0.2501920777223545}
[S6] START round=29 head_norm_before_train=1.782459 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.520536957212053, 'psi': 0.017774699907663897}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.447440507683737, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=1.641441 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1793495214320986, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1707034291360543, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=1.739815 cos_to_last_merge=0.9998 (last merge round=27)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9414976846677028, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9168965736293303, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.814477 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9746843458495564, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.952258289425693, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.317860 cos_to_last_merge=0.8876 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.888
[S10] round=29 local utility u=0.403039 metrics={'f1_val': 0.33317391997449386, 'auprc': 0.33317391997449386, 'loss_val': 2.9133242594755977, 'psi': 0.33317391997449386}-{'f1_val': 0.24976076555023924, 'auprc': 0.24976076555023924, 'loss_val': 2.9686836771477703, 'psi': 0.24976076555023924}
[S11] START round=29 head_norm_before_train=1.555897 cos_to_last_merge=0.9370 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.4452346685885695, 'psi': 0.3319353836595216}-{'f1_val': 0.33162631905648665, 'auprc': 0.33162631905648665, 'loss_val': 2.3656821004809605, 'psi': 0.33162631905648665}
[S13] START round=29 head_norm_before_train=1.746822 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5441514079682725, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5284070852033174, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.835778 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.934576403119273, 'psi': 0.13333333333333333}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.866011554397173, 'psi': 0.13572854291417166}
[S15] START round=29 head_norm_before_train=1.277903 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6241505900627566, 'psi': 0.6152170947577895}-{'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.5844051447353525, 'psi': 0.6149367764291455}
[S16] START round=29 head_norm_before_train=1.386422 cos_to_last_merge=0.9687 (last merge round=25)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.1444806369887803, 'auprc': 0.1444806369887803, 'loss_val': 2.729122308078091, 'psi': 0.1444806369887803}-{'f1_val': 0.1347784413477844, 'auprc': 0.1347784413477844, 'loss_val': 2.6414777465508554, 'psi': 0.1347784413477844}
[S17] START round=29 head_norm_before_train=1.722723 cos_to_last_merge=0.9524 (last merge round=14)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.19559426700514354, 'auprc': 0.19559426700514354, 'loss_val': 0.9239451763617116, 'psi': 0.19559426700514354}-{'f1_val': 0.20476784754848976, 'auprc': 0.20476784754848976, 'loss_val': 0.931347068413031, 'psi': 0.20476784754848976}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.6152 head_norm=1.320751
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.502382e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.6152 head_norm=1.295357 delta_norm=0.250238
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S13@127.0.0.1:31613
[S5] sending update (kind=head size=1807 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1807) from S5
[S13] cosine check vs S5: cos=-0.0266
[S13] DROPPED delta from S5 (cos=-0.0266 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:31615
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S10
[S15] cosine check vs S10: cos=0.9807
[S2] START round=30 head_norm_before_train=1.562317 cos_to_last_merge=0.9719 (last merge round=24)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.241614964623085, 'psi': 0.26531826293872696}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.1621256643601834, 'psi': 0.26531826293872696}
[S3] START round=30 head_norm_before_train=1.771717 cos_to_last_merge=0.9669 (last merge round=24)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.254040404040404, 'auprc': 0.254040404040404, 'loss_val': 1.7666603804746905, 'psi': 0.254040404040404}-{'f1_val': 0.2499223650704925, 'auprc': 0.2499223650704925, 'loss_val': 1.6819026902606542, 'psi': 0.2499223650704925}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.910329 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3822637421082093, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3615593571245865, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.286462 cos_to_last_merge=0.9989 (last merge round=25)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.936089697677681, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.82183777442176, 'psi': 0.33400978131092857}
[S6] START round=30 head_norm_before_train=1.793827 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.630036166134408, 'psi': 0.017551963048498844}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.520536957212053, 'psi': 0.017774699907663897}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.656078 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.199487204273336, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1793495214320986, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.761049 cos_to_last_merge=0.9992 (last merge round=27)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9794950882220966, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9414976846677028, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.822410 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.995226039294828, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9746843458495564, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.341703 cos_to_last_merge=0.8814 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.881
[S10] round=30 local utility u=0.038497 metrics={'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 2.8377648538079843, 'psi': 0.3333333333333333}-{'f1_val': 0.33317391997449386, 'auprc': 0.33317391997449386, 'loss_val': 2.9133242594755977, 'psi': 0.33317391997449386}
[S11] START round=30 head_norm_before_train=1.570445 cos_to_last_merge=0.9348 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=30 local utility u=0.008936 metrics={'f1_val': 0.3317035312378735, 'auprc': 0.3317035312378735, 'loss_val': 2.4252768423957196, 'psi': 0.3317035312378735}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.4452346685885695, 'psi': 0.3319353836595216}
[S13] START round=30 head_norm_before_train=1.755749 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5635469940839257, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5441514079682725, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.845971 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.10703484549638397, 'auprc': 0.10703484549638397, 'loss_val': 6.077512227440037, 'psi': 0.10703484549638397}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.934576403119273, 'psi': 0.13333333333333333}
[S15] START round=30 head_norm_before_train=1.295357 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6102517882741235, 'auprc': 0.6102517882741235, 'loss_val': 0.6875244051379807, 'psi': 0.6102517882741235}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6241505900627566, 'psi': 0.6152170947577895}
[S16] START round=30 head_norm_before_train=1.434735 cos_to_last_merge=0.9571 (last merge round=25)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.1454992053171507, 'auprc': 0.1454992053171507, 'loss_val': 2.918123634771428, 'psi': 0.1454992053171507}-{'f1_val': 0.1444806369887803, 'auprc': 0.1444806369887803, 'loss_val': 2.729122308078091, 'psi': 0.1444806369887803}
[S17] START round=30 head_norm_before_train=1.737349 cos_to_last_merge=0.9505 (last merge round=14)
[S17] round=30 local utility u=0.251286 metrics={'f1_val': 0.2539602303618435, 'auprc': 0.2539602303618435, 'loss_val': 0.9466660415141244, 'psi': 0.2539602303618435}-{'f1_val': 0.19559426700514354, 'auprc': 0.19559426700514354, 'loss_val': 0.9239451763617116, 'psi': 0.19559426700514354}
[S10]  timeout peer S5
[S5]  timeout peer S4
[S8]  timeout peer S3
[S2]  timeout peer S16
[S11]  timeout peer S2
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.6103 head_norm=1.357944
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.782042e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.6105 head_norm=1.338033 delta_norm=0.178204
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.048 → S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:31615
[S14] ⇄ pheromone p=0.006 → S5@127.0.0.1:31605
[S9] ⇄ pheromone p=0.009 → S4@127.0.0.1:31604
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.017 → S11@127.0.0.1:31612
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1794 to 1 peers)
[S8] ⇄ pheromone p=0.031 → S16@127.0.0.1:31616
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1794) from S10
[S15] cosine check vs S10: cos=0.9900
[S10] ⇄ pheromone p=0.158 → S15@127.0.0.1:31615
[S4] ⇄ pheromone p=0.009 → S6@127.0.0.1:31607
[S16] ⇄ pheromone p=0.132 → S10@127.0.0.1:31611
[S5] ⇄ pheromone p=0.130 → S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:31609
[S17] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] cosine check vs S17: cos=0.9952
[S17] ⇄ pheromone p=0.115 → S8@127.0.0.1:31609
[S2] START round=31 head_norm_before_train=1.590642 cos_to_last_merge=0.9677 (last merge round=24)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.1958041958041958, 'auprc': 0.1958041958041958, 'loss_val': 2.831421508348639, 'psi': 0.1958041958041958}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.241614964623085, 'psi': 0.26531826293872696}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.794769 cos_to_last_merge=0.9627 (last merge round=24)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.2583461736004109, 'auprc': 0.2583461736004109, 'loss_val': 1.876140618243756, 'psi': 0.2583461736004109}-{'f1_val': 0.254040404040404, 'auprc': 0.254040404040404, 'loss_val': 1.7666603804746905, 'psi': 0.254040404040404}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.920468 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4037465647781335, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3822637421082093, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.300527 cos_to_last_merge=0.9980 (last merge round=25)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.959157331750886, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.936089697677681, 'psi': 0.33400978131092857}
[S6] START round=31 head_norm_before_train=1.804468 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.764666378209909, 'psi': 0.017105871474803514}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.630036166134408, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.666420 (no previous merge yet)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2275716244380772, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.199487204273336, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.782636 cos_to_last_merge=0.9983 (last merge round=27)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0243977324629525, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9794950882220966, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.830051 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0172312737520097, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.995226039294828, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.369523 cos_to_last_merge=0.8753 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.875
[S10] round=31 local utility u=0.024628 metrics={'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 2.788508711997381, 'psi': 0.3333333333333333}-{'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 2.8377648538079843, 'psi': 0.3333333333333333}
[S11] START round=31 head_norm_before_train=1.581752 cos_to_last_merge=0.9330 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.481342676827925, 'psi': 0.3319353836595216}-{'f1_val': 0.3317035312378735, 'auprc': 0.3317035312378735, 'loss_val': 2.4252768423957196, 'psi': 0.3317035312378735}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.764212 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5774552631918097, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5635469940839257, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.855901 (no previous merge yet)
[S14] round=31 local utility u=0.147056 metrics={'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 6.032684538094611, 'psi': 0.1347331583552056}-{'f1_val': 0.10703484549638397, 'auprc': 0.10703484549638397, 'loss_val': 6.077512227440037, 'psi': 0.10703484549638397}
[S15] START round=31 head_norm_before_train=1.338033 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.031195 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6698218630297795, 'psi': 0.6152170947577895}-{'f1_val': 0.6102517882741235, 'auprc': 0.6102517882741235, 'loss_val': 0.6875244051379807, 'psi': 0.6102517882741235}
[S16] START round=31 head_norm_before_train=1.474422 cos_to_last_merge=0.9483 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.14048140043763677, 'auprc': 0.14048140043763677, 'loss_val': 3.1439827913859295, 'psi': 0.14048140043763677}-{'f1_val': 0.1454992053171507, 'auprc': 0.1454992053171507, 'loss_val': 2.918123634771428, 'psi': 0.1454992053171507}
[S17] START round=31 head_norm_before_train=1.749204 cos_to_last_merge=0.9488 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.949
[S17] round=31 local utility u=0.080030 metrics={'f1_val': 0.26873120596348893, 'auprc': 0.26873120596348893, 'loss_val': 0.9195451166442994, 'psi': 0.26873120596348893}-{'f1_val': 0.2539602303618435, 'auprc': 0.2539602303618435, 'loss_val': 0.9466660415141244, 'psi': 0.2539602303618435}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.135)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:31615
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:31614
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.3594 head_norm=1.802743
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.034136e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.3594 head_norm=1.773162 delta_norm=0.103414
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S10
[S15] cosine check vs S10: cos=0.9747
[S14] RECEIVED delta(kind=head bytes=1795) from S15
[S14] cosine check vs S15: cos=-0.0275
[S14] DROPPED delta from S15 (cos=-0.0275 < 0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.6152 head_norm=1.403231
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.544659e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.6152 head_norm=1.384069 delta_norm=0.154466
[S15] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] → sending delta(kind=head bytes=1809) to S8@127.0.0.1:31609
[S17] sending update (kind=head size=1809 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1809) from S17
[S8] cosine check vs S17: cos=0.9982
[S2] START round=32 head_norm_before_train=1.612900 cos_to_last_merge=0.9645 (last merge round=24)
[S2] round=32 local utility u=0.550506 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.3560352811361023, 'psi': 0.26531826293872696}-{'f1_val': 0.1958041958041958, 'auprc': 0.1958041958041958, 'loss_val': 2.831421508348639, 'psi': 0.1958041958041958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=32 head_norm_before_train=1.815914 cos_to_last_merge=0.9592 (last merge round=24)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.2583461736004109, 'auprc': 0.2583461736004109, 'loss_val': 1.9492618521856382, 'psi': 0.2583461736004109}-{'f1_val': 0.2583461736004109, 'auprc': 0.2583461736004109, 'loss_val': 1.876140618243756, 'psi': 0.2583461736004109}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.933840 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4224749443254041, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4037465647781335, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.323949 cos_to_last_merge=0.9960 (last merge round=25)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.062433861362766, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.959157331750886, 'psi': 0.33400978131092857}
[S6] START round=32 head_norm_before_train=1.813287 (no previous merge yet)
[S6] round=32 local utility u=0.255493 metrics={'f1_val': 0.026947463768115944, 'auprc': 0.026947463768115944, 'loss_val': 6.342254270322903, 'psi': 0.026947463768115944}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.764666378209909, 'psi': 0.017105871474803514}
[S6] not sending this round → trigger blocked (psi=0.027)
[S7] START round=32 head_norm_before_train=1.679308 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2341355998910826, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2275716244380772, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.773162 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.010545 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0033087168596067, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0243977324629525, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.837622 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.03498987770608, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0172312737520097, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=1.394686 cos_to_last_merge=0.8699 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.870
[S10] round=32 local utility u=0.016522 metrics={'f1_val': 0.3332536837913182, 'auprc': 0.3332536837913182, 'loss_val': 2.7547487891738007, 'psi': 0.3332536837913182}-{'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 2.788508711997381, 'psi': 0.3333333333333333}
[S11] START round=32 head_norm_before_train=1.595869 cos_to_last_merge=0.9308 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.931
[S11] round=32 local utility u=0.003379 metrics={'f1_val': 0.3317035312378735, 'auprc': 0.3317035312378735, 'loss_val': 2.47249771371516, 'psi': 0.3317035312378735}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.481342676827925, 'psi': 0.3319353836595216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=32 head_norm_before_train=1.772118 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5861603814935097, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5774552631918097, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.865196 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 6.083925661844146, 'psi': 0.1331327566754419}-{'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 6.032684538094611, 'psi': 0.1347331583552056}
[S15] START round=32 head_norm_before_train=1.384069 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.5990156212427494, 'auprc': 0.5990156212427494, 'loss_val': 0.7012190605651124, 'psi': 0.5990156212427494}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6698218630297795, 'psi': 0.6152170947577895}
[S16] START round=32 head_norm_before_train=1.506967 cos_to_last_merge=0.9414 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.941
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.09362581465585758, 'auprc': 0.09362581465585758, 'loss_val': 3.6159997255256773, 'psi': 0.09362581465585758}-{'f1_val': 0.14048140043763677, 'auprc': 0.14048140043763677, 'loss_val': 3.1439827913859295, 'psi': 0.14048140043763677}
[S17] START round=32 head_norm_before_train=1.762805 cos_to_last_merge=0.9472 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.947
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.2054211165658946, 'auprc': 0.2054211165658946, 'loss_val': 1.0303317455182228, 'psi': 0.2054211165658946}-{'f1_val': 0.26873120596348893, 'auprc': 0.26873120596348893, 'loss_val': 0.9195451166442994, 'psi': 0.26873120596348893}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:31616
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:31615
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1801) from S10
[S15] cosine check vs S10: cos=0.9809
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=-0.0291
[S16] DROPPED delta from S8 (cos=-0.0291 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.3594 head_norm=1.790717
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.888369e-02
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.3594 head_norm=1.775480 delta_norm=0.068884
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.630878 cos_to_last_merge=0.9618 (last merge round=24)
[S2] round=33 local utility u=0.008557 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.3398806949385693, 'psi': 0.26542475888492534}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.3560352811361023, 'psi': 0.26531826293872696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=33 head_norm_before_train=1.834897 cos_to_last_merge=0.9563 (last merge round=24)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.258595205963627, 'auprc': 0.258595205963627, 'loss_val': 2.023436839172303, 'psi': 0.258595205963627}-{'f1_val': 0.2583461736004109, 'auprc': 0.2583461736004109, 'loss_val': 1.9492618521856382, 'psi': 0.2583461736004109}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.944278 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4371993643523981, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4224749443254041, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.354235 cos_to_last_merge=0.9929 (last merge round=25)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.064691383634246, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.062433861362766, 'psi': 0.33400978131092857}
[S6] START round=33 head_norm_before_train=1.821100 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.917902434090922, 'psi': 0.017105871474803514}-{'f1_val': 0.026947463768115944, 'auprc': 0.026947463768115944, 'loss_val': 6.342254270322903, 'psi': 0.026947463768115944}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.689499 (no previous merge yet)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2437381108339203, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2341355998910826, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.775480 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0033196834560458, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0033087168596067, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.844670 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.053215019003026, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.03498987770608, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=1.417328 cos_to_last_merge=0.8652 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.865
[S10] round=33 local utility u=0.014274 metrics={'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.725484668773174, 'psi': 0.3331740723045071}-{'f1_val': 0.3332536837913182, 'auprc': 0.3332536837913182, 'loss_val': 2.7547487891738007, 'psi': 0.3332536837913182}
[S11] START round=33 head_norm_before_train=1.612535 cos_to_last_merge=0.9283 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.548798747481787, 'psi': 0.3319353836595216}-{'f1_val': 0.3317035312378735, 'auprc': 0.3317035312378735, 'loss_val': 2.47249771371516, 'psi': 0.3317035312378735}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.778567 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6005083549476122, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5861603814935097, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=1.874069 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.1005586592178771, 'auprc': 0.1005586592178771, 'loss_val': 6.282595288807587, 'psi': 0.1005586592178771}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 6.083925661844146, 'psi': 0.1331327566754419}
[S15] START round=33 head_norm_before_train=1.448710 cos_to_last_merge=0.9968 (last merge round=31)
[S15] round=33 local utility u=0.108371 metrics={'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.621445142691718, 'psi': 0.6142341889454641}-{'f1_val': 0.5990156212427494, 'auprc': 0.5990156212427494, 'loss_val': 0.7012190605651124, 'psi': 0.5990156212427494}
[S16] START round=33 head_norm_before_train=1.533340 cos_to_last_merge=0.9358 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.936
[S16] round=33 local utility u=0.296235 metrics={'f1_val': 0.13898032331212054, 'auprc': 0.13898032331212054, 'loss_val': 3.4317197508639268, 'psi': 0.13898032331212054}-{'f1_val': 0.09362581465585758, 'auprc': 0.09362581465585758, 'loss_val': 3.6159997255256773, 'psi': 0.09362581465585758}
[S17] START round=33 head_norm_before_train=1.777565 cos_to_last_merge=0.9456 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=33 local utility u=0.298457 metrics={'f1_val': 0.2628311653582412, 'auprc': 0.2628311653582412, 'loss_val': 0.9501086755320465, 'psi': 0.2628311653582412}-{'f1_val': 0.2054211165658946, 'auprc': 0.2054211165658946, 'loss_val': 1.0303317455182228, 'psi': 0.2054211165658946}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:31615
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.139)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0251
[S14] DROPPED delta from S15 (cos=-0.0251 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S10
[S15] cosine check vs S10: cos=0.9665
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.6142 head_norm=1.516562
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.938875e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.6140 head_norm=1.460502 delta_norm=0.193888
[S15] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:31609
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.9981
[S2] START round=34 head_norm_before_train=1.647015 cos_to_last_merge=0.9595 (last merge round=24)
[S2] round=34 local utility u=0.004037 metrics={'f1_val': 0.263544536271809, 'auprc': 0.263544536271809, 'loss_val': 2.3148851533034094, 'psi': 0.263544536271809}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.3398806949385693, 'psi': 0.26542475888492534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=34 head_norm_before_train=1.851407 cos_to_last_merge=0.9539 (last merge round=24)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.25789912196372494, 'auprc': 0.25789912196372494, 'loss_val': 2.0266051664372253, 'psi': 0.25789912196372494}-{'f1_val': 0.258595205963627, 'auprc': 0.258595205963627, 'loss_val': 2.023436839172303, 'psi': 0.258595205963627}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.954600 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.456003899725298, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4371993643523981, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=1.382462 cos_to_last_merge=0.9896 (last merge round=25)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.12196237282598, 'psi': 0.3335071121394324}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.064691383634246, 'psi': 0.33400978131092857}
[S6] START round=34 head_norm_before_train=1.828371 (no previous merge yet)
[S6] round=34 local utility u=0.086732 metrics={'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 6.778330164704176, 'psi': 0.020871559633027524}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.917902434090922, 'psi': 0.017105871474803514}
[S6] not sending this round → trigger blocked (psi=0.021)
[S7] START round=34 head_norm_before_train=1.699825 (no previous merge yet)
[S7] round=34 local utility u=0.003279 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2371798474790887, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2437381108339203, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=34 head_norm_before_train=1.792051 cos_to_last_merge=0.9998 (last merge round=32)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0484832241660151, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0033196834560458, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.851582 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0724505791911993, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.053215019003026, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=1.440355 cos_to_last_merge=0.8612 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.861
[S10] round=34 local utility u=0.008568 metrics={'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.7083481928086033, 'psi': 0.3331740723045071}-{'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.725484668773174, 'psi': 0.3331740723045071}
[S11] START round=34 head_norm_before_train=1.629144 cos_to_last_merge=0.9256 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.560399071862852, 'psi': 0.3319353836595216}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.548798747481787, 'psi': 0.3319353836595216}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.784031 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6098859067749702, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6005083549476122, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=1.882632 (no previous merge yet)
[S14] round=34 local utility u=0.032395 metrics={'f1_val': 0.10615040168576322, 'auprc': 0.10615040168576322, 'loss_val': 6.2681310482795105, 'psi': 0.10615040168576322}-{'f1_val': 0.1005586592178771, 'auprc': 0.1005586592178771, 'loss_val': 6.282595288807587, 'psi': 0.1005586592178771}
[S15] START round=34 head_norm_before_train=1.460502 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.008184 metrics={'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.5974595048191498, 'psi': 0.613387689325667}-{'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.621445142691718, 'psi': 0.6142341889454641}
[S16] START round=34 head_norm_before_train=1.555366 cos_to_last_merge=0.9314 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.931
[S16] round=34 local utility u=0.135369 metrics={'f1_val': 0.15525308379413016, 'auprc': 0.15525308379413016, 'loss_val': 3.3074375799100935, 'psi': 0.15525308379413016}-{'f1_val': 0.13898032331212054, 'auprc': 0.13898032331212054, 'loss_val': 3.4317197508639268, 'psi': 0.13898032331212054}
[S17] START round=34 head_norm_before_train=1.791244 cos_to_last_merge=0.9443 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=34 local utility u=0.002880 metrics={'f1_val': 0.2638231331067875, 'auprc': 0.2638231331067875, 'loss_val': 0.953277177018446, 'psi': 0.2638231331067875}-{'f1_val': 0.2628311653582412, 'auprc': 0.2628311653582412, 'loss_val': 0.9501086755320465, 'psi': 0.2628311653582412}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:31615
[S14] not sending this round → trigger blocked (psi=0.106)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:31614
[S16] not sending this round → trigger blocked (psi=0.155)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.3594 head_norm=1.806682
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.683391e-02
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.3594 head_norm=1.797738 delta_norm=0.066834
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1805 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S10
[S15] cosine check vs S10: cos=0.9820
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=-0.0254
[S14] DROPPED delta from S15 (cos=-0.0254 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.6134 head_norm=1.515912
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.439705e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.6134 head_norm=1.481511 delta_norm=0.143971
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S17] → sending delta(kind=head bytes=1811) to S8@127.0.0.1:31609
[S17] sending update (kind=head size=1811 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1811) from S17
[S8] cosine check vs S17: cos=0.9991
[S2] START round=35 head_norm_before_train=1.661472 cos_to_last_merge=0.9575 (last merge round=24)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.26474270277393425, 'auprc': 0.26474270277393425, 'loss_val': 2.3556849211164352, 'psi': 0.26474270277393425}-{'f1_val': 0.263544536271809, 'auprc': 0.263544536271809, 'loss_val': 2.3148851533034094, 'psi': 0.263544536271809}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.865273 cos_to_last_merge=0.9519 (last merge round=24)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.26065552532711495, 'auprc': 0.26065552532711495, 'loss_val': 2.1306608033042758, 'psi': 0.26065552532711495}-{'f1_val': 0.25789912196372494, 'auprc': 0.25789912196372494, 'loss_val': 2.0266051664372253, 'psi': 0.25789912196372494}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.968187 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.478922868842926, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.456003899725298, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=1.408702 cos_to_last_merge=0.9864 (last merge round=25)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.185985506529182, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.12196237282598, 'psi': 0.3335071121394324}
[S6] START round=35 head_norm_before_train=1.836487 (no previous merge yet)
[S6] round=35 local utility u=0.010238 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.7637806298954795, 'psi': 0.02153000458085204}-{'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 6.778330164704176, 'psi': 0.020871559633027524}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=35 head_norm_before_train=1.709361 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2513003090847694, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2371798474790887, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.797738 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.002776 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0429308921961, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0484832241660151, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.858347 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0921380129559375, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0724505791911993, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=1.460553 cos_to_last_merge=0.8581 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.858
[S10] round=35 local utility u=0.006324 metrics={'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.6957000421481663, 'psi': 0.3331740723045071}-{'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.7083481928086033, 'psi': 0.3331740723045071}
[S11] START round=35 head_norm_before_train=1.644818 cos_to_last_merge=0.9233 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.923
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.600042141619531, 'psi': 0.3319353836595216}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.560399071862852, 'psi': 0.3319353836595216}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.790109 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6324801447139756, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6098859067749702, 'psi': 0.3599362944611573}
[S14] START round=35 head_norm_before_train=1.890940 (no previous merge yet)
[S14] round=35 local utility u=0.133408 metrics={'f1_val': 0.13071401586701928, 'auprc': 0.13071401586701928, 'loss_val': 6.222387153072409, 'psi': 0.13071401586701928}-{'f1_val': 0.10615040168576322, 'auprc': 0.10615040168576322, 'loss_val': 6.2681310482795105, 'psi': 0.10615040168576322}
[S15] START round=35 head_norm_before_train=1.481511 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.010588 metrics={'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.5788264398669208, 'psi': 0.6136702686915539}-{'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.5974595048191498, 'psi': 0.613387689325667}
[S16] START round=35 head_norm_before_train=1.575268 cos_to_last_merge=0.9275 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.927
[S16] round=35 local utility u=0.362603 metrics={'f1_val': 0.18774480515169623, 'auprc': 0.18774480515169623, 'loss_val': 2.8746577925662735, 'psi': 0.18774480515169623}-{'f1_val': 0.15525308379413016, 'auprc': 0.15525308379413016, 'loss_val': 3.3074375799100935, 'psi': 0.15525308379413016}
[S17] START round=35 head_norm_before_train=1.804472 cos_to_last_merge=0.9429 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.943
[S17] round=35 local utility u=0.152395 metrics={'f1_val': 0.31094172436985384, 'auprc': 0.31094172436985384, 'loss_val': 1.0725551858763989, 'psi': 0.31094172436985384}-{'f1_val': 0.2638231331067875, 'auprc': 0.2638231331067875, 'loss_val': 0.953277177018446, 'psi': 0.2638231331067875}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:31616
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.131)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:31615
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.188)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] ⇄ pheromone p=0.046 → S5@127.0.0.1:31605
[S9] ⇄ pheromone p=0.003 → S4@127.0.0.1:31604
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.006 → S11@127.0.0.1:31612
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=-0.0370
[S16] DROPPED delta from S8 (cos=-0.0370 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S10
[S15] cosine check vs S10: cos=0.9891
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0242
[S14] DROPPED delta from S15 (cos=-0.0242 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.3594 head_norm=1.813470
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.900760e-02
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.3594 head_norm=1.808313 delta_norm=0.049008
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.012 → S16@127.0.0.1:31616
[S10] ⇄ pheromone p=0.060 → S15@127.0.0.1:31615
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.6137 head_norm=1.533210
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.145322e-01
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.6137 head_norm=1.500501 delta_norm=0.114532
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.035 → S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:31609
[S4] ⇄ pheromone p=0.003 → S6@127.0.0.1:31607
[S16] ⇄ pheromone p=0.175 → S10@127.0.0.1:31611
[S5] ⇄ pheromone p=0.043 → S13@127.0.0.1:31613
[S17] sending update (kind=head size=1807 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1807) from S17
[S8] cosine check vs S17: cos=0.9996
[S17] ⇄ pheromone p=0.113 → S8@127.0.0.1:31609
[S2] START round=36 head_norm_before_train=1.674861 cos_to_last_merge=0.9556 (last merge round=24)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.483540110003824, 'psi': 0.2653978324081417}-{'f1_val': 0.26474270277393425, 'auprc': 0.26474270277393425, 'loss_val': 2.3556849211164352, 'psi': 0.26474270277393425}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.878112 cos_to_last_merge=0.9501 (last merge round=24)
[S3] round=36 local utility u=0.004073 metrics={'f1_val': 0.2568619941274097, 'auprc': 0.2568619941274097, 'loss_val': 2.088373248514495, 'psi': 0.2568619941274097}-{'f1_val': 0.26065552532711495, 'auprc': 0.26065552532711495, 'loss_val': 2.1306608033042758, 'psi': 0.26065552532711495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=36 head_norm_before_train=1.982335 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5009472310140752, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.478922868842926, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=1.432124 cos_to_last_merge=0.9835 (last merge round=25)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2107684023194674, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.185985506529182, 'psi': 0.3335071121394324}
[S6] START round=36 head_norm_before_train=1.844682 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 7.034726505006377, 'psi': 0.017105871474803514}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.7637806298954795, 'psi': 0.02153000458085204}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.721855 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2883744457697304, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2513003090847694, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.808313 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0469612653929972, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0429308921961, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=1.864933 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1102743428822595, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0921380129559375, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=1.475977 cos_to_last_merge=0.8556 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.856
[S10] round=36 local utility u=0.006455 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.6820742070960373, 'psi': 0.3330944988456333}-{'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.6957000421481663, 'psi': 0.3331740723045071}
[S11] START round=36 head_norm_before_train=1.660507 cos_to_last_merge=0.9210 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.921
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.626745424438538, 'psi': 0.3319353836595216}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.600042141619531, 'psi': 0.3319353836595216}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.795895 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6383454597794134, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6324801447139756, 'psi': 0.3599362944611573}
[S14] START round=36 head_norm_before_train=1.899072 (no previous merge yet)
[S14] round=36 local utility u=0.011359 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 6.243010278629505, 'psi': 0.1355297641332834}-{'f1_val': 0.13071401586701928, 'auprc': 0.13071401586701928, 'loss_val': 6.222387153072409, 'psi': 0.13071401586701928}
[S15] START round=36 head_norm_before_train=1.500501 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6051565485366796, 'auprc': 0.6051565485366796, 'loss_val': 0.5859640425656024, 'psi': 0.6051565485366796}-{'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.5788264398669208, 'psi': 0.6136702686915539}
[S16] START round=36 head_norm_before_train=1.592768 cos_to_last_merge=0.9242 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.924
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.17751559533496067, 'auprc': 0.17751559533496067, 'loss_val': 2.8842200673363387, 'psi': 0.17751559533496067}-{'f1_val': 0.18774480515169623, 'auprc': 0.18774480515169623, 'loss_val': 2.8746577925662735, 'psi': 0.18774480515169623}
[S17] START round=36 head_norm_before_train=1.814194 cos_to_last_merge=0.9418 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.2637914561683637, 'auprc': 0.2637914561683637, 'loss_val': 1.0042007293444684, 'psi': 0.2637914561683637}-{'f1_val': 0.31094172436985384, 'auprc': 0.31094172436985384, 'loss_val': 1.0725551858763989, 'psi': 0.31094172436985384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=36 metric=0.3594 head_norm=1.822823
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.855746e-02
[S8] stored merged vector for next round verification (round=36)
[S8] DEBUG after merge:  round=36 metric=0.3594 head_norm=1.818105 delta_norm=0.038557
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.687125 cos_to_last_merge=0.9540 (last merge round=24)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.2438820330474796, 'auprc': 0.2438820330474796, 'loss_val': 2.698967028160167, 'psi': 0.2438820330474796}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.483540110003824, 'psi': 0.2653978324081417}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.888632 cos_to_last_merge=0.9486 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.949
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.2583461736004109, 'auprc': 0.2583461736004109, 'loss_val': 2.1481109995411667, 'psi': 0.2583461736004109}-{'f1_val': 0.2568619941274097, 'auprc': 0.2568619941274097, 'loss_val': 2.088373248514495, 'psi': 0.2568619941274097}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.992713 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.50710163280496, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5009472310140752, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=1.460947 cos_to_last_merge=0.9802 (last merge round=25)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2936991748567923, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2107684023194674, 'psi': 0.3335071121394324}
[S6] START round=37 head_norm_before_train=1.851892 (no previous merge yet)
[S6] round=37 local utility u=0.341354 metrics={'f1_val': 0.035571365051133834, 'auprc': 0.035571365051133834, 'loss_val': 6.51820855398141, 'psi': 0.035571365051133834}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 7.034726505006377, 'psi': 0.017105871474803514}
[S6] not sending this round → trigger blocked (psi=0.036)
[S7] START round=37 head_norm_before_train=1.731578 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3394621851733994, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2883744457697304, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.818105 cos_to_last_merge=1.0000 (last merge round=36)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.059768678628066, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0469612653929972, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=1.871322 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1270941656875455, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1102743428822595, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=1.492342 cos_to_last_merge=0.8530 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.853
[S10] round=37 local utility u=0.006725 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.6686250790966732, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.6820742070960373, 'psi': 0.3330944988456333}
[S11] START round=37 head_norm_before_train=1.674514 cos_to_last_merge=0.9190 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.919
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.7011796246254565, 'psi': 0.33201273984308244}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.626745424438538, 'psi': 0.3319353836595216}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.800929 (no previous merge yet)
[S13] round=37 local utility u=0.000850 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.636644642653337, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6383454597794134, 'psi': 0.3599362944611573}
[S14] START round=37 head_norm_before_train=1.906893 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.278811618843565, 'psi': 0.13592717296421}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 6.243010278629505, 'psi': 0.1355297641332834}
[S15] START round=37 head_norm_before_train=1.555752 cos_to_last_merge=0.9986 (last merge round=35)
[S15] round=37 local utility u=0.058483 metrics={'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.5430775904389658, 'psi': 0.613387689325667}-{'f1_val': 0.6051565485366796, 'auprc': 0.6051565485366796, 'loss_val': 0.5859640425656024, 'psi': 0.6051565485366796}
[S16] START round=37 head_norm_before_train=1.607819 cos_to_last_merge=0.9214 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.13454304049568488, 'auprc': 0.13454304049568488, 'loss_val': 3.4759484396042746, 'psi': 0.13454304049568488}-{'f1_val': 0.17751559533496067, 'auprc': 0.17751559533496067, 'loss_val': 2.8842200673363387, 'psi': 0.17751559533496067}
[S17] START round=37 head_norm_before_train=1.824612 cos_to_last_merge=0.9406 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=37 local utility u=0.530112 metrics={'f1_val': 0.38757429689088163, 'auprc': 0.38757429689088163, 'loss_val': 1.0580223481816138, 'psi': 0.38757429689088163}-{'f1_val': 0.2637914561683637, 'auprc': 0.2637914561683637, 'loss_val': 1.0042007293444684, 'psi': 0.2637914561683637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=38 head_norm_before_train=1.697590 cos_to_last_merge=0.9526 (last merge round=24)
[S2] round=38 local utility u=0.158979 metrics={'f1_val': 0.2652386619066508, 'auprc': 0.2652386619066508, 'loss_val': 2.573218464962335, 'psi': 0.2652386619066508}-{'f1_val': 0.2438820330474796, 'auprc': 0.2438820330474796, 'loss_val': 2.698967028160167, 'psi': 0.2438820330474796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=38 head_norm_before_train=1.898337 cos_to_last_merge=0.9473 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.947
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.26050365766815564, 'auprc': 0.26050365766815564, 'loss_val': 2.216752014047519, 'psi': 0.26050365766815564}-{'f1_val': 0.2583461736004109, 'auprc': 0.2583461736004109, 'loss_val': 2.1481109995411667, 'psi': 0.2583461736004109}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.997707 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5134528370267613, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.50710163280496, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=1.492011 cos_to_last_merge=0.9767 (last merge round=25)
[S5] round=38 local utility u=0.001318 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.291062586481525, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2936991748567923, 'psi': 0.3335071121394324}
[S6] START round=38 head_norm_before_train=1.858985 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.027589326096788783, 'auprc': 0.027589326096788783, 'loss_val': 6.613779988499295, 'psi': 0.027589326096788783}-{'f1_val': 0.035571365051133834, 'auprc': 0.035571365051133834, 'loss_val': 6.51820855398141, 'psi': 0.035571365051133834}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.741545 (no previous merge yet)
[S7] round=38 local utility u=0.000697 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.33806807797417, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3394621851733994, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=38 head_norm_before_train=1.832812 cos_to_last_merge=0.9999 (last merge round=36)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1037152441551923, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.059768678628066, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.877408 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.142620245139806, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1270941656875455, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=1.509225 cos_to_last_merge=0.8502 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.850
[S10] round=38 local utility u=0.007816 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.6529935070611987, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.6686250790966732, 'psi': 0.3330944988456333}
[S11] START round=38 head_norm_before_train=1.688233 cos_to_last_merge=0.9169 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.917
[S11] round=38 local utility u=0.036044 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.627010335782667, 'psi': 0.33178150217256364}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.7011796246254565, 'psi': 0.33201273984308244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=38 head_norm_before_train=1.808405 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6501560757821199, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.636644642653337, 'psi': 0.3599362944611573}
[S14] START round=38 head_norm_before_train=1.914384 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.316670323384257, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.278811618843565, 'psi': 0.13592717296421}
[S15] START round=38 head_norm_before_train=1.611058 cos_to_last_merge=0.9955 (last merge round=35)
[S15] round=38 local utility u=0.010815 metrics={'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.5290662957452179, 'psi': 0.6142341889454641}-{'f1_val': 0.613387689325667, 'auprc': 0.613387689325667, 'loss_val': 0.5430775904389658, 'psi': 0.613387689325667}
[S16] START round=38 head_norm_before_train=1.621592 cos_to_last_merge=0.9188 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.919
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.00769865273577124, 'auprc': 0.00769865273577124, 'loss_val': 4.6426889396898865, 'psi': 0.00769865273577124}-{'f1_val': 0.13454304049568488, 'auprc': 0.13454304049568488, 'loss_val': 3.4759484396042746, 'psi': 0.13454304049568488}
[S17] START round=38 head_norm_before_train=1.836057 cos_to_last_merge=0.9394 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.939
[S17] round=38 local utility u=0.035741 metrics={'f1_val': 0.39816410149443227, 'auprc': 0.39816410149443227, 'loss_val': 1.08184784115805, 'psi': 0.39816410149443227}-{'f1_val': 0.38757429689088163, 'auprc': 0.38757429689088163, 'loss_val': 1.0580223481816138, 'psi': 0.38757429689088163}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=39 head_norm_before_train=1.708189 cos_to_last_merge=0.9512 (last merge round=24)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.5883159576840216, 'psi': 0.2653978324081417}-{'f1_val': 0.2652386619066508, 'auprc': 0.2652386619066508, 'loss_val': 2.573218464962335, 'psi': 0.2652386619066508}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.265 u=0.0000 p_local=0.0557 f1=0.265 auprc=0.265 bytes=19804
[S3] START round=39 head_norm_before_train=1.907941 cos_to_last_merge=0.9460 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=39 local utility u=0.008682 metrics={'f1_val': 0.2580976204220384, 'auprc': 0.2580976204220384, 'loss_val': 2.1777336829748717, 'psi': 0.2580976204220384}-{'f1_val': 0.26050365766815564, 'auprc': 0.26050365766815564, 'loss_val': 2.216752014047519, 'psi': 0.26050365766815564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] r=40 psi=0.258 u=0.0087 p_local=0.0044 f1=0.258 auprc=0.258 bytes=14410
[S4] START round=39 head_norm_before_train=2.002946 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.528867643945084, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5134528370267613, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=1.520341 cos_to_last_merge=0.9733 (last merge round=25)
[S5] round=39 local utility u=0.012171 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2667214926879797, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.291062586481525, 'psi': 0.3335071121394324}
[S6] START round=39 head_norm_before_train=1.866475 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 7.117827815063041, 'psi': 0.017105871474803514}-{'f1_val': 0.027589326096788783, 'auprc': 0.027589326096788783, 'loss_val': 6.613779988499295, 'psi': 0.027589326096788783}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.017 u=0.0000 p_local=0.0649 f1=0.017 auprc=0.017 bytes=0
[S7] START round=39 head_norm_before_train=1.749521 (no previous merge yet)
[S7] round=39 local utility u=0.034359 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2693498528023492, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.33806807797417, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S7] r=40 psi=0.360 u=0.0344 p_local=0.0105 f1=0.360 auprc=0.360 bytes=23411
[S8] START round=39 head_norm_before_train=1.846846 cos_to_last_merge=0.9996 (last merge round=36)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1475139214569292, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1037152441551923, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=1.883259 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.157117754830802, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.142620245139806, 'psi': 0.36867172340800847}
[S10] START round=39 head_norm_before_train=1.529858 cos_to_last_merge=0.8470 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.847
[S10] round=39 local utility u=0.005747 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.6414997754186453, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.6529935070611987, 'psi': 0.3330944988456333}
[S11] START round=39 head_norm_before_train=1.701927 cos_to_last_merge=0.9149 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.915
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.7225029998935826, 'psi': 0.3319353836595216}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.627010335782667, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0116 f1=0.332 auprc=0.332 bytes=12590
[S13] START round=39 head_norm_before_train=1.815159 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6573578735430412, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6501560757821199, 'psi': 0.3599362944611573}
[S14] START round=39 head_norm_before_train=1.921633 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.3550221061786605, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.316670323384257, 'psi': 0.13592717296421}
[S15] START round=39 head_norm_before_train=1.656052 cos_to_last_merge=0.9923 (last merge round=35)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.612253222385381, 'auprc': 0.612253222385381, 'loss_val': 0.5240308747796494, 'psi': 0.612253222385381}-{'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.5290662957452179, 'psi': 0.6142341889454641}
[S16] START round=39 head_norm_before_train=1.633903 cos_to_last_merge=0.9165 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.917
[S16] round=39 local utility u=0.664523 metrics={'f1_val': 0.0877742946708464, 'auprc': 0.0877742946708464, 'loss_val': 4.034323414104969, 'psi': 0.0877742946708464}-{'f1_val': 0.00769865273577124, 'auprc': 0.00769865273577124, 'loss_val': 4.6426889396898865, 'psi': 0.00769865273577124}
[S17] START round=39 head_norm_before_train=1.846079 cos_to_last_merge=0.9383 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.938
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.35063770414427076, 'auprc': 0.35063770414427076, 'loss_val': 1.1700050178624335, 'psi': 0.35063770414427076}-{'f1_val': 0.39816410149443227, 'auprc': 0.39816410149443227, 'loss_val': 1.08184784115805, 'psi': 0.39816410149443227}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S10] r=40 psi=0.333 u=0.0057 p_local=0.0285 f1=0.333 auprc=0.333 bytes=27010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0199 f1=0.136 auprc=0.136 bytes=0
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0048 f1=0.359 auprc=0.359 bytes=27016
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0024 f1=0.360 auprc=0.360 bytes=12587
[S16] not sending this round → trigger blocked (psi=0.088)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0012 f1=0.369 auprc=0.369 bytes=3604
[S15] r=40 psi=0.612 u=0.0000 p_local=0.0237 f1=0.612 auprc=0.612 bytes=28812
[S5] r=40 psi=0.334 u=0.0122 p_local=0.0201 f1=0.334 auprc=0.334 bytes=23409
[S16] r=40 psi=0.088 u=0.6645 p_local=0.2047 f1=0.088 auprc=0.088 bytes=0
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0012 f1=0.357 auprc=0.357 bytes=14404
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.351 u=0.0000 p_local=0.1200 f1=0.351 auprc=0.351 bytes=39692
[S2] START round=40 head_norm_before_train=1.718765 cos_to_last_merge=0.9497 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.950
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.19558457711442787, 'auprc': 0.19558457711442787, 'loss_val': 3.312319230977085, 'psi': 0.19558457711442787}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.5883159576840216, 'psi': 0.2653978324081417}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.916506 cos_to_last_merge=0.9449 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.25327291037260824, 'auprc': 0.25327291037260824, 'loss_val': 2.1730454668427055, 'psi': 0.25327291037260824}-{'f1_val': 0.2580976204220384, 'auprc': 0.2580976204220384, 'loss_val': 2.1777336829748717, 'psi': 0.2580976204220384}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.006692 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5400700688644808, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.528867643945084, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=1.546736 cos_to_last_merge=0.9698 (last merge round=25)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2785549133305323, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2667214926879797, 'psi': 0.3335071121394324}
[S6] START round=40 head_norm_before_train=1.873716 (no previous merge yet)
[S6] round=40 local utility u=0.041456 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.04093535225848, 'psi': 0.017774699907663897}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 7.117827815063041, 'psi': 0.017105871474803514}
[S6] not sending this round → trigger blocked (psi=0.018)
[S7] START round=40 head_norm_before_train=1.757737 (no previous merge yet)
[S7] round=40 local utility u=0.020049 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.229251290464668, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2693498528023492, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=40 head_norm_before_train=1.859866 cos_to_last_merge=0.9991 (last merge round=36)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.188958566325669, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1475139214569292, 'psi': 0.35939447907390915}
[S9] START round=40 head_norm_before_train=1.888938 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1707546623728944, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.157117754830802, 'psi': 0.36867172340800847}
[S10] START round=40 head_norm_before_train=1.548136 cos_to_last_merge=0.8440 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.844
[S10] round=40 local utility u=0.008245 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.6250089301724127, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.6414997754186453, 'psi': 0.3330944988456333}
[S11] START round=40 head_norm_before_train=1.715187 cos_to_last_merge=0.9130 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.913
[S11] round=40 local utility u=0.016416 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.688285888123193, 'psi': 0.33178150217256364}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.7225029998935826, 'psi': 0.3319353836595216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=40 head_norm_before_train=1.822333 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.678011013129964, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6573578735430412, 'psi': 0.3599362944611573}
[S14] START round=40 head_norm_before_train=1.928570 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.393347973861991, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.3550221061786605, 'psi': 0.13592717296421}
[S15] START round=40 head_norm_before_train=1.694303 cos_to_last_merge=0.9893 (last merge round=35)
[S15] round=40 local utility u=0.021702 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5161023204785625, 'psi': 0.6161950003225232}-{'f1_val': 0.612253222385381, 'auprc': 0.612253222385381, 'loss_val': 0.5240308747796494, 'psi': 0.612253222385381}
[S16] START round=40 head_norm_before_train=1.645715 cos_to_last_merge=0.9144 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.914
[S16] round=40 local utility u=0.743377 metrics={'f1_val': 0.15633842671194115, 'auprc': 0.15633842671194115, 'loss_val': 3.164646255578203, 'psi': 0.15633842671194115}-{'f1_val': 0.0877742946708464, 'auprc': 0.0877742946708464, 'loss_val': 4.034323414104969, 'psi': 0.0877742946708464}
[S17] START round=40 head_norm_before_train=1.855599 cos_to_last_merge=0.9373 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.937
[S17] round=40 local utility u=0.225494 metrics={'f1_val': 0.39433310861882287, 'auprc': 0.39433310861882287, 'loss_val': 1.1122762307505911, 'psi': 0.39433310861882287}-{'f1_val': 0.35063770414427076, 'auprc': 0.35063770414427076, 'loss_val': 1.1700050178624335, 'psi': 0.35063770414427076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.156)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=0.312 → S2@127.0.0.1:31602
[S4] ⇄ pheromone p=0.001 → S9@127.0.0.1:31610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=41 head_norm_before_train=1.728265 cos_to_last_merge=0.9484 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.948
[S2] round=41 local utility u=0.652216 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.635490848092664, 'psi': 0.26531826293872696}-{'f1_val': 0.19558457711442787, 'auprc': 0.19558457711442787, 'loss_val': 3.312319230977085, 'psi': 0.19558457711442787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=41 head_norm_before_train=1.923948 cos_to_last_merge=0.9439 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.2563220587298554, 'auprc': 0.2563220587298554, 'loss_val': 2.2012224173094443, 'psi': 0.2563220587298554}-{'f1_val': 0.25327291037260824, 'auprc': 0.25327291037260824, 'loss_val': 2.1730454668427055, 'psi': 0.25327291037260824}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=2.015259 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5428916351160797, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5400700688644808, 'psi': 0.3567939207526687}
[S5] START round=41 head_norm_before_train=1.572891 cos_to_last_merge=0.9663 (last merge round=25)
[S5] round=41 local utility u=0.027969 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.222617290553593, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2785549133305323, 'psi': 0.3335071121394324}
[S6] START round=41 head_norm_before_train=1.880919 (no previous merge yet)
[S6] round=41 local utility u=0.008285 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 7.026368307997711, 'psi': 0.01799723119520074}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.04093535225848, 'psi': 0.017774699907663897}
[S6] not sending this round → trigger blocked (psi=0.018)
[S7] START round=41 head_norm_before_train=1.766109 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.274754917375613, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.229251290464668, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.873389 cos_to_last_merge=0.9986 (last merge round=36)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2282607828545966, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.188958566325669, 'psi': 0.35939447907390915}
[S9] START round=41 head_norm_before_train=1.894438 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1823156426429695, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1707546623728944, 'psi': 0.36867172340800847}
[S10] START round=41 head_norm_before_train=1.569167 cos_to_last_merge=0.8405 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.841
[S10] round=41 local utility u=0.008548 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.607912075748692, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.6250089301724127, 'psi': 0.3330944988456333}
[S11] START round=41 head_norm_before_train=1.727910 cos_to_last_merge=0.9112 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.911
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.772002792025374, 'psi': 0.3319353836595216}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.688285888123193, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.830304 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6907570673529702, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.678011013129964, 'psi': 0.3599362944611573}
[S14] START round=41 head_norm_before_train=1.935123 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.428464145651217, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.393347973861991, 'psi': 0.13587634006482174}
[S15] START round=41 head_norm_before_train=1.726588 cos_to_last_merge=0.9867 (last merge round=35)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6092432965021914, 'auprc': 0.6092432965021914, 'loss_val': 0.5211260938064617, 'psi': 0.6092432965021914}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5161023204785625, 'psi': 0.6161950003225232}
[S16] START round=41 head_norm_before_train=1.657085 cos_to_last_merge=0.9123 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.912
[S16] round=41 local utility u=0.428296 metrics={'f1_val': 0.18793549671511048, 'auprc': 0.18793549671511048, 'loss_val': 2.592428775136961, 'psi': 0.18793549671511048}-{'f1_val': 0.15633842671194115, 'auprc': 0.15633842671194115, 'loss_val': 3.164646255578203, 'psi': 0.15633842671194115}
[S17] START round=41 head_norm_before_train=1.862881 cos_to_last_merge=0.9365 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.937
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.3015657018310866, 'auprc': 0.3015657018310866, 'loss_val': 0.9605524872923086, 'psi': 0.3015657018310866}-{'f1_val': 0.39433310861882287, 'auprc': 0.39433310861882287, 'loss_val': 1.1122762307505911, 'psi': 0.39433310861882287}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.188)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.736953 cos_to_last_merge=0.9473 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=42 local utility u=0.008837 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.6185334477148823, 'psi': 0.2653978324081417}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.635490848092664, 'psi': 0.26531826293872696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=42 head_norm_before_train=1.931445 cos_to_last_merge=0.9429 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=42 local utility u=0.475942 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.219906129126552, 'psi': 0.3641628959276018}-{'f1_val': 0.2563220587298554, 'auprc': 0.2563220587298554, 'loss_val': 2.2012224173094443, 'psi': 0.2563220587298554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=42 head_norm_before_train=2.020387 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5595661836757726, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5428916351160797, 'psi': 0.3567939207526687}
[S5] START round=42 head_norm_before_train=1.596807 cos_to_last_merge=0.9633 (last merge round=25)
[S5] round=42 local utility u=0.003552 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.215513833441814, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.222617290553593, 'psi': 0.3335071121394324}
[S6] START round=42 head_norm_before_train=1.888218 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.125059968777597, 'psi': 0.017774699907663897}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 7.026368307997711, 'psi': 0.01799723119520074}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.773159 (no previous merge yet)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2864777914870114, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.274754917375613, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.887454 cos_to_last_merge=0.9979 (last merge round=36)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2707069293248001, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2282607828545966, 'psi': 0.35939447907390915}
[S9] START round=42 head_norm_before_train=1.899629 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.195985498627855, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1823156426429695, 'psi': 0.36867172340800847}
[S10] START round=42 head_norm_before_train=1.593027 cos_to_last_merge=0.8364 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.836
[S10] round=42 local utility u=0.006070 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.5957722597228763, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.607912075748692, 'psi': 0.3330944988456333}
[S11] START round=42 head_norm_before_train=1.738678 cos_to_last_merge=0.9096 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.910
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.783627771560926, 'psi': 0.3319353836595216}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.772002792025374, 'psi': 0.3319353836595216}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.836651 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7074178608643111, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6907570673529702, 'psi': 0.3599362944611573}
[S14] START round=42 head_norm_before_train=1.941525 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.464319879715734, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.428464145651217, 'psi': 0.13587634006482174}
[S15] START round=42 head_norm_before_train=1.757298 cos_to_last_merge=0.9841 (last merge round=35)
[S15] round=42 local utility u=0.026583 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.5217239388344543, 'psi': 0.6152170947577895}-{'f1_val': 0.6092432965021914, 'auprc': 0.6092432965021914, 'loss_val': 0.5211260938064617, 'psi': 0.6092432965021914}
[S16] START round=42 head_norm_before_train=1.668266 cos_to_last_merge=0.9103 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.910
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.1599943812333193, 'auprc': 0.1599943812333193, 'loss_val': 3.1758683067166276, 'psi': 0.1599943812333193}-{'f1_val': 0.18793549671511048, 'auprc': 0.18793549671511048, 'loss_val': 2.592428775136961, 'psi': 0.18793549671511048}
[S17] START round=42 head_norm_before_train=1.869912 cos_to_last_merge=0.9359 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.936
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.3103958499908685, 'auprc': 0.3103958499908685, 'loss_val': 1.2647682294108138, 'psi': 0.3103958499908685}-{'f1_val': 0.3015657018310866, 'auprc': 0.3015657018310866, 'loss_val': 0.9605524872923086, 'psi': 0.3015657018310866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.745588 cos_to_last_merge=0.9461 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.946
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.676117847620391, 'psi': 0.26531826293872696}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.6185334477148823, 'psi': 0.2653978324081417}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.937438 cos_to_last_merge=0.9421 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.25814729278932513, 'auprc': 0.25814729278932513, 'loss_val': 2.249126919046716, 'psi': 0.25814729278932513}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.219906129126552, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.027021 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5635009790362697, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5595661836757726, 'psi': 0.3567939207526687}
[S5] START round=43 head_norm_before_train=1.615661 cos_to_last_merge=0.9608 (last merge round=25)
[S5] round=43 local utility u=0.021518 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1724768584475473, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.215513833441814, 'psi': 0.3335071121394324}
[S6] START round=43 head_norm_before_train=1.895178 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.185604101485773, 'psi': 0.017551963048498844}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.125059968777597, 'psi': 0.017774699907663897}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.776347 (no previous merge yet)
[S7] round=43 local utility u=0.019168 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2481415810358074, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2864777914870114, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=43 head_norm_before_train=1.902810 cos_to_last_merge=0.9972 (last merge round=36)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2980192321744215, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2707069293248001, 'psi': 0.35939447907390915}
[S9] START round=43 head_norm_before_train=1.904924 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2103514579128527, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.195985498627855, 'psi': 0.36867172340800847}
[S10] START round=43 head_norm_before_train=1.617498 cos_to_last_merge=0.8321 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.832
[S10] round=43 local utility u=0.006465 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5821268016687813, 'psi': 0.33301496338745623}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.5957722597228763, 'psi': 0.3330944988456333}
[S11] START round=43 head_norm_before_train=1.748719 cos_to_last_merge=0.9082 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.908
[S11] round=43 local utility u=0.025439 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.731365541582919, 'psi': 0.33178150217256364}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.783627771560926, 'psi': 0.3319353836595216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=43 head_norm_before_train=1.841238 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7309497650728753, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7074178608643111, 'psi': 0.3599362944611573}
[S14] START round=43 head_norm_before_train=1.947657 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.499640296812038, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.464319879715734, 'psi': 0.13592717296421}
[S15] START round=43 head_norm_before_train=1.783261 cos_to_last_merge=0.9820 (last merge round=35)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5279323371017022, 'psi': 0.6150769866718802}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.5217239388344543, 'psi': 0.6152170947577895}
[S16] START round=43 head_norm_before_train=1.679141 cos_to_last_merge=0.9083 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.908
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.13828462608950412, 'auprc': 0.13828462608950412, 'loss_val': 3.6899105029102492, 'psi': 0.13828462608950412}-{'f1_val': 0.1599943812333193, 'auprc': 0.1599943812333193, 'loss_val': 3.1758683067166276, 'psi': 0.1599943812333193}
[S17] START round=43 head_norm_before_train=1.875383 cos_to_last_merge=0.9354 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.935
[S17] round=43 local utility u=0.175295 metrics={'f1_val': 0.31364784954302904, 'auprc': 0.31364784954302904, 'loss_val': 0.9434464698462988, 'psi': 0.31364784954302904}-{'f1_val': 0.3103958499908685, 'auprc': 0.3103958499908685, 'loss_val': 1.2647682294108138, 'psi': 0.3103958499908685}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S10] sending update (kind=head size=1808 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=44 head_norm_before_train=1.753811 cos_to_last_merge=0.9450 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.945
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.2621857704874308, 'auprc': 0.2621857704874308, 'loss_val': 2.718862611992193, 'psi': 0.2621857704874308}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.676117847620391, 'psi': 0.26531826293872696}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.941972 cos_to_last_merge=0.9414 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=44 local utility u=0.479514 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.244238415166013, 'psi': 0.3641628959276018}-{'f1_val': 0.25814729278932513, 'auprc': 0.25814729278932513, 'loss_val': 2.249126919046716, 'psi': 0.25814729278932513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=44 head_norm_before_train=2.037050 (no previous merge yet)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5766798274106886, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5635009790362697, 'psi': 0.3567939207526687}
[S5] START round=44 head_norm_before_train=1.635638 cos_to_last_merge=0.9580 (last merge round=25)
[S5] round=44 local utility u=0.042332 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0878136522408477, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1724768584475473, 'psi': 0.3335071121394324}
[S6] START round=44 head_norm_before_train=1.901754 (no previous merge yet)
[S6] round=44 local utility u=0.019844 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 7.149924496150591, 'psi': 0.01799723119520074}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.185604101485773, 'psi': 0.017551963048498844}
[S6] not sending this round → trigger blocked (psi=0.018)
[S7] START round=44 head_norm_before_train=1.778118 (no previous merge yet)
[S7] round=44 local utility u=0.069376 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1093890628130456, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2481415810358074, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=44 head_norm_before_train=1.916741 cos_to_last_merge=0.9966 (last merge round=36)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3265322073365229, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2980192321744215, 'psi': 0.35939447907390915}
[S9] START round=44 head_norm_before_train=1.910223 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.224501485889053, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2103514579128527, 'psi': 0.36867172340800847}
[S10] START round=44 head_norm_before_train=1.642810 cos_to_last_merge=0.8276 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.828
[S10] round=44 local utility u=0.003830 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5744676810877607, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5821268016687813, 'psi': 0.33301496338745623}
[S11] START round=44 head_norm_before_train=1.758448 cos_to_last_merge=0.9068 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.907
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.8197270543465764, 'psi': 0.3319353836595216}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.731365541582919, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.848767 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7397427081221581, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7309497650728753, 'psi': 0.3599362944611573}
[S14] START round=44 head_norm_before_train=1.953743 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.5342274169190775, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.499640296812038, 'psi': 0.13592717296421}
[S15] START round=44 head_norm_before_train=1.806995 cos_to_last_merge=0.9800 (last merge round=35)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5356140136728749, 'psi': 0.6150769866718802}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5279323371017022, 'psi': 0.6150769866718802}
[S16] START round=44 head_norm_before_train=1.689485 cos_to_last_merge=0.9065 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.906
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.13277087033747778, 'auprc': 0.13277087033747778, 'loss_val': 3.9257622301079187, 'psi': 0.13277087033747778}-{'f1_val': 0.13828462608950412, 'auprc': 0.13828462608950412, 'loss_val': 3.6899105029102492, 'psi': 0.13828462608950412}
[S17] START round=44 head_norm_before_train=1.881519 cos_to_last_merge=0.9349 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.935
[S17] round=44 local utility u=0.538453 metrics={'f1_val': 0.4404887518248977, 'auprc': 0.4404887518248977, 'loss_val': 1.0081075943089264, 'psi': 0.4404887518248977}-{'f1_val': 0.31364784954302904, 'auprc': 0.31364784954302904, 'loss_val': 0.9434464698462988, 'psi': 0.31364784954302904}
[S8]  timeout peer S16
[S15]  timeout peer S14
[S4]  timeout peer S6
[S10]  timeout peer S15
[S16]  timeout peer S10
[S13]  timeout peer S11
[S14]  timeout peer S5
[S17]  timeout peer S7
[S17]  timeout peer S8
[S5]  timeout peer S13
[S5]  timeout peer S17
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.761513 cos_to_last_merge=0.9440 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.944
[S2] round=45 local utility u=0.021314 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.7051427303819877, 'psi': 0.2653978324081417}-{'f1_val': 0.2621857704874308, 'auprc': 0.2621857704874308, 'loss_val': 2.718862611992193, 'psi': 0.2621857704874308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=45 head_norm_before_train=1.945890 cos_to_last_merge=0.9409 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=45 local utility u=0.002318 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.2396016407070944, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.244238415166013, 'psi': 0.3641628959276018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=45 head_norm_before_train=2.048968 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.59208469399073, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5766798274106886, 'psi': 0.3567939207526687}
[S5] START round=45 head_norm_before_train=1.656675 cos_to_last_merge=0.9553 (last merge round=25)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1346113804018203, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0878136522408477, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.908253 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.262363394489685, 'psi': 0.017774699907663897}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 7.149924496150591, 'psi': 0.01799723119520074}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.783072 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1940920238493236, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1093890628130456, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.926865 cos_to_last_merge=0.9961 (last merge round=36)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3557762355888727, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3265322073365229, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.915442 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2368230906696964, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.224501485889053, 'psi': 0.36867172340800847}
[S10] START round=45 head_norm_before_train=1.666977 cos_to_last_merge=0.8234 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.823
[S10] round=45 local utility u=0.002570 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.569327170933716, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5744676810877607, 'psi': 0.33301496338745623}
[S10] not sending this round → trigger blocked (psi=0.333)
[S11] START round=45 head_norm_before_train=1.768718 cos_to_last_merge=0.9053 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.905
[S11] round=45 local utility u=0.007253 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.80522749007907, 'psi': 0.3319360347772085}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.8197270543465764, 'psi': 0.3319353836595216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=45 head_norm_before_train=1.855315 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7533811950179612, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7397427081221581, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.959664 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 6.571790039993623, 'psi': 0.13533083645443197}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.5342274169190775, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.829666 cos_to_last_merge=0.9781 (last merge round=35)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6112550835481511, 'auprc': 0.6112550835481511, 'loss_val': 0.5378398026433041, 'psi': 0.6112550835481511}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5356140136728749, 'psi': 0.6150769866718802}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.699418 cos_to_last_merge=0.9047 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.905
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.1330078413966563, 'auprc': 0.1330078413966563, 'loss_val': 3.9829562662951505, 'psi': 0.1330078413966563}-{'f1_val': 0.13277087033747778, 'auprc': 0.13277087033747778, 'loss_val': 3.9257622301079187, 'psi': 0.13277087033747778}
[S17] START round=45 head_norm_before_train=1.887603 cos_to_last_merge=0.9343 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.934
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.30711103605585693, 'auprc': 0.30711103605585693, 'loss_val': 1.3210345017848808, 'psi': 0.30711103605585693}-{'f1_val': 0.4404887518248977, 'auprc': 0.4404887518248977, 'loss_val': 1.0081075943089264, 'psi': 0.4404887518248977}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=0.137 → S2@127.0.0.1:31602
[S9] ⇄ pheromone p=0.000 → S4@127.0.0.1:31604
[S4] ⇄ pheromone p=0.000 → S9@127.0.0.1:31610
[S2] START round=46 head_norm_before_train=1.769196 cos_to_last_merge=0.9430 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.943
[S2] round=46 local utility u=0.002393 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.700356175272289, 'psi': 0.2653978324081417}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.7051427303819877, 'psi': 0.2653978324081417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=46 head_norm_before_train=1.950584 cos_to_last_merge=0.9403 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.24725038402457758, 'auprc': 0.24725038402457758, 'loss_val': 2.252343282681083, 'psi': 0.24725038402457758}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.2396016407070944, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.059373 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.606990883918425, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.59208469399073, 'psi': 0.3567939207526687}
[S5] START round=46 head_norm_before_train=1.678680 cos_to_last_merge=0.9527 (last merge round=25)
[S5] round=46 local utility u=0.001846 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.130919895217153, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1346113804018203, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=46 head_norm_before_train=1.914553 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.348737857591007, 'psi': 0.017551963048498844}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.262363394489685, 'psi': 0.017774699907663897}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.792350 (no previous merge yet)
[S7] round=46 local utility u=0.015862 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1623687566781145, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1940920238493236, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=46 head_norm_before_train=1.936959 cos_to_last_merge=0.9955 (last merge round=36)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3831647254644979, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3557762355888727, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.920351 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2480977168523646, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2368230906696964, 'psi': 0.36867172340800847}
[S10] START round=46 head_norm_before_train=1.689932 cos_to_last_merge=0.8196 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.820
[S10] round=46 local utility u=0.001501 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.566325103055424, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.569327170933716, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=46 head_norm_before_train=1.778887 cos_to_last_merge=0.9038 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.904
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.331858063514248, 'auprc': 0.331858063514248, 'loss_val': 2.8389833085151683, 'psi': 0.331858063514248}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.80522749007907, 'psi': 0.3319360347772085}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.861154 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7668827109713934, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7533811950179612, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.965248 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 6.608320927381554, 'psi': 0.13413413413413414}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 6.571790039993623, 'psi': 0.13533083645443197}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.850367 cos_to_last_merge=0.9764 (last merge round=35)
[S15] round=46 local utility u=0.032982 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5163341852693762, 'psi': 0.6161950003225232}-{'f1_val': 0.6112550835481511, 'auprc': 0.6112550835481511, 'loss_val': 0.5378398026433041, 'psi': 0.6112550835481511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=46 head_norm_before_train=1.709139 cos_to_last_merge=0.9030 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.903
[S16] round=46 local utility u=0.036141 metrics={'f1_val': 0.13665417676878996, 'auprc': 0.13665417676878996, 'loss_val': 3.9434916320322357, 'psi': 0.13665417676878996}-{'f1_val': 0.1330078413966563, 'auprc': 0.1330078413966563, 'loss_val': 3.9829562662951505, 'psi': 0.1330078413966563}
[S17] START round=46 head_norm_before_train=1.894720 cos_to_last_merge=0.9336 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.934
[S17] round=46 local utility u=0.735074 metrics={'f1_val': 0.43869711887935253, 'auprc': 0.43869711887935253, 'loss_val': 1.0351618693798905, 'psi': 0.43869711887935253}-{'f1_val': 0.30711103605585693, 'auprc': 0.30711103605585693, 'loss_val': 1.3210345017848808, 'psi': 0.30711103605585693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.137)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.776944 cos_to_last_merge=0.9419 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.942
[S2] round=47 local utility u=0.011083 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.67890629016072, 'psi': 0.2654773703336637}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.700356175272289, 'psi': 0.2653978324081417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=47 head_norm_before_train=1.955797 cos_to_last_merge=0.9396 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=47 local utility u=0.512762 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.2790315830128645, 'psi': 0.3641628959276018}-{'f1_val': 0.24725038402457758, 'auprc': 0.24725038402457758, 'loss_val': 2.252343282681083, 'psi': 0.24725038402457758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=47 head_norm_before_train=2.067009 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.620667812300443, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.606990883918425, 'psi': 0.3567939207526687}
[S5] START round=47 head_norm_before_train=1.699603 cos_to_last_merge=0.9499 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.950
[S5] round=47 local utility u=0.035280 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.060360589241171, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.130919895217153, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=47 head_norm_before_train=1.920720 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.36392043590684, 'psi': 0.017774699907663897}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.348737857591007, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.798586 (no previous merge yet)
[S7] round=47 local utility u=0.074830 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.012708745889775, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1623687566781145, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=47 head_norm_before_train=1.947146 cos_to_last_merge=0.9950 (last merge round=36)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4045008225943285, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3831647254644979, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.925162 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2617546531579986, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2480977168523646, 'psi': 0.36867172340800847}
[S10] START round=47 head_norm_before_train=1.711269 cos_to_last_merge=0.8163 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.816
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5674248429489777, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.566325103055424, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.789073 cos_to_last_merge=0.9024 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.902
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.8924857102092534, 'psi': 0.3319353836595216}-{'f1_val': 0.331858063514248, 'auprc': 0.331858063514248, 'loss_val': 2.8389833085151683, 'psi': 0.331858063514248}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.865128 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7676673275757064, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7668827109713934, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.970696 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.637801598264733, 'psi': 0.13572854291417166}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 6.608320927381554, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.869145 cos_to_last_merge=0.9748 (last merge round=35)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.5094597263146431, 'psi': 0.6153571007984797}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5163341852693762, 'psi': 0.6161950003225232}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.718333 cos_to_last_merge=0.9014 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.901
[S16] round=47 local utility u=0.068132 metrics={'f1_val': 0.1415156147630487, 'auprc': 0.1415156147630487, 'loss_val': 3.850981342921178, 'psi': 0.1415156147630487}-{'f1_val': 0.13665417676878996, 'auprc': 0.13665417676878996, 'loss_val': 3.9434916320322357, 'psi': 0.13665417676878996}
[S17] START round=47 head_norm_before_train=1.897914 cos_to_last_merge=0.9333 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.933
[S17] round=47 local utility u=0.108993 metrics={'f1_val': 0.4295277125157593, 'auprc': 0.4295277125157593, 'loss_val': 0.7346505659331354, 'psi': 0.4295277125157593}-{'f1_val': 0.43869711887935253, 'auprc': 0.43869711887935253, 'loss_val': 1.0351618693798905, 'psi': 0.43869711887935253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.142)
[S2] START round=48 head_norm_before_train=1.784677 cos_to_last_merge=0.9409 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.941
[S2] round=48 local utility u=0.007904 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.6621509895405464, 'psi': 0.26537216828478966}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.67890629016072, 'psi': 0.2654773703336637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=48 head_norm_before_train=1.961180 cos_to_last_merge=0.9389 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.282184849327301, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.2790315830128645, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.075531 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.6332406554015628, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.620667812300443, 'psi': 0.3567939207526687}
[S5] START round=48 head_norm_before_train=1.717970 cos_to_last_merge=0.9473 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 2.9701260841826014, 'psi': 0.2501303341045743}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.060360589241171, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.926679 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.382715678456591, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.36392043590684, 'psi': 0.017774699907663897}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.804514 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.24632352941176472, 'auprc': 0.24632352941176472, 'loss_val': 0.8791320987952786, 'psi': 0.24632352941176472}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.012708745889775, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.957134 cos_to_last_merge=0.9943 (last merge round=36)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4272573873123326, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4045008225943285, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.930077 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2741467212797537, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2617546531579986, 'psi': 0.36867172340800847}
[S10] START round=48 head_norm_before_train=1.730675 cos_to_last_merge=0.8134 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.813
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5701865481116917, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5674248429489777, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.799364 cos_to_last_merge=0.9009 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.9028137716356923, 'psi': 0.3319353836595216}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.8924857102092534, 'psi': 0.3319353836595216}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.872291 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7895840009642066, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7676673275757064, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.976061 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.669491078929026, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.637801598264733, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.885114 cos_to_last_merge=0.9735 (last merge round=35)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6125979479387734, 'auprc': 0.6125979479387734, 'loss_val': 0.500301791167607, 'psi': 0.6125979479387734}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.5094597263146431, 'psi': 0.6153571007984797}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.727198 cos_to_last_merge=0.8998 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.900
[S16] round=48 local utility u=0.328787 metrics={'f1_val': 0.1599943812333193, 'auprc': 0.1599943812333193, 'loss_val': 3.359716138364107, 'psi': 0.1599943812333193}-{'f1_val': 0.1415156147630487, 'auprc': 0.1415156147630487, 'loss_val': 3.850981342921178, 'psi': 0.1415156147630487}
[S17] START round=48 head_norm_before_train=1.899730 cos_to_last_merge=0.9331 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.933
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.3125766281934837, 'auprc': 0.3125766281934837, 'loss_val': 1.3172925901326962, 'psi': 0.3125766281934837}-{'f1_val': 0.4295277125157593, 'auprc': 0.4295277125157593, 'loss_val': 0.7346505659331354, 'psi': 0.4295277125157593}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.160)
[S2] START round=49 head_norm_before_train=1.792159 cos_to_last_merge=0.9399 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.940
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.7573306259666834, 'psi': 0.2653978324081417}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.6621509895405464, 'psi': 0.26537216828478966}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.967329 cos_to_last_merge=0.9381 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.2489944929150424, 'auprc': 0.2489944929150424, 'loss_val': 2.299494280414421, 'psi': 0.2489944929150424}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.282184849327301, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.082572 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.6528719847988345, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.6332406554015628, 'psi': 0.3567939207526687}
[S5] START round=49 head_norm_before_train=1.734065 cos_to_last_merge=0.9453 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.945
[S5] round=49 local utility u=0.005425 metrics={'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 2.9592763904363237, 'psi': 0.2501303341045743}-{'f1_val': 0.2501303341045743, 'auprc': 0.2501303341045743, 'loss_val': 2.9701260841826014, 'psi': 0.2501303341045743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=49 head_norm_before_train=1.932356 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.425045733165544, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.382715678456591, 'psi': 0.017774699907663897}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.810297 (no previous merge yet)
[S7] round=49 local utility u=0.472209 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9556750745825618, 'psi': 0.35976373724718097}-{'f1_val': 0.24632352941176472, 'auprc': 0.24632352941176472, 'loss_val': 0.8791320987952786, 'psi': 0.24632352941176472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=49 head_norm_before_train=1.966505 cos_to_last_merge=0.9938 (last merge round=36)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.451900282885351, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4272573873123326, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.934749 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2859088550265683, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2741467212797537, 'psi': 0.36867172340800847}
[S10] START round=49 head_norm_before_train=1.748535 cos_to_last_merge=0.8108 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.811
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5754666307938434, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5701865481116917, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.809304 cos_to_last_merge=0.8996 (last merge round=18)
[S11] ⚠️ Model drifted since last merge! cos=0.900
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.9070102929600563, 'psi': 0.3319360347772085}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.9028137716356923, 'psi': 0.3319353836595216}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.878332 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7905160537722282, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7895840009642066, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.981351 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.70108045776009, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.669491078929026, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.900333 cos_to_last_merge=0.9722 (last merge round=35)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6145155316414842, 'auprc': 0.6145155316414842, 'loss_val': 0.5598255907305968, 'psi': 0.6145155316414842}-{'f1_val': 0.6125979479387734, 'auprc': 0.6125979479387734, 'loss_val': 0.500301791167607, 'psi': 0.6125979479387734}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.735218 cos_to_last_merge=0.8984 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.898
[S16] round=49 local utility u=0.624367 metrics={'f1_val': 0.19700520833333335, 'auprc': 0.19700520833333335, 'loss_val': 2.4440802098980243, 'psi': 0.19700520833333335}-{'f1_val': 0.1599943812333193, 'auprc': 0.1599943812333193, 'loss_val': 3.359716138364107, 'psi': 0.1599943812333193}
[S17] START round=49 head_norm_before_train=1.902659 cos_to_last_merge=0.9327 (last merge round=14)
[S17] ⚠️ Model drifted since last merge! cos=0.933
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.3887605792182436, 'psi': 0.30380970798684975}-{'f1_val': 0.3125766281934837, 'auprc': 0.3125766281934837, 'loss_val': 1.3172925901326962, 'psi': 0.3125766281934837}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.197)
[runner] rounds complete.
[runner] all agents stopped.
