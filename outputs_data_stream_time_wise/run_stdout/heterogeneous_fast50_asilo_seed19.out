[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:52803
[S3] → join 127.0.0.1:52802
[S4] → join 127.0.0.1:52802
[S5] → join 127.0.0.1:52802
[S6] → join 127.0.0.1:52802
[S7] → join 127.0.0.1:52802
[S8] → join 127.0.0.1:52802
[S9] → join 127.0.0.1:52802
[S10] → join 127.0.0.1:52802
[S11] → join 127.0.0.1:52802
[S13] → join 127.0.0.1:52802
[S14] → join 127.0.0.1:52802
[S15] → join 127.0.0.1:52802
[S16] → join 127.0.0.1:52802
[S17] → join 127.0.0.1:52802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.104158 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.200071 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.177088 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.164203 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.209724 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.155738 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.190997 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.193990 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.119406 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.196692 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.140527 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.123614 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.100292 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.270453 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.192208 (no previous merge yet)
[S14]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S3] + discovered S4
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S10
[S3] + discovered S11
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S8
[S3] + discovered S16
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S13
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S10
[S4] + discovered S9
[S4] + discovered S11
[S4] + discovered S17
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S7
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S13
[S5] + discovered S7
[S5] + discovered S14
[S5] + discovered S6
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S8
[S5] + discovered S17
[S5] + discovered S13
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S11
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S2
[S7] + discovered S2
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S3
[S7] + discovered S5
[S6] + discovered S9
[S6] + discovered S8
[S6] + discovered S15
[S6] + discovered S7
[S6] + discovered S10
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S17
[S6] + discovered S16
[S6] + discovered S14
[S7] + discovered S16
[S7] + discovered S17
[S7] + discovered S14
[S7] + discovered S13
[S7] + discovered S11
[S7] + discovered S10
[S7] + discovered S15
[S7] + discovered S8
[S7] + discovered S9
[S8] + discovered S4
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S5
[S8] + discovered S6
[S9] + discovered S6
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S8
[S9] + discovered S5
[S9] + discovered S3
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S11
[S8] + discovered S14
[S8] + discovered S15
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S16
[S9] + discovered S13
[S9] + discovered S15
[S9] + discovered S10
[S9] + discovered S14
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S11
[S10] + discovered S3
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S6
[S10] + discovered S8
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S9
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S16
[S10] + discovered S14
[S10] + discovered S15
[S10] + discovered S13
[S11] + discovered S7
[S11] + discovered S4
[S11] + discovered S8
[S11] + discovered S6
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S2
[S11] + discovered S10
[S11] + discovered S3
[S13] + discovered S6
[S13] + discovered S8
[S11] + discovered S14
[S11] + discovered S13
[S11] + discovered S16
[S11] + discovered S15
[S11] + discovered S17
[S13] + discovered S5
[S13] + discovered S11
[S13] + discovered S10
[S13] + discovered S9
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S3
[S13] + discovered S2
[S13] + discovered S14
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S3
[S14] + discovered S6
[S14] + discovered S5
[S14] + discovered S10
[S14] + discovered S11
[S14] + discovered S7
[S14] + discovered S8
[S14] + discovered S2
[S14] + discovered S4
[S14] + discovered S13
[S14] + discovered S9
[S15] + discovered S14
[S15] + discovered S13
[S15] + discovered S4
[S15] + discovered S11
[S15] + discovered S5
[S15] + discovered S3
[S15] + discovered S9
[S15] + discovered S2
[S15] + discovered S8
[S15] + discovered S7
[S15] + discovered S10
[S15] + discovered S6
[S14] + discovered S15
[S14] + discovered S17
[S14] + discovered S16
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S10
[S16] + discovered S7
[S16] + discovered S8
[S16] + discovered S11
[S16] + discovered S2
[S16] + discovered S15
[S16] + discovered S13
[S16] + discovered S3
[S16] + discovered S6
[S16] + discovered S9
[S16] + discovered S5
[S16] + discovered S14
[S16] + discovered S4
[S17] + discovered S4
[S17] + discovered S6
[S17] + discovered S15
[S17] + discovered S5
[S17] + discovered S13
[S17] + discovered S9
[S17] + discovered S14
[S17] + discovered S2
[S17] + discovered S3
[S17] + discovered S16
[S17] + discovered S7
[S17] + discovered S11
[S17] + discovered S8
[S17] + discovered S10
[S16] + discovered S17
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:52810
[S5] ⇄ pheromone p=1.000 → S11@127.0.0.1:52812
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:52815
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:52817
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:52817
[S2] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S11] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S3] ⇄ pheromone p=1.000 → S11@127.0.0.1:52812
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:52808
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:52814
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:52808
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:52817
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:52813
[S2] START round=1 head_norm_before_train=1.108458 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6637037483977466, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4956031030263366, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.208594 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5442375623716535, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4419048655106337, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.201481 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6143735814696947, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4383673725393498, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.165639 (no previous merge yet)
[S5] round=1 local utility u=0.352505 metrics={'f1_val': 0.2938890851289297, 'auprc': 0.2938890851289297, 'loss_val': 1.3728554498447134, 'psi': 0.2938890851289297}-{'f1_val': 0.21119338269628443, 'auprc': 0.21119338269628443, 'loss_val': 1.3336050481924606, 'psi': 0.21119338269628443}
[S6] START round=1 head_norm_before_train=1.235148 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.024001804565408, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5721907978346805, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.165497 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4674950248402998, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4216033817797287, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.209862 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6354757651460712, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4900221247864396, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.198047 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5328226642023481, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.44674459409261, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.122107 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5119750335510953, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.409238873874328, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.202848 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5377549962605297, 'psi': 0.0}-{'f1_val': 0.002574712643678161, 'auprc': 0.002574712643678161, 'loss_val': 1.4403028387282295, 'psi': 0.002574712643678161}
[S13] START round=1 head_norm_before_train=1.146215 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.496527255645083, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3724098357256056, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.131351 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5062445399575322, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4429115507588675, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.120145 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6587084112903818, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4951235199726274, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.271191 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.569213884247638, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4792152939178804, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.200478 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.610707408688409, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4474102892109952, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:52809
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S5
[S8] cosine check vs S5: cos=0.1284
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.0000 head_norm=1.250393
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.015439e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.0000 head_norm=0.911758 delta_norm=0.801544
[S8] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.147218 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3736296252288267, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6637037483977466, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.227987 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.755678367336208, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5442375623716535, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.255292 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.70716994008456, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6143735814696947, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.176464 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4513151637211752, 'psi': 0.0}-{'f1_val': 0.2938890851289297, 'auprc': 0.2938890851289297, 'loss_val': 1.3728554498447134, 'psi': 0.2938890851289297}
[S6] START round=2 head_norm_before_train=1.288077 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7348368711242386, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.024001804565408, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.184078 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5645160228359811, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4674950248402998, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=0.911758 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.820667018343358, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6354757651460712, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.212546 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6973384167774597, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5328226642023481, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.152114 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9130815411006052, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5119750335510953, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.219746 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7459783641008917, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5377549962605297, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.180582 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7592226916509868, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.496527255645083, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.150847 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6391439800472776, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5062445399575322, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.168185 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.042442944150937, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6587084112903818, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.287341 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.755636435863067, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.569213884247638, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.238105 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8700871931421301, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.610707408688409, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.213285 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9500503157160907, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3736296252288267, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.255796 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3010571453148936, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.755678367336208, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.299978 (no previous merge yet)
[S4] round=3 local utility u=0.135831 metrics={'f1_val': 0.0018700327255726974, 'auprc': 0.0018700327255726974, 'loss_val': 1.4523383896592577, 'psi': 0.0018700327255726974}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.70716994008456, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.198117 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6157166595046168, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4513151637211752, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.335770 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7491459589437293, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7348368711242386, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.211355 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8445400265273288, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5645160228359811, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=0.952273 cos_to_last_merge=0.9937 (last merge round=1)
[S8] round=3 local utility u=0.078821 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6630257997214037, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.820667018343358, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.238070 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0891042925085066, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6973384167774597, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.202438 (no previous merge yet)
[S10] round=3 local utility u=0.138563 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6359559623627016, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9130815411006052, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.246557 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2828185765792357, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7459783641008917, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.217644 (no previous merge yet)
[S13] round=3 local utility u=0.088070 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5830829495720438, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7592226916509868, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.181729 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0228074077797933, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6391439800472776, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.219392 (no previous merge yet)
[S15] round=3 local utility u=0.151839 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7387656581225233, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.042442944150937, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.318592 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2920933828941785, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.755636435863067, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.281333 (no previous merge yet)
[S17] round=3 local utility u=0.153396 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5632950809926587, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8700871931421301, 'psi': 0.0}
[S8] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.002)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=4 head_norm_before_train=1.272164 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.132163665028071, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9500503157160907, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.290683 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6835812380457464, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3010571453148936, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.325876 (no previous merge yet)
[S4] round=4 local utility u=1.000000 metrics={'f1_val': 0.2340270171595473, 'auprc': 0.2340270171595473, 'loss_val': 1.3318891242247655, 'psi': 0.2340270171595473}-{'f1_val': 0.0018700327255726974, 'auprc': 0.0018700327255726974, 'loss_val': 1.4523383896592577, 'psi': 0.0018700327255726974}
[S5] START round=4 head_norm_before_train=1.225126 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7315558160586249, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6157166595046168, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.368845 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.156997845987982, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7491459589437293, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.244965 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9966921820685837, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8445400265273288, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=0.977086 cos_to_last_merge=0.9864 (last merge round=1)
[S8] round=4 local utility u=1.000000 metrics={'f1_val': 0.3332277478618942, 'auprc': 0.3332277478618942, 'loss_val': 1.5218312010684822, 'psi': 0.3332277478618942}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6630257997214037, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.271560 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.812943457621386, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0891042925085066, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.215679 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.705980896942498, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6359559623627016, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.277012 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9413423038311564, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2828185765792357, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.228942 (no previous merge yet)
[S13] round=4 local utility u=0.030385 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5223125684676448, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5830829495720438, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.221215 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.80515778164823, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0228074077797933, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.232960 (no previous merge yet)
[S15] round=4 local utility u=0.012173 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.714418692548849, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7387656581225233, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.361146 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9598737389158005, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2920933828941785, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.317549 (no previous merge yet)
[S17] round=4 local utility u=0.092384 metrics={'f1_val': 0.0008493771234428086, 'auprc': 0.0008493771234428086, 'loss_val': 1.3861723530159535, 'psi': 0.0008493771234428086}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5632950809926587, 'psi': 0.0}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:52815
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.0535
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] cosine check vs S8: cos=-0.0356
[S15] DROPPED delta from S8 (cos=-0.0356 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.001)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.3332 head_norm=1.013806
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.306104e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.3328 head_norm=0.874212 delta_norm=0.830610
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.331293 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2957082047042117, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.132163665028071, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.314606 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6861207405643284, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6835812380457464, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.371320 (no previous merge yet)
[S4] round=5 local utility u=0.577463 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.281866188551966, 'psi': 0.3567939207526687}-{'f1_val': 0.2340270171595473, 'auprc': 0.2340270171595473, 'loss_val': 1.3318891242247655, 'psi': 0.2340270171595473}
[S5] START round=5 head_norm_before_train=1.242960 (no previous merge yet)
[S5] round=5 local utility u=0.022981 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6855930611449161, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7315558160586249, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.419100 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.61168695211695, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.156997845987982, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.261831 (no previous merge yet)
[S7] round=5 local utility u=0.046442 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.903807848024616, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9966921820685837, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=0.874212 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.22217532010693683, 'auprc': 0.22217532010693683, 'loss_val': 1.390171268999277, 'psi': 0.2221753201069368}-{'f1_val': 0.3332277478618942, 'auprc': 0.3332277478618942, 'loss_val': 1.5218312010684822, 'psi': 0.3332277478618942}
[S9] START round=5 head_norm_before_train=1.307181 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.940272195901822, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.812943457621386, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.254751 (no previous merge yet)
[S10] round=5 local utility u=1.000000 metrics={'f1_val': 0.2707919386886177, 'auprc': 0.2707919386886177, 'loss_val': 1.9315404625863182, 'psi': 0.2707919386886177}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.705980896942498, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.302861 (no previous merge yet)
[S11] round=5 local utility u=0.140606 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6601310513032104, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9413423038311564, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.252086 (no previous merge yet)
[S13] round=5 local utility u=0.930710 metrics={'f1_val': 0.1876839750382668, 'auprc': 0.1876839750382668, 'loss_val': 1.3500487451735572, 'psi': 0.1876839750382668}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5223125684676448, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.259387 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2924414277680865, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.80515778164823, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.273752 (no previous merge yet)
[S15] round=5 local utility u=0.148776 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4168670453292183, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.714418692548849, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.397776 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.008508397999561, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9598737389158005, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.371946 (no previous merge yet)
[S17] round=5 local utility u=0.491891 metrics={'f1_val': 0.10246865203761756, 'auprc': 0.10246865203761756, 'loss_val': 1.3169628934850441, 'psi': 0.10246865203761756}-{'f1_val': 0.0008493771234428086, 'auprc': 0.0008493771234428086, 'loss_val': 1.3861723530159535, 'psi': 0.0008493771234428086}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:52814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.188)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] cosine check vs S10: cos=0.0671
[S17] not sending this round → trigger blocked (psi=0.102)
[S13] ⇄ pheromone p=0.530 → S7@127.0.0.1:52808
[S5] ⇄ pheromone p=0.361 → S11@127.0.0.1:52812
[S7] ⇄ pheromone p=0.337 → S17@127.0.0.1:52817
[S6] ⇄ pheromone p=0.328 → S17@127.0.0.1:52817
[S11] ⇄ pheromone p=0.356 → S8@127.0.0.1:52809
[S3] ⇄ pheromone p=0.328 → S11@127.0.0.1:52812
[S2] ⇄ pheromone p=0.328 → S8@127.0.0.1:52809
[S15] ⇄ pheromone p=0.379 → S9@127.0.0.1:52810
[S8] ⇄ pheromone p=0.498 → S15@127.0.0.1:52815
[S4] ⇄ pheromone p=0.621 → S8@127.0.0.1:52809
[S9] ⇄ pheromone p=0.328 → S17@127.0.0.1:52817
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.0000 head_norm=1.287886
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.863177e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.0000 head_norm=0.947931 delta_norm=0.886318
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.328 → S8@127.0.0.1:52809
[S10] ⇄ pheromone p=0.545 → S14@127.0.0.1:52814
[S17] ⇄ pheromone p=0.460 → S13@127.0.0.1:52813
[S16] ⇄ pheromone p=0.328 → S7@127.0.0.1:52808
[S2] START round=6 head_norm_before_train=1.397203 (no previous merge yet)
[S2] round=6 local utility u=0.309189 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6773293828374647, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2957082047042117, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.335483 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7151849761805287, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6861207405643284, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.426119 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.1859364435429344, 'auprc': 0.1859364435429344, 'loss_val': 1.2911927968368258, 'psi': 0.1859364435429344}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.281866188551966, 'psi': 0.3567939207526687}
[S5] START round=6 head_norm_before_train=1.256935 (no previous merge yet)
[S5] round=6 local utility u=0.820680 metrics={'f1_val': 0.16484387383103502, 'auprc': 0.16484387383103502, 'loss_val': 1.527827308957107, 'psi': 0.16484387383103502}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6855930611449161, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.475058 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.636437625113802, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.61168695211695, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.267388 (no previous merge yet)
[S7] round=6 local utility u=0.039797 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8242144066723749, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.903807848024616, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=0.927569 cos_to_last_merge=0.9907 (last merge round=4)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.2036499645321468, 'auprc': 0.2036499645321468, 'loss_val': 1.3070961972218027, 'psi': 0.2036499645321468}-{'f1_val': 0.22217532010693683, 'auprc': 0.22217532010693683, 'loss_val': 1.390171268999277, 'psi': 0.2221753201069368}
[S9] START round=6 head_norm_before_train=1.330899 (no previous merge yet)
[S9] round=6 local utility u=0.079639 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7809948048577118, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.940272195901822, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.307523 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.2476477683956574, 'auprc': 0.2476477683956574, 'loss_val': 2.4797602543473936, 'psi': 0.24764776839565739}-{'f1_val': 0.2707919386886177, 'auprc': 0.2707919386886177, 'loss_val': 1.9315404625863182, 'psi': 0.2707919386886177}
[S11] START round=6 head_norm_before_train=1.317685 (no previous merge yet)
[S11] round=6 local utility u=0.112530 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4350714672672495, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6601310513032104, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.278043 (no previous merge yet)
[S13] round=6 local utility u=0.584527 metrics={'f1_val': 0.304002852812695, 'auprc': 0.304002852812695, 'loss_val': 1.227864571679143, 'psi': 0.304002852812695}-{'f1_val': 0.1876839750382668, 'auprc': 0.1876839750382668, 'loss_val': 1.3500487451735572, 'psi': 0.1876839750382668}
[S14] START round=6 head_norm_before_train=0.947931 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.447199 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3980441761447975, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2924414277680865, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.322355 (no previous merge yet)
[S15] round=6 local utility u=1.000000 metrics={'f1_val': 0.24654989384288747, 'auprc': 0.24654989384288747, 'loss_val': 1.2994879795251133, 'psi': 0.24654989384288747}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4168670453292183, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.424076 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1613439317690406, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.008508397999561, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.421344 (no previous merge yet)
[S17] round=6 local utility u=0.285922 metrics={'f1_val': 0.16381647549530762, 'auprc': 0.16381647549530762, 'loss_val': 1.2972494105732892, 'psi': 0.16381647549530762}-{'f1_val': 0.10246865203761756, 'auprc': 0.10246865203761756, 'loss_val': 1.3169628934850441, 'psi': 0.10246865203761756}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[S5] not sending this round → trigger blocked (psi=0.165)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:52810
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=-0.0557
[S9] DROPPED delta from S15 (cos=-0.0557 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=0.0268
[S17] not sending this round → trigger blocked (psi=0.164)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.0000 head_norm=1.275592
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.032521e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.2154 head_norm=0.927772 delta_norm=0.903252
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.446190 (no previous merge yet)
[S2] round=7 local utility u=0.123593 metrics={'f1_val': 0.06254698541572697, 'auprc': 0.06254698541572697, 'loss_val': 2.99306693041143, 'psi': 0.06254698541572697}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6773293828374647, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.360786 (no previous merge yet)
[S3] round=7 local utility u=0.123040 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4691055053345337, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7151849761805287, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.489070 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.0003762227238525207, 'auprc': 0.0003762227238525207, 'loss_val': 1.329885877884474, 'psi': 0.0003762227238525207}-{'f1_val': 0.1859364435429344, 'auprc': 0.1859364435429344, 'loss_val': 1.2911927968368258, 'psi': 0.1859364435429344}
[S5] START round=7 head_norm_before_train=1.264985 (no previous merge yet)
[S5] round=7 local utility u=0.807275 metrics={'f1_val': 0.3328060740272066, 'auprc': 0.3328060740272066, 'loss_val': 1.4249370674892015, 'psi': 0.3328060740272066}-{'f1_val': 0.16484387383103502, 'auprc': 0.16484387383103502, 'loss_val': 1.527827308957107, 'psi': 0.16484387383103502}
[S6] START round=7 head_norm_before_train=1.529156 (no previous merge yet)
[S6] round=7 local utility u=0.815461 metrics={'f1_val': 0.08910306845003933, 'auprc': 0.08910306845003933, 'loss_val': 2.8074435629702834, 'psi': 0.08910306845003933}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.636437625113802, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=0.927772 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.706104 metrics={'f1_val': 0.13203684749232344, 'auprc': 0.13203684749232344, 'loss_val': 1.6003385662828329, 'psi': 0.13203684749232344}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8242144066723749, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.012461 cos_to_last_merge=0.9628 (last merge round=4)
[S8] round=7 local utility u=0.478618 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.26256735907951, 'psi': 0.30506182380216385}-{'f1_val': 0.2036499645321468, 'auprc': 0.2036499645321468, 'loss_val': 1.3070961972218027, 'psi': 0.2036499645321468}
[S9] START round=7 head_norm_before_train=1.353925 (no previous merge yet)
[S9] round=7 local utility u=0.076918 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6271587423698386, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7809948048577118, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.363189 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.21144827586206896, 'auprc': 0.21144827586206896, 'loss_val': 2.84099985949438, 'psi': 0.21144827586206894}-{'f1_val': 0.2476477683956574, 'auprc': 0.2476477683956574, 'loss_val': 2.4797602543473936, 'psi': 0.24764776839565739}
[S11] START round=7 head_norm_before_train=1.335658 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5324473486893107, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4350714672672495, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.313818 (no previous merge yet)
[S13] round=7 local utility u=0.180366 metrics={'f1_val': 0.3332514131236176, 'auprc': 0.3332514131236176, 'loss_val': 1.1303696900282856, 'psi': 0.3332514131236176}-{'f1_val': 0.304002852812695, 'auprc': 0.304002852812695, 'loss_val': 1.227864571679143, 'psi': 0.304002852812695}
[S14] START round=7 head_norm_before_train=0.970166 cos_to_last_merge=0.9981 (last merge round=5)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6847006525308466, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3980441761447975, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.384393 (no previous merge yet)
[S15] round=7 local utility u=0.185282 metrics={'f1_val': 0.2776753900970635, 'auprc': 0.2776753900970635, 'loss_val': 1.2090535728128629, 'psi': 0.2776753900970635}-{'f1_val': 0.24654989384288747, 'auprc': 0.24654989384288747, 'loss_val': 1.2994879795251133, 'psi': 0.24654989384288747}
[S16] START round=7 head_norm_before_train=1.451240 (no previous merge yet)
[S16] round=7 local utility u=0.011506 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.138331894294494, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1613439317690406, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.459433 (no previous merge yet)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.15338801015426676, 'auprc': 0.15338801015426676, 'loss_val': 1.3342839870192862, 'psi': 0.15338801015426676}-{'f1_val': 0.16381647549530762, 'auprc': 0.16381647549530762, 'loss_val': 1.2972494105732892, 'psi': 0.16381647549530762}
[S7] not sending this round → trigger blocked (psi=0.132)
[S2] not sending this round → trigger blocked (psi=0.063)
[S13] not sending this round → trigger blocked (psi=0.333)
[S3] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:52815
[S6] not sending this round → trigger blocked (psi=0.089)
[S16] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:52812
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.278)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.0015
[S11] RECEIVED delta(kind=head bytes=1794) from S5
[S11] cosine check vs S5: cos=0.0111
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.0000 head_norm=1.359526
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.271561e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.0000 head_norm=0.937500 delta_norm=0.927156
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.2777 head_norm=1.445930
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.030945e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.3330 head_norm=0.904430 delta_norm=0.903094
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.499311 (no previous merge yet)
[S2] round=8 local utility u=1.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.1674682163702723, 'psi': 0.3674775928297055}-{'f1_val': 0.06254698541572697, 'auprc': 0.06254698541572697, 'loss_val': 2.99306693041143, 'psi': 0.06254698541572697}
[S3] START round=8 head_norm_before_train=1.388124 (no previous merge yet)
[S3] round=8 local utility u=0.008677 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4517522486009127, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4691055053345337, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.554446 (no previous merge yet)
[S4] round=8 local utility u=0.753191 metrics={'f1_val': 0.16444161898707352, 'auprc': 0.16444161898707352, 'loss_val': 1.3000934067490586, 'psi': 0.16444161898707352}-{'f1_val': 0.0003762227238525207, 'auprc': 0.0003762227238525207, 'loss_val': 1.329885877884474, 'psi': 0.0003762227238525207}
[S5] START round=8 head_norm_before_train=1.276220 (no previous merge yet)
[S5] round=8 local utility u=0.307122 metrics={'f1_val': 0.3950078094670603, 'auprc': 0.3950078094670603, 'loss_val': 1.3705084376053527, 'psi': 0.3950078094670603}-{'f1_val': 0.3328060740272066, 'auprc': 0.3328060740272066, 'loss_val': 1.4249370674892015, 'psi': 0.3328060740272066}
[S6] START round=8 head_norm_before_train=1.575122 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 3.5136916090278754, 'psi': 0.017551963048498844}-{'f1_val': 0.08910306845003933, 'auprc': 0.08910306845003933, 'loss_val': 2.8074435629702834, 'psi': 0.08910306845003933}
[S7] START round=8 head_norm_before_train=0.942759 cos_to_last_merge=0.9990 (last merge round=6)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8187660750292418, 'psi': 0.0}-{'f1_val': 0.13203684749232344, 'auprc': 0.13203684749232344, 'loss_val': 1.6003385662828329, 'psi': 0.13203684749232344}
[S8] START round=8 head_norm_before_train=1.084634 cos_to_last_merge=0.9385 (last merge round=4)
[S8] ⚠️ Model drifted since last merge! cos=0.938
[S8] round=8 local utility u=0.036364 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1898387002150697, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.26256735907951, 'psi': 0.30506182380216385}
[S9] START round=8 head_norm_before_train=1.383254 (no previous merge yet)
[S9] round=8 local utility u=0.030491 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5661759893919305, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6271587423698386, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.423622 (no previous merge yet)
[S10] round=8 local utility u=0.183325 metrics={'f1_val': 0.24728195216235807, 'auprc': 0.24728195216235807, 'loss_val': 2.7968530722954723, 'psi': 0.24728195216235807}-{'f1_val': 0.21144827586206896, 'auprc': 0.21144827586206896, 'loss_val': 2.84099985949438, 'psi': 0.21144827586206894}
[S11] START round=8 head_norm_before_train=0.937500 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.298528 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9353908605034864, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5324473486893107, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.355209 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.3006651884700665, 'auprc': 0.3006651884700665, 'loss_val': 1.0717286717198031, 'psi': 0.3006651884700665}-{'f1_val': 0.3332514131236176, 'auprc': 0.3332514131236176, 'loss_val': 1.1303696900282856, 'psi': 0.3332514131236176}
[S14] START round=8 head_norm_before_train=0.998728 cos_to_last_merge=0.9937 (last merge round=5)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2047907568207, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6847006525308466, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=0.904430 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.275295 metrics={'f1_val': 0.33301717778480344, 'auprc': 0.33301717778480344, 'loss_val': 1.1565402052443725, 'psi': 0.33301717778480344}-{'f1_val': 0.2776753900970635, 'auprc': 0.2776753900970635, 'loss_val': 1.2090535728128629, 'psi': 0.2776753900970635}
[S16] START round=8 head_norm_before_train=1.479336 (no previous merge yet)
[S16] round=8 local utility u=0.172061 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.794209705205804, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.138331894294494, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.490277 (no previous merge yet)
[S17] round=8 local utility u=0.050895 metrics={'f1_val': 0.15529853697113483, 'auprc': 0.15529853697113483, 'loss_val': 1.2496892717351624, 'psi': 0.15529853697113483}-{'f1_val': 0.15338801015426676, 'auprc': 0.15338801015426676, 'loss_val': 1.3342839870192862, 'psi': 0.15338801015426676}
[S3] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.395)
[S8] not sending this round → trigger blocked (psi=0.305)
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:52810
[S16] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.6583
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] cosine check vs S15: cos=-0.0816
[S9] DROPPED delta from S15 (cos=-0.0816 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=-0.0425
[S8] DROPPED delta from S2 (cos=-0.0425 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] cosine check vs S4: cos=0.6635
[S17] not sending this round → trigger blocked (psi=0.155)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.0000 head_norm=1.033129
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.603223e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.151221 delta_norm=0.560322
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3051 head_norm=1.126928
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.045389e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.2036 head_norm=1.254028 delta_norm=0.604539
[S8] aggregate: ROLLBACK (f1_val pre=0.305 post=0.204 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=1.542540 (no previous merge yet)
[S2] round=9 local utility u=0.013434 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.1405998849337107, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.1674682163702723, 'psi': 0.3674775928297055}
[S3] START round=9 head_norm_before_train=1.420238 (no previous merge yet)
[S3] round=9 local utility u=0.006572 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.438608951184287, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4517522486009127, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.614355 (no previous merge yet)
[S4] round=9 local utility u=0.866805 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2976536388645428, 'psi': 0.3567939207526687}-{'f1_val': 0.16444161898707352, 'auprc': 0.16444161898707352, 'loss_val': 1.3000934067490586, 'psi': 0.16444161898707352}
[S5] START round=9 head_norm_before_train=1.294487 (no previous merge yet)
[S5] round=9 local utility u=1.000000 metrics={'f1_val': 0.7576251090800872, 'auprc': 0.7576251090800872, 'loss_val': 1.2799606811371933, 'psi': 0.7576251090800872}-{'f1_val': 0.3950078094670603, 'auprc': 0.3950078094670603, 'loss_val': 1.3705084376053527, 'psi': 0.3950078094670603}
[S6] START round=9 head_norm_before_train=1.608053 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.03803626713843432, 'auprc': 0.03803626713843432, 'loss_val': 4.0406033548625855, 'psi': 0.03803626713843432}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 3.5136916090278754, 'psi': 0.017551963048498844}
[S7] START round=9 head_norm_before_train=0.972270 cos_to_last_merge=0.9937 (last merge round=6)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9347244247104451, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8187660750292418, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.254028 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.190464794450607, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1898387002150697, 'psi': 0.30506182380216385}
[S9] START round=9 head_norm_before_train=1.418164 (no previous merge yet)
[S9] round=9 local utility u=0.051051 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.46407408517045, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5661759893919305, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.487006 (no previous merge yet)
[S10] round=9 local utility u=0.079838 metrics={'f1_val': 0.2497010284620904, 'auprc': 0.2497010284620904, 'loss_val': 2.6589496852063257, 'psi': 0.2497010284620904}-{'f1_val': 0.24728195216235807, 'auprc': 0.24728195216235807, 'loss_val': 2.7968530722954723, 'psi': 0.24728195216235807}
[S11] START round=9 head_norm_before_train=0.965507 cos_to_last_merge=0.9977 (last merge round=7)
[S11] round=9 local utility u=0.113624 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7081426061027287, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9353908605034864, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.395317 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.2482152663371774, 'auprc': 0.2482152663371774, 'loss_val': 1.0596473356148437, 'psi': 0.2482152663371774}-{'f1_val': 0.3006651884700665, 'auprc': 0.3006651884700665, 'loss_val': 1.0717286717198031, 'psi': 0.3006651884700665}
[S14] START round=9 head_norm_before_train=1.151221 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.386252 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4322869610086433, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2047907568207, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=0.987823 cos_to_last_merge=0.9921 (last merge round=7)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.26092528514673846, 'auprc': 0.26092528514673846, 'loss_val': 1.1317880273535508, 'psi': 0.26092528514673846}-{'f1_val': 0.33301717778480344, 'auprc': 0.33301717778480344, 'loss_val': 1.1565402052443725, 'psi': 0.33301717778480344}
[S16] START round=9 head_norm_before_train=1.508901 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8947745590849796, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.794209705205804, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.505844 (no previous merge yet)
[S17] round=9 local utility u=0.031471 metrics={'f1_val': 0.15747794707297513, 'auprc': 0.15747794707297513, 'loss_val': 1.2063621611223134, 'psi': 0.15747794707297513}-{'f1_val': 0.15529853697113483, 'auprc': 0.15529853697113483, 'loss_val': 1.2496892717351624, 'psi': 0.15529853697113483}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.250)
[S4] not sending this round → trigger blocked (psi=0.357)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.367)
[S5] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=0.6408
[S17] not sending this round → trigger blocked (psi=0.157)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.0000 head_norm=1.004042
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.094752e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.049929 delta_norm=0.509475
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.580501 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.24118190212373036, 'auprc': 0.24118190212373036, 'loss_val': 2.320844622078897, 'psi': 0.24118190212373036}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.1405998849337107, 'psi': 0.3674775928297055}
[S3] START round=10 head_norm_before_train=1.451231 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6142803578712135, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.438608951184287, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.675755 (no previous merge yet)
[S4] round=10 local utility u=0.001924 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2938058986346974, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2976536388645428, 'psi': 0.3567939207526687}
[S5] START round=10 head_norm_before_train=1.309859 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.3607284963196635, 'auprc': 0.3607284963196635, 'loss_val': 1.2316015967401108, 'psi': 0.3607284963196635}-{'f1_val': 0.7576251090800872, 'auprc': 0.7576251090800872, 'loss_val': 1.2799606811371933, 'psi': 0.7576251090800872}
[S6] START round=10 head_norm_before_train=1.643131 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.05609859753506162, 'auprc': 0.05609859753506162, 'loss_val': 4.563335141768552, 'psi': 0.05609859753506162}-{'f1_val': 0.03803626713843432, 'auprc': 0.03803626713843432, 'loss_val': 4.0406033548625855, 'psi': 0.03803626713843432}
[S7] START round=10 head_norm_before_train=0.995900 cos_to_last_merge=0.9883 (last merge round=6)
[S7] round=10 local utility u=0.139259 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6562073280157483, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9347244247104451, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.307339 cos_to_last_merge=0.9970 (last merge round=8)
[S8] round=10 local utility u=0.036243 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1179787704491215, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.190464794450607, 'psi': 0.30506182380216385}
[S9] START round=10 head_norm_before_train=1.454215 (no previous merge yet)
[S9] round=10 local utility u=0.091786 metrics={'f1_val': 0.00023854961832061068, 'auprc': 0.00023854961832061068, 'loss_val': 2.282648843314641, 'psi': 0.00023854961832061065}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.46407408517045, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.543455 (no previous merge yet)
[S10] round=10 local utility u=0.054749 metrics={'f1_val': 0.24976099426386233, 'auprc': 0.24976099426386233, 'loss_val': 2.5499921901028317, 'psi': 0.24976099426386233}-{'f1_val': 0.2497010284620904, 'auprc': 0.2497010284620904, 'loss_val': 2.6589496852063257, 'psi': 0.2497010284620904}
[S11] START round=10 head_norm_before_train=1.049929 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.021932 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6642794368310445, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7081426061027287, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.442157 (no previous merge yet)
[S13] round=10 local utility u=0.003102 metrics={'f1_val': 0.24735497993433053, 'auprc': 0.24735497993433053, 'loss_val': 1.0457001855743595, 'psi': 0.24735497993433053}-{'f1_val': 0.2482152663371774, 'auprc': 0.2482152663371774, 'loss_val': 1.0596473356148437, 'psi': 0.2482152663371774}
[S14] START round=10 head_norm_before_train=1.168372 cos_to_last_merge=0.9986 (last merge round=8)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.893381770683226, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4322869610086433, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.086517 cos_to_last_merge=0.9731 (last merge round=7)
[S15] round=10 local utility u=0.092644 metrics={'f1_val': 0.2711144427786107, 'auprc': 0.2711144427786107, 'loss_val': 1.0382033409698153, 'psi': 0.2711144427786107}-{'f1_val': 0.26092528514673846, 'auprc': 0.26092528514673846, 'loss_val': 1.1317880273535508, 'psi': 0.26092528514673846}
[S16] START round=10 head_norm_before_train=1.542133 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2683692380456866, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8947745590849796, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.532909 (no previous merge yet)
[S17] round=10 local utility u=0.031839 metrics={'f1_val': 0.15641178813221823, 'auprc': 0.15641178813221823, 'loss_val': 1.133088151110486, 'psi': 0.15641178813221823}-{'f1_val': 0.15747794707297513, 'auprc': 0.15747794707297513, 'loss_val': 1.2063621611223134, 'psi': 0.15747794707297513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:52814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:52810
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:52815
[S11] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.4046
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=-0.0556
[S9] DROPPED delta from S15 (cos=-0.0556 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.8824
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=0.6662
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] cosine check vs S10: cos=0.8982
[S17] not sending this round → trigger blocked (psi=0.156)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.0000 head_norm=1.004881
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.551712e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.2921 head_norm=1.142344 delta_norm=0.555171
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.214 → S17@127.0.0.1:52817
[S6] ⇄ pheromone p=0.191 → S17@127.0.0.1:52817
[S11] ⇄ pheromone p=0.187 → S8@127.0.0.1:52809
[S9] ⇄ pheromone p=0.152 → S17@127.0.0.1:52817
[S3] ⇄ pheromone p=0.122 → S11@127.0.0.1:52812
[S2] ⇄ pheromone p=0.276 → S8@127.0.0.1:52809
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.0000 head_norm=1.193933
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.712019e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.360429 delta_norm=0.371202
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.206 → S8@127.0.0.1:52809
[S5] ⇄ pheromone p=0.468 → S11@127.0.0.1:52812
[S10] ⇄ pheromone p=0.226 → S14@127.0.0.1:52814
[S13] ⇄ pheromone p=0.241 → S7@127.0.0.1:52808
[S4] ⇄ pheromone p=0.439 → S8@127.0.0.1:52809
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.3051 head_norm=1.386573
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.124258e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3051 head_norm=1.511573 delta_norm=0.412426
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.224 → S15@127.0.0.1:52815
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.2711 head_norm=1.173442
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.040668e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.2835 head_norm=1.074275 delta_norm=0.704067
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.279 → S9@127.0.0.1:52810
[S16] ⇄ pheromone p=0.131 → S7@127.0.0.1:52808
[S17] ⇄ pheromone p=0.192 → S13@127.0.0.1:52813
[S2] START round=11 head_norm_before_train=1.619933 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.2421898975019947, 'auprc': 0.2421898975019947, 'loss_val': 2.437621972558019, 'psi': 0.2421898975019947}-{'f1_val': 0.24118190212373036, 'auprc': 0.24118190212373036, 'loss_val': 2.320844622078897, 'psi': 0.24118190212373036}
[S3] START round=11 head_norm_before_train=1.481320 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.688308542655563, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6142803578712135, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.728384 (no previous merge yet)
[S4] round=11 local utility u=0.010121 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.273564492807924, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2938058986346974, 'psi': 0.3567939207526687}
[S5] START round=11 head_norm_before_train=1.333987 (no previous merge yet)
[S5] round=11 local utility u=0.018043 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1830102289702034, 'psi': 0.35933890172383154}-{'f1_val': 0.3607284963196635, 'auprc': 0.3607284963196635, 'loss_val': 1.2316015967401108, 'psi': 0.3607284963196635}
[S6] START round=11 head_norm_before_train=1.682461 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.029504504504504505, 'auprc': 0.029504504504504505, 'loss_val': 5.257493019619413, 'psi': 0.029504504504504505}-{'f1_val': 0.05609859753506162, 'auprc': 0.05609859753506162, 'loss_val': 4.563335141768552, 'psi': 0.05609859753506162}
[S7] START round=11 head_norm_before_train=1.142344 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=1.000000 metrics={'f1_val': 0.32144429766622634, 'auprc': 0.32144429766622634, 'loss_val': 1.5058114853228017, 'psi': 0.32144429766622634}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6562073280157483, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.511573 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.251592 metrics={'f1_val': 0.3584804708400214, 'auprc': 0.3584804708400214, 'loss_val': 1.0955618775839677, 'psi': 0.3584804708400214}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1179787704491215, 'psi': 0.30506182380216385}
[S9] START round=11 head_norm_before_train=1.489007 (no previous merge yet)
[S9] round=11 local utility u=0.727647 metrics={'f1_val': 0.13451511991657977, 'auprc': 0.13451511991657977, 'loss_val': 2.0358443317201167, 'psi': 0.13451511991657977}-{'f1_val': 0.00023854961832061068, 'auprc': 0.00023854961832061068, 'loss_val': 2.282648843314641, 'psi': 0.00023854961832061065}
[S10] START round=11 head_norm_before_train=1.597386 (no previous merge yet)
[S10] round=11 local utility u=0.408604 metrics={'f1_val': 0.33301481127568083, 'auprc': 0.33301481127568083, 'loss_val': 2.4820693864887886, 'psi': 0.33301481127568083}-{'f1_val': 0.24976099426386233, 'auprc': 0.24976099426386233, 'loss_val': 2.5499921901028317, 'psi': 0.24976099426386233}
[S11] START round=11 head_norm_before_train=1.075322 cos_to_last_merge=0.9968 (last merge round=9)
[S11] round=11 local utility u=0.008356 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6475677110830127, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6642794368310445, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.488806 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.2487616951018162, 'auprc': 0.2487616951018162, 'loss_val': 1.0709406640368562, 'psi': 0.2487616951018162}-{'f1_val': 0.24735497993433053, 'auprc': 0.24735497993433053, 'loss_val': 1.0457001855743595, 'psi': 0.24735497993433053}
[S14] START round=11 head_norm_before_train=1.360429 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.117749 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6578833051047472, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.893381770683226, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.074275 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.060890 metrics={'f1_val': 0.2800976800976801, 'auprc': 0.2800976800976801, 'loss_val': 0.9972731441033514, 'psi': 0.2800976800976801}-{'f1_val': 0.2711144427786107, 'auprc': 0.2711144427786107, 'loss_val': 1.0382033409698153, 'psi': 0.2711144427786107}
[S16] START round=11 head_norm_before_train=1.571050 (no previous merge yet)
[S16] round=11 local utility u=0.217125 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8341185031472027, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2683692380456866, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.558236 (no previous merge yet)
[S17] round=11 local utility u=0.048767 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 0.9989682359111098, 'psi': 0.15234678044996122}-{'f1_val': 0.15641178813221823, 'auprc': 0.15641178813221823, 'loss_val': 1.133088151110486, 'psi': 0.15641178813221823}
[S11] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.357)
[S15] not sending this round → trigger blocked (psi=0.280)
[S16] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.135)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:52812
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.333)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:52817
[S8] not sending this round → trigger blocked (psi=0.358)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=-0.0413
[S17] DROPPED delta from S7 (cos=-0.0413 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] cosine check vs S5: cos=0.8813
[S17] not sending this round → trigger blocked (psi=0.152)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.0000 head_norm=1.111272
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.231044e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.196761 delta_norm=0.323104
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.659303 (no previous merge yet)
[S2] round=12 local utility u=0.538521 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.488168581010334, 'psi': 0.3674775928297055}-{'f1_val': 0.2421898975019947, 'auprc': 0.2421898975019947, 'loss_val': 2.437621972558019, 'psi': 0.2421898975019947}
[S3] START round=12 head_norm_before_train=1.506838 (no previous merge yet)
[S3] round=12 local utility u=0.168316 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.351677059677787, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.688308542655563, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.770689 (no previous merge yet)
[S4] round=12 local utility u=0.007061 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2594421567528868, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.273564492807924, 'psi': 0.3567939207526687}
[S5] START round=12 head_norm_before_train=1.355855 (no previous merge yet)
[S5] round=12 local utility u=0.017628 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1477547749195025, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1830102289702034, 'psi': 0.35933890172383154}
[S6] START round=12 head_norm_before_train=1.716223 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.0016698473282442748, 'auprc': 0.0016698473282442748, 'loss_val': 5.858619601068918, 'psi': 0.0016698473282442746}-{'f1_val': 0.029504504504504505, 'auprc': 0.029504504504504505, 'loss_val': 5.257493019619413, 'psi': 0.029504504504504505}
[S7] START round=12 head_norm_before_train=1.158049 cos_to_last_merge=0.9992 (last merge round=10)
[S7] round=12 local utility u=0.046468 metrics={'f1_val': 0.33312074829931976, 'auprc': 0.33312074829931976, 'loss_val': 1.517964386789549, 'psi': 0.33312074829931976}-{'f1_val': 0.32144429766622634, 'auprc': 0.32144429766622634, 'loss_val': 1.5058114853228017, 'psi': 0.32144429766622634}
[S8] START round=12 head_norm_before_train=1.575941 cos_to_last_merge=0.9966 (last merge round=10)
[S8] round=12 local utility u=0.046117 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0115536750495069, 'psi': 0.35939447907390915}-{'f1_val': 0.3584804708400214, 'auprc': 0.3584804708400214, 'loss_val': 1.0955618775839677, 'psi': 0.3584804708400214}
[S9] START round=12 head_norm_before_train=1.522256 (no previous merge yet)
[S9] round=12 local utility u=0.445723 metrics={'f1_val': 0.21923351582956438, 'auprc': 0.21923351582956438, 'loss_val': 1.906864462294238, 'psi': 0.21923351582956438}-{'f1_val': 0.13451511991657977, 'auprc': 0.13451511991657977, 'loss_val': 2.0358443317201167, 'psi': 0.13451511991657977}
[S10] START round=12 head_norm_before_train=1.634698 (no previous merge yet)
[S10] round=12 local utility u=0.035218 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4116339664695086, 'psi': 0.33301496338745623}-{'f1_val': 0.33301481127568083, 'auprc': 0.33301481127568083, 'loss_val': 2.4820693864887886, 'psi': 0.33301481127568083}
[S11] START round=12 head_norm_before_train=1.196761 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7073296493337875, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6475677110830127, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.525714 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.24051081943951758, 'auprc': 0.24051081943951758, 'loss_val': 1.1832484177561076, 'psi': 0.24051081943951758}-{'f1_val': 0.2487616951018162, 'auprc': 0.2487616951018162, 'loss_val': 1.0709406640368562, 'psi': 0.2487616951018162}
[S14] START round=12 head_norm_before_train=1.379456 cos_to_last_merge=0.9981 (last merge round=10)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1461039695336432, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6578833051047472, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.139635 cos_to_last_merge=0.9933 (last merge round=10)
[S15] round=12 local utility u=0.073446 metrics={'f1_val': 0.28318798449612403, 'auprc': 0.28318798449612403, 'loss_val': 0.8781939318536545, 'psi': 0.28318798449612403}-{'f1_val': 0.2800976800976801, 'auprc': 0.2800976800976801, 'loss_val': 0.9972731441033514, 'psi': 0.2800976800976801}
[S16] START round=12 head_norm_before_train=1.598347 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3035453029960107, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8341185031472027, 'psi': 0.0}
[S17] START round=12 head_norm_before_train=1.586737 (no previous merge yet)
[S17] round=12 local utility u=0.253047 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9484973524411917, 'psi': 0.20297157622739018}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 0.9989682359111098, 'psi': 0.15234678044996122}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:52815
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:52814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[S5] not sending this round → trigger blocked (psi=0.359)
[S7] not sending this round → trigger blocked (psi=0.333)
[S4] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] cosine check vs S10: cos=0.9522
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] cosine check vs S15: cos=-0.0599
[S9] DROPPED delta from S15 (cos=-0.0599 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S4
[S8] cosine check vs S4: cos=0.9381
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=-0.0709
[S8] DROPPED delta from S2 (cos=-0.0709 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=-0.0381
[S17] DROPPED delta from S9 (cos=-0.0381 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.7348
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=-0.0299
[S13] DROPPED delta from S17 (cos=-0.0299 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.0000 head_norm=1.406401
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.699605e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.517910 delta_norm=0.269960
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.3594 head_norm=1.646316
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.150789e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.3594 head_norm=1.702457 delta_norm=0.315079
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.2832 head_norm=1.207975
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.583367e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6166 head_norm=1.331555 delta_norm=0.558337
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.691380 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5584380135123235, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.488168581010334, 'psi': 0.3674775928297055}
[S3] START round=13 head_norm_before_train=1.531377 (no previous merge yet)
[S3] round=13 local utility u=1.000000 metrics={'f1_val': 0.2856602345819145, 'auprc': 0.2856602345819145, 'loss_val': 2.428740666495831, 'psi': 0.2856602345819145}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.351677059677787, 'psi': 0.0}
[S4] START round=13 head_norm_before_train=1.812433 (no previous merge yet)
[S4] round=13 local utility u=0.009016 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.241410335592887, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2594421567528868, 'psi': 0.3567939207526687}
[S5] START round=13 head_norm_before_train=1.381418 (no previous merge yet)
[S5] round=13 local utility u=0.069234 metrics={'f1_val': 0.37173503946376896, 'auprc': 0.37173503946376896, 'loss_val': 1.1208514707216202, 'psi': 0.37173503946376896}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1477547749195025, 'psi': 0.35933890172383154}
[S6] START round=13 head_norm_before_train=1.739521 (no previous merge yet)
[S6] round=13 local utility u=0.162231 metrics={'f1_val': 0.02327704244637152, 'auprc': 0.02327704244637152, 'loss_val': 5.728622824516192, 'psi': 0.02327704244637152}-{'f1_val': 0.0016698473282442748, 'auprc': 0.0016698473282442748, 'loss_val': 5.858619601068918, 'psi': 0.0016698473282442746}
[S7] START round=13 head_norm_before_train=1.182402 cos_to_last_merge=0.9959 (last merge round=10)
[S7] round=13 local utility u=0.020131 metrics={'f1_val': 0.3330145574327914, 'auprc': 0.3330145574327914, 'loss_val': 1.4767475940274801, 'psi': 0.3330145574327914}-{'f1_val': 0.33312074829931976, 'auprc': 0.33312074829931976, 'loss_val': 1.517964386789549, 'psi': 0.33312074829931976}
[S8] START round=13 head_norm_before_train=1.702457 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000267 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0110190885290629, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0115536750495069, 'psi': 0.35939447907390915}
[S9] START round=13 head_norm_before_train=1.555113 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.21579743008314436, 'auprc': 0.21579743008314436, 'loss_val': 2.009485742337837, 'psi': 0.21579743008314436}-{'f1_val': 0.21923351582956438, 'auprc': 0.21923351582956438, 'loss_val': 1.906864462294238, 'psi': 0.21923351582956438}
[S10] START round=13 head_norm_before_train=1.666102 (no previous merge yet)
[S10] round=13 local utility u=0.037411 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.336811174388452, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.4116339664695086, 'psi': 0.33301496338745623}
[S11] START round=13 head_norm_before_train=1.221231 cos_to_last_merge=0.9976 (last merge round=11)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9141437105409544, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7073296493337875, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.560102 (no previous merge yet)
[S13] round=13 local utility u=0.002228 metrics={'f1_val': 0.24038291083141286, 'auprc': 0.24038291083141286, 'loss_val': 1.1776421663089083, 'psi': 0.24038291083141286}-{'f1_val': 0.24051081943951758, 'auprc': 0.24051081943951758, 'loss_val': 1.1832484177561076, 'psi': 0.24051081943951758}
[S14] START round=13 head_norm_before_train=1.517910 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.075159 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9957854219172875, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1461039695336432, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.331555 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=1.000000 metrics={'f1_val': 0.6143972677974848, 'auprc': 0.6143972677974848, 'loss_val': 0.8787895929768459, 'psi': 0.6143972677974848}-{'f1_val': 0.28318798449612403, 'auprc': 0.28318798449612403, 'loss_val': 0.8781939318536545, 'psi': 0.28318798449612403}
[S16] START round=13 head_norm_before_train=1.620616 (no previous merge yet)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.412869996751233, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3035453029960107, 'psi': 0.0}
[S17] START round=13 head_norm_before_train=1.629676 (no previous merge yet)
[S17] round=13 local utility u=0.013222 metrics={'f1_val': 0.20368209516400881, 'auprc': 0.20368209516400881, 'loss_val': 0.9284480170402536, 'psi': 0.20368209516400881}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9484973524411917, 'psi': 0.20297157622739018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:52817
[S4] not sending this round → trigger blocked (psi=0.357)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.614)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[S8] not sending this round → trigger blocked (psi=0.359)
[S6] not sending this round → trigger blocked (psi=0.023)
[S10] not sending this round → trigger blocked (psi=0.333)
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[S5] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S13
[S7] cosine check vs S13: cos=0.9062
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] cosine check vs S5: cos=0.9416
[S17] RECEIVED delta(kind=head bytes=1790) from S7
[S17] cosine check vs S7: cos=-0.0371
[S17] DROPPED delta from S7 (cos=-0.0371 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.1020
[S17] not sending this round → trigger blocked (psi=0.204)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.0000 head_norm=1.253529
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.818128e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.078203 delta_norm=0.481813
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.3330 head_norm=1.206168
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.554263e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.3331 head_norm=1.364664 delta_norm=0.355426
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.719180 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6150643274606233, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5584380135123235, 'psi': 0.3674775928297055}
[S3] START round=14 head_norm_before_train=1.555496 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.2947582133628645, 'auprc': 0.2947582133628645, 'loss_val': 2.7232307239588454, 'psi': 0.2947582133628645}-{'f1_val': 0.2856602345819145, 'auprc': 0.2856602345819145, 'loss_val': 2.428740666495831, 'psi': 0.2856602345819145}
[S4] START round=14 head_norm_before_train=1.851343 (no previous merge yet)
[S4] round=14 local utility u=0.011255 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2189009877638959, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.241410335592887, 'psi': 0.3567939207526687}
[S5] START round=14 head_norm_before_train=1.408089 (no previous merge yet)
[S5] round=14 local utility u=1.000000 metrics={'f1_val': 0.6008171840446122, 'auprc': 0.6008171840446122, 'loss_val': 1.0917149955218666, 'psi': 0.6008171840446122}-{'f1_val': 0.37173503946376896, 'auprc': 0.37173503946376896, 'loss_val': 1.1208514707216202, 'psi': 0.37173503946376896}
[S6] START round=14 head_norm_before_train=1.757391 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 5.854632701614436, 'psi': 0.02262340036563071}-{'f1_val': 0.02327704244637152, 'auprc': 0.02327704244637152, 'loss_val': 5.728622824516192, 'psi': 0.02327704244637152}
[S7] START round=14 head_norm_before_train=1.364664 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.055568 metrics={'f1_val': 0.3337834388228453, 'auprc': 0.3337834388228453, 'loss_val': 1.37253064206276, 'psi': 0.3337834388228453}-{'f1_val': 0.3330145574327914, 'auprc': 0.3330145574327914, 'loss_val': 1.4767475940274801, 'psi': 0.3330145574327914}
[S8] START round=14 head_norm_before_train=1.760377 cos_to_last_merge=0.9984 (last merge round=12)
[S8] round=14 local utility u=0.011299 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9884219178765002, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0110190885290629, 'psi': 0.35939447907390915}
[S9] START round=14 head_norm_before_train=1.587373 (no previous merge yet)
[S9] round=14 local utility u=0.091782 metrics={'f1_val': 0.2455583009765855, 'auprc': 0.2455583009765855, 'loss_val': 2.093770286512024, 'psi': 0.2455583009765855}-{'f1_val': 0.21579743008314436, 'auprc': 0.21579743008314436, 'loss_val': 2.009485742337837, 'psi': 0.21579743008314436}
[S10] START round=14 head_norm_before_train=1.689461 (no previous merge yet)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.24970145689037496, 'auprc': 0.24970145689037496, 'loss_val': 2.2945556491280934, 'psi': 0.24970145689037493}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.336811174388452, 'psi': 0.33301496338745623}
[S11] START round=14 head_norm_before_train=1.078203 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.143359 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6274262970832627, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9141437105409544, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.588216 (no previous merge yet)
[S13] round=14 local utility u=0.079873 metrics={'f1_val': 0.25270219903093555, 'auprc': 0.25270219903093555, 'loss_val': 1.1287707137961647, 'psi': 0.25270219903093555}-{'f1_val': 0.24038291083141286, 'auprc': 0.24038291083141286, 'loss_val': 1.1776421663089083, 'psi': 0.24038291083141286}
[S14] START round=14 head_norm_before_train=1.539963 cos_to_last_merge=0.9986 (last merge round=12)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.483309722684958, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9957854219172875, 'psi': 0.0}
[S15] START round=14 head_norm_before_train=1.391191 cos_to_last_merge=0.9935 (last merge round=12)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6013753537763475, 'auprc': 0.6013753537763475, 'loss_val': 0.8675611152820962, 'psi': 0.6013753537763475}-{'f1_val': 0.6143972677974848, 'auprc': 0.6143972677974848, 'loss_val': 0.8787895929768459, 'psi': 0.6143972677974848}
[S16] START round=14 head_norm_before_train=1.643590 (no previous merge yet)
[S16] round=14 local utility u=0.501367 metrics={'f1_val': 0.0672890397672163, 'auprc': 0.0672890397672163, 'loss_val': 3.0157367850135888, 'psi': 0.0672890397672163}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.412869996751233, 'psi': 0.0}
[S17] START round=14 head_norm_before_train=1.670452 (no previous merge yet)
[S17] round=14 local utility u=0.003449 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9144479275113062, 'psi': 0.20289293555469456}-{'f1_val': 0.20368209516400881, 'auprc': 0.20368209516400881, 'loss_val': 0.9284480170402536, 'psi': 0.20368209516400881}
[S7] not sending this round → trigger blocked (psi=0.334)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.067)
[S5] not sending this round → trigger blocked (psi=0.601)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:52809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.253)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=0.8650
[S8] RECEIVED delta(kind=head bytes=1794) from S4
[S8] cosine check vs S4: cos=0.9663
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] cosine check vs S9: cos=-0.0365
[S17] DROPPED delta from S9 (cos=-0.0365 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S17
[S13] cosine check vs S17: cos=-0.0283
[S13] DROPPED delta from S17 (cos=-0.0283 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6014 head_norm=1.457841
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.574245e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6109 head_norm=1.578634 delta_norm=0.457425
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.3594 head_norm=1.810345
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.421481e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.3594 head_norm=1.830314 delta_norm=0.242148
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.742793 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.2346026386544113, 'auprc': 0.2346026386544113, 'loss_val': 2.7461328346153078, 'psi': 0.2346026386544113}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6150643274606233, 'psi': 0.3674775928297055}
[S3] START round=15 head_norm_before_train=1.582919 (no previous merge yet)
[S3] round=15 local utility u=0.068733 metrics={'f1_val': 0.29159104658197216, 'auprc': 0.29159104658197216, 'loss_val': 2.5572605780537128, 'psi': 0.29159104658197216}-{'f1_val': 0.2947582133628645, 'auprc': 0.2947582133628645, 'loss_val': 2.7232307239588454, 'psi': 0.2947582133628645}
[S4] START round=15 head_norm_before_train=1.881494 (no previous merge yet)
[S4] round=15 local utility u=0.007569 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2037639107045557, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2189009877638959, 'psi': 0.3567939207526687}
[S5] START round=15 head_norm_before_train=1.436015 (no previous merge yet)
[S5] round=15 local utility u=0.304019 metrics={'f1_val': 0.6648087731824756, 'auprc': 0.6648087731824756, 'loss_val': 1.0596020723783193, 'psi': 0.6648087731824756}-{'f1_val': 0.6008171840446122, 'auprc': 0.6008171840446122, 'loss_val': 1.0917149955218666, 'psi': 0.6008171840446122}
[S6] START round=15 head_norm_before_train=1.775978 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.814789392032352, 'psi': 0.017774699907663897}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 5.854632701614436, 'psi': 0.02262340036563071}
[S7] START round=15 head_norm_before_train=1.384397 cos_to_last_merge=0.9990 (last merge round=13)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.2349983989867746, 'auprc': 0.2349983989867746, 'loss_val': 1.3330005855345872, 'psi': 0.2349983989867746}-{'f1_val': 0.3337834388228453, 'auprc': 0.3337834388228453, 'loss_val': 1.37253064206276, 'psi': 0.3337834388228453}
[S8] START round=15 head_norm_before_train=1.830314 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0439846086368063, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9884219178765002, 'psi': 0.35939447907390915}
[S9] START round=15 head_norm_before_train=1.618071 (no previous merge yet)
[S9] round=15 local utility u=0.506066 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1896581777359536, 'psi': 0.36867172340800847}-{'f1_val': 0.2455583009765855, 'auprc': 0.2455583009765855, 'loss_val': 2.093770286512024, 'psi': 0.2455583009765855}
[S10] START round=15 head_norm_before_train=1.706742 (no previous merge yet)
[S10] round=15 local utility u=0.054298 metrics={'f1_val': 0.24970145689037496, 'auprc': 0.24970145689037496, 'loss_val': 2.185959485097554, 'psi': 0.24970145689037493}-{'f1_val': 0.24970145689037496, 'auprc': 0.24970145689037496, 'loss_val': 2.2945556491280934, 'psi': 0.24970145689037493}
[S11] START round=15 head_norm_before_train=1.104360 cos_to_last_merge=0.9974 (last merge round=13)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8690317276500292, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6274262970832627, 'psi': 0.0}
[S13] START round=15 head_norm_before_train=1.613871 (no previous merge yet)
[S13] round=15 local utility u=0.419796 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2542846114771928, 'psi': 0.3599362944611573}-{'f1_val': 0.25270219903093555, 'auprc': 0.25270219903093555, 'loss_val': 1.1287707137961647, 'psi': 0.25270219903093555}
[S14] START round=15 head_norm_before_train=1.564901 cos_to_last_merge=0.9953 (last merge round=12)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8797085758574834, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.483309722684958, 'psi': 0.0}
[S15] START round=15 head_norm_before_train=1.578634 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.095341 metrics={'f1_val': 0.6154386202637983, 'auprc': 0.6154386202637983, 'loss_val': 0.8034476177518011, 'psi': 0.6154386202637983}-{'f1_val': 0.6013753537763475, 'auprc': 0.6013753537763475, 'loss_val': 0.8675611152820962, 'psi': 0.6013753537763475}
[S16] START round=15 head_norm_before_train=1.666216 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.08624031007751938, 'auprc': 0.08624031007751938, 'loss_val': 3.3582442794324723, 'psi': 0.08624031007751938}-{'f1_val': 0.0672890397672163, 'auprc': 0.0672890397672163, 'loss_val': 3.0157367850135888, 'psi': 0.0672890397672163}
[S17] START round=15 head_norm_before_train=1.699551 (no previous merge yet)
[S17] round=15 local utility u=0.007875 metrics={'f1_val': 0.20281435579654014, 'auprc': 0.20281435579654014, 'loss_val': 0.8979898285901612, 'psi': 0.20281435579654014}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9144479275113062, 'psi': 0.20289293555469456}
[S9] not sending this round → trigger blocked (psi=0.369)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.357)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S15
[S9] cosine check vs S15: cos=-0.0569
[S9] DROPPED delta from S15 (cos=-0.0569 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S13
[S7] cosine check vs S13: cos=0.9648
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] cosine check vs S5: cos=0.8855
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.4293
[S14] RECEIVED delta(kind=head bytes=1805) from S10
[S14] cosine check vs S10: cos=0.9630
[S17] not sending this round → trigger blocked (psi=0.203)
[S8] ⇄ pheromone p=0.101 → S15@127.0.0.1:52815
[S6] ⇄ pheromone p=0.083 → S17@127.0.0.1:52817
[S4] ⇄ pheromone p=0.150 → S8@127.0.0.1:52809
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.2350 head_norm=1.411588
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.295738e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.4636 head_norm=1.508693 delta_norm=0.229574
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.168 → S17@127.0.0.1:52817
[S2] ⇄ pheromone p=0.145 → S8@127.0.0.1:52809
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.0000 head_norm=1.592892
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.354553e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.644494 delta_norm=0.235455
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.087 → S8@127.0.0.1:52809
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.0000 head_norm=1.136716
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.951027e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.102942 delta_norm=0.295103
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.085 → S8@127.0.0.1:52809
[S9] ⇄ pheromone p=0.271 → S17@127.0.0.1:52817
[S15] ⇄ pheromone p=0.251 → S9@127.0.0.1:52810
[S5] ⇄ pheromone p=0.386 → S11@127.0.0.1:52812
[S10] ⇄ pheromone p=0.127 → S14@127.0.0.1:52814
[S13] ⇄ pheromone p=0.176 → S7@127.0.0.1:52808
[S3] ⇄ pheromone p=0.199 → S11@127.0.0.1:52812
[S17] ⇄ pheromone p=0.097 → S13@127.0.0.1:52813
[S16] ⇄ pheromone p=0.141 → S7@127.0.0.1:52808
[S2] START round=16 head_norm_before_train=1.762336 (no previous merge yet)
[S2] round=16 local utility u=0.624666 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.692674778137899, 'psi': 0.3674775928297055}-{'f1_val': 0.2346026386544113, 'auprc': 0.2346026386544113, 'loss_val': 2.7461328346153078, 'psi': 0.2346026386544113}
[S3] START round=16 head_norm_before_train=1.612834 (no previous merge yet)
[S3] round=16 local utility u=0.001099 metrics={'f1_val': 0.29334527006863625, 'auprc': 0.29334527006863625, 'loss_val': 2.570849890531546, 'psi': 0.29334527006863625}-{'f1_val': 0.29159104658197216, 'auprc': 0.29159104658197216, 'loss_val': 2.5572605780537128, 'psi': 0.29159104658197216}
[S4] START round=16 head_norm_before_train=1.902632 (no previous merge yet)
[S4] round=16 local utility u=0.003958 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1958485937721197, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2037639107045557, 'psi': 0.3567939207526687}
[S5] START round=16 head_norm_before_train=1.462084 (no previous merge yet)
[S5] round=16 local utility u=0.017898 metrics={'f1_val': 0.6639311775214815, 'auprc': 0.6639311775214815, 'loss_val': 1.0159079143572358, 'psi': 0.6639311775214815}-{'f1_val': 0.6648087731824756, 'auprc': 0.6648087731824756, 'loss_val': 1.0596020723783193, 'psi': 0.6648087731824756}
[S6] START round=16 head_norm_before_train=1.788297 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.029056907615317, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.814789392032352, 'psi': 0.017774699907663897}
[S7] START round=16 head_norm_before_train=1.508693 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.17684887459807075, 'auprc': 0.17684887459807075, 'loss_val': 1.271047196060838, 'psi': 0.17684887459807075}-{'f1_val': 0.2349983989867746, 'auprc': 0.2349983989867746, 'loss_val': 1.3330005855345872, 'psi': 0.2349983989867746}
[S8] START round=16 head_norm_before_train=1.877632 cos_to_last_merge=0.9991 (last merge round=14)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0868001840458978, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0439846086368063, 'psi': 0.35939447907390915}
[S9] START round=16 head_norm_before_train=1.646237 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2605993144287932, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1896581777359536, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.726933 (no previous merge yet)
[S10] round=16 local utility u=0.607212 metrics={'f1_val': 0.33222169286962044, 'auprc': 0.33222169286962044, 'loss_val': 1.7142169185918825, 'psi': 0.33222169286962044}-{'f1_val': 0.24970145689037496, 'auprc': 0.24970145689037496, 'loss_val': 2.185959485097554, 'psi': 0.24970145689037493}
[S11] START round=16 head_norm_before_train=1.102942 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.044290 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7804520588248427, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8690317276500292, 'psi': 0.0}
[S13] START round=16 head_norm_before_train=1.632524 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.24744525547445254, 'auprc': 0.24744525547445254, 'loss_val': 1.156323566539363, 'psi': 0.24744525547445256}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2542846114771928, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.644494 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.201681 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.476346282279488, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.8797085758574834, 'psi': 0.0}
[S15] START round=16 head_norm_before_train=1.623996 cos_to_last_merge=0.9976 (last merge round=14)
[S15] round=16 local utility u=0.063943 metrics={'f1_val': 0.6168330926211807, 'auprc': 0.6168330926211807, 'loss_val': 0.688112836819366, 'psi': 0.6168330926211807}-{'f1_val': 0.6154386202637983, 'auprc': 0.6154386202637983, 'loss_val': 0.8034476177518011, 'psi': 0.6154386202637983}
[S16] START round=16 head_norm_before_train=1.689288 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.0297951582867784, 'auprc': 0.0297951582867784, 'loss_val': 3.797228474233288, 'psi': 0.0297951582867784}-{'f1_val': 0.08624031007751938, 'auprc': 0.08624031007751938, 'loss_val': 3.3582442794324723, 'psi': 0.08624031007751938}
[S17] START round=16 head_norm_before_train=1.713534 (no previous merge yet)
[S17] round=16 local utility u=0.026542 metrics={'f1_val': 0.20333932665378882, 'auprc': 0.20333932665378882, 'loss_val': 0.8496301441604709, 'psi': 0.20333932665378882}-{'f1_val': 0.20281435579654014, 'auprc': 0.20281435579654014, 'loss_val': 0.8979898285901612, 'psi': 0.20281435579654014}
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S3] not sending this round → trigger blocked (psi=0.293)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.332)
[S14] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.617)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.664)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=-0.0649
[S8] DROPPED delta from S2 (cos=-0.0649 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] cosine check vs S4: cos=0.9788
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S17
[S13] cosine check vs S17: cos=-0.0294
[S13] DROPPED delta from S17 (cos=-0.0294 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.3594 head_norm=1.925977
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.983117e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.3594 head_norm=1.914194 delta_norm=0.198312
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.779594 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7269346683586795, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.692674778137899, 'psi': 0.3674775928297055}
[S3] START round=17 head_norm_before_train=1.641357 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.29671745887347434, 'auprc': 0.29671745887347434, 'loss_val': 2.6813301346258283, 'psi': 0.29671745887347434}-{'f1_val': 0.29334527006863625, 'auprc': 0.29334527006863625, 'loss_val': 2.570849890531546, 'psi': 0.29334527006863625}
[S4] START round=17 head_norm_before_train=1.922900 (no previous merge yet)
[S4] round=17 local utility u=0.001223 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1934031173834918, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1958485937721197, 'psi': 0.3567939207526687}
[S5] START round=17 head_norm_before_train=1.487027 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.6234162261547718, 'auprc': 0.6234162261547718, 'loss_val': 0.9877552438551933, 'psi': 0.6234162261547718}-{'f1_val': 0.6639311775214815, 'auprc': 0.6639311775214815, 'loss_val': 1.0159079143572358, 'psi': 0.6639311775214815}
[S6] START round=17 head_norm_before_train=1.800918 (no previous merge yet)
[S6] round=17 local utility u=0.183086 metrics={'f1_val': 0.02501136880400182, 'auprc': 0.02501136880400182, 'loss_val': 5.728014972207593, 'psi': 0.02501136880400182}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.029056907615317, 'psi': 0.017774699907663897}
[S7] START round=17 head_norm_before_train=1.531383 cos_to_last_merge=0.9991 (last merge round=15)
[S7] round=17 local utility u=0.267901 metrics={'f1_val': 0.22734671730873576, 'auprc': 0.22734671730873576, 'loss_val': 1.1897265787652473, 'psi': 0.2273467173087358}-{'f1_val': 0.17684887459807075, 'auprc': 0.17684887459807075, 'loss_val': 1.271047196060838, 'psi': 0.17684887459807075}
[S8] START round=17 head_norm_before_train=1.914194 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1593944125841706, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0868001840458978, 'psi': 0.35939447907390915}
[S9] START round=17 head_norm_before_train=1.670447 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.32182250760457, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2605993144287932, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.761521 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.31369020842705053, 'auprc': 0.31369020842705053, 'loss_val': 1.5493834346082833, 'psi': 0.31369020842705053}-{'f1_val': 0.33222169286962044, 'auprc': 0.33222169286962044, 'loss_val': 1.7142169185918825, 'psi': 0.33222169286962044}
[S11] START round=17 head_norm_before_train=1.130719 cos_to_last_merge=0.9971 (last merge round=15)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7833061163816695, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7804520588248427, 'psi': 0.0}
[S13] START round=17 head_norm_before_train=1.647955 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.24034030485643387, 'auprc': 0.24034030485643387, 'loss_val': 1.2185050406593076, 'psi': 0.24034030485643387}-{'f1_val': 0.24744525547445254, 'auprc': 0.24744525547445254, 'loss_val': 1.156323566539363, 'psi': 0.24744525547445256}
[S14] START round=17 head_norm_before_train=1.666657 cos_to_last_merge=0.9994 (last merge round=15)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.000709949141518, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.476346282279488, 'psi': 0.0}
[S15] START round=17 head_norm_before_train=1.683507 cos_to_last_merge=0.9914 (last merge round=14)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.615298614223108, 'auprc': 0.615298614223108, 'loss_val': 0.6982404464410256, 'psi': 0.615298614223108}-{'f1_val': 0.6168330926211807, 'auprc': 0.6168330926211807, 'loss_val': 0.688112836819366, 'psi': 0.6168330926211807}
[S16] START round=17 head_norm_before_train=1.713858 (no previous merge yet)
[S16] round=17 local utility u=0.286198 metrics={'f1_val': 0.08903889424622308, 'auprc': 0.08903889424622308, 'loss_val': 3.758025313711959, 'psi': 0.08903889424622308}-{'f1_val': 0.0297951582867784, 'auprc': 0.0297951582867784, 'loss_val': 3.797228474233288, 'psi': 0.0297951582867784}
[S17] START round=17 head_norm_before_train=1.727720 (no previous merge yet)
[S17] round=17 local utility u=0.470892 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.8120799443248504, 'psi': 0.30380970798684975}-{'f1_val': 0.20333932665378882, 'auprc': 0.20333932665378882, 'loss_val': 0.8496301441604709, 'psi': 0.20333932665378882}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.025)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] cosine check vs S4: cos=0.9906
[S7] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1801) from S7
[S17] cosine check vs S7: cos=-0.0336
[S17] DROPPED delta from S7 (cos=-0.0336 < 0.0)
[S16] not sending this round → trigger blocked (psi=0.089)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1806 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1806) from S17
[S13] cosine check vs S17: cos=-0.0307
[S13] DROPPED delta from S17 (cos=-0.0307 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.3594 head_norm=1.955263
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.341560e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.3594 head_norm=1.949193 delta_norm=0.134156
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.795564 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.24165283158088913, 'auprc': 0.24165283158088913, 'loss_val': 2.786616752214682, 'psi': 0.24165283158088913}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7269346683586795, 'psi': 0.3674775928297055}
[S3] START round=18 head_norm_before_train=1.668310 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.296256874223878, 'auprc': 0.296256874223878, 'loss_val': 2.992095674421018, 'psi': 0.296256874223878}-{'f1_val': 0.29671745887347434, 'auprc': 0.29671745887347434, 'loss_val': 2.6813301346258283, 'psi': 0.29671745887347434}
[S4] START round=18 head_norm_before_train=1.952344 (no previous merge yet)
[S4] round=18 local utility u=0.004972 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1834586062996402, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1934031173834918, 'psi': 0.3567939207526687}
[S5] START round=18 head_norm_before_train=1.508436 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.0863885576973695, 'psi': 0.33451196111837667}-{'f1_val': 0.6234162261547718, 'auprc': 0.6234162261547718, 'loss_val': 0.9877552438551933, 'psi': 0.6234162261547718}
[S6] START round=18 head_norm_before_train=1.810340 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.01621120889300602, 'auprc': 0.01621120889300602, 'loss_val': 6.351328288585226, 'psi': 0.01621120889300602}-{'f1_val': 0.02501136880400182, 'auprc': 0.02501136880400182, 'loss_val': 5.728014972207593, 'psi': 0.02501136880400182}
[S7] START round=18 head_norm_before_train=1.554739 cos_to_last_merge=0.9970 (last merge round=15)
[S7] round=18 local utility u=0.059366 metrics={'f1_val': 0.22983870967741934, 'auprc': 0.22983870967741934, 'loss_val': 1.0934218731756484, 'psi': 0.22983870967741932}-{'f1_val': 0.22734671730873576, 'auprc': 0.22734671730873576, 'loss_val': 1.1897265787652473, 'psi': 0.2273467173087358}
[S8] START round=18 head_norm_before_train=1.949193 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.220065091378608, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1593944125841706, 'psi': 0.35939447907390915}
[S9] START round=18 head_norm_before_train=1.691316 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3725186915008267, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.32182250760457, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.817095 (no previous merge yet)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.30266203703703703, 'auprc': 0.30266203703703703, 'loss_val': 1.4702568262145812, 'psi': 0.30266203703703703}-{'f1_val': 0.31369020842705053, 'auprc': 0.31369020842705053, 'loss_val': 1.5493834346082833, 'psi': 0.31369020842705053}
[S11] START round=18 head_norm_before_train=1.168683 cos_to_last_merge=0.9890 (last merge round=15)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1269500699831223, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7833061163816695, 'psi': 0.0}
[S13] START round=18 head_norm_before_train=1.659945 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.24012750132813884, 'auprc': 0.24012750132813884, 'loss_val': 1.2581845733421704, 'psi': 0.24012750132813884}-{'f1_val': 0.24034030485643387, 'auprc': 0.24034030485643387, 'loss_val': 1.2185050406593076, 'psi': 0.24034030485643387}
[S14] START round=18 head_norm_before_train=1.690818 cos_to_last_merge=0.9978 (last merge round=15)
[S14] round=18 local utility u=0.305986 metrics={'f1_val': 0.059420289855072465, 'auprc': 0.059420289855072465, 'loss_val': 3.923521348853211, 'psi': 0.059420289855072465}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.000709949141518, 'psi': 0.0}
[S15] START round=18 head_norm_before_train=1.727722 cos_to_last_merge=0.9859 (last merge round=14)
[S15] round=18 local utility u=0.040159 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.6292302170708183, 'psi': 0.6165550083006743}-{'f1_val': 0.615298614223108, 'auprc': 0.615298614223108, 'loss_val': 0.6982404464410256, 'psi': 0.615298614223108}
[S16] START round=18 head_norm_before_train=1.737109 (no previous merge yet)
[S16] round=18 local utility u=0.006879 metrics={'f1_val': 0.09029779058597502, 'auprc': 0.09029779058597502, 'loss_val': 3.7555978816599387, 'psi': 0.09029779058597502}-{'f1_val': 0.08903889424622308, 'auprc': 0.08903889424622308, 'loss_val': 3.758025313711959, 'psi': 0.08903889424622308}
[S17] START round=18 head_norm_before_train=1.742018 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.24661162123870836, 'auprc': 0.24661162123870836, 'loss_val': 0.7859819468245569, 'psi': 0.24661162123870836}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.8120799443248504, 'psi': 0.30380970798684975}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[S4] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] cosine check vs S4: cos=0.9943
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.059)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:52810
[S16] not sending this round → trigger blocked (psi=0.090)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S7
[S17] cosine check vs S7: cos=-0.0339
[S17] DROPPED delta from S7 (cos=-0.0339 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S15
[S9] cosine check vs S15: cos=-0.0566
[S9] DROPPED delta from S15 (cos=-0.0566 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.3594 head_norm=1.989752
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.060141e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.3594 head_norm=1.981529 delta_norm=0.106014
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.809879 (no previous merge yet)
[S2] round=19 local utility u=0.563785 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7914689455620896, 'psi': 0.3674775928297055}-{'f1_val': 0.24165283158088913, 'auprc': 0.24165283158088913, 'loss_val': 2.786616752214682, 'psi': 0.24165283158088913}
[S3] START round=19 head_norm_before_train=1.694223 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 3.4401199485618204, 'psi': 0.29773995791014735}-{'f1_val': 0.296256874223878, 'auprc': 0.296256874223878, 'loss_val': 2.992095674421018, 'psi': 0.296256874223878}
[S4] START round=19 head_norm_before_train=1.978960 (no previous merge yet)
[S4] round=19 local utility u=0.006054 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.171350469803814, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1834586062996402, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.536491 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 1.4522825262374892, 'psi': 0.33409214683912186}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.0863885576973695, 'psi': 0.33451196111837667}
[S6] START round=19 head_norm_before_train=1.821854 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.5973290338947175, 'psi': 0.0}-{'f1_val': 0.01621120889300602, 'auprc': 0.01621120889300602, 'loss_val': 6.351328288585226, 'psi': 0.01621120889300602}
[S7] START round=19 head_norm_before_train=1.576410 cos_to_last_merge=0.9942 (last merge round=15)
[S7] round=19 local utility u=0.125211 metrics={'f1_val': 0.24544303797468353, 'auprc': 0.24544303797468353, 'loss_val': 0.9834392366524568, 'psi': 0.24544303797468353}-{'f1_val': 0.22983870967741934, 'auprc': 0.22983870967741934, 'loss_val': 1.0934218731756484, 'psi': 0.22983870967741932}
[S8] START round=19 head_norm_before_train=1.981529 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2577347823037897, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.220065091378608, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.709824 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.412455526053659, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3725186915008267, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.869987 (no previous merge yet)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.2875601374570447, 'auprc': 0.2875601374570447, 'loss_val': 1.3975810651752225, 'psi': 0.2875601374570447}-{'f1_val': 0.30266203703703703, 'auprc': 0.30266203703703703, 'loss_val': 1.4702568262145812, 'psi': 0.30266203703703703}
[S11] START round=19 head_norm_before_train=1.203911 cos_to_last_merge=0.9800 (last merge round=15)
[S11] round=19 local utility u=1.000000 metrics={'f1_val': 0.31295883857131074, 'auprc': 0.31295883857131074, 'loss_val': 1.986424428962285, 'psi': 0.31295883857131074}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1269500699831223, 'psi': 0.0}
[S13] START round=19 head_norm_before_train=1.674252 (no previous merge yet)
[S13] round=19 local utility u=0.520530 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2954033718952984, 'psi': 0.3599362944611573}-{'f1_val': 0.24012750132813884, 'auprc': 0.24012750132813884, 'loss_val': 1.2581845733421704, 'psi': 0.24012750132813884}
[S14] START round=19 head_norm_before_train=1.712038 cos_to_last_merge=0.9959 (last merge round=15)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.05962059620596206, 'auprc': 0.05962059620596206, 'loss_val': 4.1013607265619125, 'psi': 0.05962059620596205}-{'f1_val': 0.059420289855072465, 'auprc': 0.059420289855072465, 'loss_val': 3.923521348853211, 'psi': 0.059420289855072465}
[S15] START round=19 head_norm_before_train=1.776936 cos_to_last_merge=0.9802 (last merge round=14)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6138114033949549, 'auprc': 0.6138114033949549, 'loss_val': 0.6160712511275377, 'psi': 0.6138114033949549}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.6292302170708183, 'psi': 0.6165550083006743}
[S16] START round=19 head_norm_before_train=1.759721 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.0936704834605598, 'auprc': 0.0936704834605598, 'loss_val': 3.8055003431776364, 'psi': 0.0936704834605598}-{'f1_val': 0.09029779058597502, 'auprc': 0.09029779058597502, 'loss_val': 3.7555978816599387, 'psi': 0.09029779058597502}
[S17] START round=19 head_norm_before_train=1.755933 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.21127338356268824, 'auprc': 0.21127338356268824, 'loss_val': 0.7849663228691707, 'psi': 0.21127338356268827}-{'f1_val': 0.24661162123870836, 'auprc': 0.24661162123870836, 'loss_val': 0.7859819468245569, 'psi': 0.24661162123870836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=-0.0562
[S8] DROPPED delta from S2 (cos=-0.0562 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:52808
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:52809
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] cosine check vs S13: cos=0.9718
[S8] RECEIVED delta(kind=head bytes=1794) from S4
[S8] cosine check vs S4: cos=0.9952
[S8] RECEIVED delta(kind=head bytes=1801) from S11
[S8] cosine check vs S11: cos=0.1245
[S17] RECEIVED delta(kind=head bytes=1796) from S7
[S17] cosine check vs S7: cos=-0.0331
[S17] DROPPED delta from S7 (cos=-0.0331 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.367 u=0.5638 p_local=0.2363 f1=0.367 auprc=0.367 bytes=7196
[S15] r=20 psi=0.614 u=0.0000 p_local=0.1158 f1=0.614 auprc=0.614 bytes=10796
[S10] r=20 psi=0.288 u=0.0000 p_local=0.1141 f1=0.288 auprc=0.288 bytes=9004
[S9] r=20 psi=0.369 u=0.0000 p_local=0.1110 f1=0.369 auprc=0.369 bytes=3597
[S6] r=20 psi=0.000 u=0.0000 p_local=0.0576 f1=0.000 auprc=0.000 bytes=0
[S5] r=20 psi=0.334 u=0.0000 p_local=0.1600 f1=0.334 auprc=0.334 bytes=10783
[S14] r=20 psi=0.060 u=0.0000 p_local=0.1051 f1=0.060 auprc=0.060 bytes=0
[S3] r=20 psi=0.298 u=0.0000 p_local=0.0816 f1=0.298 auprc=0.298 bytes=3599
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.3594 head_norm=2.022136
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.665607e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.3594 head_norm=1.576003 delta_norm=0.566561
[S8] aggregate: ACCEPT kept=['S4', 'S11'] (k=2/2) mode=median trim_p=0.1
[S8] r=20 psi=0.359 u=0.0000 p_local=0.0412 f1=0.359 auprc=0.359 bytes=8990
[S4] r=20 psi=0.357 u=0.0061 p_local=0.0639 f1=0.357 auprc=0.357 bytes=16181
[S13] r=20 psi=0.360 u=0.5205 p_local=0.1761 f1=0.360 auprc=0.360 bytes=8998
[S11] r=20 psi=0.313 u=1.0000 p_local=0.2393 f1=0.313 auprc=0.313 bytes=1801
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.2454 head_norm=1.600711
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.998508e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.2497 head_norm=1.632600 delta_norm=0.199851
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.245 u=0.1252 p_local=0.1377 f1=0.245 auprc=0.245 bytes=8984
[S17] r=20 psi=0.211 u=0.0000 p_local=0.1026 f1=0.211 auprc=0.211 bytes=7216
[S16] r=20 psi=0.094 u=0.0000 p_local=0.0954 f1=0.094 auprc=0.094 bytes=0
[S2] START round=20 head_norm_before_train=1.823861 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8193636209930566, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7914689455620896, 'psi': 0.3674775928297055}
[S3] START round=20 head_norm_before_train=1.718548 (no previous merge yet)
[S3] round=20 local utility u=0.146526 metrics={'f1_val': 0.29651369619352547, 'auprc': 0.29651369619352547, 'loss_val': 3.1360317836701492, 'psi': 0.29651369619352547}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 3.4401199485618204, 'psi': 0.29773995791014735}
[S4] START round=20 head_norm_before_train=1.995423 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1825616875066187, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.171350469803814, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.566154 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9799233077978164, 'psi': 0.33358943696313936}-{'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 1.4522825262374892, 'psi': 0.33409214683912186}
[S6] START round=20 head_norm_before_train=1.834797 (no previous merge yet)
[S6] round=20 local utility u=0.436506 metrics={'f1_val': 0.03619005328596803, 'auprc': 0.03619005328596803, 'loss_val': 6.050028494084449, 'psi': 0.03619005328596803}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.5973290338947175, 'psi': 0.0}
[S7] START round=20 head_norm_before_train=1.632600 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.429111 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.9147384521100722, 'psi': 0.33316757831924415}-{'f1_val': 0.24544303797468353, 'auprc': 0.24544303797468353, 'loss_val': 0.9834392366524568, 'psi': 0.24544303797468353}
[S8] START round=20 head_norm_before_train=1.576003 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.043678 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1703783917056179, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2577347823037897, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.726336 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4416243029830293, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.412455526053659, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.913578 (no previous merge yet)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.2877381197991885, 'auprc': 0.2877381197991885, 'loss_val': 1.441295697002979, 'psi': 0.2877381197991885}-{'f1_val': 0.2875601374570447, 'auprc': 0.2875601374570447, 'loss_val': 1.3975810651752225, 'psi': 0.2875601374570447}
[S11] START round=20 head_norm_before_train=1.231524 cos_to_last_merge=0.9732 (last merge round=15)
[S11] round=20 local utility u=0.095539 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 1.9682241109522947, 'psi': 0.33216756042589574}-{'f1_val': 0.31295883857131074, 'auprc': 0.31295883857131074, 'loss_val': 1.986424428962285, 'psi': 0.31295883857131074}
[S13] START round=20 head_norm_before_train=1.687713 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.24051081943951758, 'auprc': 0.24051081943951758, 'loss_val': 1.2956398440074788, 'psi': 0.24051081943951758}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2954033718952984, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.732160 cos_to_last_merge=0.9937 (last merge round=15)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.05962059620596206, 'auprc': 0.05962059620596206, 'loss_val': 4.17490768788753, 'psi': 0.05962059620596205}-{'f1_val': 0.05962059620596206, 'auprc': 0.05962059620596206, 'loss_val': 4.1013607265619125, 'psi': 0.05962059620596205}
[S15] START round=20 head_norm_before_train=1.820352 cos_to_last_merge=0.9752 (last merge round=14)
[S15] round=20 local utility u=0.026964 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5848496855011885, 'psi': 0.6163342951580373}-{'f1_val': 0.6138114033949549, 'auprc': 0.6138114033949549, 'loss_val': 0.6160712511275377, 'psi': 0.6138114033949549}
[S16] START round=20 head_norm_before_train=1.781764 (no previous merge yet)
[S16] round=20 local utility u=0.344441 metrics={'f1_val': 0.14177583697234353, 'auprc': 0.14177583697234353, 'loss_val': 3.5495658227187956, 'psi': 0.14177583697234353}-{'f1_val': 0.0936704834605598, 'auprc': 0.0936704834605598, 'loss_val': 3.8055003431776364, 'psi': 0.0936704834605598}
[S17] START round=20 head_norm_before_train=1.769518 (no previous merge yet)
[S17] round=20 local utility u=0.220127 metrics={'f1_val': 0.2585192228704493, 'auprc': 0.2585192228704493, 'loss_val': 0.7699248620709346, 'psi': 0.2585192228704493}-{'f1_val': 0.21127338356268824, 'auprc': 0.21127338356268824, 'loss_val': 0.7849663228691707, 'psi': 0.21127338356268827}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[S16] not sending this round → trigger blocked (psi=0.142)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:52810
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.036)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=0.8636
[S9] RECEIVED delta(kind=head bytes=1805) from S15
[S9] cosine check vs S15: cos=-0.0569
[S9] DROPPED delta from S15 (cos=-0.0569 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.5525
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] cosine check vs S11: cos=0.3088
[S17] RECEIVED delta(kind=head bytes=1799) from S7
[S17] cosine check vs S7: cos=-0.0323
[S17] DROPPED delta from S7 (cos=-0.0323 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] cosine check vs S17: cos=-0.0321
[S13] DROPPED delta from S17 (cos=-0.0321 < 0.0)
[S4] ⇄ pheromone p=0.051 → S8@127.0.0.1:52809
[S14] ⇄ pheromone p=0.084 → S8@127.0.0.1:52809
[S10] ⇄ pheromone p=0.091 → S14@127.0.0.1:52814
[S6] ⇄ pheromone p=0.133 → S17@127.0.0.1:52817
[S13] ⇄ pheromone p=0.141 → S7@127.0.0.1:52808
[S2] ⇄ pheromone p=0.189 → S8@127.0.0.1:52809
[S9] ⇄ pheromone p=0.089 → S17@127.0.0.1:52817
[S5] ⇄ pheromone p=0.128 → S11@127.0.0.1:52812
[S7] ⇄ pheromone p=0.196 → S17@127.0.0.1:52817
[S3] ⇄ pheromone p=0.095 → S11@127.0.0.1:52812
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.3594 head_norm=1.626973
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.594642e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.3594 head_norm=1.169158 delta_norm=0.859464
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.042 → S15@127.0.0.1:52815
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.6163 head_norm=1.862174
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.695827e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6162 head_norm=1.684298 delta_norm=0.469583
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.098 → S9@127.0.0.1:52810
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.3322 head_norm=1.250670
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.389908e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.3319 head_norm=1.321917 delta_norm=0.738991
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.211 → S8@127.0.0.1:52809
[S16] ⇄ pheromone p=0.145 → S7@127.0.0.1:52808
[S17] ⇄ pheromone p=0.126 → S13@127.0.0.1:52813
[S2] START round=21 head_norm_before_train=1.837014 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.846749176650382, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8193636209930566, 'psi': 0.3674775928297055}
[S3] START round=21 head_norm_before_train=1.738668 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.29743308669041746, 'auprc': 0.29743308669041746, 'loss_val': 3.406660862052399, 'psi': 0.29743308669041746}-{'f1_val': 0.29651369619352547, 'auprc': 0.29651369619352547, 'loss_val': 3.1360317836701492, 'psi': 0.29651369619352547}
[S4] START round=21 head_norm_before_train=2.009065 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2024341891860393, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1825616875066187, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.594916 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.1162892305152416, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9799233077978164, 'psi': 0.33358943696313936}
[S6] START round=21 head_norm_before_train=1.846799 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.030983385720700495, 'auprc': 0.030983385720700495, 'loss_val': 6.214652373815622, 'psi': 0.030983385720700495}-{'f1_val': 0.03619005328596803, 'auprc': 0.03619005328596803, 'loss_val': 6.050028494084449, 'psi': 0.03619005328596803}
[S7] START round=21 head_norm_before_train=1.653360 cos_to_last_merge=0.9996 (last merge round=19)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.2498134792340214, 'auprc': 0.2498134792340214, 'loss_val': 0.8636691443210648, 'psi': 0.2498134792340214}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.9147384521100722, 'psi': 0.33316757831924415}
[S8] START round=21 head_norm_before_train=1.169158 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.061892 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0465949664847376, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1703783917056179, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.741087 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4686384837202375, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4416243029830293, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.951029 (no previous merge yet)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.2801097944701078, 'auprc': 0.2801097944701078, 'loss_val': 1.459384098972947, 'psi': 0.2801097944701078}-{'f1_val': 0.2877381197991885, 'auprc': 0.2877381197991885, 'loss_val': 1.441295697002979, 'psi': 0.2877381197991885}
[S11] START round=21 head_norm_before_train=1.321917 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.018410 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 1.9314048026375936, 'psi': 0.33216756042589574}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 1.9682241109522947, 'psi': 0.33216756042589574}
[S13] START round=21 head_norm_before_train=1.703904 (no previous merge yet)
[S13] round=21 local utility u=0.525178 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3201122837527528, 'psi': 0.3599362944611573}-{'f1_val': 0.24051081943951758, 'auprc': 0.24051081943951758, 'loss_val': 1.2956398440074788, 'psi': 0.24051081943951758}
[S14] START round=21 head_norm_before_train=1.752712 cos_to_last_merge=0.9916 (last merge round=15)
[S14] round=21 local utility u=0.179105 metrics={'f1_val': 0.10146082337317397, 'auprc': 0.10146082337317397, 'loss_val': 4.193260306933884, 'psi': 0.10146082337317397}-{'f1_val': 0.05962059620596206, 'auprc': 0.05962059620596206, 'loss_val': 4.17490768788753, 'psi': 0.05962059620596205}
[S15] START round=21 head_norm_before_train=1.684298 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.014850 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5551496322337585, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5848496855011885, 'psi': 0.6163342951580373}
[S16] START round=21 head_norm_before_train=1.801807 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.07197815835194837, 'auprc': 0.07197815835194837, 'loss_val': 4.452031063704201, 'psi': 0.07197815835194837}-{'f1_val': 0.14177583697234353, 'auprc': 0.14177583697234353, 'loss_val': 3.5495658227187956, 'psi': 0.14177583697234353}
[S17] START round=21 head_norm_before_train=1.787625 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.2042832666684461, 'auprc': 0.2042832666684461, 'loss_val': 0.8058005396143967, 'psi': 0.2042832666684461}-{'f1_val': 0.2585192228704493, 'auprc': 0.2585192228704493, 'loss_val': 0.7699248620709346, 'psi': 0.2585192228704493}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:52810
[S14] not sending this round → trigger blocked (psi=0.101)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:52815
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] cosine check vs S8: cos=0.8046
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=-0.0631
[S9] DROPPED delta from S15 (cos=-0.0631 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=0.9872
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] cosine check vs S11: cos=0.6125
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.2498 head_norm=1.672543
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.378995e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.3332 head_norm=1.690896 delta_norm=0.137900
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.3594 head_norm=1.248479
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.703356e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.3594 head_norm=1.160769 delta_norm=0.570336
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.6163 head_norm=1.730611
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.188836e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.6163 head_norm=1.416904 delta_norm=0.518884
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.849464 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8737728930384567, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.846749176650382, 'psi': 0.3674775928297055}
[S3] START round=22 head_norm_before_train=1.755567 (no previous merge yet)
[S3] round=22 local utility u=0.112723 metrics={'f1_val': 0.29406105134260474, 'auprc': 0.29406105134260474, 'loss_val': 3.150866220496028, 'psi': 0.29406105134260474}-{'f1_val': 0.29743308669041746, 'auprc': 0.29743308669041746, 'loss_val': 3.406660862052399, 'psi': 0.29743308669041746}
[S4] START round=22 head_norm_before_train=2.032532 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2137818168148717, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2024341891860393, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.623546 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.3359294141777394, 'psi': 0.333168561542264}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.1162892305152416, 'psi': 0.33358943696313936}
[S6] START round=22 head_norm_before_train=1.855645 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.699141108207047, 'psi': 0.017774699907663897}-{'f1_val': 0.030983385720700495, 'auprc': 0.030983385720700495, 'loss_val': 6.214652373815622, 'psi': 0.030983385720700495}
[S7] START round=22 head_norm_before_train=1.690896 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.386984 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.8398870870579759, 'psi': 0.33316757831924415}-{'f1_val': 0.2498134792340214, 'auprc': 0.2498134792340214, 'loss_val': 0.8636691443210648, 'psi': 0.2498134792340214}
[S8] START round=22 head_norm_before_train=1.160769 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.013660 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0192754620260278, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0465949664847376, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.754255 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4938032989215677, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4686384837202375, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.983306 (no previous merge yet)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.2833536502776649, 'auprc': 0.2833536502776649, 'loss_val': 1.5079952269894525, 'psi': 0.2833536502776649}-{'f1_val': 0.2801097944701078, 'auprc': 0.2801097944701078, 'loss_val': 1.459384098972947, 'psi': 0.2801097944701078}
[S11] START round=22 head_norm_before_train=1.336650 cos_to_last_merge=0.9995 (last merge round=20)
[S11] round=22 local utility u=0.018672 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.8919768608265584, 'psi': 0.3319360347772085}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 1.9314048026375936, 'psi': 0.33216756042589574}
[S13] START round=22 head_norm_before_train=1.720143 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.24025513819985825, 'auprc': 0.24025513819985825, 'loss_val': 1.3168990654955361, 'psi': 0.24025513819985825}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3201122837527528, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.775041 cos_to_last_merge=0.9893 (last merge round=15)
[S14] round=22 local utility u=0.087596 metrics={'f1_val': 0.12081569834551752, 'auprc': 0.12081569834551752, 'loss_val': 4.192261583503372, 'psi': 0.12081569834551753}-{'f1_val': 0.10146082337317397, 'auprc': 0.10146082337317397, 'loss_val': 4.193260306933884, 'psi': 0.10146082337317397}
[S15] START round=22 head_norm_before_train=1.416904 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5441816075229364, 'psi': 0.6150769866718802}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5551496322337585, 'psi': 0.6163342951580373}
[S16] START round=22 head_norm_before_train=1.819670 (no previous merge yet)
[S16] round=22 local utility u=0.668375 metrics={'f1_val': 0.13761737089201878, 'auprc': 0.13761737089201878, 'loss_val': 3.7060340342835705, 'psi': 0.13761737089201878}-{'f1_val': 0.07197815835194837, 'auprc': 0.07197815835194837, 'loss_val': 4.452031063704201, 'psi': 0.07197815835194837}
[S17] START round=22 head_norm_before_train=1.803800 (no previous merge yet)
[S17] round=22 local utility u=0.194161 metrics={'f1_val': 0.2500971808178988, 'auprc': 0.2500971808178988, 'loss_val': 0.829803043084827, 'psi': 0.2500971808178988}-{'f1_val': 0.2042832666684461, 'auprc': 0.2042832666684461, 'loss_val': 0.8058005396143967, 'psi': 0.2042832666684461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.121)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.138)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:52815
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] cosine check vs S11: cos=0.8584
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.7447
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.8992
[S17] RECEIVED delta(kind=head bytes=1801) from S7
[S17] cosine check vs S7: cos=-0.0343
[S17] DROPPED delta from S7 (cos=-0.0343 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] → sending delta(kind=head bytes=1808) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1808 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1808) from S17
[S13] cosine check vs S17: cos=-0.0340
[S13] DROPPED delta from S17 (cos=-0.0340 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.6151 head_norm=1.493559
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.029326e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.6142 head_norm=1.280265 delta_norm=0.502933
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.3594 head_norm=1.246323
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.506936e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.3594 head_norm=1.255442 delta_norm=0.350694
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.3319 head_norm=1.358278
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.049870e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.3316 head_norm=1.525797 delta_norm=0.404987
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.860482 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8892278881175937, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8737728930384567, 'psi': 0.3674775928297055}
[S3] START round=23 head_norm_before_train=1.771785 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 3.586937156030485, 'psi': 0.29773995791014735}-{'f1_val': 0.29406105134260474, 'auprc': 0.29406105134260474, 'loss_val': 3.150866220496028, 'psi': 0.29406105134260474}
[S4] START round=23 head_norm_before_train=2.051350 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2235051704548006, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2137818168148717, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.650102 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.3564504917380273, 'psi': 0.333168561542264}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.3359294141777394, 'psi': 0.333168561542264}
[S6] START round=23 head_norm_before_train=1.866581 (no previous merge yet)
[S6] round=23 local utility u=0.219411 metrics={'f1_val': 0.029504504504504505, 'auprc': 0.029504504504504505, 'loss_val': 6.365887393760245, 'psi': 0.029504504504504505}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.699141108207047, 'psi': 0.017774699907663897}
[S7] START round=23 head_norm_before_train=1.706831 cos_to_last_merge=0.9997 (last merge round=21)
[S7] round=23 local utility u=0.052838 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.7342119696179983, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.8398870870579759, 'psi': 0.33316757831924415}
[S8] START round=23 head_norm_before_train=1.255442 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.008769 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.001736850424103, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0192754620260278, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.766123 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.521612952220121, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4938032989215677, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=2.011379 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.27481116584564863, 'auprc': 0.27481116584564863, 'loss_val': 1.5327490179130825, 'psi': 0.27481116584564863}-{'f1_val': 0.2833536502776649, 'auprc': 0.2833536502776649, 'loss_val': 1.5079952269894525, 'psi': 0.2833536502776649}
[S11] START round=23 head_norm_before_train=1.525797 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.32980806893850373, 'auprc': 0.32980806893850373, 'loss_val': 1.9133592808903956, 'psi': 0.32980806893850373}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.8919768608265584, 'psi': 0.3319360347772085}
[S13] START round=23 head_norm_before_train=1.729543 (no previous merge yet)
[S13] round=23 local utility u=0.497517 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3989950091931458, 'psi': 0.3599362944611573}-{'f1_val': 0.24025513819985825, 'auprc': 0.24025513819985825, 'loss_val': 1.3168990654955361, 'psi': 0.24025513819985825}
[S14] START round=23 head_norm_before_train=1.798545 cos_to_last_merge=0.9866 (last merge round=15)
[S14] round=23 local utility u=0.027558 metrics={'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 4.235324816292454, 'psi': 0.13172448466566114}-{'f1_val': 0.12081569834551752, 'auprc': 0.12081569834551752, 'loss_val': 4.192261583503372, 'psi': 0.12081569834551753}
[S15] START round=23 head_norm_before_train=1.280265 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.008851 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5377951727622086, 'psi': 0.6163342951580373}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5441816075229364, 'psi': 0.6150769866718802}
[S16] START round=23 head_norm_before_train=1.835944 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.12405901836796146, 'auprc': 0.12405901836796146, 'loss_val': 3.9362017717209636, 'psi': 0.12405901836796146}-{'f1_val': 0.13761737089201878, 'auprc': 0.13761737089201878, 'loss_val': 3.7060340342835705, 'psi': 0.13761737089201878}
[S17] START round=23 head_norm_before_train=1.819344 (no previous merge yet)
[S17] round=23 local utility u=0.006715 metrics={'f1_val': 0.2515796332926272, 'auprc': 0.2515796332926272, 'loss_val': 0.8297151748896047, 'psi': 0.2515796332926272}-{'f1_val': 0.2500971808178988, 'auprc': 0.2500971808178988, 'loss_val': 0.829803043084827, 'psi': 0.2500971808178988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:52815
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.132)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.030)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:52810
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:52817
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S13
[S7] cosine check vs S13: cos=0.9933
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=-0.0847
[S9] DROPPED delta from S15 (cos=-0.0847 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] cosine check vs S8: cos=0.7998
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=-0.0353
[S17] DROPPED delta from S7 (cos=-0.0353 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] cosine check vs S17: cos=-0.0347
[S13] DROPPED delta from S17 (cos=-0.0347 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.6163 head_norm=1.368069
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.287969e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.6163 head_norm=1.284973 delta_norm=0.428797
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.3332 head_norm=1.723176
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.001151e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.3332 head_norm=1.727517 delta_norm=0.100115
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.871204 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9091170355337055, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8892278881175937, 'psi': 0.3674775928297055}
[S3] START round=24 head_norm_before_train=1.786712 (no previous merge yet)
[S3] round=24 local utility u=0.136029 metrics={'f1_val': 0.2953813104189044, 'auprc': 0.2953813104189044, 'loss_val': 3.293651402951144, 'psi': 0.2953813104189044}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 3.586937156030485, 'psi': 0.29773995791014735}
[S4] START round=24 head_norm_before_train=2.075867 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2330161562644744, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2235051704548006, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.670321 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.3693863238553794, 'psi': 0.333168561542264}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.3564504917380273, 'psi': 0.333168561542264}
[S6] START round=24 head_norm_before_train=1.878501 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.6851396642333505, 'psi': 0.02153000458085204}-{'f1_val': 0.029504504504504505, 'auprc': 0.029504504504504505, 'loss_val': 6.365887393760245, 'psi': 0.029504504504504505}
[S7] START round=24 head_norm_before_train=1.727517 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.027375 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6794615249736635, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.7342119696179983, 'psi': 0.33316757831924415}
[S8] START round=24 head_norm_before_train=1.341056 cos_to_last_merge=0.9885 (last merge round=22)
[S8] round=24 local utility u=0.015333 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9710718024429924, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.001736850424103, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.777399 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.552614092787173, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.521612952220121, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=2.035745 (no previous merge yet)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.27308922394099605, 'auprc': 0.27308922394099605, 'loss_val': 1.5634505966113326, 'psi': 0.27308922394099605}-{'f1_val': 0.27481116584564863, 'auprc': 0.27481116584564863, 'loss_val': 1.5327490179130825, 'psi': 0.27481116584564863}
[S11] START round=24 head_norm_before_train=1.537319 cos_to_last_merge=0.9993 (last merge round=22)
[S11] round=24 local utility u=0.000285 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 1.9333271526246996, 'psi': 0.3320901320901321}-{'f1_val': 0.32980806893850373, 'auprc': 0.32980806893850373, 'loss_val': 1.9133592808903956, 'psi': 0.32980806893850373}
[S13] START round=24 head_norm_before_train=1.737625 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4211115557652934, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3989950091931458, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.821518 cos_to_last_merge=0.9838 (last merge round=15)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.11700891127469974, 'auprc': 0.11700891127469974, 'loss_val': 4.336955698842755, 'psi': 0.11700891127469976}-{'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 4.235324816292454, 'psi': 0.13172448466566114}
[S15] START round=24 head_norm_before_train=1.284973 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.006810 metrics={'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.5216677151883669, 'psi': 0.6160556042184989}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5377951727622086, 'psi': 0.6163342951580373}
[S16] START round=24 head_norm_before_train=1.851068 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.09061799551713096, 'auprc': 0.09061799551713096, 'loss_val': 4.266835697154577, 'psi': 0.09061799551713096}-{'f1_val': 0.12405901836796146, 'auprc': 0.12405901836796146, 'loss_val': 3.9362017717209636, 'psi': 0.12405901836796146}
[S17] START round=24 head_norm_before_train=1.834381 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.2119152475178989, 'auprc': 0.2119152475178989, 'loss_val': 0.9107768183807062, 'psi': 0.2119152475178989}-{'f1_val': 0.2515796332926272, 'auprc': 0.2515796332926272, 'loss_val': 0.8297151748896047, 'psi': 0.2515796332926272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:52812
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:52817
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:52810
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=-0.0880
[S9] DROPPED delta from S15 (cos=-0.0880 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] cosine check vs S11: cos=0.8462
[S17] RECEIVED delta(kind=head bytes=1804) from S7
[S17] cosine check vs S7: cos=-0.0338
[S17] DROPPED delta from S7 (cos=-0.0338 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.9137
[S11] RECEIVED delta(kind=head bytes=1806) from S3
[S11] cosine check vs S3: cos=0.9659
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.6161 head_norm=1.375304
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.927113e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.6152 head_norm=1.372608 delta_norm=0.292711
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.3321 head_norm=1.556062
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.497173e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.3321 head_norm=1.662926 delta_norm=0.249717
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.3594 head_norm=1.431086
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.185425e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.3594 head_norm=1.435092 delta_norm=0.418542
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.881509 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9298757215358937, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9091170355337055, 'psi': 0.3674775928297055}
[S3] START round=25 head_norm_before_train=1.798342 (no previous merge yet)
[S3] round=25 local utility u=0.013499 metrics={'f1_val': 0.2939162496707927, 'auprc': 0.2939162496707927, 'loss_val': 3.253467509198838, 'psi': 0.2939162496707927}-{'f1_val': 0.2953813104189044, 'auprc': 0.2953813104189044, 'loss_val': 3.293651402951144, 'psi': 0.2953813104189044}
[S4] START round=25 head_norm_before_train=2.087536 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2399481039486644, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2330161562644744, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.693593 (no previous merge yet)
[S5] round=25 local utility u=0.007310 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.3547673096567, 'psi': 0.333168561542264}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.3693863238553794, 'psi': 0.333168561542264}
[S6] START round=25 head_norm_before_train=1.890228 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 6.843369252705172, 'psi': 0.021310724106324473}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.6851396642333505, 'psi': 0.02153000458085204}
[S7] START round=25 head_norm_before_train=1.743192 cos_to_last_merge=0.9998 (last merge round=23)
[S7] round=25 local utility u=0.030831 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6177994678032838, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6794615249736635, 'psi': 0.33316757831924415}
[S8] START round=25 head_norm_before_train=1.435092 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9937707169070106, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9710718024429924, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.788142 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5805123011076114, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.552614092787173, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=2.056786 (no previous merge yet)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.27028423772609816, 'auprc': 0.27028423772609816, 'loss_val': 1.59494328517685, 'psi': 0.27028423772609816}-{'f1_val': 0.27308922394099605, 'auprc': 0.27308922394099605, 'loss_val': 1.5634505966113326, 'psi': 0.27308922394099605}
[S11] START round=25 head_norm_before_train=1.662926 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.020130 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 1.8930671291226744, 'psi': 0.3320901320901321}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 1.9333271526246996, 'psi': 0.3320901320901321}
[S13] START round=25 head_norm_before_train=1.749172 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5026178853540095, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4211115557652934, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.843186 cos_to_last_merge=0.9812 (last merge round=15)
[S14] round=25 local utility u=0.007581 metrics={'f1_val': 0.1262222222222222, 'auprc': 0.1262222222222222, 'loss_val': 4.404712675256369, 'psi': 0.1262222222222222}-{'f1_val': 0.11700891127469974, 'auprc': 0.11700891127469974, 'loss_val': 4.336955698842755, 'psi': 0.11700891127469976}
[S15] START round=25 head_norm_before_train=1.372608 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.012456 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.4992646566514258, 'psi': 0.6163342951580373}-{'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.5216677151883669, 'psi': 0.6160556042184989}
[S16] START round=25 head_norm_before_train=1.863361 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 4.432762223845315, 'psi': 0.09036289353520788}-{'f1_val': 0.09061799551713096, 'auprc': 0.09061799551713096, 'loss_val': 4.266835697154577, 'psi': 0.09061799551713096}
[S17] START round=25 head_norm_before_train=1.852843 (no previous merge yet)
[S17] round=25 local utility u=0.262304 metrics={'f1_val': 0.264430476837624, 'auprc': 0.264430476837624, 'loss_val': 0.8588058858616071, 'psi': 0.264430476837624}-{'f1_val': 0.2119152475178989, 'auprc': 0.2119152475178989, 'loss_val': 0.9107768183807062, 'psi': 0.2119152475178989}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.126)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] cosine check vs S15: cos=-0.0834
[S9] DROPPED delta from S15 (cos=-0.0834 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] cosine check vs S11: cos=0.9201
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] cosine check vs S5: cos=0.2106
[S17] RECEIVED delta(kind=head bytes=1800) from S7
[S17] cosine check vs S7: cos=-0.0335
[S17] DROPPED delta from S7 (cos=-0.0335 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.9868
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] cosine check vs S17: cos=-0.0330
[S13] DROPPED delta from S17 (cos=-0.0330 < 0.0)
[S2] ⇄ pheromone p=0.062 → S8@127.0.0.1:52809
[S9] ⇄ pheromone p=0.029 → S17@127.0.0.1:52817
[S4] ⇄ pheromone p=0.017 → S8@127.0.0.1:52809
[S14] ⇄ pheromone p=0.056 → S8@127.0.0.1:52809
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.3594 head_norm=1.503297
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.289554e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.3594 head_norm=1.558014 delta_norm=0.328955
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.024 → S15@127.0.0.1:52815
[S10] ⇄ pheromone p=0.030 → S14@127.0.0.1:52814
[S13] ⇄ pheromone p=0.153 → S7@127.0.0.1:52808
[S6] ⇄ pheromone p=0.072 → S17@127.0.0.1:52817
[S7] ⇄ pheromone p=0.121 → S17@127.0.0.1:52817
[S3] ⇄ pheromone p=0.067 → S11@127.0.0.1:52812
[S15] ⇄ pheromone p=0.038 → S9@127.0.0.1:52810
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.3321 head_norm=1.676704
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.879777e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.3321 head_norm=1.427976 delta_norm=0.487978
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.076 → S8@127.0.0.1:52809
[S5] ⇄ pheromone p=0.043 → S11@127.0.0.1:52812
[S16] ⇄ pheromone p=0.116 → S7@127.0.0.1:52808
[S17] ⇄ pheromone p=0.115 → S13@127.0.0.1:52813
[S2] START round=26 head_norm_before_train=1.891412 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.949144506585461, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9298757215358937, 'psi': 0.3674775928297055}
[S3] START round=26 head_norm_before_train=1.810982 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.297351598173516, 'auprc': 0.297351598173516, 'loss_val': 3.6301616337968685, 'psi': 0.297351598173516}-{'f1_val': 0.2939162496707927, 'auprc': 0.2939162496707927, 'loss_val': 3.253467509198838, 'psi': 0.2939162496707927}
[S4] START round=26 head_norm_before_train=2.102408 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2528392626846143, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2399481039486644, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.714876 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.3707252999786306, 'psi': 0.333168561542264}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.3547673096567, 'psi': 0.333168561542264}
[S6] START round=26 head_norm_before_train=1.902340 (no previous merge yet)
[S6] round=26 local utility u=0.304667 metrics={'f1_val': 0.05286815068493151, 'auprc': 0.05286815068493151, 'loss_val': 6.518052583778163, 'psi': 0.05286815068493152}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 6.843369252705172, 'psi': 0.021310724106324473}
[S7] START round=26 head_norm_before_train=1.758717 cos_to_last_merge=0.9993 (last merge round=23)
[S7] round=26 local utility u=0.029183 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5594331338652885, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6177994678032838, 'psi': 0.33316757831924415}
[S8] START round=26 head_norm_before_train=1.558014 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.024425175752923, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9937707169070106, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.798168 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6042946265455003, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5805123011076114, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=2.076464 (no previous merge yet)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.27007487735605473, 'auprc': 0.27007487735605473, 'loss_val': 1.625040976588957, 'psi': 0.27007487735605473}-{'f1_val': 0.27028423772609816, 'auprc': 0.27028423772609816, 'loss_val': 1.59494328517685, 'psi': 0.27028423772609816}
[S11] START round=26 head_norm_before_train=1.427976 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 1.9130224560666083, 'psi': 0.3320901320901321}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 1.8930671291226744, 'psi': 0.3320901320901321}
[S13] START round=26 head_norm_before_train=1.761355 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.24008498583569404, 'auprc': 0.24008498583569404, 'loss_val': 1.5028947208155876, 'psi': 0.24008498583569404}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5026178853540095, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.862975 cos_to_last_merge=0.9789 (last merge round=15)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.1224907300856668, 'auprc': 0.1224907300856668, 'loss_val': 4.498013850577815, 'psi': 0.1224907300856668}-{'f1_val': 0.1262222222222222, 'auprc': 0.1262222222222222, 'loss_val': 4.404712675256369, 'psi': 0.1262222222222222}
[S15] START round=26 head_norm_before_train=1.471785 cos_to_last_merge=0.9875 (last merge round=24)
[S15] round=26 local utility u=0.012645 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.46265956266188857, 'psi': 0.6150769866718802}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.4992646566514258, 'psi': 0.6163342951580373}
[S16] START round=26 head_norm_before_train=1.875006 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 4.48490110139877, 'psi': 0.09036289353520788}-{'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 4.432762223845315, 'psi': 0.09036289353520788}
[S17] START round=26 head_norm_before_train=1.864103 (no previous merge yet)
[S17] round=26 local utility u=0.018505 metrics={'f1_val': 0.2695941581962286, 'auprc': 0.2695941581962286, 'loss_val': 0.8682693913249856, 'psi': 0.2695941581962286}-{'f1_val': 0.264430476837624, 'auprc': 0.264430476837624, 'loss_val': 0.8588058858616071, 'psi': 0.264430476837624}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.053)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:52810
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=-0.0867
[S9] DROPPED delta from S15 (cos=-0.0867 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S7
[S17] cosine check vs S7: cos=-0.0335
[S17] DROPPED delta from S7 (cos=-0.0335 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1806 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1806) from S17
[S13] cosine check vs S17: cos=-0.0334
[S13] DROPPED delta from S17 (cos=-0.0334 < 0.0)
[S2] START round=27 head_norm_before_train=1.901054 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9705448113506865, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.949144506585461, 'psi': 0.3674775928297055}
[S3] START round=27 head_norm_before_train=1.824307 (no previous merge yet)
[S3] round=27 local utility u=0.086392 metrics={'f1_val': 0.29427153811456924, 'auprc': 0.29427153811456924, 'loss_val': 3.4296565022479135, 'psi': 0.29427153811456924}-{'f1_val': 0.297351598173516, 'auprc': 0.297351598173516, 'loss_val': 3.6301616337968685, 'psi': 0.297351598173516}
[S4] START round=27 head_norm_before_train=2.125234 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.27180857099292, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2528392626846143, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.731899 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.372345237617836, 'psi': 0.333168561542264}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.3707252999786306, 'psi': 0.333168561542264}
[S6] START round=27 head_norm_before_train=1.914312 (no previous merge yet)
[S6] round=27 local utility u=0.266445 metrics={'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 6.406244251101363, 'psi': 0.09965504024530472}-{'f1_val': 0.05286815068493151, 'auprc': 0.05286815068493151, 'loss_val': 6.518052583778163, 'psi': 0.05286815068493152}
[S7] START round=27 head_norm_before_train=1.771479 cos_to_last_merge=0.9988 (last merge round=23)
[S7] round=27 local utility u=0.021466 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5165003252496779, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5594331338652885, 'psi': 0.33316757831924415}
[S8] START round=27 head_norm_before_train=1.615858 cos_to_last_merge=0.9964 (last merge round=25)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0354486714841187, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.024425175752923, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.807310 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6249326418137446, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6042946265455003, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=2.094217 (no previous merge yet)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.2696050003221857, 'auprc': 0.2696050003221857, 'loss_val': 1.6555639734808925, 'psi': 0.2696050003221857}-{'f1_val': 0.27007487735605473, 'auprc': 0.27007487735605473, 'loss_val': 1.625040976588957, 'psi': 0.27007487735605473}
[S11] START round=27 head_norm_before_train=1.450009 cos_to_last_merge=0.9980 (last merge round=25)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 1.9367437628242345, 'psi': 0.33201273984308244}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 1.9130224560666083, 'psi': 0.3320901320901321}
[S13] START round=27 head_norm_before_train=1.772546 (no previous merge yet)
[S13] round=27 local utility u=0.510785 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5599860348117105, 'psi': 0.3599362944611573}-{'f1_val': 0.24008498583569404, 'auprc': 0.24008498583569404, 'loss_val': 1.5028947208155876, 'psi': 0.24008498583569404}
[S14] START round=27 head_norm_before_train=1.880904 cos_to_last_merge=0.9768 (last merge round=15)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.11913032291264634, 'auprc': 0.11913032291264634, 'loss_val': 4.603552918445681, 'psi': 0.11913032291264634}-{'f1_val': 0.1224907300856668, 'auprc': 0.1224907300856668, 'loss_val': 4.498013850577815, 'psi': 0.1224907300856668}
[S15] START round=27 head_norm_before_train=1.574537 cos_to_last_merge=0.9677 (last merge round=24)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.47082316738546875, 'psi': 0.6149367764291455}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.46265956266188857, 'psi': 0.6150769866718802}
[S16] START round=27 head_norm_before_train=1.886348 (no previous merge yet)
[S16] round=27 local utility u=0.164351 metrics={'f1_val': 0.10610657331777518, 'auprc': 0.10610657331777518, 'loss_val': 4.297892199581696, 'psi': 0.10610657331777518}-{'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 4.48490110139877, 'psi': 0.09036289353520788}
[S17] START round=27 head_norm_before_train=1.876474 (no previous merge yet)
[S17] round=27 local utility u=0.505975 metrics={'f1_val': 0.38123496285764125, 'auprc': 0.38123496285764125, 'loss_val': 0.8610867639123616, 'psi': 0.38123496285764125}-{'f1_val': 0.2695941581962286, 'auprc': 0.2695941581962286, 'loss_val': 0.8682693913249856, 'psi': 0.2695941581962286}
[S16] not sending this round → trigger blocked (psi=0.106)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.100)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S13
[S7] cosine check vs S13: cos=0.9933
[S11] RECEIVED delta(kind=head bytes=1802) from S3
[S11] cosine check vs S3: cos=0.9102
[S17] RECEIVED delta(kind=head bytes=1801) from S7
[S17] cosine check vs S7: cos=-0.0337
[S17] DROPPED delta from S7 (cos=-0.0337 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S17
[S13] cosine check vs S17: cos=-0.0353
[S13] DROPPED delta from S17 (cos=-0.0353 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.3320 head_norm=1.477484
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.925675e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.3320 head_norm=1.619856 delta_norm=0.392568
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.3332 head_norm=1.780125
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.031615e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.3332 head_norm=1.780385 delta_norm=0.103162
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.910340 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9945836243847177, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9705448113506865, 'psi': 0.3674775928297055}
[S3] START round=28 head_norm_before_train=1.836607 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.297351598173516, 'auprc': 0.297351598173516, 'loss_val': 3.6906919308391206, 'psi': 0.297351598173516}-{'f1_val': 0.29427153811456924, 'auprc': 0.29427153811456924, 'loss_val': 3.4296565022479135, 'psi': 0.29427153811456924}
[S4] START round=28 head_norm_before_train=2.145109 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2733197818824802, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.27180857099292, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.747237 (no previous merge yet)
[S5] round=28 local utility u=0.032171 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.308003190036198, 'psi': 0.333168561542264}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.372345237617836, 'psi': 0.333168561542264}
[S6] START round=28 head_norm_before_train=1.925728 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.212779406698008, 'psi': 0.02065167508031207}-{'f1_val': 0.09965504024530472, 'auprc': 0.09965504024530472, 'loss_val': 6.406244251101363, 'psi': 0.09965504024530472}
[S7] START round=28 head_norm_before_train=1.780385 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5298795935768991, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5165003252496779, 'psi': 0.33316757831924415}
[S8] START round=28 head_norm_before_train=1.681154 cos_to_last_merge=0.9886 (last merge round=25)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0677342729778776, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0354486714841187, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.815930 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6462679673531846, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6249326418137446, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=2.110992 (no previous merge yet)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.267587618316705, 'auprc': 0.267587618316705, 'loss_val': 1.6890759413345533, 'psi': 0.267587618316705}-{'f1_val': 0.2696050003221857, 'auprc': 0.2696050003221857, 'loss_val': 1.6555639734808925, 'psi': 0.2696050003221857}
[S11] START round=28 head_norm_before_train=1.619856 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 1.9402302284369353, 'psi': 0.33216756042589574}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 1.9367437628242345, 'psi': 0.33201273984308244}
[S13] START round=28 head_norm_before_train=1.786611 (no previous merge yet)
[S13] round=28 local utility u=0.027466 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.505054027702532, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5599860348117105, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.896849 cos_to_last_merge=0.9750 (last merge round=15)
[S14] round=28 local utility u=0.015256 metrics={'f1_val': 0.13010590015128592, 'auprc': 0.13010590015128592, 'loss_val': 4.671820937091818, 'psi': 0.13010590015128592}-{'f1_val': 0.11913032291264634, 'auprc': 0.11913032291264634, 'loss_val': 4.603552918445681, 'psi': 0.11913032291264634}
[S15] START round=28 head_norm_before_train=1.649485 cos_to_last_merge=0.9544 (last merge round=24)
[S15] round=28 local utility u=0.001727 metrics={'f1_val': 0.6154970049053944, 'auprc': 0.6154970049053944, 'loss_val': 0.4724112155741511, 'psi': 0.6154970049053944}-{'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.47082316738546875, 'psi': 0.6149367764291455}
[S16] START round=28 head_norm_before_train=1.897444 (no previous merge yet)
[S16] round=28 local utility u=0.330714 metrics={'f1_val': 0.14051214707813525, 'auprc': 0.14051214707813525, 'loss_val': 3.946113540303813, 'psi': 0.14051214707813525}-{'f1_val': 0.10610657331777518, 'auprc': 0.10610657331777518, 'loss_val': 4.297892199581696, 'psi': 0.10610657331777518}
[S17] START round=28 head_norm_before_train=1.884822 (no previous merge yet)
[S17] round=28 local utility u=0.074525 metrics={'f1_val': 0.40037125303281806, 'auprc': 0.40037125303281806, 'loss_val': 0.8842642726160207, 'psi': 0.40037125303281806}-{'f1_val': 0.38123496285764125, 'auprc': 0.38123496285764125, 'loss_val': 0.8610867639123616, 'psi': 0.38123496285764125}
[S16] not sending this round → trigger blocked (psi=0.141)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:52808
[S14] not sending this round → trigger blocked (psi=0.130)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:52810
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] cosine check vs S5: cos=0.2930
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=-0.0875
[S9] DROPPED delta from S15 (cos=-0.0875 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=0.9976
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=-0.0359
[S13] DROPPED delta from S17 (cos=-0.0359 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.3332 head_norm=1.786336
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.204147e-02
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.3332 head_norm=1.790731 delta_norm=0.062041
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.3322 head_norm=1.638366
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.011961e+00
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.3181 head_norm=1.367399 delta_norm=1.011961
[S11] aggregate: ROLLBACK (f1_val pre=0.332 post=0.318 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=1.919055 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.24490791559946334, 'auprc': 0.24490791559946334, 'loss_val': 3.0126056132697507, 'psi': 0.24490791559946334}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9945836243847177, 'psi': 0.3674775928297055}
[S3] START round=29 head_norm_before_train=1.848392 (no previous merge yet)
[S3] round=29 local utility u=0.060967 metrics={'f1_val': 0.2958924027626318, 'auprc': 0.2958924027626318, 'loss_val': 3.555624392180058, 'psi': 0.2958924027626318}-{'f1_val': 0.297351598173516, 'auprc': 0.297351598173516, 'loss_val': 3.6906919308391206, 'psi': 0.297351598173516}
[S4] START round=29 head_norm_before_train=2.154369 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2858551128502165, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2733197818824802, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.761660 (no previous merge yet)
[S5] round=29 local utility u=0.031076 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.249639787516721, 'psi': 0.33358943696313936}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 2.308003190036198, 'psi': 0.333168561542264}
[S6] START round=29 head_norm_before_train=1.936677 (no previous merge yet)
[S6] round=29 local utility u=0.070418 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 7.081819767059417, 'psi': 0.021749084249084248}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.212779406698008, 'psi': 0.02065167508031207}
[S7] START round=29 head_norm_before_train=1.790731 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5551983794217773, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5298795935768991, 'psi': 0.33316757831924415}
[S8] START round=29 head_norm_before_train=1.734013 cos_to_last_merge=0.9824 (last merge round=25)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1135874577905014, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0677342729778776, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.824332 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6698036413529613, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6462679673531846, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=2.126930 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.2678445682094616, 'auprc': 0.2678445682094616, 'loss_val': 1.7135829447974145, 'psi': 0.2678445682094616}-{'f1_val': 0.267587618316705, 'auprc': 0.267587618316705, 'loss_val': 1.6890759413345533, 'psi': 0.267587618316705}
[S11] START round=29 head_norm_before_train=1.367399 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.032412 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 1.8719308605479095, 'psi': 0.33178150217256364}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 1.9402302284369353, 'psi': 0.33216756042589574}
[S13] START round=29 head_norm_before_train=1.797258 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5501787497116288, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.505054027702532, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.911523 cos_to_last_merge=0.9733 (last merge round=15)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 4.74950901009136, 'psi': 0.13232893910860014}-{'f1_val': 0.13010590015128592, 'auprc': 0.13010590015128592, 'loss_val': 4.671820937091818, 'psi': 0.13010590015128592}
[S15] START round=29 head_norm_before_train=1.699496 cos_to_last_merge=0.9465 (last merge round=24)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=29 local utility u=0.006903 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.46614041769442444, 'psi': 0.6163342951580373}-{'f1_val': 0.6154970049053944, 'auprc': 0.6154970049053944, 'loss_val': 0.4724112155741511, 'psi': 0.6154970049053944}
[S16] START round=29 head_norm_before_train=1.907737 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.0894132755437836, 'auprc': 0.0894132755437836, 'loss_val': 4.815368381748585, 'psi': 0.0894132755437836}-{'f1_val': 0.14051214707813525, 'auprc': 0.14051214707813525, 'loss_val': 3.946113540303813, 'psi': 0.14051214707813525}
[S17] START round=29 head_norm_before_train=1.905398 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.39625141461058155, 'auprc': 0.39625141461058155, 'loss_val': 0.919351900795427, 'psi': 0.39625141461058155}-{'f1_val': 0.40037125303281806, 'auprc': 0.40037125303281806, 'loss_val': 0.8842642726160207, 'psi': 0.40037125303281806}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:52812
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S6] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:52812
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:52810
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] cosine check vs S11: cos=0.7906
[S11] RECEIVED delta(kind=head bytes=1804) from S5
[S11] cosine check vs S5: cos=0.8164
[S15] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=-0.0873
[S9] DROPPED delta from S15 (cos=-0.0873 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=0.6568
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.3594 head_norm=1.771063
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.422649e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.3594 head_norm=1.499170 delta_norm=0.542265
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.3318 head_norm=1.395156
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.356631e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.3318 head_norm=1.371459 delta_norm=0.135663
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.927438 (no previous merge yet)
[S2] round=30 local utility u=0.545467 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.024798073939135, 'psi': 0.3674775928297055}-{'f1_val': 0.24490791559946334, 'auprc': 0.24490791559946334, 'loss_val': 3.0126056132697507, 'psi': 0.24490791559946334}
[S3] START round=30 head_norm_before_train=1.858802 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.2946873020182822, 'auprc': 0.2946873020182822, 'loss_val': 3.548739659844699, 'psi': 0.2946873020182822}-{'f1_val': 0.2958924027626318, 'auprc': 0.2958924027626318, 'loss_val': 3.555624392180058, 'psi': 0.2958924027626318}
[S4] START round=30 head_norm_before_train=2.166186 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2922516287763548, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2858551128502165, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.774879 (no previous merge yet)
[S5] round=30 local utility u=0.035750 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.173610635908672, 'psi': 0.33308623671855697}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.249639787516721, 'psi': 0.33358943696313936}
[S6] START round=30 head_norm_before_train=1.947397 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 7.326301517484504, 'psi': 0.02109124254928932}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 7.081819767059417, 'psi': 0.021749084249084248}
[S7] START round=30 head_norm_before_train=1.799206 cos_to_last_merge=0.9999 (last merge round=28)
[S7] round=30 local utility u=0.002919 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5493602487537655, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5551983794217773, 'psi': 0.33316757831924415}
[S8] START round=30 head_norm_before_train=1.499170 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.013954 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0856798945098216, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1135874577905014, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.832669 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.693688053307768, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6698036413529613, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=2.141589 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.2678445682094616, 'auprc': 0.2678445682094616, 'loss_val': 1.737617681523883, 'psi': 0.2678445682094616}-{'f1_val': 0.2678445682094616, 'auprc': 0.2678445682094616, 'loss_val': 1.7135829447974145, 'psi': 0.2678445682094616}
[S11] START round=30 head_norm_before_train=1.371459 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.9423393224203889, 'psi': 0.3320133550741517}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 1.8719308605479095, 'psi': 0.33178150217256364}
[S13] START round=30 head_norm_before_train=1.804797 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5691498215989998, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5501787497116288, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.924920 cos_to_last_merge=0.9718 (last merge round=15)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13192612137203166, 'auprc': 0.13192612137203166, 'loss_val': 4.832575407055635, 'psi': 0.13192612137203166}-{'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 4.74950901009136, 'psi': 0.13232893910860014}
[S15] START round=30 head_norm_before_train=1.735502 cos_to_last_merge=0.9411 (last merge round=24)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.5091015676092792, 'psi': 0.6136702686915539}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.46614041769442444, 'psi': 0.6163342951580373}
[S16] START round=30 head_norm_before_train=1.916197 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 4.842669372555575, 'psi': 0.08953068592057761}-{'f1_val': 0.0894132755437836, 'auprc': 0.0894132755437836, 'loss_val': 4.815368381748585, 'psi': 0.0894132755437836}
[S17] START round=30 head_norm_before_train=1.924732 (no previous merge yet)
[S17] round=30 local utility u=0.065062 metrics={'f1_val': 0.40793608953952837, 'auprc': 0.40793608953952837, 'loss_val': 0.894389227773251, 'psi': 0.40793608953952837}-{'f1_val': 0.39625141461058155, 'auprc': 0.39625141461058155, 'loss_val': 0.919351900795427, 'psi': 0.39625141461058155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:52815
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:52812
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S7
[S17] cosine check vs S7: cos=-0.0359
[S17] DROPPED delta from S7 (cos=-0.0359 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1805) from S5
[S11] cosine check vs S5: cos=0.7772
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] cosine check vs S2: cos=0.0391
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] cosine check vs S8: cos=0.7679
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S17
[S13] cosine check vs S17: cos=-0.0360
[S13] DROPPED delta from S17 (cos=-0.0360 < 0.0)
[S6] ⇄ pheromone p=0.087 → S17@127.0.0.1:52817
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.3320 head_norm=1.401397
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.610664e-01
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.3320 head_norm=1.502302 delta_norm=0.561066
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.030 → S8@127.0.0.1:52809
[S14] ⇄ pheromone p=0.020 → S8@127.0.0.1:52809
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.6137 head_norm=1.762481
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.722219e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.6132 head_norm=1.553289 delta_norm=0.572222
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.015 → S9@127.0.0.1:52810
[S10] ⇄ pheromone p=0.010 → S14@127.0.0.1:52814
[S9] ⇄ pheromone p=0.010 → S17@127.0.0.1:52817
[S4] ⇄ pheromone p=0.005 → S8@127.0.0.1:52809
[S3] ⇄ pheromone p=0.041 → S11@127.0.0.1:52812
[S13] ⇄ pheromone p=0.106 → S7@127.0.0.1:52808
[S7] ⇄ pheromone p=0.045 → S17@127.0.0.1:52817
[S2] ⇄ pheromone p=0.129 → S8@127.0.0.1:52809
[S5] ⇄ pheromone p=0.030 → S11@127.0.0.1:52812
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.3594 head_norm=1.540763
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.213189e+00
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.3594 head_norm=1.260292 delta_norm=1.213189
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.011 → S15@127.0.0.1:52815
[S16] ⇄ pheromone p=0.097 → S7@127.0.0.1:52808
[S17] ⇄ pheromone p=0.113 → S13@127.0.0.1:52813
[S2] START round=31 head_norm_before_train=1.935555 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0385214630309734, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.024798073939135, 'psi': 0.3674775928297055}
[S3] START round=31 head_norm_before_train=1.869246 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.29438872323122794, 'auprc': 0.29438872323122794, 'loss_val': 3.5621280813561893, 'psi': 0.29438872323122794}-{'f1_val': 0.2946873020182822, 'auprc': 0.2946873020182822, 'loss_val': 3.548739659844699, 'psi': 0.2946873020182822}
[S4] START round=31 head_norm_before_train=2.174678 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3036288217998424, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2922516287763548, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.783115 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.183261390656547, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.173610635908672, 'psi': 0.33308623671855697}
[S6] START round=31 head_norm_before_train=1.957325 (no previous merge yet)
[S6] round=31 local utility u=0.079469 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 7.175254770700452, 'psi': 0.021967963386727688}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 7.326301517484504, 'psi': 0.02109124254928932}
[S7] START round=31 head_norm_before_train=1.807547 cos_to_last_merge=0.9998 (last merge round=28)
[S7] round=31 local utility u=0.004378 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5406048828349794, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5493602487537655, 'psi': 0.33316757831924415}
[S8] START round=31 head_norm_before_train=1.260292 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.075582 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9345152442772292, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0856798945098216, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.840643 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.712754069598653, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.693688053307768, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=2.155341 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.2663102285023232, 'auprc': 0.2663102285023232, 'loss_val': 1.7659094011374779, 'psi': 0.2663102285023232}-{'f1_val': 0.2678445682094616, 'auprc': 0.2678445682094616, 'loss_val': 1.737617681523883, 'psi': 0.2678445682094616}
[S11] START round=31 head_norm_before_train=1.502302 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.995537187874813, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.9423393224203889, 'psi': 0.3320133550741517}
[S13] START round=31 head_norm_before_train=1.818261 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5934102060260775, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5691498215989998, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.937071 cos_to_last_merge=0.9705 (last merge round=15)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13192612137203166, 'auprc': 0.13192612137203166, 'loss_val': 4.917874010000729, 'psi': 0.13192612137203166}-{'f1_val': 0.13192612137203166, 'auprc': 0.13192612137203166, 'loss_val': 4.832575407055635, 'psi': 0.13192612137203166}
[S15] START round=31 head_norm_before_train=1.553289 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.023812 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.4854538430974404, 'psi': 0.6163342951580373}-{'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.5091015676092792, 'psi': 0.6136702686915539}
[S16] START round=31 head_norm_before_train=1.924766 (no previous merge yet)
[S16] round=31 local utility u=0.506755 metrics={'f1_val': 0.13460261235333185, 'auprc': 0.13460261235333185, 'loss_val': 4.234805954769247, 'psi': 0.13460261235333185}-{'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 4.842669372555575, 'psi': 0.08953068592057761}
[S17] START round=31 head_norm_before_train=1.944784 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.3948132137531493, 'auprc': 0.3948132137531493, 'loss_val': 0.9812735338254971, 'psi': 0.3948132137531493}-{'f1_val': 0.40793608953952837, 'auprc': 0.40793608953952837, 'loss_val': 0.894389227773251, 'psi': 0.40793608953952837}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:52815
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:52810
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S15
[S9] cosine check vs S15: cos=-0.0771
[S9] DROPPED delta from S15 (cos=-0.0771 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=0.6032
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=-0.0357
[S17] DROPPED delta from S7 (cos=-0.0357 < 0.0)
[S16] not sending this round → trigger blocked (psi=0.135)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.6163 head_norm=1.597757
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.601349e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.6163 head_norm=1.302827 delta_norm=0.660135
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.943473 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.052093739218492, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0385214630309734, 'psi': 0.3674775928297055}
[S3] START round=32 head_norm_before_train=1.879722 (no previous merge yet)
[S3] round=32 local utility u=0.009857 metrics={'f1_val': 0.29417589341974976, 'auprc': 0.29417589341974976, 'loss_val': 3.540498141756892, 'psi': 0.29417589341974976}-{'f1_val': 0.29438872323122794, 'auprc': 0.29438872323122794, 'loss_val': 3.5621280813561893, 'psi': 0.29438872323122794}
[S4] START round=32 head_norm_before_train=2.178156 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3212867581776464, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3036288217998424, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.789797 (no previous merge yet)
[S5] round=32 local utility u=0.043226 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.09680977974263, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.183261390656547, 'psi': 0.33308623671855697}
[S6] START round=32 head_norm_before_train=1.966280 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 7.430375663709432, 'psi': 0.02109124254928932}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 7.175254770700452, 'psi': 0.021967963386727688}
[S7] START round=32 head_norm_before_train=1.819172 cos_to_last_merge=0.9995 (last merge round=28)
[S7] round=32 local utility u=0.000919 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5387672892337128, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5406048828349794, 'psi': 0.33316757831924415}
[S8] START round=32 head_norm_before_train=1.308985 cos_to_last_merge=0.9955 (last merge round=30)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9426144165057077, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9345152442772292, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.848001 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.732361602648318, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.712754069598653, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=2.168666 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.26605621264148543, 'auprc': 0.26605621264148543, 'loss_val': 1.7885657397537285, 'psi': 0.26605621264148543}-{'f1_val': 0.2663102285023232, 'auprc': 0.2663102285023232, 'loss_val': 1.7659094011374779, 'psi': 0.2663102285023232}
[S11] START round=32 head_norm_before_train=1.535245 cos_to_last_merge=0.9983 (last merge round=30)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.051434160222019, 'psi': 0.33216756042589574}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.995537187874813, 'psi': 0.3320133550741517}
[S13] START round=32 head_norm_before_train=1.834466 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.647993183711235, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5934102060260775, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.947968 cos_to_last_merge=0.9693 (last merge round=15)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 4.993332539275044, 'psi': 0.13232893910860014}-{'f1_val': 0.13192612137203166, 'auprc': 0.13192612137203166, 'loss_val': 4.917874010000729, 'psi': 0.13192612137203166}
[S15] START round=32 head_norm_before_train=1.302827 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.54951013261691, 'psi': 0.6161950003225232}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.4854538430974404, 'psi': 0.6163342951580373}
[S16] START round=32 head_norm_before_train=1.933789 (no previous merge yet)
[S16] round=32 local utility u=0.560988 metrics={'f1_val': 0.16663200942676926, 'auprc': 0.16663200942676926, 'loss_val': 3.40109392911922, 'psi': 0.16663200942676926}-{'f1_val': 0.13460261235333185, 'auprc': 0.13460261235333185, 'loss_val': 4.234805954769247, 'psi': 0.13460261235333185}
[S17] START round=32 head_norm_before_train=1.961282 (no previous merge yet)
[S17] round=32 local utility u=0.080638 metrics={'f1_val': 0.4112183734988534, 'auprc': 0.4112183734988534, 'loss_val': 0.9676431803480622, 'psi': 0.4112183734988534}-{'f1_val': 0.3948132137531493, 'auprc': 0.3948132137531493, 'loss_val': 0.9812735338254971, 'psi': 0.3948132137531493}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.167)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=0.4101
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] cosine check vs S5: cos=0.9422
[S17] RECEIVED delta(kind=head bytes=1799) from S7
[S17] cosine check vs S7: cos=-0.0360
[S17] DROPPED delta from S7 (cos=-0.0360 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=-0.0363
[S13] DROPPED delta from S17 (cos=-0.0363 < 0.0)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.3322 head_norm=1.564781
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.516857e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.3320 head_norm=1.433414 delta_norm=0.351686
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.951041 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0666267956739035, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.052093739218492, 'psi': 0.3674775928297055}
[S3] START round=33 head_norm_before_train=1.889971 (no previous merge yet)
[S3] round=33 local utility u=0.002674 metrics={'f1_val': 0.29341210168277837, 'auprc': 0.29341210168277837, 'loss_val': 3.5282752542658797, 'psi': 0.29341210168277837}-{'f1_val': 0.29417589341974976, 'auprc': 0.29417589341974976, 'loss_val': 3.540498141756892, 'psi': 0.29417589341974976}
[S4] START round=33 head_norm_before_train=2.187911 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3321695041564308, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3212867581776464, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.796943 (no previous merge yet)
[S5] round=33 local utility u=0.001757 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.093296499676351, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.09680977974263, 'psi': 0.33308623671855697}
[S6] START round=33 head_norm_before_train=1.974364 (no previous merge yet)
[S6] round=33 local utility u=0.054857 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 7.326582727742102, 'psi': 0.021749084249084248}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 7.430375663709432, 'psi': 0.02109124254928932}
[S7] START round=33 head_norm_before_train=1.830544 cos_to_last_merge=0.9991 (last merge round=28)
[S7] round=33 local utility u=0.000873 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5370207954580236, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5387672892337128, 'psi': 0.33316757831924415}
[S8] START round=33 head_norm_before_train=1.393787 cos_to_last_merge=0.9798 (last merge round=30)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9981149893689812, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9426144165057077, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.855287 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7524572939037086, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.732361602648318, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=2.181290 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.26514575411913816, 'auprc': 0.26514575411913816, 'loss_val': 1.8177388882682235, 'psi': 0.26514575411913816}-{'f1_val': 0.26605621264148543, 'auprc': 0.26605621264148543, 'loss_val': 1.7885657397537285, 'psi': 0.26605621264148543}
[S11] START round=33 head_norm_before_train=1.433414 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.023141 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.0037594695782657, 'psi': 0.33201273984308244}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.051434160222019, 'psi': 0.33216756042589574}
[S13] START round=33 head_norm_before_train=1.846080 (no previous merge yet)
[S13] round=33 local utility u=0.013262 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.621468460977049, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.647993183711235, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=1.958166 cos_to_last_merge=0.9682 (last merge round=15)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 5.065157243868726, 'psi': 0.13232893910860014}-{'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 4.993332539275044, 'psi': 0.13232893910860014}
[S15] START round=33 head_norm_before_train=1.373689 cos_to_last_merge=0.9933 (last merge round=31)
[S15] round=33 local utility u=0.032653 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.4842033211246204, 'psi': 0.6161950003225232}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.54951013261691, 'psi': 0.6161950003225232}
[S16] START round=33 head_norm_before_train=1.942743 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.13377679231337766, 'auprc': 0.13377679231337766, 'loss_val': 4.060881624132308, 'psi': 0.13377679231337766}-{'f1_val': 0.16663200942676926, 'auprc': 0.16663200942676926, 'loss_val': 3.40109392911922, 'psi': 0.16663200942676926}
[S17] START round=33 head_norm_before_train=1.972344 (no previous merge yet)
[S17] round=33 local utility u=0.000180 metrics={'f1_val': 0.4107504832801664, 'auprc': 0.4107504832801664, 'loss_val': 0.9630720229533222, 'psi': 0.4107504832801664}-{'f1_val': 0.4112183734988534, 'auprc': 0.4112183734988534, 'loss_val': 0.9676431803480622, 'psi': 0.4112183734988534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:52813
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:52817
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:52803
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S11
[S3] cosine check vs S11: cos=0.5924
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=0.8337
[S17] RECEIVED delta(kind=head bytes=1794) from S13
[S17] cosine check vs S13: cos=-0.0377
[S17] DROPPED delta from S13 (cos=-0.0377 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] cosine check vs S7: cos=0.9960
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:52807
[S17] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S17
[S6] cosine check vs S17: cos=0.0871
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.0217 head_norm=1.982296
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.339471e+00
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.0217 head_norm=1.461750 delta_norm=1.339471
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=33 metric=0.2934 head_norm=1.898165
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.829942e-01
[S3] stored merged vector for next round verification (round=33)
[S3] DEBUG after merge:  round=33 metric=0.2945 head_norm=1.502232 delta_norm=0.782994
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.3594 head_norm=1.472364
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.243453e-01
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.3594 head_norm=1.408968 delta_norm=0.424345
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.3599 head_norm=1.852237
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.265726e-02
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.3599 head_norm=1.845078 delta_norm=0.082657
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.958587 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.080334129028264, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0666267956739035, 'psi': 0.3674775928297055}
[S3] START round=34 head_norm_before_train=1.502232 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=34 local utility u=0.379494 metrics={'f1_val': 0.29345412558841816, 'auprc': 0.29345412558841816, 'loss_val': 2.7696653002442977, 'psi': 0.29345412558841816}-{'f1_val': 0.29341210168277837, 'auprc': 0.29341210168277837, 'loss_val': 3.5282752542658797, 'psi': 0.29341210168277837}
[S4] START round=34 head_norm_before_train=2.201640 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3453572751189027, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3321695041564308, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=1.811787 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.097922933860953, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.093296499676351, 'psi': 0.33308623671855697}
[S6] START round=34 head_norm_before_train=1.461750 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=1.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.439121042634136, 'psi': 0.017774699907663897}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 7.326582727742102, 'psi': 0.021749084249084248}
[S7] START round=34 head_norm_before_train=1.841605 cos_to_last_merge=0.9986 (last merge round=28)
[S7] round=34 local utility u=0.010273 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5164754809435306, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5370207954580236, 'psi': 0.33316757831924415}
[S8] START round=34 head_norm_before_train=1.408968 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0585689922732384, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9981149893689812, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.862336 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7734377202610982, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7524572939037086, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=2.194009 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.2649946165051618, 'auprc': 0.2649946165051618, 'loss_val': 1.8392030835074618, 'psi': 0.2649946165051618}-{'f1_val': 0.26514575411913816, 'auprc': 0.26514575411913816, 'loss_val': 1.8177388882682235, 'psi': 0.26514575411913816}
[S11] START round=34 head_norm_before_train=1.461688 cos_to_last_merge=0.9991 (last merge round=32)
[S11] round=34 local utility u=0.007092 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.9895805932365545, 'psi': 0.3320133550741517}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.0037594695782657, 'psi': 0.33201273984308244}
[S13] START round=34 head_norm_before_train=1.845078 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.738746225167319, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.621468460977049, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=1.967771 cos_to_last_merge=0.9672 (last merge round=15)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.121509084429298, 'psi': 0.13253012048192772}-{'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 5.065157243868726, 'psi': 0.13232893910860014}
[S15] START round=34 head_norm_before_train=1.470600 cos_to_last_merge=0.9758 (last merge round=31)
[S15] round=34 local utility u=0.005319 metrics={'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.4723114003985449, 'psi': 0.6160556042184989}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.4842033211246204, 'psi': 0.6161950003225232}
[S16] START round=34 head_norm_before_train=1.951486 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.044825199030806506, 'auprc': 0.044825199030806506, 'loss_val': 5.225259485635466, 'psi': 0.044825199030806506}-{'f1_val': 0.13377679231337766, 'auprc': 0.13377679231337766, 'loss_val': 4.060881624132308, 'psi': 0.13377679231337766}
[S17] START round=34 head_norm_before_train=1.983000 (no previous merge yet)
[S17] round=34 local utility u=0.123181 metrics={'f1_val': 0.4362614289686204, 'auprc': 0.4362614289686204, 'loss_val': 0.9463075893727296, 'psi': 0.4362614289686204}-{'f1_val': 0.4107504832801664, 'auprc': 0.4107504832801664, 'loss_val': 0.9630720229533222, 'psi': 0.4107504832801664}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:52813
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:52809
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:52803
[S15] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S11
[S3] cosine check vs S11: cos=0.8585
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=0.9986
[S8] RECEIVED delta(kind=head bytes=1804) from S15
[S8] cosine check vs S15: cos=0.9400
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:52807
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] cosine check vs S17: cos=0.7169
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.2935 head_norm=1.515254
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.996120e-01
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.2939 head_norm=1.447393 delta_norm=0.399612
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.0178 head_norm=1.513018
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.966940e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.0176 head_norm=1.627686 delta_norm=0.696694
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.3594 head_norm=1.470252
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.658766e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.3594 head_norm=1.491848 delta_norm=0.265877
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=34 metric=0.3599 head_norm=1.851728
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.875727e-02
[S13] stored merged vector for next round verification (round=34)
[S13] DEBUG after merge:  round=34 metric=0.3599 head_norm=1.850770 delta_norm=0.048757
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.965859 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.093280535460051, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.080334129028264, 'psi': 0.3674775928297055}
[S3] START round=35 head_norm_before_train=1.447393 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.062947 metrics={'f1_val': 0.297351598173516, 'auprc': 0.297351598173516, 'loss_val': 2.678847661800614, 'psi': 0.297351598173516}-{'f1_val': 0.29345412558841816, 'auprc': 0.29345412558841816, 'loss_val': 2.7696653002442977, 'psi': 0.29345412558841816}
[S4] START round=35 head_norm_before_train=2.216364 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3617564633314383, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3453572751189027, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=1.826393 (no previous merge yet)
[S5] round=35 local utility u=0.028622 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.04067931295886, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.097922933860953, 'psi': 0.33308623671855697}
[S6] START round=35 head_norm_before_train=1.627686 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.254351 metrics={'f1_val': 0.029504504504504505, 'auprc': 0.029504504504504505, 'loss_val': 4.0359873157983035, 'psi': 0.029504504504504505}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.439121042634136, 'psi': 0.017774699907663897}
[S7] START round=35 head_norm_before_train=1.851096 cos_to_last_merge=0.9982 (last merge round=28)
[S7] round=35 local utility u=0.031086 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.45430414098409216, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.5164754809435306, 'psi': 0.33316757831924415}
[S8] START round=35 head_norm_before_train=1.491848 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0910085696279197, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0585689922732384, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.869252 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7922426845316837, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7734377202610982, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=2.205426 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.2648939537828427, 'auprc': 0.2648939537828427, 'loss_val': 1.8580085502396593, 'psi': 0.2648939537828427}-{'f1_val': 0.2649946165051618, 'auprc': 0.2649946165051618, 'loss_val': 1.8392030835074618, 'psi': 0.2649946165051618}
[S11] START round=35 head_norm_before_train=1.487709 cos_to_last_merge=0.9972 (last merge round=32)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.0841664194646623, 'psi': 0.33216756042589574}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 1.9895805932365545, 'psi': 0.3320133550741517}
[S13] START round=35 head_norm_before_train=1.850770 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7647758021279352, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.738746225167319, 'psi': 0.3599362944611573}
[S14] START round=35 head_norm_before_train=1.977094 cos_to_last_merge=0.9662 (last merge round=15)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.175753973648279, 'psi': 0.13253012048192772}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.121509084429298, 'psi': 0.13253012048192772}
[S15] START round=35 head_norm_before_train=1.559155 cos_to_last_merge=0.9595 (last merge round=31)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.4801635207925995, 'psi': 0.6161950003225232}-{'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.4723114003985449, 'psi': 0.6160556042184989}
[S16] START round=35 head_norm_before_train=1.959957 (no previous merge yet)
[S16] round=35 local utility u=0.079429 metrics={'f1_val': 0.05946950498394999, 'auprc': 0.05946950498394999, 'loss_val': 5.198199993396756, 'psi': 0.05946950498394998}-{'f1_val': 0.044825199030806506, 'auprc': 0.044825199030806506, 'loss_val': 5.225259485635466, 'psi': 0.044825199030806506}
[S17] START round=35 head_norm_before_train=1.995060 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.3948132137531493, 'auprc': 0.3948132137531493, 'loss_val': 1.1149746543896968, 'psi': 0.3948132137531493}-{'f1_val': 0.4362614289686204, 'auprc': 0.4362614289686204, 'loss_val': 0.9463075893727296, 'psi': 0.4362614289686204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.030)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.059)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:52813
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=0.9994
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.3599 head_norm=1.866740
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.342266e-02
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.3599 head_norm=1.863796 delta_norm=0.033423
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.036 → S17@127.0.0.1:52817
[S15] ⇄ pheromone p=0.012 → S8@127.0.0.1:52809
[S8] ⇄ pheromone p=0.010 → S2@127.0.0.1:52802
[S11] ⇄ pheromone p=0.014 → S3@127.0.0.1:52803
[S9] ⇄ pheromone p=0.003 → S15@127.0.0.1:52815
[S14] ⇄ pheromone p=0.007 → S10@127.0.0.1:52811
[S7] ⇄ pheromone p=0.023 → S13@127.0.0.1:52813
[S17] ⇄ pheromone p=0.065 → S6@127.0.0.1:52807
[S2] START round=36 head_norm_before_train=1.972840 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1079683548283903, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.093280535460051, 'psi': 0.3674775928297055}
[S3] START round=36 head_norm_before_train=1.471982 cos_to_last_merge=0.9998 (last merge round=34)
[S3] round=36 local utility u=0.102330 metrics={'f1_val': 0.2764159508345555, 'auprc': 0.2764159508345555, 'loss_val': 2.285766165275053, 'psi': 0.2764159508345555}-{'f1_val': 0.297351598173516, 'auprc': 0.297351598173516, 'loss_val': 2.678847661800614, 'psi': 0.297351598173516}
[S4] START round=36 head_norm_before_train=2.227576 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3865448592370755, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3617564633314383, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=1.841513 (no previous merge yet)
[S5] round=36 local utility u=0.038714 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9632508448043844, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.04067931295886, 'psi': 0.33308623671855697}
[S6] START round=36 head_norm_before_train=1.724219 cos_to_last_merge=0.9900 (last merge round=34)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.08877952755905512, 'auprc': 0.08877952755905512, 'loss_val': 4.835399440088275, 'psi': 0.08877952755905512}-{'f1_val': 0.029504504504504505, 'auprc': 0.029504504504504505, 'loss_val': 4.0359873157983035, 'psi': 0.029504504504504505}
[S7] START round=36 head_norm_before_train=1.861447 cos_to_last_merge=0.9979 (last merge round=28)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.24968897735755163, 'auprc': 0.24968897735755163, 'loss_val': 0.4146085379168616, 'psi': 0.24968897735755163}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.45430414098409216, 'psi': 0.33316757831924415}
[S8] START round=36 head_norm_before_train=1.534880 cos_to_last_merge=0.9995 (last merge round=34)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1366200584291404, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0910085696279197, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=1.875692 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.811297640526823, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7922426845316837, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=2.215936 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.26454223571067276, 'auprc': 0.26454223571067276, 'loss_val': 1.8827959531601237, 'psi': 0.26454223571067276}-{'f1_val': 0.2648939537828427, 'auprc': 0.2648939537828427, 'loss_val': 1.8580085502396593, 'psi': 0.2648939537828427}
[S11] START round=36 head_norm_before_train=1.511996 cos_to_last_merge=0.9949 (last merge round=32)
[S11] round=36 local utility u=0.004419 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.0739413502757285, 'psi': 0.3320133550741517}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.0841664194646623, 'psi': 0.33216756042589574}
[S13] START round=36 head_norm_before_train=1.863796 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7811837787555829, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7647758021279352, 'psi': 0.3599362944611573}
[S14] START round=36 head_norm_before_train=1.985948 cos_to_last_merge=0.9652 (last merge round=15)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13192612137203166, 'auprc': 0.13192612137203166, 'loss_val': 5.232281638762122, 'psi': 0.13192612137203166}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 5.175753973648279, 'psi': 0.13253012048192772}
[S15] START round=36 head_norm_before_train=1.625603 cos_to_last_merge=0.9486 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.49128814795318637, 'psi': 0.6163342951580373}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.4801635207925995, 'psi': 0.6161950003225232}
[S16] START round=36 head_norm_before_train=1.967307 (no previous merge yet)
[S16] round=36 local utility u=0.766788 metrics={'f1_val': 0.13282985339848954, 'auprc': 0.13282985339848954, 'loss_val': 4.324868127587377, 'psi': 0.13282985339848954}-{'f1_val': 0.05946950498394999, 'auprc': 0.05946950498394999, 'loss_val': 5.198199993396756, 'psi': 0.05946950498394998}
[S17] START round=36 head_norm_before_train=2.008115 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.39720845833697094, 'auprc': 0.39720845833697094, 'loss_val': 1.1986598537704392, 'psi': 0.39720845833697094}-{'f1_val': 0.3948132137531493, 'auprc': 0.3948132137531493, 'loss_val': 1.1149746543896968, 'psi': 0.3948132137531493}
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S13
[S8]  timeout peer S16
[S8]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S8
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S4
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.133)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:52803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[S11] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.9534
[S3] RECEIVED delta(kind=head bytes=1798) from S11
[S3] cosine check vs S11: cos=0.9534
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=36 metric=0.2764 head_norm=1.502204
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.324633e-01
[S3] stored merged vector for next round verification (round=36)
[S3] DEBUG after merge:  round=36 metric=0.2773 head_norm=1.500991 delta_norm=0.232463
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.3320 head_norm=1.535386
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.324633e-01
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.3320 head_norm=1.500991 delta_norm=0.232463
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] CommDone barrier timeout: have=2 need=4 — continuing
[S17] CommDone barrier timeout: have=2 need=3 — continuing
[S2] START round=37 head_norm_before_train=1.979922 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1207017422327903, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1079683548283903, 'psi': 0.3674775928297055}
[S3] START round=37 head_norm_before_train=1.500991 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.2919643644703184, 'auprc': 0.2919643644703184, 'loss_val': 2.432849264730303, 'psi': 0.2919643644703184}-{'f1_val': 0.2764159508345555, 'auprc': 0.2764159508345555, 'loss_val': 2.285766165275053, 'psi': 0.2764159508345555}
[S4] START round=37 head_norm_before_train=2.242015 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.411422815983818, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3865448592370755, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.857235 (no previous merge yet)
[S5] round=37 local utility u=0.064046 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8351588750062224, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9632508448043844, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] sending update (kind=head size=1791 to 1 peers)
[S6] START round=37 head_norm_before_train=1.827662 cos_to_last_merge=0.9725 (last merge round=34)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.893919144332292, 'psi': 0.02153000458085204}-{'f1_val': 0.08877952755905512, 'auprc': 0.08877952755905512, 'loss_val': 4.835399440088275, 'psi': 0.08877952755905512}
[S7] START round=37 head_norm_before_train=1.868579 cos_to_last_merge=0.9976 (last merge round=28)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.24968897735755163, 'auprc': 0.24968897735755163, 'loss_val': 0.41726879618418056, 'psi': 0.24968897735755163}-{'f1_val': 0.24968897735755163, 'auprc': 0.24968897735755163, 'loss_val': 0.4146085379168616, 'psi': 0.24968897735755163}
[S8] START round=37 head_norm_before_train=1.570190 cos_to_last_merge=0.9987 (last merge round=34)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.187744053227476, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1366200584291404, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=1.882170 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8292725620719077, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.811297640526823, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=2.226471 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.26454223571067276, 'auprc': 0.26454223571067276, 'loss_val': 1.899988470103491, 'psi': 0.26454223571067276}-{'f1_val': 0.26454223571067276, 'auprc': 0.26454223571067276, 'loss_val': 1.8827959531601237, 'psi': 0.26454223571067276}
[S11] START round=37 head_norm_before_train=1.500991 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.0924953541714384, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.0739413502757285, 'psi': 0.3320133550741517}
[S13] START round=37 head_norm_before_train=1.876863 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8132932790016896, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7811837787555829, 'psi': 0.3599362944611573}
[S14] START round=37 head_norm_before_train=1.994173 cos_to_last_merge=0.9642 (last merge round=15)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13273115042027347, 'auprc': 0.13273115042027347, 'loss_val': 5.276240983098764, 'psi': 0.13273115042027347}-{'f1_val': 0.13192612137203166, 'auprc': 0.13192612137203166, 'loss_val': 5.232281638762122, 'psi': 0.13192612137203166}
[S15] START round=37 head_norm_before_train=1.672345 cos_to_last_merge=0.9415 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.5122682614698895, 'psi': 0.6153571007984797}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.49128814795318637, 'psi': 0.6163342951580373}
[S16] START round=37 head_norm_before_train=1.973138 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.1336586087085089, 'auprc': 0.1336586087085089, 'loss_val': 4.471504054524575, 'psi': 0.1336586087085089}-{'f1_val': 0.13282985339848954, 'auprc': 0.13282985339848954, 'loss_val': 4.324868127587377, 'psi': 0.13282985339848954}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=2.022065 (no previous merge yet)
[S17] round=37 local utility u=0.055681 metrics={'f1_val': 0.4093448006457657, 'auprc': 0.4093448006457657, 'loss_val': 1.19652555924681, 'psi': 0.4093448006457657}-{'f1_val': 0.39720845833697094, 'auprc': 0.39720845833697094, 'loss_val': 1.1986598537704392, 'psi': 0.39720845833697094}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S11
[S8]  timeout peer S14
[S7]  timeout peer S13
[S7]  timeout peer S16
[S14]  timeout peer S10
[S9]  timeout peer S15
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S15]  timeout peer S8
[S11]  timeout peer S3
[S11]  timeout peer S5
[S13]  timeout peer S17
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=38 head_norm_before_train=1.986584 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1332101179909153, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1207017422327903, 'psi': 0.3674775928297055}
[S3] START round=38 head_norm_before_train=1.537665 cos_to_last_merge=0.9995 (last merge round=36)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.2831234256926952, 'auprc': 0.2831234256926952, 'loss_val': 2.422983639195312, 'psi': 0.2831234256926952}-{'f1_val': 0.2919643644703184, 'auprc': 0.2919643644703184, 'loss_val': 2.432849264730303, 'psi': 0.2919643644703184}
[S4] START round=38 head_norm_before_train=2.259142 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.436635827021807, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.411422815983818, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.874831 (no previous merge yet)
[S5] round=38 local utility u=0.015815 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8035282571589706, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8351588750062224, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=38 head_norm_before_train=1.892728 cos_to_last_merge=0.9615 (last merge round=34)
[S6] round=38 local utility u=0.506759 metrics={'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 5.602060208660156, 'psi': 0.10171428571428572}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.893919144332292, 'psi': 0.02153000458085204}
[S7] START round=38 head_norm_before_train=1.875043 cos_to_last_merge=0.9971 (last merge round=28)
[S7] round=38 local utility u=0.357252 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.45407180811301284, 'psi': 0.33316757831924415}-{'f1_val': 0.24968897735755163, 'auprc': 0.24968897735755163, 'loss_val': 0.41726879618418056, 'psi': 0.24968897735755163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=38 head_norm_before_train=1.597128 cos_to_last_merge=0.9978 (last merge round=34)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2517150524070297, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.187744053227476, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.888369 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.845511537598193, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8292725620719077, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.236757 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.26449206650230733, 'auprc': 0.26449206650230733, 'loss_val': 1.9223420064702499, 'psi': 0.26449206650230733}-{'f1_val': 0.26454223571067276, 'auprc': 0.26454223571067276, 'loss_val': 1.899988470103491, 'psi': 0.26454223571067276}
[S11] START round=38 head_norm_before_train=1.524343 cos_to_last_merge=0.9997 (last merge round=36)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.1724330098708005, 'psi': 0.33216756042589574}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.0924953541714384, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.890484 cos_to_last_merge=0.9999 (last merge round=35)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8306015988742728, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8132932790016896, 'psi': 0.3599362944611573}
[S14] START round=38 head_norm_before_train=2.002125 cos_to_last_merge=0.9633 (last merge round=15)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.3169814611144135, 'psi': 0.1331327566754419}-{'f1_val': 0.13273115042027347, 'auprc': 0.13273115042027347, 'loss_val': 5.276240983098764, 'psi': 0.13273115042027347}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.707332 cos_to_last_merge=0.9366 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6138114033949549, 'auprc': 0.6138114033949549, 'loss_val': 0.5344989615283815, 'psi': 0.6138114033949549}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.5122682614698895, 'psi': 0.6153571007984797}
[S16] START round=38 head_norm_before_train=1.978996 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.13318534961154274, 'auprc': 0.13318534961154274, 'loss_val': 4.578702063041507, 'psi': 0.13318534961154274}-{'f1_val': 0.1336586087085089, 'auprc': 0.1336586087085089, 'loss_val': 4.471504054524575, 'psi': 0.1336586087085089}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=2.031974 (no previous merge yet)
[S17] round=38 local utility u=0.153670 metrics={'f1_val': 0.4409358981820849, 'auprc': 0.4409358981820849, 'loss_val': 1.173506174868798, 'psi': 0.4409358981820849}-{'f1_val': 0.4093448006457657, 'auprc': 0.4093448006457657, 'loss_val': 1.19652555924681, 'psi': 0.4093448006457657}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.102)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.441)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.993124 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1445291104798727, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1332101179909153, 'psi': 0.3674775928297055}
[S3] START round=39 head_norm_before_train=1.576786 cos_to_last_merge=0.9980 (last merge round=36)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.29573115349682105, 'auprc': 0.29573115349682105, 'loss_val': 2.7782713847754397, 'psi': 0.29573115349682105}-{'f1_val': 0.2831234256926952, 'auprc': 0.2831234256926952, 'loss_val': 2.422983639195312, 'psi': 0.2831234256926952}
[S4] START round=39 head_norm_before_train=2.271838 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.458877963155849, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.436635827021807, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0007 f1=0.357 auprc=0.357 bytes=16181
[S5] START round=39 head_norm_before_train=1.890558 (no previous merge yet)
[S5] round=39 local utility u=0.023673 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.756182576380698, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8035282571589706, 'psi': 0.33308623671855697}
[S5] not sending this round → trigger blocked (psi=0.333)
[S5] r=40 psi=0.333 u=0.0237 p_local=0.0278 f1=0.333 auprc=0.333 bytes=28799
[S6] START round=39 head_norm_before_train=1.930690 cos_to_last_merge=0.9553 (last merge round=34)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.655200330080766, 'psi': 0.0}-{'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 5.602060208660156, 'psi': 0.10171428571428572}
[S7] START round=39 head_norm_before_train=1.883875 cos_to_last_merge=0.9963 (last merge round=28)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.4604940615257361, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.45407180811301284, 'psi': 0.33316757831924415}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.333 u=0.0000 p_local=0.0666 f1=0.333 auprc=0.333 bytes=34180
[S8] START round=39 head_norm_before_train=1.619687 cos_to_last_merge=0.9969 (last merge round=34)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3040611720429616, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2517150524070297, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=1.894335 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.861284045187585, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.845511537598193, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0013 f1=0.369 auprc=0.369 bytes=3597
[S10] START round=39 head_norm_before_train=2.246814 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.2640413984601792, 'auprc': 0.2640413984601792, 'loss_val': 1.9430349420713866, 'psi': 0.2640413984601792}-{'f1_val': 0.26449206650230733, 'auprc': 0.26449206650230733, 'loss_val': 1.9223420064702499, 'psi': 0.26449206650230733}
[S11] START round=39 head_norm_before_train=1.544997 cos_to_last_merge=0.9991 (last merge round=36)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.178396231690634, 'psi': 0.33201273984308244}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.1724330098708005, 'psi': 0.33216756042589574}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0062 f1=0.332 auprc=0.332 bytes=18003
[S13] START round=39 head_norm_before_train=1.901485 cos_to_last_merge=0.9999 (last merge round=35)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8906529492870598, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8306015988742728, 'psi': 0.3599362944611573}
[S14] START round=39 head_norm_before_train=2.009864 cos_to_last_merge=0.9625 (last merge round=15)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.352297174567976, 'psi': 0.1331327566754419}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.3169814611144135, 'psi': 0.1331327566754419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.133 u=0.0000 p_local=0.0027 f1=0.133 auprc=0.133 bytes=0
[S15] START round=39 head_norm_before_train=1.736870 cos_to_last_merge=0.9327 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=39 local utility u=0.014859 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5274872502280223, 'psi': 0.6163342951580373}-{'f1_val': 0.6138114033949549, 'auprc': 0.6138114033949549, 'loss_val': 0.5344989615283815, 'psi': 0.6138114033949549}
[S16] START round=39 head_norm_before_train=1.985492 (no previous merge yet)
[S16] round=39 local utility u=0.095068 metrics={'f1_val': 0.13982029366644752, 'auprc': 0.13982029366644752, 'loss_val': 4.448280738521996, 'psi': 0.13982029366644752}-{'f1_val': 0.13318534961154274, 'auprc': 0.13318534961154274, 'loss_val': 4.578702063041507, 'psi': 0.13318534961154274}
[S16] not sending this round → trigger blocked (psi=0.140)
[S16] r=40 psi=0.140 u=0.0951 p_local=0.1576 f1=0.140 auprc=0.140 bytes=0
[S17] START round=39 head_norm_before_train=2.048111 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.4048147377969459, 'auprc': 0.4048147377969459, 'loss_val': 1.2911673024675112, 'psi': 0.4048147377969459}-{'f1_val': 0.4409358981820849, 'auprc': 0.4409358981820849, 'loss_val': 1.173506174868798, 'psi': 0.4409358981820849}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0040 f1=0.359 auprc=0.359 bytes=21596
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0149 f1=0.360 auprc=0.360 bytes=17992
[S3] r=40 psi=0.296 u=0.0000 p_local=0.0465 f1=0.296 auprc=0.296 bytes=23401
[S15] r=40 psi=0.616 u=0.0149 p_local=0.0078 f1=0.616 auprc=0.616 bytes=32393
[S17] r=40 psi=0.405 u=0.0000 p_local=0.0584 f1=0.405 auprc=0.405 bytes=28849
[S6] r=40 psi=0.000 u=0.0000 p_local=0.1847 f1=0.000 auprc=0.000 bytes=0
[S10] r=40 psi=0.264 u=0.0000 p_local=0.0013 f1=0.264 auprc=0.264 bytes=9004
[S2] r=40 psi=0.367 u=0.0000 p_local=0.0174 f1=0.367 auprc=0.367 bytes=8999
[S2] START round=40 head_norm_before_train=1.999467 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.155561128919968, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1445291104798727, 'psi': 0.3674775928297055}
[S3] START round=40 head_norm_before_train=1.612673 cos_to_last_merge=0.9961 (last merge round=36)
[S3] round=40 local utility u=0.054370 metrics={'f1_val': 0.28114057028514255, 'auprc': 0.28114057028514255, 'loss_val': 2.53821621493129, 'psi': 0.28114057028514255}-{'f1_val': 0.29573115349682105, 'auprc': 0.29573115349682105, 'loss_val': 2.7782713847754397, 'psi': 0.29573115349682105}
[S4] START round=40 head_norm_before_train=2.284061 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4699136369363746, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.458877963155849, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.902659 (no previous merge yet)
[S5] round=40 local utility u=0.005792 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.744598137781006, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.756182576380698, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=40 head_norm_before_train=1.953920 cos_to_last_merge=0.9518 (last merge round=34)
[S6] round=40 local utility u=0.812475 metrics={'f1_val': 0.09919416730621643, 'auprc': 0.09919416730621643, 'loss_val': 5.922997035420674, 'psi': 0.09919416730621643}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.655200330080766, 'psi': 0.0}
[S7] START round=40 head_norm_before_train=1.894228 cos_to_last_merge=0.9957 (last merge round=28)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.4505902596851929, 'psi': 0.24975124378109453}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.4604940615257361, 'psi': 0.33316757831924415}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.639779 cos_to_last_merge=0.9959 (last merge round=34)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3339638712897648, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3040611720429616, 'psi': 0.35939447907390915}
[S9] START round=40 head_norm_before_train=1.900108 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8773663668840386, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.861284045187585, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.256476 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.26319431339246396, 'auprc': 0.26319431339246396, 'loss_val': 1.962051306522758, 'psi': 0.26319431339246396}-{'f1_val': 0.2640413984601792, 'auprc': 0.2640413984601792, 'loss_val': 1.9430349420713866, 'psi': 0.2640413984601792}
[S11] START round=40 head_norm_before_train=1.563701 cos_to_last_merge=0.9982 (last merge round=36)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.2233356654241314, 'psi': 0.33201273984308244}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.178396231690634, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.919855 cos_to_last_merge=0.9997 (last merge round=35)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9271570185586664, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8906529492870598, 'psi': 0.3599362944611573}
[S14] START round=40 head_norm_before_train=2.017433 cos_to_last_merge=0.9616 (last merge round=15)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.388010345872826, 'psi': 0.13413413413413414}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.352297174567976, 'psi': 0.1331327566754419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.761761 cos_to_last_merge=0.9295 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.5446853783614197, 'psi': 0.6152170947577895}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5274872502280223, 'psi': 0.6163342951580373}
[S16] START round=40 head_norm_before_train=1.992375 (no previous merge yet)
[S16] round=40 local utility u=0.054596 metrics={'f1_val': 0.14371691682981655, 'auprc': 0.14371691682981655, 'loss_val': 4.374158227134266, 'psi': 0.14371691682981655}-{'f1_val': 0.13982029366644752, 'auprc': 0.13982029366644752, 'loss_val': 4.448280738521996, 'psi': 0.13982029366644752}
[S16] not sending this round → trigger blocked (psi=0.144)
[S17] START round=40 head_norm_before_train=2.065523 (no previous merge yet)
[S17] round=40 local utility u=0.401586 metrics={'f1_val': 0.47745405219667325, 'auprc': 0.47745405219667325, 'loss_val': 1.1417490269523205, 'psi': 0.47745405219667325}-{'f1_val': 0.4048147377969459, 'auprc': 0.4048147377969459, 'loss_val': 1.2911673024675112, 'psi': 0.4048147377969459}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.099)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=2.005669 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1672014504778905, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.155561128919968, 'psi': 0.3674775928297055}
[S3] START round=41 head_norm_before_train=1.646026 cos_to_last_merge=0.9940 (last merge round=36)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.28036143579540745, 'auprc': 0.28036143579540745, 'loss_val': 2.575431083852105, 'psi': 0.28036143579540745}-{'f1_val': 0.28114057028514255, 'auprc': 0.28114057028514255, 'loss_val': 2.53821621493129, 'psi': 0.28114057028514255}
[S4] START round=41 head_norm_before_train=2.290990 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4776993513213414, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4699136369363746, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.912134 (no previous merge yet)
[S5] round=41 local utility u=0.025698 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.6932029765830188, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.744598137781006, 'psi': 0.33308623671855697}
[S5] not sending this round → trigger blocked (psi=0.333)
[S6] START round=41 head_norm_before_train=1.970710 cos_to_last_merge=0.9494 (last merge round=34)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 6.557763082094056, 'psi': 0.02240512117055327}-{'f1_val': 0.09919416730621643, 'auprc': 0.09919416730621643, 'loss_val': 5.922997035420674, 'psi': 0.09919416730621643}
[S7] START round=41 head_norm_before_train=1.903682 cos_to_last_merge=0.9953 (last merge round=28)
[S7] round=41 local utility u=0.003846 metrics={'f1_val': 0.24925224327018944, 'auprc': 0.24925224327018944, 'loss_val': 0.4384066699890036, 'psi': 0.24925224327018947}-{'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.4505902596851929, 'psi': 0.24975124378109453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=41 head_norm_before_train=1.661015 cos_to_last_merge=0.9950 (last merge round=34)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3726615866231984, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3339638712897648, 'psi': 0.35939447907390915}
[S9] START round=41 head_norm_before_train=1.905800 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8935535781041684, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8773663668840386, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.265606 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.26284709134313355, 'auprc': 0.26284709134313355, 'loss_val': 1.9797113684253704, 'psi': 0.26284709134313355}-{'f1_val': 0.26319431339246396, 'auprc': 0.26319431339246396, 'loss_val': 1.962051306522758, 'psi': 0.26319431339246396}
[S11] START round=41 head_norm_before_train=1.583420 cos_to_last_merge=0.9971 (last merge round=36)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.2519316664489004, 'psi': 0.33201273984308244}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.2233356654241314, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.933096 cos_to_last_merge=0.9995 (last merge round=35)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9578773346076754, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9271570185586664, 'psi': 0.3599362944611573}
[S14] START round=41 head_norm_before_train=2.024513 cos_to_last_merge=0.9608 (last merge round=15)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.426733808255057, 'psi': 0.1351317597102535}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.388010345872826, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.783482 cos_to_last_merge=0.9268 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.927
[S15] round=41 local utility u=0.003477 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.547785628872903, 'psi': 0.6163342951580373}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.5446853783614197, 'psi': 0.6152170947577895}
[S16] START round=41 head_norm_before_train=1.999334 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.14314750290360048, 'auprc': 0.14314750290360048, 'loss_val': 4.431466361982907, 'psi': 0.14314750290360048}-{'f1_val': 0.14371691682981655, 'auprc': 0.14371691682981655, 'loss_val': 4.374158227134266, 'psi': 0.14371691682981655}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=2.078902 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.3103958499908685, 'auprc': 0.3103958499908685, 'loss_val': 1.4535963506809544, 'psi': 0.3103958499908685}-{'f1_val': 0.47745405219667325, 'auprc': 0.47745405219667325, 'loss_val': 1.1417490269523205, 'psi': 0.47745405219667325}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=2.011701 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1784052767628372, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1672014504778905, 'psi': 0.3674775928297055}
[S3] START round=42 head_norm_before_train=1.676206 cos_to_last_merge=0.9920 (last merge round=36)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.2906028368794326, 'auprc': 0.2906028368794326, 'loss_val': 2.8213296178971157, 'psi': 0.2906028368794326}-{'f1_val': 0.28036143579540745, 'auprc': 0.28036143579540745, 'loss_val': 2.575431083852105, 'psi': 0.28036143579540745}
[S4] START round=42 head_norm_before_train=2.299736 (no previous merge yet)
[S4] round=42 local utility u=0.001929 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.473842286008159, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4776993513213414, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=42 head_norm_before_train=1.918281 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7949900491539068, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.6932029765830188, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.985771 cos_to_last_merge=0.9474 (last merge round=34)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.02327704244637152, 'auprc': 0.02327704244637152, 'loss_val': 6.6159325307477355, 'psi': 0.02327704244637152}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 6.557763082094056, 'psi': 0.02240512117055327}
[S7] START round=42 head_norm_before_train=1.911657 cos_to_last_merge=0.9947 (last merge round=28)
[S7] round=42 local utility u=0.000763 metrics={'f1_val': 0.2493771798704534, 'auprc': 0.2493771798704534, 'loss_val': 0.438005577955809, 'psi': 0.24937717987045344}-{'f1_val': 0.24925224327018944, 'auprc': 0.24925224327018944, 'loss_val': 0.4384066699890036, 'psi': 0.24925224327018947}
[S7] not sending this round → trigger blocked (psi=0.249)
[S8] START round=42 head_norm_before_train=1.678325 cos_to_last_merge=0.9943 (last merge round=34)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4333499363239068, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3726615866231984, 'psi': 0.35939447907390915}
[S9] START round=42 head_norm_before_train=1.911407 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.908624006885382, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8935535781041684, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.274628 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.26225398019305507, 'auprc': 0.26225398019305507, 'loss_val': 1.9974598684092226, 'psi': 0.26225398019305507}-{'f1_val': 0.26284709134313355, 'auprc': 0.26284709134313355, 'loss_val': 1.9797113684253704, 'psi': 0.26284709134313355}
[S11] START round=42 head_norm_before_train=1.601837 cos_to_last_merge=0.9961 (last merge round=36)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.3145778515342497, 'psi': 0.33201273984308244}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.2519316664489004, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.944554 cos_to_last_merge=0.9993 (last merge round=35)
[S13] round=42 local utility u=0.001050 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.955776367327059, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9578773346076754, 'psi': 0.3599362944611573}
[S14] START round=42 head_norm_before_train=2.031082 cos_to_last_merge=0.9601 (last merge round=15)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13493253373313344, 'auprc': 0.13493253373313344, 'loss_val': 5.465483532429178, 'psi': 0.13493253373313344}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.426733808255057, 'psi': 0.1351317597102535}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.803261 cos_to_last_merge=0.9244 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.924
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5553249971420966, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.547785628872903, 'psi': 0.6163342951580373}
[S16] START round=42 head_norm_before_train=2.005981 (no previous merge yet)
[S16] round=42 local utility u=0.150924 metrics={'f1_val': 0.1516384664810452, 'auprc': 0.1516384664810452, 'loss_val': 4.206036245979334, 'psi': 0.1516384664810452}-{'f1_val': 0.14314750290360048, 'auprc': 0.14314750290360048, 'loss_val': 4.431466361982907, 'psi': 0.14314750290360048}
[S16] not sending this round → trigger blocked (psi=0.152)
[S17] START round=42 head_norm_before_train=2.087152 (no previous merge yet)
[S17] round=42 local utility u=0.845265 metrics={'f1_val': 0.46765370502953285, 'auprc': 0.46765370502953285, 'loss_val': 1.1783878869452749, 'psi': 0.46765370502953285}-{'f1_val': 0.3103958499908685, 'auprc': 0.3103958499908685, 'loss_val': 1.4535963506809544, 'psi': 0.3103958499908685}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S2] START round=43 head_norm_before_train=2.017456 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1896353887086937, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1784052767628372, 'psi': 0.3674775928297055}
[S3] START round=43 head_norm_before_train=1.702605 cos_to_last_merge=0.9901 (last merge round=36)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.29365079365079366, 'auprc': 0.29365079365079366, 'loss_val': 2.9998964731627895, 'psi': 0.29365079365079366}-{'f1_val': 0.2906028368794326, 'auprc': 0.2906028368794326, 'loss_val': 2.8213296178971157, 'psi': 0.2906028368794326}
[S4] START round=43 head_norm_before_train=2.316477 (no previous merge yet)
[S4] round=43 local utility u=0.000451 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4729394658789994, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.473842286008159, 'psi': 0.3567939207526687}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] START round=43 head_norm_before_train=1.924552 (no previous merge yet)
[S5] round=43 local utility u=0.004575 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7858403500800029, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7949900491539068, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=43 head_norm_before_train=1.999884 cos_to_last_merge=0.9454 (last merge round=34)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=43 local utility u=0.224000 metrics={'f1_val': 0.04881209503239741, 'auprc': 0.04881209503239741, 'loss_val': 6.397747172410727, 'psi': 0.04881209503239741}-{'f1_val': 0.02327704244637152, 'auprc': 0.02327704244637152, 'loss_val': 6.6159325307477355, 'psi': 0.02327704244637152}
[S7] START round=43 head_norm_before_train=1.919769 cos_to_last_merge=0.9941 (last merge round=28)
[S7] round=43 local utility u=0.399228 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.3929183172212578, 'psi': 0.33308476261496395}-{'f1_val': 0.2493771798704534, 'auprc': 0.2493771798704534, 'loss_val': 0.438005577955809, 'psi': 0.24937717987045344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=43 head_norm_before_train=1.693910 cos_to_last_merge=0.9935 (last merge round=34)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4382764828129468, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4333499363239068, 'psi': 0.35939447907390915}
[S9] START round=43 head_norm_before_train=1.916788 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.923234047163832, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.908624006885382, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.283271 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.26156539134783696, 'auprc': 0.26156539134783696, 'loss_val': 2.014326727036384, 'psi': 0.26156539134783696}-{'f1_val': 0.26225398019305507, 'auprc': 0.26225398019305507, 'loss_val': 1.9974598684092226, 'psi': 0.26225398019305507}
[S11] START round=43 head_norm_before_train=1.619118 cos_to_last_merge=0.9950 (last merge round=36)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.3554367788345427, 'psi': 0.33201273984308244}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.3145778515342497, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.956669 cos_to_last_merge=0.9990 (last merge round=35)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.010133683073905, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.955776367327059, 'psi': 0.3599362944611573}
[S14] START round=43 head_norm_before_train=2.037400 cos_to_last_merge=0.9594 (last merge round=15)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.497103620304528, 'psi': 0.13413413413413414}-{'f1_val': 0.13493253373313344, 'auprc': 0.13493253373313344, 'loss_val': 5.465483532429178, 'psi': 0.13493253373313344}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.821135 cos_to_last_merge=0.9221 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.922
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.56553348132233, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5553249971420966, 'psi': 0.6163342951580373}
[S16] START round=43 head_norm_before_train=2.012222 (no previous merge yet)
[S16] round=43 local utility u=0.000727 metrics={'f1_val': 0.15284900284900285, 'auprc': 0.15284900284900285, 'loss_val': 4.215477202358572, 'psi': 0.15284900284900285}-{'f1_val': 0.1516384664810452, 'auprc': 0.1516384664810452, 'loss_val': 4.206036245979334, 'psi': 0.1516384664810452}
[S16] not sending this round → trigger blocked (psi=0.153)
[S17] START round=43 head_norm_before_train=2.098457 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.4325754352226333, 'auprc': 0.4325754352226333, 'loss_val': 1.371019834860555, 'psi': 0.4325754352226333}-{'f1_val': 0.46765370502953285, 'auprc': 0.46765370502953285, 'loss_val': 1.1783878869452749, 'psi': 0.46765370502953285}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.049)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=2.023200 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.201747384565144, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1896353887086937, 'psi': 0.3674775928297055}
[S3] START round=44 head_norm_before_train=1.725381 cos_to_last_merge=0.9884 (last merge round=36)
[S3] round=44 local utility u=0.072340 metrics={'f1_val': 0.2821993472257093, 'auprc': 0.2821993472257093, 'loss_val': 2.7521527870142526, 'psi': 0.2821993472257093}-{'f1_val': 0.29365079365079366, 'auprc': 0.29365079365079366, 'loss_val': 2.9998964731627895, 'psi': 0.29365079365079366}
[S4] START round=44 head_norm_before_train=2.319252 (no previous merge yet)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4871644993243818, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4729394658789994, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.930198 (no previous merge yet)
[S5] round=44 local utility u=0.022634 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.740572238574511, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7858403500800029, 'psi': 0.33308623671855697}
[S5] not sending this round → trigger blocked (psi=0.333)
[S6] START round=44 head_norm_before_train=2.012298 cos_to_last_merge=0.9437 (last merge round=34)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.04288840262582057, 'auprc': 0.04288840262582057, 'loss_val': 6.509816582546157, 'psi': 0.04288840262582057}-{'f1_val': 0.04881209503239741, 'auprc': 0.04881209503239741, 'loss_val': 6.397747172410727, 'psi': 0.04881209503239741}
[S7] START round=44 head_norm_before_train=1.927146 cos_to_last_merge=0.9938 (last merge round=28)
[S7] round=44 local utility u=0.731917 metrics={'f1_val': 0.4928777433686434, 'auprc': 0.4928777433686434, 'loss_val': 0.3672210252533491, 'psi': 0.49287774336864343}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.3929183172212578, 'psi': 0.33308476261496395}
[S7] not sending this round → trigger blocked (psi=0.493)
[S8] START round=44 head_norm_before_train=1.706690 cos_to_last_merge=0.9928 (last merge round=34)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.463141416350957, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4382764828129468, 'psi': 0.35939447907390915}
[S9] START round=44 head_norm_before_train=1.922021 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9368297159082415, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.923234047163832, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.291749 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.2602475586241214, 'auprc': 0.2602475586241214, 'loss_val': 2.0329544916464006, 'psi': 0.2602475586241214}-{'f1_val': 0.26156539134783696, 'auprc': 0.26156539134783696, 'loss_val': 2.014326727036384, 'psi': 0.26156539134783696}
[S11] START round=44 head_norm_before_train=1.635298 cos_to_last_merge=0.9939 (last merge round=36)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.361253002623108, 'psi': 0.3320133550741517}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.3554367788345427, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.976344 cos_to_last_merge=0.9985 (last merge round=35)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.023052710427979, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.010133683073905, 'psi': 0.3599362944611573}
[S14] START round=44 head_norm_before_train=2.043848 cos_to_last_merge=0.9587 (last merge round=15)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13273115042027347, 'auprc': 0.13273115042027347, 'loss_val': 5.526117463155167, 'psi': 0.13273115042027347}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.497103620304528, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.838901 cos_to_last_merge=0.9200 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.920
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5742601542413033, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.56553348132233, 'psi': 0.6163342951580373}
[S16] START round=44 head_norm_before_train=2.018513 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.14718801757038957, 'auprc': 0.14718801757038957, 'loss_val': 4.42040978399804, 'psi': 0.14718801757038957}-{'f1_val': 0.15284900284900285, 'auprc': 0.15284900284900285, 'loss_val': 4.215477202358572, 'psi': 0.15284900284900285}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=2.114374 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.43573888315679143, 'auprc': 0.43573888315679143, 'loss_val': 1.4246740523612955, 'psi': 0.43573888315679143}-{'f1_val': 0.4325754352226333, 'auprc': 0.4325754352226333, 'loss_val': 1.371019834860555, 'psi': 0.4325754352226333}
[S2]  timeout peer S8
[S3]  timeout peer S11
[S15]  timeout peer S9
[S10]  timeout peer S14
[S13]  timeout peer S7
[S17]  timeout peer S13
[S6]  timeout peer S17
[S8]  timeout peer S15
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=2.028926 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.213386385367909, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.201747384565144, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.744318 cos_to_last_merge=0.9869 (last merge round=36)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.28806584362139914, 'auprc': 0.28806584362139914, 'loss_val': 2.8346886436506544, 'psi': 0.28806584362139914}-{'f1_val': 0.2821993472257093, 'auprc': 0.2821993472257093, 'loss_val': 2.7521527870142526, 'psi': 0.2821993472257093}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.313214 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4990340647599296, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4871644993243818, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.936080 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7613817120440365, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.740572238574511, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=2.023821 cos_to_last_merge=0.9421 (last merge round=34)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.026947463768115944, 'auprc': 0.026947463768115944, 'loss_val': 6.740819961957775, 'psi': 0.026947463768115944}-{'f1_val': 0.04288840262582057, 'auprc': 0.04288840262582057, 'loss_val': 6.509816582546157, 'psi': 0.04288840262582057}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.933642 cos_to_last_merge=0.9934 (last merge round=28)
[S7] round=45 local utility u=0.422542 metrics={'f1_val': 0.5852839804356463, 'auprc': 0.5852839804356463, 'loss_val': 0.3537924602884787, 'psi': 0.5852839804356463}-{'f1_val': 0.4928777433686434, 'auprc': 0.4928777433686434, 'loss_val': 0.3672210252533491, 'psi': 0.49287774336864343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=45 head_norm_before_train=1.717960 cos_to_last_merge=0.9924 (last merge round=34)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4886132009192938, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.463141416350957, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.927067 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.950198191039131, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9368297159082415, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.299997 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.257603743381357, 'auprc': 0.257603743381357, 'loss_val': 2.0565395043539216, 'psi': 0.257603743381357}-{'f1_val': 0.2602475586241214, 'auprc': 0.2602475586241214, 'loss_val': 2.0329544916464006, 'psi': 0.2602475586241214}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.649480 cos_to_last_merge=0.9929 (last merge round=36)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.4200932939623865, 'psi': 0.33201273984308244}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.361253002623108, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.987381 cos_to_last_merge=0.9983 (last merge round=35)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.038272771927322, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.023052710427979, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.050280 cos_to_last_merge=0.9580 (last merge round=15)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.549148304145859, 'psi': 0.1331327566754419}-{'f1_val': 0.13273115042027347, 'auprc': 0.13273115042027347, 'loss_val': 5.526117463155167, 'psi': 0.13273115042027347}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.855476 cos_to_last_merge=0.9181 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.918
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5808388821197364, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5742601542413033, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=2.024788 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.14143179666448183, 'auprc': 0.14143179666448183, 'loss_val': 4.590718364755159, 'psi': 0.14143179666448183}-{'f1_val': 0.14718801757038957, 'auprc': 0.14718801757038957, 'loss_val': 4.42040978399804, 'psi': 0.14718801757038957}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=2.123127 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.4370899943003985, 'auprc': 0.4370899943003985, 'loss_val': 1.4603733068190552, 'psi': 0.4370899943003985}-{'f1_val': 0.43573888315679143, 'auprc': 0.43573888315679143, 'loss_val': 1.4246740523612955, 'psi': 0.43573888315679143}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=2.034417 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.2255597363736745, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.213386385367909, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.761362 cos_to_last_merge=0.9856 (last merge round=36)
[S3] round=46 local utility u=0.053947 metrics={'f1_val': 0.27366383184678145, 'auprc': 0.27366383184678145, 'loss_val': 2.597177530353033, 'psi': 0.27366383184678145}-{'f1_val': 0.28806584362139914, 'auprc': 0.28806584362139914, 'loss_val': 2.8346886436506544, 'psi': 0.28806584362139914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=46 head_norm_before_train=2.313813 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.516961530954016, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4990340647599296, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.944987 (no previous merge yet)
[S5] round=46 local utility u=0.027515 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7063523941272687, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7613817120440365, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=46 head_norm_before_train=2.034832 cos_to_last_merge=0.9407 (last merge round=34)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.024145785876993165, 'auprc': 0.024145785876993165, 'loss_val': 6.871887491034788, 'psi': 0.024145785876993165}-{'f1_val': 0.026947463768115944, 'auprc': 0.026947463768115944, 'loss_val': 6.740819961957775, 'psi': 0.026947463768115944}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.939153 cos_to_last_merge=0.9929 (last merge round=28)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.43076087009499303, 'auprc': 0.43076087009499303, 'loss_val': 0.3740551948520795, 'psi': 0.43076087009499303}-{'f1_val': 0.5852839804356463, 'auprc': 0.5852839804356463, 'loss_val': 0.3537924602884787, 'psi': 0.5852839804356463}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.730298 cos_to_last_merge=0.9918 (last merge round=34)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.503692753033687, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4886132009192938, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.932023 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.96299144924017, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.950198191039131, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.308036 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.25836729652957885, 'auprc': 0.25836729652957885, 'loss_val': 2.0657382528162804, 'psi': 0.25836729652957885}-{'f1_val': 0.257603743381357, 'auprc': 0.257603743381357, 'loss_val': 2.0565395043539216, 'psi': 0.257603743381357}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.662470 cos_to_last_merge=0.9919 (last merge round=36)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.4495623121403725, 'psi': 0.33201273984308244}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.4200932939623865, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=2.000409 cos_to_last_merge=0.9981 (last merge round=35)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0570218243299916, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.038272771927322, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.056711 cos_to_last_merge=0.9572 (last merge round=15)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.573255006585231, 'psi': 0.13413413413413414}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.549148304145859, 'psi': 0.1331327566754419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.871231 cos_to_last_merge=0.9162 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5920128865928885, 'psi': 0.6161950003225232}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5808388821197364, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=2.030828 (no previous merge yet)
[S16] round=46 local utility u=0.694032 metrics={'f1_val': 0.1804825448173608, 'auprc': 0.1804825448173608, 'loss_val': 3.554110557791665, 'psi': 0.1804825448173608}-{'f1_val': 0.14143179666448183, 'auprc': 0.14143179666448183, 'loss_val': 4.590718364755159, 'psi': 0.14143179666448183}
[S16] not sending this round → trigger blocked (psi=0.180)
[S17] START round=46 head_norm_before_train=2.138644 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.40717365331671085, 'auprc': 0.40717365331671085, 'loss_val': 1.6697724861079466, 'psi': 0.40717365331671085}-{'f1_val': 0.4370899943003985, 'auprc': 0.4370899943003985, 'loss_val': 1.4603733068190552, 'psi': 0.4370899943003985}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=2.039721 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.237098931687601, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.2255597363736745, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.776358 cos_to_last_merge=0.9844 (last merge round=36)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.27352702003400603, 'auprc': 0.27352702003400603, 'loss_val': 2.6853224383651795, 'psi': 0.27352702003400603}-{'f1_val': 0.27366383184678145, 'auprc': 0.27366383184678145, 'loss_val': 2.597177530353033, 'psi': 0.27366383184678145}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.320822 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.530417470542581, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.516961530954016, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.953766 (no previous merge yet)
[S5] round=47 local utility u=0.133408 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.4395364626175768, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7063523941272687, 'psi': 0.33308623671855697}
[S5] not sending this round → trigger blocked (psi=0.333)
[S6] START round=47 head_norm_before_train=2.045155 cos_to_last_merge=0.9393 (last merge round=34)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=47 local utility u=0.041009 metrics={'f1_val': 0.028442437923250564, 'auprc': 0.028442437923250564, 'loss_val': 6.8285400583353235, 'psi': 0.02844243792325056}-{'f1_val': 0.024145785876993165, 'auprc': 0.024145785876993165, 'loss_val': 6.871887491034788, 'psi': 0.024145785876993165}
[S6] not sending this round → trigger blocked (psi=0.028)
[S7] START round=47 head_norm_before_train=1.944102 cos_to_last_merge=0.9925 (last merge round=28)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.38500787804156256, 'psi': 0.24975124378109453}-{'f1_val': 0.43076087009499303, 'auprc': 0.43076087009499303, 'loss_val': 0.3740551948520795, 'psi': 0.43076087009499303}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.742769 cos_to_last_merge=0.9910 (last merge round=34)
[S8] round=47 local utility u=0.010148 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4833961368109245, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.503692753033687, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=47 head_norm_before_train=1.936907 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9757047828493115, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.96299144924017, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.315571 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.2587987876538628, 'auprc': 0.2587987876538628, 'loss_val': 2.0786657428008444, 'psi': 0.2587987876538628}-{'f1_val': 0.25836729652957885, 'auprc': 0.25836729652957885, 'loss_val': 2.0657382528162804, 'psi': 0.25836729652957885}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.674367 cos_to_last_merge=0.9911 (last merge round=36)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.463320774873951, 'psi': 0.33201273984308244}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.4495623121403725, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=2.016141 cos_to_last_merge=0.9977 (last merge round=35)
[S13] round=47 local utility u=0.003780 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0494623911437695, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0570218243299916, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=47 head_norm_before_train=2.062818 cos_to_last_merge=0.9565 (last merge round=15)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.598964455307224, 'psi': 0.13533083645443197}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.573255006585231, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.886066 cos_to_last_merge=0.9145 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.915
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5955561790839838, 'psi': 0.6163342951580373}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5920128865928885, 'psi': 0.6161950003225232}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=2.036251 (no previous merge yet)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.09188801148600144, 'auprc': 0.09188801148600144, 'loss_val': 5.048689945063233, 'psi': 0.09188801148600144}-{'f1_val': 0.1804825448173608, 'auprc': 0.1804825448173608, 'loss_val': 3.554110557791665, 'psi': 0.1804825448173608}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.155711 (no previous merge yet)
[S17] round=47 local utility u=1.000000 metrics={'f1_val': 0.575725526873499, 'auprc': 0.575725526873499, 'loss_val': 1.1327727751861831, 'psi': 0.575725526873499}-{'f1_val': 0.40717365331671085, 'auprc': 0.40717365331671085, 'loss_val': 1.6697724861079466, 'psi': 0.40717365331671085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=48 head_norm_before_train=2.044827 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.2486230686593336, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.237098931687601, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.789578 cos_to_last_merge=0.9834 (last merge round=36)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.29662020588503235, 'auprc': 0.29662020588503235, 'loss_val': 3.314600427051945, 'psi': 0.29662020588503235}-{'f1_val': 0.27352702003400603, 'auprc': 0.27352702003400603, 'loss_val': 2.6853224383651795, 'psi': 0.27352702003400603}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.334453 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5420230676250095, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.530417470542581, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.963299 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7217067772484849, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.4395364626175768, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=2.054561 cos_to_last_merge=0.9380 (last merge round=34)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=48 local utility u=0.100350 metrics={'f1_val': 0.04208680403331872, 'auprc': 0.04208680403331872, 'loss_val': 6.750639114723849, 'psi': 0.04208680403331872}-{'f1_val': 0.028442437923250564, 'auprc': 0.028442437923250564, 'loss_val': 6.8285400583353235, 'psi': 0.02844243792325056}
[S6] not sending this round → trigger blocked (psi=0.042)
[S7] START round=48 head_norm_before_train=1.947998 cos_to_last_merge=0.9922 (last merge round=28)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.41727412205317993, 'psi': 0.24975124378109453}-{'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.38500787804156256, 'psi': 0.24975124378109453}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.755316 cos_to_last_merge=0.9904 (last merge round=34)
[S8] round=48 local utility u=0.008076 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.467243363130301, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4833961368109245, 'psi': 0.35939447907390915}
[S8] not sending this round → trigger blocked (psi=0.359)
[S9] START round=48 head_norm_before_train=1.941708 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9881455911064547, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9757047828493115, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.323217 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.25712881022615536, 'auprc': 0.25712881022615536, 'loss_val': 2.0994509346504238, 'psi': 0.25712881022615536}-{'f1_val': 0.2587987876538628, 'auprc': 0.2587987876538628, 'loss_val': 2.0786657428008444, 'psi': 0.2587987876538628}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.685438 cos_to_last_merge=0.9902 (last merge round=36)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.494358348046737, 'psi': 0.33201273984308244}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.463320774873951, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=2.028121 cos_to_last_merge=0.9973 (last merge round=35)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.097764452216613, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0494623911437695, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.068698 cos_to_last_merge=0.9558 (last merge round=15)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.628370553261979, 'psi': 0.1355297641332834}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.598964455307224, 'psi': 0.13533083645443197}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.899737 cos_to_last_merge=0.9129 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.913
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6045726565735431, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5955561790839838, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=2.041372 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.06930939915233109, 'auprc': 0.06930939915233109, 'loss_val': 5.66502999253807, 'psi': 0.06930939915233109}-{'f1_val': 0.09188801148600144, 'auprc': 0.09188801148600144, 'loss_val': 5.048689945063233, 'psi': 0.09188801148600144}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.169224 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.42022858371251476, 'auprc': 0.42022858371251476, 'loss_val': 1.6271496428407217, 'psi': 0.4202285837125147}-{'f1_val': 0.575725526873499, 'auprc': 0.575725526873499, 'loss_val': 1.1327727751861831, 'psi': 0.575725526873499}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=2.050008 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.2617528562372353, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.2486230686593336, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.800831 cos_to_last_merge=0.9825 (last merge round=36)
[S3] round=49 local utility u=0.211524 metrics={'f1_val': 0.25876600398893396, 'auprc': 0.25876600398893396, 'loss_val': 2.550865161588752, 'psi': 0.25876600398893396}-{'f1_val': 0.29662020588503235, 'auprc': 0.29662020588503235, 'loss_val': 3.314600427051945, 'psi': 0.29662020588503235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=49 head_norm_before_train=2.347545 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5477942397627074, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5420230676250095, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.973455 (no previous merge yet)
[S5] round=49 local utility u=0.002078 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7175504632308627, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7217067772484849, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=49 head_norm_before_train=2.063706 cos_to_last_merge=0.9368 (last merge round=34)
[S6] ⚠️ Model drifted since last merge! cos=0.937
[S6] round=49 local utility u=0.019820 metrics={'f1_val': 0.04763967085318319, 'auprc': 0.04763967085318319, 'loss_val': 6.760975365246963, 'psi': 0.04763967085318319}-{'f1_val': 0.04208680403331872, 'auprc': 0.04208680403331872, 'loss_val': 6.750639114723849, 'psi': 0.04208680403331872}
[S6] not sending this round → trigger blocked (psi=0.048)
[S7] START round=49 head_norm_before_train=1.953067 cos_to_last_merge=0.9916 (last merge round=28)
[S7] round=49 local utility u=0.337754 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.491767645470709, 'psi': 0.33308476261496395}-{'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.41727412205317993, 'psi': 0.24975124378109453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=49 head_norm_before_train=1.766894 cos_to_last_merge=0.9899 (last merge round=34)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4685911496157107, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.467243363130301, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.946435 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.000273244399635, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9881455911064547, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.330746 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.25594910381109687, 'auprc': 0.25594910381109687, 'loss_val': 2.120604490174453, 'psi': 0.25594910381109687}-{'f1_val': 0.25712881022615536, 'auprc': 0.25712881022615536, 'loss_val': 2.0994509346504238, 'psi': 0.25712881022615536}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.696469 cos_to_last_merge=0.9894 (last merge round=36)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.5293377763709026, 'psi': 0.33201273984308244}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.494358348046737, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=2.032918 cos_to_last_merge=0.9972 (last merge round=35)
[S13] round=49 local utility u=0.018718 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0603279301024666, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.097764452216613, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=49 head_norm_before_train=2.074232 cos_to_last_merge=0.9552 (last merge round=15)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.659236577274953, 'psi': 0.1355297641332834}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.628370553261979, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.913192 cos_to_last_merge=0.9113 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.911
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6109320665156839, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6045726565735431, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=2.046806 (no previous merge yet)
[S16] round=49 local utility u=0.926833 metrics={'f1_val': 0.14048140043763677, 'auprc': 0.14048140043763677, 'loss_val': 4.451911065486899, 'psi': 0.14048140043763677}-{'f1_val': 0.06930939915233109, 'auprc': 0.06930939915233109, 'loss_val': 5.66502999253807, 'psi': 0.06930939915233109}
[S16] not sending this round → trigger blocked (psi=0.140)
[S17] START round=49 head_norm_before_train=2.182506 (no previous merge yet)
[S17] round=49 local utility u=0.180894 metrics={'f1_val': 0.45396805834622606, 'auprc': 0.45396805834622606, 'loss_val': 1.5690178768729672, 'psi': 0.45396805834622606}-{'f1_val': 0.42022858371251476, 'auprc': 0.42022858371251476, 'loss_val': 1.6271496428407217, 'psi': 0.4202285837125147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
