[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:51903
[S3] → join 127.0.0.1:51902
[S4] → join 127.0.0.1:51902
[S5] → join 127.0.0.1:51902
[S6] → join 127.0.0.1:51902
[S7] → join 127.0.0.1:51902
[S8] → join 127.0.0.1:51902
[S9] → join 127.0.0.1:51902
[S10] → join 127.0.0.1:51902
[S11] → join 127.0.0.1:51902
[S13] → join 127.0.0.1:51902
[S14] → join 127.0.0.1:51902
[S15] → join 127.0.0.1:51902
[S16] → join 127.0.0.1:51902
[S17] → join 127.0.0.1:51902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.139177 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.154153 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.125685 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.175109 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.131901 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.177883 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.186893 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.138557 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.177538 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.205971 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.091201 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.226920 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.186591 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.154555 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.161388 (no previous merge yet)
[S10]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3] + discovered S5
[S3] + discovered S15
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S7
[S3] + discovered S9
[S3] + discovered S8
[S3] + discovered S13
[S3] + discovered S14
[S3] + discovered S16
[S3] + discovered S17
[S3] + discovered S4
[S3] + discovered S6
[S3] + discovered S10
[S3] + discovered S11
[S4] + discovered S13
[S5] + discovered S3
[S4] + discovered S7
[S5] + discovered S2
[S4] + discovered S11
[S4] + discovered S9
[S4] + discovered S10
[S4] + discovered S15
[S4] + discovered S16
[S5] + discovered S4
[S4] + discovered S14
[S4] + discovered S6
[S4] + discovered S5
[S4] + discovered S8
[S4] + discovered S17
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S5
[S5] + discovered S11
[S5] + discovered S9
[S5] + discovered S13
[S5] + discovered S8
[S5] + discovered S6
[S5] + discovered S17
[S5] + discovered S10
[S5] + discovered S16
[S5] + discovered S15
[S5] + discovered S7
[S5] + discovered S14
[S6] + discovered S7
[S6] + discovered S16
[S6] + discovered S8
[S6] + discovered S15
[S6] + discovered S14
[S6] + discovered S10
[S6] + discovered S11
[S7] + discovered S3
[S6] + discovered S13
[S7] + discovered S2
[S7] + discovered S6
[S6] + discovered S17
[S7] + discovered S4
[S7] + discovered S5
[S6] + discovered S9
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S8
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S13
[S7] + discovered S16
[S7] + discovered S14
[S7] + discovered S10
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S2
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S3
[S8] + discovered S13
[S8] + discovered S9
[S8] + discovered S11
[S8] + discovered S15
[S9] + discovered S8
[S9] + discovered S5
[S8] + discovered S10
[S8] + discovered S14
[S9] + discovered S2
[S8] + discovered S17
[S8] + discovered S16
[S9] + discovered S6
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S3
[S10] + discovered S2
[S9] + discovered S14
[S9] + discovered S17
[S10] + discovered S9
[S10] + discovered S3
[S9] + discovered S16
[S10] + discovered S8
[S10] + discovered S7
[S9] + discovered S11
[S10] + discovered S4
[S9] + discovered S13
[S9] + discovered S10
[S10] + discovered S6
[S10] + discovered S5
[S9] + discovered S15
[S10] + discovered S15
[S10] + discovered S17
[S10] + discovered S16
[S11] + discovered S7
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S4
[S10] + discovered S14
[S11] + discovered S10
[S10] + discovered S11
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S8
[S10] + discovered S13
[S11] + discovered S6
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S6
[S13] + discovered S11
[S13] + discovered S4
[S11] + discovered S14
[S13] + discovered S9
[S13] + discovered S3
[S11] + discovered S16
[S13] + discovered S2
[S13] + discovered S7
[S13] + discovered S10
[S11] + discovered S17
[S11] + discovered S13
[S11] + discovered S15
[S14] + discovered S5
[S14] + discovered S4
[S14] + discovered S3
[S14] + discovered S8
[S14] + discovered S11
[S14] + discovered S10
[S14] + discovered S2
[S14] + discovered S13
[S14] + discovered S9
[S13] + discovered S14
[S13] + discovered S17
[S14] + discovered S7
[S13] + discovered S16
[S13] + discovered S15
[S14] + discovered S6
[S15] + discovered S14
[S15] + discovered S2
[S15] + discovered S11
[S15] + discovered S7
[S14] + discovered S16
[S15] + discovered S5
[S14] + discovered S17
[S15] + discovered S8
[S15] + discovered S3
[S15] + discovered S4
[S15] + discovered S6
[S15] + discovered S9
[S15] + discovered S13
[S15] + discovered S10
[S14] + discovered S15
[S15] + discovered S17
[S16] + discovered S8
[S16] + discovered S15
[S16] + discovered S5
[S16] + discovered S3
[S16] + discovered S9
[S16] + discovered S4
[S16] + discovered S14
[S16] + discovered S6
[S16] + discovered S2
[S16] + discovered S7
[S16] + discovered S10
[S16] + discovered S11
[S16] + discovered S13
[S15] + discovered S16
[S17] + discovered S16
[S17] + discovered S10
[S17] + discovered S3
[S16] + discovered S17
[S17] + discovered S14
[S17] + discovered S2
[S17] + discovered S15
[S17] + discovered S13
[S17] + discovered S7
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S5
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S6@127.0.0.1:51907
[S7] ⇄ pheromone p=1.000 → S5@127.0.0.1:51905
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:51912
[S2] ⇄ pheromone p=1.000 → S17@127.0.0.1:51917
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:51917
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:51910
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:51913
[S9] ⇄ pheromone p=1.000 → S2@127.0.0.1:51902
[S5] ⇄ pheromone p=1.000 → S11@127.0.0.1:51912
[S13] ⇄ pheromone p=1.000 → S5@127.0.0.1:51905
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:51915
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:51916
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:51908
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:51905
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:51908
[S2] START round=1 head_norm_before_train=1.140781 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.531332014195275, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4723368956236367, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.158534 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4979201616771347, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.445069854293746, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.136226 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4576626995613646, 'psi': 0.0}-{'f1_val': 0.0008412197686645637, 'auprc': 0.0008412197686645637, 'loss_val': 1.4038364278035687, 'psi': 0.0008412197686645637}
[S5] START round=1 head_norm_before_train=1.172326 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4926505792972893, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4704775257730163, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.140328 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5792999352576733, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4773135960283639, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.181164 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5411907752518024, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.484783122593998, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.192414 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4874873673155538, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4431256479178058, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.144094 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4702386567576486, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.373071633471808, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.175177 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4339924452309805, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4013167062481866, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.218385 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5240786586830875, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4448912846387587, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.100270 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5018853339612661, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4451858355372171, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.238805 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6414894976668888, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5246910218690946, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.188769 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5266622360837396, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4650444441756423, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.164739 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5723645655712009, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4729227857087483, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.164176 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.547059202856073, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4821702361272684, 'psi': 0.0}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.152625 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.60332390803809, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.531332014195275, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.170580 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5860322419992816, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4979201616771347, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.154937 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5467595531440912, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4576626995613646, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.181066 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5371921052820867, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4926505792972893, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.161357 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7707597481529285, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5792999352576733, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.195453 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6389917124340867, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5411907752518024, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.206369 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5600118053971213, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4874873673155538, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.163421 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6490937321243668, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4702386567576486, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.184381 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4802363848802609, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4339924452309805, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.238879 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.688215805937123, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5240786586830875, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.117654 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.637291060059216, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5018853339612661, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.261882 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8793333129471947, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6414894976668888, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.201561 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6584771512604717, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5266622360837396, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.186219 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.757536674163037, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5723645655712009, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.174812 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6604780502416698, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.547059202856073, 'psi': 0.0}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.173317 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7346254517845152, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.60332390803809, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.193313 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.811300543755077, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5860322419992816, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.183648 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7172096012513403, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5467595531440912, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.198382 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6299202052016433, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5371921052820867, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.193592 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.289237261660755, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7707597481529285, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.219271 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9165376940810592, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6389917124340867, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.227114 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7148945000259008, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5600118053971213, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.193796 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.008910848243422, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6490937321243668, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.202981 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.572405313192619, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4802363848802609, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.268107 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.125912427325944, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.688215805937123, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.141599 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9645117642011047, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.637291060059216, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.294445 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.481042711978475, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8793333129471947, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.224308 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9530472811269064, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6584771512604717, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.218916 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.190282134437989, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.757536674163037, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.193228 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9225161908538262, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6604780502416698, 'psi': 0.0}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.204029 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0427840767017327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7346254517845152, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.227058 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.417604754696984, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.811300543755077, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.217989 (no previous merge yet)
[S4] round=4 local utility u=1.000000 metrics={'f1_val': 0.31802664904746175, 'auprc': 0.31802664904746175, 'loss_val': 1.7077268334923623, 'psi': 0.31802664904746175}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7172096012513403, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.224583 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.758227193208857, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6299202052016433, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.234586 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.894739066678941, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.289237261660755, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.250806 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1129264871466416, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9165376940810592, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.255123 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8096545410560259, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7148945000259008, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.229050 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6478062139594196, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.008910848243422, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.230379 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7941944589797552, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.572405313192619, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.303657 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.889852397085774, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.125912427325944, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.166672 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.992672886935231, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9645117642011047, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.331080 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.965621644157002, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.481042711978475, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.253421 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1566001651052416, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9530472811269064, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.259214 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.86310764888483, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.190282134437989, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.218854 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.018446676233162, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9225161908538262, 'psi': 0.0}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] → sending delta(kind=head bytes=1787) to S11@127.0.0.1:51912
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1787 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1787) from S4
[S11] cosine check vs S4: cos=-0.0481
[S11] DROPPED delta from S4 (cos=-0.0481 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.242110 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.583176733077406, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0427840767017327, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.266390 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5751041055518042, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.417604754696984, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.243292 (no previous merge yet)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.24905123339658444, 'auprc': 0.24905123339658444, 'loss_val': 1.5103590292932838, 'psi': 0.24905123339658441}-{'f1_val': 0.31802664904746175, 'auprc': 0.31802664904746175, 'loss_val': 1.7077268334923623, 'psi': 0.31802664904746175}
[S5] START round=5 head_norm_before_train=1.250267 (no previous merge yet)
[S5] round=5 local utility u=0.035338 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.687551875698717, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.758227193208857, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.268855 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.129581618836002, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.894739066678941, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.268310 (no previous merge yet)
[S7] round=5 local utility u=0.124839 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8632491036657568, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1129264871466416, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.274999 (no previous merge yet)
[S8] round=5 local utility u=0.050251 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.709152232680022, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8096545410560259, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.265854 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8544546409997906, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6478062139594196, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.257458 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9164538062602232, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7941944589797552, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.337438 (no previous merge yet)
[S11] round=5 local utility u=0.046924 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7960051614710357, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.889852397085774, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.173280 (no previous merge yet)
[S13] round=5 local utility u=0.069681 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.853311053240674, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.992672886935231, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.357001 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.200072167343106, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.965621644157002, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.273852 (no previous merge yet)
[S15] round=5 local utility u=0.119345 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9179091807455693, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1566001651052416, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.298594 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.144537932427967, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.86310764888483, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.233424 (no previous merge yet)
[S17] round=5 local utility u=0.055625 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9071970387405424, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.018446676233162, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] ⇄ pheromone p=0.328 → S17@127.0.0.1:51917
[S13] ⇄ pheromone p=0.342 → S5@127.0.0.1:51905
[S14] ⇄ pheromone p=0.328 → S7@127.0.0.1:51908
[S3] ⇄ pheromone p=0.328 → S9@127.0.0.1:51910
[S4] ⇄ pheromone p=0.488 → S11@127.0.0.1:51912
[S9] ⇄ pheromone p=0.328 → S2@127.0.0.1:51902
[S7] ⇄ pheromone p=0.353 → S5@127.0.0.1:51905
[S5] ⇄ pheromone p=0.335 → S11@127.0.0.1:51912
[S10] ⇄ pheromone p=0.328 → S6@127.0.0.1:51907
[S8] ⇄ pheromone p=0.338 → S17@127.0.0.1:51917
[S15] ⇄ pheromone p=0.352 → S5@127.0.0.1:51905
[S6] ⇄ pheromone p=0.328 → S15@127.0.0.1:51915
[S17] ⇄ pheromone p=0.339 → S16@127.0.0.1:51916
[S16] ⇄ pheromone p=0.328 → S7@127.0.0.1:51908
[S11] ⇄ pheromone p=0.337 → S13@127.0.0.1:51913
[S2] START round=6 head_norm_before_train=1.281034 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8367524091088754, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.583176733077406, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.293377 (no previous merge yet)
[S3] round=6 local utility u=0.124193 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.326718802510957, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5751041055518042, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.261611 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.23793787177792466, 'auprc': 0.23793787177792466, 'loss_val': 1.4113888582237881, 'psi': 0.2379378717779247}-{'f1_val': 0.24905123339658444, 'auprc': 0.24905123339658444, 'loss_val': 1.5103590292932838, 'psi': 0.24905123339658441}
[S5] START round=6 head_norm_before_train=1.261708 (no previous merge yet)
[S5] round=6 local utility u=0.061437 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5646787227141836, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.687551875698717, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.298146 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3029163997584323, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.129581618836002, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.263810 (no previous merge yet)
[S7] round=6 local utility u=0.012124 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8390001133449583, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8632491036657568, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.289397 (no previous merge yet)
[S8] round=6 local utility u=0.223725 metrics={'f1_val': 0.03367408298256164, 'auprc': 0.03367408298256164, 'loss_val': 1.5647696112322276, 'psi': 0.03367408298256164}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.709152232680022, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.292588 (no previous merge yet)
[S9] round=6 local utility u=0.261187 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3320807423136003, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8544546409997906, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.277382 (no previous merge yet)
[S10] round=6 local utility u=0.057056 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8023418056173264, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9164538062602232, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.356231 (no previous merge yet)
[S11] round=6 local utility u=0.050170 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6956659849238247, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7960051614710357, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.174562 (no previous merge yet)
[S13] round=6 local utility u=0.036017 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7812761230723042, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.853311053240674, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.378406 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.386228504814054, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.200072167343106, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.279516 (no previous merge yet)
[S15] round=6 local utility u=0.073434 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7710411979612222, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9179091807455693, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.330289 (no previous merge yet)
[S16] round=6 local utility u=0.035038 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0744613409186043, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.144537932427967, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.245578 (no previous merge yet)
[S17] round=6 local utility u=0.096880 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.713437515497039, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9071970387405424, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.034)
[S7] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=7 head_norm_before_train=1.315413 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1399103647811657, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8367524091088754, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.318523 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4163690089658796, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.326718802510957, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.290930 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3320868121963185, 'psi': 0.0}-{'f1_val': 0.23793787177792466, 'auprc': 0.23793787177792466, 'loss_val': 1.4113888582237881, 'psi': 0.2379378717779247}
[S5] START round=7 head_norm_before_train=1.275046 (no previous merge yet)
[S5] round=7 local utility u=0.825851 metrics={'f1_val': 0.17157757496740547, 'auprc': 0.17157757496740547, 'loss_val': 1.4571748908865703, 'psi': 0.17157757496740547}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5646787227141836, 'psi': 0.0}
[S6] START round=7 head_norm_before_train=1.324298 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3357998041195778, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3029163997584323, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.273866 (no previous merge yet)
[S7] round=7 local utility u=0.005395 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8282101465084017, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8390001133449583, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.306265 (no previous merge yet)
[S8] round=7 local utility u=0.968092 metrics={'f1_val': 0.2395691093915946, 'auprc': 0.2395691093915946, 'loss_val': 1.4816403557741558, 'psi': 0.2395691093915946}-{'f1_val': 0.03367408298256164, 'auprc': 0.03367408298256164, 'loss_val': 1.5647696112322276, 'psi': 0.03367408298256164}
[S9] START round=7 head_norm_before_train=1.313450 (no previous merge yet)
[S9] round=7 local utility u=0.138087 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.055907700941828, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3320807423136003, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.291566 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8709318130808203, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8023418056173264, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.375896 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8072015318391186, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6956659849238247, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.181644 (no previous merge yet)
[S13] round=7 local utility u=0.012855 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7555670580086702, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7812761230723042, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.399946 (no previous merge yet)
[S14] round=7 local utility u=0.052077 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2820752582544523, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.386228504814054, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.289950 (no previous merge yet)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.794988548779158, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7710411979612222, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.359416 (no previous merge yet)
[S16] round=7 local utility u=0.090902 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.892657088778338, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0744613409186043, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.256405 (no previous merge yet)
[S17] round=7 local utility u=0.035625 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6421867150043905, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.713437515497039, 'psi': 0.0}
[S14] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.172)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:51917
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.0741
[S17] not sending this round → trigger blocked (psi=0.000)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.0000 head_norm=1.275190
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.877459e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.0000 head_norm=0.956074 delta_norm=0.887746
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.355593 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2184926338710493, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1399103647811657, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.350836 (no previous merge yet)
[S3] round=8 local utility u=0.153006 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1103569900128454, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4163690089658796, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.325746 (no previous merge yet)
[S4] round=8 local utility u=0.023393 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2853012219130957, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3320868121963185, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.292245 (no previous merge yet)
[S5] round=8 local utility u=0.648908 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.3613049249325064, 'psi': 0.3051272166538165}-{'f1_val': 0.17157757496740547, 'auprc': 0.17157757496740547, 'loss_val': 1.4571748908865703, 'psi': 0.17157757496740547}
[S6] START round=8 head_norm_before_train=1.353705 (no previous merge yet)
[S6] round=8 local utility u=0.004189 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3274218158317552, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3357998041195778, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.287749 (no previous merge yet)
[S7] round=8 local utility u=0.043183 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7418436091031464, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8282101465084017, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.333504 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.22031533417050372, 'auprc': 0.22031533417050372, 'loss_val': 1.332346067126894, 'psi': 0.22031533417050372}-{'f1_val': 0.2395691093915946, 'auprc': 0.2395691093915946, 'loss_val': 1.4816403557741558, 'psi': 0.2395691093915946}
[S9] START round=8 head_norm_before_train=1.345320 (no previous merge yet)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3734919665732552, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.055907700941828, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.317581 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.288179806627551, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8709318130808203, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.397189 (no previous merge yet)
[S11] round=8 local utility u=0.166565 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.474071722873561, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8072015318391186, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.193587 (no previous merge yet)
[S13] round=8 local utility u=0.045276 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6650157496827915, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7555670580086702, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.418566 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3763074096445402, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2820752582544523, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.311903 (no previous merge yet)
[S15] round=8 local utility u=0.086235 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.622518096777343, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.794988548779158, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.390786 (no previous merge yet)
[S16] round=8 local utility u=0.086680 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7192967935647787, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.892657088778338, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=0.956074 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.047943 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5463009661989853, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6421867150043905, 'psi': 0.0}
[S6] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:51912
[S15] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] cosine check vs S5: cos=0.0232
[S17] not sending this round → trigger blocked (psi=0.000)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.0000 head_norm=1.418227
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.544699e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.0000 head_norm=0.976813 delta_norm=0.954470
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.391488 (no previous merge yet)
[S2] round=9 local utility u=0.120613 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9772661799139137, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2184926338710493, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.383811 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2873202138049207, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1103569900128454, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.362843 (no previous merge yet)
[S4] round=9 local utility u=0.010538 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2642250426618569, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2853012219130957, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.311100 (no previous merge yet)
[S5] round=9 local utility u=0.029654 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.301997092441763, 'psi': 0.3051272166538165}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.3613049249325064, 'psi': 0.3051272166538165}
[S6] START round=9 head_norm_before_train=1.388545 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.509633060926101, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3274218158317552, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.300711 (no previous merge yet)
[S7] round=9 local utility u=0.058988 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6238674212385633, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7418436091031464, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.363385 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.20384714691453654, 'auprc': 0.20384714691453654, 'loss_val': 1.255787089844296, 'psi': 0.20384714691453654}-{'f1_val': 0.22031533417050372, 'auprc': 0.22031533417050372, 'loss_val': 1.332346067126894, 'psi': 0.22031533417050372}
[S9] START round=9 head_norm_before_train=1.388331 (no previous merge yet)
[S9] round=9 local utility u=0.190731 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9920291939034775, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3734919665732552, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.353900 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5626359092319997, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.288179806627551, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=0.976813 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.183338 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1073965031332436, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.474071722873561, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.205073 (no previous merge yet)
[S13] round=9 local utility u=0.052166 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5606827965249426, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6650157496827915, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.439497 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6376801338576636, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3763074096445402, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.334927 (no previous merge yet)
[S15] round=9 local utility u=0.130763 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3609921830851108, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.622518096777343, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.422945 (no previous merge yet)
[S16] round=9 local utility u=0.023723 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6718500716269027, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7192967935647787, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=0.987447 cos_to_last_merge=0.9972 (last merge round=7)
[S17] round=9 local utility u=0.070746 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.404808054557661, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5463009661989853, 'psi': 0.0}
[S13] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:51912
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] cosine check vs S5: cos=0.6673
[S17] not sending this round → trigger blocked (psi=0.000)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.0000 head_norm=1.004034
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.993165e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.068491 delta_norm=0.499316
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.419411 (no previous merge yet)
[S2] round=10 local utility u=0.193386 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5904946596634018, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9772661799139137, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.417954 (no previous merge yet)
[S3] round=10 local utility u=0.035774 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.215771418255767, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2873202138049207, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.399525 (no previous merge yet)
[S4] round=10 local utility u=0.002872 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2584818472591635, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2642250426618569, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.331877 (no previous merge yet)
[S5] round=10 local utility u=1.000000 metrics={'f1_val': 0.9191424991334673, 'auprc': 0.9191424991334673, 'loss_val': 1.2564250438264204, 'psi': 0.9191424991334673}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.301997092441763, 'psi': 0.3051272166538165}
[S6] START round=10 head_norm_before_train=1.424829 (no previous merge yet)
[S6] round=10 local utility u=0.001540 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5065523479664735, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.509633060926101, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.314554 (no previous merge yet)
[S7] round=10 local utility u=0.030102 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5636629274511533, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6238674212385633, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.398373 (no previous merge yet)
[S8] round=10 local utility u=0.475756 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.2152064659906687, 'psi': 0.30506182380216385}-{'f1_val': 0.20384714691453654, 'auprc': 0.20384714691453654, 'loss_val': 1.255787089844296, 'psi': 0.20384714691453654}
[S9] START round=10 head_norm_before_train=1.430935 (no previous merge yet)
[S9] round=10 local utility u=1.000000 metrics={'f1_val': 0.220435134966648, 'auprc': 0.220435134966648, 'loss_val': 1.4877346618778169, 'psi': 0.220435134966648}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9920291939034775, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.389468 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0007159904534606205, 'auprc': 0.0007159904534606205, 'loss_val': 2.9481819589837843, 'psi': 0.0007159904534606205}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5626359092319997, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.068491 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.050794 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0058093417683955, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1073965031332436, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.218134 (no previous merge yet)
[S13] round=10 local utility u=0.041442 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.477799596542441, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5606827965249426, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.464623 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.511541682347682, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6376801338576636, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.361642 (no previous merge yet)
[S15] round=10 local utility u=1.000000 metrics={'f1_val': 0.28499095840867994, 'auprc': 0.28499095840867994, 'loss_val': 1.238197856123658, 'psi': 0.28499095840867994}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3609921830851108, 'psi': 0.0}
[S16] START round=10 head_norm_before_train=1.456297 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6949072523078623, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6718500716269027, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.024003 cos_to_last_merge=0.9897 (last merge round=7)
[S17] round=10 local utility u=0.029151 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3465064084749674, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.404808054557661, 'psi': 0.0}
[S13] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:51917
[S3] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:51912
[S4] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:51905
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:51902
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.6885
[S11] RECEIVED delta(kind=head bytes=1805) from S5
[S11] cosine check vs S5: cos=0.9169
[S2] RECEIVED delta(kind=head bytes=1799) from S9
[S2] cosine check vs S9: cos=-0.1061
[S2] DROPPED delta from S9 (cos=-0.1061 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.0100
[S17] not sending this round → trigger blocked (psi=0.000)
[S3] ⇄ pheromone p=0.144 → S9@127.0.0.1:51910
[S7] ⇄ pheromone p=0.138 → S5@127.0.0.1:51905
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.0000 head_norm=1.092247
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.810778e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.198892 delta_norm=0.281078
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.175 → S13@127.0.0.1:51913
[S2] ⇄ pheromone p=0.165 → S17@127.0.0.1:51917
[S13] ⇄ pheromone p=0.139 → S5@127.0.0.1:51905
[S4] ⇄ pheromone p=0.165 → S11@127.0.0.1:51912
[S14] ⇄ pheromone p=0.113 → S7@127.0.0.1:51908
[S10] ⇄ pheromone p=0.112 → S6@127.0.0.1:51907
[S6] ⇄ pheromone p=0.108 → S15@127.0.0.1:51915
[S16] ⇄ pheromone p=0.134 → S7@127.0.0.1:51908
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.9191 head_norm=1.356352
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.688166e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.9992 head_norm=0.978559 delta_norm=0.968817
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.487 → S11@127.0.0.1:51912
[S15] ⇄ pheromone p=0.353 → S5@127.0.0.1:51905
[S9] ⇄ pheromone p=0.373 → S2@127.0.0.1:51902
[S8] ⇄ pheromone p=0.323 → S17@127.0.0.1:51917
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.0000 head_norm=1.063897
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.206728e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.1523 head_norm=1.148855 delta_norm=0.520673
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.146 → S16@127.0.0.1:51916
[S2] START round=11 head_norm_before_train=1.446999 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8874842963644234, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5904946596634018, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.454324 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.449269409341709, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.215771418255767, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.435785 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2662803534446414, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2584818472591635, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=0.978559 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.114895 metrics={'f1_val': 0.9489798877675856, 'auprc': 0.9489798877675856, 'loss_val': 1.2951707918168425, 'psi': 0.9489798877675856}-{'f1_val': 0.9191424991334673, 'auprc': 0.9191424991334673, 'loss_val': 1.2564250438264204, 'psi': 0.9191424991334673}
[S6] START round=11 head_norm_before_train=1.462851 (no previous merge yet)
[S6] round=11 local utility u=0.387267 metrics={'f1_val': 0.0783205490512717, 'auprc': 0.0783205490512717, 'loss_val': 3.4369038572656074, 'psi': 0.0783205490512717}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5065523479664735, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.334017 (no previous merge yet)
[S7] round=11 local utility u=0.016236 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5311918955641814, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5636629274511533, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.431803 (no previous merge yet)
[S8] round=11 local utility u=0.008607 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1979923582669179, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.2152064659906687, 'psi': 0.30506182380216385}
[S9] START round=11 head_norm_before_train=1.472716 (no previous merge yet)
[S9] round=11 local utility u=0.721082 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.379700845958409, 'psi': 0.36867172340800847}-{'f1_val': 0.220435134966648, 'auprc': 0.220435134966648, 'loss_val': 1.4877346618778169, 'psi': 0.220435134966648}
[S10] START round=11 head_norm_before_train=1.425823 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.205288795560435, 'psi': 0.0}-{'f1_val': 0.0007159904534606205, 'auprc': 0.0007159904534606205, 'loss_val': 2.9481819589837843, 'psi': 0.0007159904534606205}
[S11] START round=11 head_norm_before_train=1.198892 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.077138 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.851533181345197, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0058093417683955, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.234245 (no previous merge yet)
[S13] round=11 local utility u=0.059736 metrics={'f1_val': 0.0009818360333824251, 'auprc': 0.0009818360333824251, 'loss_val': 1.3671646641169706, 'psi': 0.0009818360333824251}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.477799596542441, 'psi': 0.0}
[S14] START round=11 head_norm_before_train=1.493896 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.862434520762984, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.511541682347682, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.397382 (no previous merge yet)
[S15] round=11 local utility u=0.028968 metrics={'f1_val': 0.2826297913634158, 'auprc': 0.2826297913634158, 'loss_val': 1.1590117231264359, 'psi': 0.2826297913634158}-{'f1_val': 0.28499095840867994, 'auprc': 0.28499095840867994, 'loss_val': 1.238197856123658, 'psi': 0.28499095840867994}
[S16] START round=11 head_norm_before_train=1.487532 (no previous merge yet)
[S16] round=11 local utility u=0.008974 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6769592268277647, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6949072523078623, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.148855 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.697259 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.3228426892811644, 'psi': 0.15231723870467326}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3465064084749674, 'psi': 0.0}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:51917
[S11] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.001)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:51912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:51905
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:51902
[S6] not sending this round → trigger blocked (psi=0.078)
[S17] not sending this round → trigger blocked (psi=0.152)
[S5] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.7072
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] cosine check vs S5: cos=0.6896
[S2] RECEIVED delta(kind=head bytes=1801) from S9
[S2] cosine check vs S9: cos=-0.1074
[S2] DROPPED delta from S9 (cos=-0.1074 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9218
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.0000 head_norm=1.221123
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.495682e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.023940 delta_norm=0.449568
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.9490 head_norm=1.004981
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.077192e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.6998 head_norm=1.130667 delta_norm=0.507719
[S5] aggregate: ROLLBACK (f1_val pre=0.949 post=0.700 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.1523 head_norm=1.182064
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.960154e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.2030 head_norm=1.297361 delta_norm=0.296015
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.474746 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9826770297676064, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8874842963644234, 'psi': 0.0}
[S3] START round=12 head_norm_before_train=1.489240 (no previous merge yet)
[S3] round=12 local utility u=0.116649 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2159719708369727, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.449269409341709, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.469647 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2747863531316126, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2662803534446414, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.130667 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.5205472099210532, 'auprc': 0.5205472099210532, 'loss_val': 1.3100523262178887, 'psi': 0.5205472099210532}-{'f1_val': 0.9489798877675856, 'auprc': 0.9489798877675856, 'loss_val': 1.2951707918168425, 'psi': 0.9489798877675856}
[S6] START round=12 head_norm_before_train=1.496931 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.07575142160844842, 'auprc': 0.07575142160844842, 'loss_val': 3.6377202194584832, 'psi': 0.07575142160844842}-{'f1_val': 0.0783205490512717, 'auprc': 0.0783205490512717, 'loss_val': 3.4369038572656074, 'psi': 0.0783205490512717}
[S7] START round=12 head_norm_before_train=1.356800 (no previous merge yet)
[S7] round=12 local utility u=0.036712 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4577683949039772, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5311918955641814, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.464331 (no previous merge yet)
[S8] round=12 local utility u=0.011113 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1757655642686302, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1979923582669179, 'psi': 0.30506182380216385}
[S9] START round=12 head_norm_before_train=1.515129 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5354371347103926, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.379700845958409, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=1.462771 (no previous merge yet)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3142537710174316, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.205288795560435, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.023940 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9961785324511652, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.851533181345197, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.252365 (no previous merge yet)
[S13] round=12 local utility u=1.000000 metrics={'f1_val': 0.2368726888536714, 'auprc': 0.2368726888536714, 'loss_val': 1.283084962721703, 'psi': 0.2368726888536714}-{'f1_val': 0.0009818360333824251, 'auprc': 0.0009818360333824251, 'loss_val': 1.3671646641169706, 'psi': 0.0009818360333824251}
[S14] START round=12 head_norm_before_train=1.519836 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.225047257843057, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.862434520762984, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.436100 (no previous merge yet)
[S15] round=12 local utility u=0.292651 metrics={'f1_val': 0.3329116592873709, 'auprc': 0.3329116592873709, 'loss_val': 1.0262463580390706, 'psi': 0.3329116592873709}-{'f1_val': 0.2826297913634158, 'auprc': 0.2826297913634158, 'loss_val': 1.1590117231264359, 'psi': 0.2826297913634158}
[S16] START round=12 head_norm_before_train=1.516272 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.00019113149847094801, 'auprc': 0.00019113149847094801, 'loss_val': 2.712090694330313, 'psi': 0.00019113149847094801}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6769592268277647, 'psi': 0.0}
[S17] START round=12 head_norm_before_train=1.297361 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.014440 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.2939618998358886, 'psi': 0.15231723870467326}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.3228426892811644, 'psi': 0.15231723870467326}
[S7] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:51917
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1805 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.9681
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:51905
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.9338
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[S17] not sending this round → trigger blocked (psi=0.152)
[S13] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S13
[S5] cosine check vs S13: cos=-0.0823
[S5] DROPPED delta from S13 (cos=-0.0823 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.5205 head_norm=1.157914
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.855846e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.5249 head_norm=1.294507 delta_norm=0.285585
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.1523 head_norm=1.329844
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.953440e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.2031 head_norm=1.399369 delta_norm=0.195344
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.500870 (no previous merge yet)
[S2] round=13 local utility u=0.430206 metrics={'f1_val': 0.0609380349195481, 'auprc': 0.0609380349195481, 'loss_val': 2.6707066014703136, 'psi': 0.0609380349195481}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9826770297676064, 'psi': 0.0}
[S3] START round=13 head_norm_before_train=1.516552 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2899133424595335, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2159719708369727, 'psi': 0.0}
[S4] START round=13 head_norm_before_train=1.503709 (no previous merge yet)
[S4] round=13 local utility u=0.020347 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2340916848189099, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2747863531316126, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.294507 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=1.000000 metrics={'f1_val': 0.9873664305207414, 'auprc': 0.9873664305207414, 'loss_val': 1.305157525542641, 'psi': 0.9873664305207414}-{'f1_val': 0.5205472099210532, 'auprc': 0.5205472099210532, 'loss_val': 1.3100523262178887, 'psi': 0.5205472099210532}
[S6] START round=13 head_norm_before_train=1.522998 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.006008855154965212, 'auprc': 0.006008855154965212, 'loss_val': 4.508121587911894, 'psi': 0.006008855154965212}-{'f1_val': 0.07575142160844842, 'auprc': 0.07575142160844842, 'loss_val': 3.6377202194584832, 'psi': 0.07575142160844842}
[S7] START round=13 head_norm_before_train=1.374905 (no previous merge yet)
[S7] round=13 local utility u=0.008560 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4406478833343954, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4577683949039772, 'psi': 0.0}
[S8] START round=13 head_norm_before_train=1.491408 (no previous merge yet)
[S8] round=13 local utility u=0.034601 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1065640590072776, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1757655642686302, 'psi': 0.30506182380216385}
[S9] START round=13 head_norm_before_train=1.555627 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8312237584566826, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5354371347103926, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=1.496723 (no previous merge yet)
[S10] round=13 local utility u=0.597614 metrics={'f1_val': 0.12656194216351302, 'auprc': 0.12656194216351302, 'loss_val': 3.25808277800105, 'psi': 0.12656194216351302}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3142537710174316, 'psi': 0.0}
[S11] START round=13 head_norm_before_train=1.051587 cos_to_last_merge=0.9952 (last merge round=11)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.078679919554597, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9961785324511652, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.276741 (no previous merge yet)
[S13] round=13 local utility u=1.000000 metrics={'f1_val': 0.5810538774558679, 'auprc': 0.5810538774558679, 'loss_val': 1.178148033689346, 'psi': 0.5810538774558679}-{'f1_val': 0.2368726888536714, 'auprc': 0.2368726888536714, 'loss_val': 1.283084962721703, 'psi': 0.2368726888536714}
[S14] START round=13 head_norm_before_train=1.546044 (no previous merge yet)
[S14] round=13 local utility u=0.543200 metrics={'f1_val': 0.13071401586701928, 'auprc': 0.13071401586701928, 'loss_val': 5.315073648104611, 'psi': 0.13071401586701928}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.225047257843057, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.474398 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.2833272793316382, 'auprc': 0.2833272793316382, 'loss_val': 1.0487042811097311, 'psi': 0.2833272793316382}-{'f1_val': 0.3329116592873709, 'auprc': 0.3329116592873709, 'loss_val': 1.0262463580390706, 'psi': 0.3329116592873709}
[S16] START round=13 head_norm_before_train=1.543039 (no previous merge yet)
[S16] round=13 local utility u=0.397937 metrics={'f1_val': 0.07416666666666667, 'auprc': 0.07416666666666667, 'loss_val': 2.5819967064029568, 'psi': 0.07416666666666667}-{'f1_val': 0.00019113149847094801, 'auprc': 0.00019113149847094801, 'loss_val': 2.712090694330313, 'psi': 0.00019113149847094801}
[S17] START round=13 head_norm_before_train=1.399369 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.005763 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.282435937556176, 'psi': 0.15231723870467326}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.2939618998358886, 'psi': 0.15231723870467326}
[S16] not sending this round → trigger blocked (psi=0.074)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.127)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:51912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:51917
[S14] not sending this round → trigger blocked (psi=0.131)
[S4] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.061)
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.9800
[S5] RECEIVED delta(kind=head bytes=1797) from S13
[S5] cosine check vs S13: cos=-0.0833
[S5] DROPPED delta from S13 (cos=-0.0833 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] cosine check vs S5: cos=0.4896
[S17] not sending this round → trigger blocked (psi=0.152)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.0000 head_norm=1.093672
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.151198e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.039807 delta_norm=0.615120
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.1523 head_norm=1.430813
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.539298e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.1523 head_norm=1.467682 delta_norm=0.153930
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.523850 (no previous merge yet)
[S2] round=14 local utility u=0.336559 metrics={'f1_val': 0.16011094301563286, 'auprc': 0.16011094301563286, 'loss_val': 2.890144540952944, 'psi': 0.16011094301563286}-{'f1_val': 0.0609380349195481, 'auprc': 0.0609380349195481, 'loss_val': 2.6707066014703136, 'psi': 0.0609380349195481}
[S3] START round=14 head_norm_before_train=1.545482 (no previous merge yet)
[S3] round=14 local utility u=1.000000 metrics={'f1_val': 0.28117523207962486, 'auprc': 0.28117523207962486, 'loss_val': 2.149067480369174, 'psi': 0.28117523207962486}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2899133424595335, 'psi': 0.0}
[S4] START round=14 head_norm_before_train=1.539456 (no previous merge yet)
[S4] round=14 local utility u=1.000000 metrics={'f1_val': 0.332570944515036, 'auprc': 0.332570944515036, 'loss_val': 1.2205213248403408, 'psi': 0.332570944515036}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2340916848189099, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.312640 cos_to_last_merge=0.9980 (last merge round=12)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.518950091783452, 'auprc': 0.518950091783452, 'loss_val': 1.2823927337383814, 'psi': 0.518950091783452}-{'f1_val': 0.9873664305207414, 'auprc': 0.9873664305207414, 'loss_val': 1.305157525542641, 'psi': 0.9873664305207414}
[S6] START round=14 head_norm_before_train=1.544079 (no previous merge yet)
[S6] round=14 local utility u=0.559261 metrics={'f1_val': 0.07575142160844842, 'auprc': 0.07575142160844842, 'loss_val': 4.0172836332403055, 'psi': 0.07575142160844842}-{'f1_val': 0.006008855154965212, 'auprc': 0.006008855154965212, 'loss_val': 4.508121587911894, 'psi': 0.006008855154965212}
[S7] START round=14 head_norm_before_train=1.391849 (no previous merge yet)
[S7] round=14 local utility u=0.001752 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4371447286795493, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4406478833343954, 'psi': 0.0}
[S8] START round=14 head_norm_before_train=1.519323 (no previous merge yet)
[S8] round=14 local utility u=0.045117 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.016330811357874, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1065640590072776, 'psi': 0.30506182380216385}
[S9] START round=14 head_norm_before_train=1.591776 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0344950408847993, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8312237584566826, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.524506 (no previous merge yet)
[S10] round=14 local utility u=0.588191 metrics={'f1_val': 0.24879923150816521, 'auprc': 0.24879923150816521, 'loss_val': 3.181836058235666, 'psi': 0.24879923150816521}-{'f1_val': 0.12656194216351302, 'auprc': 0.12656194216351302, 'loss_val': 3.25808277800105, 'psi': 0.12656194216351302}
[S11] START round=14 head_norm_before_train=1.039807 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1711599693109083, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.078679919554597, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.305152 (no previous merge yet)
[S13] round=14 local utility u=0.062678 metrics={'f1_val': 0.5849159483302893, 'auprc': 0.5849159483302893, 'loss_val': 1.0875507457219378, 'psi': 0.5849159483302893}-{'f1_val': 0.5810538774558679, 'auprc': 0.5810538774558679, 'loss_val': 1.178148033689346, 'psi': 0.5810538774558679}
[S14] START round=14 head_norm_before_train=1.573253 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.07751937984496124, 'auprc': 0.07751937984496124, 'loss_val': 5.509797973398033, 'psi': 0.07751937984496124}-{'f1_val': 0.13071401586701928, 'auprc': 0.13071401586701928, 'loss_val': 5.315073648104611, 'psi': 0.13071401586701928}
[S15] START round=14 head_norm_before_train=1.506202 (no previous merge yet)
[S15] round=14 local utility u=0.329299 metrics={'f1_val': 0.3329116592873709, 'auprc': 0.3329116592873709, 'loss_val': 0.8363660094304622, 'psi': 0.3329116592873709}-{'f1_val': 0.2833272793316382, 'auprc': 0.2833272793316382, 'loss_val': 1.0487042811097311, 'psi': 0.2833272793316382}
[S16] START round=14 head_norm_before_train=1.570076 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.06941351150705272, 'auprc': 0.06941351150705272, 'loss_val': 2.7589093819533828, 'psi': 0.06941351150705272}-{'f1_val': 0.07416666666666667, 'auprc': 0.07416666666666667, 'loss_val': 2.5819967064029568, 'psi': 0.07416666666666667}
[S17] START round=14 head_norm_before_train=1.467682 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.011272 metrics={'f1_val': 0.15499210734017363, 'auprc': 0.15499210734017363, 'loss_val': 1.2839662567974548, 'psi': 0.15499210734017363}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.282435937556176, 'psi': 0.15231723870467326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:51912
[S6] not sending this round → trigger blocked (psi=0.076)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S13
[S11] cosine check vs S13: cos=-0.1151
[S11] DROPPED delta from S13 (cos=-0.1151 < 0.0)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S17] not sending this round → trigger blocked (psi=0.155)
[S2] not sending this round → trigger blocked (psi=0.160)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:51907
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S15
[S6] cosine check vs S15: cos=-0.0002
[S6] DROPPED delta from S15 (cos=-0.0002 < 0.0)
[S2] START round=15 head_norm_before_train=1.544356 (no previous merge yet)
[S2] round=15 local utility u=0.597964 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.4592942085990486, 'psi': 0.245119570522206}-{'f1_val': 0.16011094301563286, 'auprc': 0.16011094301563286, 'loss_val': 2.890144540952944, 'psi': 0.16011094301563286}
[S3] START round=15 head_norm_before_train=1.573498 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.334973712723934, 'psi': 0.29773995791014735}-{'f1_val': 0.28117523207962486, 'auprc': 0.28117523207962486, 'loss_val': 2.149067480369174, 'psi': 0.28117523207962486}
[S4] START round=15 head_norm_before_train=1.576770 (no previous merge yet)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.2413560981580075, 'auprc': 0.2413560981580075, 'loss_val': 1.2108110638001288, 'psi': 0.2413560981580075}-{'f1_val': 0.332570944515036, 'auprc': 0.332570944515036, 'loss_val': 1.2205213248403408, 'psi': 0.332570944515036}
[S5] START round=15 head_norm_before_train=1.341030 cos_to_last_merge=0.9920 (last merge round=12)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.2696199086273483, 'psi': 0.3051272166538165}-{'f1_val': 0.518950091783452, 'auprc': 0.518950091783452, 'loss_val': 1.2823927337383814, 'psi': 0.518950091783452}
[S6] START round=15 head_norm_before_train=1.562957 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 4.798599559624083, 'psi': 0.022186642268984445}-{'f1_val': 0.07575142160844842, 'auprc': 0.07575142160844842, 'loss_val': 4.0172836332403055, 'psi': 0.07575142160844842}
[S7] START round=15 head_norm_before_train=1.403627 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4438547353093083, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4371447286795493, 'psi': 0.0}
[S8] START round=15 head_norm_before_train=1.549718 (no previous merge yet)
[S8] round=15 local utility u=0.030999 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9543334557040255, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.016330811357874, 'psi': 0.30506182380216385}
[S9] START round=15 head_norm_before_train=1.622611 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.134211726810606, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0344950408847993, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.551440 (no previous merge yet)
[S10] round=15 local utility u=0.428136 metrics={'f1_val': 0.33261477045908183, 'auprc': 0.33261477045908183, 'loss_val': 3.0799040100747237, 'psi': 0.33261477045908183}-{'f1_val': 0.24879923150816521, 'auprc': 0.24879923150816521, 'loss_val': 3.181836058235666, 'psi': 0.24879923150816521}
[S11] START round=15 head_norm_before_train=1.073441 cos_to_last_merge=0.9960 (last merge round=13)
[S11] round=15 local utility u=0.029477 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.11220505470833, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1711599693109083, 'psi': 0.0}
[S13] START round=15 head_norm_before_train=1.336944 (no previous merge yet)
[S13] round=15 local utility u=0.311051 metrics={'f1_val': 0.6466289854477308, 'auprc': 0.6466289854477308, 'loss_val': 1.0208653503127572, 'psi': 0.6466289854477308}-{'f1_val': 0.5849159483302893, 'auprc': 0.5849159483302893, 'loss_val': 1.0875507457219378, 'psi': 0.5849159483302893}
[S14] START round=15 head_norm_before_train=1.604333 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.07653910149750416, 'auprc': 0.07653910149750416, 'loss_val': 5.552022566992589, 'psi': 0.07653910149750416}-{'f1_val': 0.07751937984496124, 'auprc': 0.07751937984496124, 'loss_val': 5.509797973398033, 'psi': 0.07751937984496124}
[S15] START round=15 head_norm_before_train=1.536928 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.28346647300895667, 'auprc': 0.28346647300895667, 'loss_val': 0.8765738784749634, 'psi': 0.28346647300895667}-{'f1_val': 0.3329116592873709, 'auprc': 0.3329116592873709, 'loss_val': 0.8363660094304622, 'psi': 0.3329116592873709}
[S16] START round=15 head_norm_before_train=1.596234 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.06245278267438933, 'auprc': 0.06245278267438933, 'loss_val': 3.1490037840870744, 'psi': 0.06245278267438932}-{'f1_val': 0.06941351150705272, 'auprc': 0.06941351150705272, 'loss_val': 2.7589093819533828, 'psi': 0.06941351150705272}
[S17] START round=15 head_norm_before_train=1.499037 cos_to_last_merge=0.9972 (last merge round=13)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.288681513233377, 'psi': 0.0}-{'f1_val': 0.15499210734017363, 'auprc': 0.15499210734017363, 'loss_val': 1.2839662567974548, 'psi': 0.15499210734017363}
[S2]  timeout peer S3
[S3]  timeout peer S2
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:51912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:51910
[S11] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1792) from S13
[S11] cosine check vs S13: cos=-0.1201
[S11] DROPPED delta from S13 (cos=-0.1201 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S2
[S9] cosine check vs S2: cos=-0.1170
[S9] DROPPED delta from S2 (cos=-0.1170 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.283 → S9@127.0.0.1:51910
[S7] ⇄ pheromone p=0.052 → S16@127.0.0.1:51916
[S5] ⇄ pheromone p=0.297 → S15@127.0.0.1:51915
[S6] ⇄ pheromone p=0.157 → S10@127.0.0.1:51911
[S10] ⇄ pheromone p=0.293 → S6@127.0.0.1:51907
[S11] ⇄ pheromone p=0.070 → S5@127.0.0.1:51905
[S15] ⇄ pheromone p=0.201 → S5@127.0.0.1:51905
[S9] ⇄ pheromone p=0.181 → S2@127.0.0.1:51902
[S13] ⇄ pheromone p=0.353 → S11@127.0.0.1:51912
[S16] ⇄ pheromone p=0.096 → S17@127.0.0.1:51917
[S17] ⇄ pheromone p=0.109 → S8@127.0.0.1:51909
[S2] START round=16 head_norm_before_train=1.566260 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.199468085106383, 'auprc': 0.199468085106383, 'loss_val': 2.5067394130538765, 'psi': 0.199468085106383}-{'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.4592942085990486, 'psi': 0.245119570522206}
[S3] START round=16 head_norm_before_train=1.602083 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.29763866007688083, 'auprc': 0.29763866007688083, 'loss_val': 2.7457600396847477, 'psi': 0.29763866007688083}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.334973712723934, 'psi': 0.29773995791014735}
[S4] START round=16 head_norm_before_train=1.618886 (no previous merge yet)
[S4] round=16 local utility u=0.522908 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.203935546966979, 'psi': 0.3567939207526687}-{'f1_val': 0.2413560981580075, 'auprc': 0.2413560981580075, 'loss_val': 1.2108110638001288, 'psi': 0.2413560981580075}
[S5] START round=16 head_norm_before_train=1.371137 cos_to_last_merge=0.9843 (last merge round=12)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.20180528691166988, 'auprc': 0.20180528691166988, 'loss_val': 1.2642708598953936, 'psi': 0.20180528691166988}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.2696199086273483, 'psi': 0.3051272166538165}
[S6] START round=16 head_norm_before_train=1.583436 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 4.852738701354857, 'psi': 0.023059360730593607}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 4.798599559624083, 'psi': 0.022186642268984445}
[S7] START round=16 head_norm_before_train=1.417657 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.45581446081434, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4438547353093083, 'psi': 0.0}
[S8] START round=16 head_norm_before_train=1.582734 (no previous merge yet)
[S8] round=16 local utility u=0.188052 metrics={'f1_val': 0.34119673139937845, 'auprc': 0.34119673139937845, 'loss_val': 0.9034438620730486, 'psi': 0.34119673139937845}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9543334557040255, 'psi': 0.30506182380216385}
[S9] START round=16 head_norm_before_train=1.649020 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2045217203524836, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.134211726810606, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.570071 (no previous merge yet)
[S10] round=16 local utility u=0.035843 metrics={'f1_val': 0.3326947637292465, 'auprc': 0.3326947637292465, 'loss_val': 3.0089375834519005, 'psi': 0.3326947637292465}-{'f1_val': 0.33261477045908183, 'auprc': 0.33261477045908183, 'loss_val': 3.0799040100747237, 'psi': 0.33261477045908183}
[S11] START round=16 head_norm_before_train=1.111264 cos_to_last_merge=0.9871 (last merge round=13)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.249931899845491, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.11220505470833, 'psi': 0.0}
[S13] START round=16 head_norm_before_train=1.364803 (no previous merge yet)
[S13] round=16 local utility u=0.086080 metrics={'f1_val': 0.6635631618582013, 'auprc': 0.6635631618582013, 'loss_val': 1.0011127920748764, 'psi': 0.6635631618582013}-{'f1_val': 0.6466289854477308, 'auprc': 0.6466289854477308, 'loss_val': 1.0208653503127572, 'psi': 0.6466289854477308}
[S14] START round=16 head_norm_before_train=1.635466 (no previous merge yet)
[S14] round=16 local utility u=0.301288 metrics={'f1_val': 0.13071401586701928, 'auprc': 0.13071401586701928, 'loss_val': 5.437020716992187, 'psi': 0.13071401586701928}-{'f1_val': 0.07653910149750416, 'auprc': 0.07653910149750416, 'loss_val': 5.552022566992589, 'psi': 0.07653910149750416}
[S15] START round=16 head_norm_before_train=1.560918 (no previous merge yet)
[S15] round=16 local utility u=0.025202 metrics={'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.8274225469697528, 'psi': 0.2836055656382335}-{'f1_val': 0.28346647300895667, 'auprc': 0.28346647300895667, 'loss_val': 0.8765738784749634, 'psi': 0.28346647300895667}
[S16] START round=16 head_norm_before_train=1.622621 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.0656312625250501, 'auprc': 0.0656312625250501, 'loss_val': 3.3654534683359714, 'psi': 0.0656312625250501}-{'f1_val': 0.06245278267438933, 'auprc': 0.06245278267438933, 'loss_val': 3.1490037840870744, 'psi': 0.06245278267438932}
[S17] START round=16 head_norm_before_train=1.531629 cos_to_last_merge=0.9915 (last merge round=13)
[S17] round=16 local utility u=0.012325 metrics={'f1_val': 0.0015862944162436548, 'auprc': 0.0015862944162436548, 'loss_val': 1.278308891954373, 'psi': 0.0015862944162436548}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.288681513233377, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:51905
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:51907
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:51912
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S8] → sending delta(kind=head bytes=1809) to S17@127.0.0.1:51917
[S14] not sending this round → trigger blocked (psi=0.131)
[S8] sending update (kind=head size=1809 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.9337
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=-0.0489
[S6] DROPPED delta from S10 (cos=-0.0489 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1809) from S8
[S17] cosine check vs S8: cos=0.9578
[S11] RECEIVED delta(kind=head bytes=1797) from S13
[S11] cosine check vs S13: cos=-0.1228
[S11] DROPPED delta from S13 (cos=-0.1228 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.002)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.2018 head_norm=1.400023
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.872442e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.2019 head_norm=1.469188 delta_norm=0.287244
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.0016 head_norm=1.560068
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.328301e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.1522 head_norm=1.572926 delta_norm=0.232830
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.588879 (no previous merge yet)
[S2] round=17 local utility u=0.852359 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.314107808985154, 'psi': 0.3674775928297055}-{'f1_val': 0.199468085106383, 'auprc': 0.199468085106383, 'loss_val': 2.5067394130538765, 'psi': 0.199468085106383}
[S3] START round=17 head_norm_before_train=1.629197 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.2972503882342194, 'auprc': 0.2972503882342194, 'loss_val': 2.859784911413241, 'psi': 0.2972503882342194}-{'f1_val': 0.29763866007688083, 'auprc': 0.29763866007688083, 'loss_val': 2.7457600396847477, 'psi': 0.29763866007688083}
[S4] START round=17 head_norm_before_train=1.652039 (no previous merge yet)
[S4] round=17 local utility u=0.003236 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1974639916355405, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.203935546966979, 'psi': 0.3567939207526687}
[S5] START round=17 head_norm_before_train=1.469188 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.20081411126187246, 'auprc': 0.20081411126187246, 'loss_val': 1.2866491937622775, 'psi': 0.20081411126187246}-{'f1_val': 0.20180528691166988, 'auprc': 0.20180528691166988, 'loss_val': 1.2642708598953936, 'psi': 0.20180528691166988}
[S6] START round=17 head_norm_before_train=1.604027 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.487298199705028, 'psi': 0.0}-{'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 4.852738701354857, 'psi': 0.023059360730593607}
[S7] START round=17 head_norm_before_train=1.430969 (no previous merge yet)
[S7] round=17 local utility u=0.006909 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.441997021085205, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.45581446081434, 'psi': 0.0}
[S8] START round=17 head_norm_before_train=1.619507 (no previous merge yet)
[S8] round=17 local utility u=1.000000 metrics={'f1_val': 0.5760905601484203, 'auprc': 0.5760905601484203, 'loss_val': 0.8676308707229992, 'psi': 0.5760905601484203}-{'f1_val': 0.34119673139937845, 'auprc': 0.34119673139937845, 'loss_val': 0.9034438620730486, 'psi': 0.34119673139937845}
[S9] START round=17 head_norm_before_train=1.671187 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2732911013686974, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2045217203524836, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.587922 (no previous merge yet)
[S10] round=17 local utility u=0.040384 metrics={'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 2.929608340374885, 'psi': 0.3328546353917345}-{'f1_val': 0.3326947637292465, 'auprc': 0.3326947637292465, 'loss_val': 3.0089375834519005, 'psi': 0.3326947637292465}
[S11] START round=17 head_norm_before_train=1.153603 cos_to_last_merge=0.9760 (last merge round=13)
[S11] round=17 local utility u=0.002534 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2448648295326215, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.249931899845491, 'psi': 0.0}
[S13] START round=17 head_norm_before_train=1.387383 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6637946532568128, 'auprc': 0.6637946532568128, 'loss_val': 1.0127258605213247, 'psi': 0.6637946532568128}-{'f1_val': 0.6635631618582013, 'auprc': 0.6635631618582013, 'loss_val': 1.0011127920748764, 'psi': 0.6635631618582013}
[S14] START round=17 head_norm_before_train=1.661486 (no previous merge yet)
[S14] round=17 local utility u=0.052536 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.378866896890943, 'psi': 0.13592717296421}-{'f1_val': 0.13071401586701928, 'auprc': 0.13071401586701928, 'loss_val': 5.437020716992187, 'psi': 0.13071401586701928}
[S15] START round=17 head_norm_before_train=1.588074 (no previous merge yet)
[S15] round=17 local utility u=0.022961 metrics={'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.7815013366859221, 'psi': 0.2836055656382335}-{'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.8274225469697528, 'psi': 0.2836055656382335}
[S16] START round=17 head_norm_before_train=1.647322 (no previous merge yet)
[S16] round=17 local utility u=0.146186 metrics={'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 3.296593069398267, 'psi': 0.09046591544793414}-{'f1_val': 0.0656312625250501, 'auprc': 0.0656312625250501, 'loss_val': 3.3654534683359714, 'psi': 0.0656312625250501}
[S17] START round=17 head_norm_before_train=1.572926 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.687398 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.2595591171955323, 'psi': 0.1522581895716224}-{'f1_val': 0.0015862944162436548, 'auprc': 0.0015862944162436548, 'loss_val': 1.278308891954373, 'psi': 0.0015862944162436548}
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S14
[S5]  timeout peer S16
[S5]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:51910
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.152)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:51907
[S16] not sending this round → trigger blocked (psi=0.090)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:51917
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:51905
[S9] RECEIVED delta(kind=head bytes=1798) from S2
[S9] cosine check vs S2: cos=-0.1222
[S9] DROPPED delta from S2 (cos=-0.1222 < 0.0)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.9757
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.9832
[S6] RECEIVED delta(kind=head bytes=1803) from S10
[S6] cosine check vs S10: cos=-0.0498
[S6] DROPPED delta from S10 (cos=-0.0498 < 0.0)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.1523 head_norm=1.593271
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.522374e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.1523 head_norm=1.617611 delta_norm=0.152237
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] CommDone barrier timeout: have=2 need=3 — continuing
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.2008 head_norm=1.496907
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.816378e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.2012 head_norm=1.547057 delta_norm=0.181638
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.612892 (no previous merge yet)
[S2] round=18 local utility u=0.005592 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.30292363228671, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.314107808985154, 'psi': 0.3674775928297055}
[S3] START round=18 head_norm_before_train=1.657257 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.29741339914084636, 'auprc': 0.29741339914084636, 'loss_val': 3.058162357377285, 'psi': 0.29741339914084636}-{'f1_val': 0.2972503882342194, 'auprc': 0.2972503882342194, 'loss_val': 2.859784911413241, 'psi': 0.2972503882342194}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=18 head_norm_before_train=1.676796 (no previous merge yet)
[S4] round=18 local utility u=0.005288 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.186887892574225, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1974639916355405, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=18 head_norm_before_train=1.547057 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.0007388935069733075, 'auprc': 0.0007388935069733075, 'loss_val': 1.4020629035196552, 'psi': 0.0007388935069733075}-{'f1_val': 0.20081411126187246, 'auprc': 0.20081411126187246, 'loss_val': 1.2866491937622775, 'psi': 0.20081411126187246}
[S6] START round=18 head_norm_before_train=1.624267 (no previous merge yet)
[S6] round=18 local utility u=0.077689 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.487880931893807, 'psi': 0.01732902033271719}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.487298199705028, 'psi': 0.0}
[S7] START round=18 head_norm_before_train=1.446005 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4439690763152278, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.441997021085205, 'psi': 0.0}
[S8] START round=18 head_norm_before_train=1.655649 (no previous merge yet)
[S8] round=18 local utility u=1.000000 metrics={'f1_val': 0.9997178063266456, 'auprc': 0.9997178063266456, 'loss_val': 0.8407142918171481, 'psi': 0.9997178063266456}-{'f1_val': 0.5760905601484203, 'auprc': 0.5760905601484203, 'loss_val': 0.8676308707229992, 'psi': 0.5760905601484203}
[S9] START round=18 head_norm_before_train=1.690060 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.339728002776822, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2732911013686974, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.606705 (no previous merge yet)
[S10] round=18 local utility u=0.039264 metrics={'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 2.8510826917463183, 'psi': 0.3328548644338118}-{'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 2.929608340374885, 'psi': 0.3328546353917345}
[S11] START round=18 head_norm_before_train=1.191178 cos_to_last_merge=0.9660 (last merge round=13)
[S11] round=18 local utility u=0.102024 metrics={'f1_val': 0.011325374961738598, 'auprc': 0.011325374961738598, 'loss_val': 2.1427447887367785, 'psi': 0.011325374961738598}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2448648295326215, 'psi': 0.0}
[S13] START round=18 head_norm_before_train=1.405316 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.31508807289650603, 'auprc': 0.31508807289650603, 'loss_val': 1.0231123287367527, 'psi': 0.31508807289650603}-{'f1_val': 0.6637946532568128, 'auprc': 0.6637946532568128, 'loss_val': 1.0127258605213247, 'psi': 0.6637946532568128}
[S14] START round=18 head_norm_before_train=1.688189 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 5.381522019945872, 'psi': 0.13232893910860014}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.378866896890943, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=18 head_norm_before_train=1.616175 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.2833272793316382, 'auprc': 0.2833272793316382, 'loss_val': 0.8110261987133132, 'psi': 0.2833272793316382}-{'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.7815013366859221, 'psi': 0.2836055656382335}
[S16] START round=18 head_norm_before_train=1.669853 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.09060402684563758, 'auprc': 0.09060402684563758, 'loss_val': 3.4386393503138013, 'psi': 0.09060402684563758}-{'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 3.296593069398267, 'psi': 0.09046591544793414}
[S17] START round=18 head_norm_before_train=1.617611 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.009796081567373051, 'auprc': 0.009796081567373051, 'loss_val': 1.275667408331244, 'psi': 0.009796081567373051}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.2595591171955323, 'psi': 0.1522581895716224}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:51917
[S6] not sending this round → trigger blocked (psi=0.017)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9910
[S9] RECEIVED delta(kind=head bytes=1799) from S2
[S9] cosine check vs S2: cos=-0.1245
[S9] DROPPED delta from S2 (cos=-0.1245 < 0.0)
[S11] not sending this round → trigger blocked (psi=0.011)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:51907
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S10
[S6] cosine check vs S10: cos=-0.0503
[S6] DROPPED delta from S10 (cos=-0.0503 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.0098 head_norm=1.637133
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.149386e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.1526 head_norm=1.660299 delta_norm=0.114939
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S15]  timeout peer S6
[S17]  timeout peer S2
[S17]  timeout peer S8
[S5]  timeout peer S7
[S5]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S16]  timeout peer S17
[S13]  timeout peer S11
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=19 head_norm_before_train=1.637199 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.2531139077121652, 'auprc': 0.2531139077121652, 'loss_val': 2.3944087447521776, 'psi': 0.2531139077121652}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.30292363228671, 'psi': 0.3674775928297055}
[S3] START round=19 head_norm_before_train=1.683276 (no previous merge yet)
[S3] round=19 local utility u=0.059693 metrics={'f1_val': 0.29357136416914614, 'auprc': 0.29357136416914614, 'loss_val': 2.9041989322504493, 'psi': 0.29357136416914614}-{'f1_val': 0.29741339914084636, 'auprc': 0.29741339914084636, 'loss_val': 3.058162357377285, 'psi': 0.29741339914084636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S3] r=20 psi=0.294 u=0.0597 p_local=0.1017 f1=0.294 auprc=0.294 bytes=3606
[S4] START round=19 head_norm_before_train=1.696253 (no previous merge yet)
[S4] round=19 local utility u=0.004168 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1785526780292048, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.186887892574225, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S4] r=20 psi=0.357 u=0.0042 p_local=0.1444 f1=0.357 auprc=0.357 bytes=10799
[S5] START round=19 head_norm_before_train=1.575827 cos_to_last_merge=0.9985 (last merge round=17)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.0007388935069733075, 'auprc': 0.0007388935069733075, 'loss_val': 2.1558657626490287, 'psi': 0.0007388935069733075}-{'f1_val': 0.0007388935069733075, 'auprc': 0.0007388935069733075, 'loss_val': 1.4020629035196552, 'psi': 0.0007388935069733075}
[S6] START round=19 head_norm_before_train=1.641075 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.615385062809848, 'psi': 0.01732902033271719}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.487880931893807, 'psi': 0.01732902033271719}
[S7] START round=19 head_norm_before_train=1.463811 (no previous merge yet)
[S7] round=19 local utility u=0.013502 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4169643538409733, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4439690763152278, 'psi': 0.0}
[S7] not sending this round → trigger blocked (psi=0.000)
[S7] r=20 psi=0.000 u=0.0135 p_local=0.0248 f1=0.000 auprc=0.000 bytes=0
[S8] START round=19 head_norm_before_train=1.690977 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8274107001541485, 'psi': 0.35939447907390915}-{'f1_val': 0.9997178063266456, 'auprc': 0.9997178063266456, 'loss_val': 0.8407142918171481, 'psi': 0.9997178063266456}
[S9] START round=19 head_norm_before_train=1.706261 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.412261903126299, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.339728002776822, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.628882 (no previous merge yet)
[S10] round=19 local utility u=0.040056 metrics={'f1_val': 0.3328550932568149, 'auprc': 0.3328550932568149, 'loss_val': 2.7709736609458067, 'psi': 0.3328550932568149}-{'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 2.8510826917463183, 'psi': 0.3328548644338118}
[S11] START round=19 head_norm_before_train=1.219595 cos_to_last_merge=0.9582 (last merge round=13)
[S11] round=19 local utility u=0.797190 metrics={'f1_val': 0.20519452527211982, 'auprc': 0.20519452527211982, 'loss_val': 2.293186957799463, 'psi': 0.20519452527211982}-{'f1_val': 0.011325374961738598, 'auprc': 0.011325374961738598, 'loss_val': 2.1427447887367785, 'psi': 0.011325374961738598}
[S13] START round=19 head_norm_before_train=1.420532 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.24114185071777414, 'auprc': 0.24114185071777414, 'loss_val': 1.0211039039603909, 'psi': 0.24114185071777414}-{'f1_val': 0.31508807289650603, 'auprc': 0.31508807289650603, 'loss_val': 1.0231123287367527, 'psi': 0.31508807289650603}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.241 u=0.0000 p_local=0.1534 f1=0.241 auprc=0.241 bytes=8978
[S14] START round=19 head_norm_before_train=1.715959 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.12560386473429952, 'auprc': 0.12560386473429952, 'loss_val': 5.409137564274022, 'psi': 0.12560386473429952}-{'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 5.381522019945872, 'psi': 0.13232893910860014}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=20 psi=0.126 u=0.0000 p_local=0.0812 f1=0.126 auprc=0.126 bytes=0
[S15] START round=19 head_norm_before_train=1.642196 (no previous merge yet)
[S15] round=19 local utility u=1.000000 metrics={'f1_val': 0.6167756603166533, 'auprc': 0.6167756603166533, 'loss_val': 0.7283883319688927, 'psi': 0.6167756603166533}-{'f1_val': 0.2833272793316382, 'auprc': 0.2833272793316382, 'loss_val': 0.8110261987133132, 'psi': 0.2833272793316382}
[S16] START round=19 head_norm_before_train=1.690562 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.0900727941764659, 'auprc': 0.0900727941764659, 'loss_val': 3.681431694405601, 'psi': 0.0900727941764659}-{'f1_val': 0.09060402684563758, 'auprc': 0.09060402684563758, 'loss_val': 3.4386393503138013, 'psi': 0.09060402684563758}
[S17] START round=19 head_norm_before_train=1.660299 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.007523510971786834, 'auprc': 0.007523510971786834, 'loss_val': 1.3011983931470992, 'psi': 0.007523510971786834}-{'f1_val': 0.009796081567373051, 'auprc': 0.009796081567373051, 'loss_val': 1.275667408331244, 'psi': 0.009796081567373051}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:51913
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:51907
[S16] r=20 psi=0.090 u=0.0000 p_local=0.0579 f1=0.090 auprc=0.090 bytes=0
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0743 f1=0.369 auprc=0.369 bytes=3600
[S15] sending update (kind=head size=1794 to 1 peers)
[S6] r=20 psi=0.017 u=0.0000 p_local=0.0766 f1=0.017 auprc=0.017 bytes=0
[S17] r=20 psi=0.008 u=0.0000 p_local=0.1339 f1=0.008 auprc=0.008 bytes=0
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] r=20 psi=0.253 u=0.0000 p_local=0.2258 f1=0.253 auprc=0.253 bytes=5395
[S8] r=20 psi=0.359 u=0.0000 p_local=0.3587 f1=0.359 auprc=0.359 bytes=18033
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] cosine check vs S11: cos=-0.1256
[S13] DROPPED delta from S11 (cos=-0.1256 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S10
[S6] cosine check vs S10: cos=-0.0508
[S6] DROPPED delta from S10 (cos=-0.0508 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S15
[S5] cosine check vs S15: cos=0.9766
[S10] r=20 psi=0.333 u=0.0401 p_local=0.1431 f1=0.333 auprc=0.333 bytes=10804
[S15] r=20 psi=0.617 u=1.0000 p_local=0.2877 f1=0.617 auprc=0.617 bytes=12601
[S11] r=20 psi=0.205 u=0.7972 p_local=0.2046 f1=0.205 auprc=0.205 bytes=1800
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.0007 head_norm=1.611053
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.793910e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.0006 head_norm=1.629365 delta_norm=0.179391
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.001 u=0.0000 p_local=0.1217 f1=0.001 auprc=0.001 bytes=8997
[S2] START round=20 head_norm_before_train=1.659585 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.20350877192982456, 'auprc': 0.20350877192982456, 'loss_val': 2.659031641308471, 'psi': 0.20350877192982456}-{'f1_val': 0.2531139077121652, 'auprc': 0.2531139077121652, 'loss_val': 2.3944087447521776, 'psi': 0.2531139077121652}
[S3] START round=20 head_norm_before_train=1.703527 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.2959080459770115, 'auprc': 0.2959080459770115, 'loss_val': 3.5107280278233324, 'psi': 0.2959080459770115}-{'f1_val': 0.29357136416914614, 'auprc': 0.29357136416914614, 'loss_val': 2.9041989322504493, 'psi': 0.29357136416914614}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=20 head_norm_before_train=1.716389 (no previous merge yet)
[S4] round=20 local utility u=0.007850 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.16285348421201, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1785526780292048, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=20 head_norm_before_train=1.629365 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.0005729017473503294, 'auprc': 0.0005729017473503294, 'loss_val': 2.2157653510842654, 'psi': 0.0005729017473503294}-{'f1_val': 0.0007388935069733075, 'auprc': 0.0007388935069733075, 'loss_val': 2.1558657626490287, 'psi': 0.0007388935069733075}
[S6] START round=20 head_norm_before_train=1.658286 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.730376292186996, 'psi': 0.017551963048498844}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.615385062809848, 'psi': 0.01732902033271719}
[S7] START round=20 head_norm_before_train=1.473607 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4183681522276796, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4169643538409733, 'psi': 0.0}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=20 head_norm_before_train=1.723455 (no previous merge yet)
[S8] round=20 local utility u=0.002392 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8226270584739978, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8274107001541485, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.720895 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4720020199761956, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.412261903126299, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.657583 (no previous merge yet)
[S10] round=20 local utility u=0.045886 metrics={'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.6792029517606135, 'psi': 0.332855321861058}-{'f1_val': 0.3328550932568149, 'auprc': 0.3328550932568149, 'loss_val': 2.7709736609458067, 'psi': 0.3328550932568149}
[S11] START round=20 head_norm_before_train=1.239259 cos_to_last_merge=0.9530 (last merge round=13)
[S11] round=20 local utility u=0.503340 metrics={'f1_val': 0.3112879164594729, 'auprc': 0.3112879164594729, 'loss_val': 2.241347133449797, 'psi': 0.3112879164594729}-{'f1_val': 0.20519452527211982, 'auprc': 0.20519452527211982, 'loss_val': 2.293186957799463, 'psi': 0.20519452527211982}
[S13] START round=20 head_norm_before_train=1.435400 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.2385851602016014, 'auprc': 0.2385851602016014, 'loss_val': 1.019054220416277, 'psi': 0.2385851602016014}-{'f1_val': 0.24114185071777414, 'auprc': 0.24114185071777414, 'loss_val': 1.0211039039603909, 'psi': 0.24114185071777414}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=20 head_norm_before_train=1.741305 (no previous merge yet)
[S14] round=20 local utility u=0.016362 metrics={'f1_val': 0.13051146384479717, 'auprc': 0.13051146384479717, 'loss_val': 5.420581026133255, 'psi': 0.13051146384479717}-{'f1_val': 0.12560386473429952, 'auprc': 0.12560386473429952, 'loss_val': 5.409137564274022, 'psi': 0.12560386473429952}
[S14] not sending this round → trigger blocked (psi=0.131)
[S15] START round=20 head_norm_before_train=1.666892 (no previous merge yet)
[S15] round=20 local utility u=0.020444 metrics={'f1_val': 0.6166941009299512, 'auprc': 0.6166941009299512, 'loss_val': 0.6867663619783445, 'psi': 0.6166941009299512}-{'f1_val': 0.6167756603166533, 'auprc': 0.6167756603166533, 'loss_val': 0.7283883319688927, 'psi': 0.6167756603166533}
[S16] START round=20 head_norm_before_train=1.708722 (no previous merge yet)
[S16] round=20 local utility u=0.114283 metrics={'f1_val': 0.10837590958352687, 'auprc': 0.10837590958352687, 'loss_val': 3.617592958393673, 'psi': 0.10837590958352689}-{'f1_val': 0.0900727941764659, 'auprc': 0.0900727941764659, 'loss_val': 3.681431694405601, 'psi': 0.0900727941764659}
[S17] START round=20 head_norm_before_train=1.679960 cos_to_last_merge=0.9992 (last merge round=18)
[S17] round=20 local utility u=0.689312 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.2251856357836708, 'psi': 0.1522581895716224}-{'f1_val': 0.007523510971786834, 'auprc': 0.007523510971786834, 'loss_val': 1.3011983931470992, 'psi': 0.007523510971786834}
[S16] not sending this round → trigger blocked (psi=0.108)
[S17] not sending this round → trigger blocked (psi=0.152)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:51913
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:51907
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S9] ⇄ pheromone p=0.059 → S2@127.0.0.1:51902
[S2] ⇄ pheromone p=0.181 → S9@127.0.0.1:51910
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.061 → S10@127.0.0.1:51911
[S17] ⇄ pheromone p=0.245 → S16@127.0.0.1:51916
[S16] ⇄ pheromone p=0.069 → S7@127.0.0.1:51908
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.9867
[S6] RECEIVED delta(kind=head bytes=1804) from S10
[S6] cosine check vs S10: cos=-0.0508
[S6] DROPPED delta from S10 (cos=-0.0508 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.9893
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=-0.1265
[S13] DROPPED delta from S11 (cos=-0.1265 < 0.0)
[S11] ⇄ pheromone p=0.264 → S13@127.0.0.1:51913
[S15] ⇄ pheromone p=0.234 → S5@127.0.0.1:51905
[S8] ⇄ pheromone p=0.287 → S17@127.0.0.1:51917
[S10] ⇄ pheromone p=0.124 → S6@127.0.0.1:51907
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.0006 head_norm=1.664461
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.380713e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.0006 head_norm=1.674889 delta_norm=0.138071
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.097 → S15@127.0.0.1:51915
[S2] START round=21 head_norm_before_train=1.679524 (no previous merge yet)
[S2] round=21 local utility u=0.883804 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3671437006231093, 'psi': 0.3674775928297055}-{'f1_val': 0.20350877192982456, 'auprc': 0.20350877192982456, 'loss_val': 2.659031641308471, 'psi': 0.20350877192982456}
[S3] START round=21 head_norm_before_train=1.726991 (no previous merge yet)
[S3] round=21 local utility u=0.140415 metrics={'f1_val': 0.29684364167122784, 'auprc': 0.29684364167122784, 'loss_val': 3.238319313853738, 'psi': 0.29684364167122784}-{'f1_val': 0.2959080459770115, 'auprc': 0.2959080459770115, 'loss_val': 3.5107280278233324, 'psi': 0.2959080459770115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=21 head_norm_before_train=1.737379 (no previous merge yet)
[S4] round=21 local utility u=0.008808 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1452369810747207, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.16285348421201, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=21 head_norm_before_train=1.674889 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.397072 metrics={'f1_val': 0.0854070213805458, 'auprc': 0.0854070213805458, 'loss_val': 2.185129209301491, 'psi': 0.0854070213805458}-{'f1_val': 0.0005729017473503294, 'auprc': 0.0005729017473503294, 'loss_val': 2.2157653510842654, 'psi': 0.0005729017473503294}
[S6] START round=21 head_norm_before_train=1.674399 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.867901824509249, 'psi': 0.01732902033271719}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.730376292186996, 'psi': 0.017551963048498844}
[S7] START round=21 head_norm_before_train=1.483369 (no previous merge yet)
[S7] round=21 local utility u=0.541162 metrics={'f1_val': 0.11497125718570357, 'auprc': 0.11497125718570357, 'loss_val': 1.3707851000843887, 'psi': 0.11497125718570358}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4183681522276796, 'psi': 0.0}
[S7] not sending this round → trigger blocked (psi=0.115)
[S8] START round=21 head_norm_before_train=1.751977 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.823195693578113, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8226270584739978, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.733448 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5236972480171156, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4720020199761956, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.690159 (no previous merge yet)
[S10] round=21 local utility u=0.038688 metrics={'f1_val': 0.33293508562325763, 'auprc': 0.33293508562325763, 'loss_val': 2.602544887903039, 'psi': 0.33293508562325763}-{'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.6792029517606135, 'psi': 0.332855321861058}
[S11] START round=21 head_norm_before_train=1.255340 cos_to_last_merge=0.9490 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.3139477575160177, 'auprc': 0.3139477575160177, 'loss_val': 2.303181661528744, 'psi': 0.3139477575160177}-{'f1_val': 0.3112879164594729, 'auprc': 0.3112879164594729, 'loss_val': 2.241347133449797, 'psi': 0.3112879164594729}
[S13] START round=21 head_norm_before_train=1.450444 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.23787501482272025, 'auprc': 0.23787501482272025, 'loss_val': 1.0296869295928066, 'psi': 0.23787501482272028}-{'f1_val': 0.2385851602016014, 'auprc': 0.2385851602016014, 'loss_val': 1.019054220416277, 'psi': 0.2385851602016014}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.763996 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13071401586701928, 'auprc': 0.13071401586701928, 'loss_val': 5.42865822040598, 'psi': 0.13071401586701928}-{'f1_val': 0.13051146384479717, 'auprc': 0.13051146384479717, 'loss_val': 5.420581026133255, 'psi': 0.13051146384479717}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=21 head_norm_before_train=1.696528 (no previous merge yet)
[S15] round=21 local utility u=0.015318 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.654144035739843, 'psi': 0.6164734888353558}-{'f1_val': 0.6166941009299512, 'auprc': 0.6166941009299512, 'loss_val': 0.6867663619783445, 'psi': 0.6166941009299512}
[S16] START round=21 head_norm_before_train=1.725357 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.11069996916435398, 'auprc': 0.11069996916435398, 'loss_val': 3.720206911279635, 'psi': 0.11069996916435398}-{'f1_val': 0.10837590958352687, 'auprc': 0.10837590958352687, 'loss_val': 3.617592958393673, 'psi': 0.10837590958352689}
[S17] START round=21 head_norm_before_train=1.700079 cos_to_last_merge=0.9974 (last merge round=18)
[S17] round=21 local utility u=0.015994 metrics={'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 1.1929315981986872, 'psi': 0.15222868217054264}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.2251856357836708, 'psi': 0.1522581895716224}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:51905
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.152)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:51910
[S5] not sending this round → trigger blocked (psi=0.085)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.1522 head_norm=1.719863
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.493507e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.1522 head_norm=1.729558 delta_norm=0.149351
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.9909
[S9] RECEIVED delta(kind=head bytes=1803) from S2
[S9] cosine check vs S2: cos=-0.1275
[S9] DROPPED delta from S2 (cos=-0.1275 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.0854 head_norm=1.707998
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.164663e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.1851 head_norm=1.713833 delta_norm=0.116466
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:51907
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=-0.0503
[S6] DROPPED delta from S10 (cos=-0.0503 < 0.0)
[S2] START round=22 head_norm_before_train=1.697187 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4219101508868186, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3671437006231093, 'psi': 0.3674775928297055}
[S3] START round=22 head_norm_before_train=1.750336 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 3.5979682538467257, 'psi': 0.2975373066007507}-{'f1_val': 0.29684364167122784, 'auprc': 0.29684364167122784, 'loss_val': 3.238319313853738, 'psi': 0.29684364167122784}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.761966 (no previous merge yet)
[S4] round=22 local utility u=0.009280 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.126676761917745, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1452369810747207, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=22 head_norm_before_train=1.713833 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=1.000000 metrics={'f1_val': 0.33459436738125264, 'auprc': 0.33459436738125264, 'loss_val': 2.1910232784569152, 'psi': 0.33459436738125264}-{'f1_val': 0.0854070213805458, 'auprc': 0.0854070213805458, 'loss_val': 2.185129209301491, 'psi': 0.0854070213805458}
[S6] START round=22 head_norm_before_train=1.689904 (no previous merge yet)
[S6] round=22 local utility u=0.004836 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 5.868242813645914, 'psi': 0.018441678192715538}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.867901824509249, 'psi': 0.01732902033271719}
[S7] START round=22 head_norm_before_train=1.496091 (no previous merge yet)
[S7] round=22 local utility u=0.439780 metrics={'f1_val': 0.20648398301813972, 'auprc': 0.20648398301813972, 'loss_val': 1.3148394030954673, 'psi': 0.20648398301813972}-{'f1_val': 0.11497125718570357, 'auprc': 0.11497125718570357, 'loss_val': 1.3707851000843887, 'psi': 0.11497125718570358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=22 head_norm_before_train=1.776209 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8296083054547253, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.823195693578113, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.744890 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.565679161172555, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5236972480171156, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.725838 (no previous merge yet)
[S10] round=22 local utility u=0.038219 metrics={'f1_val': 0.33293508562325763, 'auprc': 0.33293508562325763, 'loss_val': 2.526106098545643, 'psi': 0.33293508562325763}-{'f1_val': 0.33293508562325763, 'auprc': 0.33293508562325763, 'loss_val': 2.602544887903039, 'psi': 0.33293508562325763}
[S11] START round=22 head_norm_before_train=1.274953 cos_to_last_merge=0.9450 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=22 local utility u=0.092517 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.2821265663356702, 'psi': 0.33216756042589574}-{'f1_val': 0.3139477575160177, 'auprc': 0.3139477575160177, 'loss_val': 2.303181661528744, 'psi': 0.3139477575160177}
[S13] START round=22 head_norm_before_train=1.460857 (no previous merge yet)
[S13] round=22 local utility u=0.009972 metrics={'f1_val': 0.23830424731385758, 'auprc': 0.23830424731385758, 'loss_val': 1.013605793550168, 'psi': 0.23830424731385758}-{'f1_val': 0.23787501482272025, 'auprc': 0.23787501482272025, 'loss_val': 1.0296869295928066, 'psi': 0.23787501482272028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=22 head_norm_before_train=1.784067 (no previous merge yet)
[S14] round=22 local utility u=0.009353 metrics={'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 5.438934324597415, 'psi': 0.13393415946927026}-{'f1_val': 0.13071401586701928, 'auprc': 0.13071401586701928, 'loss_val': 5.42865822040598, 'psi': 0.13071401586701928}
[S14] not sending this round → trigger blocked (psi=0.134)
[S15] START round=22 head_norm_before_train=1.727519 (no previous merge yet)
[S15] round=22 local utility u=0.018711 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6154686812696388, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.654144035739843, 'psi': 0.6164734888353558}
[S16] START round=22 head_norm_before_train=1.741416 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.10104338275672707, 'auprc': 0.10104338275672707, 'loss_val': 3.8461709828088657, 'psi': 0.10104338275672707}-{'f1_val': 0.11069996916435398, 'auprc': 0.11069996916435398, 'loss_val': 3.720206911279635, 'psi': 0.11069996916435398}
[S17] START round=22 head_norm_before_train=1.729558 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.003504 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.1869868267782326, 'psi': 0.15234678044996122}-{'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 1.1929315981986872, 'psi': 0.15222868217054264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:51905
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:51907
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:51913
[S17] not sending this round → trigger blocked (psi=0.152)
[S6] not sending this round → trigger blocked (psi=0.018)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:51915
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S10
[S6] cosine check vs S10: cos=-0.0493
[S6] DROPPED delta from S10 (cos=-0.0493 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.9933
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=-0.1261
[S13] DROPPED delta from S11 (cos=-0.1261 < 0.0)
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9933
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.3346 head_norm=1.743654
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.016117e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.3346 head_norm=1.748177 delta_norm=0.101612
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.713678 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.2477143563133185, 'auprc': 0.2477143563133185, 'loss_val': 2.465252798130385, 'psi': 0.2477143563133185}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4219101508868186, 'psi': 0.3674775928297055}
[S3] START round=23 head_norm_before_train=1.774459 (no previous merge yet)
[S3] round=23 local utility u=0.065335 metrics={'f1_val': 0.29741339914084636, 'auprc': 0.29741339914084636, 'loss_val': 3.4661827141231942, 'psi': 0.29741339914084636}-{'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 3.5979682538467257, 'psi': 0.2975373066007507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=23 head_norm_before_train=1.780121 (no previous merge yet)
[S4] round=23 local utility u=0.004644 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1173880963047196, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.126676761917745, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=23 head_norm_before_train=1.748177 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.049652 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0826754368608746, 'psi': 0.33358943696313936}-{'f1_val': 0.33459436738125264, 'auprc': 0.33459436738125264, 'loss_val': 2.1910232784569152, 'psi': 0.33459436738125264}
[S6] START round=23 head_norm_before_train=1.701986 (no previous merge yet)
[S6] round=23 local utility u=0.533786 metrics={'f1_val': 0.08813091482649842, 'auprc': 0.08813091482649842, 'loss_val': 5.4278744851444705, 'psi': 0.08813091482649842}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 5.868242813645914, 'psi': 0.018441678192715538}
[S7] START round=23 head_norm_before_train=1.513026 (no previous merge yet)
[S7] round=23 local utility u=0.049542 metrics={'f1_val': 0.21476849219885033, 'auprc': 0.21476849219885033, 'loss_val': 1.2903155258366727, 'psi': 0.21476849219885033}-{'f1_val': 0.20648398301813972, 'auprc': 0.20648398301813972, 'loss_val': 1.3148394030954673, 'psi': 0.20648398301813972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=23 head_norm_before_train=1.803560 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8417166251858565, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8296083054547253, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.755561 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5997887960887085, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.565679161172555, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.762815 (no previous merge yet)
[S10] round=23 local utility u=0.022671 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.4800483804393485, 'psi': 0.3328555502468546}-{'f1_val': 0.33293508562325763, 'auprc': 0.33293508562325763, 'loss_val': 2.526106098545643, 'psi': 0.33293508562325763}
[S11] START round=23 head_norm_before_train=1.296628 cos_to_last_merge=0.9408 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=23 local utility u=0.008464 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.264501303310899, 'psi': 0.3320901320901321}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.2821265663356702, 'psi': 0.33216756042589574}
[S13] START round=23 head_norm_before_train=1.470649 (no previous merge yet)
[S13] round=23 local utility u=0.004626 metrics={'f1_val': 0.23821369343757404, 'auprc': 0.23821369343757404, 'loss_val': 1.0035387814480077, 'psi': 0.23821369343757404}-{'f1_val': 0.23830424731385758, 'auprc': 0.23830424731385758, 'loss_val': 1.013605793550168, 'psi': 0.23830424731385758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=23 head_norm_before_train=1.801962 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.4618683663621646, 'psi': 0.1355297641332834}-{'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 5.438934324597415, 'psi': 0.13393415946927026}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=23 head_norm_before_train=1.758570 (no previous merge yet)
[S15] round=23 local utility u=0.038757 metrics={'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.5467044967858756, 'psi': 0.6173065327346117}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6154686812696388, 'psi': 0.6163342951580373}
[S16] START round=23 head_norm_before_train=1.756654 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.09101796407185629, 'auprc': 0.09101796407185629, 'loss_val': 3.992455124314103, 'psi': 0.09101796407185629}-{'f1_val': 0.10104338275672707, 'auprc': 0.10104338275672707, 'loss_val': 3.8461709828088657, 'psi': 0.10104338275672707}
[S17] START round=23 head_norm_before_train=1.745945 cos_to_last_merge=0.9997 (last merge round=21)
[S17] round=23 local utility u=0.031337 metrics={'f1_val': 0.1575727181544634, 'auprc': 0.1575727181544634, 'loss_val': 1.171345808281099, 'psi': 0.1575727181544634}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.1869868267782326, 'psi': 0.15234678044996122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:51907
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.088)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:51905
[S17] not sending this round → trigger blocked (psi=0.158)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:51913
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:51915
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S10
[S6] cosine check vs S10: cos=-0.0481
[S6] DROPPED delta from S10 (cos=-0.0481 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] cosine check vs S11: cos=-0.1255
[S13] DROPPED delta from S11 (cos=-0.1255 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.9952
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.6173 head_norm=1.788549
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.104755e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.6173 head_norm=1.762786 delta_norm=0.110475
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=0.9992
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.3336 head_norm=1.773204
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.730520e-02
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.3341 head_norm=1.778752 delta_norm=0.087305
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.728629 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.2531139077121652, 'auprc': 0.2531139077121652, 'loss_val': 2.5402302269802273, 'psi': 0.2531139077121652}-{'f1_val': 0.2477143563133185, 'auprc': 0.2477143563133185, 'loss_val': 2.465252798130385, 'psi': 0.2477143563133185}
[S3] START round=24 head_norm_before_train=1.796730 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 3.643297498354014, 'psi': 0.29773995791014735}-{'f1_val': 0.29741339914084636, 'auprc': 0.29741339914084636, 'loss_val': 3.4661827141231942, 'psi': 0.29741339914084636}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=24 head_norm_before_train=1.797413 (no previous merge yet)
[S4] round=24 local utility u=0.000302 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1167844494707246, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1173880963047196, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=24 head_norm_before_train=1.778752 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.020774 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.041127635024954, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0826754368608746, 'psi': 0.33358943696313936}
[S6] START round=24 head_norm_before_train=1.712608 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.01531322505800464, 'auprc': 0.01531322505800464, 'loss_val': 6.191236969339864, 'psi': 0.015313225058004639}-{'f1_val': 0.08813091482649842, 'auprc': 0.08813091482649842, 'loss_val': 5.4278744851444705, 'psi': 0.08813091482649842}
[S7] START round=24 head_norm_before_train=1.526827 (no previous merge yet)
[S7] round=24 local utility u=0.679394 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2364856432668307, 'psi': 0.35976373724718097}-{'f1_val': 0.21476849219885033, 'auprc': 0.21476849219885033, 'loss_val': 1.2903155258366727, 'psi': 0.21476849219885033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=24 head_norm_before_train=1.827243 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8648839996873433, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8417166251858565, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.765544 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.631700025861221, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5997887960887085, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.798945 (no previous merge yet)
[S10] round=24 local utility u=0.016133 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.447782550357713, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.4800483804393485, 'psi': 0.3328555502468546}
[S11] START round=24 head_norm_before_train=1.319570 cos_to_last_merge=0.9364 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.3341371697688444, 'psi': 0.33216756042589574}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.264501303310899, 'psi': 0.3320901320901321}
[S13] START round=24 head_norm_before_train=1.479229 (no previous merge yet)
[S13] round=24 local utility u=0.012728 metrics={'f1_val': 0.23950398582816654, 'auprc': 0.23950398582816654, 'loss_val': 0.9896963053685996, 'psi': 0.23950398582816654}-{'f1_val': 0.23821369343757404, 'auprc': 0.23821369343757404, 'loss_val': 1.0035387814480077, 'psi': 0.23821369343757404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=24 head_norm_before_train=1.818322 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.490850941633401, 'psi': 0.13572854291417166}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.4618683663621646, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=24 head_norm_before_train=1.762786 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5895357976632448, 'psi': 0.6164734888353558}-{'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.5467044967858756, 'psi': 0.6173065327346117}
[S16] START round=24 head_norm_before_train=1.770783 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.0492619292825266, 'auprc': 0.0492619292825266, 'loss_val': 4.561620975380083, 'psi': 0.0492619292825266}-{'f1_val': 0.09101796407185629, 'auprc': 0.09101796407185629, 'loss_val': 3.992455124314103, 'psi': 0.09101796407185629}
[S17] START round=24 head_norm_before_train=1.764296 cos_to_last_merge=0.9989 (last merge round=21)
[S17] round=24 local utility u=0.002851 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.1183448527889437, 'psi': 0.15231723870467326}-{'f1_val': 0.1575727181544634, 'auprc': 0.1575727181544634, 'loss_val': 1.171345808281099, 'psi': 0.1575727181544634}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:51907
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.152)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:51915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.6165 head_norm=1.787851
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.114185e-02
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.6165 head_norm=1.780067 delta_norm=0.041142
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1804) from S10
[S6] cosine check vs S10: cos=-0.0471
[S6] DROPPED delta from S10 (cos=-0.0471 < 0.0)
[S5] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S5
[S15] cosine check vs S5: cos=0.9999
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=1.742280 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.525281674583529, 'psi': 0.2450298816928894}-{'f1_val': 0.2531139077121652, 'auprc': 0.2531139077121652, 'loss_val': 2.5402302269802273, 'psi': 0.2531139077121652}
[S3] START round=25 head_norm_before_train=1.813650 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 3.8385764196340806, 'psi': 0.2975373066007507}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 3.643297498354014, 'psi': 0.29773995791014735}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.821511 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1271019184881959, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1167844494707246, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=25 head_norm_before_train=1.798271 cos_to_last_merge=0.9996 (last merge round=23)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.084054115068675, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.041127635024954, 'psi': 0.33358943696313936}
[S6] START round=25 head_norm_before_train=1.722356 (no previous merge yet)
[S6] round=25 local utility u=0.005078 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.2032346077089455, 'psi': 0.017774699907663897}-{'f1_val': 0.01531322505800464, 'auprc': 0.01531322505800464, 'loss_val': 6.191236969339864, 'psi': 0.015313225058004639}
[S7] START round=25 head_norm_before_train=1.537861 (no previous merge yet)
[S7] round=25 local utility u=0.019225 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1980364299410007, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2364856432668307, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=25 head_norm_before_train=1.849571 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8984548960499514, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8648839996873433, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.775052 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6583021807332052, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.631700025861221, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.833276 (no previous merge yet)
[S10] round=25 local utility u=0.011831 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.424120195771593, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.447782550357713, 'psi': 0.3328555502468546}
[S11] START round=25 head_norm_before_train=1.343788 cos_to_last_merge=0.9320 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=25 local utility u=0.001989 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.3301597439312114, 'psi': 0.33216756042589574}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.3341371697688444, 'psi': 0.33216756042589574}
[S13] START round=25 head_norm_before_train=1.488243 (no previous merge yet)
[S13] round=25 local utility u=0.010190 metrics={'f1_val': 0.2396552741868839, 'auprc': 0.2396552741868839, 'loss_val': 0.9706782591352731, 'psi': 0.2396552741868839}-{'f1_val': 0.23950398582816654, 'auprc': 0.23950398582816654, 'loss_val': 0.9896963053685996, 'psi': 0.23950398582816654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=25 head_norm_before_train=1.833072 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.542279072902377, 'psi': 0.1355297641332834}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.490850941633401, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=25 head_norm_before_train=1.780067 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.008300 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5729362642475843, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5895357976632448, 'psi': 0.6164734888353558}
[S16] START round=25 head_norm_before_train=1.783997 (no previous merge yet)
[S16] round=25 local utility u=0.770047 metrics={'f1_val': 0.13688771388705295, 'auprc': 0.13688771388705295, 'loss_val': 3.8101580882613715, 'psi': 0.13688771388705295}-{'f1_val': 0.0492619292825266, 'auprc': 0.0492619292825266, 'loss_val': 4.561620975380083, 'psi': 0.0492619292825266}
[S17] START round=25 head_norm_before_train=1.781612 cos_to_last_merge=0.9980 (last merge round=21)
[S17] round=25 local utility u=0.033257 metrics={'f1_val': 0.1526428293820443, 'auprc': 0.1526428293820443, 'loss_val': 1.0547610006253079, 'psi': 0.1526428293820443}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.1183448527889437, 'psi': 0.15231723870467326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:51905
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.137)
[S17] not sending this round → trigger blocked (psi=0.153)
[S2] ⇄ pheromone p=0.132 → S9@127.0.0.1:51910
[S6] ⇄ pheromone p=0.090 → S10@127.0.0.1:51911
[S9] ⇄ pheromone p=0.019 → S2@127.0.0.1:51902
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.9996
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.6165 head_norm=1.805533
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.345975e-02
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.6165 head_norm=1.801855 delta_norm=0.013460
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.087 → S5@127.0.0.1:51905
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.3336 head_norm=1.816227
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.755274e-02
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.3336 head_norm=1.810678 delta_norm=0.027553
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.177 → S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:51907
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=-0.0461
[S6] DROPPED delta from S10 (cos=-0.0461 < 0.0)
[S10] ⇄ pheromone p=0.055 → S6@127.0.0.1:51907
[S2] START round=26 head_norm_before_train=1.753865 (no previous merge yet)
[S2] round=26 local utility u=0.547512 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5322868345306535, 'psi': 0.3674775928297055}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.525281674583529, 'psi': 0.2450298816928894}
[S3] START round=26 head_norm_before_train=1.829059 (no previous merge yet)
[S3] round=26 local utility u=0.097865 metrics={'f1_val': 0.29733187134502925, 'auprc': 0.29733187134502925, 'loss_val': 3.6409974710034065, 'psi': 0.29733187134502925}-{'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 3.8385764196340806, 'psi': 0.2975373066007507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=26 head_norm_before_train=1.847957 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1416482180282495, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1271019184881959, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=26 head_norm_before_train=1.810678 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.1520848026848025, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.084054115068675, 'psi': 0.33358943696313936}
[S6] START round=26 head_norm_before_train=1.734198 (no previous merge yet)
[S6] round=26 local utility u=0.106456 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 6.033960835904798, 'psi': 0.02262340036563071}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.2032346077089455, 'psi': 0.017774699907663897}
[S7] START round=26 head_norm_before_train=1.555958 (no previous merge yet)
[S7] round=26 local utility u=0.011820 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1743967783179319, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1980364299410007, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=26 head_norm_before_train=1.863308 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9351082939718978, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8984548960499514, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.783963 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6855698651086635, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6583021807332052, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.866554 (no previous merge yet)
[S10] round=26 local utility u=0.004297 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.415525369150756, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.424120195771593, 'psi': 0.3328555502468546}
[S11] START round=26 head_norm_before_train=1.367860 cos_to_last_merge=0.9277 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.3796990161564073, 'psi': 0.33216756042589574}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.3301597439312114, 'psi': 0.33216756042589574}
[S13] START round=26 head_norm_before_train=1.496792 (no previous merge yet)
[S13] round=26 local utility u=0.014049 metrics={'f1_val': 0.24081666839171176, 'auprc': 0.24081666839171176, 'loss_val': 0.9530329975292745, 'psi': 0.24081666839171176}-{'f1_val': 0.2396552741868839, 'auprc': 0.2396552741868839, 'loss_val': 0.9706782591352731, 'psi': 0.2396552741868839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=26 head_norm_before_train=1.846210 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.60367068277663, 'psi': 0.13533083645443197}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.542279072902377, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=1.801855 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.006895 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5591453412936491, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5729362642475843, 'psi': 0.6164734888353558}
[S16] START round=26 head_norm_before_train=1.794538 (no previous merge yet)
[S16] round=26 local utility u=0.042463 metrics={'f1_val': 0.14208842350203607, 'auprc': 0.14208842350203607, 'loss_val': 3.772039293859469, 'psi': 0.14208842350203607}-{'f1_val': 0.13688771388705295, 'auprc': 0.13688771388705295, 'loss_val': 3.8101580882613715, 'psi': 0.13688771388705295}
[S17] START round=26 head_norm_before_train=1.797458 cos_to_last_merge=0.9970 (last merge round=21)
[S17] round=26 local utility u=0.029873 metrics={'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 0.9926167491344983, 'psi': 0.15237633365664405}-{'f1_val': 0.1526428293820443, 'auprc': 0.1526428293820443, 'loss_val': 1.0547610006253079, 'psi': 0.1526428293820443}
[S6] not sending this round → trigger blocked (psi=0.023)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.152)
[S16] not sending this round → trigger blocked (psi=0.142)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:51907
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:51910
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S2
[S9] cosine check vs S2: cos=-0.1275
[S9] DROPPED delta from S2 (cos=-0.1275 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1806) from S10
[S6] cosine check vs S10: cos=-0.0454
[S6] DROPPED delta from S10 (cos=-0.0454 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:51905
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.9995
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.3336 head_norm=1.826349
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.021909e-02
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.3336 head_norm=1.826045 delta_norm=0.030219
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.763380 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5604440189156197, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5322868345306535, 'psi': 0.3674775928297055}
[S3] START round=27 head_norm_before_train=1.843005 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.29757658893461364, 'auprc': 0.29757658893461364, 'loss_val': 3.778319508558315, 'psi': 0.29757658893461364}-{'f1_val': 0.29733187134502925, 'auprc': 0.29733187134502925, 'loss_val': 3.6409974710034065, 'psi': 0.29733187134502925}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.871890 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.155229856936788, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1416482180282495, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.826045 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.067409 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.01726667640919, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.1520848026848025, 'psi': 0.33358943696313936}
[S6] START round=27 head_norm_before_train=1.746691 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.365285004292371, 'psi': 0.017551963048498844}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 6.033960835904798, 'psi': 0.02262340036563071}
[S7] START round=27 head_norm_before_train=1.575332 (no previous merge yet)
[S7] round=27 local utility u=0.003607 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1671836894757917, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1743967783179319, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=27 head_norm_before_train=1.876604 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9770171459731726, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9351082939718978, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.792519 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.709948611348442, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6855698651086635, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.897375 (no previous merge yet)
[S10] round=27 local utility u=0.000525 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.414475654180726, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.415525369150756, 'psi': 0.3328555502468546}
[S11] START round=27 head_norm_before_train=1.388885 cos_to_last_merge=0.9239 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.924
[S11] round=27 local utility u=0.015949 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.3464131065401244, 'psi': 0.3320133550741517}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.3796990161564073, 'psi': 0.33216756042589574}
[S13] START round=27 head_norm_before_train=1.507298 (no previous merge yet)
[S13] round=27 local utility u=0.029454 metrics={'f1_val': 0.2427363584779235, 'auprc': 0.2427363584779235, 'loss_val': 0.9114018657743291, 'psi': 0.2427363584779235}-{'f1_val': 0.24081666839171176, 'auprc': 0.24081666839171176, 'loss_val': 0.9530329975292745, 'psi': 0.24081666839171176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=27 head_norm_before_train=1.858130 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.663476933192732, 'psi': 0.1351317597102535}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.60367068277663, 'psi': 0.13533083645443197}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=1.826241 cos_to_last_merge=0.9999 (last merge round=25)
[S15] round=27 local utility u=0.000186 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.560025858885531, 'psi': 0.6166125814646326}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5591453412936491, 'psi': 0.6164734888353558}
[S16] START round=27 head_norm_before_train=1.804417 (no previous merge yet)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.048625429553264606, 'auprc': 0.048625429553264606, 'loss_val': 4.778298675175694, 'psi': 0.048625429553264606}-{'f1_val': 0.14208842350203607, 'auprc': 0.14208842350203607, 'loss_val': 3.772039293859469, 'psi': 0.14208842350203607}
[S17] START round=27 head_norm_before_train=1.814457 cos_to_last_merge=0.9959 (last merge round=21)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 0.9998918908386583, 'psi': 0.15231723870467326}-{'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 0.9926167491344983, 'psi': 0.15237633365664405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S10] → sending delta(kind=head bytes=1809) to S6@127.0.0.1:51907
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:51905
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1809 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:51915
[S6] RECEIVED delta(kind=head bytes=1809) from S10
[S6] cosine check vs S10: cos=-0.0448
[S6] DROPPED delta from S10 (cos=-0.0448 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.9994
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=0.9994
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.3336 head_norm=1.837496
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.178379e-02
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.3336 head_norm=1.842604 delta_norm=0.031784
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.771160 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5862901035708954, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5604440189156197, 'psi': 0.3674775928297055}
[S3] START round=28 head_norm_before_train=1.857180 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 3.941365676322747, 'psi': 0.2975373066007507}-{'f1_val': 0.29757658893461364, 'auprc': 0.29757658893461364, 'loss_val': 3.778319508558315, 'psi': 0.29757658893461364}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.891865 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1673309318332905, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.155229856936788, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.842604 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.071937640077156, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.01726667640919, 'psi': 0.33358943696313936}
[S6] START round=28 head_norm_before_train=1.759081 (no previous merge yet)
[S6] round=28 local utility u=0.000203 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 6.368886771720541, 'psi': 0.01799723119520074}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.365285004292371, 'psi': 0.017551963048498844}
[S7] START round=28 head_norm_before_train=1.596369 (no previous merge yet)
[S7] round=28 local utility u=0.004558 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.158066689559703, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1671836894757917, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=28 head_norm_before_train=1.893401 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.025932106105611, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9770171459731726, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.800532 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7328731665239507, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.709948611348442, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.925895 (no previous merge yet)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.4257875574023764, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.414475654180726, 'psi': 0.3328555502468546}
[S11] START round=28 head_norm_before_train=1.407102 cos_to_last_merge=0.9209 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.921
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.428087781153045, 'psi': 0.33216756042589574}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.3464131065401244, 'psi': 0.3320133550741517}
[S13] START round=28 head_norm_before_train=1.518002 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.24144173197365384, 'auprc': 0.24144173197365384, 'loss_val': 0.9097301188880879, 'psi': 0.24144173197365384}-{'f1_val': 0.2427363584779235, 'auprc': 0.2427363584779235, 'loss_val': 0.9114018657743291, 'psi': 0.2427363584779235}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.868995 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.715640423735939, 'psi': 0.13533083645443197}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.663476933192732, 'psi': 0.1351317597102535}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.848243 cos_to_last_merge=0.9996 (last merge round=25)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.5865061266281325, 'auprc': 0.5865061266281325, 'loss_val': 0.533240272984646, 'psi': 0.5865061266281325}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.560025858885531, 'psi': 0.6166125814646326}
[S16] START round=28 head_norm_before_train=1.814080 (no previous merge yet)
[S16] round=28 local utility u=0.338129 metrics={'f1_val': 0.09048760991207035, 'auprc': 0.09048760991207035, 'loss_val': 4.47880071934757, 'psi': 0.09048760991207035}-{'f1_val': 0.048625429553264606, 'auprc': 0.048625429553264606, 'loss_val': 4.778298675175694, 'psi': 0.048625429553264606}
[S17] START round=28 head_norm_before_train=1.834350 cos_to_last_merge=0.9946 (last merge round=21)
[S17] round=28 local utility u=0.018227 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 0.9629068847249325, 'psi': 0.1522581895716224}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 0.9998918908386583, 'psi': 0.15231723870467326}
[S16] not sending this round → trigger blocked (psi=0.090)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.152)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.5865 head_norm=1.869650
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.258125e-02
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.5866 head_norm=1.853154 delta_norm=0.042581
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.780144 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6079942752163703, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5862901035708954, 'psi': 0.3674775928297055}
[S3] START round=29 head_norm_before_train=1.871200 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 3.9896127558956365, 'psi': 0.2975373066007507}-{'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 3.941365676322747, 'psi': 0.2975373066007507}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.903809 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.176629343989498, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1673309318332905, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.850800 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=29 local utility u=0.001717 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0685030771691113, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.071937640077156, 'psi': 0.33358943696313936}
[S6] START round=29 head_norm_before_train=1.771213 (no previous merge yet)
[S6] round=29 local utility u=0.168289 metrics={'f1_val': 0.027589326096788783, 'auprc': 0.027589326096788783, 'loss_val': 6.118637173776836, 'psi': 0.027589326096788783}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 6.368886771720541, 'psi': 0.01799723119520074}
[S7] START round=29 head_norm_before_train=1.617127 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.160351414914828, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.158066689559703, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=1.911152 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0765047243425638, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.025932106105611, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.808207 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7578451330473555, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7328731665239507, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.950884 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.438993989943843, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.4257875574023764, 'psi': 0.3328555502468546}
[S11] START round=29 head_norm_before_train=1.423283 cos_to_last_merge=0.9182 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.918
[S11] round=29 local utility u=0.008549 metrics={'f1_val': 0.33216810378311196, 'auprc': 0.33216810378311196, 'loss_val': 2.4109939243032423, 'psi': 0.33216810378311196}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.428087781153045, 'psi': 0.33216756042589574}
[S13] START round=29 head_norm_before_train=1.527514 (no previous merge yet)
[S13] round=29 local utility u=0.555928 metrics={'f1_val': 0.3627117308831975, 'auprc': 0.3627117308831975, 'loss_val': 0.8893034127906331, 'psi': 0.3627117308831975}-{'f1_val': 0.24144173197365384, 'auprc': 0.24144173197365384, 'loss_val': 0.9097301188880879, 'psi': 0.24144173197365384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=29 head_norm_before_train=1.879210 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.784316408531694, 'psi': 0.1351317597102535}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.715640423735939, 'psi': 0.13533083645443197}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=1.853154 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.173702 metrics={'f1_val': 0.6168904640188789, 'auprc': 0.6168904640188789, 'loss_val': 0.4592949764805898, 'psi': 0.6168904640188789}-{'f1_val': 0.5865061266281325, 'auprc': 0.5865061266281325, 'loss_val': 0.533240272984646, 'psi': 0.5865061266281325}
[S16] START round=29 head_norm_before_train=1.823919 (no previous merge yet)
[S16] round=29 local utility u=0.412886 metrics={'f1_val': 0.13442526191530177, 'auprc': 0.13442526191530177, 'loss_val': 4.048468450451115, 'psi': 0.13442526191530177}-{'f1_val': 0.09048760991207035, 'auprc': 0.09048760991207035, 'loss_val': 4.47880071934757, 'psi': 0.09048760991207035}
[S17] START round=29 head_norm_before_train=1.853810 cos_to_last_merge=0.9931 (last merge round=21)
[S17] round=29 local utility u=0.049158 metrics={'f1_val': 0.1532032510881792, 'auprc': 0.1532032510881792, 'loss_val': 0.8730959720153323, 'psi': 0.1532032510881792}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 0.9629068847249325, 'psi': 0.1522581895716224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:51905
[S16] not sending this round → trigger blocked (psi=0.134)
[S17] not sending this round → trigger blocked (psi=0.153)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.028)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:51915
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.9997
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=0.9997
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.3336 head_norm=1.858808
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.504321e-02
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.3336 head_norm=1.866858 delta_norm=0.025043
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.789498 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.630242749637755, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6079942752163703, 'psi': 0.3674775928297055}
[S3] START round=30 head_norm_before_train=1.884149 (no previous merge yet)
[S3] round=30 local utility u=0.160645 metrics={'f1_val': 0.29444745885331886, 'auprc': 0.29444745885331886, 'loss_val': 3.640513941086853, 'psi': 0.29444745885331886}-{'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 3.9896127558956365, 'psi': 0.2975373066007507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=30 head_norm_before_train=1.911977 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.190379881732047, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.176629343989498, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.866858 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.133414130770152, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0685030771691113, 'psi': 0.33358943696313936}
[S6] START round=30 head_norm_before_train=1.782732 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.0016698473282442748, 'auprc': 0.0016698473282442748, 'loss_val': 6.685517569272914, 'psi': 0.0016698473282442746}-{'f1_val': 0.027589326096788783, 'auprc': 0.027589326096788783, 'loss_val': 6.118637173776836, 'psi': 0.027589326096788783}
[S7] START round=30 head_norm_before_train=1.638279 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1706657901510442, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.160351414914828, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.926924 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1257369345732542, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0765047243425638, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.815760 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.784805577638845, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7578451330473555, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.974458 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.4530813990636227, 'psi': 0.33293527585383326}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.438993989943843, 'psi': 0.3328555502468546}
[S11] START round=30 head_norm_before_train=1.436653 cos_to_last_merge=0.9160 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.916
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.4488223455636997, 'psi': 0.3320901320901321}-{'f1_val': 0.33216810378311196, 'auprc': 0.33216810378311196, 'loss_val': 2.4109939243032423, 'psi': 0.33216810378311196}
[S13] START round=30 head_norm_before_train=1.535972 (no previous merge yet)
[S13] round=30 local utility u=0.000821 metrics={'f1_val': 0.3627117308831975, 'auprc': 0.3627117308831975, 'loss_val': 0.8876615000501831, 'psi': 0.3627117308831975}-{'f1_val': 0.3627117308831975, 'auprc': 0.3627117308831975, 'loss_val': 0.8893034127906331, 'psi': 0.3627117308831975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=30 head_norm_before_train=1.888739 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.83612625146674, 'psi': 0.1351317597102535}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.784316408531694, 'psi': 0.1351317597102535}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.875209 cos_to_last_merge=0.9999 (last merge round=28)
[S15] round=30 local utility u=0.000815 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4551648248424501, 'psi': 0.6166125814646326}-{'f1_val': 0.6168904640188789, 'auprc': 0.6168904640188789, 'loss_val': 0.4592949764805898, 'psi': 0.6168904640188789}
[S16] START round=30 head_norm_before_train=1.832599 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.07919013797044656, 'auprc': 0.07919013797044656, 'loss_val': 4.689810751641674, 'psi': 0.07919013797044656}-{'f1_val': 0.13442526191530177, 'auprc': 0.13442526191530177, 'loss_val': 4.048468450451115, 'psi': 0.13442526191530177}
[S17] START round=30 head_norm_before_train=1.869659 cos_to_last_merge=0.9916 (last merge round=21)
[S17] round=30 local utility u=0.016666 metrics={'f1_val': 0.15275055786310443, 'auprc': 0.15275055786310443, 'loss_val': 0.8356892891245661, 'psi': 0.15275055786310443}-{'f1_val': 0.1532032510881792, 'auprc': 0.1532032510881792, 'loss_val': 0.8730959720153323, 'psi': 0.1532032510881792}
[S17] not sending this round → trigger blocked (psi=0.153)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:51905
[S6] ⇄ pheromone p=0.065 → S10@127.0.0.1:51911
[S10] ⇄ pheromone p=0.019 → S6@127.0.0.1:51907
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.006 → S2@127.0.0.1:51902
[S2] ⇄ pheromone p=0.088 → S9@127.0.0.1:51910
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.9996
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.6166 head_norm=1.895464
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.745080e-02
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.6166 head_norm=1.876852 delta_norm=0.037451
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.057 → S5@127.0.0.1:51905
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.3336 head_norm=1.877137
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.720358e-02
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.3336 head_norm=1.886126 delta_norm=0.027204
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.065 → S15@127.0.0.1:51915
[S2] START round=31 head_norm_before_train=1.799422 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6505264394409878, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.630242749637755, 'psi': 0.3674775928297055}
[S3] START round=31 head_norm_before_train=1.895906 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.29741339914084636, 'auprc': 0.29741339914084636, 'loss_val': 3.88833632857428, 'psi': 0.29741339914084636}-{'f1_val': 0.29444745885331886, 'auprc': 0.29444745885331886, 'loss_val': 3.640513941086853, 'psi': 0.29444745885331886}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.922705 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2028406903075877, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.190379881732047, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.886126 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.051999 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0294165384000498, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.133414130770152, 'psi': 0.33358943696313936}
[S6] START round=31 head_norm_before_train=1.791261 (no previous merge yet)
[S6] round=31 local utility u=0.107685 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.613086037999946, 'psi': 0.017551963048498844}-{'f1_val': 0.0016698473282442748, 'auprc': 0.0016698473282442748, 'loss_val': 6.685517569272914, 'psi': 0.0016698473282442746}
[S7] START round=31 head_norm_before_train=1.655465 (no previous merge yet)
[S7] round=31 local utility u=0.004334 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1619987730816739, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1706657901510442, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=31 head_norm_before_train=1.936204 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1761725423313454, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1257369345732542, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.823197 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.806219566781539, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.784805577638845, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.995692 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.4665645392979654, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.4530813990636227, 'psi': 0.33293527585383326}
[S11] START round=31 head_norm_before_train=1.452827 cos_to_last_merge=0.9134 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.913
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.4854503691003527, 'psi': 0.33216756042589574}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.4488223455636997, 'psi': 0.3320901320901321}
[S13] START round=31 head_norm_before_train=1.544686 (no previous merge yet)
[S13] round=31 local utility u=0.012565 metrics={'f1_val': 0.3634036624310383, 'auprc': 0.3634036624310383, 'loss_val': 0.868758155798538, 'psi': 0.3634036624310383}-{'f1_val': 0.3627117308831975, 'auprc': 0.3627117308831975, 'loss_val': 0.8876615000501831, 'psi': 0.3627117308831975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=31 head_norm_before_train=1.897864 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.897446502160833, 'psi': 0.1355297641332834}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.83612625146674, 'psi': 0.1351317597102535}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=1.876852 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6151162738858119, 'auprc': 0.6151162738858119, 'loss_val': 0.5027866067267258, 'psi': 0.6151162738858119}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4551648248424501, 'psi': 0.6166125814646326}
[S16] START round=31 head_norm_before_train=1.840451 (no previous merge yet)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.04591748662178491, 'auprc': 0.04591748662178491, 'loss_val': 4.946826797982744, 'psi': 0.04591748662178491}-{'f1_val': 0.07919013797044656, 'auprc': 0.07919013797044656, 'loss_val': 4.689810751641674, 'psi': 0.07919013797044656}
[S17] START round=31 head_norm_before_train=1.882505 cos_to_last_merge=0.9903 (last merge round=21)
[S17] round=31 local utility u=0.016121 metrics={'f1_val': 0.15302589739049194, 'auprc': 0.15302589739049194, 'loss_val': 0.8059248016178164, 'psi': 0.15302589739049194}-{'f1_val': 0.15275055786310443, 'auprc': 0.15275055786310443, 'loss_val': 0.8356892891245661, 'psi': 0.15275055786310443}
[S11]  timeout peer S13
[S5]  timeout peer S11
[S8]  timeout peer S17
[S16]  timeout peer S7
[S17]  timeout peer S16
[S6] not sending this round → trigger blocked (psi=0.018)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.153)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:51915
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=0.9999
[S2] START round=32 head_norm_before_train=1.808825 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6712049074348045, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6505264394409878, 'psi': 0.3674775928297055}
[S3] START round=32 head_norm_before_train=1.906518 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.29757658893461364, 'auprc': 0.29757658893461364, 'loss_val': 3.9903990243088, 'psi': 0.29757658893461364}-{'f1_val': 0.29741339914084636, 'auprc': 0.29741339914084636, 'loss_val': 3.88833632857428, 'psi': 0.29741339914084636}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.932706 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2169336448468504, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2028406903075877, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.895623 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=32 local utility u=0.008997 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0114229155989327, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0294165384000498, 'psi': 0.33358943696313936}
[S6] START round=32 head_norm_before_train=1.797943 (no previous merge yet)
[S6] round=32 local utility u=0.062613 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.527603812226529, 'psi': 0.021967963386727688}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.613086037999946, 'psi': 0.017551963048498844}
[S7] START round=32 head_norm_before_train=1.668231 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1735282981596722, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1619987730816739, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.948171 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2272337126822321, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1761725423313454, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.830222 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.824608878578434, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.806219566781539, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=2.015066 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.484223239111339, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.4665645392979654, 'psi': 0.33293527585383326}
[S11] START round=32 head_norm_before_train=1.469834 cos_to_last_merge=0.9108 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.911
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.5057644235941052, 'psi': 0.3320901320901321}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.4854503691003527, 'psi': 0.33216756042589574}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.553763 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.36201902982542, 'auprc': 0.36201902982542, 'loss_val': 0.8565693881442097, 'psi': 0.36201902982542}-{'f1_val': 0.3634036624310383, 'auprc': 0.3634036624310383, 'loss_val': 0.868758155798538, 'psi': 0.3634036624310383}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.906575 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.9602632311719175, 'psi': 0.13572854291417166}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.897446502160833, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.895404 cos_to_last_merge=0.9999 (last merge round=30)
[S15] round=32 local utility u=0.017634 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4809859975136211, 'psi': 0.6166125814646326}-{'f1_val': 0.6151162738858119, 'auprc': 0.6151162738858119, 'loss_val': 0.5027866067267258, 'psi': 0.6151162738858119}
[S16] START round=32 head_norm_before_train=1.848469 (no previous merge yet)
[S16] round=32 local utility u=0.310238 metrics={'f1_val': 0.08657799274486094, 'auprc': 0.08657799274486094, 'loss_val': 4.6922954834335835, 'psi': 0.08657799274486094}-{'f1_val': 0.04591748662178491, 'auprc': 0.04591748662178491, 'loss_val': 4.946826797982744, 'psi': 0.04591748662178491}
[S16] not sending this round → trigger blocked (psi=0.087)
[S17] START round=32 head_norm_before_train=1.894536 cos_to_last_merge=0.9892 (last merge round=21)
[S17] round=32 local utility u=0.171501 metrics={'f1_val': 0.18729390495511347, 'auprc': 0.18729390495511347, 'loss_val': 0.7713350094486481, 'psi': 0.18729390495511347}-{'f1_val': 0.15302589739049194, 'auprc': 0.15302589739049194, 'loss_val': 0.8059248016178164, 'psi': 0.15302589739049194}
[S17] not sending this round → trigger blocked (psi=0.187)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S15] → sending delta(kind=head bytes=1809) to S5@127.0.0.1:51905
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:51915
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1809 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1809) from S15
[S5] cosine check vs S15: cos=0.9997
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=0.9997
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.3336 head_norm=1.906413
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.318475e-02
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.3336 head_norm=1.909963 delta_norm=0.023185
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.6166 head_norm=1.913788
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.095274e-02
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.6166 head_norm=1.907290 delta_norm=0.020953
[S15] aggregate: ACCEPT kept=['S5', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.817832 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.2444693015162814, 'auprc': 0.2444693015162814, 'loss_val': 2.6856061662882267, 'psi': 0.24446930151628143}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6712049074348045, 'psi': 0.3674775928297055}
[S3] START round=33 head_norm_before_train=1.916966 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 4.097975543478666, 'psi': 0.2975373066007507}-{'f1_val': 0.29757658893461364, 'auprc': 0.29757658893461364, 'loss_val': 3.9903990243088, 'psi': 0.29757658893461364}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.942381 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2330870888943244, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2169336448468504, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.909963 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.025875801235662, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0114229155989327, 'psi': 0.33358943696313936}
[S6] START round=33 head_norm_before_train=1.806001 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.7714693142454365, 'psi': 0.017551963048498844}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.527603812226529, 'psi': 0.021967963386727688}
[S7] START round=33 head_norm_before_train=1.679041 (no previous merge yet)
[S7] round=33 local utility u=0.000930 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1716684197839207, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1735282981596722, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=33 head_norm_before_train=1.957867 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2813034211485774, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2272337126822321, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.836970 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8412740881172196, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.824608878578434, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=2.034007 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.5053937092794047, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.484223239111339, 'psi': 0.33293527585383326}
[S11] START round=33 head_norm_before_train=1.485723 cos_to_last_merge=0.9084 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.908
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.5718810907545646, 'psi': 0.33216756042589574}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.5057644235941052, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.561776 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8628774554689708, 'psi': 0.3599362944611573}-{'f1_val': 0.36201902982542, 'auprc': 0.36201902982542, 'loss_val': 0.8565693881442097, 'psi': 0.36201902982542}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.914756 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.0137830301503685, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.9602632311719175, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.907290 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.041745 metrics={'f1_val': 0.6168904640188789, 'auprc': 0.6168904640188789, 'loss_val': 0.3999970108220795, 'psi': 0.6168904640188789}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4809859975136211, 'psi': 0.6166125814646326}
[S16] START round=33 head_norm_before_train=1.856553 (no previous merge yet)
[S16] round=33 local utility u=0.033850 metrics={'f1_val': 0.09009441510641703, 'auprc': 0.09009441510641703, 'loss_val': 4.656242888326725, 'psi': 0.09009441510641703}-{'f1_val': 0.08657799274486094, 'auprc': 0.08657799274486094, 'loss_val': 4.6922954834335835, 'psi': 0.08657799274486094}
[S16] not sending this round → trigger blocked (psi=0.090)
[S17] START round=33 head_norm_before_train=1.906193 cos_to_last_merge=0.9881 (last merge round=21)
[S17] round=33 local utility u=0.097602 metrics={'f1_val': 0.21059061719021863, 'auprc': 0.21059061719021863, 'loss_val': 0.7858015245348708, 'psi': 0.2105906171902186}-{'f1_val': 0.18729390495511347, 'auprc': 0.18729390495511347, 'loss_val': 0.7713350094486481, 'psi': 0.18729390495511347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:51905
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.9999
[S2] START round=34 head_norm_before_train=1.825243 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.24277171567720857, 'auprc': 0.24277171567720857, 'loss_val': 2.699100298300645, 'psi': 0.24277171567720857}-{'f1_val': 0.2444693015162814, 'auprc': 0.2444693015162814, 'loss_val': 2.6856061662882267, 'psi': 0.24446930151628143}
[S3] START round=34 head_norm_before_train=1.927001 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 4.14328291290318, 'psi': 0.2975373066007507}-{'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 4.097975543478666, 'psi': 0.2975373066007507}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.949371 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2449894726352182, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2330870888943244, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.922806 cos_to_last_merge=0.9999 (last merge round=32)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.082359673450203, 'psi': 0.33308623671855697}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.025875801235662, 'psi': 0.33358943696313936}
[S6] START round=34 head_norm_before_train=1.814012 (no previous merge yet)
[S6] round=34 local utility u=0.074715 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.6617841922275, 'psi': 0.021967963386727688}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.7714693142454365, 'psi': 0.017551963048498844}
[S7] START round=34 head_norm_before_train=1.688038 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.182818162112281, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1716684197839207, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.967894 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3282181911374469, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2813034211485774, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.843433 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8608213124201334, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8412740881172196, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=2.051222 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.526555870055221, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.5053937092794047, 'psi': 0.33293527585383326}
[S11] START round=34 head_norm_before_train=1.502006 cos_to_last_merge=0.9060 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.906
[S11] round=34 local utility u=0.034312 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.501868949679168, 'psi': 0.3320133550741517}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.5718810907545646, 'psi': 0.33216756042589574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=34 head_norm_before_train=1.567571 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8642388585960417, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8628774554689708, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.922495 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.070474978443916, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.0137830301503685, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.925880 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4478286595234631, 'psi': 0.6166125814646326}-{'f1_val': 0.6168904640188789, 'auprc': 0.6168904640188789, 'loss_val': 0.3999970108220795, 'psi': 0.6168904640188789}
[S16] START round=34 head_norm_before_train=1.864433 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.03144320791379615, 'auprc': 0.03144320791379615, 'loss_val': 5.2436903911830965, 'psi': 0.03144320791379615}-{'f1_val': 0.09009441510641703, 'auprc': 0.09009441510641703, 'loss_val': 4.656242888326725, 'psi': 0.09009441510641703}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.919184 cos_to_last_merge=0.9872 (last merge round=21)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.15685662499676947, 'auprc': 0.15685662499676947, 'loss_val': 0.8221501757093437, 'psi': 0.15685662499676947}-{'f1_val': 0.21059061719021863, 'auprc': 0.21059061719021863, 'loss_val': 0.7858015245348708, 'psi': 0.2105906171902186}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.3331 head_norm=1.937167
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.704332e-02
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.3331 head_norm=1.931342 delta_norm=0.027043
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.832423 (no previous merge yet)
[S2] round=35 local utility u=0.549075 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7233026889362058, 'psi': 0.3674775928297055}-{'f1_val': 0.24277171567720857, 'auprc': 0.24277171567720857, 'loss_val': 2.699100298300645, 'psi': 0.24277171567720857}
[S3] START round=35 head_norm_before_train=1.936547 (no previous merge yet)
[S3] round=35 local utility u=0.027496 metrics={'f1_val': 0.29749497165843847, 'auprc': 0.29749497165843847, 'loss_val': 4.087910135906343, 'psi': 0.29749497165843847}-{'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 4.14328291290318, 'psi': 0.2975373066007507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=35 head_norm_before_train=1.955297 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.251110925675147, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2449894726352182, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.931342 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.078986 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9243876863068299, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.082359673450203, 'psi': 0.33308623671855697}
[S6] START round=35 head_norm_before_train=1.822421 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.834405569585471, 'psi': 0.017551963048498844}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.6617841922275, 'psi': 0.021967963386727688}
[S7] START round=35 head_norm_before_train=1.699135 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1874602663085547, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.182818162112281, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.978062 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3699362086448637, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3282181911374469, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.849966 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.878936840348911, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8608213124201334, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=2.067029 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.549375493674572, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.526555870055221, 'psi': 0.33293527585383326}
[S11] START round=35 head_norm_before_train=1.518260 cos_to_last_merge=0.9035 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.904
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.6143316016565397, 'psi': 0.3320901320901321}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.501868949679168, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.573429 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8757109190669171, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8642388585960417, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.929868 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.1094875665657735, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.070474978443916, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.945224 cos_to_last_merge=0.9998 (last merge round=32)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4825785330210868, 'psi': 0.6164734888353558}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.4478286595234631, 'psi': 0.6166125814646326}
[S16] START round=35 head_norm_before_train=1.871602 (no previous merge yet)
[S16] round=35 local utility u=0.626514 metrics={'f1_val': 0.09156895589056392, 'auprc': 0.09156895589056392, 'loss_val': 4.531794439778764, 'psi': 0.09156895589056392}-{'f1_val': 0.03144320791379615, 'auprc': 0.03144320791379615, 'loss_val': 5.2436903911830965, 'psi': 0.03144320791379615}
[S16] not sending this round → trigger blocked (psi=0.092)
[S17] START round=35 head_norm_before_train=1.931363 cos_to_last_merge=0.9864 (last merge round=21)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.15327147624490592, 'auprc': 0.15327147624490592, 'loss_val': 0.9191378208265708, 'psi': 0.15327147624490592}-{'f1_val': 0.15685662499676947, 'auprc': 0.15685662499676947, 'loss_val': 0.8221501757093437, 'psi': 0.15685662499676947}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:51910
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:51915
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.049 → S10@127.0.0.1:51911
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] ⇄ pheromone p=0.002 → S2@127.0.0.1:51902
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] ⇄ pheromone p=0.026 → S5@127.0.0.1:51905
[S10] ⇄ pheromone p=0.006 → S6@127.0.0.1:51907
[S9] RECEIVED delta(kind=head bytes=1799) from S2
[S9] cosine check vs S2: cos=-0.1250
[S9] DROPPED delta from S2 (cos=-0.1250 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=0.9995
[S5] ⇄ pheromone p=0.042 → S15@127.0.0.1:51915
[S2] ⇄ pheromone p=0.139 → S9@127.0.0.1:51910
[S2] START round=36 head_norm_before_train=1.839032 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.736338831623576, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7233026889362058, 'psi': 0.3674775928297055}
[S3] START round=36 head_norm_before_train=1.945544 (no previous merge yet)
[S3] round=36 local utility u=0.005704 metrics={'f1_val': 0.29741339914084636, 'auprc': 0.29741339914084636, 'loss_val': 4.075768090700591, 'psi': 0.29741339914084636}-{'f1_val': 0.29749497165843847, 'auprc': 0.29749497165843847, 'loss_val': 4.087910135906343, 'psi': 0.29749497165843847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=36 head_norm_before_train=1.959365 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2609367144183927, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.251110925675147, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.944360 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=36 local utility u=0.108758 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7068718120267132, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9243876863068299, 'psi': 0.33308623671855697}
[S6] START round=36 head_norm_before_train=1.830424 (no previous merge yet)
[S6] round=36 local utility u=0.052869 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.764469773432662, 'psi': 0.02153000458085204}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.834405569585471, 'psi': 0.017551963048498844}
[S7] START round=36 head_norm_before_train=1.711131 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1897494818971666, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1874602663085547, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.991532 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.405720119418913, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3699362086448637, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.856175 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8968093869810683, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.878936840348911, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=2.081378 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.5662484388883096, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.549375493674572, 'psi': 0.33293527585383326}
[S11] START round=36 head_norm_before_train=1.533892 cos_to_last_merge=0.9012 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.614695434589967, 'psi': 0.3320133550741517}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.6143316016565397, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.582839 (no previous merge yet)
[S13] round=36 local utility u=0.016626 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8424581490953521, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8757109190669171, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=36 head_norm_before_train=1.937169 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.151447166781107, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.1094875665657735, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.964233 cos_to_last_merge=0.9996 (last merge round=32)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5056772933100546, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4825785330210868, 'psi': 0.6164734888353558}
[S16] START round=36 head_norm_before_train=1.877814 (no previous merge yet)
[S16] round=36 local utility u=0.411547 metrics={'f1_val': 0.13312624805857556, 'auprc': 0.13312624805857556, 'loss_val': 4.082716579900426, 'psi': 0.13312624805857556}-{'f1_val': 0.09156895589056392, 'auprc': 0.09156895589056392, 'loss_val': 4.531794439778764, 'psi': 0.09156895589056392}
[S16] not sending this round → trigger blocked (psi=0.133)
[S17] START round=36 head_norm_before_train=1.944817 cos_to_last_merge=0.9854 (last merge round=21)
[S17] round=36 local utility u=0.675860 metrics={'f1_val': 0.3082078012321158, 'auprc': 0.3082078012321158, 'loss_val': 0.9618451997601996, 'psi': 0.3082078012321158}-{'f1_val': 0.15327147624490592, 'auprc': 0.15327147624490592, 'loss_val': 0.9191378208265708, 'psi': 0.15327147624490592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:51915
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.6165 head_norm=1.982208
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.208600e-02
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.6165 head_norm=1.962924 delta_norm=0.042086
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9997
[S2] START round=37 head_norm_before_train=1.845928 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7447181192041943, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.736338831623576, 'psi': 0.3674775928297055}
[S3] START round=37 head_norm_before_train=1.954215 (no previous merge yet)
[S3] round=37 local utility u=0.047887 metrics={'f1_val': 0.2964581626149504, 'auprc': 0.2964581626149504, 'loss_val': 3.9713965742078043, 'psi': 0.2964581626149504}-{'f1_val': 0.29741339914084636, 'auprc': 0.29741339914084636, 'loss_val': 4.075768090700591, 'psi': 0.29741339914084636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=37 head_norm_before_train=1.967348 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2775017972391967, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2609367144183927, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.958331 cos_to_last_merge=0.9998 (last merge round=34)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7949121780043882, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7068718120267132, 'psi': 0.33308623671855697}
[S6] START round=37 head_norm_before_train=1.839042 (no previous merge yet)
[S6] round=37 local utility u=0.150841 metrics={'f1_val': 0.029927992799279927, 'auprc': 0.029927992799279927, 'loss_val': 6.538370135073718, 'psi': 0.029927992799279927}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.764469773432662, 'psi': 0.02153000458085204}
[S7] START round=37 head_norm_before_train=1.723966 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1988088756770554, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1897494818971666, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=2.006593 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.44005377925497, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.405720119418913, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.862228 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.915824057572965, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8968093869810683, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=2.094884 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.581662304272115, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.5662484388883096, 'psi': 0.33293527585383326}
[S11] START round=37 head_norm_before_train=1.549900 cos_to_last_merge=0.8988 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.899
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.6829124273533105, 'psi': 0.33216756042589574}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.614695434589967, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.591636 (no previous merge yet)
[S13] round=37 local utility u=0.023821 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.7948158941075275, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8424581490953521, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=37 head_norm_before_train=1.944011 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.194137282881726, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.151447166781107, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.962924 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.020348 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.46498201397036293, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5056772933100546, 'psi': 0.6164734888353558}
[S16] START round=37 head_norm_before_train=1.883545 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.06202723146747352, 'auprc': 0.06202723146747352, 'loss_val': 4.86151637665181, 'psi': 0.06202723146747352}-{'f1_val': 0.13312624805857556, 'auprc': 0.13312624805857556, 'loss_val': 4.082716579900426, 'psi': 0.13312624805857556}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.957003 cos_to_last_merge=0.9845 (last merge round=21)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.19973253037041397, 'auprc': 0.19973253037041397, 'loss_val': 0.8845461310257956, 'psi': 0.19973253037041397}-{'f1_val': 0.3082078012321158, 'auprc': 0.3082078012321158, 'loss_val': 0.9618451997601996, 'psi': 0.3082078012321158}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:51905
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.030)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.9994
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.6165 head_norm=1.979324
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.217300e-02
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.6165 head_norm=1.968593 delta_norm=0.032173
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.852794 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.761212020620251, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7447181192041943, 'psi': 0.3674775928297055}
[S3] START round=38 head_norm_before_train=1.962538 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.29749497165843847, 'auprc': 0.29749497165843847, 'loss_val': 4.159267587474801, 'psi': 0.29749497165843847}-{'f1_val': 0.2964581626149504, 'auprc': 0.2964581626149504, 'loss_val': 3.9713965742078043, 'psi': 0.2964581626149504}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.976687 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2911369769504142, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2775017972391967, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.967110 cos_to_last_merge=0.9997 (last merge round=34)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9309599864094544, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.7949121780043882, 'psi': 0.33308623671855697}
[S6] START round=38 head_norm_before_train=1.847476 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.00417646408435, 'psi': 0.017551963048498844}-{'f1_val': 0.029927992799279927, 'auprc': 0.029927992799279927, 'loss_val': 6.538370135073718, 'psi': 0.029927992799279927}
[S7] START round=38 head_norm_before_train=1.736287 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2287815544467133, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1988088756770554, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=2.018062 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4760491920367496, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.44005377925497, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.868260 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.933543941467592, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.915824057572965, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=2.107853 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.60131940063561, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.581662304272115, 'psi': 0.33293527585383326}
[S11] START round=38 head_norm_before_train=1.567128 cos_to_last_merge=0.8962 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.896
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.687937212164231, 'psi': 0.3320133550741517}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.6829124273533105, 'psi': 0.33216756042589574}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.603483 (no previous merge yet)
[S13] round=38 local utility u=0.019529 metrics={'f1_val': 0.3627117308831975, 'auprc': 0.3627117308831975, 'loss_val': 0.7807369207036586, 'psi': 0.3627117308831975}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.7948158941075275, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=38 head_norm_before_train=1.950539 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.227717625513667, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.194137282881726, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.968593 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.586645320305451, 'auprc': 0.586645320305451, 'loss_val': 0.5315894275019811, 'psi': 0.586645320305451}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.46498201397036293, 'psi': 0.6164734888353558}
[S16] START round=38 head_norm_before_train=1.889844 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.015579710144927537, 'auprc': 0.015579710144927537, 'loss_val': 5.410293321852464, 'psi': 0.015579710144927537}-{'f1_val': 0.06202723146747352, 'auprc': 0.06202723146747352, 'loss_val': 4.86151637665181, 'psi': 0.06202723146747352}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.967202 cos_to_last_merge=0.9838 (last merge round=21)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.20934646771658083, 'auprc': 0.20934646771658083, 'loss_val': 0.9718994176522437, 'psi': 0.20934646771658083}-{'f1_val': 0.19973253037041397, 'auprc': 0.19973253037041397, 'loss_val': 0.8845461310257956, 'psi': 0.19973253037041397}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.3331 head_norm=1.976492
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.881500e-02
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.3331 head_norm=1.977528 delta_norm=0.038815
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.859652 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7881240850480915, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.761212020620251, 'psi': 0.3674775928297055}
[S3] START round=39 head_norm_before_train=1.970662 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 4.335221522609105, 'psi': 0.2975373066007507}-{'f1_val': 0.29749497165843847, 'auprc': 0.29749497165843847, 'loss_val': 4.159267587474801, 'psi': 0.29749497165843847}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.298 u=0.0000 p_local=0.0164 f1=0.298 auprc=0.298 bytes=16192
[S4] START round=39 head_norm_before_train=1.986869 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3056840230028612, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2911369769504142, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0018 f1=0.357 auprc=0.357 bytes=19794
[S5] START round=39 head_norm_before_train=1.977528 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.0314693324122084, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9309599864094544, 'psi': 0.33308623671855697}
[S6] START round=39 head_norm_before_train=1.854959 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.039925302236829, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.00417646408435, 'psi': 0.017551963048498844}
[S7] START round=39 head_norm_before_train=1.743973 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2545329659843263, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2287815544467133, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.360 u=0.0000 p_local=0.0099 f1=0.360 auprc=0.360 bytes=16179
[S8] START round=39 head_norm_before_train=2.029611 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5162922851889844, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4760491920367496, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0041 f1=0.359 auprc=0.359 bytes=19828
[S9] START round=39 head_norm_before_train=1.874081 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9473641969154256, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.933543941467592, 'psi': 0.36867172340800847}
[S10] START round=39 head_norm_before_train=2.119591 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.6209669352108165, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.60131940063561, 'psi': 0.33293527585383326}
[S11] START round=39 head_norm_before_train=1.583916 cos_to_last_merge=0.8938 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.894
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.7134746378699295, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.687937212164231, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0069 f1=0.332 auprc=0.332 bytes=14387
[S13] START round=39 head_norm_before_train=1.615367 (no previous merge yet)
[S13] round=39 local utility u=0.515514 metrics={'f1_val': 0.4721428986614409, 'auprc': 0.4721428986614409, 'loss_val': 0.734590032996202, 'psi': 0.4721428986614409}-{'f1_val': 0.3627117308831975, 'auprc': 0.3627117308831975, 'loss_val': 0.7807369207036586, 'psi': 0.3627117308831975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S13] r=40 psi=0.472 u=0.5155 p_local=0.1259 f1=0.472 auprc=0.472 bytes=32382
[S14] START round=39 head_norm_before_train=1.957097 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.266970700617922, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.227717625513667, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0010 f1=0.136 auprc=0.136 bytes=0
[S15] START round=39 head_norm_before_train=1.984396 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=39 local utility u=0.011572 metrics={'f1_val': 0.586780486978343, 'auprc': 0.586780486978343, 'loss_val': 0.509662023665043, 'psi': 0.586780486978343}-{'f1_val': 0.586645320305451, 'auprc': 0.586645320305451, 'loss_val': 0.5315894275019811, 'psi': 0.586645320305451}
[S16] START round=39 head_norm_before_train=1.895862 (no previous merge yet)
[S16] round=39 local utility u=1.000000 metrics={'f1_val': 0.1626493397610564, 'auprc': 0.1626493397610564, 'loss_val': 3.5351722094471856, 'psi': 0.1626493397610564}-{'f1_val': 0.015579710144927537, 'auprc': 0.015579710144927537, 'loss_val': 5.410293321852464, 'psi': 0.015579710144927537}
[S16] not sending this round → trigger blocked (psi=0.163)
[S16] r=40 psi=0.163 u=1.0000 p_local=0.3312 f1=0.163 auprc=0.163 bytes=0
[S17] START round=39 head_norm_before_train=1.975515 cos_to_last_merge=0.9832 (last merge round=21)
[S17] round=39 local utility u=0.036130 metrics={'f1_val': 0.20572715725923546, 'auprc': 0.20572715725923546, 'loss_val': 0.8670659083382101, 'psi': 0.20572715725923546}-{'f1_val': 0.20934646771658083, 'auprc': 0.20934646771658083, 'loss_val': 0.9718994176522437, 'psi': 0.20934646771658083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S17] r=40 psi=0.206 u=0.0361 p_local=0.0955 f1=0.206 auprc=0.206 bytes=5399
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.333 u=0.0000 p_local=0.0025 f1=0.333 auprc=0.333 bytes=25241
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] r=40 psi=0.333 u=0.0000 p_local=0.0285 f1=0.333 auprc=0.333 bytes=25208
[S2] r=40 psi=0.367 u=0.0000 p_local=0.0568 f1=0.367 auprc=0.367 bytes=10795
[S6] r=40 psi=0.018 u=0.0000 p_local=0.0446 f1=0.018 auprc=0.018 bytes=0
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0009 f1=0.369 auprc=0.369 bytes=3600
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.9998
[S15] r=40 psi=0.587 u=0.0116 p_local=0.0155 f1=0.587 auprc=0.587 bytes=36013
[S2] START round=40 head_norm_before_train=1.865885 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.2055606198723792, 'auprc': 0.2055606198723792, 'loss_val': 3.3512054796866986, 'psi': 0.2055606198723792}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7881240850480915, 'psi': 0.3674775928297055}
[S3] START round=40 head_norm_before_train=1.978445 (no previous merge yet)
[S3] round=40 local utility u=0.015097 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 4.306851918587365, 'psi': 0.29773995791014735}-{'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 4.335221522609105, 'psi': 0.2975373066007507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=40 head_norm_before_train=1.994908 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3171012411676775, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3056840230028612, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.988257 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=40 local utility u=0.007240 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.016989492876686, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.0314693324122084, 'psi': 0.33308623671855697}
[S6] START round=40 head_norm_before_train=1.862545 (no previous merge yet)
[S6] round=40 local utility u=0.158429 metrics={'f1_val': 0.023928896991795807, 'auprc': 0.023928896991795807, 'loss_val': 6.780460585131918, 'psi': 0.023928896991795807}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.039925302236829, 'psi': 0.017551963048498844}
[S7] START round=40 head_norm_before_train=1.749987 (no previous merge yet)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2717594989502206, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2545329659843263, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=2.036914 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5545532950698282, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5162922851889844, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.879558 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.959845341978598, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9473641969154256, 'psi': 0.36867172340800847}
[S10] START round=40 head_norm_before_train=2.130924 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.6402817820244464, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.6209669352108165, 'psi': 0.33293527585383326}
[S11] START round=40 head_norm_before_train=1.600751 cos_to_last_merge=0.8915 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.891
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.790221301326826, 'psi': 0.33216756042589574}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.7134746378699295, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.628167 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.27146019783751424, 'auprc': 0.27146019783751424, 'loss_val': 0.7517922453293395, 'psi': 0.27146019783751424}-{'f1_val': 0.4721428986614409, 'auprc': 0.4721428986614409, 'loss_val': 0.734590032996202, 'psi': 0.4721428986614409}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.963424 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.313429529739936, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.266970700617922, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=2.000548 cos_to_last_merge=0.9999 (last merge round=37)
[S15] round=40 local utility u=0.144955 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.48824026715835445, 'psi': 0.6166125814646326}-{'f1_val': 0.586780486978343, 'auprc': 0.586780486978343, 'loss_val': 0.509662023665043, 'psi': 0.586780486978343}
[S16] START round=40 head_norm_before_train=1.900990 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.14013575651412305, 'auprc': 0.14013575651412305, 'loss_val': 4.186741756352959, 'psi': 0.14013575651412305}-{'f1_val': 0.1626493397610564, 'auprc': 0.1626493397610564, 'loss_val': 3.5351722094471856, 'psi': 0.1626493397610564}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.983307 cos_to_last_merge=0.9826 (last merge round=21)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.18908447213751794, 'auprc': 0.18908447213751794, 'loss_val': 0.9454891094788983, 'psi': 0.18908447213751794}-{'f1_val': 0.20572715725923546, 'auprc': 0.20572715725923546, 'loss_val': 0.8670659083382101, 'psi': 0.20572715725923546}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.024)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:51905
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:51915
[S10] ⇄ pheromone p=0.002 → S6@127.0.0.1:51907
[S9] ⇄ pheromone p=0.001 → S2@127.0.0.1:51902
[S2] ⇄ pheromone p=0.045 → S9@127.0.0.1:51910
[S15] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] ⇄ pheromone p=0.067 → S10@127.0.0.1:51911
[S5] RECEIVED delta(kind=head bytes=1793) from S15
[S5] cosine check vs S15: cos=0.9996
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9996
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.6166 head_norm=2.017009
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.031015e-02
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.6166 head_norm=2.007478 delta_norm=0.030310
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.041 → S5@127.0.0.1:51905
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.3331 head_norm=1.998362
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.639078e-02
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.3331 head_norm=2.003396 delta_norm=0.026391
[S5] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.024 → S15@127.0.0.1:51915
[S2] START round=41 head_norm_before_train=1.871540 (no previous merge yet)
[S2] round=41 local utility u=0.446094 metrics={'f1_val': 0.24487554904831624, 'auprc': 0.24487554904831624, 'loss_val': 2.8128519112031816, 'psi': 0.2448755490483162}-{'f1_val': 0.2055606198723792, 'auprc': 0.2055606198723792, 'loss_val': 3.3512054796866986, 'psi': 0.2055606198723792}
[S3] START round=41 head_norm_before_train=1.985778 (no previous merge yet)
[S3] round=41 local utility u=0.192282 metrics={'f1_val': 0.29262155118181005, 'auprc': 0.29262155118181005, 'loss_val': 3.876221843764469, 'psi': 0.29262155118181005}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 4.306851918587365, 'psi': 0.29773995791014735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=41 head_norm_before_train=2.003491 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3230797734130713, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3171012411676775, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=2.003396 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=0.034458 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9526015038105755, 'psi': 0.33358943696313936}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.016989492876686, 'psi': 0.33308623671855697}
[S6] START round=41 head_norm_before_train=1.869959 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 6.906133256110395, 'psi': 0.02262340036563071}-{'f1_val': 0.023928896991795807, 'auprc': 0.023928896991795807, 'loss_val': 6.780460585131918, 'psi': 0.023928896991795807}
[S7] START round=41 head_norm_before_train=1.760605 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2746516298883608, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2717594989502206, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=2.042249 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5889404261857845, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5545532950698282, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.884895 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9742625623329633, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.959845341978598, 'psi': 0.36867172340800847}
[S10] START round=41 head_norm_before_train=2.142431 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.657651914254991, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.6402817820244464, 'psi': 0.33293527585383326}
[S11] START round=41 head_norm_before_train=1.617350 cos_to_last_merge=0.8893 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.889
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.82537389508586, 'psi': 0.3320901320901321}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.790221301326826, 'psi': 0.33216756042589574}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.637675 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.24050586125656948, 'auprc': 0.24050586125656948, 'loss_val': 0.755187719306848, 'psi': 0.24050586125656948}-{'f1_val': 0.27146019783751424, 'auprc': 0.27146019783751424, 'loss_val': 0.7517922453293395, 'psi': 0.27146019783751424}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.969436 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.354964065631368, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.313429529739936, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.007478 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6055939982614819, 'auprc': 0.6055939982614819, 'loss_val': 0.4624199982861515, 'psi': 0.6055939982614819}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.48824026715835445, 'psi': 0.6166125814646326}
[S16] START round=41 head_norm_before_train=1.907380 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.12810750279955208, 'auprc': 0.12810750279955208, 'loss_val': 4.458203112445367, 'psi': 0.12810750279955208}-{'f1_val': 0.14013575651412305, 'auprc': 0.14013575651412305, 'loss_val': 4.186741756352959, 'psi': 0.14013575651412305}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.990881 cos_to_last_merge=0.9821 (last merge round=21)
[S17] round=41 local utility u=0.097938 metrics={'f1_val': 0.2058330424962131, 'auprc': 0.2058330424962131, 'loss_val': 0.9003500164947847, 'psi': 0.2058330424962131}-{'f1_val': 0.18908447213751794, 'auprc': 0.18908447213751794, 'loss_val': 0.9454891094788983, 'psi': 0.18908447213751794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] → sending delta(kind=head bytes=1808) to S9@127.0.0.1:51910
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9999
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1808 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1808) from S2
[S9] cosine check vs S2: cos=-0.1233
[S9] DROPPED delta from S2 (cos=-0.1233 < 0.0)
[S2] START round=42 head_norm_before_train=1.876496 (no previous merge yet)
[S2] round=42 local utility u=0.547459 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.821351569683701, 'psi': 0.3674775928297055}-{'f1_val': 0.24487554904831624, 'auprc': 0.24487554904831624, 'loss_val': 2.8128519112031816, 'psi': 0.2448755490483162}
[S3] START round=42 head_norm_before_train=1.992989 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 4.3074510934163825, 'psi': 0.29773995791014735}-{'f1_val': 0.29262155118181005, 'auprc': 0.29262155118181005, 'loss_val': 3.876221843764469, 'psi': 0.29262155118181005}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=2.008361 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.324039654407247, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3230797734130713, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=2.010576 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=42 local utility u=0.126128 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.6958169127677387, 'psi': 0.33308623671855697}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9526015038105755, 'psi': 0.33358943696313936}
[S6] START round=42 head_norm_before_train=1.877349 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.181607825911784, 'psi': 0.017551963048498844}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 6.906133256110395, 'psi': 0.02262340036563071}
[S7] START round=42 head_norm_before_train=1.771556 (no previous merge yet)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2789653795416367, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2746516298883608, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=2.048086 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6193007038731393, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5889404261857845, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.890186 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.99042509935827, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9742625623329633, 'psi': 0.36867172340800847}
[S10] START round=42 head_norm_before_train=2.153238 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.6765176124543384, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.657651914254991, 'psi': 0.33293527585383326}
[S11] START round=42 head_norm_before_train=1.633094 cos_to_last_merge=0.8872 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.887
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 2.842873047470484, 'psi': 0.3320907114010562}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.82537389508586, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.646070 (no previous merge yet)
[S13] round=42 local utility u=0.494539 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.840982798988599, 'psi': 0.3599362944611573}-{'f1_val': 0.24050586125656948, 'auprc': 0.24050586125656948, 'loss_val': 0.755187719306848, 'psi': 0.24050586125656948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=42 head_norm_before_train=1.975244 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.388583243914297, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.354964065631368, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.022923 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=42 local utility u=0.024510 metrics={'f1_val': 0.6100787309702305, 'auprc': 0.6100787309702305, 'loss_val': 0.4537621238149523, 'psi': 0.6100787309702305}-{'f1_val': 0.6055939982614819, 'auprc': 0.6055939982614819, 'loss_val': 0.4624199982861515, 'psi': 0.6055939982614819}
[S16] START round=42 head_norm_before_train=1.914356 (no previous merge yet)
[S16] round=42 local utility u=0.157646 metrics={'f1_val': 0.14002044094028324, 'auprc': 0.14002044094028324, 'loss_val': 4.250128387851639, 'psi': 0.14002044094028324}-{'f1_val': 0.12810750279955208, 'auprc': 0.12810750279955208, 'loss_val': 4.458203112445367, 'psi': 0.12810750279955208}
[S16] not sending this round → trigger blocked (psi=0.140)
[S17] START round=42 head_norm_before_train=2.000863 cos_to_last_merge=0.9813 (last merge round=21)
[S17] round=42 local utility u=0.376838 metrics={'f1_val': 0.31203211275902226, 'auprc': 0.31203211275902226, 'loss_val': 1.1024648089483937, 'psi': 0.31203211275902226}-{'f1_val': 0.2058330424962131, 'auprc': 0.2058330424962131, 'loss_val': 0.9003500164947847, 'psi': 0.2058330424962131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:51915
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S2
[S9] cosine check vs S2: cos=-0.1230
[S9] DROPPED delta from S2 (cos=-0.1230 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=0.9998
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.9998
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.6101 head_norm=2.038396
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.227628e-02
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.6116 head_norm=2.025528 delta_norm=0.022276
[S15] aggregate: ACCEPT kept=['S5', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.881795 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8218809413840895, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.821351569683701, 'psi': 0.3674775928297055}
[S3] START round=43 head_norm_before_train=1.999666 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.29743589743589743, 'auprc': 0.29743589743589743, 'loss_val': 4.497314317135421, 'psi': 0.29743589743589743}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 4.3074510934163825, 'psi': 0.29773995791014735}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.015583 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3350839769382299, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.324039654407247, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=2.015077 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9327436610161015, 'psi': 0.33358943696313936}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.6958169127677387, 'psi': 0.33308623671855697}
[S6] START round=43 head_norm_before_train=1.884269 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.20622326324216, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.181607825911784, 'psi': 0.017551963048498844}
[S7] START round=43 head_norm_before_train=1.780530 (no previous merge yet)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.292344855031711, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2789653795416367, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=2.053006 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6463635221839081, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6193007038731393, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.895594 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0033390736776466, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.99042509935827, 'psi': 0.36867172340800847}
[S10] START round=43 head_norm_before_train=2.163671 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.695097293221512, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.6765176124543384, 'psi': 0.33293527585383326}
[S11] START round=43 head_norm_before_train=1.647696 cos_to_last_merge=0.8852 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.885
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.8666317343619756, 'psi': 0.3320133550741517}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 2.842873047470484, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.654737 (no previous merge yet)
[S13] round=43 local utility u=0.009935 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8211128852989888, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.840982798988599, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=43 head_norm_before_train=1.981104 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.420153801099813, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.388583243914297, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=2.025528 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.029658 metrics={'f1_val': 0.6159852087534988, 'auprc': 0.6159852087534988, 'loss_val': 0.4476037496982461, 'psi': 0.6159852087534988}-{'f1_val': 0.6100787309702305, 'auprc': 0.6100787309702305, 'loss_val': 0.4537621238149523, 'psi': 0.6100787309702305}
[S16] START round=43 head_norm_before_train=1.920937 (no previous merge yet)
[S16] round=43 local utility u=0.555287 metrics={'f1_val': 0.17198107385311664, 'auprc': 0.17198107385311664, 'loss_val': 3.42720103731763, 'psi': 0.17198107385311664}-{'f1_val': 0.14002044094028324, 'auprc': 0.14002044094028324, 'loss_val': 4.250128387851639, 'psi': 0.14002044094028324}
[S16] not sending this round → trigger blocked (psi=0.172)
[S17] START round=43 head_norm_before_train=2.010189 cos_to_last_merge=0.9806 (last merge round=21)
[S17] round=43 local utility u=0.242502 metrics={'f1_val': 0.36486065862920464, 'auprc': 0.36486065862920464, 'loss_val': 1.0929168715101334, 'psi': 0.36486065862920464}-{'f1_val': 0.31203211275902226, 'auprc': 0.31203211275902226, 'loss_val': 1.1024648089483937, 'psi': 0.31203211275902226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:51905
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=43 metric=0.3336 head_norm=2.019380
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.186692e-02
[S5] stored merged vector for next round verification (round=43)
[S5] DEBUG after merge:  round=43 metric=0.3336 head_norm=2.028792 delta_norm=0.021867
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=1.0000
[S2] START round=44 head_norm_before_train=1.887352 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.835793558146805, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8218809413840895, 'psi': 0.3674775928297055}
[S3] START round=44 head_norm_before_train=2.006115 (no previous merge yet)
[S3] round=44 local utility u=0.430350 metrics={'f1_val': 0.2711610486891386, 'auprc': 0.2711610486891386, 'loss_val': 3.400141564386744, 'psi': 0.2711610486891386}-{'f1_val': 0.29743589743589743, 'auprc': 0.29743589743589743, 'loss_val': 4.497314317135421, 'psi': 0.29743589743589743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=44 head_norm_before_train=2.021937 (no previous merge yet)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.346151563155143, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3350839769382299, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=2.028792 cos_to_last_merge=1.0000 (last merge round=43)
[S5] round=44 local utility u=0.020050 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8881144039464128, 'psi': 0.33308623671855697}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9327436610161015, 'psi': 0.33358943696313936}
[S6] START round=44 head_norm_before_train=1.891104 (no previous merge yet)
[S6] round=44 local utility u=0.045156 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.14974096004106, 'psi': 0.021310724106324473}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.20622326324216, 'psi': 0.017551963048498844}
[S7] START round=44 head_norm_before_train=1.785791 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3107454121825584, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.292344855031711, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=2.059817 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6712847987747241, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6463635221839081, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.900716 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.015149438038572, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0033390736776466, 'psi': 0.36867172340800847}
[S10] START round=44 head_norm_before_train=2.173646 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.71075340065214, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.695097293221512, 'psi': 0.33293527585383326}
[S11] START round=44 head_norm_before_train=1.661953 cos_to_last_merge=0.8833 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.883
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 2.9022533673840027, 'psi': 0.3320907114010562}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.8666317343619756, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.662593 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.24160133890435317, 'auprc': 0.24160133890435317, 'loss_val': 0.7361395224378106, 'psi': 0.2416013389043532}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8211128852989888, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.986719 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.452865215816947, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.420153801099813, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.039591 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=44 local utility u=0.001527 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4489441722218603, 'psi': 0.6164734888353558}-{'f1_val': 0.6159852087534988, 'auprc': 0.6159852087534988, 'loss_val': 0.4476037496982461, 'psi': 0.6159852087534988}
[S16] START round=44 head_norm_before_train=1.926973 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.13921181545660596, 'auprc': 0.13921181545660596, 'loss_val': 4.150665573483358, 'psi': 0.13921181545660596}-{'f1_val': 0.17198107385311664, 'auprc': 0.17198107385311664, 'loss_val': 3.42720103731763, 'psi': 0.17198107385311664}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=2.017579 cos_to_last_merge=0.9800 (last merge round=21)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.2917412308163212, 'auprc': 0.2917412308163212, 'loss_val': 0.9092084029744539, 'psi': 0.2917412308163212}-{'f1_val': 0.36486065862920464, 'auprc': 0.36486065862920464, 'loss_val': 1.0929168715101334, 'psi': 0.36486065862920464}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.021)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:51915
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=0.9999
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=44 metric=0.3331 head_norm=2.031953
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.211561e-03
[S5] stored merged vector for next round verification (round=44)
[S5] DEBUG after merge:  round=44 metric=0.3331 head_norm=2.035759 delta_norm=0.008212
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:51905
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=1.0000
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=44 metric=0.6165 head_norm=2.052933
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.623690e-02
[S15] stored merged vector for next round verification (round=44)
[S15] DEBUG after merge:  round=44 metric=0.6165 head_norm=2.042406 delta_norm=0.016237
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.893214 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8541737229457933, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.835793558146805, 'psi': 0.3674775928297055}
[S3] START round=45 head_norm_before_train=2.011056 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.29741339914084636, 'auprc': 0.29741339914084636, 'loss_val': 4.253635528764988, 'psi': 0.29741339914084636}-{'f1_val': 0.2711610486891386, 'auprc': 0.2711610486891386, 'loss_val': 3.400141564386744, 'psi': 0.2711610486891386}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.028878 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3626834709818316, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.346151563155143, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=2.035759 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0149870802297127, 'psi': 0.33358943696313936}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8881144039464128, 'psi': 0.33308623671855697}
[S6] START round=45 head_norm_before_train=1.897666 (no previous merge yet)
[S6] round=45 local utility u=0.028614 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 7.100395281236695, 'psi': 0.022186642268984445}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 7.14974096004106, 'psi': 0.021310724106324473}
[S7] START round=45 head_norm_before_train=1.789586 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3318754439722933, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3107454121825584, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=2.068867 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7024992297945751, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6712847987747241, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.905682 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0274660213492686, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.015149438038572, 'psi': 0.36867172340800847}
[S10] START round=45 head_norm_before_train=2.183300 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.7285478677152, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.71075340065214, 'psi': 0.33293527585383326}
[S11] START round=45 head_norm_before_train=1.675462 cos_to_last_merge=0.8815 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.881
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.925374832564372, 'psi': 0.3320133550741517}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 2.9022533673840027, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.670005 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.24012750132813884, 'auprc': 0.24012750132813884, 'loss_val': 0.7465424807617363, 'psi': 0.24012750132813884}-{'f1_val': 0.24160133890435317, 'auprc': 0.24160133890435317, 'loss_val': 0.7361395224378106, 'psi': 0.2416013389043532}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.992013 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.484802006155999, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.452865215816947, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.042406 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4625968889007747, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4489441722218603, 'psi': 0.6164734888353558}
[S16] START round=45 head_norm_before_train=1.932949 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.09015934021939308, 'auprc': 0.09015934021939308, 'loss_val': 4.983295856389146, 'psi': 0.09015934021939308}-{'f1_val': 0.13921181545660596, 'auprc': 0.13921181545660596, 'loss_val': 4.150665573483358, 'psi': 0.13921181545660596}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=2.024553 cos_to_last_merge=0.9794 (last merge round=21)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.31094172436985384, 'auprc': 0.31094172436985384, 'loss_val': 1.1747707834263126, 'psi': 0.31094172436985384}-{'f1_val': 0.2917412308163212, 'auprc': 0.2917412308163212, 'loss_val': 0.9092084029744539, 'psi': 0.2917412308163212}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.000 → S2@127.0.0.1:51902
[S2] ⇄ pheromone p=0.107 → S9@127.0.0.1:51910
[S10] ⇄ pheromone p=0.001 → S6@127.0.0.1:51907
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.3336 head_norm=2.040694
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.174510e-02
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.3336 head_norm=2.046789 delta_norm=0.011745
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.027 → S15@127.0.0.1:51915
[S6] ⇄ pheromone p=0.035 → S10@127.0.0.1:51911
[S15] ⇄ pheromone p=0.020 → S5@127.0.0.1:51905
[S2] START round=46 head_norm_before_train=1.898807 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.882536046535881, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8541737229457933, 'psi': 0.3674775928297055}
[S3] START round=46 head_norm_before_train=2.014697 (no previous merge yet)
[S3] round=46 local utility u=0.215339 metrics={'f1_val': 0.28829307140960975, 'auprc': 0.28829307140960975, 'loss_val': 3.740874321217987, 'psi': 0.28829307140960975}-{'f1_val': 0.29741339914084636, 'auprc': 0.29741339914084636, 'loss_val': 4.253635528764988, 'psi': 0.29741339914084636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=46 head_norm_before_train=2.037353 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3751706239826258, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3626834709818316, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=2.046789 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.038628789223253, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0149870802297127, 'psi': 0.33358943696313936}
[S6] START round=46 head_norm_before_train=1.904333 (no previous merge yet)
[S6] round=46 local utility u=0.019747 metrics={'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 7.068756027099327, 'psi': 0.023059360730593607}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 7.100395281236695, 'psi': 0.022186642268984445}
[S7] START round=46 head_norm_before_train=1.794181 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.344092298618792, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3318754439722933, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=2.074724 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7400179351008236, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7024992297945751, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.910582 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0405619405651945, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0274660213492686, 'psi': 0.36867172340800847}
[S10] START round=46 head_norm_before_train=2.192736 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.743588469122021, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.7285478677152, 'psi': 0.33293527585383326}
[S11] START round=46 head_norm_before_train=1.688354 cos_to_last_merge=0.8797 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.880
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.9495505170565552, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.925374832564372, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.681612 (no previous merge yet)
[S13] round=46 local utility u=0.536495 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.751832045797409, 'psi': 0.3599362944611573}-{'f1_val': 0.24012750132813884, 'auprc': 0.24012750132813884, 'loss_val': 0.7465424807617363, 'psi': 0.24012750132813884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=46 head_norm_before_train=1.997133 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.515585720248333, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.484802006155999, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.055458 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.47062362441380573, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4625968889007747, 'psi': 0.6164734888353558}
[S16] START round=46 head_norm_before_train=1.938873 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.04527388975289442, 'auprc': 0.04527388975289442, 'loss_val': 5.44151591651624, 'psi': 0.04527388975289442}-{'f1_val': 0.09015934021939308, 'auprc': 0.09015934021939308, 'loss_val': 4.983295856389146, 'psi': 0.09015934021939308}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.032457 cos_to_last_merge=0.9788 (last merge round=21)
[S17] round=46 local utility u=0.740677 metrics={'f1_val': 0.44893300248138956, 'auprc': 0.44893300248138956, 'loss_val': 0.9353380687592562, 'psi': 0.44893300248138956}-{'f1_val': 0.31094172436985384, 'auprc': 0.31094172436985384, 'loss_val': 1.1747707834263126, 'psi': 0.31094172436985384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.023)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.902049 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.896619421668944, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.882536046535881, 'psi': 0.3674775928297055}
[S3] START round=47 head_norm_before_train=2.018997 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.29042904290429045, 'auprc': 0.29042904290429045, 'loss_val': 3.8291253585088505, 'psi': 0.29042904290429045}-{'f1_val': 0.28829307140960975, 'auprc': 0.28829307140960975, 'loss_val': 3.740874321217987, 'psi': 0.28829307140960975}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.048253 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3773911073169038, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3751706239826258, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=2.053617 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.099726456590226, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.038628789223253, 'psi': 0.33358943696313936}
[S6] START round=47 head_norm_before_train=1.910855 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 7.4042867745380025, 'psi': 0.016882516188714152}-{'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 7.068756027099327, 'psi': 0.023059360730593607}
[S7] START round=47 head_norm_before_train=1.800339 (no previous merge yet)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 1.34308684195267, 'psi': 0.23938362300662963}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.344092298618792, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.077888 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7696112099222512, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7400179351008236, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.915419 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0542624325194785, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0405619405651945, 'psi': 0.36867172340800847}
[S10] START round=47 head_norm_before_train=2.202013 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.756551647879153, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.743588469122021, 'psi': 0.33293527585383326}
[S11] START round=47 head_norm_before_train=1.700364 cos_to_last_merge=0.8782 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.878
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.9937869615687673, 'psi': 0.33201273984308244}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.9495505170565552, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.690774 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.24004248539564524, 'auprc': 0.24004248539564524, 'loss_val': 0.7500763308357555, 'psi': 0.24004248539564524}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.751832045797409, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.002101 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.54681478341678, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.515585720248333, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.068647 cos_to_last_merge=0.9999 (last merge round=44)
[S15] round=47 local utility u=0.004092 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.46244059904542184, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.47062362441380573, 'psi': 0.6164734888353558}
[S16] START round=47 head_norm_before_train=1.944648 (no previous merge yet)
[S16] round=47 local utility u=0.267667 metrics={'f1_val': 0.0770239265814487, 'auprc': 0.0770239265814487, 'loss_val': 5.191932911062845, 'psi': 0.0770239265814487}-{'f1_val': 0.04527388975289442, 'auprc': 0.04527388975289442, 'loss_val': 5.44151591651624, 'psi': 0.04527388975289442}
[S16] not sending this round → trigger blocked (psi=0.077)
[S17] START round=47 head_norm_before_train=2.040261 cos_to_last_merge=0.9782 (last merge round=21)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.4014978834255943, 'auprc': 0.4014978834255943, 'loss_val': 1.1225620774080092, 'psi': 0.4014978834255943}-{'f1_val': 0.44893300248138956, 'auprc': 0.44893300248138956, 'loss_val': 0.9353380687592562, 'psi': 0.44893300248138956}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:51905
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.9999
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.906401 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.2051398680918808, 'auprc': 0.2051398680918808, 'loss_val': 3.490702664890754, 'psi': 0.2051398680918808}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.896619421668944, 'psi': 0.3674775928297055}
[S3] START round=48 head_norm_before_train=2.024386 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 4.414245348361033, 'psi': 0.2975373066007507}-{'f1_val': 0.29042904290429045, 'auprc': 0.29042904290429045, 'loss_val': 3.8291253585088505, 'psi': 0.29042904290429045}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.055117 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3810906502094156, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3773911073169038, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=2.058703 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=48 local utility u=0.221883 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.6559612047172825, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.099726456590226, 'psi': 0.33358943696313936}
[S6] START round=48 head_norm_before_train=1.916512 (no previous merge yet)
[S6] round=48 local utility u=0.135253 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 7.18544797034772, 'psi': 0.02262340036563071}-{'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 7.4042867745380025, 'psi': 0.016882516188714152}
[S7] START round=48 head_norm_before_train=1.805530 (no previous merge yet)
[S7] round=48 local utility u=0.540196 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3461156450982534, 'psi': 0.35976373724718097}-{'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 1.34308684195267, 'psi': 0.23938362300662963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=48 head_norm_before_train=2.084112 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7940518095017162, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7696112099222512, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.920291 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0658349102584084, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0542624325194785, 'psi': 0.36867172340800847}
[S10] START round=48 head_norm_before_train=2.210857 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.7692166653306574, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.756551647879153, 'psi': 0.33293527585383326}
[S11] START round=48 head_norm_before_train=1.711423 cos_to_last_merge=0.8768 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.877
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.015403336822918, 'psi': 0.33201273984308244}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.9937869615687673, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.697693 (no previous merge yet)
[S13] round=48 local utility u=0.544623 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.7398741900499556, 'psi': 0.3599362944611573}-{'f1_val': 0.24004248539564524, 'auprc': 0.24004248539564524, 'loss_val': 0.7500763308357555, 'psi': 0.24004248539564524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=48 head_norm_before_train=2.007025 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.572445336074431, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.54681478341678, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.081073 cos_to_last_merge=0.9999 (last merge round=44)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6153363917081437, 'auprc': 0.6153363917081437, 'loss_val': 0.45568739167476363, 'psi': 0.6153363917081437}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.46244059904542184, 'psi': 0.6164734888353558}
[S16] START round=48 head_norm_before_train=1.950376 (no previous merge yet)
[S16] round=48 local utility u=0.189438 metrics={'f1_val': 0.09090182921958623, 'auprc': 0.09090182921958623, 'loss_val': 4.937958011071964, 'psi': 0.09090182921958623}-{'f1_val': 0.0770239265814487, 'auprc': 0.0770239265814487, 'loss_val': 5.191932911062845, 'psi': 0.0770239265814487}
[S16] not sending this round → trigger blocked (psi=0.091)
[S17] START round=48 head_norm_before_train=2.049498 cos_to_last_merge=0.9775 (last merge round=21)
[S17] round=48 local utility u=0.759210 metrics={'f1_val': 0.5469223428126081, 'auprc': 0.5469223428126081, 'loss_val': 0.9129624452738667, 'psi': 0.5469223428126081}-{'f1_val': 0.4014978834255943, 'auprc': 0.4014978834255943, 'loss_val': 1.1225620774080092, 'psi': 0.4014978834255943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.023)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:51915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9998
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=48 metric=0.3336 head_norm=2.062536
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.055590e-02
[S5] stored merged vector for next round verification (round=48)
[S5] DEBUG after merge:  round=48 metric=0.3336 head_norm=2.071723 delta_norm=0.020556
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.911083 (no previous merge yet)
[S2] round=49 local utility u=1.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8978227780555716, 'psi': 0.3674775928297055}-{'f1_val': 0.2051398680918808, 'auprc': 0.2051398680918808, 'loss_val': 3.490702664890754, 'psi': 0.2051398680918808}
[S3] START round=49 head_norm_before_train=2.029802 (no previous merge yet)
[S3] round=49 local utility u=0.042341 metrics={'f1_val': 0.29741339914084636, 'auprc': 0.29741339914084636, 'loss_val': 4.328448228537548, 'psi': 0.29741339914084636}-{'f1_val': 0.2975373066007507, 'auprc': 0.2975373066007507, 'loss_val': 4.414245348361033, 'psi': 0.2975373066007507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=49 head_norm_before_train=2.061533 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3888623333456098, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3810906502094156, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=2.071723 cos_to_last_merge=1.0000 (last merge round=48)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.6772938590117716, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.6559612047172825, 'psi': 0.33358943696313936}
[S6] START round=49 head_norm_before_train=1.922285 (no previous merge yet)
[S6] round=49 local utility u=0.169840 metrics={'f1_val': 0.03619005328596803, 'auprc': 0.03619005328596803, 'loss_val': 6.967866931404028, 'psi': 0.03619005328596803}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 7.18544797034772, 'psi': 0.02262340036563071}
[S7] START round=49 head_norm_before_train=1.810896 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3739574573675204, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3461156450982534, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.092284 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.813933691629602, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7940518095017162, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.924898 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0758458002751787, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0658349102584084, 'psi': 0.36867172340800847}
[S10] START round=49 head_norm_before_train=2.219195 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.7821715454971048, 'psi': 0.33293527585383326}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.7692166653306574, 'psi': 0.33293527585383326}
[S11] START round=49 head_norm_before_train=1.722176 cos_to_last_merge=0.8755 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.875
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.0239449488064367, 'psi': 0.3320133550741517}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.015403336822918, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.707945 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8477441669915067, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.7398741900499556, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.011937 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.593394752669316, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.572445336074431, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.092303 cos_to_last_merge=0.9998 (last merge round=44)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6103140989197582, 'auprc': 0.6103140989197582, 'loss_val': 0.45780768347210143, 'psi': 0.6103140989197582}-{'f1_val': 0.6153363917081437, 'auprc': 0.6153363917081437, 'loss_val': 0.45568739167476363, 'psi': 0.6153363917081437}
[S16] START round=49 head_norm_before_train=1.954960 (no previous merge yet)
[S16] round=49 local utility u=0.496077 metrics={'f1_val': 0.13677097105920374, 'auprc': 0.13677097105920374, 'loss_val': 4.358625389558323, 'psi': 0.13677097105920374}-{'f1_val': 0.09090182921958623, 'auprc': 0.09090182921958623, 'loss_val': 4.937958011071964, 'psi': 0.09090182921958623}
[S16] not sending this round → trigger blocked (psi=0.137)
[S17] START round=49 head_norm_before_train=2.058585 cos_to_last_merge=0.9768 (last merge round=21)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.3131206920684558, 'auprc': 0.3131206920684558, 'loss_val': 1.3490549071988398, 'psi': 0.3131206920684558}-{'f1_val': 0.5469223428126081, 'auprc': 0.5469223428126081, 'loss_val': 0.9129624452738667, 'psi': 0.5469223428126081}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.036)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:51910
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=49 metric=0.6103 head_norm=2.103325
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.330212e-02
[S15] stored merged vector for next round verification (round=49)
[S15] DEBUG after merge:  round=49 metric=0.6109 head_norm=2.082764 delta_norm=0.033302
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] RECEIVED delta(kind=head bytes=1801) from S2
[S9] cosine check vs S2: cos=-0.1216
[S9] DROPPED delta from S2 (cos=-0.1216 < 0.0)
[runner] rounds complete.
[runner] all agents stopped.
