[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:39403
[S3] → join 127.0.0.1:39402
[S4] → join 127.0.0.1:39402
[S5] → join 127.0.0.1:39402
[S6] → join 127.0.0.1:39402
[S7] → join 127.0.0.1:39402
[S8] → join 127.0.0.1:39402
[S9] → join 127.0.0.1:39402
[S10] → join 127.0.0.1:39402
[S11] → join 127.0.0.1:39402
[S13] → join 127.0.0.1:39402
[S14] → join 127.0.0.1:39402
[S15] → join 127.0.0.1:39402
[S16] → join 127.0.0.1:39402
[S17] → join 127.0.0.1:39402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.159441 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.171969 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.196584 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.179220 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.165875 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.165063 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.151985 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.176283 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.170182 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.201734 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.168938 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.124427 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.188228 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.132636 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.174261 (no previous merge yet)
[S2]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S3] + discovered S7
[S3] + discovered S14
[S3] + discovered S4
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S13
[S3] + discovered S17
[S3] + discovered S11
[S3] + discovered S5
[S3] + discovered S9
[S3] + discovered S6
[S3] + discovered S10
[S3] + discovered S16
[S3] + discovered S8
[S3] + discovered S15
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S17
[S4] + discovered S13
[S4] + discovered S10
[S4] + discovered S11
[S4] + discovered S9
[S4] + discovered S5
[S4] + discovered S6
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S15
[S4] + discovered S7
[S4] + discovered S14
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S2
[S5] + discovered S8
[S5] + discovered S7
[S5] + discovered S16
[S5] + discovered S9
[S5] + discovered S11
[S5] + discovered S10
[S5] + discovered S14
[S5] + discovered S15
[S5] + discovered S6
[S5] + discovered S13
[S5] + discovered S17
[S7] + discovered S6
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S4
[S6] + discovered S13
[S6] + discovered S17
[S6] + discovered S14
[S6] + discovered S10
[S6] + discovered S9
[S6] + discovered S15
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S16
[S6] + discovered S7
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S2
[S8] + discovered S3
[S7] + discovered S11
[S7] + discovered S15
[S7] + discovered S9
[S7] + discovered S10
[S7] + discovered S14
[S7] + discovered S13
[S7] + discovered S17
[S7] + discovered S8
[S7] + discovered S16
[S9] + discovered S4
[S8] + discovered S16
[S8] + discovered S13
[S8] + discovered S10
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S14
[S9] + discovered S8
[S8] + discovered S9
[S8] + discovered S15
[S9] + discovered S3
[S9] + discovered S6
[S9] + discovered S7
[S9] + discovered S5
[S9] + discovered S2
[S10] + discovered S3
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S8
[S10] + discovered S5
[S10] + discovered S4
[S10] + discovered S2
[S10] + discovered S7
[S9] + discovered S17
[S9] + discovered S13
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S10
[S9] + discovered S15
[S11] + discovered S6
[S11] + discovered S4
[S11] + discovered S3
[S10] + discovered S14
[S10] + discovered S15
[S10] + discovered S13
[S11] + discovered S10
[S10] + discovered S11
[S11] + discovered S8
[S10] + discovered S16
[S11] + discovered S7
[S11] + discovered S2
[S11] + discovered S5
[S10] + discovered S17
[S11] + discovered S9
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S15
[S11] + discovered S14
[S13] + discovered S3
[S13] + discovered S8
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S10
[S13] + discovered S6
[S13] + discovered S9
[S13] + discovered S5
[S13] + discovered S2
[S13] + discovered S7
[S14] + discovered S8
[S14] + discovered S9
[S14] + discovered S13
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S4
[S14] + discovered S7
[S14] + discovered S2
[S14] + discovered S5
[S14] + discovered S10
[S14] + discovered S3
[S13] + discovered S14
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S16
[S15] + discovered S3
[S15] + discovered S4
[S15] + discovered S5
[S15] + discovered S2
[S15] + discovered S6
[S15] + discovered S13
[S15] + discovered S14
[S15] + discovered S8
[S15] + discovered S10
[S15] + discovered S7
[S15] + discovered S11
[S15] + discovered S9
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S16] + discovered S13
[S16] + discovered S10
[S16] + discovered S15
[S16] + discovered S7
[S16] + discovered S9
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S3
[S16] + discovered S2
[S16] + discovered S14
[S16] + discovered S6
[S16] + discovered S11
[S16] + discovered S4
[S16] + discovered S5
[S16] + discovered S8
[S17] + discovered S8
[S17] + discovered S2
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S3
[S17] + discovered S11
[S17] + discovered S14
[S17] + discovered S9
[S17] + discovered S5
[S17] + discovered S7
[S17] + discovered S15
[S17] + discovered S10
[S17] + discovered S16
[S17] + discovered S13
[S16] + discovered S17
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=1.000 → S2@127.0.0.1:39402
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:39403
[S2] ⇄ pheromone p=1.000 → S10@127.0.0.1:39411
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:39407
[S13] ⇄ pheromone p=1.000 → S15@127.0.0.1:39415
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:39403
[S11] ⇄ pheromone p=1.000 → S7@127.0.0.1:39408
[S15] ⇄ pheromone p=1.000 → S10@127.0.0.1:39411
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:39408
[S14] ⇄ pheromone p=1.000 → S6@127.0.0.1:39407
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:39409
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:39410
[S3] ⇄ pheromone p=1.000 → S15@127.0.0.1:39415
[S7] ⇄ pheromone p=1.000 → S15@127.0.0.1:39415
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:39409
[S2] START round=1 head_norm_before_train=1.180861 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8327489446133418, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.525071053323829, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.174947 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5512926662770974, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4817241727826738, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.218762 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5194243952189088, 'psi': 0.0}-{'f1_val': 0.31744981248621224, 'auprc': 0.31744981248621224, 'loss_val': 1.4012067123587926, 'psi': 0.31744981248621224}
[S5] START round=1 head_norm_before_train=1.181946 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.490262413841139, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4461608688495216, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.195555 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1699121931093965, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.577177841313332, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.166662 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4902681141652652, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4399638534660955, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.144900 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5987545695436847, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.490840123714731, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.181104 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5835608284370564, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5234975356263187, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.206127 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.720505566130608, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5200796270841392, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.205347 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5177897421909325, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4235911390855105, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.178604 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6001231908403828, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4463395346541976, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.121237 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5498382667351693, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4857376095268569, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.195862 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5413739793666736, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4313408283631361, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.143981 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5640392815241388, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4681653362757696, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.188672 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5372205619782062, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.403955391698531, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.236695 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1022994066082883, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8327489446133418, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.189599 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6835126135136915, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5512926662770974, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.263547 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7065657533556549, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5194243952189088, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.193838 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.566346971762492, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.490262413841139, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.250836 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1483527825004622, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1699121931093965, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.180298 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.579638520165752, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4902681141652652, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.169662 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9012747217759771, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5987545695436847, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.195076 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7018077517037276, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5835608284370564, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.254968 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9079893357944686, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.720505566130608, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.219163 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6962323751060764, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5177897421909325, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.216550 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.946255844734273, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6001231908403828, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.132358 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6719307841411783, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5498382667351693, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.231158 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9371249495623801, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5413739793666736, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.167413 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7525317906034243, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5640392815241388, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.229054 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8839092224783864, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5372205619782062, 'psi': 0.0}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.307279 (no previous merge yet)
[S2] round=3 local utility u=0.233872 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6345549614035915, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1022994066082883, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.216110 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9799163673647542, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6835126135136915, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.312325 (no previous merge yet)
[S4] round=3 local utility u=0.108190 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4901864926763435, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7065657533556549, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.213361 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7216477875081995, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.566346971762492, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.303257 (no previous merge yet)
[S6] round=3 local utility u=0.239327 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.669699764481586, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1483527825004622, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.204360 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7952185140264632, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.579638520165752, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.215601 (no previous merge yet)
[S8] round=3 local utility u=0.102713 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.695847986388358, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9012747217759771, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.220126 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0485283973568165, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7018077517037276, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.289981 (no previous merge yet)
[S10] round=3 local utility u=0.016015 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8759592950040298, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9079893357944686, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.243742 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.151602380080599, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6962323751060764, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.254532 (no previous merge yet)
[S13] round=3 local utility u=0.098241 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7497747954283571, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.946255844734273, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.156534 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9499842451401697, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6719307841411783, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.283537 (no previous merge yet)
[S15] round=3 local utility u=0.115744 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7056362362402544, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9371249495623801, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.204773 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2113748241993965, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7525317906034243, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.278765 (no previous merge yet)
[S17] round=3 local utility u=0.104793 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6743241033578597, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8839092224783864, 'psi': 0.0}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=4 head_norm_before_train=1.336336 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2063953669537764, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6345549614035915, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.251346 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5188557520513433, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9799163673647542, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.342408 (no previous merge yet)
[S4] round=4 local utility u=0.062816 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3645539652186505, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4901864926763435, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.241582 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9177462503584621, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7216477875081995, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.341270 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5305908422787424, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.669699764481586, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.234414 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.976368340226408, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7952185140264632, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.237929 (no previous merge yet)
[S8] round=4 local utility u=1.000000 metrics={'f1_val': 0.2709566709566709, 'auprc': 0.2709566709566709, 'loss_val': 1.531248085480426, 'psi': 0.2709566709566709}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.695847986388358, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.256041 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5945959523567517, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0485283973568165, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.318735 (no previous merge yet)
[S10] round=4 local utility u=0.339753 metrics={'f1_val': 0.09834284161912525, 'auprc': 0.09834284161912525, 'loss_val': 2.0815387074087526, 'psi': 0.09834284161912525}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8759592950040298, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.279371 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.899899640000407, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.151602380080599, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.266072 (no previous merge yet)
[S13] round=4 local utility u=0.060460 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6288548846701623, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7497747954283571, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.191417 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.522025298877917, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9499842451401697, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.305118 (no previous merge yet)
[S15] round=4 local utility u=0.395221 metrics={'f1_val': 0.07774846086191732, 'auprc': 0.07774846086191732, 'loss_val': 1.6149295513264075, 'psi': 0.07774846086191732}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7056362362402544, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.249911 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.729011998962493, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2113748241993965, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.307494 (no previous merge yet)
[S17] round=4 local utility u=0.088515 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4972943819379876, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6743241033578597, 'psi': 0.0}
[S10] not sending this round → trigger blocked (psi=0.098)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:39403
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.078)
[S8] sending update (kind=head size=1792 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S8
[S3] cosine check vs S8: cos=0.0905
[S17] not sending this round → trigger blocked (psi=0.000)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.0000 head_norm=1.286994
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.629075e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.0000 head_norm=0.944897 delta_norm=0.862908
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.388076 (no previous merge yet)
[S2] round=5 local utility u=0.072006 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0623837226477164, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2063953669537764, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=0.944897 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.113143 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2925700337208874, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5188557520513433, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.393692 (no previous merge yet)
[S4] round=5 local utility u=0.021128 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3222974469781275, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3645539652186505, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.266173 (no previous merge yet)
[S5] round=5 local utility u=0.092123 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7335007266952378, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9177462503584621, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.403824 (no previous merge yet)
[S6] round=5 local utility u=0.038418 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4537540040039327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5305908422787424, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.252279 (no previous merge yet)
[S7] round=5 local utility u=0.029335 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9176976249635425, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.976368340226408, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.272213 (no previous merge yet)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.22292813779471976, 'auprc': 0.22292813779471976, 'loss_val': 1.381643770164362, 'psi': 0.22292813779471976}-{'f1_val': 0.2709566709566709, 'auprc': 0.2709566709566709, 'loss_val': 1.531248085480426, 'psi': 0.2709566709566709}
[S9] START round=5 head_norm_before_train=1.291791 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7082050197653413, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5945959523567517, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.365723 (no previous merge yet)
[S10] round=5 local utility u=0.061172 metrics={'f1_val': 0.201994301994302, 'auprc': 0.201994301994302, 'loss_val': 2.8920587846274737, 'psi': 0.201994301994302}-{'f1_val': 0.09834284161912525, 'auprc': 0.09834284161912525, 'loss_val': 2.0815387074087526, 'psi': 0.09834284161912525}
[S11] START round=5 head_norm_before_train=1.316018 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1242682895093203, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.899899640000407, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.285394 (no previous merge yet)
[S13] round=5 local utility u=0.082845 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4631642197235095, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6288548846701623, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.227569 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0301266470418486, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.522025298877917, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.350202 (no previous merge yet)
[S15] round=5 local utility u=0.713921 metrics={'f1_val': 0.2028706907599641, 'auprc': 0.2028706907599641, 'loss_val': 1.313186972140161, 'psi': 0.2028706907599641}-{'f1_val': 0.07774846086191732, 'auprc': 0.07774846086191732, 'loss_val': 1.6149295513264075, 'psi': 0.07774846086191732}
[S16] START round=5 head_norm_before_train=1.286103 (no previous merge yet)
[S16] round=5 local utility u=0.077354 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.574304470699218, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.729011998962493, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.349637 (no previous merge yet)
[S17] round=5 local utility u=1.000000 metrics={'f1_val': 0.2031290405999483, 'auprc': 0.2031290405999483, 'loss_val': 1.3059817929737303, 'psi': 0.2031290405999483}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4972943819379876, 'psi': 0.0}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39411
[S13] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39408
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] cosine check vs S15: cos=-0.0480
[S10] DROPPED delta from S15 (cos=-0.0480 < 0.0)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.0594
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=0.0071
[S4] ⇄ pheromone p=0.356 → S2@127.0.0.1:39402
[S6] ⇄ pheromone p=0.366 → S8@127.0.0.1:39409
[S9] ⇄ pheromone p=0.328 → S3@127.0.0.1:39403
[S11] ⇄ pheromone p=0.328 → S7@127.0.0.1:39408
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.0000 head_norm=1.258489
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.214503e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.0000 head_norm=0.977429 delta_norm=0.921450
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.334 → S15@127.0.0.1:39415
[S16] ⇄ pheromone p=0.343 → S6@127.0.0.1:39407
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.2229 head_norm=1.325652
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.615133e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.2257 head_norm=0.968324 delta_norm=0.961513
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.501 → S3@127.0.0.1:39403
[S14] ⇄ pheromone p=0.328 → S6@127.0.0.1:39407
[S2] ⇄ pheromone p=0.372 → S10@127.0.0.1:39411
[S3] ⇄ pheromone p=0.350 → S15@127.0.0.1:39415
[S13] ⇄ pheromone p=0.366 → S15@127.0.0.1:39415
[S15] ⇄ pheromone p=0.549 → S10@127.0.0.1:39411
[S10] ⇄ pheromone p=0.396 → S7@127.0.0.1:39408
[S17] ⇄ pheromone p=0.555 → S8@127.0.0.1:39409
[S5] ⇄ pheromone p=0.346 → S9@127.0.0.1:39410
[S2] START round=6 head_norm_before_train=1.441689 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.064178802432652, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0623837226477164, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=0.973188 cos_to_last_merge=0.9979 (last merge round=4)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.723294323022498, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2925700337208874, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.451241 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.39599029291572, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3222974469781275, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.268249 (no previous merge yet)
[S5] round=6 local utility u=0.075878 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.581744006297387, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7335007266952378, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.466730 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.965956644554159, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4537540040039327, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=0.977429 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.068936 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7798261012040537, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9176976249635425, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=0.968324 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.20511821252273318, 'auprc': 0.20511821252273318, 'loss_val': 1.3168047535982579, 'psi': 0.20511821252273318}-{'f1_val': 0.22292813779471976, 'auprc': 0.22292813779471976, 'loss_val': 1.381643770164362, 'psi': 0.22292813779471976}
[S9] START round=6 head_norm_before_train=1.321926 (no previous merge yet)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.74901940971165, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7082050197653413, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.423053 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.1681472081218274, 'auprc': 0.1681472081218274, 'loss_val': 3.238088656663849, 'psi': 0.1681472081218274}-{'f1_val': 0.201994301994302, 'auprc': 0.201994301994302, 'loss_val': 2.8920587846274737, 'psi': 0.201994301994302}
[S11] START round=6 head_norm_before_train=1.339093 (no previous merge yet)
[S11] round=6 local utility u=0.161409 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8014505765146898, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1242682895093203, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.306647 (no previous merge yet)
[S13] round=6 local utility u=0.771899 metrics={'f1_val': 0.15477538693846735, 'auprc': 0.15477538693846735, 'loss_val': 1.312344761500475, 'psi': 0.15477538693846735}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4631642197235095, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.255673 (no previous merge yet)
[S14] round=6 local utility u=0.002361 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0254049641899283, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0301266470418486, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.400278 (no previous merge yet)
[S15] round=6 local utility u=0.036128 metrics={'f1_val': 0.2027927235459903, 'auprc': 0.2027927235459903, 'loss_val': 1.2402290747855567, 'psi': 0.2027927235459903}-{'f1_val': 0.2028706907599641, 'auprc': 0.2028706907599641, 'loss_val': 1.313186972140161, 'psi': 0.2028706907599641}
[S16] START round=6 head_norm_before_train=1.310253 (no previous merge yet)
[S16] round=6 local utility u=0.005376 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.563552169316176, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.574304470699218, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.402485 (no previous merge yet)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.2310274319200822, 'psi': 0.152287708414114}-{'f1_val': 0.2031290405999483, 'auprc': 0.2031290405999483, 'loss_val': 1.3059817929737303, 'psi': 0.2031290405999483}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.155)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:39411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1789 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1789) from S15
[S10] cosine check vs S15: cos=-0.0387
[S10] DROPPED delta from S15 (cos=-0.0387 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S2] START round=7 head_norm_before_train=1.487753 (no previous merge yet)
[S2] round=7 local utility u=0.572672 metrics={'f1_val': 0.06395147313691507, 'auprc': 0.06395147313691507, 'loss_val': 2.494397926869941, 'psi': 0.06395147313691507}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.064178802432652, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.006666 cos_to_last_merge=0.9913 (last merge round=4)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8302093708753717, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.723294323022498, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.511291 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4403719707589262, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.39599029291572, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.273677 (no previous merge yet)
[S5] round=7 local utility u=0.706377 metrics={'f1_val': 0.14654181041563988, 'auprc': 0.14654181041563988, 'loss_val': 1.4878665505547264, 'psi': 0.14654181041563988}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.581744006297387, 'psi': 0.0}
[S6] START round=7 head_norm_before_train=1.528951 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 5.796509813233096, 'psi': 0.016882516188714152}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.965956644554159, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=0.990844 cos_to_last_merge=0.9990 (last merge round=5)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.867055430551411, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7798261012040537, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.025057 cos_to_last_merge=0.9898 (last merge round=5)
[S8] round=7 local utility u=0.017881 metrics={'f1_val': 0.20372879169085867, 'auprc': 0.20372879169085867, 'loss_val': 1.268538742268032, 'psi': 0.20372879169085867}-{'f1_val': 0.20511821252273318, 'auprc': 0.20511821252273318, 'loss_val': 1.3168047535982579, 'psi': 0.20511821252273318}
[S9] START round=7 head_norm_before_train=1.354399 (no previous merge yet)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.788687082890356, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.74901940971165, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.484561 (no previous merge yet)
[S10] round=7 local utility u=0.048335 metrics={'f1_val': 0.18254931714719272, 'auprc': 0.18254931714719272, 'loss_val': 3.271038178586535, 'psi': 0.18254931714719272}-{'f1_val': 0.1681472081218274, 'auprc': 0.1681472081218274, 'loss_val': 3.238088656663849, 'psi': 0.1681472081218274}
[S11] START round=7 head_norm_before_train=1.354459 (no previous merge yet)
[S11] round=7 local utility u=0.070498 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6604539436097006, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8014505765146898, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.344210 (no previous merge yet)
[S13] round=7 local utility u=0.850831 metrics={'f1_val': 0.32993957453853157, 'auprc': 0.32993957453853157, 'loss_val': 1.1871612961191118, 'psi': 0.32993957453853157}-{'f1_val': 0.15477538693846735, 'auprc': 0.15477538693846735, 'loss_val': 1.312344761500475, 'psi': 0.15477538693846735}
[S14] START round=7 head_norm_before_train=1.277471 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.18307755326464, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0254049641899283, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.455173 (no previous merge yet)
[S15] round=7 local utility u=0.161780 metrics={'f1_val': 0.2360924683072334, 'auprc': 0.2360924683072334, 'loss_val': 1.2163675485838878, 'psi': 0.2360924683072334}-{'f1_val': 0.2027927235459903, 'auprc': 0.2027927235459903, 'loss_val': 1.2402290747855567, 'psi': 0.2027927235459903}
[S16] START round=7 head_norm_before_train=1.342995 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.967655588743698, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.563552169316176, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.455960 (no previous merge yet)
[S17] round=7 local utility u=0.018529 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.1942352337854951, 'psi': 0.15231723870467326}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.2310274319200822, 'psi': 0.152287708414114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39403
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[S2] not sending this round → trigger blocked (psi=0.064)
[S5] not sending this round → trigger blocked (psi=0.147)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39411
[S15] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] cosine check vs S15: cos=-0.0302
[S10] DROPPED delta from S15 (cos=-0.0302 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.5086
[S15] RECEIVED delta(kind=head bytes=1799) from S13
[S15] cosine check vs S13: cos=0.0431
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=0.7391
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.6109
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.0000 head_norm=1.009481
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.249301e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.195470 delta_norm=0.524930
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.0000 head_norm=1.039302
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.286747e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.0000 head_norm=0.925518 delta_norm=0.528675
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.2361 head_norm=1.497805
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.978701e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.3040 head_norm=1.041739 delta_norm=0.997870
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.2037 head_norm=1.091793
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.039923e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.2038 head_norm=1.171581 delta_norm=0.603992
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.527804 (no previous merge yet)
[S2] round=8 local utility u=0.539098 metrics={'f1_val': 0.19008596448943518, 'auprc': 0.19008596448943518, 'loss_val': 2.5514126615681163, 'psi': 0.19008596448943518}-{'f1_val': 0.06395147313691507, 'auprc': 0.06395147313691507, 'loss_val': 2.494397926869941, 'psi': 0.06395147313691507}
[S3] START round=8 head_norm_before_train=0.925518 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.300242 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.229724848114753, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8302093708753717, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.565507 (no previous merge yet)
[S4] round=8 local utility u=0.000013 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4403467070147293, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4403719707589262, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.285406 (no previous merge yet)
[S5] round=8 local utility u=0.495631 metrics={'f1_val': 0.24893686620870134, 'auprc': 0.24893686620870134, 'loss_val': 1.418159739956627, 'psi': 0.2489368662087013}-{'f1_val': 0.14654181041563988, 'auprc': 0.14654181041563988, 'loss_val': 1.4878665505547264, 'psi': 0.14654181041563988}
[S6] START round=8 head_norm_before_train=1.580229 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.132998504787154, 'psi': 0.021967963386727688}-{'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 5.796509813233096, 'psi': 0.016882516188714152}
[S7] START round=8 head_norm_before_train=1.195470 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.016910 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8332346470098917, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.867055430551411, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.171581 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.471760 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.2370168952121818, 'psi': 0.30506182380216385}-{'f1_val': 0.20372879169085867, 'auprc': 0.20372879169085867, 'loss_val': 1.268538742268032, 'psi': 0.20372879169085867}
[S9] START round=8 head_norm_before_train=1.388486 (no previous merge yet)
[S9] round=8 local utility u=0.150212 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4882640393801756, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.788687082890356, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.546075 (no previous merge yet)
[S10] round=8 local utility u=0.330394 metrics={'f1_val': 0.23006451612903225, 'auprc': 0.23006451612903225, 'loss_val': 3.0378878143288346, 'psi': 0.23006451612903225}-{'f1_val': 0.18254931714719272, 'auprc': 0.18254931714719272, 'loss_val': 3.271038178586535, 'psi': 0.18254931714719272}
[S11] START round=8 head_norm_before_train=1.374473 (no previous merge yet)
[S11] round=8 local utility u=0.136989 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.386476260702106, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6604539436097006, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.385103 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.24063886424134873, 'auprc': 0.24063886424134873, 'loss_val': 1.048084955727132, 'psi': 0.24063886424134873}-{'f1_val': 0.32993957453853157, 'auprc': 0.32993957453853157, 'loss_val': 1.1871612961191118, 'psi': 0.32993957453853157}
[S14] START round=8 head_norm_before_train=1.304003 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.226961493880505, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.18307755326464, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.041739 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.20275376240794107, 'auprc': 0.20275376240794107, 'loss_val': 1.155410712162294, 'psi': 0.20275376240794107}-{'f1_val': 0.2360924683072334, 'auprc': 0.2360924683072334, 'loss_val': 1.2163675485838878, 'psi': 0.2360924683072334}
[S16] START round=8 head_norm_before_train=1.381657 (no previous merge yet)
[S16] round=8 local utility u=0.214623 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.538408838467543, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.967655588743698, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.510896 (no previous merge yet)
[S17] round=8 local utility u=0.016595 metrics={'f1_val': 0.15243547448088493, 'auprc': 0.15243547448088493, 'loss_val': 1.1621090788676933, 'psi': 0.15243547448088493}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.1942352337854951, 'psi': 0.15231723870467326}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.190)
[S7] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:39410
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39408
[S11] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.6640
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=-0.1364
[S9] DROPPED delta from S5 (cos=-0.1364 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=0.9473
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.8874
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.0000 head_norm=0.950866
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.604192e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.0000 head_norm=0.990024 delta_norm=0.460419
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.0000 head_norm=1.208612
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.966095e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.383136 delta_norm=0.296609
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3051 head_norm=1.216603
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.706724e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3051 head_norm=1.351417 delta_norm=0.370672
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.580863 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.18828894861145043, 'auprc': 0.18828894861145043, 'loss_val': 2.8981779417499562, 'psi': 0.18828894861145043}-{'f1_val': 0.19008596448943518, 'auprc': 0.19008596448943518, 'loss_val': 2.5514126615681163, 'psi': 0.19008596448943518}
[S3] START round=9 head_norm_before_train=0.990024 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.113024 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.003676988192433, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.229724848114753, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.620105 (no previous merge yet)
[S4] round=9 local utility u=0.029762 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3808230351862198, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4403467070147293, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.304987 (no previous merge yet)
[S5] round=9 local utility u=0.296187 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.3314986570278504, 'psi': 0.3051272166538165}-{'f1_val': 0.24893686620870134, 'auprc': 0.24893686620870134, 'loss_val': 1.418159739956627, 'psi': 0.2489368662087013}
[S6] START round=9 head_norm_before_train=1.622667 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.02737556561085973, 'auprc': 0.02737556561085973, 'loss_val': 6.231489895936076, 'psi': 0.02737556561085973}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.132998504787154, 'psi': 0.021967963386727688}
[S7] START round=9 head_norm_before_train=1.383136 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.067362 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.698510010774802, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8332346470098917, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.351417 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.032248 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1725206507534025, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.2370168952121818, 'psi': 0.30506182380216385}
[S9] START round=9 head_norm_before_train=1.423452 (no previous merge yet)
[S9] round=9 local utility u=0.065090 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3580832681515345, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4882640393801756, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.594158 (no previous merge yet)
[S10] round=9 local utility u=0.575797 metrics={'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 2.8114071597040082, 'psi': 0.3328548644338118}-{'f1_val': 0.23006451612903225, 'auprc': 0.23006451612903225, 'loss_val': 3.0378878143288346, 'psi': 0.23006451612903225}
[S11] START round=9 head_norm_before_train=1.398111 (no previous merge yet)
[S11] round=9 local utility u=0.047017 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2924430134415195, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.386476260702106, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.438362 (no previous merge yet)
[S13] round=9 local utility u=0.542787 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0361871025108647, 'psi': 0.3599362944611573}-{'f1_val': 0.24063886424134873, 'auprc': 0.24063886424134873, 'loss_val': 1.048084955727132, 'psi': 0.24063886424134873}
[S14] START round=9 head_norm_before_train=1.332478 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.721654693999262, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.226961493880505, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.103539 cos_to_last_merge=0.9952 (last merge round=7)
[S15] round=9 local utility u=0.342006 metrics={'f1_val': 0.2608982282653482, 'auprc': 0.2608982282653482, 'loss_val': 0.994698964372612, 'psi': 0.2608982282653482}-{'f1_val': 0.20275376240794107, 'auprc': 0.20275376240794107, 'loss_val': 1.155410712162294, 'psi': 0.20275376240794107}
[S16] START round=9 head_norm_before_train=1.417248 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9777727199556803, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.538408838467543, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.564394 (no previous merge yet)
[S17] round=9 local utility u=0.033634 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0935105482548606, 'psi': 0.152287708414114}-{'f1_val': 0.15243547448088493, 'auprc': 0.15243547448088493, 'loss_val': 1.1621090788676933, 'psi': 0.15243547448088493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:39410
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[S3] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S13
[S15] cosine check vs S13: cos=0.6081
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.9841
[S10] RECEIVED delta(kind=head bytes=1795) from S15
[S10] cosine check vs S15: cos=0.0174
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.8477
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=-0.1437
[S9] DROPPED delta from S5 (cos=-0.1437 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9459
[S7] not sending this round → trigger blocked (psi=0.000)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.0000 head_norm=1.014218
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.811965e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.161457 delta_norm=0.381197
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3051 head_norm=1.399982
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.721464e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3051 head_norm=1.491453 delta_norm=0.272146
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.3329 head_norm=1.631410
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.992402e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.3329 head_norm=1.015884 delta_norm=0.999240
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.2609 head_norm=1.183006
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.059340e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.3040 head_norm=1.198174 delta_norm=0.605934
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.0000 head_norm=1.392311
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.798754e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.505875 delta_norm=0.179875
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.631922 (no previous merge yet)
[S2] round=10 local utility u=0.135012 metrics={'f1_val': 0.1993365733240762, 'auprc': 0.1993365733240762, 'loss_val': 2.727581918756464, 'psi': 0.1993365733240762}-{'f1_val': 0.18828894861145043, 'auprc': 0.18828894861145043, 'loss_val': 2.8981779417499562, 'psi': 0.18828894861145043}
[S3] START round=10 head_norm_before_train=1.161457 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.059281 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8851148833335074, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.003676988192433, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.657121 (no previous merge yet)
[S4] round=10 local utility u=0.391982 metrics={'f1_val': 0.08228670420095278, 'auprc': 0.08228670420095278, 'loss_val': 1.3374395845143234, 'psi': 0.08228670420095278}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3808230351862198, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.329010 (no previous merge yet)
[S5] round=10 local utility u=1.000000 metrics={'f1_val': 0.7653842910527794, 'auprc': 0.7653842910527794, 'loss_val': 1.2565343344794484, 'psi': 0.7653842910527794}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.3314986570278504, 'psi': 0.3051272166538165}
[S6] START round=10 head_norm_before_train=1.658918 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.731602385784807, 'psi': 0.017105871474803514}-{'f1_val': 0.02737556561085973, 'auprc': 0.02737556561085973, 'loss_val': 6.231489895936076, 'psi': 0.02737556561085973}
[S7] START round=10 head_norm_before_train=1.505875 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.052154 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5942012292987522, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.698510010774802, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.491453 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.038669 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.095183300474877, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1725206507534025, 'psi': 0.30506182380216385}
[S9] START round=10 head_norm_before_train=1.456434 (no previous merge yet)
[S9] round=10 local utility u=0.675335 metrics={'f1_val': 0.1330154554422887, 'auprc': 0.1330154554422887, 'loss_val': 2.204553217549664, 'psi': 0.1330154554422887}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3580832681515345, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.015884 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.129362 metrics={'f1_val': 0.24964097654380085, 'auprc': 0.24964097654380085, 'loss_val': 1.8037587333803524, 'psi': 0.24964097654380085}-{'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 2.8114071597040082, 'psi': 0.3328548644338118}
[S11] START round=10 head_norm_before_train=1.426078 (no previous merge yet)
[S11] round=10 local utility u=0.031574 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2292950506276146, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2924430134415195, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.485277 (no previous merge yet)
[S13] round=10 local utility u=0.058477 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9192326503894631, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0361871025108647, 'psi': 0.3599362944611573}
[S14] START round=10 head_norm_before_train=1.364581 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.164178699578453, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.721654693999262, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.198174 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.871668 metrics={'f1_val': 0.4477298433535733, 'auprc': 0.4477298433535733, 'loss_val': 0.9328471162000093, 'psi': 0.44772984335357335}-{'f1_val': 0.2608982282653482, 'auprc': 0.2608982282653482, 'loss_val': 0.994698964372612, 'psi': 0.2608982282653482}
[S16] START round=10 head_norm_before_train=1.453491 (no previous merge yet)
[S16] round=10 local utility u=0.035915 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9059428802577307, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9777727199556803, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.623897 (no previous merge yet)
[S17] round=10 local utility u=0.243703 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.062260082937002, 'psi': 0.20297157622739018}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0935105482548606, 'psi': 0.152287708414114}
[S3] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.199)
[S4] not sending this round → trigger blocked (psi=0.082)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:39410
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[S9] not sending this round → trigger blocked (psi=0.133)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:39415
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] cosine check vs S15: cos=0.5383
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.9376
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=-0.1499
[S9] DROPPED delta from S5 (cos=-0.1499 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1805) from S13
[S15] cosine check vs S13: cos=0.8788
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=0.8255
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9625
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.0000 head_norm=1.516345
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.378410e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.235409 delta_norm=0.437841
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.138 → S15@127.0.0.1:39415
[S11] ⇄ pheromone p=0.159 → S7@127.0.0.1:39408
[S14] ⇄ pheromone p=0.108 → S6@127.0.0.1:39407
[S2] ⇄ pheromone p=0.277 → S10@127.0.0.1:39411
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.0000 head_norm=1.182685
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.028486e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.347099 delta_norm=0.302849
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.183 → S15@127.0.0.1:39415
[S4] ⇄ pheromone p=0.200 → S2@127.0.0.1:39402
[S6] ⇄ pheromone p=0.120 → S8@127.0.0.1:39409
[S9] ⇄ pheromone p=0.272 → S3@127.0.0.1:39403
[S13] ⇄ pheromone p=0.369 → S15@127.0.0.1:39415
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.3051 head_norm=1.553718
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.277693e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3051 head_norm=1.596100 delta_norm=0.227769
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.239 → S3@127.0.0.1:39403
[S5] ⇄ pheromone p=0.503 → S9@127.0.0.1:39410
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.4477 head_norm=1.264984
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.654041e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6955 head_norm=1.351788 delta_norm=0.365404
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.428 → S10@127.0.0.1:39411
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.2496 head_norm=1.066104
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.667516e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.2499 head_norm=1.023315 delta_norm=0.566752
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.295 → S7@127.0.0.1:39408
[S16] ⇄ pheromone p=0.148 → S6@127.0.0.1:39407
[S17] ⇄ pheromone p=0.240 → S8@127.0.0.1:39409
[S2] START round=11 head_norm_before_train=1.673547 (no previous merge yet)
[S2] round=11 local utility u=0.467923 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.3860554024714964, 'psi': 0.26537216828478966}-{'f1_val': 0.1993365733240762, 'auprc': 0.1993365733240762, 'loss_val': 2.727581918756464, 'psi': 0.1993365733240762}
[S3] START round=11 head_norm_before_train=1.347099 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.948712677339962, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8851148833335074, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.686462 (no previous merge yet)
[S4] round=11 local utility u=0.718033 metrics={'f1_val': 0.239378489924739, 'auprc': 0.239378489924739, 'loss_val': 1.3151996869251608, 'psi': 0.23937848992473904}-{'f1_val': 0.08228670420095278, 'auprc': 0.08228670420095278, 'loss_val': 1.3374395845143234, 'psi': 0.08228670420095278}
[S5] START round=11 head_norm_before_train=1.354043 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.5220958013143594, 'auprc': 0.5220958013143594, 'loss_val': 1.2111660348777853, 'psi': 0.5220958013143594}-{'f1_val': 0.7653842910527794, 'auprc': 0.7653842910527794, 'loss_val': 1.2565343344794484, 'psi': 0.7653842910527794}
[S6] START round=11 head_norm_before_train=1.691626 (no previous merge yet)
[S6] round=11 local utility u=0.158830 metrics={'f1_val': 0.029080252479711452, 'auprc': 0.029080252479711452, 'loss_val': 6.5217111137818105, 'psi': 0.029080252479711452}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.731602385784807, 'psi': 0.017105871474803514}
[S7] START round=11 head_norm_before_train=1.235409 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.017247 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5597063514732425, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5942012292987522, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.596100 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.033070 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0290438101113744, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.095183300474877, 'psi': 0.30506182380216385}
[S9] START round=11 head_norm_before_train=1.491823 (no previous merge yet)
[S9] round=11 local utility u=1.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.090613659302793, 'psi': 0.36867172340800847}-{'f1_val': 0.1330154554422887, 'auprc': 0.1330154554422887, 'loss_val': 2.204553217549664, 'psi': 0.1330154554422887}
[S10] START round=11 head_norm_before_train=1.023315 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.013859 metrics={'f1_val': 0.24964114832535886, 'auprc': 0.24964114832535886, 'loss_val': 1.776041980221858, 'psi': 0.24964114832535883}-{'f1_val': 0.24964097654380085, 'auprc': 0.24964097654380085, 'loss_val': 1.8037587333803524, 'psi': 0.24964097654380085}
[S11] START round=11 head_norm_before_train=1.459760 (no previous merge yet)
[S11] round=11 local utility u=0.322849 metrics={'f1_val': 0.047701647875108416, 'auprc': 0.047701647875108416, 'loss_val': 2.012912086888285, 'psi': 0.047701647875108416}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2292950506276146, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.523653 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1251240143102221, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9192326503894631, 'psi': 0.3599362944611573}
[S14] START round=11 head_norm_before_train=1.397569 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.019855595667870037, 'auprc': 0.019855595667870037, 'loss_val': 4.365168375489255, 'psi': 0.019855595667870037}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.164178699578453, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.351788 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=1.000000 metrics={'f1_val': 0.6660709115894611, 'auprc': 0.6660709115894611, 'loss_val': 0.830577666570796, 'psi': 0.6660709115894611}-{'f1_val': 0.4477298433535733, 'auprc': 0.4477298433535733, 'loss_val': 0.9328471162000093, 'psi': 0.44772984335357335}
[S16] START round=11 head_norm_before_train=1.485405 (no previous merge yet)
[S16] round=11 local utility u=0.075292 metrics={'f1_val': 0.00023169601482854495, 'auprc': 0.00023169601482854495, 'loss_val': 2.7574445768115137, 'psi': 0.00023169601482854495}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9059428802577307, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.668768 (no previous merge yet)
[S17] round=11 local utility u=0.028559 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.0051413894720251, 'psi': 0.20297157622739018}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.062260082937002, 'psi': 0.20297157622739018}
[S7] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[S16] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39411
[S6] not sending this round → trigger blocked (psi=0.029)
[S11] not sending this round → trigger blocked (psi=0.048)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39403
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39402
[S4] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.7167
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] cosine check vs S15: cos=0.8145
[S10] RECEIVED delta(kind=head bytes=1799) from S2
[S10] cosine check vs S2: cos=0.0646
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.0977
[S3] RECEIVED delta(kind=head bytes=1804) from S8
[S3] cosine check vs S8: cos=0.9687
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=0.0390
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.9702
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.0000 head_norm=1.368861
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.612154e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.190527 delta_norm=0.461215
[S3] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.0000 head_norm=1.257349
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.492357e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.090928 delta_norm=0.449236
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3051 head_norm=1.662827
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.061024e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3051 head_norm=1.669733 delta_norm=0.206102
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.2496 head_norm=1.096788
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.276247e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.2496 head_norm=0.985313 delta_norm=0.527625
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.2654 head_norm=1.710499
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.187342e+00
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.2654 head_norm=1.234606 delta_norm=1.187342
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.234606 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.308756 metrics={'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 1.5899088736740714, 'psi': 0.24552398411243506}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.3860554024714964, 'psi': 0.26537216828478966}
[S3] START round=12 head_norm_before_train=1.190527 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.992798340488412, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.948712677339962, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.715301 (no previous merge yet)
[S4] round=12 local utility u=0.549374 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.273189580171038, 'psi': 0.3567939207526687}-{'f1_val': 0.239378489924739, 'auprc': 0.239378489924739, 'loss_val': 1.3151996869251608, 'psi': 0.23937848992473904}
[S5] START round=12 head_norm_before_train=1.386761 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.3812083433627437, 'auprc': 0.3812083433627437, 'loss_val': 1.174879509260824, 'psi': 0.3812083433627437}-{'f1_val': 0.5220958013143594, 'auprc': 0.5220958013143594, 'loss_val': 1.2111660348777853, 'psi': 0.5220958013143594}
[S6] START round=12 head_norm_before_train=1.717739 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 6.961473753619956, 'psi': 0.01954921803127875}-{'f1_val': 0.029080252479711452, 'auprc': 0.029080252479711452, 'loss_val': 6.5217111137818105, 'psi': 0.029080252479711452}
[S7] START round=12 head_norm_before_train=1.090928 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.045951 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4678041930247987, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5597063514732425, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.669733 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.026260 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9765235024696587, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0290438101113744, 'psi': 0.30506182380216385}
[S9] START round=12 head_norm_before_train=1.527655 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.155951319318485, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.090613659302793, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=0.985313 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.24964114832535886, 'auprc': 0.24964114832535886, 'loss_val': 1.8490230050018337, 'psi': 0.24964114832535883}-{'f1_val': 0.24964114832535886, 'auprc': 0.24964114832535886, 'loss_val': 1.776041980221858, 'psi': 0.24964114832535883}
[S11] START round=12 head_norm_before_train=1.497549 (no previous merge yet)
[S11] round=12 local utility u=1.000000 metrics={'f1_val': 0.33294419799206165, 'auprc': 0.33294419799206165, 'loss_val': 1.8113702843037984, 'psi': 0.33294419799206165}-{'f1_val': 0.047701647875108416, 'auprc': 0.047701647875108416, 'loss_val': 2.012912086888285, 'psi': 0.047701647875108416}
[S13] START round=12 head_norm_before_train=1.548406 (no previous merge yet)
[S13] round=12 local utility u=0.033309 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.058505731614174, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1251240143102221, 'psi': 0.3599362944611573}
[S14] START round=12 head_norm_before_train=1.432528 (no previous merge yet)
[S14] round=12 local utility u=0.437017 metrics={'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 4.497954826068212, 'psi': 0.13172448466566114}-{'f1_val': 0.019855595667870037, 'auprc': 0.019855595667870037, 'loss_val': 4.365168375489255, 'psi': 0.019855595667870037}
[S15] START round=12 head_norm_before_train=1.414583 cos_to_last_merge=0.9931 (last merge round=10)
[S15] round=12 local utility u=0.066991 metrics={'f1_val': 0.6656381676920641, 'auprc': 0.6656381676920641, 'loss_val': 0.6927015867930926, 'psi': 0.6656381676920641}-{'f1_val': 0.6660709115894611, 'auprc': 0.6660709115894611, 'loss_val': 0.830577666570796, 'psi': 0.6660709115894611}
[S16] START round=12 head_norm_before_train=1.513554 (no previous merge yet)
[S16] round=12 local utility u=0.687922 metrics={'f1_val': 0.09971509971509972, 'auprc': 0.09971509971509972, 'loss_val': 2.276951799546026, 'psi': 0.09971509971509972}-{'f1_val': 0.00023169601482854495, 'auprc': 0.00023169601482854495, 'loss_val': 2.7574445768115137, 'psi': 0.00023169601482854495}
[S17] START round=12 head_norm_before_train=1.701759 (no previous merge yet)
[S17] round=12 local utility u=0.018344 metrics={'f1_val': 0.20370676894079467, 'auprc': 0.20370676894079467, 'loss_val': 0.9750710945752593, 'psi': 0.20370676894079467}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.0051413894720251, 'psi': 0.20297157622739018}
[S16] not sending this round → trigger blocked (psi=0.100)
[S14] not sending this round → trigger blocked (psi=0.132)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39408
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39411
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:39403
[S8] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1804) from S4
[S2] cosine check vs S4: cos=0.6827
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] cosine check vs S13: cos=0.9154
[S7] RECEIVED delta(kind=head bytes=1801) from S11
[S7] cosine check vs S11: cos=0.1536
[S10] RECEIVED delta(kind=head bytes=1799) from S2
[S10] cosine check vs S2: cos=0.3825
[S10] RECEIVED delta(kind=head bytes=1801) from S15
[S10] cosine check vs S15: cos=0.7858
[S3] RECEIVED delta(kind=head bytes=1805) from S8
[S3] cosine check vs S8: cos=0.9167
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] cosine check vs S17: cos=0.9766
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.0000 head_norm=1.114465
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.764017e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.0003 head_norm=1.015265 delta_norm=0.876402
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.0000 head_norm=1.218483
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.920176e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.444866 delta_norm=0.392018
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.2496 head_norm=1.073239
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.156727e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.3333 head_norm=0.996565 delta_norm=0.315673
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.3051 head_norm=1.731454
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.875212e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.3051 head_norm=1.724770 delta_norm=0.187521
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.2455 head_norm=1.300948
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.389462e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.2455 head_norm=1.398379 delta_norm=0.638946
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6656 head_norm=1.485649
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.181818e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.9994 head_norm=1.498584 delta_norm=0.318182
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.398379 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.108242 metrics={'f1_val': 0.26412092283214, 'auprc': 0.26412092283214, 'loss_val': 1.5407981876674133, 'psi': 0.26412092283214}-{'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 1.5899088736740714, 'psi': 0.24552398411243506}
[S3] START round=13 head_norm_before_train=1.444866 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.025159 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9424810540412234, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.992798340488412, 'psi': 0.0}
[S4] START round=13 head_norm_before_train=1.742116 (no previous merge yet)
[S4] round=13 local utility u=0.022803 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2275840897911394, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.273189580171038, 'psi': 0.3567939207526687}
[S5] START round=13 head_norm_before_train=1.419483 (no previous merge yet)
[S5] round=13 local utility u=1.000000 metrics={'f1_val': 0.8998525067076176, 'auprc': 0.8998525067076176, 'loss_val': 1.1476387271402972, 'psi': 0.8998525067076176}-{'f1_val': 0.3812083433627437, 'auprc': 0.3812083433627437, 'loss_val': 1.174879509260824, 'psi': 0.3812083433627437}
[S6] START round=13 head_norm_before_train=1.741375 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.024435890514414, 'psi': 0.02065167508031207}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 6.961473753619956, 'psi': 0.01954921803127875}
[S7] START round=13 head_norm_before_train=1.015265 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.019712 metrics={'f1_val': 0.0004189944134078212, 'auprc': 0.0004189944134078212, 'loss_val': 1.4321520143061843, 'psi': 0.0004189944134078212}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4678041930247987, 'psi': 0.0}
[S8] START round=13 head_norm_before_train=1.724770 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.055886 metrics={'f1_val': 0.31277895401587, 'auprc': 0.31277895401587, 'loss_val': 0.9342055465806494, 'psi': 0.31277895401587}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 0.9765235024696587, 'psi': 0.30506182380216385}
[S9] START round=13 head_norm_before_train=1.563251 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.22960873067613, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.155951319318485, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=0.996565 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.026451 metrics={'f1_val': 0.24958143984692657, 'auprc': 0.24958143984692657, 'loss_val': 1.795583681920345, 'psi': 0.2495814398469266}-{'f1_val': 0.24964114832535886, 'auprc': 0.24964114832535886, 'loss_val': 1.8490230050018337, 'psi': 0.24964114832535883}
[S11] START round=13 head_norm_before_train=1.534813 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.33294401619559294, 'auprc': 0.33294401619559294, 'loss_val': 2.0622710354242573, 'psi': 0.33294401619559294}-{'f1_val': 0.33294419799206165, 'auprc': 0.33294419799206165, 'loss_val': 1.8113702843037984, 'psi': 0.33294419799206165}
[S13] START round=13 head_norm_before_train=1.576971 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.181794947939502, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.058505731614174, 'psi': 0.3599362944611573}
[S14] START round=13 head_norm_before_train=1.468001 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.12081569834551752, 'auprc': 0.12081569834551752, 'loss_val': 4.693109526052497, 'psi': 0.12081569834551753}-{'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 4.497954826068212, 'psi': 0.13172448466566114}
[S15] START round=13 head_norm_before_train=1.498584 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.022922 metrics={'f1_val': 0.6660001945790885, 'auprc': 0.6660001945790885, 'loss_val': 0.6501162090457401, 'psi': 0.6660001945790885}-{'f1_val': 0.6656381676920641, 'auprc': 0.6656381676920641, 'loss_val': 0.6927015867930926, 'psi': 0.6656381676920641}
[S16] START round=13 head_norm_before_train=1.541268 (no previous merge yet)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 2.5681779561638023, 'psi': 0.08899598393574297}-{'f1_val': 0.09971509971509972, 'auprc': 0.09971509971509972, 'loss_val': 2.276951799546026, 'psi': 0.09971509971509972}
[S17] START round=13 head_norm_before_train=1.738407 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.20444073104100421, 'auprc': 0.20444073104100421, 'loss_val': 0.9932755251447061, 'psi': 0.20444073104100421}-{'f1_val': 0.20370676894079467, 'auprc': 0.20370676894079467, 'loss_val': 0.9750710945752593, 'psi': 0.20370676894079467}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39408
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:39411
[S2] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.4771
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.9747
[S10] RECEIVED delta(kind=head bytes=1801) from S15
[S10] cosine check vs S15: cos=0.7530
[S10] RECEIVED delta(kind=head bytes=1804) from S2
[S10] cosine check vs S2: cos=0.4464
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=-0.1519
[S9] DROPPED delta from S5 (cos=-0.1519 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S4
[S2] cosine check vs S4: cos=0.8944
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.0000 head_norm=1.473363
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.370691e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.614927 delta_norm=0.237069
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.0004 head_norm=1.040950
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.452896e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.0962 head_norm=0.915878 delta_norm=0.545290
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.2641 head_norm=1.468309
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.988226e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.2651 head_norm=1.574292 delta_norm=0.398823
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.2496 head_norm=1.090307
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.209029e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.3328 head_norm=1.047592 delta_norm=0.320903
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.574292 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.2568725226953075, 'auprc': 0.2568725226953075, 'loss_val': 1.5201459676900237, 'psi': 0.2568725226953075}-{'f1_val': 0.26412092283214, 'auprc': 0.26412092283214, 'loss_val': 1.5407981876674133, 'psi': 0.26412092283214}
[S3] START round=14 head_norm_before_train=1.614927 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.009461 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9235596630713485, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9424810540412234, 'psi': 0.0}
[S4] START round=14 head_norm_before_train=1.766063 (no previous merge yet)
[S4] round=14 local utility u=0.016805 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1939732244874617, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2275840897911394, 'psi': 0.3567939207526687}
[S5] START round=14 head_norm_before_train=1.450867 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.6646782883580474, 'auprc': 0.6646782883580474, 'loss_val': 1.128072007596193, 'psi': 0.6646782883580474}-{'f1_val': 0.8998525067076176, 'auprc': 0.8998525067076176, 'loss_val': 1.1476387271402972, 'psi': 0.8998525067076176}
[S6] START round=14 head_norm_before_train=1.761804 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.1624299291878, 'psi': 0.02065167508031207}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.024435890514414, 'psi': 0.02065167508031207}
[S7] START round=14 head_norm_before_train=0.915878 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=1.000000 metrics={'f1_val': 0.2295142071494042, 'auprc': 0.2295142071494042, 'loss_val': 1.3715439594081758, 'psi': 0.22951420714940424}-{'f1_val': 0.0004189944134078212, 'auprc': 0.0004189944134078212, 'loss_val': 1.4321520143061843, 'psi': 0.0004189944134078212}
[S8] START round=14 head_norm_before_train=1.776959 cos_to_last_merge=0.9975 (last merge round=12)
[S8] round=14 local utility u=1.000000 metrics={'f1_val': 0.663974770442337, 'auprc': 0.663974770442337, 'loss_val': 0.881257383591757, 'psi': 0.663974770442337}-{'f1_val': 0.31277895401587, 'auprc': 0.31277895401587, 'loss_val': 0.9342055465806494, 'psi': 0.31277895401587}
[S9] START round=14 head_norm_before_train=1.596201 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.247282436476735, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.22960873067613, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.047592 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.068048 metrics={'f1_val': 0.24958163997131247, 'auprc': 0.24958163997131247, 'loss_val': 1.6594886243982048, 'psi': 0.24958163997131244}-{'f1_val': 0.24958143984692657, 'auprc': 0.24958143984692657, 'loss_val': 1.795583681920345, 'psi': 0.2495814398469266}
[S11] START round=14 head_norm_before_train=1.572717 (no previous merge yet)
[S11] round=14 local utility u=0.013562 metrics={'f1_val': 0.3242424242424243, 'auprc': 0.3242424242424243, 'loss_val': 1.9568336331001106, 'psi': 0.3242424242424243}-{'f1_val': 0.33294401619559294, 'auprc': 0.33294401619559294, 'loss_val': 2.0622710354242573, 'psi': 0.33294401619559294}
[S13] START round=14 head_norm_before_train=1.610391 (no previous merge yet)
[S13] round=14 local utility u=0.081646 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0185029771114138, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.181794947939502, 'psi': 0.3599362944611573}
[S14] START round=14 head_norm_before_train=1.504607 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.08714596949891068, 'auprc': 0.08714596949891068, 'loss_val': 4.8300623106917495, 'psi': 0.08714596949891068}-{'f1_val': 0.12081569834551752, 'auprc': 0.12081569834551752, 'loss_val': 4.693109526052497, 'psi': 0.12081569834551753}
[S15] START round=14 head_norm_before_train=1.552095 cos_to_last_merge=0.9975 (last merge round=12)
[S15] round=14 local utility u=1.000000 metrics={'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.547526778867731, 'psi': 0.9988780126706549}-{'f1_val': 0.6660001945790885, 'auprc': 0.6660001945790885, 'loss_val': 0.6501162090457401, 'psi': 0.6660001945790885}
[S16] START round=14 head_norm_before_train=1.572444 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.08955223880597014, 'auprc': 0.08955223880597014, 'loss_val': 2.765256289609911, 'psi': 0.08955223880597014}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 2.5681779561638023, 'psi': 0.08899598393574297}
[S17] START round=14 head_norm_before_train=1.774802 (no previous merge yet)
[S17] round=14 local utility u=0.289593 metrics={'f1_val': 0.2629154033648416, 'auprc': 0.2629154033648416, 'loss_val': 0.9403610399093084, 'psi': 0.2629154033648416}-{'f1_val': 0.20444073104100421, 'auprc': 0.20444073104100421, 'loss_val': 0.9932755251447061, 'psi': 0.20444073104100421}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39403
[S3] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:39411
[S15] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=0.8142
[S10] RECEIVED delta(kind=head bytes=1805) from S15
[S10] cosine check vs S15: cos=0.7586
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.9907
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] cosine check vs S7: cos=0.6375
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=0.9418
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] cosine check vs S11: cos=0.5068
[S15] RECEIVED delta(kind=head bytes=1799) from S13
[S15] cosine check vs S13: cos=0.9473
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.9720
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.0000 head_norm=1.643031
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.490300e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.729872 delta_norm=0.149030
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.2569 head_norm=1.647189
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.028757e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.2551 head_norm=1.696903 delta_norm=0.302876
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.2295 head_norm=0.950508
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.529370e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.1593 head_norm=0.939857 delta_norm=0.252937
[S7] aggregate: ROLLBACK (f1_val pre=0.230 post=0.159 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.2496 head_norm=1.118775
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.259386e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.2496 head_norm=1.280845 delta_norm=0.525939
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.6640 head_norm=1.824769
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.153948e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9997 head_norm=1.805454 delta_norm=0.215395
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.9989 head_norm=1.607076
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.309258e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6657 head_norm=1.357314 delta_norm=0.330926
[S15] aggregate: ROLLBACK (f1_val pre=0.999 post=0.666 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.696903 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.6230648634394498, 'psi': 0.2653978324081417}-{'f1_val': 0.2568725226953075, 'auprc': 0.2568725226953075, 'loss_val': 1.5201459676900237, 'psi': 0.2568725226953075}
[S3] START round=15 head_norm_before_train=1.729872 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.571622 metrics={'f1_val': 0.13370399788191686, 'auprc': 0.13370399788191686, 'loss_val': 1.9836512330036737, 'psi': 0.13370399788191686}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9235596630713485, 'psi': 0.0}
[S4] START round=15 head_norm_before_train=1.796996 (no previous merge yet)
[S4] round=15 local utility u=0.006918 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.18013742277473, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1939732244874617, 'psi': 0.3567939207526687}
[S5] START round=15 head_norm_before_train=1.482759 (no previous merge yet)
[S5] round=15 local utility u=0.004372 metrics={'f1_val': 0.6642273836037756, 'auprc': 0.6642273836037756, 'loss_val': 1.1152693092294195, 'psi': 0.6642273836037756}-{'f1_val': 0.6646782883580474, 'auprc': 0.6646782883580474, 'loss_val': 1.128072007596193, 'psi': 0.6646782883580474}
[S6] START round=15 head_norm_before_train=1.779996 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.319405997407979, 'psi': 0.01954921803127875}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.1624299291878, 'psi': 0.02065167508031207}
[S7] START round=15 head_norm_before_train=0.939857 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.598127 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3475352665915428, 'psi': 0.35976373724718097}-{'f1_val': 0.2295142071494042, 'auprc': 0.2295142071494042, 'loss_val': 1.3715439594081758, 'psi': 0.22951420714940424}
[S8] START round=15 head_norm_before_train=1.805454 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8838508035069385, 'psi': 0.35939447907390915}-{'f1_val': 0.663974770442337, 'auprc': 0.663974770442337, 'loss_val': 0.881257383591757, 'psi': 0.663974770442337}
[S9] START round=15 head_norm_before_train=1.626240 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.330613525814078, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.247282436476735, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.280845 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.032815 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 1.593320228253443, 'psi': 0.24952175992348158}-{'f1_val': 0.24958163997131247, 'auprc': 0.24958163997131247, 'loss_val': 1.6594886243982048, 'psi': 0.24958163997131244}
[S11] START round=15 head_norm_before_train=1.604433 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.2958203799654577, 'auprc': 0.2958203799654577, 'loss_val': 1.9507128755519598, 'psi': 0.2958203799654577}-{'f1_val': 0.3242424242424243, 'auprc': 0.3242424242424243, 'loss_val': 1.9568336331001106, 'psi': 0.3242424242424243}
[S13] START round=15 head_norm_before_train=1.636761 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0600476293962828, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0185029771114138, 'psi': 0.3599362944611573}
[S14] START round=15 head_norm_before_train=1.541028 (no previous merge yet)
[S14] round=15 local utility u=0.285728 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.696721728733276, 'psi': 0.13582554517133957}-{'f1_val': 0.08714596949891068, 'auprc': 0.08714596949891068, 'loss_val': 4.8300623106917495, 'psi': 0.08714596949891068}
[S15] START round=15 head_norm_before_train=1.357314 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.016200 metrics={'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.5151259418345395, 'psi': 0.9988780126706549}-{'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.547526778867731, 'psi': 0.9988780126706549}
[S16] START round=15 head_norm_before_train=1.604662 (no previous merge yet)
[S16] round=15 local utility u=0.295165 metrics={'f1_val': 0.1434066332825314, 'auprc': 0.1434066332825314, 'loss_val': 2.6596159665665904, 'psi': 0.1434066332825314}-{'f1_val': 0.08955223880597014, 'auprc': 0.08955223880597014, 'loss_val': 2.765256289609911, 'psi': 0.08955223880597014}
[S17] START round=15 head_norm_before_train=1.811723 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.26098824904622037, 'auprc': 0.26098824904622037, 'loss_val': 1.0225256471592243, 'psi': 0.26098824904622037}-{'f1_val': 0.2629154033648416, 'auprc': 0.2629154033648416, 'loss_val': 0.9403610399093084, 'psi': 0.2629154033648416}
[S16] not sending this round → trigger blocked (psi=0.143)
[S14] not sending this round → trigger blocked (psi=0.136)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39415
[S3] not sending this round → trigger blocked (psi=0.134)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39402
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:39410
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.7008
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] cosine check vs S15: cos=0.9617
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=-0.1491
[S9] DROPPED delta from S5 (cos=-0.1491 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=0.9616
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] cosine check vs S7: cos=0.6547
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.179 → S15@127.0.0.1:39415
[S11] ⇄ pheromone p=0.183 → S7@127.0.0.1:39408
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.2654 head_norm=1.766516
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.502447e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.2655 head_norm=1.777073 delta_norm=0.250245
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.174 → S10@127.0.0.1:39411
[S9] ⇄ pheromone p=0.171 → S3@127.0.0.1:39403
[S8] ⇄ pheromone p=0.251 → S3@127.0.0.1:39403
[S13] ⇄ pheromone p=0.137 → S15@127.0.0.1:39415
[S14] ⇄ pheromone p=0.137 → S6@127.0.0.1:39407
[S6] ⇄ pheromone p=0.052 → S8@127.0.0.1:39409
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.2495 head_norm=1.333866
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.969541e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.2495 head_norm=1.368506 delta_norm=0.196954
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.119 → S7@127.0.0.1:39408
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.3598 head_norm=0.975664
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.761866e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.3598 head_norm=1.067148 delta_norm=0.476187
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.334 → S15@127.0.0.1:39415
[S5] ⇄ pheromone p=0.294 → S9@127.0.0.1:39410
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.9989 head_norm=1.429686
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.407109e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6640 head_norm=1.097995 delta_norm=0.540711
[S15] aggregate: ROLLBACK (f1_val pre=0.999 post=0.664 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.395 → S10@127.0.0.1:39411
[S4] ⇄ pheromone p=0.188 → S2@127.0.0.1:39402
[S16] ⇄ pheromone p=0.184 → S6@127.0.0.1:39407
[S17] ⇄ pheromone p=0.129 → S8@127.0.0.1:39409
[S2] START round=16 head_norm_before_train=1.777073 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.018012 metrics={'f1_val': 0.25706973768394115, 'auprc': 0.25706973768394115, 'loss_val': 1.5120885016798233, 'psi': 0.25706973768394115}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 1.6230648634394498, 'psi': 0.2653978324081417}
[S3] START round=16 head_norm_before_train=1.757661 cos_to_last_merge=0.9992 (last merge round=14)
[S3] round=16 local utility u=0.697227 metrics={'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.065521212756614, 'psi': 0.29773995791014735}-{'f1_val': 0.13370399788191686, 'auprc': 0.13370399788191686, 'loss_val': 1.9836512330036737, 'psi': 0.13370399788191686}
[S4] START round=16 head_norm_before_train=1.822263 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.18147719052434, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.18013742277473, 'psi': 0.3567939207526687}
[S5] START round=16 head_norm_before_train=1.513393 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.4405955190739103, 'auprc': 0.4405955190739103, 'loss_val': 1.1391936104095928, 'psi': 0.44059551907391026}-{'f1_val': 0.6642273836037756, 'auprc': 0.6642273836037756, 'loss_val': 1.1152693092294195, 'psi': 0.6642273836037756}
[S6] START round=16 head_norm_before_train=1.796674 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 7.362503036801473, 'psi': 0.020431588613406795}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.319405997407979, 'psi': 0.01954921803127875}
[S7] START round=16 head_norm_before_train=1.067148 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.003866 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.33980306868473, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3475352665915428, 'psi': 0.35976373724718097}
[S8] START round=16 head_norm_before_train=1.852853 cos_to_last_merge=0.9986 (last merge round=14)
[S8] round=16 local utility u=0.007036 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8697778776589473, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8838508035069385, 'psi': 0.35939447907390915}
[S9] START round=16 head_norm_before_train=1.653096 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4157215468863207, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.330613525814078, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.368506 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.358711 metrics={'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 1.6251827029399348, 'psi': 0.33277551996175}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 1.593320228253443, 'psi': 0.24952175992348158}
[S11] START round=16 head_norm_before_train=1.628899 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.24827506232968052, 'auprc': 0.24827506232968052, 'loss_val': 1.6280445589688586, 'psi': 0.24827506232968052}-{'f1_val': 0.2958203799654577, 'auprc': 0.2958203799654577, 'loss_val': 1.9507128755519598, 'psi': 0.2958203799654577}
[S13] START round=16 head_norm_before_train=1.658155 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2755086505690956, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0600476293962828, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.576683 (no previous merge yet)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.869456363435887, 'psi': 0.13592717296421}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.696721728733276, 'psi': 0.13582554517133957}
[S15] START round=16 head_norm_before_train=1.097995 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.001357 metrics={'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.5124114474866244, 'psi': 0.9988780126706549}-{'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.5151259418345395, 'psi': 0.9988780126706549}
[S16] START round=16 head_norm_before_train=1.634722 (no previous merge yet)
[S16] round=16 local utility u=0.265601 metrics={'f1_val': 0.1833534378769602, 'auprc': 0.1833534378769602, 'loss_val': 2.487935105639942, 'psi': 0.1833534378769602}-{'f1_val': 0.1434066332825314, 'auprc': 0.1434066332825314, 'loss_val': 2.6596159665665904, 'psi': 0.1434066332825314}
[S17] START round=16 head_norm_before_train=1.847345 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.25432288267898256, 'auprc': 0.25432288267898256, 'loss_val': 1.085715601288354, 'psi': 0.25432288267898256}-{'f1_val': 0.26098824904622037, 'auprc': 0.26098824904622037, 'loss_val': 1.0225256471592243, 'psi': 0.26098824904622037}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39415
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39411
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.183)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S2
[S10] cosine check vs S2: cos=0.1710
[S10] RECEIVED delta(kind=head bytes=1804) from S15
[S10] cosine check vs S15: cos=0.9552
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.9891
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=0.9745
[S15] RECEIVED delta(kind=head bytes=1803) from S3
[S15] cosine check vs S3: cos=-0.0215
[S15] DROPPED delta from S3 (cos=-0.0215 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=0.9385
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.3328 head_norm=1.418112
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.719463e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.3328 head_norm=1.164298 delta_norm=0.571946
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.9989 head_norm=1.188875
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.369129e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.9989 head_norm=1.135153 delta_norm=0.136913
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.3598 head_norm=1.095998
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.715043e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.3598 head_norm=1.237906 delta_norm=0.271504
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.2977 head_norm=1.783119
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.470679e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.2968 head_norm=1.834751 delta_norm=0.147068
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.840942 cos_to_last_merge=0.9956 (last merge round=15)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 1.771813287713005, 'psi': 0.2654773703336637}-{'f1_val': 0.25706973768394115, 'auprc': 0.25706973768394115, 'loss_val': 1.5120885016798233, 'psi': 0.25706973768394115}
[S3] START round=17 head_norm_before_train=1.834751 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.22329030486130183, 'auprc': 0.22329030486130183, 'loss_val': 2.0095103306534474, 'psi': 0.22329030486130183}-{'f1_val': 0.29773995791014735, 'auprc': 0.29773995791014735, 'loss_val': 2.065521212756614, 'psi': 0.29773995791014735}
[S4] START round=17 head_norm_before_train=1.835578 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1832602398415077, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.18147719052434, 'psi': 0.3567939207526687}
[S5] START round=17 head_norm_before_train=1.545130 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.33493014743065364, 'auprc': 0.33493014743065364, 'loss_val': 1.4802488929333293, 'psi': 0.33493014743065364}-{'f1_val': 0.4405955190739103, 'auprc': 0.4405955190739103, 'loss_val': 1.1391936104095928, 'psi': 0.44059551907391026}
[S6] START round=17 head_norm_before_train=1.812336 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.489960231502689, 'psi': 0.01954921803127875}-{'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 7.362503036801473, 'psi': 0.020431588613406795}
[S7] START round=17 head_norm_before_train=1.237906 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.1494975782548977, 'auprc': 0.1494975782548977, 'loss_val': 1.363475306312435, 'psi': 0.1494975782548977}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.33980306868473, 'psi': 0.35976373724718097}
[S8] START round=17 head_norm_before_train=1.896410 cos_to_last_merge=0.9958 (last merge round=14)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8713568670788266, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8697778776589473, 'psi': 0.35939447907390915}
[S9] START round=17 head_norm_before_train=1.675793 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.48460840331735, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4157215468863207, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.164298 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.030389 metrics={'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 1.564404323390628, 'psi': 0.33277551996175}-{'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 1.6251827029399348, 'psi': 0.33277551996175}
[S11] START round=17 head_norm_before_train=1.650554 (no previous merge yet)
[S11] round=17 local utility u=0.000492 metrics={'f1_val': 0.26991931417044884, 'auprc': 0.26991931417044884, 'loss_val': 1.821859749366969, 'psi': 0.26991931417044884}-{'f1_val': 0.24827506232968052, 'auprc': 0.24827506232968052, 'loss_val': 1.6280445589688586, 'psi': 0.24827506232968052}
[S13] START round=17 head_norm_before_train=1.685763 (no previous merge yet)
[S13] round=17 local utility u=0.046252 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1830047703667088, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2755086505690956, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=1.608676 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 5.071490156801966, 'psi': 0.1347331583552056}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.869456363435887, 'psi': 0.13592717296421}
[S15] START round=17 head_norm_before_train=1.135153 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6660001945790885, 'auprc': 0.6660001945790885, 'loss_val': 0.45365633566481306, 'psi': 0.6660001945790885}-{'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.5124114474866244, 'psi': 0.9988780126706549}
[S16] START round=17 head_norm_before_train=1.662664 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.14499674408508792, 'auprc': 0.14499674408508792, 'loss_val': 2.9557714185076316, 'psi': 0.14499674408508792}-{'f1_val': 0.1833534378769602, 'auprc': 0.1833534378769602, 'loss_val': 2.487935105639942, 'psi': 0.1833534378769602}
[S17] START round=17 head_norm_before_train=1.883604 (no previous merge yet)
[S17] round=17 local utility u=0.369074 metrics={'f1_val': 0.35063770414427076, 'auprc': 0.35063770414427076, 'loss_val': 1.2144008592049902, 'psi': 0.35063770414427076}-{'f1_val': 0.25432288267898256, 'auprc': 0.25432288267898256, 'loss_val': 1.085715601288354, 'psi': 0.25432288267898256}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39408
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S13
[S15] cosine check vs S13: cos=0.7697
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.9392
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=0.2231
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9692
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.3594 head_norm=1.933622
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.391924e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.3594 head_norm=1.910973 delta_norm=0.239192
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.6660 head_norm=1.216379
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.453675e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.9989 head_norm=1.375130 delta_norm=0.545368
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.1495 head_norm=1.261356
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.669098e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.1522 head_norm=1.084827 delta_norm=0.466910
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.899813 cos_to_last_merge=0.9882 (last merge round=15)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 1.8723932959625145, 'psi': 0.2654773703336637}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 1.771813287713005, 'psi': 0.2654773703336637}
[S3] START round=18 head_norm_before_train=1.855505 cos_to_last_merge=0.9997 (last merge round=16)
[S3] round=18 local utility u=0.180702 metrics={'f1_val': 0.258047967166859, 'auprc': 0.258047967166859, 'loss_val': 1.9609257301143235, 'psi': 0.258047967166859}-{'f1_val': 0.22329030486130183, 'auprc': 0.22329030486130183, 'loss_val': 2.0095103306534474, 'psi': 0.22329030486130183}
[S4] START round=18 head_norm_before_train=1.854494 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1923922384771732, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1832602398415077, 'psi': 0.3567939207526687}
[S5] START round=18 head_norm_before_train=1.574735 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 2.2255454833224455, 'psi': 0.33451196111837667}-{'f1_val': 0.33493014743065364, 'auprc': 0.33493014743065364, 'loss_val': 1.4802488929333293, 'psi': 0.33493014743065364}
[S6] START round=18 head_norm_before_train=1.826620 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 7.566478428514204, 'psi': 0.01999080882352941}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.489960231502689, 'psi': 0.01954921803127875}
[S7] START round=18 head_norm_before_train=1.084827 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.002229033156868208, 'auprc': 0.002229033156868208, 'loss_val': 1.3737999715587779, 'psi': 0.002229033156868208}-{'f1_val': 0.1494975782548977, 'auprc': 0.1494975782548977, 'loss_val': 1.363475306312435, 'psi': 0.1494975782548977}
[S8] START round=18 head_norm_before_train=1.910973 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9096877007020886, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8713568670788266, 'psi': 0.35939447907390915}
[S9] START round=18 head_norm_before_train=1.695277 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.541914275104511, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.48460840331735, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.221560 cos_to_last_merge=0.9967 (last merge round=16)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.7367864255174195, 'psi': 0.24958183990442054}-{'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 1.564404323390628, 'psi': 0.33277551996175}
[S11] START round=18 head_norm_before_train=1.672389 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.24966474258060756, 'auprc': 0.24966474258060756, 'loss_val': 1.7735283556621437, 'psi': 0.24966474258060756}-{'f1_val': 0.26991931417044884, 'auprc': 0.26991931417044884, 'loss_val': 1.821859749366969, 'psi': 0.26991931417044884}
[S13] START round=18 head_norm_before_train=1.702128 (no previous merge yet)
[S13] round=18 local utility u=0.090620 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0017643513588652, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1830047703667088, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.636252 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.1290893015030946, 'auprc': 0.1290893015030946, 'loss_val': 5.213243583496159, 'psi': 0.1290893015030946}-{'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 5.071490156801966, 'psi': 0.1347331583552056}
[S15] START round=18 head_norm_before_train=1.375130 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=1.000000 metrics={'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.3593171773553305, 'psi': 0.9988780126706549}-{'f1_val': 0.6660001945790885, 'auprc': 0.6660001945790885, 'loss_val': 0.45365633566481306, 'psi': 0.6660001945790885}
[S16] START round=18 head_norm_before_train=1.686833 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.0899687274476786, 'auprc': 0.0899687274476786, 'loss_val': 3.596122320778823, 'psi': 0.0899687274476786}-{'f1_val': 0.14499674408508792, 'auprc': 0.14499674408508792, 'loss_val': 2.9557714185076316, 'psi': 0.14499674408508792}
[S17] START round=18 head_norm_before_train=1.918116 (no previous merge yet)
[S17] round=18 local utility u=0.230954 metrics={'f1_val': 0.40037125303281806, 'auprc': 0.40037125303281806, 'loss_val': 1.2000941238537841, 'psi': 0.40037125303281806}-{'f1_val': 0.35063770414427076, 'auprc': 0.35063770414427076, 'loss_val': 1.2144008592049902, 'psi': 0.35063770414427076}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39411
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S13
[S15] cosine check vs S13: cos=0.9409
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] cosine check vs S15: cos=0.8632
[S15] RECEIVED delta(kind=head bytes=1801) from S3
[S15] cosine check vs S3: cos=-0.0620
[S15] DROPPED delta from S3 (cos=-0.0620 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.9872
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.2496 head_norm=1.296748
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.671491e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.2496 head_norm=1.326531 delta_norm=0.367149
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.3594 head_norm=1.948331
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.557585e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.3594 head_norm=1.939437 delta_norm=0.155759
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.9989 head_norm=1.451691
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.030951e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.9989 head_norm=1.562490 delta_norm=0.303095
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.942320 cos_to_last_merge=0.9823 (last merge round=15)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.2622142238219023, 'auprc': 0.2622142238219023, 'loss_val': 2.08838560954561, 'psi': 0.2622142238219023}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 1.8723932959625145, 'psi': 0.2654773703336637}
[S3] START round=19 head_norm_before_train=1.876197 cos_to_last_merge=0.9989 (last merge round=16)
[S3] round=19 local utility u=0.121521 metrics={'f1_val': 0.2975342465753425, 'auprc': 0.2975342465753425, 'loss_val': 2.0732607709996684, 'psi': 0.2975342465753425}-{'f1_val': 0.258047967166859, 'auprc': 0.258047967166859, 'loss_val': 1.9609257301143235, 'psi': 0.258047967166859}
[S4] START round=19 head_norm_before_train=1.873643 (no previous merge yet)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2091350258062197, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1923922384771732, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.604291 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.7175422728009395, 'psi': 0.33358943696313936}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 2.2255454833224455, 'psi': 0.33451196111837667}
[S6] START round=19 head_norm_before_train=1.839953 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 7.620698238106173, 'psi': 0.020431588613406795}-{'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 7.566478428514204, 'psi': 0.01999080882352941}
[S7] START round=19 head_norm_before_train=1.109111 cos_to_last_merge=0.9988 (last merge round=17)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.0005586592178770949, 'auprc': 0.0005586592178770949, 'loss_val': 1.3774100675143521, 'psi': 0.0005586592178770949}-{'f1_val': 0.002229033156868208, 'auprc': 0.002229033156868208, 'loss_val': 1.3737999715587779, 'psi': 0.002229033156868208}
[S8] START round=19 head_norm_before_train=1.939437 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9470505017849327, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9096877007020886, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.712490 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.585858751332171, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.541914275104511, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.326531 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.096459 metrics={'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 1.5444062783160006, 'psi': 0.24964166268514096}-{'f1_val': 0.24958183990442054, 'auprc': 0.24958183990442054, 'loss_val': 1.7367864255174195, 'psi': 0.24958183990442054}
[S11] START round=19 head_norm_before_train=1.691538 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.29525386313465785, 'auprc': 0.29525386313465785, 'loss_val': 2.334232139380991, 'psi': 0.29525386313465785}-{'f1_val': 0.24966474258060756, 'auprc': 0.24966474258060756, 'loss_val': 1.7735283556621437, 'psi': 0.24966474258060756}
[S13] START round=19 head_norm_before_train=1.720196 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3205829396463398, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0017643513588652, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.660756 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.11336453458138325, 'auprc': 0.11336453458138325, 'loss_val': 5.339263271822671, 'psi': 0.11336453458138325}-{'f1_val': 0.1290893015030946, 'auprc': 0.1290893015030946, 'loss_val': 5.213243583496159, 'psi': 0.1290893015030946}
[S15] START round=19 head_norm_before_train=1.562490 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6415693956476863, 'auprc': 0.6415693956476863, 'loss_val': 0.3019976014681885, 'psi': 0.6415693956476863}-{'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.3593171773553305, 'psi': 0.9988780126706549}
[S16] START round=19 head_norm_before_train=1.707501 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.09024605273703613, 'auprc': 0.09024605273703613, 'loss_val': 3.6665665346668406, 'psi': 0.09024605273703613}-{'f1_val': 0.0899687274476786, 'auprc': 0.0899687274476786, 'loss_val': 3.596122320778823, 'psi': 0.0899687274476786}
[S17] START round=19 head_norm_before_train=1.943028 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.31475018141724603, 'auprc': 0.31475018141724603, 'loss_val': 1.4102106011914253, 'psi': 0.31475018141724603}-{'f1_val': 0.40037125303281806, 'auprc': 0.40037125303281806, 'loss_val': 1.2000941238537841, 'psi': 0.40037125303281806}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:39415
[S3] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S3
[S15] cosine check vs S3: cos=-0.0734
[S15] DROPPED delta from S3 (cos=-0.0734 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.8959
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.0006 head_norm=1.139759
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.144829e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.0490 head_norm=1.234001 delta_norm=0.314483
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.001 u=0.0000 p_local=0.1370 f1=0.001 auprc=0.001 bytes=5400
[S15] r=20 psi=0.642 u=0.0000 p_local=0.3221 f1=0.642 auprc=0.642 bytes=21590
[S13] r=20 psi=0.360 u=0.0000 p_local=0.0767 f1=0.360 auprc=0.360 bytes=12596
[S2] r=20 psi=0.262 u=0.0000 p_local=0.0733 f1=0.262 auprc=0.262 bytes=7205
[S4] r=20 psi=0.357 u=0.0000 p_local=0.0768 f1=0.357 auprc=0.357 bytes=9006
[S8] r=20 psi=0.359 u=0.0000 p_local=0.1035 f1=0.359 auprc=0.359 bytes=18003
[S5] r=20 psi=0.334 u=0.0000 p_local=0.1203 f1=0.334 auprc=0.334 bytes=8997
[S6] r=20 psi=0.020 u=0.0000 p_local=0.0214 f1=0.020 auprc=0.020 bytes=0
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0701 f1=0.369 auprc=0.369 bytes=1799
[S14] r=20 psi=0.113 u=0.0000 p_local=0.0562 f1=0.113 auprc=0.113 bytes=0
[S11] r=20 psi=0.295 u=0.0000 p_local=0.0751 f1=0.295 auprc=0.295 bytes=5397
[S10] r=20 psi=0.250 u=0.0965 p_local=0.1085 f1=0.250 auprc=0.250 bytes=21609
[S3] r=20 psi=0.298 u=0.1215 p_local=0.1980 f1=0.298 auprc=0.298 bytes=5408
[S17] r=20 psi=0.315 u=0.0000 p_local=0.1371 f1=0.315 auprc=0.315 bytes=17995
[S16] r=20 psi=0.090 u=0.0000 p_local=0.1026 f1=0.090 auprc=0.090 bytes=0
[S2] START round=20 head_norm_before_train=1.972256 cos_to_last_merge=0.9782 (last merge round=15)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 1.9875780657662085, 'psi': 0.24543399914482925}-{'f1_val': 0.2622142238219023, 'auprc': 0.2622142238219023, 'loss_val': 2.08838560954561, 'psi': 0.2622142238219023}
[S3] START round=20 head_norm_before_train=1.891350 cos_to_last_merge=0.9981 (last merge round=16)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.2800959232613909, 'auprc': 0.2800959232613909, 'loss_val': 2.4209486446346626, 'psi': 0.2800959232613909}-{'f1_val': 0.2975342465753425, 'auprc': 0.2975342465753425, 'loss_val': 2.0732607709996684, 'psi': 0.2975342465753425}
[S4] START round=20 head_norm_before_train=1.894447 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2252584964482125, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2091350258062197, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.633841 (no previous merge yet)
[S5] round=20 local utility u=0.006488 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.7083498093434204, 'psi': 0.33400978131092857}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.7175422728009395, 'psi': 0.33358943696313936}
[S6] START round=20 head_norm_before_train=1.852200 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.713629498266198, 'psi': 0.01954921803127875}-{'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 7.620698238106173, 'psi': 0.020431588613406795}
[S7] START round=20 head_norm_before_train=1.234001 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.001985 metrics={'f1_val': 0.0007446709485246206, 'auprc': 0.0007446709485246206, 'loss_val': 1.375113980863133, 'psi': 0.0007446709485246206}-{'f1_val': 0.0005586592178770949, 'auprc': 0.0005586592178770949, 'loss_val': 1.3774100675143521, 'psi': 0.0005586592178770949}
[S8] START round=20 head_norm_before_train=1.976685 cos_to_last_merge=0.9992 (last merge round=18)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0316743332303704, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9470505017849327, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.727538 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6195727957050856, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.585858751332171, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.394369 cos_to_last_merge=0.9976 (last merge round=18)
[S10] round=20 local utility u=0.353354 metrics={'f1_val': 0.3027189690194654, 'auprc': 0.3027189690194654, 'loss_val': 1.3153938652607822, 'psi': 0.3027189690194654}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 1.5444062783160006, 'psi': 0.24964166268514096}
[S11] START round=20 head_norm_before_train=1.707044 (no previous merge yet)
[S11] round=20 local utility u=0.022131 metrics={'f1_val': 0.26550099206349204, 'auprc': 0.26550099206349204, 'loss_val': 2.022194470155421, 'psi': 0.26550099206349204}-{'f1_val': 0.29525386313465785, 'auprc': 0.29525386313465785, 'loss_val': 2.334232139380991, 'psi': 0.29525386313465785}
[S13] START round=20 head_norm_before_train=1.732574 (no previous merge yet)
[S13] round=20 local utility u=0.014579 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2914250678665224, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3205829396463398, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.682542 (no previous merge yet)
[S14] round=20 local utility u=0.078829 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.359519656759966, 'psi': 0.1331327566754419}-{'f1_val': 0.11336453458138325, 'auprc': 0.11336453458138325, 'loss_val': 5.339263271822671, 'psi': 0.11336453458138325}
[S15] START round=20 head_norm_before_train=1.641880 cos_to_last_merge=0.9942 (last merge round=18)
[S15] round=20 local utility u=0.065387 metrics={'f1_val': 0.6502255588727567, 'auprc': 0.6502255588727567, 'loss_val': 0.24913002680925309, 'psi': 0.6502255588727567}-{'f1_val': 0.6415693956476863, 'auprc': 0.6415693956476863, 'loss_val': 0.3019976014681885, 'psi': 0.6415693956476863}
[S16] START round=20 head_norm_before_train=1.725705 (no previous merge yet)
[S16] round=20 local utility u=0.387514 metrics={'f1_val': 0.14011993564428843, 'auprc': 0.14011993564428843, 'loss_val': 3.340402665185237, 'psi': 0.14011993564428843}-{'f1_val': 0.09024605273703613, 'auprc': 0.09024605273703613, 'loss_val': 3.6665665346668406, 'psi': 0.09024605273703613}
[S17] START round=20 head_norm_before_train=1.966565 (no previous merge yet)
[S17] round=20 local utility u=0.375223 metrics={'f1_val': 0.34891201718833037, 'auprc': 0.34891201718833037, 'loss_val': 0.9672201675421499, 'psi': 0.34891201718833037}-{'f1_val': 0.31475018141724603, 'auprc': 0.31475018141724603, 'loss_val': 1.4102106011914253, 'psi': 0.31475018141724603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S11] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:39408
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[S14] not sending this round → trigger blocked (psi=0.133)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.001)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:39410
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.140)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1808 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] cosine check vs S15: cos=0.9174
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=-0.1456
[S9] DROPPED delta from S5 (cos=-0.1456 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.9735
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] cosine check vs S13: cos=0.9507
[S7] RECEIVED delta(kind=head bytes=1808) from S11
[S7] cosine check vs S11: cos=0.3394
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.9872
[S14] ⇄ pheromone p=0.061 → S6@127.0.0.1:39407
[S3] ⇄ pheromone p=0.158 → S15@127.0.0.1:39415
[S6] ⇄ pheromone p=0.017 → S8@127.0.0.1:39409
[S4] ⇄ pheromone p=0.061 → S2@127.0.0.1:39402
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.3594 head_norm=2.017422
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.609597e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.3594 head_norm=1.994010 delta_norm=0.160960
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.083 → S3@127.0.0.1:39403
[S9] ⇄ pheromone p=0.056 → S3@127.0.0.1:39403
[S2] ⇄ pheromone p=0.059 → S10@127.0.0.1:39411
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.0007 head_norm=1.262681
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.613515e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.0070 head_norm=1.182497 delta_norm=0.361351
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.110 → S15@127.0.0.1:39415
[S16] ⇄ pheromone p=0.160 → S6@127.0.0.1:39407
[S11] ⇄ pheromone p=0.065 → S7@127.0.0.1:39408
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.3027 head_norm=1.462871
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.457097e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.3178 head_norm=1.556089 delta_norm=0.345710
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.157 → S7@127.0.0.1:39408
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.6502 head_norm=1.715186
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.719230e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6524 head_norm=1.708226 delta_norm=0.271923
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.271 → S10@127.0.0.1:39411
[S5] ⇄ pheromone p=0.098 → S9@127.0.0.1:39410
[S13] ⇄ pheromone p=0.064 → S15@127.0.0.1:39415
[S17] ⇄ pheromone p=0.185 → S8@127.0.0.1:39409
[S2] START round=21 head_norm_before_train=1.995032 cos_to_last_merge=0.9753 (last merge round=15)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.1673701318978353, 'psi': 0.2653978324081417}-{'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 1.9875780657662085, 'psi': 0.24543399914482925}
[S3] START round=21 head_norm_before_train=1.907022 cos_to_last_merge=0.9971 (last merge round=16)
[S3] round=21 local utility u=0.223153 metrics={'f1_val': 0.29365079365079366, 'auprc': 0.29365079365079366, 'loss_val': 2.0966367040962273, 'psi': 0.29365079365079366}-{'f1_val': 0.2800959232613909, 'auprc': 0.2800959232613909, 'loss_val': 2.4209486446346626, 'psi': 0.2800959232613909}
[S4] START round=21 head_norm_before_train=1.916229 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.246574351349626, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2252584964482125, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.663518 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8357967771129853, 'psi': 0.3335071121394324}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.7083498093434204, 'psi': 0.33400978131092857}
[S6] START round=21 head_norm_before_train=1.863743 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 7.742746730464534, 'psi': 0.020431588613406795}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.713629498266198, 'psi': 0.01954921803127875}
[S7] START round=21 head_norm_before_train=1.182497 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.480296 metrics={'f1_val': 0.10583254938852305, 'auprc': 0.10583254938852305, 'loss_val': 1.36031264806007, 'psi': 0.10583254938852305}-{'f1_val': 0.0007446709485246206, 'auprc': 0.0007446709485246206, 'loss_val': 1.375113980863133, 'psi': 0.0007446709485246206}
[S8] START round=21 head_norm_before_train=1.994010 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0914149658057521, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0316743332303704, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.741018 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6469935547794314, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6195727957050856, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.556089 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.246879 metrics={'f1_val': 0.3229188341597422, 'auprc': 0.3229188341597422, 'loss_val': 1.003435446464951, 'psi': 0.3229188341597422}-{'f1_val': 0.3027189690194654, 'auprc': 0.3027189690194654, 'loss_val': 1.3153938652607822, 'psi': 0.3027189690194654}
[S11] START round=21 head_norm_before_train=1.720354 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.25597800095648016, 'auprc': 0.25597800095648016, 'loss_val': 2.0107692933628143, 'psi': 0.25597800095648016}-{'f1_val': 0.26550099206349204, 'auprc': 0.26550099206349204, 'loss_val': 2.022194470155421, 'psi': 0.26550099206349204}
[S13] START round=21 head_norm_before_train=1.744159 (no previous merge yet)
[S13] round=21 local utility u=0.116031 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0593635796634175, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2914250678665224, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.702020 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.443410079125674, 'psi': 0.13572854291417166}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.359519656759966, 'psi': 0.1331327566754419}
[S15] START round=21 head_norm_before_train=1.708226 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=1.000000 metrics={'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.16562557458054133, 'psi': 0.9988780126706549}-{'f1_val': 0.6502255588727567, 'auprc': 0.6502255588727567, 'loss_val': 0.24913002680925309, 'psi': 0.6502255588727567}
[S16] START round=21 head_norm_before_train=1.742182 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.13291796469366562, 'auprc': 0.13291796469366562, 'loss_val': 3.5534346847151483, 'psi': 0.13291796469366562}-{'f1_val': 0.14011993564428843, 'auprc': 0.14011993564428843, 'loss_val': 3.340402665185237, 'psi': 0.14011993564428843}
[S17] START round=21 head_norm_before_train=1.983425 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.3131206920684558, 'auprc': 0.3131206920684558, 'loss_val': 1.4964743898620114, 'psi': 0.3131206920684558}-{'f1_val': 0.34891201718833037, 'auprc': 0.34891201718833037, 'loss_val': 0.9672201675421499, 'psi': 0.34891201718833037}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39411
[S7] not sending this round → trigger blocked (psi=0.106)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:39415
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.8545
[S10] RECEIVED delta(kind=head bytes=1803) from S15
[S10] cosine check vs S15: cos=0.9534
[S15] RECEIVED delta(kind=head bytes=1804) from S13
[S15] cosine check vs S13: cos=0.9770
[S15] RECEIVED delta(kind=head bytes=1799) from S3
[S15] cosine check vs S3: cos=-0.0775
[S15] DROPPED delta from S3 (cos=-0.0775 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.1058 head_norm=1.204335
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.310716e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.1200 head_norm=1.362179 delta_norm=0.431072
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.3229 head_norm=1.622432
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.677060e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.3341 head_norm=1.673416 delta_norm=0.267706
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.9989 head_norm=1.763999
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.886775e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.9989 head_norm=1.749798 delta_norm=0.188678
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=2.012671 cos_to_last_merge=0.9731 (last merge round=15)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.0970290666417046, 'psi': 0.24552398411243506}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.1673701318978353, 'psi': 0.2653978324081417}
[S3] START round=22 head_norm_before_train=1.923483 cos_to_last_merge=0.9961 (last merge round=16)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.2609090319652467, 'auprc': 0.2609090319652467, 'loss_val': 2.1584215103805446, 'psi': 0.2609090319652467}-{'f1_val': 0.29365079365079366, 'auprc': 0.29365079365079366, 'loss_val': 2.0966367040962273, 'psi': 0.29365079365079366}
[S4] START round=22 head_norm_before_train=1.939109 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2734454528952863, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.246574351349626, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.694828 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8364137368055284, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8357967771129853, 'psi': 0.3335071121394324}
[S6] START round=22 head_norm_before_train=1.874888 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 7.810087329580312, 'psi': 0.020211299954065228}-{'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 7.742746730464534, 'psi': 0.020431588613406795}
[S7] START round=22 head_norm_before_train=1.362179 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.541639 metrics={'f1_val': 0.22193211488250653, 'auprc': 0.22193211488250653, 'loss_val': 1.321930682989461, 'psi': 0.22193211488250653}-{'f1_val': 0.10583254938852305, 'auprc': 0.10583254938852305, 'loss_val': 1.36031264806007, 'psi': 0.10583254938852305}
[S8] START round=22 head_norm_before_train=2.032256 cos_to_last_merge=0.9993 (last merge round=20)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1985442827477701, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0914149658057521, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.753114 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6882907434932775, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6469935547794314, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.673416 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.067702 metrics={'f1_val': 0.32882091327232876, 'auprc': 0.32882091327232876, 'loss_val': 0.9211502325270413, 'psi': 0.32882091327232876}-{'f1_val': 0.3229188341597422, 'auprc': 0.3229188341597422, 'loss_val': 1.003435446464951, 'psi': 0.3229188341597422}
[S11] START round=22 head_norm_before_train=1.729465 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.28030898140874577, 'auprc': 0.28030898140874577, 'loss_val': 2.2317409021440318, 'psi': 0.28030898140874577}-{'f1_val': 0.25597800095648016, 'auprc': 0.25597800095648016, 'loss_val': 2.0107692933628143, 'psi': 0.25597800095648016}
[S13] START round=22 head_norm_before_train=1.755873 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2326681976259584, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0593635796634175, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.718681 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.533811016500571, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.443410079125674, 'psi': 0.13572854291417166}
[S15] START round=22 head_norm_before_train=1.749798 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6514937638743481, 'auprc': 0.6514937638743481, 'loss_val': 0.170951712027625, 'psi': 0.6514937638743481}-{'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.16562557458054133, 'psi': 0.9988780126706549}
[S16] START round=22 head_norm_before_train=1.755302 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.13587076786899757, 'auprc': 0.13587076786899757, 'loss_val': 3.590093718431949, 'psi': 0.13587076786899757}-{'f1_val': 0.13291796469366562, 'auprc': 0.13291796469366562, 'loss_val': 3.5534346847151483, 'psi': 0.13291796469366562}
[S17] START round=22 head_norm_before_train=1.994180 (no previous merge yet)
[S17] round=22 local utility u=1.000000 metrics={'f1_val': 0.5614298949597526, 'auprc': 0.5614298949597526, 'loss_val': 0.9997259248468551, 'psi': 0.5614298949597526}-{'f1_val': 0.3131206920684558, 'auprc': 0.3131206920684558, 'loss_val': 1.4964743898620114, 'psi': 0.3131206920684558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=0.8760
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.9524
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9893
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.3594 head_norm=2.069562
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.524618e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.3594 head_norm=2.032496 delta_norm=0.152462
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.2219 head_norm=1.379253
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.991710e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.2256 head_norm=1.540734 delta_norm=0.299171
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.6515 head_norm=1.802916
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.461392e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.6516 head_norm=1.541876 delta_norm=0.446139
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=2.028351 cos_to_last_merge=0.9712 (last merge round=15)
[S2] round=23 local utility u=0.016212 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.244185957279147, 'psi': 0.2654773703336637}-{'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.0970290666417046, 'psi': 0.24552398411243506}
[S3] START round=23 head_norm_before_train=1.938541 cos_to_last_merge=0.9951 (last merge round=16)
[S3] round=23 local utility u=0.100736 metrics={'f1_val': 0.28107047779178923, 'auprc': 0.28107047779178923, 'loss_val': 2.138401966226997, 'psi': 0.28107047779178923}-{'f1_val': 0.2609090319652467, 'auprc': 0.2609090319652467, 'loss_val': 2.1584215103805446, 'psi': 0.2609090319652467}
[S4] START round=23 head_norm_before_train=1.954437 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3006038254920083, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2734454528952863, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.720300 (no previous merge yet)
[S5] round=23 local utility u=0.042186 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7520415893426624, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8364137368055284, 'psi': 0.3335071121394324}
[S6] START round=23 head_norm_before_train=1.885468 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.890568326882766, 'psi': 0.01954921803127875}-{'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 7.810087329580312, 'psi': 0.020211299954065228}
[S7] START round=23 head_norm_before_train=1.540734 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.637997 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2864214475373053, 'psi': 0.35976373724718097}-{'f1_val': 0.22193211488250653, 'auprc': 0.22193211488250653, 'loss_val': 1.321930682989461, 'psi': 0.22193211488250653}
[S8] START round=23 head_norm_before_train=2.032496 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2162175800517705, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1985442827477701, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.764757 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.727210055119136, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6882907434932775, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.739077 cos_to_last_merge=0.9972 (last merge round=21)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.3285084842047596, 'auprc': 0.3285084842047596, 'loss_val': 0.9228888453357886, 'psi': 0.3285084842047596}-{'f1_val': 0.32882091327232876, 'auprc': 0.32882091327232876, 'loss_val': 0.9211502325270413, 'psi': 0.32882091327232876}
[S11] START round=23 head_norm_before_train=1.736441 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.24810243930702822, 'auprc': 0.24810243930702822, 'loss_val': 2.0233846184782442, 'psi': 0.24810243930702822}-{'f1_val': 0.28030898140874577, 'auprc': 0.28030898140874577, 'loss_val': 2.2317409021440318, 'psi': 0.28030898140874577}
[S13] START round=23 head_norm_before_train=1.764057 (no previous merge yet)
[S13] round=23 local utility u=0.060756 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1111567919536058, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2326681976259584, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.733641 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 5.621404044121688, 'psi': 0.1345336334083521}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.533811016500571, 'psi': 0.13572854291417166}
[S15] START round=23 head_norm_before_train=1.541876 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6169418407377033, 'auprc': 0.6169418407377033, 'loss_val': 0.2894319742025682, 'psi': 0.6169418407377033}-{'f1_val': 0.6514937638743481, 'auprc': 0.6514937638743481, 'loss_val': 0.170951712027625, 'psi': 0.6514937638743481}
[S16] START round=23 head_norm_before_train=1.767414 (no previous merge yet)
[S16] round=23 local utility u=0.120895 metrics={'f1_val': 0.14601386481802428, 'auprc': 0.14601386481802428, 'loss_val': 3.439591196850381, 'psi': 0.14601386481802428}-{'f1_val': 0.13587076786899757, 'auprc': 0.13587076786899757, 'loss_val': 3.590093718431949, 'psi': 0.13587076786899757}
[S17] START round=23 head_norm_before_train=2.006361 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.32015275118303005, 'auprc': 0.32015275118303005, 'loss_val': 1.4421532014031158, 'psi': 0.32015275118303005}-{'f1_val': 0.5614298949597526, 'auprc': 0.5614298949597526, 'loss_val': 0.9997259248468551, 'psi': 0.5614298949597526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39415
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.146)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:39415
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S13
[S15] cosine check vs S13: cos=0.9293
[S15] RECEIVED delta(kind=head bytes=1803) from S3
[S15] cosine check vs S3: cos=-0.0579
[S15] DROPPED delta from S3 (cos=-0.0579 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=-0.1454
[S9] DROPPED delta from S5 (cos=-0.1454 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S2
[S10] cosine check vs S2: cos=0.1688
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] cosine check vs S7: cos=0.9895
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.6169 head_norm=1.605312
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.397223e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.6137 head_norm=1.605200 delta_norm=0.139722
[S15] aggregate: ACCEPT kept=['S13', 'S7'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.3285 head_norm=1.802772
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.242798e+00
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.3792 head_norm=1.471824 delta_norm=1.242798
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=2.042459 cos_to_last_merge=0.9694 (last merge round=15)
[S2] round=24 local utility u=0.009963 metrics={'f1_val': 0.26469038208168644, 'auprc': 0.26469038208168644, 'loss_val': 2.2171765763802593, 'psi': 0.26469038208168644}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.244185957279147, 'psi': 0.2654773703336637}
[S3] START round=24 head_norm_before_train=1.951404 cos_to_last_merge=0.9942 (last merge round=16)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.28986249893244515, 'auprc': 0.28986249893244515, 'loss_val': 2.226545570094159, 'psi': 0.28986249893244515}-{'f1_val': 0.28107047779178923, 'auprc': 0.28107047779178923, 'loss_val': 2.138401966226997, 'psi': 0.28107047779178923}
[S4] START round=24 head_norm_before_train=1.962782 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3204657523989272, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3006038254920083, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.739730 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7822363747155214, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7520415893426624, 'psi': 0.3335071121394324}
[S6] START round=24 head_norm_before_train=1.895623 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.942578618056806, 'psi': 0.01954921803127875}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.890568326882766, 'psi': 0.01954921803127875}
[S7] START round=24 head_norm_before_train=1.557082 cos_to_last_merge=0.9997 (last merge round=22)
[S7] round=24 local utility u=0.017062 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2522971271440897, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2864214475373053, 'psi': 0.35976373724718097}
[S8] START round=24 head_norm_before_train=2.060034 cos_to_last_merge=0.9997 (last merge round=22)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2936112616682152, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2162175800517705, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.775603 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7620472053905307, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.727210055119136, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.471824 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.182078 metrics={'f1_val': 0.34588080488534306, 'auprc': 0.34588080488534306, 'loss_val': 0.7150841320539751, 'psi': 0.34588080488534306}-{'f1_val': 0.3285084842047596, 'auprc': 0.3285084842047596, 'loss_val': 0.9228888453357886, 'psi': 0.3285084842047596}
[S11] START round=24 head_norm_before_train=1.743833 (no previous merge yet)
[S11] round=24 local utility u=0.012764 metrics={'f1_val': 0.280253943320898, 'auprc': 0.280253943320898, 'loss_val': 2.2872191825775117, 'psi': 0.280253943320898}-{'f1_val': 0.24810243930702822, 'auprc': 0.24810243930702822, 'loss_val': 2.0233846184782442, 'psi': 0.24810243930702822}
[S13] START round=24 head_norm_before_train=1.770408 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2910631347905086, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1111567919536058, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.747194 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13433395872420262, 'auprc': 0.13433395872420262, 'loss_val': 5.69625175318739, 'psi': 0.13433395872420262}-{'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 5.621404044121688, 'psi': 0.1345336334083521}
[S15] START round=24 head_norm_before_train=1.605200 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.103887 metrics={'f1_val': 0.6300297829017055, 'auprc': 0.6300297829017055, 'loss_val': 0.1994492607273206, 'psi': 0.6300297829017055}-{'f1_val': 0.6169418407377033, 'auprc': 0.6169418407377033, 'loss_val': 0.2894319742025682, 'psi': 0.6169418407377033}
[S16] START round=24 head_norm_before_train=1.778803 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.14260793720017445, 'auprc': 0.14260793720017445, 'loss_val': 3.596093759055216, 'psi': 0.14260793720017445}-{'f1_val': 0.14601386481802428, 'auprc': 0.14601386481802428, 'loss_val': 3.439591196850381, 'psi': 0.14601386481802428}
[S17] START round=24 head_norm_before_train=2.016045 (no previous merge yet)
[S17] round=24 local utility u=0.060116 metrics={'f1_val': 0.32870526006464884, 'auprc': 0.32870526006464884, 'loss_val': 1.39889305044834, 'psi': 0.32870526006464884}-{'f1_val': 0.32015275118303005, 'auprc': 0.32015275118303005, 'loss_val': 1.4421532014031158, 'psi': 0.32015275118303005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39411
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39411
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:39408
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S2
[S10] cosine check vs S2: cos=0.7818
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] cosine check vs S15: cos=0.7047
[S7] RECEIVED delta(kind=head bytes=1806) from S10
[S7] cosine check vs S10: cos=0.7563
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=0.9822
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] cosine check vs S11: cos=0.2079
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9927
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.3594 head_norm=2.088486
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.280191e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.3594 head_norm=2.056519 delta_norm=0.128019
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.6300 head_norm=1.660179
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.582398e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.6334 head_norm=1.610622 delta_norm=0.158240
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.3459 head_norm=1.534587
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.216185e-01
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.3542 head_norm=1.464655 delta_norm=0.121619
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.3598 head_norm=1.575466
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.997391e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.3598 head_norm=1.249537 delta_norm=0.599739
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=2.055092 cos_to_last_merge=0.9679 (last merge round=15)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.2460183066062673, 'psi': 0.2450298816928894}-{'f1_val': 0.26469038208168644, 'auprc': 0.26469038208168644, 'loss_val': 2.2171765763802593, 'psi': 0.26469038208168644}
[S3] START round=25 head_norm_before_train=1.965223 cos_to_last_merge=0.9931 (last merge round=16)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.297351598173516, 'auprc': 0.297351598173516, 'loss_val': 2.4252202877715767, 'psi': 0.297351598173516}-{'f1_val': 0.28986249893244515, 'auprc': 0.28986249893244515, 'loss_val': 2.226545570094159, 'psi': 0.28986249893244515}
[S4] START round=25 head_norm_before_train=1.972522 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3419585273777863, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3204657523989272, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.753954 (no previous merge yet)
[S5] round=25 local utility u=0.038483 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7052696132865903, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7822363747155214, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.905292 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 7.978661565181295, 'psi': 0.01999080882352941}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.942578618056806, 'psi': 0.01954921803127875}
[S7] START round=25 head_norm_before_train=1.249537 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.005476 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2413458225462624, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2522971271440897, 'psi': 0.35976373724718097}
[S8] START round=25 head_norm_before_train=2.056519 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2975051083967057, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2936112616682152, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.785698 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7904535508990134, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7620472053905307, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.464655 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.3534830745487633, 'auprc': 0.3534830745487633, 'loss_val': 0.8243863422291423, 'psi': 0.3534830745487633}-{'f1_val': 0.34588080488534306, 'auprc': 0.34588080488534306, 'loss_val': 0.7150841320539751, 'psi': 0.34588080488534306}
[S11] START round=25 head_norm_before_train=1.754444 (no previous merge yet)
[S11] round=25 local utility u=0.515236 metrics={'f1_val': 0.3720243266724587, 'auprc': 0.3720243266724587, 'loss_val': 2.0826798723431206, 'psi': 0.3720243266724587}-{'f1_val': 0.280253943320898, 'auprc': 0.280253943320898, 'loss_val': 2.2872191825775117, 'psi': 0.280253943320898}
[S13] START round=25 head_norm_before_train=1.780846 (no previous merge yet)
[S13] round=25 local utility u=0.094711 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.101641476034353, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2910631347905086, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.759909 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 5.761861059928777, 'psi': 0.1345336334083521}-{'f1_val': 0.13433395872420262, 'auprc': 0.13433395872420262, 'loss_val': 5.69625175318739, 'psi': 0.13433395872420262}
[S15] START round=25 head_norm_before_train=1.610622 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=1.000000 metrics={'f1_val': 0.8827619227792033, 'auprc': 0.8827619227792033, 'loss_val': 0.22660536439323137, 'psi': 0.8827619227792033}-{'f1_val': 0.6300297829017055, 'auprc': 0.6300297829017055, 'loss_val': 0.1994492607273206, 'psi': 0.6300297829017055}
[S16] START round=25 head_norm_before_train=1.787945 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.14232700283780833, 'auprc': 0.14232700283780833, 'loss_val': 3.689840694767718, 'psi': 0.14232700283780833}-{'f1_val': 0.14260793720017445, 'auprc': 0.14260793720017445, 'loss_val': 3.596093759055216, 'psi': 0.14260793720017445}
[S17] START round=25 head_norm_before_train=2.032128 (no previous merge yet)
[S17] round=25 local utility u=1.000000 metrics={'f1_val': 0.5698360655737705, 'auprc': 0.5698360655737705, 'loss_val': 1.0776989160482568, 'psi': 0.5698360655737705}-{'f1_val': 0.32870526006464884, 'auprc': 0.32870526006464884, 'loss_val': 1.39889305044834, 'psi': 0.32870526006464884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39408
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:39415
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:39410
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] cosine check vs S15: cos=0.7390
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.1452
[S9] DROPPED delta from S5 (cos=-0.1452 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] cosine check vs S7: cos=0.9085
[S15] RECEIVED delta(kind=head bytes=1804) from S13
[S15] cosine check vs S13: cos=0.9123
[S7] RECEIVED delta(kind=head bytes=1804) from S11
[S7] cosine check vs S11: cos=0.4829
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.9963
[S3] ⇄ pheromone p=0.083 → S15@127.0.0.1:39415
[S2] ⇄ pheromone p=0.023 → S10@127.0.0.1:39411
[S4] ⇄ pheromone p=0.020 → S2@127.0.0.1:39402
[S9] ⇄ pheromone p=0.018 → S3@127.0.0.1:39403
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.3594 head_norm=2.082917
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.038312e-02
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.3594 head_norm=2.063607 delta_norm=0.090383
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.027 → S3@127.0.0.1:39403
[S6] ⇄ pheromone p=0.006 → S8@127.0.0.1:39409
[S14] ⇄ pheromone p=0.020 → S6@127.0.0.1:39407
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.3535 head_norm=1.539277
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.805637e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.3128 head_norm=1.491818 delta_norm=0.580564
[S10] aggregate: ROLLBACK (f1_val pre=0.353 post=0.313 tol_abs=0.005 tol_rel=0.0)
[S10] ⇄ pheromone p=0.108 → S7@127.0.0.1:39408
[S16] ⇄ pheromone p=0.068 → S6@127.0.0.1:39407
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.8828 head_norm=1.660053
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.074710e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.8825 head_norm=1.536514 delta_norm=0.207471
[S15] aggregate: ACCEPT kept=['S7', 'S13'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.387 → S10@127.0.0.1:39411
[S11] ⇄ pheromone p=0.126 → S7@127.0.0.1:39408
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.3598 head_norm=1.270770
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.003209e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.3598 head_norm=1.312702 delta_norm=0.800321
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.216 → S15@127.0.0.1:39415
[S5] ⇄ pheromone p=0.045 → S9@127.0.0.1:39410
[S13] ⇄ pheromone p=0.057 → S15@127.0.0.1:39415
[S17] ⇄ pheromone p=0.373 → S8@127.0.0.1:39409
[S2] START round=26 head_norm_before_train=2.067247 cos_to_last_merge=0.9664 (last merge round=15)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.306606379834311, 'psi': 0.24507471790179935}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.2460183066062673, 'psi': 0.2450298816928894}
[S3] START round=26 head_norm_before_train=1.979184 cos_to_last_merge=0.9920 (last merge round=16)
[S3] round=26 local utility u=0.044253 metrics={'f1_val': 0.29553626238709113, 'auprc': 0.29553626238709113, 'loss_val': 2.320377236532281, 'psi': 0.29553626238709113}-{'f1_val': 0.297351598173516, 'auprc': 0.297351598173516, 'loss_val': 2.4252202877715767, 'psi': 0.297351598173516}
[S4] START round=26 head_norm_before_train=1.988070 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3642960250140157, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3419585273777863, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.764306 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.73753114115115, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7052696132865903, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.914340 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.05582475156587, 'psi': 0.019770114942528734}-{'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 7.978661565181295, 'psi': 0.01999080882352941}
[S7] START round=26 head_norm_before_train=1.312702 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2620498289755853, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2413458225462624, 'psi': 0.35976373724718097}
[S8] START round=26 head_norm_before_train=2.063607 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3303971115706845, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2975051083967057, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.795006 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.815170024011227, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7904535508990134, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.491818 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.302409199433751, 'auprc': 0.302409199433751, 'loss_val': 1.0790096386045454, 'psi': 0.302409199433751}-{'f1_val': 0.3534830745487633, 'auprc': 0.3534830745487633, 'loss_val': 0.8243863422291423, 'psi': 0.3534830745487633}
[S11] START round=26 head_norm_before_train=1.764240 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.24827506232968052, 'auprc': 0.24827506232968052, 'loss_val': 2.128574928028939, 'psi': 0.24827506232968052}-{'f1_val': 0.3720243266724587, 'auprc': 0.3720243266724587, 'loss_val': 2.0826798723431206, 'psi': 0.3720243266724587}
[S13] START round=26 head_norm_before_train=1.795427 (no previous merge yet)
[S13] round=26 local utility u=0.028608 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.044424775687957, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.101641476034353, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.771515 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.8198838553729155, 'psi': 0.13533083645443197}-{'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 5.761861059928777, 'psi': 0.1345336334083521}
[S15] START round=26 head_norm_before_train=1.536514 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6648598077045716, 'auprc': 0.6648598077045716, 'loss_val': 0.16825435784807008, 'psi': 0.6648598077045716}-{'f1_val': 0.8827619227792033, 'auprc': 0.8827619227792033, 'loss_val': 0.22660536439323137, 'psi': 0.8827619227792033}
[S16] START round=26 head_norm_before_train=1.797654 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.14260793720017445, 'auprc': 0.14260793720017445, 'loss_val': 3.7249974088342195, 'psi': 0.14260793720017445}-{'f1_val': 0.14232700283780833, 'auprc': 0.14232700283780833, 'loss_val': 3.689840694767718, 'psi': 0.14232700283780833}
[S17] START round=26 head_norm_before_train=2.048107 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.3152924461283448, 'auprc': 0.3152924461283448, 'loss_val': 1.643181013202419, 'psi': 0.3152924461283448}-{'f1_val': 0.5698360655737705, 'auprc': 0.5698360655737705, 'loss_val': 1.0776989160482568, 'psi': 0.5698360655737705}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:39415
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S3
[S15] cosine check vs S3: cos=-0.0605
[S15] DROPPED delta from S3 (cos=-0.0605 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S13
[S15] cosine check vs S13: cos=0.9303
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.6649 head_norm=1.578211
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.384809e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.6649 head_norm=1.668960 delta_norm=0.338481
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=2.078862 cos_to_last_merge=0.9650 (last merge round=15)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.261537434047953, 'auprc': 0.261537434047953, 'loss_val': 2.5336521031408012, 'psi': 0.261537434047953}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.306606379834311, 'psi': 0.24507471790179935}
[S3] START round=27 head_norm_before_train=1.991378 cos_to_last_merge=0.9911 (last merge round=16)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.297351598173516, 'auprc': 0.297351598173516, 'loss_val': 2.4943674903906143, 'psi': 0.297351598173516}-{'f1_val': 0.29553626238709113, 'auprc': 0.29553626238709113, 'loss_val': 2.320377236532281, 'psi': 0.29553626238709113}
[S4] START round=27 head_norm_before_train=1.998315 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3742935165109493, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3642960250140157, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.773243 (no previous merge yet)
[S5] round=27 local utility u=0.028664 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.680202379748475, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.73753114115115, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.923158 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 8.087911339404226, 'psi': 0.020431588613406795}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.05582475156587, 'psi': 0.019770114942528734}
[S7] START round=27 head_norm_before_train=1.331617 cos_to_last_merge=0.9994 (last merge round=25)
[S7] round=27 local utility u=0.003606 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2548383227677717, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2620498289755853, 'psi': 0.35976373724718097}
[S8] START round=27 head_norm_before_train=2.090195 cos_to_last_merge=0.9997 (last merge round=25)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.399077168235613, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3303971115706845, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.803702 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.835497851928487, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.815170024011227, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.567649 cos_to_last_merge=0.9987 (last merge round=25)
[S10] round=27 local utility u=0.193697 metrics={'f1_val': 0.33789700132506956, 'auprc': 0.33789700132506956, 'loss_val': 1.0110055982941, 'psi': 0.33789700132506956}-{'f1_val': 0.302409199433751, 'auprc': 0.302409199433751, 'loss_val': 1.0790096386045454, 'psi': 0.302409199433751}
[S11] START round=27 head_norm_before_train=1.774256 (no previous merge yet)
[S11] round=27 local utility u=0.014377 metrics={'f1_val': 0.2689529552163809, 'auprc': 0.2689529552163809, 'loss_val': 2.2859212180359116, 'psi': 0.2689529552163809}-{'f1_val': 0.24827506232968052, 'auprc': 0.24827506232968052, 'loss_val': 2.128574928028939, 'psi': 0.24827506232968052}
[S13] START round=27 head_norm_before_train=1.819132 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1957016585856062, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.044424775687957, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.782238 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.872357882264228, 'psi': 0.1355297641332834}-{'f1_val': 0.13533083645443197, 'auprc': 0.13533083645443197, 'loss_val': 5.8198838553729155, 'psi': 0.13533083645443197}
[S15] START round=27 head_norm_before_train=1.668960 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.609361972708747, 'auprc': 0.609361972708747, 'loss_val': 0.2410538233689391, 'psi': 0.609361972708747}-{'f1_val': 0.6648598077045716, 'auprc': 0.6648598077045716, 'loss_val': 0.16825435784807008, 'psi': 0.6648598077045716}
[S16] START round=27 head_norm_before_train=1.807513 (no previous merge yet)
[S16] round=27 local utility u=0.035522 metrics={'f1_val': 0.14612663345606816, 'auprc': 0.14612663345606816, 'loss_val': 3.6856212777143007, 'psi': 0.14612663345606816}-{'f1_val': 0.14260793720017445, 'auprc': 0.14260793720017445, 'loss_val': 3.7249974088342195, 'psi': 0.14260793720017445}
[S17] START round=27 head_norm_before_train=2.066625 (no previous merge yet)
[S17] round=27 local utility u=1.000000 metrics={'f1_val': 0.5524729946461446, 'auprc': 0.5524729946461446, 'loss_val': 1.2209483615738346, 'psi': 0.5524729946461446}-{'f1_val': 0.3152924461283448, 'auprc': 0.3152924461283448, 'loss_val': 1.643181013202419, 'psi': 0.3152924461283448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:39412
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.146)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39415
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1792) from S7
[S11] cosine check vs S7: cos=0.8935
[S15] RECEIVED delta(kind=head bytes=1795) from S10
[S15] cosine check vs S10: cos=0.8789
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.6094 head_norm=1.715451
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.134938e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.6166 head_norm=1.620125 delta_norm=0.413494
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.2690 head_norm=1.788172
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.196143e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.2725 head_norm=1.529441 delta_norm=0.419614
[S11] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=2.089459 cos_to_last_merge=0.9637 (last merge round=15)
[S2] round=28 local utility u=0.082714 metrics={'f1_val': 0.26112952492363684, 'auprc': 0.26112952492363684, 'loss_val': 2.364553481340701, 'psi': 0.26112952492363684}-{'f1_val': 0.261537434047953, 'auprc': 0.261537434047953, 'loss_val': 2.5336521031408012, 'psi': 0.261537434047953}
[S3] START round=28 head_norm_before_train=2.002876 cos_to_last_merge=0.9902 (last merge round=16)
[S3] round=28 local utility u=0.038112 metrics={'f1_val': 0.29187224097636977, 'auprc': 0.29187224097636977, 'loss_val': 2.36882931603596, 'psi': 0.29187224097636977}-{'f1_val': 0.297351598173516, 'auprc': 0.297351598173516, 'loss_val': 2.4943674903906143, 'psi': 0.297351598173516}
[S4] START round=28 head_norm_before_train=2.004631 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3903527796254773, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3742935165109493, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.782977 (no previous merge yet)
[S5] round=28 local utility u=0.023837 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6325293001708174, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.680202379748475, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.931989 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.152863121353542, 'psi': 0.01999080882352941}-{'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 8.087911339404226, 'psi': 0.020431588613406795}
[S7] START round=28 head_norm_before_train=1.353872 cos_to_last_merge=0.9976 (last merge round=25)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.2255518559625108, 'auprc': 0.2255518559625108, 'loss_val': 1.2616015864599366, 'psi': 0.2255518559625108}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2548383227677717, 'psi': 0.35976373724718097}
[S8] START round=28 head_norm_before_train=2.115668 cos_to_last_merge=0.9989 (last merge round=25)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4627291163628, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.399077168235613, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.811784 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8581442618605313, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.835497851928487, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.627511 cos_to_last_merge=0.9966 (last merge round=25)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.31638676844783714, 'auprc': 0.31638676844783714, 'loss_val': 1.0814252667217212, 'psi': 0.31638676844783714}-{'f1_val': 0.33789700132506956, 'auprc': 0.33789700132506956, 'loss_val': 1.0110055982941, 'psi': 0.33789700132506956}
[S11] START round=28 head_norm_before_train=1.529441 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.130738 metrics={'f1_val': 0.25942081667272504, 'auprc': 0.25942081667272504, 'loss_val': 1.9386558569275176, 'psi': 0.25942081667272504}-{'f1_val': 0.2689529552163809, 'auprc': 0.2689529552163809, 'loss_val': 2.2859212180359116, 'psi': 0.2689529552163809}
[S13] START round=28 head_norm_before_train=1.836117 (no previous merge yet)
[S13] round=28 local utility u=0.083940 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0278225747467904, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1957016585856062, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.792204 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.921093928904701, 'psi': 0.13572854291417166}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.872357882264228, 'psi': 0.1355297641332834}
[S15] START round=28 head_norm_before_train=1.620125 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.014464 metrics={'f1_val': 0.6181359625605519, 'auprc': 0.6181359625605519, 'loss_val': 0.2910907415480022, 'psi': 0.6181359625605519}-{'f1_val': 0.609361972708747, 'auprc': 0.609361972708747, 'loss_val': 0.2410538233689391, 'psi': 0.609361972708747}
[S16] START round=28 head_norm_before_train=1.817102 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.13910876575784228, 'auprc': 0.13910876575784228, 'loss_val': 3.9317619979611105, 'psi': 0.13910876575784228}-{'f1_val': 0.14612663345606816, 'auprc': 0.14612663345606816, 'loss_val': 3.6856212777143007, 'psi': 0.14612663345606816}
[S17] START round=28 head_norm_before_train=2.083938 (no previous merge yet)
[S17] round=28 local utility u=0.382813 metrics={'f1_val': 0.6177501499871172, 'auprc': 0.6177501499871172, 'loss_val': 1.0428176453016382, 'psi': 0.6177501499871172}-{'f1_val': 0.5524729946461446, 'auprc': 0.5524729946461446, 'loss_val': 1.2209483615738346, 'psi': 0.5524729946461446}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:39404
[S5] not sending this round → trigger blocked (psi=0.334)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.259)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] cosine check vs S15: cos=0.5212
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=0.9137
[S8] RECEIVED delta(kind=head bytes=1806) from S3
[S8] cosine check vs S3: cos=0.9595
[S17] not sending this round → trigger blocked (psi=0.618)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.3568 head_norm=2.014328
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.292191e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.3568 head_norm=2.011950 delta_norm=0.429219
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.2256 head_norm=1.376296
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.569713e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.2355 head_norm=1.331453 delta_norm=0.756971
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.3594 head_norm=2.139706
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.019117e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.3594 head_norm=2.055532 delta_norm=0.301912
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=2.099244 cos_to_last_merge=0.9625 (last merge round=15)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 2.392507188798636, 'psi': 0.24543399914482925}-{'f1_val': 0.26112952492363684, 'auprc': 0.26112952492363684, 'loss_val': 2.364553481340701, 'psi': 0.26112952492363684}
[S3] START round=29 head_norm_before_train=2.013551 cos_to_last_merge=0.9893 (last merge round=16)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.29609929078014185, 'auprc': 0.29609929078014185, 'loss_val': 2.4514877167516387, 'psi': 0.29609929078014185}-{'f1_val': 0.29187224097636977, 'auprc': 0.29187224097636977, 'loss_val': 2.36882931603596, 'psi': 0.29187224097636977}
[S4] START round=29 head_norm_before_train=2.011950 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3962461656888863, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3903527796254773, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.795396 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8495505944323685, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6325293001708174, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.940349 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.169536893667194, 'psi': 0.01999080882352941}-{'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.152863121353542, 'psi': 0.01999080882352941}
[S7] START round=29 head_norm_before_train=1.331453 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.637016 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1954770062930884, 'psi': 0.35976373724718097}-{'f1_val': 0.2255518559625108, 'auprc': 0.2255518559625108, 'loss_val': 1.2616015864599366, 'psi': 0.2255518559625108}
[S8] START round=29 head_norm_before_train=2.055532 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.534881915291253, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4627291163628, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.819924 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.880623927130734, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8581442618605313, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.674314 cos_to_last_merge=0.9944 (last merge round=25)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.2734819189645715, 'auprc': 0.2734819189645715, 'loss_val': 1.1964945117527959, 'psi': 0.2734819189645715}-{'f1_val': 0.31638676844783714, 'auprc': 0.31638676844783714, 'loss_val': 1.0814252667217212, 'psi': 0.31638676844783714}
[S11] START round=29 head_norm_before_train=1.546208 cos_to_last_merge=0.9999 (last merge round=27)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.2657976412166356, 'auprc': 0.2657976412166356, 'loss_val': 2.021460133223098, 'psi': 0.2657976412166356}-{'f1_val': 0.25942081667272504, 'auprc': 0.25942081667272504, 'loss_val': 1.9386558569275176, 'psi': 0.25942081667272504}
[S13] START round=29 head_norm_before_train=1.846771 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.158866786630687, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0278225747467904, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.801574 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.966865025859059, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.921093928904701, 'psi': 0.13572854291417166}
[S15] START round=29 head_norm_before_train=1.672530 cos_to_last_merge=0.9989 (last merge round=27)
[S15] round=29 local utility u=0.262289 metrics={'f1_val': 0.660447281550175, 'auprc': 0.660447281550175, 'loss_val': 0.14731504748113128, 'psi': 0.660447281550175}-{'f1_val': 0.6181359625605519, 'auprc': 0.6181359625605519, 'loss_val': 0.2910907415480022, 'psi': 0.6181359625605519}
[S16] START round=29 head_norm_before_train=1.825687 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.09010742344075677, 'auprc': 0.09010742344075677, 'loss_val': 4.502832168117848, 'psi': 0.09010742344075677}-{'f1_val': 0.13910876575784228, 'auprc': 0.13910876575784228, 'loss_val': 3.9317619979611105, 'psi': 0.13910876575784228}
[S17] START round=29 head_norm_before_train=2.101038 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.34340834878954557, 'auprc': 0.34340834878954557, 'loss_val': 1.6975979986933252, 'psi': 0.34340834878954557}-{'f1_val': 0.6177501499871172, 'auprc': 0.6177501499871172, 'loss_val': 1.0428176453016382, 'psi': 0.6177501499871172}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:39412
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.8945
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S7
[S11] cosine check vs S7: cos=0.6700
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.3598 head_norm=1.352183
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.939385e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.3598 head_norm=1.492981 delta_norm=0.393939
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.2658 head_norm=1.570629
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.019449e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.2717 head_norm=1.336151 delta_norm=0.601945
[S11] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=2.108943 cos_to_last_merge=0.9613 (last merge round=15)
[S2] round=30 local utility u=0.007480 metrics={'f1_val': 0.24922466195261136, 'auprc': 0.24922466195261136, 'loss_val': 2.4116623945621827, 'psi': 0.24922466195261136}-{'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 2.392507188798636, 'psi': 0.24543399914482925}
[S3] START round=30 head_norm_before_train=2.023861 cos_to_last_merge=0.9884 (last merge round=16)
[S3] round=30 local utility u=0.055646 metrics={'f1_val': 0.2968605724838412, 'auprc': 0.2968605724838412, 'loss_val': 2.3470475822106938, 'psi': 0.2968605724838412}-{'f1_val': 0.29609929078014185, 'auprc': 0.29609929078014185, 'loss_val': 2.4514877167516387, 'psi': 0.29609929078014185}
[S4] START round=30 head_norm_before_train=2.018946 cos_to_last_merge=0.9999 (last merge round=28)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4157239714195506, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3962461656888863, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.809827 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8695390812973463, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8495505944323685, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.948279 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 8.199305417200826, 'psi': 0.020431588613406795}-{'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.169536893667194, 'psi': 0.01999080882352941}
[S7] START round=30 head_norm_before_train=1.492981 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.017394 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.160688608284377, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1954770062930884, 'psi': 0.35976373724718097}
[S8] START round=30 head_norm_before_train=2.077830 cos_to_last_merge=0.9999 (last merge round=28)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6141955824104164, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.534881915291253, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.827629 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9010928570521415, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.880623927130734, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.711277 cos_to_last_merge=0.9924 (last merge round=25)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.261388178471565, 'auprc': 0.261388178471565, 'loss_val': 1.223636049656091, 'psi': 0.261388178471565}-{'f1_val': 0.2734819189645715, 'auprc': 0.2734819189645715, 'loss_val': 1.1964945117527959, 'psi': 0.2734819189645715}
[S11] START round=30 head_norm_before_train=1.336151 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.240844 metrics={'f1_val': 0.27570665121370164, 'auprc': 0.27570665121370164, 'loss_val': 1.6289529436173171, 'psi': 0.27570665121370164}-{'f1_val': 0.2657976412166356, 'auprc': 0.2657976412166356, 'loss_val': 2.021460133223098, 'psi': 0.2657976412166356}
[S13] START round=30 head_norm_before_train=1.856178 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1967520062231798, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.158866786630687, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.810587 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.007789979989998, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.966865025859059, 'psi': 0.13572854291417166}
[S15] START round=30 head_norm_before_train=1.714632 cos_to_last_merge=0.9972 (last merge round=27)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6033796236018626, 'auprc': 0.6033796236018626, 'loss_val': 0.20799871699398845, 'psi': 0.6033796236018626}-{'f1_val': 0.660447281550175, 'auprc': 0.660447281550175, 'loss_val': 0.14731504748113128, 'psi': 0.660447281550175}
[S16] START round=30 head_norm_before_train=1.832734 (no previous merge yet)
[S16] round=30 local utility u=0.081482 metrics={'f1_val': 0.09448818897637795, 'auprc': 0.09448818897637795, 'loss_val': 4.379294955069049, 'psi': 0.09448818897637795}-{'f1_val': 0.09010742344075677, 'auprc': 0.09010742344075677, 'loss_val': 4.502832168117848, 'psi': 0.09010742344075677}
[S17] START round=30 head_norm_before_train=2.120145 (no previous merge yet)
[S17] round=30 local utility u=1.000000 metrics={'f1_val': 0.6712213244139298, 'auprc': 0.6712213244139298, 'loss_val': 1.0121122701919145, 'psi': 0.6712213244139298}-{'f1_val': 0.34340834878954557, 'auprc': 0.34340834878954557, 'loss_val': 1.6975979986933252, 'psi': 0.34340834878954557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:39404
[S2] sending update (kind=head size=1792 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1792) from S2
[S4] cosine check vs S2: cos=0.9757
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:39412
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39409
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S7
[S11] cosine check vs S7: cos=0.7517
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S3
[S8] cosine check vs S3: cos=0.9885
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.094)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] ⇄ pheromone p=0.020 → S4@127.0.0.1:39404
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.3594 head_norm=2.096157
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.595373e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.3594 head_norm=2.059270 delta_norm=0.159537
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.009 → S17@127.0.0.1:39417
[S6] ⇄ pheromone p=0.002 → S16@127.0.0.1:39416
[S7] ⇄ pheromone p=0.177 → S11@127.0.0.1:39412
[S3] ⇄ pheromone p=0.047 → S8@127.0.0.1:39409
[S9] ⇄ pheromone p=0.006 → S5@127.0.0.1:39405
[S10] ⇄ pheromone p=0.055 → S15@127.0.0.1:39415
[S5] ⇄ pheromone p=0.021 → S9@127.0.0.1:39410
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.3568 head_norm=2.031634
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.327013e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.3568 head_norm=2.062248 delta_norm=0.232701
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.007 → S2@127.0.0.1:39402
[S15] ⇄ pheromone p=0.171 → S7@127.0.0.1:39408
[S16] ⇄ pheromone p=0.042 → S6@127.0.0.1:39407
[S17] ⇄ pheromone p=0.473 → S8@127.0.0.1:39409
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.2757 head_norm=1.370600
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.120941e-01
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.2791 head_norm=1.349084 delta_norm=0.512094
[S11] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.108 → S7@127.0.0.1:39408
[S2] START round=31 head_norm_before_train=2.118136 cos_to_last_merge=0.9603 (last merge round=15)
[S2] round=31 local utility u=0.018610 metrics={'f1_val': 0.257168458781362, 'auprc': 0.257168458781362, 'loss_val': 2.4459367462834773, 'psi': 0.257168458781362}-{'f1_val': 0.24922466195261136, 'auprc': 0.24922466195261136, 'loss_val': 2.4116623945621827, 'psi': 0.24922466195261136}
[S3] START round=31 head_norm_before_train=2.034262 cos_to_last_merge=0.9875 (last merge round=16)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.2915150044487584, 'auprc': 0.2915150044487584, 'loss_val': 2.3874469971723373, 'psi': 0.2915150044487584}-{'f1_val': 0.2968605724838412, 'auprc': 0.2968605724838412, 'loss_val': 2.3470475822106938, 'psi': 0.2968605724838412}
[S4] START round=31 head_norm_before_train=2.062248 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4512122163272712, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4157239714195506, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.822754 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8790945365721465, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8695390812973463, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=1.955969 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.264714893586182, 'psi': 0.01999080882352941}-{'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 8.199305417200826, 'psi': 0.020431588613406795}
[S7] START round=31 head_norm_before_train=1.511950 cos_to_last_merge=0.9997 (last merge round=29)
[S7] round=31 local utility u=0.018691 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1233064443650724, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.160688608284377, 'psi': 0.35976373724718097}
[S8] START round=31 head_norm_before_train=2.059270 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6185619066525958, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6141955824104164, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.834915 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.916788813605531, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9010928570521415, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.742037 cos_to_last_merge=0.9907 (last merge round=25)
[S10] round=31 local utility u=0.160294 metrics={'f1_val': 0.29178284673456906, 'auprc': 0.29178284673456906, 'loss_val': 1.1766009241711655, 'psi': 0.29178284673456906}-{'f1_val': 0.261388178471565, 'auprc': 0.261388178471565, 'loss_val': 1.223636049656091, 'psi': 0.261388178471565}
[S11] START round=31 head_norm_before_train=1.349084 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.118573 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 1.4337225057924783, 'psi': 0.28036404111831337}-{'f1_val': 0.27570665121370164, 'auprc': 0.27570665121370164, 'loss_val': 1.6289529436173171, 'psi': 0.27570665121370164}
[S13] START round=31 head_norm_before_train=1.864869 (no previous merge yet)
[S13] round=31 local utility u=0.068785 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0591816678760133, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1967520062231798, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.819558 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.048666267469557, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.007789979989998, 'psi': 0.13572854291417166}
[S15] START round=31 head_norm_before_train=1.747752 cos_to_last_merge=0.9957 (last merge round=27)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6120907606756664, 'auprc': 0.6120907606756664, 'loss_val': 0.3022703666710342, 'psi': 0.6120907606756664}-{'f1_val': 0.6033796236018626, 'auprc': 0.6033796236018626, 'loss_val': 0.20799871699398845, 'psi': 0.6033796236018626}
[S16] START round=31 head_norm_before_train=1.840599 (no previous merge yet)
[S16] round=31 local utility u=1.000000 metrics={'f1_val': 0.24729682595047087, 'auprc': 0.24729682595047087, 'loss_val': 2.5048942573990205, 'psi': 0.24729682595047087}-{'f1_val': 0.09448818897637795, 'auprc': 0.09448818897637795, 'loss_val': 4.379294955069049, 'psi': 0.09448818897637795}
[S17] START round=31 head_norm_before_train=2.134217 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6320625756642564, 'auprc': 0.6320625756642564, 'loss_val': 1.1050344102053336, 'psi': 0.6320625756642564}-{'f1_val': 0.6712213244139298, 'auprc': 0.6712213244139298, 'loss_val': 1.0121122701919145, 'psi': 0.6712213244139298}
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S2]  timeout peer S3
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S16
[S10]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S15
[S6]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:39407
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:39404
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S10
[S15] cosine check vs S10: cos=0.9542
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] cosine check vs S7: cos=0.9739
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] cosine check vs S11: cos=0.9242
[S4] RECEIVED delta(kind=head bytes=1795) from S2
[S4] cosine check vs S2: cos=0.9929
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.3598 head_norm=1.529523
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.922474e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.3598 head_norm=1.434303 delta_norm=0.292247
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.3568 head_norm=2.066409
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.281868e-01
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.3568 head_norm=2.093016 delta_norm=0.128187
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] cosine check vs S16: cos=-0.0685
[S6] DROPPED delta from S16 (cos=-0.0685 < 0.0)
[S15] CommDone barrier timeout: have=2 need=3 — continuing
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.6121 head_norm=1.776376
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.991457e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.6126 head_norm=1.691756 delta_norm=0.199146
[S15] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=2.127028 cos_to_last_merge=0.9592 (last merge round=15)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.2593094546627945, 'auprc': 0.2593094546627945, 'loss_val': 2.4816725871935272, 'psi': 0.2593094546627945}-{'f1_val': 0.257168458781362, 'auprc': 0.257168458781362, 'loss_val': 2.4459367462834773, 'psi': 0.257168458781362}
[S3] START round=32 head_norm_before_train=2.044477 cos_to_last_merge=0.9866 (last merge round=16)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.2798939584205386, 'auprc': 0.2798939584205386, 'loss_val': 2.371008582171218, 'psi': 0.2798939584205386}-{'f1_val': 0.2915150044487584, 'auprc': 0.2915150044487584, 'loss_val': 2.3874469971723373, 'psi': 0.2915150044487584}
[S4] START round=32 head_norm_before_train=2.093016 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4743204235982172, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4512122163272712, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.832728 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9522528784490367, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8790945365721465, 'psi': 0.3335071121394324}
[S6] START round=32 head_norm_before_train=1.963389 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 8.338475690464504, 'psi': 0.01910681399631676}-{'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.264714893586182, 'psi': 0.01999080882352941}
[S7] START round=32 head_norm_before_train=1.434303 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.007077 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1091523417894906, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1233064443650724, 'psi': 0.35976373724718097}
[S8] START round=32 head_norm_before_train=2.073029 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6670923668627982, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6185619066525958, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.841693 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.934458226940406, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.916788813605531, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=1.769169 cos_to_last_merge=0.9891 (last merge round=25)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.2657206881861775, 'auprc': 0.2657206881861775, 'loss_val': 1.2457838103061623, 'psi': 0.2657206881861775}-{'f1_val': 0.29178284673456906, 'auprc': 0.29178284673456906, 'loss_val': 1.1766009241711655, 'psi': 0.29178284673456906}
[S11] START round=32 head_norm_before_train=1.394928 cos_to_last_merge=0.9976 (last merge round=30)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.28050858565998166, 'auprc': 0.28050858565998166, 'loss_val': 1.6217831010262809, 'psi': 0.28050858565998166}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 1.4337225057924783, 'psi': 0.28036404111831337}
[S13] START round=32 head_norm_before_train=1.874103 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4311842008906532, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0591816678760133, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.827926 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.087233047317553, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.048666267469557, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.691756 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.021298 metrics={'f1_val': 0.6150623545909649, 'auprc': 0.6150623545909649, 'loss_val': 0.2864187445090533, 'psi': 0.6150623545909649}-{'f1_val': 0.6120907606756664, 'auprc': 0.6120907606756664, 'loss_val': 0.3022703666710342, 'psi': 0.6120907606756664}
[S16] START round=32 head_norm_before_train=1.847671 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.14747605674371714, 'auprc': 0.14747605674371714, 'loss_val': 3.8297678725326465, 'psi': 0.14747605674371714}-{'f1_val': 0.24729682595047087, 'auprc': 0.24729682595047087, 'loss_val': 2.5048942573990205, 'psi': 0.24729682595047087}
[S17] START round=32 head_norm_before_train=2.143695 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.45265119215910676, 'auprc': 0.45265119215910676, 'loss_val': 1.6089695012917526, 'psi': 0.45265119215910676}-{'f1_val': 0.6320625756642564, 'auprc': 0.6320625756642564, 'loss_val': 1.1050344102053336, 'psi': 0.6320625756642564}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=0.9379
[S8]  timeout peer S6
[S7]  timeout peer S10
[S6]  timeout peer S14
[S3]  timeout peer S8
[S3]  timeout peer S9
[S10]  timeout peer S2
[S10]  timeout peer S15
[S15]  timeout peer S3
[S15]  timeout peer S7
[S15]  timeout peer S13
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.6151 head_norm=1.719073
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.093898e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.6163 head_norm=1.558525 delta_norm=0.309390
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=2.135576 cos_to_last_merge=0.9582 (last merge round=15)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.2572672557305673, 'auprc': 0.2572672557305673, 'loss_val': 2.4953595153871304, 'psi': 0.2572672557305673}-{'f1_val': 0.2593094546627945, 'auprc': 0.2593094546627945, 'loss_val': 2.4816725871935272, 'psi': 0.2593094546627945}
[S3] START round=33 head_norm_before_train=2.052925 cos_to_last_merge=0.9859 (last merge round=16)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.27872724746422123, 'auprc': 0.27872724746422123, 'loss_val': 2.390061493812682, 'psi': 0.27872724746422123}-{'f1_val': 0.2798939584205386, 'auprc': 0.2798939584205386, 'loss_val': 2.371008582171218, 'psi': 0.2798939584205386}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=2.104918 cos_to_last_merge=0.9999 (last merge round=31)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5043350859147957, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4743204235982172, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.842459 (no previous merge yet)
[S5] round=33 local utility u=0.020986 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9102814892516724, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9522528784490367, 'psi': 0.3335071121394324}
[S6] START round=33 head_norm_before_train=1.970355 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.354519733781943, 'psi': 0.01999080882352941}-{'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 8.338475690464504, 'psi': 0.01910681399631676}
[S7] START round=33 head_norm_before_train=1.447147 cos_to_last_merge=0.9998 (last merge round=31)
[S7] round=33 local utility u=0.013286 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0825798757082694, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1091523417894906, 'psi': 0.35976373724718097}
[S8] START round=33 head_norm_before_train=2.086524 cos_to_last_merge=0.9999 (last merge round=30)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7176432580467385, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6670923668627982, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.848480 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.95312287668894, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.934458226940406, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=1.794128 cos_to_last_merge=0.9877 (last merge round=25)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.2629676816068674, 'auprc': 0.2629676816068674, 'loss_val': 1.2614170265864657, 'psi': 0.2629676816068674}-{'f1_val': 0.2657206881861775, 'auprc': 0.2657206881861775, 'loss_val': 1.2457838103061623, 'psi': 0.2657206881861775}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.454772 cos_to_last_merge=0.9898 (last merge round=30)
[S11] round=33 local utility u=0.068193 metrics={'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 1.8743274433387156, 'psi': 0.3237230419977299}-{'f1_val': 0.28050858565998166, 'auprc': 0.28050858565998166, 'loss_val': 1.6217831010262809, 'psi': 0.28050858565998166}
[S13] START round=33 head_norm_before_train=1.883321 (no previous merge yet)
[S13] round=33 local utility u=0.106321 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.218543072372069, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4311842008906532, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=33 head_norm_before_train=1.836131 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.124340499804516, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.087233047317553, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.558525 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.030433 metrics={'f1_val': 0.6181359625605519, 'auprc': 0.6181359625605519, 'loss_val': 0.253214547682149, 'psi': 0.6181359625605519}-{'f1_val': 0.6150623545909649, 'auprc': 0.6150623545909649, 'loss_val': 0.2864187445090533, 'psi': 0.6150623545909649}
[S16] START round=33 head_norm_before_train=1.854715 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 4.955065375910561, 'psi': 0.08899598393574297}-{'f1_val': 0.14747605674371714, 'auprc': 0.14747605674371714, 'loss_val': 3.8297678725326465, 'psi': 0.14747605674371714}
[S17] START round=33 head_norm_before_train=2.159195 (no previous merge yet)
[S17] round=33 local utility u=1.000000 metrics={'f1_val': 0.7123798747782455, 'auprc': 0.7123798747782455, 'loss_val': 0.9609216509563681, 'psi': 0.7123798747782455}-{'f1_val': 0.45265119215910676, 'auprc': 0.45265119215910676, 'loss_val': 1.6089695012917526, 'psi': 0.45265119215910676}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.618)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=2.143598 cos_to_last_merge=0.9572 (last merge round=15)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.2559887869520897, 'auprc': 0.2559887869520897, 'loss_val': 2.5089486045823595, 'psi': 0.2559887869520897}-{'f1_val': 0.2572672557305673, 'auprc': 0.2572672557305673, 'loss_val': 2.4953595153871304, 'psi': 0.2572672557305673}
[S3] START round=34 head_norm_before_train=2.061525 cos_to_last_merge=0.9851 (last merge round=16)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.28372716608010723, 'auprc': 0.28372716608010723, 'loss_val': 2.4744071790226605, 'psi': 0.28372716608010723}-{'f1_val': 0.27872724746422123, 'auprc': 0.27872724746422123, 'loss_val': 2.390061493812682, 'psi': 0.27872724746422123}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=2.124746 cos_to_last_merge=0.9996 (last merge round=31)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5204742248852245, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5043350859147957, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=1.853928 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9781608585388595, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9102814892516724, 'psi': 0.3335071121394324}
[S6] START round=34 head_norm_before_train=1.977100 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.385360687260203, 'psi': 0.01999080882352941}-{'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.354519733781943, 'psi': 0.01999080882352941}
[S7] START round=34 head_norm_before_train=1.462275 cos_to_last_merge=0.9994 (last merge round=31)
[S7] round=34 local utility u=0.013713 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0551548720014927, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0825798757082694, 'psi': 0.35976373724718097}
[S8] START round=34 head_norm_before_train=2.099304 cos_to_last_merge=0.9997 (last merge round=30)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7644066625414836, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7176432580467385, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.855269 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9685993755600575, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.95312287668894, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=1.816188 cos_to_last_merge=0.9864 (last merge round=25)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.25378270734588565, 'auprc': 0.25378270734588565, 'loss_val': 1.298826053835343, 'psi': 0.25378270734588565}-{'f1_val': 0.2629676816068674, 'auprc': 0.2629676816068674, 'loss_val': 1.2614170265864657, 'psi': 0.2629676816068674}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.512761 cos_to_last_merge=0.9803 (last merge round=30)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.31894430776112725, 'auprc': 0.31894430776112725, 'loss_val': 1.9905608457838133, 'psi': 0.31894430776112725}-{'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 1.8743274433387156, 'psi': 0.3237230419977299}
[S13] START round=34 head_norm_before_train=1.893287 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2280956535384975, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.218543072372069, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.844064 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.163183959549788, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.124340499804516, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.590537 cos_to_last_merge=0.9998 (last merge round=32)
[S15] round=34 local utility u=1.000000 metrics={'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.30718323720048335, 'psi': 0.8796705340794291}-{'f1_val': 0.6181359625605519, 'auprc': 0.6181359625605519, 'loss_val': 0.253214547682149, 'psi': 0.6181359625605519}
[S16] START round=34 head_norm_before_train=1.862118 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.034309844286091316, 'auprc': 0.034309844286091316, 'loss_val': 5.400581367653391, 'psi': 0.034309844286091316}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 4.955065375910561, 'psi': 0.08899598393574297}
[S17] START round=34 head_norm_before_train=2.172768 (no previous merge yet)
[S17] round=34 local utility u=0.017550 metrics={'f1_val': 0.7154712170427341, 'auprc': 0.7154712170427341, 'loss_val': 0.9536434622992094, 'psi': 0.7154712170427341}-{'f1_val': 0.7123798747782455, 'auprc': 0.7123798747782455, 'loss_val': 0.9609216509563681, 'psi': 0.7123798747782455}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.715)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.360)
[S2] START round=35 head_norm_before_train=2.151156 cos_to_last_merge=0.9563 (last merge round=15)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.25308641975308643, 'auprc': 0.25308641975308643, 'loss_val': 2.525092327673359, 'psi': 0.25308641975308643}-{'f1_val': 0.2559887869520897, 'auprc': 0.2559887869520897, 'loss_val': 2.5089486045823595, 'psi': 0.2559887869520897}
[S3] START round=35 head_norm_before_train=2.070245 cos_to_last_merge=0.9843 (last merge round=16)
[S3] round=35 local utility u=0.008113 metrics={'f1_val': 0.2793677320520855, 'auprc': 0.2793677320520855, 'loss_val': 2.41894671545142, 'psi': 0.2793677320520855}-{'f1_val': 0.28372716608010723, 'auprc': 0.28372716608010723, 'loss_val': 2.4744071790226605, 'psi': 0.28372716608010723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=35 head_norm_before_train=2.139429 cos_to_last_merge=0.9993 (last merge round=31)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5502793023112253, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5204742248852245, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=1.862492 (no previous merge yet)
[S5] round=35 local utility u=0.026044 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.926073059083662, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9781608585388595, 'psi': 0.3335071121394324}
[S6] START round=35 head_norm_before_train=1.983698 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.431160373966447, 'psi': 0.019770114942528734}-{'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.385360687260203, 'psi': 0.01999080882352941}
[S7] START round=35 head_norm_before_train=1.478647 cos_to_last_merge=0.9988 (last merge round=31)
[S7] round=35 local utility u=0.015969 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0232172602610656, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0551548720014927, 'psi': 0.35976373724718097}
[S8] START round=35 head_norm_before_train=2.111739 cos_to_last_merge=0.9996 (last merge round=30)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8184717141077797, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7644066625414836, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.861554 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.983488836421893, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9685993755600575, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=1.836363 cos_to_last_merge=0.9851 (last merge round=25)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.24581431280387211, 'auprc': 0.24581431280387211, 'loss_val': 1.3349381346274853, 'psi': 0.24581431280387211}-{'f1_val': 0.25378270734588565, 'auprc': 0.25378270734588565, 'loss_val': 1.298826053835343, 'psi': 0.25378270734588565}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.563884 cos_to_last_merge=0.9716 (last merge round=30)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.130073516514871, 'psi': 0.3237230419977299}-{'f1_val': 0.31894430776112725, 'auprc': 0.31894430776112725, 'loss_val': 1.9905608457838133, 'psi': 0.31894430776112725}
[S13] START round=35 head_norm_before_train=1.903951 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2377697294468946, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2280956535384975, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.851468 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.20220231161082, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.163183959549788, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.627781 cos_to_last_merge=0.9990 (last merge round=32)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6139722607942376, 'auprc': 0.6139722607942376, 'loss_val': 0.23050715623751253, 'psi': 0.6139722607942376}-{'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.30718323720048335, 'psi': 0.8796705340794291}
[S16] START round=35 head_norm_before_train=1.868593 (no previous merge yet)
[S16] round=35 local utility u=1.000000 metrics={'f1_val': 0.24744304974430498, 'auprc': 0.24744304974430498, 'loss_val': 2.3983479840044746, 'psi': 0.24744304974430498}-{'f1_val': 0.034309844286091316, 'auprc': 0.034309844286091316, 'loss_val': 5.400581367653391, 'psi': 0.034309844286091316}
[S17] START round=35 head_norm_before_train=2.179768 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6465526122778399, 'auprc': 0.6465526122778399, 'loss_val': 1.1714111411168882, 'psi': 0.6465526122778399}-{'f1_val': 0.7154712170427341, 'auprc': 0.7154712170427341, 'loss_val': 0.9536434622992094, 'psi': 0.7154712170427341}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] START round=36 head_norm_before_train=2.158569 cos_to_last_merge=0.9554 (last merge round=15)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.2508114856429463, 'auprc': 0.2508114856429463, 'loss_val': 2.5449100687375075, 'psi': 0.2508114856429463}-{'f1_val': 0.25308641975308643, 'auprc': 0.25308641975308643, 'loss_val': 2.525092327673359, 'psi': 0.25308641975308643}
[S3] START round=36 head_norm_before_train=2.077658 cos_to_last_merge=0.9836 (last merge round=16)
[S3] round=36 local utility u=0.018636 metrics={'f1_val': 0.2862406957034417, 'auprc': 0.2862406957034417, 'loss_val': 2.4435305261190834, 'psi': 0.2862406957034417}-{'f1_val': 0.2793677320520855, 'auprc': 0.2793677320520855, 'loss_val': 2.41894671545142, 'psi': 0.2793677320520855}
[S3] not sending this round → trigger blocked (psi=0.286)
[S4] START round=36 head_norm_before_train=2.150581 cos_to_last_merge=0.9991 (last merge round=31)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.575255909249776, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5502793023112253, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=1.870771 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.962175362592296, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.926073059083662, 'psi': 0.3335071121394324}
[S6] START round=36 head_norm_before_train=1.990530 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.470730827369152, 'psi': 0.019770114942528734}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.431160373966447, 'psi': 0.019770114942528734}
[S7] START round=36 head_norm_before_train=1.495864 cos_to_last_merge=0.9978 (last merge round=31)
[S7] round=36 local utility u=0.011830 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9995575784298179, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0232172602610656, 'psi': 0.35976373724718097}
[S8] START round=36 head_norm_before_train=2.124975 cos_to_last_merge=0.9993 (last merge round=30)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8738396616986195, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8184717141077797, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=1.867673 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.997536308648827, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.983488836421893, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=1.855738 cos_to_last_merge=0.9840 (last merge round=25)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.2418465335049375, 'auprc': 0.2418465335049375, 'loss_val': 1.3776463993672956, 'psi': 0.2418465335049375}-{'f1_val': 0.24581431280387211, 'auprc': 0.24581431280387211, 'loss_val': 1.3349381346274853, 'psi': 0.24581431280387211}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.605512 cos_to_last_merge=0.9647 (last merge round=30)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.2289902175226897, 'psi': 0.3237230419977299}-{'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.130073516514871, 'psi': 0.3237230419977299}
[S13] START round=36 head_norm_before_train=1.908372 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4244146267158035, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2377697294468946, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.858467 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.236604049067738, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.20220231161082, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.663312 cos_to_last_merge=0.9980 (last merge round=32)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.43582000604387294, 'psi': 0.6175834097438502}-{'f1_val': 0.6139722607942376, 'auprc': 0.6139722607942376, 'loss_val': 0.23050715623751253, 'psi': 0.6139722607942376}
[S16] START round=36 head_norm_before_train=1.874067 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.19321388724814595, 'auprc': 0.19321388724814595, 'loss_val': 3.0689161806198495, 'psi': 0.19321388724814595}-{'f1_val': 0.24744304974430498, 'auprc': 0.24744304974430498, 'loss_val': 2.3983479840044746, 'psi': 0.24744304974430498}
[S17] START round=36 head_norm_before_train=2.189174 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5674733199757773, 'auprc': 0.5674733199757773, 'loss_val': 1.2887636299432157, 'psi': 0.5674733199757773}-{'f1_val': 0.6465526122778399, 'auprc': 0.6465526122778399, 'loss_val': 1.1714111411168882, 'psi': 0.6465526122778399}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.360)
[S2] START round=37 head_norm_before_train=2.165739 cos_to_last_merge=0.9545 (last merge round=15)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.2503894808998567, 'auprc': 0.2503894808998567, 'loss_val': 2.565909429595154, 'psi': 0.2503894808998567}-{'f1_val': 0.2508114856429463, 'auprc': 0.2508114856429463, 'loss_val': 2.5449100687375075, 'psi': 0.2508114856429463}
[S3] START round=37 head_norm_before_train=2.084342 cos_to_last_merge=0.9830 (last merge round=16)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.2622352557836429, 'auprc': 0.2622352557836429, 'loss_val': 2.4715564901334033, 'psi': 0.2622352557836429}-{'f1_val': 0.2862406957034417, 'auprc': 0.2862406957034417, 'loss_val': 2.4435305261190834, 'psi': 0.2862406957034417}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=2.157651 cos_to_last_merge=0.9986 (last merge round=31)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5982317708709843, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.575255909249776, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=1.884271 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.999319211331663, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.962175362592296, 'psi': 0.3335071121394324}
[S6] START round=37 head_norm_before_train=1.996919 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.48931853730695, 'psi': 0.01999080882352941}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.470730827369152, 'psi': 0.019770114942528734}
[S7] START round=37 head_norm_before_train=1.513351 cos_to_last_merge=0.9966 (last merge round=31)
[S7] round=37 local utility u=0.009130 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9812975003810783, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9995575784298179, 'psi': 0.35976373724718097}
[S8] START round=37 head_norm_before_train=2.134543 cos_to_last_merge=0.9990 (last merge round=30)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9065949096332127, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8738396616986195, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=1.873565 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.012378139469211, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.997536308648827, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=1.873158 cos_to_last_merge=0.9829 (last merge round=25)
[S10] round=37 local utility u=0.495562 metrics={'f1_val': 0.32493245138939714, 'auprc': 0.32493245138939714, 'loss_val': 1.1342964264183353, 'psi': 0.32493245138939714}-{'f1_val': 0.2418465335049375, 'auprc': 0.2418465335049375, 'loss_val': 1.3776463993672956, 'psi': 0.2418465335049375}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=37 head_norm_before_train=1.637970 cos_to_last_merge=0.9594 (last merge round=30)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.2685652815624877, 'psi': 0.3237230419977299}-{'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.2289902175226897, 'psi': 0.3237230419977299}
[S13] START round=37 head_norm_before_train=1.914713 (no previous merge yet)
[S13] round=37 local utility u=0.042307 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3398005727852729, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4244146267158035, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=37 head_norm_before_train=1.865430 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.271485424514304, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.236604049067738, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.693620 cos_to_last_merge=0.9969 (last merge round=32)
[S15] round=37 local utility u=0.086050 metrics={'f1_val': 0.6181359625605519, 'auprc': 0.6181359625605519, 'loss_val': 0.26869334256827737, 'psi': 0.6181359625605519}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.43582000604387294, 'psi': 0.6175834097438502}
[S16] START round=37 head_norm_before_train=1.880116 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.051044878383007884, 'auprc': 0.051044878383007884, 'loss_val': 5.339557566569148, 'psi': 0.051044878383007884}-{'f1_val': 0.19321388724814595, 'auprc': 0.19321388724814595, 'loss_val': 3.0689161806198495, 'psi': 0.19321388724814595}
[S17] START round=37 head_norm_before_train=2.201836 (no previous merge yet)
[S17] round=37 local utility u=1.000000 metrics={'f1_val': 0.7897467361504826, 'auprc': 0.7897467361504826, 'loss_val': 0.761249546123434, 'psi': 0.7897467361504826}-{'f1_val': 0.5674733199757773, 'auprc': 0.5674733199757773, 'loss_val': 1.2887636299432157, 'psi': 0.5674733199757773}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S2] START round=38 head_norm_before_train=2.172665 cos_to_last_merge=0.9537 (last merge round=15)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.24987562189054727, 'auprc': 0.24987562189054727, 'loss_val': 2.5857035703763755, 'psi': 0.24987562189054727}-{'f1_val': 0.2503894808998567, 'auprc': 0.2503894808998567, 'loss_val': 2.565909429595154, 'psi': 0.2503894808998567}
[S3] START round=38 head_norm_before_train=2.090316 cos_to_last_merge=0.9825 (last merge round=16)
[S3] round=38 local utility u=0.089510 metrics={'f1_val': 0.2797681402332565, 'auprc': 0.2797681402332565, 'loss_val': 2.450332727876449, 'psi': 0.2797681402332565}-{'f1_val': 0.2622352557836429, 'auprc': 0.2622352557836429, 'loss_val': 2.4715564901334033, 'psi': 0.2622352557836429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=38 head_norm_before_train=2.162146 cos_to_last_merge=0.9979 (last merge round=31)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.6204434268593908, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5982317708709843, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=1.906257 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0525844305362333, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.999319211331663, 'psi': 0.3335071121394324}
[S6] START round=38 head_norm_before_train=2.003096 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.524480948902308, 'psi': 0.01999080882352941}-{'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.48931853730695, 'psi': 0.01999080882352941}
[S7] START round=38 head_norm_before_train=1.526840 cos_to_last_merge=0.9955 (last merge round=31)
[S7] round=38 local utility u=0.002932 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.975433776686077, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9812975003810783, 'psi': 0.35976373724718097}
[S8] START round=38 head_norm_before_train=2.145644 cos_to_last_merge=0.9988 (last merge round=30)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9413297633982487, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9065949096332127, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.879444 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0258222281262634, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.012378139469211, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=1.889689 cos_to_last_merge=0.9819 (last merge round=25)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.2613472195417827, 'auprc': 0.2613472195417827, 'loss_val': 1.325528193647526, 'psi': 0.2613472195417827}-{'f1_val': 0.32493245138939714, 'auprc': 0.32493245138939714, 'loss_val': 1.1342964264183353, 'psi': 0.32493245138939714}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.664060 cos_to_last_merge=0.9553 (last merge round=30)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.3014799154334038, 'auprc': 0.3014799154334038, 'loss_val': 2.2775544272950055, 'psi': 0.3014799154334038}-{'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.2685652815624877, 'psi': 0.3237230419977299}
[S13] START round=38 head_norm_before_train=1.919810 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4418094265937853, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3398005727852729, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.872053 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.306591933407658, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.271485424514304, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.720227 cos_to_last_merge=0.9957 (last merge round=32)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.5977022107598094, 'auprc': 0.5977022107598094, 'loss_val': 0.3174896605838373, 'psi': 0.5977022107598094}-{'f1_val': 0.6181359625605519, 'auprc': 0.6181359625605519, 'loss_val': 0.26869334256827737, 'psi': 0.6181359625605519}
[S16] START round=38 head_norm_before_train=1.886622 (no previous merge yet)
[S16] round=38 local utility u=1.000000 metrics={'f1_val': 0.17745217745217745, 'auprc': 0.17745217745217745, 'loss_val': 3.5417657791806922, 'psi': 0.17745217745217745}-{'f1_val': 0.051044878383007884, 'auprc': 0.051044878383007884, 'loss_val': 5.339557566569148, 'psi': 0.051044878383007884}
[S17] START round=38 head_norm_before_train=2.217591 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6078797451988749, 'auprc': 0.6078797451988749, 'loss_val': 1.2944021656409326, 'psi': 0.6078797451988749}-{'f1_val': 0.7897467361504826, 'auprc': 0.7897467361504826, 'loss_val': 0.761249546123434, 'psi': 0.7897467361504826}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.360)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9]  timeout peer S5
[S11]  timeout peer S7
[S17]  timeout peer S8
[S8]  timeout peer S3
[S8]  timeout peer S17
[S2]  timeout peer S4
[S7]  timeout peer S11
[S7]  timeout peer S15
[S5]  timeout peer S9
[S4]  timeout peer S2
[S15]  timeout peer S10
[S16]  timeout peer S6
[S6]  timeout peer S16
[S2] START round=39 head_norm_before_train=2.179347 cos_to_last_merge=0.9529 (last merge round=15)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.2493174484983867, 'auprc': 0.2493174484983867, 'loss_val': 2.6057216054980397, 'psi': 0.2493174484983867}-{'f1_val': 0.24987562189054727, 'auprc': 0.24987562189054727, 'loss_val': 2.5857035703763755, 'psi': 0.24987562189054727}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.249 u=0.0000 p_local=0.0033 f1=0.249 auprc=0.249 bytes=16192
[S3] START round=39 head_norm_before_train=2.096571 cos_to_last_merge=0.9819 (last merge round=16)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.26574165840766434, 'auprc': 0.26574165840766434, 'loss_val': 2.4854493946195606, 'psi': 0.26574165840766434}-{'f1_val': 0.2797681402332565, 'auprc': 0.2797681402332565, 'loss_val': 2.450332727876449, 'psi': 0.2797681402332565}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.266 u=0.0000 p_local=0.0232 f1=0.266 auprc=0.266 bytes=18026
[S4] START round=39 head_norm_before_train=2.164304 cos_to_last_merge=0.9974 (last merge round=31)
[S4] round=39 local utility u=0.015460 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.589522970894686, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.6204434268593908, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] r=40 psi=0.357 u=0.0155 p_local=0.0040 f1=0.357 auprc=0.357 bytes=10805
[S5] START round=39 head_norm_before_train=1.926934 (no previous merge yet)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.060552352092688, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0525844305362333, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.334 u=0.0000 p_local=0.0060 f1=0.334 auprc=0.334 bytes=19787
[S6] START round=39 head_norm_before_train=2.008903 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.566905917134907, 'psi': 0.019770114942528734}-{'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.524480948902308, 'psi': 0.01999080882352941}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.020 u=0.0000 p_local=0.0002 f1=0.020 auprc=0.020 bytes=0
[S7] START round=39 head_norm_before_train=1.539250 cos_to_last_merge=0.9943 (last merge round=31)
[S7] round=39 local utility u=0.003518 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9683983958023926, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.975433776686077, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S7] r=40 psi=0.360 u=0.0035 p_local=0.0311 f1=0.360 auprc=0.360 bytes=28795
[S8] START round=39 head_norm_before_train=2.155874 cos_to_last_merge=0.9985 (last merge round=30)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9893754256220266, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9413297633982487, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0012 f1=0.359 auprc=0.359 bytes=18003
[S9] START round=39 head_norm_before_train=1.885064 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0393310449948667, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0258222281262634, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0008 f1=0.369 auprc=0.369 bytes=1799
[S10] START round=39 head_norm_before_train=1.905291 cos_to_last_merge=0.9809 (last merge round=25)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.2353148952181247, 'auprc': 0.2353148952181247, 'loss_val': 1.453079428836728, 'psi': 0.2353148952181247}-{'f1_val': 0.2613472195417827, 'auprc': 0.2613472195417827, 'loss_val': 1.325528193647526, 'psi': 0.2613472195417827}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.235 u=0.0000 p_local=0.0762 f1=0.235 auprc=0.235 bytes=34218
[S11] START round=39 head_norm_before_train=1.686290 cos_to_last_merge=0.9520 (last merge round=30)
[S11] round=39 local utility u=0.014919 metrics={'f1_val': 0.30952897764271764, 'auprc': 0.30952897764271764, 'loss_val': 2.3201589532797806, 'psi': 0.30952897764271764}-{'f1_val': 0.3014799154334038, 'auprc': 0.3014799154334038, 'loss_val': 2.2775544272950055, 'psi': 0.3014799154334038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S11] sending update (kind=head size=1808 to 1 peers)
[S11] r=40 psi=0.310 u=0.0149 p_local=0.0250 f1=0.310 auprc=0.310 bytes=19821
[S13] START round=39 head_norm_before_train=1.930677 (no previous merge yet)
[S13] round=39 local utility u=0.081877 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2780544342662072, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4418094265937853, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S13] r=40 psi=0.360 u=0.0819 p_local=0.0339 f1=0.360 auprc=0.360 bytes=30620
[S14] START round=39 head_norm_before_train=1.878371 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.339524722783354, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.306591933407658, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0009 f1=0.136 auprc=0.136 bytes=0
[S15] START round=39 head_norm_before_train=1.744582 cos_to_last_merge=0.9946 (last merge round=32)
[S15] round=39 local utility u=0.077314 metrics={'f1_val': 0.6165172216356483, 'auprc': 0.6165172216356483, 'loss_val': 0.33219747910555864, 'psi': 0.6165172216356483}-{'f1_val': 0.5977022107598094, 'auprc': 0.5977022107598094, 'loss_val': 0.3174896605838373, 'psi': 0.5977022107598094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S15] r=40 psi=0.617 u=0.0773 p_local=0.1174 f1=0.617 auprc=0.617 bytes=39608
[S16] START round=39 head_norm_before_train=1.892256 (no previous merge yet)
[S16] round=39 local utility u=0.090484 metrics={'f1_val': 0.1857704874308195, 'auprc': 0.1857704874308195, 'loss_val': 3.4356631898284107, 'psi': 0.1857704874308195}-{'f1_val': 0.17745217745217745, 'auprc': 0.17745217745217745, 'loss_val': 3.5417657791806922, 'psi': 0.17745217745217745}
[S16] not sending this round → trigger blocked (psi=0.186)
[S16] r=40 psi=0.186 u=0.0905 p_local=0.2992 f1=0.186 auprc=0.186 bytes=5402
[S17] START round=39 head_norm_before_train=2.230481 (no previous merge yet)
[S17] round=39 local utility u=0.682163 metrics={'f1_val': 0.7283499668227215, 'auprc': 0.7283499668227215, 'loss_val': 1.0143091552554948, 'psi': 0.7283499668227215}-{'f1_val': 0.6078797451988749, 'auprc': 0.6078797451988749, 'loss_val': 1.2944021656409326, 'psi': 0.6078797451988749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S17] r=40 psi=0.728 u=0.6822 p_local=0.3816 f1=0.728 auprc=0.728 bytes=34189
[S2] START round=40 head_norm_before_train=2.185789 cos_to_last_merge=0.9521 (last merge round=15)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.2488542053759445, 'auprc': 0.2488542053759445, 'loss_val': 2.628072616292397, 'psi': 0.2488542053759445}-{'f1_val': 0.2493174484983867, 'auprc': 0.2493174484983867, 'loss_val': 2.6057216054980397, 'psi': 0.2493174484983867}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.103174 cos_to_last_merge=0.9813 (last merge round=16)
[S3] round=40 local utility u=0.063845 metrics={'f1_val': 0.27877522616562284, 'auprc': 0.27877522616562284, 'loss_val': 2.4750608772765457, 'psi': 0.27877522616562284}-{'f1_val': 0.26574165840766434, 'auprc': 0.26574165840766434, 'loss_val': 2.4854493946195606, 'psi': 0.26574165840766434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=40 head_norm_before_train=2.174131 cos_to_last_merge=0.9970 (last merge round=31)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5910208667425414, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.589522970894686, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.943067 (no previous merge yet)
[S5] round=40 local utility u=0.003087 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.054378424469809, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.060552352092688, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=40 head_norm_before_train=2.014599 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 8.614850814686038, 'psi': 0.019328117809479982}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.566905917134907, 'psi': 0.019770114942528734}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.553625 cos_to_last_merge=0.9931 (last merge round=31)
[S7] round=40 local utility u=0.006511 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9553760136613756, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9683983958023926, 'psi': 0.35976373724718097}
[S7] not sending this round → trigger blocked (psi=0.360)
[S8] START round=40 head_norm_before_train=2.166157 cos_to_last_merge=0.9982 (last merge round=30)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0292881114832526, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9893754256220266, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.890619 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0536727943574857, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0393310449948667, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.919814 cos_to_last_merge=0.9800 (last merge round=25)
[S10] round=40 local utility u=0.096757 metrics={'f1_val': 0.24899769990818826, 'auprc': 0.24899769990818826, 'loss_val': 1.3827104461191937, 'psi': 0.24899769990818826}-{'f1_val': 0.2353148952181247, 'auprc': 0.2353148952181247, 'loss_val': 1.453079428836728, 'psi': 0.2353148952181247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=40 head_norm_before_train=1.704525 cos_to_last_merge=0.9493 (last merge round=30)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=40 local utility u=0.033815 metrics={'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.380276136254898, 'psi': 0.3237230419977299}-{'f1_val': 0.30952897764271764, 'auprc': 0.30952897764271764, 'loss_val': 2.3201589532797806, 'psi': 0.30952897764271764}
[S11] not sending this round → trigger blocked (psi=0.324)
[S13] START round=40 head_norm_before_train=1.937213 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6062753914460803, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2780544342662072, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.884691 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.370731673547581, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.339524722783354, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.765341 cos_to_last_merge=0.9935 (last merge round=32)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.617721697935218, 'auprc': 0.617721697935218, 'loss_val': 0.37529637995666526, 'psi': 0.617721697935218}-{'f1_val': 0.6165172216356483, 'auprc': 0.6165172216356483, 'loss_val': 0.33219747910555864, 'psi': 0.6165172216356483}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.897864 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.08955223880597014, 'auprc': 0.08955223880597014, 'loss_val': 5.1585878571008354, 'psi': 0.08955223880597014}-{'f1_val': 0.1857704874308195, 'auprc': 0.1857704874308195, 'loss_val': 3.4356631898284107, 'psi': 0.1857704874308195}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=2.244581 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6124293552367686, 'auprc': 0.6124293552367686, 'loss_val': 1.3398291529790598, 'psi': 0.6124293552367686}-{'f1_val': 0.7283499668227215, 'auprc': 0.7283499668227215, 'loss_val': 1.0143091552554948, 'psi': 0.7283499668227215}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=2.192203 cos_to_last_merge=0.9514 (last merge round=15)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.24945675793133418, 'auprc': 0.24945675793133418, 'loss_val': 2.642427471807933, 'psi': 0.24945675793133418}-{'f1_val': 0.2488542053759445, 'auprc': 0.2488542053759445, 'loss_val': 2.628072616292397, 'psi': 0.2488542053759445}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.109914 cos_to_last_merge=0.9807 (last merge round=16)
[S3] round=41 local utility u=0.001344 metrics={'f1_val': 0.28205684530266867, 'auprc': 0.28205684530266867, 'loss_val': 2.501908383639152, 'psi': 0.28205684530266867}-{'f1_val': 0.27877522616562284, 'auprc': 0.27877522616562284, 'loss_val': 2.4750608772765457, 'psi': 0.27877522616562284}
[S3] not sending this round → trigger blocked (psi=0.282)
[S4] START round=41 head_norm_before_train=2.185571 cos_to_last_merge=0.9966 (last merge round=31)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5912067137331163, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5910208667425414, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.966051 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0877710115125816, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.054378424469809, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=2.020407 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.637979619175894, 'psi': 0.01999080882352941}-{'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 8.614850814686038, 'psi': 0.019328117809479982}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.571963 cos_to_last_merge=0.9914 (last merge round=31)
[S7] round=41 local utility u=0.005629 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.944118652970851, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9553760136613756, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=41 head_norm_before_train=2.176963 cos_to_last_merge=0.9979 (last merge round=30)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0721048888335747, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0292881114832526, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.896112 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0662070293137966, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0536727943574857, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.934027 cos_to_last_merge=0.9791 (last merge round=25)
[S10] round=41 local utility u=0.055267 metrics={'f1_val': 0.258922894758412, 'auprc': 0.258922894758412, 'loss_val': 1.3615037260936311, 'psi': 0.258922894758412}-{'f1_val': 0.24899769990818826, 'auprc': 0.24899769990818826, 'loss_val': 1.3827104461191937, 'psi': 0.24899769990818826}
[S10] not sending this round → trigger blocked (psi=0.259)
[S11] START round=41 head_norm_before_train=1.719762 cos_to_last_merge=0.9471 (last merge round=30)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.3236495687698593, 'auprc': 0.3236495687698593, 'loss_val': 2.4019420098523203, 'psi': 0.3236495687698593}-{'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.380276136254898, 'psi': 0.3237230419977299}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.946307 (no previous merge yet)
[S13] round=41 local utility u=0.122644 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3609873116079205, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6062753914460803, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=41 head_norm_before_train=1.890952 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.400975057691405, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.370731673547581, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.784020 cos_to_last_merge=0.9925 (last merge round=32)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6126664281936547, 'auprc': 0.6126664281936547, 'loss_val': 0.34352796790677437, 'psi': 0.6126664281936547}-{'f1_val': 0.617721697935218, 'auprc': 0.617721697935218, 'loss_val': 0.37529637995666526, 'psi': 0.617721697935218}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.904047 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.08885675263115611, 'auprc': 0.08885675263115611, 'loss_val': 5.241632924081352, 'psi': 0.08885675263115611}-{'f1_val': 0.08955223880597014, 'auprc': 0.08955223880597014, 'loss_val': 5.1585878571008354, 'psi': 0.08955223880597014}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=2.254065 (no previous merge yet)
[S17] round=41 local utility u=0.460035 metrics={'f1_val': 0.6983430769831388, 'auprc': 0.6983430769831388, 'loss_val': 1.1929830624041748, 'psi': 0.6983430769831388}-{'f1_val': 0.6124293552367686, 'auprc': 0.6124293552367686, 'loss_val': 1.3398291529790598, 'psi': 0.6124293552367686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=42 head_norm_before_train=2.198188 cos_to_last_merge=0.9506 (last merge round=15)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.25010893246187366, 'auprc': 0.25010893246187366, 'loss_val': 2.657672996682672, 'psi': 0.25010893246187366}-{'f1_val': 0.24945675793133418, 'auprc': 0.24945675793133418, 'loss_val': 2.642427471807933, 'psi': 0.24945675793133418}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.116611 cos_to_last_merge=0.9801 (last merge round=16)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.27842646649986097, 'auprc': 0.27842646649986097, 'loss_val': 2.5021255877530306, 'psi': 0.27842646649986097}-{'f1_val': 0.28205684530266867, 'auprc': 0.28205684530266867, 'loss_val': 2.501908383639152, 'psi': 0.28205684530266867}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=2.192040 cos_to_last_merge=0.9962 (last merge round=31)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.24012176560121767, 'auprc': 0.24012176560121767, 'loss_val': 1.5886462594691786, 'psi': 0.24012176560121767}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5912067137331163, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.989450 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1093441144194824, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0877710115125816, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=2.026012 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.672983935479454, 'psi': 0.019770114942528734}-{'f1_val': 0.01999080882352941, 'auprc': 0.01999080882352941, 'loss_val': 8.637979619175894, 'psi': 0.01999080882352941}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.587073 cos_to_last_merge=0.9896 (last merge round=31)
[S7] round=42 local utility u=0.002130 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9398577888729777, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.944118652970851, 'psi': 0.35976373724718097}
[S7] not sending this round → trigger blocked (psi=0.360)
[S8] START round=42 head_norm_before_train=2.185678 cos_to_last_merge=0.9976 (last merge round=30)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.098023865717039, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0721048888335747, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.901357 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0795273869750703, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0662070293137966, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.947581 cos_to_last_merge=0.9782 (last merge round=25)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.24478130821467592, 'auprc': 0.24478130821467592, 'loss_val': 1.4137879488137315, 'psi': 0.24478130821467592}-{'f1_val': 0.258922894758412, 'auprc': 0.258922894758412, 'loss_val': 1.3615037260936311, 'psi': 0.258922894758412}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.733165 cos_to_last_merge=0.9452 (last merge round=30)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.2935364347468094, 'auprc': 0.2935364347468094, 'loss_val': 2.3938808834592296, 'psi': 0.2935364347468094}-{'f1_val': 0.3236495687698593, 'auprc': 0.3236495687698593, 'loss_val': 2.4019420098523203, 'psi': 0.3236495687698593}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.961773 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5068773840756118, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3609873116079205, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.897025 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.430553201531627, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.400975057691405, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.801554 cos_to_last_merge=0.9916 (last merge round=32)
[S15] round=42 local utility u=1.000000 metrics={'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.2876930704988448, 'psi': 0.8796705340794291}-{'f1_val': 0.6126664281936547, 'auprc': 0.6126664281936547, 'loss_val': 0.34352796790677437, 'psi': 0.6126664281936547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=42 head_norm_before_train=1.910553 (no previous merge yet)
[S16] round=42 local utility u=0.305984 metrics={'f1_val': 0.09652876842605801, 'auprc': 0.09652876842605801, 'loss_val': 4.698714030546639, 'psi': 0.09652876842605801}-{'f1_val': 0.08885675263115611, 'auprc': 0.08885675263115611, 'loss_val': 5.241632924081352, 'psi': 0.08885675263115611}
[S16] not sending this round → trigger blocked (psi=0.097)
[S17] START round=42 head_norm_before_train=2.267709 (no previous merge yet)
[S17] round=42 local utility u=0.413420 metrics={'f1_val': 0.7613805451756579, 'auprc': 0.7613805451756579, 'loss_val': 0.9334796140994582, 'psi': 0.7613805451756579}-{'f1_val': 0.6983430769831388, 'auprc': 0.6983430769831388, 'loss_val': 1.1929830624041748, 'psi': 0.6983430769831388}
[S17] not sending this round → trigger blocked (psi=0.761)
[S2] START round=43 head_norm_before_train=2.204122 cos_to_last_merge=0.9499 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.950
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.24987562189054727, 'auprc': 0.24987562189054727, 'loss_val': 2.6732940842552946, 'psi': 0.24987562189054727}-{'f1_val': 0.25010893246187366, 'auprc': 0.25010893246187366, 'loss_val': 2.657672996682672, 'psi': 0.25010893246187366}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.123358 cos_to_last_merge=0.9795 (last merge round=16)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.2744856810881006, 'auprc': 0.2744856810881006, 'loss_val': 2.523242464432343, 'psi': 0.2744856810881006}-{'f1_val': 0.27842646649986097, 'auprc': 0.27842646649986097, 'loss_val': 2.5021255877530306, 'psi': 0.27842646649986097}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.199226 cos_to_last_merge=0.9958 (last merge round=31)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.24082554802466874, 'auprc': 0.24082554802466874, 'loss_val': 1.6106090691623964, 'psi': 0.24082554802466874}-{'f1_val': 0.24012176560121767, 'auprc': 0.24012176560121767, 'loss_val': 1.5886462594691786, 'psi': 0.24012176560121767}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=2.009840 (no previous merge yet)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1440125441151343, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1093441144194824, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=2.031498 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.701314703996935, 'psi': 0.019770114942528734}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.672983935479454, 'psi': 0.019770114942528734}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.596389 cos_to_last_merge=0.9885 (last merge round=31)
[S7] round=43 local utility u=0.004018 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9318209900880701, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9398577888729777, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=43 head_norm_before_train=2.195469 cos_to_last_merge=0.9973 (last merge round=30)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.12981074610805, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.098023865717039, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.906590 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.092239484048919, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0795273869750703, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.960489 cos_to_last_merge=0.9774 (last merge round=25)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.23726790134942263, 'auprc': 0.23726790134942263, 'loss_val': 1.4714724157362178, 'psi': 0.23726790134942263}-{'f1_val': 0.24478130821467592, 'auprc': 0.24478130821467592, 'loss_val': 1.4137879488137315, 'psi': 0.24478130821467592}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.745585 cos_to_last_merge=0.9435 (last merge round=30)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.28936688311688313, 'auprc': 0.28936688311688313, 'loss_val': 2.409590308237302, 'psi': 0.28936688311688313}-{'f1_val': 0.2935364347468094, 'auprc': 0.2935364347468094, 'loss_val': 2.3938808834592296, 'psi': 0.2935364347468094}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.975175 (no previous merge yet)
[S13] round=43 local utility u=0.132198 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2424814415748942, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5068773840756118, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=43 head_norm_before_train=1.903007 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.460190540858523, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.430553201531627, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.817814 cos_to_last_merge=0.9907 (last merge round=32)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6154754843374205, 'auprc': 0.6154754843374205, 'loss_val': 0.3713498162147318, 'psi': 0.6154754843374205}-{'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.2876930704988448, 'psi': 0.8796705340794291}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.917212 (no previous merge yet)
[S16] round=43 local utility u=0.243609 metrics={'f1_val': 0.1302013422818792, 'auprc': 0.1302013422818792, 'loss_val': 4.514550058919635, 'psi': 0.1302013422818792}-{'f1_val': 0.09652876842605801, 'auprc': 0.09652876842605801, 'loss_val': 4.698714030546639, 'psi': 0.09652876842605801}
[S16] not sending this round → trigger blocked (psi=0.130)
[S17] START round=43 head_norm_before_train=2.278797 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6272866086114945, 'auprc': 0.6272866086114945, 'loss_val': 1.3942317499378543, 'psi': 0.6272866086114945}-{'f1_val': 0.7613805451756579, 'auprc': 0.7613805451756579, 'loss_val': 0.9334796140994582, 'psi': 0.7613805451756579}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=2.209785 cos_to_last_merge=0.9493 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.2497824194952132, 'auprc': 0.2497824194952132, 'loss_val': 2.6903542377652525, 'psi': 0.2497824194952132}-{'f1_val': 0.24987562189054727, 'auprc': 0.24987562189054727, 'loss_val': 2.6732940842552946, 'psi': 0.24987562189054727}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.130041 cos_to_last_merge=0.9789 (last merge round=16)
[S3] round=44 local utility u=0.021968 metrics={'f1_val': 0.279876854184159, 'auprc': 0.279876854184159, 'loss_val': 2.527826582938113, 'psi': 0.279876854184159}-{'f1_val': 0.2744856810881006, 'auprc': 0.2744856810881006, 'loss_val': 2.523242464432343, 'psi': 0.2744856810881006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=44 head_norm_before_train=2.206710 cos_to_last_merge=0.9952 (last merge round=31)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.24117898856478934, 'auprc': 0.24117898856478934, 'loss_val': 1.6263321513463747, 'psi': 0.24117898856478934}-{'f1_val': 0.24082554802466874, 'auprc': 0.24082554802466874, 'loss_val': 1.6106090691623964, 'psi': 0.24082554802466874}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=2.028381 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.181791483689176, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1440125441151343, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=2.036835 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.728726469616673, 'psi': 0.019770114942528734}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.701314703996935, 'psi': 0.019770114942528734}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.604041 cos_to_last_merge=0.9876 (last merge round=31)
[S7] round=44 local utility u=0.002334 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.927152706796066, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9318209900880701, 'psi': 0.35976373724718097}
[S7] not sending this round → trigger blocked (psi=0.360)
[S8] START round=44 head_norm_before_train=2.205178 cos_to_last_merge=0.9970 (last merge round=30)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1464203283775483, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.12981074610805, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.911659 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1070287382962736, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.092239484048919, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.972828 cos_to_last_merge=0.9766 (last merge round=25)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.2370135074114765, 'auprc': 0.2370135074114765, 'loss_val': 1.4887137924071696, 'psi': 0.2370135074114765}-{'f1_val': 0.23726790134942263, 'auprc': 0.23726790134942263, 'loss_val': 1.4714724157362178, 'psi': 0.23726790134942263}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.756850 cos_to_last_merge=0.9420 (last merge round=30)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=44 local utility u=0.024040 metrics={'f1_val': 0.2982015892931828, 'auprc': 0.2982015892931828, 'loss_val': 2.441021947280326, 'psi': 0.2982015892931828}-{'f1_val': 0.28936688311688313, 'auprc': 0.28936688311688313, 'loss_val': 2.409590308237302, 'psi': 0.28936688311688313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=44 head_norm_before_train=1.981214 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5043778298866959, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2424814415748942, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.908835 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.489368471995421, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.460190540858523, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.832060 cos_to_last_merge=0.9899 (last merge round=32)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6158227667721874, 'auprc': 0.6158227667721874, 'loss_val': 0.4791720965725822, 'psi': 0.6158227667721874}-{'f1_val': 0.6154754843374205, 'auprc': 0.6154754843374205, 'loss_val': 0.3713498162147318, 'psi': 0.6154754843374205}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.923399 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.11565563725490197, 'auprc': 0.11565563725490197, 'loss_val': 4.674619769573975, 'psi': 0.11565563725490197}-{'f1_val': 0.1302013422818792, 'auprc': 0.1302013422818792, 'loss_val': 4.514550058919635, 'psi': 0.1302013422818792}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=2.290637 (no previous merge yet)
[S17] round=44 local utility u=0.575698 metrics={'f1_val': 0.7249929436906514, 'auprc': 0.7249929436906514, 'loss_val': 1.122193477312025, 'psi': 0.7249929436906514}-{'f1_val': 0.6272866086114945, 'auprc': 0.6272866086114945, 'loss_val': 1.3942317499378543, 'psi': 0.6272866086114945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=45 head_norm_before_train=2.215374 cos_to_last_merge=0.9486 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.2491782945736434, 'auprc': 0.2491782945736434, 'loss_val': 2.708613422242978, 'psi': 0.2491782945736434}-{'f1_val': 0.2497824194952132, 'auprc': 0.2497824194952132, 'loss_val': 2.6903542377652525, 'psi': 0.2497824194952132}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.136007 cos_to_last_merge=0.9783 (last merge round=16)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.2683496961196821, 'auprc': 0.2683496961196821, 'loss_val': 2.5548352363817917, 'psi': 0.2683496961196821}-{'f1_val': 0.279876854184159, 'auprc': 0.279876854184159, 'loss_val': 2.527826582938113, 'psi': 0.279876854184159}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.211245 cos_to_last_merge=0.9942 (last merge round=31)
[S4] round=45 local utility u=0.002757 metrics={'f1_val': 0.2423795476892822, 'auprc': 0.2423795476892822, 'loss_val': 1.6316228772182735, 'psi': 0.2423795476892822}-{'f1_val': 0.24117898856478934, 'auprc': 0.24117898856478934, 'loss_val': 1.6263321513463747, 'psi': 0.24117898856478934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=45 head_norm_before_train=2.042239 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1989951084115305, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.181791483689176, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=2.042110 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.761625396218442, 'psi': 0.019770114942528734}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.728726469616673, 'psi': 0.019770114942528734}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.612294 cos_to_last_merge=0.9867 (last merge round=31)
[S7] round=45 local utility u=0.002327 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9224993728541134, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.927152706796066, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=45 head_norm_before_train=2.214530 cos_to_last_merge=0.9967 (last merge round=30)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1747807000986374, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1464203283775483, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.916773 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.124438934559734, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1070287382962736, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.984355 cos_to_last_merge=0.9759 (last merge round=25)
[S10] round=45 local utility u=0.003753 metrics={'f1_val': 0.23817666332349363, 'auprc': 0.23817666332349363, 'loss_val': 1.4916757853771379, 'psi': 0.23817666332349363}-{'f1_val': 0.2370135074114765, 'auprc': 0.2370135074114765, 'loss_val': 1.4887137924071696, 'psi': 0.2370135074114765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=45 head_norm_before_train=1.767403 cos_to_last_merge=0.9405 (last merge round=30)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.298826487845767, 'auprc': 0.298826487845767, 'loss_val': 2.4604357877516367, 'psi': 0.298826487845767}-{'f1_val': 0.2982015892931828, 'auprc': 0.2982015892931828, 'loss_val': 2.441021947280326, 'psi': 0.2982015892931828}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.985886 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5810364743725733, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5043778298866959, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.914403 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.518222930670631, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.489368471995421, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.846311 cos_to_last_merge=0.9891 (last merge round=32)
[S15] round=45 local utility u=0.114794 metrics={'f1_val': 0.6181359625605519, 'auprc': 0.6181359625605519, 'loss_val': 0.2704037007268746, 'psi': 0.6181359625605519}-{'f1_val': 0.6158227667721874, 'auprc': 0.6158227667721874, 'loss_val': 0.4791720965725822, 'psi': 0.6158227667721874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=45 head_norm_before_train=1.928247 (no previous merge yet)
[S16] round=45 local utility u=0.212239 metrics={'f1_val': 0.13873001906437896, 'auprc': 0.13873001906437896, 'loss_val': 4.457811589412277, 'psi': 0.13873001906437896}-{'f1_val': 0.11565563725490197, 'auprc': 0.11565563725490197, 'loss_val': 4.674619769573975, 'psi': 0.11565563725490197}
[S16] not sending this round → trigger blocked (psi=0.139)
[S17] START round=45 head_norm_before_train=2.300122 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6138237240043157, 'auprc': 0.6138237240043157, 'loss_val': 1.4484181701595282, 'psi': 0.6138237240043157}-{'f1_val': 0.7249929436906514, 'auprc': 0.7249929436906514, 'loss_val': 1.122193477312025, 'psi': 0.7249929436906514}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=2.220794 cos_to_last_merge=0.9480 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.948
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.24908561155539025, 'auprc': 0.24908561155539025, 'loss_val': 2.725565147842969, 'psi': 0.24908561155539022}-{'f1_val': 0.2491782945736434, 'auprc': 0.2491782945736434, 'loss_val': 2.708613422242978, 'psi': 0.2491782945736434}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.141759 cos_to_last_merge=0.9778 (last merge round=16)
[S3] round=46 local utility u=0.030234 metrics={'f1_val': 0.2751714677640604, 'auprc': 0.2751714677640604, 'loss_val': 2.555763553130625, 'psi': 0.2751714677640604}-{'f1_val': 0.2683496961196821, 'auprc': 0.2683496961196821, 'loss_val': 2.5548352363817917, 'psi': 0.2683496961196821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=46 head_norm_before_train=2.222646 cos_to_last_merge=0.9933 (last merge round=31)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.24211172498465316, 'auprc': 0.24211172498465316, 'loss_val': 1.642614819791612, 'psi': 0.24211172498465316}-{'f1_val': 0.2423795476892822, 'auprc': 0.2423795476892822, 'loss_val': 1.6316228772182735, 'psi': 0.2423795476892822}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=2.057646 (no previous merge yet)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2307900555846003, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1989951084115305, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=2.047158 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.79113733219207, 'psi': 0.019770114942528734}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.761625396218442, 'psi': 0.019770114942528734}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.619350 cos_to_last_merge=0.9860 (last merge round=31)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9123476104045753, 'psi': 0.23976608187134504}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9224993728541134, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=2.224498 cos_to_last_merge=0.9964 (last merge round=30)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1814359375226564, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1747807000986374, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.922162 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1397783655728464, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.124438934559734, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.995373 cos_to_last_merge=0.9752 (last merge round=25)
[S10] round=46 local utility u=0.034428 metrics={'f1_val': 0.24347655355916686, 'auprc': 0.24347655355916686, 'loss_val': 1.4705178701879957, 'psi': 0.24347655355916686}-{'f1_val': 0.23817666332349363, 'auprc': 0.23817666332349363, 'loss_val': 1.4916757853771379, 'psi': 0.23817666332349363}
[S10] not sending this round → trigger blocked (psi=0.243)
[S11] START round=46 head_norm_before_train=1.777471 cos_to_last_merge=0.9392 (last merge round=30)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.291973791973792, 'auprc': 0.291973791973792, 'loss_val': 2.4704851739228744, 'psi': 0.291973791973792}-{'f1_val': 0.298826487845767, 'auprc': 0.298826487845767, 'loss_val': 2.4604357877516367, 'psi': 0.298826487845767}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.991528 (no previous merge yet)
[S13] round=46 local utility u=0.112561 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3559147688481963, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5810364743725733, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S13] sending update (kind=head size=1809 to 1 peers)
[S14] START round=46 head_norm_before_train=1.919813 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.546150637783796, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.518222930670631, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.859709 cos_to_last_merge=0.9883 (last merge round=32)
[S15] round=46 local utility u=1.000000 metrics={'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.3470608887500045, 'psi': 0.8796705340794291}-{'f1_val': 0.6181359625605519, 'auprc': 0.6181359625605519, 'loss_val': 0.2704037007268746, 'psi': 0.6181359625605519}
[S15] not sending this round → trigger blocked (psi=0.880)
[S16] START round=46 head_norm_before_train=1.933205 (no previous merge yet)
[S16] round=46 local utility u=0.685286 metrics={'f1_val': 0.18659745790909696, 'auprc': 0.18659745790909696, 'loss_val': 3.5180473854250707, 'psi': 0.18659745790909696}-{'f1_val': 0.13873001906437896, 'auprc': 0.13873001906437896, 'loss_val': 4.457811589412277, 'psi': 0.13873001906437896}
[S16] not sending this round → trigger blocked (psi=0.187)
[S17] START round=46 head_norm_before_train=2.309566 (no previous merge yet)
[S17] round=46 local utility u=1.000000 metrics={'f1_val': 0.8409626271441701, 'auprc': 0.8409626271441701, 'loss_val': 0.6796380406952865, 'psi': 0.8409626271441701}-{'f1_val': 0.6138237240043157, 'auprc': 0.6138237240043157, 'loss_val': 1.4484181701595282, 'psi': 0.6138237240043157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=47 head_norm_before_train=2.226206 cos_to_last_merge=0.9473 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.2488542053759445, 'auprc': 0.2488542053759445, 'loss_val': 2.743488077518483, 'psi': 0.2488542053759445}-{'f1_val': 0.24908561155539025, 'auprc': 0.24908561155539025, 'loss_val': 2.725565147842969, 'psi': 0.24908561155539022}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.147548 cos_to_last_merge=0.9773 (last merge round=16)
[S3] round=47 local utility u=0.014092 metrics={'f1_val': 0.278904453272005, 'auprc': 0.278904453272005, 'loss_val': 2.5611768844368457, 'psi': 0.278904453272005}-{'f1_val': 0.2751714677640604, 'auprc': 0.2751714677640604, 'loss_val': 2.555763553130625, 'psi': 0.2751714677640604}
[S3] not sending this round → trigger blocked (psi=0.279)
[S4] START round=47 head_norm_before_train=2.233910 cos_to_last_merge=0.9929 (last merge round=31)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.24211172498465316, 'auprc': 0.24211172498465316, 'loss_val': 1.6543803735127574, 'psi': 0.24211172498465316}-{'f1_val': 0.24211172498465316, 'auprc': 0.24211172498465316, 'loss_val': 1.642614819791612, 'psi': 0.24211172498465316}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=2.073943 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.268857435947221, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2307900555846003, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=2.052153 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.812495645904514, 'psi': 0.019770114942528734}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.79113733219207, 'psi': 0.019770114942528734}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.626224 cos_to_last_merge=0.9853 (last merge round=31)
[S7] round=47 local utility u=0.532665 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9269965431457277, 'psi': 0.35976373724718097}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9123476104045753, 'psi': 0.23976608187134504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=47 head_norm_before_train=2.232731 cos_to_last_merge=0.9961 (last merge round=30)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.221473767079456, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1814359375226564, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.927317 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.154151020579854, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1397783655728464, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.006537 cos_to_last_merge=0.9745 (last merge round=25)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.2412814482882237, 'auprc': 0.2412814482882237, 'loss_val': 1.492950857206567, 'psi': 0.24128144828822373}-{'f1_val': 0.24347655355916686, 'auprc': 0.24347655355916686, 'loss_val': 1.4705178701879957, 'psi': 0.24347655355916686}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.786868 cos_to_last_merge=0.9379 (last merge round=30)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.2850859656137545, 'auprc': 0.2850859656137545, 'loss_val': 2.478595578297085, 'psi': 0.2850859656137545}-{'f1_val': 0.291973791973792, 'auprc': 0.291973791973792, 'loss_val': 2.4704851739228744, 'psi': 0.291973791973792}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=2.002511 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.565000770110082, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3559147688481963, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.925118 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.572579652322391, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.546150637783796, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.872907 cos_to_last_merge=0.9875 (last merge round=32)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.4664345556095745, 'psi': 0.6175834097438502}-{'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.3470608887500045, 'psi': 0.8796705340794291}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.938612 (no previous merge yet)
[S16] round=47 local utility u=0.430613 metrics={'f1_val': 0.20767322008016798, 'auprc': 0.20767322008016798, 'loss_val': 2.846503085057157, 'psi': 0.20767322008016798}-{'f1_val': 0.18659745790909696, 'auprc': 0.18659745790909696, 'loss_val': 3.5180473854250707, 'psi': 0.18659745790909696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=47 head_norm_before_train=2.319299 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.7077241351369146, 'auprc': 0.7077241351369146, 'loss_val': 1.275418684172115, 'psi': 0.7077241351369146}-{'f1_val': 0.8409626271441701, 'auprc': 0.8409626271441701, 'loss_val': 0.6796380406952865, 'psi': 0.8409626271441701}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=2.231539 cos_to_last_merge=0.9467 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.24894671623296158, 'auprc': 0.24894671623296158, 'loss_val': 2.757306212493963, 'psi': 0.24894671623296158}-{'f1_val': 0.2488542053759445, 'auprc': 0.2488542053759445, 'loss_val': 2.743488077518483, 'psi': 0.2488542053759445}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.153244 cos_to_last_merge=0.9767 (last merge round=16)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.26014998707008014, 'auprc': 0.26014998707008014, 'loss_val': 2.6129454230995752, 'psi': 0.26014998707008014}-{'f1_val': 0.278904453272005, 'auprc': 0.278904453272005, 'loss_val': 2.5611768844368457, 'psi': 0.278904453272005}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.245327 cos_to_last_merge=0.9925 (last merge round=31)
[S4] round=48 local utility u=0.004142 metrics={'f1_val': 0.2428272380248738, 'auprc': 0.2428272380248738, 'loss_val': 1.6525351481256334, 'psi': 0.2428272380248738}-{'f1_val': 0.24211172498465316, 'auprc': 0.24211172498465316, 'loss_val': 1.6543803735127574, 'psi': 0.24211172498465316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=48 head_norm_before_train=2.088513 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.277735833715679, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.268857435947221, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=2.057041 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.840477605116646, 'psi': 0.019770114942528734}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.812495645904514, 'psi': 0.019770114942528734}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.632514 cos_to_last_merge=0.9845 (last merge round=31)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9379560696583106, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9269965431457277, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.241566 cos_to_last_merge=0.9958 (last merge round=30)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.244660451665393, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.221473767079456, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.932295 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1669275281478804, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.154151020579854, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.016784 cos_to_last_merge=0.9738 (last merge round=25)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.2370135074114765, 'auprc': 0.2370135074114765, 'loss_val': 1.5511745042810225, 'psi': 0.2370135074114765}-{'f1_val': 0.2412814482882237, 'auprc': 0.2412814482882237, 'loss_val': 1.492950857206567, 'psi': 0.24128144828822373}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.796042 cos_to_last_merge=0.9367 (last merge round=30)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.2848581701957651, 'auprc': 0.2848581701957651, 'loss_val': 2.4949971534880535, 'psi': 0.2848581701957651}-{'f1_val': 0.2850859656137545, 'auprc': 0.2850859656137545, 'loss_val': 2.478595578297085, 'psi': 0.2850859656137545}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=2.014696 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6481681224231601, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.565000770110082, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.930378 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.598194829625629, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.572579652322391, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.884882 cos_to_last_merge=0.9868 (last merge round=32)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.616923624538269, 'auprc': 0.616923624538269, 'loss_val': 0.49665772631927535, 'psi': 0.616923624538269}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.4664345556095745, 'psi': 0.6175834097438502}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.944584 (no previous merge yet)
[S16] round=48 local utility u=0.041137 metrics={'f1_val': 0.21019994937990383, 'auprc': 0.21019994937990383, 'loss_val': 2.7869687380358243, 'psi': 0.21019994937990383}-{'f1_val': 0.20767322008016798, 'auprc': 0.20767322008016798, 'loss_val': 2.846503085057157, 'psi': 0.20767322008016798}
[S16] not sending this round → trigger blocked (psi=0.210)
[S17] START round=48 head_norm_before_train=2.331615 (no previous merge yet)
[S17] round=48 local utility u=0.366197 metrics={'f1_val': 0.7613805451756579, 'auprc': 0.7613805451756579, 'loss_val': 1.0259328001715768, 'psi': 0.7613805451756579}-{'f1_val': 0.7077241351369146, 'auprc': 0.7077241351369146, 'loss_val': 1.275418684172115, 'psi': 0.7077241351369146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=49 head_norm_before_train=2.236634 cos_to_last_merge=0.9461 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.946
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.24820854954287128, 'auprc': 0.24820854954287128, 'loss_val': 2.774768905496981, 'psi': 0.24820854954287125}-{'f1_val': 0.24894671623296158, 'auprc': 0.24894671623296158, 'loss_val': 2.757306212493963, 'psi': 0.24894671623296158}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.158742 cos_to_last_merge=0.9762 (last merge round=16)
[S3] round=49 local utility u=0.012975 metrics={'f1_val': 0.262053687776909, 'auprc': 0.262053687776909, 'loss_val': 2.604127782034024, 'psi': 0.262053687776909}-{'f1_val': 0.26014998707008014, 'auprc': 0.26014998707008014, 'loss_val': 2.6129454230995752, 'psi': 0.26014998707008014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=49 head_norm_before_train=2.258627 cos_to_last_merge=0.9922 (last merge round=31)
[S4] round=49 local utility u=0.007998 metrics={'f1_val': 0.24300677757239678, 'auprc': 0.24300677757239678, 'loss_val': 1.6381543996874326, 'psi': 0.24300677757239678}-{'f1_val': 0.2428272380248738, 'auprc': 0.2428272380248738, 'loss_val': 1.6525351481256334, 'psi': 0.2428272380248738}
[S4] not sending this round → trigger blocked (psi=0.243)
[S5] START round=49 head_norm_before_train=2.097630 (no previous merge yet)
[S5] round=49 local utility u=0.019745 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.238246239373578, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.277735833715679, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=49 head_norm_before_train=2.061861 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.865786720831053, 'psi': 0.019770114942528734}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 8.840477605116646, 'psi': 0.019770114942528734}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.638885 cos_to_last_merge=0.9836 (last merge round=31)
[S7] round=49 local utility u=0.001917 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9341216054663363, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9379560696583106, 'psi': 0.35976373724718097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=49 head_norm_before_train=2.250919 cos_to_last_merge=0.9956 (last merge round=30)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.251876543091208, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.244660451665393, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.936954 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1788560842634874, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1669275281478804, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.026814 cos_to_last_merge=0.9732 (last merge round=25)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.23642734285135464, 'auprc': 0.23642734285135464, 'loss_val': 1.5821595760593705, 'psi': 0.23642734285135464}-{'f1_val': 0.2370135074114765, 'auprc': 0.2370135074114765, 'loss_val': 1.5511745042810225, 'psi': 0.2370135074114765}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.804585 cos_to_last_merge=0.9356 (last merge round=30)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=49 local utility u=0.002646 metrics={'f1_val': 0.2873841193067312, 'auprc': 0.2873841193067312, 'loss_val': 2.5124385271806955, 'psi': 0.2873841193067312}-{'f1_val': 0.2848581701957651, 'auprc': 0.2848581701957651, 'loss_val': 2.4949971534880535, 'psi': 0.2848581701957651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=49 head_norm_before_train=2.025949 (no previous merge yet)
[S13] round=49 local utility u=0.157459 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3332497543777564, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6481681224231601, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=49 head_norm_before_train=1.935612 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.6245284155550905, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.598194829625629, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.896774 cos_to_last_merge=0.9861 (last merge round=32)
[S15] round=49 local utility u=0.032617 metrics={'f1_val': 0.6080372935034378, 'auprc': 0.6080372935034378, 'loss_val': 0.3514467531951469, 'psi': 0.6080372935034378}-{'f1_val': 0.616923624538269, 'auprc': 0.616923624538269, 'loss_val': 0.49665772631927535, 'psi': 0.616923624538269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=49 head_norm_before_train=1.950509 (no previous merge yet)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.19451534786308003, 'auprc': 0.19451534786308003, 'loss_val': 3.1927848929057387, 'psi': 0.19451534786308003}-{'f1_val': 0.21019994937990383, 'auprc': 0.21019994937990383, 'loss_val': 2.7869687380358243, 'psi': 0.21019994937990383}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=2.339694 (no previous merge yet)
[S17] round=49 local utility u=0.169885 metrics={'f1_val': 0.7868332049089908, 'auprc': 0.7868332049089908, 'loss_val': 0.9152373811000678, 'psi': 0.7868332049089908}-{'f1_val': 0.7613805451756579, 'auprc': 0.7613805451756579, 'loss_val': 1.0259328001715768, 'psi': 0.7613805451756579}
[S17] not sending this round → trigger blocked (psi=0.787)
[runner] rounds complete.
[runner] all agents stopped.
