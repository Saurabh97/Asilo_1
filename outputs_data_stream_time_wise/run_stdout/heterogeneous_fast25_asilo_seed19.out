[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:61003
[S3] → join 127.0.0.1:61002
[S4] → join 127.0.0.1:61002
[S5] → join 127.0.0.1:61002
[S6] → join 127.0.0.1:61002
[S7] → join 127.0.0.1:61002
[S8] → join 127.0.0.1:61002
[S9] → join 127.0.0.1:61002
[S10] → join 127.0.0.1:61002
[S11] → join 127.0.0.1:61002
[S13] → join 127.0.0.1:61002
[S14] → join 127.0.0.1:61002
[S15] → join 127.0.0.1:61002
[S16] → join 127.0.0.1:61002
[S17] → join 127.0.0.1:61002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.159659 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.184510 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.193362 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.164962 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.119639 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.099103 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.148023 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.180689 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.144311 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.199902 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.104332 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.160651 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.190115 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.199319 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.141583 (no previous merge yet)
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S4] + discovered S3
[S3] + discovered S17
[S3] + discovered S16
[S3] + discovered S6
[S3] + discovered S15
[S3] + discovered S8
[S3] + discovered S5
[S3] + discovered S14
[S3] + discovered S4
[S3] + discovered S13
[S3] + discovered S7
[S3] + discovered S11
[S3] + discovered S10
[S3] + discovered S9
[S4] + discovered S2
[S4] + discovered S17
[S4] + discovered S8
[S4] + discovered S16
[S4] + discovered S6
[S4] + discovered S15
[S4] + discovered S5
[S4] + discovered S14
[S4] + discovered S13
[S4] + discovered S7
[S4] + discovered S11
[S4] + discovered S10
[S4] + discovered S9
[S5] + discovered S4
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S17
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S7
[S5] + discovered S14
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S8
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S4
[S5] + discovered S13
[S7] + discovered S3
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S4
[S6] + discovered S14
[S6] + discovered S15
[S6] + discovered S7
[S6] + discovered S16
[S6] + discovered S10
[S6] + discovered S17
[S6] + discovered S13
[S6] + discovered S8
[S6] + discovered S9
[S6] + discovered S11
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S5
[S8] + discovered S2
[S8] + discovered S6
[S8] + discovered S3
[S7] + discovered S8
[S7] + discovered S17
[S7] + discovered S13
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S11
[S7] + discovered S10
[S7] + discovered S16
[S7] + discovered S14
[S9] + discovered S3
[S9] + discovered S2
[S9] + discovered S7
[S9] + discovered S4
[S9] + discovered S6
[S9] + discovered S5
[S9] + discovered S8
[S8] + discovered S14
[S8] + discovered S16
[S8] + discovered S11
[S8] + discovered S13
[S8] + discovered S17
[S8] + discovered S10
[S8] + discovered S15
[S8] + discovered S9
[S10] + discovered S8
[S10] + discovered S6
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S5
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S3
[S9] + discovered S15
[S9] + discovered S17
[S9] + discovered S13
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S10
[S9] + discovered S16
[S11] + discovered S10
[S10] + discovered S15
[S10] + discovered S13
[S10] + discovered S14
[S10] + discovered S11
[S10] + discovered S16
[S10] + discovered S17
[S11] + discovered S4
[S11] + discovered S3
[S11] + discovered S8
[S11] + discovered S6
[S11] + discovered S2
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S7
[S13] + discovered S7
[S13] + discovered S9
[S11] + discovered S15
[S13] + discovered S2
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S3
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S10
[S11] + discovered S16
[S11] + discovered S14
[S11] + discovered S13
[S11] + discovered S17
[S13] + discovered S5
[S14] + discovered S13
[S14] + discovered S11
[S14] + discovered S3
[S14] + discovered S2
[S14] + discovered S10
[S14] + discovered S4
[S14] + discovered S8
[S14] + discovered S6
[S14] + discovered S9
[S14] + discovered S5
[S13] + discovered S16
[S14] + discovered S7
[S13] + discovered S17
[S13] + discovered S14
[S13] + discovered S15
[S15] + discovered S7
[S15] + discovered S5
[S15] + discovered S9
[S15] + discovered S8
[S15] + discovered S10
[S15] + discovered S3
[S15] + discovered S14
[S15] + discovered S13
[S15] + discovered S6
[S15] + discovered S4
[S15] + discovered S2
[S15] + discovered S11
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S16] + discovered S11
[S16] + discovered S2
[S16] + discovered S6
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S5
[S16] + discovered S4
[S16] + discovered S15
[S16] + discovered S13
[S16] + discovered S3
[S16] + discovered S8
[S16] + discovered S9
[S16] + discovered S7
[S15] + discovered S17
[S15] + discovered S16
[S17] + discovered S9
[S17] + discovered S3
[S17] + discovered S11
[S17] + discovered S4
[S17] + discovered S6
[S17] + discovered S14
[S17] + discovered S13
[S17] + discovered S15
[S17] + discovered S16
[S17] + discovered S8
[S17] + discovered S10
[S17] + discovered S5
[S17] + discovered S7
[S17] + discovered S2
[S16] + discovered S17
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:61015
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:61017
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:61017
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S5] ⇄ pheromone p=1.000 → S11@127.0.0.1:61012
[S11] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:61017
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:61008
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S2] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:61014
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:61008
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:61010
[S3] ⇄ pheromone p=1.000 → S11@127.0.0.1:61012
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:61013
[S2] START round=1 head_norm_before_train=1.150383 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4435238768877166, 'psi': 0.0}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.3710576870392126, 'psi': 0.3674775928297055}
[S3] START round=1 head_norm_before_train=1.205950 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8276573084922918, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5681395822707722, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.192723 (no previous merge yet)
[S4] round=1 local utility u=0.204917 metrics={'f1_val': 0.31640668215510565, 'auprc': 0.31640668215510565, 'loss_val': 1.4596622061860711, 'psi': 0.31640668215510565}-{'f1_val': 0.2675799086757991, 'auprc': 0.2675799086757991, 'loss_val': 1.4300558787413136, 'psi': 0.2675799086757991}
[S5] START round=1 head_norm_before_train=1.171733 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.491575753041378, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3902644432517501, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.132706 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5152617470972878, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4284659896062515, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.106115 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.679260356550179, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4957025451626826, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.152870 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4298626240090986, 'psi': 0.0}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.3954880179513836, 'psi': 0.30506182380216385}
[S9] START round=1 head_norm_before_train=1.207864 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8638725352423229, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5433025538083482, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.153489 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5107034697987263, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4548765216117658, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.207484 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4919988872789038, 'psi': 0.0}-{'f1_val': 0.008576998050682261, 'auprc': 0.008576998050682261, 'loss_val': 1.389269237762884, 'psi': 0.008576998050682261}
[S13] START round=1 head_norm_before_train=1.103932 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4400609846832437, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4001933762109786, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.158173 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5169490903755487, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4400452211759278, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.206827 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6209458408132689, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5136716599848936, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.205622 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6134486990616732, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5312527821954256, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.149279 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5902655000663304, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5263744252417433, 'psi': 0.0}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S4] → sending delta(kind=head bytes=1786) to S8@127.0.0.1:61009
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1786 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1786) from S4
[S8] cosine check vs S4: cos=0.0391
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.0000 head_norm=1.166128
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.215008e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.0000 head_norm=0.854245 delta_norm=0.821501
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.154864 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5595263327935327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4435238768877166, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.257068 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7326196530870983, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8276573084922918, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.203885 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5059258048174018, 'psi': 0.0}-{'f1_val': 0.31640668215510565, 'auprc': 0.31640668215510565, 'loss_val': 1.4596622061860711, 'psi': 0.31640668215510565}
[S5] START round=2 head_norm_before_train=1.205683 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8023267514941825, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.491575753041378, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.158590 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6933896368722254, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5152617470972878, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.143835 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.018066542240589, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.679260356550179, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=0.854245 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4457023443815957, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4298626240090986, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.264269 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.786791939773972, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8638725352423229, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.173939 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6376717574950381, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5107034697987263, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.229787 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7579015028115954, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4919988872789038, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.112684 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5036613995167396, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4400609846832437, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.168170 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6333776868068375, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5169490903755487, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.234115 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8412765606119703, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6209458408132689, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.223684 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7526134709162822, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6134486990616732, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.166894 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7107883833584134, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5902655000663304, 'psi': 0.0}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.172043 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8467144882060278, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5595263327935327, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.318010 (no previous merge yet)
[S3] round=3 local utility u=0.111454 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5097113712833914, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7326196530870983, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.224464 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.603552118955976, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5059258048174018, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.250104 (no previous merge yet)
[S5] round=3 local utility u=0.120948 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5604313080531464, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8023267514941825, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.196991 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1533394675528776, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6933896368722254, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.177712 (no previous merge yet)
[S7] round=3 local utility u=0.081904 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8542585050393938, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.018066542240589, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=0.866925 cos_to_last_merge=0.9962 (last merge round=1)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.527921457234495, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4457023443815957, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.328492 (no previous merge yet)
[S9] round=3 local utility u=0.110610 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5655717323861884, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.786791939773972, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.207739 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8918505838660853, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6376717574950381, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.264173 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5726250199488194, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7579015028115954, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.132247 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6559612291318504, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5036613995167396, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.189855 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8748392145450763, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6333776868068375, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.266491 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1912049100003985, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8412765606119703, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.255380 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.112999283250916, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7526134709162822, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.193266 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9580385092834982, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7107883833584134, 'psi': 0.0}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.200460 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5133612005447605, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8467144882060278, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.351629 (no previous merge yet)
[S3] round=4 local utility u=0.153012 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.20368759540929, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5097113712833914, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.253641 (no previous merge yet)
[S4] round=4 local utility u=0.449709 metrics={'f1_val': 0.11239495798319328, 'auprc': 0.11239495798319328, 'loss_val': 1.7156878552869248, 'psi': 0.11239495798319328}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.603552118955976, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.253997 (no previous merge yet)
[S5] round=4 local utility u=0.476392 metrics={'f1_val': 0.09436008676789588, 'auprc': 0.09436008676789588, 'loss_val': 1.4568879162901869, 'psi': 0.09436008676789588}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5604313080531464, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.243164 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0581475164480234, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1533394675528776, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.183119 (no previous merge yet)
[S7] round=4 local utility u=0.024969 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8043203311535865, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8542585050393938, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=0.892872 cos_to_last_merge=0.9855 (last merge round=1)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7349255940701527, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.527921457234495, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.370237 (no previous merge yet)
[S9] round=4 local utility u=0.053814 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.457944507518531, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5655717323861884, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.242836 (no previous merge yet)
[S10] round=4 local utility u=0.022071 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8477081585147381, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8918505838660853, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.302517 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9163072924680717, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5726250199488194, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.159495 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9433742874547104, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6559612291318504, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.222214 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4132073617293615, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8748392145450763, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.294768 (no previous merge yet)
[S15] round=4 local utility u=0.015336 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1605336038331497, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1912049100003985, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.300364 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5616555143213864, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.112999283250916, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.224440 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.986676517993076, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9580385092834982, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:61009
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.094)
[S4] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S4
[S8] cosine check vs S4: cos=0.6547
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.0000 head_norm=0.923836
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.869576e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.0000 head_norm=1.006749 delta_norm=0.486958
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.233522 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8399659318531896, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5133612005447605, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.398935 (no previous merge yet)
[S3] round=5 local utility u=0.041801 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1200855068148106, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.20368759540929, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.283694 (no previous merge yet)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.09939301972685888, 'auprc': 0.09939301972685888, 'loss_val': 1.671417725689851, 'psi': 0.09939301972685888}-{'f1_val': 0.11239495798319328, 'auprc': 0.11239495798319328, 'loss_val': 1.7156878552869248, 'psi': 0.11239495798319328}
[S5] START round=5 head_norm_before_train=1.279234 (no previous merge yet)
[S5] round=5 local utility u=1.000000 metrics={'f1_val': 0.3230510021854774, 'auprc': 0.3230510021854774, 'loss_val': 1.3151180353947878, 'psi': 0.3230510021854774}-{'f1_val': 0.09436008676789588, 'auprc': 0.09436008676789588, 'loss_val': 1.4568879162901869, 'psi': 0.09436008676789588}
[S6] START round=5 head_norm_before_train=1.288114 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1107203078852286, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0581475164480234, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.204284 (no previous merge yet)
[S7] round=5 local utility u=0.081810 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6406997092535356, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8043203311535865, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.006749 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.029342 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6762423753212963, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7349255940701527, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.425982 (no previous merge yet)
[S9] round=5 local utility u=0.121934 metrics={'f1_val': 0.0030602636534839923, 'auprc': 0.0030602636534839923, 'loss_val': 2.241619044741415, 'psi': 0.0030602636534839923}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.457944507518531, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.255634 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8495655722208693, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8477081585147381, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.322475 (no previous merge yet)
[S11] round=5 local utility u=0.308527 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.299253919649295, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9163072924680717, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.184875 (no previous merge yet)
[S13] round=5 local utility u=0.057944 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8274861720153999, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9433742874547104, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.258931 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.139656253490732, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4132073617293615, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.308679 (no previous merge yet)
[S15] round=5 local utility u=0.049398 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0617377730536486, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1605336038331497, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.337125 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.665115602074693, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5616555143213864, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.242904 (no previous merge yet)
[S17] round=5 local utility u=0.099554 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7875687091018193, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.986676517993076, 'psi': 0.0}
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.003)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] cosine check vs S5: cos=-0.0739
[S11] DROPPED delta from S5 (cos=-0.0739 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S13] ⇄ pheromone p=0.339 → S7@127.0.0.1:61008
[S8] ⇄ pheromone p=0.334 → S15@127.0.0.1:61015
[S15] ⇄ pheromone p=0.340 → S9@127.0.0.1:61010
[S2] ⇄ pheromone p=0.328 → S8@127.0.0.1:61009
[S11] ⇄ pheromone p=0.389 → S8@127.0.0.1:61009
[S4] ⇄ pheromone p=0.416 → S8@127.0.0.1:61009
[S3] ⇄ pheromone p=0.375 → S11@127.0.0.1:61012
[S9] ⇄ pheromone p=0.375 → S17@127.0.0.1:61017
[S7] ⇄ pheromone p=0.359 → S17@127.0.0.1:61017
[S14] ⇄ pheromone p=0.328 → S8@127.0.0.1:61009
[S10] ⇄ pheromone p=0.331 → S14@127.0.0.1:61014
[S6] ⇄ pheromone p=0.328 → S17@127.0.0.1:61017
[S5] ⇄ pheromone p=0.619 → S11@127.0.0.1:61012
[S17] ⇄ pheromone p=0.348 → S13@127.0.0.1:61013
[S16] ⇄ pheromone p=0.328 → S7@127.0.0.1:61008
[S2] START round=6 head_norm_before_train=1.259446 (no previous merge yet)
[S2] round=6 local utility u=0.002979 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8340082195209053, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8399659318531896, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.464735 (no previous merge yet)
[S3] round=6 local utility u=0.100312 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.919461584998513, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1200855068148106, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.308984 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5531861215744032, 'psi': 0.0}-{'f1_val': 0.09939301972685888, 'auprc': 0.09939301972685888, 'loss_val': 1.671417725689851, 'psi': 0.09939301972685888}
[S5] START round=6 head_norm_before_train=1.310273 (no previous merge yet)
[S5] round=6 local utility u=1.000000 metrics={'f1_val': 0.998874035668551, 'auprc': 0.998874035668551, 'loss_val': 1.2228149408825217, 'psi': 0.998874035668551}-{'f1_val': 0.3230510021854774, 'auprc': 0.3230510021854774, 'loss_val': 1.3151180353947878, 'psi': 0.3230510021854774}
[S6] START round=6 head_norm_before_train=1.315307 (no previous merge yet)
[S6] round=6 local utility u=0.141426 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.82786814824935, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1107203078852286, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.228865 (no previous merge yet)
[S7] round=6 local utility u=0.071624 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4974512269055864, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6406997092535356, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.018799 cos_to_last_merge=0.9976 (last merge round=4)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7583707921900191, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6762423753212963, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.483851 (no previous merge yet)
[S9] round=6 local utility u=0.916295 metrics={'f1_val': 0.17793254130820702, 'auprc': 0.17793254130820702, 'loss_val': 1.9828795880918344, 'psi': 0.17793254130820702}-{'f1_val': 0.0030602636534839923, 'auprc': 0.0030602636534839923, 'loss_val': 2.241619044741415, 'psi': 0.0030602636534839923}
[S10] START round=6 head_norm_before_train=1.275952 (no previous merge yet)
[S10] round=6 local utility u=0.026921 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.795723796594949, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8495655722208693, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.327422 (no previous merge yet)
[S11] round=6 local utility u=0.050450 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1983533750522724, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.299253919649295, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.185969 (no previous merge yet)
[S13] round=6 local utility u=0.042957 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7415731351541524, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8274861720153999, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.291132 (no previous merge yet)
[S14] round=6 local utility u=0.040132 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.059391491207925, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.139656253490732, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.323368 (no previous merge yet)
[S15] round=6 local utility u=0.064448 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.932842501813505, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0617377730536486, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.367945 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.901457699455868, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.665115602074693, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.255511 (no previous merge yet)
[S17] round=6 local utility u=0.060009 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6675515484956016, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7875687091018193, 'psi': 0.0}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.178)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[S11] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=-0.0642
[S11] DROPPED delta from S5 (cos=-0.0642 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=7 head_norm_before_train=1.285017 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.063382118666097, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8340082195209053, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.529176 (no previous merge yet)
[S3] round=7 local utility u=0.461597 metrics={'f1_val': 0.09875818910726508, 'auprc': 0.09875818910726508, 'loss_val': 1.8850904241852893, 'psi': 0.09875818910726508}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.919461584998513, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.337600 (no previous merge yet)
[S4] round=7 local utility u=0.039312 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4745631026795807, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5531861215744032, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.345485 (no previous merge yet)
[S5] round=7 local utility u=0.028570 metrics={'f1_val': 0.9994369411582424, 'auprc': 0.9994369411582424, 'loss_val': 1.1707417127215856, 'psi': 0.9994369411582424}-{'f1_val': 0.998874035668551, 'auprc': 0.998874035668551, 'loss_val': 1.2228149408825217, 'psi': 0.998874035668551}
[S6] START round=7 head_norm_before_train=1.338682 (no previous merge yet)
[S6] round=7 local utility u=0.078228 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6714117717513135, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.82786814824935, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.258427 (no previous merge yet)
[S7] round=7 local utility u=0.016661 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4641301911153872, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4974512269055864, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.037343 cos_to_last_merge=0.9916 (last merge round=4)
[S8] round=7 local utility u=0.064207 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6299557984226956, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7583707921900191, 'psi': 0.0}
[S9] START round=7 head_norm_before_train=1.544492 (no previous merge yet)
[S9] round=7 local utility u=0.860983 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9775668389444776, 'psi': 0.36867172340800847}-{'f1_val': 0.17793254130820702, 'auprc': 0.17793254130820702, 'loss_val': 1.9828795880918344, 'psi': 0.17793254130820702}
[S10] START round=7 head_norm_before_train=1.300335 (no previous merge yet)
[S10] round=7 local utility u=0.040161 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7154023600486634, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.795723796594949, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.342345 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6021563703855306, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1983533750522724, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.191587 (no previous merge yet)
[S13] round=7 local utility u=0.019615 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7023432243314809, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7415731351541524, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.306219 (no previous merge yet)
[S14] round=7 local utility u=0.122682 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.814027338089246, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.059391491207925, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.340081 (no previous merge yet)
[S15] round=7 local utility u=0.032180 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8684833656997073, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.932842501813505, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.408004 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.948578454319451, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.901457699455868, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.278229 (no previous merge yet)
[S17] round=7 local utility u=1.000000 metrics={'f1_val': 0.20774862721171447, 'auprc': 0.20774862721171447, 'loss_val': 1.472645626613277, 'psi': 0.20774862721171447}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6675515484956016, 'psi': 0.0}
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:61017
[S3] not sending this round → trigger blocked (psi=0.099)
[S15] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=-0.0248
[S17] DROPPED delta from S9 (cos=-0.0248 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=-0.0581
[S11] DROPPED delta from S5 (cos=-0.0581 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:61013
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S17
[S13] cosine check vs S17: cos=0.0605
[S13] not sending this round → trigger blocked (psi=0.000)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.0000 head_norm=1.203909
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.599129e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.0000 head_norm=0.913450 delta_norm=0.859913
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.309774 (no previous merge yet)
[S2] round=8 local utility u=0.006896 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.049591070803704, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.063382118666097, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.586082 (no previous merge yet)
[S3] round=8 local utility u=1.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.6997518964996334, 'psi': 0.3641628959276018}-{'f1_val': 0.09875818910726508, 'auprc': 0.09875818910726508, 'loss_val': 1.8850904241852893, 'psi': 0.09875818910726508}
[S4] START round=8 head_norm_before_train=1.373532 (no previous merge yet)
[S4] round=8 local utility u=0.016088 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4423864672041586, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4745631026795807, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.384224 (no previous merge yet)
[S5] round=8 local utility u=0.016430 metrics={'f1_val': 0.9994369411582424, 'auprc': 0.9994369411582424, 'loss_val': 1.137881945520701, 'psi': 0.9994369411582424}-{'f1_val': 0.9994369411582424, 'auprc': 0.9994369411582424, 'loss_val': 1.1707417127215856, 'psi': 0.9994369411582424}
[S6] START round=8 head_norm_before_train=1.370918 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0422542916392668, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6714117717513135, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.290065 (no previous merge yet)
[S7] round=8 local utility u=0.018940 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4262495154421893, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4641301911153872, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.053694 cos_to_last_merge=0.9863 (last merge round=4)
[S8] round=8 local utility u=1.000000 metrics={'f1_val': 0.26133730552797085, 'auprc': 0.26133730552797085, 'loss_val': 1.4950875894508966, 'psi': 0.26133730552797085}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6299557984226956, 'psi': 0.0}
[S9] START round=8 head_norm_before_train=1.602677 (no previous merge yet)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2457175227427166, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9775668389444776, 'psi': 0.36867172340800847}
[S10] START round=8 head_norm_before_train=1.328080 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7197299628371896, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7154023600486634, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.367426 (no previous merge yet)
[S11] round=8 local utility u=0.202247 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.197662941205249, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6021563703855306, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=0.913450 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.058152 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5860398175531327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7023432243314809, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.321864 (no previous merge yet)
[S14] round=8 local utility u=0.020577 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.772872605955133, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.814027338089246, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.362455 (no previous merge yet)
[S15] round=8 local utility u=0.988781 metrics={'f1_val': 0.1897090646790094, 'auprc': 0.1897090646790094, 'loss_val': 1.5983027530701102, 'psi': 0.1897090646790094}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8684833656997073, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.446796 (no previous merge yet)
[S16] round=8 local utility u=0.099758 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7490631834825754, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.948578454319451, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.303182 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.1623269270510436, 'auprc': 0.1623269270510436, 'loss_val': 1.3456068728919404, 'psi': 0.1623269270510436}-{'f1_val': 0.20774862721171447, 'auprc': 0.20774862721171447, 'loss_val': 1.472645626613277, 'psi': 0.20774862721171447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:61012
[S4] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:61015
[S2] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61012
[S15] not sending this round → trigger blocked (psi=0.190)
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] cosine check vs S5: cos=-0.0520
[S11] DROPPED delta from S5 (cos=-0.0520 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S8
[S15] cosine check vs S8: cos=0.0957
[S11] RECEIVED delta(kind=head bytes=1792) from S3
[S11] cosine check vs S3: cos=-0.0236
[S11] DROPPED delta from S3 (cos=-0.0236 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.1897 head_norm=1.385821
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.364050e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.2494 head_norm=0.917929 delta_norm=0.836405
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.338908 (no previous merge yet)
[S2] round=9 local utility u=0.224428 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.600734197218253, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.049591070803704, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.634541 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.8209882111843791, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.6997518964996334, 'psi': 0.3641628959276018}
[S4] START round=9 head_norm_before_train=1.411900 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.470697381046913, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4423864672041586, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.426294 (no previous merge yet)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.6647293003369455, 'auprc': 0.6647293003369455, 'loss_val': 1.1020839918797327, 'psi': 0.6647293003369455}-{'f1_val': 0.9994369411582424, 'auprc': 0.9994369411582424, 'loss_val': 1.137881945520701, 'psi': 0.9994369411582424}
[S6] START round=9 head_norm_before_train=1.410315 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.186619166419156, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0422542916392668, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.318015 (no previous merge yet)
[S7] round=9 local utility u=0.624046 metrics={'f1_val': 0.1348110465116279, 'auprc': 0.1348110465116279, 'loss_val': 1.3914567826245623, 'psi': 0.1348110465116279}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4262495154421893, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.078812 cos_to_last_merge=0.9794 (last merge round=4)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.22765282583621685, 'auprc': 0.22765282583621685, 'loss_val': 1.38686799099209, 'psi': 0.22765282583621688}-{'f1_val': 0.26133730552797085, 'auprc': 0.26133730552797085, 'loss_val': 1.4950875894508966, 'psi': 0.26133730552797085}
[S9] START round=9 head_norm_before_train=1.650565 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4501175124766505, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2457175227427166, 'psi': 0.36867172340800847}
[S10] START round=9 head_norm_before_train=1.360606 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.02776523702031603, 'auprc': 0.02776523702031603, 'loss_val': 2.073464065764946, 'psi': 0.027765237020316025}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7197299628371896, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.389277 (no previous merge yet)
[S11] round=9 local utility u=0.115788 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9660875281800843, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.197662941205249, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=0.931578 cos_to_last_merge=0.9986 (last merge round=7)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6359030826780707, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5860398175531327, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.343013 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9103841368965235, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.772872605955133, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=0.917929 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.16987087517934005, 'auprc': 0.16987087517934005, 'loss_val': 1.5272259188239716, 'psi': 0.16987087517934005}-{'f1_val': 0.1897090646790094, 'auprc': 0.1897090646790094, 'loss_val': 1.5983027530701102, 'psi': 0.1897090646790094}
[S16] START round=9 head_norm_before_train=1.482539 (no previous merge yet)
[S16] round=9 local utility u=0.104798 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5394662967350263, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7490631834825754, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.332389 (no previous merge yet)
[S17] round=9 local utility u=0.215319 metrics={'f1_val': 0.20281435579654014, 'auprc': 0.20281435579654014, 'loss_val': 1.2793548896534874, 'psi': 0.20281435579654014}-{'f1_val': 0.1623269270510436, 'auprc': 0.1623269270510436, 'loss_val': 1.3456068728919404, 'psi': 0.1623269270510436}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.135)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.7153
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.0000 head_norm=0.959550
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.756298e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.077189 delta_norm=0.475630
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.370837 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4714214624551074, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.600734197218253, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.683714 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.045445227397808, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.8209882111843791, 'psi': 0.3641628959276018}
[S4] START round=10 head_norm_before_train=1.451384 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4807378652495466, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.470697381046913, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.462313 (no previous merge yet)
[S5] round=10 local utility u=0.027827 metrics={'f1_val': 0.6637451584486723, 'auprc': 0.6637451584486723, 'loss_val': 1.0375727502782752, 'psi': 0.6637451584486723}-{'f1_val': 0.6647293003369455, 'auprc': 0.6647293003369455, 'loss_val': 1.1020839918797327, 'psi': 0.6647293003369455}
[S6] START round=10 head_norm_before_train=1.449104 (no previous merge yet)
[S6] round=10 local utility u=0.006303 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.174013803016544, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.186619166419156, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.333663 (no previous merge yet)
[S7] round=10 local utility u=0.928591 metrics={'f1_val': 0.3331674133067861, 'auprc': 0.3331674133067861, 'loss_val': 1.3194829193800863, 'psi': 0.3331674133067861}-{'f1_val': 0.1348110465116279, 'auprc': 0.1348110465116279, 'loss_val': 1.3914567826245623, 'psi': 0.1348110465116279}
[S8] START round=10 head_norm_before_train=1.110294 cos_to_last_merge=0.9708 (last merge round=4)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.206567242281528, 'auprc': 0.206567242281528, 'loss_val': 1.3136500193866407, 'psi': 0.206567242281528}-{'f1_val': 0.22765282583621685, 'auprc': 0.22765282583621685, 'loss_val': 1.38686799099209, 'psi': 0.22765282583621688}
[S9] START round=10 head_norm_before_train=1.689142 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5614351907955935, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4501175124766505, 'psi': 0.36867172340800847}
[S10] START round=10 head_norm_before_train=1.395553 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.00706880301602262, 'auprc': 0.00706880301602262, 'loss_val': 2.660523216365785, 'psi': 0.00706880301602262}-{'f1_val': 0.02776523702031603, 'auprc': 0.02776523702031603, 'loss_val': 2.073464065764946, 'psi': 0.027765237020316025}
[S11] START round=10 head_norm_before_train=1.415800 (no previous merge yet)
[S11] round=10 local utility u=0.039335 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8874172665051239, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9660875281800843, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.077189 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.022874 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5901550547563965, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6359030826780707, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.367249 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9489133603020856, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9103841368965235, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=0.946706 cos_to_last_merge=0.9982 (last merge round=8)
[S15] round=10 local utility u=0.058975 metrics={'f1_val': 0.187932268065824, 'auprc': 0.187932268065824, 'loss_val': 1.5718283661005648, 'psi': 0.187932268065824}-{'f1_val': 0.16987087517934005, 'auprc': 0.16987087517934005, 'loss_val': 1.5272259188239716, 'psi': 0.16987087517934005}
[S16] START round=10 head_norm_before_train=1.515371 (no previous merge yet)
[S16] round=10 local utility u=0.016701 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5060633604836196, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5394662967350263, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.361023 (no previous merge yet)
[S17] round=10 local utility u=0.007683 metrics={'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 1.265758917347637, 'psi': 0.20301091942882987}-{'f1_val': 0.20281435579654014, 'auprc': 0.20281435579654014, 'loss_val': 1.2793548896534874, 'psi': 0.20281435579654014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:61017
[S16] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.188)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61012
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] cosine check vs S5: cos=-0.0455
[S11] DROPPED delta from S5 (cos=-0.0455 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S7
[S17] cosine check vs S7: cos=-0.0786
[S17] DROPPED delta from S7 (cos=-0.0786 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=0.9344
[S6] ⇄ pheromone p=0.128 → S17@127.0.0.1:61017
[S8] ⇄ pheromone p=0.244 → S15@127.0.0.1:61015
[S3] ⇄ pheromone p=0.306 → S11@127.0.0.1:61012
[S10] ⇄ pheromone p=0.115 → S14@127.0.0.1:61014
[S11] ⇄ pheromone p=0.184 → S8@127.0.0.1:61009
[S15] ⇄ pheromone p=0.258 → S9@127.0.0.1:61010
[S4] ⇄ pheromone p=0.143 → S8@127.0.0.1:61009
[S9] ⇄ pheromone p=0.286 → S17@127.0.0.1:61017
[S2] ⇄ pheromone p=0.144 → S8@127.0.0.1:61009
[S14] ⇄ pheromone p=0.126 → S8@127.0.0.1:61009
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.0000 head_norm=1.097926
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.661317e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.222143 delta_norm=0.266132
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.129 → S7@127.0.0.1:61008
[S5] ⇄ pheromone p=0.295 → S11@127.0.0.1:61012
[S7] ⇄ pheromone p=0.413 → S17@127.0.0.1:61017
[S17] ⇄ pheromone p=0.257 → S13@127.0.0.1:61013
[S16] ⇄ pheromone p=0.140 → S7@127.0.0.1:61008
[S2] START round=11 head_norm_before_train=1.403460 (no previous merge yet)
[S2] round=11 local utility u=0.325207 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.821006511170828, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4714214624551074, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.728890 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.2030327446598346, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.045445227397808, 'psi': 0.3641628959276018}
[S4] START round=11 head_norm_before_train=1.484401 (no previous merge yet)
[S4] round=11 local utility u=0.017138 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.44646223915744, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4807378652495466, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.504874 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.33484660280397555, 'auprc': 0.33484660280397555, 'loss_val': 1.4754435683976794, 'psi': 0.33484660280397555}-{'f1_val': 0.6637451584486723, 'auprc': 0.6637451584486723, 'loss_val': 1.0375727502782752, 'psi': 0.6637451584486723}
[S6] START round=11 head_norm_before_train=1.484362 (no previous merge yet)
[S6] round=11 local utility u=0.272189 metrics={'f1_val': 0.029080252479711452, 'auprc': 0.029080252479711452, 'loss_val': 2.891359020778667, 'psi': 0.029080252479711452}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.174013803016544, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.362194 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.23900364520048603, 'auprc': 0.23900364520048603, 'loss_val': 1.2671330951181778, 'psi': 0.23900364520048606}-{'f1_val': 0.3331674133067861, 'auprc': 0.3331674133067861, 'loss_val': 1.3194829193800863, 'psi': 0.3331674133067861}
[S8] START round=11 head_norm_before_train=1.146453 cos_to_last_merge=0.9605 (last merge round=4)
[S8] round=11 local utility u=0.009761 metrics={'f1_val': 0.20345316325215823, 'auprc': 0.20345316325215823, 'loss_val': 1.2661006319166135, 'psi': 0.20345316325215823}-{'f1_val': 0.206567242281528, 'auprc': 0.206567242281528, 'loss_val': 1.3136500193866407, 'psi': 0.206567242281528}
[S9] START round=11 head_norm_before_train=1.718413 (no previous merge yet)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.638547076536408, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5614351907955935, 'psi': 0.36867172340800847}
[S10] START round=11 head_norm_before_train=1.429700 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1405415090768694, 'psi': 0.0}-{'f1_val': 0.00706880301602262, 'auprc': 0.00706880301602262, 'loss_val': 2.660523216365785, 'psi': 0.00706880301602262}
[S11] START round=11 head_norm_before_train=1.447793 (no previous merge yet)
[S11] round=11 local utility u=0.046167 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7950826649876501, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8874172665051239, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.222143 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.046835 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.496486014130937, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5901550547563965, 'psi': 0.0}
[S14] START round=11 head_norm_before_train=1.393738 (no previous merge yet)
[S14] round=11 local utility u=0.064491 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8199315699989724, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9489133603020856, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=0.989661 cos_to_last_merge=0.9920 (last merge round=8)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.15342120566001163, 'auprc': 0.15342120566001163, 'loss_val': 1.437056311391187, 'psi': 0.15342120566001163}-{'f1_val': 0.187932268065824, 'auprc': 0.187932268065824, 'loss_val': 1.5718283661005648, 'psi': 0.187932268065824}
[S16] START round=11 head_norm_before_train=1.549097 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6206260763084837, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5060633604836196, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.386896 (no previous merge yet)
[S17] round=11 local utility u=0.014551 metrics={'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 1.2359495448912727, 'psi': 0.20293224827229864}-{'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 1.265758917347637, 'psi': 0.20301091942882987}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61015
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.029)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.5890
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=0.9779
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.1534 head_norm=1.034097
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.055692e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.1522 head_norm=0.986562 delta_norm=0.505569
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.0000 head_norm=1.237469
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.626189e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.315096 delta_norm=0.162619
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.432599 (no previous merge yet)
[S2] round=12 local utility u=1.000000 metrics={'f1_val': 0.2149522203485104, 'auprc': 0.2149522203485104, 'loss_val': 2.737601814353418, 'psi': 0.2149522203485104}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.821006511170828, 'psi': 0.0}
[S3] START round=12 head_norm_before_train=1.766593 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.3305734227774058, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.2030327446598346, 'psi': 0.3641628959276018}
[S4] START round=12 head_norm_before_train=1.510004 (no previous merge yet)
[S4] round=12 local utility u=0.018612 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4092381121486737, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.44646223915744, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.558412 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.33451112575104336, 'auprc': 0.33451112575104336, 'loss_val': 2.6794726475703388, 'psi': 0.33451112575104336}-{'f1_val': 0.33484660280397555, 'auprc': 0.33484660280397555, 'loss_val': 1.4754435683976794, 'psi': 0.33484660280397555}
[S6] START round=12 head_norm_before_train=1.518589 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.014862981885740827, 'auprc': 0.014862981885740827, 'loss_val': 3.268742939335972, 'psi': 0.014862981885740829}-{'f1_val': 0.029080252479711452, 'auprc': 0.029080252479711452, 'loss_val': 2.891359020778667, 'psi': 0.029080252479711452}
[S7] START round=12 head_norm_before_train=1.403207 (no previous merge yet)
[S7] round=12 local utility u=0.027874 metrics={'f1_val': 0.23807812125569136, 'auprc': 0.23807812125569136, 'loss_val': 1.2030557412943674, 'psi': 0.23807812125569136}-{'f1_val': 0.23900364520048603, 'auprc': 0.23900364520048603, 'loss_val': 1.2671330951181778, 'psi': 0.23900364520048606}
[S8] START round=12 head_norm_before_train=1.178326 cos_to_last_merge=0.9505 (last merge round=4)
[S8] round=12 local utility u=0.012485 metrics={'f1_val': 0.20353183810260378, 'auprc': 0.20353183810260378, 'loss_val': 1.2418395589061064, 'psi': 0.20353183810260378}-{'f1_val': 0.20345316325215823, 'auprc': 0.20345316325215823, 'loss_val': 1.2661006319166135, 'psi': 0.20345316325215823}
[S9] START round=12 head_norm_before_train=1.741829 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.710785586447564, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.638547076536408, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=1.462528 (no previous merge yet)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.430668346335794, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1405415090768694, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.481439 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.389563527309748, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7950826649876501, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.315096 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.034327 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4278318659452363, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.496486014130937, 'psi': 0.0}
[S14] START round=12 head_norm_before_train=1.423949 (no previous merge yet)
[S14] round=12 local utility u=0.149534 metrics={'f1_val': 0.07286230429546367, 'auprc': 0.07286230429546367, 'loss_val': 3.1766237220128266, 'psi': 0.07286230429546367}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8199315699989724, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=0.986562 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.263744 metrics={'f1_val': 0.20298775405526703, 'auprc': 0.20298775405526703, 'loss_val': 1.355667177296002, 'psi': 0.20298775405526703}-{'f1_val': 0.15342120566001163, 'auprc': 0.15342120566001163, 'loss_val': 1.437056311391187, 'psi': 0.15342120566001163}
[S16] START round=12 head_norm_before_train=1.581866 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9918300640481887, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6206260763084837, 'psi': 0.0}
[S17] START round=12 head_norm_before_train=1.407307 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.15214022854929304, 'auprc': 0.15214022854929304, 'loss_val': 1.2314469401187842, 'psi': 0.15214022854929304}-{'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 1.2359495448912727, 'psi': 0.20293224827229864}
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61015
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.0093
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.8780
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=-0.0818
[S17] DROPPED delta from S7 (cos=-0.0818 < 0.0)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:61010
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.073)
[S15] sending update (kind=head size=1790 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1790) from S15
[S9] cosine check vs S15: cos=-0.0148
[S9] DROPPED delta from S15 (cos=-0.0148 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.2035 head_norm=1.207815
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.450733e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.2037 head_norm=0.953782 delta_norm=0.945073
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.2030 head_norm=1.021964
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.897408e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.2029 head_norm=1.080585 delta_norm=0.289741
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.465234 (no previous merge yet)
[S2] round=13 local utility u=0.003759 metrics={'f1_val': 0.1988574957542072, 'auprc': 0.1988574957542072, 'loss_val': 2.5852311378653368, 'psi': 0.1988574957542072}-{'f1_val': 0.2149522203485104, 'auprc': 0.2149522203485104, 'loss_val': 2.737601814353418, 'psi': 0.2149522203485104}
[S3] START round=13 head_norm_before_train=1.796616 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.4282898593709077, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.3305734227774058, 'psi': 0.3641628959276018}
[S4] START round=13 head_norm_before_train=1.537311 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.412451709683988, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4092381121486737, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.605805 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.33459436738125264, 'auprc': 0.33459436738125264, 'loss_val': 2.8719433017571583, 'psi': 0.33459436738125264}-{'f1_val': 0.33451112575104336, 'auprc': 0.33451112575104336, 'loss_val': 2.6794726475703388, 'psi': 0.33451112575104336}
[S6] START round=13 head_norm_before_train=1.552199 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.61798546936274, 'psi': 0.0}-{'f1_val': 0.014862981885740827, 'auprc': 0.014862981885740827, 'loss_val': 3.268742939335972, 'psi': 0.014862981885740829}
[S7] START round=13 head_norm_before_train=1.435593 (no previous merge yet)
[S7] round=13 local utility u=0.580718 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1367911837578626, 'psi': 0.35976373724718097}-{'f1_val': 0.23807812125569136, 'auprc': 0.23807812125569136, 'loss_val': 1.2030557412943674, 'psi': 0.23807812125569136}
[S8] START round=13 head_norm_before_train=0.953782 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.2039261268242283, 'auprc': 0.2039261268242283, 'loss_val': 1.3058252718400687, 'psi': 0.2039261268242283}-{'f1_val': 0.20353183810260378, 'auprc': 0.20353183810260378, 'loss_val': 1.2418395589061064, 'psi': 0.20353183810260378}
[S9] START round=13 head_norm_before_train=1.762245 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7747653749264414, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.710785586447564, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=1.494816 (no previous merge yet)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.454844136504943, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.430668346335794, 'psi': 0.0}
[S11] START round=13 head_norm_before_train=1.518513 (no previous merge yet)
[S11] round=13 local utility u=0.127129 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1353051733092063, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.389563527309748, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.332105 cos_to_last_merge=0.9985 (last merge round=11)
[S13] round=13 local utility u=1.000000 metrics={'f1_val': 0.2894761242466389, 'auprc': 0.2894761242466389, 'loss_val': 1.3388414628361298, 'psi': 0.2894761242466389}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4278318659452363, 'psi': 0.0}
[S14] START round=13 head_norm_before_train=1.459508 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.894916883171459, 'psi': 0.13582554517133957}-{'f1_val': 0.07286230429546367, 'auprc': 0.07286230429546367, 'loss_val': 3.1766237220128266, 'psi': 0.07286230429546367}
[S15] START round=13 head_norm_before_train=1.080585 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.026231 metrics={'f1_val': 0.2044823354647032, 'auprc': 0.2044823354647032, 'loss_val': 1.316657400568052, 'psi': 0.2044823354647032}-{'f1_val': 0.20298775405526703, 'auprc': 0.20298775405526703, 'loss_val': 1.355667177296002, 'psi': 0.20298775405526703}
[S16] START round=13 head_norm_before_train=1.613834 (no previous merge yet)
[S16] round=13 local utility u=0.520149 metrics={'f1_val': 0.0938560760353021, 'auprc': 0.0938560760353021, 'loss_val': 2.7962373452839526, 'psi': 0.0938560760353021}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9918300640481887, 'psi': 0.0}
[S17] START round=13 head_norm_before_train=1.422374 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 1.2399779764071643, 'psi': 0.15222868217054264}-{'f1_val': 0.15214022854929304, 'auprc': 0.15214022854929304, 'loss_val': 1.2314469401187842, 'psi': 0.15214022854929304}
[S16] not sending this round → trigger blocked (psi=0.094)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:61010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61008
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S13] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S7
[S17] cosine check vs S7: cos=-0.0832
[S17] DROPPED delta from S7 (cos=-0.0832 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S15
[S9] cosine check vs S15: cos=-0.0138
[S9] DROPPED delta from S15 (cos=-0.0138 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=0.7483
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=-0.0707
[S7] DROPPED delta from S13 (cos=-0.0707 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.2039 head_norm=0.987889
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.007329e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.164889 delta_norm=0.500733
[S8] aggregate: ROLLBACK (f1_val pre=0.204 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.496488 (no previous merge yet)
[S2] round=14 local utility u=0.359008 metrics={'f1_val': 0.263908228897288, 'auprc': 0.263908228897288, 'loss_val': 2.452670999104396, 'psi': 0.263908228897288}-{'f1_val': 0.1988574957542072, 'auprc': 0.1988574957542072, 'loss_val': 2.5852311378653368, 'psi': 0.1988574957542072}
[S3] START round=14 head_norm_before_train=1.823550 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.482356524085756, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.4282898593709077, 'psi': 0.3641628959276018}
[S4] START round=14 head_norm_before_train=1.569347 (no previous merge yet)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4186848640607332, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.412451709683988, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.647452 (no previous merge yet)
[S5] round=14 local utility u=0.108300 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 2.6546012178093132, 'psi': 0.33451196111837667}-{'f1_val': 0.33459436738125264, 'auprc': 0.33459436738125264, 'loss_val': 2.8719433017571583, 'psi': 0.33459436738125264}
[S6] START round=14 head_norm_before_train=1.580391 (no previous merge yet)
[S6] round=14 local utility u=1.000000 metrics={'f1_val': 0.14019979331725801, 'auprc': 0.14019979331725801, 'loss_val': 3.466750331459238, 'psi': 0.14019979331725801}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.61798546936274, 'psi': 0.0}
[S7] START round=14 head_norm_before_train=1.459377 (no previous merge yet)
[S7] round=14 local utility u=0.026413 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0839647994631039, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1367911837578626, 'psi': 0.35976373724718097}
[S8] START round=14 head_norm_before_train=1.164889 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.018979 metrics={'f1_val': 0.21163382924540944, 'auprc': 0.21163382924540944, 'loss_val': 1.3372360618811716, 'psi': 0.21163382924540944}-{'f1_val': 0.2039261268242283, 'auprc': 0.2039261268242283, 'loss_val': 1.3058252718400687, 'psi': 0.2039261268242283}
[S9] START round=14 head_norm_before_train=1.780308 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.83215103085862, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7747653749264414, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.527062 (no previous merge yet)
[S10] round=14 local utility u=0.008296 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4382526188968896, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.454844136504943, 'psi': 0.0}
[S11] START round=14 head_norm_before_train=1.548487 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.668239130189086, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1353051733092063, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.352858 cos_to_last_merge=0.9947 (last merge round=11)
[S13] round=14 local utility u=0.254624 metrics={'f1_val': 0.3332514131236176, 'auprc': 0.3332514131236176, 'loss_val': 1.2235719052954508, 'psi': 0.3332514131236176}-{'f1_val': 0.2894761242466389, 'auprc': 0.2894761242466389, 'loss_val': 1.3388414628361298, 'psi': 0.2894761242466389}
[S14] START round=14 head_norm_before_train=1.497071 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.08333333333333333, 'auprc': 0.08333333333333333, 'loss_val': 5.405182947944544, 'psi': 0.08333333333333333}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.894916883171459, 'psi': 0.13582554517133957}
[S15] START round=14 head_norm_before_train=1.111657 cos_to_last_merge=0.9949 (last merge round=12)
[S15] round=14 local utility u=0.458712 metrics={'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.2950172662162702, 'psi': 0.3040138275398502}-{'f1_val': 0.2044823354647032, 'auprc': 0.2044823354647032, 'loss_val': 1.316657400568052, 'psi': 0.2044823354647032}
[S16] START round=14 head_norm_before_train=1.640870 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.015921518173045997, 'auprc': 0.015921518173045997, 'loss_val': 3.274216509710518, 'psi': 0.015921518173045997}-{'f1_val': 0.0938560760353021, 'auprc': 0.0938560760353021, 'loss_val': 2.7962373452839526, 'psi': 0.0938560760353021}
[S17] START round=14 head_norm_before_train=1.439349 (no previous merge yet)
[S17] round=14 local utility u=0.002369 metrics={'f1_val': 0.15246506211180125, 'auprc': 0.15246506211180125, 'loss_val': 1.2373674439108515, 'psi': 0.15246506211180125}-{'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 1.2399779764071643, 'psi': 0.15222868217054264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:61010
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:61015
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.140)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61012
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=0.9384
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] cosine check vs S13: cos=-0.0708
[S7] DROPPED delta from S13 (cos=-0.0708 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=-0.0847
[S17] DROPPED delta from S7 (cos=-0.0847 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=0.3566
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] cosine check vs S5: cos=-0.0401
[S11] DROPPED delta from S5 (cos=-0.0401 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=-0.0135
[S9] DROPPED delta from S15 (cos=-0.0135 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] cosine check vs S17: cos=0.9717
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.2116 head_norm=1.191966
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.899777e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.338648 delta_norm=0.289978
[S8] aggregate: ROLLBACK (f1_val pre=0.212 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.3333 head_norm=1.374129
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.734434e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.3332 head_norm=1.405464 delta_norm=0.173443
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.3040 head_norm=1.155256
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.658438e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.3040 head_norm=0.966619 delta_norm=0.665844
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.526875 (no previous merge yet)
[S2] round=15 local utility u=0.038983 metrics={'f1_val': 0.26489978902953587, 'auprc': 0.26489978902953587, 'loss_val': 2.3836293807541096, 'psi': 0.26489978902953587}-{'f1_val': 0.263908228897288, 'auprc': 0.263908228897288, 'loss_val': 2.452670999104396, 'psi': 0.263908228897288}
[S3] START round=15 head_norm_before_train=1.846639 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.575877897299171, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.482356524085756, 'psi': 0.3641628959276018}
[S4] START round=15 head_norm_before_train=1.601263 (no previous merge yet)
[S4] round=15 local utility u=0.001228 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4162298020313644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4186848640607332, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.687479 (no previous merge yet)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.846231011107526, 'psi': 0.33400978131092857}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 2.6546012178093132, 'psi': 0.33451196111837667}
[S6] START round=15 head_norm_before_train=1.598390 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.03844454264250994, 'auprc': 0.03844454264250994, 'loss_val': 4.098604351931454, 'psi': 0.03844454264250994}-{'f1_val': 0.14019979331725801, 'auprc': 0.14019979331725801, 'loss_val': 3.466750331459238, 'psi': 0.14019979331725801}
[S7] START round=15 head_norm_before_train=1.484998 (no previous merge yet)
[S7] round=15 local utility u=0.027772 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0284213392763097, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0839647994631039, 'psi': 0.35976373724718097}
[S8] START round=15 head_norm_before_train=1.338648 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.002655 metrics={'f1_val': 0.21163382924540944, 'auprc': 0.21163382924540944, 'loss_val': 1.3319265866299572, 'psi': 0.21163382924540944}-{'f1_val': 0.21163382924540944, 'auprc': 0.21163382924540944, 'loss_val': 1.3372360618811716, 'psi': 0.21163382924540944}
[S9] START round=15 head_norm_before_train=1.796256 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8784939364612447, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.83215103085862, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.557384 (no previous merge yet)
[S10] round=15 local utility u=0.074093 metrics={'f1_val': 0.0016674606955693187, 'auprc': 0.0016674606955693187, 'loss_val': 3.3050744681687845, 'psi': 0.0016674606955693187}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4382526188968896, 'psi': 0.0}
[S11] START round=15 head_norm_before_train=1.571493 (no previous merge yet)
[S11] round=15 local utility u=1.000000 metrics={'f1_val': 0.33247763516141576, 'auprc': 0.33247763516141576, 'loss_val': 2.0883193557203468, 'psi': 0.33247763516141576}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.668239130189086, 'psi': 0.0}
[S13] START round=15 head_norm_before_train=1.405464 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000700 metrics={'f1_val': 0.3330876934414149, 'auprc': 0.3330876934414149, 'loss_val': 1.2206974834509525, 'psi': 0.3330876934414149}-{'f1_val': 0.3332514131236176, 'auprc': 0.3332514131236176, 'loss_val': 1.2235719052954508, 'psi': 0.3332514131236176}
[S14] START round=15 head_norm_before_train=1.533769 (no previous merge yet)
[S14] round=15 local utility u=0.249281 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.37905120640545, 'psi': 0.13582554517133957}-{'f1_val': 0.08333333333333333, 'auprc': 0.08333333333333333, 'loss_val': 5.405182947944544, 'psi': 0.08333333333333333}
[S15] START round=15 head_norm_before_train=0.966619 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.013853 metrics={'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.2673122075758074, 'psi': 0.3040138275398502}-{'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.2950172662162702, 'psi': 0.3040138275398502}
[S16] START round=15 head_norm_before_train=1.662768 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.03218495013599275, 'auprc': 0.03218495013599275, 'loss_val': 3.427477988706203, 'psi': 0.03218495013599275}-{'f1_val': 0.015921518173045997, 'auprc': 0.015921518173045997, 'loss_val': 3.274216509710518, 'psi': 0.015921518173045997}
[S17] START round=15 head_norm_before_train=1.456912 (no previous merge yet)
[S17] round=15 local utility u=0.013617 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.2082720180346809, 'psi': 0.1522581895716224}-{'f1_val': 0.15246506211180125, 'auprc': 0.15246506211180125, 'loss_val': 1.2373674439108515, 'psi': 0.15246506211180125}
[S4] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.002)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.7388
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] cosine check vs S2: cos=0.9730
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=-0.0774
[S7] DROPPED delta from S13 (cos=-0.0774 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=-0.0842
[S17] DROPPED delta from S7 (cos=-0.0842 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=0.0008
[S8] RECEIVED delta(kind=head bytes=1804) from S11
[S8] cosine check vs S11: cos=-0.0091
[S8] DROPPED delta from S11 (cos=-0.0091 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=0.9885
[S6] ⇄ pheromone p=0.224 → S17@127.0.0.1:61017
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.3687 head_norm=1.810508
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.036616e+00
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.3687 head_norm=1.037326 delta_norm=1.036616
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.094 → S17@127.0.0.1:61017
[S10] ⇄ pheromone p=0.054 → S14@127.0.0.1:61014
[S3] ⇄ pheromone p=0.100 → S11@127.0.0.1:61012
[S5] ⇄ pheromone p=0.114 → S11@127.0.0.1:61012
[S4] ⇄ pheromone p=0.050 → S8@127.0.0.1:61009
[S14] ⇄ pheromone p=0.112 → S8@127.0.0.1:61009
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.3040 head_norm=1.011582
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.582383e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.3040 head_norm=1.107404 delta_norm=0.458238
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.191 → S9@127.0.0.1:61010
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.2116 head_norm=1.359910
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.963285e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.449550 delta_norm=0.196329
[S8] aggregate: ROLLBACK (f1_val pre=0.212 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.086 → S15@127.0.0.1:61015
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.3331 head_norm=1.423162
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.122358e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.2498 head_norm=1.442278 delta_norm=0.112236
[S13] aggregate: ROLLBACK (f1_val pre=0.333 post=0.250 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.218 → S7@127.0.0.1:61008
[S11] ⇄ pheromone p=0.280 → S8@127.0.0.1:61009
[S7] ⇄ pheromone p=0.222 → S17@127.0.0.1:61017
[S2] ⇄ pheromone p=0.242 → S8@127.0.0.1:61009
[S16] ⇄ pheromone p=0.113 → S7@127.0.0.1:61008
[S17] ⇄ pheromone p=0.089 → S13@127.0.0.1:61013
[S2] START round=16 head_norm_before_train=1.558886 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.25865842667696665, 'auprc': 0.25865842667696665, 'loss_val': 2.382544710618927, 'psi': 0.25865842667696665}-{'f1_val': 0.26489978902953587, 'auprc': 0.26489978902953587, 'loss_val': 2.3836293807541096, 'psi': 0.26489978902953587}
[S3] START round=16 head_norm_before_train=1.868057 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.6153939662321926, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.575877897299171, 'psi': 0.3641628959276018}
[S4] START round=16 head_norm_before_train=1.635117 (no previous merge yet)
[S4] round=16 local utility u=0.008408 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.399413730514406, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4162298020313644, 'psi': 0.0}
[S5] START round=16 head_norm_before_train=1.716902 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.856802935350028, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.846231011107526, 'psi': 0.33400978131092857}
[S6] START round=16 head_norm_before_train=1.614963 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.981208901679686, 'psi': 0.0}-{'f1_val': 0.03844454264250994, 'auprc': 0.03844454264250994, 'loss_val': 4.098604351931454, 'psi': 0.03844454264250994}
[S7] START round=16 head_norm_before_train=1.506024 (no previous merge yet)
[S7] round=16 local utility u=0.042713 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9429959592125238, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0284213392763097, 'psi': 0.35976373724718097}
[S8] START round=16 head_norm_before_train=1.449550 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.20400516795865634, 'auprc': 0.20400516795865634, 'loss_val': 1.292105414214395, 'psi': 0.20400516795865634}-{'f1_val': 0.21163382924540944, 'auprc': 0.21163382924540944, 'loss_val': 1.3319265866299572, 'psi': 0.21163382924540944}
[S9] START round=16 head_norm_before_train=1.037326 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.530692 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8171092317282427, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8784939364612447, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.586820 (no previous merge yet)
[S10] round=16 local utility u=1.000000 metrics={'f1_val': 0.2476477683956574, 'auprc': 0.2476477683956574, 'loss_val': 3.147882822144822, 'psi': 0.24764776839565739}-{'f1_val': 0.0016674606955693187, 'auprc': 0.0016674606955693187, 'loss_val': 3.3050744681687845, 'psi': 0.0016674606955693187}
[S11] START round=16 head_norm_before_train=1.589901 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.33240006221807433, 'auprc': 0.33240006221807433, 'loss_val': 2.2747625461757726, 'psi': 0.33240006221807433}-{'f1_val': 0.33247763516141576, 'auprc': 0.33247763516141576, 'loss_val': 2.0883193557203468, 'psi': 0.33247763516141576}
[S13] START round=16 head_norm_before_train=1.442278 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=1.000000 metrics={'f1_val': 0.6581119731435839, 'auprc': 0.6581119731435839, 'loss_val': 1.0582030839958534, 'psi': 0.6581119731435839}-{'f1_val': 0.3330876934414149, 'auprc': 0.3330876934414149, 'loss_val': 1.2206974834509525, 'psi': 0.3330876934414149}
[S14] START round=16 head_norm_before_train=1.567373 (no previous merge yet)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.12806884333080235, 'auprc': 0.12806884333080235, 'loss_val': 5.494339980781469, 'psi': 0.12806884333080235}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.37905120640545, 'psi': 0.13582554517133957}
[S15] START round=16 head_norm_before_train=1.107404 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.2938533426818526, 'psi': 0.3040138275398502}-{'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.2673122075758074, 'psi': 0.3040138275398502}
[S16] START round=16 head_norm_before_train=1.684849 (no previous merge yet)
[S16] round=16 local utility u=0.255928 metrics={'f1_val': 0.07848918843021623, 'auprc': 0.07848918843021623, 'loss_val': 3.332361022419262, 'psi': 0.07848918843021623}-{'f1_val': 0.03218495013599275, 'auprc': 0.03218495013599275, 'loss_val': 3.427477988706203, 'psi': 0.03218495013599275}
[S17] START round=16 head_norm_before_train=1.469739 (no previous merge yet)
[S17] round=16 local utility u=0.030164 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.148476269416959, 'psi': 0.15231723870467326}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.2082720180346809, 'psi': 0.1522581895716224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.078)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:61014
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61008
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[S9] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=-0.0816
[S7] DROPPED delta from S13 (cos=-0.0816 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.0141
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=-0.0050
[S17] DROPPED delta from S9 (cos=-0.0050 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=-0.0839
[S17] DROPPED delta from S7 (cos=-0.0839 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S17
[S13] cosine check vs S17: cos=0.9939
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.1281 head_norm=1.600526
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.130710e+00
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.0962 head_norm=1.146734 delta_norm=1.130710
[S14] aggregate: ROLLBACK (f1_val pre=0.128 post=0.096 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6581 head_norm=1.459612
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.256003e-02
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.4897 head_norm=1.469944 delta_norm=0.082560
[S13] aggregate: ROLLBACK (f1_val pre=0.658 post=0.490 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.590433 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.2454789833822092, 'auprc': 0.2454789833822092, 'loss_val': 2.3920442376711453, 'psi': 0.2454789833822092}-{'f1_val': 0.25865842667696665, 'auprc': 0.25865842667696665, 'loss_val': 2.382544710618927, 'psi': 0.25865842667696665}
[S3] START round=17 head_norm_before_train=1.882964 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.6423820845091597, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.6153939662321926, 'psi': 0.3641628959276018}
[S4] START round=17 head_norm_before_train=1.667602 (no previous merge yet)
[S4] round=17 local utility u=0.002372 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3946695798481703, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.399413730514406, 'psi': 0.0}
[S5] START round=17 head_norm_before_train=1.744415 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.9423825285219825, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.856802935350028, 'psi': 0.33400978131092857}
[S6] START round=17 head_norm_before_train=1.630657 (no previous merge yet)
[S6] round=17 local utility u=0.722015 metrics={'f1_val': 0.09980842911877395, 'auprc': 0.09980842911877395, 'loss_val': 4.4354547235348045, 'psi': 0.09980842911877395}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.981208901679686, 'psi': 0.0}
[S7] START round=17 head_norm_before_train=1.533621 (no previous merge yet)
[S7] round=17 local utility u=0.028265 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8864665388434858, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9429959592125238, 'psi': 0.35976373724718097}
[S8] START round=17 head_norm_before_train=1.469467 cos_to_last_merge=0.9966 (last merge round=15)
[S8] round=17 local utility u=0.036831 metrics={'f1_val': 0.20376822815847206, 'auprc': 0.20376822815847206, 'loss_val': 1.2163115282449182, 'psi': 0.20376822815847206}-{'f1_val': 0.20400516795865634, 'auprc': 0.20400516795865634, 'loss_val': 1.292105414214395, 'psi': 0.20400516795865634}
[S9] START round=17 head_norm_before_train=1.115364 cos_to_last_merge=0.9963 (last merge round=15)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.960188311630987, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8171092317282427, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.620285 (no previous merge yet)
[S10] round=17 local utility u=0.103981 metrics={'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.956247982023624, 'psi': 0.24946185123176273}-{'f1_val': 0.2476477683956574, 'auprc': 0.2476477683956574, 'loss_val': 3.147882822144822, 'psi': 0.24764776839565739}
[S11] START round=17 head_norm_before_train=1.610245 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.2873593763840907, 'auprc': 0.2873593763840907, 'loss_val': 2.8287281828120983, 'psi': 0.2873593763840907}-{'f1_val': 0.33240006221807433, 'auprc': 0.33240006221807433, 'loss_val': 2.2747625461757726, 'psi': 0.33240006221807433}
[S13] START round=17 head_norm_before_train=1.469944 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.30980123372172724, 'auprc': 0.30980123372172724, 'loss_val': 1.1935270079824407, 'psi': 0.30980123372172724}-{'f1_val': 0.6581119731435839, 'auprc': 0.6581119731435839, 'loss_val': 1.0582030839958534, 'psi': 0.6581119731435839}
[S14] START round=17 head_norm_before_train=1.146734 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=1.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 3.015837881752149, 'psi': 0.13577478824115594}-{'f1_val': 0.12806884333080235, 'auprc': 0.12806884333080235, 'loss_val': 5.494339980781469, 'psi': 0.12806884333080235}
[S15] START round=17 head_norm_before_train=1.147185 cos_to_last_merge=0.9963 (last merge round=15)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.382591468806607, 'psi': 0.3040138275398502}-{'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.2938533426818526, 'psi': 0.3040138275398502}
[S16] START round=17 head_norm_before_train=1.706799 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.02329749103942652, 'auprc': 0.02329749103942652, 'loss_val': 4.004197675070867, 'psi': 0.02329749103942652}-{'f1_val': 0.07848918843021623, 'auprc': 0.07848918843021623, 'loss_val': 3.332361022419262, 'psi': 0.07848918843021623}
[S17] START round=17 head_norm_before_train=1.484802 (no previous merge yet)
[S17] round=17 local utility u=0.035645 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.0771858299383241, 'psi': 0.15231723870467326}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.148476269416959, 'psi': 0.15231723870467326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61015
[S14] not sending this round → trigger blocked (psi=0.136)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[S4] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.100)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.6890
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=-0.0845
[S17] DROPPED delta from S7 (cos=-0.0845 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=0.9145
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.9958
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.1358 head_norm=1.179932
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.986301e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.1358 head_norm=1.304049 delta_norm=0.598630
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.3098 head_norm=1.486933
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.938807e-02
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.2894 head_norm=1.495931 delta_norm=0.069388
[S13] aggregate: ROLLBACK (f1_val pre=0.310 post=0.289 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.3040 head_norm=1.190045
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.167482e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.3040 head_norm=1.316234 delta_norm=0.316748
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.619251 (no previous merge yet)
[S2] round=18 local utility u=0.008044 metrics={'f1_val': 0.25390205371248026, 'auprc': 0.25390205371248026, 'loss_val': 2.4517636472751887, 'psi': 0.25390205371248026}-{'f1_val': 0.2454789833822092, 'auprc': 0.2454789833822092, 'loss_val': 2.3920442376711453, 'psi': 0.2454789833822092}
[S3] START round=18 head_norm_before_train=1.895297 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.674899394316048, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.6423820845091597, 'psi': 0.3641628959276018}
[S4] START round=18 head_norm_before_train=1.695007 (no previous merge yet)
[S4] round=18 local utility u=0.023918 metrics={'f1_val': 0.004032258064516129, 'auprc': 0.004032258064516129, 'loss_val': 1.383123757369541, 'psi': 0.004032258064516129}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3946695798481703, 'psi': 0.0}
[S5] START round=18 head_norm_before_train=1.768415 (no previous merge yet)
[S5] round=18 local utility u=0.063149 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.811560180680829, 'psi': 0.3335071121394324}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.9423825285219825, 'psi': 0.33400978131092857}
[S6] START round=18 head_norm_before_train=1.644004 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 5.33290609455425, 'psi': 0.002619047619047619}-{'f1_val': 0.09980842911877395, 'auprc': 0.09980842911877395, 'loss_val': 4.4354547235348045, 'psi': 0.09980842911877395}
[S7] START round=18 head_norm_before_train=1.557557 (no previous merge yet)
[S7] round=18 local utility u=0.001221 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8840243203215986, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8864665388434858, 'psi': 0.35976373724718097}
[S8] START round=18 head_norm_before_train=1.499798 cos_to_last_merge=0.9879 (last merge round=15)
[S8] round=18 local utility u=0.036727 metrics={'f1_val': 0.20361057382333977, 'auprc': 0.20361057382333977, 'loss_val': 1.1414382576832884, 'psi': 0.20361057382333977}-{'f1_val': 0.20376822815847206, 'auprc': 0.20376822815847206, 'loss_val': 1.2163115282449182, 'psi': 0.20376822815847206}
[S9] START round=18 head_norm_before_train=1.223421 cos_to_last_merge=0.9868 (last merge round=15)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.132350699887031, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.960188311630987, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.650929 (no previous merge yet)
[S10] round=18 local utility u=0.109875 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.7370381381372355, 'psi': 0.24952175992348158}-{'f1_val': 0.24946185123176273, 'auprc': 0.24946185123176273, 'loss_val': 2.956247982023624, 'psi': 0.24946185123176273}
[S11] START round=18 head_norm_before_train=1.631044 (no previous merge yet)
[S11] round=18 local utility u=0.254207 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.723587966880588, 'psi': 0.33216756042589574}-{'f1_val': 0.2873593763840907, 'auprc': 0.2873593763840907, 'loss_val': 2.8287281828120983, 'psi': 0.2873593763840907}
[S13] START round=18 head_norm_before_train=1.495931 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.417456 metrics={'f1_val': 0.39374920910208616, 'auprc': 0.39374920910208616, 'loss_val': 1.1141458862142724, 'psi': 0.39374920910208616}-{'f1_val': 0.30980123372172724, 'auprc': 0.30980123372172724, 'loss_val': 1.1935270079824407, 'psi': 0.30980123372172724}
[S14] START round=18 head_norm_before_train=1.304049 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.310584 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 2.3946703579789066, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 3.015837881752149, 'psi': 0.13577478824115594}
[S15] START round=18 head_norm_before_train=1.316234 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.136183 metrics={'f1_val': 0.3323866624592406, 'auprc': 0.3323866624592406, 'loss_val': 1.3655802421635872, 'psi': 0.3323866624592406}-{'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.382591468806607, 'psi': 0.3040138275398502}
[S16] START round=18 head_norm_before_train=1.726697 (no previous merge yet)
[S16] round=18 local utility u=0.601906 metrics={'f1_val': 0.08366064414768264, 'auprc': 0.08366064414768264, 'loss_val': 3.343654416657231, 'psi': 0.08366064414768264}-{'f1_val': 0.02329749103942652, 'auprc': 0.02329749103942652, 'loss_val': 4.004197675070867, 'psi': 0.02329749103942652}
[S17] START round=18 head_norm_before_train=1.508072 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.078130133757075, 'psi': 0.15231723870467326}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.0771858299383241, 'psi': 0.15231723870467326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:61015
[S14] not sending this round → trigger blocked (psi=0.136)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61014
[S4] not sending this round → trigger blocked (psi=0.004)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:61008
[S16] not sending this round → trigger blocked (psi=0.084)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:61012
[S13] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S7
[S17] cosine check vs S7: cos=-0.0846
[S17] DROPPED delta from S7 (cos=-0.0846 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] cosine check vs S8: cos=0.9769
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9206
[S11] RECEIVED delta(kind=head bytes=1805) from S5
[S11] cosine check vs S5: cos=-0.0445
[S11] DROPPED delta from S5 (cos=-0.0445 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1805) from S13
[S7] cosine check vs S13: cos=-0.0827
[S7] DROPPED delta from S13 (cos=-0.0827 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.9479
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=0.3444
[S8] RECEIVED delta(kind=head bytes=1799) from S11
[S8] cosine check vs S11: cos=-0.0105
[S8] DROPPED delta from S11 (cos=-0.0105 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.1358 head_norm=1.328313
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.460978e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.1358 head_norm=1.474889 delta_norm=0.346098
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.3687 head_norm=1.309832
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.605132e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.3687 head_norm=1.088888 delta_norm=0.760513
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.3324 head_norm=1.346275
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.810970e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.3286 head_norm=1.432587 delta_norm=0.181097
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.2036 head_norm=1.535495
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.623585e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.2036 head_norm=1.569339 delta_norm=0.262358
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.644861 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.5917397794964887, 'psi': 0.26542475888492534}-{'f1_val': 0.25390205371248026, 'auprc': 0.25390205371248026, 'loss_val': 2.4517636472751887, 'psi': 0.25390205371248026}
[S3] START round=19 head_norm_before_train=1.906141 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7102489239167107, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.674899394316048, 'psi': 0.3641628959276018}
[S4] START round=19 head_norm_before_train=1.718369 (no previous merge yet)
[S4] round=19 local utility u=1.000000 metrics={'f1_val': 0.33274066548133097, 'auprc': 0.33274066548133097, 'loss_val': 1.3491695739063754, 'psi': 0.33274066548133097}-{'f1_val': 0.004032258064516129, 'auprc': 0.004032258064516129, 'loss_val': 1.383123757369541, 'psi': 0.004032258064516129}
[S5] START round=19 head_norm_before_train=1.784809 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9061094936863032, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.811560180680829, 'psi': 0.3335071121394324}
[S6] START round=19 head_norm_before_train=1.661064 (no previous merge yet)
[S6] round=19 local utility u=0.089018 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.3270409093316, 'psi': 0.021749084249084248}-{'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 5.33290609455425, 'psi': 0.002619047619047619}
[S7] START round=19 head_norm_before_train=1.568867 (no previous merge yet)
[S7] round=19 local utility u=0.003491 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8770416911201936, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8840243203215986, 'psi': 0.35976373724718097}
[S8] START round=19 head_norm_before_train=1.569339 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.017576 metrics={'f1_val': 0.20361057382333977, 'auprc': 0.20361057382333977, 'loss_val': 1.1062870690164301, 'psi': 0.20361057382333977}-{'f1_val': 0.20361057382333977, 'auprc': 0.20361057382333977, 'loss_val': 1.1414382576832884, 'psi': 0.20361057382333977}
[S9] START round=19 head_norm_before_train=1.088888 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.210766 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7108191361870106, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.132350699887031, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.680995 (no previous merge yet)
[S10] round=19 local utility u=0.108520 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.5199985214428064, 'psi': 0.24952175992348158}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.7370381381372355, 'psi': 0.24952175992348158}
[S11] START round=19 head_norm_before_train=1.650413 (no previous merge yet)
[S11] round=19 local utility u=0.182411 metrics={'f1_val': 0.32639047837033647, 'auprc': 0.32639047837033647, 'loss_val': 2.3067724749314547, 'psi': 0.32639047837033647}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.723587966880588, 'psi': 0.33216756042589574}
[S13] START round=19 head_norm_before_train=1.510310 cos_to_last_merge=0.9997 (last merge round=17)
[S13] round=19 local utility u=1.000000 metrics={'f1_val': 0.6607729673414401, 'auprc': 0.6607729673414401, 'loss_val': 0.8498999934687974, 'psi': 0.6607729673414401}-{'f1_val': 0.39374920910208616, 'auprc': 0.39374920910208616, 'loss_val': 1.1141458862142724, 'psi': 0.39374920910208616}
[S14] START round=19 head_norm_before_train=1.474889 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.013736 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.3676560188771343, 'psi': 0.13582554517133957}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 2.3946703579789066, 'psi': 0.13577478824115594}
[S15] START round=19 head_norm_before_train=1.432587 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.25998715478484263, 'auprc': 0.25998715478484263, 'loss_val': 1.3335528658024995, 'psi': 0.25998715478484263}-{'f1_val': 0.3323866624592406, 'auprc': 0.3323866624592406, 'loss_val': 1.3655802421635872, 'psi': 0.3323866624592406}
[S16] START round=19 head_norm_before_train=1.743115 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.0014831294030404152, 'auprc': 0.0014831294030404152, 'loss_val': 4.664464639952491, 'psi': 0.0014831294030404152}-{'f1_val': 0.08366064414768264, 'auprc': 0.08366064414768264, 'loss_val': 3.343654416657231, 'psi': 0.08366064414768264}
[S17] START round=19 head_norm_before_train=1.537048 (no previous merge yet)
[S17] round=19 local utility u=0.221199 metrics={'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 1.092328632382591, 'psi': 0.20305027788548533}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.078130133757075, 'psi': 0.15231723870467326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S14] not sending this round → trigger blocked (psi=0.136)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61008
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:61017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61015
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:61017
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S11
[S8] cosine check vs S11: cos=-0.0013
[S8] DROPPED delta from S11 (cos=-0.0013 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=0.9810
[S17] RECEIVED delta(kind=head bytes=1806) from S7
[S17] cosine check vs S7: cos=-0.0837
[S17] DROPPED delta from S7 (cos=-0.0837 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S9
[S17] cosine check vs S9: cos=0.0209
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=-0.0820
[S7] DROPPED delta from S13 (cos=-0.0820 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.9669
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] cosine check vs S4: cos=0.0600
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=0.9924
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.1358 head_norm=1.494114
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.328302e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.1358 head_norm=1.589605 delta_norm=0.232830
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.136 u=0.0137 p_local=0.2262 f1=0.136 auprc=0.136 bytes=0
[S5] r=20 psi=0.334 u=0.0000 p_local=0.0569 f1=0.334 auprc=0.334 bytes=12596
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.2600 head_norm=1.456461
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.648816e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.2774 head_norm=1.520030 delta_norm=0.164882
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.260 u=0.0000 p_local=0.1001 f1=0.260 auprc=0.260 bytes=8984
[S3] r=20 psi=0.364 u=0.0000 p_local=0.0411 f1=0.364 auprc=0.364 bytes=1792
[S6] r=20 psi=0.022 u=0.0890 p_local=0.2021 f1=0.022 auprc=0.022 bytes=0
[S2] r=20 psi=0.265 u=0.0000 p_local=0.1004 f1=0.265 auprc=0.265 bytes=9006
[S16] r=20 psi=0.001 u=0.0000 p_local=0.1686 f1=0.001 auprc=0.001 bytes=0
[S9] r=20 psi=0.369 u=0.2108 p_local=0.1349 f1=0.369 auprc=0.369 bytes=5397
[S7] r=20 psi=0.360 u=0.0035 p_local=0.0999 f1=0.360 auprc=0.360 bytes=16186
[S4] r=20 psi=0.333 u=1.0000 p_local=0.2256 f1=0.333 auprc=0.333 bytes=5378
[S10] r=20 psi=0.250 u=0.1085 p_local=0.1770 f1=0.250 auprc=0.250 bytes=7200
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.2036 head_norm=1.598148
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.145474e+00
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.2036 head_norm=1.216186 delta_norm=1.145474
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.204 u=0.0176 p_local=0.0492 f1=0.204 auprc=0.204 bytes=14397
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.6608 head_norm=1.528931
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.702479e-02
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.6561 head_norm=1.542731 delta_norm=0.097025
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.661 u=1.0000 p_local=0.4587 f1=0.661 auprc=0.661 bytes=10796
[S11] r=20 psi=0.326 u=0.1824 p_local=0.1920 f1=0.326 auprc=0.326 bytes=5404
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.2031 head_norm=1.562445
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.750388e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.2030 head_norm=0.994897 delta_norm=0.975039
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.203 u=0.2212 p_local=0.0882 f1=0.203 auprc=0.203 bytes=16182
[S2] START round=20 head_norm_before_train=1.667597 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.22373228116323252, 'auprc': 0.22373228116323252, 'loss_val': 2.927633376042648, 'psi': 0.22373228116323252}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.5917397794964887, 'psi': 0.26542475888492534}
[S3] START round=20 head_norm_before_train=1.917758 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7458870426037234, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7102489239167107, 'psi': 0.3641628959276018}
[S4] START round=20 head_norm_before_train=1.740219 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.3204159558046958, 'auprc': 0.3204159558046958, 'loss_val': 1.3119219305087746, 'psi': 0.3204159558046958}-{'f1_val': 0.33274066548133097, 'auprc': 0.33274066548133097, 'loss_val': 1.3491695739063754, 'psi': 0.33274066548133097}
[S5] START round=20 head_norm_before_train=1.794020 (no previous merge yet)
[S5] round=20 local utility u=0.082735 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7406404707270746, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9061094936863032, 'psi': 0.3335071121394324}
[S6] START round=20 head_norm_before_train=1.675536 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.525216899538518, 'psi': 0.021967963386727688}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.3270409093316, 'psi': 0.021749084249084248}
[S7] START round=20 head_norm_before_train=1.588767 (no previous merge yet)
[S7] round=20 local utility u=0.024058 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8289254946395032, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8770416911201936, 'psi': 0.35976373724718097}
[S8] START round=20 head_norm_before_train=1.216186 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.008056 metrics={'f1_val': 0.20345316325215823, 'auprc': 0.20345316325215823, 'loss_val': 1.0887579016877054, 'psi': 0.20345316325215823}-{'f1_val': 0.20361057382333977, 'auprc': 0.20361057382333977, 'loss_val': 1.1062870690164301, 'psi': 0.20361057382333977}
[S9] START round=20 head_norm_before_train=1.199919 cos_to_last_merge=0.9912 (last merge round=18)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9174074441213786, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7108191361870106, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.711645 (no previous merge yet)
[S10] round=20 local utility u=0.254933 metrics={'f1_val': 0.2513441662509812, 'auprc': 0.2513441662509812, 'loss_val': 2.0265333424350063, 'psi': 0.2513441662509812}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.5199985214428064, 'psi': 0.24952175992348158}
[S11] START round=20 head_norm_before_train=1.669157 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.567554005993374, 'psi': 0.33154997286190585}-{'f1_val': 0.32639047837033647, 'auprc': 0.32639047837033647, 'loss_val': 2.3067724749314547, 'psi': 0.32639047837033647}
[S13] START round=20 head_norm_before_train=1.542731 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.067812 metrics={'f1_val': 0.6645397141700268, 'auprc': 0.6645397141700268, 'loss_val': 0.7481774704917252, 'psi': 0.6645397141700268}-{'f1_val': 0.6607729673414401, 'auprc': 0.6607729673414401, 'loss_val': 0.8498999934687974, 'psi': 0.6607729673414401}
[S14] START round=20 head_norm_before_train=1.589605 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 2.3827419310214584, 'psi': 0.13577478824115594}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.3676560188771343, 'psi': 0.13582554517133957}
[S15] START round=20 head_norm_before_train=1.520030 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.305489 metrics={'f1_val': 0.3066075287160241, 'auprc': 0.3066075287160241, 'loss_val': 1.1421575320483637, 'psi': 0.3066075287160241}-{'f1_val': 0.25998715478484263, 'auprc': 0.25998715478484263, 'loss_val': 1.3335528658024995, 'psi': 0.25998715478484263}
[S16] START round=20 head_norm_before_train=1.755643 (no previous merge yet)
[S16] round=20 local utility u=1.000000 metrics={'f1_val': 0.12665618684033236, 'auprc': 0.12665618684033236, 'loss_val': 3.4726276677957477, 'psi': 0.12665618684033236}-{'f1_val': 0.0014831294030404152, 'auprc': 0.0014831294030404152, 'loss_val': 4.664464639952491, 'psi': 0.0014831294030404152}
[S17] START round=20 head_norm_before_train=0.994897 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.0455699193771792, 'psi': 0.15231723870467326}-{'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 1.092328632382591, 'psi': 0.20305027788548533}
[S16] not sending this round → trigger blocked (psi=0.127)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:61012
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:61010
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:61015
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9792
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] cosine check vs S8: cos=0.7329
[S11] RECEIVED delta(kind=head bytes=1806) from S5
[S11] cosine check vs S5: cos=-0.0463
[S11] DROPPED delta from S5 (cos=-0.0463 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1804) from S15
[S9] cosine check vs S15: cos=0.6747
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=-0.0799
[S7] DROPPED delta from S13 (cos=-0.0799 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S7
[S17] cosine check vs S7: cos=-0.0836
[S17] DROPPED delta from S7 (cos=-0.0836 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.3687 head_norm=1.321231
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.862051e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.3687 head_norm=1.310918 delta_norm=0.586205
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.108 → S17@127.0.0.1:61017
[S3] ⇄ pheromone p=0.033 → S11@127.0.0.1:61012
[S2] ⇄ pheromone p=0.080 → S8@127.0.0.1:61009
[S4] ⇄ pheromone p=0.180 → S8@127.0.0.1:61009
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.1358 head_norm=1.609229
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.824934e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.1358 head_norm=1.665227 delta_norm=0.182493
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.181 → S8@127.0.0.1:61009
[S6] ⇄ pheromone p=0.162 → S17@127.0.0.1:61017
[S11] ⇄ pheromone p=0.154 → S8@127.0.0.1:61009
[S8] ⇄ pheromone p=0.041 → S15@127.0.0.1:61015
[S5] ⇄ pheromone p=0.062 → S11@127.0.0.1:61012
[S10] ⇄ pheromone p=0.193 → S14@127.0.0.1:61014
[S13] ⇄ pheromone p=0.380 → S7@127.0.0.1:61008
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.3066 head_norm=1.542282
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.287843e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.3329 head_norm=1.306291 delta_norm=0.528784
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.141 → S9@127.0.0.1:61010
[S7] ⇄ pheromone p=0.085 → S17@127.0.0.1:61017
[S16] ⇄ pheromone p=0.335 → S7@127.0.0.1:61008
[S17] ⇄ pheromone p=0.071 → S13@127.0.0.1:61013
[S2] START round=21 head_norm_before_train=1.686689 (no previous merge yet)
[S2] round=21 local utility u=0.823436 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.574469115095847, 'psi': 0.3674775928297055}-{'f1_val': 0.22373228116323252, 'auprc': 0.22373228116323252, 'loss_val': 2.927633376042648, 'psi': 0.22373228116323252}
[S3] START round=21 head_norm_before_train=1.929096 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7744677135708344, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7458870426037234, 'psi': 0.3641628959276018}
[S4] START round=21 head_norm_before_train=1.756588 (no previous merge yet)
[S4] round=21 local utility u=0.173858 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2916077675621267, 'psi': 0.3567939207526687}-{'f1_val': 0.3204159558046958, 'auprc': 0.3204159558046958, 'loss_val': 1.3119219305087746, 'psi': 0.3204159558046958}
[S5] START round=21 head_norm_before_train=1.800518 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.040381282359769, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7406404707270746, 'psi': 0.3335071121394324}
[S6] START round=21 head_norm_before_train=1.690354 (no previous merge yet)
[S6] round=21 local utility u=0.087986 metrics={'f1_val': 0.04626411815812337, 'auprc': 0.04626411815812337, 'loss_val': 5.567909952915161, 'psi': 0.04626411815812337}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.525216899538518, 'psi': 0.021967963386727688}
[S7] START round=21 head_norm_before_train=1.610076 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.8431341480597007, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8289254946395032, 'psi': 0.35976373724718097}
[S8] START round=21 head_norm_before_train=1.262293 cos_to_last_merge=0.9974 (last merge round=19)
[S8] round=21 local utility u=0.482160 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0389165018276807, 'psi': 0.30506182380216385}-{'f1_val': 0.20345316325215823, 'auprc': 0.20345316325215823, 'loss_val': 1.0887579016877054, 'psi': 0.20345316325215823}
[S9] START round=21 head_norm_before_train=1.310918 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.130259 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6568893123167587, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9174074441213786, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.738663 (no previous merge yet)
[S10] round=21 local utility u=0.440993 metrics={'f1_val': 0.28702762979255275, 'auprc': 0.28702762979255275, 'loss_val': 1.4656987391765477, 'psi': 0.28702762979255275}-{'f1_val': 0.2513441662509812, 'auprc': 0.2513441662509812, 'loss_val': 2.0265333424350063, 'psi': 0.2513441662509812}
[S11] START round=21 head_norm_before_train=1.685262 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.6253670897903105, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.567554005993374, 'psi': 0.33154997286190585}
[S13] START round=21 head_norm_before_train=1.560138 cos_to_last_merge=0.9996 (last merge round=19)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6532072508805175, 'auprc': 0.6532072508805175, 'loss_val': 0.7393312350718096, 'psi': 0.6532072508805175}-{'f1_val': 0.6645397141700268, 'auprc': 0.6645397141700268, 'loss_val': 0.7481774704917252, 'psi': 0.6645397141700268}
[S14] START round=21 head_norm_before_train=1.665227 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 2.8324413840124767, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 2.3827419310214584, 'psi': 0.13577478824115594}
[S15] START round=21 head_norm_before_train=1.306291 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.27810505645557193, 'auprc': 0.27810505645557193, 'loss_val': 1.0686249043907194, 'psi': 0.27810505645557193}-{'f1_val': 0.3066075287160241, 'auprc': 0.3066075287160241, 'loss_val': 1.1421575320483637, 'psi': 0.3066075287160241}
[S16] START round=21 head_norm_before_train=1.766912 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.027584979533724862, 'auprc': 0.027584979533724862, 'loss_val': 4.475543233803401, 'psi': 0.027584979533724862}-{'f1_val': 0.12665618684033236, 'auprc': 0.12665618684033236, 'loss_val': 3.4726276677957477, 'psi': 0.12665618684033236}
[S17] START round=21 head_norm_before_train=1.036847 cos_to_last_merge=0.9982 (last merge round=19)
[S17] round=21 local utility u=0.233681 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.034096666941649, 'psi': 0.20297157622739018}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.0455699193771792, 'psi': 0.15231723870467326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:61014
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S8] → sending delta(kind=head bytes=1810) to S15@127.0.0.1:61015
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.046)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1810 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1810) from S8
[S15] cosine check vs S8: cos=0.9137
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=0.6170
[S17] RECEIVED delta(kind=head bytes=1803) from S9
[S17] cosine check vs S9: cos=0.5512
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] cosine check vs S4: cos=0.7356
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.9844
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.8176
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.6532 head_norm=1.572303
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.626596e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.6638 head_norm=1.272888 delta_norm=0.462660
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.1358 head_norm=1.689309
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.574035e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.1358 head_norm=1.720766 delta_norm=0.157403
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.2781 head_norm=1.332968
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.745342e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.2822 head_norm=1.291655 delta_norm=0.274534
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.3051 head_norm=1.307930
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.737988e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.3051 head_norm=1.252808 delta_norm=0.173799
[S8] aggregate: ACCEPT kept=['S2', 'S4'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.2030 head_norm=1.093827
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.096770e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.2029 head_norm=1.105810 delta_norm=0.609677
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.703509 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.609607381907789, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.574469115095847, 'psi': 0.3674775928297055}
[S3] START round=22 head_norm_before_train=1.940890 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8098479310194047, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7744677135708344, 'psi': 0.3641628959276018}
[S4] START round=22 head_norm_before_train=1.771026 (no previous merge yet)
[S4] round=22 local utility u=0.008859 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2738894303620032, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2916077675621267, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.809978 (no previous merge yet)
[S5] round=22 local utility u=0.026673 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.98703499734844, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.040381282359769, 'psi': 0.3335071121394324}
[S6] START round=22 head_norm_before_train=1.705554 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.8731151249077875, 'psi': 0.021749084249084248}-{'f1_val': 0.04626411815812337, 'auprc': 0.04626411815812337, 'loss_val': 5.567909952915161, 'psi': 0.04626411815812337}
[S7] START round=22 head_norm_before_train=1.627753 (no previous merge yet)
[S7] round=22 local utility u=0.520072 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8836569880701544, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.8431341480597007, 'psi': 0.23968964488212474}
[S8] START round=22 head_norm_before_train=1.252808 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0661597739056525, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0389165018276807, 'psi': 0.30506182380216385}
[S9] START round=22 head_norm_before_train=1.411590 cos_to_last_merge=0.9907 (last merge round=20)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.878188656217134, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6568893123167587, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.765745 (no previous merge yet)
[S10] round=22 local utility u=0.066931 metrics={'f1_val': 0.27768551911089634, 'auprc': 0.27768551911089634, 'loss_val': 1.247757898723288, 'psi': 0.27768551911089634}-{'f1_val': 0.28702762979255275, 'auprc': 0.28702762979255275, 'loss_val': 1.4656987391765477, 'psi': 0.28702762979255275}
[S11] START round=22 head_norm_before_train=1.706275 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.7320673914174325, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.6253670897903105, 'psi': 0.33154997286190585}
[S13] START round=22 head_norm_before_train=1.272888 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.043074 metrics={'f1_val': 0.6646380780188575, 'auprc': 0.6646380780188575, 'loss_val': 0.7560599399474911, 'psi': 0.6646380780188575}-{'f1_val': 0.6532072508805175, 'auprc': 0.6532072508805175, 'loss_val': 0.7393312350718096, 'psi': 0.6532072508805175}
[S14] START round=22 head_norm_before_train=1.720766 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.154329234257253, 'psi': 0.13587634006482174}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 2.8324413840124767, 'psi': 0.13577478824115594}
[S15] START round=22 head_norm_before_train=1.291655 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.321764 metrics={'f1_val': 0.33270042194092825, 'auprc': 0.33270042194092825, 'loss_val': 0.9164547870794046, 'psi': 0.33270042194092825}-{'f1_val': 0.27810505645557193, 'auprc': 0.27810505645557193, 'loss_val': 1.0686249043907194, 'psi': 0.27810505645557193}
[S16] START round=22 head_norm_before_train=1.777768 (no previous merge yet)
[S16] round=22 local utility u=0.424445 metrics={'f1_val': 0.07257008121561435, 'auprc': 0.07257008121561435, 'loss_val': 4.0315187478785, 'psi': 0.07257008121561435}-{'f1_val': 0.027584979533724862, 'auprc': 0.027584979533724862, 'loss_val': 4.475543233803401, 'psi': 0.027584979533724862}
[S17] START round=22 head_norm_before_train=1.105810 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.018488721160931, 'psi': 0.152287708414114}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.034096666941649, 'psi': 0.20297157622739018}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S11@127.0.0.1:61012
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:61010
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.073)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1807 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S7
[S17] cosine check vs S7: cos=-0.0562
[S17] DROPPED delta from S7 (cos=-0.0562 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1807) from S5
[S11] cosine check vs S5: cos=-0.0488
[S11] DROPPED delta from S5 (cos=-0.0488 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1805) from S10
[S14] cosine check vs S10: cos=0.9871
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.7239
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=-0.0787
[S7] DROPPED delta from S13 (cos=-0.0787 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1806) from S15
[S9] cosine check vs S15: cos=0.7427
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.3687 head_norm=1.512098
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.164373e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.3687 head_norm=1.325331 delta_norm=0.516437
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.1359 head_norm=1.750470
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.440055e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.1359 head_norm=1.767737 delta_norm=0.144005
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.3051 head_norm=1.292107
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.168278e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.3209 head_norm=1.432921 delta_norm=0.616828
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.719115 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.26186186186186183, 'auprc': 0.26186186186186183, 'loss_val': 2.9060055761655526, 'psi': 0.26186186186186183}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.609607381907789, 'psi': 0.3674775928297055}
[S3] START round=23 head_norm_before_train=1.950942 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8458728904810267, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8098479310194047, 'psi': 0.3641628959276018}
[S4] START round=23 head_norm_before_train=1.788278 (no previous merge yet)
[S4] round=23 local utility u=0.010922 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2520452170327843, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2738894303620032, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.821137 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.042895312384106, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.98703499734844, 'psi': 0.3335071121394324}
[S6] START round=23 head_norm_before_train=1.717871 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.98735954485852, 'psi': 0.02153000458085204}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.8731151249077875, 'psi': 0.021749084249084248}
[S7] START round=23 head_norm_before_train=1.646727 (no previous merge yet)
[S7] round=23 local utility u=0.011290 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8610767701069384, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8836569880701544, 'psi': 0.35976373724718097}
[S8] START round=23 head_norm_before_train=1.432921 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=1.000000 metrics={'f1_val': 0.9991535350598939, 'auprc': 0.9991535350598939, 'loss_val': 1.0969179536163962, 'psi': 0.9991535350598939}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0661597739056525, 'psi': 0.30506182380216385}
[S9] START round=23 head_norm_before_train=1.325331 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.136081 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6060276530598658, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.878188656217134, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.796418 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.26324887324042695, 'auprc': 0.26324887324042695, 'loss_val': 1.1277582633510648, 'psi': 0.26324887324042695}-{'f1_val': 0.27768551911089634, 'auprc': 0.27768551911089634, 'loss_val': 1.247757898723288, 'psi': 0.27768551911089634}
[S11] START round=23 head_norm_before_train=1.728644 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.9332008924631987, 'psi': 0.33201273984308244}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.7320673914174325, 'psi': 0.33154997286190585}
[S13] START round=23 head_norm_before_train=1.286142 cos_to_last_merge=0.9997 (last merge round=21)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6639117137230345, 'auprc': 0.6639117137230345, 'loss_val': 0.7694081575337786, 'psi': 0.6639117137230345}-{'f1_val': 0.6646380780188575, 'auprc': 0.6646380780188575, 'loss_val': 0.7560599399474911, 'psi': 0.6646380780188575}
[S14] START round=23 head_norm_before_train=1.767737 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.3338471256710105, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.154329234257253, 'psi': 0.13587634006482174}
[S15] START round=23 head_norm_before_train=1.326642 cos_to_last_merge=0.9985 (last merge round=21)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.28094541910331383, 'auprc': 0.28094541910331383, 'loss_val': 0.9447760703107438, 'psi': 0.28094541910331383}-{'f1_val': 0.33270042194092825, 'auprc': 0.33270042194092825, 'loss_val': 0.9164547870794046, 'psi': 0.33270042194092825}
[S16] START round=23 head_norm_before_train=1.789412 (no previous merge yet)
[S16] round=23 local utility u=0.181966 metrics={'f1_val': 0.0802828618968386, 'auprc': 0.0802828618968386, 'loss_val': 3.737001307972035, 'psi': 0.0802828618968386}-{'f1_val': 0.07257008121561435, 'auprc': 0.07257008121561435, 'loss_val': 4.0315187478785, 'psi': 0.07257008121561435}
[S17] START round=23 head_norm_before_train=1.142581 cos_to_last_merge=0.9956 (last merge round=21)
[S17] round=23 local utility u=0.257052 metrics={'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 0.9608938117217631, 'psi': 0.20301091942882987}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.018488721160931, 'psi': 0.152287708414114}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:61017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61015
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.080)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=0.8010
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=0.9418
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.8288
[S17] RECEIVED delta(kind=head bytes=1803) from S7
[S17] cosine check vs S7: cos=-0.0547
[S17] DROPPED delta from S7 (cos=-0.0547 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.6954
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.2809 head_norm=1.361977
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.483899e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.2830 head_norm=1.341158 delta_norm=0.448390
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.6639 head_norm=1.303636
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.902161e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.9952 head_norm=1.150794 delta_norm=0.490216
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9992 head_norm=1.464422
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.252046e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9994 head_norm=1.610698 delta_norm=0.325205
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.2030 head_norm=1.195747
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.962140e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.2030 head_norm=1.249079 delta_norm=0.396214
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.732263 (no previous merge yet)
[S2] round=24 local utility u=0.098629 metrics={'f1_val': 0.2577127830158425, 'auprc': 0.2577127830158425, 'loss_val': 2.6714052361761036, 'psi': 0.2577127830158425}-{'f1_val': 0.26186186186186183, 'auprc': 0.26186186186186183, 'loss_val': 2.9060055761655526, 'psi': 0.26186186186186183}
[S3] START round=24 head_norm_before_train=1.962649 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8651518406842262, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8458728904810267, 'psi': 0.3641628959276018}
[S4] START round=24 head_norm_before_train=1.804350 (no previous merge yet)
[S4] round=24 local utility u=0.009399 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2332470058461054, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2520452170327843, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.847495 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.171513075298088, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.042895312384106, 'psi': 0.3335071121394324}
[S6] START round=24 head_norm_before_train=1.730186 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.090496905465097, 'psi': 0.02153000458085204}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.98735954485852, 'psi': 0.02153000458085204}
[S7] START round=24 head_norm_before_train=1.659384 (no previous merge yet)
[S7] round=24 local utility u=0.027234 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8066089805026648, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8610767701069384, 'psi': 0.35976373724718097}
[S8] START round=24 head_norm_before_train=1.610698 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.001369 metrics={'f1_val': 0.9997177674455537, 'auprc': 0.9997177674455537, 'loss_val': 1.099258057907824, 'psi': 0.9997177674455537}-{'f1_val': 0.9991535350598939, 'auprc': 0.9991535350598939, 'loss_val': 1.0969179536163962, 'psi': 0.9991535350598939}
[S9] START round=24 head_norm_before_train=1.415825 cos_to_last_merge=0.9927 (last merge round=22)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7478982188845489, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6060276530598658, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.830820 (no previous merge yet)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.24918310067944657, 'auprc': 0.24918310067944657, 'loss_val': 1.1283997735107636, 'psi': 0.2491831006794466}-{'f1_val': 0.26324887324042695, 'auprc': 0.26324887324042695, 'loss_val': 1.1277582633510648, 'psi': 0.26324887324042695}
[S11] START round=24 head_norm_before_train=1.750727 (no previous merge yet)
[S11] round=24 local utility u=0.045213 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.83999819828676, 'psi': 0.3317042898145993}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.9332008924631987, 'psi': 0.33201273984308244}
[S13] START round=24 head_norm_before_train=1.150794 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.001788 metrics={'f1_val': 0.6645564790251969, 'auprc': 0.6645564790251969, 'loss_val': 0.7716345096851694, 'psi': 0.6645564790251969}-{'f1_val': 0.6639117137230345, 'auprc': 0.6639117137230345, 'loss_val': 0.7694081575337786, 'psi': 0.6639117137230345}
[S14] START round=24 head_norm_before_train=1.800739 cos_to_last_merge=0.9979 (last merge round=22)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 3.8696250162714776, 'psi': 0.1331327566754419}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.3338471256710105, 'psi': 0.13582554517133957}
[S15] START round=24 head_norm_before_train=1.341158 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.232674 metrics={'f1_val': 0.32031506399737447, 'auprc': 0.32031506399737447, 'loss_val': 0.8337553354022899, 'psi': 0.32031506399737447}-{'f1_val': 0.28094541910331383, 'auprc': 0.28094541910331383, 'loss_val': 0.9447760703107438, 'psi': 0.28094541910331383}
[S16] START round=24 head_norm_before_train=1.799787 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.08381971465629053, 'auprc': 0.08381971465629053, 'loss_val': 4.328262868442346, 'psi': 0.08381971465629053}-{'f1_val': 0.0802828618968386, 'auprc': 0.0802828618968386, 'loss_val': 3.737001307972035, 'psi': 0.0802828618968386}
[S17] START round=24 head_norm_before_train=1.249079 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.0019380264093678, 'psi': 0.20297157622739018}-{'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 0.9608938117217631, 'psi': 0.20301091942882987}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:61005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:61009
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S15
[S8] cosine check vs S15: cos=0.8817
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] cosine check vs S11: cos=-0.0501
[S5] DROPPED delta from S11 (cos=-0.0501 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S13
[S17] cosine check vs S13: cos=0.7931
[S14] RECEIVED delta(kind=head bytes=1797) from S8
[S14] cosine check vs S8: cos=0.0256
[S13] RECEIVED delta(kind=head bytes=1802) from S7
[S13] cosine check vs S7: cos=-0.0705
[S13] DROPPED delta from S7 (cos=-0.0705 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.1331 head_norm=1.836586
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.214847e+00
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.1359 head_norm=1.246130 delta_norm=1.214847
[S14] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9997 head_norm=1.638395
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.883052e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9992 head_norm=1.459019 delta_norm=0.388305
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.2030 head_norm=1.288122
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.991699e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.2030 head_norm=1.163322 delta_norm=0.399170
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.744624 (no previous merge yet)
[S2] round=25 local utility u=0.477477 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7043345225953423, 'psi': 0.3674775928297055}-{'f1_val': 0.2577127830158425, 'auprc': 0.2577127830158425, 'loss_val': 2.6714052361761036, 'psi': 0.2577127830158425}
[S3] START round=25 head_norm_before_train=1.973213 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8983917985159815, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8651518406842262, 'psi': 0.3641628959276018}
[S4] START round=25 head_norm_before_train=1.819659 (no previous merge yet)
[S4] round=25 local utility u=0.006298 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2206516081267509, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2332470058461054, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.887278 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2671140257226927, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.171513075298088, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.739307 (no previous merge yet)
[S6] round=25 local utility u=0.535473 metrics={'f1_val': 0.10042081101759755, 'auprc': 0.10042081101759755, 'loss_val': 5.72956883401273, 'psi': 0.10042081101759755}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.090496905465097, 'psi': 0.02153000458085204}
[S7] START round=25 head_norm_before_train=1.673777 (no previous merge yet)
[S7] round=25 local utility u=0.004608 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.7973935260777856, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8066089805026648, 'psi': 0.35976373724718097}
[S8] START round=25 head_norm_before_train=1.459019 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.028319 metrics={'f1_val': 0.9994356513935347, 'auprc': 0.9994356513935347, 'loss_val': 1.0400801250598422, 'psi': 0.9994356513935347}-{'f1_val': 0.9997177674455537, 'auprc': 0.9997177674455537, 'loss_val': 1.099258057907824, 'psi': 0.9997177674455537}
[S9] START round=25 head_norm_before_train=1.505311 cos_to_last_merge=0.9790 (last merge round=22)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9197094427789076, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7478982188845489, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.864684 (no previous merge yet)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.24347319347319346, 'auprc': 0.24347319347319346, 'loss_val': 1.1410719495853967, 'psi': 0.24347319347319346}-{'f1_val': 0.24918310067944657, 'auprc': 0.24918310067944657, 'loss_val': 1.1283997735107636, 'psi': 0.2491831006794466}
[S11] START round=25 head_norm_before_train=1.769593 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.9362810067978793, 'psi': 0.3320133550741517}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.83999819828676, 'psi': 0.3317042898145993}
[S13] START round=25 head_norm_before_train=1.168782 cos_to_last_merge=0.9994 (last merge round=23)
[S13] round=25 local utility u=0.050585 metrics={'f1_val': 0.6649648747744116, 'auprc': 0.6649648747744116, 'loss_val': 0.6741401429361096, 'psi': 0.6649648747744116}-{'f1_val': 0.6645564790251969, 'auprc': 0.6645564790251969, 'loss_val': 0.7716345096851694, 'psi': 0.6645564790251969}
[S14] START round=25 head_norm_before_train=1.246130 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.626502 metrics={'f1_val': 0.13111866112998616, 'auprc': 0.13111866112998616, 'loss_val': 2.5984937696397608, 'psi': 0.13111866112998616}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 3.8696250162714776, 'psi': 0.1331327566754419}
[S15] START round=25 head_norm_before_train=1.369195 cos_to_last_merge=0.9989 (last merge round=23)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.2915037326697476, 'auprc': 0.2915037326697476, 'loss_val': 0.8079814434086092, 'psi': 0.2915037326697476}-{'f1_val': 0.32031506399737447, 'auprc': 0.32031506399737447, 'loss_val': 0.8337553354022899, 'psi': 0.32031506399737447}
[S16] START round=25 head_norm_before_train=1.809650 (no previous merge yet)
[S16] round=25 local utility u=0.036626 metrics={'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 4.3064100416829, 'psi': 0.08953068592057761}-{'f1_val': 0.08381971465629053, 'auprc': 0.08381971465629053, 'loss_val': 4.328262868442346, 'psi': 0.08381971465629053}
[S17] START round=25 head_norm_before_train=1.163322 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.020687 metrics={'f1_val': 0.20349685210048432, 'auprc': 0.20349685210048432, 'loss_val': 0.9652909305600916, 'psi': 0.20349685210048432}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.0019380264093678, 'psi': 0.20297157622739018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:61014
[S16] not sending this round → trigger blocked (psi=0.090)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.131)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:61013
[S6] not sending this round → trigger blocked (psi=0.100)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S8
[S14] cosine check vs S8: cos=0.6328
[S13] RECEIVED delta(kind=head bytes=1806) from S7
[S13] cosine check vs S7: cos=-0.0684
[S13] DROPPED delta from S7 (cos=-0.0684 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S13
[S17] cosine check vs S13: cos=0.9472
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:61007
[S17] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S17
[S6] cosine check vs S17: cos=0.0367
[S11] ⇄ pheromone p=0.058 → S5@127.0.0.1:61005
[S9] ⇄ pheromone p=0.063 → S15@127.0.0.1:61015
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.1311 head_norm=1.282333
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.020108e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.1359 head_norm=1.254332 delta_norm=0.602011
[S14] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.185 → S10@127.0.0.1:61011
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.1004 head_norm=1.748229
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.049062e+00
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.1003 head_norm=1.085888 delta_norm=1.049062
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.116 → S8@127.0.0.1:61009
[S8] ⇄ pheromone p=0.187 → S14@127.0.0.1:61014
[S7] ⇄ pheromone p=0.088 → S13@127.0.0.1:61013
[S13] ⇄ pheromone p=0.139 → S17@127.0.0.1:61017
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.2035 head_norm=1.225994
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.970287e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.2031 head_norm=1.192182 delta_norm=0.197029
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.079 → S6@127.0.0.1:61007
[S2] START round=26 head_norm_before_train=1.755955 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7323986308888033, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7043345225953423, 'psi': 0.3674775928297055}
[S3] START round=26 head_norm_before_train=1.981922 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.916083503595699, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8983917985159815, 'psi': 0.3641628959276018}
[S4] START round=26 head_norm_before_train=1.835057 (no previous merge yet)
[S4] round=26 local utility u=0.006010 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2086320146498848, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2206516081267509, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.932408 (no previous merge yet)
[S5] round=26 local utility u=0.007959 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2511965382443604, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2671140257226927, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.085888 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.597241 metrics={'f1_val': 0.0159870250231696, 'auprc': 0.0159870250231696, 'loss_val': 3.7751825588405477, 'psi': 0.0159870250231696}-{'f1_val': 0.10042081101759755, 'auprc': 0.10042081101759755, 'loss_val': 5.72956883401273, 'psi': 0.10042081101759755}
[S7] START round=26 head_norm_before_train=1.679762 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.24014336917562726, 'auprc': 0.24014336917562726, 'loss_val': 0.7741329884890376, 'psi': 0.24014336917562729}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.7973935260777856, 'psi': 0.35976373724718097}
[S8] START round=26 head_norm_before_train=1.492365 cos_to_last_merge=0.9993 (last merge round=24)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.00692786710004, 'psi': 0.35939447907390915}-{'f1_val': 0.9994356513935347, 'auprc': 0.9994356513935347, 'loss_val': 1.0400801250598422, 'psi': 0.9994356513935347}
[S9] START round=26 head_norm_before_train=1.568318 cos_to_last_merge=0.9686 (last merge round=22)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0605801412247766, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9197094427789076, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.897488 (no previous merge yet)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.23722461957756075, 'auprc': 0.23722461957756075, 'loss_val': 1.1614399607991934, 'psi': 0.23722461957756075}-{'f1_val': 0.24347319347319346, 'auprc': 0.24347319347319346, 'loss_val': 1.1410719495853967, 'psi': 0.24347319347319346}
[S11] START round=26 head_norm_before_train=1.785158 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.0010385330856977, 'psi': 0.33201273984308244}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.9362810067978793, 'psi': 0.3320133550741517}
[S13] START round=26 head_norm_before_train=1.190451 cos_to_last_merge=0.9973 (last merge round=23)
[S13] round=26 local utility u=0.046602 metrics={'f1_val': 0.6651770508034461, 'auprc': 0.6651770508034461, 'loss_val': 0.5828456604723949, 'psi': 0.6651770508034461}-{'f1_val': 0.6649648747744116, 'auprc': 0.6649648747744116, 'loss_val': 0.6741401429361096, 'psi': 0.6649648747744116}
[S14] START round=26 head_norm_before_train=1.254332 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.129370 metrics={'f1_val': 0.1276595744680851, 'auprc': 0.1276595744680851, 'loss_val': 2.3086211110861203, 'psi': 0.1276595744680851}-{'f1_val': 0.13111866112998616, 'auprc': 0.13111866112998616, 'loss_val': 2.5984937696397608, 'psi': 0.13111866112998616}
[S15] START round=26 head_norm_before_train=1.397465 cos_to_last_merge=0.9964 (last merge round=23)
[S15] round=26 local utility u=0.057415 metrics={'f1_val': 0.30099330099330096, 'auprc': 0.30099330099330096, 'loss_val': 0.7785576415491262, 'psi': 0.30099330099330096}-{'f1_val': 0.2915037326697476, 'auprc': 0.2915037326697476, 'loss_val': 0.8079814434086092, 'psi': 0.2915037326697476}
[S16] START round=26 head_norm_before_train=1.819794 (no previous merge yet)
[S16] round=26 local utility u=0.403265 metrics={'f1_val': 0.12048948854722309, 'auprc': 0.12048948854722309, 'loss_val': 3.7785095135655054, 'psi': 0.12048948854722309}-{'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 4.3064100416829, 'psi': 0.08953068592057761}
[S17] START round=26 head_norm_before_train=1.192182 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9906436344534356, 'psi': 0.20289293555469456}-{'f1_val': 0.20349685210048432, 'auprc': 0.20349685210048432, 'loss_val': 0.9652909305600916, 'psi': 0.20349685210048432}
[S6] not sending this round → trigger blocked (psi=0.016)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.128)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61012
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.120)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:61008
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1807 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1806) from S13
[S7] cosine check vs S13: cos=-0.0646
[S7] DROPPED delta from S13 (cos=-0.0646 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S5
[S11] cosine check vs S5: cos=-0.0526
[S11] DROPPED delta from S5 (cos=-0.0526 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1807) from S15
[S9] cosine check vs S15: cos=0.7183
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.3687 head_norm=1.610151
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.760944e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.3687 head_norm=1.407557 delta_norm=0.576094
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.766879 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7660315771920865, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7323986308888033, 'psi': 0.3674775928297055}
[S3] START round=27 head_norm_before_train=1.989967 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.9351937187766737, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.916083503595699, 'psi': 0.3641628959276018}
[S4] START round=27 head_norm_before_train=1.852207 (no previous merge yet)
[S4] round=27 local utility u=0.002327 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.203977602722475, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2086320146498848, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.965936 (no previous merge yet)
[S5] round=27 local utility u=0.004909 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2413783775380245, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2511965382443604, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.109287 cos_to_last_merge=0.9996 (last merge round=25)
[S6] round=27 local utility u=0.304859 metrics={'f1_val': 0.08780584056827151, 'auprc': 0.08780584056827151, 'loss_val': 3.8118347909209183, 'psi': 0.08780584056827151}-{'f1_val': 0.0159870250231696, 'auprc': 0.0159870250231696, 'loss_val': 3.7751825588405477, 'psi': 0.0159870250231696}
[S7] START round=27 head_norm_before_train=1.687223 (no previous merge yet)
[S7] round=27 local utility u=0.099175 metrics={'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.6605763505804727, 'psi': 0.24956478487938324}-{'f1_val': 0.24014336917562726, 'auprc': 0.24014336917562726, 'loss_val': 0.7741329884890376, 'psi': 0.24014336917562729}
[S8] START round=27 head_norm_before_train=1.523199 cos_to_last_merge=0.9977 (last merge round=24)
[S8] round=27 local utility u=0.007616 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9916966286386139, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.00692786710004, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.407557 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.196588 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6674046379198266, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0605801412247766, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.929495 (no previous merge yet)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.2336239660183322, 'auprc': 0.2336239660183322, 'loss_val': 1.1873628646700285, 'psi': 0.2336239660183322}-{'f1_val': 0.23722461957756075, 'auprc': 0.23722461957756075, 'loss_val': 1.1614399607991934, 'psi': 0.23722461957756075}
[S11] START round=27 head_norm_before_train=1.798518 (no previous merge yet)
[S11] round=27 local utility u=0.016113 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.96881896214437, 'psi': 0.3320133550741517}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.0010385330856977, 'psi': 0.33201273984308244}
[S13] START round=27 head_norm_before_train=1.212392 cos_to_last_merge=0.9940 (last merge round=23)
[S13] round=27 local utility u=0.016379 metrics={'f1_val': 0.6644749200506603, 'auprc': 0.6644749200506603, 'loss_val': 0.5437684532023609, 'psi': 0.6644749200506603}-{'f1_val': 0.6651770508034461, 'auprc': 0.6651770508034461, 'loss_val': 0.5828456604723949, 'psi': 0.6651770508034461}
[S14] START round=27 head_norm_before_train=1.285134 cos_to_last_merge=0.9964 (last merge round=25)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.78965066797272, 'psi': 0.13582554517133957}-{'f1_val': 0.1276595744680851, 'auprc': 0.1276595744680851, 'loss_val': 2.3086211110861203, 'psi': 0.1276595744680851}
[S15] START round=27 head_norm_before_train=1.426048 cos_to_last_merge=0.9932 (last merge round=23)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.2881396461023434, 'auprc': 0.2881396461023434, 'loss_val': 0.7787951214589476, 'psi': 0.2881396461023434}-{'f1_val': 0.30099330099330096, 'auprc': 0.30099330099330096, 'loss_val': 0.7785576415491262, 'psi': 0.30099330099330096}
[S16] START round=27 head_norm_before_train=1.829613 (no previous merge yet)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.07507307998937018, 'auprc': 0.07507307998937018, 'loss_val': 4.114834772282813, 'psi': 0.07507307998937018}-{'f1_val': 0.12048948854722309, 'auprc': 0.12048948854722309, 'loss_val': 3.7785095135655054, 'psi': 0.12048948854722309}
[S17] START round=27 head_norm_before_train=1.246859 cos_to_last_merge=0.9990 (last merge round=25)
[S17] round=27 local utility u=0.043098 metrics={'f1_val': 0.20370676894079467, 'auprc': 0.20370676894079467, 'loss_val': 0.9117722097931942, 'psi': 0.20370676894079467}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9906436344534356, 'psi': 0.20289293555469456}
[S6] not sending this round → trigger blocked (psi=0.088)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:61013
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:61014
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:61012
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:61005
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S9] → sending delta(kind=head bytes=1809) to S15@127.0.0.1:61015
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1809 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] cosine check vs S11: cos=-0.0533
[S5] DROPPED delta from S11 (cos=-0.0533 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S13
[S7] cosine check vs S13: cos=-0.0620
[S7] DROPPED delta from S13 (cos=-0.0620 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1809) from S9
[S15] cosine check vs S9: cos=0.8959
[S14] RECEIVED delta(kind=head bytes=1794) from S8
[S14] cosine check vs S8: cos=0.8678
[S13] RECEIVED delta(kind=head bytes=1805) from S7
[S13] cosine check vs S7: cos=-0.0620
[S13] DROPPED delta from S7 (cos=-0.0620 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1805) from S5
[S11] cosine check vs S5: cos=-0.0533
[S11] DROPPED delta from S5 (cos=-0.0533 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:61007
[S17] sending update (kind=head size=1807 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1807) from S17
[S6] cosine check vs S17: cos=0.5300
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.2881 head_norm=1.460072
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.337258e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.2864 head_norm=1.424019 delta_norm=0.333726
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.0878 head_norm=1.159505
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.951111e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.0689 head_norm=1.069510 delta_norm=0.595111
[S6] aggregate: ROLLBACK (f1_val pre=0.088 post=0.069 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.1358 head_norm=1.330730
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.845277e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.1358 head_norm=1.390954 delta_norm=0.384528
[S14] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.777111 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.792875095315666, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.7660315771920865, 'psi': 0.3674775928297055}
[S3] START round=28 head_norm_before_train=1.998674 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.9839228611725996, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.9351937187766737, 'psi': 0.3641628959276018}
[S4] START round=28 head_norm_before_train=1.872489 (no previous merge yet)
[S4] round=28 local utility u=0.002672 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1986333054716583, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.203977602722475, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.990068 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.258668118453593, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2413783775380245, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.069510 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.086678 metrics={'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 3.0752707159710204, 'psi': 0.025227272727272727}-{'f1_val': 0.08780584056827151, 'auprc': 0.08780584056827151, 'loss_val': 3.8118347909209183, 'psi': 0.08780584056827151}
[S7] START round=28 head_norm_before_train=1.698223 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6972331711094345, 'psi': 0.24962705121829937}-{'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.6605763505804727, 'psi': 0.24956478487938324}
[S8] START round=28 head_norm_before_train=1.547380 cos_to_last_merge=0.9959 (last merge round=24)
[S8] round=28 local utility u=0.004433 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9828298409014828, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9916966286386139, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.465127 cos_to_last_merge=0.9977 (last merge round=26)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8337117846207265, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6674046379198266, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.960996 (no previous merge yet)
[S10] round=28 local utility u=0.005281 metrics={'f1_val': 0.23583841119386142, 'auprc': 0.23583841119386142, 'loss_val': 1.1967313536296846, 'psi': 0.23583841119386145}-{'f1_val': 0.2336239660183322, 'auprc': 0.2336239660183322, 'loss_val': 1.1873628646700285, 'psi': 0.2336239660183322}
[S11] START round=28 head_norm_before_train=1.813176 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.0444591996595793, 'psi': 0.33201273984308244}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.96881896214437, 'psi': 0.3320133550741517}
[S13] START round=28 head_norm_before_train=1.231883 cos_to_last_merge=0.9905 (last merge round=23)
[S13] round=28 local utility u=0.034766 metrics={'f1_val': 0.6648746422246283, 'auprc': 0.6648746422246283, 'loss_val': 0.4778331803137725, 'psi': 0.6648746422246283}-{'f1_val': 0.6644749200506603, 'auprc': 0.6644749200506603, 'loss_val': 0.5437684532023609, 'psi': 0.6644749200506603}
[S14] START round=28 head_norm_before_train=1.390954 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.159674 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.4703016930497004, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.78965066797272, 'psi': 0.13582554517133957}
[S15] START round=28 head_norm_before_train=1.424019 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.28374455732946297, 'auprc': 0.28374455732946297, 'loss_val': 0.8569384792120108, 'psi': 0.28374455732946297}-{'f1_val': 0.2881396461023434, 'auprc': 0.2881396461023434, 'loss_val': 0.7787951214589476, 'psi': 0.2881396461023434}
[S16] START round=28 head_norm_before_train=1.838639 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.05293715846994535, 'auprc': 0.05293715846994535, 'loss_val': 4.76492090744656, 'psi': 0.052937158469945345}-{'f1_val': 0.07507307998937018, 'auprc': 0.07507307998937018, 'loss_val': 4.114834772282813, 'psi': 0.07507307998937018}
[S17] START round=28 head_norm_before_train=1.285132 cos_to_last_merge=0.9969 (last merge round=25)
[S17] round=28 local utility u=0.298267 metrics={'f1_val': 0.25929253790680207, 'auprc': 0.25929253790680207, 'loss_val': 0.8155100297881644, 'psi': 0.25929253790680207}-{'f1_val': 0.20370676894079467, 'auprc': 0.20370676894079467, 'loss_val': 0.9117722097931942, 'psi': 0.20370676894079467}
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S4
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S13
[S8]  timeout peer S16
[S8]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S8] not sending this round → trigger blocked (psi=0.359)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.665)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.357)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:61014
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.025)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.2338
[S17] not sending this round → trigger blocked (psi=0.259)
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S8
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.1358 head_norm=1.425835
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.080100e+00
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.1358 head_norm=1.352745 delta_norm=1.080100
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.786717 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.2611311672683514, 'auprc': 0.2611311672683514, 'loss_val': 3.0914215543436483, 'psi': 0.2611311672683514}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.792875095315666, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=2.009017 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.0147499885402587, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.9839228611725996, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.887763 (no previous merge yet)
[S4] round=29 local utility u=0.003259 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1921152065374723, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1986333054716583, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=29 head_norm_before_train=2.008985 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.266709104733345, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.258668118453593, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.121137 cos_to_last_merge=0.9949 (last merge round=27)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 3.7244487722385107, 'psi': 0.025227272727272727}-{'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 3.0752707159710204, 'psi': 0.025227272727272727}
[S7] START round=29 head_norm_before_train=1.705988 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.19531401905502624, 'auprc': 0.19531401905502624, 'loss_val': 0.7952326566232483, 'psi': 0.19531401905502624}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6972331711094345, 'psi': 0.24962705121829937}
[S8] START round=29 head_norm_before_train=1.571392 cos_to_last_merge=0.9936 (last merge round=24)
[S8] round=29 local utility u=0.003231 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9763678290545414, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9828298409014828, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.535219 cos_to_last_merge=0.9910 (last merge round=26)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9818361652883016, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8337117846207265, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.989991 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.23477870141541227, 'auprc': 0.23477870141541227, 'loss_val': 1.2143323556073504, 'psi': 0.23477870141541227}-{'f1_val': 0.23583841119386142, 'auprc': 0.23583841119386142, 'loss_val': 1.1967313536296846, 'psi': 0.23583841119386145}
[S11] START round=29 head_norm_before_train=1.827867 (no previous merge yet)
[S11] round=29 local utility u=0.028760 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.984858242766758, 'psi': 0.33178150217256364}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.0444591996595793, 'psi': 0.33201273984308244}
[S13] START round=29 head_norm_before_train=1.251118 cos_to_last_merge=0.9870 (last merge round=23)
[S13] round=29 local utility u=0.022786 metrics={'f1_val': 0.6646870960796948, 'auprc': 0.6646870960796948, 'loss_val': 0.4305724294931042, 'psi': 0.6646870960796948}-{'f1_val': 0.6648746422246283, 'auprc': 0.6648746422246283, 'loss_val': 0.4778331803137725, 'psi': 0.6648746422246283}
[S14] START round=29 head_norm_before_train=1.352745 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13572406923172706, 'auprc': 0.13572406923172706, 'loss_val': 3.187474339363765, 'psi': 0.13572406923172706}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 2.4703016930497004, 'psi': 0.13582554517133957}
[S15] START round=29 head_norm_before_train=1.459734 cos_to_last_merge=0.9995 (last merge round=27)
[S15] round=29 local utility u=0.010406 metrics={'f1_val': 0.28374455732946297, 'auprc': 0.28374455732946297, 'loss_val': 0.836127103364549, 'psi': 0.28374455732946297}-{'f1_val': 0.28374455732946297, 'auprc': 0.28374455732946297, 'loss_val': 0.8569384792120108, 'psi': 0.28374455732946297}
[S16] START round=29 head_norm_before_train=1.846438 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.05481784133469527, 'auprc': 0.05481784133469527, 'loss_val': 4.865535195715022, 'psi': 0.05481784133469527}-{'f1_val': 0.05293715846994535, 'auprc': 0.05293715846994535, 'loss_val': 4.76492090744656, 'psi': 0.052937158469945345}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.316181 cos_to_last_merge=0.9942 (last merge round=25)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.20497652139443182, 'auprc': 0.20497652139443182, 'loss_val': 0.8614839251767936, 'psi': 0.20497652139443182}-{'f1_val': 0.25929253790680207, 'auprc': 0.25929253790680207, 'loss_val': 0.8155100297881644, 'psi': 0.25929253790680207}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61010
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:61005
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S13
[S7] cosine check vs S13: cos=-0.0569
[S7] DROPPED delta from S13 (cos=-0.0569 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=0.9436
[S5] RECEIVED delta(kind=head bytes=1804) from S11
[S5] cosine check vs S11: cos=-0.0545
[S5] DROPPED delta from S11 (cos=-0.0545 < 0.0)
[S17] RoundReady barrier timeout: have=2 need=3 — continuing
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RoundReady barrier timeout: have=2 need=4 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61015
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=0.8866
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S7]  timeout peer S13
[S7]  timeout peer S16
[S11]  timeout peer S3
[S11]  timeout peer S5
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S11
[S8]  timeout peer S14
[S14]  timeout peer S10
[S9]  timeout peer S15
[S15]  timeout peer S8
[S2] START round=30 head_norm_before_train=1.795377 (no previous merge yet)
[S2] round=30 local utility u=0.126599 metrics={'f1_val': 0.26215175833496446, 'auprc': 0.26215175833496446, 'loss_val': 2.8474089131059452, 'psi': 0.26215175833496446}-{'f1_val': 0.2611311672683514, 'auprc': 0.2611311672683514, 'loss_val': 3.0914215543436483, 'psi': 0.2611311672683514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=30 head_norm_before_train=2.019681 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.0458714139177845, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.0147499885402587, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.896668 (no previous merge yet)
[S4] round=30 local utility u=0.000032 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1920521450636832, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1921152065374723, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=30 head_norm_before_train=2.031837 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.341952230447496, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.266709104733345, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.196859 cos_to_last_merge=0.9795 (last merge round=27)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 4.433774789481759, 'psi': 0.02153000458085204}-{'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 3.7244487722385107, 'psi': 0.025227272727272727}
[S7] START round=30 head_norm_before_train=1.715475 (no previous merge yet)
[S7] round=30 local utility u=0.289609 metrics={'f1_val': 0.24925298804780877, 'auprc': 0.24925298804780877, 'loss_val': 0.7014648927188732, 'psi': 0.24925298804780877}-{'f1_val': 0.19531401905502624, 'auprc': 0.19531401905502624, 'loss_val': 0.7952326566232483, 'psi': 0.19531401905502624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=30 head_norm_before_train=1.595192 cos_to_last_merge=0.9912 (last merge round=24)
[S8] round=30 local utility u=0.000750 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9748668808242834, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9763678290545414, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.590357 cos_to_last_merge=0.9841 (last merge round=26)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0913011680872886, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9818361652883016, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.3687 head_norm=1.630539
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.903020e-01
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.3687 head_norm=1.532180 delta_norm=0.290302
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] START round=30 head_norm_before_train=2.016131 (no previous merge yet)
[S10] round=30 local utility u=0.021820 metrics={'f1_val': 0.24089022140221403, 'auprc': 0.24089022140221403, 'loss_val': 1.2256966289721474, 'psi': 0.24089022140221403}-{'f1_val': 0.23477870141541227, 'auprc': 0.23477870141541227, 'loss_val': 1.2143323556073504, 'psi': 0.23477870141541227}
[S11] START round=30 head_norm_before_train=1.842098 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.076051328499508, 'psi': 0.3320133550741517}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.984858242766758, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.276013 cos_to_last_merge=0.9832 (last merge round=23)
[S13] round=30 local utility u=0.026972 metrics={'f1_val': 0.6648746422246283, 'auprc': 0.6648746422246283, 'loss_val': 0.3783169732552123, 'psi': 0.6648746422246283}-{'f1_val': 0.6646870960796948, 'auprc': 0.6646870960796948, 'loss_val': 0.4305724294931042, 'psi': 0.6646870960796948}
[S14] START round=30 head_norm_before_train=1.404302 cos_to_last_merge=0.9980 (last merge round=28)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 3.7211813057171854, 'psi': 0.13333333333333333}-{'f1_val': 0.13572406923172706, 'auprc': 0.13572406923172706, 'loss_val': 3.187474339363765, 'psi': 0.13572406923172706}
[S15] START round=30 head_norm_before_train=1.484938 cos_to_last_merge=0.9986 (last merge round=27)
[S15] round=30 local utility u=0.039994 metrics={'f1_val': 0.28416092787241753, 'auprc': 0.28416092787241753, 'loss_val': 0.7598857215176572, 'psi': 0.28416092787241753}-{'f1_val': 0.28374455732946297, 'auprc': 0.28374455732946297, 'loss_val': 0.836127103364549, 'psi': 0.28374455732946297}
[S16] START round=30 head_norm_before_train=1.855116 (no previous merge yet)
[S16] round=30 local utility u=0.251867 metrics={'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 4.674217791530353, 'psi': 0.08953068592057761}-{'f1_val': 0.05481784133469527, 'auprc': 0.05481784133469527, 'loss_val': 4.865535195715022, 'psi': 0.05481784133469527}
[S16] not sending this round → trigger blocked (psi=0.090)
[S17] START round=30 head_norm_before_train=1.342115 cos_to_last_merge=0.9924 (last merge round=25)
[S17] round=30 local utility u=0.000802 metrics={'f1_val': 0.2061913621145198, 'auprc': 0.2061913621145198, 'loss_val': 0.8708129756128301, 'psi': 0.2061913621145198}-{'f1_val': 0.20497652139443182, 'auprc': 0.20497652139443182, 'loss_val': 0.8614839251767936, 'psi': 0.20497652139443182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:61010
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:61013
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.146 → S17@127.0.0.1:61017
[S10] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] ⇄ pheromone p=0.009 → S11@127.0.0.1:61012
[S17] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:61008
[S15] sending update (kind=head size=1805 to 1 peers)
[S14] ⇄ pheromone p=0.092 → S8@127.0.0.1:61009
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.8500
[S13] RECEIVED delta(kind=head bytes=1805) from S17
[S13] cosine check vs S17: cos=0.9642
[S9] RECEIVED delta(kind=head bytes=1805) from S15
[S9] cosine check vs S15: cos=0.9811
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=0.8825
[S13] sending update (kind=head size=1804 to 1 peers)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.2842 head_norm=1.507940
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.798804e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.2844 head_norm=1.510906 delta_norm=0.379880
[S15] aggregate: ACCEPT kept=['S8', 'S8'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.053 → S9@127.0.0.1:61010
[S17] ⇄ pheromone p=0.069 → S13@127.0.0.1:61013
[S8] ⇄ pheromone p=0.063 → S15@127.0.0.1:61015
[S10] ⇄ pheromone p=0.040 → S14@127.0.0.1:61014
[S7] RECEIVED delta(kind=head bytes=1804) from S13
[S7] cosine check vs S13: cos=-0.0544
[S7] DROPPED delta from S13 (cos=-0.0544 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.6649 head_norm=1.295555
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.810344e-01
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.6649 head_norm=1.317696 delta_norm=0.181034
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.065 → S7@127.0.0.1:61008
[S2] START round=31 head_norm_before_train=1.803708 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.980610299180306, 'psi': 0.2654773703336637}-{'f1_val': 0.26215175833496446, 'auprc': 0.26215175833496446, 'loss_val': 2.8474089131059452, 'psi': 0.26215175833496446}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=2.030001 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.0656799005654287, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.0458714139177845, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.908077 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.19942428560933, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1920521450636832, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=2.063318 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.385520736623916, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.341952230447496, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=1.269903 cos_to_last_merge=0.9623 (last merge round=27)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 4.873446701419888, 'psi': 0.02153000458085204}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 4.433774789481759, 'psi': 0.02153000458085204}
[S7] START round=31 head_norm_before_train=1.726109 (no previous merge yet)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.7519443349003875, 'psi': 0.2496892866020383}-{'f1_val': 0.24925298804780877, 'auprc': 0.24925298804780877, 'loss_val': 0.7014648927188732, 'psi': 0.24925298804780877}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.617679 cos_to_last_merge=0.9888 (last merge round=24)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.982918053784197, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9748668808242834, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.532180 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.107716 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.875868390531364, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0913011680872886, 'psi': 0.36867172340800847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.3687 head_norm=1.572839
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.804452e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.3687 head_norm=1.530128 delta_norm=0.180445
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] START round=31 head_norm_before_train=2.040411 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.23989435002296738, 'auprc': 0.23989435002296738, 'loss_val': 1.2419894637729947, 'psi': 0.23989435002296738}-{'f1_val': 0.24089022140221403, 'auprc': 0.24089022140221403, 'loss_val': 1.2256966289721474, 'psi': 0.24089022140221403}
[S11] START round=31 head_norm_before_train=1.857711 (no previous merge yet)
[S11] round=31 local utility u=0.005300 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.064754486086909, 'psi': 0.3319360347772085}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.076051328499508, 'psi': 0.3320133550741517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=31 head_norm_before_train=1.317696 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6648746422246283, 'auprc': 0.6648746422246283, 'loss_val': 0.4075377023446602, 'psi': 0.6648746422246283}-{'f1_val': 0.6648746422246283, 'auprc': 0.6648746422246283, 'loss_val': 0.3783169732552123, 'psi': 0.6648746422246283}
[S14] START round=31 head_norm_before_train=1.447629 cos_to_last_merge=0.9947 (last merge round=28)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.000345453889018, 'psi': 0.13577478824115594}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 3.7211813057171854, 'psi': 0.13333333333333333}
[S15] START round=31 head_norm_before_train=1.510906 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.002788 metrics={'f1_val': 0.2845763939174511, 'auprc': 0.2845763939174511, 'loss_val': 0.7580494786491957, 'psi': 0.2845763939174511}-{'f1_val': 0.28416092787241753, 'auprc': 0.28416092787241753, 'loss_val': 0.7598857215176572, 'psi': 0.28416092787241753}
[S16] START round=31 head_norm_before_train=1.864141 (no previous merge yet)
[S16] round=31 local utility u=0.143349 metrics={'f1_val': 0.0691747572815534, 'auprc': 0.0691747572815534, 'loss_val': 4.204315669269485, 'psi': 0.0691747572815534}-{'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 4.674217791530353, 'psi': 0.08953068592057761}
[S16] not sending this round → trigger blocked (psi=0.069)
[S17] START round=31 head_norm_before_train=1.363719 cos_to_last_merge=0.9911 (last merge round=25)
[S17] round=31 local utility u=0.100639 metrics={'f1_val': 0.23462922404218076, 'auprc': 0.23462922404218076, 'loss_val': 0.9254748645078137, 'psi': 0.23462922404218073}-{'f1_val': 0.2061913621145198, 'auprc': 0.2061913621145198, 'loss_val': 0.8708129756128301, 'psi': 0.2061913621145198}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.235)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.285)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.1358 head_norm=1.482851
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.578971e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.1358 head_norm=1.694052 delta_norm=0.557897
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.811665 (no previous merge yet)
[S2] round=32 local utility u=0.029638 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.9208614997090043, 'psi': 0.26542475888492534}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.980610299180306, 'psi': 0.2654773703336637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=32 head_norm_before_train=2.039702 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.0969757962831737, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.0656799005654287, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.924707 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.207010856172071, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.19942428560933, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=2.087151 (no previous merge yet)
[S5] round=32 local utility u=0.010425 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.3646713092678566, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.385520736623916, 'psi': 0.3335071121394324}
[S6] START round=32 head_norm_before_train=1.334172 cos_to_last_merge=0.9473 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.170078865041031, 'psi': 0.021749084249084248}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 4.873446701419888, 'psi': 0.02153000458085204}
[S7] START round=32 head_norm_before_train=1.736091 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.7780373005272173, 'psi': 0.24956478487938324}-{'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.7519443349003875, 'psi': 0.2496892866020383}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.638936 cos_to_last_merge=0.9864 (last merge round=24)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0047455432648027, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.982918053784197, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.530128 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.034247 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8073752693131733, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.875868390531364, 'psi': 0.36867172340800847}
[S9] not sending this round → trigger blocked (psi=0.369)
[S10] START round=32 head_norm_before_train=2.062398 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.24017015405840422, 'auprc': 0.24017015405840422, 'loss_val': 1.261157706149103, 'psi': 0.2401701540584042}-{'f1_val': 0.23989435002296738, 'auprc': 0.23989435002296738, 'loss_val': 1.2419894637729947, 'psi': 0.23989435002296738}
[S11] START round=32 head_norm_before_train=1.872903 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.1580932837988325, 'psi': 0.33201273984308244}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.064754486086909, 'psi': 0.3319360347772085}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.329948 cos_to_last_merge=0.9997 (last merge round=30)
[S13] round=32 local utility u=0.028694 metrics={'f1_val': 0.6657881153823432, 'auprc': 0.6657881153823432, 'loss_val': 0.3583719414263493, 'psi': 0.6657881153823432}-{'f1_val': 0.6648746422246283, 'auprc': 0.6648746422246283, 'loss_val': 0.4075377023446602, 'psi': 0.6648746422246283}
[S14] START round=32 head_norm_before_train=1.694052 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.038521 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 3.923304180395962, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.000345453889018, 'psi': 0.13577478824115594}
[S15] START round=32 head_norm_before_train=1.537732 cos_to_last_merge=0.9997 (last merge round=30)
[S15] round=32 local utility u=1.000000 metrics={'f1_val': 0.6166937408445748, 'auprc': 0.6166937408445748, 'loss_val': 0.7938594477349507, 'psi': 0.6166937408445748}-{'f1_val': 0.2845763939174511, 'auprc': 0.2845763939174511, 'loss_val': 0.7580494786491957, 'psi': 0.2845763939174511}
[S16] START round=32 head_norm_before_train=1.873142 (no previous merge yet)
[S16] round=32 local utility u=0.325449 metrics={'f1_val': 0.1202260922700886, 'auprc': 0.1202260922700886, 'loss_val': 4.012879910312585, 'psi': 0.1202260922700886}-{'f1_val': 0.0691747572815534, 'auprc': 0.0691747572815534, 'loss_val': 4.204315669269485, 'psi': 0.0691747572815534}
[S16] not sending this round → trigger blocked (psi=0.120)
[S17] START round=32 head_norm_before_train=1.386174 cos_to_last_merge=0.9900 (last merge round=25)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.2062308122890749, 'auprc': 0.2062308122890749, 'loss_val': 1.0057099608586606, 'psi': 0.2062308122890749}-{'f1_val': 0.23462922404218076, 'auprc': 0.23462922404218076, 'loss_val': 0.9254748645078137, 'psi': 0.23462922404218073}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:61017
[S13] sending update (kind=head size=1805 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S13
[S17] cosine check vs S13: cos=0.9869
[S2] START round=33 head_norm_before_train=1.819478 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.2525614432082469, 'auprc': 0.2525614432082469, 'loss_val': 2.8243940539281667, 'psi': 0.2525614432082469}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.9208614997090043, 'psi': 0.26542475888492534}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=2.049370 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.124073534585093, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.0969757962831737, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.937155 (no previous merge yet)
[S4] round=33 local utility u=0.003046 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2009196870192496, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.207010856172071, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=33 head_norm_before_train=2.106566 (no previous merge yet)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.4094343497791795, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.3646713092678566, 'psi': 0.3335071121394324}
[S6] START round=33 head_norm_before_train=1.386688 cos_to_last_merge=0.9357 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.447341998541013, 'psi': 0.021310724106324473}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.170078865041031, 'psi': 0.021749084249084248}
[S7] START round=33 head_norm_before_train=1.751545 (no previous merge yet)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.2197766097240473, 'auprc': 0.2197766097240473, 'loss_val': 0.8296928993832966, 'psi': 0.21977660972404733}-{'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.7780373005272173, 'psi': 0.24956478487938324}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.661133 cos_to_last_merge=0.9839 (last merge round=24)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0307738935871587, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0047455432648027, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.583576 cos_to_last_merge=0.9981 (last merge round=31)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9320146281151018, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8073752693131733, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=2.082792 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.22796684118673646, 'auprc': 0.22796684118673646, 'loss_val': 1.330763800271062, 'psi': 0.2279668411867365}-{'f1_val': 0.24017015405840422, 'auprc': 0.24017015405840422, 'loss_val': 1.261157706149103, 'psi': 0.2401701540584042}
[S11] START round=33 head_norm_before_train=1.887050 (no previous merge yet)
[S11] round=33 local utility u=0.006269 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.145561551649814, 'psi': 0.3320133550741517}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.1580932837988325, 'psi': 0.33201273984308244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=33 head_norm_before_train=1.343438 cos_to_last_merge=0.9991 (last merge round=30)
[S13] round=33 local utility u=0.009239 metrics={'f1_val': 0.6657881153823432, 'auprc': 0.6657881153823432, 'loss_val': 0.33989342117646243, 'psi': 0.6657881153823432}-{'f1_val': 0.6657881153823432, 'auprc': 0.6657881153823432, 'loss_val': 0.3583719414263493, 'psi': 0.6657881153823432}
[S14] START round=33 head_norm_before_train=1.718488 cos_to_last_merge=0.9998 (last merge round=31)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.076460597840505, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 3.923304180395962, 'psi': 0.13577478824115594}
[S15] START round=33 head_norm_before_train=1.568280 cos_to_last_merge=0.9987 (last merge round=30)
[S15] round=33 local utility u=0.069647 metrics={'f1_val': 0.6177464885958709, 'auprc': 0.6177464885958709, 'loss_val': 0.6640403256590455, 'psi': 0.6177464885958709}-{'f1_val': 0.6166937408445748, 'auprc': 0.6166937408445748, 'loss_val': 0.7938594477349507, 'psi': 0.6166937408445748}
[S16] START round=33 head_norm_before_train=1.880799 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.01346801346801347, 'auprc': 0.01346801346801347, 'loss_val': 5.4243451714780555, 'psi': 0.01346801346801347}-{'f1_val': 0.1202260922700886, 'auprc': 0.1202260922700886, 'loss_val': 4.012879910312585, 'psi': 0.1202260922700886}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.407808 cos_to_last_merge=0.9886 (last merge round=25)
[S17] round=33 local utility u=0.138000 metrics={'f1_val': 0.23719560421327388, 'auprc': 0.23719560421327388, 'loss_val': 1.008393403460111, 'psi': 0.23719560421327388}-{'f1_val': 0.2062308122890749, 'auprc': 0.2062308122890749, 'loss_val': 1.0057099608586606, 'psi': 0.2062308122890749}
[S15] not sending this round → trigger blocked (psi=0.618)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.2372 head_norm=1.428795
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.233274e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.2358 head_norm=1.381279 delta_norm=0.123327
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] not sending this round → trigger blocked (psi=0.666)
[S2] START round=34 head_norm_before_train=1.827035 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.8662527514394287, 'psi': 0.24507471790179935}-{'f1_val': 0.2525614432082469, 'auprc': 0.2525614432082469, 'loss_val': 2.8243940539281667, 'psi': 0.2525614432082469}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=2.058416 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.1490560924972, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.124073534585093, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.945121 (no previous merge yet)
[S4] round=34 local utility u=0.002808 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.195304247489106, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2009196870192496, 'psi': 0.3567939207526687}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] START round=34 head_norm_before_train=2.128711 (no previous merge yet)
[S5] round=34 local utility u=0.024850 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.359733893193487, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.4094343497791795, 'psi': 0.3335071121394324}
[S6] START round=34 head_norm_before_train=1.427503 cos_to_last_merge=0.9271 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.551624314012245, 'psi': 0.021749084249084248}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.447341998541013, 'psi': 0.021310724106324473}
[S7] START round=34 head_norm_before_train=1.763816 (no previous merge yet)
[S7] round=34 local utility u=0.188017 metrics={'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.7178212425493383, 'psi': 0.2491280518186348}-{'f1_val': 0.2197766097240473, 'auprc': 0.2197766097240473, 'loss_val': 0.8296928993832966, 'psi': 0.21977660972404733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=34 head_norm_before_train=1.679373 cos_to_last_merge=0.9817 (last merge round=24)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0588031855137654, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0307738935871587, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.639135 cos_to_last_merge=0.9933 (last merge round=31)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0464718816502803, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9320146281151018, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=2.101648 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.21978137481606055, 'auprc': 0.21978137481606055, 'loss_val': 1.3866880728834878, 'psi': 0.21978137481606055}-{'f1_val': 0.22796684118673646, 'auprc': 0.22796684118673646, 'loss_val': 1.330763800271062, 'psi': 0.2279668411867365}
[S11] START round=34 head_norm_before_train=1.899996 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.193802544523766, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.145561551649814, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.353983 cos_to_last_merge=0.9988 (last merge round=30)
[S13] round=34 local utility u=0.006841 metrics={'f1_val': 0.6657881153823432, 'auprc': 0.6657881153823432, 'loss_val': 0.3262122552075447, 'psi': 0.6657881153823432}-{'f1_val': 0.6657881153823432, 'auprc': 0.6657881153823432, 'loss_val': 0.33989342117646243, 'psi': 0.6657881153823432}
[S14] START round=34 head_norm_before_train=1.739787 cos_to_last_merge=0.9992 (last merge round=31)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.262545401813396, 'psi': 0.13582554517133957}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.076460597840505, 'psi': 0.13577478824115594}
[S15] START round=34 head_norm_before_train=1.601284 cos_to_last_merge=0.9972 (last merge round=30)
[S15] round=34 local utility u=0.115910 metrics={'f1_val': 0.6256561826980748, 'auprc': 0.6256561826980748, 'loss_val': 0.5034080878606964, 'psi': 0.6256561826980748}-{'f1_val': 0.6177464885958709, 'auprc': 0.6177464885958709, 'loss_val': 0.6640403256590455, 'psi': 0.6177464885958709}
[S16] START round=34 head_norm_before_train=1.886874 (no previous merge yet)
[S16] round=34 local utility u=0.762243 metrics={'f1_val': 0.07348740586860555, 'auprc': 0.07348740586860555, 'loss_val': 4.4400343054892115, 'psi': 0.07348740586860555}-{'f1_val': 0.01346801346801347, 'auprc': 0.01346801346801347, 'loss_val': 5.4243451714780555, 'psi': 0.01346801346801347}
[S16] not sending this round → trigger blocked (psi=0.073)
[S17] START round=34 head_norm_before_train=1.381279 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.429723 metrics={'f1_val': 0.3329399774513072, 'auprc': 0.3329399774513072, 'loss_val': 1.0106470799804677, 'psi': 0.3329399774513072}-{'f1_val': 0.23719560421327388, 'auprc': 0.23719560421327388, 'loss_val': 1.008393403460111, 'psi': 0.23719560421327388}
[S17] not sending this round → trigger blocked (psi=0.333)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:61017
[S13] sending update (kind=head size=1806 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1806) from S13
[S17] cosine check vs S13: cos=0.9940
[S2] START round=35 head_norm_before_train=1.834465 (no previous merge yet)
[S2] round=35 local utility u=0.533111 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9016575700280507, 'psi': 0.3674775928297055}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.8662527514394287, 'psi': 0.24507471790179935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=35 head_norm_before_train=2.067133 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.1696485554070435, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.1490560924972, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.954330 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2054444006924454, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.195304247489106, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=2.142908 (no previous merge yet)
[S5] round=35 local utility u=0.038508 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2827173399709833, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.359733893193487, 'psi': 0.3335071121394324}
[S6] START round=35 head_norm_before_train=1.460162 cos_to_last_merge=0.9207 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.921
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 5.783202669948854, 'psi': 0.02065167508031207}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.551624314012245, 'psi': 0.021749084249084248}
[S7] START round=35 head_norm_before_train=1.777143 (no previous merge yet)
[S7] round=35 local utility u=0.032159 metrics={'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.6529410361139718, 'psi': 0.2490655370047346}-{'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.7178212425493383, 'psi': 0.2491280518186348}
[S7] not sending this round → trigger blocked (psi=0.249)
[S8] START round=35 head_norm_before_train=1.696925 cos_to_last_merge=0.9797 (last merge round=24)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.090156990559063, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0588031855137654, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.683318 cos_to_last_merge=0.9886 (last merge round=31)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1353505244998665, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0464718816502803, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=2.119178 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.21204135414555036, 'auprc': 0.21204135414555036, 'loss_val': 1.4712717852486612, 'psi': 0.21204135414555036}-{'f1_val': 0.21978137481606055, 'auprc': 0.21978137481606055, 'loss_val': 1.3866880728834878, 'psi': 0.21978137481606055}
[S11] START round=35 head_norm_before_train=1.913386 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.2424120279916795, 'psi': 0.3320901320901321}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.193802544523766, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.362039 cos_to_last_merge=0.9985 (last merge round=30)
[S13] round=35 local utility u=0.010049 metrics={'f1_val': 0.66562455648549, 'auprc': 0.66562455648549, 'loss_val': 0.3046425438131427, 'psi': 0.66562455648549}-{'f1_val': 0.6657881153823432, 'auprc': 0.6657881153823432, 'loss_val': 0.3262122552075447, 'psi': 0.6657881153823432}
[S14] START round=35 head_norm_before_train=1.757814 cos_to_last_merge=0.9986 (last merge round=31)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.4043621731684155, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.262545401813396, 'psi': 0.13582554517133957}
[S15] START round=35 head_norm_before_train=1.635506 cos_to_last_merge=0.9950 (last merge round=30)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.671042125028436, 'psi': 0.6164158146233559}-{'f1_val': 0.6256561826980748, 'auprc': 0.6256561826980748, 'loss_val': 0.5034080878606964, 'psi': 0.6256561826980748}
[S16] START round=35 head_norm_before_train=1.894083 (no previous merge yet)
[S16] round=35 local utility u=0.512992 metrics={'f1_val': 0.12994980479643056, 'auprc': 0.12994980479643056, 'loss_val': 3.9222125314174923, 'psi': 0.12994980479643056}-{'f1_val': 0.07348740586860555, 'auprc': 0.07348740586860555, 'loss_val': 4.4400343054892115, 'psi': 0.07348740586860555}
[S16] not sending this round → trigger blocked (psi=0.130)
[S17] START round=35 head_norm_before_train=1.400418 cos_to_last_merge=0.9998 (last merge round=33)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.2638231331067875, 'auprc': 0.2638231331067875, 'loss_val': 0.9983162619387164, 'psi': 0.2638231331067875}-{'f1_val': 0.3329399774513072, 'auprc': 0.3329399774513072, 'loss_val': 1.0106470799804677, 'psi': 0.3329399774513072}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.334)
[S13] not sending this round → trigger blocked (psi=0.666)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=35 metric=0.2638 head_norm=1.419858
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.650874e-02
[S17] stored merged vector for next round verification (round=35)
[S17] DEBUG after merge:  round=35 metric=0.2638 head_norm=1.388556 delta_norm=0.086509
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.028 → S17@127.0.0.1:61017
[S2] START round=36 head_norm_before_train=1.841526 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.21186885737864805, 'auprc': 0.21186885737864805, 'loss_val': 3.4994452853799314, 'psi': 0.21186885737864805}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9016575700280507, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.075168 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.1893773092325253, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.1696485554070435, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.964735 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2243346358354381, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2054444006924454, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=2.156701 (no previous merge yet)
[S5] round=36 local utility u=0.007159 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2683989087903806, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2827173399709833, 'psi': 0.3335071121394324}
[S6] START round=36 head_norm_before_train=1.486591 cos_to_last_merge=0.9157 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.916
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 5.9169349038425665, 'psi': 0.01954921803127875}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 5.783202669948854, 'psi': 0.02065167508031207}
[S7] START round=36 head_norm_before_train=1.788830 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.24868979286249066, 'auprc': 0.24868979286249066, 'loss_val': 0.6951060860524648, 'psi': 0.24868979286249066}-{'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.6529410361139718, 'psi': 0.2490655370047346}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.714521 cos_to_last_merge=0.9778 (last merge round=24)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1271638110624878, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.090156990559063, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=1.716112 cos_to_last_merge=0.9849 (last merge round=31)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.213901191289117, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1353505244998665, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=2.135131 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.20753968253968255, 'auprc': 0.20753968253968255, 'loss_val': 1.516750515034329, 'psi': 0.20753968253968255}-{'f1_val': 0.21204135414555036, 'auprc': 0.21204135414555036, 'loss_val': 1.4712717852486612, 'psi': 0.21204135414555036}
[S11] START round=36 head_norm_before_train=1.926458 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.2699299532608794, 'psi': 0.3320901320901321}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.2424120279916795, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.373744 cos_to_last_merge=0.9978 (last merge round=30)
[S13] round=36 local utility u=1.000000 metrics={'f1_val': 0.9977520212852571, 'auprc': 0.9977520212852571, 'loss_val': 0.28360429388960623, 'psi': 0.9977520212852571}-{'f1_val': 0.66562455648549, 'auprc': 0.66562455648549, 'loss_val': 0.3046425438131427, 'psi': 0.66562455648549}
[S14] START round=36 head_norm_before_train=1.773029 cos_to_last_merge=0.9979 (last merge round=31)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.470074261814243, 'psi': 0.13577478824115594}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.4043621731684155, 'psi': 0.13582554517133957}
[S15] START round=36 head_norm_before_train=1.662586 cos_to_last_merge=0.9930 (last merge round=30)
[S15] round=36 local utility u=0.038673 metrics={'f1_val': 0.6176081002319632, 'auprc': 0.6176081002319632, 'loss_val': 0.6044257630880508, 'psi': 0.6176081002319632}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.671042125028436, 'psi': 0.6164158146233559}
[S16] START round=36 head_norm_before_train=1.901583 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.0688622754491018, 'auprc': 0.0688622754491018, 'loss_val': 4.974052681396407, 'psi': 0.0688622754491018}-{'f1_val': 0.12994980479643056, 'auprc': 0.12994980479643056, 'loss_val': 3.9222125314174923, 'psi': 0.12994980479643056}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.388556 cos_to_last_merge=1.0000 (last merge round=35)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.26474963626555065, 'auprc': 0.26474963626555065, 'loss_val': 1.023934656406428, 'psi': 0.26474963626555065}-{'f1_val': 0.2638231331067875, 'auprc': 0.2638231331067875, 'loss_val': 0.9983162619387164, 'psi': 0.2638231331067875}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:61017
[S13] sending update (kind=head size=1807 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1807) from S13
[S17] cosine check vs S13: cos=0.9960
[S2] START round=37 head_norm_before_train=1.848010 (no previous merge yet)
[S2] round=37 local utility u=0.988835 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9222546038520685, 'psi': 0.3674775928297055}-{'f1_val': 0.21186885737864805, 'auprc': 0.21186885737864805, 'loss_val': 3.4994452853799314, 'psi': 0.21186885737864805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=37 head_norm_before_train=2.083103 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.209445471339485, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.1893773092325253, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.976709 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2565390380795922, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2243346358354381, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=2.169557 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.314479981792415, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2683989087903806, 'psi': 0.3335071121394324}
[S6] START round=37 head_norm_before_train=1.508538 cos_to_last_merge=0.9117 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.912
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 6.0370703982587255, 'psi': 0.018441678192715538}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 5.9169349038425665, 'psi': 0.01954921803127875}
[S7] START round=37 head_norm_before_train=1.806458 (no previous merge yet)
[S7] round=37 local utility u=0.035987 metrics={'f1_val': 0.2488778054862843, 'auprc': 0.2488778054862843, 'loss_val': 0.6248234946475594, 'psi': 0.2488778054862843}-{'f1_val': 0.24868979286249066, 'auprc': 0.24868979286249066, 'loss_val': 0.6951060860524648, 'psi': 0.24868979286249066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=37 head_norm_before_train=1.730994 cos_to_last_merge=0.9759 (last merge round=24)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1684791728281863, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1271638110624878, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=1.741503 cos_to_last_merge=0.9820 (last merge round=31)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2879394271526925, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.213901191289117, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.149782 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.2064638563367948, 'auprc': 0.2064638563367948, 'loss_val': 1.5492198626691935, 'psi': 0.2064638563367948}-{'f1_val': 0.20753968253968255, 'auprc': 0.20753968253968255, 'loss_val': 1.516750515034329, 'psi': 0.20753968253968255}
[S11] START round=37 head_norm_before_train=1.939457 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.270035280231189, 'psi': 0.3320133550741517}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.2699299532608794, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.386882 cos_to_last_merge=0.9965 (last merge round=30)
[S13] round=37 local utility u=0.018472 metrics={'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.2593081610285047, 'psi': 0.9991573068393276}-{'f1_val': 0.9977520212852571, 'auprc': 0.9977520212852571, 'loss_val': 0.28360429388960623, 'psi': 0.9977520212852571}
[S14] START round=37 head_norm_before_train=1.786121 cos_to_last_merge=0.9973 (last merge round=31)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.5430944237645505, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.470074261814243, 'psi': 0.13577478824115594}
[S15] START round=37 head_norm_before_train=1.682145 cos_to_last_merge=0.9915 (last merge round=30)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6359201204974712, 'psi': 0.6163342951580373}-{'f1_val': 0.6176081002319632, 'auprc': 0.6176081002319632, 'loss_val': 0.6044257630880508, 'psi': 0.6176081002319632}
[S16] START round=37 head_norm_before_train=1.908941 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.028259130898427087, 'auprc': 0.028259130898427087, 'loss_val': 5.445295371586424, 'psi': 0.028259130898427087}-{'f1_val': 0.0688622754491018, 'auprc': 0.0688622754491018, 'loss_val': 4.974052681396407, 'psi': 0.0688622754491018}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.410580 cos_to_last_merge=0.9999 (last merge round=35)
[S17] round=37 local utility u=0.193488 metrics={'f1_val': 0.32069056703562393, 'auprc': 0.32069056703562393, 'loss_val': 1.1404260494074439, 'psi': 0.32069056703562393}-{'f1_val': 0.26474963626555065, 'auprc': 0.26474963626555065, 'loss_val': 1.023934656406428, 'psi': 0.26474963626555065}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61013
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.999)
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] cosine check vs S17: cos=0.9945
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.3207 head_norm=1.428711
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.134940e-02
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.3207 head_norm=1.406143 delta_norm=0.071349
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.9992 head_norm=1.398089
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.585517e-02
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.9992 head_norm=1.411446 delta_norm=0.075855
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.854497 (no previous merge yet)
[S2] round=38 local utility u=0.001031 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.920192734657917, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.9222546038520685, 'psi': 0.3674775928297055}
[S2] not sending this round → trigger blocked (psi=0.367)
[S3] START round=38 head_norm_before_train=2.090801 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.2283462611567093, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.209445471339485, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.986215 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2627287456794263, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2565390380795922, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=2.185444 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.370634953901429, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.314479981792415, 'psi': 0.3335071121394324}
[S6] START round=38 head_norm_before_train=1.527179 cos_to_last_merge=0.9084 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.908
[S6] round=38 local utility u=0.039037 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.98876388908208, 'psi': 0.021749084249084248}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 6.0370703982587255, 'psi': 0.018441678192715538}
[S7] START round=38 head_norm_before_train=1.822694 (no previous merge yet)
[S7] round=38 local utility u=0.003942 metrics={'f1_val': 0.24894041386187982, 'auprc': 0.24894041386187982, 'loss_val': 0.6175020505843873, 'psi': 0.24894041386187982}-{'f1_val': 0.2488778054862843, 'auprc': 0.2488778054862843, 'loss_val': 0.6248234946475594, 'psi': 0.2488778054862843}
[S7] not sending this round → trigger blocked (psi=0.249)
[S8] START round=38 head_norm_before_train=1.746305 cos_to_last_merge=0.9741 (last merge round=24)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2111196541766889, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1684791728281863, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.762795 cos_to_last_merge=0.9796 (last merge round=31)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3556236204253276, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2879394271526925, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.163756 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.20302803975553083, 'auprc': 0.20302803975553083, 'loss_val': 1.6135782885414092, 'psi': 0.20302803975553083}-{'f1_val': 0.2064638563367948, 'auprc': 0.2064638563367948, 'loss_val': 1.5492198626691935, 'psi': 0.2064638563367948}
[S11] START round=38 head_norm_before_train=1.951082 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.294256639983872, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.270035280231189, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.411446 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6658937674686215, 'auprc': 0.6658937674686215, 'loss_val': 0.26738352597185494, 'psi': 0.6658937674686215}-{'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.2593081610285047, 'psi': 0.9991573068393276}
[S14] START round=38 head_norm_before_train=1.797380 cos_to_last_merge=0.9967 (last merge round=31)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.645556003122896, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.5430944237645505, 'psi': 0.13577478824115594}
[S15] START round=38 head_norm_before_train=1.700976 cos_to_last_merge=0.9900 (last merge round=30)
[S15] round=38 local utility u=0.037719 metrics={'f1_val': 0.6175265408452612, 'auprc': 0.6175265408452612, 'loss_val': 0.5712114404318593, 'psi': 0.6175265408452612}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6359201204974712, 'psi': 0.6163342951580373}
[S16] START round=38 head_norm_before_train=1.916257 (no previous merge yet)
[S16] round=38 local utility u=0.969386 metrics={'f1_val': 0.10199556541019955, 'auprc': 0.10199556541019955, 'loss_val': 4.170152227178743, 'psi': 0.10199556541019955}-{'f1_val': 0.028259130898427087, 'auprc': 0.028259130898427087, 'loss_val': 5.445295371586424, 'psi': 0.028259130898427087}
[S16] not sending this round → trigger blocked (psi=0.102)
[S17] START round=38 head_norm_before_train=1.406143 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 1.1736989673803377, 'psi': 0.30875549754205167}-{'f1_val': 0.32069056703562393, 'auprc': 0.32069056703562393, 'loss_val': 1.1404260494074439, 'psi': 0.32069056703562393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.860794 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.934485432274941, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.920192734657917, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.367 u=0.0000 p_local=0.1841 f1=0.367 auprc=0.367 bytes=21628
[S3] START round=39 head_norm_before_train=2.098136 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.245477642882477, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.2283462611567093, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.364 u=0.0000 p_local=0.0005 f1=0.364 auprc=0.364 bytes=1792
[S4] START round=39 head_norm_before_train=1.995257 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2807599020593514, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2627287456794263, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0040 f1=0.357 auprc=0.357 bytes=23381
[S5] START round=39 head_norm_before_train=2.202237 (no previous merge yet)
[S5] round=39 local utility u=0.017925 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.3347840464308267, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.370634953901429, 'psi': 0.3335071121394324}
[S6] START round=39 head_norm_before_train=1.544028 cos_to_last_merge=0.9056 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.906
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.070549840028834, 'psi': 0.021749084249084248}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.98876388908208, 'psi': 0.021749084249084248}
[S7] START round=39 head_norm_before_train=1.830526 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.24919053549190537, 'auprc': 0.24919053549190537, 'loss_val': 0.6554382768080854, 'psi': 0.24919053549190537}-{'f1_val': 0.24894041386187982, 'auprc': 0.24894041386187982, 'loss_val': 0.6175020505843873, 'psi': 0.24894041386187982}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.249 u=0.0000 p_local=0.0332 f1=0.249 auprc=0.249 bytes=32410
[S8] START round=39 head_norm_before_train=1.761606 cos_to_last_merge=0.9725 (last merge round=24)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2511495052553585, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2111196541766889, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=1.781310 cos_to_last_merge=0.9774 (last merge round=31)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.405594247129405, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3556236204253276, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0105 f1=0.369 auprc=0.369 bytes=12617
[S10] START round=39 head_norm_before_train=2.177172 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.20409432766006103, 'auprc': 0.20409432766006103, 'loss_val': 1.6283723800993302, 'psi': 0.20409432766006103}-{'f1_val': 0.20302803975553083, 'auprc': 0.20302803975553083, 'loss_val': 1.6135782885414092, 'psi': 0.20302803975553083}
[S11] START round=39 head_norm_before_train=1.961912 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.3300151327867367, 'psi': 0.33201273984308244}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.294256639983872, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0039 f1=0.332 auprc=0.332 bytes=14406
[S13] START round=39 head_norm_before_train=1.422268 cos_to_last_merge=0.9999 (last merge round=37)
[S13] round=39 local utility u=1.000000 metrics={'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.26255888391095566, 'psi': 0.9991573068393276}-{'f1_val': 0.6658937674686215, 'auprc': 0.6658937674686215, 'loss_val': 0.26738352597185494, 'psi': 0.6658937674686215}
[S14] START round=39 head_norm_before_train=1.807403 cos_to_last_merge=0.9962 (last merge round=31)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.7184396395818125, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.645556003122896, 'psi': 0.13577478824115594}
[S15] START round=39 head_norm_before_train=1.719367 cos_to_last_merge=0.9884 (last merge round=30)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6128743179208713, 'psi': 0.6164734888353558}-{'f1_val': 0.6175265408452612, 'auprc': 0.6175265408452612, 'loss_val': 0.5712114404318593, 'psi': 0.6175265408452612}
[S16] START round=39 head_norm_before_train=1.923057 (no previous merge yet)
[S16] round=39 local utility u=0.100395 metrics={'f1_val': 0.13359934973767826, 'auprc': 0.13359934973767826, 'loss_val': 4.253795945669115, 'psi': 0.13359934973767826}-{'f1_val': 0.10199556541019955, 'auprc': 0.10199556541019955, 'loss_val': 4.170152227178743, 'psi': 0.10199556541019955}
[S16] not sending this round → trigger blocked (psi=0.134)
[S16] r=40 psi=0.134 u=0.1004 p_local=0.3049 f1=0.134 auprc=0.134 bytes=0
[S17] START round=39 head_norm_before_train=1.421582 cos_to_last_merge=0.9999 (last merge round=37)
[S17] round=39 local utility u=0.051651 metrics={'f1_val': 0.29604882358916934, 'auprc': 0.29604882358916934, 'loss_val': 0.9560377351319828, 'psi': 0.29604882358916934}-{'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 1.1736989673803377, 'psi': 0.30875549754205167}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61013
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0139 f1=0.136 auprc=0.136 bytes=0
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] r=40 psi=0.334 u=0.0179 p_local=0.0107 f1=0.334 auprc=0.334 bytes=27025
[S6] r=40 psi=0.022 u=0.0000 p_local=0.0258 f1=0.022 auprc=0.022 bytes=0
[S10] r=40 psi=0.204 u=0.0000 p_local=0.0053 f1=0.204 auprc=0.204 bytes=16206
[S15] r=40 psi=0.616 u=0.0000 p_local=0.0703 f1=0.616 auprc=0.616 bytes=27032
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0085 f1=0.359 auprc=0.359 bytes=28800
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=0.9993
[S17] r=40 psi=0.296 u=0.0517 p_local=0.0831 f1=0.296 auprc=0.296 bytes=30602
[S13] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S13
[S17] cosine check vs S13: cos=0.9993
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=39 metric=0.9992 head_norm=1.432384
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.723087e-02
[S13] stored merged vector for next round verification (round=39)
[S13] DEBUG after merge:  round=39 metric=0.9992 head_norm=1.433939 delta_norm=0.027231
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] r=40 psi=0.999 u=1.0000 p_local=0.3164 f1=0.999 auprc=0.999 bytes=32433
[S2] START round=40 head_norm_before_train=1.866967 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.258159856078129, 'auprc': 0.258159856078129, 'loss_val': 2.938427032722628, 'psi': 0.258159856078129}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.934485432274941, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.105234 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.265329492910012, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.245477642882477, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.002537 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.305685015459238, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2807599020593514, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=2.210921 (no previous merge yet)
[S5] round=40 local utility u=0.014027 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.3067296244740936, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.3347840464308267, 'psi': 0.3335071121394324}
[S6] START round=40 head_norm_before_train=1.558873 cos_to_last_merge=0.9031 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.903
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.245087085718678, 'psi': 0.017774699907663897}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.070549840028834, 'psi': 0.021749084249084248}
[S7] START round=40 head_norm_before_train=1.838311 (no previous merge yet)
[S7] round=40 local utility u=0.058609 metrics={'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.5370958590514344, 'psi': 0.2490655370047346}-{'f1_val': 0.24919053549190537, 'auprc': 0.24919053549190537, 'loss_val': 0.6554382768080854, 'psi': 0.24919053549190537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=40 head_norm_before_train=1.774418 cos_to_last_merge=0.9710 (last merge round=24)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2831049394042728, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2511495052553585, 'psi': 0.35939447907390915}
[S9] START round=40 head_norm_before_train=1.797131 cos_to_last_merge=0.9756 (last merge round=31)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4465037389553674, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.405594247129405, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.189967 (no previous merge yet)
[S10] round=40 local utility u=0.002418 metrics={'f1_val': 0.20553361759201466, 'auprc': 0.20553361759201466, 'loss_val': 1.6364909824005034, 'psi': 0.20553361759201466}-{'f1_val': 0.20409432766006103, 'auprc': 0.20409432766006103, 'loss_val': 1.6283723800993302, 'psi': 0.20409432766006103}
[S11] START round=40 head_norm_before_train=1.972277 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.3542948217382595, 'psi': 0.3320901320901321}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.3300151327867367, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.433939 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=40 local utility u=0.004031 metrics={'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.2544971470349144, 'psi': 0.9991573068393276}-{'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.26255888391095566, 'psi': 0.9991573068393276}
[S14] START round=40 head_norm_before_train=1.816740 cos_to_last_merge=0.9956 (last merge round=31)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.770130966064553, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.7184396395818125, 'psi': 0.13577478824115594}
[S15] START round=40 head_norm_before_train=1.735602 cos_to_last_merge=0.9870 (last merge round=30)
[S15] round=40 local utility u=0.018263 metrics={'f1_val': 0.6168330926211807, 'auprc': 0.6168330926211807, 'loss_val': 0.5795857065068561, 'psi': 0.6168330926211807}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6128743179208713, 'psi': 0.6164734888353558}
[S16] START round=40 head_norm_before_train=1.927651 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.13442526191530177, 'auprc': 0.13442526191530177, 'loss_val': 4.355738110284782, 'psi': 0.13442526191530177}-{'f1_val': 0.13359934973767826, 'auprc': 0.13359934973767826, 'loss_val': 4.253795945669115, 'psi': 0.13359934973767826}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.436008 cos_to_last_merge=0.9997 (last merge round=37)
[S17] round=40 local utility u=0.055073 metrics={'f1_val': 0.33188386464612196, 'auprc': 0.33188386464612196, 'loss_val': 1.1684074524082106, 'psi': 0.33188386464612196}-{'f1_val': 0.29604882358916934, 'auprc': 0.29604882358916934, 'loss_val': 0.9560377351319828, 'psi': 0.29604882358916934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.332)
[S5] not sending this round → trigger blocked (psi=0.334)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.999)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.3319 head_norm=1.450150
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.379702e-02
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.3319 head_norm=1.440898 delta_norm=0.033797
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.077 → S13@127.0.0.1:61013
[S13] ⇄ pheromone p=0.254 → S17@127.0.0.1:61017
[S2] START round=41 head_norm_before_train=1.872513 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.2230515916575192, 'auprc': 0.2230515916575192, 'loss_val': 3.505410757843309, 'psi': 0.2230515916575192}-{'f1_val': 0.258159856078129, 'auprc': 0.258159856078129, 'loss_val': 2.938427032722628, 'psi': 0.258159856078129}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.112208 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.2809630391398055, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.265329492910012, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=2.014518 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3231482574172124, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.305685015459238, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=2.221488 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.3274473157132296, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.3067296244740936, 'psi': 0.3335071121394324}
[S6] START round=41 head_norm_before_train=1.572278 cos_to_last_merge=0.9009 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.901
[S6] round=41 local utility u=0.011830 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.2552254917175985, 'psi': 0.02153000458085204}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.245087085718678, 'psi': 0.017774699907663897}
[S7] START round=41 head_norm_before_train=1.849367 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.248375812093953, 'auprc': 0.248375812093953, 'loss_val': 0.5400174258981756, 'psi': 0.248375812093953}-{'f1_val': 0.2490655370047346, 'auprc': 0.2490655370047346, 'loss_val': 0.5370958590514344, 'psi': 0.2490655370047346}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.785436 cos_to_last_merge=0.9698 (last merge round=24)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3151683864589647, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2831049394042728, 'psi': 0.35939447907390915}
[S9] START round=41 head_norm_before_train=1.811246 cos_to_last_merge=0.9738 (last merge round=31)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4830013970691587, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4465037389553674, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.201384 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.20485142774957665, 'auprc': 0.20485142774957665, 'loss_val': 1.6661336066614303, 'psi': 0.20485142774957665}-{'f1_val': 0.20553361759201466, 'auprc': 0.20553361759201466, 'loss_val': 1.6364909824005034, 'psi': 0.20553361759201466}
[S11] START round=41 head_norm_before_train=1.982033 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.376271509953875, 'psi': 0.3320901320901321}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.3542948217382595, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.442939 cos_to_last_merge=0.9999 (last merge round=39)
[S13] round=41 local utility u=0.006627 metrics={'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.24124246133280056, 'psi': 0.9991573068393276}-{'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.2544971470349144, 'psi': 0.9991573068393276}
[S14] START round=41 head_norm_before_train=1.825465 cos_to_last_merge=0.9951 (last merge round=31)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.838954822503521, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.770130966064553, 'psi': 0.13577478824115594}
[S15] START round=41 head_norm_before_train=1.754406 cos_to_last_merge=0.9854 (last merge round=30)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5925705928548806, 'psi': 0.6164734888353558}-{'f1_val': 0.6168330926211807, 'auprc': 0.6168330926211807, 'loss_val': 0.5795857065068561, 'psi': 0.6168330926211807}
[S16] START round=41 head_norm_before_train=1.933421 (no previous merge yet)
[S16] round=41 local utility u=0.007097 metrics={'f1_val': 0.13513115237253168, 'auprc': 0.13513115237253168, 'loss_val': 4.34789757320457, 'psi': 0.13513115237253168}-{'f1_val': 0.13442526191530177, 'auprc': 0.13442526191530177, 'loss_val': 4.355738110284782, 'psi': 0.13442526191530177}
[S16] not sending this round → trigger blocked (psi=0.135)
[S17] START round=41 head_norm_before_train=1.440898 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.346976 metrics={'f1_val': 0.40054710935924787, 'auprc': 0.40054710935924787, 'loss_val': 1.0924245679724087, 'psi': 0.40054710935924787}-{'f1_val': 0.33188386464612196, 'auprc': 0.33188386464612196, 'loss_val': 1.1684074524082106, 'psi': 0.33188386464612196}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61013
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=0.9996
[S13] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S13
[S17] cosine check vs S13: cos=0.9996
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=41 metric=0.9992 head_norm=1.452509
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.080102e-02
[S13] stored merged vector for next round verification (round=41)
[S13] DEBUG after merge:  round=41 metric=0.9992 head_norm=1.454326 delta_norm=0.020801
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.877750 (no previous merge yet)
[S2] round=42 local utility u=0.895877 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.013491427758963, 'psi': 0.3674775928297055}-{'f1_val': 0.2230515916575192, 'auprc': 0.2230515916575192, 'loss_val': 3.505410757843309, 'psi': 0.2230515916575192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=42 head_norm_before_train=2.118838 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.2964112400909467, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.2809630391398055, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=2.025364 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3382256521356122, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3231482574172124, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=2.235784 (no previous merge yet)
[S5] round=42 local utility u=0.031129 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2651890937607786, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.3274473157132296, 'psi': 0.3335071121394324}
[S6] START round=42 head_norm_before_train=1.584512 cos_to_last_merge=0.8990 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.298492370391106, 'psi': 0.021749084249084248}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.2552254917175985, 'psi': 0.02153000458085204}
[S7] START round=42 head_norm_before_train=1.859449 (no previous merge yet)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.24856429463171037, 'auprc': 0.24856429463171037, 'loss_val': 0.5570318858428802, 'psi': 0.24856429463171037}-{'f1_val': 0.248375812093953, 'auprc': 0.248375812093953, 'loss_val': 0.5400174258981756, 'psi': 0.248375812093953}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.798191 cos_to_last_merge=0.9688 (last merge round=24)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3554420938088076, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3151683864589647, 'psi': 0.35939447907390915}
[S9] START round=42 head_norm_before_train=1.824094 cos_to_last_merge=0.9723 (last merge round=31)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.520269880374423, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4830013970691587, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.211900 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.20493144988036252, 'auprc': 0.20493144988036252, 'loss_val': 1.6867601675446908, 'psi': 0.20493144988036252}-{'f1_val': 0.20485142774957665, 'auprc': 0.20485142774957665, 'loss_val': 1.6661336066614303, 'psi': 0.20485142774957665}
[S11] START round=42 head_norm_before_train=1.991219 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.3964043246630404, 'psi': 0.3320901320901321}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.376271509953875, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.454326 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=42 local utility u=0.002526 metrics={'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.23618983542449434, 'psi': 0.9991573068393276}-{'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.24124246133280056, 'psi': 0.9991573068393276}
[S14] START round=42 head_norm_before_train=1.833506 cos_to_last_merge=0.9946 (last merge round=31)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.907914799038177, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.838954822503521, 'psi': 0.13577478824115594}
[S15] START round=42 head_norm_before_train=1.774977 cos_to_last_merge=0.9835 (last merge round=30)
[S15] round=42 local utility u=0.001804 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.5896969555181206, 'psi': 0.6165550083006743}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5925705928548806, 'psi': 0.6164734888353558}
[S16] START round=42 head_norm_before_train=1.939994 (no previous merge yet)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.12607750543437524, 'auprc': 0.12607750543437524, 'loss_val': 4.456754473882983, 'psi': 0.12607750543437524}-{'f1_val': 0.13513115237253168, 'auprc': 0.13513115237253168, 'loss_val': 4.34789757320457, 'psi': 0.13513115237253168}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.456438 cos_to_last_merge=0.9999 (last merge round=40)
[S17] round=42 local utility u=0.177173 metrics={'f1_val': 0.43509913132363587, 'auprc': 0.43509913132363587, 'loss_val': 1.0490460070629495, 'psi': 0.43509913132363587}-{'f1_val': 0.40054710935924787, 'auprc': 0.40054710935924787, 'loss_val': 1.0924245679724087, 'psi': 0.40054710935924787}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S15] sending update (kind=head size=1809 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.435)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=42 metric=0.4351 head_norm=1.476169
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.926440e-02
[S17] stored merged vector for next round verification (round=42)
[S17] DEBUG after merge:  round=42 metric=0.4365 head_norm=1.464094 delta_norm=0.029264
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] not sending this round → trigger blocked (psi=0.999)
[S2] START round=43 head_norm_before_train=1.882913 (no previous merge yet)
[S2] round=43 local utility u=0.008082 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.997326967057675, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.013491427758963, 'psi': 0.3674775928297055}
[S2] not sending this round → trigger blocked (psi=0.367)
[S3] START round=43 head_norm_before_train=2.125192 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.312943911930305, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.2964112400909467, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.039181 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3726053132238965, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3382256521356122, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=2.243397 (no previous merge yet)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2889280177141056, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2651890937607786, 'psi': 0.3335071121394324}
[S6] START round=43 head_norm_before_train=1.595817 cos_to_last_merge=0.8971 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.897
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 6.391651518266355, 'psi': 0.021310724106324473}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.298492370391106, 'psi': 0.021749084249084248}
[S7] START round=43 head_norm_before_train=1.868004 (no previous merge yet)
[S7] round=43 local utility u=0.002101 metrics={'f1_val': 0.24868979286249066, 'auprc': 0.24868979286249066, 'loss_val': 0.5539603205865459, 'psi': 0.24868979286249066}-{'f1_val': 0.24856429463171037, 'auprc': 0.24856429463171037, 'loss_val': 0.5570318858428802, 'psi': 0.24856429463171037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=43 head_norm_before_train=1.808250 cos_to_last_merge=0.9675 (last merge round=24)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3939636725812308, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3554420938088076, 'psi': 0.35939447907390915}
[S9] START round=43 head_norm_before_train=1.836305 cos_to_last_merge=0.9708 (last merge round=31)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.548903710082573, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.520269880374423, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.222348 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.20493144988036252, 'auprc': 0.20493144988036252, 'loss_val': 1.7039972754616723, 'psi': 0.20493144988036252}-{'f1_val': 0.20493144988036252, 'auprc': 0.20493144988036252, 'loss_val': 1.6867601675446908, 'psi': 0.20493144988036252}
[S11] START round=43 head_norm_before_train=1.999801 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.4153937390840765, 'psi': 0.3320901320901321}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.3964043246630404, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.462407 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.9988763297954963, 'auprc': 0.9988763297954963, 'loss_val': 0.23683401419768868, 'psi': 0.9988763297954963}-{'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.23618983542449434, 'psi': 0.9991573068393276}
[S14] START round=43 head_norm_before_train=1.841182 cos_to_last_merge=0.9941 (last merge round=31)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.962109267628709, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.907914799038177, 'psi': 0.13577478824115594}
[S15] START round=43 head_norm_before_train=1.794876 cos_to_last_merge=0.9817 (last merge round=30)
[S15] round=43 local utility u=0.011559 metrics={'f1_val': 0.6168330926211807, 'auprc': 0.6168330926211807, 'loss_val': 0.5690809154438335, 'psi': 0.6168330926211807}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.5896969555181206, 'psi': 0.6165550083006743}
[S16] START round=43 head_norm_before_train=1.946700 (no previous merge yet)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 4.935269952318257, 'psi': 0.09046591544793414}-{'f1_val': 0.12607750543437524, 'auprc': 0.12607750543437524, 'loss_val': 4.456754473882983, 'psi': 0.12607750543437524}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.464094 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.4067025508849623, 'auprc': 0.4067025508849623, 'loss_val': 1.164813898571415, 'psi': 0.4067025508849623}-{'f1_val': 0.43509913132363587, 'auprc': 0.43509913132363587, 'loss_val': 1.0490460070629495, 'psi': 0.43509913132363587}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.617)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.888177 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.011217132505692, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.997326967057675, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.131603 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.3299634894868917, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.312943911930305, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=2.049183 (no previous merge yet)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.41285083504649, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3726053132238965, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=2.249472 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.353565947549215, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2889280177141056, 'psi': 0.3335071121394324}
[S6] START round=44 head_norm_before_train=1.606374 cos_to_last_merge=0.8955 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.895
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 6.448184844362764, 'psi': 0.021310724106324473}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 6.391651518266355, 'psi': 0.021310724106324473}
[S7] START round=44 head_norm_before_train=1.882372 (no previous merge yet)
[S7] round=44 local utility u=0.010112 metrics={'f1_val': 0.24875249500998003, 'auprc': 0.24875249500998003, 'loss_val': 0.5343004336256637, 'psi': 0.24875249500998003}-{'f1_val': 0.24868979286249066, 'auprc': 0.24868979286249066, 'loss_val': 0.5539603205865459, 'psi': 0.24868979286249066}
[S7] not sending this round → trigger blocked (psi=0.249)
[S8] START round=44 head_norm_before_train=1.816844 cos_to_last_merge=0.9662 (last merge round=24)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4224883375255455, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3939636725812308, 'psi': 0.35939447907390915}
[S9] START round=44 head_norm_before_train=1.847203 cos_to_last_merge=0.9694 (last merge round=31)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.577126742772559, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.548903710082573, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.232646 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.2052923256976807, 'auprc': 0.2052923256976807, 'loss_val': 1.7184989653787628, 'psi': 0.2052923256976807}-{'f1_val': 0.20493144988036252, 'auprc': 0.20493144988036252, 'loss_val': 1.7039972754616723, 'psi': 0.20493144988036252}
[S11] START round=44 head_norm_before_train=2.008035 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.4333381082891568, 'psi': 0.3320901320901321}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.4153937390840765, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.467945 cos_to_last_merge=0.9998 (last merge round=41)
[S13] round=44 local utility u=0.003899 metrics={'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.23156469462349655, 'psi': 0.9991573068393276}-{'f1_val': 0.9988763297954963, 'auprc': 0.9988763297954963, 'loss_val': 0.23683401419768868, 'psi': 0.9988763297954963}
[S14] START round=44 head_norm_before_train=1.848333 cos_to_last_merge=0.9937 (last merge round=31)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.000359333451725, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 4.962109267628709, 'psi': 0.13577478824115594}
[S15] START round=44 head_norm_before_train=1.813168 cos_to_last_merge=0.9800 (last merge round=30)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6154970049053944, 'auprc': 0.6154970049053944, 'loss_val': 0.5749502681560029, 'psi': 0.6154970049053944}-{'f1_val': 0.6168330926211807, 'auprc': 0.6168330926211807, 'loss_val': 0.5690809154438335, 'psi': 0.6168330926211807}
[S16] START round=44 head_norm_before_train=1.952534 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.00037140204271123495, 'auprc': 0.00037140204271123495, 'loss_val': 6.566980497906723, 'psi': 0.00037140204271123495}-{'f1_val': 0.09046591544793414, 'auprc': 0.09046591544793414, 'loss_val': 4.935269952318257, 'psi': 0.09046591544793414}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.481909 cos_to_last_merge=0.9999 (last merge round=42)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.3065619657460797, 'auprc': 0.3065619657460797, 'loss_val': 1.3758655794205181, 'psi': 0.3065619657460797}-{'f1_val': 0.4067025508849623, 'auprc': 0.4067025508849623, 'loss_val': 1.164813898571415, 'psi': 0.4067025508849623}
[S10]  timeout peer S14
[S13]  timeout peer S7
[S5]  timeout peer S11
[S6]  timeout peer S17
[S14]  timeout peer S8
[S15]  timeout peer S9
[S8]  timeout peer S15
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[S13] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S13
[S17] cosine check vs S13: cos=0.9992
[S2] START round=45 head_norm_before_train=1.893603 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.042631984664978, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.011217132505692, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.137855 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.3467807230012023, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.3299634894868917, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.054330 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4602566906059267, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.41285083504649, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=2.256880 (no previous merge yet)
[S5] round=45 local utility u=0.037603 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.278359798593754, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.353565947549215, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=45 head_norm_before_train=1.616478 cos_to_last_merge=0.8939 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.894
[S6] round=45 local utility u=0.015243 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.421644044544352, 'psi': 0.021749084249084248}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 6.448184844362764, 'psi': 0.021310724106324473}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=45 head_norm_before_train=1.891909 (no previous merge yet)
[S7] round=45 local utility u=0.002001 metrics={'f1_val': 0.2488778054862843, 'auprc': 0.2488778054862843, 'loss_val': 0.5314255832112396, 'psi': 0.2488778054862843}-{'f1_val': 0.24875249500998003, 'auprc': 0.24875249500998003, 'loss_val': 0.5343004336256637, 'psi': 0.24875249500998003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=45 head_norm_before_train=1.826626 cos_to_last_merge=0.9652 (last merge round=24)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.447904369754018, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4224883375255455, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.857579 cos_to_last_merge=0.9681 (last merge round=31)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6032739820556037, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.577126742772559, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.242220 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.20465164598918537, 'auprc': 0.20465164598918537, 'loss_val': 1.744038578788315, 'psi': 0.20465164598918537}-{'f1_val': 0.2052923256976807, 'auprc': 0.2052923256976807, 'loss_val': 1.7184989653787628, 'psi': 0.2052923256976807}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.015656 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.4493130210121037, 'psi': 0.3320901320901321}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.4333381082891568, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.474008 cos_to_last_merge=0.9997 (last merge round=41)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.9988763297954963, 'auprc': 0.9988763297954963, 'loss_val': 0.23858464440459912, 'psi': 0.9988763297954963}-{'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.23156469462349655, 'psi': 0.9991573068393276}
[S14] START round=45 head_norm_before_train=1.855276 cos_to_last_merge=0.9932 (last merge round=31)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.046207589498267, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.000359333451725, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.828698 cos_to_last_merge=0.9785 (last merge round=30)
[S15] round=45 local utility u=0.012640 metrics={'f1_val': 0.6172494631641352, 'auprc': 0.6172494631641352, 'loss_val': 0.5654426769644384, 'psi': 0.6172494631641352}-{'f1_val': 0.6154970049053944, 'auprc': 0.6154970049053944, 'loss_val': 0.5749502681560029, 'psi': 0.6154970049053944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S15] sending update (kind=head size=1809 to 1 peers)
[S16] START round=45 head_norm_before_train=1.957499 (no previous merge yet)
[S16] round=45 local utility u=1.000000 metrics={'f1_val': 0.11607483772432226, 'auprc': 0.11607483772432226, 'loss_val': 4.676722300710489, 'psi': 0.11607483772432226}-{'f1_val': 0.00037140204271123495, 'auprc': 0.00037140204271123495, 'loss_val': 6.566980497906723, 'psi': 0.00037140204271123495}
[S16] not sending this round → trigger blocked (psi=0.116)
[S17] START round=45 head_norm_before_train=1.500068 cos_to_last_merge=0.9997 (last merge round=42)
[S17] round=45 local utility u=0.716494 metrics={'f1_val': 0.43798919342432097, 'auprc': 0.43798919342432097, 'loss_val': 1.1257234376539402, 'psi': 0.43798919342432097}-{'f1_val': 0.3065619657460797, 'auprc': 0.3065619657460797, 'loss_val': 1.3758655794205181, 'psi': 0.3065619657460797}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] ⇄ pheromone p=0.085 → S17@127.0.0.1:61017
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.9987
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=45 metric=0.4380 head_norm=1.512857
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.901713e-02
[S17] stored merged vector for next round verification (round=45)
[S17] DEBUG after merge:  round=45 metric=0.4393 head_norm=1.493049 delta_norm=0.039017
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.215 → S13@127.0.0.1:61013
[S2] START round=46 head_norm_before_train=1.898907 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0715652302844334, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.042631984664978, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.143968 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.3619478396601408, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.3467807230012023, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.061361 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.465877231618771, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4602566906059267, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=2.263348 (no previous merge yet)
[S5] round=46 local utility u=0.014713 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2489341023156006, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.278359798593754, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=46 head_norm_before_train=1.625908 cos_to_last_merge=0.8924 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.892
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.489221159633385, 'psi': 0.021749084249084248}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.421644044544352, 'psi': 0.021749084249084248}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.900464 (no previous merge yet)
[S7] round=46 local utility u=0.715692 metrics={'f1_val': 0.39395371422032066, 'auprc': 0.39395371422032066, 'loss_val': 0.40572509459536216, 'psi': 0.39395371422032066}-{'f1_val': 0.2488778054862843, 'auprc': 0.2488778054862843, 'loss_val': 0.5314255832112396, 'psi': 0.2488778054862843}
[S7] not sending this round → trigger blocked (psi=0.394)
[S8] START round=46 head_norm_before_train=1.836022 cos_to_last_merge=0.9645 (last merge round=24)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4705035646006697, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.447904369754018, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.867417 cos_to_last_merge=0.9669 (last merge round=31)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6288867827974642, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6032739820556037, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.251508 (no previous merge yet)
[S10] round=46 local utility u=0.018565 metrics={'f1_val': 0.2075256380061236, 'auprc': 0.2075256380061236, 'loss_val': 1.732775144711966, 'psi': 0.2075256380061236}-{'f1_val': 0.20465164598918537, 'auprc': 0.20465164598918537, 'loss_val': 1.744038578788315, 'psi': 0.20465164598918537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=46 head_norm_before_train=2.022782 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.460957475136186, 'psi': 0.3320901320901321}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.4493130210121037, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.479763 cos_to_last_merge=0.9994 (last merge round=41)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.9988763297954963, 'auprc': 0.9988763297954963, 'loss_val': 0.23911555348472352, 'psi': 0.9988763297954963}-{'f1_val': 0.9988763297954963, 'auprc': 0.9988763297954963, 'loss_val': 0.23858464440459912, 'psi': 0.9988763297954963}
[S14] START round=46 head_norm_before_train=1.861845 cos_to_last_merge=0.9928 (last merge round=31)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.10167075917191, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.046207589498267, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.842444 cos_to_last_merge=0.9772 (last merge round=30)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5819694063783979, 'psi': 0.6164734888353558}-{'f1_val': 0.6172494631641352, 'auprc': 0.6172494631641352, 'loss_val': 0.5654426769644384, 'psi': 0.6172494631641352}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.963140 (no previous merge yet)
[S16] round=46 local utility u=0.385728 metrics={'f1_val': 0.14516012434034556, 'auprc': 0.14516012434034556, 'loss_val': 4.167034608257954, 'psi': 0.14516012434034556}-{'f1_val': 0.11607483772432226, 'auprc': 0.11607483772432226, 'loss_val': 4.676722300710489, 'psi': 0.11607483772432226}
[S16] not sending this round → trigger blocked (psi=0.145)
[S17] START round=46 head_norm_before_train=1.493049 cos_to_last_merge=1.0000 (last merge round=45)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.4155959595959596, 'auprc': 0.4155959595959596, 'loss_val': 1.1498580786003685, 'psi': 0.4155959595959596}-{'f1_val': 0.43798919342432097, 'auprc': 0.43798919342432097, 'loss_val': 1.1257234376539402, 'psi': 0.43798919342432097}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=46 metric=0.9989 head_norm=1.486009
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.507023e-02
[S13] stored merged vector for next round verification (round=46)
[S13] DEBUG after merge:  round=46 metric=0.9989 head_norm=1.498816 delta_norm=0.045070
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.904156 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 3.061816479255146, 'psi': 0.24507471790179935}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0715652302844334, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.149799 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.3762379265549316, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.3619478396601408, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.067448 (no previous merge yet)
[S4] round=47 local utility u=0.018368 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.429142006490032, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.465877231618771, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=47 head_norm_before_train=2.265785 (no previous merge yet)
[S5] round=47 local utility u=0.005714 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2375069993991246, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2489341023156006, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=47 head_norm_before_train=1.634848 cos_to_last_merge=0.8910 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.891
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.569572778818358, 'psi': 0.02153000458085204}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.489221159633385, 'psi': 0.021749084249084248}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.914074 (no previous merge yet)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.24843867099675243, 'auprc': 0.24843867099675243, 'loss_val': 0.6284243541838173, 'psi': 0.24843867099675243}-{'f1_val': 0.39395371422032066, 'auprc': 0.39395371422032066, 'loss_val': 0.40572509459536216, 'psi': 0.39395371422032066}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.844068 cos_to_last_merge=0.9636 (last merge round=24)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4879705968765298, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4705035646006697, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.876824 cos_to_last_merge=0.9657 (last merge round=31)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.657029594635297, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6288867827974642, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.260579 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.2080606410041548, 'auprc': 0.2080606410041548, 'loss_val': 1.7420245838322115, 'psi': 0.2080606410041548}-{'f1_val': 0.2075256380061236, 'auprc': 0.2075256380061236, 'loss_val': 1.732775144711966, 'psi': 0.2075256380061236}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.029574 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.474477123800507, 'psi': 0.33201273984308244}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.460957475136186, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.498816 cos_to_last_merge=1.0000 (last merge round=46)
[S13] round=47 local utility u=0.006541 metrics={'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.22856253042703453, 'psi': 0.9991573068393276}-{'f1_val': 0.9988763297954963, 'auprc': 0.9988763297954963, 'loss_val': 0.23911555348472352, 'psi': 0.9988763297954963}
[S14] START round=47 head_norm_before_train=1.868077 cos_to_last_merge=0.9924 (last merge round=31)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.150319364729219, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.10167075917191, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.855739 cos_to_last_merge=0.9759 (last merge round=30)
[S15] round=47 local utility u=0.023341 metrics={'f1_val': 0.6154970049053944, 'auprc': 0.6154970049053944, 'loss_val': 0.5264992014473411, 'psi': 0.6154970049053944}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5819694063783979, 'psi': 0.6164734888353558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=47 head_norm_before_train=1.967270 (no previous merge yet)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.07049846562163059, 'auprc': 0.07049846562163059, 'loss_val': 5.532558160419731, 'psi': 0.07049846562163059}-{'f1_val': 0.14516012434034556, 'auprc': 0.14516012434034556, 'loss_val': 4.167034608257954, 'psi': 0.14516012434034556}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.501678 cos_to_last_merge=1.0000 (last merge round=45)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.3114871450549657, 'auprc': 0.3114871450549657, 'loss_val': 1.3352556455003914, 'psi': 0.3114871450549657}-{'f1_val': 0.4155959595959596, 'auprc': 0.4155959595959596, 'loss_val': 1.1498580786003685, 'psi': 0.4155959595959596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S13
[S17] cosine check vs S13: cos=0.9998
[S2] START round=48 head_norm_before_train=1.909199 (no previous merge yet)
[S2] round=48 local utility u=0.017663 metrics={'f1_val': 0.24611049859120424, 'auprc': 0.24611049859120424, 'loss_val': 3.0358119633187037, 'psi': 0.24611049859120424}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 3.061816479255146, 'psi': 0.24507471790179935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=48 head_norm_before_train=2.155502 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.390348117255451, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.3762379265549316, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.074240 (no previous merge yet)
[S4] round=48 local utility u=0.006894 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.415354726915703, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.429142006490032, 'psi': 0.3567939207526687}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] START round=48 head_norm_before_train=2.273592 (no previous merge yet)
[S5] round=48 local utility u=0.022404 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1926996518909876, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2375069993991246, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=48 head_norm_before_train=1.643456 cos_to_last_merge=0.8897 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.890
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 6.662255772527426, 'psi': 0.02065167508031207}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.569572778818358, 'psi': 0.02153000458085204}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.926376 (no previous merge yet)
[S7] round=48 local utility u=0.087571 metrics={'f1_val': 0.2490164597970771, 'auprc': 0.2490164597970771, 'loss_val': 0.4584826810384888, 'psi': 0.2490164597970771}-{'f1_val': 0.24843867099675243, 'auprc': 0.24843867099675243, 'loss_val': 0.6284243541838173, 'psi': 0.24843867099675243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=48 head_norm_before_train=1.851478 cos_to_last_merge=0.9626 (last merge round=24)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5132274805732238, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4879705968765298, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.885954 cos_to_last_merge=0.9646 (last merge round=31)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.679766434332683, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.657029594635297, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.269121 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.20397815912636505, 'auprc': 0.20397815912636505, 'loss_val': 1.7936018442957908, 'psi': 0.20397815912636505}-{'f1_val': 0.2080606410041548, 'auprc': 0.2080606410041548, 'loss_val': 1.7420245838322115, 'psi': 0.2080606410041548}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=2.036036 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.4910170173755852, 'psi': 0.3320901320901321}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.474477123800507, 'psi': 0.33201273984308244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.503843 cos_to_last_merge=1.0000 (last merge round=46)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.2301047797137919, 'psi': 0.9991573068393276}-{'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.22856253042703453, 'psi': 0.9991573068393276}
[S14] START round=48 head_norm_before_train=1.874212 cos_to_last_merge=0.9919 (last merge round=31)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.193051616295629, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.150319364729219, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.869153 cos_to_last_merge=0.9746 (last merge round=30)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5817913606810109, 'psi': 0.6166125814646326}-{'f1_val': 0.6154970049053944, 'auprc': 0.6154970049053944, 'loss_val': 0.5264992014473411, 'psi': 0.6154970049053944}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.971652 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.03798022228056357, 'auprc': 0.03798022228056357, 'loss_val': 5.889156301298401, 'psi': 0.03798022228056357}-{'f1_val': 0.07049846562163059, 'auprc': 0.07049846562163059, 'loss_val': 5.532558160419731, 'psi': 0.07049846562163059}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.510575 cos_to_last_merge=0.9999 (last merge round=45)
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.5096585099751825, 'auprc': 0.5096585099751825, 'loss_val': 0.9926282698640969, 'psi': 0.5096585099751825}-{'f1_val': 0.3114871450549657, 'auprc': 0.3114871450549657, 'loss_val': 1.3352556455003914, 'psi': 0.3114871450549657}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=0.9995
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=48 metric=0.5097 head_norm=1.522324
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.182986e-02
[S17] stored merged vector for next round verification (round=48)
[S17] DEBUG after merge:  round=48 metric=0.5097 head_norm=1.512954 delta_norm=0.021830
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.914085 (no previous merge yet)
[S2] round=49 local utility u=0.019657 metrics={'f1_val': 0.25048313696153607, 'auprc': 0.25048313696153607, 'loss_val': 3.035852352665266, 'psi': 0.25048313696153607}-{'f1_val': 0.24611049859120424, 'auprc': 0.24611049859120424, 'loss_val': 3.0358119633187037, 'psi': 0.24611049859120424}
[S2] not sending this round → trigger blocked (psi=0.250)
[S3] START round=49 head_norm_before_train=2.161177 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.4014113855915795, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 3.390348117255451, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.081522 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4244095980355551, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.415354726915703, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=2.283140 (no previous merge yet)
[S5] round=49 local utility u=0.061789 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.069122000060886, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1926996518909876, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=49 head_norm_before_train=1.652192 cos_to_last_merge=0.8884 (last merge round=27)
[S6] ⚠️ Model drifted since last merge! cos=0.888
[S6] round=49 local utility u=0.048551 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.577000042368414, 'psi': 0.021967963386727688}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 6.662255772527426, 'psi': 0.02065167508031207}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=49 head_norm_before_train=1.936266 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.24856429463171037, 'auprc': 0.24856429463171037, 'loss_val': 0.4683216977068174, 'psi': 0.24856429463171037}-{'f1_val': 0.2490164597970771, 'auprc': 0.2490164597970771, 'loss_val': 0.4584826810384888, 'psi': 0.2490164597970771}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.859033 cos_to_last_merge=0.9617 (last merge round=24)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5413399507009045, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5132274805732238, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.894481 cos_to_last_merge=0.9635 (last merge round=31)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.704859367955266, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.679766434332683, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.277102 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.20283110335466356, 'auprc': 0.20283110335466356, 'loss_val': 1.824353781567435, 'psi': 0.20283110335466356}-{'f1_val': 0.20397815912636505, 'auprc': 0.20397815912636505, 'loss_val': 1.7936018442957908, 'psi': 0.20397815912636505}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.042356 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.506463972956377, 'psi': 0.3320901320901321}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.4910170173755852, 'psi': 0.3320901320901321}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.510043 cos_to_last_merge=0.9999 (last merge round=46)
[S13] round=49 local utility u=0.000189 metrics={'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.22972625679159345, 'psi': 0.9991573068393276}-{'f1_val': 0.9991573068393276, 'auprc': 0.9991573068393276, 'loss_val': 0.2301047797137919, 'psi': 0.9991573068393276}
[S14] START round=49 head_norm_before_train=1.880026 cos_to_last_merge=0.9915 (last merge round=31)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.229211863777123, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 5.193051616295629, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.880499 cos_to_last_merge=0.9735 (last merge round=30)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5934173221632756, 'psi': 0.6166125814646326}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5817913606810109, 'psi': 0.6166125814646326}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.977072 (no previous merge yet)
[S16] round=49 local utility u=0.343373 metrics={'f1_val': 0.06916043225270158, 'auprc': 0.06916043225270158, 'loss_val': 5.483032245108752, 'psi': 0.06916043225270158}-{'f1_val': 0.03798022228056357, 'auprc': 0.03798022228056357, 'loss_val': 5.889156301298401, 'psi': 0.03798022228056357}
[S16] not sending this round → trigger blocked (psi=0.069)
[S17] START round=49 head_norm_before_train=1.512954 cos_to_last_merge=1.0000 (last merge round=48)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.43618956247126783, 'auprc': 0.43618956247126783, 'loss_val': 1.1418908018839833, 'psi': 0.43618956247126783}-{'f1_val': 0.5096585099751825, 'auprc': 0.5096585099751825, 'loss_val': 0.9926282698640969, 'psi': 0.5096585099751825}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[S13] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S13
[S17] cosine check vs S13: cos=0.9995
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=49 metric=0.9992 head_norm=1.518185
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.936362e-02
[S13] stored merged vector for next round verification (round=49)
[S13] DEBUG after merge:  round=49 metric=0.9992 head_norm=1.519972 delta_norm=0.029364
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
