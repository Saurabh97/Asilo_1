[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:40403
[S3] → join 127.0.0.1:40402
[S4] → join 127.0.0.1:40402
[S5] → join 127.0.0.1:40402
[S6] → join 127.0.0.1:40402
[S7] → join 127.0.0.1:40402
[S8] → join 127.0.0.1:40402
[S9] → join 127.0.0.1:40402
[S10] → join 127.0.0.1:40402
[S11] → join 127.0.0.1:40402
[S13] → join 127.0.0.1:40402
[S14] → join 127.0.0.1:40402
[S15] → join 127.0.0.1:40402
[S16] → join 127.0.0.1:40402
[S17] → join 127.0.0.1:40402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.148283 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.234133 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.165530 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.210540 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.192651 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.206699 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.190094 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.184209 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.166157 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.184282 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.176963 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.153311 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.147022 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.174303 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.098123 (no previous merge yet)
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S3] + discovered S10
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S13
[S3] + discovered S4
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S6
[S3] + discovered S17
[S3] + discovered S9
[S3] + discovered S11
[S3] + discovered S15
[S3] + discovered S8
[S3] + discovered S16
[S3] + discovered S7
[S5] + discovered S4
[S5] + discovered S2
[S5] + discovered S3
[S4] + discovered S13
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S17
[S4] + discovered S9
[S4] + discovered S11
[S4] + discovered S15
[S4] + discovered S8
[S4] + discovered S16
[S4] + discovered S7
[S4] + discovered S10
[S5] + discovered S16
[S5] + discovered S9
[S5] + discovered S14
[S5] + discovered S6
[S5] + discovered S10
[S5] + discovered S7
[S5] + discovered S17
[S5] + discovered S8
[S5] + discovered S11
[S5] + discovered S13
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S3
[S5] + discovered S15
[S6] + discovered S4
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S3
[S7] + discovered S6
[S6] + discovered S15
[S6] + discovered S17
[S6] + discovered S9
[S6] + discovered S8
[S6] + discovered S16
[S6] + discovered S11
[S6] + discovered S10
[S6] + discovered S7
[S6] + discovered S14
[S6] + discovered S13
[S7] + discovered S14
[S7] + discovered S9
[S8] + discovered S5
[S8] + discovered S3
[S7] + discovered S16
[S7] + discovered S13
[S7] + discovered S11
[S7] + discovered S10
[S7] + discovered S15
[S7] + discovered S8
[S8] + discovered S2
[S8] + discovered S7
[S8] + discovered S6
[S8] + discovered S4
[S7] + discovered S17
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S6
[S9] + discovered S8
[S8] + discovered S11
[S9] + discovered S5
[S8] + discovered S13
[S8] + discovered S9
[S8] + discovered S14
[S8] + discovered S17
[S8] + discovered S16
[S8] + discovered S15
[S8] + discovered S10
[S10] + discovered S8
[S10] + discovered S6
[S10] + discovered S5
[S10] + discovered S7
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S4
[S10] + discovered S9
[S9] + discovered S14
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S10
[S9] + discovered S15
[S9] + discovered S13
[S9] + discovered S11
[S10] + discovered S15
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S16
[S10] + discovered S17
[S10] + discovered S14
[S11] + discovered S4
[S11] + discovered S3
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S9
[S11] + discovered S2
[S11] + discovered S10
[S11] + discovered S7
[S11] + discovered S5
[S11] + discovered S17
[S11] + discovered S13
[S11] + discovered S15
[S11] + discovered S16
[S11] + discovered S14
[S13] + discovered S2
[S13] + discovered S5
[S13] + discovered S8
[S13] + discovered S3
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S10
[S13] + discovered S9
[S13] + discovered S11
[S13] + discovered S6
[S14] + discovered S11
[S14] + discovered S10
[S14] + discovered S4
[S14] + discovered S3
[S14] + discovered S8
[S14] + discovered S5
[S14] + discovered S13
[S14] + discovered S6
[S14] + discovered S9
[S14] + discovered S7
[S14] + discovered S2
[S13] + discovered S14
[S13] + discovered S16
[S13] + discovered S15
[S13] + discovered S17
[S15] + discovered S4
[S15] + discovered S5
[S15] + discovered S2
[S15] + discovered S11
[S15] + discovered S9
[S15] + discovered S6
[S15] + discovered S8
[S15] + discovered S10
[S14] + discovered S17
[S14] + discovered S15
[S15] + discovered S7
[S15] + discovered S14
[S14] + discovered S16
[S15] + discovered S13
[S15] + discovered S3
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S4
[S16] + discovered S8
[S16] + discovered S10
[S16] + discovered S5
[S16] + discovered S6
[S16] + discovered S15
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S11
[S16] + discovered S7
[S16] + discovered S2
[S16] + discovered S14
[S16] + discovered S9
[S17] + discovered S10
[S16] + discovered S17
[S17] + discovered S9
[S17] + discovered S6
[S17] + discovered S2
[S17] + discovered S3
[S17] + discovered S7
[S17] + discovered S4
[S17] + discovered S5
[S17] + discovered S16
[S17] + discovered S13
[S17] + discovered S14
[S17] + discovered S11
[S17] + discovered S8
[S17] + discovered S15
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:40414
[S7] ⇄ pheromone p=1.000 → S10@127.0.0.1:40411
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:40404
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:40402
[S14] ⇄ pheromone p=1.000 → S4@127.0.0.1:40404
[S2] ⇄ pheromone p=1.000 → S16@127.0.0.1:40416
[S15] ⇄ pheromone p=1.000 → S16@127.0.0.1:40416
[S4] ⇄ pheromone p=1.000 → S9@127.0.0.1:40410
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:40414
[S9] ⇄ pheromone p=1.000 → S13@127.0.0.1:40413
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:40410
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:40412
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:40417
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:40416
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:40410
[S2] START round=1 head_norm_before_train=1.167009 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9600772875745702, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.567694667337952, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.241304 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.552454557649607, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.45830462864353, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.162716 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5084938581501885, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4386377180926442, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.214157 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4758617520116721, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4364239034865234, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.209606 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9612722738497883, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5724944361747286, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.204908 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4957055091678055, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4350985572504031, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.199601 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.538104429267794, 'psi': 0.0}-{'f1_val': 0.24165901438628712, 'auprc': 0.24165901438628712, 'loss_val': 1.4017507320395446, 'psi': 0.24165901438628712}
[S9] START round=1 head_norm_before_train=1.187940 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5769772508868525, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4565651239529, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.180825 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5190385136190327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3937448077518266, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.187998 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4986622836178287, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4000379621825823, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.190577 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6271767077038954, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4999998028103285, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.158524 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4743322566986505, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3930261821533028, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.160227 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6418434078074315, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4555894839604846, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.180907 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6047450556311158, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4991468385547946, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.112883 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6452009310966034, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4645510382217928, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.218668 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2209813773562104, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9600772875745702, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.261217 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7381823840127142, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.552454557649607, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.194986 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6505978961478442, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5084938581501885, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.226122 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5537448559167655, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4758617520116721, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.265088 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.051406061380719, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9612722738497883, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.213430 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6018471517513346, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4957055091678055, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.238842 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6552772501700572, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.538104429267794, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.205709 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7963711440317278, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5769772508868525, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.217612 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8507843030175681, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5190385136190327, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.203384 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6697123086087409, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4986622836178287, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.231979 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.81670883614539, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6271767077038954, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.175303 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6109691765863192, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4743322566986505, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.193495 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.233116514766681, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6418434078074315, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.200266 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.803937583682289, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6047450556311158, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.157939 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9762722349861441, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6452009310966034, 'psi': 0.0}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.283969 (no previous merge yet)
[S2] round=3 local utility u=0.144757 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9314676520566225, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2209813773562104, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.289042 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2577127520085813, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7381823840127142, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.245153 (no previous merge yet)
[S4] round=3 local utility u=0.048606 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5533866623925672, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6505978961478442, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.245353 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.716530983741028, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5537448559167655, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.328145 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.056044425608409, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.051406061380719, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.233876 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8693614458116163, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6018471517513346, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.277870 (no previous merge yet)
[S8] round=3 local utility u=0.937881 metrics={'f1_val': 0.19145299145299144, 'auprc': 0.19145299145299144, 'loss_val': 1.5025915272561825, 'psi': 0.19145299145299144}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6552772501700572, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.235173 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3436742153637966, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7963711440317278, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.267711 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8630657248239255, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8507843030175681, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.228001 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0864115241554897, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6697123086087409, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.265514 (no previous merge yet)
[S13] round=3 local utility u=0.075222 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6662653366947697, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.81670883614539, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.201253 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.00748081718726, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6109691765863192, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.239773 (no previous merge yet)
[S15] round=3 local utility u=0.194408 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8443001829607606, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.233116514766681, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.230053 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2903283840476885, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.803937583682289, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.206579 (no previous merge yet)
[S17] round=3 local utility u=0.159139 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.657993621454139, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9762722349861441, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.191)
[S15] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=4 head_norm_before_train=1.319665 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.950264866735465, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9314676520566225, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.326622 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.053401830905372, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2577127520085813, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.287408 (no previous merge yet)
[S4] round=4 local utility u=0.056088 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4412098780164515, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5533866623925672, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.270545 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8762336897794143, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.716530983741028, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.370638 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1877803715376594, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.056044425608409, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.263191 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1575832756122097, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8693614458116163, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.308398 (no previous merge yet)
[S8] round=4 local utility u=0.250353 metrics={'f1_val': 0.22784992784992786, 'auprc': 0.22784992784992786, 'loss_val': 1.329458085973106, 'psi': 0.22784992784992786}-{'f1_val': 0.19145299145299144, 'auprc': 0.19145299145299144, 'loss_val': 1.5025915272561825, 'psi': 0.19145299145299144}
[S9] START round=4 head_norm_before_train=1.273239 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.780157507601057, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3436742153637966, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.305983 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2862297699937986, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8630657248239255, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.261365 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.790141894113198, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0864115241554897, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.275274 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6970695439696672, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6662653366947697, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.237495 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0724901667660185, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.00748081718726, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.245357 (no previous merge yet)
[S15] round=4 local utility u=0.069040 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7062211053684389, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8443001829607606, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.266179 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8898444728789294, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2903283840476885, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.240630 (no previous merge yet)
[S17] round=4 local utility u=1.000000 metrics={'f1_val': 0.21474358974358976, 'auprc': 0.21474358974358976, 'loss_val': 1.3863527055231137, 'psi': 0.21474358974358976}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.657993621454139, 'psi': 0.0}
[S4] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:40417
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=-0.0985
[S17] DROPPED delta from S8 (cos=-0.0985 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] cosine check vs S17: cos=0.0136
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.0000 head_norm=1.300943
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.107507e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.0000 head_norm=0.923179 delta_norm=0.910751
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.371658 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1201432234563793, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.950264866735465, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.359748 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.170443072868646, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.053401830905372, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.340438 (no previous merge yet)
[S4] round=5 local utility u=0.011497 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4182159058283552, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4412098780164515, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.291252 (no previous merge yet)
[S5] round=5 local utility u=0.028828 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8185776749388445, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8762336897794143, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.417455 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.51659036716572, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1877803715376594, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.283964 (no previous merge yet)
[S7] round=5 local utility u=0.047373 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0628382338544813, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1575832756122097, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.352613 (no previous merge yet)
[S8] round=5 local utility u=0.106644 metrics={'f1_val': 0.2386009941565497, 'auprc': 0.2386009941565497, 'loss_val': 1.2129297872446119, 'psi': 0.2386009941565497}-{'f1_val': 0.22784992784992786, 'auprc': 0.22784992784992786, 'loss_val': 1.329458085973106, 'psi': 0.22784992784992786}
[S9] START round=5 head_norm_before_train=0.923179 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.317598 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.144960722916329, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.780157507601057, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.361480 (no previous merge yet)
[S10] round=5 local utility u=0.775576 metrics={'f1_val': 0.23832923832923833, 'auprc': 0.23832923832923833, 'loss_val': 2.880041364475389, 'psi': 0.23832923832923833}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2862297699937986, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.295426 (no previous merge yet)
[S11] round=5 local utility u=0.014121 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.761899145815009, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.790141894113198, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.302640 (no previous merge yet)
[S13] round=5 local utility u=0.127858 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.441352802567734, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6970695439696672, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.281146 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.534332135016495, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0724901667660185, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.266944 (no previous merge yet)
[S15] round=5 local utility u=0.023930 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6583609715219572, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7062211053684389, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.295497 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0300946309968184, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8898444728789294, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.292671 (no previous merge yet)
[S17] round=5 local utility u=0.011163 metrics={'f1_val': 0.20308965160623102, 'auprc': 0.20308965160623102, 'loss_val': 1.2591418583925393, 'psi': 0.20308965160623102}-{'f1_val': 0.21474358974358976, 'auprc': 0.21474358974358976, 'loss_val': 1.3863527055231137, 'psi': 0.21474358974358976}
[S4] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:40414
[S15] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.239)
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.0378
[S17] not sending this round → trigger blocked (psi=0.203)
[S6] ⇄ pheromone p=0.328 → S11@127.0.0.1:40412
[S9] ⇄ pheromone p=0.391 → S13@127.0.0.1:40413
[S7] ⇄ pheromone p=0.337 → S10@127.0.0.1:40411
[S5] ⇄ pheromone p=0.333 → S9@127.0.0.1:40410
[S15] ⇄ pheromone p=0.368 → S16@127.0.0.1:40416
[S13] ⇄ pheromone p=0.363 → S16@127.0.0.1:40416
[S11] ⇄ pheromone p=0.331 → S14@127.0.0.1:40414
[S4] ⇄ pheromone p=0.345 → S9@127.0.0.1:40410
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.0000 head_norm=1.313193
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.507173e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.0000 head_norm=0.987269 delta_norm=0.950717
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.328 → S4@127.0.0.1:40404
[S3] ⇄ pheromone p=0.328 → S4@127.0.0.1:40404
[S8] ⇄ pheromone p=0.509 → S17@127.0.0.1:40417
[S2] ⇄ pheromone p=0.346 → S8@127.0.0.1:40409
[S10] ⇄ pheromone p=0.483 → S14@127.0.0.1:40414
[S17] ⇄ pheromone p=0.510 → S9@127.0.0.1:40410
[S16] ⇄ pheromone p=0.328 → S8@127.0.0.1:40409
[S2] START round=6 head_norm_before_train=1.437532 (no previous merge yet)
[S2] round=6 local utility u=0.210077 metrics={'f1_val': 0.00819403474270731, 'auprc': 0.00819403474270731, 'loss_val': 2.7737359533777677, 'psi': 0.00819403474270731}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1201432234563793, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.377831 (no previous merge yet)
[S3] round=6 local utility u=0.202555 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7653329640353785, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.170443072868646, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.405851 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4479012999737328, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4182159058283552, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.302616 (no previous merge yet)
[S5] round=6 local utility u=0.096186 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6262061831194168, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8185776749388445, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.470812 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5392518032613576, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.51659036716572, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.288019 (no previous merge yet)
[S7] round=6 local utility u=0.112448 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8379418442555648, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0628382338544813, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.402751 (no previous merge yet)
[S8] round=6 local utility u=0.106633 metrics={'f1_val': 0.2552470327983235, 'auprc': 0.2552470327983235, 'loss_val': 1.149478841554487, 'psi': 0.2552470327983235}-{'f1_val': 0.2386009941565497, 'auprc': 0.2386009941565497, 'loss_val': 1.2129297872446119, 'psi': 0.2386009941565497}
[S9] START round=6 head_norm_before_train=0.943645 cos_to_last_merge=0.9976 (last merge round=4)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.481036124068894, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.144960722916329, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.425711 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.2454444780026175, 'auprc': 0.2454444780026175, 'loss_val': 3.238056685190131, 'psi': 0.24544447800261754}-{'f1_val': 0.23832923832923833, 'auprc': 0.23832923832923833, 'loss_val': 2.880041364475389, 'psi': 0.23832923832923833}
[S11] START round=6 head_norm_before_train=1.315006 (no previous merge yet)
[S11] round=6 local utility u=0.118588 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.524723969368505, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.761899145815009, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.317487 (no previous merge yet)
[S13] round=6 local utility u=0.108794 metrics={'f1_val': 0.011594202898550725, 'auprc': 0.011594202898550725, 'loss_val': 1.328113096393843, 'psi': 0.011594202898550725}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.441352802567734, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=0.987269 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.527588 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4791561421938324, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.534332135016495, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.309157 (no previous merge yet)
[S15] round=6 local utility u=0.406774 metrics={'f1_val': 0.05340264650283554, 'auprc': 0.05340264650283554, 'loss_val': 1.3254373850349541, 'psi': 0.053402646502835535}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6583609715219572, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.318005 (no previous merge yet)
[S16] round=6 local utility u=0.090245 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8496039423535002, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0300946309968184, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.347547 (no previous merge yet)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2159030115471563, 'psi': 0.15234678044996122}-{'f1_val': 0.20308965160623102, 'auprc': 0.20308965160623102, 'loss_val': 1.2591418583925393, 'psi': 0.20308965160623102}
[S3] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.053)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:40417
[S13] not sending this round → trigger blocked (psi=0.012)
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.008)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=-0.1041
[S17] DROPPED delta from S8 (cos=-0.1041 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=7 head_norm_before_train=1.492938 (no previous merge yet)
[S2] round=7 local utility u=0.806531 metrics={'f1_val': 0.21188455008488963, 'auprc': 0.21188455008488963, 'loss_val': 2.9938881223415796, 'psi': 0.21188455008488966}-{'f1_val': 0.00819403474270731, 'auprc': 0.00819403474270731, 'loss_val': 2.7737359533777677, 'psi': 0.00819403474270731}
[S3] START round=7 head_norm_before_train=1.390169 (no previous merge yet)
[S3] round=7 local utility u=0.136523 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.492287307276838, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7653329640353785, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.475126 (no previous merge yet)
[S4] round=7 local utility u=0.036756 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3743899074167176, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4479012999737328, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.308954 (no previous merge yet)
[S5] round=7 local utility u=0.047661 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5308843234062472, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6262061831194168, 'psi': 0.0}
[S6] START round=7 head_norm_before_train=1.526216 (no previous merge yet)
[S6] round=7 local utility u=0.609876 metrics={'f1_val': 0.10703536493604214, 'auprc': 0.10703536493604214, 'loss_val': 3.2828186629166414, 'psi': 0.10703536493604213}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5392518032613576, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.286753 (no previous merge yet)
[S7] round=7 local utility u=0.017826 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8022906310829088, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8379418442555648, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.453876 (no previous merge yet)
[S8] round=7 local utility u=1.000000 metrics={'f1_val': 0.5091680145920088, 'auprc': 0.5091680145920088, 'loss_val': 1.0558047683757925, 'psi': 0.5091680145920088}-{'f1_val': 0.2552470327983235, 'auprc': 0.2552470327983235, 'loss_val': 1.149478841554487, 'psi': 0.2552470327983235}
[S9] START round=7 head_norm_before_train=0.976752 cos_to_last_merge=0.9909 (last merge round=4)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6854650750811935, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.481036124068894, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.488131 (no previous merge yet)
[S10] round=7 local utility u=0.273615 metrics={'f1_val': 0.2892196662156067, 'auprc': 0.2892196662156067, 'loss_val': 3.0848025688657694, 'psi': 0.2892196662156067}-{'f1_val': 0.2454444780026175, 'auprc': 0.2454444780026175, 'loss_val': 3.238056685190131, 'psi': 0.24544447800261754}
[S11] START round=7 head_norm_before_train=1.335142 (no previous merge yet)
[S11] round=7 local utility u=0.014745 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4952331002657533, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.524723969368505, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.352855 (no previous merge yet)
[S13] round=7 local utility u=1.000000 metrics={'f1_val': 0.3231146018072798, 'auprc': 0.3231146018072798, 'loss_val': 1.2246879299593472, 'psi': 0.3231146018072798}-{'f1_val': 0.011594202898550725, 'auprc': 0.011594202898550725, 'loss_val': 1.328113096393843, 'psi': 0.011594202898550725}
[S14] START round=7 head_norm_before_train=1.012006 cos_to_last_merge=0.9985 (last merge round=5)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.110842346812702, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4791561421938324, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.350365 (no previous merge yet)
[S15] round=7 local utility u=1.000000 metrics={'f1_val': 0.43370863768214757, 'auprc': 0.43370863768214757, 'loss_val': 1.1715529082297642, 'psi': 0.4337086376821475}-{'f1_val': 0.05340264650283554, 'auprc': 0.05340264650283554, 'loss_val': 1.3254373850349541, 'psi': 0.053402646502835535}
[S16] START round=7 head_norm_before_train=1.340146 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8541400536616726, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8496039423535002, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.405258 (no previous merge yet)
[S17] round=7 local utility u=0.023015 metrics={'f1_val': 0.1524058983313931, 'auprc': 0.1524058983313931, 'loss_val': 1.1704049794547324, 'psi': 0.1524058983313931}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2159030115471563, 'psi': 0.15234678044996122}
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:40416
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:40409
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.107)
[S5] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:40414
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=-0.0221
[S16] DROPPED delta from S13 (cos=-0.0221 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S15
[S16] cosine check vs S15: cos=-0.1369
[S16] DROPPED delta from S15 (cos=-0.1369 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] cosine check vs S8: cos=-0.1051
[S17] DROPPED delta from S8 (cos=-0.1051 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] cosine check vs S10: cos=0.7029
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=-0.0047
[S8] DROPPED delta from S2 (cos=-0.0047 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.6221
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.0000 head_norm=1.013997
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.733705e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.117395 delta_norm=0.573371
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.0000 head_norm=1.045389
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.459840e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.194020 delta_norm=0.545984
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.546726 (no previous merge yet)
[S2] round=8 local utility u=0.237080 metrics={'f1_val': 0.22919823915710472, 'auprc': 0.22919823915710472, 'loss_val': 2.6755518031465058, 'psi': 0.22919823915710472}-{'f1_val': 0.21188455008488963, 'auprc': 0.21188455008488963, 'loss_val': 2.9938881223415796, 'psi': 0.21188455008488966}
[S3] START round=8 head_norm_before_train=1.408225 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.583828331637359, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.492287307276838, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.524601 (no previous merge yet)
[S4] round=8 local utility u=0.005039 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3643126475891272, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3743899074167176, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.324880 (no previous merge yet)
[S5] round=8 local utility u=0.050743 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4293992210108337, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5308843234062472, 'psi': 0.0}
[S6] START round=8 head_norm_before_train=1.568696 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.04626411815812337, 'auprc': 0.04626411815812337, 'loss_val': 4.256340112516049, 'psi': 0.04626411815812337}-{'f1_val': 0.10703536493604214, 'auprc': 0.10703536493604214, 'loss_val': 3.2828186629166414, 'psi': 0.10703536493604213}
[S7] START round=8 head_norm_before_train=1.296113 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8357320221532873, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8022906310829088, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.500942 (no previous merge yet)
[S8] round=8 local utility u=0.435380 metrics={'f1_val': 0.5953803123331289, 'auprc': 0.5953803123331289, 'loss_val': 0.9609549335162516, 'psi': 0.5953803123331289}-{'f1_val': 0.5091680145920088, 'auprc': 0.5091680145920088, 'loss_val': 1.0558047683757925, 'psi': 0.5091680145920088}
[S9] START round=8 head_norm_before_train=1.117395 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.311259 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0629479899947483, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6854650750811935, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.534512 (no previous merge yet)
[S10] round=8 local utility u=0.270350 metrics={'f1_val': 0.3279909341104096, 'auprc': 0.3279909341104096, 'loss_val': 2.893043196809049, 'psi': 0.3279909341104096}-{'f1_val': 0.2892196662156067, 'auprc': 0.2892196662156067, 'loss_val': 3.0848025688657694, 'psi': 0.2892196662156067}
[S11] START round=8 head_norm_before_train=1.357420 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.571378654526795, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4952331002657533, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.393542 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.2400709219858156, 'auprc': 0.2400709219858156, 'loss_val': 1.1753402875401993, 'psi': 0.2400709219858156}-{'f1_val': 0.3231146018072798, 'auprc': 0.3231146018072798, 'loss_val': 1.2246879299593472, 'psi': 0.3231146018072798}
[S14] START round=8 head_norm_before_train=1.194020 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.325678 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.459486015622056, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.110842346812702, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.409117 (no previous merge yet)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.33322801474460245, 'auprc': 0.33322801474460245, 'loss_val': 1.0258005254729285, 'psi': 0.33322801474460245}-{'f1_val': 0.43370863768214757, 'auprc': 0.43370863768214757, 'loss_val': 1.1715529082297642, 'psi': 0.4337086376821475}
[S16] START round=8 head_norm_before_train=1.369442 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.932749872122565, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8541400536616726, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.458239 (no previous merge yet)
[S17] round=8 local utility u=0.038733 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.0916098916392765, 'psi': 0.1522581895716224}-{'f1_val': 0.1524058983313931, 'auprc': 0.1524058983313931, 'loss_val': 1.1704049794547324, 'psi': 0.1524058983313931}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:40414
[S14] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:40417
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9341
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=-0.0034
[S8] DROPPED delta from S2 (cos=-0.0034 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=-0.1067
[S17] DROPPED delta from S8 (cos=-0.1067 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.9119
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.0000 head_norm=1.215563
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.111444e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.375729 delta_norm=0.311144
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.0000 head_norm=1.139670
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.323020e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.296569 delta_norm=0.332302
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.595807 (no previous merge yet)
[S2] round=9 local utility u=0.227174 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.546999807348521, 'psi': 0.2653978324081417}-{'f1_val': 0.22919823915710472, 'auprc': 0.22919823915710472, 'loss_val': 2.6755518031465058, 'psi': 0.22919823915710472}
[S3] START round=9 head_norm_before_train=1.435372 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7260781599379835, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.583828331637359, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.568378 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3660499219993276, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3643126475891272, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.344802 (no previous merge yet)
[S5] round=9 local utility u=1.000000 metrics={'f1_val': 0.2176418453833527, 'auprc': 0.2176418453833527, 'loss_val': 1.3067928191358062, 'psi': 0.2176418453833527}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4293992210108337, 'psi': 0.0}
[S6] START round=9 head_norm_before_train=1.605541 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 4.543848163924172, 'psi': 0.023059360730593607}-{'f1_val': 0.04626411815812337, 'auprc': 0.04626411815812337, 'loss_val': 4.256340112516049, 'psi': 0.04626411815812337}
[S7] START round=9 head_norm_before_train=1.311627 (no previous merge yet)
[S7] round=9 local utility u=0.041058 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7536153757569428, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8357320221532873, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.557903 (no previous merge yet)
[S8] round=9 local utility u=1.000000 metrics={'f1_val': 0.9994354958690915, 'auprc': 0.9994354958690915, 'loss_val': 0.8832040514061283, 'psi': 0.9994354958690915}-{'f1_val': 0.5953803123331289, 'auprc': 0.5953803123331289, 'loss_val': 0.9609549335162516, 'psi': 0.5953803123331289}
[S9] START round=9 head_norm_before_train=1.296569 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.026362 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0102240306790886, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0629479899947483, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.581547 (no previous merge yet)
[S10] round=9 local utility u=0.100226 metrics={'f1_val': 0.33261477045908183, 'auprc': 0.33261477045908183, 'loss_val': 2.7342054898902663, 'psi': 0.33261477045908183}-{'f1_val': 0.3279909341104096, 'auprc': 0.3279909341104096, 'loss_val': 2.893043196809049, 'psi': 0.3279909341104096}
[S11] START round=9 head_norm_before_train=1.383739 (no previous merge yet)
[S11] round=9 local utility u=0.222822 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.125734359669699, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.571378654526795, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.443274 (no previous merge yet)
[S13] round=9 local utility u=0.538409 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1773109241363733, 'psi': 0.3599362944611573}-{'f1_val': 0.2400709219858156, 'auprc': 0.2400709219858156, 'loss_val': 1.1753402875401993, 'psi': 0.2400709219858156}
[S14] START round=9 head_norm_before_train=1.375729 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6737468694619175, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.459486015622056, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.470632 (no previous merge yet)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.2820699708454811, 'auprc': 0.2820699708454811, 'loss_val': 0.9428631493994712, 'psi': 0.2820699708454811}-{'f1_val': 0.33322801474460245, 'auprc': 0.33322801474460245, 'loss_val': 1.0258005254729285, 'psi': 0.33322801474460245}
[S16] START round=9 head_norm_before_train=1.402075 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9372049429211273, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.932749872122565, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.511353 (no previous merge yet)
[S17] round=9 local utility u=0.031599 metrics={'f1_val': 0.1527318685592067, 'auprc': 0.1527318685592067, 'loss_val': 1.0326757692171509, 'psi': 0.1527318685592067}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.0916098916392765, 'psi': 0.1522581895716224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:40417
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[S9] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:40414
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:40410
[S5] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=-0.0142
[S9] DROPPED delta from S5 (cos=-0.0142 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9773
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] cosine check vs S2: cos=-0.0020
[S8] DROPPED delta from S2 (cos=-0.0020 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=-0.1093
[S17] DROPPED delta from S8 (cos=-0.1093 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] cosine check vs S13: cos=-0.0231
[S16] DROPPED delta from S13 (cos=-0.0231 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.9681
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.0000 head_norm=1.396341
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.977762e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.503389 delta_norm=0.197776
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.0000 head_norm=1.315530
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.181501e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.426022 delta_norm=0.218150
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.642542 (no previous merge yet)
[S2] round=10 local utility u=0.023478 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.5002869923014823, 'psi': 0.26542475888492534}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.546999807348521, 'psi': 0.2653978324081417}
[S3] START round=10 head_norm_before_train=1.466637 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.763367488633971, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7260781599379835, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.607274 (no previous merge yet)
[S4] round=10 local utility u=0.913273 metrics={'f1_val': 0.20340858787073926, 'auprc': 0.20340858787073926, 'loss_val': 1.3701804216034468, 'psi': 0.20340858787073926}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3660499219993276, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.362032 (no previous merge yet)
[S5] round=10 local utility u=1.000000 metrics={'f1_val': 0.63568652294016, 'auprc': 0.63568652294016, 'loss_val': 1.2356692088964074, 'psi': 0.63568652294016}-{'f1_val': 0.2176418453833527, 'auprc': 0.2176418453833527, 'loss_val': 1.3067928191358062, 'psi': 0.2176418453833527}
[S6] START round=10 head_norm_before_train=1.636963 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.449975654313922, 'psi': 0.0}-{'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 4.543848163924172, 'psi': 0.023059360730593607}
[S7] START round=10 head_norm_before_train=1.325424 (no previous merge yet)
[S7] round=10 local utility u=0.103735 metrics={'f1_val': 0.0003046922608165753, 'auprc': 0.0003046922608165753, 'loss_val': 1.5488870528434435, 'psi': 0.0003046922608165753}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7536153757569428, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.622813 (no previous merge yet)
[S8] round=10 local utility u=0.028775 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.8205722226898272, 'psi': 0.9988708350860451}-{'f1_val': 0.9994354958690915, 'auprc': 0.9994354958690915, 'loss_val': 0.8832040514061283, 'psi': 0.9994354958690915}
[S9] START round=10 head_norm_before_train=1.426022 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.075934 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.858355737469547, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0102240306790886, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.627519 (no previous merge yet)
[S10] round=10 local utility u=0.056377 metrics={'f1_val': 0.33293470461612057, 'auprc': 0.33293470461612057, 'loss_val': 2.624331420349776, 'psi': 0.33293470461612057}-{'f1_val': 0.33261477045908183, 'auprc': 0.33261477045908183, 'loss_val': 2.7342054898902663, 'psi': 0.33261477045908183}
[S11] START round=10 head_norm_before_train=1.410299 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.377638599782722, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.125734359669699, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.494124 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.187384653376334, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1773109241363733, 'psi': 0.3599362944611573}
[S14] START round=10 head_norm_before_train=1.503389 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.921540091589438, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6737468694619175, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.529874 (no previous merge yet)
[S15] round=10 local utility u=0.335590 metrics={'f1_val': 0.3308940502704422, 'auprc': 0.3308940502704422, 'loss_val': 0.7111000093076126, 'psi': 0.3308940502704422}-{'f1_val': 0.2820699708454811, 'auprc': 0.2820699708454811, 'loss_val': 0.9428631493994712, 'psi': 0.2820699708454811}
[S16] START round=10 head_norm_before_train=1.436089 (no previous merge yet)
[S16] round=10 local utility u=0.045929 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8453473030030083, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9372049429211273, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.559371 (no previous merge yet)
[S17] round=10 local utility u=0.031646 metrics={'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.9648548438673482, 'psi': 0.15222868217054264}-{'f1_val': 0.1527318685592067, 'auprc': 0.1527318685592067, 'loss_val': 1.0326757692171509, 'psi': 0.1527318685592067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:40416
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[S7] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:40417
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:40410
[S16] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=-0.0040
[S9] DROPPED delta from S5 (cos=-0.0040 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S4
[S9] cosine check vs S4: cos=0.0251
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=-0.0006
[S8] DROPPED delta from S2 (cos=-0.0006 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=-0.1117
[S17] DROPPED delta from S8 (cos=-0.1117 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S15
[S16] cosine check vs S15: cos=-0.1098
[S16] DROPPED delta from S15 (cos=-0.1098 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.9818
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9874
[S7] ⇄ pheromone p=0.149 → S10@127.0.0.1:40411
[S3] ⇄ pheromone p=0.138 → S4@127.0.0.1:40404
[S6] ⇄ pheromone p=0.170 → S11@127.0.0.1:40412
[S2] ⇄ pheromone p=0.285 → S8@127.0.0.1:40409
[S5] ⇄ pheromone p=0.489 → S9@127.0.0.1:40410
[S4] ⇄ pheromone p=0.300 → S9@127.0.0.1:40410
[S8] ⇄ pheromone p=0.499 → S17@127.0.0.1:40417
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.0000 head_norm=1.525994
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.452344e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.591867 delta_norm=0.145234
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.192 → S4@127.0.0.1:40404
[S13] ⇄ pheromone p=0.316 → S16@127.0.0.1:40416
[S11] ⇄ pheromone p=0.155 → S14@127.0.0.1:40414
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.0000 head_norm=1.444676
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.304112e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.203672 delta_norm=0.530411
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.187 → S13@127.0.0.1:40413
[S17] ⇄ pheromone p=0.186 → S9@127.0.0.1:40410
[S10] ⇄ pheromone p=0.248 → S14@127.0.0.1:40414
[S15] ⇄ pheromone p=0.324 → S16@127.0.0.1:40416
[S16] ⇄ pheromone p=0.124 → S8@127.0.0.1:40409
[S2] START round=11 head_norm_before_train=1.681800 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.6889383189407994, 'psi': 0.2653978324081417}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.5002869923014823, 'psi': 0.26542475888492534}
[S3] START round=11 head_norm_before_train=1.498032 (no previous merge yet)
[S3] round=11 local utility u=0.180787 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4017943143432263, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.763367488633971, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.650949 (no previous merge yet)
[S4] round=11 local utility u=0.700670 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3493087739355725, 'psi': 0.3567939207526687}-{'f1_val': 0.20340858787073926, 'auprc': 0.20340858787073926, 'loss_val': 1.3701804216034468, 'psi': 0.20340858787073926}
[S5] START round=11 head_norm_before_train=1.385850 (no previous merge yet)
[S5] round=11 local utility u=1.000000 metrics={'f1_val': 0.9991554693142528, 'auprc': 0.9991554693142528, 'loss_val': 1.1724410276642325, 'psi': 0.9991554693142528}-{'f1_val': 0.63568652294016, 'auprc': 0.63568652294016, 'loss_val': 1.2356692088964074, 'psi': 0.63568652294016}
[S6] START round=11 head_norm_before_train=1.665223 (no previous merge yet)
[S6] round=11 local utility u=0.136312 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.333312022067963, 'psi': 0.01732902033271719}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.449975654313922, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.335073 (no previous merge yet)
[S7] round=11 local utility u=0.041871 metrics={'f1_val': 0.0009305788200260562, 'auprc': 0.0009305788200260562, 'loss_val': 1.4707777424490547, 'psi': 0.0009305788200260562}-{'f1_val': 0.0003046922608165753, 'auprc': 0.0003046922608165753, 'loss_val': 1.5488870528434435, 'psi': 0.0003046922608165753}
[S8] START round=11 head_norm_before_train=1.679608 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7641462274979085, 'psi': 0.35939447907390915}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.8205722226898272, 'psi': 0.9988708350860451}
[S9] START round=11 head_norm_before_train=1.203672 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.021563 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8152297916376683, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.858355737469547, 'psi': 0.0}
[S10] START round=11 head_norm_before_train=1.667816 (no previous merge yet)
[S10] round=11 local utility u=0.039517 metrics={'f1_val': 0.33293489521077374, 'auprc': 0.33293489521077374, 'loss_val': 2.5452998247804834, 'psi': 0.33293489521077374}-{'f1_val': 0.33293470461612057, 'auprc': 0.33293470461612057, 'loss_val': 2.624331420349776, 'psi': 0.33293470461612057}
[S11] START round=11 head_norm_before_train=1.443323 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.523921622064343, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.377638599782722, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.544198 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2639035768639642, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.187384653376334, 'psi': 0.3599362944611573}
[S14] START round=11 head_norm_before_train=1.591867 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2498408764637006, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.921540091589438, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.590198 (no previous merge yet)
[S15] round=11 local utility u=1.000000 metrics={'f1_val': 0.5989108740498366, 'auprc': 0.5989108740498366, 'loss_val': 0.6213794754096786, 'psi': 0.5989108740498366}-{'f1_val': 0.3308940502704422, 'auprc': 0.3308940502704422, 'loss_val': 0.7111000093076126, 'psi': 0.3308940502704422}
[S16] START round=11 head_norm_before_train=1.469483 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.980895576184696, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8453473030030083, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.603930 (no previous merge yet)
[S17] round=11 local utility u=0.024954 metrics={'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.9149476609984498, 'psi': 0.15222868217054264}-{'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.9648548438673482, 'psi': 0.15222868217054264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:40410
[S6] not sending this round → trigger blocked (psi=0.017)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[S7] not sending this round → trigger blocked (psi=0.001)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:40416
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.0068
[S9] DROPPED delta from S5 (cos=-0.0068 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1805) from S4
[S9] cosine check vs S4: cos=0.3598
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9907
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] cosine check vs S15: cos=-0.1055
[S16] DROPPED delta from S15 (cos=-0.1055 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] → sending delta(kind=head bytes=1808) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1808 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1808) from S17
[S9] cosine check vs S17: cos=0.9257
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.0000 head_norm=1.226719
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.903044e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.178078 delta_norm=0.290304
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.0000 head_norm=1.617436
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.209511e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.655723 delta_norm=0.120951
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.714906 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.785024517240598, 'psi': 0.26531826293872696}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.6889383189407994, 'psi': 0.2653978324081417}
[S3] START round=12 head_norm_before_train=1.530955 (no previous merge yet)
[S3] round=12 local utility u=0.001765 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.398265134462692, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4017943143432263, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.692300 (no previous merge yet)
[S4] round=12 local utility u=0.010294 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3287212000181188, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3493087739355725, 'psi': 0.3567939207526687}
[S5] START round=12 head_norm_before_train=1.409492 (no previous merge yet)
[S5] round=12 local utility u=0.022363 metrics={'f1_val': 0.9994369411582424, 'auprc': 0.9994369411582424, 'loss_val': 1.1302481085982343, 'psi': 0.9994369411582424}-{'f1_val': 0.9991554693142528, 'auprc': 0.9991554693142528, 'loss_val': 1.1724410276642325, 'psi': 0.9991554693142528}
[S6] START round=12 head_norm_before_train=1.685208 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.515278176986065, 'psi': 0.017551963048498844}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.333312022067963, 'psi': 0.01732902033271719}
[S7] START round=12 head_norm_before_train=1.351707 (no previous merge yet)
[S7] round=12 local utility u=0.417418 metrics={'f1_val': 0.08818788855629749, 'auprc': 0.08818788855629749, 'loss_val': 1.4212583216273211, 'psi': 0.08818788855629749}-{'f1_val': 0.0009305788200260562, 'auprc': 0.0009305788200260562, 'loss_val': 1.4707777424490547, 'psi': 0.0009305788200260562}
[S8] START round=12 head_norm_before_train=1.725075 (no previous merge yet)
[S8] round=12 local utility u=0.025385 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7133760393401962, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7641462274979085, 'psi': 0.35939447907390915}
[S9] START round=12 head_norm_before_train=1.178078 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.095977 metrics={'f1_val': 0.0002380952380952381, 'auprc': 0.0002380952380952381, 'loss_val': 1.6254187808537146, 'psi': 0.0002380952380952381}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8152297916376683, 'psi': 0.0}
[S10] START round=12 head_norm_before_train=1.701762 (no previous merge yet)
[S10] round=12 local utility u=0.042429 metrics={'f1_val': 0.33293508562325763, 'auprc': 0.33293508562325763, 'loss_val': 2.460444241977198, 'psi': 0.33293508562325763}-{'f1_val': 0.33293489521077374, 'auprc': 0.33293489521077374, 'loss_val': 2.5452998247804834, 'psi': 0.33293489521077374}
[S11] START round=12 head_norm_before_train=1.479451 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.067569295695361, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.523921622064343, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.578080 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3098939591305467, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2639035768639642, 'psi': 0.3599362944611573}
[S14] START round=12 head_norm_before_train=1.655723 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.365771724607885, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2498408764637006, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.639822 (no previous merge yet)
[S15] round=12 local utility u=0.212881 metrics={'f1_val': 0.6392456314912444, 'auprc': 0.6392456314912444, 'loss_val': 0.5586311534624193, 'psi': 0.6392456314912444}-{'f1_val': 0.5989108740498366, 'auprc': 0.5989108740498366, 'loss_val': 0.6213794754096786, 'psi': 0.5989108740498366}
[S16] START round=12 head_norm_before_train=1.499490 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.000186584569456106, 'auprc': 0.000186584569456106, 'loss_val': 3.250777525198114, 'psi': 0.000186584569456106}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.980895576184696, 'psi': 0.0}
[S17] START round=12 head_norm_before_train=1.638072 (no previous merge yet)
[S17] round=12 local utility u=0.041050 metrics={'f1_val': 0.15710884291408855, 'auprc': 0.15710884291408855, 'loss_val': 0.8767687375579352, 'psi': 0.15710884291408855}-{'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 0.9149476609984498, 'psi': 0.15222868217054264}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:40410
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:40417
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:40414
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.088)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S10] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=-0.0026
[S9] DROPPED delta from S5 (cos=-0.0026 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1806) from S4
[S9] cosine check vs S4: cos=0.5462
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9927
[S17] RECEIVED delta(kind=head bytes=1806) from S8
[S17] cosine check vs S8: cos=-0.1136
[S17] DROPPED delta from S8 (cos=-0.1136 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S15
[S16] cosine check vs S15: cos=-0.1031
[S16] DROPPED delta from S15 (cos=-0.1031 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=0.8390
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.0000 head_norm=1.678741
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.071613e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.704878 delta_norm=0.107161
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.0002 head_norm=1.204646
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.769404e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.0007 head_norm=1.200495 delta_norm=0.176940
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.744318 (no previous merge yet)
[S2] round=13 local utility u=0.002759 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.78022200440839, 'psi': 0.2653978324081417}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.785024517240598, 'psi': 0.26531826293872696}
[S3] START round=13 head_norm_before_train=1.562561 (no previous merge yet)
[S3] round=13 local utility u=0.358042 metrics={'f1_val': 0.06740104555638536, 'auprc': 0.06740104555638536, 'loss_val': 2.288790110931075, 'psi': 0.06740104555638536}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.398265134462692, 'psi': 0.0}
[S4] START round=13 head_norm_before_train=1.724258 (no previous merge yet)
[S4] round=13 local utility u=0.008734 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.311253989920874, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3287212000181188, 'psi': 0.3567939207526687}
[S5] START round=13 head_norm_before_train=1.438229 (no previous merge yet)
[S5] round=13 local utility u=0.023392 metrics={'f1_val': 0.9997184513402302, 'auprc': 0.9997184513402302, 'loss_val': 1.0859978103631434, 'psi': 0.9997184513402302}-{'f1_val': 0.9994369411582424, 'auprc': 0.9994369411582424, 'loss_val': 1.1302481085982343, 'psi': 0.9994369411582424}
[S6] START round=13 head_norm_before_train=1.709012 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.864238030744579, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.515278176986065, 'psi': 0.017551963048498844}
[S7] START round=13 head_norm_before_train=1.372310 (no previous merge yet)
[S7] round=13 local utility u=0.073095 metrics={'f1_val': 0.10175907370296147, 'auprc': 0.10175907370296147, 'loss_val': 1.3972096362993747, 'psi': 0.10175907370296147}-{'f1_val': 0.08818788855629749, 'auprc': 0.08818788855629749, 'loss_val': 1.4212583216273211, 'psi': 0.08818788855629749}
[S8] START round=13 head_norm_before_train=1.772303 (no previous merge yet)
[S8] round=13 local utility u=0.029729 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6539185114322287, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7133760393401962, 'psi': 0.35939447907390915}
[S9] START round=13 head_norm_before_train=1.200495 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7414505046559656, 'psi': 0.0}-{'f1_val': 0.0002380952380952381, 'auprc': 0.0002380952380952381, 'loss_val': 1.6254187808537146, 'psi': 0.0002380952380952381}
[S10] START round=13 head_norm_before_train=1.737244 (no previous merge yet)
[S10] round=13 local utility u=0.057191 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.346780384619868, 'psi': 0.33301496338745623}-{'f1_val': 0.33293508562325763, 'auprc': 0.33293508562325763, 'loss_val': 2.460444241977198, 'psi': 0.33293508562325763}
[S11] START round=13 head_norm_before_train=1.511448 (no previous merge yet)
[S11] round=13 local utility u=0.094951 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8776663516905607, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.067569295695361, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.607055 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3791417219196043, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3098939591305467, 'psi': 0.3599362944611573}
[S14] START round=13 head_norm_before_train=1.704878 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.471261347884526, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.365771724607885, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.687610 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6174450213799425, 'auprc': 0.6174450213799425, 'loss_val': 0.5099231978693933, 'psi': 0.6174450213799425}-{'f1_val': 0.6392456314912444, 'auprc': 0.6392456314912444, 'loss_val': 0.5586311534624193, 'psi': 0.6392456314912444}
[S16] START round=13 head_norm_before_train=1.526810 (no previous merge yet)
[S16] round=13 local utility u=0.428822 metrics={'f1_val': 0.07365062483382079, 'auprc': 0.07365062483382079, 'loss_val': 3.0543100690508243, 'psi': 0.07365062483382079}-{'f1_val': 0.000186584569456106, 'auprc': 0.000186584569456106, 'loss_val': 3.250777525198114, 'psi': 0.000186584569456106}
[S17] START round=13 head_norm_before_train=1.667330 (no previous merge yet)
[S17] round=13 local utility u=0.020324 metrics={'f1_val': 0.16192056216164738, 'auprc': 0.16192056216164738, 'loss_val': 0.8794269642986786, 'psi': 0.16192056216164738}-{'f1_val': 0.15710884291408855, 'auprc': 0.15710884291408855, 'loss_val': 0.8767687375579352, 'psi': 0.15710884291408855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:40414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.102)
[S3] not sending this round → trigger blocked (psi=0.067)
[S16] not sending this round → trigger blocked (psi=0.074)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:40409
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.0024
[S9] RECEIVED delta(kind=head bytes=1803) from S4
[S9] cosine check vs S4: cos=0.6309
[S14] RECEIVED delta(kind=head bytes=1805) from S10
[S14] cosine check vs S10: cos=0.9934
[S17] RECEIVED delta(kind=head bytes=1806) from S8
[S17] cosine check vs S8: cos=-0.1136
[S17] DROPPED delta from S8 (cos=-0.1136 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=0.0007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=0.7823
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.0000 head_norm=1.727318
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.043234e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.751406 delta_norm=0.104323
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.0000 head_norm=1.230671
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.538392e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.0062 head_norm=1.043797 delta_norm=0.353839
[S9] aggregate: ACCEPT kept=['S5', 'S4', 'S17'] (k=3/3) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.3594 head_norm=1.819005
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.268426e+00
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.3594 head_norm=1.269354 delta_norm=1.268426
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.769618 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.9030941380701822, 'psi': 0.26531826293872696}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.78022200440839, 'psi': 0.2653978324081417}
[S3] START round=14 head_norm_before_train=1.589050 (no previous merge yet)
[S3] round=14 local utility u=0.215150 metrics={'f1_val': 0.06465997770345597, 'auprc': 0.06465997770345597, 'loss_val': 1.8338212861772065, 'psi': 0.06465997770345597}-{'f1_val': 0.06740104555638536, 'auprc': 0.06740104555638536, 'loss_val': 2.288790110931075, 'psi': 0.06740104555638536}
[S4] START round=14 head_norm_before_train=1.755931 (no previous merge yet)
[S4] round=14 local utility u=0.008852 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2935504332745684, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.311253989920874, 'psi': 0.3567939207526687}
[S5] START round=14 head_norm_before_train=1.464334 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.6647858487513331, 'auprc': 0.6647858487513331, 'loss_val': 1.042511331661115, 'psi': 0.6647858487513331}-{'f1_val': 0.9997184513402302, 'auprc': 0.9997184513402302, 'loss_val': 1.0859978103631434, 'psi': 0.9997184513402302}
[S6] START round=14 head_norm_before_train=1.739091 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 5.971584058992355, 'psi': 0.018219557195571955}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.864238030744579, 'psi': 0.017551963048498844}
[S7] START round=14 head_norm_before_train=1.395723 (no previous merge yet)
[S7] round=14 local utility u=0.283638 metrics={'f1_val': 0.16036801132342535, 'auprc': 0.16036801132342535, 'loss_val': 1.357414512693739, 'psi': 0.16036801132342535}-{'f1_val': 0.10175907370296147, 'auprc': 0.10175907370296147, 'loss_val': 1.3972096362993747, 'psi': 0.10175907370296147}
[S8] START round=14 head_norm_before_train=1.269354 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7578610927094477, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6539185114322287, 'psi': 0.35939447907390915}
[S9] START round=14 head_norm_before_train=1.043797 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.079119 metrics={'f1_val': 0.006688285366842318, 'auprc': 0.006688285366842318, 'loss_val': 1.64340787453919, 'psi': 0.006688285366842319}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7414505046559656, 'psi': 0.0}
[S10] START round=14 head_norm_before_train=1.781287 (no previous merge yet)
[S10] round=14 local utility u=0.044682 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2574162950638685, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.346780384619868, 'psi': 0.33301496338745623}
[S11] START round=14 head_norm_before_train=1.539012 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.0006221807435059885, 'auprc': 0.0006221807435059885, 'loss_val': 2.9803269989087027, 'psi': 0.0006221807435059885}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8776663516905607, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.633619 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4189934377587283, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3791417219196043, 'psi': 0.3599362944611573}
[S14] START round=14 head_norm_before_train=1.751406 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5791339869863616, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.471261347884526, 'psi': 0.0}
[S15] START round=14 head_norm_before_train=1.741602 (no previous merge yet)
[S15] round=14 local utility u=0.063202 metrics={'f1_val': 0.6182738511474447, 'auprc': 0.6182738511474447, 'loss_val': 0.39097909343448656, 'psi': 0.6182738511474447}-{'f1_val': 0.6174450213799425, 'auprc': 0.6174450213799425, 'loss_val': 0.5099231978693933, 'psi': 0.6174450213799425}
[S16] START round=14 head_norm_before_train=1.551888 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.04385508753683481, 'auprc': 0.04385508753683481, 'loss_val': 3.56562625377538, 'psi': 0.04385508753683481}-{'f1_val': 0.07365062483382079, 'auprc': 0.07365062483382079, 'loss_val': 3.0543100690508243, 'psi': 0.07365062483382079}
[S17] START round=14 head_norm_before_train=1.695481 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.15482121982697888, 'auprc': 0.15482121982697888, 'loss_val': 0.9064634986064362, 'psi': 0.15482121982697888}-{'f1_val': 0.16192056216164738, 'auprc': 0.16192056216164738, 'loss_val': 0.8794269642986786, 'psi': 0.16192056216164738}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.007)
[S7] not sending this round → trigger blocked (psi=0.160)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[S3] not sending this round → trigger blocked (psi=0.065)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:40414
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S4
[S9] cosine check vs S4: cos=0.6172
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9934
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=-0.1036
[S16] DROPPED delta from S15 (cos=-0.1036 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.0067 head_norm=1.081301
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.024608e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.0054 head_norm=1.298062 delta_norm=0.702461
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.0000 head_norm=1.772887
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.089716e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.803563 delta_norm=0.108972
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.791213 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.9377138332893384, 'psi': 0.26531826293872696}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.9030941380701822, 'psi': 0.26531826293872696}
[S3] START round=15 head_norm_before_train=1.611316 (no previous merge yet)
[S3] round=15 local utility u=0.040477 metrics={'f1_val': 0.1119421906693712, 'auprc': 0.1119421906693712, 'loss_val': 2.1784078814400067, 'psi': 0.1119421906693712}-{'f1_val': 0.06465997770345597, 'auprc': 0.06465997770345597, 'loss_val': 1.8338212861772065, 'psi': 0.06465997770345597}
[S4] START round=15 head_norm_before_train=1.785391 (no previous merge yet)
[S4] round=15 local utility u=0.009297 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2749571052209627, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2935504332745684, 'psi': 0.3567939207526687}
[S5] START round=15 head_norm_before_train=1.490905 (no previous merge yet)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.4980903882877148, 'auprc': 0.4980903882877148, 'loss_val': 1.001878495489681, 'psi': 0.4980903882877148}-{'f1_val': 0.6647858487513331, 'auprc': 0.6647858487513331, 'loss_val': 1.042511331661115, 'psi': 0.6647858487513331}
[S6] START round=15 head_norm_before_train=1.761361 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 6.419768317978515, 'psi': 0.002619047619047619}-{'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 5.971584058992355, 'psi': 0.018219557195571955}
[S7] START round=15 head_norm_before_train=1.416039 (no previous merge yet)
[S7] round=15 local utility u=0.021891 metrics={'f1_val': 0.16545441187274998, 'auprc': 0.16545441187274998, 'loss_val': 1.3594105428063352, 'psi': 0.16545441187274998}-{'f1_val': 0.16036801132342535, 'auprc': 0.16036801132342535, 'loss_val': 1.357414512693739, 'psi': 0.16036801132342535}
[S8] START round=15 head_norm_before_train=1.352673 cos_to_last_merge=0.9955 (last merge round=13)
[S8] round=15 local utility u=0.043494 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6708727466213273, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7578610927094477, 'psi': 0.35939447907390915}
[S9] START round=15 head_norm_before_train=1.298062 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.053215 metrics={'f1_val': 0.004714364947310039, 'auprc': 0.004714364947310039, 'loss_val': 1.519212032816101, 'psi': 0.004714364947310039}-{'f1_val': 0.006688285366842318, 'auprc': 0.006688285366842318, 'loss_val': 1.64340787453919, 'psi': 0.006688285366842319}
[S10] START round=15 head_norm_before_train=1.840191 (no previous merge yet)
[S10] round=15 local utility u=0.015847 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.225722482038284, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2574162950638685, 'psi': 0.33301496338745623}
[S11] START round=15 head_norm_before_train=1.564479 (no previous merge yet)
[S11] round=15 local utility u=1.000000 metrics={'f1_val': 0.24531212912413958, 'auprc': 0.24531212912413958, 'loss_val': 3.1766746288784105, 'psi': 0.24531212912413958}-{'f1_val': 0.0006221807435059885, 'auprc': 0.0006221807435059885, 'loss_val': 2.9803269989087027, 'psi': 0.0006221807435059885}
[S13] START round=15 head_norm_before_train=1.661065 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4358805578630471, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4189934377587283, 'psi': 0.3599362944611573}
[S14] START round=15 head_norm_before_train=1.803563 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.700377067078415, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5791339869863616, 'psi': 0.0}
[S15] START round=15 head_norm_before_train=1.794788 (no previous merge yet)
[S15] round=15 local utility u=0.234728 metrics={'f1_val': 0.6582523517478917, 'auprc': 0.6582523517478917, 'loss_val': 0.28132967223972005, 'psi': 0.6582523517478917}-{'f1_val': 0.6182738511474447, 'auprc': 0.6182738511474447, 'loss_val': 0.39097909343448656, 'psi': 0.6182738511474447}
[S16] START round=15 head_norm_before_train=1.576245 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.05852998392962869, 'auprc': 0.05852998392962869, 'loss_val': 3.725999744967874, 'psi': 0.05852998392962869}-{'f1_val': 0.04385508753683481, 'auprc': 0.04385508753683481, 'loss_val': 3.56562625377538, 'psi': 0.04385508753683481}
[S17] START round=15 head_norm_before_train=1.725021 (no previous merge yet)
[S17] round=15 local utility u=0.225860 metrics={'f1_val': 0.20366741048413925, 'auprc': 0.20366741048413925, 'loss_val': 0.8943584361021302, 'psi': 0.20366741048413925}-{'f1_val': 0.15482121982697888, 'auprc': 0.15482121982697888, 'loss_val': 0.9064634986064362, 'psi': 0.15482121982697888}
[S9] not sending this round → trigger blocked (psi=0.005)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:40410
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:40414
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:40417
[S3] not sending this round → trigger blocked (psi=0.112)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.165)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=-0.1031
[S16] DROPPED delta from S15 (cos=-0.1031 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=-0.0367
[S17] DROPPED delta from S8 (cos=-0.0367 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1807) from S4
[S9] cosine check vs S4: cos=0.9303
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=-0.0713
[S14] DROPPED delta from S11 (cos=-0.0713 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S10
[S14] cosine check vs S10: cos=0.9944
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.3578
[S6] ⇄ pheromone p=0.067 → S11@127.0.0.1:40412
[S7] ⇄ pheromone p=0.154 → S10@127.0.0.1:40411
[S5] ⇄ pheromone p=0.247 → S9@127.0.0.1:40410
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.0000 head_norm=1.825860
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.040689e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.857033 delta_norm=0.104069
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.063 → S4@127.0.0.1:40404
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.0047 head_norm=1.325247
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.919543e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.1585 head_norm=1.272037 delta_norm=0.291954
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.096 → S13@127.0.0.1:40413
[S2] ⇄ pheromone p=0.094 → S8@127.0.0.1:40409
[S13] ⇄ pheromone p=0.104 → S16@127.0.0.1:40416
[S3] ⇄ pheromone p=0.149 → S4@127.0.0.1:40404
[S4] ⇄ pheromone p=0.161 → S9@127.0.0.1:40410
[S11] ⇄ pheromone p=0.263 → S14@127.0.0.1:40414
[S15] ⇄ pheromone p=0.267 → S16@127.0.0.1:40416
[S8] ⇄ pheromone p=0.179 → S17@127.0.0.1:40417
[S10] ⇄ pheromone p=0.107 → S14@127.0.0.1:40414
[S16] ⇄ pheromone p=0.096 → S8@127.0.0.1:40409
[S17] ⇄ pheromone p=0.115 → S9@127.0.0.1:40410
[S2] START round=16 head_norm_before_train=1.809257 (no previous merge yet)
[S2] round=16 local utility u=0.038258 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.679409095748404, 'psi': 0.245119570522206}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 2.9377138332893384, 'psi': 0.26531826293872696}
[S3] START round=16 head_norm_before_train=1.633701 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.10887792848335388, 'auprc': 0.10887792848335388, 'loss_val': 2.2162958013601908, 'psi': 0.10887792848335388}-{'f1_val': 0.1119421906693712, 'auprc': 0.1119421906693712, 'loss_val': 2.1784078814400067, 'psi': 0.1119421906693712}
[S4] START round=16 head_norm_before_train=1.813671 (no previous merge yet)
[S4] round=16 local utility u=0.009565 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.255827613795537, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2749571052209627, 'psi': 0.3567939207526687}
[S5] START round=16 head_norm_before_train=1.516803 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.49318624269954575, 'auprc': 0.49318624269954575, 'loss_val': 0.9754107097353757, 'psi': 0.49318624269954575}-{'f1_val': 0.4980903882877148, 'auprc': 0.4980903882877148, 'loss_val': 1.001878495489681, 'psi': 0.4980903882877148}
[S6] START round=16 head_norm_before_train=1.779519 (no previous merge yet)
[S6] round=16 local utility u=0.159543 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.274822026237215, 'psi': 0.021967963386727688}-{'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 6.419768317978515, 'psi': 0.002619047619047619}
[S7] START round=16 head_norm_before_train=1.435351 (no previous merge yet)
[S7] round=16 local utility u=0.139230 metrics={'f1_val': 0.1931150293870697, 'auprc': 0.1931150293870697, 'loss_val': 1.3298964845681869, 'psi': 0.1931150293870697}-{'f1_val': 0.16545441187274998, 'auprc': 0.16545441187274998, 'loss_val': 1.3594105428063352, 'psi': 0.16545441187274998}
[S8] START round=16 head_norm_before_train=1.449915 cos_to_last_merge=0.9849 (last merge round=13)
[S8] round=16 local utility u=0.017486 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6359014735751581, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6708727466213273, 'psi': 0.35939447907390915}
[S9] START round=16 head_norm_before_train=1.272037 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.736033 metrics={'f1_val': 0.17430182968771493, 'auprc': 0.17430182968771493, 'loss_val': 1.573433552671236, 'psi': 0.17430182968771493}-{'f1_val': 0.004714364947310039, 'auprc': 0.004714364947310039, 'loss_val': 1.519212032816101, 'psi': 0.004714364947310039}
[S10] START round=16 head_norm_before_train=1.893420 (no previous merge yet)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2407508128367244, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.225722482038284, 'psi': 0.33301496338745623}
[S11] START round=16 head_norm_before_train=1.587727 (no previous merge yet)
[S11] round=16 local utility u=0.467934 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.020422401531721, 'psi': 0.3319360347772085}-{'f1_val': 0.24531212912413958, 'auprc': 0.24531212912413958, 'loss_val': 3.1766746288784105, 'psi': 0.24531212912413958}
[S13] START round=16 head_norm_before_train=1.677427 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.470543882650611, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4358805578630471, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.857033 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.178491 metrics={'f1_val': 0.046655304644226674, 'auprc': 0.046655304644226674, 'loss_val': 3.7632928677970914, 'psi': 0.046655304644226674}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.700377067078415, 'psi': 0.0}
[S15] START round=16 head_norm_before_train=1.845264 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6415693956476863, 'auprc': 0.6415693956476863, 'loss_val': 0.2359949311877797, 'psi': 0.6415693956476863}-{'f1_val': 0.6582523517478917, 'auprc': 0.6582523517478917, 'loss_val': 0.28132967223972005, 'psi': 0.6582523517478917}
[S16] START round=16 head_norm_before_train=1.602039 (no previous merge yet)
[S16] round=16 local utility u=0.210688 metrics={'f1_val': 0.0896264229597563, 'auprc': 0.0896264229597563, 'loss_val': 3.584492187519452, 'psi': 0.0896264229597563}-{'f1_val': 0.05852998392962869, 'auprc': 0.05852998392962869, 'loss_val': 3.725999744967874, 'psi': 0.05852998392962869}
[S17] START round=16 head_norm_before_train=1.749605 (no previous merge yet)
[S17] round=16 local utility u=0.249293 metrics={'f1_val': 0.2506743525795499, 'auprc': 0.2506743525795499, 'loss_val': 0.8188351566051293, 'psi': 0.2506743525795499}-{'f1_val': 0.20366741048413925, 'auprc': 0.20366741048413925, 'loss_val': 0.8943584361021302, 'psi': 0.20366741048413925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:40409
[S6] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[S9] not sending this round → trigger blocked (psi=0.174)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:40417
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.047)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.193)
[S16] not sending this round → trigger blocked (psi=0.090)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S4
[S9] cosine check vs S4: cos=0.8378
[S14] RECEIVED delta(kind=head bytes=1804) from S11
[S14] cosine check vs S11: cos=-0.0703
[S14] DROPPED delta from S11 (cos=-0.0703 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=0.5931
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=-0.0405
[S17] DROPPED delta from S8 (cos=-0.0405 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.5567
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.1743 head_norm=1.310796
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.572849e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.2443 head_norm=1.296631 delta_norm=0.157285
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.3594 head_norm=1.504282
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.647010e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.3594 head_norm=1.487973 delta_norm=0.764701
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.826143 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.26110777042827554, 'auprc': 0.26110777042827554, 'loss_val': 3.0650460478028894, 'psi': 0.26110777042827554}-{'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.679409095748404, 'psi': 0.245119570522206}
[S3] START round=17 head_norm_before_train=1.656187 (no previous merge yet)
[S3] round=17 local utility u=1.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.7539532285820103, 'psi': 0.3641628959276018}-{'f1_val': 0.10887792848335388, 'auprc': 0.10887792848335388, 'loss_val': 2.2162958013601908, 'psi': 0.10887792848335388}
[S4] START round=17 head_norm_before_train=1.844145 (no previous merge yet)
[S4] round=17 local utility u=0.008602 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2386237160044655, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.255827613795537, 'psi': 0.3567939207526687}
[S5] START round=17 head_norm_before_train=1.542650 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.3875297703944181, 'auprc': 0.3875297703944181, 'loss_val': 0.9446275916196075, 'psi': 0.3875297703944181}-{'f1_val': 0.49318624269954575, 'auprc': 0.49318624269954575, 'loss_val': 0.9754107097353757, 'psi': 0.49318624269954575}
[S6] START round=17 head_norm_before_train=1.795096 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 6.428530148421318, 'psi': 0.01910681399631676}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.274822026237215, 'psi': 0.021967963386727688}
[S7] START round=17 head_norm_before_train=1.456020 (no previous merge yet)
[S7] round=17 local utility u=0.761779 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3061766730958084, 'psi': 0.35976373724718097}-{'f1_val': 0.1931150293870697, 'auprc': 0.1931150293870697, 'loss_val': 1.3298964845681869, 'psi': 0.1931150293870697}
[S8] START round=17 head_norm_before_train=1.487973 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7091432225968185, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6359014735751581, 'psi': 0.35939447907390915}
[S9] START round=17 head_norm_before_train=1.296631 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.919291 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4841808918382018, 'psi': 0.36867172340800847}-{'f1_val': 0.17430182968771493, 'auprc': 0.17430182968771493, 'loss_val': 1.573433552671236, 'psi': 0.17430182968771493}
[S10] START round=17 head_norm_before_train=1.938269 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.288217368823491, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2407508128367244, 'psi': 0.33301496338745623}
[S11] START round=17 head_norm_before_train=1.609463 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.1687722304254993, 'psi': 0.3320907114010562}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.020422401531721, 'psi': 0.3319360347772085}
[S13] START round=17 head_norm_before_train=1.691300 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5072865733957121, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.470543882650611, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=1.877867 cos_to_last_merge=0.9995 (last merge round=15)
[S14] round=17 local utility u=0.064559 metrics={'f1_val': 0.08309337721102426, 'auprc': 0.08309337721102426, 'loss_val': 3.9621168611392004, 'psi': 0.08309337721102426}-{'f1_val': 0.046655304644226674, 'auprc': 0.046655304644226674, 'loss_val': 3.7632928677970914, 'psi': 0.046655304644226674}
[S15] START round=17 head_norm_before_train=1.892038 (no previous merge yet)
[S15] round=17 local utility u=0.093829 metrics={'f1_val': 0.6561406963819546, 'auprc': 0.6561406963819546, 'loss_val': 0.17947801051985665, 'psi': 0.6561406963819546}-{'f1_val': 0.6415693956476863, 'auprc': 0.6415693956476863, 'loss_val': 0.2359949311877797, 'psi': 0.6415693956476863}
[S16] START round=17 head_norm_before_train=1.628164 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.04530912235192391, 'auprc': 0.04530912235192391, 'loss_val': 4.176526993264297, 'psi': 0.04530912235192391}-{'f1_val': 0.0896264229597563, 'auprc': 0.0896264229597563, 'loss_val': 3.584492187519452, 'psi': 0.0896264229597563}
[S17] START round=17 head_norm_before_train=1.764658 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.18363429703448036, 'auprc': 0.18363429703448036, 'loss_val': 0.8284638905520326, 'psi': 0.18363429703448036}-{'f1_val': 0.2506743525795499, 'auprc': 0.2506743525795499, 'loss_val': 0.8188351566051293, 'psi': 0.2506743525795499}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:40413
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.083)
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1794) from S7
[S10] cosine check vs S7: cos=0.0043
[S9] RECEIVED delta(kind=head bytes=1800) from S4
[S9] cosine check vs S4: cos=0.7791
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=-0.1009
[S16] DROPPED delta from S15 (cos=-0.1009 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S9
[S13] cosine check vs S9: cos=0.0049
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=-0.1080
[S4] DROPPED delta from S3 (cos=-0.1080 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.3330 head_norm=1.976201
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.229715e+00
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.3322 head_norm=1.234812 delta_norm=1.229715
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.3599 head_norm=1.707027
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.082989e+00
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.3599 head_norm=1.088182 delta_norm=1.082989
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.3687 head_norm=1.341667
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.907035e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.3687 head_norm=1.519408 delta_norm=0.590703
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.838642 (no previous merge yet)
[S2] round=18 local utility u=0.033569 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 3.0358032944102615, 'psi': 0.26531826293872696}-{'f1_val': 0.26110777042827554, 'auprc': 0.26110777042827554, 'loss_val': 3.0650460478028894, 'psi': 0.26110777042827554}
[S3] START round=18 head_norm_before_train=1.679729 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.19013419013419014, 'auprc': 0.19013419013419014, 'loss_val': 2.090477651698377, 'psi': 0.19013419013419014}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.7539532285820103, 'psi': 0.3641628959276018}
[S4] START round=18 head_norm_before_train=1.874832 (no previous merge yet)
[S4] round=18 local utility u=0.003766 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.231092073677028, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2386237160044655, 'psi': 0.3567939207526687}
[S5] START round=18 head_norm_before_train=1.569455 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.3950483581887678, 'psi': 0.33451196111837667}-{'f1_val': 0.3875297703944181, 'auprc': 0.3875297703944181, 'loss_val': 0.9446275916196075, 'psi': 0.3875297703944181}
[S6] START round=18 head_norm_before_train=1.809834 (no previous merge yet)
[S6] round=18 local utility u=0.096720 metrics={'f1_val': 0.026733121884911646, 'auprc': 0.026733121884911646, 'loss_val': 6.303726370918939, 'psi': 0.026733121884911643}-{'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 6.428530148421318, 'psi': 0.01910681399631676}
[S7] START round=18 head_norm_before_train=1.472600 (no previous merge yet)
[S7] round=18 local utility u=0.013242 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.279692257091711, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3061766730958084, 'psi': 0.35976373724718097}
[S8] START round=18 head_norm_before_train=1.542127 cos_to_last_merge=0.9971 (last merge round=16)
[S8] round=18 local utility u=0.038555 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6320324306695473, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7091432225968185, 'psi': 0.35939447907390915}
[S9] START round=18 head_norm_before_train=1.519408 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000886 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4824092079870415, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4841808918382018, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.234812 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.333161 metrics={'f1_val': 0.33222169286962044, 'auprc': 0.33222169286962044, 'loss_val': 1.6147557950737872, 'psi': 0.33222169286962044}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.288217368823491, 'psi': 0.33301496338745623}
[S11] START round=18 head_norm_before_train=1.632365 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.206381296385181, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.1687722304254993, 'psi': 0.3320907114010562}
[S13] START round=18 head_norm_before_train=1.088182 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.100329 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3066281931015082, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5072865733957121, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.897405 cos_to_last_merge=0.9984 (last merge round=15)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.009572332870155936, 'auprc': 0.009572332870155936, 'loss_val': 4.195722895458643, 'psi': 0.009572332870155936}-{'f1_val': 0.08309337721102426, 'auprc': 0.08309337721102426, 'loss_val': 3.9621168611392004, 'psi': 0.08309337721102426}
[S15] START round=18 head_norm_before_train=1.936425 (no previous merge yet)
[S15] round=18 local utility u=0.059856 metrics={'f1_val': 0.6647535513177775, 'auprc': 0.6647535513177775, 'loss_val': 0.13728265790883598, 'psi': 0.6647535513177775}-{'f1_val': 0.6561406963819546, 'auprc': 0.6561406963819546, 'loss_val': 0.17947801051985665, 'psi': 0.6561406963819546}
[S16] START round=18 head_norm_before_train=1.652448 (no previous merge yet)
[S16] round=18 local utility u=0.422208 metrics={'f1_val': 0.07767106842737095, 'auprc': 0.07767106842737095, 'loss_val': 3.6233691716508174, 'psi': 0.07767106842737095}-{'f1_val': 0.04530912235192391, 'auprc': 0.04530912235192391, 'loss_val': 4.176526993264297, 'psi': 0.04530912235192391}
[S17] START round=18 head_norm_before_train=1.781847 (no previous merge yet)
[S17] round=18 local utility u=0.232409 metrics={'f1_val': 0.23515023769392862, 'auprc': 0.23515023769392862, 'loss_val': 0.8272886900560273, 'psi': 0.23515023769392862}-{'f1_val': 0.18363429703448036, 'auprc': 0.18363429703448036, 'loss_val': 0.8284638905520326, 'psi': 0.18363429703448036}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:40409
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:40417
[S6] not sending this round → trigger blocked (psi=0.027)
[S16] not sending this round → trigger blocked (psi=0.078)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=0.5557
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] cosine check vs S4: cos=0.9517
[S14] RECEIVED delta(kind=head bytes=1805) from S10
[S14] cosine check vs S10: cos=0.8187
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=0.8491
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.0143
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=-0.0433
[S16] DROPPED delta from S13 (cos=-0.0433 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=-0.0994
[S16] DROPPED delta from S15 (cos=-0.0994 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] cosine check vs S9: cos=0.5623
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S17
[S9] cosine check vs S17: cos=0.3235
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.0096 head_norm=1.916525
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.630137e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.0028 head_norm=1.550848 delta_norm=0.563014
[S14] aggregate: ROLLBACK (f1_val pre=0.010 post=0.003 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.3322 head_norm=1.330850
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.682957e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.2939 head_norm=1.244164 delta_norm=0.668296
[S10] aggregate: ROLLBACK (f1_val pre=0.332 post=0.294 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.3687 head_norm=1.556622
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.477709e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.3687 head_norm=1.409647 delta_norm=0.347771
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.3599 head_norm=1.146578
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.577293e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.3599 head_norm=1.198436 delta_norm=0.657729
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.3594 head_norm=1.620924
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.894080e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.3594 head_norm=1.669471 delta_norm=0.489408
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.2352 head_norm=1.803017
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.203636e+00
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.2036 head_norm=1.220816 delta_norm=1.203636
[S17] aggregate: ROLLBACK (f1_val pre=0.235 post=0.204 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.850922 (no previous merge yet)
[S2] round=19 local utility u=0.067285 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.902191229061146, 'psi': 0.26542475888492534}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 3.0358032944102615, 'psi': 0.26531826293872696}
[S3] START round=19 head_norm_before_train=1.706409 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.19541569541569542, 'auprc': 0.19541569541569542, 'loss_val': 2.5255470128243775, 'psi': 0.19541569541569542}-{'f1_val': 0.19013419013419014, 'auprc': 0.19013419013419014, 'loss_val': 2.090477651698377, 'psi': 0.19013419013419014}
[S4] START round=19 head_norm_before_train=1.906427 (no previous merge yet)
[S4] round=19 local utility u=0.004721 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.221650085221829, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.231092073677028, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.595461 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.4475877170345095, 'psi': 0.33400978131092857}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.3950483581887678, 'psi': 0.33451196111837667}
[S6] START round=19 head_norm_before_train=1.824987 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.964759468591205, 'psi': 0.017105871474803514}-{'f1_val': 0.026733121884911646, 'auprc': 0.026733121884911646, 'loss_val': 6.303726370918939, 'psi': 0.026733121884911643}
[S7] START round=19 head_norm_before_train=1.489284 (no previous merge yet)
[S7] round=19 local utility u=0.019082 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2415272727104616, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.279692257091711, 'psi': 0.35976373724718097}
[S8] START round=19 head_norm_before_train=1.669471 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.010463 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6111071995264286, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6320324306695473, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.409647 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5227985642757162, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4824092079870415, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.244164 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.313267445342917, 'auprc': 0.313267445342917, 'loss_val': 1.530835865148722, 'psi': 0.313267445342917}-{'f1_val': 0.33222169286962044, 'auprc': 0.33222169286962044, 'loss_val': 1.6147557950737872, 'psi': 0.33222169286962044}
[S11] START round=19 head_norm_before_train=1.653744 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.2277827515636393, 'psi': 0.3320133550741517}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.206381296385181, 'psi': 0.3320907114010562}
[S13] START round=19 head_norm_before_train=1.198436 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.010420 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.285788374003293, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3066281931015082, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.550848 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.618960 metrics={'f1_val': 0.06528189910979228, 'auprc': 0.06528189910979228, 'loss_val': 3.4591881293682745, 'psi': 0.06528189910979228}-{'f1_val': 0.009572332870155936, 'auprc': 0.009572332870155936, 'loss_val': 4.195722895458643, 'psi': 0.009572332870155936}
[S15] START round=19 head_norm_before_train=1.969080 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6458911369572516, 'auprc': 0.6458911369572516, 'loss_val': 0.1404830938759998, 'psi': 0.6458911369572516}-{'f1_val': 0.6647535513177775, 'auprc': 0.6647535513177775, 'loss_val': 0.13728265790883598, 'psi': 0.6647535513177775}
[S16] START round=19 head_norm_before_train=1.675334 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.0889745442865173, 'auprc': 0.0889745442865173, 'loss_val': 4.211482274145593, 'psi': 0.0889745442865173}-{'f1_val': 0.07767106842737095, 'auprc': 0.07767106842737095, 'loss_val': 3.6233691716508174, 'psi': 0.07767106842737095}
[S17] START round=19 head_norm_before_train=1.220816 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.013211 metrics={'f1_val': 0.25207486557991615, 'auprc': 0.25207486557991615, 'loss_val': 0.9531886893711566, 'psi': 0.25207486557991615}-{'f1_val': 0.23515023769392862, 'auprc': 0.23515023769392862, 'loss_val': 0.8272886900560273, 'psi': 0.23515023769392862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:40411
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:40417
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:40410
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.065)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:40416
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:40409
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=0.8157
[S9] RECEIVED delta(kind=head bytes=1793) from S4
[S9] cosine check vs S4: cos=0.8674
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=0.9394
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.6540
[S16] RECEIVED delta(kind=head bytes=1789) from S13
[S16] cosine check vs S13: cos=-0.0494
[S16] DROPPED delta from S13 (cos=-0.0494 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.3522
[S5] r=20 psi=0.334 u=0.0000 p_local=0.1013 f1=0.334 auprc=0.334 bytes=8982
[S3] r=20 psi=0.195 u=0.0000 p_local=0.1888 f1=0.195 auprc=0.195 bytes=1802
[S15] r=20 psi=0.646 u=0.0000 p_local=0.1309 f1=0.646 auprc=0.646 bytes=14390
[S11] r=20 psi=0.332 u=0.0000 p_local=0.1556 f1=0.332 auprc=0.332 bytes=3603
[S14] r=20 psi=0.065 u=0.6190 p_local=0.1761 f1=0.065 auprc=0.065 bytes=0
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.3687 head_norm=1.451918
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.955844e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.3687 head_norm=1.276823 delta_norm=0.295584
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] r=20 psi=0.369 u=0.0000 p_local=0.2326 f1=0.369 auprc=0.369 bytes=3601
[S6] r=20 psi=0.017 u=0.0000 p_local=0.0592 f1=0.017 auprc=0.017 bytes=0
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.3133 head_norm=1.359234
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.420826e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.2517 head_norm=1.368558 delta_norm=0.442083
[S10] aggregate: ROLLBACK (f1_val pre=0.313 post=0.252 tol_abs=0.005 tol_rel=0.0)
[S10] r=20 psi=0.313 u=0.0000 p_local=0.0969 f1=0.313 auprc=0.313 bytes=19789
[S16] r=20 psi=0.089 u=0.0000 p_local=0.1282 f1=0.089 auprc=0.089 bytes=0
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.3594 head_norm=1.740034
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.195459e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.3594 head_norm=1.774743 delta_norm=0.319546
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.359 u=0.0105 p_local=0.0833 f1=0.359 auprc=0.359 bytes=21609
[S4] r=20 psi=0.357 u=0.0047 p_local=0.0697 f1=0.357 auprc=0.357 bytes=18018
[S2] r=20 psi=0.265 u=0.0673 p_local=0.0611 f1=0.265 auprc=0.265 bytes=14397
[S13] r=20 psi=0.360 u=0.0104 p_local=0.0606 f1=0.360 auprc=0.360 bytes=7186
[S7] r=20 psi=0.360 u=0.0191 p_local=0.1808 f1=0.360 auprc=0.360 bytes=5393
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.2521 head_norm=1.271717
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.615911e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.2031 head_norm=1.372876 delta_norm=0.661591
[S17] aggregate: ROLLBACK (f1_val pre=0.252 post=0.203 tol_abs=0.005 tol_rel=0.0)
[S17] r=20 psi=0.252 u=0.0132 p_local=0.1124 f1=0.252 auprc=0.252 bytes=21637
[S2] START round=20 head_norm_before_train=1.864383 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.18758402530644525, 'auprc': 0.18758402530644525, 'loss_val': 4.019569268575191, 'psi': 0.18758402530644525}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.902191229061146, 'psi': 0.26542475888492534}
[S3] START round=20 head_norm_before_train=1.732165 (no previous merge yet)
[S3] round=20 local utility u=0.259010 metrics={'f1_val': 0.2602004526349822, 'auprc': 0.2602004526349822, 'loss_val': 2.5905896424341446, 'psi': 0.2602004526349822}-{'f1_val': 0.19541569541569542, 'auprc': 0.19541569541569542, 'loss_val': 2.5255470128243775, 'psi': 0.19541569541569542}
[S4] START round=20 head_norm_before_train=1.933868 (no previous merge yet)
[S4] round=20 local utility u=0.002403 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2168434804606842, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.221650085221829, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.622228 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.4578981111554272, 'psi': 0.2501920777223545}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.4475877170345095, 'psi': 0.33400978131092857}
[S6] START round=20 head_norm_before_train=1.840249 (no previous merge yet)
[S6] round=20 local utility u=0.028835 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.913108261126724, 'psi': 0.017774699907663897}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 6.964759468591205, 'psi': 0.017105871474803514}
[S7] START round=20 head_norm_before_train=1.513030 (no previous merge yet)
[S7] round=20 local utility u=0.015735 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2100563900807406, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2415272727104616, 'psi': 0.35976373724718097}
[S8] START round=20 head_norm_before_train=1.774743 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.007072 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5969640872298929, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6111071995264286, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.276823 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.025949 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4709012046281964, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5227985642757162, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.368558 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.3018759018759019, 'auprc': 0.3018759018759019, 'loss_val': 1.5368620851297423, 'psi': 0.3018759018759019}-{'f1_val': 0.313267445342917, 'auprc': 0.313267445342917, 'loss_val': 1.530835865148722, 'psi': 0.313267445342917}
[S11] START round=20 head_norm_before_train=1.672400 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.3322450248756219, 'auprc': 0.3322450248756219, 'loss_val': 3.287350112292981, 'psi': 0.3322450248756219}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.2277827515636393, 'psi': 0.3320133550741517}
[S13] START round=20 head_norm_before_train=1.254759 cos_to_last_merge=0.9896 (last merge round=18)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2885932022191284, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.285788374003293, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.573749 cos_to_last_merge=0.9995 (last merge round=18)
[S14] round=20 local utility u=0.006925 metrics={'f1_val': 0.08405201916495551, 'auprc': 0.08405201916495551, 'loss_val': 3.614269302413397, 'psi': 0.08405201916495551}-{'f1_val': 0.06528189910979228, 'auprc': 0.06528189910979228, 'loss_val': 3.4591881293682745, 'psi': 0.06528189910979228}
[S15] START round=20 head_norm_before_train=1.995464 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6402277242732656, 'auprc': 0.6402277242732656, 'loss_val': 0.14829228980209128, 'psi': 0.6402277242732656}-{'f1_val': 0.6458911369572516, 'auprc': 0.6458911369572516, 'loss_val': 0.1404830938759998, 'psi': 0.6458911369572516}
[S16] START round=20 head_norm_before_train=1.695771 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.06823098685305375, 'auprc': 0.06823098685305375, 'loss_val': 4.478796068259047, 'psi': 0.06823098685305375}-{'f1_val': 0.0889745442865173, 'auprc': 0.0889745442865173, 'loss_val': 4.211482274145593, 'psi': 0.0889745442865173}
[S17] START round=20 head_norm_before_train=1.372876 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.17952633030613377, 'auprc': 0.17952633030613377, 'loss_val': 1.1059543595810475, 'psi': 0.17952633030613377}-{'f1_val': 0.25207486557991615, 'auprc': 0.25207486557991615, 'loss_val': 0.9531886893711566, 'psi': 0.25207486557991615}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:40417
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:40411
[S14] not sending this round → trigger blocked (psi=0.084)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:40413
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=0.8915
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.8920
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=0.8618
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] cosine check vs S9: cos=0.8016
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=-0.1101
[S4] DROPPED delta from S3 (cos=-0.1101 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.3019 head_norm=1.470272
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.519537e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.2419 head_norm=1.463199 delta_norm=0.351954
[S10] aggregate: ROLLBACK (f1_val pre=0.302 post=0.242 tol_abs=0.005 tol_rel=0.0)
[S10] ⇄ pheromone p=0.078 → S14@127.0.0.1:40414
[S6] ⇄ pheromone p=0.053 → S11@127.0.0.1:40412
[S2] ⇄ pheromone p=0.049 → S8@127.0.0.1:40409
[S5] ⇄ pheromone p=0.081 → S9@127.0.0.1:40410
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.3599 head_norm=1.322553
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.159144e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.3599 head_norm=1.253217 delta_norm=0.415914
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.048 → S16@127.0.0.1:40416
[S11] ⇄ pheromone p=0.125 → S14@127.0.0.1:40414
[S15] ⇄ pheromone p=0.105 → S16@127.0.0.1:40416
[S14] ⇄ pheromone p=0.142 → S4@127.0.0.1:40404
[S16] ⇄ pheromone p=0.103 → S8@127.0.0.1:40409
[S3] ⇄ pheromone p=0.203 → S4@127.0.0.1:40404
[S8] ⇄ pheromone p=0.068 → S17@127.0.0.1:40417
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.3687 head_norm=1.318304
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.282419e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.3687 head_norm=1.580760 delta_norm=0.528242
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.191 → S13@127.0.0.1:40413
[S7] ⇄ pheromone p=0.148 → S10@127.0.0.1:40411
[S4] ⇄ pheromone p=0.056 → S9@127.0.0.1:40410
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.1795 head_norm=1.446300
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.279830e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.1550 head_norm=1.600069 delta_norm=0.427983
[S17] aggregate: ROLLBACK (f1_val pre=0.180 post=0.155 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.090 → S9@127.0.0.1:40410
[S2] START round=21 head_norm_before_train=1.874438 (no previous merge yet)
[S2] round=21 local utility u=0.932147 metrics={'f1_val': 0.2617419060647515, 'auprc': 0.2617419060647515, 'loss_val': 2.822696058080667, 'psi': 0.2617419060647515}-{'f1_val': 0.18758402530644525, 'auprc': 0.18758402530644525, 'loss_val': 4.019569268575191, 'psi': 0.18758402530644525}
[S3] START round=21 head_norm_before_train=1.756906 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.19353597537514428, 'auprc': 0.19353597537514428, 'loss_val': 2.5471888610819273, 'psi': 0.19353597537514428}-{'f1_val': 0.2602004526349822, 'auprc': 0.2602004526349822, 'loss_val': 2.5905896424341446, 'psi': 0.2602004526349822}
[S4] START round=21 head_norm_before_train=1.953908 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2178067694764072, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2168434804606842, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.647205 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.485138500259064, 'psi': 0.2501920777223545}-{'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.4578981111554272, 'psi': 0.2501920777223545}
[S6] START round=21 head_norm_before_train=1.855715 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 6.9585088986018055, 'psi': 0.018219557195571955}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.913108261126724, 'psi': 0.017774699907663897}
[S7] START round=21 head_norm_before_train=1.538813 (no previous merge yet)
[S7] round=21 local utility u=0.024525 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1610070377392234, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2100563900807406, 'psi': 0.35976373724718097}
[S8] START round=21 head_norm_before_train=1.842552 cos_to_last_merge=0.9942 (last merge round=19)
[S8] round=21 local utility u=0.019659 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5576466013730487, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5969640872298929, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.580760 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.034787 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4013281381101408, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4709012046281964, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.463199 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.27070393374741203, 'auprc': 0.27070393374741203, 'loss_val': 1.5954785993776404, 'psi': 0.27070393374741203}-{'f1_val': 0.3018759018759019, 'auprc': 0.3018759018759019, 'loss_val': 1.5368620851297423, 'psi': 0.3018759018759019}
[S11] START round=21 head_norm_before_train=1.689574 (no previous merge yet)
[S11] round=21 local utility u=0.008762 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.267740790418262, 'psi': 0.3320133550741517}-{'f1_val': 0.3322450248756219, 'auprc': 0.3322450248756219, 'loss_val': 3.287350112292981, 'psi': 0.3322450248756219}
[S13] START round=21 head_norm_before_train=1.253217 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.027597 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2333995663572346, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2885932022191284, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.605744 cos_to_last_merge=0.9976 (last merge round=18)
[S14] round=21 local utility u=0.163744 metrics={'f1_val': 0.1309164149043303, 'auprc': 0.1309164149043303, 'loss_val': 3.708560243392493, 'psi': 0.1309164149043303}-{'f1_val': 0.08405201916495551, 'auprc': 0.08405201916495551, 'loss_val': 3.614269302413397, 'psi': 0.08405201916495551}
[S15] START round=21 head_norm_before_train=2.019433 (no previous merge yet)
[S15] round=21 local utility u=1.000000 metrics={'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.09601210567140471, 'psi': 0.9988780126706549}-{'f1_val': 0.6402277242732656, 'auprc': 0.6402277242732656, 'loss_val': 0.14829228980209128, 'psi': 0.6402277242732656}
[S16] START round=21 head_norm_before_train=1.713997 (no previous merge yet)
[S16] round=21 local utility u=0.002555 metrics={'f1_val': 0.07922894715347546, 'auprc': 0.07922894715347546, 'loss_val': 4.572667952819568, 'psi': 0.07922894715347546}-{'f1_val': 0.06823098685305375, 'auprc': 0.06823098685305375, 'loss_val': 4.478796068259047, 'psi': 0.06823098685305375}
[S17] START round=21 head_norm_before_train=1.600069 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.236805 metrics={'f1_val': 0.24393956359021862, 'auprc': 0.24393956359021862, 'loss_val': 1.2120634127673107, 'psi': 0.24393956359021862}-{'f1_val': 0.17952633030613377, 'auprc': 0.17952633030613377, 'loss_val': 1.1059543595810475, 'psi': 0.17952633030613377}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.079)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:40411
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:40416
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:40414
[S14] not sending this round → trigger blocked (psi=0.131)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:40409
[S11] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S7
[S10] cosine check vs S7: cos=0.9226
[S14] RECEIVED delta(kind=head bytes=1805) from S11
[S14] cosine check vs S11: cos=-0.0704
[S14] DROPPED delta from S11 (cos=-0.0704 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=0.9433
[S17] RECEIVED delta(kind=head bytes=1806) from S8
[S17] cosine check vs S8: cos=0.9449
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=-0.0961
[S16] DROPPED delta from S15 (cos=-0.0961 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=-0.0391
[S16] DROPPED delta from S13 (cos=-0.0391 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1794) from S9
[S13] cosine check vs S9: cos=0.8963
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.0792
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.2707 head_norm=1.557976
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.068214e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.2419 head_norm=1.528797 delta_norm=0.306821
[S10] aggregate: ROLLBACK (f1_val pre=0.271 post=0.242 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.3594 head_norm=1.915412
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.202867e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.3594 head_norm=1.873374 delta_norm=0.320287
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.3599 head_norm=1.300577
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.667426e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.3599 head_norm=1.421806 delta_norm=0.366743
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.3687 head_norm=1.618815
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.120376e+00
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.3687 head_norm=1.212890 delta_norm=1.120376
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.2439 head_norm=1.682894
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.198866e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.2275 head_norm=1.774300 delta_norm=0.319887
[S17] aggregate: ROLLBACK (f1_val pre=0.244 post=0.227 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.885584 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.0293919275358654, 'psi': 0.2654773703336637}-{'f1_val': 0.2617419060647515, 'auprc': 0.2617419060647515, 'loss_val': 2.822696058080667, 'psi': 0.2617419060647515}
[S3] START round=22 head_norm_before_train=1.776948 (no previous merge yet)
[S3] round=22 local utility u=0.285490 metrics={'f1_val': 0.25099800399201594, 'auprc': 0.25099800399201594, 'loss_val': 2.4933664398277284, 'psi': 0.25099800399201594}-{'f1_val': 0.19353597537514428, 'auprc': 0.19353597537514428, 'loss_val': 2.5471888610819273, 'psi': 0.19353597537514428}
[S4] START round=22 head_norm_before_train=1.967632 (no previous merge yet)
[S4] round=22 local utility u=0.001392 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2150221338703802, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2178067694764072, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.666963 (no previous merge yet)
[S5] round=22 local utility u=0.498363 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.23824684158249, 'psi': 0.3335071121394324}-{'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.485138500259064, 'psi': 0.2501920777223545}
[S6] START round=22 head_norm_before_train=1.870009 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.178391116701234, 'psi': 0.017774699907663897}-{'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 6.9585088986018055, 'psi': 0.018219557195571955}
[S7] START round=22 head_norm_before_train=1.560586 (no previous merge yet)
[S7] round=22 local utility u=0.021911 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1171847721401482, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1610070377392234, 'psi': 0.35976373724718097}
[S8] START round=22 head_norm_before_train=1.873374 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5745693634296417, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5576466013730487, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.212890 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.093840 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.2136486345463624, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4013281381101408, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.528797 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.24191962995085284, 'auprc': 0.24191962995085284, 'loss_val': 1.6688421205838515, 'psi': 0.24191962995085287}-{'f1_val': 0.27070393374741203, 'auprc': 0.27070393374741203, 'loss_val': 1.5954785993776404, 'psi': 0.27070393374741203}
[S11] START round=22 head_norm_before_train=1.703291 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.307321963157029, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.267740790418262, 'psi': 0.3320133550741517}
[S13] START round=22 head_norm_before_train=1.421806 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2547431283240016, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2333995663572346, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.641158 cos_to_last_merge=0.9945 (last merge round=18)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.10168591530598699, 'auprc': 0.10168591530598699, 'loss_val': 3.9550575047983916, 'psi': 0.10168591530598699}-{'f1_val': 0.1309164149043303, 'auprc': 0.1309164149043303, 'loss_val': 3.708560243392493, 'psi': 0.1309164149043303}
[S15] START round=22 head_norm_before_train=2.043074 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.881835611830256, 'auprc': 0.881835611830256, 'loss_val': 0.2527315469351355, 'psi': 0.881835611830256}-{'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.09601210567140471, 'psi': 0.9988780126706549}
[S16] START round=22 head_norm_before_train=1.728979 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.08037825059101654, 'auprc': 0.08037825059101654, 'loss_val': 4.691622206065084, 'psi': 0.08037825059101654}-{'f1_val': 0.07922894715347546, 'auprc': 0.07922894715347546, 'loss_val': 4.572667952819568, 'psi': 0.07922894715347546}
[S17] START round=22 head_norm_before_train=1.774300 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.062658 metrics={'f1_val': 0.25993908698158924, 'auprc': 0.25993908698158924, 'loss_val': 1.2307429512527142, 'psi': 0.25993908698158924}-{'f1_val': 0.24393956359021862, 'auprc': 0.24393956359021862, 'loss_val': 1.2120634127673107, 'psi': 0.24393956359021862}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:40404
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.7379
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=-0.1099
[S4] DROPPED delta from S3 (cos=-0.1099 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=0.9425
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.0135
[S9] RECEIVED delta(kind=head bytes=1800) from S4
[S9] cosine check vs S4: cos=0.6319
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.7133
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.2419 head_norm=1.614394
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.712152e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.2418 head_norm=1.573896 delta_norm=0.271215
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.3599 head_norm=1.456514
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.985496e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.3599 head_norm=1.258114 delta_norm=0.498550
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.3687 head_norm=1.241520
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.890109e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.3687 head_norm=1.078248 delta_norm=0.389011
[S9] aggregate: ACCEPT kept=['S5', 'S4', 'S17'] (k=3/3) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.896389 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.26363696764334593, 'auprc': 0.26363696764334593, 'loss_val': 3.1884598084250326, 'psi': 0.26363696764334593}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 3.0293919275358654, 'psi': 0.2654773703336637}
[S3] START round=23 head_norm_before_train=1.792104 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.25389614486718404, 'auprc': 0.25389614486718404, 'loss_val': 2.5543748402986366, 'psi': 0.25389614486718404}-{'f1_val': 0.25099800399201594, 'auprc': 0.25099800399201594, 'loss_val': 2.4933664398277284, 'psi': 0.25099800399201594}
[S4] START round=23 head_norm_before_train=1.982074 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2210920168030592, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2150221338703802, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.682094 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.640990592478462, 'psi': 0.2501920777223545}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.23824684158249, 'psi': 0.3335071121394324}
[S6] START round=23 head_norm_before_train=1.883946 (no previous merge yet)
[S6] round=23 local utility u=0.425390 metrics={'f1_val': 0.054774083546462064, 'auprc': 0.054774083546462064, 'loss_val': 6.6606046417445, 'psi': 0.05477408354646207}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.178391116701234, 'psi': 0.017774699907663897}
[S7] START round=23 head_norm_before_train=1.579602 (no previous merge yet)
[S7] round=23 local utility u=0.019119 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0789460413004248, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1171847721401482, 'psi': 0.35976373724718097}
[S8] START round=23 head_norm_before_train=1.930316 cos_to_last_merge=0.9981 (last merge round=21)
[S8] round=23 local utility u=0.014797 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5449759357835422, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5745693634296417, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.078248 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.007911 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.1978264063595343, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.2136486345463624, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.573896 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 1.748687159843418, 'psi': 0.2418357320386105}-{'f1_val': 0.24191962995085284, 'auprc': 0.24191962995085284, 'loss_val': 1.6688421205838515, 'psi': 0.24191962995085287}
[S11] START round=23 head_norm_before_train=1.715462 (no previous merge yet)
[S11] round=23 local utility u=0.007796 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.291034999132565, 'psi': 0.3319360347772085}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.307321963157029, 'psi': 0.3320133550741517}
[S13] START round=23 head_norm_before_train=1.258114 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.036222 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1822981478098613, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2547431283240016, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.675821 cos_to_last_merge=0.9909 (last merge round=18)
[S14] round=23 local utility u=0.110700 metrics={'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 4.023891636184643, 'psi': 0.13393415946927026}-{'f1_val': 0.10168591530598699, 'auprc': 0.10168591530598699, 'loss_val': 3.9550575047983916, 'psi': 0.10168591530598699}
[S15] START round=23 head_norm_before_train=2.065924 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6630442300741396, 'auprc': 0.6630442300741396, 'loss_val': 0.12365252361095115, 'psi': 0.6630442300741396}-{'f1_val': 0.881835611830256, 'auprc': 0.881835611830256, 'loss_val': 0.2527315469351355, 'psi': 0.881835611830256}
[S16] START round=23 head_norm_before_train=1.742260 (no previous merge yet)
[S16] round=23 local utility u=0.088571 metrics={'f1_val': 0.08950914340712224, 'auprc': 0.08950914340712224, 'loss_val': 4.59665774805531, 'psi': 0.08950914340712224}-{'f1_val': 0.08037825059101654, 'auprc': 0.08037825059101654, 'loss_val': 4.691622206065084, 'psi': 0.08037825059101654}
[S17] START round=23 head_norm_before_train=1.843910 cos_to_last_merge=0.9942 (last merge round=21)
[S17] round=23 local utility u=0.120383 metrics={'f1_val': 0.27069355537460066, 'auprc': 0.27069355537460066, 'loss_val': 1.086766560854614, 'psi': 0.27069355537460066}-{'f1_val': 0.25993908698158924, 'auprc': 0.25993908698158924, 'loss_val': 1.2307429512527142, 'psi': 0.25993908698158924}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:40416
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:40411
[S16] not sending this round → trigger blocked (psi=0.090)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.055)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.134)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=0.9537
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] cosine check vs S11: cos=-0.0690
[S14] DROPPED delta from S11 (cos=-0.0690 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.9497
[S16] RECEIVED delta(kind=head bytes=1807) from S13
[S16] cosine check vs S13: cos=-0.0066
[S16] DROPPED delta from S13 (cos=-0.0066 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S9
[S13] cosine check vs S9: cos=0.8789
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.6674
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.2418 head_norm=1.664004
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.503560e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.2418 head_norm=1.611956 delta_norm=0.250356
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.3687 head_norm=1.109922
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.109758e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.3687 head_norm=1.382459 delta_norm=0.710976
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.3599 head_norm=1.296413
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.095256e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.3599 head_norm=1.166405 delta_norm=0.309526
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.2707 head_norm=1.897744
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.102113e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.2651 head_norm=1.914798 delta_norm=0.310211
[S17] aggregate: ROLLBACK (f1_val pre=0.271 post=0.265 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.907593 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.19470404984423675, 'auprc': 0.19470404984423675, 'loss_val': 3.958639014082959, 'psi': 0.19470404984423675}-{'f1_val': 0.26363696764334593, 'auprc': 0.26363696764334593, 'loss_val': 3.1884598084250326, 'psi': 0.26363696764334593}
[S3] START round=24 head_norm_before_train=1.806773 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.25573562122656496, 'auprc': 0.25573562122656496, 'loss_val': 2.6285339475410705, 'psi': 0.25573562122656496}-{'f1_val': 0.25389614486718404, 'auprc': 0.25389614486718404, 'loss_val': 2.5543748402986366, 'psi': 0.25389614486718404}
[S4] START round=24 head_norm_before_train=2.003782 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.233501452583552, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2210920168030592, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.691496 (no previous merge yet)
[S5] round=24 local utility u=0.408124 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5745787421262256, 'psi': 0.3335071121394324}-{'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.640990592478462, 'psi': 0.2501920777223545}
[S6] START round=24 head_norm_before_train=1.897717 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 7.4368095955624165, 'psi': 0.017105871474803514}-{'f1_val': 0.054774083546462064, 'auprc': 0.054774083546462064, 'loss_val': 6.6606046417445, 'psi': 0.05477408354646207}
[S7] START round=24 head_norm_before_train=1.597891 (no previous merge yet)
[S7] round=24 local utility u=0.019395 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0401551775523912, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0789460413004248, 'psi': 0.35976373724718097}
[S8] START round=24 head_norm_before_train=1.980892 cos_to_last_merge=0.9945 (last merge round=21)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5492822955840918, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5449759357835422, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.382459 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3080939321727958, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.1978264063595343, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.611956 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 1.8295891256269223, 'psi': 0.2418357320386105}-{'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 1.748687159843418, 'psi': 0.2418357320386105}
[S11] START round=24 head_norm_before_train=1.726821 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.352771175466231, 'psi': 0.3320133550741517}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.291034999132565, 'psi': 0.3319360347772085}
[S13] START round=24 head_norm_before_train=1.166405 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1835185026854327, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1822981478098613, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.707477 cos_to_last_merge=0.9873 (last merge round=18)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.145806521382762, 'psi': 0.13572854291417166}-{'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 4.023891636184643, 'psi': 0.13393415946927026}
[S15] START round=24 head_norm_before_train=2.086217 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6179979742350791, 'auprc': 0.6179979742350791, 'loss_val': 0.17479991717647467, 'psi': 0.6179979742350791}-{'f1_val': 0.6630442300741396, 'auprc': 0.6630442300741396, 'loss_val': 0.12365252361095115, 'psi': 0.6630442300741396}
[S16] START round=24 head_norm_before_train=1.754469 (no previous merge yet)
[S16] round=24 local utility u=0.661620 metrics={'f1_val': 0.14797238999137188, 'auprc': 0.14797238999137188, 'loss_val': 3.7995876082976987, 'psi': 0.14797238999137188}-{'f1_val': 0.08950914340712224, 'auprc': 0.08950914340712224, 'loss_val': 4.59665774805531, 'psi': 0.08950914340712224}
[S17] START round=24 head_norm_before_train=1.914798 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.2533830959686159, 'auprc': 0.2533830959686159, 'loss_val': 1.2978172358795226, 'psi': 0.2533830959686159}-{'f1_val': 0.27069355537460066, 'auprc': 0.27069355537460066, 'loss_val': 1.086766560854614, 'psi': 0.27069355537460066}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:40411
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.148)
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=0.9627
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.1262
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.2418 head_norm=1.698381
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.300414e-01
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.2418 head_norm=1.642089 delta_norm=0.230041
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.3687 head_norm=1.402484
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.031059e+00
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.3687 head_norm=1.167792 delta_norm=1.031059
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.918545 (no previous merge yet)
[S2] round=25 local utility u=0.741871 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.9278299914777977, 'psi': 0.2450298816928894}-{'f1_val': 0.19470404984423675, 'auprc': 0.19470404984423675, 'loss_val': 3.958639014082959, 'psi': 0.19470404984423675}
[S3] START round=25 head_norm_before_train=1.820960 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.25607738322514956, 'auprc': 0.25607738322514956, 'loss_val': 2.6656261904041987, 'psi': 0.25607738322514956}-{'f1_val': 0.25573562122656496, 'auprc': 0.25573562122656496, 'loss_val': 2.6285339475410705, 'psi': 0.25573562122656496}
[S4] START round=25 head_norm_before_train=2.023388 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2472004117882982, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.233501452583552, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.699024 (no previous merge yet)
[S5] round=25 local utility u=0.022645 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5292878679259476, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5745787421262256, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.909093 (no previous merge yet)
[S6] round=25 local utility u=0.109650 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 7.26126913207675, 'psi': 0.021967963386727688}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 7.4368095955624165, 'psi': 0.017105871474803514}
[S7] START round=25 head_norm_before_train=1.616865 (no previous merge yet)
[S7] round=25 local utility u=0.023747 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9926620005164957, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.0401551775523912, 'psi': 0.35976373724718097}
[S8] START round=25 head_norm_before_train=2.018073 cos_to_last_merge=0.9915 (last merge round=21)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5867807561315622, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5492822955840918, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.167792 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.091470 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.1251539180433074, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3080939321727958, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.642089 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 1.9026107442407578, 'psi': 0.241793804900601}-{'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 1.8295891256269223, 'psi': 0.2418357320386105}
[S11] START round=25 head_norm_before_train=1.742087 (no previous merge yet)
[S11] round=25 local utility u=0.003944 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.344882951491247, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.352771175466231, 'psi': 0.3320133550741517}
[S13] START round=25 head_norm_before_train=1.206026 cos_to_last_merge=0.9954 (last merge round=23)
[S13] round=25 local utility u=0.006016 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1714862767329686, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1835185026854327, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.735981 cos_to_last_merge=0.9838 (last merge round=18)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13051146384479717, 'auprc': 0.13051146384479717, 'loss_val': 4.28583747403648, 'psi': 0.13051146384479717}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.145806521382762, 'psi': 0.13572854291417166}
[S15] START round=25 head_norm_before_train=2.102627 (no previous merge yet)
[S15] round=25 local utility u=1.000000 metrics={'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.03257063744540909, 'psi': 0.9988780126706549}-{'f1_val': 0.6179979742350791, 'auprc': 0.6179979742350791, 'loss_val': 0.17479991717647467, 'psi': 0.6179979742350791}
[S16] START round=25 head_norm_before_train=1.765773 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.00037140204271123495, 'auprc': 0.00037140204271123495, 'loss_val': 5.646148680898975, 'psi': 0.00037140204271123495}-{'f1_val': 0.14797238999137188, 'auprc': 0.14797238999137188, 'loss_val': 3.7995876082976987, 'psi': 0.14797238999137188}
[S17] START round=25 head_norm_before_train=1.950609 cos_to_last_merge=0.9991 (last merge round=23)
[S17] round=25 local utility u=0.672520 metrics={'f1_val': 0.4013216608359342, 'auprc': 0.4013216608359342, 'loss_val': 1.2842238623062152, 'psi': 0.4013216608359342}-{'f1_val': 0.2533830959686159, 'auprc': 0.2533830959686159, 'loss_val': 1.2978172358795226, 'psi': 0.2533830959686159}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:40407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.5817
[S17] RECEIVED delta(kind=head bytes=1804) from S9
[S17] cosine check vs S9: cos=0.5609
[S6] RECEIVED delta(kind=head bytes=1803) from S11
[S6] cosine check vs S11: cos=0.0313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:40409
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9722
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.0220 head_norm=1.920020
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.280763e+00
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.0239 head_norm=1.321325 delta_norm=1.280763
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.074 → S11@127.0.0.1:40412
[S10] ⇄ pheromone p=0.025 → S7@127.0.0.1:40408
[S4] ⇄ pheromone p=0.019 → S3@127.0.0.1:40403
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.3594 head_norm=2.046983
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.395840e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.3594 head_norm=2.004628 delta_norm=0.239584
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.026 → S16@127.0.0.1:40416
[S13] ⇄ pheromone p=0.024 → S9@127.0.0.1:40410
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.3687 head_norm=1.185519
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.593717e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.3687 head_norm=1.086031 delta_norm=0.559372
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.094 → S17@127.0.0.1:40417
[S11] ⇄ pheromone p=0.043 → S6@127.0.0.1:40407
[S16] ⇄ pheromone p=0.151 → S15@127.0.0.1:40415
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.4013 head_norm=1.990410
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.246233e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.4023 head_norm=1.415482 delta_norm=0.824623
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.205 → S9@127.0.0.1:40410
[S2] START round=26 head_norm_before_train=1.927487 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.1230316213860627, 'psi': 0.2653978324081417}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.9278299914777977, 'psi': 0.2450298816928894}
[S3] START round=26 head_norm_before_train=1.834569 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.2570096442485789, 'auprc': 0.2570096442485789, 'loss_val': 2.785264648789997, 'psi': 0.2570096442485789}-{'f1_val': 0.25607738322514956, 'auprc': 0.25607738322514956, 'loss_val': 2.6656261904041987, 'psi': 0.25607738322514956}
[S4] START round=26 head_norm_before_train=2.041803 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.250163319386705, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2472004117882982, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.708223 (no previous merge yet)
[S5] round=26 local utility u=0.079428 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3704316482066123, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5292878679259476, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.321325 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 4.352516132512735, 'psi': 0.02109124254928932}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 7.26126913207675, 'psi': 0.021967963386727688}
[S7] START round=26 head_norm_before_train=1.637971 (no previous merge yet)
[S7] round=26 local utility u=0.023453 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9457559262094938, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9926620005164957, 'psi': 0.35976373724718097}
[S8] START round=26 head_norm_before_train=2.004628 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.030292 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5261959405285005, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5867807561315622, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.086031 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.24511189634864547, 'auprc': 0.24511189634864547, 'loss_val': 1.4007835569741587, 'psi': 0.2451118963486455}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.1251539180433074, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.722699 cos_to_last_merge=0.9949 (last merge round=24)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.093295937138346, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 1.9026107442407578, 'psi': 0.241793804900601}
[S11] START round=26 head_norm_before_train=1.756710 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.4202227144964312, 'psi': 0.33201273984308244}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.344882951491247, 'psi': 0.3320133550741517}
[S13] START round=26 head_norm_before_train=1.256688 cos_to_last_merge=0.9844 (last merge round=23)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1894599174621134, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1714862767329686, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.760543 cos_to_last_merge=0.9808 (last merge round=18)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.12969972243250064, 'auprc': 0.12969972243250064, 'loss_val': 4.409547357310954, 'psi': 0.12969972243250064}-{'f1_val': 0.13051146384479717, 'auprc': 0.13051146384479717, 'loss_val': 4.28583747403648, 'psi': 0.13051146384479717}
[S15] START round=26 head_norm_before_train=2.117819 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.5865818886546367, 'auprc': 0.5865818886546367, 'loss_val': 0.3731175953322452, 'psi': 0.5865818886546367}-{'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.03257063744540909, 'psi': 0.9988780126706549}
[S16] START round=26 head_norm_before_train=1.775727 (no previous merge yet)
[S16] round=26 local utility u=1.000000 metrics={'f1_val': 0.12314291692822767, 'auprc': 0.12314291692822767, 'loss_val': 3.5912947126082924, 'psi': 0.12314291692822768}-{'f1_val': 0.00037140204271123495, 'auprc': 0.00037140204271123495, 'loss_val': 5.646148680898975, 'psi': 0.00037140204271123495}
[S17] START round=26 head_norm_before_train=1.415482 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.2642271767487719, 'auprc': 0.2642271767487719, 'loss_val': 1.1623290423980226, 'psi': 0.2642271767487719}-{'f1_val': 0.4013216608359342, 'auprc': 0.4013216608359342, 'loss_val': 1.2842238623062152, 'psi': 0.4013216608359342}
[S16] not sending this round → trigger blocked (psi=0.123)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.021)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:40411
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:40416
[S8] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=0.9554
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=0.0778
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.2418 head_norm=1.796227
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.670452e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.2418 head_norm=1.705529 delta_norm=0.267045
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.1231 head_norm=1.784897
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.295865e+00
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.1640 head_norm=1.400033 delta_norm=1.295865
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.932984 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.2619953286619953, 'auprc': 0.2619953286619953, 'loss_val': 3.273800250908939, 'psi': 0.2619953286619953}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.1230316213860627, 'psi': 0.2653978324081417}
[S3] START round=27 head_norm_before_train=1.847075 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.25909471379821003, 'auprc': 0.25909471379821003, 'loss_val': 2.826513540595921, 'psi': 0.25909471379821003}-{'f1_val': 0.2570096442485789, 'auprc': 0.2570096442485789, 'loss_val': 2.785264648789997, 'psi': 0.2570096442485789}
[S4] START round=27 head_norm_before_train=2.058853 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2613831632213668, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.250163319386705, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.719738 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4060737789428175, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3704316482066123, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.377666 cos_to_last_merge=0.9986 (last merge round=25)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.15991043471828, 'psi': 0.01732902033271719}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 4.352516132512735, 'psi': 0.02109124254928932}
[S7] START round=27 head_norm_before_train=1.653436 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9327943878498229, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.9457559262094938, 'psi': 0.35976373724718097}
[S8] START round=27 head_norm_before_train=2.023082 cos_to_last_merge=0.9999 (last merge round=25)
[S8] round=27 local utility u=0.003855 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5184853104265712, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5261959405285005, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.132688 cos_to_last_merge=0.9963 (last merge round=25)
[S9] round=27 local utility u=0.589537 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3337486440994286, 'psi': 0.36867172340800847}-{'f1_val': 0.24511189634864547, 'auprc': 0.24511189634864547, 'loss_val': 1.4007835569741587, 'psi': 0.2451118963486455}
[S10] START round=27 head_norm_before_train=1.705529 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.020636 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.0520241795171805, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.093295937138346, 'psi': 0.241793804900601}
[S11] START round=27 head_norm_before_train=1.770350 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.4551628775680667, 'psi': 0.33201273984308244}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.4202227144964312, 'psi': 0.33201273984308244}
[S13] START round=27 head_norm_before_train=1.302141 cos_to_last_merge=0.9728 (last merge round=23)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.208091911640302, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1894599174621134, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.781257 cos_to_last_merge=0.9783 (last merge round=18)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13192612137203166, 'auprc': 0.13192612137203166, 'loss_val': 4.51256121854932, 'psi': 0.13192612137203166}-{'f1_val': 0.12969972243250064, 'auprc': 0.12969972243250064, 'loss_val': 4.409547357310954, 'psi': 0.12969972243250064}
[S15] START round=27 head_norm_before_train=2.128201 (no previous merge yet)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.8815266316866779, 'auprc': 0.8815266316866779, 'loss_val': 0.29232324730067605, 'psi': 0.8815266316866779}-{'f1_val': 0.5865818886546367, 'auprc': 0.5865818886546367, 'loss_val': 0.3731175953322452, 'psi': 0.5865818886546367}
[S16] START round=27 head_norm_before_train=1.400033 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.026038879971464243, 'auprc': 0.026038879971464243, 'loss_val': 3.4825609289727355, 'psi': 0.026038879971464243}-{'f1_val': 0.12314291692822767, 'auprc': 0.12314291692822767, 'loss_val': 3.5912947126082924, 'psi': 0.12314291692822768}
[S17] START round=27 head_norm_before_train=1.472567 cos_to_last_merge=0.9986 (last merge round=25)
[S17] round=27 local utility u=0.691792 metrics={'f1_val': 0.4144842668466669, 'auprc': 0.4144842668466669, 'loss_val': 1.1310586104242393, 'psi': 0.4144842668466669}-{'f1_val': 0.2642271767487719, 'auprc': 0.2642271767487719, 'loss_val': 1.1623290423980226, 'psi': 0.2642271767487719}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:40408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S10
[S7] cosine check vs S10: cos=0.9777
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] cosine check vs S9: cos=0.7488
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=-0.0200
[S16] DROPPED delta from S15 (cos=-0.0200 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S8
[S16] cosine check vs S8: cos=0.7656
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.7488
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.2397 head_norm=1.665541
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.877323e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.2397 head_norm=1.705762 delta_norm=0.187732
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.3687 head_norm=1.184787
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.108910e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.3687 head_norm=1.275878 delta_norm=0.510891
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.0260 head_norm=1.415500
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.596847e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.0260 head_norm=1.626140 delta_norm=0.659685
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.4145 head_norm=1.540788
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.108910e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.4223 head_norm=1.275878 delta_norm=0.510891
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.939960 (no previous merge yet)
[S2] round=28 local utility u=0.031855 metrics={'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 3.2399966711453656, 'psi': 0.26531826293872696}-{'f1_val': 0.2619953286619953, 'auprc': 0.2619953286619953, 'loss_val': 3.273800250908939, 'psi': 0.2619953286619953}
[S3] START round=28 head_norm_before_train=1.857243 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.2570096442485789, 'auprc': 0.2570096442485789, 'loss_val': 2.8213556759201026, 'psi': 0.2570096442485789}-{'f1_val': 0.25909471379821003, 'auprc': 0.25909471379821003, 'loss_val': 2.826513540595921, 'psi': 0.25909471379821003}
[S4] START round=28 head_norm_before_train=2.079848 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2730581960798752, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2613831632213668, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.737352 (no previous merge yet)
[S5] round=28 local utility u=0.011314 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3834448680351277, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4060737789428175, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.456569 cos_to_last_merge=0.9938 (last merge round=25)
[S6] round=28 local utility u=0.255622 metrics={'f1_val': 0.06461025427261359, 'auprc': 0.06461025427261359, 'loss_val': 5.074197397664083, 'psi': 0.06461025427261359}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.15991043471828, 'psi': 0.01732902033271719}
[S7] START round=28 head_norm_before_train=1.705762 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.007618 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9175588203968159, 'psi': 0.23968964488212474}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9327943878498229, 'psi': 0.23968964488212474}
[S8] START round=28 head_norm_before_train=2.038477 cos_to_last_merge=0.9998 (last merge round=25)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5363690897430627, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5184853104265712, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.275878 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3862834387161878, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3337486440994286, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.765136 cos_to_last_merge=0.9983 (last merge round=26)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.1928385343844132, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.0520241795171805, 'psi': 0.241793804900601}
[S11] START round=28 head_norm_before_train=1.784901 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.4776305897374185, 'psi': 0.3320133550741517}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.4551628775680667, 'psi': 0.33201273984308244}
[S13] START round=28 head_norm_before_train=1.333390 cos_to_last_merge=0.9651 (last merge round=23)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2125526881317887, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.208091911640302, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.799034 cos_to_last_merge=0.9763 (last merge round=18)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13273115042027347, 'auprc': 0.13273115042027347, 'loss_val': 4.603515453587839, 'psi': 0.13273115042027347}-{'f1_val': 0.13192612137203166, 'auprc': 0.13192612137203166, 'loss_val': 4.51256121854932, 'psi': 0.13192612137203166}
[S15] START round=28 head_norm_before_train=2.135427 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.8802896568133244, 'auprc': 0.8802896568133244, 'loss_val': 0.3530278484648149, 'psi': 0.8802896568133244}-{'f1_val': 0.8815266316866779, 'auprc': 0.8815266316866779, 'loss_val': 0.29232324730067605, 'psi': 0.8815266316866779}
[S16] START round=28 head_norm_before_train=1.626140 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.740135 metrics={'f1_val': 0.09034118212397886, 'auprc': 0.09034118212397886, 'loss_val': 2.581011667844891, 'psi': 0.09034118212397886}-{'f1_val': 0.026038879971464243, 'auprc': 0.026038879971464243, 'loss_val': 3.4825609289727355, 'psi': 0.026038879971464243}
[S17] START round=28 head_norm_before_train=1.275878 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.26922669954195627, 'auprc': 0.26922669954195627, 'loss_val': 1.1487438486080865, 'psi': 0.26922669954195627}-{'f1_val': 0.4144842668466669, 'auprc': 0.4144842668466669, 'loss_val': 1.1310586104242393, 'psi': 0.4144842668466669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:40411
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.090)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.065)
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S7
[S10] cosine check vs S7: cos=0.9894
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.2418 head_norm=1.821993
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.391126e-01
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.2418 head_norm=1.764285 delta_norm=0.139113
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.948693 (no previous merge yet)
[S2] round=29 local utility u=0.003812 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.2330890573518123, 'psi': 0.2653978324081417}-{'f1_val': 0.26531826293872696, 'auprc': 0.26531826293872696, 'loss_val': 3.2399966711453656, 'psi': 0.26531826293872696}
[S3] START round=29 head_norm_before_train=1.866622 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.2564690885914595, 'auprc': 0.2564690885914595, 'loss_val': 2.819333917693675, 'psi': 0.2564690885914595}-{'f1_val': 0.2570096442485789, 'auprc': 0.2570096442485789, 'loss_val': 2.8213556759201026, 'psi': 0.2570096442485789}
[S4] START round=29 head_norm_before_train=2.101552 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2888084187001256, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2730581960798752, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.753485 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3975403384808565, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3834448680351277, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.521882 cos_to_last_merge=0.9886 (last merge round=25)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.975505223597084, 'psi': 0.01732902033271719}-{'f1_val': 0.06461025427261359, 'auprc': 0.06461025427261359, 'loss_val': 5.074197397664083, 'psi': 0.06461025427261359}
[S7] START round=29 head_norm_before_train=1.715940 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=29 local utility u=0.552451 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8933239070191359, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9175588203968159, 'psi': 0.23968964488212474}
[S8] START round=29 head_norm_before_train=2.056316 cos_to_last_merge=0.9995 (last merge round=25)
[S8] round=29 local utility u=0.014503 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5073628814369964, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5363690897430627, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.315633 cos_to_last_merge=0.9981 (last merge round=27)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4623745802730415, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.3862834387161878, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.764285 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.2050128742206208, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.1928385343844132, 'psi': 0.241793804900601}
[S11] START round=29 head_norm_before_train=1.798026 (no previous merge yet)
[S11] round=29 local utility u=0.005418 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.466795521042619, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.4776305897374185, 'psi': 0.3320133550741517}
[S13] START round=29 head_norm_before_train=1.358272 cos_to_last_merge=0.9592 (last merge round=23)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2400017075640917, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2125526881317887, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.815227 cos_to_last_merge=0.9743 (last merge round=18)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 4.693698189359161, 'psi': 0.13172448466566114}-{'f1_val': 0.13273115042027347, 'auprc': 0.13273115042027347, 'loss_val': 4.603515453587839, 'psi': 0.13273115042027347}
[S15] START round=29 head_norm_before_train=2.143866 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6333656875838907, 'auprc': 0.6333656875838907, 'loss_val': 0.12241716672584757, 'psi': 0.6333656875838907}-{'f1_val': 0.8802896568133244, 'auprc': 0.8802896568133244, 'loss_val': 0.3530278484648149, 'psi': 0.8802896568133244}
[S16] START round=29 head_norm_before_train=1.653111 cos_to_last_merge=0.9987 (last merge round=27)
[S16] round=29 local utility u=0.002659 metrics={'f1_val': 0.11569616383921749, 'auprc': 0.11569616383921749, 'loss_val': 2.803889038069554, 'psi': 0.11569616383921749}-{'f1_val': 0.09034118212397886, 'auprc': 0.09034118212397886, 'loss_val': 2.581011667844891, 'psi': 0.09034118212397886}
[S17] START round=29 head_norm_before_train=1.332945 cos_to_last_merge=0.9985 (last merge round=27)
[S17] round=29 local utility u=0.049581 metrics={'f1_val': 0.2845319991661455, 'auprc': 0.2845319991661455, 'loss_val': 1.1873286227721385, 'psi': 0.2845319991661455}-{'f1_val': 0.26922669954195627, 'auprc': 0.26922669954195627, 'loss_val': 1.1487438486080865, 'psi': 0.26922669954195627}
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:40416
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.116)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:40411
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=0.9933
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=-0.0660
[S14] DROPPED delta from S11 (cos=-0.0660 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] cosine check vs S8: cos=0.9312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.1157 head_norm=1.696446
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.957993e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.1190 head_norm=1.852905 delta_norm=0.395799
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.9879
[S9] CommDone barrier timeout: have=2 need=3 — continuing
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.3687 head_norm=1.358158
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.090455e-01
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.3687 head_norm=1.373623 delta_norm=0.109045
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.957476 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.24665696667359524, 'auprc': 0.24665696667359524, 'loss_val': 3.4543372561190746, 'psi': 0.24665696667359527}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.2330890573518123, 'psi': 0.2653978324081417}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.873711 (no previous merge yet)
[S3] round=30 local utility u=0.017503 metrics={'f1_val': 0.255881978888465, 'auprc': 0.255881978888465, 'loss_val': 2.779043389988848, 'psi': 0.255881978888465}-{'f1_val': 0.2564690885914595, 'auprc': 0.2564690885914595, 'loss_val': 2.819333917693675, 'psi': 0.2564690885914595}
[S4] START round=30 head_norm_before_train=2.120276 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2949617488496818, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2888084187001256, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.775568 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.417777769429528, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3975403384808565, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.567616 cos_to_last_merge=0.9847 (last merge round=25)
[S6] round=30 local utility u=0.232045 metrics={'f1_val': 0.034951024042742654, 'auprc': 0.034951024042742654, 'loss_val': 5.670013844961941, 'psi': 0.034951024042742654}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 5.975505223597084, 'psi': 0.01732902033271719}
[S7] START round=30 head_norm_before_train=1.727825 cos_to_last_merge=0.9998 (last merge round=27)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.25475285171102663, 'auprc': 0.25475285171102663, 'loss_val': 0.8529151167134992, 'psi': 0.25475285171102663}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8933239070191359, 'psi': 0.35976373724718097}
[S8] START round=30 head_norm_before_train=2.074101 cos_to_last_merge=0.9991 (last merge round=25)
[S8] round=30 local utility u=0.015802 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.4757585922135063, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5073628814369964, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.373623 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5581612466464343, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4623745802730415, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.815690 cos_to_last_merge=0.9991 (last merge round=28)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.3094638009905997, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.2050128742206208, 'psi': 0.241793804900601}
[S11] START round=30 head_norm_before_train=1.810557 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.5275739907794676, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.466795521042619, 'psi': 0.3320133550741517}
[S13] START round=30 head_norm_before_train=1.381099 cos_to_last_merge=0.9539 (last merge round=23)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2645199960077576, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2400017075640917, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.829726 cos_to_last_merge=0.9726 (last merge round=18)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 4.776807552381032, 'psi': 0.13172448466566114}-{'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 4.693698189359161, 'psi': 0.13172448466566114}
[S15] START round=30 head_norm_before_train=2.157068 (no previous merge yet)
[S15] round=30 local utility u=1.000000 metrics={'f1_val': 0.8815266316866779, 'auprc': 0.8815266316866779, 'loss_val': 0.32473626269438566, 'psi': 0.8815266316866779}-{'f1_val': 0.6333656875838907, 'auprc': 0.6333656875838907, 'loss_val': 0.12241716672584757, 'psi': 0.6333656875838907}
[S16] START round=30 head_norm_before_train=1.852905 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.07297341918441473, 'auprc': 0.07297341918441473, 'loss_val': 3.0858302924382826, 'psi': 0.07297341918441473}-{'f1_val': 0.11569616383921749, 'auprc': 0.11569616383921749, 'loss_val': 2.803889038069554, 'psi': 0.11569616383921749}
[S17] START round=30 head_norm_before_train=1.397450 cos_to_last_merge=0.9948 (last merge round=27)
[S17] round=30 local utility u=0.494282 metrics={'f1_val': 0.4099931598108088, 'auprc': 0.4099931598108088, 'loss_val': 1.3279143518380176, 'psi': 0.4099931598108088}-{'f1_val': 0.2845319991661455, 'auprc': 0.2845319991661455, 'loss_val': 1.1873286227721385, 'psi': 0.2845319991661455}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.035)
[S6] ⇄ pheromone p=0.192 → S11@127.0.0.1:40412
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] ⇄ pheromone p=0.112 → S10@127.0.0.1:40411
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.2418 head_norm=1.861955
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.476289e-01
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.2418 head_norm=1.790065 delta_norm=0.147629
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.010 → S7@127.0.0.1:40408
[S15] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:40416
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.008 → S9@127.0.0.1:40410
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] cosine check vs S15: cos=0.0448
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] cosine check vs S3: cos=-0.1122
[S4] DROPPED delta from S3 (cos=-0.1122 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] ⇄ pheromone p=0.406 → S16@127.0.0.1:40416
[S3] ⇄ pheromone p=0.035 → S4@127.0.0.1:40404
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] cosine check vs S8: cos=0.9748
[S11] ⇄ pheromone p=0.015 → S6@127.0.0.1:40407
[S4] ⇄ pheromone p=0.006 → S3@127.0.0.1:40403
[S8] ⇄ pheromone p=0.017 → S16@127.0.0.1:40416
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.0730 head_norm=1.891001
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.948432e-01
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.0681 head_norm=1.582380 delta_norm=0.694843
[S16] aggregate: ACCEPT kept=['S15', 'S8'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.227 → S15@127.0.0.1:40415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.9907
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.024 → S11@127.0.0.1:40412
[S8]  timeout peer S2
[S8]  timeout peer S16
[S13]  timeout peer S9
[S4]  timeout peer S14
[S14]  timeout peer S10
[S14]  timeout peer S11
[S9]  timeout peer S4
[S9]  timeout peer S5
[S16]  timeout peer S13
[S17]  timeout peer S8
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.3687 head_norm=1.410280
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.007546e-01
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.3687 head_norm=1.430930 delta_norm=0.100755
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.091 → S13@127.0.0.1:40413
[S2] START round=31 head_norm_before_train=1.966147 (no previous merge yet)
[S2] round=31 local utility u=0.305561 metrics={'f1_val': 0.2556955581010564, 'auprc': 0.2556955581010564, 'loss_val': 2.924561929387798, 'psi': 0.2556955581010564}-{'f1_val': 0.24665696667359524, 'auprc': 0.24665696667359524, 'loss_val': 3.4543372561190746, 'psi': 0.24665696667359527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=31 head_norm_before_train=1.880440 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.2556381424305953, 'auprc': 0.2556381424305953, 'loss_val': 2.8017654241572103, 'psi': 0.2556381424305953}-{'f1_val': 0.255881978888465, 'auprc': 0.255881978888465, 'loss_val': 2.779043389988848, 'psi': 0.255881978888465}
[S4] START round=31 head_norm_before_train=2.134554 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.307024657791048, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2949617488496818, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.795167 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4420131394596964, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.417777769429528, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.602623 cos_to_last_merge=0.9817 (last merge round=25)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 6.004771687509773, 'psi': 0.025227272727272727}-{'f1_val': 0.034951024042742654, 'auprc': 0.034951024042742654, 'loss_val': 5.670013844961941, 'psi': 0.034951024042742654}
[S7] START round=31 head_norm_before_train=1.738003 cos_to_last_merge=0.9995 (last merge round=27)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.24061770515352846, 'auprc': 0.24061770515352846, 'loss_val': 0.8673757060565017, 'psi': 0.24061770515352846}-{'f1_val': 0.25475285171102663, 'auprc': 0.25475285171102663, 'loss_val': 0.8529151167134992, 'psi': 0.25475285171102663}
[S8] START round=31 head_norm_before_train=2.093152 cos_to_last_merge=0.9986 (last merge round=25)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.501134342695418, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.4757585922135063, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.430930 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.676966476659036, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5581612466464343, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.790065 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.015445 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.2785736034867257, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.3094638009905997, 'psi': 0.241793804900601}
[S11] START round=31 head_norm_before_train=1.824482 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.5711357937748502, 'psi': 0.33201273984308244}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.5275739907794676, 'psi': 0.3320133550741517}
[S13] START round=31 head_norm_before_train=1.401369 cos_to_last_merge=0.9490 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.949
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2690407659385645, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2645199960077576, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.842760 cos_to_last_merge=0.9711 (last merge round=18)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 4.85027609457887, 'psi': 0.13172448466566114}-{'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 4.776807552381032, 'psi': 0.13172448466566114}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=2.171251 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.8802896568133244, 'auprc': 0.8802896568133244, 'loss_val': 0.3744512934912084, 'psi': 0.8802896568133244}-{'f1_val': 0.8815266316866779, 'auprc': 0.8815266316866779, 'loss_val': 0.32473626269438566, 'psi': 0.8815266316866779}
[S16] START round=31 head_norm_before_train=1.582380 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.467341 metrics={'f1_val': 0.1086603204086371, 'auprc': 0.1086603204086371, 'loss_val': 2.4723296371384804, 'psi': 0.1086603204086371}-{'f1_val': 0.07297341918441473, 'auprc': 0.07297341918441473, 'loss_val': 3.0858302924382826, 'psi': 0.07297341918441473}
[S17] START round=31 head_norm_before_train=1.458264 cos_to_last_merge=0.9902 (last merge round=27)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.21401374414579022, 'auprc': 0.21401374414579022, 'loss_val': 1.3392021647957482, 'psi': 0.21401374414579022}-{'f1_val': 0.4099931598108088, 'auprc': 0.4099931598108088, 'loss_val': 1.3279143518380176, 'psi': 0.4099931598108088}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:40408
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.109)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.9940
[S2] START round=32 head_norm_before_train=1.973520 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 3.03873945521291, 'psi': 0.245119570522206}-{'f1_val': 0.2556955581010564, 'auprc': 0.2556955581010564, 'loss_val': 2.924561929387798, 'psi': 0.2556955581010564}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.888795 (no previous merge yet)
[S3] round=32 local utility u=0.523456 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.731575287127565, 'psi': 0.3641628959276018}-{'f1_val': 0.2556381424305953, 'auprc': 0.2556381424305953, 'loss_val': 2.8017654241572103, 'psi': 0.2556381424305953}
[S4] START round=32 head_norm_before_train=2.146922 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3219088883183414, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.307024657791048, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.813499 (no previous merge yet)
[S5] round=32 local utility u=0.030612 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3807882981179302, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4420131394596964, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=32 head_norm_before_train=1.632030 cos_to_last_merge=0.9792 (last merge round=25)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.469824221708618, 'psi': 0.017551963048498844}-{'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 6.004771687509773, 'psi': 0.025227272727272727}
[S7] START round=32 head_norm_before_train=1.747800 cos_to_last_merge=0.9993 (last merge round=27)
[S7] round=32 local utility u=0.087018 metrics={'f1_val': 0.25700038358266203, 'auprc': 0.25700038358266203, 'loss_val': 0.8407831478661003, 'psi': 0.25700038358266203}-{'f1_val': 0.24061770515352846, 'auprc': 0.24061770515352846, 'loss_val': 0.8673757060565017, 'psi': 0.24061770515352846}
[S8] START round=32 head_norm_before_train=2.107750 cos_to_last_merge=0.9982 (last merge round=25)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5233873074895793, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.501134342695418, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.462542 cos_to_last_merge=0.9994 (last merge round=30)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7340316859485796, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.676966476659036, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=1.832649 cos_to_last_merge=0.9995 (last merge round=30)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.374799025698891, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.2785736034867257, 'psi': 0.241793804900601}
[S11] START round=32 head_norm_before_train=1.838298 (no previous merge yet)
[S11] round=32 local utility u=0.004918 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.561305930713752, 'psi': 0.3320133550741517}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 3.5711357937748502, 'psi': 0.33201273984308244}
[S13] START round=32 head_norm_before_train=1.418156 cos_to_last_merge=0.9452 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.945
[S13] round=32 local utility u=0.000988 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.267065600317558, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2690407659385645, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=32 head_norm_before_train=1.854509 cos_to_last_merge=0.9697 (last merge round=18)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13212760612911328, 'auprc': 0.13212760612911328, 'loss_val': 4.913338101625834, 'psi': 0.13212760612911328}-{'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 4.85027609457887, 'psi': 0.13172448466566114}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=2.185406 (no previous merge yet)
[S15] round=32 local utility u=0.069983 metrics={'f1_val': 0.881835611830256, 'auprc': 0.881835611830256, 'loss_val': 0.24839931471692203, 'psi': 0.881835611830256}-{'f1_val': 0.8802896568133244, 'auprc': 0.8802896568133244, 'loss_val': 0.3744512934912084, 'psi': 0.8802896568133244}
[S16] START round=32 head_norm_before_train=1.626643 cos_to_last_merge=0.9968 (last merge round=30)
[S16] round=32 local utility u=0.134396 metrics={'f1_val': 0.14853120735473677, 'auprc': 0.14853120735473677, 'loss_val': 2.5623758606515628, 'psi': 0.14853120735473677}-{'f1_val': 0.1086603204086371, 'auprc': 0.1086603204086371, 'loss_val': 2.4723296371384804, 'psi': 0.1086603204086371}
[S17] START round=32 head_norm_before_train=1.506988 cos_to_last_merge=0.9864 (last merge round=27)
[S17] round=32 local utility u=0.575012 metrics={'f1_val': 0.32921235425060286, 'auprc': 0.32921235425060286, 'loss_val': 1.2259661491144793, 'psi': 0.32921235425060286}-{'f1_val': 0.21401374414579022, 'auprc': 0.21401374414579022, 'loss_val': 1.3392021647957482, 'psi': 0.21401374414579022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:40404
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.149)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:40407
[S16] RECEIVED delta(kind=head bytes=1795) from S15
[S16] cosine check vs S15: cos=0.3635
[S4] RECEIVED delta(kind=head bytes=1793) from S3
[S4] cosine check vs S3: cos=-0.1118
[S4] DROPPED delta from S3 (cos=-0.1118 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=0.9907
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.2570 head_norm=1.756237
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.057886e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.2573 head_norm=1.791730 delta_norm=0.105789
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1798) from S11
[S6] cosine check vs S11: cos=0.5781
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.1485 head_norm=1.678206
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.114250e+00
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.1413 head_norm=1.606950 delta_norm=1.114250
[S16] aggregate: ROLLBACK (f1_val pre=0.149 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S2] START round=33 head_norm_before_train=1.980706 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.21150668469280456, 'auprc': 0.21150668469280456, 'loss_val': 3.754326861786347, 'psi': 0.21150668469280456}-{'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 3.03873945521291, 'psi': 0.245119570522206}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.896853 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.2429071592418206, 'auprc': 0.2429071592418206, 'loss_val': 2.793618583432641, 'psi': 0.2429071592418206}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.731575287127565, 'psi': 0.3641628959276018}
[S4] START round=33 head_norm_before_train=2.163915 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.325201648214446, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3219088883183414, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.829594 (no previous merge yet)
[S5] round=33 local utility u=0.036661 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3074664502916487, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3807882981179302, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=33 head_norm_before_train=1.656157 cos_to_last_merge=0.9771 (last merge round=25)
[S6] round=33 local utility u=0.386729 metrics={'f1_val': 0.04822664359861592, 'auprc': 0.04822664359861592, 'loss_val': 5.972437438029802, 'psi': 0.04822664359861592}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.469824221708618, 'psi': 0.017551963048498844}
[S7] START round=33 head_norm_before_train=1.791730 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.19255135342676138, 'auprc': 0.19255135342676138, 'loss_val': 0.837369467258603, 'psi': 0.19255135342676138}-{'f1_val': 0.25700038358266203, 'auprc': 0.25700038358266203, 'loss_val': 0.8407831478661003, 'psi': 0.25700038358266203}
[S8] START round=33 head_norm_before_train=2.121485 cos_to_last_merge=0.9978 (last merge round=25)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5601731697828684, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5233873074895793, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.490903 cos_to_last_merge=0.9980 (last merge round=30)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7747614916120251, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7340316859485796, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=1.874061 cos_to_last_merge=0.9982 (last merge round=30)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.45552498894612, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.374799025698891, 'psi': 0.241793804900601}
[S11] START round=33 head_norm_before_train=1.850486 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.6340932615537564, 'psi': 0.3320901320901321}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.561305930713752, 'psi': 0.3320133550741517}
[S13] START round=33 head_norm_before_train=1.431756 cos_to_last_merge=0.9420 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.942
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2695770490205396, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.267065600317558, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.865574 cos_to_last_merge=0.9685 (last merge round=18)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.971854995340198, 'psi': 0.1331327566754419}-{'f1_val': 0.13212760612911328, 'auprc': 0.13212760612911328, 'loss_val': 4.913338101625834, 'psi': 0.13212760612911328}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=2.198023 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.4408056059612338, 'psi': 0.8796705340794291}-{'f1_val': 0.881835611830256, 'auprc': 0.881835611830256, 'loss_val': 0.24839931471692203, 'psi': 0.881835611830256}
[S16] START round=33 head_norm_before_train=1.606950 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.0907563025210084, 'auprc': 0.0907563025210084, 'loss_val': 2.2875958146924984, 'psi': 0.0907563025210084}-{'f1_val': 0.14853120735473677, 'auprc': 0.14853120735473677, 'loss_val': 2.5623758606515628, 'psi': 0.14853120735473677}
[S17] START round=33 head_norm_before_train=1.541514 cos_to_last_merge=0.9836 (last merge round=27)
[S17] round=33 local utility u=0.296695 metrics={'f1_val': 0.4174529461215735, 'auprc': 0.4174529461215735, 'loss_val': 1.4267412502493084, 'psi': 0.4174529461215735}-{'f1_val': 0.32921235425060286, 'auprc': 0.32921235425060286, 'loss_val': 1.2259661491144793, 'psi': 0.32921235425060286}
[S6] not sending this round → trigger blocked (psi=0.048)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.2418 head_norm=1.909870
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.638518e-01
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.2418 head_norm=1.827331 delta_norm=0.163852
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.0482 head_norm=1.677399
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.181783e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.0689 head_norm=1.565109 delta_norm=0.818178
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.987086 (no previous merge yet)
[S2] round=34 local utility u=0.567041 metrics={'f1_val': 0.26510952757983636, 'auprc': 0.26510952757983636, 'loss_val': 3.1026704570256776, 'psi': 0.26510952757983636}-{'f1_val': 0.21150668469280456, 'auprc': 0.21150668469280456, 'loss_val': 3.754326861786347, 'psi': 0.21150668469280456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=34 head_norm_before_train=1.903898 (no previous merge yet)
[S3] round=34 local utility u=0.010909 metrics={'f1_val': 0.2555894308943089, 'auprc': 0.2555894308943089, 'loss_val': 2.8859414545406423, 'psi': 0.2555894308943089}-{'f1_val': 0.2429071592418206, 'auprc': 0.2429071592418206, 'loss_val': 2.793618583432641, 'psi': 0.2429071592418206}
[S4] START round=34 head_norm_before_train=2.180200 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3345459999243128, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.325201648214446, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=1.845165 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.38796277759753, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3074664502916487, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.565109 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.676135 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.3461005865371165, 'psi': 0.017774699907663897}-{'f1_val': 0.04822664359861592, 'auprc': 0.04822664359861592, 'loss_val': 5.972437438029802, 'psi': 0.04822664359861592}
[S7] START round=34 head_norm_before_train=1.797847 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=34 local utility u=0.027223 metrics={'f1_val': 0.19696969696969696, 'auprc': 0.19696969696969696, 'loss_val': 0.8226886270181387, 'psi': 0.19696969696969696}-{'f1_val': 0.19255135342676138, 'auprc': 0.19255135342676138, 'loss_val': 0.837369467258603, 'psi': 0.19255135342676138}
[S8] START round=34 head_norm_before_train=2.131192 cos_to_last_merge=0.9973 (last merge round=25)
[S8] round=34 local utility u=0.004817 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5505399522772318, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5601731697828684, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=34 head_norm_before_train=1.515258 cos_to_last_merge=0.9965 (last merge round=30)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8159606208340355, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7747614916120251, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=1.827331 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.043817 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.367890600676885, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.45552498894612, 'psi': 0.241793804900601}
[S11] START round=34 head_norm_before_train=1.862472 (no previous merge yet)
[S11] round=34 local utility u=0.006711 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.6199799440643177, 'psi': 0.3320133550741517}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.6340932615537564, 'psi': 0.3320901320901321}
[S13] START round=34 head_norm_before_train=1.450342 cos_to_last_merge=0.9375 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.938
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2942164993151226, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2695770490205396, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.875926 cos_to_last_merge=0.9673 (last merge round=18)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.031807911007241, 'psi': 0.13333333333333333}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.971854995340198, 'psi': 0.1331327566754419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=2.210372 (no previous merge yet)
[S15] round=34 local utility u=0.069868 metrics={'f1_val': 0.8809083554976439, 'auprc': 0.8809083554976439, 'loss_val': 0.31221042531223775, 'psi': 0.8809083554976438}-{'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.4408056059612338, 'psi': 0.8796705340794291}
[S16] START round=34 head_norm_before_train=1.643686 cos_to_last_merge=0.9968 (last merge round=32)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.1105969458583989, 'auprc': 0.1105969458583989, 'loss_val': 2.575421745786264, 'psi': 0.11059694585839891}-{'f1_val': 0.0907563025210084, 'auprc': 0.0907563025210084, 'loss_val': 2.2875958146924984, 'psi': 0.0907563025210084}
[S17] START round=34 head_norm_before_train=1.572030 cos_to_last_merge=0.9810 (last merge round=27)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.2854395302907889, 'auprc': 0.2854395302907889, 'loss_val': 1.4859108295007506, 'psi': 0.2854395302907889}-{'f1_val': 0.4174529461215735, 'auprc': 0.4174529461215735, 'loss_val': 1.4267412502493084, 'psi': 0.4174529461215735}
[S6] not sending this round → trigger blocked (psi=0.018)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:40408
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[S7] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:40407
[S10] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1804) from S7
[S10] cosine check vs S7: cos=0.9986
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.9986
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.8269
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] cosine check vs S3: cos=-0.1126
[S4] DROPPED delta from S3 (cos=-0.1126 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=34 metric=0.2418 head_norm=1.862576
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.732339e-02
[S10] stored merged vector for next round verification (round=34)
[S10] DEBUG after merge:  round=34 metric=0.2418 head_norm=1.831802 delta_norm=0.057323
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.1970 head_norm=1.802327
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.732339e-02
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.1970 head_norm=1.831802 delta_norm=0.057323
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] cosine check vs S11: cos=0.8769
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.1106 head_norm=1.691488
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.290045e-01
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.0901 head_norm=1.871679 delta_norm=0.629004
[S16] aggregate: ROLLBACK (f1_val pre=0.111 post=0.090 tol_abs=0.005 tol_rel=0.0)
[S2] START round=35 head_norm_before_train=1.994205 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.2454789833822092, 'auprc': 0.2454789833822092, 'loss_val': 3.0480317375342505, 'psi': 0.2454789833822092}-{'f1_val': 0.26510952757983636, 'auprc': 0.26510952757983636, 'loss_val': 3.1026704570256776, 'psi': 0.26510952757983636}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.911891 (no previous merge yet)
[S3] round=35 local utility u=0.005041 metrics={'f1_val': 0.25413666792977135, 'auprc': 0.25413666792977135, 'loss_val': 2.862784076460359, 'psi': 0.25413666792977135}-{'f1_val': 0.2555894308943089, 'auprc': 0.2555894308943089, 'loss_val': 2.8859414545406423, 'psi': 0.2555894308943089}
[S4] START round=35 head_norm_before_train=2.200175 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3349774440058522, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3345459999243128, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=1.865234 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5363931269572073, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.38796277759753, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.615827 cos_to_last_merge=0.9983 (last merge round=33)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.032034050179211467, 'auprc': 0.032034050179211467, 'loss_val': 4.618329428352992, 'psi': 0.032034050179211467}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.3461005865371165, 'psi': 0.017774699907663897}
[S7] START round=35 head_norm_before_train=1.831802 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.703705 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8804255760945723, 'psi': 0.35976373724718097}-{'f1_val': 0.19696969696969696, 'auprc': 0.19696969696969696, 'loss_val': 0.8226886270181387, 'psi': 0.19696969696969696}
[S8] START round=35 head_norm_before_train=2.142835 cos_to_last_merge=0.9969 (last merge round=25)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5512110622201237, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5505399522772318, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.535914 cos_to_last_merge=0.9949 (last merge round=30)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8553614245001901, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8159606208340355, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=1.831802 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.403844274169924, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.367890600676885, 'psi': 0.241793804900601}
[S11] START round=35 head_norm_before_train=1.873629 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.654796088617393, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.6199799440643177, 'psi': 0.3320133550741517}
[S13] START round=35 head_norm_before_train=1.466226 cos_to_last_merge=0.9337 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.934
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.354110482414378, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2942164993151226, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.885488 cos_to_last_merge=0.9662 (last merge round=18)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.0880881048989695, 'psi': 0.1331327566754419}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.031807911007241, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=2.221830 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.8802896568133244, 'auprc': 0.8802896568133244, 'loss_val': 0.3509716969736641, 'psi': 0.8802896568133244}-{'f1_val': 0.8809083554976439, 'auprc': 0.8809083554976439, 'loss_val': 0.31221042531223775, 'psi': 0.8809083554976438}
[S16] START round=35 head_norm_before_train=1.871679 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.552100 metrics={'f1_val': 0.15119685602000715, 'auprc': 0.15119685602000715, 'loss_val': 1.836621766852837, 'psi': 0.15119685602000715}-{'f1_val': 0.1105969458583989, 'auprc': 0.1105969458583989, 'loss_val': 2.575421745786264, 'psi': 0.11059694585839891}
[S17] START round=35 head_norm_before_train=1.592572 cos_to_last_merge=0.9791 (last merge round=27)
[S17] round=35 local utility u=0.796188 metrics={'f1_val': 0.37853127799541775, 'auprc': 0.37853127799541775, 'loss_val': 0.7313614678525463, 'psi': 0.37853127799541775}-{'f1_val': 0.2854395302907889, 'auprc': 0.2854395302907889, 'loss_val': 1.4859108295007506, 'psi': 0.2854395302907889}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.360)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.254)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S4] ⇄ pheromone p=0.002 → S3@127.0.0.1:40403
[S3] ⇄ pheromone p=0.068 → S4@127.0.0.1:40404
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.0320 head_norm=1.685341
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.972236e-01
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.0490 head_norm=1.711198 delta_norm=0.497224
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.221 → S11@127.0.0.1:40412
[S7] ⇄ pheromone p=0.191 → S10@127.0.0.1:40411
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.012 → S7@127.0.0.1:40408
[S16] not sending this round → trigger blocked (psi=0.151)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.151 → S16@127.0.0.1:40416
[S11] ⇄ pheromone p=0.007 → S6@127.0.0.1:40407
[S9] ⇄ pheromone p=0.030 → S13@127.0.0.1:40413
[S16] ⇄ pheromone p=0.237 → S15@127.0.0.1:40415
[S2] START round=36 head_norm_before_train=2.001420 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 3.1006889808640374, 'psi': 0.24520932503356518}-{'f1_val': 0.2454789833822092, 'auprc': 0.2454789833822092, 'loss_val': 3.0480317375342505, 'psi': 0.2454789833822092}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.919885 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2555894308943089, 'auprc': 0.2555894308943089, 'loss_val': 2.892754348524197, 'psi': 0.2555894308943089}-{'f1_val': 0.25413666792977135, 'auprc': 0.25413666792977135, 'loss_val': 2.862784076460359, 'psi': 0.25413666792977135}
[S4] START round=36 head_norm_before_train=2.214310 (no previous merge yet)
[S4] round=36 local utility u=0.006224 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.322529404829852, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3349774440058522, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=1.891050 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.631906663144601, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5363931269572073, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.711198 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.112931 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 4.305807312230707, 'psi': 0.02240512117055327}-{'f1_val': 0.032034050179211467, 'auprc': 0.032034050179211467, 'loss_val': 4.618329428352992, 'psi': 0.032034050179211467}
[S7] START round=36 head_norm_before_train=1.837559 cos_to_last_merge=0.9999 (last merge round=34)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8896719179703386, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8804255760945723, 'psi': 0.35976373724718097}
[S8] START round=36 head_norm_before_train=2.157840 cos_to_last_merge=0.9964 (last merge round=25)
[S8] round=36 local utility u=0.003234 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5447426011042528, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5512110622201237, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=36 head_norm_before_train=1.553691 cos_to_last_merge=0.9936 (last merge round=30)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8922682120863614, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8553614245001901, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=1.870100 cos_to_last_merge=0.9996 (last merge round=34)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.460889527713381, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.403844274169924, 'psi': 0.241793804900601}
[S11] START round=36 head_norm_before_train=1.884325 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.33216810378311196, 'auprc': 0.33216810378311196, 'loss_val': 3.6896176058794246, 'psi': 0.33216810378311196}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.654796088617393, 'psi': 0.3320133550741517}
[S13] START round=36 head_norm_before_train=1.491543 cos_to_last_merge=0.9283 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.928
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3825988541550935, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.354110482414378, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.894812 cos_to_last_merge=0.9651 (last merge round=18)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.136812847738553, 'psi': 0.13333333333333333}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 5.0880881048989695, 'psi': 0.1331327566754419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=2.234100 (no previous merge yet)
[S15] round=36 local utility u=0.005896 metrics={'f1_val': 0.8805990590644588, 'auprc': 0.8805990590644588, 'loss_val': 0.34196334315638416, 'psi': 0.8805990590644588}-{'f1_val': 0.8802896568133244, 'auprc': 0.8802896568133244, 'loss_val': 0.3509716969736641, 'psi': 0.8802896568133244}
[S16] START round=36 head_norm_before_train=1.901377 cos_to_last_merge=0.9977 (last merge round=34)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.06907571288102261, 'auprc': 0.06907571288102261, 'loss_val': 2.5031948509068385, 'psi': 0.06907571288102261}-{'f1_val': 0.15119685602000715, 'auprc': 0.15119685602000715, 'loss_val': 1.836621766852837, 'psi': 0.15119685602000715}
[S17] START round=36 head_norm_before_train=1.616642 cos_to_last_merge=0.9770 (last merge round=27)
[S17] round=36 local utility u=0.063557 metrics={'f1_val': 0.4708527349923941, 'auprc': 0.4708527349923941, 'loss_val': 1.4351402767965795, 'psi': 0.4708527349923941}-{'f1_val': 0.37853127799541775, 'auprc': 0.37853127799541775, 'loss_val': 0.7313614678525463, 'psi': 0.37853127799541775}
[S17]  timeout peer S9
[S9]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:40416
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:40403
[S17] not sending this round → trigger blocked (psi=0.471)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S15
[S16] cosine check vs S15: cos=0.9373
[S3] RECEIVED delta(kind=head bytes=1796) from S4
[S3] cosine check vs S4: cos=-0.1129
[S3] DROPPED delta from S4 (cos=-0.1129 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.0691 head_norm=1.937190
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.001441e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.0679 head_norm=2.058527 delta_norm=0.400144
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=2.008754 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.1979891724671307, 'auprc': 0.1979891724671307, 'loss_val': 4.394310562610205, 'psi': 0.1979891724671307}-{'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 3.1006889808640374, 'psi': 0.24520932503356518}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.928068 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.2564690885914595, 'auprc': 0.2564690885914595, 'loss_val': 2.9732444569691405, 'psi': 0.2564690885914595}-{'f1_val': 0.2555894308943089, 'auprc': 0.2555894308943089, 'loss_val': 2.892754348524197, 'psi': 0.2555894308943089}
[S4] START round=37 head_norm_before_train=2.222656 (no previous merge yet)
[S4] round=37 local utility u=0.005336 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.31185658413923, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.322529404829852, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=1.917809 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.656839202548586, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.631906663144601, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.788962 cos_to_last_merge=0.9945 (last merge round=35)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.03474387527839644, 'auprc': 0.03474387527839644, 'loss_val': 4.947578703513403, 'psi': 0.03474387527839644}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 4.305807312230707, 'psi': 0.02240512117055327}
[S7] START round=37 head_norm_before_train=1.844616 cos_to_last_merge=0.9997 (last merge round=34)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.18773373223635004, 'auprc': 0.18773373223635004, 'loss_val': 0.8409277735805597, 'psi': 0.18773373223635004}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8896719179703386, 'psi': 0.35976373724718097}
[S8] START round=37 head_norm_before_train=2.170592 cos_to_last_merge=0.9960 (last merge round=25)
[S8] round=37 local utility u=0.001508 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5417271574524044, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5447426011042528, 'psi': 0.35939447907390915}
[S8] not sending this round → trigger blocked (psi=0.359)
[S9] START round=37 head_norm_before_train=1.569219 cos_to_last_merge=0.9924 (last merge round=30)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9320979643615783, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8922682120863614, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=1.905195 cos_to_last_merge=0.9988 (last merge round=34)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.51307667639724, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.460889527713381, 'psi': 0.241793804900601}
[S11] START round=37 head_norm_before_train=1.894370 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.33216810378311196, 'auprc': 0.33216810378311196, 'loss_val': 3.7105864931132064, 'psi': 0.33216810378311196}-{'f1_val': 0.33216810378311196, 'auprc': 0.33216810378311196, 'loss_val': 3.6896176058794246, 'psi': 0.33216810378311196}
[S13] START round=37 head_norm_before_train=1.511101 cos_to_last_merge=0.9239 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.924
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.412367064149842, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3825988541550935, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.903894 cos_to_last_merge=0.9640 (last merge round=18)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.182883966979843, 'psi': 0.13333333333333333}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.136812847738553, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=2.245572 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.44107043266673207, 'psi': 0.8796705340794291}-{'f1_val': 0.8805990590644588, 'auprc': 0.8805990590644588, 'loss_val': 0.34196334315638416, 'psi': 0.8805990590644588}
[S16] START round=37 head_norm_before_train=2.058527 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.645705 metrics={'f1_val': 0.15885660731021556, 'auprc': 0.15885660731021556, 'loss_val': 2.019813437883004, 'psi': 0.15885660731021556}-{'f1_val': 0.06907571288102261, 'auprc': 0.06907571288102261, 'loss_val': 2.5031948509068385, 'psi': 0.06907571288102261}
[S17] START round=37 head_norm_before_train=1.630005 cos_to_last_merge=0.9757 (last merge round=27)
[S17] round=37 local utility u=0.124016 metrics={'f1_val': 0.5013495014999667, 'auprc': 0.5013495014999667, 'loss_val': 1.4615793702102577, 'psi': 0.5013495014999667}-{'f1_val': 0.4708527349923941, 'auprc': 0.4708527349923941, 'loss_val': 1.4351402767965795, 'psi': 0.4708527349923941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.357)
[S16] not sending this round → trigger blocked (psi=0.159)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=2.015131 (no previous merge yet)
[S2] round=38 local utility u=0.931768 metrics={'f1_val': 0.2591087895788999, 'auprc': 0.2591087895788999, 'loss_val': 3.080850922193817, 'psi': 0.2591087895788999}-{'f1_val': 0.1979891724671307, 'auprc': 0.1979891724671307, 'loss_val': 4.394310562610205, 'psi': 0.1979891724671307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=38 head_norm_before_train=1.934531 (no previous merge yet)
[S3] round=38 local utility u=0.027485 metrics={'f1_val': 0.2557843885075006, 'auprc': 0.2557843885075006, 'loss_val': 2.9121126737955056, 'psi': 0.2557843885075006}-{'f1_val': 0.2564690885914595, 'auprc': 0.2564690885914595, 'loss_val': 2.9732444569691405, 'psi': 0.2564690885914595}
[S4] START round=38 head_norm_before_train=2.229608 (no previous merge yet)
[S4] round=38 local utility u=0.000014 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.311829169679099, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.31185658413923, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=1.942240 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.712949439995793, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.656839202548586, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.867903 cos_to_last_merge=0.9839 (last merge round=35)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.023494525547445255, 'auprc': 0.023494525547445255, 'loss_val': 5.768357022409507, 'psi': 0.023494525547445255}-{'f1_val': 0.03474387527839644, 'auprc': 0.03474387527839644, 'loss_val': 4.947578703513403, 'psi': 0.03474387527839644}
[S7] START round=38 head_norm_before_train=1.851446 cos_to_last_merge=0.9995 (last merge round=34)
[S7] round=38 local utility u=0.061134 metrics={'f1_val': 0.1981020166073547, 'auprc': 0.1981020166073547, 'loss_val': 0.8119750919930947, 'psi': 0.1981020166073547}-{'f1_val': 0.18773373223635004, 'auprc': 0.18773373223635004, 'loss_val': 0.8409277735805597, 'psi': 0.18773373223635004}
[S8] START round=38 head_norm_before_train=2.180013 cos_to_last_merge=0.9956 (last merge round=25)
[S8] round=38 local utility u=0.005798 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5301315326584705, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5417271574524044, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=38 head_norm_before_train=1.582944 cos_to_last_merge=0.9914 (last merge round=30)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9757880196630344, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9320979643615783, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=1.936648 cos_to_last_merge=0.9977 (last merge round=34)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.5777933123377137, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.51307667639724, 'psi': 0.241793804900601}
[S11] START round=38 head_norm_before_train=1.904075 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.7188885782489147, 'psi': 0.3320133550741517}-{'f1_val': 0.33216810378311196, 'auprc': 0.33216810378311196, 'loss_val': 3.7105864931132064, 'psi': 0.33216810378311196}
[S13] START round=38 head_norm_before_train=1.527599 cos_to_last_merge=0.9201 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.920
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4357360104565815, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.412367064149842, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.912566 cos_to_last_merge=0.9630 (last merge round=18)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.227362597950137, 'psi': 0.13333333333333333}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.182883966979843, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=2.256397 (no previous merge yet)
[S15] round=38 local utility u=0.056312 metrics={'f1_val': 0.8809083554976439, 'auprc': 0.8809083554976439, 'loss_val': 0.3395863628765952, 'psi': 0.8809083554976438}-{'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.44107043266673207, 'psi': 0.8796705340794291}
[S16] START round=38 head_norm_before_train=2.085997 cos_to_last_merge=0.9987 (last merge round=36)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.13214285714285715, 'auprc': 0.13214285714285715, 'loss_val': 2.4563452194126847, 'psi': 0.13214285714285715}-{'f1_val': 0.15885660731021556, 'auprc': 0.15885660731021556, 'loss_val': 2.019813437883004, 'psi': 0.15885660731021556}
[S17] START round=38 head_norm_before_train=1.649362 cos_to_last_merge=0.9739 (last merge round=27)
[S17] round=38 local utility u=1.000000 metrics={'f1_val': 0.7737554975381542, 'auprc': 0.7737554975381542, 'loss_val': 0.7319294837619313, 'psi': 0.7737554975381542}-{'f1_val': 0.5013495014999667, 'auprc': 0.5013495014999667, 'loss_val': 1.4615793702102577, 'psi': 0.5013495014999667}
[S17] not sending this round → trigger blocked (psi=0.774)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:40403
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=0.9962
[S16] RECEIVED delta(kind=head bytes=1795) from S15
[S16] cosine check vs S15: cos=0.9687
[S3] RECEIVED delta(kind=head bytes=1794) from S4
[S3] cosine check vs S4: cos=-0.1131
[S3] DROPPED delta from S4 (cos=-0.1131 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=-0.1131
[S4] DROPPED delta from S3 (cos=-0.1131 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.1321 head_norm=2.115547
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.841810e-01
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.1186 head_norm=2.174101 delta_norm=0.284181
[S16] aggregate: ROLLBACK (f1_val pre=0.132 post=0.119 tol_abs=0.005 tol_rel=0.0)
[S2] START round=39 head_norm_before_train=2.021360 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.1928996754694423, 'psi': 0.2450298816928894}-{'f1_val': 0.2591087895788999, 'auprc': 0.2591087895788999, 'loss_val': 3.080850922193817, 'psi': 0.2591087895788999}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.245 u=0.0000 p_local=0.2077 f1=0.245 auprc=0.245 bytes=26984
[S3] START round=39 head_norm_before_train=1.940747 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.2562730862310534, 'auprc': 0.2562730862310534, 'loss_val': 2.9644506725155857, 'psi': 0.2562730862310534}-{'f1_val': 0.2557843885075006, 'auprc': 0.2557843885075006, 'loss_val': 2.9121126737955056, 'psi': 0.2557843885075006}
[S4] START round=39 head_norm_before_train=2.242335 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3161620491251784, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.311829169679099, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=1.962473 (no previous merge yet)
[S5] round=39 local utility u=0.032073 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6488033831518876, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.712949439995793, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S5] r=40 psi=0.334 u=0.0321 p_local=0.0172 f1=0.334 auprc=0.334 bytes=21577
[S6] START round=39 head_norm_before_train=1.922101 cos_to_last_merge=0.9762 (last merge round=35)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.143193828963411, 'psi': 0.017774699907663897}-{'f1_val': 0.023494525547445255, 'auprc': 0.023494525547445255, 'loss_val': 5.768357022409507, 'psi': 0.023494525547445255}
[S7] START round=39 head_norm_before_train=1.857925 cos_to_last_merge=0.9993 (last merge round=34)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.18140712606257914, 'auprc': 0.18140712606257914, 'loss_val': 0.868789146969027, 'psi': 0.18140712606257914}-{'f1_val': 0.1981020166073547, 'auprc': 0.1981020166073547, 'loss_val': 0.8119750919930947, 'psi': 0.1981020166073547}
[S8] START round=39 head_norm_before_train=2.190213 cos_to_last_merge=0.9952 (last merge round=25)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5436051840652284, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5301315326584705, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0040 f1=0.359 auprc=0.359 bytes=39632
[S9] START round=39 head_norm_before_train=1.595073 cos_to_last_merge=0.9905 (last merge round=30)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0231652420902564, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9757880196630344, 'psi': 0.36867172340800847}
[S10] START round=39 head_norm_before_train=1.964358 cos_to_last_merge=0.9966 (last merge round=34)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.624981310959494, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.5777933123377137, 'psi': 0.241793804900601}
[S11] START round=39 head_norm_before_train=1.913731 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.741573755737573, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.7188885782489147, 'psi': 0.3320133550741517}
[S13] START round=39 head_norm_before_train=1.537953 cos_to_last_merge=0.9177 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.918
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4428529527681377, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4357360104565815, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0011 f1=0.360 auprc=0.360 bytes=14399
[S14] START round=39 head_norm_before_train=1.920803 cos_to_last_merge=0.9620 (last merge round=18)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.272753691763284, 'psi': 0.13333333333333333}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.227362597950137, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.133 u=0.0000 p_local=0.0033 f1=0.133 auprc=0.133 bytes=0
[S15] START round=39 head_norm_before_train=2.267027 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6455349800322157, 'auprc': 0.6455349800322157, 'loss_val': 0.1023805199297905, 'psi': 0.6455349800322157}-{'f1_val': 0.8809083554976439, 'auprc': 0.8809083554976439, 'loss_val': 0.3395863628765952, 'psi': 0.8809083554976438}
[S16] START round=39 head_norm_before_train=2.174101 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.10114973993977552, 'auprc': 0.10114973993977552, 'loss_val': 2.3992521434619407, 'psi': 0.10114973993977552}-{'f1_val': 0.13214285714285715, 'auprc': 0.13214285714285715, 'loss_val': 2.4563452194126847, 'psi': 0.13214285714285715}
[S17] START round=39 head_norm_before_train=1.669791 cos_to_last_merge=0.9725 (last merge round=27)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.3485803246883312, 'auprc': 0.3485803246883312, 'loss_val': 1.6967602613991362, 'psi': 0.3485803246883312}-{'f1_val': 0.7737554975381542, 'auprc': 0.7737554975381542, 'loss_val': 0.7319294837619313, 'psi': 0.7737554975381542}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.349 u=0.0000 p_local=0.3201 f1=0.349 auprc=0.349 bytes=41463
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.018 u=0.0000 p_local=0.1019 f1=0.018 auprc=0.018 bytes=0
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0123 f1=0.369 auprc=0.369 bytes=14394
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0021 f1=0.357 auprc=0.357 bytes=25209
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=39 metric=0.2418 head_norm=1.988447
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.155266e-01
[S10] stored merged vector for next round verification (round=39)
[S10] DEBUG after merge:  round=39 metric=0.2418 head_norm=1.920822 delta_norm=0.115527
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] r=40 psi=0.242 u=0.0000 p_local=0.0048 f1=0.242 auprc=0.242 bytes=25193
[S7] r=40 psi=0.181 u=0.0000 p_local=0.0879 f1=0.181 auprc=0.181 bytes=27000
[S15] r=40 psi=0.646 u=0.0000 p_local=0.0716 f1=0.646 auprc=0.646 bytes=28761
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.256 u=0.0000 p_local=0.0322 f1=0.256 auprc=0.256 bytes=12599
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0027 f1=0.332 auprc=0.332 bytes=14407
[S16] r=40 psi=0.101 u=0.0000 p_local=0.1796 f1=0.101 auprc=0.101 bytes=0
[S2] START round=40 head_norm_before_train=2.025838 (no previous merge yet)
[S2] round=40 local utility u=0.083364 metrics={'f1_val': 0.26510952757983636, 'auprc': 0.26510952757983636, 'loss_val': 3.2068881099504214, 'psi': 0.26510952757983636}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.1928996754694423, 'psi': 0.2450298816928894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=40 head_norm_before_train=1.946500 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.2561262809496531, 'auprc': 0.2561262809496531, 'loss_val': 2.963920935435418, 'psi': 0.2561262809496531}-{'f1_val': 0.2562730862310534, 'auprc': 0.2562730862310534, 'loss_val': 2.9644506725155857, 'psi': 0.2562730862310534}
[S4] START round=40 head_norm_before_train=2.254945 (no previous merge yet)
[S4] round=40 local utility u=0.007189 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3017840307265713, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3161620491251784, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=1.978413 (no previous merge yet)
[S5] round=40 local utility u=0.030364 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.58807509580371, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6488033831518876, 'psi': 0.3335071121394324}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=40 head_norm_before_train=1.957100 cos_to_last_merge=0.9714 (last merge round=35)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 6.263793487733176, 'psi': 0.01799723119520074}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.143193828963411, 'psi': 0.017774699907663897}
[S7] START round=40 head_norm_before_train=1.865271 cos_to_last_merge=0.9992 (last merge round=34)
[S7] round=40 local utility u=0.082571 metrics={'f1_val': 0.1949037152304999, 'auprc': 0.1949037152304999, 'loss_val': 0.8251162428192341, 'psi': 0.1949037152304999}-{'f1_val': 0.18140712606257914, 'auprc': 0.18140712606257914, 'loss_val': 0.868789146969027, 'psi': 0.18140712606257914}
[S8] START round=40 head_norm_before_train=2.198656 cos_to_last_merge=0.9948 (last merge round=25)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5500707379411985, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5436051840652284, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.605976 cos_to_last_merge=0.9896 (last merge round=30)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0514025295355642, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0231652420902564, 'psi': 0.36867172340800847}
[S10] START round=40 head_norm_before_train=1.920822 cos_to_last_merge=1.0000 (last merge round=39)
[S10] round=40 local utility u=0.022682 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.57961755986584, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.624981310959494, 'psi': 0.241793804900601}
[S11] START round=40 head_norm_before_train=1.922627 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 3.8032440414787674, 'psi': 0.33216756042589574}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.741573755737573, 'psi': 0.3320133550741517}
[S13] START round=40 head_norm_before_train=1.549115 cos_to_last_merge=0.9155 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.915
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4597585297683549, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4428529527681377, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.928614 cos_to_last_merge=0.9611 (last merge round=18)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.319717235517919, 'psi': 0.13333333333333333}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.272753691763284, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=2.277072 (no previous merge yet)
[S15] round=40 local utility u=0.981759 metrics={'f1_val': 0.881835611830256, 'auprc': 0.881835611830256, 'loss_val': 0.2655680803115229, 'psi': 0.881835611830256}-{'f1_val': 0.6455349800322157, 'auprc': 0.6455349800322157, 'loss_val': 0.1023805199297905, 'psi': 0.6455349800322157}
[S16] START round=40 head_norm_before_train=2.199119 cos_to_last_merge=0.9993 (last merge round=38)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.06801249699591444, 'auprc': 0.06801249699591444, 'loss_val': 3.0761551584951032, 'psi': 0.06801249699591444}-{'f1_val': 0.10114973993977552, 'auprc': 0.10114973993977552, 'loss_val': 2.3992521434619407, 'psi': 0.10114973993977552}
[S17] START round=40 head_norm_before_train=1.679793 cos_to_last_merge=0.9718 (last merge round=27)
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.6089321034825819, 'auprc': 0.6089321034825819, 'loss_val': 1.1421061361914344, 'psi': 0.6089321034825819}-{'f1_val': 0.3485803246883312, 'auprc': 0.3485803246883312, 'loss_val': 1.6967602613991362, 'psi': 0.3485803246883312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:40416
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:40403
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1795 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] ⇄ pheromone p=0.082 → S11@127.0.0.1:40412
[S9] ⇄ pheromone p=0.010 → S13@127.0.0.1:40413
[S3] ⇄ pheromone p=0.026 → S4@127.0.0.1:40404
[S10] RECEIVED delta(kind=head bytes=1803) from S7
[S10] cosine check vs S7: cos=0.9978
[S16] RECEIVED delta(kind=head bytes=1795) from S15
[S16] cosine check vs S15: cos=0.9829
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.9978
[S3] RECEIVED delta(kind=head bytes=1795) from S4
[S3] cosine check vs S4: cos=-0.1125
[S3] DROPPED delta from S4 (cos=-0.1125 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=40 metric=0.2418 head_norm=1.944918
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.354286e-02
[S10] stored merged vector for next round verification (round=40)
[S10] DEBUG after merge:  round=40 metric=0.2418 head_norm=1.907589 delta_norm=0.073543
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.008 → S7@127.0.0.1:40408
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.1949 head_norm=1.872405
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.354285e-02
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.1951 head_norm=1.907589 delta_norm=0.073543
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.087 → S10@127.0.0.1:40411
[S15] ⇄ pheromone p=0.254 → S16@127.0.0.1:40416
[S4] ⇄ pheromone p=0.003 → S3@127.0.0.1:40403
[S11] ⇄ pheromone p=0.002 → S6@127.0.0.1:40407
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=40 metric=0.0680 head_norm=2.225896
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.109189e-01
[S16] stored merged vector for next round verification (round=40)
[S16] DEBUG after merge:  round=40 metric=0.0906 head_norm=2.246127 delta_norm=0.210919
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.144 → S15@127.0.0.1:40415
[S2] START round=41 head_norm_before_train=2.029187 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.372835620673426, 'psi': 0.2653978324081417}-{'f1_val': 0.26510952757983636, 'auprc': 0.26510952757983636, 'loss_val': 3.2068881099504214, 'psi': 0.26510952757983636}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.952997 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.2556868725378066, 'auprc': 0.2556868725378066, 'loss_val': 2.96637837625341, 'psi': 0.2556868725378066}-{'f1_val': 0.2561262809496531, 'auprc': 0.2561262809496531, 'loss_val': 2.963920935435418, 'psi': 0.2561262809496531}
[S4] START round=41 head_norm_before_train=2.257802 (no previous merge yet)
[S4] round=41 local utility u=0.007184 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2874167514412318, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3017840307265713, 'psi': 0.3567939207526687}
[S5] START round=41 head_norm_before_train=1.992694 (no previous merge yet)
[S5] round=41 local utility u=0.007403 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.573269673096884, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.58807509580371, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=41 head_norm_before_train=1.981025 cos_to_last_merge=0.9684 (last merge round=35)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.329490443457965, 'psi': 0.021967963386727688}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 6.263793487733176, 'psi': 0.01799723119520074}
[S7] START round=41 head_norm_before_train=1.907589 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.19349546419610114, 'auprc': 0.19349546419610114, 'loss_val': 0.8183666444315009, 'psi': 0.19349546419610114}-{'f1_val': 0.1949037152304999, 'auprc': 0.1949037152304999, 'loss_val': 0.8251162428192341, 'psi': 0.1949037152304999}
[S8] START round=41 head_norm_before_train=2.207497 cos_to_last_merge=0.9944 (last merge round=25)
[S8] round=41 local utility u=0.012418 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5252354280430338, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5500707379411985, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=41 head_norm_before_train=1.616008 cos_to_last_merge=0.9888 (last merge round=30)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.07815734137715, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0514025295355642, 'psi': 0.36867172340800847}
[S10] START round=41 head_norm_before_train=1.907589 cos_to_last_merge=1.0000 (last merge round=40)
[S10] round=41 local utility u=0.001891 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.575834785898881, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.57961755986584, 'psi': 0.241793804900601}
[S11] START round=41 head_norm_before_train=1.931163 (no previous merge yet)
[S11] round=41 local utility u=0.041793 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.718269341380567, 'psi': 0.3320133550741517}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 3.8032440414787674, 'psi': 0.33216756042589574}
[S13] START round=41 head_norm_before_train=1.561779 cos_to_last_merge=0.9129 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.913
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.485249267626249, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4597585297683549, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.935948 cos_to_last_merge=0.9603 (last merge round=18)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.365374223677379, 'psi': 0.13333333333333333}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.319717235517919, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.285724 (no previous merge yet)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8815266316866779, 'auprc': 0.8815266316866779, 'loss_val': 0.369720421615523, 'psi': 0.8815266316866779}-{'f1_val': 0.881835611830256, 'auprc': 0.881835611830256, 'loss_val': 0.2655680803115229, 'psi': 0.881835611830256}
[S16] START round=41 head_norm_before_train=2.246127 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=41 local utility u=0.515232 metrics={'f1_val': 0.13371749408983452, 'auprc': 0.13371749408983452, 'loss_val': 2.6370352689583902, 'psi': 0.13371749408983452}-{'f1_val': 0.06801249699591444, 'auprc': 0.06801249699591444, 'loss_val': 3.0761551584951032, 'psi': 0.06801249699591444}
[S17] START round=41 head_norm_before_train=1.696403 cos_to_last_merge=0.9706 (last merge round=27)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.40102266937933323, 'auprc': 0.40102266937933323, 'loss_val': 1.4901255365866557, 'psi': 0.40102266937933323}-{'f1_val': 0.6089321034825819, 'auprc': 0.6089321034825819, 'loss_val': 1.1421061361914344, 'psi': 0.6089321034825819}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.242)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.357)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.134)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:40407
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] cosine check vs S11: cos=0.8724
[S2] START round=42 head_norm_before_train=2.034567 (no previous merge yet)
[S2] round=42 local utility u=0.003024 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.3667871398091127, 'psi': 0.2653978324081417}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.372835620673426, 'psi': 0.2653978324081417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=42 head_norm_before_train=1.959534 (no previous merge yet)
[S3] round=42 local utility u=0.007248 metrics={'f1_val': 0.25351225351225354, 'auprc': 0.25351225351225354, 'loss_val': 2.9323114358812052, 'psi': 0.25351225351225354}-{'f1_val': 0.2556868725378066, 'auprc': 0.2556868725378066, 'loss_val': 2.96637837625341, 'psi': 0.2556868725378066}
[S4] START round=42 head_norm_before_train=2.261429 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2912842773082185, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2874167514412318, 'psi': 0.3567939207526687}
[S5] START round=42 head_norm_before_train=2.010349 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.635161558607888, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.573269673096884, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.999485 cos_to_last_merge=0.9661 (last merge round=35)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 6.389210681168093, 'psi': 0.023059360730593607}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.329490443457965, 'psi': 0.021967963386727688}
[S7] START round=42 head_norm_before_train=1.913202 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=42 local utility u=0.084299 metrics={'f1_val': 0.2080655193862741, 'auprc': 0.2080655193862741, 'loss_val': 0.7808995570340971, 'psi': 0.2080655193862741}-{'f1_val': 0.19349546419610114, 'auprc': 0.19349546419610114, 'loss_val': 0.8183666444315009, 'psi': 0.19349546419610114}
[S8] START round=42 head_norm_before_train=2.217882 cos_to_last_merge=0.9940 (last merge round=25)
[S8] round=42 local utility u=0.008589 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5080565165663977, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5252354280430338, 'psi': 0.35939447907390915}
[S8] not sending this round → trigger blocked (psi=0.359)
[S9] START round=42 head_norm_before_train=1.625444 cos_to_last_merge=0.9880 (last merge round=30)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1029415150002535, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.07815734137715, 'psi': 0.36867172340800847}
[S10] START round=42 head_norm_before_train=1.933778 cos_to_last_merge=0.9999 (last merge round=40)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.623435497620584, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.575834785898881, 'psi': 0.241793804900601}
[S11] START round=42 head_norm_before_train=1.938629 (no previous merge yet)
[S11] round=42 local utility u=0.003287 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.711696230768077, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.718269341380567, 'psi': 0.3320133550741517}
[S13] START round=42 head_norm_before_train=1.571896 cos_to_last_merge=0.9108 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.911
[S13] round=42 local utility u=0.004103 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4770436673566132, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.485249267626249, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=42 head_norm_before_train=1.942971 cos_to_last_merge=0.9595 (last merge round=18)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.410767243245556, 'psi': 0.13333333333333333}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.365374223677379, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.293994 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.47781241152942966, 'psi': 0.8796705340794291}-{'f1_val': 0.8815266316866779, 'auprc': 0.8815266316866779, 'loss_val': 0.369720421615523, 'psi': 0.8815266316866779}
[S16] START round=42 head_norm_before_train=2.268607 cos_to_last_merge=0.9996 (last merge round=40)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.10051040439733018, 'auprc': 0.10051040439733018, 'loss_val': 3.0925990626835604, 'psi': 0.10051040439733018}-{'f1_val': 0.13371749408983452, 'auprc': 0.13371749408983452, 'loss_val': 2.6370352689583902, 'psi': 0.13371749408983452}
[S17] START round=42 head_norm_before_train=1.712859 cos_to_last_merge=0.9695 (last merge round=27)
[S17] round=42 local utility u=1.000000 metrics={'f1_val': 0.7465430227242772, 'auprc': 0.7465430227242772, 'loss_val': 0.7754045492420638, 'psi': 0.7465430227242772}-{'f1_val': 0.40102266937933323, 'auprc': 0.40102266937933323, 'loss_val': 1.4901255365866557, 'psi': 0.40102266937933323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:40411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.332)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.0231 head_norm=2.014902
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.073514e-01
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.0248 head_norm=1.910930 delta_norm=0.507351
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1800) from S3
[S4] cosine check vs S3: cos=-0.1125
[S4] DROPPED delta from S3 (cos=-0.1125 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=0.9995
[S2] START round=43 head_norm_before_train=2.040718 (no previous merge yet)
[S2] round=43 local utility u=0.048247 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 3.2700623045733415, 'psi': 0.26537216828478966}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 3.3667871398091127, 'psi': 0.2653978324081417}
[S2] not sending this round → trigger blocked (psi=0.265)
[S3] START round=43 head_norm_before_train=1.966115 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.253848094877618, 'auprc': 0.253848094877618, 'loss_val': 2.972309971591164, 'psi': 0.253848094877618}-{'f1_val': 0.25351225351225354, 'auprc': 0.25351225351225354, 'loss_val': 2.9323114358812052, 'psi': 0.25351225351225354}
[S4] START round=43 head_norm_before_train=2.275632 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3007107919337362, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2912842773082185, 'psi': 0.3567939207526687}
[S5] START round=43 head_norm_before_train=2.028168 (no previous merge yet)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7260814302229557, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.635161558607888, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.910930 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=0.859452 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.622743782799672, 'psi': 0.017774699907663897}-{'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 6.389210681168093, 'psi': 0.023059360730593607}
[S7] START round=43 head_norm_before_train=1.918154 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.19653349001175088, 'auprc': 0.19653349001175088, 'loss_val': 0.8112365926594164, 'psi': 0.19653349001175088}-{'f1_val': 0.2080655193862741, 'auprc': 0.2080655193862741, 'loss_val': 0.7808995570340971, 'psi': 0.2080655193862741}
[S8] START round=43 head_norm_before_train=2.227968 cos_to_last_merge=0.9936 (last merge round=25)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5219886864488433, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5080565165663977, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.634224 cos_to_last_merge=0.9873 (last merge round=30)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.124425269772758, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1029415150002535, 'psi': 0.36867172340800847}
[S10] START round=43 head_norm_before_train=1.960130 cos_to_last_merge=0.9995 (last merge round=40)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.673878340762494, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.623435497620584, 'psi': 0.241793804900601}
[S11] START round=43 head_norm_before_train=1.945831 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.8463668145302194, 'psi': 0.3320901320901321}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.711696230768077, 'psi': 0.3320133550741517}
[S13] START round=43 head_norm_before_train=1.579677 cos_to_last_merge=0.9092 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.909
[S13] round=43 local utility u=0.001223 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4745978277614717, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4770436673566132, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] sending update (kind=head size=1808 to 1 peers)
[S14] START round=43 head_norm_before_train=1.949723 cos_to_last_merge=0.9588 (last merge round=18)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.452242216730167, 'psi': 0.13333333333333333}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.410767243245556, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=2.301943 (no previous merge yet)
[S15] round=43 local utility u=0.029155 metrics={'f1_val': 0.8802896568133244, 'auprc': 0.8802896568133244, 'loss_val': 0.4250741197140166, 'psi': 0.8802896568133244}-{'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.47781241152942966, 'psi': 0.8796705340794291}
[S16] START round=43 head_norm_before_train=2.290838 cos_to_last_merge=0.9986 (last merge round=40)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.09101796407185629, 'auprc': 0.09101796407185629, 'loss_val': 3.4131865426864163, 'psi': 0.09101796407185629}-{'f1_val': 0.10051040439733018, 'auprc': 0.10051040439733018, 'loss_val': 3.0925990626835604, 'psi': 0.10051040439733018}
[S17] START round=43 head_norm_before_train=1.724821 cos_to_last_merge=0.9685 (last merge round=27)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5600130533810842, 'auprc': 0.5600130533810842, 'loss_val': 1.3431615345209202, 'psi': 0.5600130533810842}-{'f1_val': 0.7465430227242772, 'auprc': 0.7465430227242772, 'loss_val': 0.7754045492420638, 'psi': 0.7465430227242772}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:40416
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=43 metric=0.2418 head_norm=1.984911
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.513001e-02
[S10] stored merged vector for next round verification (round=43)
[S10] DEBUG after merge:  round=43 metric=0.2418 head_norm=1.951039 delta_norm=0.055130
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1792 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1792) from S15
[S16] cosine check vs S15: cos=0.9874
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=43 metric=0.0910 head_norm=2.309450
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.834151e-01
[S16] stored merged vector for next round verification (round=43)
[S16] DEBUG after merge:  round=43 metric=0.0916 head_norm=2.302236 delta_norm=0.183415
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=2.047056 (no previous merge yet)
[S2] round=44 local utility u=0.035746 metrics={'f1_val': 0.2643247154792448, 'auprc': 0.2643247154792448, 'loss_val': 3.189143632427549, 'psi': 0.2643247154792448}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 3.2700623045733415, 'psi': 0.26537216828478966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=44 head_norm_before_train=1.972755 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.2541848272376982, 'auprc': 0.2541848272376982, 'loss_val': 2.998427616441938, 'psi': 0.2541848272376982}-{'f1_val': 0.253848094877618, 'auprc': 0.253848094877618, 'loss_val': 2.972309971591164, 'psi': 0.253848094877618}
[S4] START round=44 head_norm_before_train=2.282057 (no previous merge yet)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3068768098112817, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3007107919337362, 'psi': 0.3567939207526687}
[S5] START round=44 head_norm_before_train=2.044669 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.749594689240056, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7260814302229557, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.943577 cos_to_last_merge=0.9993 (last merge round=42)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.236911853378036, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.622743782799672, 'psi': 0.017774699907663897}
[S7] START round=44 head_norm_before_train=1.924332 cos_to_last_merge=0.9999 (last merge round=40)
[S7] round=44 local utility u=0.047788 metrics={'f1_val': 0.20488105004101723, 'auprc': 0.20488105004101723, 'loss_val': 0.7907886088488045, 'psi': 0.20488105004101723}-{'f1_val': 0.19653349001175088, 'auprc': 0.19653349001175088, 'loss_val': 0.8112365926594164, 'psi': 0.19653349001175088}
[S8] START round=44 head_norm_before_train=2.236410 cos_to_last_merge=0.9933 (last merge round=25)
[S8] round=44 local utility u=0.013083 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.49582297662778557, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5219886864488433, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=44 head_norm_before_train=1.642456 cos_to_last_merge=0.9866 (last merge round=30)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1448690538511492, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.124425269772758, 'psi': 0.36867172340800847}
[S10] START round=44 head_norm_before_train=1.951039 cos_to_last_merge=1.0000 (last merge round=43)
[S10] round=44 local utility u=0.004902 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.6640737914150914, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.673878340762494, 'psi': 0.241793804900601}
[S11] START round=44 head_norm_before_train=1.951555 (no previous merge yet)
[S11] round=44 local utility u=0.085723 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.673534327402567, 'psi': 0.3319360347772085}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 3.8463668145302194, 'psi': 0.3320901320901321}
[S13] START round=44 head_norm_before_train=1.590767 cos_to_last_merge=0.9072 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.907
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4940027418567798, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4745978277614717, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.956446 cos_to_last_merge=0.9580 (last merge round=18)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 5.487561534818688, 'psi': 0.13393415946927026}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.452242216730167, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.309610 (no previous merge yet)
[S15] round=44 local utility u=0.010130 metrics={'f1_val': 0.8805990590644588, 'auprc': 0.8805990590644588, 'loss_val': 0.4075978444972963, 'psi': 0.8805990590644588}-{'f1_val': 0.8802896568133244, 'auprc': 0.8802896568133244, 'loss_val': 0.4250741197140166, 'psi': 0.8802896568133244}
[S16] START round=44 head_norm_before_train=2.302236 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=44 local utility u=0.287712 metrics={'f1_val': 0.12777404169468728, 'auprc': 0.12777404169468728, 'loss_val': 3.1685677836537964, 'psi': 0.12777404169468728}-{'f1_val': 0.09101796407185629, 'auprc': 0.09101796407185629, 'loss_val': 3.4131865426864163, 'psi': 0.09101796407185629}
[S17] START round=44 head_norm_before_train=1.739118 cos_to_last_merge=0.9671 (last merge round=27)
[S17] round=44 local utility u=0.306602 metrics={'f1_val': 0.6061225212882805, 'auprc': 0.6061225212882805, 'loss_val': 1.144943523454224, 'psi': 0.6061225212882805}-{'f1_val': 0.5600130533810842, 'auprc': 0.5600130533810842, 'loss_val': 1.3431615345209202, 'psi': 0.5600130533810842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:40411
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:40407
[S16] not sending this round → trigger blocked (psi=0.128)
[S15] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.9993
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] cosine check vs S15: cos=0.9955
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] cosine check vs S7: cos=0.9993
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=44 metric=0.2418 head_norm=1.975007
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.231778e-02
[S10] stored merged vector for next round verification (round=44)
[S10] DEBUG after merge:  round=44 metric=0.2418 head_norm=1.953839 delta_norm=0.042318
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=44 metric=0.2049 head_norm=1.933365
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.231778e-02
[S7] stored merged vector for next round verification (round=44)
[S7] DEBUG after merge:  round=44 metric=0.2047 head_norm=1.953839 delta_norm=0.042318
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1798) from S11
[S6] cosine check vs S11: cos=0.9447
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=44 metric=0.1278 head_norm=2.316861
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.093746e-01
[S16] stored merged vector for next round verification (round=44)
[S16] DEBUG after merge:  round=44 metric=0.1286 head_norm=2.314763 delta_norm=0.109375
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=2.053266 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.2595104307950656, 'auprc': 0.2595104307950656, 'loss_val': 3.150773640178191, 'psi': 0.2595104307950656}-{'f1_val': 0.2643247154792448, 'auprc': 0.2643247154792448, 'loss_val': 3.189143632427549, 'psi': 0.2643247154792448}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.979328 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.2542330048016174, 'auprc': 0.2542330048016174, 'loss_val': 3.00804139332347, 'psi': 0.2542330048016174}-{'f1_val': 0.2541848272376982, 'auprc': 0.2541848272376982, 'loss_val': 2.998427616441938, 'psi': 0.2541848272376982}
[S4] START round=45 head_norm_before_train=2.288388 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.309680642296649, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3068768098112817, 'psi': 0.3567939207526687}
[S5] START round=45 head_norm_before_train=2.058478 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7872948196723737, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.749594689240056, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.986668 cos_to_last_merge=0.9970 (last merge round=42)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 5.585117419541856, 'psi': 0.02109124254928932}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.236911853378036, 'psi': 0.017774699907663897}
[S7] START round=45 head_norm_before_train=1.953839 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.19843160611475083, 'auprc': 0.19843160611475083, 'loss_val': 0.8090827961641787, 'psi': 0.19843160611475083}-{'f1_val': 0.20488105004101723, 'auprc': 0.20488105004101723, 'loss_val': 0.7907886088488045, 'psi': 0.20488105004101723}
[S8] START round=45 head_norm_before_train=2.244810 cos_to_last_merge=0.9929 (last merge round=25)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5023724481864734, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.49582297662778557, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.650309 cos_to_last_merge=0.9860 (last merge round=30)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1646157190687187, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1448690538511492, 'psi': 0.36867172340800847}
[S10] START round=45 head_norm_before_train=1.953839 cos_to_last_merge=1.0000 (last merge round=44)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.6736231012264033, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.6640737914150914, 'psi': 0.241793804900601}
[S11] START round=45 head_norm_before_train=1.955209 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.823234103235393, 'psi': 0.3320133550741517}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.673534327402567, 'psi': 0.3319360347772085}
[S13] START round=45 head_norm_before_train=1.604169 cos_to_last_merge=0.9046 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.905
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.522683828767927, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4940027418567798, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.963083 cos_to_last_merge=0.9573 (last merge round=18)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.520926434384801, 'psi': 0.13413413413413414}-{'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 5.487561534818688, 'psi': 0.13393415946927026}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.317830 (no previous merge yet)
[S15] round=45 local utility u=0.018576 metrics={'f1_val': 0.8815266316866779, 'auprc': 0.8815266316866779, 'loss_val': 0.3787935696731269, 'psi': 0.8815266316866779}-{'f1_val': 0.8805990590644588, 'auprc': 0.8805990590644588, 'loss_val': 0.4075978444972963, 'psi': 0.8805990590644588}
[S16] START round=45 head_norm_before_train=2.314763 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=45 local utility u=0.260041 metrics={'f1_val': 0.14595062797747943, 'auprc': 0.14595062797747943, 'loss_val': 2.812074764566465, 'psi': 0.14595062797747943}-{'f1_val': 0.12777404169468728, 'auprc': 0.12777404169468728, 'loss_val': 3.1685677836537964, 'psi': 0.12777404169468728}
[S17] START round=45 head_norm_before_train=1.755840 cos_to_last_merge=0.9656 (last merge round=27)
[S17] round=45 local utility u=0.638819 metrics={'f1_val': 0.7197826935766342, 'auprc': 0.7197826935766342, 'loss_val': 0.890247023021818, 'psi': 0.7197826935766342}-{'f1_val': 0.6061225212882805, 'auprc': 0.6061225212882805, 'loss_val': 1.144943523454224, 'psi': 0.6061225212882805}
[S17] not sending this round → trigger blocked (psi=0.720)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.882)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.009 → S4@127.0.0.1:40404
[S7] ⇄ pheromone p=0.045 → S10@127.0.0.1:40411
[S16] not sending this round → trigger blocked (psi=0.146)
[S15] ⇄ pheromone p=0.092 → S16@127.0.0.1:40416
[S4] ⇄ pheromone p=0.002 → S3@127.0.0.1:40403
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=45 metric=0.0211 head_norm=2.023186
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.589287e-01
[S6] stored merged vector for next round verification (round=45)
[S6] DEBUG after merge:  round=45 metric=0.0239 head_norm=1.956843 delta_norm=0.358929
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.137 → S11@127.0.0.1:40412
[S10] ⇄ pheromone p=0.004 → S7@127.0.0.1:40408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.003 → S13@127.0.0.1:40413
[S16] ⇄ pheromone p=0.187 → S15@127.0.0.1:40415
[S11] ⇄ pheromone p=0.018 → S6@127.0.0.1:40407
[S2] START round=46 head_norm_before_train=2.059384 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.25711908875663914, 'auprc': 0.25711908875663914, 'loss_val': 3.1453453154771287, 'psi': 0.25711908875663914}-{'f1_val': 0.2595104307950656, 'auprc': 0.2595104307950656, 'loss_val': 3.150773640178191, 'psi': 0.2595104307950656}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.984946 (no previous merge yet)
[S3] round=46 local utility u=0.000429 metrics={'f1_val': 0.25380006307158626, 'auprc': 0.25380006307158626, 'loss_val': 3.003287607451242, 'psi': 0.25380006307158626}-{'f1_val': 0.2542330048016174, 'auprc': 0.2542330048016174, 'loss_val': 3.00804139332347, 'psi': 0.2542330048016174}
[S4] START round=46 head_norm_before_train=2.293935 (no previous merge yet)
[S4] round=46 local utility u=0.002201 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3052794923245357, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.309680642296649, 'psi': 0.3567939207526687}
[S5] START round=46 head_norm_before_train=2.073932 (no previous merge yet)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8306460822922297, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7872948196723737, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.956843 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=46 local utility u=0.531492 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.49228494451569, 'psi': 0.017774699907663897}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 5.585117419541856, 'psi': 0.02109124254928932}
[S7] START round=46 head_norm_before_train=1.962891 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=46 local utility u=0.190127 metrics={'f1_val': 0.23532877680886166, 'auprc': 0.23532877680886166, 'loss_val': 0.760902948697355, 'psi': 0.23532877680886166}-{'f1_val': 0.19843160611475083, 'auprc': 0.19843160611475083, 'loss_val': 0.8090827961641787, 'psi': 0.19843160611475083}
[S8] START round=46 head_norm_before_train=2.253298 cos_to_last_merge=0.9926 (last merge round=25)
[S8] round=46 local utility u=0.002551 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.4972699538349873, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5023724481864734, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=46 head_norm_before_train=1.657823 cos_to_last_merge=0.9853 (last merge round=30)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1837970833440803, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1646157190687187, 'psi': 0.36867172340800847}
[S10] START round=46 head_norm_before_train=1.977602 cos_to_last_merge=0.9999 (last merge round=44)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.714307053461838, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.6736231012264033, 'psi': 0.241793804900601}
[S11] START round=46 head_norm_before_train=1.958907 (no previous merge yet)
[S11] round=46 local utility u=0.027888 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.7674582923103364, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.823234103235393, 'psi': 0.3320133550741517}
[S13] START round=46 head_norm_before_train=1.616216 cos_to_last_merge=0.9027 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.903
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5378208173020291, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.522683828767927, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.969748 cos_to_last_merge=0.9565 (last merge round=18)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.554407729385419, 'psi': 0.13413413413413414}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.520926434384801, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.326312 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.5206833847132742, 'psi': 0.8796705340794291}-{'f1_val': 0.8815266316866779, 'auprc': 0.8815266316866779, 'loss_val': 0.3787935696731269, 'psi': 0.8815266316866779}
[S16] START round=46 head_norm_before_train=2.329825 cos_to_last_merge=0.9999 (last merge round=44)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.11704410011918952, 'auprc': 0.11704410011918952, 'loss_val': 2.775015387591718, 'psi': 0.1170441001191895}-{'f1_val': 0.14595062797747943, 'auprc': 0.14595062797747943, 'loss_val': 2.812074764566465, 'psi': 0.14595062797747943}
[S17] START round=46 head_norm_before_train=1.773784 cos_to_last_merge=0.9641 (last merge round=27)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.686320835866087, 'auprc': 0.686320835866087, 'loss_val': 1.024948281629337, 'psi': 0.686320835866087}-{'f1_val': 0.7197826935766342, 'auprc': 0.7197826935766342, 'loss_val': 0.890247023021818, 'psi': 0.7197826935766342}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:40403
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:40407
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=0.9996
[S3] RECEIVED delta(kind=head bytes=1792) from S4
[S3] cosine check vs S4: cos=-0.1139
[S3] DROPPED delta from S4 (cos=-0.1139 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] cosine check vs S3: cos=-0.1139
[S4] DROPPED delta from S3 (cos=-0.1139 < 0.0)
[S11] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S11
[S6] cosine check vs S11: cos=0.9731
[S2] START round=47 head_norm_before_train=2.065044 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.2568725226953075, 'auprc': 0.2568725226953075, 'loss_val': 3.156176090252536, 'psi': 0.2568725226953075}-{'f1_val': 0.25711908875663914, 'auprc': 0.25711908875663914, 'loss_val': 3.1453453154771287, 'psi': 0.25711908875663914}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.990444 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.2527479429684065, 'auprc': 0.2527479429684065, 'loss_val': 3.0085227279293263, 'psi': 0.2527479429684065}-{'f1_val': 0.25380006307158626, 'auprc': 0.25380006307158626, 'loss_val': 3.003287607451242, 'psi': 0.25380006307158626}
[S4] START round=47 head_norm_before_train=2.298401 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.310409291907929, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3052794923245357, 'psi': 0.3567939207526687}
[S5] START round=47 head_norm_before_train=2.088720 (no previous merge yet)
[S5] round=47 local utility u=0.034012 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7626225826572366, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8306460822922297, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=47 head_norm_before_train=2.000889 cos_to_last_merge=0.9987 (last merge round=45)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.222782031562041, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 4.49228494451569, 'psi': 0.017774699907663897}
[S7] START round=47 head_norm_before_train=1.970303 cos_to_last_merge=0.9999 (last merge round=44)
[S7] round=47 local utility u=0.080166 metrics={'f1_val': 0.24868979286249066, 'auprc': 0.24868979286249066, 'loss_val': 0.7208200264832265, 'psi': 0.24868979286249066}-{'f1_val': 0.23532877680886166, 'auprc': 0.23532877680886166, 'loss_val': 0.760902948697355, 'psi': 0.23532877680886166}
[S8] START round=47 head_norm_before_train=2.261123 cos_to_last_merge=0.9923 (last merge round=25)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5153971268759365, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.4972699538349873, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.665098 cos_to_last_merge=0.9847 (last merge round=30)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2009254360784962, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1837970833440803, 'psi': 0.36867172340800847}
[S10] START round=47 head_norm_before_train=2.000751 cos_to_last_merge=0.9997 (last merge round=44)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.757469704373297, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.714307053461838, 'psi': 0.241793804900601}
[S11] START round=47 head_norm_before_train=1.963639 (no previous merge yet)
[S11] round=47 local utility u=0.019298 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.7288627000308225, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.7674582923103364, 'psi': 0.3320133550741517}
[S13] START round=47 head_norm_before_train=1.628438 cos_to_last_merge=0.9008 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.901
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5597325013927361, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5378208173020291, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.976112 cos_to_last_merge=0.9557 (last merge round=18)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13433395872420262, 'auprc': 0.13433395872420262, 'loss_val': 5.588602488801261, 'psi': 0.13433395872420262}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.554407729385419, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.334565 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.5408617721154544, 'psi': 0.8796705340794291}-{'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.5206833847132742, 'psi': 0.8796705340794291}
[S16] START round=47 head_norm_before_train=2.345499 cos_to_last_merge=0.9995 (last merge round=44)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.06020743738932457, 'auprc': 0.06020743738932457, 'loss_val': 4.166444143249859, 'psi': 0.06020743738932457}-{'f1_val': 0.11704410011918952, 'auprc': 0.11704410011918952, 'loss_val': 2.775015387591718, 'psi': 0.1170441001191895}
[S17] START round=47 head_norm_before_train=1.792832 cos_to_last_merge=0.9626 (last merge round=27)
[S17] round=47 local utility u=0.393950 metrics={'f1_val': 0.7534054537930801, 'auprc': 0.7534054537930801, 'loss_val': 0.8408102931756789, 'psi': 0.7534054537930801}-{'f1_val': 0.686320835866087, 'auprc': 0.686320835866087, 'loss_val': 1.024948281629337, 'psi': 0.686320835866087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.249)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=47 metric=0.2418 head_norm=2.022031
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.536022e-02
[S10] stored merged vector for next round verification (round=47)
[S10] DEBUG after merge:  round=47 metric=0.2418 head_norm=1.995819 delta_norm=0.045360
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=47 metric=0.0178 head_norm=2.050618
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.824927e-01
[S6] stored merged vector for next round verification (round=47)
[S6] DEBUG after merge:  round=47 metric=0.0180 head_norm=1.987625 delta_norm=0.282493
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] not sending this round → trigger blocked (psi=0.332)
[S2] START round=48 head_norm_before_train=2.070469 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.25613565372601516, 'auprc': 0.25613565372601516, 'loss_val': 3.1662743269334817, 'psi': 0.25613565372601516}-{'f1_val': 0.2568725226953075, 'auprc': 0.2568725226953075, 'loss_val': 3.156176090252536, 'psi': 0.2568725226953075}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.995830 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.2436130282116479, 'auprc': 0.2436130282116479, 'loss_val': 2.999665710803832, 'psi': 0.2436130282116479}-{'f1_val': 0.2527479429684065, 'auprc': 0.2527479429684065, 'loss_val': 3.0085227279293263, 'psi': 0.2527479429684065}
[S4] START round=48 head_norm_before_train=2.303899 (no previous merge yet)
[S4] round=48 local utility u=0.005756 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.298897182834318, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.310409291907929, 'psi': 0.3567939207526687}
[S5] START round=48 head_norm_before_train=2.101965 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7703161068914057, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7626225826572366, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.987625 cos_to_last_merge=1.0000 (last merge round=47)
[S6] round=48 local utility u=0.275322 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 4.674141538864075, 'psi': 0.01799723119520074}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.222782031562041, 'psi': 0.017774699907663897}
[S7] START round=48 head_norm_before_train=1.977013 cos_to_last_merge=0.9999 (last merge round=44)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.18448656606551345, 'auprc': 0.18448656606551345, 'loss_val': 0.8711391734843296, 'psi': 0.18448656606551345}-{'f1_val': 0.24868979286249066, 'auprc': 0.24868979286249066, 'loss_val': 0.7208200264832265, 'psi': 0.24868979286249066}
[S8] START round=48 head_norm_before_train=2.268777 cos_to_last_merge=0.9920 (last merge round=25)
[S8] round=48 local utility u=0.008077 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.4992427526452161, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5153971268759365, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=48 head_norm_before_train=1.672013 cos_to_last_merge=0.9841 (last merge round=30)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2168018996138303, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2009254360784962, 'psi': 0.36867172340800847}
[S10] START round=48 head_norm_before_train=1.995819 cos_to_last_merge=1.0000 (last merge round=47)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.758721678767593, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.757469704373297, 'psi': 0.241793804900601}
[S11] START round=48 head_norm_before_train=1.969773 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.8250423344928786, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.7288627000308225, 'psi': 0.3320133550741517}
[S13] START round=48 head_norm_before_train=1.640449 cos_to_last_merge=0.8988 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.899
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5854101353817747, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5597325013927361, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.982187 cos_to_last_merge=0.9551 (last merge round=18)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 5.621940065854251, 'psi': 0.1347331583552056}-{'f1_val': 0.13433395872420262, 'auprc': 0.13433395872420262, 'loss_val': 5.588602488801261, 'psi': 0.13433395872420262}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.342702 (no previous merge yet)
[S15] round=48 local utility u=0.045295 metrics={'f1_val': 0.8802896568133244, 'auprc': 0.8802896568133244, 'loss_val': 0.45584449495078744, 'psi': 0.8802896568133244}-{'f1_val': 0.8796705340794291, 'auprc': 0.8796705340794291, 'loss_val': 0.5408617721154544, 'psi': 0.8796705340794291}
[S16] START round=48 head_norm_before_train=2.360510 cos_to_last_merge=0.9989 (last merge round=44)
[S16] round=48 local utility u=0.297946 metrics={'f1_val': 0.06820906257492208, 'auprc': 0.06820906257492208, 'loss_val': 3.642566697152206, 'psi': 0.06820906257492208}-{'f1_val': 0.06020743738932457, 'auprc': 0.06020743738932457, 'loss_val': 4.166444143249859, 'psi': 0.06020743738932457}
[S17] START round=48 head_norm_before_train=1.802623 cos_to_last_merge=0.9613 (last merge round=27)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.5901173396861679, 'auprc': 0.5901173396861679, 'loss_val': 1.3453908979984688, 'psi': 0.5901173396861679}-{'f1_val': 0.7534054537930801, 'auprc': 0.7534054537930801, 'loss_val': 0.8408102931756789, 'psi': 0.7534054537930801}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:40403
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[S16] not sending this round → trigger blocked (psi=0.068)
[S4] sending update (kind=head size=1791 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S15
[S16] cosine check vs S15: cos=0.9946
[S3] RECEIVED delta(kind=head bytes=1791) from S4
[S3] cosine check vs S4: cos=-0.1140
[S3] DROPPED delta from S4 (cos=-0.1140 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=48 metric=0.0682 head_norm=2.373399
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.231572e-01
[S16] stored merged vector for next round verification (round=48)
[S16] DEBUG after merge:  round=48 metric=0.0687 head_norm=2.358753 delta_norm=0.123157
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=2.075837 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.25515971296119894, 'auprc': 0.25515971296119894, 'loss_val': 3.1781620585959107, 'psi': 0.25515971296119894}-{'f1_val': 0.25613565372601516, 'auprc': 0.25613565372601516, 'loss_val': 3.1662743269334817, 'psi': 0.25613565372601516}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.001746 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.24566544566544568, 'auprc': 0.24566544566544568, 'loss_val': 3.0399398727077944, 'psi': 0.24566544566544568}-{'f1_val': 0.2436130282116479, 'auprc': 0.2436130282116479, 'loss_val': 2.999665710803832, 'psi': 0.2436130282116479}
[S4] START round=49 head_norm_before_train=2.302008 (no previous merge yet)
[S4] round=49 local utility u=0.004236 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2904246507005737, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.298897182834318, 'psi': 0.3567939207526687}
[S5] START round=49 head_norm_before_train=2.109833 (no previous merge yet)
[S5] round=49 local utility u=0.070213 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6298897425445285, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7703161068914057, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=49 head_norm_before_train=2.038532 cos_to_last_merge=0.9981 (last merge round=47)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.433744343494745, 'psi': 0.017774699907663897}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 4.674141538864075, 'psi': 0.01799723119520074}
[S7] START round=49 head_norm_before_train=1.984721 cos_to_last_merge=0.9998 (last merge round=44)
[S7] round=49 local utility u=0.000665 metrics={'f1_val': 0.18559479553903346, 'auprc': 0.18559479553903346, 'loss_val': 0.8797837320526629, 'psi': 0.18559479553903346}-{'f1_val': 0.18448656606551345, 'auprc': 0.18448656606551345, 'loss_val': 0.8711391734843296, 'psi': 0.18448656606551345}
[S8] START round=49 head_norm_before_train=2.277158 cos_to_last_merge=0.9916 (last merge round=25)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.555660557833638, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.4992427526452161, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.678681 cos_to_last_merge=0.9836 (last merge round=30)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2351731603742895, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2168018996138303, 'psi': 0.36867172340800847}
[S10] START round=49 head_norm_before_train=2.016184 cos_to_last_merge=0.9999 (last merge round=47)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.795682844062979, 'psi': 0.241793804900601}-{'f1_val': 0.241793804900601, 'auprc': 0.241793804900601, 'loss_val': 2.758721678767593, 'psi': 0.241793804900601}
[S11] START round=49 head_norm_before_train=1.976548 (no previous merge yet)
[S11] round=49 local utility u=0.018493 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.7880564413686555, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.8250423344928786, 'psi': 0.3320133550741517}
[S13] START round=49 head_norm_before_train=1.647616 cos_to_last_merge=0.8976 (last merge round=23)
[S13] ⚠️ Model drifted since last merge! cos=0.898
[S13] round=49 local utility u=0.009731 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5659471746591633, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5854101353817747, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=49 head_norm_before_train=1.988068 cos_to_last_merge=0.9544 (last merge round=18)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.1345336334083521, 'auprc': 0.1345336334083521, 'loss_val': 5.655315972788786, 'psi': 0.1345336334083521}-{'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 5.621940065854251, 'psi': 0.1347331583552056}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.350477 (no previous merge yet)
[S15] round=49 local utility u=0.044793 metrics={'f1_val': 0.8815266316866779, 'auprc': 0.8815266316866779, 'loss_val': 0.3773914232124969, 'psi': 0.8815266316866779}-{'f1_val': 0.8802896568133244, 'auprc': 0.8802896568133244, 'loss_val': 0.45584449495078744, 'psi': 0.8802896568133244}
[S16] START round=49 head_norm_before_train=2.358753 cos_to_last_merge=1.0000 (last merge round=48)
[S16] round=49 local utility u=0.623198 metrics={'f1_val': 0.11282219309742246, 'auprc': 0.11282219309742246, 'loss_val': 2.7976888211383626, 'psi': 0.11282219309742247}-{'f1_val': 0.06820906257492208, 'auprc': 0.06820906257492208, 'loss_val': 3.642566697152206, 'psi': 0.06820906257492208}
[S17] START round=49 head_norm_before_train=1.817194 cos_to_last_merge=0.9601 (last merge round=27)
[S17] round=49 local utility u=1.000000 metrics={'f1_val': 0.7798837248378533, 'auprc': 0.7798837248378533, 'loss_val': 0.7659903402505771, 'psi': 0.7798837248378533}-{'f1_val': 0.5901173396861679, 'auprc': 0.5901173396861679, 'loss_val': 1.3453908979984688, 'psi': 0.5901173396861679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.882)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:40411
[S4] not sending this round → trigger blocked (psi=0.357)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1804 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.113)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:40407
[S10] RECEIVED delta(kind=head bytes=1804) from S7
[S10] cosine check vs S7: cos=0.9991
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S11
[S6] cosine check vs S11: cos=0.9690
[runner] rounds complete.
[runner] all agents stopped.
