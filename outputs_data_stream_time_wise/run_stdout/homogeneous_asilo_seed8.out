[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:61803
[S3] → join 127.0.0.1:61802
[S4] → join 127.0.0.1:61802
[S5] → join 127.0.0.1:61802
[S6] → join 127.0.0.1:61802
[S7] → join 127.0.0.1:61802
[S8] → join 127.0.0.1:61802
[S9] → join 127.0.0.1:61802
[S10] → join 127.0.0.1:61802
[S11] → join 127.0.0.1:61802
[S13] → join 127.0.0.1:61802
[S14] → join 127.0.0.1:61802
[S15] → join 127.0.0.1:61802
[S16] → join 127.0.0.1:61802
[S17] → join 127.0.0.1:61802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.189197 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.138096 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.134206 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.158188 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.159295 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.211050 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.188261 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.165080 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.199240 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.189235 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.189965 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.218486 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.150857 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.130044 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.211676 (no previous merge yet)
[S6]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S3] + discovered S5
[S3] + discovered S7
[S3] + discovered S8
[S3] + discovered S9
[S3] + discovered S11
[S3] + discovered S4
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S16
[S3] + discovered S14
[S3] + discovered S13
[S3] + discovered S17
[S3] + discovered S15
[S3] + discovered S10
[S3] + discovered S6
[S4] + discovered S14
[S4] + discovered S6
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S17
[S4] + discovered S15
[S4] + discovered S10
[S4] + discovered S5
[S4] + discovered S7
[S4] + discovered S8
[S4] + discovered S9
[S4] + discovered S11
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S8
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S9
[S5] + discovered S7
[S5] + discovered S10
[S5] + discovered S13
[S5] + discovered S6
[S5] + discovered S14
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S2
[S6] + discovered S9
[S6] + discovered S7
[S6] + discovered S10
[S6] + discovered S13
[S6] + discovered S14
[S6] + discovered S17
[S6] + discovered S15
[S6] + discovered S16
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S3
[S7] + discovered S2
[S7] + discovered S6
[S6] + discovered S11
[S6] + discovered S8
[S7] + discovered S13
[S8] + discovered S4
[S8] + discovered S3
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S5
[S8] + discovered S2
[S7] + discovered S9
[S7] + discovered S8
[S7] + discovered S10
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S11
[S7] + discovered S14
[S7] + discovered S17
[S8] + discovered S13
[S8] + discovered S17
[S8] + discovered S11
[S8] + discovered S16
[S8] + discovered S10
[S8] + discovered S9
[S8] + discovered S14
[S8] + discovered S15
[S9] + discovered S3
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S5
[S9] + discovered S6
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S14
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S13
[S9] + discovered S11
[S9] + discovered S10
[S9] + discovered S17
[S10] + discovered S6
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S4
[S10] + discovered S9
[S10] + discovered S8
[S10] + discovered S7
[S10] + discovered S3
[S11] + discovered S9
[S11] + discovered S8
[S11] + discovered S10
[S11] + discovered S4
[S11] + discovered S7
[S11] + discovered S3
[S11] + discovered S2
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S17
[S11] + discovered S6
[S11] + discovered S5
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S15
[S13] + discovered S4
[S11] + discovered S14
[S13] + discovered S5
[S13] + discovered S9
[S13] + discovered S8
[S13] + discovered S10
[S13] + discovered S6
[S13] + discovered S11
[S13] + discovered S3
[S13] + discovered S7
[S13] + discovered S2
[S11] + discovered S16
[S14] + discovered S13
[S14] + discovered S9
[S13] + discovered S14
[S13] + discovered S15
[S14] + discovered S8
[S13] + discovered S17
[S14] + discovered S4
[S13] + discovered S16
[S14] + discovered S2
[S14] + discovered S7
[S14] + discovered S3
[S14] + discovered S10
[S14] + discovered S6
[S14] + discovered S5
[S14] + discovered S11
[S14] + discovered S17
[S15] + discovered S9
[S15] + discovered S7
[S15] + discovered S11
[S15] + discovered S14
[S15] + discovered S10
[S15] + discovered S2
[S15] + discovered S13
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S8
[S15] + discovered S5
[S14] + discovered S15
[S15] + discovered S6
[S14] + discovered S16
[S16] + discovered S8
[S16] + discovered S9
[S16] + discovered S13
[S16] + discovered S2
[S16] + discovered S14
[S16] + discovered S11
[S16] + discovered S10
[S16] + discovered S15
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S4
[S16] + discovered S3
[S16] + discovered S5
[S15] + discovered S16
[S15] + discovered S17
[S17] + discovered S15
[S17] + discovered S9
[S16] + discovered S17
[S17] + discovered S3
[S17] + discovered S7
[S17] + discovered S10
[S17] + discovered S6
[S17] + discovered S11
[S17] + discovered S14
[S17] + discovered S16
[S17] + discovered S8
[S17] + discovered S2
[S17] + discovered S13
[S17] + discovered S4
[S17] + discovered S5
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:61805
[S6] ⇄ pheromone p=1.000 → S5@127.0.0.1:61805
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:61809
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:61810
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:61804
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:61812
[S9] ⇄ pheromone p=1.000 → S2@127.0.0.1:61802
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:61808
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:61815
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:61808
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:61802
[S3] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:61810
[S5] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S2] START round=1 head_norm_before_train=1.195183 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5511914037626982, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4412460219118173, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.152014 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.564549899626843, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4695069651958013, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.135852 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.3318565400843882, 'auprc': 0.3318565400843882, 'loss_val': 1.3729369914992993, 'psi': 0.3318565400843882}-{'f1_val': 0.33270281630937365, 'auprc': 0.33270281630937365, 'loss_val': 1.337265040428655, 'psi': 0.33270281630937365}
[S5] START round=1 head_norm_before_train=1.161174 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4940879163406393, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4560666023301905, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.172895 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.635867169480244, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5117525623891601, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.208117 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.507244562115714, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4417250204156538, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.189574 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.480684475473621, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4273900662220764, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.169959 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5418356866198943, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.436467661170256, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.205945 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5307996069390466, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4802894750248745, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.193033 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4844097404086716, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4102747850831194, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.185619 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5321338306876089, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4947837191001234, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.230098 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5676985428811656, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4686449144113747, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.149648 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4647800336151513, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4112402445327068, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.138297 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4890289389765108, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.408432623028344, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.211928 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5853201057411364, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5264801389547822, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.214057 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.788525067964918, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5511914037626982, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.177682 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7715790864152139, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.564549899626843, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.149879 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.08594566353187043, 'auprc': 0.08594566353187043, 'loss_val': 1.4069353874967034, 'psi': 0.08594566353187043}-{'f1_val': 0.3318565400843882, 'auprc': 0.3318565400843882, 'loss_val': 1.3729369914992993, 'psi': 0.3318565400843882}
[S5] START round=2 head_norm_before_train=1.174559 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5675610324368943, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4940879163406393, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.198243 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8798285428944954, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.635867169480244, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.216827 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.606532858206935, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.507244562115714, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.199492 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5621117383350538, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.480684475473621, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.185378 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.765089469044587, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5418356866198943, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.224569 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6072049672965958, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5307996069390466, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.210723 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6193429442878118, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4844097404086716, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.190495 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.599966103000451, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5321338306876089, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.250061 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7684508869237034, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5676985428811656, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.160559 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5578283162074102, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4647800336151513, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.157052 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6458359743998874, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4890289389765108, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.225283 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7174141415429747, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5853201057411364, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.247345 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4230941577588765, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.788525067964918, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.214347 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3606852741761934, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7715790864152139, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.176057 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4598490141273552, 'psi': 0.0}-{'f1_val': 0.08594566353187043, 'auprc': 0.08594566353187043, 'loss_val': 1.4069353874967034, 'psi': 0.08594566353187043}
[S5] START round=3 head_norm_before_train=1.197444 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7353306537896034, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5675610324368943, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.231135 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.437893516390599, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8798285428944954, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.234041 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8790859020353328, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.606532858206935, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.217154 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.756162522038465, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5621117383350538, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.211043 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2981551426725684, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.765089469044587, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.252080 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7920863259059334, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6072049672965958, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.240399 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9902547469806269, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6193429442878118, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.204576 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.739265116670356, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.599966103000451, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.278981 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2645555180358077, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7684508869237034, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.182543 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7498456228048445, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5578283162074102, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.188297 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.027548440961763, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6458359743998874, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.251295 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0421053921043963, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7174141415429747, 'psi': 0.0}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.289622 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3007254808049327, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4230941577588765, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.257761 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.963941752842646, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3606852741761934, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.210742 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.532607491636141, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4598490141273552, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.227953 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9864324518780396, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7353306537896034, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.269953 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0049442939057696, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.437893516390599, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.262277 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.004478057356562, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8790859020353328, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.242757 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8297699321780125, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.756162522038465, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.244094 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9622616908337163, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2981551426725684, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.284541 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9537908957433714, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7920863259059334, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.279250 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7783654836208265, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9902547469806269, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.227486 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0068250381519572, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.739265116670356, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.317345 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0886206303970782, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2645555180358077, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.210830 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1146755335742102, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7498456228048445, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.228896 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.773151092414643, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.027548440961763, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.284029 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1893884065257394, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0421053921043963, 'psi': 0.0}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.326795 (no previous merge yet)
[S2] round=5 local utility u=0.031527 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2376716644452204, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3007254808049327, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.289215 (no previous merge yet)
[S3] round=5 local utility u=0.149636 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6646703062535795, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.963941752842646, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.250197 (no previous merge yet)
[S4] round=5 local utility u=0.035692 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4612231731872405, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.532607491636141, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.256133 (no previous merge yet)
[S5] round=5 local utility u=0.073004 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8404236230651656, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9864324518780396, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.297545 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.358218265733742, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0049442939057696, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.275104 (no previous merge yet)
[S7] round=5 local utility u=0.047179 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9101208596612018, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.004478057356562, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.257099 (no previous merge yet)
[S8] round=5 local utility u=0.038982 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.75180586466087, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8297699321780125, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.274441 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0977349309794637, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9622616908337163, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.306735 (no previous merge yet)
[S10] round=5 local utility u=0.016860 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.920071243313396, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9537908957433714, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.317318 (no previous merge yet)
[S11] round=5 local utility u=0.013842 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7506810074678456, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7783654836208265, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.251801 (no previous merge yet)
[S13] round=5 local utility u=0.033892 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.939041928524498, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0068250381519572, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.357659 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.466914408706588, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0886206303970782, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.241000 (no previous merge yet)
[S15] round=5 local utility u=0.072716 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9692430872415088, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1146755335742102, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.274274 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2564985037666823, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.773151092414643, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.306983 (no previous merge yet)
[S17] round=5 local utility u=0.195607 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7981753387697612, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1893884065257394, 'psi': 0.0}
[S8] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S4] ⇄ pheromone p=0.335 → S11@127.0.0.1:61812
[S14] ⇄ pheromone p=0.328 → S7@127.0.0.1:61808
[S9] ⇄ pheromone p=0.328 → S11@127.0.0.1:61812
[S7] ⇄ pheromone p=0.337 → S8@127.0.0.1:61809
[S2] ⇄ pheromone p=0.334 → S4@127.0.0.1:61804
[S11] ⇄ pheromone p=0.330 → S5@127.0.0.1:61805
[S6] ⇄ pheromone p=0.328 → S5@127.0.0.1:61805
[S15] ⇄ pheromone p=0.342 → S9@127.0.0.1:61810
[S3] ⇄ pheromone p=0.358 → S13@127.0.0.1:61813
[S8] ⇄ pheromone p=0.335 → S15@127.0.0.1:61815
[S10] ⇄ pheromone p=0.331 → S4@127.0.0.1:61804
[S16] ⇄ pheromone p=0.328 → S2@127.0.0.1:61802
[S13] ⇄ pheromone p=0.334 → S7@127.0.0.1:61808
[S5] ⇄ pheromone p=0.342 → S13@127.0.0.1:61813
[S17] ⇄ pheromone p=0.367 → S13@127.0.0.1:61813
[S2] START round=6 head_norm_before_train=1.346170 (no previous merge yet)
[S2] round=6 local utility u=0.191604 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8544627954699235, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2376716644452204, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.304040 (no previous merge yet)
[S3] round=6 local utility u=0.117584 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4295014055261315, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6646703062535795, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.280952 (no previous merge yet)
[S4] round=6 local utility u=0.050802 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3596182549570173, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4612231731872405, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.262144 (no previous merge yet)
[S5] round=6 local utility u=0.088641 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6631410385406709, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8404236230651656, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.323162 (no previous merge yet)
[S6] round=6 local utility u=0.141578 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.075061674089819, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.358218265733742, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.278402 (no previous merge yet)
[S7] round=6 local utility u=0.040827 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.828466949450191, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9101208596612018, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.264362 (no previous merge yet)
[S8] round=6 local utility u=0.017665 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7164755003042222, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.75180586466087, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.295117 (no previous merge yet)
[S9] round=6 local utility u=0.097397 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9029408522770224, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0977349309794637, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.321192 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0327846188608603, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.920071243313396, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.336393 (no previous merge yet)
[S11] round=6 local utility u=0.212626 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3254286845929966, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7506810074678456, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.253789 (no previous merge yet)
[S13] round=6 local utility u=0.079262 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.780517739846892, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.939041928524498, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.386812 (no previous merge yet)
[S14] round=6 local utility u=0.036853 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3932089627581066, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.466914408706588, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.254368 (no previous merge yet)
[S15] round=6 local utility u=0.132358 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7045274601777753, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9692430872415088, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.311803 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3357047734974774, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2564985037666823, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.309164 (no previous merge yet)
[S17] round=6 local utility u=0.042069 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.714036844681963, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7981753387697612, 'psi': 0.0}
[S3] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=7 head_norm_before_train=1.361459 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.063735926007771, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8544627954699235, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.323975 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4394776361925192, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4295014055261315, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.304400 (no previous merge yet)
[S4] round=7 local utility u=0.023190 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3132379211444778, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3596182549570173, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.265240 (no previous merge yet)
[S5] round=7 local utility u=0.042516 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5781096504715824, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6631410385406709, 'psi': 0.0}
[S6] START round=7 head_norm_before_train=1.344494 (no previous merge yet)
[S6] round=7 local utility u=0.205586 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.663889257563262, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.075061674089819, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.284259 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8397430510966526, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.828466949450191, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.279089 (no previous merge yet)
[S8] round=7 local utility u=0.044105 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6282652469247028, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7164755003042222, 'psi': 0.0}
[S9] START round=7 head_norm_before_train=1.314704 (no previous merge yet)
[S9] round=7 local utility u=0.187348 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5282449070727675, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9029408522770224, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.340326 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.41822728827052, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0327846188608603, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.353763 (no previous merge yet)
[S11] round=7 local utility u=0.022490 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.280449223519279, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3254286845929966, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.250234 (no previous merge yet)
[S13] round=7 local utility u=0.024688 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7311417632475243, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.780517739846892, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.408170 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.432184817420719, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3932089627581066, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.267091 (no previous merge yet)
[S15] round=7 local utility u=0.077465 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.549596519191529, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7045274601777753, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.341673 (no previous merge yet)
[S16] round=7 local utility u=0.082452 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.170801104727659, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3357047734974774, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.328091 (no previous merge yet)
[S17] round=7 local utility u=0.039236 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6355649270509685, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.714036844681963, 'psi': 0.0}
[S4] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=8 head_norm_before_train=1.387301 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.21662695217812, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.063735926007771, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.351324 (no previous merge yet)
[S3] round=8 local utility u=0.166670 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1061376168798924, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4394776361925192, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.342406 (no previous merge yet)
[S4] round=8 local utility u=0.011876 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2894856969572555, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3132379211444778, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.276059 (no previous merge yet)
[S5] round=8 local utility u=0.761377 metrics={'f1_val': 0.1605917667238422, 'auprc': 0.1605917667238422, 'loss_val': 1.5006811618549947, 'psi': 0.1605917667238422}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5781096504715824, 'psi': 0.0}
[S6] START round=8 head_norm_before_train=1.368756 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0799886170756885, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.663889257563262, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.297874 (no previous merge yet)
[S7] round=8 local utility u=0.023119 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7935058672871742, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8397430510966526, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.296135 (no previous merge yet)
[S8] round=8 local utility u=0.072676 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4829136578011333, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6282652469247028, 'psi': 0.0}
[S9] START round=8 head_norm_before_train=1.337348 (no previous merge yet)
[S9] round=8 local utility u=0.032276 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.463692526649179, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5282449070727675, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.365051 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.868554766976795, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.41822728827052, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.381555 (no previous merge yet)
[S11] round=8 local utility u=0.026038 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2283739746506592, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.280449223519279, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.258189 (no previous merge yet)
[S13] round=8 local utility u=0.015429 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7002839899543065, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7311417632475243, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.433374 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4502484644973492, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.432184817420719, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.286180 (no previous merge yet)
[S15] round=8 local utility u=0.032611 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4843746408204013, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.549596519191529, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.370298 (no previous merge yet)
[S16] round=8 local utility u=0.094282 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9822361813319382, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.170801104727659, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.353660 (no previous merge yet)
[S17] round=8 local utility u=0.082989 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4695868155605287, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6355649270509685, 'psi': 0.0}
[S7] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.161)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=9 head_norm_before_train=1.416791 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3343107930449185, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.21662695217812, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.381471 (no previous merge yet)
[S3] round=9 local utility u=0.164566 metrics={'f1_val': 0.0003311806590495115, 'auprc': 0.0003311806590495115, 'loss_val': 1.7799856195332382, 'psi': 0.0003311806590495115}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1061376168798924, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.379607 (no previous merge yet)
[S4] round=9 local utility u=0.000720 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2880461286288587, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2894856969572555, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.290616 (no previous merge yet)
[S5] round=9 local utility u=0.272628 metrics={'f1_val': 0.21197234352256186, 'auprc': 0.21197234352256186, 'loss_val': 1.4178506793168648, 'psi': 0.2119723435225619}-{'f1_val': 0.1605917667238422, 'auprc': 0.1605917667238422, 'loss_val': 1.5006811618549947, 'psi': 0.1605917667238422}
[S6] START round=9 head_norm_before_train=1.404731 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.356966943460012, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0799886170756885, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.311498 (no previous merge yet)
[S7] round=9 local utility u=1.000000 metrics={'f1_val': 0.2790352504638219, 'auprc': 0.2790352504638219, 'loss_val': 1.6888649172631323, 'psi': 0.2790352504638219}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7935058672871742, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.314798 (no previous merge yet)
[S8] round=9 local utility u=1.000000 metrics={'f1_val': 0.5379069301510455, 'auprc': 0.5379069301510455, 'loss_val': 1.3774009082301064, 'psi': 0.5379069301510455}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4829136578011333, 'psi': 0.0}
[S9] START round=9 head_norm_before_train=1.367342 (no previous merge yet)
[S9] round=9 local utility u=0.034498 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3946972541723786, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.463692526649179, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.396893 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1265597784812367, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.868554766976795, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.417079 (no previous merge yet)
[S11] round=9 local utility u=0.106365 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0156436972386276, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2283739746506592, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.269795 (no previous merge yet)
[S13] round=9 local utility u=0.003219 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6938467459338813, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7002839899543065, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.460289 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.038193886190322, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4502484644973492, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.315108 (no previous merge yet)
[S15] round=9 local utility u=1.000000 metrics={'f1_val': 0.22699304440877474, 'auprc': 0.22699304440877474, 'loss_val': 1.2890792774407789, 'psi': 0.22699304440877474}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4843746408204013, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.400207 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0768259387450683, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9822361813319382, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.377079 (no previous merge yet)
[S17] round=9 local utility u=0.044696 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3801947809621777, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4695868155605287, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S13] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:61810
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61809
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] cosine check vs S8: cos=-0.0496
[S15] DROPPED delta from S8 (cos=-0.0496 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S5
[S13] cosine check vs S5: cos=-0.1034
[S13] DROPPED delta from S5 (cos=-0.1034 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] cosine check vs S7: cos=-0.0186
[S8] DROPPED delta from S7 (cos=-0.0186 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S15
[S9] cosine check vs S15: cos=-0.0078
[S9] DROPPED delta from S15 (cos=-0.0078 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=10 head_norm_before_train=1.448583 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5297538929861245, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3343107930449185, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.418316 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.152454708971498, 'psi': 0.0}-{'f1_val': 0.0003311806590495115, 'auprc': 0.0003311806590495115, 'loss_val': 1.7799856195332382, 'psi': 0.0003311806590495115}
[S4] START round=10 head_norm_before_train=1.416121 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3047052367028866, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2880461286288587, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.307655 (no previous merge yet)
[S5] round=10 local utility u=1.000000 metrics={'f1_val': 0.570673284528624, 'auprc': 0.570673284528624, 'loss_val': 1.3305220337274104, 'psi': 0.570673284528624}-{'f1_val': 0.21197234352256186, 'auprc': 0.21197234352256186, 'loss_val': 1.4178506793168648, 'psi': 0.2119723435225619}
[S6] START round=10 head_norm_before_train=1.440177 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5140164004160526, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.356966943460012, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.323856 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.18588271321390293, 'auprc': 0.18588271321390293, 'loss_val': 1.5992965769241785, 'psi': 0.18588271321390293}-{'f1_val': 0.2790352504638219, 'auprc': 0.2790352504638219, 'loss_val': 1.6888649172631323, 'psi': 0.2790352504638219}
[S8] START round=10 head_norm_before_train=1.333829 (no previous merge yet)
[S8] round=10 local utility u=0.010923 metrics={'f1_val': 0.5336922938440279, 'auprc': 0.5336922938440279, 'loss_val': 1.317622301657126, 'psi': 0.5336922938440279}-{'f1_val': 0.5379069301510455, 'auprc': 0.5379069301510455, 'loss_val': 1.3774009082301064, 'psi': 0.5379069301510455}
[S9] START round=10 head_norm_before_train=1.403429 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.575865931234273, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3946972541723786, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.430090 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.321889527191444, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1265597784812367, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.453955 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.050026804594342, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0156436972386276, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.287823 (no previous merge yet)
[S13] round=10 local utility u=0.075311 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5432242635402942, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6938467459338813, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.492226 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.270715861972386, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.038193886190322, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.345257 (no previous merge yet)
[S15] round=10 local utility u=1.000000 metrics={'f1_val': 0.9980380472506714, 'auprc': 0.9980380472506714, 'loss_val': 1.1835162305294478, 'psi': 0.9980380472506714}-{'f1_val': 0.22699304440877474, 'auprc': 0.22699304440877474, 'loss_val': 1.2890792774407789, 'psi': 0.22699304440877474}
[S16] START round=10 head_norm_before_train=1.429865 (no previous merge yet)
[S16] round=10 local utility u=0.101726 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.873374027071285, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0768259387450683, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.402954 (no previous merge yet)
[S17] round=10 local utility u=0.019023 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.342148506054825, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3801947809621777, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.534)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.571)
[S15] not sending this round → trigger blocked (psi=0.998)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S7] ⇄ pheromone p=0.277 → S8@127.0.0.1:61809
[S11] ⇄ pheromone p=0.148 → S5@127.0.0.1:61805
[S14] ⇄ pheromone p=0.110 → S7@127.0.0.1:61808
[S5] ⇄ pheromone p=0.465 → S13@127.0.0.1:61813
[S3] ⇄ pheromone p=0.174 → S13@127.0.0.1:61813
[S15] ⇄ pheromone p=0.495 → S9@127.0.0.1:61810
[S6] ⇄ pheromone p=0.140 → S5@127.0.0.1:61805
[S16] ⇄ pheromone p=0.148 → S2@127.0.0.1:61802
[S8] ⇄ pheromone p=0.287 → S15@127.0.0.1:61815
[S2] ⇄ pheromone p=0.125 → S4@127.0.0.1:61804
[S4] ⇄ pheromone p=0.118 → S11@127.0.0.1:61812
[S9] ⇄ pheromone p=0.144 → S11@127.0.0.1:61812
[S10] ⇄ pheromone p=0.108 → S4@127.0.0.1:61804
[S13] ⇄ pheromone p=0.136 → S7@127.0.0.1:61808
[S17] ⇄ pheromone p=0.149 → S13@127.0.0.1:61813
[S2] START round=11 head_norm_before_train=1.478293 (no previous merge yet)
[S2] round=11 local utility u=0.330886 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8679811605089065, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5297538929861245, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.456919 (no previous merge yet)
[S3] round=11 local utility u=0.083518 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9854186523614288, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.152454708971498, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.452886 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3256380810064328, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3047052367028866, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.323233 (no previous merge yet)
[S5] round=11 local utility u=1.000000 metrics={'f1_val': 0.7998781950183187, 'auprc': 0.7998781950183187, 'loss_val': 1.2739570611329452, 'psi': 0.7998781950183187}-{'f1_val': 0.570673284528624, 'auprc': 0.570673284528624, 'loss_val': 1.3305220337274104, 'psi': 0.570673284528624}
[S6] START round=11 head_norm_before_train=1.474193 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.352702940533848, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5140164004160526, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.339566 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.0007446709485246206, 'auprc': 0.0007446709485246206, 'loss_val': 1.4373169058360256, 'psi': 0.0007446709485246206}-{'f1_val': 0.18588271321390293, 'auprc': 0.18588271321390293, 'loss_val': 1.5992965769241785, 'psi': 0.18588271321390293}
[S8] START round=11 head_norm_before_train=1.362251 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.4251161907223013, 'auprc': 0.4251161907223013, 'loss_val': 1.2566050272696607, 'psi': 0.42511619072230133}-{'f1_val': 0.5336922938440279, 'auprc': 0.5336922938440279, 'loss_val': 1.317622301657126, 'psi': 0.5336922938440279}
[S9] START round=11 head_norm_before_train=1.443783 (no previous merge yet)
[S9] round=11 local utility u=0.875689 metrics={'f1_val': 0.14321608040201006, 'auprc': 0.14321608040201006, 'loss_val': 2.1134328579039106, 'psi': 0.14321608040201006}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.575865931234273, 'psi': 0.0}
[S10] START round=11 head_norm_before_train=1.464070 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5615255505108525, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.321889527191444, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.490176 (no previous merge yet)
[S11] round=11 local utility u=0.048994 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9520397037631518, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.050026804594342, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.301990 (no previous merge yet)
[S13] round=11 local utility u=0.064013 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.415197425182759, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5432242635402942, 'psi': 0.0}
[S14] START round=11 head_norm_before_train=1.521302 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.04087634171445376, 'auprc': 0.04087634171445376, 'loss_val': 4.648141330693356, 'psi': 0.04087634171445376}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.270715861972386, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.380899 (no previous merge yet)
[S15] round=11 local utility u=0.013278 metrics={'f1_val': 0.9930016382809459, 'auprc': 0.9930016382809459, 'loss_val': 1.1116325483873604, 'psi': 0.9930016382809459}-{'f1_val': 0.9980380472506714, 'auprc': 0.9980380472506714, 'loss_val': 1.1835162305294478, 'psi': 0.9980380472506714}
[S16] START round=11 head_norm_before_train=1.458767 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.156746832633982, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.873374027071285, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.431798 (no previous merge yet)
[S17] round=11 local utility u=0.012535 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3170791603098837, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.342148506054825, 'psi': 0.0}
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.143)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S13] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:61810
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S15
[S9] cosine check vs S15: cos=-0.0100
[S9] DROPPED delta from S15 (cos=-0.0100 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S5
[S13] cosine check vs S5: cos=-0.1177
[S13] DROPPED delta from S5 (cos=-0.1177 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=12 head_norm_before_train=1.504518 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0548364815698106, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8679811605089065, 'psi': 0.0}
[S3] START round=12 head_norm_before_train=1.486899 (no previous merge yet)
[S3] round=12 local utility u=0.168354 metrics={'f1_val': 0.08144269924374636, 'auprc': 0.08144269924374636, 'loss_val': 2.381694520222071, 'psi': 0.08144269924374636}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9854186523614288, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.483649 (no previous merge yet)
[S4] round=12 local utility u=0.000837 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3239650684253423, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3256380810064328, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.347547 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.37173503946376896, 'auprc': 0.37173503946376896, 'loss_val': 1.2298220679241638, 'psi': 0.37173503946376896}-{'f1_val': 0.7998781950183187, 'auprc': 0.7998781950183187, 'loss_val': 1.2739570611329452, 'psi': 0.7998781950183187}
[S6] START round=12 head_norm_before_train=1.507868 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 4.876735758051017, 'psi': 0.002619047619047619}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.352702940533848, 'psi': 0.0}
[S7] START round=12 head_norm_before_train=1.347068 (no previous merge yet)
[S7] round=12 local utility u=0.002497 metrics={'f1_val': 0.0009305788200260562, 'auprc': 0.0009305788200260562, 'loss_val': 1.4339963840632945, 'psi': 0.0009305788200260562}-{'f1_val': 0.0007446709485246206, 'auprc': 0.0007446709485246206, 'loss_val': 1.4373169058360256, 'psi': 0.0007446709485246206}
[S8] START round=12 head_norm_before_train=1.392946 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.28108171386302266, 'auprc': 0.28108171386302266, 'loss_val': 1.2265415740823218, 'psi': 0.28108171386302266}-{'f1_val': 0.4251161907223013, 'auprc': 0.4251161907223013, 'loss_val': 1.2566050272696607, 'psi': 0.42511619072230133}
[S9] START round=12 head_norm_before_train=1.482958 (no previous merge yet)
[S9] round=12 local utility u=0.489255 metrics={'f1_val': 0.2403668632005241, 'auprc': 0.2403668632005241, 'loss_val': 2.0092803898934073, 'psi': 0.24036686320052414}-{'f1_val': 0.14321608040201006, 'auprc': 0.14321608040201006, 'loss_val': 2.1134328579039106, 'psi': 0.14321608040201006}
[S10] START round=12 head_norm_before_train=1.496179 (no previous merge yet)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.396937797319025, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5615255505108525, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.520203 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3920181352746694, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9520397037631518, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.316650 (no previous merge yet)
[S13] round=12 local utility u=1.000000 metrics={'f1_val': 0.26417334520629265, 'auprc': 0.26417334520629265, 'loss_val': 1.3259940432107262, 'psi': 0.26417334520629265}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.415197425182759, 'psi': 0.0}
[S14] START round=12 head_norm_before_train=1.554778 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.05039096437880105, 'auprc': 0.05039096437880105, 'loss_val': 4.884782519025703, 'psi': 0.05039096437880105}-{'f1_val': 0.04087634171445376, 'auprc': 0.04087634171445376, 'loss_val': 4.648141330693356, 'psi': 0.04087634171445376}
[S15] START round=12 head_norm_before_train=1.418540 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6651642684745376, 'auprc': 0.6651642684745376, 'loss_val': 1.0253853609199628, 'psi': 0.6651642684745376}-{'f1_val': 0.9930016382809459, 'auprc': 0.9930016382809459, 'loss_val': 1.1116325483873604, 'psi': 0.9930016382809459}
[S16] START round=12 head_norm_before_train=1.481973 (no previous merge yet)
[S16] round=12 local utility u=0.019823 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.117101666511756, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.156746832633982, 'psi': 0.0}
[S17] START round=12 head_norm_before_train=1.455727 (no previous merge yet)
[S17] round=12 local utility u=0.923673 metrics={'f1_val': 0.20278940027894002, 'auprc': 0.20278940027894002, 'loss_val': 1.2948378675693426, 'psi': 0.20278940027894002}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3170791603098837, 'psi': 0.0}
[S7] not sending this round → trigger blocked (psi=0.001)
[S3] not sending this round → trigger blocked (psi=0.081)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S13] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] cosine check vs S9: cos=0.0777
[S7] RECEIVED delta(kind=head bytes=1802) from S13
[S7] cosine check vs S13: cos=0.0362
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=-0.0141
[S13] DROPPED delta from S17 (cos=-0.0141 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.0009 head_norm=1.365146
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.391245e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.3328 head_norm=0.973729 delta_norm=0.939125
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.0000 head_norm=1.541871
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.040834e+00
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.125140 delta_norm=1.040834
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.531959 (no previous merge yet)
[S2] round=13 local utility u=0.113109 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.828618242196632, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0548364815698106, 'psi': 0.0}
[S3] START round=13 head_norm_before_train=1.515923 (no previous merge yet)
[S3] round=13 local utility u=0.997247 metrics={'f1_val': 0.2945521698984303, 'auprc': 0.2945521698984303, 'loss_val': 2.3051852074194144, 'psi': 0.2945521698984303}-{'f1_val': 0.08144269924374636, 'auprc': 0.08144269924374636, 'loss_val': 2.381694520222071, 'psi': 0.08144269924374636}
[S4] START round=13 head_norm_before_train=1.514210 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3252380261675352, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3239650684253423, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.370393 (no previous merge yet)
[S5] round=13 local utility u=0.017435 metrics={'f1_val': 0.37309725911855346, 'auprc': 0.37309725911855346, 'loss_val': 1.207212451672401, 'psi': 0.37309725911855346}-{'f1_val': 0.37173503946376896, 'auprc': 0.37173503946376896, 'loss_val': 1.2298220679241638, 'psi': 0.37173503946376896}
[S6] START round=13 head_norm_before_train=1.538397 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 5.114861328670905, 'psi': 0.018441678192715538}-{'f1_val': 0.002619047619047619, 'auprc': 0.002619047619047619, 'loss_val': 4.876735758051017, 'psi': 0.002619047619047619}
[S7] START round=13 head_norm_before_train=0.973729 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=1.000000 metrics={'f1_val': 0.33280237867686097, 'auprc': 0.33280237867686097, 'loss_val': 1.4129867327348218, 'psi': 0.33280237867686097}-{'f1_val': 0.0009305788200260562, 'auprc': 0.0009305788200260562, 'loss_val': 1.4339963840632945, 'psi': 0.0009305788200260562}
[S8] START round=13 head_norm_before_train=1.427683 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.2543855706776838, 'auprc': 0.2543855706776838, 'loss_val': 1.1818001817703776, 'psi': 0.2543855706776838}-{'f1_val': 0.28108171386302266, 'auprc': 0.28108171386302266, 'loss_val': 1.2265415740823218, 'psi': 0.28108171386302266}
[S9] START round=13 head_norm_before_train=1.523544 (no previous merge yet)
[S9] round=13 local utility u=0.528062 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.107901118893982, 'psi': 0.36867172340800847}-{'f1_val': 0.2403668632005241, 'auprc': 0.2403668632005241, 'loss_val': 2.0092803898934073, 'psi': 0.24036686320052414}
[S10] START round=13 head_norm_before_train=1.520368 (no previous merge yet)
[S10] round=13 local utility u=0.018972 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.358994724286037, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.396937797319025, 'psi': 0.0}
[S11] START round=13 head_norm_before_train=1.125140 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.239726 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9125661425348546, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3920181352746694, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.340367 (no previous merge yet)
[S13] round=13 local utility u=0.300545 metrics={'f1_val': 0.3208365212955879, 'auprc': 0.3208365212955879, 'loss_val': 1.2348723825278778, 'psi': 0.3208365212955879}-{'f1_val': 0.26417334520629265, 'auprc': 0.26417334520629265, 'loss_val': 1.3259940432107262, 'psi': 0.26417334520629265}
[S14] START round=13 head_norm_before_train=1.588986 (no previous merge yet)
[S14] round=13 local utility u=0.349182 metrics={'f1_val': 0.13010590015128592, 'auprc': 0.13010590015128592, 'loss_val': 4.9038530239711235, 'psi': 0.13010590015128592}-{'f1_val': 0.05039096437880105, 'auprc': 0.05039096437880105, 'loss_val': 4.884782519025703, 'psi': 0.05039096437880105}
[S15] START round=13 head_norm_before_train=1.456702 (no previous merge yet)
[S15] round=13 local utility u=0.918409 metrics={'f1_val': 0.8645031135856229, 'auprc': 0.8645031135856229, 'loss_val': 0.9826164921999225, 'psi': 0.8645031135856229}-{'f1_val': 0.6651642684745376, 'auprc': 0.6651642684745376, 'loss_val': 1.0253853609199628, 'psi': 0.6651642684745376}
[S16] START round=13 head_norm_before_train=1.503099 (no previous merge yet)
[S16] round=13 local utility u=0.042407 metrics={'f1_val': 0.011354079058031959, 'auprc': 0.011354079058031959, 'loss_val': 3.1344740093223913, 'psi': 0.011354079058031959}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.117101666511756, 'psi': 0.0}
[S17] START round=13 head_norm_before_train=1.480068 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.19721315591262867, 'auprc': 0.19721315591262867, 'loss_val': 1.2869831085594623, 'psi': 0.19721315591262867}-{'f1_val': 0.20278940027894002, 'auprc': 0.20278940027894002, 'loss_val': 1.2948378675693426, 'psi': 0.20278940027894002}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:61810
[S16] not sending this round → trigger blocked (psi=0.011)
[S13] not sending this round → trigger blocked (psi=0.321)
[S14] not sending this round → trigger blocked (psi=0.130)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:61813
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61813
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.369)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S5
[S13] cosine check vs S5: cos=-0.1337
[S13] DROPPED delta from S5 (cos=-0.1337 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] cosine check vs S7: cos=-0.0039
[S8] DROPPED delta from S7 (cos=-0.0039 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S15
[S9] cosine check vs S15: cos=-0.0125
[S9] DROPPED delta from S15 (cos=-0.0125 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S3
[S13] cosine check vs S3: cos=0.0939
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.3208 head_norm=1.364888
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.819658e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.5677 head_norm=1.078145 delta_norm=0.981966
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.559869 (no previous merge yet)
[S2] round=14 local utility u=0.893156 metrics={'f1_val': 0.18362486655169583, 'auprc': 0.18362486655169583, 'loss_val': 2.6949306502674593, 'psi': 0.18362486655169583}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.828618242196632, 'psi': 0.0}
[S3] START round=14 head_norm_before_train=1.546088 (no previous merge yet)
[S3] round=14 local utility u=0.020806 metrics={'f1_val': 0.2903276622558286, 'auprc': 0.2903276622558286, 'loss_val': 2.2255521132641594, 'psi': 0.2903276622558286}-{'f1_val': 0.2945521698984303, 'auprc': 0.2945521698984303, 'loss_val': 2.3051852074194144, 'psi': 0.2945521698984303}
[S4] START round=14 head_norm_before_train=1.549247 (no previous merge yet)
[S4] round=14 local utility u=0.002714 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3198104980401584, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3252380261675352, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.398569 (no previous merge yet)
[S5] round=14 local utility u=0.028193 metrics={'f1_val': 0.3771660680764966, 'auprc': 0.3771660680764966, 'loss_val': 1.1874450445388525, 'psi': 0.3771660680764966}-{'f1_val': 0.37309725911855346, 'auprc': 0.37309725911855346, 'loss_val': 1.207212451672401, 'psi': 0.37309725911855346}
[S6] START round=14 head_norm_before_train=1.567855 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 5.436812214000388, 'psi': 0.019770114942528734}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 5.114861328670905, 'psi': 0.018441678192715538}
[S7] START round=14 head_norm_before_train=0.992019 cos_to_last_merge=0.9984 (last merge round=12)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.057081004918001506, 'auprc': 0.057081004918001506, 'loss_val': 1.3787898347827912, 'psi': 0.0570810049180015}-{'f1_val': 0.33280237867686097, 'auprc': 0.33280237867686097, 'loss_val': 1.4129867327348218, 'psi': 0.33280237867686097}
[S8] START round=14 head_norm_before_train=1.463082 (no previous merge yet)
[S8] round=14 local utility u=0.306951 metrics={'f1_val': 0.3146890314485726, 'auprc': 0.3146890314485726, 'loss_val': 1.1106299724183248, 'psi': 0.3146890314485726}-{'f1_val': 0.2543855706776838, 'auprc': 0.2543855706776838, 'loss_val': 1.1818001817703776, 'psi': 0.2543855706776838}
[S9] START round=14 head_norm_before_train=1.564468 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2662718548015532, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.107901118893982, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.537151 (no previous merge yet)
[S10] round=14 local utility u=0.239205 metrics={'f1_val': 0.004734848484848485, 'auprc': 0.004734848484848485, 'loss_val': 3.9231985759470858, 'psi': 0.004734848484848485}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.358994724286037, 'psi': 0.0}
[S11] START round=14 head_norm_before_train=1.153638 cos_to_last_merge=0.9991 (last merge round=12)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9736536412147143, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9125661425348546, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.078145 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=1.000000 metrics={'f1_val': 0.6646007025350977, 'auprc': 0.6646007025350977, 'loss_val': 1.2619389052981151, 'psi': 0.6646007025350977}-{'f1_val': 0.3208365212955879, 'auprc': 0.3208365212955879, 'loss_val': 1.2348723825278778, 'psi': 0.3208365212955879}
[S14] START round=14 head_norm_before_train=1.622854 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.12165450121654502, 'auprc': 0.12165450121654502, 'loss_val': 5.034490949390548, 'psi': 0.121654501216545}-{'f1_val': 0.13010590015128592, 'auprc': 0.13010590015128592, 'loss_val': 4.9038530239711235, 'psi': 0.13010590015128592}
[S15] START round=14 head_norm_before_train=1.489903 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6662925642233294, 'auprc': 0.6662925642233294, 'loss_val': 0.9042360252742481, 'psi': 0.6662925642233294}-{'f1_val': 0.8645031135856229, 'auprc': 0.8645031135856229, 'loss_val': 0.9826164921999225, 'psi': 0.8645031135856229}
[S16] START round=14 head_norm_before_train=1.525131 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6191008993727904, 'psi': 0.0}-{'f1_val': 0.011354079058031959, 'auprc': 0.011354079058031959, 'loss_val': 3.1344740093223913, 'psi': 0.011354079058031959}
[S17] START round=14 head_norm_before_train=1.506578 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.15483934555489848, 'auprc': 0.15483934555489848, 'loss_val': 1.2582078685411573, 'psi': 0.15483934555489848}-{'f1_val': 0.19721315591262867, 'auprc': 0.19721315591262867, 'loss_val': 1.2869831085594623, 'psi': 0.19721315591262867}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.290)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61808
[S5] not sending this round → trigger blocked (psi=0.377)
[S2] not sending this round → trigger blocked (psi=0.184)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:61815
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.005)
[S8] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=0.5158
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=-0.0797
[S15] DROPPED delta from S8 (cos=-0.0797 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.0571 head_norm=1.009879
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.207615e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.2496 head_norm=0.919053 delta_norm=0.520762
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.588462 (no previous merge yet)
[S2] round=15 local utility u=0.556986 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.317631126487347, 'psi': 0.2654773703336637}-{'f1_val': 0.18362486655169583, 'auprc': 0.18362486655169583, 'loss_val': 2.6949306502674593, 'psi': 0.18362486655169583}
[S3] START round=15 head_norm_before_train=1.577363 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.26373050203172105, 'auprc': 0.26373050203172105, 'loss_val': 1.9886607808348167, 'psi': 0.26373050203172105}-{'f1_val': 0.2903276622558286, 'auprc': 0.2903276622558286, 'loss_val': 2.2255521132641594, 'psi': 0.2903276622558286}
[S4] START round=15 head_norm_before_train=1.588357 (no previous merge yet)
[S4] round=15 local utility u=0.010021 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.299768330159787, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3198104980401584, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.419228 (no previous merge yet)
[S5] round=15 local utility u=1.000000 metrics={'f1_val': 0.8971145937737822, 'auprc': 0.8971145937737822, 'loss_val': 1.1721776623399505, 'psi': 0.8971145937737822}-{'f1_val': 0.3771660680764966, 'auprc': 0.3771660680764966, 'loss_val': 1.1874450445388525, 'psi': 0.3771660680764966}
[S6] START round=15 head_norm_before_train=1.595793 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 5.6810563417966184, 'psi': 0.020211299954065228}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 5.436812214000388, 'psi': 0.019770114942528734}
[S7] START round=15 head_norm_before_train=0.919053 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=1.000000 metrics={'f1_val': 0.3329084342468664, 'auprc': 0.3329084342468664, 'loss_val': 1.368308690095831, 'psi': 0.3329084342468664}-{'f1_val': 0.057081004918001506, 'auprc': 0.057081004918001506, 'loss_val': 1.3787898347827912, 'psi': 0.0570810049180015}
[S8] START round=15 head_norm_before_train=1.499471 (no previous merge yet)
[S8] round=15 local utility u=0.278732 metrics={'f1_val': 0.3690121405170217, 'auprc': 0.3690121405170217, 'loss_val': 1.0420741373798448, 'psi': 0.3690121405170217}-{'f1_val': 0.3146890314485726, 'auprc': 0.3146890314485726, 'loss_val': 1.1106299724183248, 'psi': 0.3146890314485726}
[S9] START round=15 head_norm_before_train=1.601469 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3460926730299145, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2662718548015532, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.553601 (no previous merge yet)
[S10] round=15 local utility u=0.454104 metrics={'f1_val': 0.15156562291805464, 'auprc': 0.15156562291805464, 'loss_val': 4.336468533914865, 'psi': 0.15156562291805464}-{'f1_val': 0.004734848484848485, 'auprc': 0.004734848484848485, 'loss_val': 3.9231985759470858, 'psi': 0.004734848484848485}
[S11] START round=15 head_norm_before_train=1.196786 cos_to_last_merge=0.9953 (last merge round=12)
[S11] round=15 local utility u=1.000000 metrics={'f1_val': 0.2923332459131043, 'auprc': 0.2923332459131043, 'loss_val': 1.9283606014181058, 'psi': 0.2923332459131043}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9736536412147143, 'psi': 0.0}
[S13] START round=15 head_norm_before_train=1.100839 cos_to_last_merge=0.9986 (last merge round=13)
[S13] round=15 local utility u=0.014733 metrics={'f1_val': 0.6634581568086424, 'auprc': 0.6634581568086424, 'loss_val': 1.2221896283605085, 'psi': 0.6634581568086424}-{'f1_val': 0.6646007025350977, 'auprc': 0.6646007025350977, 'loss_val': 1.2619389052981151, 'psi': 0.6646007025350977}
[S14] START round=15 head_norm_before_train=1.655960 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.1199743095696853, 'auprc': 0.1199743095696853, 'loss_val': 5.149921355800456, 'psi': 0.1199743095696853}-{'f1_val': 0.12165450121654502, 'auprc': 0.12165450121654502, 'loss_val': 5.034490949390548, 'psi': 0.121654501216545}
[S15] START round=15 head_norm_before_train=1.522058 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6168572596540716, 'auprc': 0.6168572596540716, 'loss_val': 0.8523951023109293, 'psi': 0.6168572596540716}-{'f1_val': 0.6662925642233294, 'auprc': 0.6662925642233294, 'loss_val': 0.9042360252742481, 'psi': 0.6662925642233294}
[S16] START round=15 head_norm_before_train=1.547731 (no previous merge yet)
[S16] round=15 local utility u=0.077178 metrics={'f1_val': 0.017186793306196293, 'auprc': 0.017186793306196293, 'loss_val': 3.6194269405625583, 'psi': 0.017186793306196293}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6191008993727904, 'psi': 0.0}
[S17] START round=15 head_norm_before_train=1.532471 (no previous merge yet)
[S17] round=15 local utility u=0.008369 metrics={'f1_val': 0.15267249757045676, 'auprc': 0.15267249757045676, 'loss_val': 1.2219689295566962, 'psi': 0.15267249757045676}-{'f1_val': 0.15483934555489848, 'auprc': 0.15483934555489848, 'loss_val': 1.2582078685411573, 'psi': 0.15483934555489848}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.152)
[S13] not sending this round → trigger blocked (psi=0.663)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:61804
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.369)
[S16] not sending this round → trigger blocked (psi=0.017)
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S5
[S13] cosine check vs S5: cos=-0.1007
[S13] DROPPED delta from S5 (cos=-0.1007 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=-0.0687
[S4] DROPPED delta from S2 (cos=-0.0687 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=-0.1071
[S5] DROPPED delta from S11 (cos=-0.1071 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=0.0100
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=-0.0035
[S13] DROPPED delta from S17 (cos=-0.0035 < 0.0)
[S10] ⇄ pheromone p=0.167 → S4@127.0.0.1:61804
[S14] ⇄ pheromone p=0.081 → S7@127.0.0.1:61808
[S6] ⇄ pheromone p=0.046 → S5@127.0.0.1:61805
[S13] ⇄ pheromone p=0.354 → S7@127.0.0.1:61808
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.3690 head_norm=1.529975
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.944293e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.3581 head_norm=0.902430 delta_norm=0.894429
[S8] aggregate: ROLLBACK (f1_val pre=0.369 post=0.358 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.199 → S15@127.0.0.1:61815
[S4] ⇄ pheromone p=0.041 → S11@127.0.0.1:61812
[S15] ⇄ pheromone p=0.281 → S9@127.0.0.1:61810
[S9] ⇄ pheromone p=0.237 → S11@127.0.0.1:61812
[S3] ⇄ pheromone p=0.212 → S13@127.0.0.1:61813
[S7] ⇄ pheromone p=0.419 → S8@127.0.0.1:61809
[S11] ⇄ pheromone p=0.283 → S5@127.0.0.1:61805
[S2] ⇄ pheromone p=0.337 → S4@127.0.0.1:61804
[S5] ⇄ pheromone p=0.441 → S13@127.0.0.1:61813
[S16] ⇄ pheromone p=0.071 → S2@127.0.0.1:61802
[S17] ⇄ pheromone p=0.146 → S13@127.0.0.1:61813
[S2] START round=16 head_norm_before_train=1.616941 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.2404556000843704, 'auprc': 0.2404556000843704, 'loss_val': 2.5615379491911456, 'psi': 0.2404556000843704}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.317631126487347, 'psi': 0.2654773703336637}
[S3] START round=16 head_norm_before_train=1.605250 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.27782380557856945, 'auprc': 0.27782380557856945, 'loss_val': 2.2049850455456075, 'psi': 0.27782380557856945}-{'f1_val': 0.26373050203172105, 'auprc': 0.26373050203172105, 'loss_val': 1.9886607808348167, 'psi': 0.26373050203172105}
[S4] START round=16 head_norm_before_train=1.624936 (no previous merge yet)
[S4] round=16 local utility u=0.711422 metrics={'f1_val': 0.15611650485436893, 'auprc': 0.15611650485436893, 'loss_val': 1.2819726574858272, 'psi': 0.15611650485436893}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.299768330159787, 'psi': 0.0}
[S5] START round=16 head_norm_before_train=1.439139 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.664595922829854, 'auprc': 0.664595922829854, 'loss_val': 1.1545825928925066, 'psi': 0.664595922829854}-{'f1_val': 0.8971145937737822, 'auprc': 0.8971145937737822, 'loss_val': 1.1721776623399505, 'psi': 0.8971145937737822}
[S6] START round=16 head_norm_before_train=1.622680 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 5.792329360788436, 'psi': 0.020431588613406795}-{'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 5.6810563417966184, 'psi': 0.020211299954065228}
[S7] START round=16 head_norm_before_train=0.942306 cos_to_last_merge=0.9966 (last merge round=14)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3808196781391635, 'psi': 0.0}-{'f1_val': 0.3329084342468664, 'auprc': 0.3329084342468664, 'loss_val': 1.368308690095831, 'psi': 0.3329084342468664}
[S8] START round=16 head_norm_before_train=0.902430 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.3723978664312793, 'auprc': 0.3723978664312793, 'loss_val': 1.1481850264257398, 'psi': 0.3723978664312793}-{'f1_val': 0.3690121405170217, 'auprc': 0.3690121405170217, 'loss_val': 1.0420741373798448, 'psi': 0.3690121405170217}
[S9] START round=16 head_norm_before_train=1.632854 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.392707098154396, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3460926730299145, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.571652 (no previous merge yet)
[S10] round=16 local utility u=0.568919 metrics={'f1_val': 0.1912632821723731, 'auprc': 0.1912632821723731, 'loss_val': 3.5559101531750477, 'psi': 0.1912632821723731}-{'f1_val': 0.15156562291805464, 'auprc': 0.15156562291805464, 'loss_val': 4.336468533914865, 'psi': 0.15156562291805464}
[S11] START round=16 head_norm_before_train=1.239148 cos_to_last_merge=0.9900 (last merge round=12)
[S11] round=16 local utility u=0.140931 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.003620169676079, 'psi': 0.3320133550741517}-{'f1_val': 0.2923332459131043, 'auprc': 0.2923332459131043, 'loss_val': 1.9283606014181058, 'psi': 0.2923332459131043}
[S13] START round=16 head_norm_before_train=1.131734 cos_to_last_merge=0.9929 (last merge round=13)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.3360767603463577, 'auprc': 0.3360767603463577, 'loss_val': 1.2010308517940242, 'psi': 0.3360767603463577}-{'f1_val': 0.6634581568086424, 'auprc': 0.6634581568086424, 'loss_val': 1.2221896283605085, 'psi': 0.6634581568086424}
[S14] START round=16 head_norm_before_train=1.686710 (no previous merge yet)
[S14] round=16 local utility u=0.012467 metrics={'f1_val': 0.13051146384479717, 'auprc': 0.13051146384479717, 'loss_val': 5.21982227250287, 'psi': 0.13051146384479717}-{'f1_val': 0.1199743095696853, 'auprc': 0.1199743095696853, 'loss_val': 5.149921355800456, 'psi': 0.1199743095696853}
[S15] START round=16 head_norm_before_train=1.551942 (no previous merge yet)
[S15] round=16 local utility u=0.002330 metrics={'f1_val': 0.6138333475435748, 'auprc': 0.6138333475435748, 'loss_val': 0.8205196723317141, 'psi': 0.6138333475435748}-{'f1_val': 0.6168572596540716, 'auprc': 0.6168572596540716, 'loss_val': 0.8523951023109293, 'psi': 0.6168572596540716}
[S16] START round=16 head_norm_before_train=1.568411 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.00018585633305454884, 'auprc': 0.00018585633305454884, 'loss_val': 4.00574033514421, 'psi': 0.00018585633305454884}-{'f1_val': 0.017186793306196293, 'auprc': 0.017186793306196293, 'loss_val': 3.6194269405625583, 'psi': 0.017186793306196293}
[S17] START round=16 head_norm_before_train=1.556813 (no previous merge yet)
[S17] round=16 local utility u=0.028499 metrics={'f1_val': 0.15246506211180125, 'auprc': 0.15246506211180125, 'loss_val': 1.1631040150301786, 'psi': 0.15246506211180125}-{'f1_val': 0.15267249757045676, 'auprc': 0.15267249757045676, 'loss_val': 1.2219689295566962, 'psi': 0.15267249757045676}
[S11] not sending this round → trigger blocked (psi=0.332)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.191)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:61810
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.131)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.156)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=-0.0195
[S9] DROPPED delta from S15 (cos=-0.0195 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.152)
[S2] START round=17 head_norm_before_train=1.644859 (no previous merge yet)
[S2] round=17 local utility u=0.052775 metrics={'f1_val': 0.2495528958591278, 'auprc': 0.2495528958591278, 'loss_val': 2.5378644149616694, 'psi': 0.2495528958591278}-{'f1_val': 0.2404556000843704, 'auprc': 0.2404556000843704, 'loss_val': 2.5615379491911456, 'psi': 0.2404556000843704}
[S3] START round=17 head_norm_before_train=1.630706 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.2649285667259201, 'auprc': 0.2649285667259201, 'loss_val': 2.211553474931497, 'psi': 0.2649285667259201}-{'f1_val': 0.27782380557856945, 'auprc': 0.27782380557856945, 'loss_val': 2.2049850455456075, 'psi': 0.27782380557856945}
[S4] START round=17 head_norm_before_train=1.657170 (no previous merge yet)
[S4] round=17 local utility u=0.803364 metrics={'f1_val': 0.33299492385786805, 'auprc': 0.33299492385786805, 'loss_val': 1.2671511683954813, 'psi': 0.33299492385786805}-{'f1_val': 0.15611650485436893, 'auprc': 0.15611650485436893, 'loss_val': 1.2819726574858272, 'psi': 0.15611650485436893}
[S5] START round=17 head_norm_before_train=1.464183 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.49780635746243046, 'auprc': 0.49780635746243046, 'loss_val': 1.1164678384887152, 'psi': 0.4978063574624305}-{'f1_val': 0.664595922829854, 'auprc': 0.664595922829854, 'loss_val': 1.1545825928925066, 'psi': 0.664595922829854}
[S6] START round=17 head_norm_before_train=1.646724 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 5.953008898634046, 'psi': 0.018663594470046084}-{'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 5.792329360788436, 'psi': 0.020431588613406795}
[S7] START round=17 head_norm_before_train=0.980727 cos_to_last_merge=0.9841 (last merge round=14)
[S7] round=17 local utility u=0.005658 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.369503084432669, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3808196781391635, 'psi': 0.0}
[S8] START round=17 head_norm_before_train=0.949508 cos_to_last_merge=0.9978 (last merge round=15)
[S8] round=17 local utility u=0.057700 metrics={'f1_val': 0.37901894679939535, 'auprc': 0.37901894679939535, 'loss_val': 1.0923756458804088, 'psi': 0.37901894679939535}-{'f1_val': 0.3723978664312793, 'auprc': 0.3723978664312793, 'loss_val': 1.1481850264257398, 'psi': 0.3723978664312793}
[S9] START round=17 head_norm_before_train=1.659346 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4622763155880483, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.392707098154396, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.591592 (no previous merge yet)
[S10] round=17 local utility u=0.228904 metrics={'f1_val': 0.2124003299422601, 'auprc': 0.2124003299422601, 'loss_val': 3.2883363638810765, 'psi': 0.2124003299422601}-{'f1_val': 0.1912632821723731, 'auprc': 0.1912632821723731, 'loss_val': 3.5559101531750477, 'psi': 0.1912632821723731}
[S11] START round=17 head_norm_before_train=1.279696 cos_to_last_merge=0.9839 (last merge round=12)
[S11] round=17 local utility u=0.002158 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 1.9951342604246123, 'psi': 0.33154997286190585}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.003620169676079, 'psi': 0.3320133550741517}
[S13] START round=17 head_norm_before_train=1.162538 cos_to_last_merge=0.9845 (last merge round=13)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.23886615667437586, 'auprc': 0.23886615667437586, 'loss_val': 1.1715498755396088, 'psi': 0.23886615667437588}-{'f1_val': 0.3360767603463577, 'auprc': 0.3360767603463577, 'loss_val': 1.2010308517940242, 'psi': 0.3360767603463577}
[S14] START round=17 head_norm_before_train=1.714386 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.261501838815399, 'psi': 0.13333333333333333}-{'f1_val': 0.13051146384479717, 'auprc': 0.13051146384479717, 'loss_val': 5.21982227250287, 'psi': 0.13051146384479717}
[S15] START round=17 head_norm_before_train=1.578484 (no previous merge yet)
[S15] round=17 local utility u=0.030458 metrics={'f1_val': 0.613632367515106, 'auprc': 0.613632367515106, 'loss_val': 0.7577940440507727, 'psi': 0.613632367515106}-{'f1_val': 0.6138333475435748, 'auprc': 0.6138333475435748, 'loss_val': 0.8205196723317141, 'psi': 0.6138333475435748}
[S16] START round=17 head_norm_before_train=1.590646 (no previous merge yet)
[S16] round=17 local utility u=0.535086 metrics={'f1_val': 0.08775313404050145, 'auprc': 0.08775313404050145, 'loss_val': 3.723673132664728, 'psi': 0.08775313404050145}-{'f1_val': 0.00018585633305454884, 'auprc': 0.00018585633305454884, 'loss_val': 4.00574033514421, 'psi': 0.00018585633305454884}
[S17] START round=17 head_norm_before_train=1.576646 (no previous merge yet)
[S17] round=17 local utility u=0.057002 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0475032816076335, 'psi': 0.152287708414114}-{'f1_val': 0.15246506211180125, 'auprc': 0.15246506211180125, 'loss_val': 1.1631040150301786, 'psi': 0.15246506211180125}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61815
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:61804
[S15] not sending this round → trigger blocked (psi=0.614)
[S16] not sending this round → trigger blocked (psi=0.088)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S4
[S11] cosine check vs S4: cos=0.0381
[S5] RECEIVED delta(kind=head bytes=1806) from S11
[S5] cosine check vs S11: cos=-0.1094
[S5] DROPPED delta from S11 (cos=-0.1094 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=-0.1030
[S15] DROPPED delta from S8 (cos=-0.1030 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.0275
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=-0.0643
[S4] DROPPED delta from S2 (cos=-0.0643 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S17
[S13] cosine check vs S17: cos=-0.0043
[S13] DROPPED delta from S17 (cos=-0.0043 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.3330 head_norm=1.687218
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.150471e+00
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.0000 head_norm=1.182494 delta_norm=1.150471
[S4] aggregate: ROLLBACK (f1_val pre=0.333 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.3315 head_norm=1.315018
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.049640e+00
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.3105 head_norm=1.089148 delta_norm=1.049640
[S11] aggregate: ROLLBACK (f1_val pre=0.332 post=0.311 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.669866 (no previous merge yet)
[S2] round=18 local utility u=0.245959 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.1887929313585754, 'psi': 0.26542475888492534}-{'f1_val': 0.2495528958591278, 'auprc': 0.2495528958591278, 'loss_val': 2.5378644149616694, 'psi': 0.2495528958591278}
[S3] START round=18 head_norm_before_train=1.658165 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.3018897149938042, 'auprc': 0.3018897149938042, 'loss_val': 2.640588699233227, 'psi': 0.3018897149938042}-{'f1_val': 0.2649285667259201, 'auprc': 0.2649285667259201, 'loss_val': 2.211553474931497, 'psi': 0.2649285667259201}
[S4] START round=18 head_norm_before_train=1.182494 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3326138019799179, 'psi': 0.0}-{'f1_val': 0.33299492385786805, 'auprc': 0.33299492385786805, 'loss_val': 1.2671511683954813, 'psi': 0.33299492385786805}
[S5] START round=18 head_norm_before_train=1.495800 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.25082219669263744, 'auprc': 0.25082219669263744, 'loss_val': 1.106512904353333, 'psi': 0.25082219669263744}-{'f1_val': 0.49780635746243046, 'auprc': 0.49780635746243046, 'loss_val': 1.1164678384887152, 'psi': 0.4978063574624305}
[S6] START round=18 head_norm_before_train=1.666383 (no previous merge yet)
[S6] round=18 local utility u=0.006363 metrics={'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 5.954212382209477, 'psi': 0.020211299954065228}-{'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 5.953008898634046, 'psi': 0.018663594470046084}
[S7] START round=18 head_norm_before_train=1.013978 cos_to_last_merge=0.9703 (last merge round=14)
[S7] round=18 local utility u=0.002282 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.364938364848938, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.369503084432669, 'psi': 0.0}
[S8] START round=18 head_norm_before_train=1.018069 cos_to_last_merge=0.9890 (last merge round=15)
[S8] round=18 local utility u=0.096701 metrics={'f1_val': 0.39441441541757, 'auprc': 0.39441441541757, 'loss_val': 1.037533251417656, 'psi': 0.39441441541757}-{'f1_val': 0.37901894679939535, 'auprc': 0.37901894679939535, 'loss_val': 1.0923756458804088, 'psi': 0.37901894679939535}
[S9] START round=18 head_norm_before_train=1.680940 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.535942741413331, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4622763155880483, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.611536 (no previous merge yet)
[S10] round=18 local utility u=0.180622 metrics={'f1_val': 0.23227540312260045, 'auprc': 0.23227540312260045, 'loss_val': 3.105967225059707, 'psi': 0.23227540312260042}-{'f1_val': 0.2124003299422601, 'auprc': 0.2124003299422601, 'loss_val': 3.2883363638810765, 'psi': 0.2124003299422601}
[S11] START round=18 head_norm_before_train=1.089148 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.163498 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.67161202894094, 'psi': 0.3319360347772085}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 1.9951342604246123, 'psi': 0.33154997286190585}
[S13] START round=18 head_norm_before_train=1.193882 cos_to_last_merge=0.9774 (last merge round=13)
[S13] round=18 local utility u=0.009838 metrics={'f1_val': 0.23878119627719485, 'auprc': 0.23878119627719485, 'loss_val': 1.1511096186658127, 'psi': 0.23878119627719485}-{'f1_val': 0.23886615667437586, 'auprc': 0.23886615667437586, 'loss_val': 1.1715498755396088, 'psi': 0.23886615667437588}
[S14] START round=18 head_norm_before_train=1.739478 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.308739883538792, 'psi': 0.13572854291417166}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.261501838815399, 'psi': 0.13333333333333333}
[S15] START round=18 head_norm_before_train=1.611410 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6003103369571227, 'auprc': 0.6003103369571227, 'loss_val': 0.7654228082763169, 'psi': 0.6003103369571227}-{'f1_val': 0.613632367515106, 'auprc': 0.613632367515106, 'loss_val': 0.7577940440507727, 'psi': 0.613632367515106}
[S16] START round=18 head_norm_before_train=1.611936 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.008981761525066446, 'auprc': 0.008981761525066446, 'loss_val': 4.314231421597411, 'psi': 0.008981761525066446}-{'f1_val': 0.08775313404050145, 'auprc': 0.08775313404050145, 'loss_val': 3.723673132664728, 'psi': 0.08775313404050145}
[S17] START round=18 head_norm_before_train=1.598317 (no previous merge yet)
[S17] round=18 local utility u=0.036160 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 0.975183815451333, 'psi': 0.152287708414114}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0475032816076335, 'psi': 0.152287708414114}
[S8] not sending this round → trigger blocked (psi=0.394)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.020)
[S2] not sending this round → trigger blocked (psi=0.265)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.232)
[S11] not sending this round → trigger blocked (psi=0.332)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S13
[S7] cosine check vs S13: cos=0.7681
[S17] not sending this round → trigger blocked (psi=0.152)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.0000 head_norm=1.046074
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.945966e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.2635 head_norm=1.066106 delta_norm=0.394597
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.693062 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.2619428876434481, 'auprc': 0.2619428876434481, 'loss_val': 2.5368543405284907, 'psi': 0.2619428876434481}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.1887929313585754, 'psi': 0.26542475888492534}
[S3] START round=19 head_norm_before_train=1.685933 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.3030869971936389, 'auprc': 0.3030869971936389, 'loss_val': 2.730102933666679, 'psi': 0.3030869971936389}-{'f1_val': 0.3018897149938042, 'auprc': 0.3018897149938042, 'loss_val': 2.640588699233227, 'psi': 0.3018897149938042}
[S4] START round=19 head_norm_before_train=1.214892 cos_to_last_merge=0.9989 (last merge round=17)
[S4] round=19 local utility u=0.002415 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3277833415196738, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3326138019799179, 'psi': 0.0}
[S5] START round=19 head_norm_before_train=1.526731 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 1.567747627623948, 'psi': 0.2501920777223545}-{'f1_val': 0.25082219669263744, 'auprc': 0.25082219669263744, 'loss_val': 1.106512904353333, 'psi': 0.25082219669263744}
[S6] START round=19 head_norm_before_train=1.682924 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 6.089651748663656, 'psi': 0.018663594470046084}-{'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 5.954212382209477, 'psi': 0.020211299954065228}
[S7] START round=19 head_norm_before_train=1.066106 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.375851323143663, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.364938364848938, 'psi': 0.0}
[S8] START round=19 head_norm_before_train=1.091495 cos_to_last_merge=0.9771 (last merge round=15)
[S8] round=19 local utility u=0.016899 metrics={'f1_val': 0.392326527897299, 'auprc': 0.392326527897299, 'loss_val': 0.9849439968820911, 'psi': 0.392326527897299}-{'f1_val': 0.39441441541757, 'auprc': 0.39441441541757, 'loss_val': 1.037533251417656, 'psi': 0.39441441541757}
[S9] START round=19 head_norm_before_train=1.699126 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5989923251453253, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.535942741413331, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.633765 (no previous merge yet)
[S10] round=19 local utility u=0.081170 metrics={'f1_val': 0.24147305981216016, 'auprc': 0.24147305981216016, 'loss_val': 3.0264067206100065, 'psi': 0.24147305981216016}-{'f1_val': 0.23227540312260045, 'auprc': 0.23227540312260045, 'loss_val': 3.105967225059707, 'psi': 0.23227540312260042}
[S11] START round=19 head_norm_before_train=1.125982 cos_to_last_merge=0.9979 (last merge round=17)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 1.8496578123070364, 'psi': 0.3320901320901321}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.67161202894094, 'psi': 0.3319360347772085}
[S13] START round=19 head_norm_before_train=1.220780 cos_to_last_merge=0.9688 (last merge round=13)
[S13] round=19 local utility u=0.013831 metrics={'f1_val': 0.23900936129873207, 'auprc': 0.23900936129873207, 'loss_val': 1.1255020299830363, 'psi': 0.23900936129873207}-{'f1_val': 0.23878119627719485, 'auprc': 0.23878119627719485, 'loss_val': 1.1511096186658127, 'psi': 0.23878119627719485}
[S14] START round=19 head_norm_before_train=1.761606 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.385259219353183, 'psi': 0.1355297641332834}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.308739883538792, 'psi': 0.13572854291417166}
[S15] START round=19 head_norm_before_train=1.646864 (no previous merge yet)
[S15] round=19 local utility u=0.118466 metrics={'f1_val': 0.6155785243707129, 'auprc': 0.6155785243707129, 'loss_val': 0.665904727625996, 'psi': 0.6155785243707129}-{'f1_val': 0.6003103369571227, 'auprc': 0.6003103369571227, 'loss_val': 0.7654228082763169, 'psi': 0.6003103369571227}
[S16] START round=19 head_norm_before_train=1.630460 (no previous merge yet)
[S16] round=19 local utility u=0.533153 metrics={'f1_val': 0.0900511836212412, 'auprc': 0.0900511836212412, 'loss_val': 3.9775508477460755, 'psi': 0.0900511836212412}-{'f1_val': 0.008981761525066446, 'auprc': 0.008981761525066446, 'loss_val': 4.314231421597411, 'psi': 0.008981761525066446}
[S17] START round=19 head_norm_before_train=1.620982 (no previous merge yet)
[S17] round=19 local utility u=0.246576 metrics={'f1_val': 0.20308965160623102, 'auprc': 0.20308965160623102, 'loss_val': 0.9392495501957535, 'psi': 0.20308965160623102}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 0.975183815451333, 'psi': 0.152287708414114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61815
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:61810
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:61804
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.239)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=-0.1091
[S15] DROPPED delta from S8 (cos=-0.1091 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] cosine check vs S15: cos=-0.0233
[S9] DROPPED delta from S15 (cos=-0.0233 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1805) from S10
[S4] cosine check vs S10: cos=0.6491
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] cosine check vs S17: cos=-0.0011
[S13] DROPPED delta from S17 (cos=-0.0011 < 0.0)
[S11] r=20 psi=0.332 u=0.0000 p_local=0.1569 f1=0.332 auprc=0.332 bytes=3607
[S2] r=20 psi=0.262 u=0.0000 p_local=0.1841 f1=0.262 auprc=0.262 bytes=3599
[S14] r=20 psi=0.136 u=0.0000 p_local=0.0344 f1=0.136 auprc=0.136 bytes=0
[S3] r=20 psi=0.303 u=0.0000 p_local=0.0869 f1=0.303 auprc=0.303 bytes=1802
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0969 f1=0.369 auprc=0.369 bytes=1797
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.0000 head_norm=1.267639
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.376790e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.0000 head_norm=1.330607 delta_norm=0.637679
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.000 u=0.0024 p_local=0.1930 f1=0.000 auprc=0.000 bytes=1803
[S13] r=20 psi=0.239 u=0.0138 p_local=0.1492 f1=0.239 auprc=0.239 bytes=5398
[S6] r=20 psi=0.019 u=0.0000 p_local=0.0198 f1=0.019 auprc=0.019 bytes=0
[S7] r=20 psi=0.000 u=0.0000 p_local=0.1727 f1=0.000 auprc=0.000 bytes=5389
[S5] r=20 psi=0.250 u=0.0000 p_local=0.1806 f1=0.250 auprc=0.250 bytes=7189
[S8] r=20 psi=0.392 u=0.0169 p_local=0.1078 f1=0.392 auprc=0.392 bytes=7191
[S10] r=20 psi=0.241 u=0.0812 p_local=0.2011 f1=0.241 auprc=0.241 bytes=3606
[S15] r=20 psi=0.616 u=0.1185 p_local=0.1429 f1=0.616 auprc=0.616 bytes=8970
[S17] r=20 psi=0.203 u=0.2466 p_local=0.1252 f1=0.203 auprc=0.203 bytes=7205
[S16] r=20 psi=0.090 u=0.5332 p_local=0.2044 f1=0.090 auprc=0.090 bytes=0
[S2] START round=20 head_norm_before_train=1.714914 (no previous merge yet)
[S2] round=20 local utility u=0.156072 metrics={'f1_val': 0.25194381740657135, 'auprc': 0.25194381740657135, 'loss_val': 2.134718019329161, 'psi': 0.25194381740657135}-{'f1_val': 0.2619428876434481, 'auprc': 0.2619428876434481, 'loss_val': 2.5368543405284907, 'psi': 0.2619428876434481}
[S3] START round=20 head_norm_before_train=1.711947 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.29866523336020784, 'auprc': 0.29866523336020784, 'loss_val': 3.124931962245001, 'psi': 0.29866523336020784}-{'f1_val': 0.3030869971936389, 'auprc': 0.3030869971936389, 'loss_val': 2.730102933666679, 'psi': 0.3030869971936389}
[S4] START round=20 head_norm_before_train=1.330607 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3784406390745314, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3277833415196738, 'psi': 0.0}
[S5] START round=20 head_norm_before_train=1.557353 (no previous merge yet)
[S5] round=20 local utility u=0.062847 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.1964134812661302, 'psi': 0.33400978131092857}-{'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 1.567747627623948, 'psi': 0.2501920777223545}
[S6] START round=20 head_norm_before_train=1.697623 (no previous merge yet)
[S6] round=20 local utility u=0.036240 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 6.050845782749587, 'psi': 0.02240512117055327}-{'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 6.089651748663656, 'psi': 0.018663594470046084}
[S7] START round=20 head_norm_before_train=1.091251 cos_to_last_merge=0.9980 (last merge round=18)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3842765301371862, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.375851323143663, 'psi': 0.0}
[S8] START round=20 head_norm_before_train=1.162974 cos_to_last_merge=0.9658 (last merge round=15)
[S8] round=20 local utility u=0.205606 metrics={'f1_val': 0.4338346493474529, 'auprc': 0.4338346493474529, 'loss_val': 0.9473044379371457, 'psi': 0.4338346493474529}-{'f1_val': 0.392326527897299, 'auprc': 0.392326527897299, 'loss_val': 0.9849439968820911, 'psi': 0.392326527897299}
[S9] START round=20 head_norm_before_train=1.715072 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6468951295629553, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5989923251453253, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.657526 (no previous merge yet)
[S10] round=20 local utility u=0.086489 metrics={'f1_val': 0.24964097654380085, 'auprc': 0.24964097654380085, 'loss_val': 2.926940472355654, 'psi': 0.24964097654380085}-{'f1_val': 0.24147305981216016, 'auprc': 0.24147305981216016, 'loss_val': 3.0264067206100065, 'psi': 0.24147305981216016}
[S11] START round=20 head_norm_before_train=1.177207 cos_to_last_merge=0.9910 (last merge round=17)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.9283437221079156, 'psi': 0.3319360347772085}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 1.8496578123070364, 'psi': 0.3320901320901321}
[S13] START round=20 head_norm_before_train=1.244591 cos_to_last_merge=0.9618 (last merge round=13)
[S13] round=20 local utility u=0.001938 metrics={'f1_val': 0.23964986988407855, 'auprc': 0.23964986988407855, 'loss_val': 1.127390149716703, 'psi': 0.23964986988407855}-{'f1_val': 0.23900936129873207, 'auprc': 0.23900936129873207, 'loss_val': 1.1255020299830363, 'psi': 0.23900936129873207}
[S14] START round=20 head_norm_before_train=1.780933 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.13493253373313344, 'auprc': 0.13493253373313344, 'loss_val': 5.464864840196031, 'psi': 0.13493253373313344}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 5.385259219353183, 'psi': 0.1355297641332834}
[S15] START round=20 head_norm_before_train=1.676663 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.6762946977058338, 'psi': 0.6142341889454641}-{'f1_val': 0.6155785243707129, 'auprc': 0.6155785243707129, 'loss_val': 0.665904727625996, 'psi': 0.6155785243707129}
[S16] START round=20 head_norm_before_train=1.650062 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.054008007496379594, 'auprc': 0.054008007496379594, 'loss_val': 4.329630654455873, 'psi': 0.054008007496379594}-{'f1_val': 0.0900511836212412, 'auprc': 0.0900511836212412, 'loss_val': 3.9775508477460755, 'psi': 0.0900511836212412}
[S17] START round=20 head_norm_before_train=1.642854 (no previous merge yet)
[S17] round=20 local utility u=0.015217 metrics={'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 0.9084609195431071, 'psi': 0.20305027788548533}-{'f1_val': 0.20308965160623102, 'auprc': 0.20308965160623102, 'loss_val': 0.9392495501957535, 'psi': 0.20308965160623102}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:61804
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:61813
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[S8] not sending this round → trigger blocked (psi=0.434)
[S10] not sending this round → trigger blocked (psi=0.250)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S13
[S7] cosine check vs S13: cos=0.9056
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] cosine check vs S2: cos=-0.0945
[S4] DROPPED delta from S2 (cos=-0.0945 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1806) from S5
[S13] cosine check vs S5: cos=-0.1235
[S13] DROPPED delta from S5 (cos=-0.1235 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.203)
[S6] ⇄ pheromone p=0.023 → S5@127.0.0.1:61805
[S9] ⇄ pheromone p=0.078 → S11@127.0.0.1:61812
[S15] ⇄ pheromone p=0.114 → S9@127.0.0.1:61810
[S14] ⇄ pheromone p=0.028 → S7@127.0.0.1:61808
[S4] ⇄ pheromone p=0.154 → S11@127.0.0.1:61812
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.0000 head_norm=1.120201
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.683158e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.2372 head_norm=1.163586 delta_norm=0.268316
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.138 → S8@127.0.0.1:61809
[S11] ⇄ pheromone p=0.126 → S5@127.0.0.1:61805
[S10] ⇄ pheromone p=0.178 → S4@127.0.0.1:61804
[S8] ⇄ pheromone p=0.127 → S15@127.0.0.1:61815
[S3] ⇄ pheromone p=0.070 → S13@127.0.0.1:61813
[S13] ⇄ pheromone p=0.120 → S7@127.0.0.1:61808
[S2] ⇄ pheromone p=0.178 → S4@127.0.0.1:61804
[S5] ⇄ pheromone p=0.157 → S13@127.0.0.1:61813
[S17] ⇄ pheromone p=0.103 → S13@127.0.0.1:61813
[S16] ⇄ pheromone p=0.164 → S2@127.0.0.1:61802
[S2] START round=21 head_norm_before_train=1.735027 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.3195452398668674, 'psi': 0.26542475888492534}-{'f1_val': 0.25194381740657135, 'auprc': 0.25194381740657135, 'loss_val': 2.134718019329161, 'psi': 0.25194381740657135}
[S3] START round=21 head_norm_before_train=1.735301 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.2990116801437556, 'auprc': 0.2990116801437556, 'loss_val': 3.2095833129388067, 'psi': 0.2990116801437556}-{'f1_val': 0.29866523336020784, 'auprc': 0.29866523336020784, 'loss_val': 3.124931962245001, 'psi': 0.29866523336020784}
[S4] START round=21 head_norm_before_train=1.366842 cos_to_last_merge=0.9970 (last merge round=19)
[S4] round=21 local utility u=0.018408 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.341624224383899, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3784406390745314, 'psi': 0.0}
[S5] START round=21 head_norm_before_train=1.586842 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.6051615963235943, 'psi': 0.33358943696313936}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.1964134812661302, 'psi': 0.33400978131092857}
[S6] START round=21 head_norm_before_train=1.711472 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.024578971324533454, 'auprc': 0.024578971324533454, 'loss_val': 6.087925283879107, 'psi': 0.024578971324533454}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 6.050845782749587, 'psi': 0.02240512117055327}
[S7] START round=21 head_norm_before_train=1.163586 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.018259 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3477590063858533, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3842765301371862, 'psi': 0.0}
[S8] START round=21 head_norm_before_train=1.222983 cos_to_last_merge=0.9570 (last merge round=15)
[S8] round=21 local utility u=1.000000 metrics={'f1_val': 0.6654013727790579, 'auprc': 0.6654013727790579, 'loss_val': 0.9115992501899648, 'psi': 0.6654013727790579}-{'f1_val': 0.4338346493474529, 'auprc': 0.4338346493474529, 'loss_val': 0.9473044379371457, 'psi': 0.4338346493474529}
[S9] START round=21 head_norm_before_train=1.729053 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6807722813565213, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6468951295629553, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.680667 (no previous merge yet)
[S10] round=21 local utility u=0.387012 metrics={'f1_val': 0.33277471869762987, 'auprc': 0.33277471869762987, 'loss_val': 2.9011207139624853, 'psi': 0.33277471869762987}-{'f1_val': 0.24964097654380085, 'auprc': 0.24964097654380085, 'loss_val': 2.926940472355654, 'psi': 0.24964097654380085}
[S11] START round=21 head_norm_before_train=1.229584 cos_to_last_merge=0.9816 (last merge round=17)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.32423415225963, 'auprc': 0.32423415225963, 'loss_val': 1.9279536920428795, 'psi': 0.32423415225963}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.9283437221079156, 'psi': 0.3319360347772085}
[S13] START round=21 head_norm_before_train=1.263726 cos_to_last_merge=0.9571 (last merge round=13)
[S13] round=21 local utility u=0.016309 metrics={'f1_val': 0.24008498583569404, 'auprc': 0.24008498583569404, 'loss_val': 1.0986891483412626, 'psi': 0.24008498583569404}-{'f1_val': 0.23964986988407855, 'auprc': 0.23964986988407855, 'loss_val': 1.127390149716703, 'psi': 0.23964986988407855}
[S14] START round=21 head_norm_before_train=1.797911 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.532396058510651, 'psi': 0.13572854291417166}-{'f1_val': 0.13493253373313344, 'auprc': 0.13493253373313344, 'loss_val': 5.464864840196031, 'psi': 0.13493253373313344}
[S15] START round=21 head_norm_before_train=1.707665 (no previous merge yet)
[S15] round=21 local utility u=0.028410 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6383757023590584, 'psi': 0.6163342951580373}-{'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.6762946977058338, 'psi': 0.6142341889454641}
[S16] START round=21 head_norm_before_train=1.671354 (no previous merge yet)
[S16] round=21 local utility u=0.180192 metrics={'f1_val': 0.08926282051282051, 'auprc': 0.08926282051282051, 'loss_val': 4.286540419983831, 'psi': 0.08926282051282051}-{'f1_val': 0.054008007496379594, 'auprc': 0.054008007496379594, 'loss_val': 4.329630654455873, 'psi': 0.054008007496379594}
[S17] START round=21 head_norm_before_train=1.667311 (no previous merge yet)
[S17] round=21 local utility u=0.016870 metrics={'f1_val': 0.20281435579654014, 'auprc': 0.20281435579654014, 'loss_val': 0.872598441502649, 'psi': 0.20281435579654014}-{'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 0.9084609195431071, 'psi': 0.20305027788548533}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:61804
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:61810
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.240)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:61815
[S16] not sending this round → trigger blocked (psi=0.089)
[S8] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] cosine check vs S8: cos=-0.1103
[S15] DROPPED delta from S8 (cos=-0.1103 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=-0.0240
[S9] DROPPED delta from S15 (cos=-0.0240 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=0.8726
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S17
[S13] cosine check vs S17: cos=0.0040
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.2401 head_norm=1.280536
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.057643e+00
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.2396 head_norm=1.061710 delta_norm=1.057643
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.0000 head_norm=1.418080
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.170970e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.0000 head_norm=1.510071 delta_norm=0.417097
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.754262 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.531777872320202, 'psi': 0.2653978324081417}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.3195452398668674, 'psi': 0.26542475888492534}
[S3] START round=22 head_norm_before_train=1.757975 (no previous merge yet)
[S3] round=22 local utility u=0.038958 metrics={'f1_val': 0.28933707769551525, 'auprc': 0.28933707769551525, 'loss_val': 3.0445950680274847, 'psi': 0.28933707769551525}-{'f1_val': 0.2990116801437556, 'auprc': 0.2990116801437556, 'loss_val': 3.2095833129388067, 'psi': 0.2990116801437556}
[S4] START round=22 head_norm_before_train=1.510071 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.363651263350365, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.341624224383899, 'psi': 0.0}
[S5] START round=22 head_norm_before_train=1.612772 (no previous merge yet)
[S5] round=22 local utility u=0.060919 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.482582927704651, 'psi': 0.3335071121394324}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.6051615963235943, 'psi': 0.33358943696313936}
[S6] START round=22 head_norm_before_train=1.724638 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 6.2515673566500665, 'psi': 0.020211299954065228}-{'f1_val': 0.024578971324533454, 'auprc': 0.024578971324533454, 'loss_val': 6.087925283879107, 'psi': 0.024578971324533454}
[S7] START round=22 head_norm_before_train=1.183507 cos_to_last_merge=0.9978 (last merge round=20)
[S7] round=22 local utility u=0.954360 metrics={'f1_val': 0.20869565217391303, 'auprc': 0.20869565217391303, 'loss_val': 1.317299764980172, 'psi': 0.20869565217391303}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3477590063858533, 'psi': 0.0}
[S8] START round=22 head_norm_before_train=1.272926 cos_to_last_merge=0.9506 (last merge round=15)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.23845238095238094, 'auprc': 0.23845238095238094, 'loss_val': 0.8836144930422687, 'psi': 0.23845238095238097}-{'f1_val': 0.6654013727790579, 'auprc': 0.6654013727790579, 'loss_val': 0.9115992501899648, 'psi': 0.6654013727790579}
[S9] START round=22 head_norm_before_train=1.741431 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7100788253521175, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6807722813565213, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.702238 (no previous merge yet)
[S10] round=22 local utility u=0.029615 metrics={'f1_val': 0.33277498604131767, 'auprc': 0.33277498604131767, 'loss_val': 2.8418923692428506, 'psi': 0.33277498604131767}-{'f1_val': 0.33277471869762987, 'auprc': 0.33277471869762987, 'loss_val': 2.9011207139624853, 'psi': 0.33277471869762987}
[S11] START round=22 head_norm_before_train=1.279261 cos_to_last_merge=0.9721 (last merge round=17)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.3290243151738997, 'auprc': 0.3290243151738997, 'loss_val': 2.0615325225436445, 'psi': 0.3290243151738997}-{'f1_val': 0.32423415225963, 'auprc': 0.32423415225963, 'loss_val': 1.9279536920428795, 'psi': 0.32423415225963}
[S13] START round=22 head_norm_before_train=1.061710 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.23813765663044126, 'auprc': 0.23813765663044126, 'loss_val': 1.2111497967768543, 'psi': 0.23813765663044126}-{'f1_val': 0.24008498583569404, 'auprc': 0.24008498583569404, 'loss_val': 1.0986891483412626, 'psi': 0.24008498583569404}
[S14] START round=22 head_norm_before_train=1.813287 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.590959282807462, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.532396058510651, 'psi': 0.13572854291417166}
[S15] START round=22 head_norm_before_train=1.740670 (no previous merge yet)
[S15] round=22 local utility u=0.007197 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6227280244073905, 'psi': 0.6161950003225232}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6383757023590584, 'psi': 0.6163342951580373}
[S16] START round=22 head_norm_before_train=1.692678 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.0625, 'auprc': 0.0625, 'loss_val': 4.521986290472204, 'psi': 0.0625}-{'f1_val': 0.08926282051282051, 'auprc': 0.08926282051282051, 'loss_val': 4.286540419983831, 'psi': 0.08926282051282051}
[S17] START round=22 head_norm_before_train=1.688758 (no previous merge yet)
[S17] round=22 local utility u=0.011212 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8508819155635782, 'psi': 0.20289293555469456}-{'f1_val': 0.20281435579654014, 'auprc': 0.20281435579654014, 'loss_val': 0.872598441502649, 'psi': 0.20281435579654014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.616)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.333)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61809
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S3
[S13] cosine check vs S3: cos=0.3891
[S8] RECEIVED delta(kind=head bytes=1794) from S7
[S8] cosine check vs S7: cos=0.3769
[S13] RECEIVED delta(kind=head bytes=1801) from S5
[S13] cosine check vs S5: cos=-0.0533
[S13] DROPPED delta from S5 (cos=-0.0533 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.203)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.2381 head_norm=1.074811
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.413252e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.1545 head_norm=1.204890 delta_norm=0.841325
[S13] aggregate: ROLLBACK (f1_val pre=0.238 post=0.154 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.2385 head_norm=1.315658
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.063022e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.2385 head_norm=1.048297 delta_norm=0.706302
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.771915 (no previous merge yet)
[S2] round=23 local utility u=0.013377 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.505739942752761, 'psi': 0.2654773703336637}-{'f1_val': 0.2653978324081417, 'auprc': 0.2653978324081417, 'loss_val': 2.531777872320202, 'psi': 0.2653978324081417}
[S3] START round=23 head_norm_before_train=1.778752 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.2892857142857143, 'auprc': 0.2892857142857143, 'loss_val': 3.0931890382127856, 'psi': 0.2892857142857143}-{'f1_val': 0.28933707769551525, 'auprc': 0.28933707769551525, 'loss_val': 3.0445950680274847, 'psi': 0.28933707769551525}
[S4] START round=23 head_norm_before_train=1.542532 cos_to_last_merge=0.9970 (last merge round=21)
[S4] round=23 local utility u=0.016512 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3306276774466803, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.363651263350365, 'psi': 0.0}
[S5] START round=23 head_norm_before_train=1.633008 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.740668762319937, 'psi': 0.33358943696313936}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.482582927704651, 'psi': 0.3335071121394324}
[S6] START round=23 head_norm_before_train=1.737978 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 6.374192473778727, 'psi': 0.018885306310456013}-{'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 6.2515673566500665, 'psi': 0.020211299954065228}
[S7] START round=23 head_norm_before_train=1.210216 cos_to_last_merge=0.9913 (last merge round=20)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.16754879259014224, 'auprc': 0.16754879259014224, 'loss_val': 1.3005168555414837, 'psi': 0.16754879259014224}-{'f1_val': 0.20869565217391303, 'auprc': 0.20869565217391303, 'loss_val': 1.317299764980172, 'psi': 0.20869565217391303}
[S8] START round=23 head_norm_before_train=1.048297 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.23845238095238094, 'auprc': 0.23845238095238094, 'loss_val': 1.001721097663377, 'psi': 0.23845238095238097}-{'f1_val': 0.23845238095238094, 'auprc': 0.23845238095238094, 'loss_val': 0.8836144930422687, 'psi': 0.23845238095238097}
[S9] START round=23 head_norm_before_train=1.752869 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7376268889913287, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7100788253521175, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.724949 (no previous merge yet)
[S10] round=23 local utility u=0.023390 metrics={'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 2.7958310547335268, 'psi': 0.3328548644338118}-{'f1_val': 0.33277498604131767, 'auprc': 0.33277498604131767, 'loss_val': 2.8418923692428506, 'psi': 0.33277498604131767}
[S11] START round=23 head_norm_before_train=1.320513 cos_to_last_merge=0.9640 (last merge round=17)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.226377700034398, 'psi': 0.3320133550741517}-{'f1_val': 0.3290243151738997, 'auprc': 0.3290243151738997, 'loss_val': 2.0615325225436445, 'psi': 0.3290243151738997}
[S13] START round=23 head_norm_before_train=1.204890 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.2388484094544162, 'auprc': 0.2388484094544162, 'loss_val': 1.2281705587694836, 'psi': 0.2388484094544162}-{'f1_val': 0.23813765663044126, 'auprc': 0.23813765663044126, 'loss_val': 1.2111497967768543, 'psi': 0.23813765663044126}
[S14] START round=23 head_norm_before_train=1.827524 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.647281463039107, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.590959282807462, 'psi': 0.13572854291417166}
[S15] START round=23 head_norm_before_train=1.772450 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6279906290449466, 'psi': 0.6163342951580373}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6227280244073905, 'psi': 0.6161950003225232}
[S16] START round=23 head_norm_before_train=1.712958 (no previous merge yet)
[S16] round=23 local utility u=0.174245 metrics={'f1_val': 0.08993438950232037, 'auprc': 0.08993438950232037, 'loss_val': 4.420405741288174, 'psi': 0.08993438950232037}-{'f1_val': 0.0625, 'auprc': 0.0625, 'loss_val': 4.521986290472204, 'psi': 0.0625}
[S17] START round=23 head_norm_before_train=1.705323 (no previous merge yet)
[S17] round=23 local utility u=0.008007 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8348683703147258, 'psi': 0.20289293555469456}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8508819155635782, 'psi': 0.20289293555469456}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:61804
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S10
[S4] cosine check vs S10: cos=0.9317
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] cosine check vs S2: cos=-0.0979
[S4] DROPPED delta from S2 (cos=-0.0979 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1806 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1806) from S17
[S13] cosine check vs S17: cos=0.3517
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.2388 head_norm=1.215517
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.613152e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.5355 head_norm=1.215493 delta_norm=0.861315
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.0000 head_norm=1.584565
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.183381e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.0000 head_norm=1.637695 delta_norm=0.318338
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.788214 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.2518640125863602, 'auprc': 0.2518640125863602, 'loss_val': 2.8080878502617197, 'psi': 0.2518640125863602}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.505739942752761, 'psi': 0.2654773703336637}
[S3] START round=24 head_norm_before_train=1.797729 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.29717813051146386, 'auprc': 0.29717813051146386, 'loss_val': 3.2639486798844857, 'psi': 0.29717813051146386}-{'f1_val': 0.2892857142857143, 'auprc': 0.2892857142857143, 'loss_val': 3.0931890382127856, 'psi': 0.2892857142857143}
[S4] START round=24 head_norm_before_train=1.637695 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3359722763748807, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3306276774466803, 'psi': 0.0}
[S5] START round=24 head_norm_before_train=1.655423 (no previous merge yet)
[S5] round=24 local utility u=0.030510 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6751195754709864, 'psi': 0.33308623671855697}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.740668762319937, 'psi': 0.33358943696313936}
[S6] START round=24 head_norm_before_train=1.750360 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 6.4061743701468465, 'psi': 0.019770114942528734}-{'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 6.374192473778727, 'psi': 0.018885306310456013}
[S7] START round=24 head_norm_before_train=1.236740 cos_to_last_merge=0.9837 (last merge round=20)
[S7] round=24 local utility u=0.378450 metrics={'f1_val': 0.2454407294832827, 'auprc': 0.2454407294832827, 'loss_val': 1.244644181838029, 'psi': 0.2454407294832827}-{'f1_val': 0.16754879259014224, 'auprc': 0.16754879259014224, 'loss_val': 1.3005168555414837, 'psi': 0.16754879259014224}
[S8] START round=24 head_norm_before_train=1.096436 cos_to_last_merge=0.9980 (last merge round=22)
[S8] round=24 local utility u=0.030503 metrics={'f1_val': 0.23875802997858672, 'auprc': 0.23875802997858672, 'loss_val': 0.9434661492185196, 'psi': 0.23875802997858672}-{'f1_val': 0.23845238095238094, 'auprc': 0.23845238095238094, 'loss_val': 1.001721097663377, 'psi': 0.23845238095238097}
[S9] START round=24 head_norm_before_train=1.763535 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.762853158725418, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7376268889913287, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.748119 (no previous merge yet)
[S10] round=24 local utility u=0.013384 metrics={'f1_val': 0.332695374800638, 'auprc': 0.332695374800638, 'loss_val': 2.7676282503755165, 'psi': 0.332695374800638}-{'f1_val': 0.3328548644338118, 'auprc': 0.3328548644338118, 'loss_val': 2.7958310547335268, 'psi': 0.3328548644338118}
[S11] START round=24 head_norm_before_train=1.355710 cos_to_last_merge=0.9573 (last merge round=17)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.237453317093316, 'psi': 0.33185875048506014}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.226377700034398, 'psi': 0.3320133550741517}
[S13] START round=24 head_norm_before_train=1.215493 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.2373728359807246, 'auprc': 0.2373728359807246, 'loss_val': 1.2445252573090972, 'psi': 0.23737283598072462}-{'f1_val': 0.2388484094544162, 'auprc': 0.2388484094544162, 'loss_val': 1.2281705587694836, 'psi': 0.2388484094544162}
[S14] START round=24 head_norm_before_train=1.840354 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.705327458313287, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.647281463039107, 'psi': 0.13572854291417166}
[S15] START round=24 head_norm_before_train=1.804602 (no previous merge yet)
[S15] round=24 local utility u=0.012935 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6008668603508298, 'psi': 0.6161950003225232}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6279906290449466, 'psi': 0.6163342951580373}
[S16] START round=24 head_norm_before_train=1.731996 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.018413214189006228, 'auprc': 0.018413214189006228, 'loss_val': 5.026673756740674, 'psi': 0.018413214189006228}-{'f1_val': 0.08993438950232037, 'auprc': 0.08993438950232037, 'loss_val': 4.420405741288174, 'psi': 0.08993438950232037}
[S17] START round=24 head_norm_before_train=1.720783 (no previous merge yet)
[S17] round=24 local utility u=0.006327 metrics={'f1_val': 0.20285363806572407, 'auprc': 0.20285363806572407, 'loss_val': 0.8218615243776238, 'psi': 0.20285363806572407}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8348683703147258, 'psi': 0.20289293555469456}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61809
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.333)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:61813
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:61810
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] cosine check vs S8: cos=-0.0947
[S15] DROPPED delta from S8 (cos=-0.0947 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] cosine check vs S7: cos=0.7443
[S13] RECEIVED delta(kind=head bytes=1796) from S5
[S13] cosine check vs S5: cos=-0.0160
[S13] DROPPED delta from S5 (cos=-0.0160 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=-0.0235
[S9] DROPPED delta from S15 (cos=-0.0235 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.203)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.2388 head_norm=1.159028
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.341890e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.2388 head_norm=1.127954 delta_norm=0.434189
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.802180 (no previous merge yet)
[S2] round=25 local utility u=0.249913 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.2467555296458355, 'psi': 0.2450298816928894}-{'f1_val': 0.2518640125863602, 'auprc': 0.2518640125863602, 'loss_val': 2.8080878502617197, 'psi': 0.2518640125863602}
[S3] START round=25 head_norm_before_train=1.814904 (no previous merge yet)
[S3] round=25 local utility u=0.101609 metrics={'f1_val': 0.29914529914529914, 'auprc': 0.29914529914529914, 'loss_val': 3.078434596291943, 'psi': 0.29914529914529914}-{'f1_val': 0.29717813051146386, 'auprc': 0.29717813051146386, 'loss_val': 3.2639486798844857, 'psi': 0.29717813051146386}
[S4] START round=25 head_norm_before_train=1.671150 cos_to_last_merge=0.9979 (last merge round=23)
[S4] round=25 local utility u=0.017103 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3017672079094513, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3359722763748807, 'psi': 0.0}
[S5] START round=25 head_norm_before_train=1.672769 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.732561182744437, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6751195754709864, 'psi': 0.33308623671855697}
[S6] START round=25 head_norm_before_train=1.761842 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 6.440538596903975, 'psi': 0.02065167508031207}-{'f1_val': 0.019770114942528734, 'auprc': 0.019770114942528734, 'loss_val': 6.4061743701468465, 'psi': 0.019770114942528734}
[S7] START round=25 head_norm_before_train=1.256286 cos_to_last_merge=0.9775 (last merge round=20)
[S7] round=25 local utility u=0.418933 metrics={'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 1.1978126163633103, 'psi': 0.3333333333333333}-{'f1_val': 0.2454407294832827, 'auprc': 0.2454407294832827, 'loss_val': 1.244644181838029, 'psi': 0.2454407294832827}
[S8] START round=25 head_norm_before_train=1.127954 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.23883437407077013, 'auprc': 0.23883437407077013, 'loss_val': 1.0096262917407133, 'psi': 0.23883437407077013}-{'f1_val': 0.23875802997858672, 'auprc': 0.23875802997858672, 'loss_val': 0.9434661492185196, 'psi': 0.23875802997858672}
[S9] START round=25 head_norm_before_train=1.773452 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7861719766675295, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.762853158725418, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.766996 (no previous merge yet)
[S10] round=25 local utility u=0.013345 metrics={'f1_val': 0.33277525312923545, 'auprc': 0.33277525312923545, 'loss_val': 2.741656295028024, 'psi': 0.33277525312923545}-{'f1_val': 0.332695374800638, 'auprc': 0.332695374800638, 'loss_val': 2.7676282503755165, 'psi': 0.332695374800638}
[S11] START round=25 head_norm_before_train=1.387915 cos_to_last_merge=0.9513 (last merge round=17)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.39615564877112, 'psi': 0.33201273984308244}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 2.237453317093316, 'psi': 0.33185875048506014}
[S13] START round=25 head_norm_before_train=1.228926 cos_to_last_merge=0.9976 (last merge round=23)
[S13] round=25 local utility u=0.034738 metrics={'f1_val': 0.2384679236333452, 'auprc': 0.2384679236333452, 'loss_val': 1.1849059918927798, 'psi': 0.2384679236333452}-{'f1_val': 0.2373728359807246, 'auprc': 0.2373728359807246, 'loss_val': 1.2445252573090972, 'psi': 0.23737283598072462}
[S14] START round=25 head_norm_before_train=1.851912 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.757570709926725, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.705327458313287, 'psi': 0.13572854291417166}
[S15] START round=25 head_norm_before_train=1.829459 (no previous merge yet)
[S15] round=25 local utility u=0.008355 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.585410236770264, 'psi': 0.6163342951580373}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6008668603508298, 'psi': 0.6161950003225232}
[S16] START round=25 head_norm_before_train=1.748983 (no previous merge yet)
[S16] round=25 local utility u=0.615560 metrics={'f1_val': 0.09056061332055582, 'auprc': 0.09056061332055582, 'loss_val': 4.444879450202433, 'psi': 0.09056061332055582}-{'f1_val': 0.018413214189006228, 'auprc': 0.018413214189006228, 'loss_val': 5.026673756740674, 'psi': 0.018413214189006228}
[S17] START round=25 head_norm_before_train=1.733740 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.8269559595294504, 'psi': 0.20297157622739018}-{'f1_val': 0.20285363806572407, 'auprc': 0.20285363806572407, 'loss_val': 0.8218615243776238, 'psi': 0.20285363806572407}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.091)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61808
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61813
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.333)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:61804
[S15] not sending this round → trigger blocked (psi=0.616)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S3
[S13] cosine check vs S3: cos=0.4620
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=-0.0953
[S4] DROPPED delta from S2 (cos=-0.0953 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S10
[S4] cosine check vs S10: cos=0.9575
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=0.4428
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.0000 head_norm=1.708177
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.571364e-01
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.0000 head_norm=1.726705 delta_norm=0.257136
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.058 → S11@127.0.0.1:61812
[S5] ⇄ pheromone p=0.063 → S13@127.0.0.1:61813
[S6] ⇄ pheromone p=0.008 → S5@127.0.0.1:61805
[S15] ⇄ pheromone p=0.044 → S9@127.0.0.1:61810
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.3333 head_norm=1.276135
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.695959e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.3332 head_norm=1.077454 delta_norm=0.669596
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.289 → S8@127.0.0.1:61809
[S8] ⇄ pheromone p=0.129 → S15@127.0.0.1:61815
[S11] ⇄ pheromone p=0.041 → S5@127.0.0.1:61805
[S14] ⇄ pheromone p=0.009 → S7@127.0.0.1:61808
[S9] ⇄ pheromone p=0.025 → S11@127.0.0.1:61812
[S3] ⇄ pheromone p=0.047 → S13@127.0.0.1:61813
[S2] ⇄ pheromone p=0.110 → S4@127.0.0.1:61804
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.2385 head_norm=1.260957
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.378863e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.2295 head_norm=1.329791 delta_norm=0.837886
[S13] aggregate: ROLLBACK (f1_val pre=0.238 post=0.230 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.048 → S7@127.0.0.1:61808
[S10] ⇄ pheromone p=0.101 → S4@127.0.0.1:61804
[S17] ⇄ pheromone p=0.038 → S13@127.0.0.1:61813
[S16] ⇄ pheromone p=0.214 → S2@127.0.0.1:61802
[S2] START round=26 head_norm_before_train=1.815204 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.2610208040671617, 'auprc': 0.2610208040671617, 'loss_val': 2.815991649839928, 'psi': 0.2610208040671617}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.2467555296458355, 'psi': 0.2450298816928894}
[S3] START round=26 head_norm_before_train=1.830514 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.29794551543126074, 'auprc': 0.29794551543126074, 'loss_val': 3.484807554190444, 'psi': 0.29794551543126074}-{'f1_val': 0.29914529914529914, 'auprc': 0.29914529914529914, 'loss_val': 3.078434596291943, 'psi': 0.29914529914529914}
[S4] START round=26 head_norm_before_train=1.726705 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.002518 metrics={'f1_val': 0.00033789491468153406, 'auprc': 0.00033789491468153406, 'loss_val': 1.2997719795140639, 'psi': 0.00033789491468153406}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3017672079094513, 'psi': 0.0}
[S5] START round=26 head_norm_before_train=1.692086 (no previous merge yet)
[S5] round=26 local utility u=0.069183 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5979821189741212, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.732561182744437, 'psi': 0.33308623671855697}
[S6] START round=26 head_norm_before_train=1.772248 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 6.518231425809665, 'psi': 0.020431588613406795}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 6.440538596903975, 'psi': 0.02065167508031207}
[S7] START round=26 head_norm_before_train=1.077454 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.3332503939620138, 'auprc': 0.3332503939620138, 'loss_val': 1.213788415959367, 'psi': 0.3332503939620138}-{'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 1.1978126163633103, 'psi': 0.3333333333333333}
[S8] START round=26 head_norm_before_train=1.171322 cos_to_last_merge=0.9951 (last merge round=24)
[S8] round=26 local utility u=0.032707 metrics={'f1_val': 0.2389106909263884, 'auprc': 0.2389106909263884, 'loss_val': 0.9448986938531541, 'psi': 0.2389106909263884}-{'f1_val': 0.23883437407077013, 'auprc': 0.23883437407077013, 'loss_val': 1.0096262917407133, 'psi': 0.23883437407077013}
[S9] START round=26 head_norm_before_train=1.782773 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8129745567325846, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7861719766675295, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.782523 (no previous merge yet)
[S10] round=26 local utility u=0.015285 metrics={'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 2.7110895117616876, 'psi': 0.33277551996175}-{'f1_val': 0.33277525312923545, 'auprc': 0.33277525312923545, 'loss_val': 2.741656295028024, 'psi': 0.33277525312923545}
[S11] START round=26 head_norm_before_train=1.415999 cos_to_last_merge=0.9463 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.946
[S11] round=26 local utility u=0.023629 metrics={'f1_val': 0.3314728682170543, 'auprc': 0.3314728682170543, 'loss_val': 2.3440382112933995, 'psi': 0.3314728682170543}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.39615564877112, 'psi': 0.33201273984308244}
[S13] START round=26 head_norm_before_train=1.329791 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.018466 metrics={'f1_val': 0.23956485751448506, 'auprc': 0.23956485751448506, 'loss_val': 1.1578470788681945, 'psi': 0.23956485751448506}-{'f1_val': 0.2384679236333452, 'auprc': 0.2384679236333452, 'loss_val': 1.1849059918927798, 'psi': 0.2384679236333452}
[S14] START round=26 head_norm_before_train=1.862805 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.806804203366818, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.757570709926725, 'psi': 0.13572854291417166}
[S15] START round=26 head_norm_before_train=1.855541 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5959620130406617, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.585410236770264, 'psi': 0.6163342951580373}
[S16] START round=26 head_norm_before_train=1.763440 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.0409372005922829, 'auprc': 0.0409372005922829, 'loss_val': 5.104600813435532, 'psi': 0.0409372005922829}-{'f1_val': 0.09056061332055582, 'auprc': 0.09056061332055582, 'loss_val': 4.444879450202433, 'psi': 0.09056061332055582}
[S17] START round=26 head_norm_before_train=1.747491 (no previous merge yet)
[S17] round=26 local utility u=0.003575 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.8198054062873399, 'psi': 0.20297157622739018}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.8269559595294504, 'psi': 0.20297157622739018}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.333)
[S13] not sending this round → trigger blocked (psi=0.240)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61815
[S4] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:61805
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S11
[S5] cosine check vs S11: cos=-0.1476
[S5] DROPPED delta from S11 (cos=-0.1476 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S5
[S13] cosine check vs S5: cos=-0.0512
[S13] DROPPED delta from S5 (cos=-0.0512 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=-0.0852
[S15] DROPPED delta from S8 (cos=-0.0852 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] cosine check vs S17: cos=0.4039
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.2396 head_norm=1.355228
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.685928e-01
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.2387 head_norm=1.311605 delta_norm=0.868593
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.826342 (no previous merge yet)
[S2] round=27 local utility u=0.164131 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.5273643228362936, 'psi': 0.26542475888492534}-{'f1_val': 0.2610208040671617, 'auprc': 0.2610208040671617, 'loss_val': 2.815991649839928, 'psi': 0.2610208040671617}
[S3] START round=27 head_norm_before_train=1.844046 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.2970044614404079, 'auprc': 0.2970044614404079, 'loss_val': 3.569741645451861, 'psi': 0.2970044614404079}-{'f1_val': 0.29794551543126074, 'auprc': 0.29794551543126074, 'loss_val': 3.484807554190444, 'psi': 0.29794551543126074}
[S4] START round=27 head_norm_before_train=1.757672 cos_to_last_merge=0.9987 (last merge round=25)
[S4] round=27 local utility u=1.000000 metrics={'f1_val': 0.3330795906284361, 'auprc': 0.3330795906284361, 'loss_val': 1.2732704059473845, 'psi': 0.3330795906284361}-{'f1_val': 0.00033789491468153406, 'auprc': 0.00033789491468153406, 'loss_val': 1.2997719795140639, 'psi': 0.00033789491468153406}
[S5] START round=27 head_norm_before_train=1.712180 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6797434567588074, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5979821189741212, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.781982 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 6.59394270494687, 'psi': 0.020431588613406795}-{'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 6.518231425809665, 'psi': 0.020431588613406795}
[S7] START round=27 head_norm_before_train=1.096481 cos_to_last_merge=0.9992 (last merge round=25)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.23759791122715404, 'auprc': 0.23759791122715404, 'loss_val': 1.1887204644016243, 'psi': 0.23759791122715407}-{'f1_val': 0.3332503939620138, 'auprc': 0.3332503939620138, 'loss_val': 1.213788415959367, 'psi': 0.3332503939620138}
[S8] START round=27 head_norm_before_train=1.232135 cos_to_last_merge=0.9805 (last merge round=24)
[S8] round=27 local utility u=0.023454 metrics={'f1_val': 0.23875802997858672, 'auprc': 0.23875802997858672, 'loss_val': 0.8966161992022836, 'psi': 0.23875802997858672}-{'f1_val': 0.2389106909263884, 'auprc': 0.2389106909263884, 'loss_val': 0.9448986938531541, 'psi': 0.2389106909263884}
[S9] START round=27 head_norm_before_train=1.791656 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.836862380652082, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8129745567325846, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.795479 (no previous merge yet)
[S10] round=27 local utility u=0.012008 metrics={'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 2.6870733431830596, 'psi': 0.33277551996175}-{'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 2.7110895117616876, 'psi': 0.33277551996175}
[S11] START round=27 head_norm_before_train=1.442055 cos_to_last_merge=0.9418 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.3310878823073945, 'auprc': 0.3310878823073945, 'loss_val': 2.3896284129721885, 'psi': 0.3310878823073945}-{'f1_val': 0.3314728682170543, 'auprc': 0.3314728682170543, 'loss_val': 2.3440382112933995, 'psi': 0.3314728682170543}
[S13] START round=27 head_norm_before_train=1.311605 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.2385865053954702, 'auprc': 0.2385865053954702, 'loss_val': 1.1524386517364051, 'psi': 0.2385865053954702}-{'f1_val': 0.23956485751448506, 'auprc': 0.23956485751448506, 'loss_val': 1.1578470788681945, 'psi': 0.23956485751448506}
[S14] START round=27 head_norm_before_train=1.873002 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.854945187319133, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.806804203366818, 'psi': 0.13572854291417166}
[S15] START round=27 head_norm_before_train=1.880180 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6227426966710453, 'psi': 0.6150769866718802}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5959620130406617, 'psi': 0.6163342951580373}
[S16] START round=27 head_norm_before_train=1.776818 (no previous merge yet)
[S16] round=27 local utility u=0.253693 metrics={'f1_val': 0.08074888074888074, 'auprc': 0.08074888074888074, 'loss_val': 4.955520185268364, 'psi': 0.08074888074888074}-{'f1_val': 0.0409372005922829, 'auprc': 0.0409372005922829, 'loss_val': 5.104600813435532, 'psi': 0.0409372005922829}
[S17] START round=27 head_norm_before_train=1.764336 (no previous merge yet)
[S17] round=27 local utility u=0.006173 metrics={'f1_val': 0.2031290405999483, 'auprc': 0.2031290405999483, 'loss_val': 0.8088768399976607, 'psi': 0.2031290405999483}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.8198054062873399, 'psi': 0.20297157622739018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S10] → sending delta(kind=head bytes=1808) to S4@127.0.0.1:61804
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[S16] not sending this round → trigger blocked (psi=0.081)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61812
[S8] not sending this round → trigger blocked (psi=0.239)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1808 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.1173
[S4] RECEIVED delta(kind=head bytes=1808) from S10
[S4] cosine check vs S10: cos=0.9731
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=-0.0924
[S4] DROPPED delta from S2 (cos=-0.0924 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.203)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.3311 head_norm=1.466961
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.089022e+00
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.3243 head_norm=1.222377 delta_norm=1.089022
[S11] aggregate: ROLLBACK (f1_val pre=0.331 post=0.324 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.3331 head_norm=1.791193
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.090103e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.2437 head_norm=1.787216 delta_norm=0.209010
[S4] aggregate: ROLLBACK (f1_val pre=0.333 post=0.244 tol_abs=0.005 tol_rel=0.0)
[S2] START round=28 head_norm_before_train=1.836425 (no previous merge yet)
[S2] round=28 local utility u=0.006986 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.3298389720687385, 'psi': 0.2450298816928894}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.5273643228362936, 'psi': 0.26542475888492534}
[S3] START round=28 head_norm_before_train=1.856497 (no previous merge yet)
[S3] round=28 local utility u=0.134179 metrics={'f1_val': 0.2894937674891885, 'auprc': 0.2894937674891885, 'loss_val': 3.233787336263972, 'psi': 0.2894937674891885}-{'f1_val': 0.2970044614404079, 'auprc': 0.2970044614404079, 'loss_val': 3.569741645451861, 'psi': 0.2970044614404079}
[S4] START round=28 head_norm_before_train=1.787216 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.32468067573135556, 'auprc': 0.32468067573135556, 'loss_val': 1.2689227083812826, 'psi': 0.32468067573135556}-{'f1_val': 0.3330795906284361, 'auprc': 0.3330795906284361, 'loss_val': 1.2732704059473845, 'psi': 0.3330795906284361}
[S5] START round=28 head_norm_before_train=1.728224 (no previous merge yet)
[S5] round=28 local utility u=0.108320 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.466891919191348, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6797434567588074, 'psi': 0.33308623671855697}
[S6] START round=28 head_norm_before_train=1.791231 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 6.700171221650523, 'psi': 0.019328117809479982}-{'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 6.59394270494687, 'psi': 0.020431588613406795}
[S7] START round=28 head_norm_before_train=1.123574 cos_to_last_merge=0.9962 (last merge round=25)
[S7] round=28 local utility u=0.071020 metrics={'f1_val': 0.24925149700598803, 'auprc': 0.24925149700598803, 'loss_val': 1.151563488214919, 'psi': 0.24925149700598803}-{'f1_val': 0.23759791122715404, 'auprc': 0.23759791122715404, 'loss_val': 1.1887204644016243, 'psi': 0.23759791122715407}
[S8] START round=28 head_norm_before_train=1.292479 cos_to_last_merge=0.9659 (last merge round=24)
[S8] round=28 local utility u=0.014730 metrics={'f1_val': 0.2385288341367613, 'auprc': 0.2385288341367613, 'loss_val': 0.8650941778987242, 'psi': 0.2385288341367613}-{'f1_val': 0.23875802997858672, 'auprc': 0.23875802997858672, 'loss_val': 0.8966161992022836, 'psi': 0.23875802997858672}
[S9] START round=28 head_norm_before_train=1.800029 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.862398588185527, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.836862380652082, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.807562 (no previous merge yet)
[S10] round=28 local utility u=0.017998 metrics={'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 2.6510783313459183, 'psi': 0.33277551996175}-{'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 2.6870733431830596, 'psi': 0.33277551996175}
[S11] START round=28 head_norm_before_train=1.222377 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.259386 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.8784895795933985, 'psi': 0.3319360347772085}-{'f1_val': 0.3310878823073945, 'auprc': 0.3310878823073945, 'loss_val': 2.3896284129721885, 'psi': 0.3310878823073945}
[S13] START round=28 head_norm_before_train=1.328152 cos_to_last_merge=0.9980 (last merge round=26)
[S13] round=28 local utility u=0.569825 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1049370088407875, 'psi': 0.3599362944611573}-{'f1_val': 0.2385865053954702, 'auprc': 0.2385865053954702, 'loss_val': 1.1524386517364051, 'psi': 0.2385865053954702}
[S14] START round=28 head_norm_before_train=1.882520 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.900601152438712, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.854945187319133, 'psi': 0.13592717296421}
[S15] START round=28 head_norm_before_train=1.903451 (no previous merge yet)
[S15] round=28 local utility u=0.016837 metrics={'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.5814835090594399, 'psi': 0.6142341889454641}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6227426966710453, 'psi': 0.6150769866718802}
[S16] START round=28 head_norm_before_train=1.788985 (no previous merge yet)
[S16] round=28 local utility u=0.155378 metrics={'f1_val': 0.09056061332055582, 'auprc': 0.09056061332055582, 'loss_val': 4.733070021247601, 'psi': 0.09056061332055582}-{'f1_val': 0.08074888074888074, 'auprc': 0.08074888074888074, 'loss_val': 4.955520185268364, 'psi': 0.08074888074888074}
[S17] START round=28 head_norm_before_train=1.781623 (no previous merge yet)
[S17] round=28 local utility u=0.001119 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.8052210540518124, 'psi': 0.20297157622739018}-{'f1_val': 0.2031290405999483, 'auprc': 0.2031290405999483, 'loss_val': 0.8088768399976607, 'psi': 0.2031290405999483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:61810
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61813
[S16] not sending this round → trigger blocked (psi=0.091)
[S10] not sending this round → trigger blocked (psi=0.333)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:61805
[S2] not sending this round → trigger blocked (psi=0.245)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S8
[S15] cosine check vs S8: cos=-0.0947
[S15] DROPPED delta from S8 (cos=-0.0947 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S5
[S13] cosine check vs S5: cos=-0.0228
[S13] DROPPED delta from S5 (cos=-0.0228 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S11
[S5] cosine check vs S11: cos=-0.0852
[S5] DROPPED delta from S11 (cos=-0.0852 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S7
[S8] cosine check vs S7: cos=0.7315
[S9] RECEIVED delta(kind=head bytes=1803) from S15
[S9] cosine check vs S15: cos=-0.0220
[S9] DROPPED delta from S15 (cos=-0.0220 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S13
[S7] cosine check vs S13: cos=0.7834
[S13] RECEIVED delta(kind=head bytes=1802) from S3
[S13] cosine check vs S3: cos=0.4704
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S17
[S13] cosine check vs S17: cos=0.8649
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.3599 head_norm=1.344217
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.407476e-01
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.3599 head_norm=1.299932 delta_norm=0.240748
[S13] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.2493 head_norm=1.149364
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.204579e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.2498 head_norm=1.177792 delta_norm=0.420458
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.2385 head_norm=1.347501
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.666128e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.2386 head_norm=1.162184 delta_norm=0.466613
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.846585 (no previous merge yet)
[S2] round=29 local utility u=0.537024 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3578194714906657, 'psi': 0.3674775928297055}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.3298389720687385, 'psi': 0.2450298816928894}
[S3] START round=29 head_norm_before_train=1.867664 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.2971074003102473, 'auprc': 0.2971074003102473, 'loss_val': 3.643015361332671, 'psi': 0.2971074003102473}-{'f1_val': 0.2894937674891885, 'auprc': 0.2894937674891885, 'loss_val': 3.233787336263972, 'psi': 0.2894937674891885}
[S4] START round=29 head_norm_before_train=1.814111 cos_to_last_merge=0.9992 (last merge round=27)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.2909198200191783, 'auprc': 0.2909198200191783, 'loss_val': 1.245671241544037, 'psi': 0.2909198200191783}-{'f1_val': 0.32468067573135556, 'auprc': 0.32468067573135556, 'loss_val': 1.2689227083812826, 'psi': 0.32468067573135556}
[S5] START round=29 head_norm_before_train=1.740990 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5130228012005422, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.466891919191348, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.800218 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 6.788266408243492, 'psi': 0.018663594470046084}-{'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 6.700171221650523, 'psi': 0.019328117809479982}
[S7] START round=29 head_norm_before_train=1.177792 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.2498132935026139, 'auprc': 0.2498132935026139, 'loss_val': 1.1658564355435452, 'psi': 0.2498132935026139}-{'f1_val': 0.24925149700598803, 'auprc': 0.24925149700598803, 'loss_val': 1.151563488214919, 'psi': 0.24925149700598803}
[S8] START round=29 head_norm_before_train=1.162184 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.23829939264022867, 'auprc': 0.23829939264022867, 'loss_val': 0.9133242033370678, 'psi': 0.23829939264022867}-{'f1_val': 0.2385288341367613, 'auprc': 0.2385288341367613, 'loss_val': 0.8650941778987242, 'psi': 0.2385288341367613}
[S9] START round=29 head_norm_before_train=1.808216 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8842758123507193, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.862398588185527, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.822940 (no previous merge yet)
[S10] round=29 local utility u=0.041502 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.5687938788711566, 'psi': 0.3328555502468546}-{'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 2.6510783313459183, 'psi': 0.33277551996175}
[S11] START round=29 head_norm_before_train=1.256259 cos_to_last_merge=0.9984 (last merge round=27)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.0695549844281063, 'psi': 0.3320901320901321}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 1.8784895795933985, 'psi': 0.3319360347772085}
[S13] START round=29 head_norm_before_train=1.299932 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1087731390325581, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1049370088407875, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.891488 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.946779515335664, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.900601152438712, 'psi': 0.13592717296421}
[S15] START round=29 head_norm_before_train=1.925037 (no previous merge yet)
[S15] round=29 local utility u=0.035424 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5295363950383221, 'psi': 0.6163342951580373}-{'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.5814835090594399, 'psi': 0.6142341889454641}
[S16] START round=29 head_norm_before_train=1.801267 (no previous merge yet)
[S16] round=29 local utility u=0.121003 metrics={'f1_val': 0.11182894939240118, 'auprc': 0.11182894939240118, 'loss_val': 4.682478745648605, 'psi': 0.11182894939240118}-{'f1_val': 0.09056061332055582, 'auprc': 0.09056061332055582, 'loss_val': 4.733070021247601, 'psi': 0.09056061332055582}
[S17] START round=29 head_norm_before_train=1.791476 (no previous merge yet)
[S17] round=29 local utility u=0.002166 metrics={'f1_val': 0.20333932665378882, 'auprc': 0.20333932665378882, 'loss_val': 0.8041978869757405, 'psi': 0.20333932665378882}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.8052210540518124, 'psi': 0.20297157622739018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:61804
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] not sending this round → trigger blocked (psi=0.112)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:61804
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S2
[S4] cosine check vs S2: cos=-0.0903
[S4] DROPPED delta from S2 (cos=-0.0903 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=0.9826
[S17] not sending this round → trigger blocked (psi=0.203)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.2909 head_norm=1.841705
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.716365e-01
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.3226 head_norm=1.832883 delta_norm=0.171636
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.856845 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.39960428354385, 'psi': 0.2450298816928894}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3578194714906657, 'psi': 0.3674775928297055}
[S3] START round=30 head_norm_before_train=1.878077 (no previous merge yet)
[S3] round=30 local utility u=0.275264 metrics={'f1_val': 0.3028440872922083, 'auprc': 0.3028440872922083, 'loss_val': 3.144118199660707, 'psi': 0.3028440872922083}-{'f1_val': 0.2971074003102473, 'auprc': 0.2971074003102473, 'loss_val': 3.643015361332671, 'psi': 0.2971074003102473}
[S4] START round=30 head_norm_before_train=1.832883 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.256520325203252, 'auprc': 0.256520325203252, 'loss_val': 1.2501675796304015, 'psi': 0.256520325203252}-{'f1_val': 0.2909198200191783, 'auprc': 0.2909198200191783, 'loss_val': 1.245671241544037, 'psi': 0.2909198200191783}
[S5] START round=30 head_norm_before_train=1.755798 (no previous merge yet)
[S5] round=30 local utility u=0.005296 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5024309995117453, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5130228012005422, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.808619 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 6.801774688926499, 'psi': 0.019328117809479982}-{'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 6.788266408243492, 'psi': 0.018663594470046084}
[S7] START round=30 head_norm_before_train=1.194692 cos_to_last_merge=0.9992 (last merge round=28)
[S7] round=30 local utility u=0.400236 metrics={'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 1.1170643284286201, 'psi': 0.3333333333333333}-{'f1_val': 0.2498132935026139, 'auprc': 0.2498132935026139, 'loss_val': 1.1658564355435452, 'psi': 0.2498132935026139}
[S8] START round=30 head_norm_before_train=1.211149 cos_to_last_merge=0.9979 (last merge round=28)
[S8] round=30 local utility u=0.024128 metrics={'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 0.8726291620488875, 'psi': 0.23913947821952816}-{'f1_val': 0.23829939264022867, 'auprc': 0.23829939264022867, 'loss_val': 0.9133242033370678, 'psi': 0.23829939264022867}
[S9] START round=30 head_norm_before_train=1.816020 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9039684387686346, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8842758123507193, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.840099 (no previous merge yet)
[S10] round=30 local utility u=0.059899 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.4489968167244887, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.5687938788711566, 'psi': 0.3328555502468546}
[S11] START round=30 head_norm_before_train=1.312546 cos_to_last_merge=0.9916 (last merge round=27)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.160986225297844, 'psi': 0.3319360347772085}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.0695549844281063, 'psi': 0.3320901320901321}
[S13] START round=30 head_norm_before_train=1.311660 cos_to_last_merge=0.9991 (last merge round=28)
[S13] round=30 local utility u=0.012903 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0829669814124632, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1087731390325581, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.899979 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.994084183750464, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.946779515335664, 'psi': 0.13592717296421}
[S15] START round=30 head_norm_before_train=1.945059 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5538556582068385, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5295363950383221, 'psi': 0.6163342951580373}
[S16] START round=30 head_norm_before_train=1.813641 (no previous merge yet)
[S16] round=30 local utility u=0.336141 metrics={'f1_val': 0.14323030039181542, 'auprc': 0.14323030039181542, 'loss_val': 4.2928098482329595, 'psi': 0.14323030039181542}-{'f1_val': 0.11182894939240118, 'auprc': 0.11182894939240118, 'loss_val': 4.682478745648605, 'psi': 0.11182894939240118}
[S17] START round=30 head_norm_before_train=1.801559 (no previous merge yet)
[S17] round=30 local utility u=0.004629 metrics={'f1_val': 0.20358873932760801, 'auprc': 0.20358873932760801, 'loss_val': 0.7971843119899681, 'psi': 0.20358873932760801}-{'f1_val': 0.20333932665378882, 'auprc': 0.20333932665378882, 'loss_val': 0.8041978869757405, 'psi': 0.20333932665378882}
[S16] not sending this round → trigger blocked (psi=0.143)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.333)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:61815
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61813
[S5] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] cosine check vs S8: cos=-0.0663
[S15] DROPPED delta from S8 (cos=-0.0663 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=0.7741
[S13] RECEIVED delta(kind=head bytes=1802) from S5
[S13] cosine check vs S5: cos=-0.0276
[S13] DROPPED delta from S5 (cos=-0.0276 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=0.9398
[S13] RECEIVED delta(kind=head bytes=1800) from S3
[S13] cosine check vs S3: cos=0.6024
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] cosine check vs S17: cos=0.7856
[S10] ⇄ pheromone p=0.056 → S4@127.0.0.1:61804
[S11] ⇄ pheromone p=0.049 → S5@127.0.0.1:61805
[S6] ⇄ pheromone p=0.002 → S5@127.0.0.1:61805
[S4] ⇄ pheromone p=0.121 → S11@127.0.0.1:61812
[S2] ⇄ pheromone p=0.140 → S4@127.0.0.1:61804
[S9] ⇄ pheromone p=0.008 → S11@127.0.0.1:61812
[S15] ⇄ pheromone p=0.022 → S9@127.0.0.1:61810
[S14] ⇄ pheromone p=0.003 → S7@127.0.0.1:61808
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.2391 head_norm=1.265584
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.177623e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.2392 head_norm=1.168935 delta_norm=0.417762
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.054 → S15@127.0.0.1:61815
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.3599 head_norm=1.321709
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.498619e-01
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.3599 head_norm=1.309428 delta_norm=0.149862
[S13] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.093 → S7@127.0.0.1:61808
[S3] ⇄ pheromone p=0.088 → S13@127.0.0.1:61813
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.3333 head_norm=1.216621
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.261024e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.3333 head_norm=1.249968 delta_norm=0.226102
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.184 → S8@127.0.0.1:61809
[S5] ⇄ pheromone p=0.041 → S13@127.0.0.1:61813
[S16] ⇄ pheromone p=0.202 → S2@127.0.0.1:61802
[S17] ⇄ pheromone p=0.015 → S13@127.0.0.1:61813
[S2] START round=31 head_norm_before_train=1.866528 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.2452542269425624, 'auprc': 0.2452542269425624, 'loss_val': 2.446197339270192, 'psi': 0.2452542269425624}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.39960428354385, 'psi': 0.2450298816928894}
[S3] START round=31 head_norm_before_train=1.887493 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.2973570228940157, 'auprc': 0.2973570228940157, 'loss_val': 3.4486671340732276, 'psi': 0.2973570228940157}-{'f1_val': 0.3028440872922083, 'auprc': 0.3028440872922083, 'loss_val': 3.144118199660707, 'psi': 0.3028440872922083}
[S4] START round=31 head_norm_before_train=1.861051 cos_to_last_merge=0.9994 (last merge round=29)
[S4] round=31 local utility u=0.462674 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2272828787633479, 'psi': 0.3567939207526687}-{'f1_val': 0.256520325203252, 'auprc': 0.256520325203252, 'loss_val': 1.2501675796304015, 'psi': 0.256520325203252}
[S5] START round=31 head_norm_before_train=1.773554 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7301141871836356, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5024309995117453, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=1.816622 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 6.837422086522305, 'psi': 0.020211299954065228}-{'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 6.801774688926499, 'psi': 0.019328117809479982}
[S7] START round=31 head_norm_before_train=1.249968 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 1.1406056853273066, 'psi': 0.3333333333333333}-{'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 1.1170643284286201, 'psi': 0.3333333333333333}
[S8] START round=31 head_norm_before_train=1.168935 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.532907 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8891103470058844, 'psi': 0.35939447907390915}-{'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 0.8726291620488875, 'psi': 0.23913947821952816}
[S9] START round=31 head_norm_before_train=1.823428 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9223465130843933, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9039684387686346, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.858452 (no previous merge yet)
[S10] round=31 local utility u=0.085850 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.277296766947599, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.4489968167244887, 'psi': 0.3328555502468546}
[S11] START round=31 head_norm_before_train=1.371969 cos_to_last_merge=0.9817 (last merge round=27)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.3717035211323827, 'psi': 0.3320901320901321}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 2.160986225297844, 'psi': 0.3319360347772085}
[S13] START round=31 head_norm_before_train=1.309428 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.005376 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0722158311747818, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0829669814124632, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.907950 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.038593484912123, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.994084183750464, 'psi': 0.13592717296421}
[S15] START round=31 head_norm_before_train=1.965760 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.5975980030265574, 'psi': 0.6149367764291455}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5538556582068385, 'psi': 0.6163342951580373}
[S16] START round=31 head_norm_before_train=1.824910 (no previous merge yet)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.0001858045336306206, 'auprc': 0.0001858045336306206, 'loss_val': 5.945472187102336, 'psi': 0.0001858045336306206}-{'f1_val': 0.14323030039181542, 'auprc': 0.14323030039181542, 'loss_val': 4.2928098482329595, 'psi': 0.14323030039181542}
[S17] START round=31 head_norm_before_train=1.811965 (no previous merge yet)
[S17] round=31 local utility u=0.477117 metrics={'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 0.7894501565785264, 'psi': 0.30875549754205167}-{'f1_val': 0.20358873932760801, 'auprc': 0.20358873932760801, 'loss_val': 0.7971843119899681, 'psi': 0.20358873932760801}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:61804
[S8] not sending this round → trigger blocked (psi=0.359)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61812
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.360)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.6593
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=0.9865
[S17] not sending this round → trigger blocked (psi=0.309)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.3321 head_norm=1.425267
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.164059e-01
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.3319 head_norm=1.513320 delta_norm=0.716406
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.3568 head_norm=1.890863
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.548335e-01
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.2391 head_norm=1.879414 delta_norm=0.154834
[S4] aggregate: ROLLBACK (f1_val pre=0.357 post=0.239 tol_abs=0.005 tol_rel=0.0)
[S2] START round=32 head_norm_before_train=1.875990 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.2454789833822092, 'auprc': 0.2454789833822092, 'loss_val': 2.487876799831436, 'psi': 0.2454789833822092}-{'f1_val': 0.2452542269425624, 'auprc': 0.2452542269425624, 'loss_val': 2.446197339270192, 'psi': 0.2452542269425624}
[S3] START round=32 head_norm_before_train=1.896226 (no previous merge yet)
[S3] round=32 local utility u=0.068159 metrics={'f1_val': 0.29132214148500796, 'auprc': 0.29132214148500796, 'loss_val': 3.2580360721713135, 'psi': 0.29132214148500796}-{'f1_val': 0.2973570228940157, 'auprc': 0.2973570228940157, 'loss_val': 3.4486671340732276, 'psi': 0.2973570228940157}
[S4] START round=32 head_norm_before_train=1.879414 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2325254848868554, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2272828787633479, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.787823 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7385513047266756, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7301141871836356, 'psi': 0.3335071121394324}
[S6] START round=32 head_norm_before_train=1.824128 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 6.916722827476315, 'psi': 0.019328117809479982}-{'f1_val': 0.020211299954065228, 'auprc': 0.020211299954065228, 'loss_val': 6.837422086522305, 'psi': 0.020211299954065228}
[S7] START round=32 head_norm_before_train=1.268742 cos_to_last_merge=0.9988 (last merge round=30)
[S7] round=32 local utility u=0.030594 metrics={'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 1.0786720039614963, 'psi': 0.3332504352151206}-{'f1_val': 0.3333333333333333, 'auprc': 0.3333333333333333, 'loss_val': 1.1406056853273066, 'psi': 0.3333333333333333}
[S8] START round=32 head_norm_before_train=1.217138 cos_to_last_merge=0.9970 (last merge round=30)
[S8] round=32 local utility u=0.018262 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8525853532717522, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8891103470058844, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.830456 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.940634827800833, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9223465130843933, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=1.880685 (no previous merge yet)
[S10] round=32 local utility u=0.071974 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.133349529936285, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.277296766947599, 'psi': 0.3328555502468546}
[S11] START round=32 head_norm_before_train=1.513320 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.182738 metrics={'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.0055302985208394, 'psi': 0.33201273984308244}-{'f1_val': 0.3320901320901321, 'auprc': 0.3320901320901321, 'loss_val': 2.3717035211323827, 'psi': 0.3320901320901321}
[S13] START round=32 head_norm_before_train=1.321540 cos_to_last_merge=0.9994 (last merge round=30)
[S13] round=32 local utility u=0.023094 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0260269438078693, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0722158311747818, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.915677 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.07893190541126, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.038593484912123, 'psi': 0.13592717296421}
[S15] START round=32 head_norm_before_train=1.985311 (no previous merge yet)
[S15] round=32 local utility u=0.007017 metrics={'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.5835647554311783, 'psi': 0.6149367764291455}-{'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.5975980030265574, 'psi': 0.6149367764291455}
[S16] START round=32 head_norm_before_train=1.834278 (no previous merge yet)
[S16] round=32 local utility u=1.000000 metrics={'f1_val': 0.15251942128144821, 'auprc': 0.15251942128144821, 'loss_val': 3.9784240083518747, 'psi': 0.15251942128144821}-{'f1_val': 0.0001858045336306206, 'auprc': 0.0001858045336306206, 'loss_val': 5.945472187102336, 'psi': 0.0001858045336306206}
[S17] START round=32 head_norm_before_train=1.824525 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.2498497135028436, 'auprc': 0.2498497135028436, 'loss_val': 0.7780934260232755, 'psi': 0.24984971350284363}-{'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 0.7894501565785264, 'psi': 0.30875549754205167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61809
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:61810
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.153)
[S10] not sending this round → trigger blocked (psi=0.333)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:61815
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61808
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=0.9668
[S13] RECEIVED delta(kind=head bytes=1800) from S3
[S13] cosine check vs S3: cos=0.6633
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] cosine check vs S11: cos=-0.0457
[S5] DROPPED delta from S11 (cos=-0.0457 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S7
[S8] cosine check vs S7: cos=0.8617
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=-0.0210
[S9] DROPPED delta from S15 (cos=-0.0210 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=-0.0405
[S15] DROPPED delta from S8 (cos=-0.0405 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.3333 head_norm=1.291103
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.727287e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.3333 head_norm=1.309541 delta_norm=0.172729
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.3594 head_norm=1.275334
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.374821e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.3594 head_norm=1.238070 delta_norm=0.337482
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.3599 head_norm=1.350006
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.138731e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.3599 head_norm=1.488218 delta_norm=0.713873
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.884995 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.24880797572605115, 'auprc': 0.24880797572605115, 'loss_val': 2.5315350887345964, 'psi': 0.24880797572605112}-{'f1_val': 0.2454789833822092, 'auprc': 0.2454789833822092, 'loss_val': 2.487876799831436, 'psi': 0.2454789833822092}
[S3] START round=33 head_norm_before_train=1.904284 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.2973634139711878, 'auprc': 0.2973634139711878, 'loss_val': 3.6364477915676914, 'psi': 0.2973634139711878}-{'f1_val': 0.29132214148500796, 'auprc': 0.29132214148500796, 'loss_val': 3.2580360721713135, 'psi': 0.29132214148500796}
[S4] START round=33 head_norm_before_train=1.898981 cos_to_last_merge=0.9997 (last merge round=31)
[S4] round=33 local utility u=0.012818 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.206890008704619, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2325254848868554, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.797668 (no previous merge yet)
[S5] round=33 local utility u=0.001875 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.734800540046648, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7385513047266756, 'psi': 0.3335071121394324}
[S6] START round=33 head_norm_before_train=1.831502 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 7.016655891681649, 'psi': 0.018441678192715538}-{'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 6.916722827476315, 'psi': 0.019328117809479982}
[S7] START round=33 head_norm_before_train=1.309541 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.014700 metrics={'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 1.0492717997572258, 'psi': 0.3332504352151206}-{'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 1.0786720039614963, 'psi': 0.3332504352151206}
[S8] START round=33 head_norm_before_train=1.238070 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.23944414751469803, 'auprc': 0.23944414751469803, 'loss_val': 0.8479720201643711, 'psi': 0.239444147514698}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8525853532717522, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.837423 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.957748093918109, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.940634827800833, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=1.905242 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.24958203964652495, 'auprc': 0.24958203964652495, 'loss_val': 1.7726551924582163, 'psi': 0.24958203964652495}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.133349529936285, 'psi': 0.3328555502468546}
[S11] START round=33 head_norm_before_train=1.549620 cos_to_last_merge=0.9982 (last merge round=31)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.0694435538660896, 'psi': 0.3319353836595216}-{'f1_val': 0.33201273984308244, 'auprc': 0.33201273984308244, 'loss_val': 2.0055302985208394, 'psi': 0.33201273984308244}
[S13] START round=33 head_norm_before_train=1.488218 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.009779 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0064682303729056, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0260269438078693, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=1.923330 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.118269426618933, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.07893190541126, 'psi': 0.13592717296421}
[S15] START round=33 head_norm_before_train=2.002841 (no previous merge yet)
[S15] round=33 local utility u=0.010757 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5746283945796178, 'psi': 0.6163342951580373}-{'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.5835647554311783, 'psi': 0.6149367764291455}
[S16] START round=33 head_norm_before_train=1.842050 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.02587437544610992, 'auprc': 0.02587437544610992, 'loss_val': 5.617900775724397, 'psi': 0.02587437544610992}-{'f1_val': 0.15251942128144821, 'auprc': 0.15251942128144821, 'loss_val': 3.9784240083518747, 'psi': 0.15251942128144821}
[S17] START round=33 head_norm_before_train=1.837386 (no previous merge yet)
[S17] round=33 local utility u=0.255821 metrics={'f1_val': 0.3093027372931954, 'auprc': 0.3093027372931954, 'loss_val': 0.8015279425379688, 'psi': 0.3093027372931954}-{'f1_val': 0.2498497135028436, 'auprc': 0.2498497135028436, 'loss_val': 0.7780934260232755, 'psi': 0.24984971350284363}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.616)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.360)
[S7] not sending this round → trigger blocked (psi=0.333)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61812
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S5
[S13] cosine check vs S5: cos=-0.0526
[S13] DROPPED delta from S5 (cos=-0.0526 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.8841
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] cosine check vs S17: cos=0.3428
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.3599 head_norm=1.513356
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.727242e-01
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.3599 head_norm=1.379913 delta_norm=0.972724
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.3319 head_norm=1.599735
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.516695e-01
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.3298 head_norm=1.709279 delta_norm=0.451670
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.893451 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.20357634112792297, 'auprc': 0.20357634112792297, 'loss_val': 3.492011046225375, 'psi': 0.20357634112792297}-{'f1_val': 0.24880797572605115, 'auprc': 0.24880797572605115, 'loss_val': 2.5315350887345964, 'psi': 0.24880797572605112}
[S3] START round=34 head_norm_before_train=1.911407 (no previous merge yet)
[S3] round=34 local utility u=0.049732 metrics={'f1_val': 0.2975618437444385, 'auprc': 0.2975618437444385, 'loss_val': 3.5387688048382913, 'psi': 0.2975618437444385}-{'f1_val': 0.2973634139711878, 'auprc': 0.2973634139711878, 'loss_val': 3.6364477915676914, 'psi': 0.2973634139711878}
[S4] START round=34 head_norm_before_train=1.921491 cos_to_last_merge=0.9988 (last merge round=31)
[S4] round=34 local utility u=0.016436 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1740176252731849, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.206890008704619, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=1.808389 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7992354962963777, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.734800540046648, 'psi': 0.3335071121394324}
[S6] START round=34 head_norm_before_train=1.838587 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.054246330727716, 'psi': 0.018885306310456013}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 7.016655891681649, 'psi': 0.018441678192715538}
[S7] START round=34 head_norm_before_train=1.331223 cos_to_last_merge=0.9983 (last merge round=32)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.24950174389636273, 'auprc': 0.24950174389636273, 'loss_val': 0.9761017596682514, 'psi': 0.24950174389636273}-{'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 1.0492717997572258, 'psi': 0.3332504352151206}
[S8] START round=34 head_norm_before_train=1.285608 cos_to_last_merge=0.9967 (last merge round=32)
[S8] round=34 local utility u=0.014062 metrics={'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 0.8171060582393858, 'psi': 0.23913947821952816}-{'f1_val': 0.23944414751469803, 'auprc': 0.23944414751469803, 'loss_val': 0.8479720201643711, 'psi': 0.239444147514698}
[S9] START round=34 head_norm_before_train=1.844098 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9757175752580802, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.957748093918109, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=1.929898 (no previous merge yet)
[S10] round=34 local utility u=0.229108 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.0639004496880418, 'psi': 0.3328555502468546}-{'f1_val': 0.24958203964652495, 'auprc': 0.24958203964652495, 'loss_val': 1.7726551924582163, 'psi': 0.24958203964652495}
[S11] START round=34 head_norm_before_train=1.709279 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.044366 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 1.9807117240348497, 'psi': 0.3319353836595216}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.0694435538660896, 'psi': 0.3319353836595216}
[S13] START round=34 head_norm_before_train=1.379913 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.008118 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9902326838593879, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0064682303729056, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=1.930620 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.155693893373606, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.118269426618933, 'psi': 0.13592717296421}
[S15] START round=34 head_norm_before_train=2.019111 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5855391686770339, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5746283945796178, 'psi': 0.6163342951580373}
[S16] START round=34 head_norm_before_train=1.849281 (no previous merge yet)
[S16] round=34 local utility u=0.539912 metrics={'f1_val': 0.09018949388342529, 'auprc': 0.09018949388342529, 'loss_val': 5.116912246338555, 'psi': 0.09018949388342529}-{'f1_val': 0.02587437544610992, 'auprc': 0.02587437544610992, 'loss_val': 5.617900775724397, 'psi': 0.02587437544610992}
[S17] START round=34 head_norm_before_train=1.846743 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 0.8417390376785593, 'psi': 0.30875549754205167}-{'f1_val': 0.3093027372931954, 'auprc': 0.3093027372931954, 'loss_val': 0.8015279425379688, 'psi': 0.3093027372931954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:61805
[S16] not sending this round → trigger blocked (psi=0.090)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61813
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S13] → sending delta(kind=head bytes=1809) to S7@127.0.0.1:61808
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:61815
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.357)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[S8] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1809 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=-0.0214
[S15] DROPPED delta from S8 (cos=-0.0214 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S3
[S13] cosine check vs S3: cos=0.5212
[S7] RECEIVED delta(kind=head bytes=1809) from S13
[S7] cosine check vs S13: cos=0.9580
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.9868
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] cosine check vs S11: cos=-0.0225
[S5] DROPPED delta from S11 (cos=-0.0225 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.3568 head_norm=1.949939
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.585496e-01
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.3568 head_norm=1.945158 delta_norm=0.158550
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.2495 head_norm=1.357477
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.007080e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.2496 head_norm=1.363426 delta_norm=0.200708
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=34 metric=0.3599 head_norm=1.398457
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.424577e-01
[S13] stored merged vector for next round verification (round=34)
[S13] DEBUG after merge:  round=34 metric=0.3599 head_norm=1.451797 delta_norm=0.842458
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.901347 (no previous merge yet)
[S2] round=35 local utility u=1.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5130959275884526, 'psi': 0.3674775928297055}-{'f1_val': 0.20357634112792297, 'auprc': 0.20357634112792297, 'loss_val': 3.492011046225375, 'psi': 0.20357634112792297}
[S3] START round=35 head_norm_before_train=1.918128 (no previous merge yet)
[S3] round=35 local utility u=0.199522 metrics={'f1_val': 0.2785407129976418, 'auprc': 0.2785407129976418, 'loss_val': 2.96853371742434, 'psi': 0.2785407129976418}-{'f1_val': 0.2975618437444385, 'auprc': 0.2975618437444385, 'loss_val': 3.5387688048382913, 'psi': 0.2975618437444385}
[S4] START round=35 head_norm_before_train=1.945158 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.007420 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1591770961106178, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1740176252731849, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=1.822396 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.84694853600019, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7992354962963777, 'psi': 0.3335071121394324}
[S6] START round=35 head_norm_before_train=1.845481 (no previous merge yet)
[S6] round=35 local utility u=0.019655 metrics={'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 7.0288536924969724, 'psi': 0.020431588613406795}-{'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.054246330727716, 'psi': 0.018885306310456013}
[S7] START round=35 head_norm_before_train=1.363426 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.378804 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.9714861453107904, 'psi': 0.33316757831924415}-{'f1_val': 0.24950174389636273, 'auprc': 0.24950174389636273, 'loss_val': 0.9761017596682514, 'psi': 0.24950174389636273}
[S8] START round=35 head_norm_before_train=1.336558 cos_to_last_merge=0.9889 (last merge round=32)
[S8] round=35 local utility u=0.011830 metrics={'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 0.7934458021835504, 'psi': 0.23913947821952816}-{'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 0.8171060582393858, 'psi': 0.23913947821952816}
[S9] START round=35 head_norm_before_train=1.850557 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9938547570272087, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9757175752580802, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=1.953277 (no previous merge yet)
[S10] round=35 local utility u=0.133299 metrics={'f1_val': 0.33229986485412194, 'auprc': 0.33229986485412194, 'loss_val': 1.792302198853199, 'psi': 0.33229986485412194}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.0639004496880418, 'psi': 0.3328555502468546}
[S11] START round=35 head_norm_before_train=1.745079 cos_to_last_merge=0.9977 (last merge round=33)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.0550995887701675, 'psi': 0.3319353836595216}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 1.9807117240348497, 'psi': 0.3319353836595216}
[S13] START round=35 head_norm_before_train=1.451797 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=35 local utility u=0.003852 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9825287776019275, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9902326838593879, 'psi': 0.3599362944611573}
[S14] START round=35 head_norm_before_train=1.937723 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.196435547995167, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.155693893373606, 'psi': 0.13592717296421}
[S15] START round=35 head_norm_before_train=2.033454 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6103495106338748, 'psi': 0.6150769866718802}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5855391686770339, 'psi': 0.6163342951580373}
[S16] START round=35 head_norm_before_train=1.856482 (no previous merge yet)
[S16] round=35 local utility u=0.609977 metrics={'f1_val': 0.13863270385009516, 'auprc': 0.13863270385009516, 'loss_val': 4.332946778471597, 'psi': 0.13863270385009516}-{'f1_val': 0.09018949388342529, 'auprc': 0.09018949388342529, 'loss_val': 5.116912246338555, 'psi': 0.09018949388342529}
[S17] START round=35 head_norm_before_train=1.854426 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.20954433258462435, 'auprc': 0.20954433258462435, 'loss_val': 0.8313843044091782, 'psi': 0.20954433258462435}-{'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 0.8417390376785593, 'psi': 0.30875549754205167}
[S3] not sending this round → trigger blocked (psi=0.279)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:61809
[S10] not sending this round → trigger blocked (psi=0.332)
[S13] not sending this round → trigger blocked (psi=0.360)
[S16] not sending this round → trigger blocked (psi=0.139)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.239)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:61812
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.020)
[S4] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1808) from S7
[S8] cosine check vs S7: cos=0.8734
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9380
[S4] RECEIVED delta(kind=head bytes=1803) from S2
[S4] cosine check vs S2: cos=-0.0895
[S4] DROPPED delta from S2 (cos=-0.0895 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.2391 head_norm=1.384019
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.481570e-01
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.2393 head_norm=1.339139 delta_norm=0.348157
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.068 → S15@127.0.0.1:61815
[S10] ⇄ pheromone p=0.096 → S4@127.0.0.1:61804
[S5] ⇄ pheromone p=0.014 → S13@127.0.0.1:61813
[S6] ⇄ pheromone p=0.005 → S5@127.0.0.1:61805
[S15] ⇄ pheromone p=0.009 → S9@127.0.0.1:61810
[S9] ⇄ pheromone p=0.003 → S11@127.0.0.1:61812
[S14] ⇄ pheromone p=0.001 → S7@127.0.0.1:61808
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=35 metric=0.3319 head_norm=1.791039
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.420489e-01
[S11] stored merged vector for next round verification (round=35)
[S11] DEBUG after merge:  round=35 metric=0.3319 head_norm=1.849750 delta_norm=0.342049
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.042 → S5@127.0.0.1:61805
[S3] ⇄ pheromone p=0.084 → S13@127.0.0.1:61813
[S13] ⇄ pheromone p=0.036 → S7@127.0.0.1:61808
[S4] ⇄ pheromone p=0.083 → S11@127.0.0.1:61812
[S2] ⇄ pheromone p=0.246 → S4@127.0.0.1:61804
[S7] ⇄ pheromone p=0.141 → S8@127.0.0.1:61809
[S17] ⇄ pheromone p=0.077 → S13@127.0.0.1:61813
[S16] ⇄ pheromone p=0.377 → S2@127.0.0.1:61802
[S2] START round=36 head_norm_before_train=1.908523 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5428507032115806, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5130959275884526, 'psi': 0.3674775928297055}
[S3] START round=36 head_norm_before_train=1.923987 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2959539447012081, 'auprc': 0.2959539447012081, 'loss_val': 3.2485805180809995, 'psi': 0.2959539447012081}-{'f1_val': 0.2785407129976418, 'auprc': 0.2785407129976418, 'loss_val': 2.96853371742434, 'psi': 0.2785407129976418}
[S4] START round=36 head_norm_before_train=1.967060 cos_to_last_merge=0.9997 (last merge round=34)
[S4] round=36 local utility u=0.015493 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1281902503833545, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1591770961106178, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=1.837790 (no previous merge yet)
[S5] round=36 local utility u=0.015030 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8168877455743675, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.84694853600019, 'psi': 0.3335071121394324}
[S6] START round=36 head_norm_before_train=1.852125 (no previous merge yet)
[S6] round=36 local utility u=0.009108 metrics={'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 7.032325930093441, 'psi': 0.02284148012791229}-{'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 7.0288536924969724, 'psi': 0.020431588613406795}
[S7] START round=36 head_norm_before_train=1.383294 cos_to_last_merge=0.9990 (last merge round=34)
[S7] round=36 local utility u=0.023178 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.9251307561428908, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.9714861453107904, 'psi': 0.33316757831924415}
[S8] START round=36 head_norm_before_train=1.339139 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.23898698056001424, 'auprc': 0.23898698056001424, 'loss_val': 0.8024743221043137, 'psi': 0.23898698056001422}-{'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 0.7934458021835504, 'psi': 0.23913947821952816}
[S9] START round=36 head_norm_before_train=1.856881 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.00901487412861, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9938547570272087, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=1.974404 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.0858987696526694, 'psi': 0.3328555502468546}-{'f1_val': 0.33229986485412194, 'auprc': 0.33229986485412194, 'loss_val': 1.792302198853199, 'psi': 0.33229986485412194}
[S11] START round=36 head_norm_before_train=1.849750 cos_to_last_merge=1.0000 (last merge round=35)
[S11] round=36 local utility u=0.010681 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.03582718636522, 'psi': 0.33216756042589574}-{'f1_val': 0.3319353836595216, 'auprc': 0.3319353836595216, 'loss_val': 2.0550995887701675, 'psi': 0.3319353836595216}
[S13] START round=36 head_norm_before_train=1.470032 cos_to_last_merge=0.9991 (last merge round=34)
[S13] round=36 local utility u=0.004726 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9730765826489355, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9825287776019275, 'psi': 0.3599362944611573}
[S14] START round=36 head_norm_before_train=1.944251 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.238164282671288, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.196435547995167, 'psi': 0.13592717296421}
[S15] START round=36 head_norm_before_train=2.046267 (no previous merge yet)
[S15] round=36 local utility u=0.012684 metrics={'f1_val': 0.6141527093722254, 'auprc': 0.6141527093722254, 'loss_val': 0.5766631115858474, 'psi': 0.6141527093722254}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6103495106338748, 'psi': 0.6150769866718802}
[S16] START round=36 head_norm_before_train=1.863508 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.048024786986831915, 'auprc': 0.048024786986831915, 'loss_val': 5.390933427401354, 'psi': 0.048024786986831915}-{'f1_val': 0.13863270385009516, 'auprc': 0.13863270385009516, 'loss_val': 4.332946778471597, 'psi': 0.13863270385009516}
[S17] START round=36 head_norm_before_train=1.861232 (no previous merge yet)
[S17] round=36 local utility u=0.106214 metrics={'f1_val': 0.23454773503626533, 'auprc': 0.23454773503626533, 'loss_val': 0.8439859801390847, 'psi': 0.23454773503626533}-{'f1_val': 0.20954433258462435, 'auprc': 0.20954433258462435, 'loss_val': 0.8313843044091782, 'psi': 0.20954433258462435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.333)
[S4] not sending this round → trigger blocked (psi=0.357)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61808
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:61810
[S6] not sending this round → trigger blocked (psi=0.023)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=-0.0102
[S5] DROPPED delta from S11 (cos=-0.0102 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S15
[S9] cosine check vs S15: cos=-0.0206
[S9] DROPPED delta from S15 (cos=-0.0206 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=0.8585
[S13] RECEIVED delta(kind=head bytes=1797) from S5
[S13] cosine check vs S5: cos=-0.0512
[S13] DROPPED delta from S5 (cos=-0.0512 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] cosine check vs S17: cos=0.4183
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.3332 head_norm=1.405708
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.869907e-01
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.3332 head_norm=1.395067 delta_norm=0.386991
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=36 metric=0.3599 head_norm=1.488602
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.195173e-01
[S13] stored merged vector for next round verification (round=36)
[S13] DEBUG after merge:  round=36 metric=0.3599 head_norm=1.417507 delta_norm=0.919517
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.915281 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.5740945389420435, 'psi': 0.2450298816928894}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5428507032115806, 'psi': 0.3674775928297055}
[S3] START round=37 head_norm_before_train=1.929706 (no previous merge yet)
[S3] round=37 local utility u=0.052206 metrics={'f1_val': 0.2912465293000146, 'auprc': 0.2912465293000146, 'loss_val': 3.1018010266912897, 'psi': 0.2912465293000146}-{'f1_val': 0.2959539447012081, 'auprc': 0.2959539447012081, 'loss_val': 3.2485805180809995, 'psi': 0.2959539447012081}
[S4] START round=37 head_norm_before_train=1.988097 cos_to_last_merge=0.9990 (last merge round=34)
[S4] round=37 local utility u=0.009484 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1092219237993448, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1281902503833545, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=1.850204 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8538737964033314, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8168877455743675, 'psi': 0.3335071121394324}
[S6] START round=37 head_norm_before_train=1.858637 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.145857775981376, 'psi': 0.018885306310456013}-{'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 7.032325930093441, 'psi': 0.02284148012791229}
[S7] START round=37 head_norm_before_train=1.395067 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.008418 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.9082944853519246, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.9251307561428908, 'psi': 0.33316757831924415}
[S8] START round=37 head_norm_before_train=1.379122 cos_to_last_merge=0.9984 (last merge round=35)
[S8] round=37 local utility u=0.006571 metrics={'f1_val': 0.23898698056001424, 'auprc': 0.23898698056001424, 'loss_val': 0.7893321433795585, 'psi': 0.23898698056001422}-{'f1_val': 0.23898698056001424, 'auprc': 0.23898698056001424, 'loss_val': 0.8024743221043137, 'psi': 0.23898698056001422}
[S9] START round=37 head_norm_before_train=1.862903 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.023673089804484, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.00901487412861, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=1.994038 (no previous merge yet)
[S10] round=37 local utility u=0.144343 metrics={'f1_val': 0.3321414382201033, 'auprc': 0.3321414382201033, 'loss_val': 1.7907854665673155, 'psi': 0.3321414382201033}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.0858987696526694, 'psi': 0.3328555502468546}
[S11] START round=37 head_norm_before_train=1.884566 cos_to_last_merge=0.9983 (last merge round=35)
[S11] round=37 local utility u=0.001242 metrics={'f1_val': 0.304375667022412, 'auprc': 0.304375667022412, 'loss_val': 1.7832170937625103, 'psi': 0.304375667022412}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.03582718636522, 'psi': 0.33216756042589574}
[S13] START round=37 head_norm_before_train=1.417507 cos_to_last_merge=1.0000 (last merge round=36)
[S13] round=37 local utility u=0.008974 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9551285540235577, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9730765826489355, 'psi': 0.3599362944611573}
[S14] START round=37 head_norm_before_train=1.950363 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.278347523219681, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.238164282671288, 'psi': 0.13592717296421}
[S15] START round=37 head_norm_before_train=2.059380 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.6138490442483627, 'auprc': 0.6138490442483627, 'loss_val': 0.5804548990944602, 'psi': 0.6138490442483627}-{'f1_val': 0.6141527093722254, 'auprc': 0.6141527093722254, 'loss_val': 0.5766631115858474, 'psi': 0.6141527093722254}
[S16] START round=37 head_norm_before_train=1.870878 (no previous merge yet)
[S16] round=37 local utility u=0.184137 metrics={'f1_val': 0.07544378698224852, 'auprc': 0.07544378698224852, 'loss_val': 5.269430036079698, 'psi': 0.07544378698224852}-{'f1_val': 0.048024786986831915, 'auprc': 0.048024786986831915, 'loss_val': 5.390933427401354, 'psi': 0.048024786986831915}
[S17] START round=37 head_norm_before_train=1.869156 (no previous merge yet)
[S17] round=37 local utility u=0.274446 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.9184509174947836, 'psi': 0.30380970798684975}-{'f1_val': 0.23454773503626533, 'auprc': 0.23454773503626533, 'loss_val': 0.8439859801390847, 'psi': 0.23454773503626533}
[S11] not sending this round → trigger blocked (psi=0.304)
[S13] not sending this round → trigger blocked (psi=0.360)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61809
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61815
[S16] not sending this round → trigger blocked (psi=0.075)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61812
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S4
[S11] cosine check vs S4: cos=0.9690
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.9895
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=-0.0082
[S15] DROPPED delta from S8 (cos=-0.0082 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S3
[S13] cosine check vs S3: cos=0.4831
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] cosine check vs S7: cos=0.9183
[S17] not sending this round → trigger blocked (psi=0.304)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.2390 head_norm=1.421583
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.863088e-01
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.2391 head_norm=1.387347 delta_norm=0.286309
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.3568 head_norm=2.008705
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.459520e-01
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.3568 head_norm=2.005247 delta_norm=0.145952
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.3044 head_norm=1.916254
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.485049e-01
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.2886 head_norm=1.947230 delta_norm=0.248505
[S11] aggregate: ROLLBACK (f1_val pre=0.304 post=0.289 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.3599 head_norm=1.429619
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.829755e-01
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.3599 head_norm=1.454982 delta_norm=0.882975
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.922013 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.600483453071907, 'psi': 0.24507471790179935}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.5740945389420435, 'psi': 0.2450298816928894}
[S3] START round=38 head_norm_before_train=1.936344 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.2824475968663985, 'auprc': 0.2824475968663985, 'loss_val': 3.0600228932544344, 'psi': 0.2824475968663985}-{'f1_val': 0.2912465293000146, 'auprc': 0.2912465293000146, 'loss_val': 3.1018010266912897, 'psi': 0.2912465293000146}
[S4] START round=38 head_norm_before_train=2.005247 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1101581111750825, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1092219237993448, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=1.867509 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8812235237430346, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8538737964033314, 'psi': 0.3335071121394324}
[S6] START round=38 head_norm_before_train=1.864816 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 7.208698495978373, 'psi': 0.018663594470046084}-{'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.145857775981376, 'psi': 0.018885306310456013}
[S7] START round=38 head_norm_before_train=1.411563 cos_to_last_merge=0.9994 (last merge round=36)
[S7] round=38 local utility u=0.032074 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.8441460724126028, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.9082944853519246, 'psi': 0.33316757831924415}
[S8] START round=38 head_norm_before_train=1.387347 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.002833 metrics={'f1_val': 0.23944414751469803, 'auprc': 0.23944414751469803, 'loss_val': 0.7877811638773801, 'psi': 0.239444147514698}-{'f1_val': 0.23898698056001424, 'auprc': 0.23898698056001424, 'loss_val': 0.7893321433795585, 'psi': 0.23898698056001422}
[S9] START round=38 head_norm_before_train=1.868720 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.039059085317909, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.023673089804484, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=2.012396 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.001787319824498, 'psi': 0.3328555502468546}-{'f1_val': 0.3321414382201033, 'auprc': 0.3321414382201033, 'loss_val': 1.7907854665673155, 'psi': 0.3321414382201033}
[S11] START round=38 head_norm_before_train=1.947230 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.2798144154740901, 'auprc': 0.2798144154740901, 'loss_val': 1.5638417178752606, 'psi': 0.2798144154740901}-{'f1_val': 0.304375667022412, 'auprc': 0.304375667022412, 'loss_val': 1.7832170937625103, 'psi': 0.304375667022412}
[S13] START round=38 head_norm_before_train=1.454982 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9618978009912099, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9551285540235577, 'psi': 0.3599362944611573}
[S14] START round=38 head_norm_before_train=1.956409 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.316389259916012, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.278347523219681, 'psi': 0.13592717296421}
[S15] START round=38 head_norm_before_train=2.072593 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6104366902954557, 'psi': 0.61591610673549}-{'f1_val': 0.6138490442483627, 'auprc': 0.6138490442483627, 'loss_val': 0.5804548990944602, 'psi': 0.6138490442483627}
[S16] START round=38 head_norm_before_train=1.877008 (no previous merge yet)
[S16] round=38 local utility u=0.760697 metrics={'f1_val': 0.1440266608708252, 'auprc': 0.1440266608708252, 'loss_val': 4.365282294946844, 'psi': 0.1440266608708252}-{'f1_val': 0.07544378698224852, 'auprc': 0.07544378698224852, 'loss_val': 5.269430036079698, 'psi': 0.07544378698224852}
[S17] START round=38 head_norm_before_train=1.877223 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.20391650024080257, 'auprc': 0.20391650024080257, 'loss_val': 0.9345793012159028, 'psi': 0.20391650024080257}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.9184509174947836, 'psi': 0.30380970798684975}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S8] → sending delta(kind=head bytes=1809) to S15@127.0.0.1:61815
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.144)
[S8] sending update (kind=head size=1809 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] cosine check vs S7: cos=0.9698
[S15] RECEIVED delta(kind=head bytes=1809) from S8
[S15] cosine check vs S8: cos=0.0034
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.2394 head_norm=1.423490
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.750858e-01
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.3594 head_norm=1.413890 delta_norm=0.175086
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.6159 head_norm=2.085776
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.260628e+00
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.6155 head_norm=1.264599 delta_norm=1.260628
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.928522 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 2.6231997080323266, 'psi': 0.24516443956312162}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.600483453071907, 'psi': 0.24507471790179935}
[S3] START round=39 head_norm_before_train=1.943321 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.2996201329534663, 'auprc': 0.2996201329534663, 'loss_val': 3.229877261844291, 'psi': 0.2996201329534663}-{'f1_val': 0.2824475968663985, 'auprc': 0.2824475968663985, 'loss_val': 3.0600228932544344, 'psi': 0.2824475968663985}
[S4] START round=39 head_norm_before_train=2.027827 cos_to_last_merge=0.9998 (last merge round=37)
[S4] round=39 local utility u=0.006063 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0980314880217206, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1101581111750825, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=1.883558 (no previous merge yet)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8985397685193197, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8812235237430346, 'psi': 0.3335071121394324}
[S6] START round=39 head_norm_before_train=1.870861 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.240876747841697, 'psi': 0.018885306310456013}-{'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 7.208698495978373, 'psi': 0.018663594470046084}
[S7] START round=39 head_norm_before_train=1.425887 cos_to_last_merge=0.9984 (last merge round=36)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.2498134792340214, 'auprc': 0.2498134792340214, 'loss_val': 0.8057803725593984, 'psi': 0.2498134792340214}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.8441460724126028, 'psi': 0.33316757831924415}
[S8] START round=39 head_norm_before_train=1.413890 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.542696 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7819413536269928, 'psi': 0.35939447907390915}-{'f1_val': 0.23944414751469803, 'auprc': 0.23944414751469803, 'loss_val': 0.7877811638773801, 'psi': 0.239444147514698}
[S9] START round=39 head_norm_before_train=1.874467 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0546188707735884, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.039059085317909, 'psi': 0.36867172340800847}
[S10] START round=39 head_norm_before_train=2.028589 (no previous merge yet)
[S10] round=39 local utility u=0.017513 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.9667613511792557, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.001787319824498, 'psi': 0.3328555502468546}
[S11] START round=39 head_norm_before_train=1.973880 cos_to_last_merge=0.9994 (last merge round=37)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.3243079256731134, 'auprc': 0.3243079256731134, 'loss_val': 2.0170151999871972, 'psi': 0.3243079256731134}-{'f1_val': 0.2798144154740901, 'auprc': 0.2798144154740901, 'loss_val': 1.5638417178752606, 'psi': 0.2798144154740901}
[S13] START round=39 head_norm_before_train=1.468719 cos_to_last_merge=0.9997 (last merge round=37)
[S13] round=39 local utility u=0.000813 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9602711393009717, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9618978009912099, 'psi': 0.3599362944611573}
[S14] START round=39 head_norm_before_train=1.962382 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.351663095857865, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.316389259916012, 'psi': 0.13592717296421}
[S15] START round=39 head_norm_before_train=1.264599 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.050944 metrics={'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.5085478018452301, 'psi': 0.61591610673549}-{'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6104366902954557, 'psi': 0.61591610673549}
[S16] START round=39 head_norm_before_train=1.883616 (no previous merge yet)
[S16] round=39 local utility u=0.009310 metrics={'f1_val': 0.14583784564291388, 'auprc': 0.14583784564291388, 'loss_val': 4.36296345289234, 'psi': 0.14583784564291388}-{'f1_val': 0.1440266608708252, 'auprc': 0.1440266608708252, 'loss_val': 4.365282294946844, 'psi': 0.1440266608708252}
[S17] START round=39 head_norm_before_train=1.884558 (no previous merge yet)
[S17] round=39 local utility u=0.267749 metrics={'f1_val': 0.2574416405670558, 'auprc': 0.2574416405670558, 'loss_val': 0.8808080057729196, 'psi': 0.2574416405670558}-{'f1_val': 0.20391650024080257, 'auprc': 0.20391650024080257, 'loss_val': 0.9345793012159028, 'psi': 0.20391650024080257}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:61808
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61815
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61812
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:61804
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S10
[S4] cosine check vs S10: cos=0.9941
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=0.5451
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9824
[S7] RECEIVED delta(kind=head bytes=1805) from S13
[S7] cosine check vs S13: cos=0.9586
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[S16] not sending this round → trigger blocked (psi=0.146)
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.4376
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=0.0374
[S5] r=40 psi=0.334 u=0.0000 p_local=0.0072 f1=0.334 auprc=0.334 bytes=21592
[S3] r=40 psi=0.300 u=0.0000 p_local=0.0409 f1=0.300 auprc=0.300 bytes=14410
[S6] r=40 psi=0.019 u=0.0000 p_local=0.0029 f1=0.019 auprc=0.019 bytes=0
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.3687 head_norm=1.880217
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.124518e+00
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.3687 head_norm=1.164599 delta_norm=1.124518
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0011 f1=0.369 auprc=0.369 bytes=1797
[S2] r=40 psi=0.245 u=0.0000 p_local=0.1007 f1=0.245 auprc=0.245 bytes=14404
[S8] r=40 psi=0.359 u=0.5427 p_local=0.1376 f1=0.359 auprc=0.359 bytes=25213
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=39 metric=0.3568 head_norm=2.049103
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.115909e-01
[S4] stored merged vector for next round verification (round=39)
[S4] DEBUG after merge:  round=39 metric=0.3568 head_norm=2.043179 delta_norm=0.111591
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] r=40 psi=0.357 u=0.0061 p_local=0.0382 f1=0.357 auprc=0.357 bytes=12596
[S10] r=40 psi=0.333 u=0.0175 p_local=0.0614 f1=0.333 auprc=0.333 bytes=19819
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.2498 head_norm=1.440823
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.115582e-01
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.2498 head_norm=1.447374 delta_norm=0.211558
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] r=40 psi=0.250 u=0.0000 p_local=0.0663 f1=0.250 auprc=0.250 bytes=19800
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.6159 head_norm=1.306310
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.608109e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.6154 head_norm=1.212598 delta_norm=0.660811
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.616 u=0.0509 p_local=0.0153 f1=0.616 auprc=0.616 bytes=19768
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=39 metric=0.3243 head_norm=1.999401
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.914976e-01
[S11] stored merged vector for next round verification (round=39)
[S11] DEBUG after merge:  round=39 metric=0.3239 head_norm=2.015327 delta_norm=0.191498
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=40 psi=0.324 u=0.0000 p_local=0.0183 f1=0.324 auprc=0.324 bytes=12601
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=39 metric=0.3599 head_norm=1.484361
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.110051e-01
[S13] stored merged vector for next round verification (round=39)
[S13] DEBUG after merge:  round=39 metric=0.3599 head_norm=1.434398 delta_norm=0.911005
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] r=40 psi=0.360 u=0.0008 p_local=0.0167 f1=0.360 auprc=0.360 bytes=19809
[S17] r=40 psi=0.257 u=0.2677 p_local=0.1310 f1=0.257 auprc=0.257 bytes=21630
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0004 f1=0.136 auprc=0.136 bytes=0
[S16] r=40 psi=0.146 u=0.0093 p_local=0.3016 f1=0.146 auprc=0.146 bytes=0
[S2] START round=40 head_norm_before_train=1.934981 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.2452542269425624, 'auprc': 0.2452542269425624, 'loss_val': 2.6443426889524724, 'psi': 0.2452542269425624}-{'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 2.6231997080323266, 'psi': 0.24516443956312162}
[S3] START round=40 head_norm_before_train=1.950335 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.29787915166066425, 'auprc': 0.29787915166066425, 'loss_val': 3.252807102418907, 'psi': 0.29787915166066425}-{'f1_val': 0.2996201329534663, 'auprc': 0.2996201329534663, 'loss_val': 3.229877261844291, 'psi': 0.2996201329534663}
[S4] START round=40 head_norm_before_train=2.043179 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=40 local utility u=0.002964 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0921036057310818, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0980314880217206, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=1.901933 (no previous merge yet)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.919556937270828, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8985397685193197, 'psi': 0.3335071121394324}
[S6] START round=40 head_norm_before_train=1.876918 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 7.289466544997586, 'psi': 0.018663594470046084}-{'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.240876747841697, 'psi': 0.018885306310456013}
[S7] START round=40 head_norm_before_train=1.447374 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.8114028701869287, 'psi': 0.24975124378109453}-{'f1_val': 0.2498134792340214, 'auprc': 0.2498134792340214, 'loss_val': 0.8057803725593984, 'psi': 0.2498134792340214}
[S8] START round=40 head_norm_before_train=1.451786 cos_to_last_merge=0.9979 (last merge round=38)
[S8] round=40 local utility u=0.006629 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7686834014920442, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7819413536269928, 'psi': 0.35939447907390915}
[S9] START round=40 head_norm_before_train=1.164599 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.536932 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9807539361147581, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0546188707735884, 'psi': 0.36867172340800847}
[S10] START round=40 head_norm_before_train=2.043340 (no previous merge yet)
[S10] round=40 local utility u=0.088267 metrics={'f1_val': 0.33182503770739064, 'auprc': 0.33182503770739064, 'loss_val': 1.7809528994845878, 'psi': 0.33182503770739064}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.9667613511792557, 'psi': 0.3328555502468546}
[S11] START round=40 head_norm_before_train=2.015327 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=40 local utility u=0.046935 metrics={'f1_val': 0.3300910915547321, 'auprc': 0.3300910915547321, 'loss_val': 1.9751936539883221, 'psi': 0.3300910915547321}-{'f1_val': 0.3243079256731134, 'auprc': 0.3243079256731134, 'loss_val': 2.0170151999871972, 'psi': 0.3243079256731134}
[S13] START round=40 head_norm_before_train=1.434398 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=40 local utility u=0.010634 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9390022956189992, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9602711393009717, 'psi': 0.3599362944611573}
[S14] START round=40 head_norm_before_train=1.968159 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.38523708535976, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.351663095857865, 'psi': 0.13587634006482174}
[S15] START round=40 head_norm_before_train=1.212598 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.692342760928075, 'psi': 0.6142341889454641}-{'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.5085478018452301, 'psi': 0.61591610673549}
[S16] START round=40 head_norm_before_train=1.891642 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.13548339592077166, 'auprc': 0.13548339592077166, 'loss_val': 4.690916316239134, 'psi': 0.13548339592077166}-{'f1_val': 0.14583784564291388, 'auprc': 0.14583784564291388, 'loss_val': 4.36296345289234, 'psi': 0.14583784564291388}
[S17] START round=40 head_norm_before_train=1.889850 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.21227537641547467, 'auprc': 0.21227537641547467, 'loss_val': 0.8804430362257583, 'psi': 0.21227537641547467}-{'f1_val': 0.2574416405670558, 'auprc': 0.2574416405670558, 'loss_val': 0.8808080057729196, 'psi': 0.2574416405670558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:61815
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61812
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:61805
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:61808
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.9911
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] cosine check vs S9: cos=0.0901
[S15] RECEIVED delta(kind=head bytes=1807) from S8
[S15] cosine check vs S8: cos=0.8430
[S7] RECEIVED delta(kind=head bytes=1807) from S13
[S7] cosine check vs S13: cos=0.8613
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.9974
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] cosine check vs S11: cos=0.0053
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.033 → S13@127.0.0.1:61813
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.3335 head_norm=1.922796
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.397554e+00
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.3335 head_norm=1.404994 delta_norm=1.397554
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.006 → S13@127.0.0.1:61813
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.2498 head_norm=1.459299
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.825704e-01
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.2498 head_norm=1.401455 delta_norm=0.382570
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.053 → S8@127.0.0.1:61809
[S14] ⇄ pheromone p=0.000 → S7@127.0.0.1:61808
[S6] ⇄ pheromone p=0.002 → S5@127.0.0.1:61805
[S9] ⇄ pheromone p=0.108 → S11@127.0.0.1:61812
[S8] ⇄ pheromone p=0.111 → S15@127.0.0.1:61815
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=40 metric=0.3301 head_norm=2.038917
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.650662e-01
[S11] stored merged vector for next round verification (round=40)
[S11] DEBUG after merge:  round=40 metric=0.3245 head_norm=1.585310 delta_norm=0.565066
[S11] aggregate: ROLLBACK (f1_val pre=0.330 post=0.325 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.024 → S5@127.0.0.1:61805
[S10] ⇄ pheromone p=0.067 → S4@127.0.0.1:61804
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=40 metric=0.3568 head_norm=2.062381
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.464065e-02
[S4] stored merged vector for next round verification (round=40)
[S4] DEBUG after merge:  round=40 metric=0.3568 head_norm=2.058310 delta_norm=0.074641
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.031 → S11@127.0.0.1:61812
[S13] ⇄ pheromone p=0.016 → S7@127.0.0.1:61808
[S17] ⇄ pheromone p=0.105 → S13@127.0.0.1:61813
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.6142 head_norm=1.260638
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.019970e-01
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.6137 head_norm=1.322993 delta_norm=0.401997
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.012 → S9@127.0.0.1:61810
[S16] ⇄ pheromone p=0.241 → S2@127.0.0.1:61802
[S2] ⇄ pheromone p=0.081 → S4@127.0.0.1:61804
[S2] START round=41 head_norm_before_train=1.941388 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.24529914529914532, 'auprc': 0.24529914529914532, 'loss_val': 2.6634462722516825, 'psi': 0.24529914529914532}-{'f1_val': 0.2452542269425624, 'auprc': 0.2452542269425624, 'loss_val': 2.6443426889524724, 'psi': 0.2452542269425624}
[S3] START round=41 head_norm_before_train=1.957306 (no previous merge yet)
[S3] round=41 local utility u=0.010317 metrics={'f1_val': 0.2800391663169674, 'auprc': 0.2800391663169674, 'loss_val': 3.0716139882405553, 'psi': 0.2800391663169674}-{'f1_val': 0.29787915166066425, 'auprc': 0.29787915166066425, 'loss_val': 3.252807102418907, 'psi': 0.29787915166066425}
[S4] START round=41 head_norm_before_train=2.058310 cos_to_last_merge=1.0000 (last merge round=40)
[S4] round=41 local utility u=0.001716 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0886720996881898, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0921036057310818, 'psi': 0.3567939207526687}
[S5] START round=41 head_norm_before_train=1.404994 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=0.671859 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.5758393808096527, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.919556937270828, 'psi': 0.3335071121394324}
[S6] START round=41 head_norm_before_train=1.882738 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.314261991195602, 'psi': 0.018885306310456013}-{'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 7.289466544997586, 'psi': 0.018663594470046084}
[S7] START round=41 head_norm_before_train=1.401455 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.8121116374185398, 'psi': 0.24975124378109453}-{'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.8114028701869287, 'psi': 0.24975124378109453}
[S8] START round=41 head_norm_before_train=1.494863 cos_to_last_merge=0.9928 (last merge round=38)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.23944414751469803, 'auprc': 0.23944414751469803, 'loss_val': 0.7649883481682369, 'psi': 0.239444147514698}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7686834014920442, 'psi': 0.35939447907390915}
[S9] START round=41 head_norm_before_train=1.199811 cos_to_last_merge=0.9988 (last merge round=39)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0838849465903877, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9807539361147581, 'psi': 0.36867172340800847}
[S10] START round=41 head_norm_before_train=2.056941 (no previous merge yet)
[S10] round=41 local utility u=0.003335 metrics={'f1_val': 0.33158813263525305, 'auprc': 0.33158813263525305, 'loss_val': 1.7721498926814254, 'psi': 0.33158813263525305}-{'f1_val': 0.33182503770739064, 'auprc': 0.33182503770739064, 'loss_val': 1.7809528994845878, 'psi': 0.33182503770739064}
[S11] START round=41 head_norm_before_train=1.585310 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=41 local utility u=0.154129 metrics={'f1_val': 0.31710028908161, 'auprc': 0.31710028908161, 'loss_val': 1.550018550194577, 'psi': 0.31710028908161}-{'f1_val': 0.3300910915547321, 'auprc': 0.3300910915547321, 'loss_val': 1.9751936539883221, 'psi': 0.3300910915547321}
[S13] START round=41 head_norm_before_train=1.446140 cos_to_last_merge=0.9996 (last merge round=39)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9390671286456327, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9390022956189992, 'psi': 0.3599362944611573}
[S14] START round=41 head_norm_before_train=1.973919 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.418051310508836, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.38523708535976, 'psi': 0.13587634006482174}
[S15] START round=41 head_norm_before_train=1.322993 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.8054745964635899, 'psi': 0.6150769866718802}-{'f1_val': 0.6142341889454641, 'auprc': 0.6142341889454641, 'loss_val': 0.692342760928075, 'psi': 0.6142341889454641}
[S16] START round=41 head_norm_before_train=1.899825 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.0882565710151917, 'auprc': 0.0882565710151917, 'loss_val': 5.497173862775802, 'psi': 0.0882565710151917}-{'f1_val': 0.13548339592077166, 'auprc': 0.13548339592077166, 'loss_val': 4.690916316239134, 'psi': 0.13548339592077166}
[S17] START round=41 head_norm_before_train=1.896839 (no previous merge yet)
[S17] round=41 local utility u=0.423582 metrics={'f1_val': 0.3093027372931954, 'auprc': 0.3093027372931954, 'loss_val': 0.9065251973372551, 'psi': 0.3093027372931954}-{'f1_val': 0.21227537641547467, 'auprc': 0.21227537641547467, 'loss_val': 0.8804430362257583, 'psi': 0.21227537641547467}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61812
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:61805
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S5
[S13] cosine check vs S5: cos=-0.1010
[S13] DROPPED delta from S5 (cos=-0.1010 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S11
[S5] cosine check vs S11: cos=0.6777
[S13] RECEIVED delta(kind=head bytes=1799) from S3
[S13] cosine check vs S3: cos=0.4775
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9711
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.9985
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.8790
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.3335 head_norm=1.441816
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.184198e-01
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.3335 head_norm=1.399899 delta_norm=0.618420
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.3568 head_norm=2.077699
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.700677e-02
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.3568 head_norm=2.072944 delta_norm=0.057007
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=41 metric=0.3171 head_norm=1.614152
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.195742e-01
[S11] stored merged vector for next round verification (round=41)
[S11] DEBUG after merge:  round=41 metric=0.3131 head_norm=1.832766 delta_norm=0.319574
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=41 metric=0.3599 head_norm=1.457413
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.290345e-01
[S13] stored merged vector for next round verification (round=41)
[S13] DEBUG after merge:  round=41 metric=0.3599 head_norm=1.399137 delta_norm=0.229035
[S13] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.947684 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 2.679097649859916, 'psi': 0.24538903139123003}-{'f1_val': 0.24529914529914532, 'auprc': 0.24529914529914532, 'loss_val': 2.6634462722516825, 'psi': 0.24529914529914532}
[S3] START round=42 head_norm_before_train=1.963745 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.28806999831734814, 'auprc': 0.28806999831734814, 'loss_val': 3.3464584968426676, 'psi': 0.28806999831734814}-{'f1_val': 0.2800391663169674, 'auprc': 0.2800391663169674, 'loss_val': 3.0716139882405553, 'psi': 0.2800391663169674}
[S4] START round=42 head_norm_before_train=2.072944 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0893487303069165, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0886720996881898, 'psi': 0.3567939207526687}
[S5] START round=42 head_norm_before_train=1.399899 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=0.111592 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.3526551743467663, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.5758393808096527, 'psi': 0.3335071121394324}
[S6] START round=42 head_norm_before_train=1.888484 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 7.328631693425769, 'psi': 0.019328117809479982}-{'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.314261991195602, 'psi': 0.018885306310456013}
[S7] START round=42 head_norm_before_train=1.418917 cos_to_last_merge=0.9993 (last merge round=40)
[S7] round=42 local utility u=0.014688 metrics={'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.7827353182087973, 'psi': 0.24975124378109453}-{'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.8121116374185398, 'psi': 0.24975124378109453}
[S8] START round=42 head_norm_before_train=1.535467 cos_to_last_merge=0.9875 (last merge round=38)
[S8] round=42 local utility u=0.002368 metrics={'f1_val': 0.239368020907579, 'auprc': 0.239368020907579, 'loss_val': 0.7595668484342198, 'psi': 0.239368020907579}-{'f1_val': 0.23944414751469803, 'auprc': 0.23944414751469803, 'loss_val': 0.7649883481682369, 'psi': 0.239444147514698}
[S9] START round=42 head_norm_before_train=1.261055 cos_to_last_merge=0.9935 (last merge round=39)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.16544357763619, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0838849465903877, 'psi': 0.36867172340800847}
[S10] START round=42 head_norm_before_train=2.069749 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.33229986485412194, 'auprc': 0.33229986485412194, 'loss_val': 1.888621824945166, 'psi': 0.33229986485412194}-{'f1_val': 0.33158813263525305, 'auprc': 0.33158813263525305, 'loss_val': 1.7721498926814254, 'psi': 0.33158813263525305}
[S11] START round=42 head_norm_before_train=1.832766 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3053533190578159, 'auprc': 0.3053533190578159, 'loss_val': 1.5945733967617286, 'psi': 0.3053533190578159}-{'f1_val': 0.31710028908161, 'auprc': 0.31710028908161, 'loss_val': 1.550018550194577, 'psi': 0.31710028908161}
[S13] START round=42 head_norm_before_train=1.399137 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=42 local utility u=0.004223 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9306205006244346, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9390671286456327, 'psi': 0.3599362944611573}
[S14] START round=42 head_norm_before_train=1.979465 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.449948787336318, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.418051310508836, 'psi': 0.13587634006482174}
[S15] START round=42 head_norm_before_train=1.366398 cos_to_last_merge=0.9897 (last merge round=40)
[S15] round=42 local utility u=0.071012 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.665971556661034, 'psi': 0.6153571007984797}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.8054745964635899, 'psi': 0.6150769866718802}
[S16] START round=42 head_norm_before_train=1.906975 (no previous merge yet)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.07820040899795501, 'auprc': 0.07820040899795501, 'loss_val': 5.6053316723997035, 'psi': 0.07820040899795501}-{'f1_val': 0.0882565710151917, 'auprc': 0.0882565710151917, 'loss_val': 5.497173862775802, 'psi': 0.0882565710151917}
[S17] START round=42 head_norm_before_train=1.907573 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.26479184836224706, 'auprc': 0.26479184836224706, 'loss_val': 0.8471563948071981, 'psi': 0.26479184836224706}-{'f1_val': 0.3093027372931954, 'auprc': 0.3093027372931954, 'loss_val': 0.9065251973372551, 'psi': 0.3093027372931954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61809
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:61817
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S7
[S13] cosine check vs S7: cos=0.9850
[S11] RECEIVED delta(kind=head bytes=1794) from S5
[S11] cosine check vs S5: cos=0.9065
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=0.9480
[S17] RECEIVED delta(kind=head bytes=1803) from S13
[S17] cosine check vs S13: cos=0.7990
[S8] RECEIVED delta(kind=head bytes=1802) from S15
[S8] cosine check vs S15: cos=0.8663
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=42 metric=0.2394 head_norm=1.567822
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.938245e-01
[S8] stored merged vector for next round verification (round=42)
[S8] DEBUG after merge:  round=42 metric=0.2394 head_norm=1.453956 delta_norm=0.393825
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.2498 head_norm=1.439018
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.507010e-01
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.2498 head_norm=1.483768 delta_norm=0.250701
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=42 metric=0.3054 head_norm=1.863130
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.139577e-01
[S11] stored merged vector for next round verification (round=42)
[S11] DEBUG after merge:  round=42 metric=0.3173 head_norm=1.608638 delta_norm=0.413958
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=42 metric=0.3599 head_norm=1.418095
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.242729e-01
[S13] stored merged vector for next round verification (round=42)
[S13] DEBUG after merge:  round=42 metric=0.3599 head_norm=1.423179 delta_norm=0.124273
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=42 metric=0.2648 head_norm=1.917386
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.793004e-01
[S17] stored merged vector for next round verification (round=42)
[S17] DEBUG after merge:  round=42 metric=0.2694 head_norm=1.583696 delta_norm=0.579300
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.953642 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 2.6959349612548076, 'psi': 0.24538903139123003}-{'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 2.679097649859916, 'psi': 0.24538903139123003}
[S3] START round=43 head_norm_before_train=1.970320 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.29293719051342193, 'auprc': 0.29293719051342193, 'loss_val': 3.5029674921206295, 'psi': 0.29293719051342193}-{'f1_val': 0.28806999831734814, 'auprc': 0.28806999831734814, 'loss_val': 3.3464584968426676, 'psi': 0.28806999831734814}
[S4] START round=43 head_norm_before_train=2.090385 cos_to_last_merge=0.9999 (last merge round=41)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0900296835122536, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0893487303069165, 'psi': 0.3567939207526687}
[S5] START round=43 head_norm_before_train=1.430699 cos_to_last_merge=0.9959 (last merge round=41)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7025188496472332, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.3526551743467663, 'psi': 0.3335071121394324}
[S6] START round=43 head_norm_before_train=1.893920 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 7.3551921147026285, 'psi': 0.019328117809479982}-{'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 7.328631693425769, 'psi': 0.019328117809479982}
[S7] START round=43 head_norm_before_train=1.483768 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.034038 metrics={'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.7146586277878348, 'psi': 0.24975124378109453}-{'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.7827353182087973, 'psi': 0.24975124378109453}
[S8] START round=43 head_norm_before_train=1.453956 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=43 local utility u=0.531038 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7777295560221618, 'psi': 0.35939447907390915}-{'f1_val': 0.239368020907579, 'auprc': 0.239368020907579, 'loss_val': 0.7595668484342198, 'psi': 0.239368020907579}
[S9] START round=43 head_norm_before_train=1.323425 cos_to_last_merge=0.9859 (last merge round=39)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2256955089616617, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.16544357763619, 'psi': 0.36867172340800847}
[S10] START round=43 head_norm_before_train=2.081922 (no previous merge yet)
[S10] round=43 local utility u=0.010678 metrics={'f1_val': 0.3321414382201033, 'auprc': 0.3321414382201033, 'loss_val': 1.865839775372398, 'psi': 0.3321414382201033}-{'f1_val': 0.33229986485412194, 'auprc': 0.33229986485412194, 'loss_val': 1.888621824945166, 'psi': 0.33229986485412194}
[S11] START round=43 head_norm_before_train=1.608638 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=43 local utility u=0.018522 metrics={'f1_val': 0.30686464385625134, 'auprc': 0.30686464385625134, 'loss_val': 1.5711317539816743, 'psi': 0.30686464385625134}-{'f1_val': 0.3053533190578159, 'auprc': 0.3053533190578159, 'loss_val': 1.5945733967617286, 'psi': 0.3053533190578159}
[S13] START round=43 head_norm_before_train=1.423179 cos_to_last_merge=1.0000 (last merge round=42)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9762292559674793, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9306205006244346, 'psi': 0.3599362944611573}
[S14] START round=43 head_norm_before_train=1.984877 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.481370692045463, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.449948787336318, 'psi': 0.13587634006482174}
[S15] START round=43 head_norm_before_train=1.442257 cos_to_last_merge=0.9649 (last merge round=40)
[S15] round=43 local utility u=0.036828 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5998559817654042, 'psi': 0.6161950003225232}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.665971556661034, 'psi': 0.6153571007984797}
[S16] START round=43 head_norm_before_train=1.914826 (no previous merge yet)
[S16] round=43 local utility u=0.109773 metrics={'f1_val': 0.09018949388342529, 'auprc': 0.09018949388342529, 'loss_val': 5.493686829153915, 'psi': 0.09018949388342529}-{'f1_val': 0.07820040899795501, 'auprc': 0.07820040899795501, 'loss_val': 5.6053316723997035, 'psi': 0.07820040899795501}
[S17] START round=43 head_norm_before_train=1.583696 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.2593641695355335, 'auprc': 0.2593641695355335, 'loss_val': 0.8213150845511255, 'psi': 0.2593641695355335}-{'f1_val': 0.26479184836224706, 'auprc': 0.26479184836224706, 'loss_val': 0.8471563948071981, 'psi': 0.26479184836224706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S8
[S7] cosine check vs S8: cos=0.9660
[S13] RECEIVED delta(kind=head bytes=1801) from S7
[S13] cosine check vs S7: cos=0.9774
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:61810
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] cosine check vs S11: cos=0.1619
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61809
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=0.9320
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=43 metric=0.2498 head_norm=1.499008
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.945798e-01
[S7] stored merged vector for next round verification (round=43)
[S7] DEBUG after merge:  round=43 metric=0.2498 head_norm=1.478240 delta_norm=0.194580
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=43 metric=0.3594 head_norm=1.482932
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.780774e-01
[S8] stored merged vector for next round verification (round=43)
[S8] DEBUG after merge:  round=43 metric=0.3594 head_norm=1.478230 delta_norm=0.278077
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=43 metric=0.3687 head_norm=1.376893
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.828951e-01
[S9] stored merged vector for next round verification (round=43)
[S9] DEBUG after merge:  round=43 metric=0.3687 head_norm=1.154277 delta_norm=0.982895
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=43 metric=0.3599 head_norm=1.443501
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.588744e-01
[S13] stored merged vector for next round verification (round=43)
[S13] DEBUG after merge:  round=43 metric=0.3599 head_norm=1.462914 delta_norm=0.158874
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S4
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S2] START round=44 head_norm_before_train=1.959657 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 2.7140539734732507, 'psi': 0.24538903139123003}-{'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 2.6959349612548076, 'psi': 0.24538903139123003}
[S3] START round=44 head_norm_before_train=1.976946 (no previous merge yet)
[S3] round=44 local utility u=0.151842 metrics={'f1_val': 0.2790665273423894, 'auprc': 0.2790665273423894, 'loss_val': 3.0744480547239146, 'psi': 0.2790665273423894}-{'f1_val': 0.29293719051342193, 'auprc': 0.29293719051342193, 'loss_val': 3.5029674921206295, 'psi': 0.29293719051342193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=44 head_norm_before_train=2.108834 cos_to_last_merge=0.9996 (last merge round=41)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.095220623608576, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0900296835122536, 'psi': 0.3567939207526687}
[S5] START round=44 head_norm_before_train=1.472706 cos_to_last_merge=0.9855 (last merge round=41)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.0173472609427705, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.7025188496472332, 'psi': 0.3335071121394324}
[S6] START round=44 head_norm_before_train=1.899278 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 7.432807057580099, 'psi': 0.018663594470046084}-{'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 7.3551921147026285, 'psi': 0.019328117809479982}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.478240 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=44 local utility u=0.382804 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6997969904850948, 'psi': 0.33316757831924415}-{'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.7146586277878348, 'psi': 0.24975124378109453}
[S8] START round=44 head_norm_before_train=1.478230 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.23944414751469803, 'auprc': 0.23944414751469803, 'loss_val': 0.7947956481085002, 'psi': 0.239444147514698}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7777295560221618, 'psi': 0.35939447907390915}
[S9] START round=44 head_norm_before_train=1.154277 cos_to_last_merge=1.0000 (last merge round=43)
[S9] round=44 local utility u=0.242882 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7399305510406586, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2256955089616617, 'psi': 0.36867172340800847}
[S10] START round=44 head_norm_before_train=2.093259 (no previous merge yet)
[S10] round=44 local utility u=0.023607 metrics={'f1_val': 0.33174603174603173, 'auprc': 0.33174603174603173, 'loss_val': 1.8150672100981844, 'psi': 0.33174603174603173}-{'f1_val': 0.3321414382201033, 'auprc': 0.3321414382201033, 'loss_val': 1.865839775372398, 'psi': 0.3321414382201033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=44 head_norm_before_train=1.643484 cos_to_last_merge=0.9992 (last merge round=42)
[S11] round=44 local utility u=0.015609 metrics={'f1_val': 0.32131048993086864, 'auprc': 0.32131048993086864, 'loss_val': 1.6699265119652043, 'psi': 0.32131048993086864}-{'f1_val': 0.30686464385625134, 'auprc': 0.30686464385625134, 'loss_val': 1.5711317539816743, 'psi': 0.30686464385625134}
[S13] START round=44 head_norm_before_train=1.462914 cos_to_last_merge=1.0000 (last merge round=43)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0393546784040932, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9762292559674793, 'psi': 0.3599362944611573}
[S14] START round=44 head_norm_before_train=1.990103 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.512987318826421, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.481370692045463, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.525089 cos_to_last_merge=0.9388 (last merge round=40)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=44 local utility u=0.020195 metrics={'f1_val': 0.6146560490259613, 'auprc': 0.6146560490259613, 'loss_val': 0.545616257613739, 'psi': 0.6146560490259613}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.5998559817654042, 'psi': 0.6161950003225232}
[S16] START round=44 head_norm_before_train=1.922588 (no previous merge yet)
[S16] round=44 local utility u=0.192300 metrics={'f1_val': 0.10300898788589292, 'auprc': 0.10300898788589292, 'loss_val': 5.224461716011461, 'psi': 0.10300898788589292}-{'f1_val': 0.09018949388342529, 'auprc': 0.09018949388342529, 'loss_val': 5.493686829153915, 'psi': 0.09018949388342529}
[S16] not sending this round → trigger blocked (psi=0.103)
[S17] START round=44 head_norm_before_train=1.592356 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.2521541483402707, 'auprc': 0.2521541483402707, 'loss_val': 0.8528542004577209, 'psi': 0.2521541483402707}-{'f1_val': 0.2593641695355335, 'auprc': 0.2593641695355335, 'loss_val': 0.8213150845511255, 'psi': 0.2593641695355335}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61809
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[S8] RECEIVED delta(kind=head bytes=1802) from S15
[S8] cosine check vs S15: cos=0.9662
[S15] RECEIVED delta(kind=head bytes=1799) from S9
[S15] cosine check vs S9: cos=0.2608
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=44 metric=0.6147 head_norm=1.597152
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.686652e-01
[S15] stored merged vector for next round verification (round=44)
[S15] DEBUG after merge:  round=44 metric=0.6148 head_norm=1.123137 delta_norm=0.868665
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=0.9815
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:61810
[S11] sending update (kind=head size=1807 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1807) from S11
[S9] cosine check vs S11: cos=0.7804
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] CommDone barrier timeout: have=0 need=1 — continuing
[S13] RoundReady barrier timeout: have=1 need=2 — continuing
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15]  timeout peer S8
[S4]  timeout peer S2
[S4]  timeout peer S10
[S5]  timeout peer S6
[S5]  timeout peer S11
[S8]  timeout peer S7
[S13]  timeout peer S3
[S13]  timeout peer S5
[S13]  timeout peer S17
[S2]  timeout peer S16
[S9]  timeout peer S15
[S11]  timeout peer S4
[S11]  timeout peer S9
[S7]  timeout peer S13
[S7]  timeout peer S14
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=44 metric=0.3599 head_norm=1.480863
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.430950e-01
[S13] stored merged vector for next round verification (round=44)
[S13] DEBUG after merge:  round=44 metric=0.3599 head_norm=1.478658 delta_norm=0.143095
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.965632 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 2.7307038416354827, 'psi': 0.24543399914482925}-{'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 2.7140539734732507, 'psi': 0.24538903139123003}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.983363 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.2882698696652185, 'auprc': 0.2882698696652185, 'loss_val': 3.4223061040216862, 'psi': 0.2882698696652185}-{'f1_val': 0.2790665273423894, 'auprc': 0.2790665273423894, 'loss_val': 3.0744480547239146, 'psi': 0.2790665273423894}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.126768 cos_to_last_merge=0.9991 (last merge round=41)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0971553531501923, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.095220623608576, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.514942 cos_to_last_merge=0.9742 (last merge round=41)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1960559994107776, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.0173472609427705, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.904507 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 7.4780878415032745, 'psi': 0.018441678192715538}-{'f1_val': 0.018663594470046084, 'auprc': 0.018663594470046084, 'loss_val': 7.432807057580099, 'psi': 0.018663594470046084}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.490254 cos_to_last_merge=0.9996 (last merge round=43)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.2498134792340214, 'auprc': 0.2498134792340214, 'loss_val': 0.7037534773747524, 'psi': 0.2498134792340214}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6997969904850948, 'psi': 0.33316757831924415}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.508454 cos_to_last_merge=0.9994 (last merge round=43)
[S8] round=45 local utility u=0.004581 metrics={'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 0.7828910675029183, 'psi': 0.23913947821952816}-{'f1_val': 0.23944414751469803, 'auprc': 0.23944414751469803, 'loss_val': 0.7947956481085002, 'psi': 0.239444147514698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=45 metric=0.2391 head_norm=1.539723
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.235659e-01
[S8] stored merged vector for next round verification (round=45)
[S8] DEBUG after merge:  round=45 metric=0.2391 head_norm=1.552688 delta_norm=0.223566
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] START round=45 head_norm_before_train=1.217018 cos_to_last_merge=0.9974 (last merge round=43)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.851918273181955, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7399305510406586, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=45 metric=0.3687 head_norm=1.293896
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.576588e-01
[S9] stored merged vector for next round verification (round=45)
[S9] DEBUG after merge:  round=45 metric=0.3687 head_norm=1.392280 delta_norm=0.557659
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] START round=45 head_norm_before_train=2.104034 (no previous merge yet)
[S10] round=45 local utility u=0.001919 metrics={'f1_val': 0.3312727849104454, 'auprc': 0.3312727849104454, 'loss_val': 1.8069694664155007, 'psi': 0.3312727849104454}-{'f1_val': 0.33174603174603173, 'auprc': 0.33174603174603173, 'loss_val': 1.8150672100981844, 'psi': 0.33174603174603173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=45 head_norm_before_train=1.680681 cos_to_last_merge=0.9974 (last merge round=42)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 1.6071376414277223, 'psi': 0.280398322851153}-{'f1_val': 0.32131048993086864, 'auprc': 0.32131048993086864, 'loss_val': 1.6699265119652043, 'psi': 0.32131048993086864}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.478658 cos_to_last_merge=1.0000 (last merge round=44)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.081597806926992, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0393546784040932, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.995227 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.542940800759768, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.512987318826421, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.123137 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5950486647704882, 'psi': 0.6150769866718802}-{'f1_val': 0.6146560490259613, 'auprc': 0.6146560490259613, 'loss_val': 0.545616257613739, 'psi': 0.6146560490259613}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.930300 (no previous merge yet)
[S16] round=45 local utility u=0.199254 metrics={'f1_val': 0.1289505068574836, 'auprc': 0.1289505068574836, 'loss_val': 5.059426388981253, 'psi': 0.1289505068574836}-{'f1_val': 0.10300898788589292, 'auprc': 0.10300898788589292, 'loss_val': 5.224461716011461, 'psi': 0.10300898788589292}
[S16] not sending this round → trigger blocked (psi=0.129)
[S17] START round=45 head_norm_before_train=1.608387 cos_to_last_merge=0.9998 (last merge round=42)
[S17] round=45 local utility u=0.049341 metrics={'f1_val': 0.26282049883190456, 'auprc': 0.26282049883190456, 'loss_val': 0.8501698703117875, 'psi': 0.26282049883190456}-{'f1_val': 0.2521541483402707, 'auprc': 0.2521541483402707, 'loss_val': 0.8528542004577209, 'psi': 0.2521541483402707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=46 head_norm_before_train=1.971398 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.7443714237664465, 'psi': 0.24552398411243506}-{'f1_val': 0.24543399914482925, 'auprc': 0.24543399914482925, 'loss_val': 2.7307038416354827, 'psi': 0.24543399914482925}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.989420 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.2964581626149504, 'auprc': 0.2964581626149504, 'loss_val': 3.863254297000444, 'psi': 0.2964581626149504}-{'f1_val': 0.2882698696652185, 'auprc': 0.2882698696652185, 'loss_val': 3.4223061040216862, 'psi': 0.2882698696652185}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.139356 cos_to_last_merge=0.9987 (last merge round=41)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.106291802254621, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0971553531501923, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.546938 cos_to_last_merge=0.9659 (last merge round=41)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.307982375167981, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1960559994107776, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.909675 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 7.502279970053434, 'psi': 0.018441678192715538}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 7.4780878415032745, 'psi': 0.018441678192715538}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.502327 cos_to_last_merge=0.9988 (last merge round=43)
[S7] round=46 local utility u=0.381321 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6912976396751671, 'psi': 0.33316757831924415}-{'f1_val': 0.2498134792340214, 'auprc': 0.2498134792340214, 'loss_val': 0.7037534773747524, 'psi': 0.2498134792340214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=46 head_norm_before_train=1.552688 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=46 local utility u=0.529783 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8056192334871993, 'psi': 0.35939447907390915}-{'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 0.7828910675029183, 'psi': 0.23913947821952816}
[S8] not sending this round → trigger blocked (psi=0.359)
[S9] START round=46 head_norm_before_train=1.392280 cos_to_last_merge=1.0000 (last merge round=45)
[S9] round=46 local utility u=0.021613 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8086921082306278, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.851918273181955, 'psi': 0.36867172340800847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=46 head_norm_before_train=2.114304 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.3309580364212193, 'auprc': 0.3309580364212193, 'loss_val': 1.8135660445032487, 'psi': 0.3309580364212193}-{'f1_val': 0.3312727849104454, 'auprc': 0.3312727849104454, 'loss_val': 1.8069694664155007, 'psi': 0.3312727849104454}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.714656 cos_to_last_merge=0.9951 (last merge round=42)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.28819725141471303, 'auprc': 0.28819725141471303, 'loss_val': 1.7332364713332, 'psi': 0.28819725141471303}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 1.6071376414277223, 'psi': 0.280398322851153}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.496612 cos_to_last_merge=0.9998 (last merge round=44)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1098416588869693, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.081597806926992, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.000259 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.571604179013746, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.542940800759768, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.195165 cos_to_last_merge=0.9970 (last merge round=44)
[S15] round=46 local utility u=0.019082 metrics={'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.564437725163219, 'psi': 0.61591610673549}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5950486647704882, 'psi': 0.6150769866718802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=46 head_norm_before_train=1.937762 (no previous merge yet)
[S16] round=46 local utility u=0.063083 metrics={'f1_val': 0.13606943218593703, 'auprc': 0.13606943218593703, 'loss_val': 4.997331652594271, 'psi': 0.13606943218593703}-{'f1_val': 0.1289505068574836, 'auprc': 0.1289505068574836, 'loss_val': 5.059426388981253, 'psi': 0.1289505068574836}
[S16] not sending this round → trigger blocked (psi=0.136)
[S17] START round=46 head_norm_before_train=1.626922 cos_to_last_merge=0.9995 (last merge round=42)
[S17] round=46 local utility u=0.351028 metrics={'f1_val': 0.3470330263782717, 'auprc': 0.3470330263782717, 'loss_val': 0.9060260739646898, 'psi': 0.3470330263782717}-{'f1_val': 0.26282049883190456, 'auprc': 0.26282049883190456, 'loss_val': 0.8501698703117875, 'psi': 0.26282049883190456}
[S17] not sending this round → trigger blocked (psi=0.347)
[S2] START round=47 head_norm_before_train=1.976740 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.758199021886468, 'psi': 0.24552398411243506}-{'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.7443714237664465, 'psi': 0.24552398411243506}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.995238 (no previous merge yet)
[S3] round=47 local utility u=0.224223 metrics={'f1_val': 0.29019412643106024, 'auprc': 0.29019412643106024, 'loss_val': 3.358431480569522, 'psi': 0.29019412643106024}-{'f1_val': 0.2964581626149504, 'auprc': 0.2964581626149504, 'loss_val': 3.863254297000444, 'psi': 0.2964581626149504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=47 head_norm_before_train=2.149735 cos_to_last_merge=0.9983 (last merge round=41)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.115190093068779, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.106291802254621, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.575107 cos_to_last_merge=0.9596 (last merge round=41)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3966888321895405, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.307982375167981, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.914536 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.508038466151368, 'psi': 0.018885306310456013}-{'f1_val': 0.018441678192715538, 'auprc': 0.018441678192715538, 'loss_val': 7.502279970053434, 'psi': 0.018441678192715538}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.513922 cos_to_last_merge=0.9982 (last merge round=43)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.6677444669030929, 'psi': 0.24975124378109453}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 0.6912976396751671, 'psi': 0.33316757831924415}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.584237 cos_to_last_merge=0.9993 (last merge round=45)
[S8] round=47 local utility u=0.000198 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8052225867600966, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8056192334871993, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=47 head_norm_before_train=1.457061 cos_to_last_merge=0.9963 (last merge round=45)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8357028316929331, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8086921082306278, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.124261 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.3273040482342808, 'auprc': 0.3273040482342808, 'loss_val': 1.7897566837790313, 'psi': 0.3273040482342808}-{'f1_val': 0.3309580364212193, 'auprc': 0.3309580364212193, 'loss_val': 1.8135660445032487, 'psi': 0.3309580364212193}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.744764 cos_to_last_merge=0.9929 (last merge round=42)
[S11] round=47 local utility u=0.005527 metrics={'f1_val': 0.2799790767621289, 'auprc': 0.2799790767621289, 'loss_val': 1.6482179798406655, 'psi': 0.2799790767621289}-{'f1_val': 0.28819725141471303, 'auprc': 0.28819725141471303, 'loss_val': 1.7332364713332, 'psi': 0.28819725141471303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=47 head_norm_before_train=1.516961 cos_to_last_merge=0.9993 (last merge round=44)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1223328357353226, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1098416588869693, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.005178 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.599473442899196, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.571604179013746, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.271559 cos_to_last_merge=0.9902 (last merge round=44)
[S15] round=47 local utility u=0.007884 metrics={'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.5461564841251426, 'psi': 0.615636807189815}-{'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.564437725163219, 'psi': 0.61591610673549}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=47 head_norm_before_train=1.944813 (no previous merge yet)
[S16] round=47 local utility u=0.244079 metrics={'f1_val': 0.1494228149422815, 'auprc': 0.1494228149422815, 'loss_val': 4.6293541157964215, 'psi': 0.1494228149422815}-{'f1_val': 0.13606943218593703, 'auprc': 0.13606943218593703, 'loss_val': 4.997331652594271, 'psi': 0.13606943218593703}
[S16] not sending this round → trigger blocked (psi=0.149)
[S17] START round=47 head_norm_before_train=1.644657 cos_to_last_merge=0.9990 (last merge round=42)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.2700549568101787, 'auprc': 0.2700549568101787, 'loss_val': 0.874305900819879, 'psi': 0.2700549568101787}-{'f1_val': 0.3470330263782717, 'auprc': 0.3470330263782717, 'loss_val': 0.9060260739646898, 'psi': 0.3470330263782717}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.981930 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.769951938596762, 'psi': 0.24552398411243506}-{'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.758199021886468, 'psi': 0.24552398411243506}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.999271 (no previous merge yet)
[S3] round=48 local utility u=0.074478 metrics={'f1_val': 0.2820295983086681, 'auprc': 0.2820295983086681, 'loss_val': 3.1359956289887276, 'psi': 0.2820295983086681}-{'f1_val': 0.29019412643106024, 'auprc': 0.29019412643106024, 'loss_val': 3.358431480569522, 'psi': 0.29019412643106024}
[S3] not sending this round → trigger blocked (psi=0.282)
[S4] START round=48 head_norm_before_train=2.156816 cos_to_last_merge=0.9979 (last merge round=41)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1208941297370234, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.115190093068779, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.603555 cos_to_last_merge=0.9540 (last merge round=41)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.435819322298845, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3966888321895405, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.919603 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.5203305465885055, 'psi': 0.018885306310456013}-{'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.508038466151368, 'psi': 0.018885306310456013}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.525614 cos_to_last_merge=0.9975 (last merge round=43)
[S7] round=48 local utility u=0.001302 metrics={'f1_val': 0.24925224327018944, 'auprc': 0.24925224327018944, 'loss_val': 0.6606500340797323, 'psi': 0.24925224327018947}-{'f1_val': 0.24975124378109453, 'auprc': 0.24975124378109453, 'loss_val': 0.6677444669030929, 'psi': 0.24975124378109453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=48 head_norm_before_train=1.616323 cos_to_last_merge=0.9974 (last merge round=45)
[S8] round=48 local utility u=0.001324 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8025746430289176, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8052225867600966, 'psi': 0.35939447907390915}
[S8] not sending this round → trigger blocked (psi=0.359)
[S9] START round=48 head_norm_before_train=1.530297 cos_to_last_merge=0.9872 (last merge round=45)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9689881351056588, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8357028316929331, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.133823 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.32569736637057817, 'auprc': 0.32569736637057817, 'loss_val': 1.792146640082778, 'psi': 0.32569736637057817}-{'f1_val': 0.3273040482342808, 'auprc': 0.3273040482342808, 'loss_val': 1.7897566837790313, 'psi': 0.3273040482342808}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.767928 cos_to_last_merge=0.9910 (last merge round=42)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.288722413444017, 'auprc': 0.288722413444017, 'loss_val': 1.8233860502527588, 'psi': 0.288722413444017}-{'f1_val': 0.2799790767621289, 'auprc': 0.2799790767621289, 'loss_val': 1.6482179798406655, 'psi': 0.2799790767621289}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.534331 cos_to_last_merge=0.9986 (last merge round=44)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1394548286765718, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1223328357353226, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.009919 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.628600760400324, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.599473442899196, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.338365 cos_to_last_merge=0.9829 (last merge round=44)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.5883315766736669, 'psi': 0.6152170947577895}-{'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.5461564841251426, 'psi': 0.615636807189815}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.951468 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.11159855306703609, 'auprc': 0.11159855306703609, 'loss_val': 5.115575556225063, 'psi': 0.11159855306703609}-{'f1_val': 0.1494228149422815, 'auprc': 0.1494228149422815, 'loss_val': 4.6293541157964215, 'psi': 0.1494228149422815}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.665466 cos_to_last_merge=0.9984 (last merge round=42)
[S17] round=48 local utility u=0.542219 metrics={'f1_val': 0.39625141461058155, 'auprc': 0.39625141461058155, 'loss_val': 0.9256357152006833, 'psi': 0.39625141461058155}-{'f1_val': 0.2700549568101787, 'auprc': 0.2700549568101787, 'loss_val': 0.874305900819879, 'psi': 0.2700549568101787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=49 head_norm_before_train=1.986837 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.24561403508771928, 'auprc': 0.24561403508771928, 'loss_val': 2.782297431204479, 'psi': 0.24561403508771928}-{'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.769951938596762, 'psi': 0.24552398411243506}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.003577 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.2950527169505272, 'auprc': 0.2950527169505272, 'loss_val': 3.3410918180718983, 'psi': 0.2950527169505272}-{'f1_val': 0.2820295983086681, 'auprc': 0.2820295983086681, 'loss_val': 3.1359956289887276, 'psi': 0.2820295983086681}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.164456 cos_to_last_merge=0.9975 (last merge round=41)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1211750205354145, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1208941297370234, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.630605 cos_to_last_merge=0.9494 (last merge round=41)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.471870578197737, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.435819322298845, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.924450 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 7.531751517209991, 'psi': 0.019328117809479982}-{'f1_val': 0.018885306310456013, 'auprc': 0.018885306310456013, 'loss_val': 7.5203305465885055, 'psi': 0.018885306310456013}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.536726 cos_to_last_merge=0.9964 (last merge round=43)
[S7] round=49 local utility u=0.006988 metrics={'f1_val': 0.2496268656716418, 'auprc': 0.2496268656716418, 'loss_val': 0.6500451803543406, 'psi': 0.2496268656716418}-{'f1_val': 0.24925224327018944, 'auprc': 0.24925224327018944, 'loss_val': 0.6606500340797323, 'psi': 0.24925224327018947}
[S7] not sending this round → trigger blocked (psi=0.250)
[S8] START round=49 head_norm_before_train=1.645350 cos_to_last_merge=0.9950 (last merge round=45)
[S8] round=49 local utility u=0.005083 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7924093533571469, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8025746430289176, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=49 head_norm_before_train=1.593758 cos_to_last_merge=0.9777 (last merge round=45)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.129143563448311, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9689881351056588, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.142788 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.32939322301024426, 'auprc': 0.32939322301024426, 'loss_val': 1.8315500983119686, 'psi': 0.32939322301024426}-{'f1_val': 0.32569736637057817, 'auprc': 0.32569736637057817, 'loss_val': 1.792146640082778, 'psi': 0.32569736637057817}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.786342 cos_to_last_merge=0.9894 (last merge round=42)
[S11] round=49 local utility u=0.010828 metrics={'f1_val': 0.2801439319594374, 'auprc': 0.2801439319594374, 'loss_val': 1.724523071050262, 'psi': 0.2801439319594374}-{'f1_val': 0.288722413444017, 'auprc': 0.288722413444017, 'loss_val': 1.8233860502527588, 'psi': 0.288722413444017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=49 head_norm_before_train=1.548220 cos_to_last_merge=0.9977 (last merge round=44)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1767157796928267, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1394548286765718, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.014481 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.656416062386813, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.628600760400324, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.392674 cos_to_last_merge=0.9766 (last merge round=44)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6159204459827949, 'psi': 0.6161950003225232}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.5883315766736669, 'psi': 0.6152170947577895}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.957612 (no previous merge yet)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.017710309930423784, 'auprc': 0.017710309930423784, 'loss_val': 6.259576192613525, 'psi': 0.017710309930423784}-{'f1_val': 0.11159855306703609, 'auprc': 0.11159855306703609, 'loss_val': 5.115575556225063, 'psi': 0.11159855306703609}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.680920 cos_to_last_merge=0.9978 (last merge round=42)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.34080692855266387, 'auprc': 0.34080692855266387, 'loss_val': 0.9932598774193038, 'psi': 0.34080692855266387}-{'f1_val': 0.39625141461058155, 'auprc': 0.39625141461058155, 'loss_val': 0.9256357152006833, 'psi': 0.39625141461058155}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
