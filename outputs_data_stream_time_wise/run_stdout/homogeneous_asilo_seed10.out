[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:44603
[S3] → join 127.0.0.1:44602
[S4] → join 127.0.0.1:44602
[S5] → join 127.0.0.1:44602
[S6] → join 127.0.0.1:44602
[S7] → join 127.0.0.1:44602
[S8] → join 127.0.0.1:44602
[S9] → join 127.0.0.1:44602
[S10] → join 127.0.0.1:44602
[S11] → join 127.0.0.1:44602
[S13] → join 127.0.0.1:44602
[S14] → join 127.0.0.1:44602
[S15] → join 127.0.0.1:44602
[S16] → join 127.0.0.1:44602
[S17] → join 127.0.0.1:44602
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.226826 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.177649 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.167209 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.133139 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.194113 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.182201 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.092994 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.109377 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.142960 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.137174 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.150536 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.119875 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.165678 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.138169 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.212398 (no previous merge yet)
[S17]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S17
[S3] + discovered S13
[S3] + discovered S4
[S3] + discovered S11
[S3] + discovered S9
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S10
[S3] + discovered S8
[S3] + discovered S16
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S6
[S5] + discovered S3
[S5] + discovered S2
[S5] + discovered S4
[S4] + discovered S10
[S4] + discovered S8
[S4] + discovered S16
[S4] + discovered S7
[S4] + discovered S6
[S4] + discovered S15
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S17
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S9
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S2
[S5] + discovered S9
[S5] + discovered S11
[S5] + discovered S13
[S5] + discovered S6
[S5] + discovered S16
[S5] + discovered S8
[S5] + discovered S14
[S5] + discovered S17
[S5] + discovered S15
[S5] + discovered S7
[S5] + discovered S10
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S3
[S7] + discovered S6
[S6] + discovered S10
[S6] + discovered S14
[S6] + discovered S16
[S6] + discovered S13
[S6] + discovered S7
[S6] + discovered S15
[S6] + discovered S17
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S9
[S8] + discovered S6
[S8] + discovered S2
[S8] + discovered S5
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S7
[S7] + discovered S14
[S7] + discovered S17
[S7] + discovered S8
[S7] + discovered S15
[S7] + discovered S10
[S7] + discovered S9
[S7] + discovered S11
[S7] + discovered S13
[S7] + discovered S16
[S9] + discovered S6
[S8] + discovered S11
[S8] + discovered S10
[S8] + discovered S17
[S8] + discovered S16
[S8] + discovered S13
[S8] + discovered S9
[S8] + discovered S15
[S8] + discovered S14
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S8
[S10] + discovered S2
[S10] + discovered S3
[S10] + discovered S7
[S10] + discovered S8
[S10] + discovered S6
[S10] + discovered S4
[S10] + discovered S5
[S10] + discovered S9
[S9] + discovered S13
[S9] + discovered S14
[S9] + discovered S10
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S17
[S11] + discovered S8
[S11] + discovered S6
[S11] + discovered S3
[S11] + discovered S4
[S11] + discovered S2
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S7
[S10] + discovered S13
[S10] + discovered S17
[S10] + discovered S16
[S10] + discovered S15
[S10] + discovered S11
[S10] + discovered S14
[S11] + discovered S10
[S13] + discovered S3
[S13] + discovered S7
[S13] + discovered S11
[S13] + discovered S2
[S13] + discovered S5
[S13] + discovered S10
[S13] + discovered S4
[S13] + discovered S8
[S13] + discovered S9
[S13] + discovered S6
[S11] + discovered S16
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S17
[S11] + discovered S13
[S14] + discovered S5
[S14] + discovered S2
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S9
[S14] + discovered S4
[S14] + discovered S13
[S14] + discovered S7
[S14] + discovered S3
[S14] + discovered S8
[S13] + discovered S17
[S14] + discovered S10
[S13] + discovered S15
[S13] + discovered S16
[S13] + discovered S14
[S15] + discovered S7
[S15] + discovered S13
[S15] + discovered S4
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S5
[S15] + discovered S10
[S15] + discovered S11
[S15] + discovered S9
[S15] + discovered S2
[S15] + discovered S3
[S15] + discovered S8
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S16] + discovered S15
[S16] + discovered S10
[S16] + discovered S6
[S16] + discovered S14
[S16] + discovered S2
[S16] + discovered S9
[S16] + discovered S13
[S16] + discovered S11
[S16] + discovered S7
[S15] + discovered S16
[S16] + discovered S5
[S15] + discovered S17
[S16] + discovered S4
[S16] + discovered S8
[S16] + discovered S3
[S16] + discovered S17
[S17] + discovered S7
[S17] + discovered S14
[S17] + discovered S4
[S17] + discovered S10
[S17] + discovered S5
[S17] + discovered S3
[S17] + discovered S15
[S17] + discovered S8
[S17] + discovered S13
[S17] + discovered S9
[S17] + discovered S2
[S17] + discovered S6
[S17] + discovered S11
[S17] + discovered S16
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S9@127.0.0.1:44610
[S9] ⇄ pheromone p=1.000 → S14@127.0.0.1:44614
[S6] ⇄ pheromone p=1.000 → S4@127.0.0.1:44604
[S3] ⇄ pheromone p=1.000 → S14@127.0.0.1:44614
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:44615
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:44604
[S2] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:44605
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:44610
[S15] ⇄ pheromone p=1.000 → S8@127.0.0.1:44609
[S7] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S16] ⇄ pheromone p=1.000 → S15@127.0.0.1:44615
[S13] ⇄ pheromone p=1.000 → S14@127.0.0.1:44614
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S2] START round=1 head_norm_before_train=1.241714 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6081167832406564, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4991762498034749, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.180020 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5124516453591046, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.435884954359876, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.172218 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4914744776409579, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4671656237134703, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.136955 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4537755242350403, 'psi': 0.0}-{'f1_val': 0.33301777637530244, 'auprc': 0.33301777637530244, 'loss_val': 1.3934100121950497, 'psi': 0.33301777637530244}
[S6] START round=1 head_norm_before_train=1.198315 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5959979146250245, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5135751410963374, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.185681 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4582483505798396, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.404666890642547, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.097881 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4026238542550342, 'psi': 0.0}-{'f1_val': 0.3069036226930964, 'auprc': 0.3069036226930964, 'loss_val': 1.3732936559962254, 'psi': 0.3069036226930964}
[S9] START round=1 head_norm_before_train=1.110426 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4810281874226585, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3965302074248562, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.151276 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.463697147986595, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4115073620181144, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.136300 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5234475721696141, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4494179402196257, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.152847 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4419595091091213, 'psi': 0.0}-{'f1_val': 0.007454221357964673, 'auprc': 0.007454221357964673, 'loss_val': 1.4026155123730333, 'psi': 0.007454221357964673}
[S14] START round=1 head_norm_before_train=1.125566 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5088621177260304, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4337525103512714, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.182302 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5905264631157843, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4991091677006732, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.144092 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4474246511130744, 'psi': 0.0}-{'f1_val': 0.37171224525344015, 'auprc': 0.37171224525344015, 'loss_val': 1.3841612065856737, 'psi': 0.37171224525344015}
[S17] START round=1 head_norm_before_train=1.219252 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4774719894863009, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4244004127916459, 'psi': 0.0}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.264633 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8381883366580898, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6081167832406564, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.197121 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6492778913175832, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5124516453591046, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.186588 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5369279895798906, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4914744776409579, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.148493 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.559279929528356, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4537755242350403, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.215731 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.763316691404019, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5959979146250245, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.199199 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5674136356024193, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4582483505798396, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.112099 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4462277592182435, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4026238542550342, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.122714 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6217853281225485, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4810281874226585, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.167771 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.557318191758092, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.463697147986595, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.149534 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6515232549503729, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5234475721696141, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.167666 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5310954158150456, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4419595091091213, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.142980 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6398305322932278, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5088621177260304, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.207908 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8123441860170644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5905264631157843, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.161630 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5585807231185782, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4474246511130744, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.234631 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.581536545880542, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4774719894863009, 'psi': 0.0}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.296605 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.440421213084935, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8381883366580898, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.226808 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0037760354218004, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6492778913175832, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.209172 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.648157604461153, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5369279895798906, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.168254 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7794259673066757, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.559279929528356, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.245500 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.199924258410738, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.763316691404019, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.222257 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8166638221296352, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5674136356024193, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.135479 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5382302611071206, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4462277592182435, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.146128 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9717386374923782, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6217853281225485, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.191696 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7690783395247018, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.557318191758092, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.174633 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9727707755007688, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6515232549503729, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.191562 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8168491589355404, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5310954158150456, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.173241 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9410790637770687, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6398305322932278, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.239495 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0090085714654484, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8123441860170644, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.192695 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8622820482814206, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5585807231185782, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.258052 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8389257112325126, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.581536545880542, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.335163 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.860100553722054, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.440421213084935, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.267318 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6014874473708454, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0037760354218004, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.240660 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7228358229368999, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.648157604461153, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.189755 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8382590804698948, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7794259673066757, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.284352 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.919154937323637, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.199924258410738, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.253289 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1757907094111384, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8166638221296352, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.167979 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.71879060356139, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5382302611071206, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.181296 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.505560681359354, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9717386374923782, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.221342 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8401870885422087, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7690783395247018, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.209833 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5630312473841235, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9727707755007688, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.222034 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.00031189523198, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8168491589355404, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.215008 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.626171789029161, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9410790637770687, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.259680 (no previous merge yet)
[S15] round=4 local utility u=0.029004 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9510014367340893, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0090085714654484, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.235526 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7688795715080414, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8622820482814206, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.286794 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9047440092045507, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8389257112325126, 'psi': 0.0}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.362810 (no previous merge yet)
[S2] round=5 local utility u=0.112186 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.635728171430594, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.860100553722054, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.304672 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6653807821338744, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6014874473708454, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.268903 (no previous merge yet)
[S4] round=5 local utility u=0.068721 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5853945079398284, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7228358229368999, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.199521 (no previous merge yet)
[S5] round=5 local utility u=0.048172 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7419148217649345, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8382590804698948, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.320723 (no previous merge yet)
[S6] round=5 local utility u=0.021972 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.875210188855297, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.919154937323637, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.277802 (no previous merge yet)
[S7] round=5 local utility u=0.096657 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.982477339724886, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1757907094111384, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.202671 (no previous merge yet)
[S8] round=5 local utility u=0.032401 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6539877261364087, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.71879060356139, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.213090 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.695068654808738, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.505560681359354, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.237238 (no previous merge yet)
[S10] round=5 local utility u=0.012934 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8143182401341889, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8401870885422087, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.244194 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5714072405288837, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5630312473841235, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.238566 (no previous merge yet)
[S13] round=5 local utility u=0.156077 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6881569807985872, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.00031189523198, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.257925 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1682680383965196, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.626171789029161, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.269079 (no previous merge yet)
[S15] round=5 local utility u=0.062351 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8262989088067592, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9510014367340893, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.284319 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0090962798208, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7688795715080414, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.306473 (no previous merge yet)
[S17] round=5 local utility u=0.109616 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6855126372008244, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9047440092045507, 'psi': 0.0}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S3] ⇄ pheromone p=0.328 → S14@127.0.0.1:44614
[S5] ⇄ pheromone p=0.337 → S9@127.0.0.1:44610
[S6] ⇄ pheromone p=0.332 → S4@127.0.0.1:44604
[S4] ⇄ pheromone p=0.341 → S5@127.0.0.1:44605
[S7] ⇄ pheromone p=0.347 → S16@127.0.0.1:44616
[S9] ⇄ pheromone p=0.328 → S14@127.0.0.1:44614
[S2] ⇄ pheromone p=0.350 → S16@127.0.0.1:44616
[S8] ⇄ pheromone p=0.334 → S4@127.0.0.1:44604
[S10] ⇄ pheromone p=0.330 → S9@127.0.0.1:44610
[S15] ⇄ pheromone p=0.345 → S8@127.0.0.1:44609
[S13] ⇄ pheromone p=0.359 → S14@127.0.0.1:44614
[S17] ⇄ pheromone p=0.350 → S16@127.0.0.1:44616
[S14] ⇄ pheromone p=0.328 → S15@127.0.0.1:44615
[S11] ⇄ pheromone p=0.328 → S16@127.0.0.1:44616
[S16] ⇄ pheromone p=0.328 → S15@127.0.0.1:44615
[S2] START round=6 head_norm_before_train=1.382346 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.674412675377239, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.635728171430594, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.328165 (no previous merge yet)
[S3] round=6 local utility u=0.085013 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.495355499562194, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6653807821338744, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.287661 (no previous merge yet)
[S4] round=6 local utility u=0.043462 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4984710160709622, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5853945079398284, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.204112 (no previous merge yet)
[S5] round=6 local utility u=0.030236 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.681443011131635, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7419148217649345, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.342940 (no previous merge yet)
[S6] round=6 local utility u=0.095441 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6843289628843205, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.875210188855297, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.277878 (no previous merge yet)
[S7] round=6 local utility u=0.093225 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7960275855138814, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.982477339724886, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.224436 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.28312712928097544, 'auprc': 0.28312712928097544, 'loss_val': 1.5518737589194809, 'psi': 0.28312712928097544}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6539877261364087, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.238166 (no previous merge yet)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8764966258493914, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.695068654808738, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.251718 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8225486175859, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8143182401341889, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.269253 (no previous merge yet)
[S11] round=6 local utility u=0.099869 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3716701925369463, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5714072405288837, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.230751 (no previous merge yet)
[S13] round=6 local utility u=0.073433 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.541290716087883, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6881569807985872, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.292844 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.206485204597778, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1682680383965196, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.277293 (no previous merge yet)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.83039507984946, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8262989088067592, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.316495 (no previous merge yet)
[S16] round=6 local utility u=0.157923 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6932508241627433, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0090962798208, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.321458 (no previous merge yet)
[S17] round=6 local utility u=0.041331 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.602851427101086, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6855126372008244, 'psi': 0.0}
[S4] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:44604
[S3] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S8
[S4] cosine check vs S8: cos=-0.0763
[S4] DROPPED delta from S8 (cos=-0.0763 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=7 head_norm_before_train=1.407043 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2504282804210107, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.674412675377239, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.353275 (no previous merge yet)
[S3] round=7 local utility u=0.079539 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.336277958177183, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.495355499562194, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.317241 (no previous merge yet)
[S4] round=7 local utility u=0.029979 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4385139153647293, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4984710160709622, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.212708 (no previous merge yet)
[S5] round=7 local utility u=0.642220 metrics={'f1_val': 0.1411022576361222, 'auprc': 0.1411022576361222, 'loss_val': 1.6669227226086027, 'psi': 0.1411022576361222}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.681443011131635, 'psi': 0.0}
[S6] START round=7 head_norm_before_train=1.368285 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9032919780619175, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6843289628843205, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.278173 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8068243923041776, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7960275855138814, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.252910 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.2320182205569025, 'auprc': 0.2320182205569025, 'loss_val': 1.4855931758801086, 'psi': 0.23201822055690252}-{'f1_val': 0.28312712928097544, 'auprc': 0.28312712928097544, 'loss_val': 1.5518737589194809, 'psi': 0.28312712928097544}
[S9] START round=7 head_norm_before_train=1.269043 (no previous merge yet)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.059047039602942, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8764966258493914, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.272318 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.103230387186978, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8225486175859, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.295327 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4205604102417153, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3716701925369463, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.228153 (no previous merge yet)
[S13] round=7 local utility u=0.014271 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.51274893833032, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.541290716087883, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.323402 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4495488122982283, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.206485204597778, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.296286 (no previous merge yet)
[S15] round=7 local utility u=0.035961 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.758472900291605, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.83039507984946, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.344022 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0382985963440765, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6932508241627433, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.345934 (no previous merge yet)
[S17] round=7 local utility u=1.000000 metrics={'f1_val': 0.2688465031789283, 'auprc': 0.2688465031789283, 'loss_val': 1.4618088600344676, 'psi': 0.2688465031789283}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.602851427101086, 'psi': 0.0}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.141)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S17
[S16] cosine check vs S17: cos=0.0002
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.0000 head_norm=1.374622
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.700225e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.0000 head_norm=0.970234 delta_norm=0.970022
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.439937 (no previous merge yet)
[S2] round=8 local utility u=0.186009 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.878410926076821, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2504282804210107, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.380757 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6272974531922153, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.336277958177183, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.353256 (no previous merge yet)
[S4] round=8 local utility u=0.016512 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4054905820920685, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4385139153647293, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.227415 (no previous merge yet)
[S5] round=8 local utility u=0.736108 metrics={'f1_val': 0.2911032028469751, 'auprc': 0.2911032028469751, 'loss_val': 1.5447148587689983, 'psi': 0.2911032028469751}-{'f1_val': 0.1411022576361222, 'auprc': 0.1411022576361222, 'loss_val': 1.6669227226086027, 'psi': 0.1411022576361222}
[S6] START round=8 head_norm_before_train=1.402613 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.531471930940809, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9032919780619175, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.292798 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8095410093218203, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8068243923041776, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.290099 (no previous merge yet)
[S8] round=8 local utility u=0.019075 metrics={'f1_val': 0.225942620018602, 'auprc': 0.225942620018602, 'loss_val': 1.3927625797724283, 'psi': 0.225942620018602}-{'f1_val': 0.2320182205569025, 'auprc': 0.2320182205569025, 'loss_val': 1.4855931758801086, 'psi': 0.23201822055690252}
[S9] START round=8 head_norm_before_train=1.299618 (no previous merge yet)
[S9] round=8 local utility u=0.036807 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9854328535036294, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.059047039602942, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.303472 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.36957459181404, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.103230387186978, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.324695 (no previous merge yet)
[S11] round=8 local utility u=0.277449 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.865662591168193, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4205604102417153, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.239890 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.517182621716268, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.51274893833032, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.357301 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.124282932884351, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4495488122982283, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.318194 (no previous merge yet)
[S15] round=8 local utility u=0.119166 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5201408837182073, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.758472900291605, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=0.970234 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.460735 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1168293185041716, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0382985963440765, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.369310 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.1579847144006436, 'auprc': 0.1579847144006436, 'loss_val': 1.3595013459989405, 'psi': 0.1579847144006436}-{'f1_val': 0.2688465031789283, 'auprc': 0.2688465031789283, 'loss_val': 1.4618088600344676, 'psi': 0.2688465031789283}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:44604
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44610
[S4] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.0703
[S9] DROPPED delta from S5 (cos=-0.0703 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S8
[S4] cosine check vs S8: cos=-0.0701
[S4] DROPPED delta from S8 (cos=-0.0701 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=9 head_norm_before_train=1.473404 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2973611172314397, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.878410926076821, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.414571 (no previous merge yet)
[S3] round=9 local utility u=0.298896 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.02950615185405, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6272974531922153, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.389989 (no previous merge yet)
[S4] round=9 local utility u=0.000915 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4036596437086104, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4054905820920685, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.239033 (no previous merge yet)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.23577599046767947, 'auprc': 0.23577599046767947, 'loss_val': 1.4301884248577486, 'psi': 0.23577599046767947}-{'f1_val': 0.2911032028469751, 'auprc': 0.2911032028469751, 'loss_val': 1.5447148587689983, 'psi': 0.2911032028469751}
[S6] START round=9 head_norm_before_train=1.443054 (no previous merge yet)
[S6] round=9 local utility u=0.052759 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4259541481542324, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.531471930940809, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.309906 (no previous merge yet)
[S7] round=9 local utility u=0.054488 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7005649686214979, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8095410093218203, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.327891 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.2133927968105953, 'auprc': 0.2133927968105953, 'loss_val': 1.3272815374728961, 'psi': 0.2133927968105953}-{'f1_val': 0.225942620018602, 'auprc': 0.225942620018602, 'loss_val': 1.3927625797724283, 'psi': 0.225942620018602}
[S9] START round=9 head_norm_before_train=1.328941 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.054177578338308, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9854328535036294, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.336030 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6057153072158643, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.36957459181404, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.354795 (no previous merge yet)
[S11] round=9 local utility u=0.021636 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8223900396538824, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.865662591168193, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.258205 (no previous merge yet)
[S13] round=9 local utility u=0.051121 metrics={'f1_val': 0.005847953216374269, 'auprc': 0.005847953216374269, 'loss_val': 1.4675724113965751, 'psi': 0.005847953216374269}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.517182621716268, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.396389 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.678744365910662, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.124282932884351, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.339457 (no previous merge yet)
[S15] round=9 local utility u=0.053332 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.413476660827934, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5201408837182073, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.006994 cos_to_last_merge=0.9965 (last merge round=7)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.137851009221833, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1168293185041716, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.393133 (no previous merge yet)
[S17] round=9 local utility u=0.011896 metrics={'f1_val': 0.15483934555489848, 'auprc': 0.15483934555489848, 'loss_val': 1.3074003836895371, 'psi': 0.15483934555489848}-{'f1_val': 0.1579847144006436, 'auprc': 0.1579847144006436, 'loss_val': 1.3595013459989405, 'psi': 0.1579847144006436}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.006)
[S15] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S17
[S16] cosine check vs S17: cos=0.6608
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.0000 head_norm=1.059539
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.348921e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.130211 delta_norm=0.534892
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.503314 (no previous merge yet)
[S2] round=10 local utility u=0.120083 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.057194946378091, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2973611172314397, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.447496 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.221055619579389, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.02950615185405, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.427492 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4140892193645038, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4036596437086104, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.253226 (no previous merge yet)
[S5] round=10 local utility u=0.353823 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.3467035298009595, 'psi': 0.3051272166538165}-{'f1_val': 0.23577599046767947, 'auprc': 0.23577599046767947, 'loss_val': 1.4301884248577486, 'psi': 0.23577599046767947}
[S6] START round=10 head_norm_before_train=1.479643 (no previous merge yet)
[S6] round=10 local utility u=0.171957 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.082039332977373, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4259541481542324, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.324813 (no previous merge yet)
[S7] round=10 local utility u=0.086452 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5276619195292254, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7005649686214979, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.360997 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.20783152352747614, 'auprc': 0.20783152352747614, 'loss_val': 1.3014601278573008, 'psi': 0.20783152352747614}-{'f1_val': 0.2133927968105953, 'auprc': 0.2133927968105953, 'loss_val': 1.3272815374728961, 'psi': 0.2133927968105953}
[S9] START round=10 head_norm_before_train=1.360363 (no previous merge yet)
[S9] round=10 local utility u=0.207412 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6393532975509997, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.054177578338308, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.368042 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9760113468222125, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6057153072158643, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.386650 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.881852035288294, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8223900396538824, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.273369 (no previous merge yet)
[S13] round=10 local utility u=1.000000 metrics={'f1_val': 0.2799011218862902, 'auprc': 0.2799011218862902, 'loss_val': 1.3487912148158934, 'psi': 0.2799011218862902}-{'f1_val': 0.005847953216374269, 'auprc': 0.005847953216374269, 'loss_val': 1.4675724113965751, 'psi': 0.005847953216374269}
[S14] START round=10 head_norm_before_train=1.434735 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.051744181725313, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.678744365910662, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.370189 (no previous merge yet)
[S15] round=10 local utility u=0.353294 metrics={'f1_val': 0.06908267270668177, 'auprc': 0.06908267270668177, 'loss_val': 1.3286321738838345, 'psi': 0.06908267270668177}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.413476660827934, 'psi': 0.0}
[S16] START round=10 head_norm_before_train=1.130211 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3104320538866503, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.137851009221833, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.415750 (no previous merge yet)
[S17] round=10 local utility u=0.020498 metrics={'f1_val': 0.15732024834768676, 'auprc': 0.15732024834768676, 'loss_val': 1.288733051920226, 'psi': 0.15732024834768676}-{'f1_val': 0.15483934555489848, 'auprc': 0.15483934555489848, 'loss_val': 1.3074003836895371, 'psi': 0.15483934555489848}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44610
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:44614
[S15] not sending this round → trigger blocked (psi=0.069)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S13
[S14] cosine check vs S13: cos=0.0416
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=-0.0730
[S9] DROPPED delta from S5 (cos=-0.0730 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S17
[S16] cosine check vs S17: cos=0.9140
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.0000 head_norm=1.468169
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.561556e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.0000 head_norm=0.996393 delta_norm=0.956156
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.107 → S15@127.0.0.1:44615
[S15] ⇄ pheromone p=0.211 → S8@127.0.0.1:44609
[S3] ⇄ pheromone p=0.170 → S14@127.0.0.1:44614
[S10] ⇄ pheromone p=0.108 → S9@127.0.0.1:44610
[S11] ⇄ pheromone p=0.155 → S16@127.0.0.1:44616
[S6] ⇄ pheromone p=0.159 → S4@127.0.0.1:44604
[S7] ⇄ pheromone p=0.147 → S16@127.0.0.1:44616
[S8] ⇄ pheromone p=0.194 → S4@127.0.0.1:44604
[S2] ⇄ pheromone p=0.163 → S16@127.0.0.1:44616
[S4] ⇄ pheromone p=0.121 → S5@127.0.0.1:44605
[S9] ⇄ pheromone p=0.154 → S14@127.0.0.1:44614
[S13] ⇄ pheromone p=0.333 → S14@127.0.0.1:44614
[S5] ⇄ pheromone p=0.344 → S9@127.0.0.1:44610
[S17] ⇄ pheromone p=0.226 → S16@127.0.0.1:44616
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.0000 head_norm=1.171209
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.001850e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.276319 delta_norm=0.300185
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.179 → S15@127.0.0.1:44615
[S2] START round=11 head_norm_before_train=1.526477 (no previous merge yet)
[S2] round=11 local utility u=0.211031 metrics={'f1_val': 0.010238907849829351, 'auprc': 0.010238907849829351, 'loss_val': 2.727283791712965, 'psi': 0.010238907849829351}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.057194946378091, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.483364 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.373226905640143, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.221055619579389, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.464135 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4193402977996374, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4140892193645038, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.272370 (no previous merge yet)
[S5] round=11 local utility u=0.033566 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.2795714622408816, 'psi': 0.3051272166538165}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.3467035298009595, 'psi': 0.3051272166538165}
[S6] START round=11 head_norm_before_train=1.514420 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6475199776033307, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.082039332977373, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.339664 (no previous merge yet)
[S7] round=11 local utility u=0.039433 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4487950871573423, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5276619195292254, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.388591 (no previous merge yet)
[S8] round=11 local utility u=0.016859 metrics={'f1_val': 0.20701409373975746, 'auprc': 0.20701409373975746, 'loss_val': 1.260385438146374, 'psi': 0.20701409373975746}-{'f1_val': 0.20783152352747614, 'auprc': 0.20783152352747614, 'loss_val': 1.3014601278573008, 'psi': 0.20783152352747614}
[S9] START round=11 head_norm_before_train=1.387740 (no previous merge yet)
[S9] round=11 local utility u=0.917890 metrics={'f1_val': 0.1553077889447236, 'auprc': 0.1553077889447236, 'loss_val': 2.201343321132335, 'psi': 0.1553077889447236}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6393532975509997, 'psi': 0.0}
[S10] START round=11 head_norm_before_train=1.401847 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1976321675588504, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9760113468222125, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.417774 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.060010294635992, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.881852035288294, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.287845 (no previous merge yet)
[S13] round=11 local utility u=0.212656 metrics={'f1_val': 0.3179909145452987, 'auprc': 0.3179909145452987, 'loss_val': 1.2662875456067637, 'psi': 0.3179909145452987}-{'f1_val': 0.2799011218862902, 'auprc': 0.2799011218862902, 'loss_val': 1.3487912148158934, 'psi': 0.2799011218862902}
[S14] START round=11 head_norm_before_train=0.996393 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.747852 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5560392111541073, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.051744181725313, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.403415 (no previous merge yet)
[S15] round=11 local utility u=0.315207 metrics={'f1_val': 0.13447638258530845, 'auprc': 0.13447638258530845, 'loss_val': 1.2867613866836949, 'psi': 0.13447638258530845}-{'f1_val': 0.06908267270668177, 'auprc': 0.06908267270668177, 'loss_val': 1.3286321738838345, 'psi': 0.06908267270668177}
[S16] START round=11 head_norm_before_train=1.276319 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.199640 metrics={'f1_val': 0.01935483870967742, 'auprc': 0.01935483870967742, 'loss_val': 2.085345262966927, 'psi': 0.01935483870967742}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3104320538866503, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.437524 (no previous merge yet)
[S17] round=11 local utility u=0.035827 metrics={'f1_val': 0.16585726351351351, 'auprc': 0.16585726351351351, 'loss_val': 1.2939124940256523, 'psi': 0.16585726351351351}-{'f1_val': 0.15732024834768676, 'auprc': 0.15732024834768676, 'loss_val': 1.288733051920226, 'psi': 0.15732024834768676}
[S15] not sending this round → trigger blocked (psi=0.134)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44614
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44604
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.010)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.019)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44610
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.155)
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S13
[S14] cosine check vs S13: cos=0.6478
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=-0.0745
[S9] DROPPED delta from S5 (cos=-0.0745 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S8
[S4] cosine check vs S8: cos=-0.0597
[S4] DROPPED delta from S8 (cos=-0.0597 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] cosine check vs S17: cos=0.9683
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.0000 head_norm=1.034111
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.068170e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.064407 delta_norm=0.506817
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.0194 head_norm=1.310259
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.898024e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.0242 head_norm=1.374661 delta_norm=0.189802
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.547779 (no previous merge yet)
[S2] round=12 local utility u=1.000000 metrics={'f1_val': 0.23296931877275093, 'auprc': 0.23296931877275093, 'loss_val': 2.538847544335497, 'psi': 0.23296931877275093}-{'f1_val': 0.010238907849829351, 'auprc': 0.010238907849829351, 'loss_val': 2.727283791712965, 'psi': 0.010238907849829351}
[S3] START round=12 head_norm_before_train=1.517929 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.635844365759628, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.373226905640143, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.497409 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4310399918882366, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4193402977996374, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.293206 (no previous merge yet)
[S5] round=12 local utility u=0.023529 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.232512938586425, 'psi': 0.3051272166538165}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.2795714622408816, 'psi': 0.3051272166538165}
[S6] START round=12 head_norm_before_train=1.549626 (no previous merge yet)
[S6] round=12 local utility u=0.074052 metrics={'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 3.6513576342801812, 'psi': 0.016882516188714152}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6475199776033307, 'psi': 0.0}
[S7] START round=12 head_norm_before_train=1.356642 (no previous merge yet)
[S7] round=12 local utility u=0.079363 metrics={'f1_val': 0.014961389961389961, 'auprc': 0.014961389961389961, 'loss_val': 1.4247221440557014, 'psi': 0.014961389961389961}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4487950871573423, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.413075 (no previous merge yet)
[S8] round=12 local utility u=0.053115 metrics={'f1_val': 0.2091559055398273, 'auprc': 0.2091559055398273, 'loss_val': 1.17343094628704, 'psi': 0.2091559055398273}-{'f1_val': 0.20701409373975746, 'auprc': 0.20701409373975746, 'loss_val': 1.260385438146374, 'psi': 0.20701409373975746}
[S9] START round=12 head_norm_before_train=1.416540 (no previous merge yet)
[S9] round=12 local utility u=0.059667 metrics={'f1_val': 0.16456228956228955, 'auprc': 0.16456228956228955, 'loss_val': 2.1653004678480325, 'psi': 0.16456228956228955}-{'f1_val': 0.1553077889447236, 'auprc': 0.1553077889447236, 'loss_val': 2.201343321132335, 'psi': 0.1553077889447236}
[S10] START round=12 head_norm_before_train=1.430744 (no previous merge yet)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.337196834277896, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1976321675588504, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.449004 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3882856675993223, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.060010294635992, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.307772 (no previous merge yet)
[S13] round=12 local utility u=0.091592 metrics={'f1_val': 0.33186202386790914, 'auprc': 0.33186202386790914, 'loss_val': 1.2079429587195216, 'psi': 0.33186202386790914}-{'f1_val': 0.3179909145452987, 'auprc': 0.3179909145452987, 'loss_val': 1.2662875456067637, 'psi': 0.3179909145452987}
[S14] START round=12 head_norm_before_train=1.064407 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.308389 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9392618929672922, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5560392111541073, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.439030 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2759869082738515, 'psi': 0.0}-{'f1_val': 0.13447638258530845, 'auprc': 0.13447638258530845, 'loss_val': 1.2867613866836949, 'psi': 0.13447638258530845}
[S16] START round=12 head_norm_before_train=1.374661 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.070348 metrics={'f1_val': 0.04352678571428571, 'auprc': 0.04352678571428571, 'loss_val': 2.1621964071877025, 'psi': 0.04352678571428571}-{'f1_val': 0.01935483870967742, 'auprc': 0.01935483870967742, 'loss_val': 2.085345262966927, 'psi': 0.01935483870967742}
[S17] START round=12 head_norm_before_train=1.461046 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.008707124010554089, 'auprc': 0.008707124010554089, 'loss_val': 1.3352907595269137, 'psi': 0.008707124010554089}-{'f1_val': 0.16585726351351351, 'auprc': 0.16585726351351351, 'loss_val': 1.2939124940256523, 'psi': 0.16585726351351351}
[S6] not sending this round → trigger blocked (psi=0.017)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.015)
[S9] not sending this round → trigger blocked (psi=0.165)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44610
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.044)
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:44604
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] cosine check vs S2: cos=0.0447
[S14] RECEIVED delta(kind=head bytes=1800) from S13
[S14] cosine check vs S13: cos=0.9011
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=-0.0755
[S9] DROPPED delta from S5 (cos=-0.0755 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1805) from S8
[S4] cosine check vs S8: cos=-0.0561
[S4] DROPPED delta from S8 (cos=-0.0561 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.0000 head_norm=1.093792
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.921851e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.180435 delta_norm=0.292185
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.0435 head_norm=1.409065
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.031597e+00
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.0572 head_norm=1.078501 delta_norm=1.031597
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.571385 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.1796938775510204, 'auprc': 0.1796938775510204, 'loss_val': 2.324257822028304, 'psi': 0.1796938775510204}-{'f1_val': 0.23296931877275093, 'auprc': 0.23296931877275093, 'loss_val': 2.538847544335497, 'psi': 0.23296931877275093}
[S3] START round=13 head_norm_before_train=1.547001 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.709706096653304, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.635844365759628, 'psi': 0.0}
[S4] START round=13 head_norm_before_train=1.531949 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4524427340815738, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4310399918882366, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.320143 (no previous merge yet)
[S5] round=13 local utility u=0.016021 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.2004704800807942, 'psi': 0.3051272166538165}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.232512938586425, 'psi': 0.3051272166538165}
[S6] START round=13 head_norm_before_train=1.580093 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 4.556449163356692, 'psi': 0.01732902033271719}-{'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 3.6513576342801812, 'psi': 0.016882516188714152}
[S7] START round=13 head_norm_before_train=1.378643 (no previous merge yet)
[S7] round=13 local utility u=0.519135 metrics={'f1_val': 0.12791558681969642, 'auprc': 0.12791558681969642, 'loss_val': 1.4030402427669841, 'psi': 0.12791558681969642}-{'f1_val': 0.014961389961389961, 'auprc': 0.014961389961389961, 'loss_val': 1.4247221440557014, 'psi': 0.014961389961389961}
[S8] START round=13 head_norm_before_train=1.439085 (no previous merge yet)
[S8] round=13 local utility u=0.202291 metrics={'f1_val': 0.24486824196209092, 'auprc': 0.24486824196209092, 'loss_val': 1.0902592301178078, 'psi': 0.24486824196209092}-{'f1_val': 0.2091559055398273, 'auprc': 0.2091559055398273, 'loss_val': 1.17343094628704, 'psi': 0.2091559055398273}
[S9] START round=13 head_norm_before_train=1.448895 (no previous merge yet)
[S9] round=13 local utility u=1.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.97422726329321, 'psi': 0.36867172340800847}-{'f1_val': 0.16456228956228955, 'auprc': 0.16456228956228955, 'loss_val': 2.1653004678480325, 'psi': 0.16456228956228955}
[S10] START round=13 head_norm_before_train=1.457841 (no previous merge yet)
[S10] round=13 local utility u=0.020830 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.295536985716491, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.337196834277896, 'psi': 0.0}
[S11] START round=13 head_norm_before_train=1.481024 (no previous merge yet)
[S11] round=13 local utility u=0.051012 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.286262562917075, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3882856675993223, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.327109 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.25469571750563486, 'auprc': 0.25469571750563486, 'loss_val': 1.1534354602268468, 'psi': 0.25469571750563486}-{'f1_val': 0.33186202386790914, 'auprc': 0.33186202386790914, 'loss_val': 1.2079429587195216, 'psi': 0.33186202386790914}
[S14] START round=13 head_norm_before_train=1.180435 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.043831 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.851599407379221, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9392618929672922, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.468647 (no previous merge yet)
[S15] round=13 local utility u=0.965583 metrics={'f1_val': 0.20541958041958042, 'auprc': 0.20541958041958042, 'loss_val': 1.1935970141206125, 'psi': 0.20541958041958042}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2759869082738515, 'psi': 0.0}
[S16] START round=13 head_norm_before_train=1.078501 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.023221343873517788, 'auprc': 0.023221343873517788, 'loss_val': 2.1487571761249153, 'psi': 0.023221343873517788}-{'f1_val': 0.04352678571428571, 'auprc': 0.04352678571428571, 'loss_val': 2.1621964071877025, 'psi': 0.04352678571428571}
[S17] START round=13 head_norm_before_train=1.487564 (no previous merge yet)
[S17] round=13 local utility u=0.758950 metrics={'f1_val': 0.17446569178852644, 'auprc': 0.17446569178852644, 'loss_val': 1.3092170678407062, 'psi': 0.17446569178852644}-{'f1_val': 0.008707124010554089, 'auprc': 0.008707124010554089, 'loss_val': 1.3352907595269137, 'psi': 0.008707124010554089}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44609
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44610
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.128)
[S10] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:44604
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.0042
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=-0.0760
[S9] DROPPED delta from S5 (cos=-0.0760 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=-0.1016
[S8] DROPPED delta from S15 (cos=-0.1016 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S8
[S4] cosine check vs S8: cos=-0.0523
[S4] DROPPED delta from S8 (cos=-0.0523 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S17
[S16] cosine check vs S17: cos=0.6748
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.0000 head_norm=1.207661
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.543501e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.0000 head_norm=0.958248 delta_norm=0.954350
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.0232 head_norm=1.116231
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.602226e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.0432 head_norm=1.205459 delta_norm=0.560223
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.598335 (no previous merge yet)
[S2] round=14 local utility u=0.018750 metrics={'f1_val': 0.20414821719878817, 'auprc': 0.20414821719878817, 'loss_val': 2.506846622316941, 'psi': 0.20414821719878817}-{'f1_val': 0.1796938775510204, 'auprc': 0.1796938775510204, 'loss_val': 2.324257822028304, 'psi': 0.1796938775510204}
[S3] START round=14 head_norm_before_train=1.573380 (no previous merge yet)
[S3] round=14 local utility u=1.000000 metrics={'f1_val': 0.29786066922654963, 'auprc': 0.29786066922654963, 'loss_val': 2.1306510901920817, 'psi': 0.29786066922654963}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.709706096653304, 'psi': 0.0}
[S4] START round=14 head_norm_before_train=1.569082 (no previous merge yet)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4556543311491148, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4524427340815738, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.348464 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.202344152498712, 'auprc': 0.202344152498712, 'loss_val': 1.1849318774155568, 'psi': 0.202344152498712}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.2004704800807942, 'psi': 0.3051272166538165}
[S6] START round=14 head_norm_before_train=1.609268 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.0016698473282442748, 'auprc': 0.0016698473282442748, 'loss_val': 5.304049584344806, 'psi': 0.0016698473282442746}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 4.556449163356692, 'psi': 0.01732902033271719}
[S7] START round=14 head_norm_before_train=1.403824 (no previous merge yet)
[S7] round=14 local utility u=0.149904 metrics={'f1_val': 0.15754812563323203, 'auprc': 0.15754812563323203, 'loss_val': 1.3699245883044169, 'psi': 0.15754812563323203}-{'f1_val': 0.12791558681969642, 'auprc': 0.12791558681969642, 'loss_val': 1.4030402427669841, 'psi': 0.12791558681969642}
[S8] START round=14 head_norm_before_train=1.467478 (no previous merge yet)
[S8] round=14 local utility u=0.365704 metrics={'f1_val': 0.3184539432432469, 'auprc': 0.3184539432432469, 'loss_val': 1.021121572116052, 'psi': 0.3184539432432469}-{'f1_val': 0.24486824196209092, 'auprc': 0.24486824196209092, 'loss_val': 1.0902592301178078, 'psi': 0.24486824196209092}
[S9] START round=14 head_norm_before_train=1.483106 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.23221655741684877, 'auprc': 0.23221655741684877, 'loss_val': 2.239065040310061, 'psi': 0.23221655741684877}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.97422726329321, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.482008 (no previous merge yet)
[S10] round=14 local utility u=0.056119 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1832995250639553, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.295536985716491, 'psi': 0.0}
[S11] START round=14 head_norm_before_train=1.510097 (no previous merge yet)
[S11] round=14 local utility u=1.000000 metrics={'f1_val': 0.31558282208588956, 'auprc': 0.31558282208588956, 'loss_val': 2.252757012226154, 'psi': 0.31558282208588956}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.286262562917075, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.355006 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.2450750045183445, 'auprc': 0.2450750045183445, 'loss_val': 1.1037739282927563, 'psi': 0.24507500451834446}-{'f1_val': 0.25469571750563486, 'auprc': 0.25469571750563486, 'loss_val': 1.1534354602268468, 'psi': 0.25469571750563486}
[S14] START round=14 head_norm_before_train=0.958248 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.388748 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.074102447068032, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.851599407379221, 'psi': 0.0}
[S15] START round=14 head_norm_before_train=1.494685 (no previous merge yet)
[S15] round=14 local utility u=0.045915 metrics={'f1_val': 0.21040495748666954, 'auprc': 0.21040495748666954, 'loss_val': 1.146635007939016, 'psi': 0.21040495748666954}-{'f1_val': 0.20541958041958042, 'auprc': 0.20541958041958042, 'loss_val': 1.1935970141206125, 'psi': 0.20541958041958042}
[S16] START round=14 head_norm_before_train=1.205459 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.246820 metrics={'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 2.2470887227712284, 'psi': 0.08899598393574297}-{'f1_val': 0.023221343873517788, 'auprc': 0.023221343873517788, 'loss_val': 2.1487571761249153, 'psi': 0.023221343873517788}
[S17] START round=14 head_norm_before_train=1.512610 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.15741482965931863, 'auprc': 0.15741482965931863, 'loss_val': 1.2447728004813736, 'psi': 0.15741482965931863}-{'f1_val': 0.17446569178852644, 'auprc': 0.17446569178852644, 'loss_val': 1.3092170678407062, 'psi': 0.17446569178852644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[S16] not sending this round → trigger blocked (psi=0.089)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.158)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[S10] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44616
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44609
[S11] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S8
[S4] cosine check vs S8: cos=-0.0480
[S4] DROPPED delta from S8 (cos=-0.0480 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S11
[S16] cosine check vs S11: cos=-0.0055
[S16] DROPPED delta from S11 (cos=-0.0055 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S2
[S16] cosine check vs S2: cos=0.3620
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] cosine check vs S3: cos=0.1352
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=-0.1009
[S8] DROPPED delta from S15 (cos=-0.1009 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.0000 head_norm=0.983170
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.808280e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.0000 head_norm=0.994266 delta_norm=0.880828
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.0890 head_norm=1.250921
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.281703e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.0845 head_norm=1.193173 delta_norm=0.828170
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.629187 (no previous merge yet)
[S2] round=15 local utility u=0.321408 metrics={'f1_val': 0.25884984866429794, 'auprc': 0.25884984866429794, 'loss_val': 2.3563456304578065, 'psi': 0.25884984866429794}-{'f1_val': 0.20414821719878817, 'auprc': 0.20414821719878817, 'loss_val': 2.506846622316941, 'psi': 0.20414821719878817}
[S3] START round=15 head_norm_before_train=1.600694 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.29802414928649834, 'auprc': 0.29802414928649834, 'loss_val': 2.470241747589205, 'psi': 0.29802414928649834}-{'f1_val': 0.29786066922654963, 'auprc': 0.29786066922654963, 'loss_val': 2.1306510901920817, 'psi': 0.29786066922654963}
[S4] START round=15 head_norm_before_train=1.606455 (no previous merge yet)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4731139116599932, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4556543311491148, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.377027 (no previous merge yet)
[S5] round=15 local utility u=0.002386 metrics={'f1_val': 0.20162538699690402, 'auprc': 0.20162538699690402, 'loss_val': 1.173691692808195, 'psi': 0.20162538699690402}-{'f1_val': 0.202344152498712, 'auprc': 0.202344152498712, 'loss_val': 1.1849318774155568, 'psi': 0.202344152498712}
[S6] START round=15 head_norm_before_train=1.633900 (no previous merge yet)
[S6] round=15 local utility u=0.173099 metrics={'f1_val': 0.025873808443032227, 'auprc': 0.025873808443032227, 'loss_val': 5.175688161984813, 'psi': 0.025873808443032227}-{'f1_val': 0.0016698473282442748, 'auprc': 0.0016698473282442748, 'loss_val': 5.304049584344806, 'psi': 0.0016698473282442746}
[S7] START round=15 head_norm_before_train=1.424751 (no previous merge yet)
[S7] round=15 local utility u=0.593670 metrics={'f1_val': 0.28609296601344314, 'auprc': 0.28609296601344314, 'loss_val': 1.3394882510600041, 'psi': 0.28609296601344314}-{'f1_val': 0.15754812563323203, 'auprc': 0.15754812563323203, 'loss_val': 1.3699245883044169, 'psi': 0.15754812563323203}
[S8] START round=15 head_norm_before_train=1.501343 (no previous merge yet)
[S8] round=15 local utility u=0.227193 metrics={'f1_val': 0.3633323650045286, 'auprc': 0.3633323650045286, 'loss_val': 0.9706417481487009, 'psi': 0.3633323650045286}-{'f1_val': 0.3184539432432469, 'auprc': 0.3184539432432469, 'loss_val': 1.021121572116052, 'psi': 0.3184539432432469}
[S9] START round=15 head_norm_before_train=1.516027 (no previous merge yet)
[S9] round=15 local utility u=0.059212 metrics={'f1_val': 0.2455583009765855, 'auprc': 0.2455583009765855, 'loss_val': 2.2407157433028617, 'psi': 0.2455583009765855}-{'f1_val': 0.23221655741684877, 'auprc': 0.23221655741684877, 'loss_val': 2.239065040310061, 'psi': 0.23221655741684877}
[S10] START round=15 head_norm_before_train=1.501285 (no previous merge yet)
[S10] round=15 local utility u=0.969022 metrics={'f1_val': 0.2056837366347777, 'auprc': 0.2056837366347777, 'loss_val': 3.096410143969946, 'psi': 0.2056837366347777}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1832995250639553, 'psi': 0.0}
[S11] START round=15 head_norm_before_train=1.533883 (no previous merge yet)
[S11] round=15 local utility u=0.172379 metrics={'f1_val': 0.3315508021390374, 'auprc': 0.3315508021390374, 'loss_val': 2.0517105473871253, 'psi': 0.3315508021390374}-{'f1_val': 0.31558282208588956, 'auprc': 0.31558282208588956, 'loss_val': 2.252757012226154, 'psi': 0.31558282208588956}
[S13] START round=15 head_norm_before_train=1.383798 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.2404255319148936, 'auprc': 0.2404255319148936, 'loss_val': 1.0912319447986787, 'psi': 0.2404255319148936}-{'f1_val': 0.2450750045183445, 'auprc': 0.2450750045183445, 'loss_val': 1.1037739282927563, 'psi': 0.24507500451834446}
[S14] START round=15 head_norm_before_train=0.994266 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4504997879709474, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.074102447068032, 'psi': 0.0}
[S15] START round=15 head_norm_before_train=1.518924 (no previous merge yet)
[S15] round=15 local utility u=0.049704 metrics={'f1_val': 0.21451013996001142, 'auprc': 0.21451013996001142, 'loss_val': 1.0841741947928514, 'psi': 0.21451013996001145}-{'f1_val': 0.21040495748666954, 'auprc': 0.21040495748666954, 'loss_val': 1.146635007939016, 'psi': 0.21040495748666954}
[S16] START round=15 head_norm_before_train=1.193173 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.04062064156206416, 'auprc': 0.04062064156206416, 'loss_val': 2.3090523599789026, 'psi': 0.04062064156206416}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 2.2470887227712284, 'psi': 0.08899598393574297}
[S17] START round=15 head_norm_before_train=1.533978 (no previous merge yet)
[S17] round=15 local utility u=0.017884 metrics={'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.1636576262279046, 'psi': 0.15237633365664405}-{'f1_val': 0.15741482965931863, 'auprc': 0.15741482965931863, 'loss_val': 1.2447728004813736, 'psi': 0.15741482965931863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44604
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44609
[S6] not sending this round → trigger blocked (psi=0.026)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S8
[S4] cosine check vs S8: cos=-0.0441
[S4] DROPPED delta from S8 (cos=-0.0441 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.0087
[S16] RECEIVED delta(kind=head bytes=1800) from S11
[S16] cosine check vs S11: cos=0.0785
[S16] RECEIVED delta(kind=head bytes=1801) from S2
[S16] cosine check vs S2: cos=0.8506
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.4192
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.0759
[S9] DROPPED delta from S5 (cos=-0.0759 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=-0.0106
[S9] DROPPED delta from S10 (cos=-0.0106 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=-0.0998
[S8] DROPPED delta from S15 (cos=-0.0998 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S17
[S16] cosine check vs S17: cos=0.5391
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.0000 head_norm=1.021728
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.264423e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.090958 delta_norm=0.726442
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.196 → S15@127.0.0.1:44615
[S6] ⇄ pheromone p=0.094 → S4@127.0.0.1:44604
[S4] ⇄ pheromone p=0.040 → S5@127.0.0.1:44605
[S13] ⇄ pheromone p=0.136 → S14@127.0.0.1:44614
[S3] ⇄ pheromone p=0.216 → S14@127.0.0.1:44614
[S11] ⇄ pheromone p=0.252 → S16@127.0.0.1:44616
[S5] ⇄ pheromone p=0.120 → S9@127.0.0.1:44610
[S8] ⇄ pheromone p=0.200 → S4@127.0.0.1:44604
[S2] ⇄ pheromone p=0.240 → S16@127.0.0.1:44616
[S15] ⇄ pheromone p=0.236 → S8@127.0.0.1:44609
[S7] ⇄ pheromone p=0.269 → S16@127.0.0.1:44616
[S10] ⇄ pheromone p=0.241 → S9@127.0.0.1:44610
[S9] ⇄ pheromone p=0.271 → S14@127.0.0.1:44614
[S16] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.0406 head_norm=1.231566
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.287077e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.0211 head_norm=0.948074 delta_norm=0.428708
[S16] aggregate: ROLLBACK (f1_val pre=0.041 post=0.021 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.122 → S15@127.0.0.1:44615
[S17] ⇄ pheromone p=0.178 → S16@127.0.0.1:44616
[S2] START round=16 head_norm_before_train=1.658211 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.2537096672349561, 'auprc': 0.2537096672349561, 'loss_val': 2.334215278676901, 'psi': 0.2537096672349561}-{'f1_val': 0.25884984866429794, 'auprc': 0.25884984866429794, 'loss_val': 2.3563456304578065, 'psi': 0.25884984866429794}
[S3] START round=16 head_norm_before_train=1.626465 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.7765005622411327, 'psi': 0.2979423868312757}-{'f1_val': 0.29802414928649834, 'auprc': 0.29802414928649834, 'loss_val': 2.470241747589205, 'psi': 0.29802414928649834}
[S4] START round=16 head_norm_before_train=1.641208 (no previous merge yet)
[S4] round=16 local utility u=0.011211 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4506921725001047, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4731139116599932, 'psi': 0.0}
[S5] START round=16 head_norm_before_train=1.400292 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.20108485083301045, 'auprc': 0.20108485083301045, 'loss_val': 1.1801260487906022, 'psi': 0.20108485083301045}-{'f1_val': 0.20162538699690402, 'auprc': 0.20162538699690402, 'loss_val': 1.173691692808195, 'psi': 0.20162538699690402}
[S6] START round=16 head_norm_before_train=1.655075 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.688828342027336, 'psi': 0.017551963048498844}-{'f1_val': 0.025873808443032227, 'auprc': 0.025873808443032227, 'loss_val': 5.175688161984813, 'psi': 0.025873808443032227}
[S7] START round=16 head_norm_before_train=1.443158 (no previous merge yet)
[S7] round=16 local utility u=0.212993 metrics={'f1_val': 0.32947492031538334, 'auprc': 0.32947492031538334, 'loss_val': 1.3039399621229875, 'psi': 0.32947492031538334}-{'f1_val': 0.28609296601344314, 'auprc': 0.28609296601344314, 'loss_val': 1.3394882510600041, 'psi': 0.28609296601344314}
[S8] START round=16 head_norm_before_train=1.530970 (no previous merge yet)
[S8] round=16 local utility u=0.072558 metrics={'f1_val': 0.3746134686004372, 'auprc': 0.3746134686004372, 'loss_val': 0.9270549641318006, 'psi': 0.3746134686004372}-{'f1_val': 0.3633323650045286, 'auprc': 0.3633323650045286, 'loss_val': 0.9706417481487009, 'psi': 0.3633323650045286}
[S9] START round=16 head_norm_before_train=1.546572 (no previous merge yet)
[S9] round=16 local utility u=0.587061 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1746139267322886, 'psi': 0.36867172340800847}-{'f1_val': 0.2455583009765855, 'auprc': 0.2455583009765855, 'loss_val': 2.2407157433028617, 'psi': 0.2455583009765855}
[S10] START round=16 head_norm_before_train=1.521307 (no previous merge yet)
[S10] round=16 local utility u=0.596507 metrics={'f1_val': 0.33277471869762987, 'auprc': 0.33277471869762987, 'loss_val': 3.0472150213279923, 'psi': 0.33277471869762987}-{'f1_val': 0.2056837366347777, 'auprc': 0.2056837366347777, 'loss_val': 3.096410143969946, 'psi': 0.2056837366347777}
[S11] START round=16 head_norm_before_train=1.556366 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.3314728682170543, 'auprc': 0.3314728682170543, 'loss_val': 2.3805406891801395, 'psi': 0.3314728682170543}-{'f1_val': 0.3315508021390374, 'auprc': 0.3315508021390374, 'loss_val': 2.0517105473871253, 'psi': 0.3315508021390374}
[S13] START round=16 head_norm_before_train=1.412466 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.24025513819985825, 'auprc': 0.24025513819985825, 'loss_val': 1.1132223362959455, 'psi': 0.24025513819985825}-{'f1_val': 0.2404255319148936, 'auprc': 0.2404255319148936, 'loss_val': 1.0912319447986787, 'psi': 0.2404255319148936}
[S14] START round=16 head_norm_before_train=1.090958 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.230819 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9888614962707967, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4504997879709474, 'psi': 0.0}
[S15] START round=16 head_norm_before_train=1.544835 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.08328726736686935, 'auprc': 0.08328726736686935, 'loss_val': 1.1330726664998183, 'psi': 0.08328726736686935}-{'f1_val': 0.21451013996001142, 'auprc': 0.21451013996001142, 'loss_val': 1.0841741947928514, 'psi': 0.21451013996001145}
[S16] START round=16 head_norm_before_train=0.948074 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.223488 metrics={'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 2.2974538927874413, 'psi': 0.08899598393574297}-{'f1_val': 0.04062064156206416, 'auprc': 0.04062064156206416, 'loss_val': 2.3090523599789026, 'psi': 0.04062064156206416}
[S17] START round=16 head_norm_before_train=1.554470 (no previous merge yet)
[S17] round=16 local utility u=0.037646 metrics={'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.0873014585298253, 'psi': 0.1522581895716224}-{'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.1636576262279046, 'psi': 0.15237633365664405}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:44614
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:44604
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44610
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.089)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.2063
[S14] RECEIVED delta(kind=head bytes=1804) from S9
[S14] cosine check vs S9: cos=0.8819
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=-0.0096
[S9] DROPPED delta from S10 (cos=-0.0096 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S8
[S4] cosine check vs S8: cos=-0.0397
[S4] DROPPED delta from S8 (cos=-0.0397 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S17
[S16] cosine check vs S17: cos=0.5719
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.0000 head_norm=1.107626
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.966578e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.0000 head_norm=1.301855 delta_norm=0.396658
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.0890 head_norm=0.996263
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.944642e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.0890 head_norm=0.918527 delta_norm=0.494464
[S16] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.684316 (no previous merge yet)
[S2] round=17 local utility u=0.501639 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3548476098124715, 'psi': 0.3674775928297055}-{'f1_val': 0.2537096672349561, 'auprc': 0.2537096672349561, 'loss_val': 2.334215278676901, 'psi': 0.2537096672349561}
[S3] START round=17 head_norm_before_train=1.652390 (no previous merge yet)
[S3] round=17 local utility u=0.051044 metrics={'f1_val': 0.29798919301975374, 'auprc': 0.29798919301975374, 'loss_val': 2.6748337691723396, 'psi': 0.29798919301975374}-{'f1_val': 0.2979423868312757, 'auprc': 0.2979423868312757, 'loss_val': 2.7765005622411327, 'psi': 0.2979423868312757}
[S4] START round=17 head_norm_before_train=1.672370 (no previous merge yet)
[S4] round=17 local utility u=0.016169 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4183540345355008, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4506921725001047, 'psi': 0.0}
[S5] START round=17 head_norm_before_train=1.419134 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.0007388935069733075, 'auprc': 0.0007388935069733075, 'loss_val': 1.2649239507125978, 'psi': 0.0007388935069733075}-{'f1_val': 0.20108485083301045, 'auprc': 0.20108485083301045, 'loss_val': 1.1801260487906022, 'psi': 0.20108485083301045}
[S6] START round=17 head_norm_before_train=1.675988 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.913654380893504, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.688828342027336, 'psi': 0.017551963048498844}
[S7] START round=17 head_norm_before_train=1.464761 (no previous merge yet)
[S7] round=17 local utility u=0.059020 metrics={'f1_val': 0.3332503939620138, 'auprc': 0.3332503939620138, 'loss_val': 1.2198785724750791, 'psi': 0.3332503939620138}-{'f1_val': 0.32947492031538334, 'auprc': 0.32947492031538334, 'loss_val': 1.3039399621229875, 'psi': 0.32947492031538334}
[S8] START round=17 head_norm_before_train=1.560641 (no previous merge yet)
[S8] round=17 local utility u=0.308300 metrics={'f1_val': 0.43896265634810866, 'auprc': 0.43896265634810866, 'loss_val': 0.8895968934806421, 'psi': 0.4389626563481086}-{'f1_val': 0.3746134686004372, 'auprc': 0.3746134686004372, 'loss_val': 0.9270549641318006, 'psi': 0.3746134686004372}
[S9] START round=17 head_norm_before_train=1.574006 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2032157527966834, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1746139267322886, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.537895 (no previous merge yet)
[S10] round=17 local utility u=0.023166 metrics={'f1_val': 0.33277471869762987, 'auprc': 0.33277471869762987, 'loss_val': 3.0008826377554074, 'psi': 0.33277471869762987}-{'f1_val': 0.33277471869762987, 'auprc': 0.33277471869762987, 'loss_val': 3.0472150213279923, 'psi': 0.33277471869762987}
[S11] START round=17 head_norm_before_train=1.580736 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.3269142595139844, 'auprc': 0.3269142595139844, 'loss_val': 2.346772960437497, 'psi': 0.3269142595139844}-{'f1_val': 0.3314728682170543, 'auprc': 0.3314728682170543, 'loss_val': 2.3805406891801395, 'psi': 0.3314728682170543}
[S13] START round=17 head_norm_before_train=1.437607 (no previous merge yet)
[S13] round=17 local utility u=0.517536 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1552804591937154, 'psi': 0.3599362944611573}-{'f1_val': 0.24025513819985825, 'auprc': 0.24025513819985825, 'loss_val': 1.1132223362959455, 'psi': 0.24025513819985825}
[S14] START round=17 head_norm_before_train=1.301855 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.074469 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8399244394528498, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9888614962707967, 'psi': 0.0}
[S15] START round=17 head_norm_before_train=1.570819 (no previous merge yet)
[S15] round=17 local utility u=0.363053 metrics={'f1_val': 0.1580722891566265, 'auprc': 0.1580722891566265, 'loss_val': 1.0800322221470948, 'psi': 0.1580722891566265}-{'f1_val': 0.08328726736686935, 'auprc': 0.08328726736686935, 'loss_val': 1.1330726664998183, 'psi': 0.08328726736686935}
[S16] START round=17 head_norm_before_train=0.918527 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.05027885027885028, 'auprc': 0.05027885027885028, 'loss_val': 2.4818017873661766, 'psi': 0.05027885027885028}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 2.2974538927874413, 'psi': 0.08899598393574297}
[S17] START round=17 head_norm_before_train=1.574868 (no previous merge yet)
[S17] round=17 local utility u=0.255344 metrics={'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 1.0333878204415252, 'psi': 0.20301091942882987}-{'f1_val': 0.1522581895716224, 'auprc': 0.1522581895716224, 'loss_val': 1.0873014585298253, 'psi': 0.1522581895716224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44610
[S14] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:44616
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:44609
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.4967
[S16] RECEIVED delta(kind=head bytes=1805) from S2
[S16] cosine check vs S2: cos=0.4151
[S4] RECEIVED delta(kind=head bytes=1800) from S8
[S4] cosine check vs S8: cos=-0.0353
[S4] DROPPED delta from S8 (cos=-0.0353 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S3
[S14] cosine check vs S3: cos=0.2463
[S14] RECEIVED delta(kind=head bytes=1796) from S13
[S14] cosine check vs S13: cos=0.1061
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=-0.0091
[S9] DROPPED delta from S10 (cos=-0.0091 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S15
[S8] cosine check vs S15: cos=-0.0978
[S8] DROPPED delta from S15 (cos=-0.0978 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=0.7498
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.0000 head_norm=1.313442
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.615861e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.0000 head_norm=0.976571 delta_norm=0.761586
[S14] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.0503 head_norm=0.975952
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.560961e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.0550 head_norm=0.945274 delta_norm=0.156096
[S16] aggregate: ACCEPT kept=['S7', 'S2', 'S17'] (k=3/3) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.707307 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.2620285219245635, 'auprc': 0.2620285219245635, 'loss_val': 2.4906872871894956, 'psi': 0.2620285219245635}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3548476098124715, 'psi': 0.3674775928297055}
[S3] START round=18 head_norm_before_train=1.680331 (no previous merge yet)
[S3] round=18 local utility u=0.056188 metrics={'f1_val': 0.2983400628084343, 'auprc': 0.2983400628084343, 'loss_val': 2.5656164352887303, 'psi': 0.2983400628084343}-{'f1_val': 0.29798919301975374, 'auprc': 0.29798919301975374, 'loss_val': 2.6748337691723396, 'psi': 0.29798919301975374}
[S4] START round=18 head_norm_before_train=1.700024 (no previous merge yet)
[S4] round=18 local utility u=0.010456 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3974422361719614, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4183540345355008, 'psi': 0.0}
[S5] START round=18 head_norm_before_train=1.438975 (no previous merge yet)
[S5] round=18 local utility u=0.568529 metrics={'f1_val': 0.1770007391115518, 'auprc': 0.1770007391115518, 'loss_val': 1.7142227577454492, 'psi': 0.1770007391115518}-{'f1_val': 0.0007388935069733075, 'auprc': 0.0007388935069733075, 'loss_val': 1.2649239507125978, 'psi': 0.0007388935069733075}
[S6] START round=18 head_norm_before_train=1.696631 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.088562860642948, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.913654380893504, 'psi': 0.017551963048498844}
[S7] START round=18 head_norm_before_train=1.486934 (no previous merge yet)
[S7] round=18 local utility u=0.042137 metrics={'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 1.135605736940391, 'psi': 0.3332504352151206}-{'f1_val': 0.3332503939620138, 'auprc': 0.3332503939620138, 'loss_val': 1.2198785724750791, 'psi': 0.3332503939620138}
[S8] START round=18 head_norm_before_train=1.595278 (no previous merge yet)
[S8] round=18 local utility u=0.710375 metrics={'f1_val': 0.5930687387865322, 'auprc': 0.5930687387865322, 'loss_val': 0.8558011314100065, 'psi': 0.5930687387865322}-{'f1_val': 0.43896265634810866, 'auprc': 0.43896265634810866, 'loss_val': 0.8895968934806421, 'psi': 0.4389626563481086}
[S9] START round=18 head_norm_before_train=1.599144 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2529218843618746, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2032157527966834, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.558264 (no previous merge yet)
[S10] round=18 local utility u=0.030601 metrics={'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 2.94040048652023, 'psi': 0.3328546353917345}-{'f1_val': 0.33277471869762987, 'auprc': 0.33277471869762987, 'loss_val': 3.0008826377554074, 'psi': 0.33277471869762987}
[S11] START round=18 head_norm_before_train=1.606864 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.624461049423894, 'psi': 0.33154997286190585}-{'f1_val': 0.3269142595139844, 'auprc': 0.3269142595139844, 'loss_val': 2.346772960437497, 'psi': 0.3269142595139844}
[S13] START round=18 head_norm_before_train=1.461881 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1815673956750028, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1552804591937154, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=0.976571 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.465925399356738, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8399244394528498, 'psi': 0.0}
[S15] START round=18 head_norm_before_train=1.596838 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.014823965410747375, 'auprc': 0.014823965410747375, 'loss_val': 1.1771514187910166, 'psi': 0.014823965410747375}-{'f1_val': 0.1580722891566265, 'auprc': 0.1580722891566265, 'loss_val': 1.0800322221470948, 'psi': 0.1580722891566265}
[S16] START round=18 head_norm_before_train=0.945274 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.0435537046677078, 'auprc': 0.0435537046677078, 'loss_val': 2.548488077817791, 'psi': 0.0435537046677078}-{'f1_val': 0.05027885027885028, 'auprc': 0.05027885027885028, 'loss_val': 2.4818017873661766, 'psi': 0.05027885027885028}
[S17] START round=18 head_norm_before_train=1.597010 (no previous merge yet)
[S17] round=18 local utility u=0.020958 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9911180911203837, 'psi': 0.20297157622739018}-{'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 1.0333878204415252, 'psi': 0.20301091942882987}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:44610
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:44614
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44610
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.4981
[S14] RECEIVED delta(kind=head bytes=1804) from S3
[S14] cosine check vs S3: cos=0.6143
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=-0.0758
[S9] DROPPED delta from S5 (cos=-0.0758 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1806) from S10
[S9] cosine check vs S10: cos=-0.0083
[S9] DROPPED delta from S10 (cos=-0.0083 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1805) from S8
[S4] cosine check vs S8: cos=-0.0324
[S4] DROPPED delta from S8 (cos=-0.0324 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] cosine check vs S17: cos=0.7126
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.0000 head_norm=1.006149
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.739802e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.0000 head_norm=1.228626 delta_norm=0.673980
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.0436 head_norm=1.002778
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.964737e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.0444 head_norm=1.021323 delta_norm=0.296474
[S16] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.727510 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.2497824194952132, 'auprc': 0.2497824194952132, 'loss_val': 2.4562454375344545, 'psi': 0.2497824194952132}-{'f1_val': 0.2620285219245635, 'auprc': 0.2620285219245635, 'loss_val': 2.4906872871894956, 'psi': 0.2620285219245635}
[S3] START round=19 head_norm_before_train=1.707397 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.29866099139842156, 'auprc': 0.29866099139842156, 'loss_val': 2.9490675866934533, 'psi': 0.29866099139842156}-{'f1_val': 0.2983400628084343, 'auprc': 0.2983400628084343, 'loss_val': 2.5656164352887303, 'psi': 0.2983400628084343}
[S4] START round=19 head_norm_before_train=1.723113 (no previous merge yet)
[S4] round=19 local utility u=1.000000 metrics={'f1_val': 0.2505012134641764, 'auprc': 0.2505012134641764, 'loss_val': 1.3823025771553448, 'psi': 0.2505012134641764}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3974422361719614, 'psi': 0.0}
[S5] START round=19 head_norm_before_train=1.462883 (no previous merge yet)
[S5] round=19 local utility u=0.458640 metrics={'f1_val': 0.33451112575104336, 'auprc': 0.33451112575104336, 'loss_val': 2.214535715629622, 'psi': 0.33451112575104336}-{'f1_val': 0.1770007391115518, 'auprc': 0.1770007391115518, 'loss_val': 1.7142227577454492, 'psi': 0.1770007391115518}
[S6] START round=19 head_norm_before_train=1.715526 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.23232190229901, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.088562860642948, 'psi': 0.017551963048498844}
[S7] START round=19 head_norm_before_train=1.508582 (no previous merge yet)
[S7] round=19 local utility u=0.024064 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0859864024486134, 'psi': 0.33308476261496395}-{'f1_val': 0.3332504352151206, 'auprc': 0.3332504352151206, 'loss_val': 1.135605736940391, 'psi': 0.3332504352151206}
[S8] START round=19 head_norm_before_train=1.628706 (no previous merge yet)
[S8] round=19 local utility u=0.338531 metrics={'f1_val': 0.665567539218079, 'auprc': 0.665567539218079, 'loss_val': 0.8312282074348502, 'psi': 0.665567539218079}-{'f1_val': 0.5930687387865322, 'auprc': 0.5930687387865322, 'loss_val': 0.8558011314100065, 'psi': 0.5930687387865322}
[S9] START round=19 head_norm_before_train=1.620908 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.307934536813718, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2529218843618746, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.578257 (no previous merge yet)
[S10] round=19 local utility u=0.039022 metrics={'f1_val': 0.33277498604131767, 'auprc': 0.33277498604131767, 'loss_val': 2.861638710468967, 'psi': 0.33277498604131767}-{'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 2.94040048652023, 'psi': 0.3328546353917345}
[S11] START round=19 head_norm_before_train=1.627261 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.692206001337959, 'psi': 0.3317042898145993}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.624461049423894, 'psi': 0.33154997286190585}
[S13] START round=19 head_norm_before_train=1.483731 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2354423734825077, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1815673956750028, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.228626 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.716030334098418, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.465925399356738, 'psi': 0.0}
[S15] START round=19 head_norm_before_train=1.622143 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.005015673981191223, 'auprc': 0.005015673981191223, 'loss_val': 1.169582972092124, 'psi': 0.005015673981191223}-{'f1_val': 0.014823965410747375, 'auprc': 0.014823965410747375, 'loss_val': 1.1771514187910166, 'psi': 0.014823965410747375}
[S16] START round=19 head_norm_before_train=1.021323 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.218228 metrics={'f1_val': 0.0889745442865173, 'auprc': 0.0889745442865173, 'loss_val': 2.5208199104909457, 'psi': 0.0889745442865173}-{'f1_val': 0.0435537046677078, 'auprc': 0.0435537046677078, 'loss_val': 2.548488077817791, 'psi': 0.0435537046677078}
[S17] START round=19 head_norm_before_train=1.619072 (no previous merge yet)
[S17] round=19 local utility u=0.024854 metrics={'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 0.9410554925294075, 'psi': 0.20293224827229864}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9911180911203837, 'psi': 0.20297157622739018}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:44604
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:44605
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] → sending delta(kind=head bytes=1808) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44610
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[S16] not sending this round → trigger blocked (psi=0.089)
[S7] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1808 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.5990
[S9] RECEIVED delta(kind=head bytes=1808) from S5
[S9] cosine check vs S5: cos=-0.0755
[S9] DROPPED delta from S5 (cos=-0.0755 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=-0.0073
[S9] DROPPED delta from S10 (cos=-0.0073 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S4
[S5] cosine check vs S4: cos=-0.0093
[S5] DROPPED delta from S4 (cos=-0.0093 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S8
[S4] cosine check vs S8: cos=-0.0305
[S4] DROPPED delta from S8 (cos=-0.0305 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S17
[S16] cosine check vs S17: cos=0.7585
[S11] r=20 psi=0.332 u=0.0000 p_local=0.1031 f1=0.332 auprc=0.332 bytes=3604
[S3] r=20 psi=0.299 u=0.0000 p_local=0.1039 f1=0.299 auprc=0.299 bytes=5402
[S14] r=20 psi=0.000 u=0.0000 p_local=0.1134 f1=0.000 auprc=0.000 bytes=0
[S9] r=20 psi=0.369 u=0.0000 p_local=0.1713 f1=0.369 auprc=0.369 bytes=5403
[S2] r=20 psi=0.250 u=0.0000 p_local=0.1626 f1=0.250 auprc=0.250 bytes=7204
[S15] r=20 psi=0.005 u=0.0000 p_local=0.1431 f1=0.005 auprc=0.005 bytes=7202
[S13] r=20 psi=0.360 u=0.0000 p_local=0.1220 f1=0.360 auprc=0.360 bytes=7185
[S6] r=20 psi=0.018 u=0.0000 p_local=0.0387 f1=0.018 auprc=0.018 bytes=0
[S10] r=20 psi=0.333 u=0.0390 p_local=0.1754 f1=0.333 auprc=0.333 bytes=9008
[S5] r=20 psi=0.335 u=0.4586 p_local=0.2320 f1=0.335 auprc=0.335 bytes=14401
[S8] r=20 psi=0.666 u=0.3385 p_local=0.3103 f1=0.666 auprc=0.666 bytes=19820
[S7] r=20 psi=0.333 u=0.0241 p_local=0.1510 f1=0.333 auprc=0.333 bytes=8992
[S4] r=20 psi=0.251 u=1.0000 p_local=0.2211 f1=0.251 auprc=0.251 bytes=1802
[S17] r=20 psi=0.203 u=0.0249 p_local=0.1177 f1=0.203 auprc=0.203 bytes=17997
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.0890 head_norm=1.076869
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.780685e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.0890 head_norm=1.093990 delta_norm=0.178068
[S16] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] r=20 psi=0.089 u=0.2182 p_local=0.1164 f1=0.089 auprc=0.089 bytes=0
[S2] START round=20 head_norm_before_train=1.746935 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.24973584436571572, 'auprc': 0.24973584436571572, 'loss_val': 2.505801707087766, 'psi': 0.24973584436571572}-{'f1_val': 0.2497824194952132, 'auprc': 0.2497824194952132, 'loss_val': 2.4562454375344545, 'psi': 0.2497824194952132}
[S3] START round=20 head_norm_before_train=1.732704 (no previous merge yet)
[S3] round=20 local utility u=0.033426 metrics={'f1_val': 0.2959848297468876, 'auprc': 0.2959848297468876, 'loss_val': 2.858130681556672, 'psi': 0.2959848297468876}-{'f1_val': 0.29866099139842156, 'auprc': 0.29866099139842156, 'loss_val': 2.9490675866934533, 'psi': 0.29866099139842156}
[S4] START round=20 head_norm_before_train=1.750250 (no previous merge yet)
[S4] round=20 local utility u=0.387505 metrics={'f1_val': 0.33299492385786805, 'auprc': 0.33299492385786805, 'loss_val': 1.3497357713316283, 'psi': 0.33299492385786805}-{'f1_val': 0.2505012134641764, 'auprc': 0.2505012134641764, 'loss_val': 1.3823025771553448, 'psi': 0.2505012134641764}
[S5] START round=20 head_norm_before_train=1.489892 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.33459436738125264, 'auprc': 0.33459436738125264, 'loss_val': 2.4313370017364018, 'psi': 0.33459436738125264}-{'f1_val': 0.33451112575104336, 'auprc': 0.33451112575104336, 'loss_val': 2.214535715629622, 'psi': 0.33451112575104336}
[S6] START round=20 head_norm_before_train=1.733634 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.341855179093567, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.23232190229901, 'psi': 0.017551963048498844}
[S7] START round=20 head_norm_before_train=1.531542 (no previous merge yet)
[S7] round=20 local utility u=0.025032 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0359231117050816, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0859864024486134, 'psi': 0.33308476261496395}
[S8] START round=20 head_norm_before_train=1.658587 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.6566934264254, 'auprc': 0.6566934264254, 'loss_val': 0.8154525883442293, 'psi': 0.6566934264254}-{'f1_val': 0.665567539218079, 'auprc': 0.665567539218079, 'loss_val': 0.8312282074348502, 'psi': 0.665567539218079}
[S9] START round=20 head_norm_before_train=1.640651 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3565890979625332, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.307934536813718, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.599836 (no previous merge yet)
[S10] round=20 local utility u=0.034563 metrics={'f1_val': 0.332695374800638, 'auprc': 0.332695374800638, 'loss_val': 2.791796834163979, 'psi': 0.332695374800638}-{'f1_val': 0.33277498604131767, 'auprc': 0.33277498604131767, 'loss_val': 2.861638710468967, 'psi': 0.33277498604131767}
[S11] START round=20 head_norm_before_train=1.648836 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.6940694224314563, 'psi': 0.33154997286190585}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.692206001337959, 'psi': 0.3317042898145993}
[S13] START round=20 head_norm_before_train=1.507202 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2589032338146104, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2354423734825077, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.254104 cos_to_last_merge=0.9962 (last merge round=18)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0434442090481113, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.716030334098418, 'psi': 0.0}
[S15] START round=20 head_norm_before_train=1.651362 (no previous merge yet)
[S15] round=20 local utility u=1.000000 metrics={'f1_val': 0.3600347023754273, 'auprc': 0.3600347023754273, 'loss_val': 1.1416240988836868, 'psi': 0.3600347023754273}-{'f1_val': 0.005015673981191223, 'auprc': 0.005015673981191223, 'loss_val': 1.169582972092124, 'psi': 0.005015673981191223}
[S16] START round=20 head_norm_before_train=1.093990 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.05977710233029382, 'auprc': 0.05977710233029382, 'loss_val': 2.6617658426570157, 'psi': 0.05977710233029382}-{'f1_val': 0.0889745442865173, 'auprc': 0.0889745442865173, 'loss_val': 2.5208199104909457, 'psi': 0.0889745442865173}
[S17] START round=20 head_norm_before_train=1.643424 (no previous merge yet)
[S17] round=20 local utility u=0.019270 metrics={'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 0.9025156178906508, 'psi': 0.20293224827229864}-{'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 0.9410554925294075, 'psi': 0.20293224827229864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44610
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44609
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:44614
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.6318
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=-0.0066
[S9] DROPPED delta from S10 (cos=-0.0066 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=-0.0937
[S8] DROPPED delta from S15 (cos=-0.0937 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S3
[S14] cosine check vs S3: cos=0.9153
[S5] RECEIVED delta(kind=head bytes=1803) from S4
[S5] cosine check vs S4: cos=-0.0095
[S5] DROPPED delta from S4 (cos=-0.0095 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=0.7632
[S2] ⇄ pheromone p=0.130 → S16@127.0.0.1:44616
[S5] ⇄ pheromone p=0.186 → S9@127.0.0.1:44610
[S6] ⇄ pheromone p=0.031 → S4@127.0.0.1:44604
[S3] ⇄ pheromone p=0.090 → S14@127.0.0.1:44614
[S8] ⇄ pheromone p=0.248 → S4@127.0.0.1:44604
[S9] ⇄ pheromone p=0.137 → S14@127.0.0.1:44614
[S7] ⇄ pheromone p=0.126 → S16@127.0.0.1:44616
[S13] ⇄ pheromone p=0.098 → S14@127.0.0.1:44614
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.0000 head_norm=1.285988
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.879992e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.0000 head_norm=1.488661 delta_norm=0.387999
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.091 → S15@127.0.0.1:44615
[S15] ⇄ pheromone p=0.314 → S8@127.0.0.1:44609
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.0598 head_norm=1.146448
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.306503e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.0605 head_norm=1.144288 delta_norm=0.130650
[S16] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.093 → S15@127.0.0.1:44615
[S4] ⇄ pheromone p=0.254 → S5@127.0.0.1:44605
[S11] ⇄ pheromone p=0.082 → S16@127.0.0.1:44616
[S17] ⇄ pheromone p=0.098 → S16@127.0.0.1:44616
[S10] ⇄ pheromone p=0.147 → S9@127.0.0.1:44610
[S2] START round=21 head_norm_before_train=1.764988 (no previous merge yet)
[S2] round=21 local utility u=0.000906 metrics={'f1_val': 0.25692179806893023, 'auprc': 0.25692179806893023, 'loss_val': 2.5686627607684733, 'psi': 0.25692179806893023}-{'f1_val': 0.24973584436571572, 'auprc': 0.24973584436571572, 'loss_val': 2.505801707087766, 'psi': 0.24973584436571572}
[S3] START round=21 head_norm_before_train=1.754863 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.298324913586812, 'auprc': 0.298324913586812, 'loss_val': 3.0715661695828707, 'psi': 0.298324913586812}-{'f1_val': 0.2959848297468876, 'auprc': 0.2959848297468876, 'loss_val': 2.858130681556672, 'psi': 0.2959848297468876}
[S4] START round=21 head_norm_before_train=1.774218 (no previous merge yet)
[S4] round=21 local utility u=0.014602 metrics={'f1_val': 0.3309835515273582, 'auprc': 0.3309835515273582, 'loss_val': 1.302430325585009, 'psi': 0.3309835515273582}-{'f1_val': 0.33299492385786805, 'auprc': 0.33299492385786805, 'loss_val': 1.3497357713316283, 'psi': 0.33299492385786805}
[S5] START round=21 head_norm_before_train=1.514621 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.432826251747717, 'psi': 0.33409214683912186}-{'f1_val': 0.33459436738125264, 'auprc': 0.33459436738125264, 'loss_val': 2.4313370017364018, 'psi': 0.33459436738125264}
[S6] START round=21 head_norm_before_train=1.750244 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.436176141026958, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.341855179093567, 'psi': 0.017551963048498844}
[S7] START round=21 head_norm_before_train=1.557258 (no previous merge yet)
[S7] round=21 local utility u=0.039719 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.9564849209422498, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0359231117050816, 'psi': 0.33308476261496395}
[S8] START round=21 head_norm_before_train=1.688156 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.23944414751469803, 'auprc': 0.23944414751469803, 'loss_val': 0.8035713821433744, 'psi': 0.239444147514698}-{'f1_val': 0.6566934264254, 'auprc': 0.6566934264254, 'loss_val': 0.8154525883442293, 'psi': 0.6566934264254}
[S9] START round=21 head_norm_before_train=1.658493 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3949078216827537, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3565890979625332, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.624411 (no previous merge yet)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.24958143984692657, 'auprc': 0.24958143984692657, 'loss_val': 2.7154988594180476, 'psi': 0.2495814398469266}-{'f1_val': 0.332695374800638, 'auprc': 0.332695374800638, 'loss_val': 2.791796834163979, 'psi': 0.332695374800638}
[S11] START round=21 head_norm_before_train=1.672525 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.7721382645713133, 'psi': 0.3317042898145993}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 2.6940694224314563, 'psi': 0.33154997286190585}
[S13] START round=21 head_norm_before_train=1.529995 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.302096954043077, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2589032338146104, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.488661 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.526474 metrics={'f1_val': 0.10045061960195269, 'auprc': 0.10045061960195269, 'loss_val': 2.894551643268717, 'psi': 0.10045061960195269}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0434442090481113, 'psi': 0.0}
[S15] START round=21 head_norm_before_train=1.680790 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.3487167483289375, 'auprc': 0.3487167483289375, 'loss_val': 1.1632747370464476, 'psi': 0.3487167483289375}-{'f1_val': 0.3600347023754273, 'auprc': 0.3600347023754273, 'loss_val': 1.1416240988836868, 'psi': 0.3600347023754273}
[S16] START round=21 head_norm_before_train=1.144288 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.184131 metrics={'f1_val': 0.08911368015414257, 'auprc': 0.08911368015414257, 'loss_val': 2.5575330815349644, 'psi': 0.08911368015414257}-{'f1_val': 0.05977710233029382, 'auprc': 0.05977710233029382, 'loss_val': 2.6617658426570157, 'psi': 0.05977710233029382}
[S17] START round=21 head_norm_before_train=1.664979 (no previous merge yet)
[S17] round=21 local utility u=0.006123 metrics={'f1_val': 0.20344470344470345, 'auprc': 0.20344470344470345, 'loss_val': 0.8948812915116819, 'psi': 0.20344470344470345}-{'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 0.9025156178906508, 'psi': 0.20293224827229864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44616
[S2] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S2
[S16] cosine check vs S2: cos=0.0960
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[S14] not sending this round → trigger blocked (psi=0.100)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:44605
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.089)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44616
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1807) from S4
[S5] cosine check vs S4: cos=-0.0093
[S5] DROPPED delta from S4 (cos=-0.0093 < 0.0)
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=0.6475
[S17] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S17
[S16] cosine check vs S17: cos=0.7601
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.0891 head_norm=1.194034
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.100331e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.0891 head_norm=1.054384 delta_norm=0.310033
[S16] aggregate: ACCEPT kept=['S2', 'S7', 'S17'] (k=3/3) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.781250 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.26040651990388985, 'auprc': 0.26040651990388985, 'loss_val': 2.6456649408145703, 'psi': 0.26040651990388985}-{'f1_val': 0.25692179806893023, 'auprc': 0.25692179806893023, 'loss_val': 2.5686627607684733, 'psi': 0.25692179806893023}
[S3] START round=22 head_norm_before_train=1.771836 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.29493571241144056, 'auprc': 0.29493571241144056, 'loss_val': 3.059211639903837, 'psi': 0.29493571241144056}-{'f1_val': 0.298324913586812, 'auprc': 0.298324913586812, 'loss_val': 3.0715661695828707, 'psi': 0.298324913586812}
[S4] START round=22 head_norm_before_train=1.796686 (no previous merge yet)
[S4] round=22 local utility u=0.130923 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.272878413579645, 'psi': 0.3567939207526687}-{'f1_val': 0.3309835515273582, 'auprc': 0.3309835515273582, 'loss_val': 1.302430325585009, 'psi': 0.3309835515273582}
[S5] START round=22 head_norm_before_train=1.533875 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.5269967249715752, 'psi': 0.33409214683912186}-{'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.432826251747717, 'psi': 0.33409214683912186}
[S6] START round=22 head_norm_before_train=1.765379 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.50473216156287, 'psi': 0.017774699907663897}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.436176141026958, 'psi': 0.017551963048498844}
[S7] START round=22 head_norm_before_train=1.578604 (no previous merge yet)
[S7] round=22 local utility u=0.029921 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.8966422576767458, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.9564849209422498, 'psi': 0.33308476261496395}
[S8] START round=22 head_norm_before_train=1.712054 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.23944414751469803, 'auprc': 0.23944414751469803, 'loss_val': 0.8070674915355899, 'psi': 0.239444147514698}-{'f1_val': 0.23944414751469803, 'auprc': 0.23944414751469803, 'loss_val': 0.8035713821433744, 'psi': 0.239444147514698}
[S9] START round=22 head_norm_before_train=1.674284 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.425235664653115, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3949078216827537, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.653434 (no previous merge yet)
[S10] round=22 local utility u=0.033980 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.6470012244953587, 'psi': 0.24952175992348158}-{'f1_val': 0.24958143984692657, 'auprc': 0.24958143984692657, 'loss_val': 2.7154988594180476, 'psi': 0.2495814398469266}
[S11] START round=22 head_norm_before_train=1.694749 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.331858063514248, 'auprc': 0.331858063514248, 'loss_val': 2.923043796645455, 'psi': 0.331858063514248}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.7721382645713133, 'psi': 0.3317042898145993}
[S13] START round=22 head_norm_before_train=1.549020 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.325074767820175, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.302096954043077, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.512893 cos_to_last_merge=0.9983 (last merge round=20)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.343944791410607, 'psi': 0.13582554517133957}-{'f1_val': 0.10045061960195269, 'auprc': 0.10045061960195269, 'loss_val': 2.894551643268717, 'psi': 0.10045061960195269}
[S15] START round=22 head_norm_before_train=1.706357 (no previous merge yet)
[S15] round=22 local utility u=0.500735 metrics={'f1_val': 0.45144857426795754, 'auprc': 0.45144857426795754, 'loss_val': 1.0863910476092673, 'psi': 0.4514485742679575}-{'f1_val': 0.3487167483289375, 'auprc': 0.3487167483289375, 'loss_val': 1.1632747370464476, 'psi': 0.3487167483289375}
[S16] START round=22 head_norm_before_train=1.054384 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.08706166868198308, 'auprc': 0.08706166868198308, 'loss_val': 2.675631780193523, 'psi': 0.08706166868198308}-{'f1_val': 0.08911368015414257, 'auprc': 0.08911368015414257, 'loss_val': 2.5575330815349644, 'psi': 0.08911368015414257}
[S17] START round=22 head_norm_before_train=1.690238 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 0.9049030428329193, 'psi': 0.20293224827229864}-{'f1_val': 0.20344470344470345, 'auprc': 0.20344470344470345, 'loss_val': 0.8948812915116819, 'psi': 0.20344470344470345}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44609
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S15
[S8] cosine check vs S15: cos=-0.0904
[S8] DROPPED delta from S15 (cos=-0.0904 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=-0.0055
[S9] DROPPED delta from S10 (cos=-0.0055 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.5938
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S4
[S5] cosine check vs S4: cos=-0.0096
[S5] DROPPED delta from S4 (cos=-0.0096 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.0871 head_norm=1.106231
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.464732e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.0002 head_norm=1.210587 delta_norm=0.646473
[S16] aggregate: ROLLBACK (f1_val pre=0.087 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.795490 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.24890045220838752, 'auprc': 0.24890045220838752, 'loss_val': 2.6175913978986043, 'psi': 0.24890045220838752}-{'f1_val': 0.26040651990388985, 'auprc': 0.26040651990388985, 'loss_val': 2.6456649408145703, 'psi': 0.26040651990388985}
[S3] START round=23 head_norm_before_train=1.786124 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.29745275267050125, 'auprc': 0.29745275267050125, 'loss_val': 3.3508761803519906, 'psi': 0.29745275267050125}-{'f1_val': 0.29493571241144056, 'auprc': 0.29493571241144056, 'loss_val': 3.059211639903837, 'psi': 0.29493571241144056}
[S4] START round=23 head_norm_before_train=1.815301 (no previous merge yet)
[S4] round=23 local utility u=0.010548 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2517831808509017, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.272878413579645, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.548463 (no previous merge yet)
[S5] round=23 local utility u=0.079221 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.3640311015933237, 'psi': 0.33358943696313936}-{'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 2.5269967249715752, 'psi': 0.33409214683912186}
[S6] START round=23 head_norm_before_train=1.778619 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.6084198367235105, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.50473216156287, 'psi': 0.017774699907663897}
[S7] START round=23 head_norm_before_train=1.594726 (no previous merge yet)
[S7] round=23 local utility u=0.022852 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.8509391053572234, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.8966422576767458, 'psi': 0.33308476261496395}
[S8] START round=23 head_norm_before_train=1.733784 (no previous merge yet)
[S8] round=23 local utility u=0.530999 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8246226588518786, 'psi': 0.35939447907390915}-{'f1_val': 0.23944414751469803, 'auprc': 0.23944414751469803, 'loss_val': 0.8070674915355899, 'psi': 0.239444147514698}
[S9] START round=23 head_norm_before_train=1.688145 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4518721776967562, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.425235664653115, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.686041 (no previous merge yet)
[S10] round=23 local utility u=0.055478 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.536045661183193, 'psi': 0.24952175992348158}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.6470012244953587, 'psi': 0.24952175992348158}
[S11] START round=23 head_norm_before_train=1.715173 (no previous merge yet)
[S11] round=23 local utility u=0.063356 metrics={'f1_val': 0.32512165450121655, 'auprc': 0.32512165450121655, 'loss_val': 2.73570496883624, 'psi': 0.32512165450121655}-{'f1_val': 0.331858063514248, 'auprc': 0.331858063514248, 'loss_val': 2.923043796645455, 'psi': 0.331858063514248}
[S13] START round=23 head_norm_before_train=1.569597 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3745634470178898, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.325074767820175, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.545518 cos_to_last_merge=0.9935 (last merge round=20)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.11336453458138325, 'auprc': 0.11336453458138325, 'loss_val': 3.760934751213471, 'psi': 0.11336453458138325}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.343944791410607, 'psi': 0.13582554517133957}
[S15] START round=23 head_norm_before_train=1.733825 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.44656396900599377, 'auprc': 0.44656396900599377, 'loss_val': 1.0855706225233872, 'psi': 0.4465639690059938}-{'f1_val': 0.45144857426795754, 'auprc': 0.45144857426795754, 'loss_val': 1.0863910476092673, 'psi': 0.4514485742679575}
[S16] START round=23 head_norm_before_train=1.210587 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.004433361041839845, 'auprc': 0.004433361041839845, 'loss_val': 2.5785865937767722, 'psi': 0.004433361041839845}-{'f1_val': 0.08706166868198308, 'auprc': 0.08706166868198308, 'loss_val': 2.675631780193523, 'psi': 0.08706166868198308}
[S17] START round=23 head_norm_before_train=1.711107 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.20329998345234912, 'auprc': 0.20329998345234912, 'loss_val': 0.9306575694215597, 'psi': 0.20329998345234912}-{'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 0.9049030428329193, 'psi': 0.20293224827229864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44610
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44610
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=0.0624
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.9116
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.0761
[S9] DROPPED delta from S5 (cos=-0.0761 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=-0.0053
[S9] DROPPED delta from S10 (cos=-0.0053 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S8
[S4] cosine check vs S8: cos=-0.0267
[S4] DROPPED delta from S8 (cos=-0.0267 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] cosine check vs S4: cos=-0.0096
[S5] DROPPED delta from S4 (cos=-0.0096 < 0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.0044 head_norm=1.247827
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.150501e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.0000 head_norm=1.116690 delta_norm=0.515050
[S16] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.808568 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.2514235654840123, 'auprc': 0.2514235654840123, 'loss_val': 2.6447934683185452, 'psi': 0.2514235654840123}-{'f1_val': 0.24890045220838752, 'auprc': 0.24890045220838752, 'loss_val': 2.6175913978986043, 'psi': 0.24890045220838752}
[S3] START round=24 head_norm_before_train=1.800223 (no previous merge yet)
[S3] round=24 local utility u=0.039231 metrics={'f1_val': 0.29769959404600815, 'auprc': 0.29769959404600815, 'loss_val': 3.274636246750613, 'psi': 0.29769959404600815}-{'f1_val': 0.29745275267050125, 'auprc': 0.29745275267050125, 'loss_val': 3.3508761803519906, 'psi': 0.29745275267050125}
[S4] START round=24 head_norm_before_train=1.829612 (no previous merge yet)
[S4] round=24 local utility u=0.004693 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2423965155964474, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2517831808509017, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.560003 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.4515715165423306, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.3640311015933237, 'psi': 0.33358943696313936}
[S6] START round=24 head_norm_before_train=1.790626 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.765519560874436, 'psi': 0.017551963048498844}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.6084198367235105, 'psi': 0.017774699907663897}
[S7] START round=24 head_norm_before_train=1.607407 (no previous merge yet)
[S7] round=24 local utility u=0.009806 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.831327759460701, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.8509391053572234, 'psi': 0.33308476261496395}
[S8] START round=24 head_norm_before_train=1.757005 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8574325730046379, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8246226588518786, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.700771 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.477774918408596, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4518721776967562, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.717524 (no previous merge yet)
[S10] round=24 local utility u=0.023021 metrics={'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.4900044459483452, 'psi': 0.24952175992348158}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.536045661183193, 'psi': 0.24952175992348158}
[S11] START round=24 head_norm_before_train=1.732470 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.331858063514248, 'auprc': 0.331858063514248, 'loss_val': 3.012273356061332, 'psi': 0.331858063514248}-{'f1_val': 0.32512165450121655, 'auprc': 0.32512165450121655, 'loss_val': 2.73570496883624, 'psi': 0.32512165450121655}
[S13] START round=24 head_norm_before_train=1.587015 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.411705836750972, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3745634470178898, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.581911 cos_to_last_merge=0.9869 (last merge round=20)
[S14] round=24 local utility u=0.009206 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.9437978298703493, 'psi': 0.13572854291417166}-{'f1_val': 0.11336453458138325, 'auprc': 0.11336453458138325, 'loss_val': 3.760934751213471, 'psi': 0.11336453458138325}
[S15] START round=24 head_norm_before_train=1.759733 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.4398151502207404, 'auprc': 0.4398151502207404, 'loss_val': 1.095606412080034, 'psi': 0.43981515022074036}-{'f1_val': 0.44656396900599377, 'auprc': 0.44656396900599377, 'loss_val': 1.0855706225233872, 'psi': 0.4465639690059938}
[S16] START round=24 head_norm_before_train=1.116690 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.030758 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4771712462782554, 'psi': 0.0}-{'f1_val': 0.004433361041839845, 'auprc': 0.004433361041839845, 'loss_val': 2.5785865937767722, 'psi': 0.004433361041839845}
[S17] START round=24 head_norm_before_train=1.731450 (no previous merge yet)
[S17] round=24 local utility u=0.023943 metrics={'f1_val': 0.20513404684112735, 'auprc': 0.20513404684112735, 'loss_val': 0.8992782632931479, 'psi': 0.20513404684112735}-{'f1_val': 0.20329998345234912, 'auprc': 0.20329998345234912, 'loss_val': 0.9306575694215597, 'psi': 0.20329998345234912}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44610
[S16] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.8726
[S14] RECEIVED delta(kind=head bytes=1801) from S3
[S14] cosine check vs S3: cos=0.9412
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] cosine check vs S10: cos=-0.0051
[S9] DROPPED delta from S10 (cos=-0.0051 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] cosine check vs S4: cos=-0.0102
[S5] DROPPED delta from S4 (cos=-0.0102 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] cosine check vs S17: cos=0.2423
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.1357 head_norm=1.617869
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.096057e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.1359 head_norm=1.690206 delta_norm=0.309606
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.0000 head_norm=1.151350
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.123688e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.0442 head_norm=1.107093 delta_norm=0.412369
[S16] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.820578 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.2615343704294642, 'auprc': 0.2615343704294642, 'loss_val': 2.7482692862884646, 'psi': 0.2615343704294642}-{'f1_val': 0.2514235654840123, 'auprc': 0.2514235654840123, 'loss_val': 2.6447934683185452, 'psi': 0.2514235654840123}
[S3] START round=25 head_norm_before_train=1.813230 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.298292902066487, 'auprc': 0.298292902066487, 'loss_val': 3.291502300647017, 'psi': 0.298292902066487}-{'f1_val': 0.29769959404600815, 'auprc': 0.29769959404600815, 'loss_val': 3.274636246750613, 'psi': 0.29769959404600815}
[S4] START round=25 head_norm_before_train=1.847741 (no previous merge yet)
[S4] round=25 local utility u=0.004983 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.23243015932158, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2423965155964474, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.573686 (no previous merge yet)
[S5] round=25 local utility u=0.096719 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.2581330985055614, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.4515715165423306, 'psi': 0.33358943696313936}
[S6] START round=25 head_norm_before_train=1.801960 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.911240066453145, 'psi': 0.01732902033271719}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.765519560874436, 'psi': 0.017551963048498844}
[S7] START round=25 head_norm_before_train=1.616789 (no previous merge yet)
[S7] round=25 local utility u=0.014158 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.8030116168414791, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.831327759460701, 'psi': 0.33308476261496395}
[S8] START round=25 head_norm_before_train=1.777488 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8946507756726501, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8574325730046379, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.712555 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5014025341842108, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.477774918408596, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.742353 (no previous merge yet)
[S10] round=25 local utility u=0.042076 metrics={'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 2.405315048052115, 'psi': 0.2494621085345446}-{'f1_val': 0.24952175992348158, 'auprc': 0.24952175992348158, 'loss_val': 2.4900044459483452, 'psi': 0.24952175992348158}
[S11] START round=25 head_norm_before_train=1.748174 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.331858063514248, 'auprc': 0.331858063514248, 'loss_val': 3.0473280171182155, 'psi': 0.331858063514248}-{'f1_val': 0.331858063514248, 'auprc': 0.331858063514248, 'loss_val': 3.012273356061332, 'psi': 0.331858063514248}
[S13] START round=25 head_norm_before_train=1.600505 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.469232598906127, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.411705836750972, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.690206 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.296487 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.3516971839746112, 'psi': 0.13582554517133957}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.9437978298703493, 'psi': 0.13572854291417166}
[S15] START round=25 head_norm_before_train=1.784894 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.3392648381042464, 'auprc': 0.3392648381042464, 'loss_val': 1.1785475183866296, 'psi': 0.3392648381042464}-{'f1_val': 0.4398151502207404, 'auprc': 0.4398151502207404, 'loss_val': 1.095606412080034, 'psi': 0.43981515022074036}
[S16] START round=25 head_norm_before_train=1.107093 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.02449928469241774, 'auprc': 0.02449928469241774, 'loss_val': 2.769486151088571, 'psi': 0.02449928469241774}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4771712462782554, 'psi': 0.0}
[S17] START round=25 head_norm_before_train=1.745081 (no previous merge yet)
[S17] round=25 local utility u=0.279960 metrics={'f1_val': 0.25917900002042726, 'auprc': 0.25917900002042726, 'loss_val': 0.8257620160519412, 'psi': 0.25917900002042726}-{'f1_val': 0.20513404684112735, 'auprc': 0.20513404684112735, 'loss_val': 0.8992782632931479, 'psi': 0.20513404684112735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44610
[S14] not sending this round → trigger blocked (psi=0.136)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44610
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.8111
[S9] RECEIVED delta(kind=head bytes=1796) from S10
[S9] cosine check vs S10: cos=-0.0051
[S9] DROPPED delta from S10 (cos=-0.0051 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=-0.0774
[S9] DROPPED delta from S5 (cos=-0.0774 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] cosine check vs S4: cos=-0.0111
[S5] DROPPED delta from S4 (cos=-0.0111 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=0.5504
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.010 → S4@127.0.0.1:44604
[S2] ⇄ pheromone p=0.043 → S16@127.0.0.1:44616
[S7] ⇄ pheromone p=0.055 → S16@127.0.0.1:44616
[S10] ⇄ pheromone p=0.071 → S9@127.0.0.1:44610
[S4] ⇄ pheromone p=0.101 → S5@127.0.0.1:44605
[S9] ⇄ pheromone p=0.045 → S14@127.0.0.1:44614
[S3] ⇄ pheromone p=0.036 → S14@127.0.0.1:44614
[S8] ⇄ pheromone p=0.149 → S4@127.0.0.1:44604
[S14] ⇄ pheromone p=0.134 → S15@127.0.0.1:44615
[S15] ⇄ pheromone p=0.154 → S8@127.0.0.1:44609
[S13] ⇄ pheromone p=0.032 → S14@127.0.0.1:44614
[S11] ⇄ pheromone p=0.035 → S16@127.0.0.1:44616
[S5] ⇄ pheromone p=0.090 → S9@127.0.0.1:44610
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.0245 head_norm=1.152577
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.120985e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.0332 head_norm=1.167873 delta_norm=0.212098
[S16] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.051 → S15@127.0.0.1:44615
[S17] ⇄ pheromone p=0.092 → S16@127.0.0.1:44616
[S2] START round=26 head_norm_before_train=1.831923 (no previous merge yet)
[S2] round=26 local utility u=0.000587 metrics={'f1_val': 0.2573166826769132, 'auprc': 0.2573166826769132, 'loss_val': 2.7091351645500064, 'psi': 0.2573166826769132}-{'f1_val': 0.2615343704294642, 'auprc': 0.2615343704294642, 'loss_val': 2.7482692862884646, 'psi': 0.2615343704294642}
[S3] START round=26 head_norm_before_train=1.827088 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.29775948788294465, 'auprc': 0.29775948788294465, 'loss_val': 3.6185171461513317, 'psi': 0.29775948788294465}-{'f1_val': 0.298292902066487, 'auprc': 0.298292902066487, 'loss_val': 3.291502300647017, 'psi': 0.298292902066487}
[S4] START round=26 head_norm_before_train=1.863018 (no previous merge yet)
[S4] round=26 local utility u=0.005372 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2216855410243912, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.23243015932158, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.585168 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.496732972543418, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.2581330985055614, 'psi': 0.33358943696313936}
[S6] START round=26 head_norm_before_train=1.812521 (no previous merge yet)
[S6] round=26 local utility u=0.005455 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.902336251492054, 'psi': 0.017551963048498844}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.911240066453145, 'psi': 0.01732902033271719}
[S7] START round=26 head_norm_before_train=1.628806 (no previous merge yet)
[S7] round=26 local utility u=0.007035 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7881961701314218, 'psi': 0.3330019880715706}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.8030116168414791, 'psi': 0.33308476261496395}
[S8] START round=26 head_norm_before_train=1.793198 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9433439624610086, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8946507756726501, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.723505 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.52571882016198, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5014025341842108, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.768413 (no previous merge yet)
[S10] round=26 local utility u=0.069054 metrics={'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 2.2672074813693466, 'psi': 0.2494621085345446}-{'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 2.405315048052115, 'psi': 0.2494621085345446}
[S11] START round=26 head_norm_before_train=1.764125 (no previous merge yet)
[S11] round=26 local utility u=0.147140 metrics={'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.679833678102069, 'psi': 0.3237230419977299}-{'f1_val': 0.331858063514248, 'auprc': 0.331858063514248, 'loss_val': 3.0473280171182155, 'psi': 0.331858063514248}
[S13] START round=26 head_norm_before_train=1.614600 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4920338576366534, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.469232598906127, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.719027 cos_to_last_merge=0.9993 (last merge round=24)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13273115042027347, 'auprc': 0.13273115042027347, 'loss_val': 3.6506355481982085, 'psi': 0.13273115042027347}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.3516971839746112, 'psi': 0.13582554517133957}
[S15] START round=26 head_norm_before_train=1.808668 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.302908875037103, 'auprc': 0.302908875037103, 'loss_val': 1.3045531068452096, 'psi': 0.302908875037103}-{'f1_val': 0.3392648381042464, 'auprc': 0.3392648381042464, 'loss_val': 1.1785475183866296, 'psi': 0.3392648381042464}
[S16] START round=26 head_norm_before_train=1.167873 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.03799019607843137, 'auprc': 0.03799019607843137, 'loss_val': 2.9731537646935142, 'psi': 0.03799019607843137}-{'f1_val': 0.02449928469241774, 'auprc': 0.02449928469241774, 'loss_val': 2.769486151088571, 'psi': 0.02449928469241774}
[S17] START round=26 head_norm_before_train=1.757989 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.21399211578638888, 'auprc': 0.21399211578638888, 'loss_val': 0.8193076077005783, 'psi': 0.21399211578638888}-{'f1_val': 0.25917900002042726, 'auprc': 0.25917900002042726, 'loss_val': 0.8257620160519412, 'psi': 0.25917900002042726}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:44605
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.018)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44616
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:44616
[S4] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S2
[S16] cosine check vs S2: cos=0.0662
[S5] RECEIVED delta(kind=head bytes=1802) from S4
[S5] cosine check vs S4: cos=-0.0123
[S5] DROPPED delta from S4 (cos=-0.0123 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.7465
[S16] RECEIVED delta(kind=head bytes=1793) from S11
[S16] cosine check vs S11: cos=0.1122
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=-0.0053
[S9] DROPPED delta from S10 (cos=-0.0053 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.0380 head_norm=1.212671
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.891488e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.0147 head_norm=0.978555 delta_norm=0.589149
[S16] aggregate: ROLLBACK (f1_val pre=0.038 post=0.015 tol_abs=0.005 tol_rel=0.0)
[S2] START round=27 head_norm_before_train=1.842445 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.2493174484983867, 'auprc': 0.2493174484983867, 'loss_val': 2.707899532294662, 'psi': 0.2493174484983867}-{'f1_val': 0.2573166826769132, 'auprc': 0.2573166826769132, 'loss_val': 2.7091351645500064, 'psi': 0.2573166826769132}
[S3] START round=27 head_norm_before_train=1.840943 (no previous merge yet)
[S3] round=27 local utility u=0.205269 metrics={'f1_val': 0.29146162479495813, 'auprc': 0.29146162479495813, 'loss_val': 3.151298803208166, 'psi': 0.29146162479495813}-{'f1_val': 0.29775948788294465, 'auprc': 0.29775948788294465, 'loss_val': 3.6185171461513317, 'psi': 0.29775948788294465}
[S4] START round=27 head_norm_before_train=1.876128 (no previous merge yet)
[S4] round=27 local utility u=0.003642 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.214401196231504, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2216855410243912, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.598436 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.556451978338976, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.496732972543418, 'psi': 0.33358943696313936}
[S6] START round=27 head_norm_before_train=1.822664 (no previous merge yet)
[S6] round=27 local utility u=0.066852 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 6.802460219549173, 'psi': 0.021310724106324473}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.902336251492054, 'psi': 0.017551963048498844}
[S7] START round=27 head_norm_before_train=1.642951 (no previous merge yet)
[S7] round=27 local utility u=0.000449 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7872990655582507, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7881961701314218, 'psi': 0.3330019880715706}
[S8] START round=27 head_norm_before_train=1.810150 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9807447922464554, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9433439624610086, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.733999 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5528691840158175, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.52571882016198, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.794646 (no previous merge yet)
[S10] round=27 local utility u=0.139879 metrics={'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.9879881402722415, 'psi': 0.24952198852772467}-{'f1_val': 0.2494621085345446, 'auprc': 0.2494621085345446, 'loss_val': 2.2672074813693466, 'psi': 0.2494621085345446}
[S11] START round=27 head_norm_before_train=1.776621 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.018831924426137, 'psi': 0.33154997286190585}-{'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.679833678102069, 'psi': 0.3237230419977299}
[S13] START round=27 head_norm_before_train=1.623978 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5203917421714155, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4920338576366534, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.748517 cos_to_last_merge=0.9976 (last merge round=24)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 3.8826296846562998, 'psi': 0.1355297641332834}-{'f1_val': 0.13273115042027347, 'auprc': 0.13273115042027347, 'loss_val': 3.6506355481982085, 'psi': 0.13273115042027347}
[S15] START round=27 head_norm_before_train=1.830284 (no previous merge yet)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.49351860655381713, 'auprc': 0.49351860655381713, 'loss_val': 0.959897946411543, 'psi': 0.49351860655381713}-{'f1_val': 0.302908875037103, 'auprc': 0.302908875037103, 'loss_val': 1.3045531068452096, 'psi': 0.302908875037103}
[S16] START round=27 head_norm_before_train=0.978555 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.459564 metrics={'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 2.5130788043007946, 'psi': 0.08899598393574297}-{'f1_val': 0.03799019607843137, 'auprc': 0.03799019607843137, 'loss_val': 2.9731537646935142, 'psi': 0.03799019607843137}
[S17] START round=27 head_norm_before_train=1.770933 (no previous merge yet)
[S17] round=27 local utility u=0.449820 metrics={'f1_val': 0.3142074679736025, 'auprc': 0.3142074679736025, 'loss_val': 0.8216062042830186, 'psi': 0.3142074679736025}-{'f1_val': 0.21399211578638888, 'auprc': 0.21399211578638888, 'loss_val': 0.8193076077005783, 'psi': 0.21399211578638888}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44610
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:44605
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44614
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:44609
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] cosine check vs S3: cos=0.9699
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.7176
[S9] RECEIVED delta(kind=head bytes=1796) from S10
[S9] cosine check vs S10: cos=-0.0056
[S9] DROPPED delta from S10 (cos=-0.0056 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S4
[S5] cosine check vs S4: cos=-0.0140
[S5] DROPPED delta from S4 (cos=-0.0140 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S15
[S8] cosine check vs S15: cos=-0.0809
[S8] DROPPED delta from S15 (cos=-0.0809 < 0.0)
[S16] not sending this round → trigger blocked (psi=0.089)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S17
[S16] cosine check vs S17: cos=0.4518
[S6] not sending this round → trigger blocked (psi=0.021)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.1355 head_norm=1.775532
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.260552e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.1359 head_norm=1.800575 delta_norm=0.226055
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.0890 head_norm=1.024608
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.708958e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.0890 head_norm=1.077757 delta_norm=0.370896
[S16] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.852086 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.7415228587463494, 'psi': 0.245119570522206}-{'f1_val': 0.2493174484983867, 'auprc': 0.2493174484983867, 'loss_val': 2.707899532294662, 'psi': 0.2493174484983867}
[S3] START round=28 head_norm_before_train=1.853058 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.2976157851466155, 'auprc': 0.2976157851466155, 'loss_val': 3.627191920912831, 'psi': 0.2976157851466155}-{'f1_val': 0.29146162479495813, 'auprc': 0.29146162479495813, 'loss_val': 3.151298803208166, 'psi': 0.29146162479495813}
[S4] START round=28 head_norm_before_train=1.891667 (no previous merge yet)
[S4] round=28 local utility u=0.003733 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2069348509830784, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.214401196231504, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=1.612675 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.676033267955425, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.556451978338976, 'psi': 0.33358943696313936}
[S6] START round=28 head_norm_before_train=1.831916 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 7.141963150817066, 'psi': 0.017105871474803514}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 6.802460219549173, 'psi': 0.021310724106324473}
[S7] START round=28 head_norm_before_train=1.661502 (no previous merge yet)
[S7] round=28 local utility u=0.013396 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7605068185224031, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7872990655582507, 'psi': 0.3330019880715706}
[S8] START round=28 head_norm_before_train=1.826105 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0199883967807497, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9807447922464554, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.743711 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.580319894018242, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5528691840158175, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.821627 (no previous merge yet)
[S10] round=28 local utility u=0.224295 metrics={'f1_val': 0.2527127102863867, 'auprc': 0.2527127102863867, 'loss_val': 1.5681155627629733, 'psi': 0.2527127102863867}-{'f1_val': 0.24952198852772467, 'auprc': 0.24952198852772467, 'loss_val': 1.9879881402722415, 'psi': 0.24952198852772467}
[S11] START round=28 head_norm_before_train=1.785545 (no previous merge yet)
[S11] round=28 local utility u=0.090262 metrics={'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.7685275955852995, 'psi': 0.3237965485921889}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.018831924426137, 'psi': 0.33154997286190585}
[S13] START round=28 head_norm_before_train=1.637677 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5460241610967176, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5203917421714155, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.800575 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.179513 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.5262655674638963, 'psi': 0.13582554517133957}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 3.8826296846562998, 'psi': 0.1355297641332834}
[S15] START round=28 head_norm_before_train=1.853393 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.302908875037103, 'auprc': 0.302908875037103, 'loss_val': 1.2545205572457832, 'psi': 0.302908875037103}-{'f1_val': 0.49351860655381713, 'auprc': 0.49351860655381713, 'loss_val': 0.959897946411543, 'psi': 0.49351860655381713}
[S16] START round=28 head_norm_before_train=1.077757 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 2.639287054246011, 'psi': 0.08953068592057761}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 2.5130788043007946, 'psi': 0.08899598393574297}
[S17] START round=28 head_norm_before_train=1.785267 (no previous merge yet)
[S17] round=28 local utility u=0.056854 metrics={'f1_val': 0.3281739884891101, 'auprc': 0.3281739884891101, 'loss_val': 0.8335962570097214, 'psi': 0.3281739884891101}-{'f1_val': 0.3142074679736025, 'auprc': 0.3142074679736025, 'loss_val': 0.8216062042830186, 'psi': 0.3142074679736025}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:44609
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S4
[S8] cosine check vs S4: cos=-0.0260
[S8] DROPPED delta from S4 (cos=-0.0260 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=29 head_norm_before_train=1.861066 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.765266079049635, 'psi': 0.24507471790179935}-{'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.7415228587463494, 'psi': 0.245119570522206}
[S3] START round=29 head_norm_before_train=1.863373 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.2976157851466155, 'auprc': 0.2976157851466155, 'loss_val': 3.6478693348416975, 'psi': 0.2976157851466155}-{'f1_val': 0.2976157851466155, 'auprc': 0.2976157851466155, 'loss_val': 3.627191920912831, 'psi': 0.2976157851466155}
[S4] START round=29 head_norm_before_train=1.904655 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.208485949160908, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2069348509830784, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=1.633375 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.7274137517154404, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.676033267955425, 'psi': 0.33358943696313936}
[S6] START round=29 head_norm_before_train=1.840460 (no previous merge yet)
[S6] round=29 local utility u=0.190094 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 6.807502048884227, 'psi': 0.022186642268984445}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 7.141963150817066, 'psi': 0.017105871474803514}
[S7] START round=29 head_norm_before_train=1.677912 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.713214781155221, 'psi': 0.24962705121829937}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7605068185224031, 'psi': 0.3330019880715706}
[S8] START round=29 head_norm_before_train=1.838611 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0808579934752416, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0199883967807497, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.753131 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.608067272868171, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.580319894018242, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.851698 (no previous merge yet)
[S10] round=29 local utility u=0.050770 metrics={'f1_val': 0.26531576707112997, 'auprc': 0.26531576707112997, 'loss_val': 1.58000395074653, 'psi': 0.26531576707112997}-{'f1_val': 0.2527127102863867, 'auprc': 0.2527127102863867, 'loss_val': 1.5681155627629733, 'psi': 0.2527127102863867}
[S11] START round=29 head_norm_before_train=1.793074 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0375465166381503, 'psi': 0.33154997286190585}-{'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 2.7685275955852995, 'psi': 0.3237965485921889}
[S13] START round=29 head_norm_before_train=1.649685 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5891335519766794, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5460241610967176, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.823513 cos_to_last_merge=0.9997 (last merge round=27)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.7901755868752267, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.5262655674638963, 'psi': 0.13582554517133957}
[S15] START round=29 head_norm_before_train=1.871239 (no previous merge yet)
[S15] round=29 local utility u=0.756709 metrics={'f1_val': 0.44294536991221795, 'auprc': 0.44294536991221795, 'loss_val': 1.0014315856158744, 'psi': 0.44294536991221795}-{'f1_val': 0.302908875037103, 'auprc': 0.302908875037103, 'loss_val': 1.2545205572457832, 'psi': 0.302908875037103}
[S16] START round=29 head_norm_before_train=1.126117 cos_to_last_merge=0.9980 (last merge round=27)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 2.800655158625581, 'psi': 0.08953068592057761}-{'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 2.639287054246011, 'psi': 0.08953068592057761}
[S17] START round=29 head_norm_before_train=1.800684 (no previous merge yet)
[S17] round=29 local utility u=0.126746 metrics={'f1_val': 0.3603227008892912, 'auprc': 0.3603227008892912, 'loss_val': 0.8694432733624096, 'psi': 0.3603227008892912}-{'f1_val': 0.3281739884891101, 'auprc': 0.3281739884891101, 'loss_val': 0.8335962570097214, 'psi': 0.3281739884891101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44614
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0165
[S14] DROPPED delta from S15 (cos=-0.0165 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=30 head_norm_before_train=1.869842 (no previous merge yet)
[S2] round=30 local utility u=0.009931 metrics={'f1_val': 0.24830058089234952, 'auprc': 0.24830058089234952, 'loss_val': 2.7744377202818478, 'psi': 0.24830058089234952}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.765266079049635, 'psi': 0.24507471790179935}
[S3] START round=30 head_norm_before_train=1.873209 (no previous merge yet)
[S3] round=30 local utility u=0.186874 metrics={'f1_val': 0.2939536504617529, 'auprc': 0.2939536504617529, 'loss_val': 3.2411611429296707, 'psi': 0.2939536504617529}-{'f1_val': 0.2976157851466155, 'auprc': 0.2976157851466155, 'loss_val': 3.6478693348416975, 'psi': 0.2976157851466155}
[S4] START round=30 head_norm_before_train=1.920230 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2189283641856372, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.208485949160908, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.651053 (no previous merge yet)
[S5] round=30 local utility u=0.043257 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6363711924381166, 'psi': 0.33308623671855697}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.7274137517154404, 'psi': 0.33358943696313936}
[S6] START round=30 head_norm_before_train=1.848472 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.169866290017766, 'psi': 0.017551963048498844}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 6.807502048884227, 'psi': 0.022186642268984445}
[S7] START round=30 head_norm_before_train=1.690641 (no previous merge yet)
[S7] round=30 local utility u=0.016318 metrics={'f1_val': 0.24956456830057228, 'auprc': 0.24956456830057228, 'loss_val': 0.6800163450662661, 'psi': 0.24956456830057228}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.713214781155221, 'psi': 0.24962705121829937}
[S8] START round=30 head_norm_before_train=1.852296 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1548628537694599, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0808579934752416, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.762036 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.632447842061395, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.608067272868171, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.882065 (no previous merge yet)
[S10] round=30 local utility u=0.137936 metrics={'f1_val': 0.2707043504656758, 'auprc': 0.2707043504656758, 'loss_val': 1.3526285797185167, 'psi': 0.2707043504656758}-{'f1_val': 0.26531576707112997, 'auprc': 0.26531576707112997, 'loss_val': 1.58000395074653, 'psi': 0.26531576707112997}
[S11] START round=30 head_norm_before_train=1.802242 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0552306992687934, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0375465166381503, 'psi': 0.33154997286190585}
[S13] START round=30 head_norm_before_train=1.663036 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6377632100765873, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5891335519766794, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.847174 cos_to_last_merge=0.9989 (last merge round=27)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 4.016643629754952, 'psi': 0.1347331583552056}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.7901755868752267, 'psi': 0.13587634006482174}
[S15] START round=30 head_norm_before_train=1.890378 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.30626106443580403, 'auprc': 0.30626106443580403, 'loss_val': 1.121299984578326, 'psi': 0.30626106443580403}-{'f1_val': 0.44294536991221795, 'auprc': 0.44294536991221795, 'loss_val': 1.0014315856158744, 'psi': 0.44294536991221795}
[S16] START round=30 head_norm_before_train=1.172648 cos_to_last_merge=0.9934 (last merge round=27)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.08925274901677503, 'auprc': 0.08925274901677503, 'loss_val': 3.032896280102365, 'psi': 0.08925274901677503}-{'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 2.800655158625581, 'psi': 0.08953068592057761}
[S17] START round=30 head_norm_before_train=1.815866 (no previous merge yet)
[S17] round=30 local utility u=0.162823 metrics={'f1_val': 0.39673011180732504, 'auprc': 0.39673011180732504, 'loss_val': 0.8714645750861029, 'psi': 0.39673011180732504}-{'f1_val': 0.3603227008892912, 'auprc': 0.3603227008892912, 'loss_val': 0.8694432733624096, 'psi': 0.3603227008892912}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S5
[S4] cosine check vs S5: cos=-0.0195
[S4] DROPPED delta from S5 (cos=-0.0195 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.049 → S15@127.0.0.1:44615
[S5] ⇄ pheromone p=0.038 → S4@127.0.0.1:44604
[S14] ⇄ pheromone p=0.067 → S9@127.0.0.1:44610
[S15] ⇄ pheromone p=0.274 → S14@127.0.0.1:44614
[S9] ⇄ pheromone p=0.015 → S5@127.0.0.1:44605
[S16] ⇄ pheromone p=0.064 → S17@127.0.0.1:44617
[S4] ⇄ pheromone p=0.034 → S8@127.0.0.1:44609
[S17] ⇄ pheromone p=0.136 → S16@127.0.0.1:44616
[S2] START round=31 head_norm_before_train=1.878352 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.24936386768447838, 'auprc': 0.24936386768447838, 'loss_val': 2.791177924471666, 'psi': 0.24936386768447838}-{'f1_val': 0.24830058089234952, 'auprc': 0.24830058089234952, 'loss_val': 2.7744377202818478, 'psi': 0.24830058089234952}
[S3] START round=31 head_norm_before_train=1.882311 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.29775948788294465, 'auprc': 0.29775948788294465, 'loss_val': 3.769049122309045, 'psi': 0.29775948788294465}-{'f1_val': 0.2939536504617529, 'auprc': 0.2939536504617529, 'loss_val': 3.2411611429296707, 'psi': 0.2939536504617529}
[S4] START round=31 head_norm_before_train=1.933684 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.230412675986555, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2189283641856372, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.664814 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.706074584952419, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6363711924381166, 'psi': 0.33308623671855697}
[S6] START round=31 head_norm_before_train=1.856245 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 7.351565875686152, 'psi': 0.016882516188714152}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.169866290017766, 'psi': 0.017551963048498844}
[S7] START round=31 head_norm_before_train=1.697868 (no previous merge yet)
[S7] round=31 local utility u=0.369226 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6925011000912278, 'psi': 0.3330019880715706}-{'f1_val': 0.24956456830057228, 'auprc': 0.24956456830057228, 'loss_val': 0.6800163450662661, 'psi': 0.24956456830057228}
[S8] START round=31 head_norm_before_train=1.870897 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2289268663336308, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1548628537694599, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.770305 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.653993925418045, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.632447842061395, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.912778 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.25439058752355026, 'auprc': 0.25439058752355026, 'loss_val': 1.2690986598399017, 'psi': 0.25439058752355026}-{'f1_val': 0.2707043504656758, 'auprc': 0.2707043504656758, 'loss_val': 1.3526285797185167, 'psi': 0.2707043504656758}
[S11] START round=31 head_norm_before_train=1.812934 (no previous merge yet)
[S11] round=31 local utility u=0.013243 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0287449733451735, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0552306992687934, 'psi': 0.33154997286190585}
[S13] START round=31 head_norm_before_train=1.673565 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6643933291959812, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6377632100765873, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.869291 cos_to_last_merge=0.9978 (last merge round=27)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 4.207304619510421, 'psi': 0.1355297641332834}-{'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 4.016643629754952, 'psi': 0.1347331583552056}
[S15] START round=31 head_norm_before_train=1.907461 (no previous merge yet)
[S15] round=31 local utility u=1.000000 metrics={'f1_val': 0.5257925269774244, 'auprc': 0.5257925269774244, 'loss_val': 0.8695318293031359, 'psi': 0.5257925269774244}-{'f1_val': 0.30626106443580403, 'auprc': 0.30626106443580403, 'loss_val': 1.121299984578326, 'psi': 0.30626106443580403}
[S16] START round=31 head_norm_before_train=1.213006 cos_to_last_merge=0.9884 (last merge round=27)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.08901743391982003, 'auprc': 0.08901743391982003, 'loss_val': 3.2803903885765164, 'psi': 0.08901743391982003}-{'f1_val': 0.08925274901677503, 'auprc': 0.08925274901677503, 'loss_val': 3.032896280102365, 'psi': 0.08925274901677503}
[S17] START round=31 head_norm_before_train=1.827291 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.0121425186101904, 'psi': 0.30380970798684975}-{'f1_val': 0.39673011180732504, 'auprc': 0.39673011180732504, 'loss_val': 0.8714645750861029, 'psi': 0.39673011180732504}
[S3]  timeout peer S2
[S2]  timeout peer S3
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:44614
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=-0.0190
[S14] DROPPED delta from S15 (cos=-0.0190 < 0.0)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.886499 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.24927104659097957, 'auprc': 0.24927104659097957, 'loss_val': 2.8105796102624567, 'psi': 0.2492710465909796}-{'f1_val': 0.24936386768447838, 'auprc': 0.24936386768447838, 'loss_val': 2.791177924471666, 'psi': 0.24936386768447838}
[S3] START round=32 head_norm_before_train=1.890723 (no previous merge yet)
[S3] round=32 local utility u=0.185011 metrics={'f1_val': 0.2973838761345435, 'auprc': 0.2973838761345435, 'loss_val': 3.3956463952108233, 'psi': 0.2973838761345435}-{'f1_val': 0.29775948788294465, 'auprc': 0.29775948788294465, 'loss_val': 3.769049122309045, 'psi': 0.29775948788294465}
[S4] START round=32 head_norm_before_train=1.945595 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2322914331060104, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.230412675986555, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.675281 (no previous merge yet)
[S5] round=32 local utility u=0.008224 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6896257124701877, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.706074584952419, 'psi': 0.33308623671855697}
[S6] START round=32 head_norm_before_train=1.863576 (no previous merge yet)
[S6] round=32 local utility u=0.486915 metrics={'f1_val': 0.04744367417677643, 'auprc': 0.04744367417677643, 'loss_val': 6.652786272599998, 'psi': 0.04744367417677643}-{'f1_val': 0.016882516188714152, 'auprc': 0.016882516188714152, 'loss_val': 7.351565875686152, 'psi': 0.016882516188714152}
[S7] START round=32 head_norm_before_train=1.706341 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6974821187472311, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6925011000912278, 'psi': 0.3330019880715706}
[S8] START round=32 head_norm_before_train=1.890961 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2946315170009421, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2289268663336308, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.778378 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6741724231032853, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.653993925418045, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=1.942573 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.2403403863845446, 'auprc': 0.2403403863845446, 'loss_val': 1.187129277273175, 'psi': 0.2403403863845446}-{'f1_val': 0.25439058752355026, 'auprc': 0.25439058752355026, 'loss_val': 1.2690986598399017, 'psi': 0.25439058752355026}
[S11] START round=32 head_norm_before_train=1.824671 (no previous merge yet)
[S11] round=32 local utility u=0.006739 metrics={'f1_val': 0.3271364088440058, 'auprc': 0.3271364088440058, 'loss_val': 2.9755453348193557, 'psi': 0.3271364088440058}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.0287449733451735, 'psi': 0.33154997286190585}
[S13] START round=32 head_norm_before_train=1.685008 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.687878490964707, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6643933291959812, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.888638 cos_to_last_merge=0.9967 (last merge round=27)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.3609736170130216, 'psi': 0.13587634006482174}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 4.207304619510421, 'psi': 0.1355297641332834}
[S15] START round=32 head_norm_before_train=1.925620 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.3559628543070678, 'auprc': 0.3559628543070678, 'loss_val': 1.1293914152655344, 'psi': 0.3559628543070678}-{'f1_val': 0.5257925269774244, 'auprc': 0.5257925269774244, 'loss_val': 0.8695318293031359, 'psi': 0.5257925269774244}
[S16] START round=32 head_norm_before_train=1.247473 cos_to_last_merge=0.9839 (last merge round=27)
[S16] round=32 local utility u=0.036042 metrics={'f1_val': 0.08980835538449201, 'auprc': 0.08980835538449201, 'loss_val': 3.215424465293635, 'psi': 0.08980835538449201}-{'f1_val': 0.08901743391982003, 'auprc': 0.08901743391982003, 'loss_val': 3.2803903885765164, 'psi': 0.08901743391982003}
[S17] START round=32 head_norm_before_train=1.837756 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.21347480203012434, 'auprc': 0.21347480203012434, 'loss_val': 0.986682295416972, 'psi': 0.21347480203012434}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.0121425186101904, 'psi': 0.30380970798684975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44604
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.047)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S5
[S4] cosine check vs S5: cos=-0.0221
[S4] DROPPED delta from S5 (cos=-0.0221 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.894222 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.24922466195261136, 'auprc': 0.24922466195261136, 'loss_val': 2.829357813823546, 'psi': 0.24922466195261136}-{'f1_val': 0.24927104659097957, 'auprc': 0.24927104659097957, 'loss_val': 2.8105796102624567, 'psi': 0.2492710465909796}
[S3] START round=33 head_norm_before_train=1.898216 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.29746609564596715, 'auprc': 0.29746609564596715, 'loss_val': 3.4478721181168814, 'psi': 0.29746609564596715}-{'f1_val': 0.2973838761345435, 'auprc': 0.2973838761345435, 'loss_val': 3.3956463952108233, 'psi': 0.2973838761345435}
[S4] START round=33 head_norm_before_train=1.957250 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2338843460058466, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2322914331060104, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.688491 (no previous merge yet)
[S5] round=33 local utility u=0.010314 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.668997459569856, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6896257124701877, 'psi': 0.33308623671855697}
[S6] START round=33 head_norm_before_train=1.870167 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.023494525547445255, 'auprc': 0.023494525547445255, 'loss_val': 6.8544253605968475, 'psi': 0.023494525547445255}-{'f1_val': 0.04744367417677643, 'auprc': 0.04744367417677643, 'loss_val': 6.652786272599998, 'psi': 0.04744367417677643}
[S7] START round=33 head_norm_before_train=1.714423 (no previous merge yet)
[S7] round=33 local utility u=0.013968 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6695463356262642, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6974821187472311, 'psi': 0.3330019880715706}
[S8] START round=33 head_norm_before_train=1.909017 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3582551153088416, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2946315170009421, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=1.786008 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6935634591233044, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6741724231032853, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=1.969006 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.23509561304836896, 'auprc': 0.23509561304836896, 'loss_val': 1.1829002701840743, 'psi': 0.23509561304836896}-{'f1_val': 0.2403403863845446, 'auprc': 0.2403403863845446, 'loss_val': 1.187129277273175, 'psi': 0.2403403863845446}
[S11] START round=33 head_norm_before_train=1.836819 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.3314728682170543, 'auprc': 0.3314728682170543, 'loss_val': 3.0260395851127844, 'psi': 0.3314728682170543}-{'f1_val': 0.3271364088440058, 'auprc': 0.3271364088440058, 'loss_val': 2.9755453348193557, 'psi': 0.3271364088440058}
[S13] START round=33 head_norm_before_train=1.695438 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7010363572263665, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.687878490964707, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=1.905535 cos_to_last_merge=0.9956 (last merge round=27)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.492874586575973, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.3609736170130216, 'psi': 0.13587634006482174}
[S15] START round=33 head_norm_before_train=1.947155 (no previous merge yet)
[S15] round=33 local utility u=0.555777 metrics={'f1_val': 0.465056998940212, 'auprc': 0.465056998940212, 'loss_val': 0.9996851721075835, 'psi': 0.465056998940212}-{'f1_val': 0.3559628543070678, 'auprc': 0.3559628543070678, 'loss_val': 1.1293914152655344, 'psi': 0.3559628543070678}
[S16] START round=33 head_norm_before_train=1.277144 cos_to_last_merge=0.9800 (last merge round=27)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 3.22054405388973, 'psi': 0.09022435897435897}-{'f1_val': 0.08980835538449201, 'auprc': 0.08980835538449201, 'loss_val': 3.215424465293635, 'psi': 0.08980835538449201}
[S17] START round=33 head_norm_before_train=1.847218 (no previous merge yet)
[S17] round=33 local utility u=0.481622 metrics={'f1_val': 0.3185366503077137, 'auprc': 0.3185366503077137, 'loss_val': 0.9689946659160577, 'psi': 0.3185366503077137}-{'f1_val': 0.21347480203012434, 'auprc': 0.21347480203012434, 'loss_val': 0.986682295416972, 'psi': 0.21347480203012434}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44614
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:44604
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S5
[S4] cosine check vs S5: cos=-0.0249
[S4] DROPPED delta from S5 (cos=-0.0249 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S15
[S14] cosine check vs S15: cos=-0.0207
[S14] DROPPED delta from S15 (cos=-0.0207 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44616
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S17
[S16] cosine check vs S17: cos=0.6504
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.0902 head_norm=1.302268
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.055340e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.0915 head_norm=1.437912 delta_norm=0.705534
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.901489 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.2491782945736434, 'auprc': 0.2491782945736434, 'loss_val': 2.845113011920525, 'psi': 0.2491782945736434}-{'f1_val': 0.24922466195261136, 'auprc': 0.24922466195261136, 'loss_val': 2.829357813823546, 'psi': 0.24922466195261136}
[S3] START round=34 head_norm_before_train=1.905651 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.2975342465753425, 'auprc': 0.2975342465753425, 'loss_val': 3.7503119631510384, 'psi': 0.2975342465753425}-{'f1_val': 0.29746609564596715, 'auprc': 0.29746609564596715, 'loss_val': 3.4478721181168814, 'psi': 0.29746609564596715}
[S4] START round=34 head_norm_before_train=1.971066 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2358848879411166, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2338843460058466, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=1.709933 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6999753629932304, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.668997459569856, 'psi': 0.33308623671855697}
[S6] START round=34 head_norm_before_train=1.877078 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.241402306740364, 'psi': 0.017551963048498844}-{'f1_val': 0.023494525547445255, 'auprc': 0.023494525547445255, 'loss_val': 6.8544253605968475, 'psi': 0.023494525547445255}
[S7] START round=34 head_norm_before_train=1.722707 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6673297796149501, 'psi': 0.24962705121829937}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6695463356262642, 'psi': 0.3330019880715706}
[S8] START round=34 head_norm_before_train=1.922761 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4194338113100657, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3582551153088416, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.793331 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.709709819368236, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6935634591233044, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=1.993859 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.2308882015024304, 'auprc': 0.2308882015024304, 'loss_val': 1.1749848937519423, 'psi': 0.2308882015024304}-{'f1_val': 0.23509561304836896, 'auprc': 0.23509561304836896, 'loss_val': 1.1829002701840743, 'psi': 0.23509561304836896}
[S11] START round=34 head_norm_before_train=1.848204 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.1121320356972935, 'psi': 0.33154997286190585}-{'f1_val': 0.3314728682170543, 'auprc': 0.3314728682170543, 'loss_val': 3.0260395851127844, 'psi': 0.3314728682170543}
[S13] START round=34 head_norm_before_train=1.708234 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.73524155708607, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7010363572263665, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=1.920234 cos_to_last_merge=0.9946 (last merge round=27)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.600507488804392, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.492874586575973, 'psi': 0.13582554517133957}
[S15] START round=34 head_norm_before_train=1.970931 (no previous merge yet)
[S15] round=34 local utility u=0.489846 metrics={'f1_val': 0.5523089799354849, 'auprc': 0.5523089799354849, 'loss_val': 0.8052608105586762, 'psi': 0.5523089799354849}-{'f1_val': 0.465056998940212, 'auprc': 0.465056998940212, 'loss_val': 0.9996851721075835, 'psi': 0.465056998940212}
[S16] START round=34 head_norm_before_train=1.437912 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.08873884735953702, 'auprc': 0.08873884735953702, 'loss_val': 3.9681614058970904, 'psi': 0.08873884735953702}-{'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 3.22054405388973, 'psi': 0.09022435897435897}
[S17] START round=34 head_norm_before_train=1.853332 (no previous merge yet)
[S17] round=34 local utility u=0.392847 metrics={'f1_val': 0.39816410149443227, 'auprc': 0.39816410149443227, 'loss_val': 0.8999476669732627, 'psi': 0.39816410149443227}-{'f1_val': 0.3185366503077137, 'auprc': 0.3185366503077137, 'loss_val': 0.9689946659160577, 'psi': 0.3185366503077137}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:44614
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=-0.0211
[S14] DROPPED delta from S15 (cos=-0.0211 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S17
[S16] cosine check vs S17: cos=0.9356
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.0887 head_norm=1.457743
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.581828e-01
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.0890 head_norm=1.633482 delta_norm=0.358183
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.908163 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.24941030415890753, 'auprc': 0.24941030415890753, 'loss_val': 2.8599254711474162, 'psi': 0.24941030415890753}-{'f1_val': 0.2491782945736434, 'auprc': 0.2491782945736434, 'loss_val': 2.845113011920525, 'psi': 0.2491782945736434}
[S3] START round=35 head_norm_before_train=1.913473 (no previous merge yet)
[S3] round=35 local utility u=0.162849 metrics={'f1_val': 0.29588411941353115, 'auprc': 0.29588411941353115, 'loss_val': 3.4097622059201953, 'psi': 0.29588411941353115}-{'f1_val': 0.2975342465753425, 'auprc': 0.2975342465753425, 'loss_val': 3.7503119631510384, 'psi': 0.2975342465753425}
[S4] START round=35 head_norm_before_train=1.982944 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2438483988032003, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2358848879411166, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=1.730260 (no previous merge yet)
[S5] round=35 local utility u=0.012902 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6741723477781125, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6999753629932304, 'psi': 0.33308623671855697}
[S6] START round=35 head_norm_before_train=1.884121 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 7.353243897391528, 'psi': 0.01732902033271719}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.241402306740364, 'psi': 0.017551963048498844}
[S7] START round=35 head_norm_before_train=1.733544 (no previous merge yet)
[S7] round=35 local utility u=0.002142 metrics={'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.6585542915393406, 'psi': 0.2491280518186348}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6673297796149501, 'psi': 0.24962705121829937}
[S8] START round=35 head_norm_before_train=1.931521 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4532996794363013, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4194338113100657, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.800338 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.728381969835285, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.709709819368236, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=2.017601 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.23099027409372236, 'auprc': 0.23099027409372236, 'loss_val': 1.2069546004636023, 'psi': 0.23099027409372236}-{'f1_val': 0.2308882015024304, 'auprc': 0.2308882015024304, 'loss_val': 1.1749848937519423, 'psi': 0.2308882015024304}
[S11] START round=35 head_norm_before_train=1.859353 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.1231995553789607, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.1121320356972935, 'psi': 0.33154997286190585}
[S13] START round=35 head_norm_before_train=1.722656 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7678775878621409, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.73524155708607, 'psi': 0.3599362944611573}
[S14] START round=35 head_norm_before_train=1.933369 cos_to_last_merge=0.9937 (last merge round=27)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.693446816518082, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.600507488804392, 'psi': 0.13582554517133957}
[S15] START round=35 head_norm_before_train=1.993332 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.45232272824516134, 'auprc': 0.45232272824516134, 'loss_val': 0.9364053981545456, 'psi': 0.45232272824516134}-{'f1_val': 0.5523089799354849, 'auprc': 0.5523089799354849, 'loss_val': 0.8052608105586762, 'psi': 0.5523089799354849}
[S16] START round=35 head_norm_before_train=1.633482 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.0703500912560146, 'auprc': 0.0703500912560146, 'loss_val': 4.312758440769484, 'psi': 0.0703500912560146}-{'f1_val': 0.08873884735953702, 'auprc': 0.08873884735953702, 'loss_val': 3.9681614058970904, 'psi': 0.08873884735953702}
[S17] START round=35 head_norm_before_train=1.862283 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.35575297413753554, 'auprc': 0.35575297413753554, 'loss_val': 0.9495340333475365, 'psi': 0.35575297413753554}-{'f1_val': 0.39816410149443227, 'auprc': 0.39816410149443227, 'loss_val': 0.8999476669732627, 'psi': 0.39816410149443227}
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S7
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S16
[S8]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S16
[S14]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:44604
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S5
[S4] cosine check vs S5: cos=-0.0293
[S4] DROPPED delta from S5 (cos=-0.0293 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] ⇄ pheromone p=0.169 → S16@127.0.0.1:44616
[S15] ⇄ pheromone p=0.321 → S14@127.0.0.1:44614
[S8] ⇄ pheromone p=0.016 → S15@127.0.0.1:44615
[S9] ⇄ pheromone p=0.005 → S5@127.0.0.1:44605
[S4] ⇄ pheromone p=0.011 → S8@127.0.0.1:44609
[S5] ⇄ pheromone p=0.017 → S4@127.0.0.1:44604
[S16] CommDone barrier timeout: have=2 need=3 — continuing
[S16] ⇄ pheromone p=0.025 → S17@127.0.0.1:44617
[S14] CommDone barrier timeout: have=2 need=3 — continuing
[S14] ⇄ pheromone p=0.022 → S15@127.0.0.1:44615
[S2] START round=36 head_norm_before_train=1.914703 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.24927104659097957, 'auprc': 0.24927104659097957, 'loss_val': 2.8755139001681047, 'psi': 0.2492710465909796}-{'f1_val': 0.24941030415890753, 'auprc': 0.24941030415890753, 'loss_val': 2.8599254711474162, 'psi': 0.24941030415890753}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.921394 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2954298150163221, 'auprc': 0.2954298150163221, 'loss_val': 3.6146932771391587, 'psi': 0.2954298150163221}-{'f1_val': 0.29588411941353115, 'auprc': 0.29588411941353115, 'loss_val': 3.4097622059201953, 'psi': 0.29588411941353115}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.993363 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2528747988608555, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2438483988032003, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=1.749997 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6958188821655877, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6741723477781125, 'psi': 0.33308623671855697}
[S6] START round=36 head_norm_before_train=1.890986 (no previous merge yet)
[S6] round=36 local utility u=0.060428 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.252370230588727, 'psi': 0.01954921803127875}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 7.353243897391528, 'psi': 0.01732902033271719}
[S6] not sending this round → trigger blocked (psi=0.020)
[S7] START round=36 head_norm_before_train=1.742725 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6714824646668478, 'psi': 0.24962705121829937}-{'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.6585542915393406, 'psi': 0.2491280518186348}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.937567 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5022884535848366, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4532996794363013, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=1.807379 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7460598010330544, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.728381969835285, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=2.038788 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.2247903676628682, 'auprc': 0.2247903676628682, 'loss_val': 1.222031193596408, 'psi': 0.2247903676628682}-{'f1_val': 0.23099027409372236, 'auprc': 0.23099027409372236, 'loss_val': 1.2069546004636023, 'psi': 0.23099027409372236}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.870306 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.128521257867287, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.1231995553789607, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.731760 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8013522728037956, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7678775878621409, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.945095 cos_to_last_merge=0.9929 (last merge round=27)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.77950764139919, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.693446816518082, 'psi': 0.13582554517133957}
[S15] START round=36 head_norm_before_train=2.009425 (no previous merge yet)
[S15] round=36 local utility u=0.020234 metrics={'f1_val': 0.45639584841943776, 'auprc': 0.45639584841943776, 'loss_val': 0.9325954812820667, 'psi': 0.45639584841943776}-{'f1_val': 0.45232272824516134, 'auprc': 0.45232272824516134, 'loss_val': 0.9364053981545456, 'psi': 0.45232272824516134}
[S16] START round=36 head_norm_before_train=1.649734 cos_to_last_merge=0.9997 (last merge round=34)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.043542371411223864, 'auprc': 0.043542371411223864, 'loss_val': 4.592309907810535, 'psi': 0.043542371411223864}-{'f1_val': 0.0703500912560146, 'auprc': 0.0703500912560146, 'loss_val': 4.312758440769484, 'psi': 0.0703500912560146}
[S17] START round=36 head_norm_before_train=1.871504 (no previous merge yet)
[S17] round=36 local utility u=0.281505 metrics={'f1_val': 0.4102822580645161, 'auprc': 0.4102822580645161, 'loss_val': 0.8772876696145429, 'psi': 0.4102822580645161}-{'f1_val': 0.35575297413753554, 'auprc': 0.35575297413753554, 'loss_val': 0.9495340333475365, 'psi': 0.35575297413753554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1805 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1805) from S17
[S16] cosine check vs S17: cos=0.9819
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.0612
[S14]  timeout peer S3
[S14]  timeout peer S9
[S14]  timeout peer S13
[S16]  timeout peer S2
[S16]  timeout peer S7
[S16]  timeout peer S11
[S9]  timeout peer S5
[S9]  timeout peer S10
[S15]  timeout peer S16
[S4]  timeout peer S6
[S4]  timeout peer S8
[S5]  timeout peer S4
[S8]  timeout peer S15
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.0435 head_norm=1.666077
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.135442e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.0435 head_norm=1.421181 delta_norm=0.613544
[S16] aggregate: ACCEPT kept=['S17', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.921053 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.24876176324913324, 'auprc': 0.24876176324913324, 'loss_val': 2.8909056260233266, 'psi': 0.24876176324913324}-{'f1_val': 0.24927104659097957, 'auprc': 0.24927104659097957, 'loss_val': 2.8755139001681047, 'psi': 0.2492710465909796}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.929191 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.29759619778813634, 'auprc': 0.29759619778813634, 'loss_val': 3.90982589168752, 'psi': 0.29759619778813634}-{'f1_val': 0.2954298150163221, 'auprc': 0.2954298150163221, 'loss_val': 3.6146932771391587, 'psi': 0.2954298150163221}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.999326 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2617306496108542, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2528747988608555, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=1.770075 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.723227759097614, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.6958188821655877, 'psi': 0.33308623671855697}
[S6] START round=37 head_norm_before_train=1.897678 (no previous merge yet)
[S6] round=37 local utility u=0.082448 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 7.113177420405885, 'psi': 0.02240512117055327}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 7.252370230588727, 'psi': 0.01954921803127875}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=37 head_norm_before_train=1.750467 (no previous merge yet)
[S7] round=37 local utility u=0.357132 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7075924197664699, 'psi': 0.3330019880715706}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6714824646668478, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=37 head_norm_before_train=1.945405 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5564660895405176, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5022884535848366, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=1.814032 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.764161608284557, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7460598010330544, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=2.057629 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.22561501942166595, 'auprc': 0.22561501942166595, 'loss_val': 1.2438982483739844, 'psi': 0.22561501942166595}-{'f1_val': 0.2247903676628682, 'auprc': 0.2247903676628682, 'loss_val': 1.222031193596408, 'psi': 0.2247903676628682}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.880768 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.1702947681424702, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.128521257867287, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.740007 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8147980194894509, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8013522728037956, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.955504 cos_to_last_merge=0.9921 (last merge round=27)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.853730566521979, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.77950764139919, 'psi': 0.13582554517133957}
[S15] START round=37 head_norm_before_train=2.026520 (no previous merge yet)
[S15] round=37 local utility u=0.638125 metrics={'f1_val': 0.5699445089688991, 'auprc': 0.5699445089688991, 'loss_val': 0.678283728785364, 'psi': 0.5699445089688991}-{'f1_val': 0.45639584841943776, 'auprc': 0.45639584841943776, 'loss_val': 0.9325954812820667, 'psi': 0.45639584841943776}
[S16] START round=37 head_norm_before_train=1.421181 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.743013 metrics={'f1_val': 0.0889745442865173, 'auprc': 0.0889745442865173, 'loss_val': 3.515173497552651, 'psi': 0.0889745442865173}-{'f1_val': 0.043542371411223864, 'auprc': 0.043542371411223864, 'loss_val': 4.592309907810535, 'psi': 0.043542371411223864}
[S17] START round=37 head_norm_before_train=1.882770 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.30491199524034457, 'auprc': 0.30491199524034457, 'loss_val': 0.9958909646392348, 'psi': 0.30491199524034457}-{'f1_val': 0.4102822580645161, 'auprc': 0.4102822580645161, 'loss_val': 0.8772876696145429, 'psi': 0.4102822580645161}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.089)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44614
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=-0.0215
[S14] DROPPED delta from S15 (cos=-0.0215 < 0.0)
[S2] START round=38 head_norm_before_train=1.927047 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.24715507166143816, 'auprc': 0.24715507166143816, 'loss_val': 2.9101744107504692, 'psi': 0.24715507166143816}-{'f1_val': 0.24876176324913324, 'auprc': 0.24876176324913324, 'loss_val': 2.8909056260233266, 'psi': 0.24876176324913324}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.936699 (no previous merge yet)
[S3] round=38 local utility u=0.350415 metrics={'f1_val': 0.2900676281267824, 'auprc': 0.2900676281267824, 'loss_val': 3.141239657419206, 'psi': 0.2900676281267824}-{'f1_val': 0.29759619778813634, 'auprc': 0.29759619778813634, 'loss_val': 3.90982589168752, 'psi': 0.29759619778813634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=38 head_norm_before_train=2.006765 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2728124133084424, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2617306496108542, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=1.791370 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.751608645819792, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.723227759097614, 'psi': 0.33308623671855697}
[S6] START round=38 head_norm_before_train=1.903887 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.42330716858214, 'psi': 0.017551963048498844}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 7.113177420405885, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.759018 (no previous merge yet)
[S7] round=38 local utility u=0.010431 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6867312862907307, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7075924197664699, 'psi': 0.3330019880715706}
[S7] not sending this round → trigger blocked (psi=0.333)
[S8] START round=38 head_norm_before_train=1.951214 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.587848352269363, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5564660895405176, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.820493 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7827283109828183, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.764161608284557, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=2.075678 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.2243080883930487, 'auprc': 0.2243080883930487, 'loss_val': 1.2647400477091257, 'psi': 0.2243080883930487}-{'f1_val': 0.22561501942166595, 'auprc': 0.22561501942166595, 'loss_val': 1.2438982483739844, 'psi': 0.22561501942166595}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.890620 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.2149005599227127, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.1702947681424702, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.746069 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8294122796997456, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8147980194894509, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.965236 cos_to_last_merge=0.9915 (last merge round=27)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.917565157030896, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.853730566521979, 'psi': 0.13582554517133957}
[S15] START round=38 head_norm_before_train=2.043840 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.5183873074704942, 'auprc': 0.5183873074704942, 'loss_val': 0.8598129211611524, 'psi': 0.5183873074704942}-{'f1_val': 0.5699445089688991, 'auprc': 0.5699445089688991, 'loss_val': 0.678283728785364, 'psi': 0.5699445089688991}
[S16] START round=38 head_norm_before_train=1.440620 cos_to_last_merge=0.9993 (last merge round=36)
[S16] round=38 local utility u=0.379754 metrics={'f1_val': 0.13167074890521785, 'auprc': 0.13167074890521785, 'loss_val': 3.1399311846985953, 'psi': 0.13167074890521785}-{'f1_val': 0.0889745442865173, 'auprc': 0.0889745442865173, 'loss_val': 3.515173497552651, 'psi': 0.0889745442865173}
[S17] START round=38 head_norm_before_train=1.892101 (no previous merge yet)
[S17] round=38 local utility u=0.518183 metrics={'f1_val': 0.4102822580645161, 'auprc': 0.4102822580645161, 'loss_val': 0.9078572490650505, 'psi': 0.4102822580645161}-{'f1_val': 0.30491199524034457, 'auprc': 0.30491199524034457, 'loss_val': 0.9958909646392348, 'psi': 0.30491199524034457}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[S16] not sending this round → trigger blocked (psi=0.132)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S17
[S16] cosine check vs S17: cos=0.9190
[S2] START round=39 head_norm_before_train=1.932858 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 2.9310403533932665, 'psi': 0.24538903139123003}-{'f1_val': 0.24715507166143816, 'auprc': 0.24715507166143816, 'loss_val': 2.9101744107504692, 'psi': 0.24715507166143816}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.245 u=0.0000 p_local=0.0022 f1=0.245 auprc=0.245 bytes=12585
[S3] START round=39 head_norm_before_train=1.943701 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.28470824949698187, 'auprc': 0.28470824949698187, 'loss_val': 3.207327534892669, 'psi': 0.28470824949698187}-{'f1_val': 0.2900676281267824, 'auprc': 0.2900676281267824, 'loss_val': 3.141239657419206, 'psi': 0.2900676281267824}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.285 u=0.0000 p_local=0.0866 f1=0.285 auprc=0.285 bytes=18004
[S4] START round=39 head_norm_before_train=2.014679 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2809034699208504, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2728124133084424, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=1.815568 (no previous merge yet)
[S5] round=39 local utility u=0.003987 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.7436339056445624, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.751608645819792, 'psi': 0.33308623671855697}
[S6] START round=39 head_norm_before_train=1.909922 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.497709531199568, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.42330716858214, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.018 u=0.0000 p_local=0.0427 f1=0.018 auprc=0.018 bytes=0
[S7] START round=39 head_norm_before_train=1.765323 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6593814328541713, 'psi': 0.24962705121829937}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6867312862907307, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.250 u=0.0000 p_local=0.0638 f1=0.250 auprc=0.250 bytes=34186
[S8] START round=39 head_norm_before_train=1.958232 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6212938351641062, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.587848352269363, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=1.826953 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8014056443685735, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7827283109828183, 'psi': 0.36867172340800847}
[S10] START round=39 head_norm_before_train=2.091625 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.2209425190194421, 'auprc': 0.2209425190194421, 'loss_val': 1.2781111414538626, 'psi': 0.2209425190194421}-{'f1_val': 0.2243080883930487, 'auprc': 0.2243080883930487, 'loss_val': 1.2647400477091257, 'psi': 0.2243080883930487}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.221 u=0.0000 p_local=0.0144 f1=0.221 auprc=0.221 bytes=27000
[S11] START round=39 head_norm_before_train=1.900012 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.2524585193345823, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.2149005599227127, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0054 f1=0.332 auprc=0.332 bytes=12584
[S13] START round=39 head_norm_before_train=1.751506 (no previous merge yet)
[S13] round=39 local utility u=0.009761 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8098907644084072, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8294122796997456, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S13] r=40 psi=0.360 u=0.0098 p_local=0.0034 f1=0.360 auprc=0.360 bytes=8987
[S14] START round=39 head_norm_before_train=1.974430 cos_to_last_merge=0.9908 (last merge round=27)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.978105151374519, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.917565157030896, 'psi': 0.13582554517133957}
[S15] START round=39 head_norm_before_train=2.060245 (no previous merge yet)
[S15] round=39 local utility u=0.509335 metrics={'f1_val': 0.6070645555089388, 'auprc': 0.6070645555089388, 'loss_val': 0.6392391046569174, 'psi': 0.6070645555089388}-{'f1_val': 0.5183873074704942, 'auprc': 0.5183873074704942, 'loss_val': 0.8598129211611524, 'psi': 0.5183873074704942}
[S16] START round=39 head_norm_before_train=1.465822 cos_to_last_merge=0.9969 (last merge round=36)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.130596459913729, 'auprc': 0.130596459913729, 'loss_val': 3.2637881608948276, 'psi': 0.130596459913729}-{'f1_val': 0.13167074890521785, 'auprc': 0.13167074890521785, 'loss_val': 3.1399311846985953, 'psi': 0.13167074890521785}
[S17] START round=39 head_norm_before_train=1.901484 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.33188386464612196, 'auprc': 0.33188386464612196, 'loss_val': 1.0528220268287125, 'psi': 0.33188386464612196}-{'f1_val': 0.4102822580645161, 'auprc': 0.4102822580645161, 'loss_val': 0.9078572490650505, 'psi': 0.4102822580645161}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:44610
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0090 f1=0.136 auprc=0.136 bytes=0
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0046 f1=0.357 auprc=0.357 bytes=18022
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.1306 head_norm=1.491950
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.044814e-01
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.1317 head_norm=1.660474 delta_norm=0.404481
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.131 u=0.0000 p_local=0.1659 f1=0.131 auprc=0.131 bytes=0
[S5] sending update (kind=head size=1803 to 1 peers)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0020 f1=0.369 auprc=0.369 bytes=5403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44614
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0066 f1=0.359 auprc=0.359 bytes=21620
[S17] r=40 psi=0.332 u=0.0000 p_local=0.1810 f1=0.332 auprc=0.332 bytes=39616
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=-0.0950
[S9] DROPPED delta from S5 (cos=-0.0950 < 0.0)
[S5] r=40 psi=0.333 u=0.0040 p_local=0.0079 f1=0.333 auprc=0.333 bytes=27004
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0219
[S14] DROPPED delta from S15 (cos=-0.0219 < 0.0)
[S15] r=40 psi=0.607 u=0.5093 p_local=0.3172 f1=0.607 auprc=0.607 bytes=25195
[S2] START round=40 head_norm_before_train=1.938647 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.94869694505312, 'psi': 0.24507471790179935}-{'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 2.9310403533932665, 'psi': 0.24538903139123003}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.949054 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.2947121458220538, 'auprc': 0.2947121458220538, 'loss_val': 3.618664955397118, 'psi': 0.2947121458220538}-{'f1_val': 0.28470824949698187, 'auprc': 0.28470824949698187, 'loss_val': 3.207327534892669, 'psi': 0.28470824949698187}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.020373 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2906621820212252, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2809034699208504, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=1.841465 (no previous merge yet)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.751764850741981, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.7436339056445624, 'psi': 0.33308623671855697}
[S6] START round=40 head_norm_before_train=1.915780 (no previous merge yet)
[S6] round=40 local utility u=0.028438 metrics={'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 7.4468425590121035, 'psi': 0.018219557195571955}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.497709531199568, 'psi': 0.017551963048498844}
[S6] not sending this round → trigger blocked (psi=0.018)
[S7] START round=40 head_norm_before_train=1.771605 (no previous merge yet)
[S7] round=40 local utility u=0.009841 metrics={'f1_val': 0.24956456830057228, 'auprc': 0.24956456830057228, 'loss_val': 0.6391368056819748, 'psi': 0.24956456830057228}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6593814328541713, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=40 head_norm_before_train=1.966414 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6527620638883247, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6212938351641062, 'psi': 0.35939447907390915}
[S9] START round=40 head_norm_before_train=1.833123 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8182748613415334, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8014056443685735, 'psi': 0.36867172340800847}
[S10] START round=40 head_norm_before_train=2.106557 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.22159813480288257, 'auprc': 0.22159813480288257, 'loss_val': 1.2910505233563776, 'psi': 0.22159813480288254}-{'f1_val': 0.2209425190194421, 'auprc': 0.2209425190194421, 'loss_val': 1.2781111414538626, 'psi': 0.2209425190194421}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.908930 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.26517533549509, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.2524585193345823, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.756314 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8237379816234807, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8098907644084072, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.982877 cos_to_last_merge=0.9902 (last merge round=27)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.036600979865397, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.978105151374519, 'psi': 0.13582554517133957}
[S15] START round=40 head_norm_before_train=2.073655 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.5142598805784184, 'auprc': 0.5142598805784184, 'loss_val': 0.824678738763438, 'psi': 0.5142598805784184}-{'f1_val': 0.6070645555089388, 'auprc': 0.6070645555089388, 'loss_val': 0.6392391046569174, 'psi': 0.6070645555089388}
[S16] START round=40 head_norm_before_train=1.660474 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.000556947925368978, 'auprc': 0.000556947925368978, 'loss_val': 4.971110295337388, 'psi': 0.000556947925368978}-{'f1_val': 0.130596459913729, 'auprc': 0.130596459913729, 'loss_val': 3.2637881608948276, 'psi': 0.130596459913729}
[S17] START round=40 head_norm_before_train=1.909820 (no previous merge yet)
[S17] round=40 local utility u=0.291151 metrics={'f1_val': 0.39673011180732504, 'auprc': 0.39673011180732504, 'loss_val': 1.054137090985261, 'psi': 0.39673011180732504}-{'f1_val': 0.33188386464612196, 'auprc': 0.33188386464612196, 'loss_val': 1.0528220268287125, 'psi': 0.33188386464612196}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44616
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.007 → S15@127.0.0.1:44615
[S4] ⇄ pheromone p=0.004 → S5@127.0.0.1:44605
[S17] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=0.133 → S17@127.0.0.1:44617
[S5] ⇄ pheromone p=0.006 → S9@127.0.0.1:44610
[S8] ⇄ pheromone p=0.005 → S4@127.0.0.1:44604
[S16] RECEIVED delta(kind=head bytes=1804) from S17
[S16] cosine check vs S17: cos=0.9803
[S17] ⇄ pheromone p=0.203 → S16@127.0.0.1:44616
[S15] ⇄ pheromone p=0.254 → S8@127.0.0.1:44609
[S2] START round=41 head_norm_before_train=1.944181 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.958994458455113, 'psi': 0.245119570522206}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.94869694505312, 'psi': 0.24507471790179935}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.954576 (no previous merge yet)
[S3] round=41 local utility u=0.245649 metrics={'f1_val': 0.2834544677212484, 'auprc': 0.2834544677212484, 'loss_val': 3.0260481325407715, 'psi': 0.2834544677212484}-{'f1_val': 0.2947121458220538, 'auprc': 0.2947121458220538, 'loss_val': 3.618664955397118, 'psi': 0.2947121458220538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=41 head_norm_before_train=2.028425 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.306649554430178, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2906621820212252, 'psi': 0.3567939207526687}
[S5] START round=41 head_norm_before_train=1.862385 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.819860478142562, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.751764850741981, 'psi': 0.33308623671855697}
[S6] START round=41 head_norm_before_train=1.921261 (no previous merge yet)
[S6] round=41 local utility u=0.013342 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.44204737904255, 'psi': 0.02065167508031207}-{'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 7.4468425590121035, 'psi': 0.018219557195571955}
[S6] not sending this round → trigger blocked (psi=0.021)
[S7] START round=41 head_norm_before_train=1.776101 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.6422701226209785, 'psi': 0.24968913205670232}-{'f1_val': 0.24956456830057228, 'auprc': 0.24956456830057228, 'loss_val': 0.6391368056819748, 'psi': 0.24956456830057228}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.974911 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6872152433194885, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6527620638883247, 'psi': 0.35939447907390915}
[S9] START round=41 head_norm_before_train=1.838953 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8355095741354073, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8182748613415334, 'psi': 0.36867172340800847}
[S10] START round=41 head_norm_before_train=2.120216 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.2192743288590604, 'auprc': 0.2192743288590604, 'loss_val': 1.301310093978328, 'psi': 0.2192743288590604}-{'f1_val': 0.22159813480288257, 'auprc': 0.22159813480288257, 'loss_val': 1.2910505233563776, 'psi': 0.22159813480288254}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.917176 (no previous merge yet)
[S11] round=41 local utility u=0.004341 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.2564937867094645, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.26517533549509, 'psi': 0.33154997286190585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=41 head_norm_before_train=1.762140 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8343581455085427, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8237379816234807, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.990714 cos_to_last_merge=0.9897 (last merge round=27)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.093946326960028, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.036600979865397, 'psi': 0.13582554517133957}
[S15] START round=41 head_norm_before_train=2.087615 (no previous merge yet)
[S15] round=41 local utility u=0.446663 metrics={'f1_val': 0.5919702124473152, 'auprc': 0.5919702124473152, 'loss_val': 0.6307448492434962, 'psi': 0.5919702124473152}-{'f1_val': 0.5142598805784184, 'auprc': 0.5142598805784184, 'loss_val': 0.824678738763438, 'psi': 0.5142598805784184}
[S16] START round=41 head_norm_before_train=1.680462 cos_to_last_merge=0.9996 (last merge round=39)
[S16] round=41 local utility u=0.946203 metrics={'f1_val': 0.10176678445229682, 'auprc': 0.10176678445229682, 'loss_val': 3.9895934392780106, 'psi': 0.10176678445229682}-{'f1_val': 0.000556947925368978, 'auprc': 0.000556947925368978, 'loss_val': 4.971110295337388, 'psi': 0.000556947925368978}
[S17] START round=41 head_norm_before_train=1.920531 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.39720845833697094, 'auprc': 0.39720845833697094, 'loss_val': 1.0866507039908835, 'psi': 0.39720845833697094}-{'f1_val': 0.39673011180732504, 'auprc': 0.39673011180732504, 'loss_val': 1.054137090985261, 'psi': 0.39673011180732504}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.102)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44609
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.1018 head_norm=1.697914
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.221382e-01
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.1049 head_norm=1.798980 delta_norm=0.222138
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=-0.0640
[S8] DROPPED delta from S15 (cos=-0.0640 < 0.0)
[S2] START round=42 head_norm_before_train=1.949459 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 2.9690353214250313, 'psi': 0.24520932503356518}-{'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.958994458455113, 'psi': 0.245119570522206}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.959219 (no previous merge yet)
[S3] round=42 local utility u=0.007271 metrics={'f1_val': 0.2898550724637681, 'auprc': 0.2898550724637681, 'loss_val': 3.0691124882041017, 'psi': 0.2898550724637681}-{'f1_val': 0.2834544677212484, 'auprc': 0.2834544677212484, 'loss_val': 3.0260481325407715, 'psi': 0.2834544677212484}
[S3] not sending this round → trigger blocked (psi=0.290)
[S4] START round=42 head_norm_before_train=2.037696 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.321493552176345, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.306649554430178, 'psi': 0.3567939207526687}
[S5] START round=42 head_norm_before_train=1.878552 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.82152757944185, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.819860478142562, 'psi': 0.33308623671855697}
[S6] START round=42 head_norm_before_train=1.926480 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.471828655294322, 'psi': 0.02065167508031207}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.44204737904255, 'psi': 0.02065167508031207}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.780974 (no previous merge yet)
[S7] round=42 local utility u=0.363718 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.664649946471568, 'psi': 0.3330019880715706}-{'f1_val': 0.24968913205670232, 'auprc': 0.24968913205670232, 'loss_val': 0.6422701226209785, 'psi': 0.24968913205670232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=42 head_norm_before_train=1.983611 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7163838792945654, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6872152433194885, 'psi': 0.35939447907390915}
[S9] START round=42 head_norm_before_train=1.844684 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8503142912064243, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8355095741354073, 'psi': 0.36867172340800847}
[S10] START round=42 head_norm_before_train=2.133246 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.21587858765228166, 'auprc': 0.21587858765228166, 'loss_val': 1.3161745230709478, 'psi': 0.21587858765228166}-{'f1_val': 0.2192743288590604, 'auprc': 0.2192743288590604, 'loss_val': 1.301310093978328, 'psi': 0.2192743288590604}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.924840 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.2630755353234737, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.2564937867094645, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.763159 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8434909093303138, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8343581455085427, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.998006 cos_to_last_merge=0.9891 (last merge round=27)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.146543600777799, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.093946326960028, 'psi': 0.13582554517133957}
[S15] START round=42 head_norm_before_train=2.101070 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.505896572752393, 'auprc': 0.505896572752393, 'loss_val': 0.8082405109131011, 'psi': 0.505896572752393}-{'f1_val': 0.5919702124473152, 'auprc': 0.5919702124473152, 'loss_val': 0.6307448492434962, 'psi': 0.5919702124473152}
[S16] START round=42 head_norm_before_train=1.798980 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.627255 metrics={'f1_val': 0.1742098436753362, 'auprc': 0.1742098436753362, 'loss_val': 3.3870701364008458, 'psi': 0.1742098436753362}-{'f1_val': 0.10176678445229682, 'auprc': 0.10176678445229682, 'loss_val': 3.9895934392780106, 'psi': 0.10176678445229682}
[S17] START round=42 head_norm_before_train=1.930575 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.3355728239166802, 'auprc': 0.3355728239166802, 'loss_val': 1.1930306550419028, 'psi': 0.3355728239166802}-{'f1_val': 0.39720845833697094, 'auprc': 0.39720845833697094, 'loss_val': 1.0866507039908835, 'psi': 0.39720845833697094}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.174)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.954708 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.9787854901676485, 'psi': 0.24552398411243506}-{'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 2.9690353214250313, 'psi': 0.24520932503356518}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.964557 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.2881383586229401, 'auprc': 0.2881383586229401, 'loss_val': 3.1930233705493745, 'psi': 0.2881383586229401}-{'f1_val': 0.2898550724637681, 'auprc': 0.2898550724637681, 'loss_val': 3.0691124882041017, 'psi': 0.2898550724637681}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.048285 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3343072521346009, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.321493552176345, 'psi': 0.3567939207526687}
[S5] START round=43 head_norm_before_train=1.892686 (no previous merge yet)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.8258154355683143, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.82152757944185, 'psi': 0.33308623671855697}
[S6] START round=43 head_norm_before_train=1.931658 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 7.539839424271056, 'psi': 0.018219557195571955}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 7.471828655294322, 'psi': 0.02065167508031207}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.785170 (no previous merge yet)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.24937779990044798, 'auprc': 0.24937779990044798, 'loss_val': 0.6386312190146056, 'psi': 0.249377799900448}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.664649946471568, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.988724 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7367381392587735, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7163838792945654, 'psi': 0.35939447907390915}
[S9] START round=43 head_norm_before_train=1.850174 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.86502339951577, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8503142912064243, 'psi': 0.36867172340800847}
[S10] START round=43 head_norm_before_train=2.145453 (no previous merge yet)
[S10] round=43 local utility u=0.001836 metrics={'f1_val': 0.21790329303876615, 'auprc': 0.21790329303876615, 'loss_val': 1.3307247816857755, 'psi': 0.21790329303876615}-{'f1_val': 0.21587858765228166, 'auprc': 0.21587858765228166, 'loss_val': 1.3161745230709478, 'psi': 0.21587858765228166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=43 head_norm_before_train=1.932462 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.2884290724972836, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.2630755353234737, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.765598 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8571819968607162, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8434909093303138, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.004978 cos_to_last_merge=0.9886 (last merge round=27)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.191974302343968, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.146543600777799, 'psi': 0.13582554517133957}
[S15] START round=43 head_norm_before_train=2.116110 (no previous merge yet)
[S15] round=43 local utility u=0.550864 metrics={'f1_val': 0.6016024415120801, 'auprc': 0.6016024415120801, 'loss_val': 0.5678662674988073, 'psi': 0.6016024415120801}-{'f1_val': 0.505896572752393, 'auprc': 0.505896572752393, 'loss_val': 0.8082405109131011, 'psi': 0.505896572752393}
[S16] START round=43 head_norm_before_train=1.813491 cos_to_last_merge=0.9998 (last merge round=41)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.13938862074009067, 'auprc': 0.13938862074009067, 'loss_val': 3.968840444493997, 'psi': 0.13938862074009067}-{'f1_val': 0.1742098436753362, 'auprc': 0.1742098436753362, 'loss_val': 3.3870701364008458, 'psi': 0.1742098436753362}
[S17] START round=43 head_norm_before_train=1.940549 (no previous merge yet)
[S17] round=43 local utility u=0.320360 metrics={'f1_val': 0.39529296611086967, 'auprc': 0.39529296611086967, 'loss_val': 1.089791944382903, 'psi': 0.39529296611086967}-{'f1_val': 0.3355728239166802, 'auprc': 0.3355728239166802, 'loss_val': 1.1930306550419028, 'psi': 0.3355728239166802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44616
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:44609
[S16] RECEIVED delta(kind=head bytes=1804) from S17
[S16] cosine check vs S17: cos=0.9912
[S15] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S15
[S8] cosine check vs S15: cos=-0.0622
[S8] DROPPED delta from S15 (cos=-0.0622 < 0.0)
[S2] START round=44 head_norm_before_train=1.959869 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.24588458478673278, 'auprc': 0.24588458478673278, 'loss_val': 2.9890034227720483, 'psi': 0.24588458478673275}-{'f1_val': 0.24552398411243506, 'auprc': 0.24552398411243506, 'loss_val': 2.9787854901676485, 'psi': 0.24552398411243506}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.970872 (no previous merge yet)
[S3] round=44 local utility u=0.037811 metrics={'f1_val': 0.2804366078925273, 'auprc': 0.2804366078925273, 'loss_val': 3.048086442336206, 'psi': 0.2804366078925273}-{'f1_val': 0.2881383586229401, 'auprc': 0.2881383586229401, 'loss_val': 3.1930233705493745, 'psi': 0.2881383586229401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=44 head_norm_before_train=2.054715 (no previous merge yet)
[S4] round=44 local utility u=0.000813 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3326803630687822, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3343072521346009, 'psi': 0.3567939207526687}
[S5] START round=44 head_norm_before_train=1.907962 (no previous merge yet)
[S5] round=44 local utility u=0.023349 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7829046462515215, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.8258154355683143, 'psi': 0.33308623671855697}
[S6] START round=44 head_norm_before_train=1.936769 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 7.595316993379781, 'psi': 0.01799723119520074}-{'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 7.539839424271056, 'psi': 0.018219557195571955}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.789803 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.24937779990044798, 'auprc': 0.24937779990044798, 'loss_val': 0.6482214635010968, 'psi': 0.249377799900448}-{'f1_val': 0.24937779990044798, 'auprc': 0.24937779990044798, 'loss_val': 0.6386312190146056, 'psi': 0.249377799900448}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.995643 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7677654439256527, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7367381392587735, 'psi': 0.35939447907390915}
[S9] START round=44 head_norm_before_train=1.855743 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.876903818321769, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.86502339951577, 'psi': 0.36867172340800847}
[S10] START round=44 head_norm_before_train=2.157484 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.21503496503496503, 'auprc': 0.21503496503496503, 'loss_val': 1.3445513602615837, 'psi': 0.21503496503496503}-{'f1_val': 0.21790329303876615, 'auprc': 0.21790329303876615, 'loss_val': 1.3307247816857755, 'psi': 0.21790329303876615}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.940176 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.3164671983984357, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.2884290724972836, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.771097 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8814048321631807, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8571819968607162, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.011813 cos_to_last_merge=0.9881 (last merge round=27)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.236050082240923, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.191974302343968, 'psi': 0.13582554517133957}
[S15] START round=44 head_norm_before_train=2.129805 (no previous merge yet)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.5905296069281041, 'auprc': 0.5905296069281041, 'loss_val': 0.5980162133653938, 'psi': 0.5905296069281041}-{'f1_val': 0.6016024415120801, 'auprc': 0.6016024415120801, 'loss_val': 0.5678662674988073, 'psi': 0.6016024415120801}
[S16] START round=44 head_norm_before_train=1.827776 cos_to_last_merge=0.9990 (last merge round=41)
[S16] round=44 local utility u=0.040315 metrics={'f1_val': 0.14260793720017445, 'auprc': 0.14260793720017445, 'loss_val': 3.91718375607035, 'psi': 0.14260793720017445}-{'f1_val': 0.13938862074009067, 'auprc': 0.13938862074009067, 'loss_val': 3.968840444493997, 'psi': 0.13938862074009067}
[S17] START round=44 head_norm_before_train=1.950774 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 1.2200043060037509, 'psi': 0.30875549754205167}-{'f1_val': 0.39529296611086967, 'auprc': 0.39529296611086967, 'loss_val': 1.089791944382903, 'psi': 0.39529296611086967}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:44610
[S16] not sending this round → trigger blocked (psi=0.143)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=44 metric=0.1426 head_norm=1.840519
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.510414e-01
[S16] stored merged vector for next round verification (round=44)
[S16] DEBUG after merge:  round=44 metric=0.1427 head_norm=1.890424 delta_norm=0.151041
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] RECEIVED delta(kind=head bytes=1805) from S5
[S9] cosine check vs S5: cos=-0.0983
[S9] DROPPED delta from S5 (cos=-0.0983 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S4
[S5] cosine check vs S4: cos=-0.0420
[S5] DROPPED delta from S4 (cos=-0.0420 < 0.0)
[S2] START round=45 head_norm_before_train=1.964823 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.24642747623428396, 'auprc': 0.24642747623428396, 'loss_val': 2.9998786151770958, 'psi': 0.24642747623428396}-{'f1_val': 0.24588458478673278, 'auprc': 0.24588458478673278, 'loss_val': 2.9890034227720483, 'psi': 0.24588458478673275}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.977192 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.28841919859092907, 'auprc': 0.28841919859092907, 'loss_val': 3.1232187022256293, 'psi': 0.28841919859092907}-{'f1_val': 0.2804366078925273, 'auprc': 0.2804366078925273, 'loss_val': 3.048086442336206, 'psi': 0.2804366078925273}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.064320 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3385733138771647, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3326803630687822, 'psi': 0.3567939207526687}
[S5] START round=45 head_norm_before_train=1.920316 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.8132501186303918, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7829046462515215, 'psi': 0.3335071121394324}
[S6] START round=45 head_norm_before_train=1.941754 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 7.627914444335777, 'psi': 0.01799723119520074}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 7.595316993379781, 'psi': 0.01799723119520074}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.795801 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.6603467912755939, 'psi': 0.2491280518186348}-{'f1_val': 0.24937779990044798, 'auprc': 0.24937779990044798, 'loss_val': 0.6482214635010968, 'psi': 0.249377799900448}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=2.003565 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7949692538536959, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7677654439256527, 'psi': 0.35939447907390915}
[S9] START round=45 head_norm_before_train=1.861202 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8885962464225146, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.876903818321769, 'psi': 0.36867172340800847}
[S10] START round=45 head_norm_before_train=2.168737 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.21325178389398572, 'auprc': 0.21325178389398572, 'loss_val': 1.356002507307139, 'psi': 0.2132517838939857}-{'f1_val': 0.21503496503496503, 'auprc': 0.21503496503496503, 'loss_val': 1.3445513602615837, 'psi': 0.21503496503496503}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.947347 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.3310837967224143, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.3164671983984357, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.783281 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8990368680985998, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8814048321631807, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.018320 cos_to_last_merge=0.9877 (last merge round=27)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.280974566856656, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.236050082240923, 'psi': 0.13582554517133957}
[S15] START round=45 head_norm_before_train=2.142296 (no previous merge yet)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.5050802365394503, 'auprc': 0.5050802365394503, 'loss_val': 0.8173327356098575, 'psi': 0.5050802365394503}-{'f1_val': 0.5905296069281041, 'auprc': 0.5905296069281041, 'loss_val': 0.5980162133653938, 'psi': 0.5905296069281041}
[S16] START round=45 head_norm_before_train=1.890424 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=45 local utility u=0.012423 metrics={'f1_val': 0.1452231141968612, 'auprc': 0.1452231141968612, 'loss_val': 3.9158733905830396, 'psi': 0.1452231141968612}-{'f1_val': 0.14260793720017445, 'auprc': 0.14260793720017445, 'loss_val': 3.91718375607035, 'psi': 0.14260793720017445}
[S17] START round=45 head_norm_before_train=1.962616 (no previous merge yet)
[S17] round=45 local utility u=0.617265 metrics={'f1_val': 0.4298517170623549, 'auprc': 0.4298517170623549, 'loss_val': 1.0753406990586427, 'psi': 0.4298517170623549}-{'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 1.2200043060037509, 'psi': 0.30875549754205167}
[S9]  timeout peer S14
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.145)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1803 to 1 peers)
[S4] ⇄ pheromone p=0.001 → S5@127.0.0.1:44605
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=0.194 → S17@127.0.0.1:44617
[S16] RECEIVED delta(kind=head bytes=1803) from S17
[S16] cosine check vs S17: cos=0.9960
[S17] ⇄ pheromone p=0.231 → S16@127.0.0.1:44616
[S15] ⇄ pheromone p=0.190 → S14@127.0.0.1:44614
[S2] START round=46 head_norm_before_train=1.969834 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.24651819130007976, 'auprc': 0.24651819130007976, 'loss_val': 3.0113202239555705, 'psi': 0.2465181913000798}-{'f1_val': 0.24642747623428396, 'auprc': 0.24642747623428396, 'loss_val': 2.9998786151770958, 'psi': 0.24642747623428396}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.983390 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.2901696005144281, 'auprc': 0.2901696005144281, 'loss_val': 3.225079814858516, 'psi': 0.2901696005144281}-{'f1_val': 0.28841919859092907, 'auprc': 0.28841919859092907, 'loss_val': 3.1232187022256293, 'psi': 0.28841919859092907}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.077478 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3444847987087347, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3385733138771647, 'psi': 0.3567939207526687}
[S5] START round=46 head_norm_before_train=1.931424 (no previous merge yet)
[S5] round=46 local utility u=0.003754 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.8057419777869836, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.8132501186303918, 'psi': 0.33308623671855697}
[S6] START round=46 head_norm_before_train=1.946779 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.663957232742177, 'psi': 0.017774699907663897}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 7.627914444335777, 'psi': 0.01799723119520074}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.801160 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.6793771851759621, 'psi': 0.2491280518186348}-{'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.6603467912755939, 'psi': 0.2491280518186348}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=2.010113 (no previous merge yet)
[S8] round=46 local utility u=0.001488 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7919929082814914, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7949692538536959, 'psi': 0.35939447907390915}
[S9] START round=46 head_norm_before_train=1.866396 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.904063044982971, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8885962464225146, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.179310 (no previous merge yet)
[S10] round=46 local utility u=0.010903 metrics={'f1_val': 0.21645962732919255, 'auprc': 0.21645962732919255, 'loss_val': 1.3630667723436174, 'psi': 0.21645962732919255}-{'f1_val': 0.21325178389398572, 'auprc': 0.21325178389398572, 'loss_val': 1.356002507307139, 'psi': 0.2132517838939857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=46 head_norm_before_train=1.954077 (no previous merge yet)
[S11] round=46 local utility u=0.000883 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.329317033683791, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.3310837967224143, 'psi': 0.33154997286190585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=46 head_norm_before_train=1.797853 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9178803995794909, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8990368680985998, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.024483 cos_to_last_merge=0.9872 (last merge round=27)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.324500966979693, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.280974566856656, 'psi': 0.13582554517133957}
[S15] START round=46 head_norm_before_train=2.156092 (no previous merge yet)
[S15] round=46 local utility u=0.603516 metrics={'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.599009778006716, 'psi': 0.6149367764291455}-{'f1_val': 0.5050802365394503, 'auprc': 0.5050802365394503, 'loss_val': 0.8173327356098575, 'psi': 0.5050802365394503}
[S16] START round=46 head_norm_before_train=1.901016 cos_to_last_merge=0.9999 (last merge round=44)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.13671444321940462, 'auprc': 0.13671444321940462, 'loss_val': 4.0873577467591184, 'psi': 0.13671444321940462}-{'f1_val': 0.1452231141968612, 'auprc': 0.1452231141968612, 'loss_val': 3.9158733905830396, 'psi': 0.1452231141968612}
[S17] START round=46 head_norm_before_train=1.977702 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.30491199524034457, 'auprc': 0.30491199524034457, 'loss_val': 1.4308989662875502, 'psi': 0.30491199524034457}-{'f1_val': 0.4298517170623549, 'auprc': 0.4298517170623549, 'loss_val': 1.0753406990586427, 'psi': 0.4298517170623549}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44614
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=46 metric=0.1367 head_norm=1.912194
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.060715e-01
[S16] stored merged vector for next round verification (round=46)
[S16] DEBUG after merge:  round=46 metric=0.1374 head_norm=1.942330 delta_norm=0.106071
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0229
[S14] DROPPED delta from S15 (cos=-0.0229 < 0.0)
[S2] START round=47 head_norm_before_train=1.974683 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.24565908535094153, 'auprc': 0.24565908535094153, 'loss_val': 3.024972346855459, 'psi': 0.24565908535094153}-{'f1_val': 0.24651819130007976, 'auprc': 0.24651819130007976, 'loss_val': 3.0113202239555705, 'psi': 0.2465181913000798}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.989736 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.27469451839716025, 'auprc': 0.27469451839716025, 'loss_val': 3.0879088235567997, 'psi': 0.27469451839716025}-{'f1_val': 0.2901696005144281, 'auprc': 0.2901696005144281, 'loss_val': 3.225079814858516, 'psi': 0.2901696005144281}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.088030 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.350038624185468, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3444847987087347, 'psi': 0.3567939207526687}
[S5] START round=47 head_norm_before_train=1.944736 (no previous merge yet)
[S5] round=47 local utility u=0.016602 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7763264789945947, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.8057419777869836, 'psi': 0.33308623671855697}
[S6] START round=47 head_norm_before_train=1.951604 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.712910224236756, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.663957232742177, 'psi': 0.017774699907663897}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.806732 (no previous merge yet)
[S7] round=47 local utility u=0.003269 metrics={'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.6767694177506985, 'psi': 0.24956478487938324}-{'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.6793771851759621, 'psi': 0.2491280518186348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=47 head_norm_before_train=2.013952 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8041652901401226, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.7919929082814914, 'psi': 0.35939447907390915}
[S9] START round=47 head_norm_before_train=1.871676 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.918319395841231, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.904063044982971, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.189539 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.21437359032191922, 'auprc': 0.21437359032191922, 'loss_val': 1.3729739208517058, 'psi': 0.21437359032191922}-{'f1_val': 0.21645962732919255, 'auprc': 0.21645962732919255, 'loss_val': 1.3630667723436174, 'psi': 0.21645962732919255}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.960600 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.3320644996726276, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.329317033683791, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.810382 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9298815389780613, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9178803995794909, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.030417 cos_to_last_merge=0.9868 (last merge round=27)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.364703812758147, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.324500966979693, 'psi': 0.13582554517133957}
[S15] START round=47 head_norm_before_train=2.168537 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.5575903511745423, 'auprc': 0.5575903511745423, 'loss_val': 0.676764453474494, 'psi': 0.5575903511745423}-{'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.599009778006716, 'psi': 0.6149367764291455}
[S16] START round=47 head_norm_before_train=1.942330 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.12100560351355444, 'auprc': 0.12100560351355444, 'loss_val': 4.335594701184923, 'psi': 0.12100560351355444}-{'f1_val': 0.13671444321940462, 'auprc': 0.13671444321940462, 'loss_val': 4.0873577467591184, 'psi': 0.13671444321940462}
[S17] START round=47 head_norm_before_train=1.992651 (no previous merge yet)
[S17] round=47 local utility u=0.531603 metrics={'f1_val': 0.405287202589438, 'auprc': 0.405287202589438, 'loss_val': 1.2710702075683349, 'psi': 0.405287202589438}-{'f1_val': 0.30491199524034457, 'auprc': 0.30491199524034457, 'loss_val': 1.4308989662875502, 'psi': 0.30491199524034457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] → sending delta(kind=head bytes=1809) to S16@127.0.0.1:44616
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.334)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1809 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1809) from S17
[S16] cosine check vs S17: cos=0.9976
[S2] START round=48 head_norm_before_train=1.979342 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.2454789833822092, 'auprc': 0.2454789833822092, 'loss_val': 3.0378025752526874, 'psi': 0.2454789833822092}-{'f1_val': 0.24565908535094153, 'auprc': 0.24565908535094153, 'loss_val': 3.024972346855459, 'psi': 0.24565908535094153}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.995691 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.26305811597045176, 'auprc': 0.26305811597045176, 'loss_val': 3.1120780157980406, 'psi': 0.26305811597045176}-{'f1_val': 0.27469451839716025, 'auprc': 0.27469451839716025, 'loss_val': 3.0879088235567997, 'psi': 0.27469451839716025}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.093080 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3582732281839, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.350038624185468, 'psi': 0.3567939207526687}
[S5] START round=48 head_norm_before_train=1.958925 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.784882732900374, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7763264789945947, 'psi': 0.3335071121394324}
[S6] START round=48 head_norm_before_train=1.956123 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.736411036011325, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.712910224236756, 'psi': 0.017774699907663897}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.815045 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.6822005388885723, 'psi': 0.2496892866020383}-{'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.6767694177506985, 'psi': 0.24956478487938324}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.019710 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8251617299492835, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8041652901401226, 'psi': 0.35939447907390915}
[S9] START round=48 head_norm_before_train=1.876631 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.932583539216043, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.918319395841231, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.199378 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.21232737611697808, 'auprc': 0.21232737611697808, 'loss_val': 1.38280890348216, 'psi': 0.21232737611697805}-{'f1_val': 0.21437359032191922, 'auprc': 0.21437359032191922, 'loss_val': 1.3729739208517058, 'psi': 0.21437359032191922}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.967099 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.3466101805925845, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.3320644996726276, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.819796 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9416139999592008, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9298815389780613, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.036167 cos_to_last_merge=0.9864 (last merge round=27)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.403426918671521, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.364703812758147, 'psi': 0.13582554517133957}
[S15] START round=48 head_norm_before_train=2.179466 (no previous merge yet)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.5356826867480612, 'auprc': 0.5356826867480612, 'loss_val': 0.7707158744953385, 'psi': 0.5356826867480612}-{'f1_val': 0.5575903511745423, 'auprc': 0.5575903511745423, 'loss_val': 0.676764453474494, 'psi': 0.5575903511745423}
[S16] START round=48 head_norm_before_train=1.952402 cos_to_last_merge=0.9999 (last merge round=46)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.0814000814000814, 'auprc': 0.0814000814000814, 'loss_val': 5.105748898192621, 'psi': 0.0814000814000814}-{'f1_val': 0.12100560351355444, 'auprc': 0.12100560351355444, 'loss_val': 4.335594701184923, 'psi': 0.12100560351355444}
[S17] START round=48 head_norm_before_train=2.004901 (no previous merge yet)
[S17] round=48 local utility u=0.025575 metrics={'f1_val': 0.4085849267016768, 'auprc': 0.4085849267016768, 'loss_val': 1.2495994390359018, 'psi': 0.4085849267016768}-{'f1_val': 0.405287202589438, 'auprc': 0.405287202589438, 'loss_val': 1.2710702075683349, 'psi': 0.405287202589438}
[S17] not sending this round → trigger blocked (psi=0.409)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=48 metric=0.0814 head_norm=1.962191
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.476716e-02
[S16] stored merged vector for next round verification (round=48)
[S16] DEBUG after merge:  round=48 metric=0.0820 head_norm=1.981849 delta_norm=0.084767
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.983991 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.24529914529914532, 'auprc': 0.24529914529914532, 'loss_val': 3.0493716107119457, 'psi': 0.24529914529914532}-{'f1_val': 0.2454789833822092, 'auprc': 0.2454789833822092, 'loss_val': 3.0378025752526874, 'psi': 0.2454789833822092}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.002050 (no previous merge yet)
[S3] round=49 local utility u=0.062265 metrics={'f1_val': 0.2925121349566325, 'auprc': 0.2925121349566325, 'loss_val': 3.2526334893396127, 'psi': 0.2925121349566325}-{'f1_val': 0.26305811597045176, 'auprc': 0.26305811597045176, 'loss_val': 3.1120780157980406, 'psi': 0.26305811597045176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=49 head_norm_before_train=2.097102 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.37220730082907, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3582732281839, 'psi': 0.3567939207526687}
[S5] START round=49 head_norm_before_train=1.967776 (no previous merge yet)
[S5] round=49 local utility u=0.026521 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7356291595810682, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.784882732900374, 'psi': 0.33308623671855697}
[S6] START round=49 head_norm_before_train=1.960591 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.757456739213691, 'psi': 0.017774699907663897}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 7.736411036011325, 'psi': 0.017774699907663897}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.823901 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.6956617581276613, 'psi': 0.24956478487938324}-{'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.6822005388885723, 'psi': 0.2496892866020383}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.028405 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8441956235000139, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.8251617299492835, 'psi': 0.35939447907390915}
[S9] START round=49 head_norm_before_train=1.881524 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.945859520111966, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.932583539216043, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.208873 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.21151122799919078, 'auprc': 0.21151122799919078, 'loss_val': 1.3962031220552127, 'psi': 0.2115112279991908}-{'f1_val': 0.21232737611697808, 'auprc': 0.21232737611697808, 'loss_val': 1.38280890348216, 'psi': 0.21232737611697805}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.973518 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.369985181400972, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.3466101805925845, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.828165 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9615688008708578, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9416139999592008, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.041692 cos_to_last_merge=0.9860 (last merge round=27)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.437639989084368, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.403426918671521, 'psi': 0.13582554517133957}
[S15] START round=49 head_norm_before_train=2.189750 (no previous merge yet)
[S15] round=49 local utility u=0.236109 metrics={'f1_val': 0.5737401983630551, 'auprc': 0.5737401983630551, 'loss_val': 0.6410151514076305, 'psi': 0.5737401983630551}-{'f1_val': 0.5356826867480612, 'auprc': 0.5356826867480612, 'loss_val': 0.7707158744953385, 'psi': 0.5356826867480612}
[S16] START round=49 head_norm_before_train=1.981849 cos_to_last_merge=1.0000 (last merge round=48)
[S16] round=49 local utility u=0.245299 metrics={'f1_val': 0.09077809798270893, 'auprc': 0.09077809798270893, 'loss_val': 4.69955299527612, 'psi': 0.09077809798270893}-{'f1_val': 0.0814000814000814, 'auprc': 0.0814000814000814, 'loss_val': 5.105748898192621, 'psi': 0.0814000814000814}
[S17] START round=49 head_norm_before_train=2.014848 (no previous merge yet)
[S17] round=49 local utility u=0.135213 metrics={'f1_val': 0.4325754352226333, 'auprc': 0.4325754352226333, 'loss_val': 1.1950876888077104, 'psi': 0.4325754352226333}-{'f1_val': 0.4085849267016768, 'auprc': 0.4085849267016768, 'loss_val': 1.2495994390359018, 'psi': 0.4085849267016768}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.091)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[S16] RECEIVED delta(kind=head bytes=1803) from S17
[S16] cosine check vs S17: cos=0.9983
[S15] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=-0.0235
[S14] DROPPED delta from S15 (cos=-0.0235 < 0.0)
[runner] rounds complete.
[runner] all agents stopped.
