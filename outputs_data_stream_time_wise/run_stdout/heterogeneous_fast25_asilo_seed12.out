[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:57003
[S3] → join 127.0.0.1:57002
[S4] → join 127.0.0.1:57002
[S5] → join 127.0.0.1:57002
[S6] → join 127.0.0.1:57002
[S7] → join 127.0.0.1:57002
[S8] → join 127.0.0.1:57002
[S9] → join 127.0.0.1:57002
[S10] → join 127.0.0.1:57002
[S11] → join 127.0.0.1:57002
[S13] → join 127.0.0.1:57002
[S14] → join 127.0.0.1:57002
[S15] → join 127.0.0.1:57002
[S16] → join 127.0.0.1:57002
[S17] → join 127.0.0.1:57002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.182384 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.218433 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.133327 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.178546 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.207575 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.105663 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.098938 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.154223 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.173371 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.154067 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.189286 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.130507 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.180109 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.183388 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.167553 (no previous merge yet)
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S3] + discovered S6
[S3] + discovered S7
[S3] + discovered S14
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S4
[S3] + discovered S5
[S3] + discovered S11
[S3] + discovered S8
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S9
[S3] + discovered S16
[S3] + discovered S10
[S3] + discovered S17
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S16
[S4] + discovered S9
[S4] + discovered S10
[S4] + discovered S17
[S4] + discovered S6
[S4] + discovered S7
[S4] + discovered S14
[S4] + discovered S15
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S5
[S4] + discovered S8
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S3
[S5] + discovered S13
[S5] + discovered S6
[S5] + discovered S8
[S5] + discovered S14
[S5] + discovered S10
[S5] + discovered S16
[S5] + discovered S11
[S5] + discovered S15
[S5] + discovered S7
[S5] + discovered S17
[S5] + discovered S9
[S6] + discovered S15
[S6] + discovered S11
[S6] + discovered S16
[S6] + discovered S14
[S6] + discovered S7
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S8
[S6] + discovered S17
[S6] + discovered S13
[S7] + discovered S2
[S7] + discovered S6
[S7] + discovered S3
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S17
[S7] + discovered S9
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S16
[S7] + discovered S10
[S7] + discovered S13
[S7] + discovered S11
[S7] + discovered S15
[S8] + discovered S5
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S2
[S8] + discovered S15
[S8] + discovered S9
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S8
[S9] + discovered S6
[S9] + discovered S7
[S9] + discovered S3
[S9] + discovered S5
[S8] + discovered S10
[S8] + discovered S11
[S8] + discovered S13
[S8] + discovered S16
[S8] + discovered S14
[S8] + discovered S17
[S10] + discovered S3
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S9
[S10] + discovered S5
[S10] + discovered S6
[S10] + discovered S8
[S10] + discovered S2
[S9] + discovered S10
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S14
[S9] + discovered S13
[S9] + discovered S11
[S10] + discovered S16
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S11
[S10] + discovered S13
[S10] + discovered S14
[S11] + discovered S6
[S11] + discovered S2
[S11] + discovered S5
[S11] + discovered S3
[S11] + discovered S8
[S11] + discovered S9
[S11] + discovered S4
[S11] + discovered S7
[S11] + discovered S10
[S11] + discovered S14
[S11] + discovered S13
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S15
[S13] + discovered S3
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S10
[S13] + discovered S4
[S13] + discovered S9
[S13] + discovered S8
[S13] + discovered S11
[S13] + discovered S2
[S13] + discovered S6
[S14] + discovered S10
[S14] + discovered S3
[S13] + discovered S15
[S14] + discovered S13
[S14] + discovered S7
[S14] + discovered S4
[S13] + discovered S17
[S14] + discovered S6
[S14] + discovered S9
[S13] + discovered S14
[S14] + discovered S8
[S14] + discovered S2
[S14] + discovered S5
[S14] + discovered S11
[S13] + discovered S16
[S15] + discovered S3
[S15] + discovered S14
[S15] + discovered S10
[S15] + discovered S5
[S15] + discovered S7
[S15] + discovered S9
[S15] + discovered S4
[S15] + discovered S6
[S15] + discovered S8
[S15] + discovered S13
[S15] + discovered S11
[S15] + discovered S2
[S14] + discovered S16
[S14] + discovered S17
[S14] + discovered S15
[S16] + discovered S11
[S16] + discovered S13
[S16] + discovered S6
[S16] + discovered S3
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S8
[S16] + discovered S2
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S14
[S16] + discovered S7
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S4
[S16] + discovered S17
[S17] + discovered S14
[S17] + discovered S7
[S17] + discovered S2
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S15
[S17] + discovered S5
[S17] + discovered S3
[S17] + discovered S10
[S17] + discovered S9
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S13
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=1.000 → S10@127.0.0.1:57011
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:57003
[S7] ⇄ pheromone p=1.000 → S15@127.0.0.1:57015
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:57003
[S15] ⇄ pheromone p=1.000 → S10@127.0.0.1:57011
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:57008
[S4] ⇄ pheromone p=1.000 → S2@127.0.0.1:57002
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:57009
[S14] ⇄ pheromone p=1.000 → S6@127.0.0.1:57007
[S13] ⇄ pheromone p=1.000 → S15@127.0.0.1:57015
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:57010
[S11] ⇄ pheromone p=1.000 → S7@127.0.0.1:57008
[S3] ⇄ pheromone p=1.000 → S15@127.0.0.1:57015
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:57007
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:57009
[S2] START round=1 head_norm_before_train=1.191187 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.621522343541469, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5151097921177397, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.222460 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6688814976453699, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5072064770780675, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.131503 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4386771278469785, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4279582315618133, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.188957 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5574260095998083, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4265537969456166, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.217874 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5844646899827919, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4725315922135878, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.130745 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.688031103380373, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.44080874654383, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.106615 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4376843901069423, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3964471455074003, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.165680 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8522045886930385, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.512743845001336, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.183042 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4719239968841082, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4269789902988033, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.164372 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5968794987259882, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5258124829743418, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.192836 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.485345704601145, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.444688781345366, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.135975 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4687715766107248, 'psi': 0.0}-{'f1_val': 0.00023408239700374532, 'auprc': 0.00023408239700374532, 'loss_val': 1.3989218121321398, 'psi': 0.0002340823970037453}
[S15] START round=1 head_norm_before_train=1.187874 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5116855853431992, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.461212452000726, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.191229 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5064560929867046, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4069711546286439, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.177784 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3984868237098156, 'psi': 0.0}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.3559608815116828, 'psi': 0.30380970798684975}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.209206 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8120643225005404, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.621522343541469, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.256623 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3934778942894024, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6688814976453699, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.140598 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4595958525237493, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4386771278469785, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.223251 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.815148233291861, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5574260095998083, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.240087 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8089281795157366, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5844646899827919, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.175712 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9212043725712253, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.688031103380373, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.127241 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.514502109459194, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4376843901069423, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.213351 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.777081044246052, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8522045886930385, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.202689 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5612357417072127, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4719239968841082, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.184479 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7418415778333916, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5968794987259882, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.208222 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5545165032059098, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.485345704601145, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.153538 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5961982339081693, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4687715766107248, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.204738 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6380496832993336, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5116855853431992, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.210463 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7170513314644196, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5064560929867046, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.198449 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4627237333794558, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3984868237098156, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.237099 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.225855778597251, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8120643225005404, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.312700 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.677945926585321, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3934778942894024, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.161190 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5086918663287705, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4595958525237493, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.262117 (no previous merge yet)
[S5] round=3 local utility u=0.107815 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5995176988071655, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.815148233291861, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.271618 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.352554000065418, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8089281795157366, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.202373 (no previous merge yet)
[S7] round=3 local utility u=0.054973 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8112576755689342, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9212043725712253, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.157058 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6545591209887158, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.514502109459194, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.273651 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.795618011935208, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.777081044246052, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.230635 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7629656918465129, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5612357417072127, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.214068 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1719675208799125, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7418415778333916, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.233295 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7109266277113964, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5545165032059098, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.181730 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.926854049896013, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5961982339081693, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.234483 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.908293676500375, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6380496832993336, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.242202 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.265465398041699, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7170513314644196, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.228798 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6311424991807097, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4627237333794558, 'psi': 0.0}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.270115 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7326905696916928, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.225855778597251, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.349915 (no previous merge yet)
[S3] round=4 local utility u=0.133242 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.411461409844267, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.677945926585321, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.193347 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6193587146789399, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5086918663287705, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.264724 (no previous merge yet)
[S5] round=4 local utility u=0.019893 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5597317662196126, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5995176988071655, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.308832 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.94273458401082, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.352554000065418, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.213585 (no previous merge yet)
[S7] round=4 local utility u=0.291867 metrics={'f1_val': 0.06736609607951408, 'auprc': 0.06736609607951408, 'loss_val': 1.8338189279934582, 'psi': 0.06736609607951408}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8112576755689342, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.186294 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7761721717162133, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6545591209887158, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.320827 (no previous merge yet)
[S9] round=4 local utility u=0.148702 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4982144409804015, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.795618011935208, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.262245 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8717388050138257, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7629656918465129, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.252655 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8555363367931004, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1719675208799125, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.266072 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8498591366034023, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7109266277113964, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.218727 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7427291238565648, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.926854049896013, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.266458 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9844767672321506, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.908293676500375, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.278750 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.918588329188188, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.265465398041699, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.269269 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7595137479041947, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6311424991807097, 'psi': 0.0}
[S7] not sending this round → trigger blocked (psi=0.067)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.298745 (no previous merge yet)
[S2] round=5 local utility u=0.042414 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6478633188905865, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7326905696916928, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.391330 (no previous merge yet)
[S3] round=5 local utility u=0.181563 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0483363222036224, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.411461409844267, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.232112 (no previous merge yet)
[S4] round=5 local utility u=0.025699 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5679611212871956, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6193587146789399, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.291856 (no previous merge yet)
[S5] round=5 local utility u=0.881552 metrics={'f1_val': 0.17302210123368814, 'auprc': 0.17302210123368814, 'loss_val': 1.3538273433831092, 'psi': 0.17302210123368814}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5597317662196126, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.339967 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1794745492008705, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.94273458401082, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.239486 (no previous merge yet)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5231922061018122, 'psi': 0.0}-{'f1_val': 0.06736609607951408, 'auprc': 0.06736609607951408, 'loss_val': 1.8338189279934582, 'psi': 0.06736609607951408}
[S8] START round=5 head_norm_before_train=1.208200 (no previous merge yet)
[S8] round=5 local utility u=0.045254 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6856647758056922, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7761721717162133, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.377465 (no previous merge yet)
[S9] round=5 local utility u=0.137309 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2235960619459587, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4982144409804015, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.284184 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8733531185865067, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8717388050138257, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.287775 (no previous merge yet)
[S11] round=5 local utility u=0.140894 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5737487098063285, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8555363367931004, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.288453 (no previous merge yet)
[S13] round=5 local utility u=0.067328 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7152022783262673, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8498591366034023, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.258403 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2008290675390407, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7427291238565648, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.281666 (no previous merge yet)
[S15] round=5 local utility u=0.050693 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8830908152397456, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9844767672321506, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.306421 (no previous merge yet)
[S16] round=5 local utility u=0.018792 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8810047414994386, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.918588329188188, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.296383 (no previous merge yet)
[S17] round=5 local utility u=0.069532 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6204491076843088, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7595137479041947, 'psi': 0.0}
[S8] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.173)
[S16] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S10] ⇄ pheromone p=0.328 → S7@127.0.0.1:57008
[S13] ⇄ pheromone p=0.341 → S15@127.0.0.1:57015
[S3] ⇄ pheromone p=0.385 → S15@127.0.0.1:57015
[S7] ⇄ pheromone p=0.381 → S15@127.0.0.1:57015
[S8] ⇄ pheromone p=0.337 → S3@127.0.0.1:57003
[S15] ⇄ pheromone p=0.338 → S10@127.0.0.1:57011
[S9] ⇄ pheromone p=0.379 → S3@127.0.0.1:57003
[S11] ⇄ pheromone p=0.356 → S7@127.0.0.1:57008
[S4] ⇄ pheromone p=0.333 → S2@127.0.0.1:57002
[S5] ⇄ pheromone p=0.521 → S9@127.0.0.1:57010
[S6] ⇄ pheromone p=0.328 → S8@127.0.0.1:57009
[S14] ⇄ pheromone p=0.328 → S6@127.0.0.1:57007
[S2] ⇄ pheromone p=0.336 → S10@127.0.0.1:57011
[S16] ⇄ pheromone p=0.331 → S6@127.0.0.1:57007
[S17] ⇄ pheromone p=0.342 → S8@127.0.0.1:57009
[S2] START round=6 head_norm_before_train=1.318312 (no previous merge yet)
[S2] round=6 local utility u=0.059701 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.528461584101739, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6478633188905865, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.446853 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3454626066157243, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0483363222036224, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.258064 (no previous merge yet)
[S4] round=6 local utility u=0.063753 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4404556835576403, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5679611212871956, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.312177 (no previous merge yet)
[S5] round=6 local utility u=1.000000 metrics={'f1_val': 0.47041801153014373, 'auprc': 0.47041801153014373, 'loss_val': 1.2478270481592875, 'psi': 0.47041801153014373}-{'f1_val': 0.17302210123368814, 'auprc': 0.17302210123368814, 'loss_val': 1.3538273433831092, 'psi': 0.17302210123368814}
[S6] START round=6 head_norm_before_train=1.366208 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2742259060228056, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1794745492008705, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.258177 (no previous merge yet)
[S7] round=6 local utility u=0.054365 metrics={'f1_val': 0.0005585032113934655, 'auprc': 0.0005585032113934655, 'loss_val': 1.4194884727853683, 'psi': 0.0005585032113934655}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5231922061018122, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.223757 (no previous merge yet)
[S8] round=6 local utility u=0.094989 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4956872229572225, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6856647758056922, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.440586 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8987717216621143, 'psi': 0.36867172340800847}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2235960619459587, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.303684 (no previous merge yet)
[S10] round=6 local utility u=0.024018 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.825317683361604, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8733531185865067, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.304003 (no previous merge yet)
[S11] round=6 local utility u=0.056706 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.460337361453823, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5737487098063285, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.289775 (no previous merge yet)
[S13] round=6 local utility u=0.022874 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6694534325262136, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7152022783262673, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.284078 (no previous merge yet)
[S14] round=6 local utility u=0.041647 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.11753565757419, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2008290675390407, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.292057 (no previous merge yet)
[S15] round=6 local utility u=0.081241 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7206078768957842, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8830908152397456, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.322232 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.938540481815973, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8810047414994386, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.311359 (no previous merge yet)
[S17] round=6 local utility u=0.061264 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4979202549924127, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6204491076843088, 'psi': 0.0}
[S10] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:57010
[S7] not sending this round → trigger blocked (psi=0.001)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[S11] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=0.0323
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] cosine check vs S5: cos=0.1194
[S17] not sending this round → trigger blocked (psi=0.000)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.0000 head_norm=1.513650
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.048612e+00
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.0000 head_norm=1.083100 delta_norm=1.048612
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.3687 head_norm=1.501415
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.470420e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.2359 head_norm=1.067013 delta_norm=0.947042
[S9] aggregate: ROLLBACK (f1_val pre=0.369 post=0.236 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.341074 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0731887874319717, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.528461584101739, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.083100 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.010582 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3242994391702374, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3454626066157243, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.277659 (no previous merge yet)
[S4] round=7 local utility u=0.027523 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3854091561036268, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4404556835576403, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.347800 (no previous merge yet)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.37309725911855346, 'auprc': 0.37309725911855346, 'loss_val': 1.1586884349893212, 'psi': 0.37309725911855346}-{'f1_val': 0.47041801153014373, 'auprc': 0.47041801153014373, 'loss_val': 1.2478270481592875, 'psi': 0.47041801153014373}
[S6] START round=7 head_norm_before_train=1.392595 (no previous merge yet)
[S6] round=7 local utility u=0.150679 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9728680793375757, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2742259060228056, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.286862 (no previous merge yet)
[S7] round=7 local utility u=0.710601 metrics={'f1_val': 0.14960971379011276, 'auprc': 0.14960971379011276, 'loss_val': 1.3397478157306635, 'psi': 0.14960971379011276}-{'f1_val': 0.0005585032113934655, 'auprc': 0.0005585032113934655, 'loss_val': 1.4194884727853683, 'psi': 0.0005585032113934655}
[S8] START round=7 head_norm_before_train=1.234012 (no previous merge yet)
[S8] round=7 local utility u=0.935503 metrics={'f1_val': 0.20152702431183445, 'auprc': 0.20152702431183445, 'loss_val': 1.4384249268700042, 'psi': 0.20152702431183445}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4956872229572225, 'psi': 0.0}
[S9] START round=7 head_norm_before_train=1.067013 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.18012506797172376, 'auprc': 0.18012506797172376, 'loss_val': 1.7448089229752264, 'psi': 0.18012506797172376}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8987717216621143, 'psi': 0.36867172340800847}
[S10] START round=7 head_norm_before_train=1.321022 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1603791641818337, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.825317683361604, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.326238 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7486093875225053, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.460337361453823, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.298345 (no previous merge yet)
[S13] round=7 local utility u=0.011486 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.646480580883329, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6694534325262136, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.301727 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1481551423938474, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.11753565757419, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.301482 (no previous merge yet)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8065052097786578, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7206078768957842, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.342874 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.984364636064041, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.938540481815973, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.333868 (no previous merge yet)
[S17] round=7 local utility u=0.951551 metrics={'f1_val': 0.2013852587558808, 'auprc': 0.2013852587558808, 'loss_val': 1.4072857251829005, 'psi': 0.2013852587558808}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4979202549924127, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:57003
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.150)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1792 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S8
[S3] cosine check vs S8: cos=-0.0285
[S3] DROPPED delta from S8 (cos=-0.0285 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=-0.0364
[S8] DROPPED delta from S17 (cos=-0.0364 < 0.0)
[S2] START round=8 head_norm_before_train=1.375564 (no previous merge yet)
[S2] round=8 local utility u=0.100869 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8714500729915415, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0731887874319717, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.156598 cos_to_last_merge=0.9934 (last merge round=6)
[S3] round=8 local utility u=0.776853 metrics={'f1_val': 0.13370399788191686, 'auprc': 0.13370399788191686, 'loss_val': 1.9739291945172996, 'psi': 0.13370399788191686}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3242994391702374, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.313723 (no previous merge yet)
[S4] round=8 local utility u=0.022532 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3403450709337683, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3854091561036268, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.393605 (no previous merge yet)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.3541105414095768, 'auprc': 0.3541105414095768, 'loss_val': 1.1061997564408401, 'psi': 0.3541105414095768}-{'f1_val': 0.37309725911855346, 'auprc': 0.37309725911855346, 'loss_val': 1.1586884349893212, 'psi': 0.37309725911855346}
[S6] START round=8 head_norm_before_train=1.417021 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2753777437853935, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9728680793375757, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.315725 (no previous merge yet)
[S7] round=8 local utility u=0.027037 metrics={'f1_val': 0.15559365623660523, 'auprc': 0.15559365623660523, 'loss_val': 1.339528972047002, 'psi': 0.15559365623660523}-{'f1_val': 0.14960971379011276, 'auprc': 0.14960971379011276, 'loss_val': 1.3397478157306635, 'psi': 0.14960971379011276}
[S8] START round=8 head_norm_before_train=1.258366 (no previous merge yet)
[S8] round=8 local utility u=0.362597 metrics={'f1_val': 0.2750966565672493, 'auprc': 0.2750966565672493, 'loss_val': 1.3753570772460504, 'psi': 0.2750966565672493}-{'f1_val': 0.20152702431183445, 'auprc': 0.20152702431183445, 'loss_val': 1.4384249268700042, 'psi': 0.20152702431183445}
[S9] START round=8 head_norm_before_train=1.145303 cos_to_last_merge=0.9937 (last merge round=6)
[S9] round=8 local utility u=0.857381 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7269671021210762, 'psi': 0.36867172340800847}-{'f1_val': 0.18012506797172376, 'auprc': 0.18012506797172376, 'loss_val': 1.7448089229752264, 'psi': 0.18012506797172376}
[S10] START round=8 head_norm_before_train=1.350527 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.57954304470218, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1603791641818337, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.354021 (no previous merge yet)
[S11] round=8 local utility u=0.083564 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.581480594002428, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7486093875225053, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.313612 (no previous merge yet)
[S13] round=8 local utility u=0.005982 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.634516896709846, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.646480580883329, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.322897 (no previous merge yet)
[S14] round=8 local utility u=0.046356 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.055442941015539, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1481551423938474, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.325555 (no previous merge yet)
[S15] round=8 local utility u=0.510881 metrics={'f1_val': 0.09253417455310199, 'auprc': 0.09253417455310199, 'loss_val': 1.6175498072911652, 'psi': 0.09253417455310199}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8065052097786578, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.368227 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1817019822502037, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.984364636064041, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.364343 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.1609301372669535, 'auprc': 0.1609301372669535, 'loss_val': 1.3200862327610499, 'psi': 0.1609301372669535}-{'f1_val': 0.2013852587558808, 'auprc': 0.2013852587558808, 'loss_val': 1.4072857251829005, 'psi': 0.2013852587558808}
[S14] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.093)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.134)
[S2] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.156)
[S4] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.275)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:57003
[S9] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S9
[S3] cosine check vs S9: cos=0.5421
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.1337 head_norm=1.234694
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.914297e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.085369 delta_norm=0.591430
[S3] aggregate: ROLLBACK (f1_val pre=0.134 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=1.408589 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1346206209612792, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8714500729915415, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.085369 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.1337571182624818, 'auprc': 0.1337571182624818, 'loss_val': 2.2177020368345457, 'psi': 0.1337571182624818}-{'f1_val': 0.13370399788191686, 'auprc': 0.13370399788191686, 'loss_val': 1.9739291945172996, 'psi': 0.13370399788191686}
[S4] START round=9 head_norm_before_train=1.350312 (no previous merge yet)
[S4] round=9 local utility u=0.007643 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.325058079093562, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3403450709337683, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.441397 (no previous merge yet)
[S5] round=9 local utility u=1.000000 metrics={'f1_val': 0.6633380696799851, 'auprc': 0.6633380696799851, 'loss_val': 1.0383638613946735, 'psi': 0.6633380696799851}-{'f1_val': 0.3541105414095768, 'auprc': 0.3541105414095768, 'loss_val': 1.1061997564408401, 'psi': 0.3541105414095768}
[S6] START round=9 head_norm_before_train=1.446552 (no previous merge yet)
[S6] round=9 local utility u=0.090651 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0940758586629853, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2753777437853935, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.344689 (no previous merge yet)
[S7] round=9 local utility u=0.053943 metrics={'f1_val': 0.16684133305386714, 'auprc': 0.16684133305386714, 'loss_val': 1.3328718347506772, 'psi': 0.16684133305386714}-{'f1_val': 0.15559365623660523, 'auprc': 0.15559365623660523, 'loss_val': 1.339528972047002, 'psi': 0.15559365623660523}
[S8] START round=9 head_norm_before_train=1.287995 (no previous merge yet)
[S8] round=9 local utility u=0.118913 metrics={'f1_val': 0.2903095411429787, 'auprc': 0.2903095411429787, 'loss_val': 1.274446832246279, 'psi': 0.2903095411429787}-{'f1_val': 0.2750966565672493, 'auprc': 0.2750966565672493, 'loss_val': 1.3753570772460504, 'psi': 0.2750966565672493}
[S9] START round=9 head_norm_before_train=1.237400 cos_to_last_merge=0.9797 (last merge round=6)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.874499698832696, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.7269671021210762, 'psi': 0.36867172340800847}
[S10] START round=9 head_norm_before_train=1.382608 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0333057925710234, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.57954304470218, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.380753 (no previous merge yet)
[S11] round=9 local utility u=0.264282 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0529165815456607, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.581480594002428, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.334057 (no previous merge yet)
[S13] round=9 local utility u=0.046782 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5409531961972764, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.634516896709846, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.344849 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.327437107341445, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.055442941015539, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.349177 (no previous merge yet)
[S15] round=9 local utility u=0.533719 metrics={'f1_val': 0.1900408948761126, 'auprc': 0.1900408948761126, 'loss_val': 1.4276724656674322, 'psi': 0.1900408948761126}-{'f1_val': 0.09253417455310199, 'auprc': 0.09253417455310199, 'loss_val': 1.6175498072911652, 'psi': 0.09253417455310199}
[S16] START round=9 head_norm_before_train=1.398060 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4015396403846476, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1817019822502037, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.395978 (no previous merge yet)
[S17] round=9 local utility u=0.017268 metrics={'f1_val': 0.16020803589638996, 'auprc': 0.16020803589638996, 'loss_val': 1.2790522556495934, 'psi': 0.16020803589638996}-{'f1_val': 0.1609301372669535, 'auprc': 0.1609301372669535, 'loss_val': 1.3200862327610499, 'psi': 0.1609301372669535}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.190)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:57003
[S6] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.167)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=-0.0152
[S3] DROPPED delta from S8 (cos=-0.0152 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.5838
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=-0.0422
[S8] DROPPED delta from S17 (cos=-0.0422 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.3687 head_norm=1.314708
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.450523e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.3687 head_norm=1.249458 delta_norm=0.645052
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.440711 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2213853810398936, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1346206209612792, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.149077 cos_to_last_merge=0.9930 (last merge round=8)
[S3] round=10 local utility u=0.832424 metrics={'f1_val': 0.2956505947516571, 'auprc': 0.2956505947516571, 'loss_val': 2.009895362404182, 'psi': 0.2956505947516571}-{'f1_val': 0.1337571182624818, 'auprc': 0.1337571182624818, 'loss_val': 2.2177020368345457, 'psi': 0.1337571182624818}
[S4] START round=10 head_norm_before_train=1.388241 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.329042987789264, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.325058079093562, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.491984 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.1321008568895428, 'psi': 0.3335071121394324}-{'f1_val': 0.6633380696799851, 'auprc': 0.6633380696799851, 'loss_val': 1.0383638613946735, 'psi': 0.6633380696799851}
[S6] START round=10 head_norm_before_train=1.479217 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.105270604300275, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0940758586629853, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.366811 (no previous merge yet)
[S7] round=10 local utility u=0.213927 metrics={'f1_val': 0.21131691171790465, 'auprc': 0.21131691171790465, 'loss_val': 1.305298827483814, 'psi': 0.21131691171790465}-{'f1_val': 0.16684133305386714, 'auprc': 0.16684133305386714, 'loss_val': 1.3328718347506772, 'psi': 0.16684133305386714}
[S8] START round=10 head_norm_before_train=1.315545 (no previous merge yet)
[S8] round=10 local utility u=0.154958 metrics={'f1_val': 0.3187698157292741, 'auprc': 0.3187698157292741, 'loss_val': 1.2206733628533666, 'psi': 0.3187698157292741}-{'f1_val': 0.2903095411429787, 'auprc': 0.2903095411429787, 'loss_val': 1.274446832246279, 'psi': 0.2903095411429787}
[S9] START round=10 head_norm_before_train=1.249458 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.196415 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4816701102847336, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.874499698832696, 'psi': 0.36867172340800847}
[S10] START round=10 head_norm_before_train=1.415244 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2089211583900763, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0333057925710234, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.406976 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.334712187215943, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0529165815456607, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.353391 (no previous merge yet)
[S13] round=10 local utility u=0.062497 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4159598816896002, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5409531961972764, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.371091 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7803398777195625, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.327437107341445, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.378417 (no previous merge yet)
[S15] round=10 local utility u=0.010975 metrics={'f1_val': 0.1824153030652224, 'auprc': 0.1824153030652224, 'loss_val': 1.337092977381517, 'psi': 0.1824153030652224}-{'f1_val': 0.1900408948761126, 'auprc': 0.1900408948761126, 'loss_val': 1.4276724656674322, 'psi': 0.1900408948761126}
[S16] START round=10 head_norm_before_train=1.429101 (no previous merge yet)
[S16] round=10 local utility u=0.007560 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3864206393560368, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4015396403846476, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.426595 (no previous merge yet)
[S17] round=10 local utility u=0.049159 metrics={'f1_val': 0.1691445809092868, 'auprc': 0.1691445809092868, 'loss_val': 1.2611630816645296, 'psi': 0.1691445809092868}-{'f1_val': 0.16020803589638996, 'auprc': 0.16020803589638996, 'loss_val': 1.2790522556495934, 'psi': 0.16020803589638996}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:57003
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:57003
[S15] not sending this round → trigger blocked (psi=0.182)
[S16] not sending this round → trigger blocked (psi=0.000)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.6779
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=-0.0136
[S3] DROPPED delta from S8 (cos=-0.0136 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S3
[S15] cosine check vs S3: cos=0.0202
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=0.0670
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=-0.0437
[S8] DROPPED delta from S17 (cos=-0.0437 < 0.0)
[S6] ⇄ pheromone p=0.137 → S8@127.0.0.1:57009
[S4] ⇄ pheromone p=0.121 → S2@127.0.0.1:57002
[S13] ⇄ pheromone p=0.136 → S15@127.0.0.1:57015
[S14] ⇄ pheromone p=0.117 → S6@127.0.0.1:57007
[S10] ⇄ pheromone p=0.109 → S7@127.0.0.1:57008
[S2] ⇄ pheromone p=0.128 → S10@127.0.0.1:57011
[S5] ⇄ pheromone p=0.413 → S9@127.0.0.1:57010
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.1824 head_norm=1.411542
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.366833e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.2030 head_norm=0.885077 delta_norm=0.836683
[S15] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.270 → S10@127.0.0.1:57011
[S11] ⇄ pheromone p=0.174 → S7@127.0.0.1:57008
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.2957 head_norm=1.228242
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.119110e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.2975 head_norm=1.164947 delta_norm=0.511911
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.393 → S15@127.0.0.1:57015
[S7] ⇄ pheromone p=0.257 → S15@127.0.0.1:57015
[S8] ⇄ pheromone p=0.310 → S3@127.0.0.1:57003
[S9] ⇄ pheromone p=0.355 → S3@127.0.0.1:57003
[S16] ⇄ pheromone p=0.110 → S6@127.0.0.1:57007
[S17] ⇄ pheromone p=0.227 → S8@127.0.0.1:57009
[S2] START round=11 head_norm_before_train=1.475113 (no previous merge yet)
[S2] round=11 local utility u=0.126800 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9677849942238597, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2213853810398936, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.164947 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.063267 metrics={'f1_val': 0.2929617720614505, 'auprc': 0.2929617720614505, 'loss_val': 1.8591615151423277, 'psi': 0.2929617720614505}-{'f1_val': 0.2956505947516571, 'auprc': 0.2956505947516571, 'loss_val': 2.009895362404182, 'psi': 0.2956505947516571}
[S4] START round=11 head_norm_before_train=1.427125 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3451042033077698, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.329042987789264, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.533543 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.029428043322896, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.1321008568895428, 'psi': 0.3335071121394324}
[S6] START round=11 head_norm_before_train=1.516408 (no previous merge yet)
[S6] round=11 local utility u=0.098040 metrics={'f1_val': 0.0019074868860276585, 'auprc': 0.0019074868860276585, 'loss_val': 3.9263582144063984, 'psi': 0.0019074868860276585}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.105270604300275, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.391813 (no previous merge yet)
[S7] round=11 local utility u=0.690427 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2604659804052136, 'psi': 0.35976373724718097}-{'f1_val': 0.21131691171790465, 'auprc': 0.21131691171790465, 'loss_val': 1.305298827483814, 'psi': 0.21131691171790465}
[S8] START round=11 head_norm_before_train=1.351153 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.2739817823160826, 'auprc': 0.2739817823160826, 'loss_val': 1.1609544566640952, 'psi': 0.2739817823160826}-{'f1_val': 0.3187698157292741, 'auprc': 0.3187698157292741, 'loss_val': 1.2206733628533666, 'psi': 0.3187698157292741}
[S9] START round=11 head_norm_before_train=1.315193 cos_to_last_merge=0.9965 (last merge round=9)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6564467769955695, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4816701102847336, 'psi': 0.36867172340800847}
[S10] START round=11 head_norm_before_train=1.444776 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3309814675212954, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2089211583900763, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.439692 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3782075790845276, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.334712187215943, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.367061 (no previous merge yet)
[S13] round=11 local utility u=0.239290 metrics={'f1_val': 0.04663923182441701, 'auprc': 0.04663923182441701, 'loss_val': 1.3571322073148269, 'psi': 0.04663923182441701}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4159598816896002, 'psi': 0.0}
[S14] START round=11 head_norm_before_train=1.400735 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.577236958105952, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7803398777195625, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=0.885077 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.577848 metrics={'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.2757831060629645, 'psi': 0.3040138275398502}-{'f1_val': 0.1824153030652224, 'auprc': 0.1824153030652224, 'loss_val': 1.337092977381517, 'psi': 0.1824153030652224}
[S16] START round=11 head_norm_before_train=1.454136 (no previous merge yet)
[S16] round=11 local utility u=0.178477 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0294674610738985, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3864206393560368, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.449703 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.15215877437325906, 'auprc': 0.15215877437325906, 'loss_val': 1.288802782268504, 'psi': 0.15215877437325906}-{'f1_val': 0.1691445809092868, 'auprc': 0.1691445809092868, 'loss_val': 1.2611630816645296, 'psi': 0.1691445809092868}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.047)
[S2] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.002)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:57011
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] cosine check vs S15: cos=-0.0210
[S10] DROPPED delta from S15 (cos=-0.0210 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S3
[S15] cosine check vs S3: cos=0.3749
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=0.4704
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.3040 head_norm=0.927705
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.454349e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.3040 head_norm=0.850673 delta_norm=0.445435
[S15] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.507203 (no previous merge yet)
[S2] round=12 local utility u=0.412453 metrics={'f1_val': 0.046172330930312394, 'auprc': 0.046172330930312394, 'loss_val': 2.5584299974017903, 'psi': 0.046172330930312394}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9677849942238597, 'psi': 0.0}
[S3] START round=12 head_norm_before_train=1.242932 cos_to_last_merge=0.9914 (last merge round=10)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.2972107910379515, 'auprc': 0.2972107910379515, 'loss_val': 2.2216503181574425, 'psi': 0.2972107910379515}-{'f1_val': 0.2929617720614505, 'auprc': 0.2929617720614505, 'loss_val': 1.8591615151423277, 'psi': 0.2929617720614505}
[S4] START round=12 head_norm_before_train=1.465004 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3716243933198695, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3451042033077698, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.568706 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.411509286164826, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.029428043322896, 'psi': 0.3335071121394324}
[S6] START round=12 head_norm_before_train=1.547187 (no previous merge yet)
[S6] round=12 local utility u=0.071327 metrics={'f1_val': 0.0007170172084130019, 'auprc': 0.0007170172084130019, 'loss_val': 3.772989489652979, 'psi': 0.0007170172084130019}-{'f1_val': 0.0019074868860276585, 'auprc': 0.0019074868860276585, 'loss_val': 3.9263582144063984, 'psi': 0.0019074868860276585}
[S7] START round=12 head_norm_before_train=1.416354 (no previous merge yet)
[S7] round=12 local utility u=0.025658 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.209150312722577, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2604659804052136, 'psi': 0.35976373724718097}
[S8] START round=12 head_norm_before_train=1.387306 (no previous merge yet)
[S8] round=12 local utility u=0.112251 metrics={'f1_val': 0.29307455051853376, 'auprc': 0.29307455051853376, 'loss_val': 1.1082867336461015, 'psi': 0.29307455051853376}-{'f1_val': 0.2739817823160826, 'auprc': 0.2739817823160826, 'loss_val': 1.1609544566640952, 'psi': 0.2739817823160826}
[S9] START round=12 head_norm_before_train=1.387496 cos_to_last_merge=0.9887 (last merge round=9)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8380580622611307, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6564467769955695, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=1.471369 (no previous merge yet)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.406822907883461, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3309814675212954, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.474021 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0050832961494796, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3782075790845276, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.388297 (no previous merge yet)
[S13] round=12 local utility u=1.000000 metrics={'f1_val': 0.2942415087430193, 'auprc': 0.2942415087430193, 'loss_val': 1.2574190592571868, 'psi': 0.2942415087430193}-{'f1_val': 0.04663923182441701, 'auprc': 0.04663923182441701, 'loss_val': 1.3571322073148269, 'psi': 0.04663923182441701}
[S14] START round=12 head_norm_before_train=1.432418 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.989383470181896, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.577236958105952, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=0.850673 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.280608399015264, 'psi': 0.3040138275398502}-{'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.2757831060629645, 'psi': 0.3040138275398502}
[S16] START round=12 head_norm_before_train=1.473915 (no previous merge yet)
[S16] round=12 local utility u=0.085340 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8587867706596253, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0294674610738985, 'psi': 0.0}
[S17] START round=12 head_norm_before_train=1.473322 (no previous merge yet)
[S17] round=12 local utility u=0.107745 metrics={'f1_val': 0.17080339647289353, 'auprc': 0.17080339647289353, 'loss_val': 1.2411147695864742, 'psi': 0.17080339647289353}-{'f1_val': 0.15215877437325906, 'auprc': 0.15215877437325906, 'loss_val': 1.288802782268504, 'psi': 0.15215877437325906}
[S16] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[S6] not sending this round → trigger blocked (psi=0.001)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.046)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:57003
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.0088
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=0.6762
[S15] RECEIVED delta(kind=head bytes=1796) from S13
[S15] cosine check vs S13: cos=0.0920
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=-0.0443
[S8] DROPPED delta from S17 (cos=-0.0443 < 0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.3040 head_norm=0.898981
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.824195e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.1199 head_norm=0.854733 delta_norm=0.482419
[S15] aggregate: ROLLBACK (f1_val pre=0.304 post=0.120 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.2972 head_norm=1.327335
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.690827e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.2889 head_norm=0.977609 delta_norm=0.969083
[S3] aggregate: ROLLBACK (f1_val pre=0.297 post=0.289 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.536592 (no previous merge yet)
[S2] round=13 local utility u=0.699325 metrics={'f1_val': 0.19328922495274103, 'auprc': 0.19328922495274103, 'loss_val': 2.483832199889756, 'psi': 0.19328922495274103}-{'f1_val': 0.046172330930312394, 'auprc': 0.046172330930312394, 'loss_val': 2.5584299974017903, 'psi': 0.046172330930312394}
[S3] START round=13 head_norm_before_train=0.977609 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.198599 metrics={'f1_val': 0.2943674976915974, 'auprc': 0.2943674976915974, 'loss_val': 1.7988634361154323, 'psi': 0.2943674976915974}-{'f1_val': 0.2972107910379515, 'auprc': 0.2972107910379515, 'loss_val': 2.2216503181574425, 'psi': 0.2972107910379515}
[S4] START round=13 head_norm_before_train=1.500109 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3863066388840217, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3716243933198695, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.603695 (no previous merge yet)
[S5] round=13 local utility u=0.129312 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1566725864149467, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.411509286164826, 'psi': 0.33308623671855697}
[S6] START round=13 head_norm_before_train=1.572873 (no previous merge yet)
[S6] round=13 local utility u=0.012828 metrics={'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 3.9484149254923575, 'psi': 0.023059360730593607}-{'f1_val': 0.0007170172084130019, 'auprc': 0.0007170172084130019, 'loss_val': 3.772989489652979, 'psi': 0.0007170172084130019}
[S7] START round=13 head_norm_before_train=1.446371 (no previous merge yet)
[S7] round=13 local utility u=0.010772 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1876064619757651, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.209150312722577, 'psi': 0.35976373724718097}
[S8] START round=13 head_norm_before_train=1.424030 (no previous merge yet)
[S8] round=13 local utility u=1.000000 metrics={'f1_val': 0.580503481030703, 'auprc': 0.580503481030703, 'loss_val': 1.0423204497409426, 'psi': 0.580503481030703}-{'f1_val': 0.29307455051853376, 'auprc': 0.29307455051853376, 'loss_val': 1.1082867336461015, 'psi': 0.29307455051853376}
[S9] START round=13 head_norm_before_train=1.445596 cos_to_last_merge=0.9813 (last merge round=9)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9705938130347163, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8380580622611307, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=1.496542 (no previous merge yet)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4113600847759296, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.406822907883461, 'psi': 0.0}
[S11] START round=13 head_norm_before_train=1.504424 (no previous merge yet)
[S11] round=13 local utility u=0.133786 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7375116792798577, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0050832961494796, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.408574 (no previous merge yet)
[S13] round=13 local utility u=1.000000 metrics={'f1_val': 0.6314022973626932, 'auprc': 0.6314022973626932, 'loss_val': 1.1902429619517074, 'psi': 0.6314022973626932}-{'f1_val': 0.2942415087430193, 'auprc': 0.2942415087430193, 'loss_val': 1.2574190592571868, 'psi': 0.2942415087430193}
[S14] START round=13 head_norm_before_train=1.460562 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.219286476330984, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.989383470181896, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=0.854733 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.342025634311118, 'psi': 0.0}-{'f1_val': 0.3040138275398502, 'auprc': 0.3040138275398502, 'loss_val': 1.280608399015264, 'psi': 0.3040138275398502}
[S16] START round=13 head_norm_before_train=1.491855 (no previous merge yet)
[S16] round=13 local utility u=0.099025 metrics={'f1_val': 0.0002304147465437788, 'auprc': 0.0002304147465437788, 'loss_val': 2.662809858913828, 'psi': 0.0002304147465437788}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8587867706596253, 'psi': 0.0}
[S17] START round=13 head_norm_before_train=1.498040 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.15713142628525706, 'auprc': 0.15713142628525706, 'loss_val': 1.1578655379082192, 'psi': 0.15713142628525706}-{'f1_val': 0.17080339647289353, 'auprc': 0.17080339647289353, 'loss_val': 1.2411147695864742, 'psi': 0.17080339647289353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[S2] not sending this round → trigger blocked (psi=0.193)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:57010
[S6] not sending this round → trigger blocked (psi=0.023)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:57003
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.6682
[S15] RECEIVED delta(kind=head bytes=1797) from S3
[S15] cosine check vs S3: cos=0.3091
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] cosine check vs S13: cos=0.4764
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=0.7847
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.8040
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.3687 head_norm=1.488603
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.928407e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.3687 head_norm=1.481464 delta_norm=0.492841
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.0000 head_norm=0.901781
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.450697e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.0000 head_norm=0.822708 delta_norm=0.245070
[S15] aggregate: ACCEPT kept=['S3', 'S13', 'S7'] (k=3/3) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.2944 head_norm=1.061033
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.439252e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.2832 head_norm=1.152870 delta_norm=0.543925
[S3] aggregate: ROLLBACK (f1_val pre=0.294 post=0.283 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.564170 (no previous merge yet)
[S2] round=14 local utility u=0.415784 metrics={'f1_val': 0.2643768916962758, 'auprc': 0.2643768916962758, 'loss_val': 2.2920528474688915, 'psi': 0.2643768916962758}-{'f1_val': 0.19328922495274103, 'auprc': 0.19328922495274103, 'loss_val': 2.483832199889756, 'psi': 0.19328922495274103}
[S3] START round=14 head_norm_before_train=1.152870 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.029432 metrics={'f1_val': 0.29006634893935146, 'auprc': 0.29006634893935146, 'loss_val': 1.701289687576552, 'psi': 0.29006634893935146}-{'f1_val': 0.2943674976915974, 'auprc': 0.2943674976915974, 'loss_val': 1.7988634361154323, 'psi': 0.2943674976915974}
[S4] START round=14 head_norm_before_train=1.533920 (no previous merge yet)
[S4] round=14 local utility u=0.001352 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3836036141413286, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3863066388840217, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.630741 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4212586523728477, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.1566725864149467, 'psi': 0.3335071121394324}
[S6] START round=14 head_norm_before_train=1.598045 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 4.4454466193842626, 'psi': 0.017105871474803514}-{'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 3.9484149254923575, 'psi': 0.023059360730593607}
[S7] START round=14 head_norm_before_train=1.473927 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1935552627211077, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1876064619757651, 'psi': 0.35976373724718097}
[S8] START round=14 head_norm_before_train=1.457441 (no previous merge yet)
[S8] round=14 local utility u=1.000000 metrics={'f1_val': 0.9994356513935347, 'auprc': 0.9994356513935347, 'loss_val': 0.9847336041343994, 'psi': 0.9994356513935347}-{'f1_val': 0.580503481030703, 'auprc': 0.580503481030703, 'loss_val': 1.0423204497409426, 'psi': 0.580503481030703}
[S9] START round=14 head_norm_before_train=1.481464 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.212340 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5459142553708152, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9705938130347163, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.521183 (no previous merge yet)
[S10] round=14 local utility u=0.985866 metrics={'f1_val': 0.2035987531878719, 'auprc': 0.2035987531878719, 'loss_val': 3.2720164658901383, 'psi': 0.2035987531878719}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4113600847759296, 'psi': 0.0}
[S11] START round=14 head_norm_before_train=1.528494 (no previous merge yet)
[S11] round=14 local utility u=0.100907 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5356984943428857, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7375116792798577, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.433440 (no previous merge yet)
[S13] round=14 local utility u=0.148176 metrics={'f1_val': 0.6546869664166003, 'auprc': 0.6546869664166003, 'loss_val': 1.103453461788269, 'psi': 0.6546869664166003}-{'f1_val': 0.6314022973626932, 'auprc': 0.6314022973626932, 'loss_val': 1.1902429619517074, 'psi': 0.6314022973626932}
[S14] START round=14 head_norm_before_train=1.486427 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.5152569271895535, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.219286476330984, 'psi': 0.0}
[S15] START round=14 head_norm_before_train=0.822708 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.005156 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3317134213729473, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.342025634311118, 'psi': 0.0}
[S16] START round=14 head_norm_before_train=1.513975 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.00016600265604249667, 'auprc': 0.00016600265604249667, 'loss_val': 3.065651438394925, 'psi': 0.00016600265604249667}-{'f1_val': 0.0002304147465437788, 'auprc': 0.0002304147465437788, 'loss_val': 2.662809858913828, 'psi': 0.0002304147465437788}
[S17] START round=14 head_norm_before_train=1.522472 (no previous merge yet)
[S17] round=14 local utility u=0.019208 metrics={'f1_val': 0.1553599683544304, 'auprc': 0.1553599683544304, 'loss_val': 1.103506546003702, 'psi': 0.1553599683544304}-{'f1_val': 0.15713142628525706, 'auprc': 0.15713142628525706, 'loss_val': 1.1578655379082192, 'psi': 0.15713142628525706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:57011
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[S15] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:57008
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.8887
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=0.3243
[S10] RECEIVED delta(kind=head bytes=1803) from S2
[S10] cosine check vs S2: cos=-0.0021
[S10] DROPPED delta from S2 (cos=-0.0021 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S3
[S15] cosine check vs S3: cos=0.3641
[S15] RECEIVED delta(kind=head bytes=1797) from S13
[S15] cosine check vs S13: cos=0.5413
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=-0.0196
[S7] DROPPED delta from S10 (cos=-0.0196 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.0378
[S8] DROPPED delta from S17 (cos=-0.0378 < 0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.0000 head_norm=0.872638
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.986750e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.0000 head_norm=0.834576 delta_norm=0.398675
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.2901 head_norm=1.210572
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.399955e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.2837 head_norm=1.102410 delta_norm=0.339996
[S3] aggregate: ROLLBACK (f1_val pre=0.290 post=0.284 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.594793 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.18928220255653883, 'auprc': 0.18928220255653883, 'loss_val': 2.805665076783546, 'psi': 0.18928220255653883}-{'f1_val': 0.2643768916962758, 'auprc': 0.2643768916962758, 'loss_val': 2.2920528474688915, 'psi': 0.2643768916962758}
[S3] START round=15 head_norm_before_train=1.102410 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.056420 metrics={'f1_val': 0.29745275267050125, 'auprc': 0.29745275267050125, 'loss_val': 1.6549276416894896, 'psi': 0.29745275267050125}-{'f1_val': 0.29006634893935146, 'auprc': 0.29006634893935146, 'loss_val': 1.701289687576552, 'psi': 0.29006634893935146}
[S4] START round=15 head_norm_before_train=1.574742 (no previous merge yet)
[S4] round=15 local utility u=0.001621 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3803611000545306, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3836036141413286, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.648147 (no previous merge yet)
[S5] round=15 local utility u=0.015888 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3894831409065627, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4212586523728477, 'psi': 0.3335071121394324}
[S6] START round=15 head_norm_before_train=1.620275 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.016658954187875982, 'auprc': 0.016658954187875982, 'loss_val': 5.068810873795902, 'psi': 0.016658954187875982}-{'f1_val': 0.017105871474803514, 'auprc': 0.017105871474803514, 'loss_val': 4.4454466193842626, 'psi': 0.017105871474803514}
[S7] START round=15 head_norm_before_train=1.503141 (no previous merge yet)
[S7] round=15 local utility u=0.026417 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1407215079235742, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1935552627211077, 'psi': 0.35976373724718097}
[S8] START round=15 head_norm_before_train=1.488233 (no previous merge yet)
[S8] round=15 local utility u=0.018689 metrics={'f1_val': 0.9994354958690915, 'auprc': 0.9994354958690915, 'loss_val': 0.9473548712456107, 'psi': 0.9994354958690915}-{'f1_val': 0.9994356513935347, 'auprc': 0.9994356513935347, 'loss_val': 0.9847336041343994, 'psi': 0.9994356513935347}
[S9] START round=15 head_norm_before_train=1.524173 cos_to_last_merge=0.9990 (last merge round=13)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.734825906569391, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.5459142553708152, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.545494 (no previous merge yet)
[S10] round=15 local utility u=0.254480 metrics={'f1_val': 0.24952107279693486, 'auprc': 0.24952107279693486, 'loss_val': 3.1763575925908616, 'psi': 0.24952107279693486}-{'f1_val': 0.2035987531878719, 'auprc': 0.2035987531878719, 'loss_val': 3.2720164658901383, 'psi': 0.2035987531878719}
[S11] START round=15 head_norm_before_train=1.549822 (no previous merge yet)
[S11] round=15 local utility u=1.000000 metrics={'f1_val': 0.25839054157131963, 'auprc': 0.25839054157131963, 'loss_val': 2.6004015195360113, 'psi': 0.25839054157131963}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5356984943428857, 'psi': 0.0}
[S13] START round=15 head_norm_before_train=1.461841 (no previous merge yet)
[S13] round=15 local utility u=0.079444 metrics={'f1_val': 0.663880801094115, 'auprc': 0.663880801094115, 'loss_val': 1.0273101065916161, 'psi': 0.663880801094115}-{'f1_val': 0.6546869664166003, 'auprc': 0.6546869664166003, 'loss_val': 1.103453461788269, 'psi': 0.6546869664166003}
[S14] START round=15 head_norm_before_train=1.511794 (no previous merge yet)
[S14] round=15 local utility u=0.196083 metrics={'f1_val': 0.04373927958833619, 'auprc': 0.04373927958833619, 'loss_val': 5.516744079804965, 'psi': 0.04373927958833619}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.5152569271895535, 'psi': 0.0}
[S15] START round=15 head_norm_before_train=0.834576 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.003281 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3251516293667762, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3317134213729473, 'psi': 0.0}
[S16] START round=15 head_norm_before_train=1.538116 (no previous merge yet)
[S16] round=15 local utility u=0.032963 metrics={'f1_val': 0.0028346456692913387, 'auprc': 0.0028346456692913387, 'loss_val': 3.023743246852463, 'psi': 0.0028346456692913387}-{'f1_val': 0.00016600265604249667, 'auprc': 0.00016600265604249667, 'loss_val': 3.065651438394925, 'psi': 0.00016600265604249667}
[S17] START round=15 head_norm_before_train=1.550244 (no previous merge yet)
[S17] round=15 local utility u=0.243223 metrics={'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 1.045919543108129, 'psi': 0.20301091942882987}-{'f1_val': 0.1553599683544304, 'auprc': 0.1553599683544304, 'loss_val': 1.103506546003702, 'psi': 0.1553599683544304}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.044)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[S15] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:57010
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[S16] not sending this round → trigger blocked (psi=0.003)
[S3] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=0.7858
[S15] RECEIVED delta(kind=head bytes=1803) from S3
[S15] cosine check vs S3: cos=0.5660
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=0.4337
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] cosine check vs S13: cos=0.7010
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=-0.0220
[S7] DROPPED delta from S10 (cos=-0.0220 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S11
[S7] cosine check vs S11: cos=-0.0120
[S7] DROPPED delta from S11 (cos=-0.0120 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.9282
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=-0.0320
[S8] DROPPED delta from S17 (cos=-0.0320 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.3687 head_norm=1.572839
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.118703e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.3687 head_norm=1.595049 delta_norm=0.311870
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.150 → S3@127.0.0.1:57003
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.0000 head_norm=0.881636
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.762823e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.0000 head_norm=0.850872 delta_norm=0.176282
[S15] aggregate: ACCEPT kept=['S3', 'S7', 'S13'] (k=3/3) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.137 → S10@127.0.0.1:57011
[S2] ⇄ pheromone p=0.251 → S10@127.0.0.1:57011
[S14] ⇄ pheromone p=0.077 → S6@127.0.0.1:57007
[S6] ⇄ pheromone p=0.062 → S8@127.0.0.1:57009
[S4] ⇄ pheromone p=0.040 → S2@127.0.0.1:57002
[S16] ⇄ pheromone p=0.079 → S6@127.0.0.1:57007
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.2975 head_norm=1.184113
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.701127e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.2975 head_norm=1.278873 delta_norm=0.470113
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.175 → S15@127.0.0.1:57015
[S5] ⇄ pheromone p=0.155 → S9@127.0.0.1:57010
[S7] ⇄ pheromone p=0.150 → S15@127.0.0.1:57015
[S8] ⇄ pheromone p=0.405 → S3@127.0.0.1:57003
[S13] ⇄ pheromone p=0.334 → S15@127.0.0.1:57015
[S10] ⇄ pheromone p=0.244 → S7@127.0.0.1:57008
[S11] ⇄ pheromone p=0.290 → S7@127.0.0.1:57008
[S17] ⇄ pheromone p=0.137 → S8@127.0.0.1:57009
[S2] START round=16 head_norm_before_train=1.625527 (no previous merge yet)
[S2] round=16 local utility u=0.491090 metrics={'f1_val': 0.26197145524876614, 'auprc': 0.26197145524876614, 'loss_val': 2.4776885521760974, 'psi': 0.26197145524876614}-{'f1_val': 0.18928220255653883, 'auprc': 0.18928220255653883, 'loss_val': 2.805665076783546, 'psi': 0.18928220255653883}
[S3] START round=16 head_norm_before_train=1.278873 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.005810 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 1.6468038140980412, 'psi': 0.29784120014635934}-{'f1_val': 0.29745275267050125, 'auprc': 0.29745275267050125, 'loss_val': 1.6549276416894896, 'psi': 0.29745275267050125}
[S4] START round=16 head_norm_before_train=1.615481 (no previous merge yet)
[S4] round=16 local utility u=0.008023 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3643159380243246, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3803611000545306, 'psi': 0.0}
[S5] START round=16 head_norm_before_train=1.676027 (no previous merge yet)
[S5] round=16 local utility u=0.041786 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.301381865474702, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3894831409065627, 'psi': 0.3335071121394324}
[S6] START round=16 head_norm_before_train=1.642658 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.24430616524419, 'psi': 0.017774699907663897}-{'f1_val': 0.016658954187875982, 'auprc': 0.016658954187875982, 'loss_val': 5.068810873795902, 'psi': 0.016658954187875982}
[S7] START round=16 head_norm_before_train=1.530157 (no previous merge yet)
[S7] round=16 local utility u=0.012529 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1156628789389684, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1407215079235742, 'psi': 0.35976373724718097}
[S8] START round=16 head_norm_before_train=1.520172 (no previous merge yet)
[S8] round=16 local utility u=0.018161 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.9059514604840173, 'psi': 0.9988708350860451}-{'f1_val': 0.9994354958690915, 'auprc': 0.9994354958690915, 'loss_val': 0.9473548712456107, 'psi': 0.9994354958690915}
[S9] START round=16 head_norm_before_train=1.595049 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.133445 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4679362978723167, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.734825906569391, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.570132 (no previous merge yet)
[S10] round=16 local utility u=0.043902 metrics={'f1_val': 0.24982061707725425, 'auprc': 0.24982061707725425, 'loss_val': 3.091249458825228, 'psi': 0.24982061707725425}-{'f1_val': 0.24952107279693486, 'auprc': 0.24952107279693486, 'loss_val': 3.1763575925908616, 'psi': 0.24952107279693486}
[S11] START round=16 head_norm_before_train=1.570074 (no previous merge yet)
[S11] round=16 local utility u=0.167679 metrics={'f1_val': 0.32151186168073986, 'auprc': 0.32151186168073986, 'loss_val': 2.8331355897819543, 'psi': 0.32151186168073986}-{'f1_val': 0.25839054157131963, 'auprc': 0.25839054157131963, 'loss_val': 2.6004015195360113, 'psi': 0.25839054157131963}
[S13] START round=16 head_norm_before_train=1.488956 (no previous merge yet)
[S13] round=16 local utility u=0.014087 metrics={'f1_val': 0.6647852333840177, 'auprc': 0.6647852333840177, 'loss_val': 1.0072755858451834, 'psi': 0.6647852333840177}-{'f1_val': 0.663880801094115, 'auprc': 0.663880801094115, 'loss_val': 1.0273101065916161, 'psi': 0.663880801094115}
[S14] START round=16 head_norm_before_train=1.534342 (no previous merge yet)
[S14] round=16 local utility u=0.292597 metrics={'f1_val': 0.10213556174558959, 'auprc': 0.10213556174558959, 'loss_val': 5.457116227522502, 'psi': 0.10213556174558959}-{'f1_val': 0.04373927958833619, 'auprc': 0.04373927958833619, 'loss_val': 5.516744079804965, 'psi': 0.04373927958833619}
[S15] START round=16 head_norm_before_train=0.850872 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.444322 metrics={'f1_val': 0.09744696152463143, 'auprc': 0.09744696152463143, 'loss_val': 1.3135296639805085, 'psi': 0.09744696152463143}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3251516293667762, 'psi': 0.0}
[S16] START round=16 head_norm_before_train=1.561507 (no previous merge yet)
[S16] round=16 local utility u=0.433671 metrics={'f1_val': 0.07299077733860343, 'auprc': 0.07299077733860343, 'loss_val': 2.787807422867034, 'psi': 0.07299077733860343}-{'f1_val': 0.0028346456692913387, 'auprc': 0.0028346456692913387, 'loss_val': 3.023743246852463, 'psi': 0.0028346456692913387}
[S17] START round=16 head_norm_before_train=1.576785 (no previous merge yet)
[S17] round=16 local utility u=0.011851 metrics={'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 1.0225717388861308, 'psi': 0.20305027788548533}-{'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 1.045919543108129, 'psi': 0.20301091942882987}
[S14] not sending this round → trigger blocked (psi=0.102)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[S16] not sending this round → trigger blocked (psi=0.073)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:57003
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:57008
[S15] not sending this round → trigger blocked (psi=0.097)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:57003
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=0.9215
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=0.3138
[S10] RECEIVED delta(kind=head bytes=1802) from S2
[S10] cosine check vs S2: cos=-0.0088
[S10] DROPPED delta from S2 (cos=-0.0088 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S13
[S15] cosine check vs S13: cos=0.6442
[S15] RECEIVED delta(kind=head bytes=1806) from S3
[S15] cosine check vs S3: cos=0.5297
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] cosine check vs S7: cos=0.5359
[S7] RECEIVED delta(kind=head bytes=1807) from S11
[S7] cosine check vs S11: cos=-0.0090
[S7] DROPPED delta from S11 (cos=-0.0090 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1805) from S5
[S9] cosine check vs S5: cos=0.9732
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:57009
[S10] sending update (kind=head size=1793 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1793) from S10
[S7] cosine check vs S10: cos=-0.0240
[S7] DROPPED delta from S10 (cos=-0.0240 < 0.0)
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=-0.0276
[S8] DROPPED delta from S17 (cos=-0.0276 < 0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.2978 head_norm=1.338663
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.690212e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.2977 head_norm=1.200623 delta_norm=0.369021
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.3687 head_norm=1.639805
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.972398e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.3687 head_norm=1.664104 delta_norm=0.197240
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.0974 head_norm=0.901108
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.665784e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.0000 head_norm=0.884716 delta_norm=0.166578
[S15] aggregate: ROLLBACK (f1_val pre=0.097 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.649624 (no previous merge yet)
[S2] round=17 local utility u=0.007894 metrics={'f1_val': 0.24733764235149278, 'auprc': 0.24733764235149278, 'loss_val': 2.3301953726366436, 'psi': 0.24733764235149278}-{'f1_val': 0.26197145524876614, 'auprc': 0.26197145524876614, 'loss_val': 2.4776885521760974, 'psi': 0.26197145524876614}
[S3] START round=17 head_norm_before_train=1.200623 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 1.7671874229166278, 'psi': 0.29784120014635934}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 1.6468038140980412, 'psi': 0.29784120014635934}
[S4] START round=17 head_norm_before_train=1.648178 (no previous merge yet)
[S4] round=17 local utility u=1.000000 metrics={'f1_val': 0.2348276913693199, 'auprc': 0.2348276913693199, 'loss_val': 1.3430035182328464, 'psi': 0.2348276913693199}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3643159380243246, 'psi': 0.0}
[S5] START round=17 head_norm_before_train=1.710944 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4622821024883788, 'psi': 0.3335071121394324}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.301381865474702, 'psi': 0.33300395256917}
[S6] START round=17 head_norm_before_train=1.663572 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.022510021584952203, 'auprc': 0.022510021584952203, 'loss_val': 5.774408171161505, 'psi': 0.022510021584952203}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.24430616524419, 'psi': 0.017774699907663897}
[S7] START round=17 head_norm_before_train=1.563316 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.107065169473856, 'psi': 0.2396131805157593}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1156628789389684, 'psi': 0.35976373724718097}
[S8] START round=17 head_norm_before_train=1.557760 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.43664380496181077, 'auprc': 0.43664380496181077, 'loss_val': 0.8636788109757313, 'psi': 0.43664380496181077}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.9059514604840173, 'psi': 0.9988708350860451}
[S9] START round=17 head_norm_before_train=1.664104 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.003717 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4605027325873967, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4679362978723167, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.597825 (no previous merge yet)
[S10] round=17 local utility u=0.034569 metrics={'f1_val': 0.2497608799617408, 'auprc': 0.2497608799617408, 'loss_val': 3.0215741466249293, 'psi': 0.2497608799617408}-{'f1_val': 0.24982061707725425, 'auprc': 0.24982061707725425, 'loss_val': 3.091249458825228, 'psi': 0.24982061707725425}
[S11] START round=17 head_norm_before_train=1.590783 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.3322450248756219, 'auprc': 0.3322450248756219, 'loss_val': 3.082979184150421, 'psi': 0.3322450248756219}-{'f1_val': 0.32151186168073986, 'auprc': 0.32151186168073986, 'loss_val': 2.8331355897819543, 'psi': 0.32151186168073986}
[S13] START round=17 head_norm_before_train=1.515019 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.651951528176513, 'auprc': 0.651951528176513, 'loss_val': 1.0438504760033864, 'psi': 0.651951528176513}-{'f1_val': 0.6647852333840177, 'auprc': 0.6647852333840177, 'loss_val': 1.0072755858451834, 'psi': 0.6647852333840177}
[S14] START round=17 head_norm_before_train=1.558017 (no previous merge yet)
[S14] round=17 local utility u=0.033810 metrics={'f1_val': 0.10280869104398516, 'auprc': 0.10280869104398516, 'loss_val': 5.395553591566421, 'psi': 0.10280869104398516}-{'f1_val': 0.10213556174558959, 'auprc': 0.10213556174558959, 'loss_val': 5.457116227522502, 'psi': 0.10213556174558959}
[S15] START round=17 head_norm_before_train=0.884716 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.745786 metrics={'f1_val': 0.26045676161149606, 'auprc': 0.26045676161149606, 'loss_val': 1.2890452428872663, 'psi': 0.26045676161149606}-{'f1_val': 0.09744696152463143, 'auprc': 0.09744696152463143, 'loss_val': 1.3135296639805085, 'psi': 0.09744696152463143}
[S16] START round=17 head_norm_before_train=1.586679 (no previous merge yet)
[S16] round=17 local utility u=0.021712 metrics={'f1_val': 0.0889745442865173, 'auprc': 0.0889745442865173, 'loss_val': 2.888237229977639, 'psi': 0.0889745442865173}-{'f1_val': 0.07299077733860343, 'auprc': 0.07299077733860343, 'loss_val': 2.787807422867034, 'psi': 0.07299077733860343}
[S17] START round=17 head_norm_before_train=1.595188 (no previous merge yet)
[S17] round=17 local utility u=0.010445 metrics={'f1_val': 0.2031290405999483, 'auprc': 0.2031290405999483, 'loss_val': 1.002390362995548, 'psi': 0.2031290405999483}-{'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 1.0225717388861308, 'psi': 0.20305027788548533}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:57011
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.089)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[S14] not sending this round → trigger blocked (psi=0.103)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:57011
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:57003
[S10] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.5426
[S10] RECEIVED delta(kind=head bytes=1799) from S15
[S10] cosine check vs S15: cos=-0.0131
[S10] DROPPED delta from S15 (cos=-0.0131 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S2
[S10] cosine check vs S2: cos=-0.0102
[S10] DROPPED delta from S2 (cos=-0.0102 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=-0.0270
[S7] DROPPED delta from S10 (cos=-0.0270 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] cosine check vs S4: cos=-0.0189
[S2] DROPPED delta from S4 (cos=-0.0189 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S17
[S8] cosine check vs S17: cos=-0.0240
[S8] DROPPED delta from S17 (cos=-0.0240 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.2978 head_norm=1.270945
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.400528e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.2957 head_norm=1.315444 delta_norm=0.740053
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.671079 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.19219924812030076, 'auprc': 0.19219924812030076, 'loss_val': 2.9459017076843534, 'psi': 0.19219924812030076}-{'f1_val': 0.24733764235149278, 'auprc': 0.24733764235149278, 'loss_val': 2.3301953726366436, 'psi': 0.24733764235149278}
[S3] START round=18 head_norm_before_train=1.315444 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.031611 metrics={'f1_val': 0.2986469864698647, 'auprc': 0.2986469864698647, 'loss_val': 1.7112169053319675, 'psi': 0.2986469864698647}-{'f1_val': 0.29784120014635934, 'auprc': 0.29784120014635934, 'loss_val': 1.7671874229166278, 'psi': 0.29784120014635934}
[S4] START round=18 head_norm_before_train=1.676825 (no previous merge yet)
[S4] round=18 local utility u=0.559021 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3226581248980729, 'psi': 0.3567939207526687}-{'f1_val': 0.2348276913693199, 'auprc': 0.2348276913693199, 'loss_val': 1.3430035182328464, 'psi': 0.2348276913693199}
[S5] START round=18 head_norm_before_train=1.733873 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5874781931547735, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4622821024883788, 'psi': 0.3335071121394324}
[S6] START round=18 head_norm_before_train=1.681147 (no previous merge yet)
[S6] round=18 local utility u=0.156126 metrics={'f1_val': 0.023711810305517556, 'auprc': 0.023711810305517556, 'loss_val': 5.472972508808187, 'psi': 0.023711810305517556}-{'f1_val': 0.022510021584952203, 'auprc': 0.022510021584952203, 'loss_val': 5.774408171161505, 'psi': 0.022510021584952203}
[S7] START round=18 head_norm_before_train=1.594813 (no previous merge yet)
[S7] round=18 local utility u=0.535924 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1165728124304608, 'psi': 0.35976373724718097}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.107065169473856, 'psi': 0.2396131805157593}
[S8] START round=18 head_norm_before_train=1.599311 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.838746856756433, 'psi': 0.35939447907390915}-{'f1_val': 0.43664380496181077, 'auprc': 0.43664380496181077, 'loss_val': 0.8636788109757313, 'psi': 0.43664380496181077}
[S9] START round=18 head_norm_before_train=1.714889 cos_to_last_merge=0.9981 (last merge round=16)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6885396453767658, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.4605027325873967, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.625123 (no previous merge yet)
[S10] round=18 local utility u=0.034909 metrics={'f1_val': 0.24982078853046594, 'auprc': 0.24982078853046594, 'loss_val': 2.9522943638775283, 'psi': 0.24982078853046594}-{'f1_val': 0.2497608799617408, 'auprc': 0.2497608799617408, 'loss_val': 3.0215741466249293, 'psi': 0.2497608799617408}
[S11] START round=18 head_norm_before_train=1.614051 (no previous merge yet)
[S11] round=18 local utility u=0.166563 metrics={'f1_val': 0.3265399587817724, 'auprc': 0.3265399587817724, 'loss_val': 2.6985078475091564, 'psi': 0.3265399587817724}-{'f1_val': 0.3322450248756219, 'auprc': 0.3322450248756219, 'loss_val': 3.082979184150421, 'psi': 0.3322450248756219}
[S13] START round=18 head_norm_before_train=1.536310 (no previous merge yet)
[S13] round=18 local utility u=0.048909 metrics={'f1_val': 0.6591326014496933, 'auprc': 0.6591326014496933, 'loss_val': 1.0106626228615891, 'psi': 0.6591326014496933}-{'f1_val': 0.651951528176513, 'auprc': 0.651951528176513, 'loss_val': 1.0438504760033864, 'psi': 0.651951528176513}
[S14] START round=18 head_norm_before_train=1.581673 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.08309337721102426, 'auprc': 0.08309337721102426, 'loss_val': 5.392872449984085, 'psi': 0.08309337721102426}-{'f1_val': 0.10280869104398516, 'auprc': 0.10280869104398516, 'loss_val': 5.395553591566421, 'psi': 0.10280869104398516}
[S15] START round=18 head_norm_before_train=0.935180 cos_to_last_merge=0.9899 (last merge round=16)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.22694444444444442, 'auprc': 0.22694444444444442, 'loss_val': 1.2848657159928942, 'psi': 0.22694444444444445}-{'f1_val': 0.26045676161149606, 'auprc': 0.26045676161149606, 'loss_val': 1.2890452428872663, 'psi': 0.26045676161149606}
[S16] START round=18 head_norm_before_train=1.614276 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.08939175092280532, 'auprc': 0.08939175092280532, 'loss_val': 3.074513673976471, 'psi': 0.08939175092280532}-{'f1_val': 0.0889745442865173, 'auprc': 0.0889745442865173, 'loss_val': 2.888237229977639, 'psi': 0.0889745442865173}
[S17] START round=18 head_norm_before_train=1.613353 (no previous merge yet)
[S17] round=18 local utility u=0.013664 metrics={'f1_val': 0.20345744782490724, 'auprc': 0.20345744782490724, 'loss_val': 0.9780172509600068, 'psi': 0.20345744782490724}-{'f1_val': 0.2031290405999483, 'auprc': 0.2031290405999483, 'loss_val': 1.002390362995548, 'psi': 0.2031290405999483}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[S6] not sending this round → trigger blocked (psi=0.024)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:57008
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S3
[S15] cosine check vs S3: cos=0.4182
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=0.5706
[S15] RECEIVED delta(kind=head bytes=1793) from S13
[S15] cosine check vs S13: cos=0.5833
[S7] RECEIVED delta(kind=head bytes=1805) from S11
[S7] cosine check vs S11: cos=-0.0036
[S7] DROPPED delta from S11 (cos=-0.0036 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=-0.0311
[S7] DROPPED delta from S10 (cos=-0.0311 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=-0.0196
[S2] DROPPED delta from S4 (cos=-0.0196 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S17
[S8] cosine check vs S17: cos=-0.0213
[S8] DROPPED delta from S17 (cos=-0.0213 < 0.0)
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.2269 head_norm=0.993244
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.525701e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.2500 head_norm=0.924554 delta_norm=0.252570
[S15] aggregate: ACCEPT kept=['S3', 'S7', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.691690 (no previous merge yet)
[S2] round=19 local utility u=0.534579 metrics={'f1_val': 0.25289526686807656, 'auprc': 0.25289526686807656, 'loss_val': 2.4230073285697067, 'psi': 0.25289526686807656}-{'f1_val': 0.19219924812030076, 'auprc': 0.19219924812030076, 'loss_val': 2.9459017076843534, 'psi': 0.19219924812030076}
[S3] START round=19 head_norm_before_train=1.386169 cos_to_last_merge=0.9942 (last merge round=17)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.29906040268456374, 'auprc': 0.29906040268456374, 'loss_val': 2.0083207438941786, 'psi': 0.29906040268456374}-{'f1_val': 0.2986469864698647, 'auprc': 0.2986469864698647, 'loss_val': 1.7112169053319675, 'psi': 0.2986469864698647}
[S4] START round=19 head_norm_before_train=1.704847 (no previous merge yet)
[S4] round=19 local utility u=0.010081 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.302496431037719, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3226581248980729, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.759600 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6488256474040544, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5874781931547735, 'psi': 0.3335071121394324}
[S6] START round=19 head_norm_before_train=1.694421 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.0028557829604950024, 'auprc': 0.0028557829604950024, 'loss_val': 6.109293598973529, 'psi': 0.0028557829604950024}-{'f1_val': 0.023711810305517556, 'auprc': 0.023711810305517556, 'loss_val': 5.472972508808187, 'psi': 0.023711810305517556}
[S7] START round=19 head_norm_before_train=1.610625 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1420867205569258, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1165728124304608, 'psi': 0.35976373724718097}
[S8] START round=19 head_norm_before_train=1.641236 (no previous merge yet)
[S8] round=19 local utility u=0.002996 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8327551417688173, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.838746856756433, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.765014 cos_to_last_merge=0.9938 (last merge round=16)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8627160571957606, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6885396453767658, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.650517 (no previous merge yet)
[S10] round=19 local utility u=0.414411 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.872935713217187, 'psi': 0.3330944988456333}-{'f1_val': 0.24982078853046594, 'auprc': 0.24982078853046594, 'loss_val': 2.9522943638775283, 'psi': 0.24982078853046594}
[S11] START round=19 head_norm_before_train=1.640202 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.321727389300754, 'psi': 0.28041912246234446}-{'f1_val': 0.3265399587817724, 'auprc': 0.3265399587817724, 'loss_val': 2.6985078475091564, 'psi': 0.3265399587817724}
[S13] START round=19 head_norm_before_train=1.554213 (no previous merge yet)
[S13] round=19 local utility u=0.096412 metrics={'f1_val': 0.6648342289327933, 'auprc': 0.6648342289327933, 'loss_val': 0.8691542233977285, 'psi': 0.6648342289327933}-{'f1_val': 0.6591326014496933, 'auprc': 0.6591326014496933, 'loss_val': 1.0106626228615891, 'psi': 0.6591326014496933}
[S14] START round=19 head_norm_before_train=1.605535 (no previous merge yet)
[S14] round=19 local utility u=0.291047 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.284494771311782, 'psi': 0.13572854291417166}-{'f1_val': 0.08309337721102426, 'auprc': 0.08309337721102426, 'loss_val': 5.392872449984085, 'psi': 0.08309337721102426}
[S15] START round=19 head_norm_before_train=0.924554 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.279649 metrics={'f1_val': 0.2816490331995622, 'auprc': 0.2816490331995622, 'loss_val': 1.2179092605012338, 'psi': 0.2816490331995622}-{'f1_val': 0.22694444444444442, 'auprc': 0.22694444444444442, 'loss_val': 1.2848657159928942, 'psi': 0.22694444444444445}
[S16] START round=19 head_norm_before_train=1.642393 (no previous merge yet)
[S16] round=19 local utility u=0.618312 metrics={'f1_val': 0.16760085807210576, 'auprc': 0.16760085807210576, 'loss_val': 2.5417720039190574, 'psi': 0.16760085807210576}-{'f1_val': 0.08939175092280532, 'auprc': 0.08939175092280532, 'loss_val': 3.074513673976471, 'psi': 0.08939175092280532}
[S17] START round=19 head_norm_before_train=1.633829 (no previous merge yet)
[S17] round=19 local utility u=0.091018 metrics={'f1_val': 0.22083840546409073, 'auprc': 0.22083840546409073, 'loss_val': 0.9524105382681053, 'psi': 0.22083840546409073}-{'f1_val': 0.20345744782490724, 'auprc': 0.20345744782490724, 'loss_val': 0.9780172509600068, 'psi': 0.20345744782490724}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.168)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:57011
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S13] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.4277
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] cosine check vs S15: cos=-0.0182
[S10] DROPPED delta from S15 (cos=-0.0182 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S2
[S10] cosine check vs S2: cos=-0.0133
[S10] DROPPED delta from S2 (cos=-0.0133 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S13
[S15] cosine check vs S13: cos=0.6025
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=-0.0345
[S7] DROPPED delta from S10 (cos=-0.0345 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] cosine check vs S4: cos=-0.0201
[S2] DROPPED delta from S4 (cos=-0.0201 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=-0.0182
[S8] DROPPED delta from S17 (cos=-0.0182 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.2991 head_norm=1.443270
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.402007e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.2994 head_norm=1.319449 delta_norm=0.840201
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.299 u=0.0000 p_local=0.0775 f1=0.299 auprc=0.299 bytes=12604
[S11] r=20 psi=0.280 u=0.0000 p_local=0.1628 f1=0.280 auprc=0.280 bytes=5413
[S6] r=20 psi=0.003 u=0.0000 p_local=0.0504 f1=0.003 auprc=0.003 bytes=0
[S7] r=20 psi=0.360 u=0.0000 p_local=0.1485 f1=0.360 auprc=0.360 bytes=12607
[S14] r=20 psi=0.136 u=0.2910 p_local=0.1242 f1=0.136 auprc=0.136 bytes=0
[S5] r=20 psi=0.334 u=0.0000 p_local=0.0677 f1=0.334 auprc=0.334 bytes=8998
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0757 f1=0.369 auprc=0.369 bytes=10797
[S4] r=20 psi=0.357 u=0.0101 p_local=0.2368 f1=0.357 auprc=0.357 bytes=5402
[S13] r=20 psi=0.665 u=0.0964 p_local=0.1654 f1=0.665 auprc=0.665 bytes=12587
[S10] r=20 psi=0.333 u=0.4144 p_local=0.1975 f1=0.333 auprc=0.333 bytes=10780
[S8] r=20 psi=0.359 u=0.0030 p_local=0.1683 f1=0.359 auprc=0.359 bytes=16184
[S2] r=20 psi=0.253 u=0.5346 p_local=0.2609 f1=0.253 auprc=0.253 bytes=7204
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.2816 head_norm=0.971312
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.276751e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.2380 head_norm=1.146447 delta_norm=0.627675
[S15] aggregate: ROLLBACK (f1_val pre=0.282 post=0.238 tol_abs=0.005 tol_rel=0.0)
[S15] r=20 psi=0.282 u=0.2796 p_local=0.2532 f1=0.282 auprc=0.282 bytes=5391
[S16] r=20 psi=0.168 u=0.6183 p_local=0.2031 f1=0.168 auprc=0.168 bytes=0
[S17] r=20 psi=0.221 u=0.0910 p_local=0.0791 f1=0.221 auprc=0.221 bytes=18007
[S2] START round=20 head_norm_before_train=1.711822 (no previous merge yet)
[S2] round=20 local utility u=0.491784 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4706804481127613, 'psi': 0.3674775928297055}-{'f1_val': 0.25289526686807656, 'auprc': 0.25289526686807656, 'loss_val': 2.4230073285697067, 'psi': 0.25289526686807656}
[S3] START round=20 head_norm_before_train=1.319449 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.28625342013397487, 'auprc': 0.28625342013397487, 'loss_val': 1.9279502666879411, 'psi': 0.28625342013397487}-{'f1_val': 0.29906040268456374, 'auprc': 0.29906040268456374, 'loss_val': 2.0083207438941786, 'psi': 0.29906040268456374}
[S4] START round=20 head_norm_before_train=1.724348 (no previous merge yet)
[S4] round=20 local utility u=0.012574 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2773482204042426, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.302496431037719, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.777251 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.692666638854565, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6488256474040544, 'psi': 0.3335071121394324}
[S6] START round=20 head_norm_before_train=1.708016 (no previous merge yet)
[S6] round=20 local utility u=0.243232 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 5.796806854418337, 'psi': 0.022186642268984445}-{'f1_val': 0.0028557829604950024, 'auprc': 0.0028557829604950024, 'loss_val': 6.109293598973529, 'psi': 0.0028557829604950024}
[S7] START round=20 head_norm_before_train=1.621932 (no previous merge yet)
[S7] round=20 local utility u=0.003113 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.135859775342062, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1420867205569258, 'psi': 0.35976373724718097}
[S8] START round=20 head_norm_before_train=1.676526 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8423114109475935, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8327551417688173, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.804899 cos_to_last_merge=0.9894 (last merge round=16)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9816475810945269, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8627160571957606, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.672644 (no previous merge yet)
[S10] round=20 local utility u=0.019892 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.8331526767455943, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.872935713217187, 'psi': 0.3330944988456333}
[S11] START round=20 head_norm_before_train=1.663958 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.32438580527752503, 'auprc': 0.32438580527752503, 'loss_val': 2.8527307157880677, 'psi': 0.32438580527752503}-{'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.321727389300754, 'psi': 0.28041912246234446}
[S13] START round=20 head_norm_before_train=1.572636 (no previous merge yet)
[S13] round=20 local utility u=0.002018 metrics={'f1_val': 0.6646215137018151, 'auprc': 0.6646215137018151, 'loss_val': 0.86320434429885, 'psi': 0.6646215137018151}-{'f1_val': 0.6648342289327933, 'auprc': 0.6648342289327933, 'loss_val': 0.8691542233977285, 'psi': 0.6648342289327933}
[S14] START round=20 head_norm_before_train=1.629337 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.288147804242232, 'psi': 0.13587634006482174}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.284494771311782, 'psi': 0.13572854291417166}
[S15] START round=20 head_norm_before_train=1.146447 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.012925 metrics={'f1_val': 0.27839097375521216, 'auprc': 0.27839097375521216, 'loss_val': 1.1627362583361922, 'psi': 0.27839097375521216}-{'f1_val': 0.2816490331995622, 'auprc': 0.2816490331995622, 'loss_val': 1.2179092605012338, 'psi': 0.2816490331995622}
[S16] START round=20 head_norm_before_train=1.669222 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.0894132755437836, 'auprc': 0.0894132755437836, 'loss_val': 3.5294869528961197, 'psi': 0.0894132755437836}-{'f1_val': 0.16760085807210576, 'auprc': 0.16760085807210576, 'loss_val': 2.5417720039190574, 'psi': 0.16760085807210576}
[S17] START round=20 head_norm_before_train=1.656406 (no previous merge yet)
[S17] round=20 local utility u=0.155612 metrics={'f1_val': 0.25372904185450834, 'auprc': 0.25372904185450834, 'loss_val': 0.9372030621289406, 'psi': 0.25372904185450834}-{'f1_val': 0.22083840546409073, 'auprc': 0.22083840546409073, 'loss_val': 0.9524105382681053, 'psi': 0.22083840546409073}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[S6] not sending this round → trigger blocked (psi=0.022)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:57011
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:57011
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S2
[S10] cosine check vs S2: cos=-0.0147
[S10] DROPPED delta from S2 (cos=-0.0147 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S15
[S10] cosine check vs S15: cos=-0.0198
[S10] DROPPED delta from S15 (cos=-0.0198 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1805) from S13
[S15] cosine check vs S13: cos=0.9209
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=0.3284
[S7] RECEIVED delta(kind=head bytes=1806) from S10
[S7] cosine check vs S10: cos=-0.0359
[S7] DROPPED delta from S10 (cos=-0.0359 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=-0.0208
[S2] DROPPED delta from S4 (cos=-0.0208 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.0147
[S8] DROPPED delta from S17 (cos=-0.0147 < 0.0)
[S6] ⇄ pheromone p=0.089 → S8@127.0.0.1:57009
[S5] ⇄ pheromone p=0.054 → S9@127.0.0.1:57010
[S8] ⇄ pheromone p=0.135 → S3@127.0.0.1:57003
[S3] ⇄ pheromone p=0.062 → S15@127.0.0.1:57015
[S2] ⇄ pheromone p=0.307 → S10@127.0.0.1:57011
[S7] ⇄ pheromone p=0.119 → S15@127.0.0.1:57015
[S11] ⇄ pheromone p=0.130 → S7@127.0.0.1:57008
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.2784 head_norm=1.180759
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.358679e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.2764 head_norm=1.138412 delta_norm=0.335868
[S15] aggregate: ACCEPT kept=['S13', 'S7'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.205 → S10@127.0.0.1:57011
[S9] ⇄ pheromone p=0.061 → S3@127.0.0.1:57003
[S13] ⇄ pheromone p=0.133 → S15@127.0.0.1:57015
[S14] ⇄ pheromone p=0.099 → S6@127.0.0.1:57007
[S16] ⇄ pheromone p=0.162 → S6@127.0.0.1:57007
[S4] ⇄ pheromone p=0.192 → S2@127.0.0.1:57002
[S10] ⇄ pheromone p=0.162 → S7@127.0.0.1:57008
[S17] ⇄ pheromone p=0.094 → S8@127.0.0.1:57009
[S2] START round=21 head_norm_before_train=1.731004 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.2652386619066508, 'auprc': 0.2652386619066508, 'loss_val': 2.6899927548463562, 'psi': 0.2652386619066508}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4706804481127613, 'psi': 0.3674775928297055}
[S3] START round=21 head_norm_before_train=1.368363 cos_to_last_merge=0.9978 (last merge round=19)
[S3] round=21 local utility u=0.091686 metrics={'f1_val': 0.29743308669041746, 'auprc': 0.29743308669041746, 'loss_val': 1.845194531765349, 'psi': 0.29743308669041746}-{'f1_val': 0.28625342013397487, 'auprc': 0.28625342013397487, 'loss_val': 1.9279502666879411, 'psi': 0.28625342013397487}
[S4] START round=21 head_norm_before_train=1.746242 (no previous merge yet)
[S4] round=21 local utility u=0.008277 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2607934946812511, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2773482204042426, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.797660 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.764018555543684, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.692666638854565, 'psi': 0.3335071121394324}
[S6] START round=21 head_norm_before_train=1.719363 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.208145832129608, 'psi': 0.01732902033271719}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 5.796806854418337, 'psi': 0.022186642268984445}
[S7] START round=21 head_norm_before_train=1.643916 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.1217382959516775, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.135859775342062, 'psi': 0.35976373724718097}
[S8] START round=21 head_norm_before_train=1.705597 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8527522850828051, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8423114109475935, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.834098 cos_to_last_merge=0.9861 (last merge round=16)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0765171363792554, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.9816475810945269, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.691923 (no previous merge yet)
[S10] round=21 local utility u=0.060959 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.7105194921433373, 'psi': 0.33301496338745623}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.8331526767455943, 'psi': 0.3330944988456333}
[S11] START round=21 head_norm_before_train=1.681387 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.116083603594109, 'psi': 0.33185875048506014}-{'f1_val': 0.32438580527752503, 'auprc': 0.32438580527752503, 'loss_val': 2.8527307157880677, 'psi': 0.32438580527752503}
[S13] START round=21 head_norm_before_train=1.590008 (no previous merge yet)
[S13] round=21 local utility u=0.040459 metrics={'f1_val': 0.6650466743061997, 'auprc': 0.6650466743061997, 'loss_val': 0.7861118289228968, 'psi': 0.6650466743061997}-{'f1_val': 0.6646215137018151, 'auprc': 0.6646215137018151, 'loss_val': 0.86320434429885, 'psi': 0.6646215137018151}
[S14] START round=21 head_norm_before_train=1.653087 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.369195672250199, 'psi': 0.13572854291417166}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.288147804242232, 'psi': 0.13587634006482174}
[S15] START round=21 head_norm_before_train=1.138412 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.088709 metrics={'f1_val': 0.28374455732946297, 'auprc': 0.28374455732946297, 'loss_val': 1.0334997154310206, 'psi': 0.28374455732946297}-{'f1_val': 0.27839097375521216, 'auprc': 0.27839097375521216, 'loss_val': 1.1627362583361922, 'psi': 0.27839097375521216}
[S16] START round=21 head_norm_before_train=1.693312 (no previous merge yet)
[S16] round=21 local utility u=0.165024 metrics={'f1_val': 0.10131950989632423, 'auprc': 0.10131950989632423, 'loss_val': 3.3065942158540844, 'psi': 0.10131950989632423}-{'f1_val': 0.0894132755437836, 'auprc': 0.0894132755437836, 'loss_val': 3.5294869528961197, 'psi': 0.0894132755437836}
[S17] START round=21 head_norm_before_train=1.679465 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.2216965068221749, 'auprc': 0.2216965068221749, 'loss_val': 0.9360672872721544, 'psi': 0.2216965068221749}-{'f1_val': 0.25372904185450834, 'auprc': 0.25372904185450834, 'loss_val': 0.9372030621289406, 'psi': 0.25372904185450834}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:57011
[S16] not sending this round → trigger blocked (psi=0.101)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S3
[S15] cosine check vs S3: cos=0.1566
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] cosine check vs S13: cos=0.8401
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=-0.0372
[S7] DROPPED delta from S10 (cos=-0.0372 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S15
[S10] cosine check vs S15: cos=-0.0299
[S10] DROPPED delta from S15 (cos=-0.0299 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=-0.0213
[S2] DROPPED delta from S4 (cos=-0.0213 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.2837 head_norm=1.176031
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.229319e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.2847 head_norm=1.049324 delta_norm=0.422932
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.748609 (no previous merge yet)
[S2] round=22 local utility u=0.044964 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.601266078622346, 'psi': 0.26537216828478966}-{'f1_val': 0.2652386619066508, 'auprc': 0.2652386619066508, 'loss_val': 2.6899927548463562, 'psi': 0.2652386619066508}
[S3] START round=22 head_norm_before_train=1.416241 cos_to_last_merge=0.9929 (last merge round=19)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.29724804082376527, 'auprc': 0.29724804082376527, 'loss_val': 1.9233808941336092, 'psi': 0.29724804082376527}-{'f1_val': 0.29743308669041746, 'auprc': 0.29743308669041746, 'loss_val': 1.845194531765349, 'psi': 0.29743308669041746}
[S4] START round=22 head_norm_before_train=1.764994 (no previous merge yet)
[S4] round=22 local utility u=0.004771 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2512517376645942, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2607934946812511, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.835883 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.8491525725555693, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.764018555543684, 'psi': 0.33300395256917}
[S6] START round=22 head_norm_before_train=1.729429 (no previous merge yet)
[S6] round=22 local utility u=0.185661 metrics={'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 5.907908597298244, 'psi': 0.025227272727272727}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.208145832129608, 'psi': 0.01732902033271719}
[S7] START round=22 head_norm_before_train=1.664325 (no previous merge yet)
[S7] round=22 local utility u=0.518564 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1652775142808025, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.1217382959516775, 'psi': 0.23968964488212474}
[S8] START round=22 head_norm_before_train=1.733326 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8615950549537839, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8527522850828051, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.857126 cos_to_last_merge=0.9833 (last merge round=16)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.151612416215167, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0765171363792554, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.711008 (no previous merge yet)
[S10] round=22 local utility u=0.070671 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.569176747470083, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.7105194921433373, 'psi': 0.33301496338745623}
[S11] START round=22 head_norm_before_train=1.698029 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.22817866949033, 'psi': 0.3320133550741517}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.116083603594109, 'psi': 0.33185875048506014}
[S13] START round=22 head_norm_before_train=1.602919 (no previous merge yet)
[S13] round=22 local utility u=0.013968 metrics={'f1_val': 0.6650466743061997, 'auprc': 0.6650466743061997, 'loss_val': 0.7581763573951237, 'psi': 0.6650466743061997}-{'f1_val': 0.6650466743061997, 'auprc': 0.6650466743061997, 'loss_val': 0.7861118289228968, 'psi': 0.6650466743061997}
[S14] START round=22 head_norm_before_train=1.675030 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.398552220237188, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.369195672250199, 'psi': 0.13572854291417166}
[S15] START round=22 head_norm_before_train=1.049324 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.28066325286515487, 'auprc': 0.28066325286515487, 'loss_val': 1.0207845797351665, 'psi': 0.28066325286515487}-{'f1_val': 0.28374455732946297, 'auprc': 0.28374455732946297, 'loss_val': 1.0334997154310206, 'psi': 0.28374455732946297}
[S16] START round=22 head_norm_before_train=1.714693 (no previous merge yet)
[S16] round=22 local utility u=0.637453 metrics={'f1_val': 0.17821111788205024, 'auprc': 0.17821111788205024, 'loss_val': 2.7237123225529363, 'psi': 0.17821111788205024}-{'f1_val': 0.10131950989632423, 'auprc': 0.10131950989632423, 'loss_val': 3.3065942158540844, 'psi': 0.10131950989632423}
[S17] START round=22 head_norm_before_train=1.699937 (no previous merge yet)
[S17] round=22 local utility u=0.092629 metrics={'f1_val': 0.24406849503622816, 'auprc': 0.24406849503622816, 'loss_val': 0.9521562982310916, 'psi': 0.24406849503622816}-{'f1_val': 0.2216965068221749, 'auprc': 0.2216965068221749, 'loss_val': 0.9360672872721544, 'psi': 0.2216965068221749}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.025)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:57002
[S16] not sending this round → trigger blocked (psi=0.178)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S2
[S10] cosine check vs S2: cos=-0.0169
[S10] DROPPED delta from S2 (cos=-0.0169 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=0.3683
[S15] RECEIVED delta(kind=head bytes=1802) from S13
[S15] cosine check vs S13: cos=0.8441
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=-0.0389
[S7] DROPPED delta from S10 (cos=-0.0389 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S4
[S2] cosine check vs S4: cos=-0.0218
[S2] DROPPED delta from S4 (cos=-0.0218 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=-0.0084
[S8] DROPPED delta from S17 (cos=-0.0084 < 0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.2807 head_norm=1.084948
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.554762e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.2804 head_norm=1.096650 delta_norm=0.355476
[S15] aggregate: ACCEPT kept=['S7', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.765607 (no previous merge yet)
[S2] round=23 local utility u=0.462606 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5950038708974494, 'psi': 0.3674775928297055}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.601266078622346, 'psi': 0.26537216828478966}
[S3] START round=23 head_norm_before_train=1.466209 cos_to_last_merge=0.9863 (last merge round=19)
[S3] round=23 local utility u=0.005550 metrics={'f1_val': 0.29838566613446865, 'auprc': 0.29838566613446865, 'loss_val': 1.922519732542622, 'psi': 0.29838566613446865}-{'f1_val': 0.29724804082376527, 'auprc': 0.29724804082376527, 'loss_val': 1.9233808941336092, 'psi': 0.29724804082376527}
[S4] START round=23 head_norm_before_train=1.780052 (no previous merge yet)
[S4] round=23 local utility u=0.007122 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.237007474513194, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2512517376645942, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.877967 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.913951068863468, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.8491525725555693, 'psi': 0.33300395256917}
[S6] START round=23 head_norm_before_train=1.739848 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.421903446442448, 'psi': 0.017551963048498844}-{'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 5.907908597298244, 'psi': 0.025227272727272727}
[S7] START round=23 head_norm_before_train=1.682172 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1945188771072885, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1652775142808025, 'psi': 0.35976373724718097}
[S8] START round=23 head_norm_before_train=1.756934 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8760967143847438, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8615950549537839, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.876016 cos_to_last_merge=0.9811 (last merge round=16)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2128543465066124, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.151612416215167, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.733466 (no previous merge yet)
[S10] round=23 local utility u=0.012079 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5450190969846167, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.569176747470083, 'psi': 0.33301496338745623}
[S11] START round=23 head_norm_before_train=1.712601 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.2449488840267207, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.22817866949033, 'psi': 0.3320133550741517}
[S13] START round=23 head_norm_before_train=1.616551 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6634467331694794, 'auprc': 0.6634467331694794, 'loss_val': 0.8062917055266704, 'psi': 0.6634467331694794}-{'f1_val': 0.6650466743061997, 'auprc': 0.6650466743061997, 'loss_val': 0.7581763573951237, 'psi': 0.6650466743061997}
[S14] START round=23 head_norm_before_train=1.695193 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.430719500099572, 'psi': 0.13582554517133957}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.398552220237188, 'psi': 0.13592717296421}
[S15] START round=23 head_norm_before_train=1.096650 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.033853 metrics={'f1_val': 0.2826297913634158, 'auprc': 0.2826297913634158, 'loss_val': 0.9707774287544374, 'psi': 0.2826297913634158}-{'f1_val': 0.28066325286515487, 'auprc': 0.28066325286515487, 'loss_val': 1.0207845797351665, 'psi': 0.28066325286515487}
[S16] START round=23 head_norm_before_train=1.734479 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.14346910622231904, 'auprc': 0.14346910622231904, 'loss_val': 3.204106444148822, 'psi': 0.14346910622231904}-{'f1_val': 0.17821111788205024, 'auprc': 0.17821111788205024, 'loss_val': 2.7237123225529363, 'psi': 0.17821111788205024}
[S17] START round=23 head_norm_before_train=1.723601 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.2355325519306151, 'auprc': 0.2355325519306151, 'loss_val': 0.990348126986413, 'psi': 0.23553255193061506}-{'f1_val': 0.24406849503622816, 'auprc': 0.24406849503622816, 'loss_val': 0.9521562982310916, 'psi': 0.24406849503622816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:57011
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S2
[S10] cosine check vs S2: cos=-0.0176
[S10] DROPPED delta from S2 (cos=-0.0176 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1805) from S15
[S10] cosine check vs S15: cos=-0.0345
[S10] DROPPED delta from S15 (cos=-0.0345 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S3
[S15] cosine check vs S3: cos=0.2443
[S2] RECEIVED delta(kind=head bytes=1806) from S4
[S2] cosine check vs S4: cos=-0.0220
[S2] DROPPED delta from S4 (cos=-0.0220 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=-0.0428
[S7] DROPPED delta from S10 (cos=-0.0428 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.2826 head_norm=1.131909
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.262686e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.2843 head_norm=1.049161 delta_norm=0.826269
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.781285 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.640611871150476, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5950038708974494, 'psi': 0.3674775928297055}
[S3] START round=24 head_norm_before_train=1.511853 cos_to_last_merge=0.9793 (last merge round=19)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.29370263914293177, 'auprc': 0.29370263914293177, 'loss_val': 1.9885657001960657, 'psi': 0.29370263914293177}-{'f1_val': 0.29838566613446865, 'auprc': 0.29838566613446865, 'loss_val': 1.922519732542622, 'psi': 0.29838566613446865}
[S4] START round=24 head_norm_before_train=1.794768 (no previous merge yet)
[S4] round=24 local utility u=0.004915 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2271769442426552, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.237007474513194, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.910944 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9590412807770257, 'psi': 0.3335071121394324}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.913951068863468, 'psi': 0.33300395256917}
[S6] START round=24 head_norm_before_train=1.751409 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.448864750762851, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.421903446442448, 'psi': 0.017551963048498844}
[S7] START round=24 head_norm_before_train=1.691761 (no previous merge yet)
[S7] round=24 local utility u=0.007793 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1789336457028037, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1945188771072885, 'psi': 0.35976373724718097}
[S8] START round=24 head_norm_before_train=1.781863 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8971117948836209, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8760967143847438, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.892170 cos_to_last_merge=0.9792 (last merge round=16)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.260395415577978, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2128543465066124, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.761167 (no previous merge yet)
[S10] round=24 local utility u=0.051758 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.441503536063823, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.5450190969846167, 'psi': 0.33301496338745623}
[S11] START round=24 head_norm_before_train=1.724846 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.250146666377903, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.2449488840267207, 'psi': 0.3320133550741517}
[S13] START round=24 head_norm_before_train=1.627554 (no previous merge yet)
[S13] round=24 local utility u=0.049327 metrics={'f1_val': 0.6649404853195875, 'auprc': 0.6649404853195875, 'loss_val': 0.7210807227765953, 'psi': 0.6649404853195875}-{'f1_val': 0.6634467331694794, 'auprc': 0.6634467331694794, 'loss_val': 0.8062917055266704, 'psi': 0.6634467331694794}
[S14] START round=24 head_norm_before_train=1.713384 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.500642297287604, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.430719500099572, 'psi': 0.13582554517133957}
[S15] START round=24 head_norm_before_train=1.049161 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.015244 metrics={'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.9490718096187689, 'psi': 0.2836055656382335}-{'f1_val': 0.2826297913634158, 'auprc': 0.2826297913634158, 'loss_val': 0.9707774287544374, 'psi': 0.2826297913634158}
[S16] START round=24 head_norm_before_train=1.752083 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.12782517587187547, 'auprc': 0.12782517587187547, 'loss_val': 3.538424537822045, 'psi': 0.12782517587187547}-{'f1_val': 0.14346910622231904, 'auprc': 0.14346910622231904, 'loss_val': 3.204106444148822, 'psi': 0.14346910622231904}
[S17] START round=24 head_norm_before_train=1.746899 (no previous merge yet)
[S17] round=24 local utility u=0.139541 metrics={'f1_val': 0.2644726719850745, 'auprc': 0.2644726719850745, 'loss_val': 0.971727482208204, 'psi': 0.2644726719850745}-{'f1_val': 0.2355325519306151, 'auprc': 0.2355325519306151, 'loss_val': 0.990348126986413, 'psi': 0.23553255193061506}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:57011
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S15
[S10] cosine check vs S15: cos=-0.0109
[S10] DROPPED delta from S15 (cos=-0.0109 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] cosine check vs S13: cos=0.4525
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] cosine check vs S7: cos=0.3513
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=-0.0450
[S7] DROPPED delta from S10 (cos=-0.0450 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=-0.0219
[S2] DROPPED delta from S4 (cos=-0.0219 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1807 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1807) from S17
[S8] cosine check vs S17: cos=-0.0025
[S8] DROPPED delta from S17 (cos=-0.0025 < 0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.2836 head_norm=1.085649
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.569958e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.2835 head_norm=1.018519 delta_norm=0.556996
[S15] aggregate: ACCEPT kept=['S13', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.795717 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.6982129641338277, 'psi': 0.26537216828478966}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.640611871150476, 'psi': 0.3674775928297055}
[S3] START round=25 head_norm_before_train=1.549781 cos_to_last_merge=0.9732 (last merge round=19)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.28889459714016613, 'auprc': 0.28889459714016613, 'loss_val': 2.0085172651048184, 'psi': 0.28889459714016613}-{'f1_val': 0.29370263914293177, 'auprc': 0.29370263914293177, 'loss_val': 1.9885657001960657, 'psi': 0.29370263914293177}
[S4] START round=25 head_norm_before_train=1.810577 (no previous merge yet)
[S4] round=25 local utility u=0.005539 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2160979500958469, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2271769442426552, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.942682 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9800324973292494, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9590412807770257, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.763172 (no previous merge yet)
[S6] round=25 local utility u=0.007392 metrics={'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 6.459996520100298, 'psi': 0.020431588613406795}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.448864750762851, 'psi': 0.017551963048498844}
[S7] START round=25 head_norm_before_train=1.702912 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1973961522764347, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1789336457028037, 'psi': 0.35976373724718097}
[S8] START round=25 head_norm_before_train=1.805629 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9279546183853093, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8971117948836209, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.906046 cos_to_last_merge=0.9776 (last merge round=16)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.305533561126142, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.260395415577978, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.793090 (no previous merge yet)
[S10] round=25 local utility u=0.025583 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3903370020390775, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.441503536063823, 'psi': 0.33301496338745623}
[S11] START round=25 head_norm_before_train=1.738569 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.277568658377561, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.250146666377903, 'psi': 0.3320133550741517}
[S13] START round=25 head_norm_before_train=1.638084 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3330876934414149, 'auprc': 0.3330876934414149, 'loss_val': 0.8672909020360313, 'psi': 0.3330876934414149}-{'f1_val': 0.6649404853195875, 'auprc': 0.6649404853195875, 'loss_val': 0.7210807227765953, 'psi': 0.6649404853195875}
[S14] START round=25 head_norm_before_train=1.729979 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.58140732134317, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.500642297287604, 'psi': 0.13587634006482174}
[S15] START round=25 head_norm_before_train=1.018519 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.001389 metrics={'f1_val': 0.28221007893139044, 'auprc': 0.28221007893139044, 'loss_val': 0.9337350703522108, 'psi': 0.28221007893139044}-{'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.9490718096187689, 'psi': 0.2836055656382335}
[S16] START round=25 head_norm_before_train=1.768051 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.12061902594446973, 'auprc': 0.12061902594446973, 'loss_val': 3.6602832880926117, 'psi': 0.12061902594446973}-{'f1_val': 0.12782517587187547, 'auprc': 0.12782517587187547, 'loss_val': 3.538424537822045, 'psi': 0.12782517587187547}
[S17] START round=25 head_norm_before_train=1.767443 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.2521541483402707, 'auprc': 0.2521541483402707, 'loss_val': 1.050838002976044, 'psi': 0.2521541483402707}-{'f1_val': 0.2644726719850745, 'auprc': 0.2644726719850745, 'loss_val': 0.971727482208204, 'psi': 0.2644726719850745}
[S6] not sending this round → trigger blocked (psi=0.020)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:57011
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1792) from S15
[S10] cosine check vs S15: cos=-0.0343
[S10] DROPPED delta from S15 (cos=-0.0343 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=-0.0458
[S7] DROPPED delta from S10 (cos=-0.0458 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=-0.0225
[S2] DROPPED delta from S4 (cos=-0.0225 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.020 → S3@127.0.0.1:57003
[S11] ⇄ pheromone p=0.043 → S7@127.0.0.1:57008
[S13] ⇄ pheromone p=0.056 → S15@127.0.0.1:57015
[S2] ⇄ pheromone p=0.164 → S10@127.0.0.1:57011
[S14] ⇄ pheromone p=0.033 → S6@127.0.0.1:57007
[S7] ⇄ pheromone p=0.093 → S15@127.0.0.1:57015
[S8] ⇄ pheromone p=0.044 → S3@127.0.0.1:57003
[S5] ⇄ pheromone p=0.018 → S9@127.0.0.1:57010
[S6] ⇄ pheromone p=0.050 → S8@127.0.0.1:57009
[S3] ⇄ pheromone p=0.029 → S15@127.0.0.1:57015
[S15] ⇄ pheromone p=0.082 → S10@127.0.0.1:57011
[S4] ⇄ pheromone p=0.067 → S2@127.0.0.1:57002
[S10] ⇄ pheromone p=0.080 → S7@127.0.0.1:57008
[S17] ⇄ pheromone p=0.063 → S8@127.0.0.1:57009
[S16] ⇄ pheromone p=0.132 → S6@127.0.0.1:57007
[S2] START round=26 head_norm_before_train=1.808402 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.26208091714990334, 'auprc': 0.26208091714990334, 'loss_val': 2.8875628481465268, 'psi': 0.26208091714990334}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.6982129641338277, 'psi': 0.26537216828478966}
[S3] START round=26 head_norm_before_train=1.580374 cos_to_last_merge=0.9683 (last merge round=19)
[S3] round=26 local utility u=0.039221 metrics={'f1_val': 0.2959848297468876, 'auprc': 0.2959848297468876, 'loss_val': 1.9938873810711242, 'psi': 0.2959848297468876}-{'f1_val': 0.28889459714016613, 'auprc': 0.28889459714016613, 'loss_val': 2.0085172651048184, 'psi': 0.28889459714016613}
[S4] START round=26 head_norm_before_train=1.824676 (no previous merge yet)
[S4] round=26 local utility u=0.002929 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2102393496226496, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2160979500958469, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.969557 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.9771899553165007, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9800324973292494, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.773404 (no previous merge yet)
[S6] round=26 local utility u=0.489562 metrics={'f1_val': 0.09294621979734996, 'auprc': 0.09294621979734996, 'loss_val': 6.133504485273808, 'psi': 0.09294621979734996}-{'f1_val': 0.020431588613406795, 'auprc': 0.020431588613406795, 'loss_val': 6.459996520100298, 'psi': 0.020431588613406795}
[S7] START round=26 head_norm_before_train=1.714903 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.23900047824007653, 'auprc': 0.23900047824007653, 'loss_val': 1.1661587882955786, 'psi': 0.23900047824007653}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1973961522764347, 'psi': 0.35976373724718097}
[S8] START round=26 head_norm_before_train=1.827478 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9623857002274271, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9279546183853093, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.918831 cos_to_last_merge=0.9761 (last merge round=16)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3425486631240373, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.305533561126142, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.828237 (no previous merge yet)
[S10] round=26 local utility u=0.020187 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3499623694918284, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3903370020390775, 'psi': 0.33301496338745623}
[S11] START round=26 head_norm_before_train=1.755500 (no previous merge yet)
[S11] round=26 local utility u=0.027153 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.221871180800377, 'psi': 0.33185875048506014}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.277568658377561, 'psi': 0.3320133550741517}
[S13] START round=26 head_norm_before_train=1.646677 (no previous merge yet)
[S13] round=26 local utility u=1.000000 metrics={'f1_val': 0.6626948477052284, 'auprc': 0.6626948477052284, 'loss_val': 0.7578904156237458, 'psi': 0.6626948477052284}-{'f1_val': 0.3330876934414149, 'auprc': 0.3330876934414149, 'loss_val': 0.8672909020360313, 'psi': 0.3330876934414149}
[S14] START round=26 head_norm_before_train=1.744732 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.6569405169290725, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.58140732134317, 'psi': 0.13587634006482174}
[S15] START round=26 head_norm_before_train=1.064156 cos_to_last_merge=0.9958 (last merge round=24)
[S15] round=26 local utility u=0.062983 metrics={'f1_val': 0.28499095840867994, 'auprc': 0.28499095840867994, 'loss_val': 0.8327978156218194, 'psi': 0.28499095840867994}-{'f1_val': 0.28221007893139044, 'auprc': 0.28221007893139044, 'loss_val': 0.9337350703522108, 'psi': 0.28221007893139044}
[S16] START round=26 head_norm_before_train=1.782396 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.09063976299143246, 'auprc': 0.09063976299143246, 'loss_val': 4.071442030663766, 'psi': 0.09063976299143246}-{'f1_val': 0.12061902594446973, 'auprc': 0.12061902594446973, 'loss_val': 3.6602832880926117, 'psi': 0.12061902594446973}
[S17] START round=26 head_norm_before_train=1.786879 (no previous merge yet)
[S17] round=26 local utility u=0.096228 metrics={'f1_val': 0.2727762498168981, 'auprc': 0.2727762498168981, 'loss_val': 1.0439804834770048, 'psi': 0.2727762498168981}-{'f1_val': 0.2521541483402707, 'auprc': 0.2521541483402707, 'loss_val': 1.050838002976044, 'psi': 0.2521541483402707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:57011
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.093)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:57008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:57002
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] cosine check vs S15: cos=-0.0350
[S10] DROPPED delta from S15 (cos=-0.0350 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S3
[S15] cosine check vs S3: cos=0.4536
[S15] RECEIVED delta(kind=head bytes=1802) from S13
[S15] cosine check vs S13: cos=0.6554
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=-0.0469
[S7] DROPPED delta from S10 (cos=-0.0469 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S11
[S7] cosine check vs S11: cos=0.0049
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=-0.0230
[S2] DROPPED delta from S4 (cos=-0.0230 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=0.0024
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.3594 head_norm=1.846021
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.290518e+00
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.3594 head_norm=1.293655 delta_norm=1.290518
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.2390 head_norm=1.722073
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.232803e+00
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.2392 head_norm=1.238800 delta_norm=1.232803
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.2850 head_norm=1.115750
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.819805e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.5767 head_norm=1.076424 delta_norm=0.381981
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.820894 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.25966183574879226, 'auprc': 0.25966183574879226, 'loss_val': 2.9866022138666497, 'psi': 0.25966183574879226}-{'f1_val': 0.26208091714990334, 'auprc': 0.26208091714990334, 'loss_val': 2.8875628481465268, 'psi': 0.26208091714990334}
[S3] START round=27 head_norm_before_train=1.606216 cos_to_last_merge=0.9640 (last merge round=19)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.2892318070663631, 'auprc': 0.2892318070663631, 'loss_val': 2.070930714663932, 'psi': 0.2892318070663631}-{'f1_val': 0.2959848297468876, 'auprc': 0.2959848297468876, 'loss_val': 1.9938873810711242, 'psi': 0.2959848297468876}
[S4] START round=27 head_norm_before_train=1.838460 (no previous merge yet)
[S4] round=27 local utility u=0.000318 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2096043167071906, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2102393496226496, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.986380 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.0014308663724134, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.9771899553165007, 'psi': 0.33300395256917}
[S6] START round=27 head_norm_before_train=1.783360 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.009163533834586466, 'auprc': 0.009163533834586466, 'loss_val': 6.917846904687529, 'psi': 0.009163533834586466}-{'f1_val': 0.09294621979734996, 'auprc': 0.09294621979734996, 'loss_val': 6.133504485273808, 'psi': 0.09294621979734996}
[S7] START round=27 head_norm_before_train=1.238800 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.062592 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.047865978558651, 'psi': 0.23976608187134504}-{'f1_val': 0.23900047824007653, 'auprc': 0.23900047824007653, 'loss_val': 1.1661587882955786, 'psi': 0.23900047824007653}
[S8] START round=27 head_norm_before_train=1.293655 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9659333858321746, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9623857002274271, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.930346 cos_to_last_merge=0.9748 (last merge round=16)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3797325314997946, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3425486631240373, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.863813 (no previous merge yet)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.2747631543245803, 'psi': 0.2497612225405922}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3499623694918284, 'psi': 0.33301496338745623}
[S11] START round=27 head_norm_before_train=1.772941 (no previous merge yet)
[S11] round=27 local utility u=0.004914 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.209265155923359, 'psi': 0.33154997286190585}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.221871180800377, 'psi': 0.33185875048506014}
[S13] START round=27 head_norm_before_train=1.658268 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.42464082695640126, 'auprc': 0.42464082695640126, 'loss_val': 0.7498114748294002, 'psi': 0.42464082695640126}-{'f1_val': 0.6626948477052284, 'auprc': 0.6626948477052284, 'loss_val': 0.7578904156237458, 'psi': 0.6626948477052284}
[S14] START round=27 head_norm_before_train=1.757870 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.722137956856417, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.6569405169290725, 'psi': 0.13592717296421}
[S15] START round=27 head_norm_before_train=1.076424 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.6153216648613191, 'auprc': 0.6153216648613191, 'loss_val': 0.8498309875832791, 'psi': 0.6153216648613191}-{'f1_val': 0.28499095840867994, 'auprc': 0.28499095840867994, 'loss_val': 0.8327978156218194, 'psi': 0.28499095840867994}
[S16] START round=27 head_norm_before_train=1.794304 (no previous merge yet)
[S16] round=27 local utility u=1.000000 metrics={'f1_val': 0.24604979301498456, 'auprc': 0.24604979301498456, 'loss_val': 2.433334834130352, 'psi': 0.24604979301498456}-{'f1_val': 0.09063976299143246, 'auprc': 0.09063976299143246, 'loss_val': 4.071442030663766, 'psi': 0.09063976299143246}
[S17] START round=27 head_norm_before_train=1.808360 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.26574797813001355, 'auprc': 0.26574797813001355, 'loss_val': 1.0886673958239124, 'psi': 0.26574797813001355}-{'f1_val': 0.2727762498168981, 'auprc': 0.2727762498168981, 'loss_val': 1.0439804834770048, 'psi': 0.2727762498168981}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:57011
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:57008
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S15
[S10] cosine check vs S15: cos=-0.0251
[S10] DROPPED delta from S15 (cos=-0.0251 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1806) from S7
[S15] cosine check vs S7: cos=0.2418
[S7] RECEIVED delta(kind=head bytes=1805) from S11
[S7] cosine check vs S11: cos=0.6926
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=-0.0238
[S2] DROPPED delta from S4 (cos=-0.0238 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=0.0084
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.0092 head_norm=1.793110
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.267191e+00
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.0169 head_norm=1.277860 delta_norm=1.267191
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.2398 head_norm=1.283481
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.461406e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.2398 head_norm=1.417473 delta_norm=0.646141
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.6153 head_norm=1.114162
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.411300e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.2814 head_norm=0.946080 delta_norm=0.741130
[S15] aggregate: ROLLBACK (f1_val pre=0.615 post=0.281 tol_abs=0.005 tol_rel=0.0)
[S2] START round=28 head_norm_before_train=1.832742 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.19459375243436938, 'auprc': 0.19459375243436938, 'loss_val': 3.5938481201623085, 'psi': 0.19459375243436938}-{'f1_val': 0.25966183574879226, 'auprc': 0.25966183574879226, 'loss_val': 2.9866022138666497, 'psi': 0.25966183574879226}
[S3] START round=28 head_norm_before_train=1.628049 cos_to_last_merge=0.9606 (last merge round=19)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.29447209850668066, 'auprc': 0.29447209850668066, 'loss_val': 2.2410531172663237, 'psi': 0.29447209850668066}-{'f1_val': 0.2892318070663631, 'auprc': 0.2892318070663631, 'loss_val': 2.070930714663932, 'psi': 0.2892318070663631}
[S4] START round=28 head_norm_before_train=1.852530 (no previous merge yet)
[S4] round=28 local utility u=0.001042 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2075209511358245, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2096043167071906, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=2.003907 (no previous merge yet)
[S5] round=28 local utility u=0.018029 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.9653723495144977, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 3.0014308663724134, 'psi': 0.33300395256917}
[S6] START round=28 head_norm_before_train=1.277860 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=1.000000 metrics={'f1_val': 0.0940536338904003, 'auprc': 0.0940536338904003, 'loss_val': 3.136800039194664, 'psi': 0.0940536338904003}-{'f1_val': 0.009163533834586466, 'auprc': 0.009163533834586466, 'loss_val': 6.917846904687529, 'psi': 0.009163533834586466}
[S7] START round=28 head_norm_before_train=1.417473 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 1.06079296691141, 'psi': 0.23953668875753775}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.047865978558651, 'psi': 0.23976608187134504}
[S8] START round=28 head_norm_before_train=1.316945 cos_to_last_merge=0.9985 (last merge round=26)
[S8] round=28 local utility u=0.018434 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9290650751048103, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9659333858321746, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.941214 cos_to_last_merge=0.9735 (last merge round=16)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4136234498362046, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3797325314997946, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.897068 (no previous merge yet)
[S10] round=28 local utility u=0.005419 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.2639243678625953, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.2747631543245803, 'psi': 0.2497612225405922}
[S11] START round=28 head_norm_before_train=1.790567 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.3303971565445835, 'auprc': 0.3303971565445835, 'loss_val': 3.2225781144483308, 'psi': 0.3303971565445835}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.209265155923359, 'psi': 0.33154997286190585}
[S13] START round=28 head_norm_before_train=1.668999 (no previous merge yet)
[S13] round=28 local utility u=1.000000 metrics={'f1_val': 0.664515054729005, 'auprc': 0.664515054729005, 'loss_val': 0.6734951331487588, 'psi': 0.664515054729005}-{'f1_val': 0.42464082695640126, 'auprc': 0.42464082695640126, 'loss_val': 0.7498114748294002, 'psi': 0.42464082695640126}
[S14] START round=28 head_norm_before_train=1.769880 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.778273145679022, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.722137956856417, 'psi': 0.13592717296421}
[S15] START round=28 head_norm_before_train=0.946080 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.9956225352693621, 'psi': 0.2836055656382335}-{'f1_val': 0.6153216648613191, 'auprc': 0.6153216648613191, 'loss_val': 0.8498309875832791, 'psi': 0.6153216648613191}
[S16] START round=28 head_norm_before_train=1.806144 (no previous merge yet)
[S16] round=28 local utility u=0.027977 metrics={'f1_val': 0.24773519163763066, 'auprc': 0.24773519163763066, 'loss_val': 2.3925494824014613, 'psi': 0.24773519163763066}-{'f1_val': 0.24604979301498456, 'auprc': 0.24604979301498456, 'loss_val': 2.433334834130352, 'psi': 0.24604979301498456}
[S17] START round=28 head_norm_before_train=1.822353 (no previous merge yet)
[S17] round=28 local utility u=0.441151 metrics={'f1_val': 0.37136027710144887, 'auprc': 0.37136027710144887, 'loss_val': 1.1568751907657375, 'psi': 0.37136027710144887}-{'f1_val': 0.26574797813001355, 'auprc': 0.26574797813001355, 'loss_val': 1.0886673958239124, 'psi': 0.26574797813001355}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.094)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.357)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.248)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.5226
[S15] RECEIVED delta(kind=head bytes=1798) from S13
[S15] cosine check vs S13: cos=0.4328
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.0089
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.9188
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.6522
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.2395 head_norm=1.474647
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.208712e+00
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.2389 head_norm=1.219133 delta_norm=1.208712
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.2836 head_norm=0.978924
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.661467e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.6169 head_norm=1.138940 delta_norm=0.766147
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.3687 head_norm=1.951436
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.004713e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.3687 head_norm=1.941527 delta_norm=0.400471
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.2945 head_norm=1.647168
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.454236e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.2986 head_norm=1.314265 delta_norm=0.745424
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.3594 head_norm=1.361152
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.009398e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.3594 head_norm=1.456639 delta_norm=0.700940
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.843490 (no previous merge yet)
[S2] round=29 local utility u=0.670216 metrics={'f1_val': 0.24853095812457474, 'auprc': 0.24853095812457474, 'loss_val': 2.738851939545855, 'psi': 0.24853095812457474}-{'f1_val': 0.19459375243436938, 'auprc': 0.19459375243436938, 'loss_val': 3.5938481201623085, 'psi': 0.19459375243436938}
[S3] START round=29 head_norm_before_train=1.314265 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.412694 metrics={'f1_val': 0.28357046789835066, 'auprc': 0.28357046789835066, 'loss_val': 1.3175501352140402, 'psi': 0.28357046789835066}-{'f1_val': 0.29447209850668066, 'auprc': 0.29447209850668066, 'loss_val': 2.2410531172663237, 'psi': 0.29447209850668066}
[S4] START round=29 head_norm_before_train=1.860594 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2101379975932502, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2075209511358245, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=2.012885 (no previous merge yet)
[S5] round=29 local utility u=0.003269 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.9588351705916227, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.9653723495144977, 'psi': 0.33300395256917}
[S6] START round=29 head_norm_before_train=1.300984 cos_to_last_merge=0.9995 (last merge round=27)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 3.7539437587318614, 'psi': 0.021749084249084248}-{'f1_val': 0.0940536338904003, 'auprc': 0.0940536338904003, 'loss_val': 3.136800039194664, 'psi': 0.0940536338904003}
[S7] START round=29 head_norm_before_train=1.219133 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.0898563731070599, 'psi': 0.2396131805157593}-{'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 1.06079296691141, 'psi': 0.23953668875753775}
[S8] START round=29 head_norm_before_train=1.456639 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9827182579552785, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9290650751048103, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.941527 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.316370 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.780884166515955, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4136234498362046, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.928718 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.2772899201869117, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.2639243678625953, 'psi': 0.2497612225405922}
[S11] START round=29 head_norm_before_train=1.807402 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.366107747775609, 'psi': 0.3320133550741517}-{'f1_val': 0.3303971565445835, 'auprc': 0.3303971565445835, 'loss_val': 3.2225781144483308, 'psi': 0.3303971565445835}
[S13] START round=29 head_norm_before_train=1.676317 (no previous merge yet)
[S13] round=29 local utility u=0.005717 metrics={'f1_val': 0.6640885416178356, 'auprc': 0.6640885416178356, 'loss_val': 0.6582234241665427, 'psi': 0.6640885416178356}-{'f1_val': 0.664515054729005, 'auprc': 0.664515054729005, 'loss_val': 0.6734951331487588, 'psi': 0.664515054729005}
[S14] START round=29 head_norm_before_train=1.781040 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.831318687457177, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.778273145679022, 'psi': 0.13587634006482174}
[S15] START round=29 head_norm_before_train=1.138940 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=1.000000 metrics={'f1_val': 0.6157998860418357, 'auprc': 0.6157998860418357, 'loss_val': 0.8728461413272864, 'psi': 0.6157998860418357}-{'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.9956225352693621, 'psi': 0.2836055656382335}
[S16] START round=29 head_norm_before_train=1.817387 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.22242748937742474, 'auprc': 0.22242748937742474, 'loss_val': 2.5117613851908667, 'psi': 0.22242748937742474}-{'f1_val': 0.24773519163763066, 'auprc': 0.24773519163763066, 'loss_val': 2.3925494824014613, 'psi': 0.24773519163763066}
[S17] START round=29 head_norm_before_train=1.836707 (no previous merge yet)
[S17] round=29 local utility u=0.250230 metrics={'f1_val': 0.4180142442411692, 'auprc': 0.4180142442411692, 'loss_val': 1.0763008011118154, 'psi': 0.4180142442411692}-{'f1_val': 0.37136027710144887, 'auprc': 0.37136027710144887, 'loss_val': 1.1568751907657375, 'psi': 0.37136027710144887}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.664)
[S5] not sending this round → trigger blocked (psi=0.333)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:57011
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:57003
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1791) from S9
[S3] cosine check vs S9: cos=0.3453
[S10] RECEIVED delta(kind=head bytes=1797) from S2
[S10] cosine check vs S2: cos=-0.0213
[S10] DROPPED delta from S2 (cos=-0.0213 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] cosine check vs S15: cos=-0.0354
[S10] DROPPED delta from S15 (cos=-0.0354 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S3
[S15] cosine check vs S3: cos=0.1968
[S17] not sending this round → trigger blocked (psi=0.418)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.2836 head_norm=1.350387
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.781073e-01
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.3017 head_norm=1.367112 delta_norm=0.978107
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.6158 head_norm=1.171376
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.020594e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.6160 head_norm=0.977002 delta_norm=0.802059
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.854226 (no previous merge yet)
[S2] round=30 local utility u=0.488514 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8323441216204457, 'psi': 0.3674775928297055}-{'f1_val': 0.24853095812457474, 'auprc': 0.24853095812457474, 'loss_val': 2.738851939545855, 'psi': 0.24853095812457474}
[S3] START round=30 head_norm_before_train=1.367112 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.28261022927689594, 'auprc': 0.28261022927689594, 'loss_val': 1.5633782723814504, 'psi': 0.28261022927689594}-{'f1_val': 0.28357046789835066, 'auprc': 0.28357046789835066, 'loss_val': 1.3175501352140402, 'psi': 0.28357046789835066}
[S4] START round=30 head_norm_before_train=1.875461 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2166328356239668, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2101379975932502, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=2.032578 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.9803531950169866, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.9588351705916227, 'psi': 0.33300395256917}
[S6] START round=30 head_norm_before_train=1.343495 cos_to_last_merge=0.9966 (last merge round=27)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 4.319873738652662, 'psi': 0.019328117809479982}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 3.7539437587318614, 'psi': 0.021749084249084248}
[S7] START round=30 head_norm_before_train=1.287433 cos_to_last_merge=0.9835 (last merge round=28)
[S7] round=30 local utility u=0.037397 metrics={'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 1.014373307146721, 'psi': 0.23953668875753775}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.0898563731070599, 'psi': 0.2396131805157593}
[S8] START round=30 head_norm_before_train=1.483962 cos_to_last_merge=0.9957 (last merge round=28)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.2379164431730139, 'auprc': 0.2379164431730139, 'loss_val': 0.9053658046244483, 'psi': 0.23791644317301391}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9827182579552785, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.956485 cos_to_last_merge=0.9999 (last merge round=28)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8770343693859621, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.780884166515955, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.959347 (no previous merge yet)
[S10] round=30 local utility u=0.096426 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.0844387172167083, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.2772899201869117, 'psi': 0.2497612225405922}
[S11] START round=30 head_norm_before_train=1.824146 (no previous merge yet)
[S11] round=30 local utility u=0.029758 metrics={'f1_val': 0.3302440531356194, 'auprc': 0.3302440531356194, 'loss_val': 3.29066795210079, 'psi': 0.3302440531356194}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.366107747775609, 'psi': 0.3320133550741517}
[S13] START round=30 head_norm_before_train=1.686926 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.646881907751473, 'auprc': 0.646881907751473, 'loss_val': 0.6574015882498176, 'psi': 0.646881907751473}-{'f1_val': 0.6640885416178356, 'auprc': 0.6640885416178356, 'loss_val': 0.6582234241665427, 'psi': 0.6640885416178356}
[S14] START round=30 head_norm_before_train=1.791596 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.884922928976657, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.831318687457177, 'psi': 0.13587634006482174}
[S15] START round=30 head_norm_before_train=0.977002 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.010751 metrics={'f1_val': 0.616497374010058, 'auprc': 0.616497374010058, 'loss_val': 0.8576209664660774, 'psi': 0.616497374010058}-{'f1_val': 0.6157998860418357, 'auprc': 0.6157998860418357, 'loss_val': 0.8728461413272864, 'psi': 0.6157998860418357}
[S16] START round=30 head_norm_before_train=1.827805 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.13916355379770015, 'auprc': 0.13916355379770015, 'loss_val': 3.8156711591967483, 'psi': 0.13916355379770015}-{'f1_val': 0.22242748937742474, 'auprc': 0.22242748937742474, 'loss_val': 2.5117613851908667, 'psi': 0.22242748937742474}
[S17] START round=30 head_norm_before_train=1.849698 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.37779579498329313, 'auprc': 0.37779579498329313, 'loss_val': 1.206530156648736, 'psi': 0.37779579498329313}-{'f1_val': 0.4180142442411692, 'auprc': 0.4180142442411692, 'loss_val': 1.0763008011118154, 'psi': 0.4180142442411692}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.616)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:57008
[S2] not sending this round → trigger blocked (psi=0.367)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] cosine check vs S7: cos=0.1397
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.6975
[S7] RECEIVED delta(kind=head bytes=1805) from S11
[S7] cosine check vs S11: cos=0.5290
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.011 → S6@127.0.0.1:57007
[S8] ⇄ pheromone p=0.017 → S3@127.0.0.1:57003
[S6] ⇄ pheromone p=0.184 → S8@127.0.0.1:57009
[S4] ⇄ pheromone p=0.022 → S2@127.0.0.1:57002
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.6165 head_norm=1.019368
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.899021e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.2833 head_norm=0.904008 delta_norm=0.789902
[S15] aggregate: ROLLBACK (f1_val pre=0.616 post=0.283 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.296 → S10@127.0.0.1:57011
[S2] ⇄ pheromone p=0.259 → S10@127.0.0.1:57011
[S5] ⇄ pheromone p=0.009 → S9@127.0.0.1:57010
[S13] ⇄ pheromone p=0.229 → S15@127.0.0.1:57015
[S3] ⇄ pheromone p=0.079 → S15@127.0.0.1:57015
[S9] ⇄ pheromone p=0.057 → S3@127.0.0.1:57003
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.2395 head_norm=1.357659
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.624548e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.2396 head_norm=1.316779 delta_norm=0.362455
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.045 → S15@127.0.0.1:57015
[S11] ⇄ pheromone p=0.023 → S7@127.0.0.1:57008
[S10] ⇄ pheromone p=0.048 → S7@127.0.0.1:57008
[S17] ⇄ pheromone p=0.125 → S8@127.0.0.1:57009
[S16] ⇄ pheromone p=0.149 → S6@127.0.0.1:57007
[S2] START round=31 head_norm_before_train=1.864340 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8434024805834683, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8323441216204457, 'psi': 0.3674775928297055}
[S3] START round=31 head_norm_before_train=1.420255 cos_to_last_merge=0.9984 (last merge round=29)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.2880324543610548, 'auprc': 0.2880324543610548, 'loss_val': 1.877626027453989, 'psi': 0.2880324543610548}-{'f1_val': 0.28261022927689594, 'auprc': 0.28261022927689594, 'loss_val': 1.5633782723814504, 'psi': 0.28261022927689594}
[S4] START round=31 head_norm_before_train=1.893451 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2335406872604464, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2166328356239668, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=2.057068 (no previous merge yet)
[S5] round=31 local utility u=0.021278 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.9377979293894425, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.9803531950169866, 'psi': 0.33300395256917}
[S6] START round=31 head_norm_before_train=1.394361 cos_to_last_merge=0.9912 (last merge round=27)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 4.648402846053779, 'psi': 0.02153000458085204}-{'f1_val': 0.019328117809479982, 'auprc': 0.019328117809479982, 'loss_val': 4.319873738652662, 'psi': 0.019328117809479982}
[S7] START round=31 head_norm_before_train=1.316779 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.001769 metrics={'f1_val': 0.23853979652902454, 'auprc': 0.23853979652902454, 'loss_val': 1.0018628737494257, 'psi': 0.23853979652902452}-{'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 1.014373307146721, 'psi': 0.23953668875753775}
[S8] START round=31 head_norm_before_train=1.534292 cos_to_last_merge=0.9827 (last merge round=28)
[S8] round=31 local utility u=0.039077 metrics={'f1_val': 0.23898698056001424, 'auprc': 0.23898698056001424, 'loss_val': 0.8368471684140333, 'psi': 0.23898698056001422}-{'f1_val': 0.2379164431730139, 'auprc': 0.2379164431730139, 'loss_val': 0.9053658046244483, 'psi': 0.23791644317301391}
[S9] START round=31 head_norm_before_train=1.976009 cos_to_last_merge=0.9996 (last merge round=28)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.965741957931272, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8770343693859621, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.990005 (no previous merge yet)
[S10] round=31 local utility u=0.037892 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.0086548143293417, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.0844387172167083, 'psi': 0.2497612225405922}
[S11] START round=31 head_norm_before_train=1.838681 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.433265307507269, 'psi': 0.3320133550741517}-{'f1_val': 0.3302440531356194, 'auprc': 0.3302440531356194, 'loss_val': 3.29066795210079, 'psi': 0.3302440531356194}
[S13] START round=31 head_norm_before_train=1.698985 (no previous merge yet)
[S13] round=31 local utility u=0.043046 metrics={'f1_val': 0.652605237301064, 'auprc': 0.652605237301064, 'loss_val': 0.6228198779743435, 'psi': 0.652605237301064}-{'f1_val': 0.646881907751473, 'auprc': 0.646881907751473, 'loss_val': 0.6574015882498176, 'psi': 0.646881907751473}
[S14] START round=31 head_norm_before_train=1.801427 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.938656953481146, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.884922928976657, 'psi': 0.13587634006482174}
[S15] START round=31 head_norm_before_train=0.904008 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.29802141764820106, 'auprc': 0.29802141764820106, 'loss_val': 1.0388235108162707, 'psi': 0.29802141764820106}-{'f1_val': 0.616497374010058, 'auprc': 0.616497374010058, 'loss_val': 0.8576209664660774, 'psi': 0.616497374010058}
[S16] START round=31 head_norm_before_train=1.837497 (no previous merge yet)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.0779305828421742, 'auprc': 0.0779305828421742, 'loss_val': 4.859141290266152, 'psi': 0.0779305828421742}-{'f1_val': 0.13916355379770015, 'auprc': 0.13916355379770015, 'loss_val': 3.8156711591967483, 'psi': 0.13916355379770015}
[S17] START round=31 head_norm_before_train=1.865272 (no previous merge yet)
[S17] round=31 local utility u=0.125160 metrics={'f1_val': 0.40416461735761977, 'auprc': 0.40416461735761977, 'loss_val': 1.1935291318748988, 'psi': 0.40416461735761977}-{'f1_val': 0.37779579498329313, 'auprc': 0.37779579498329313, 'loss_val': 1.206530156648736, 'psi': 0.37779579498329313}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:57003
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[S13] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1807) from S8
[S3] cosine check vs S8: cos=0.3079
[S15] RECEIVED delta(kind=head bytes=1796) from S13
[S15] cosine check vs S13: cos=0.3180
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.7190
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=0.7697
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.9696
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=0.8426
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.2880 head_norm=1.471746
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.005172e-01
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.2978 head_norm=1.236821 delta_norm=0.900517
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.2980 head_norm=0.942542
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.632311e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.3127 head_norm=0.939550 delta_norm=0.363231
[S15] aggregate: ACCEPT kept=['S13', 'S7'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.3687 head_norm=1.995023
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.537424e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.3687 head_norm=2.018892 delta_norm=0.253742
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.2390 head_norm=1.585964
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.069279e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.3594 head_norm=1.665228 delta_norm=0.506928
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.2385 head_norm=1.363769
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.031141e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.2388 head_norm=1.573112 delta_norm=0.703114
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.873636 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.9790478551740183, 'psi': 0.2654773703336637}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8434024805834683, 'psi': 0.3674775928297055}
[S3] START round=32 head_norm_before_train=1.236821 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.272367 metrics={'f1_val': 0.278319839457477, 'auprc': 0.278319839457477, 'loss_val': 1.2454783068936661, 'psi': 0.278319839457477}-{'f1_val': 0.2880324543610548, 'auprc': 0.2880324543610548, 'loss_val': 1.877626027453989, 'psi': 0.2880324543610548}
[S4] START round=32 head_norm_before_train=1.913848 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2410143357412262, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2335406872604464, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=2.073765 (no previous merge yet)
[S5] round=32 local utility u=0.034706 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.8683858024639624, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.9377979293894425, 'psi': 0.33300395256917}
[S6] START round=32 head_norm_before_train=1.441496 cos_to_last_merge=0.9851 (last merge round=27)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 4.961805232560365, 'psi': 0.02153000458085204}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 4.648402846053779, 'psi': 0.02153000458085204}
[S7] START round=32 head_norm_before_train=1.573112 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.000739 metrics={'f1_val': 0.23900047824007653, 'auprc': 0.23900047824007653, 'loss_val': 1.0045307206172047, 'psi': 0.23900047824007653}-{'f1_val': 0.23853979652902454, 'auprc': 0.23853979652902454, 'loss_val': 1.0018628737494257, 'psi': 0.23853979652902452}
[S8] START round=32 head_norm_before_train=1.665228 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.23898698056001424, 'auprc': 0.23898698056001424, 'loss_val': 0.8593918386276036, 'psi': 0.23898698056001422}-{'f1_val': 0.23898698056001424, 'auprc': 0.23898698056001424, 'loss_val': 0.8368471684140333, 'psi': 0.23898698056001422}
[S9] START round=32 head_norm_before_train=2.018892 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.135055 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6956311033674643, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.965741957931272, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=2.019464 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.0714022493875257, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.0086548143293417, 'psi': 0.2497612225405922}
[S11] START round=32 head_norm_before_train=1.852078 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.4882433832412536, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.433265307507269, 'psi': 0.3320133550741517}
[S13] START round=32 head_norm_before_train=1.709184 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.41435179888281953, 'auprc': 0.41435179888281953, 'loss_val': 0.6658771898207152, 'psi': 0.41435179888281953}-{'f1_val': 0.652605237301064, 'auprc': 0.652605237301064, 'loss_val': 0.6228198779743435, 'psi': 0.652605237301064}
[S14] START round=32 head_norm_before_train=1.810539 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.991033519723989, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.938656953481146, 'psi': 0.13587634006482174}
[S15] START round=32 head_norm_before_train=0.939550 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=1.000000 metrics={'f1_val': 0.616497374010058, 'auprc': 0.616497374010058, 'loss_val': 0.9529752765937561, 'psi': 0.616497374010058}-{'f1_val': 0.29802141764820106, 'auprc': 0.29802141764820106, 'loss_val': 1.0388235108162707, 'psi': 0.29802141764820106}
[S16] START round=32 head_norm_before_train=1.845828 (no previous merge yet)
[S16] round=32 local utility u=1.000000 metrics={'f1_val': 0.20538397595754207, 'auprc': 0.20538397595754207, 'loss_val': 2.802788713606461, 'psi': 0.20538397595754207}-{'f1_val': 0.0779305828421742, 'auprc': 0.0779305828421742, 'loss_val': 4.859141290266152, 'psi': 0.0779305828421742}
[S17] START round=32 head_norm_before_train=1.882721 (no previous merge yet)
[S17] round=32 local utility u=0.433326 metrics={'f1_val': 0.48481882206186816, 'auprc': 0.48481882206186816, 'loss_val': 1.052765053486895, 'psi': 0.48481882206186816}-{'f1_val': 0.40416461735761977, 'auprc': 0.40416461735761977, 'loss_val': 1.1935291318748988, 'psi': 0.40416461735761977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:57013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:57005
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:57011
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1806) from S7
[S10] cosine check vs S7: cos=0.9354
[S5] RECEIVED delta(kind=head bytes=1792) from S9
[S5] cosine check vs S9: cos=0.9898
[S13] RECEIVED delta(kind=head bytes=1798) from S15
[S13] cosine check vs S15: cos=0.5998
[S9] RECEIVED delta(kind=head bytes=1797) from S3
[S9] cosine check vs S3: cos=0.5130
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=32 metric=0.2498 head_norm=2.045559
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.934043e-01
[S10] stored merged vector for next round verification (round=32)
[S10] DEBUG after merge:  round=32 metric=0.2498 head_norm=1.795297 delta_norm=0.393404
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.4144 head_norm=1.718626
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.880641e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.6648 head_norm=1.217350 delta_norm=0.688064
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.3330 head_norm=2.082442
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.485271e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.3330 head_norm=2.056175 delta_norm=0.148527
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.3687 head_norm=2.040409
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.841815e-01
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.3687 head_norm=1.460191 delta_norm=0.884181
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.882313 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.2611311672683514, 'auprc': 0.2611311672683514, 'loss_val': 3.104027411439361, 'psi': 0.2611311672683514}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 2.9790478551740183, 'psi': 0.2654773703336637}
[S3] START round=33 head_norm_before_train=1.290194 cos_to_last_merge=0.9966 (last merge round=31)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.26126477080898586, 'auprc': 0.26126477080898586, 'loss_val': 1.2947792118936408, 'psi': 0.26126477080898586}-{'f1_val': 0.278319839457477, 'auprc': 0.278319839457477, 'loss_val': 1.2454783068936661, 'psi': 0.278319839457477}
[S4] START round=33 head_norm_before_train=1.932129 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2474076107018743, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2410143357412262, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=2.056175 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.884324149576077, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.8683858024639624, 'psi': 0.33300395256917}
[S6] START round=33 head_norm_before_train=1.481401 cos_to_last_merge=0.9797 (last merge round=27)
[S6] round=33 local utility u=0.162796 metrics={'f1_val': 0.05835095137420719, 'auprc': 0.05835095137420719, 'loss_val': 4.967600760239555, 'psi': 0.05835095137420719}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 4.961805232560365, 'psi': 0.02153000458085204}
[S7] START round=33 head_norm_before_train=1.603562 cos_to_last_merge=0.9963 (last merge round=31)
[S7] round=33 local utility u=0.019922 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.9702018533116028, 'psi': 0.2396131805157593}-{'f1_val': 0.23900047824007653, 'auprc': 0.23900047824007653, 'loss_val': 1.0045307206172047, 'psi': 0.23900047824007653}
[S8] START round=33 head_norm_before_train=1.695753 cos_to_last_merge=0.9979 (last merge round=31)
[S8] round=33 local utility u=0.583225 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7766096131471527, 'psi': 0.35939447907390915}-{'f1_val': 0.23898698056001424, 'auprc': 0.23898698056001424, 'loss_val': 0.8593918386276036, 'psi': 0.23898698056001422}
[S9] START round=33 head_norm_before_train=1.460191 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.091479 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.51267345936881, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.6956311033674643, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=1.795297 cos_to_last_merge=1.0000 (last merge round=32)
[S10] round=33 local utility u=0.135632 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 1.8001377163631198, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 2.0714022493875257, 'psi': 0.2497612225405922}
[S11] START round=33 head_norm_before_train=1.865604 (no previous merge yet)
[S11] round=33 local utility u=0.064730 metrics={'f1_val': 0.32401303326513603, 'auprc': 0.32401303326513603, 'loss_val': 3.286780038315192, 'psi': 0.32401303326513603}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.4882433832412536, 'psi': 0.3320133550741517}
[S13] START round=33 head_norm_before_train=1.217350 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=1.000000 metrics={'f1_val': 0.6646461055498384, 'auprc': 0.6646461055498384, 'loss_val': 0.7167417074309922, 'psi': 0.6646461055498384}-{'f1_val': 0.41435179888281953, 'auprc': 0.41435179888281953, 'loss_val': 0.6658771898207152, 'psi': 0.41435179888281953}
[S14] START round=33 head_norm_before_train=1.819147 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.040033669823158, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.991033519723989, 'psi': 0.13587634006482174}
[S15] START round=33 head_norm_before_train=0.978300 cos_to_last_merge=0.9943 (last merge round=31)
[S15] round=33 local utility u=0.031987 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.8895200895825335, 'psi': 0.6165550083006743}-{'f1_val': 0.616497374010058, 'auprc': 0.616497374010058, 'loss_val': 0.9529752765937561, 'psi': 0.616497374010058}
[S16] START round=33 head_norm_before_train=1.854307 (no previous merge yet)
[S16] round=33 local utility u=0.357496 metrics={'f1_val': 0.2476621943428007, 'auprc': 0.2476621943428007, 'loss_val': 2.4683004286071877, 'psi': 0.24766219434280073}-{'f1_val': 0.20538397595754207, 'auprc': 0.20538397595754207, 'loss_val': 2.802788713606461, 'psi': 0.20538397595754207}
[S17] START round=33 head_norm_before_train=1.900489 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.3986413991697077, 'auprc': 0.3986413991697077, 'loss_val': 1.3319420223454241, 'psi': 0.3986413991697077}-{'f1_val': 0.48481882206186816, 'auprc': 0.48481882206186816, 'loss_val': 1.052765053486895, 'psi': 0.48481882206186816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[S9] not sending this round → trigger blocked (psi=0.369)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.617)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.058)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] sending update (kind=head size=1789 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=0.9656
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=-0.0085
[S6] DROPPED delta from S8 (cos=-0.0085 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S10
[S15] cosine check vs S10: cos=0.5176
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.6166 head_norm=1.029816
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.803880e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.2833 head_norm=1.256886 delta_norm=0.780388
[S15] aggregate: ROLLBACK (f1_val pre=0.617 post=0.283 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.2498 head_norm=1.821267
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.433622e-01
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.2498 head_norm=1.718721 delta_norm=0.243362
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.890910 (no previous merge yet)
[S2] round=34 local utility u=0.111891 metrics={'f1_val': 0.26510952757983636, 'auprc': 0.26510952757983636, 'loss_val': 2.9160507317315596, 'psi': 0.26510952757983636}-{'f1_val': 0.2611311672683514, 'auprc': 0.2611311672683514, 'loss_val': 3.104027411439361, 'psi': 0.2611311672683514}
[S3] START round=34 head_norm_before_train=1.365660 cos_to_last_merge=0.9849 (last merge round=31)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.2587448559670782, 'auprc': 0.2587448559670782, 'loss_val': 1.431345455538435, 'psi': 0.2587448559670782}-{'f1_val': 0.26126477080898586, 'auprc': 0.26126477080898586, 'loss_val': 1.2947792118936408, 'psi': 0.26126477080898586}
[S4] START round=34 head_norm_before_train=1.949534 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.260845843926413, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2474076107018743, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=2.066459 cos_to_last_merge=0.9999 (last merge round=32)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.905808312918648, 'psi': 0.3335071121394324}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.884324149576077, 'psi': 0.33300395256917}
[S6] START round=34 head_norm_before_train=1.515821 cos_to_last_merge=0.9751 (last merge round=27)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.521386835334953, 'psi': 0.017774699907663897}-{'f1_val': 0.05835095137420719, 'auprc': 0.05835095137420719, 'loss_val': 4.967600760239555, 'psi': 0.05835095137420719}
[S7] START round=34 head_norm_before_train=1.646038 cos_to_last_merge=0.9874 (last merge round=31)
[S7] round=34 local utility u=0.018133 metrics={'f1_val': 0.23915381857296522, 'auprc': 0.23915381857296522, 'loss_val': 0.9298021354670861, 'psi': 0.23915381857296522}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.9702018533116028, 'psi': 0.2396131805157593}
[S8] START round=34 head_norm_before_train=1.738825 cos_to_last_merge=0.9916 (last merge round=31)
[S8] round=34 local utility u=0.033552 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.709506017569835, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7766096131471527, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=1.515856 cos_to_last_merge=0.9979 (last merge round=32)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.712636290621559, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.51267345936881, 'psi': 0.36867172340800847}
[S10] START round=34 head_norm_before_train=1.718721 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.035991 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 1.7281565270418344, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 1.8001377163631198, 'psi': 0.2497612225405922}
[S11] START round=34 head_norm_before_train=1.876778 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.460898414983448, 'psi': 0.33178150217256364}-{'f1_val': 0.32401303326513603, 'auprc': 0.32401303326513603, 'loss_val': 3.286780038315192, 'psi': 0.32401303326513603}
[S13] START round=34 head_norm_before_train=1.231379 cos_to_last_merge=0.9998 (last merge round=32)
[S13] round=34 local utility u=0.029915 metrics={'f1_val': 0.6647524294010051, 'auprc': 0.6647524294010051, 'loss_val': 0.6578690522599028, 'psi': 0.6647524294010051}-{'f1_val': 0.6646461055498384, 'auprc': 0.6646461055498384, 'loss_val': 0.7167417074309922, 'psi': 0.6646461055498384}
[S14] START round=34 head_norm_before_train=1.827434 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.086974325437091, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.040033669823158, 'psi': 0.13587634006482174}
[S15] START round=34 head_norm_before_train=1.256886 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.2841191080228252, 'auprc': 0.2841191080228252, 'loss_val': 0.9819864580755152, 'psi': 0.2841191080228252}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.8895200895825335, 'psi': 0.6165550083006743}
[S16] START round=34 head_norm_before_train=1.862290 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.07208994708994709, 'auprc': 0.07208994708994709, 'loss_val': 5.024013416157275, 'psi': 0.07208994708994709}-{'f1_val': 0.2476621943428007, 'auprc': 0.2476621943428007, 'loss_val': 2.4683004286071877, 'psi': 0.24766219434280073}
[S17] START round=34 head_norm_before_train=1.912879 (no previous merge yet)
[S17] round=34 local utility u=0.130460 metrics={'f1_val': 0.4209675584481122, 'auprc': 0.4209675584481122, 'loss_val': 1.2719579034073376, 'psi': 0.4209675584481122}-{'f1_val': 0.3986413991697077, 'auprc': 0.3986413991697077, 'loss_val': 1.3319420223454241, 'psi': 0.3986413991697077}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.665)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.250)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.359)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:57004
[S7] not sending this round → trigger blocked (psi=0.239)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1805 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1805) from S2
[S4] cosine check vs S2: cos=-0.0246
[S4] DROPPED delta from S2 (cos=-0.0246 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=35 head_norm_before_train=1.899531 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.2582643237056487, 'auprc': 0.2582643237056487, 'loss_val': 3.16696129789025, 'psi': 0.2582643237056487}-{'f1_val': 0.26510952757983636, 'auprc': 0.26510952757983636, 'loss_val': 2.9160507317315596, 'psi': 0.26510952757983636}
[S3] START round=35 head_norm_before_train=1.434172 cos_to_last_merge=0.9714 (last merge round=31)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.25989795259316667, 'auprc': 0.25989795259316667, 'loss_val': 1.5701484843764304, 'psi': 0.25989795259316667}-{'f1_val': 0.2587448559670782, 'auprc': 0.2587448559670782, 'loss_val': 1.431345455538435, 'psi': 0.2587448559670782}
[S4] START round=35 head_norm_before_train=1.962615 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2741645830592574, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.260845843926413, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=2.081242 cos_to_last_merge=0.9998 (last merge round=32)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9383399487753405, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.905808312918648, 'psi': 0.3335071121394324}
[S6] START round=35 head_norm_before_train=1.544575 cos_to_last_merge=0.9713 (last merge round=27)
[S6] round=35 local utility u=0.372903 metrics={'f1_val': 0.06874483897605285, 'auprc': 0.06874483897605285, 'loss_val': 5.2343125669511705, 'psi': 0.06874483897605285}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 5.521386835334953, 'psi': 0.017774699907663897}
[S7] START round=35 head_norm_before_train=1.679220 cos_to_last_merge=0.9792 (last merge round=31)
[S7] round=35 local utility u=0.004860 metrics={'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 0.9214606264460655, 'psi': 0.23930704898446833}-{'f1_val': 0.23915381857296522, 'auprc': 0.23915381857296522, 'loss_val': 0.9298021354670861, 'psi': 0.23915381857296522}
[S8] START round=35 head_norm_before_train=1.784158 cos_to_last_merge=0.9842 (last merge round=31)
[S8] round=35 local utility u=0.027683 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6541393937528421, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.709506017569835, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=1.584293 cos_to_last_merge=0.9923 (last merge round=32)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8777617771146298, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.712636290621559, 'psi': 0.36867172340800847}
[S10] START round=35 head_norm_before_train=1.748954 cos_to_last_merge=0.9999 (last merge round=33)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 1.7566176062633017, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 1.7281565270418344, 'psi': 0.2497612225405922}
[S11] START round=35 head_norm_before_train=1.887497 (no previous merge yet)
[S11] round=35 local utility u=0.037774 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 3.3154726534227166, 'psi': 0.3240172688025449}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.460898414983448, 'psi': 0.33178150217256364}
[S13] START round=35 head_norm_before_train=1.248472 cos_to_last_merge=0.9994 (last merge round=32)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6524092064027714, 'auprc': 0.6524092064027714, 'loss_val': 0.6713315892983329, 'psi': 0.6524092064027714}-{'f1_val': 0.6647524294010051, 'auprc': 0.6647524294010051, 'loss_val': 0.6578690522599028, 'psi': 0.6647524294010051}
[S14] START round=35 head_norm_before_train=1.835376 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.129052851027636, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.086974325437091, 'psi': 0.13587634006482174}
[S15] START round=35 head_norm_before_train=1.285501 cos_to_last_merge=0.9964 (last merge round=33)
[S15] round=35 local utility u=1.000000 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.9132468416365697, 'psi': 0.6164158146233559}-{'f1_val': 0.2841191080228252, 'auprc': 0.2841191080228252, 'loss_val': 0.9819864580755152, 'psi': 0.2841191080228252}
[S16] START round=35 head_norm_before_train=1.869952 (no previous merge yet)
[S16] round=35 local utility u=1.000000 metrics={'f1_val': 0.19746341463414632, 'auprc': 0.19746341463414632, 'loss_val': 3.000268506499179, 'psi': 0.19746341463414632}-{'f1_val': 0.07208994708994709, 'auprc': 0.07208994708994709, 'loss_val': 5.024013416157275, 'psi': 0.07208994708994709}
[S17] START round=35 head_norm_before_train=1.926190 (no previous merge yet)
[S17] round=35 local utility u=0.140275 metrics={'f1_val': 0.4484912578945808, 'auprc': 0.4484912578945808, 'loss_val': 1.2391207568819187, 'psi': 0.4484912578945808}-{'f1_val': 0.4209675584481122, 'auprc': 0.4209675584481122, 'loss_val': 1.2719579034073376, 'psi': 0.4209675584481122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:57013
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.069)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:57011
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S8] → sending delta(kind=head bytes=1809) to S6@127.0.0.1:57007
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1809 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] cosine check vs S7: cos=0.9770
[S6] RECEIVED delta(kind=head bytes=1809) from S8
[S6] cosine check vs S8: cos=-0.0118
[S6] DROPPED delta from S8 (cos=-0.0118 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] cosine check vs S15: cos=0.4939
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] ⇄ pheromone p=0.054 → S9@127.0.0.1:57010
[S6] ⇄ pheromone p=0.156 → S16@127.0.0.1:57016
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.6524 head_norm=1.272606
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.537002e-01
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.6651 head_norm=1.122524 delta_norm=0.653700
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=35 metric=0.2498 head_norm=1.782026
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.909464e-01
[S10] stored merged vector for next round verification (round=35)
[S10] DEBUG after merge:  round=35 metric=0.2498 head_norm=1.730678 delta_norm=0.190946
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.042 → S15@127.0.0.1:57015
[S2] ⇄ pheromone p=0.103 → S4@127.0.0.1:57004
[S9] ⇄ pheromone p=0.044 → S5@127.0.0.1:57005
[S15] ⇄ pheromone p=0.404 → S13@127.0.0.1:57013
[S8] ⇄ pheromone p=0.094 → S6@127.0.0.1:57007
[S7] ⇄ pheromone p=0.021 → S10@127.0.0.1:57011
[S2] START round=36 head_norm_before_train=1.907413 (no previous merge yet)
[S2] round=36 local utility u=0.074781 metrics={'f1_val': 0.2652386619066508, 'auprc': 0.2652386619066508, 'loss_val': 3.0801678203263063, 'psi': 0.2652386619066508}-{'f1_val': 0.2582643237056487, 'auprc': 0.2582643237056487, 'loss_val': 3.16696129789025, 'psi': 0.2582643237056487}
[S3] START round=36 head_norm_before_train=1.485350 cos_to_last_merge=0.9618 (last merge round=31)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.26151946448300517, 'auprc': 0.26151946448300517, 'loss_val': 1.6738706110025112, 'psi': 0.26151946448300517}-{'f1_val': 0.25989795259316667, 'auprc': 0.25989795259316667, 'loss_val': 1.5701484843764304, 'psi': 0.25989795259316667}
[S4] START round=36 head_norm_before_train=1.975540 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2860253382172464, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2741645830592574, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=2.099635 cos_to_last_merge=0.9997 (last merge round=32)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9713582956223443, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9383399487753405, 'psi': 0.3335071121394324}
[S6] START round=36 head_norm_before_train=1.568823 cos_to_last_merge=0.9683 (last merge round=27)
[S6] round=36 local utility u=0.124986 metrics={'f1_val': 0.10057361376673041, 'auprc': 0.10057361376673041, 'loss_val': 5.270799607336251, 'psi': 0.10057361376673041}-{'f1_val': 0.06874483897605285, 'auprc': 0.06874483897605285, 'loss_val': 5.2343125669511705, 'psi': 0.06874483897605285}
[S7] START round=36 head_norm_before_train=1.699351 cos_to_last_merge=0.9742 (last merge round=31)
[S7] round=36 local utility u=0.005001 metrics={'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.9135248127636414, 'psi': 0.23953668875753775}-{'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 0.9214606264460655, 'psi': 0.23930704898446833}
[S8] START round=36 head_norm_before_train=1.825260 cos_to_last_merge=0.9780 (last merge round=31)
[S8] round=36 local utility u=0.026115 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6019097111704197, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6541393937528421, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=1.638715 cos_to_last_merge=0.9869 (last merge round=32)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.003538777788733, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8777617771146298, 'psi': 0.36867172340800847}
[S10] START round=36 head_norm_before_train=1.730678 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=36 local utility u=0.020784 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 1.7150500017728028, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 1.7566176062633017, 'psi': 0.2497612225405922}
[S11] START round=36 head_norm_before_train=1.897682 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.5066885883029717, 'psi': 0.3319360347772085}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 3.3154726534227166, 'psi': 0.3240172688025449}
[S13] START round=36 head_norm_before_train=1.122524 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6542279342806032, 'auprc': 0.6542279342806032, 'loss_val': 0.7855088476761943, 'psi': 0.6542279342806032}-{'f1_val': 0.6524092064027714, 'auprc': 0.6524092064027714, 'loss_val': 0.6713315892983329, 'psi': 0.6524092064027714}
[S14] START round=36 head_norm_before_train=1.843141 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.171002938256805, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.129052851027636, 'psi': 0.13587634006482174}
[S15] START round=36 head_norm_before_train=1.324856 cos_to_last_merge=0.9868 (last merge round=33)
[S15] round=36 local utility u=0.043004 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.8272383110657875, 'psi': 0.6164158146233559}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.9132468416365697, 'psi': 0.6164158146233559}
[S16] START round=36 head_norm_before_train=1.876644 (no previous merge yet)
[S16] round=36 local utility u=1.000000 metrics={'f1_val': 0.37171224525344015, 'auprc': 0.37171224525344015, 'loss_val': 2.5175298497161687, 'psi': 0.37171224525344015}-{'f1_val': 0.19746341463414632, 'auprc': 0.19746341463414632, 'loss_val': 3.000268506499179, 'psi': 0.19746341463414632}
[S17] START round=36 head_norm_before_train=1.938778 (no previous merge yet)
[S17] round=36 local utility u=0.745415 metrics={'f1_val': 0.5892880729097874, 'auprc': 0.5892880729097874, 'loss_val': 1.015461153455447, 'psi': 0.5892880729097874}-{'f1_val': 0.4484912578945808, 'auprc': 0.4484912578945808, 'loss_val': 1.2391207568819187, 'psi': 0.4484912578945808}
[S3]  timeout peer S2
[S2]  timeout peer S3
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:57004
[S6] not sending this round → trigger blocked (psi=0.101)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:57011
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:57013
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] cosine check vs S2: cos=-0.0250
[S4] DROPPED delta from S2 (cos=-0.0250 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=-0.0133
[S6] DROPPED delta from S8 (cos=-0.0133 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S7
[S10] cosine check vs S7: cos=0.9908
[S15] RECEIVED delta(kind=head bytes=1806) from S10
[S15] cosine check vs S10: cos=0.8870
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] cosine check vs S15: cos=0.8600
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] sending update (kind=head size=1808 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=0.5723
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.1006 head_norm=1.589565
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.136353e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.1015 head_norm=1.541343 delta_norm=0.813635
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=36 metric=0.6542 head_norm=1.149117
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.504342e-01
[S13] stored merged vector for next round verification (round=36)
[S13] DEBUG after merge:  round=36 metric=0.6655 head_norm=1.215950 delta_norm=0.350434
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=36 metric=0.2498 head_norm=1.763098
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.203349e-01
[S10] stored merged vector for next round verification (round=36)
[S10] DEBUG after merge:  round=36 metric=0.2498 head_norm=1.735634 delta_norm=0.120335
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.6164 head_norm=1.371936
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.182925e-01
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.6164 head_norm=1.523284 delta_norm=0.418292
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.915260 (no previous merge yet)
[S2] round=37 local utility u=0.044192 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.9929848038654234, 'psi': 0.26537216828478966}-{'f1_val': 0.2652386619066508, 'auprc': 0.2652386619066508, 'loss_val': 3.0801678203263063, 'psi': 0.2652386619066508}
[S3] START round=37 head_norm_before_train=1.524450 cos_to_last_merge=0.9544 (last merge round=31)
[S3] round=37 local utility u=0.027572 metrics={'f1_val': 0.27576754385964913, 'auprc': 0.27576754385964913, 'loss_val': 1.7469594456190656, 'psi': 0.27576754385964913}-{'f1_val': 0.26151946448300517, 'auprc': 0.26151946448300517, 'loss_val': 1.6738706110025112, 'psi': 0.26151946448300517}
[S4] START round=37 head_norm_before_train=1.978278 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2869036706719867, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2860253382172464, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=2.112912 cos_to_last_merge=0.9995 (last merge round=32)
[S5] round=37 local utility u=0.041553 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.8837234643825904, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9713582956223443, 'psi': 0.3335071121394324}
[S6] START round=37 head_norm_before_train=1.541343 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.594381 metrics={'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 3.362740168657842, 'psi': 0.02065167508031207}-{'f1_val': 0.10057361376673041, 'auprc': 0.10057361376673041, 'loss_val': 5.270799607336251, 'psi': 0.10057361376673041}
[S7] START round=37 head_norm_before_train=1.716187 cos_to_last_merge=0.9704 (last merge round=31)
[S7] round=37 local utility u=0.006631 metrics={'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.900261950362063, 'psi': 0.23953668875753775}-{'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.9135248127636414, 'psi': 0.23953668875753775}
[S8] START round=37 head_norm_before_train=1.859093 cos_to_last_merge=0.9733 (last merge round=31)
[S8] round=37 local utility u=0.019640 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5626292475837603, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6019097111704197, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=1.678612 cos_to_last_merge=0.9827 (last merge round=32)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.088546286860651, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.003538777788733, 'psi': 0.36867172340800847}
[S10] START round=37 head_norm_before_train=1.735634 cos_to_last_merge=1.0000 (last merge round=36)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 1.799361646240711, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 1.7150500017728028, 'psi': 0.2497612225405922}
[S11] START round=37 head_norm_before_train=1.906562 (no previous merge yet)
[S11] round=37 local utility u=0.037886 metrics={'f1_val': 0.3239393939393939, 'auprc': 0.3239393939393939, 'loss_val': 3.3589468909541034, 'psi': 0.3239393939393939}-{'f1_val': 0.3319360347772085, 'auprc': 0.3319360347772085, 'loss_val': 3.5066885883029717, 'psi': 0.3319360347772085}
[S13] START round=37 head_norm_before_train=1.215950 cos_to_last_merge=1.0000 (last merge round=36)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6461270552719941, 'auprc': 0.6461270552719941, 'loss_val': 0.852663959664522, 'psi': 0.6461270552719941}-{'f1_val': 0.6542279342806032, 'auprc': 0.6542279342806032, 'loss_val': 0.7855088476761943, 'psi': 0.6542279342806032}
[S14] START round=37 head_norm_before_train=1.850523 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.210870478497825, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.171002938256805, 'psi': 0.13587634006482174}
[S15] START round=37 head_norm_before_train=1.523284 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.8357981196603956, 'psi': 0.6164158146233559}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.8272383110657875, 'psi': 0.6164158146233559}
[S16] START round=37 head_norm_before_train=1.883816 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.17495056930524308, 'auprc': 0.17495056930524308, 'loss_val': 3.5130467593664183, 'psi': 0.17495056930524308}-{'f1_val': 0.37171224525344015, 'auprc': 0.37171224525344015, 'loss_val': 2.5175298497161687, 'psi': 0.37171224525344015}
[S17] START round=37 head_norm_before_train=1.950689 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.32711015004306737, 'auprc': 0.32711015004306737, 'loss_val': 1.5625350481413642, 'psi': 0.32711015004306737}-{'f1_val': 0.5892880729097874, 'auprc': 0.5892880729097874, 'loss_val': 1.015461153455447, 'psi': 0.5892880729097874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:57010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.8947
[S6] not sending this round → trigger blocked (psi=0.021)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[S8] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=-0.0172
[S6] DROPPED delta from S8 (cos=-0.0172 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=0.9954
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:57004
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S3
[S9] cosine check vs S3: cos=0.7764
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=-0.0250
[S4] DROPPED delta from S2 (cos=-0.0250 < 0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=37 metric=0.3687 head_norm=1.708198
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.192414e-01
[S9] stored merged vector for next round verification (round=37)
[S9] DEBUG after merge:  round=37 metric=0.3687 head_norm=1.643109 delta_norm=0.219241
[S9] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=37 metric=0.2498 head_norm=1.770000
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.559477e-02
[S10] stored merged vector for next round verification (round=37)
[S10] DEBUG after merge:  round=37 metric=0.2498 head_norm=1.751057 delta_norm=0.085595
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.923009 (no previous merge yet)
[S2] round=38 local utility u=0.003997 metrics={'f1_val': 0.2588083735909823, 'auprc': 0.2588083735909823, 'loss_val': 2.9259163722826456, 'psi': 0.2588083735909823}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.9929848038654234, 'psi': 0.26537216828478966}
[S3] START round=38 head_norm_before_train=1.554320 cos_to_last_merge=0.9492 (last merge round=31)
[S3] ⚠️ Model drifted since last merge! cos=0.949
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.2741331153348321, 'auprc': 0.2741331153348321, 'loss_val': 1.7973839349507494, 'psi': 0.2741331153348321}-{'f1_val': 0.27576754385964913, 'auprc': 0.27576754385964913, 'loss_val': 1.7469594456190656, 'psi': 0.27576754385964913}
[S4] START round=38 head_norm_before_train=1.983164 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2909827289751818, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2869036706719867, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=2.121462 cos_to_last_merge=0.9993 (last merge round=32)
[S5] round=38 local utility u=0.055995 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.771733800755535, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.8837234643825904, 'psi': 0.33300395256917}
[S6] START round=38 head_norm_before_train=1.573933 cos_to_last_merge=0.9987 (last merge round=36)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 4.070284309068557, 'psi': 0.020871559633027524}-{'f1_val': 0.02065167508031207, 'auprc': 0.02065167508031207, 'loss_val': 3.362740168657842, 'psi': 0.02065167508031207}
[S7] START round=38 head_norm_before_train=1.736133 cos_to_last_merge=0.9670 (last merge round=31)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.23915381857296522, 'auprc': 0.23915381857296522, 'loss_val': 0.9041880885137638, 'psi': 0.23915381857296522}-{'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.900261950362063, 'psi': 0.23953668875753775}
[S8] START round=38 head_norm_before_train=1.884364 cos_to_last_merge=0.9701 (last merge round=31)
[S8] round=38 local utility u=0.015098 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5324341679026764, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5626292475837603, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=1.643109 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=38 local utility u=0.110746 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8670541572157808, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.088546286860651, 'psi': 0.36867172340800847}
[S10] START round=38 head_norm_before_train=1.751057 cos_to_last_merge=1.0000 (last merge round=37)
[S10] round=38 local utility u=0.060415 metrics={'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 1.6785314680357009, 'psi': 0.2497612225405922}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 1.799361646240711, 'psi': 0.2497612225405922}
[S11] START round=38 head_norm_before_train=1.915638 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.3278135541245017, 'auprc': 0.3278135541245017, 'loss_val': 3.4803543238542596, 'psi': 0.3278135541245017}-{'f1_val': 0.3239393939393939, 'auprc': 0.3239393939393939, 'loss_val': 3.3589468909541034, 'psi': 0.3239393939393939}
[S13] START round=38 head_norm_before_train=1.245081 cos_to_last_merge=0.9963 (last merge round=36)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3330876934414149, 'auprc': 0.3330876934414149, 'loss_val': 0.8374176060887765, 'psi': 0.3330876934414149}-{'f1_val': 0.6461270552719941, 'auprc': 0.6461270552719941, 'loss_val': 0.852663959664522, 'psi': 0.6461270552719941}
[S14] START round=38 head_norm_before_train=1.857816 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.2500779519968, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.210870478497825, 'psi': 0.13587634006482174}
[S15] START round=38 head_norm_before_train=1.552948 cos_to_last_merge=0.9983 (last merge round=36)
[S15] round=38 local utility u=0.006844 metrics={'f1_val': 0.6155785243707129, 'auprc': 0.6155785243707129, 'loss_val': 0.8145741096663107, 'psi': 0.6155785243707129}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.8357981196603956, 'psi': 0.6164158146233559}
[S16] START round=38 head_norm_before_train=1.890724 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 4.927378483164896, 'psi': 0.09036289353520788}-{'f1_val': 0.17495056930524308, 'auprc': 0.17495056930524308, 'loss_val': 3.5130467593664183, 'psi': 0.17495056930524308}
[S17] START round=38 head_norm_before_train=1.960670 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.31691655489353393, 'auprc': 0.31691655489353393, 'loss_val': 1.6576963979243298, 'psi': 0.31691655489353393}-{'f1_val': 0.32711015004306737, 'auprc': 0.32711015004306737, 'loss_val': 1.5625350481413642, 'psi': 0.32711015004306737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S10] → sending delta(kind=head bytes=1808) to S15@127.0.0.1:57015
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S13@127.0.0.1:57013
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S8] → sending delta(kind=head bytes=1809) to S6@127.0.0.1:57007
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1809 to 1 peers)
[S10] sending update (kind=head size=1808 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=0.8033
[S13] RECEIVED delta(kind=head bytes=1807) from S15
[S13] cosine check vs S15: cos=0.8681
[S15] RECEIVED delta(kind=head bytes=1808) from S10
[S15] cosine check vs S10: cos=0.9501
[S6] RECEIVED delta(kind=head bytes=1809) from S8
[S6] cosine check vs S8: cos=-0.0177
[S6] DROPPED delta from S8 (cos=-0.0177 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] cosine check vs S5: cos=0.9066
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=-0.0257
[S4] DROPPED delta from S2 (cos=-0.0257 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.2741 head_norm=1.578619
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.116757e-01
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.2769 head_norm=1.543530 delta_norm=0.511676
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=38 metric=0.3331 head_norm=1.287570
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.966227e-01
[S13] stored merged vector for next round verification (round=38)
[S13] DEBUG after merge:  round=38 metric=0.6649 head_norm=1.389821 delta_norm=0.396623
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=38 metric=0.3687 head_norm=1.672290
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.651531e-01
[S9] stored merged vector for next round verification (round=38)
[S9] DEBUG after merge:  round=38 metric=0.3687 head_norm=1.853038 delta_norm=0.465153
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S16
[S10]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S15
[S6]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S16
[S13]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.6156 head_norm=1.587448
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.840240e-01
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.6153 head_norm=1.665925 delta_norm=0.284024
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.930299 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.2538539297447561, 'auprc': 0.2538539297447561, 'loss_val': 2.9180802062669393, 'psi': 0.2538539297447561}-{'f1_val': 0.2588083735909823, 'auprc': 0.2588083735909823, 'loss_val': 2.9259163722826456, 'psi': 0.2588083735909823}
[S3] START round=39 head_norm_before_train=1.543530 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.027521 metrics={'f1_val': 0.2608582911966809, 'auprc': 0.2608582911966809, 'loss_val': 1.622869346750053, 'psi': 0.2608582911966809}-{'f1_val': 0.2741331153348321, 'auprc': 0.2741331153348321, 'loss_val': 1.7973839349507494, 'psi': 0.2741331153348321}
[S4] START round=39 head_norm_before_train=1.987929 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2942572475797463, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2909827289751818, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=2.122188 cos_to_last_merge=0.9989 (last merge round=32)
[S5] round=39 local utility u=0.001359 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7735442187434485, 'psi': 0.3335071121394324}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.771733800755535, 'psi': 0.33300395256917}
[S6] START round=39 head_norm_before_train=1.622091 cos_to_last_merge=0.9938 (last merge round=36)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 4.565043631423629, 'psi': 0.021749084249084248}-{'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 4.070284309068557, 'psi': 0.020871559633027524}
[S7] START round=39 head_norm_before_train=1.750130 cos_to_last_merge=0.9644 (last merge round=31)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.9103988067172103, 'psi': 0.23953668875753775}-{'f1_val': 0.23915381857296522, 'auprc': 0.23915381857296522, 'loss_val': 0.9041880885137638, 'psi': 0.23915381857296522}
[S8] START round=39 head_norm_before_train=1.903330 cos_to_last_merge=0.9682 (last merge round=31)
[S8] round=39 local utility u=0.110156 metrics={'f1_val': 0.3813178540468187, 'auprc': 0.3813178540468187, 'loss_val': 0.5094318205630818, 'psi': 0.3813178540468187}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5324341679026764, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=1.853038 cos_to_last_merge=1.0000 (last merge round=38)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8671111111043366, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8670541572157808, 'psi': 0.36867172340800847}
[S10] START round=39 head_norm_before_train=1.786606 cos_to_last_merge=0.9998 (last merge round=37)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.24952290076335878, 'auprc': 0.24952290076335878, 'loss_val': 1.7219697280558848, 'psi': 0.2495229007633588}-{'f1_val': 0.24976122254059216, 'auprc': 0.24976122254059216, 'loss_val': 1.6785314680357009, 'psi': 0.2497612225405922}
[S11] START round=39 head_norm_before_train=1.923319 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.534532393531056, 'psi': 0.33178150217256364}-{'f1_val': 0.3278135541245017, 'auprc': 0.3278135541245017, 'loss_val': 3.4803543238542596, 'psi': 0.3278135541245017}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0144 f1=0.332 auprc=0.332 bytes=16232
[S13] START round=39 head_norm_before_train=1.389821 cos_to_last_merge=1.0000 (last merge round=38)
[S13] round=39 local utility u=1.000000 metrics={'f1_val': 0.5728395812515551, 'auprc': 0.5728395812515551, 'loss_val': 0.8498358975617738, 'psi': 0.5728395812515551}-{'f1_val': 0.3330876934414149, 'auprc': 0.3330876934414149, 'loss_val': 0.8374176060887765, 'psi': 0.3330876934414149}
[S14] START round=39 head_norm_before_train=1.864818 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.287503621386405, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.2500779519968, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0014 f1=0.136 auprc=0.136 bytes=0
[S15] START round=39 head_norm_before_train=1.665925 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.008582 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.8049460840373585, 'psi': 0.6164158146233559}-{'f1_val': 0.6155785243707129, 'auprc': 0.6155785243707129, 'loss_val': 0.8145741096663107, 'psi': 0.6155785243707129}
[S16] START round=39 head_norm_before_train=1.898024 (no previous merge yet)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 4.968800096689709, 'psi': 0.09036289353520788}-{'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 4.927378483164896, 'psi': 0.09036289353520788}
[S17] START round=39 head_norm_before_train=1.970671 (no previous merge yet)
[S17] round=39 local utility u=1.000000 metrics={'f1_val': 0.505402902130287, 'auprc': 0.505402902130287, 'loss_val': 1.1893923733526053, 'psi': 0.505402902130287}-{'f1_val': 0.31691655489353393, 'auprc': 0.31691655489353393, 'loss_val': 1.6576963979243298, 'psi': 0.31691655489353393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S17] r=40 psi=0.505 u=1.0000 p_local=0.3355 f1=0.505 auprc=0.505 bytes=37843
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S13] → sending delta(kind=head bytes=1810) to S15@127.0.0.1:57015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1794 to 1 peers)
[S2] r=40 psi=0.254 u=0.0000 p_local=0.0560 f1=0.254 auprc=0.254 bytes=21611
[S13] sending update (kind=head size=1810 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0030 f1=0.357 auprc=0.357 bytes=19801
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.9793
[S15] RECEIVED delta(kind=head bytes=1810) from S13
[S15] cosine check vs S13: cos=0.9229
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] r=40 psi=0.334 u=0.0014 p_local=0.0179 f1=0.334 auprc=0.334 bytes=19783
[S13] r=40 psi=0.573 u=1.0000 p_local=0.2866 f1=0.573 auprc=0.573 bytes=28789
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=0.8611
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.3687 head_norm=1.880589
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.393574e-01
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.3687 head_norm=1.802067 delta_norm=0.139357
[S9] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0358 f1=0.369 auprc=0.369 bytes=16183
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.090 u=0.0000 p_local=0.2650 f1=0.090 auprc=0.090 bytes=9003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=-0.0180
[S6] DROPPED delta from S8 (cos=-0.0180 < 0.0)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.240 u=0.0000 p_local=0.0101 f1=0.240 auprc=0.240 bytes=32422
[S6] r=40 psi=0.022 u=0.0000 p_local=0.1527 f1=0.022 auprc=0.022 bytes=0
[S8] r=40 psi=0.381 u=0.1102 p_local=0.0682 f1=0.381 auprc=0.381 bytes=30621
[S3] r=40 psi=0.261 u=0.0275 p_local=0.0310 f1=0.261 auprc=0.261 bytes=25204
[S15] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:57013
[S15] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S15
[S13] cosine check vs S15: cos=0.9229
[S10] r=40 psi=0.250 u=0.0000 p_local=0.0290 f1=0.250 auprc=0.250 bytes=34198
[S10]  timeout peer S2
[S10]  timeout peer S15
[S6]  timeout peer S14
[S6]  timeout peer S16
[S8]  timeout peer S6
[S8]  timeout peer S17
[S9]  timeout peer S5
[S15]  timeout peer S3
[S15]  timeout peer S7
[S15]  timeout peer S13
[S7]  timeout peer S10
[S7]  timeout peer S11
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.6164 head_norm=1.690199
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.331744e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.6164 head_norm=1.523739 delta_norm=0.333174
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.616 u=0.0086 p_local=0.1725 f1=0.616 auprc=0.616 bytes=28804
[S3]  timeout peer S8
[S3]  timeout peer S9
[S2]  timeout peer S4
[S2] START round=40 head_norm_before_train=1.937357 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.25024912805181865, 'auprc': 0.25024912805181865, 'loss_val': 2.9315197806710085, 'psi': 0.25024912805181865}-{'f1_val': 0.2538539297447561, 'auprc': 0.2538539297447561, 'loss_val': 2.9180802062669393, 'psi': 0.2538539297447561}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.563861 cos_to_last_merge=0.9999 (last merge round=38)
[S3] round=40 local utility u=0.015768 metrics={'f1_val': 0.26640185369083086, 'auprc': 0.26640185369083086, 'loss_val': 1.6412248547922585, 'psi': 0.26640185369083086}-{'f1_val': 0.2608582911966809, 'auprc': 0.2608582911966809, 'loss_val': 1.622869346750053, 'psi': 0.2608582911966809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=40 head_norm_before_train=1.991012 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3081103026741523, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2942572475797463, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=2.130426 cos_to_last_merge=0.9986 (last merge round=32)
[S5] round=40 local utility u=0.017154 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.734706867817533, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7735442187434485, 'psi': 0.3335071121394324}
[S6] START round=40 head_norm_before_train=1.669157 cos_to_last_merge=0.9872 (last merge round=36)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.2066795507623045, 'psi': 0.017551963048498844}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 4.565043631423629, 'psi': 0.021749084249084248}
[S7] START round=40 head_norm_before_train=1.768586 cos_to_last_merge=0.9611 (last merge round=31)
[S7] round=40 local utility u=0.000162 metrics={'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.9100742874846901, 'psi': 0.23953668875753775}-{'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.9103988067172103, 'psi': 0.23953668875753775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=40 head_norm_before_train=1.918607 cos_to_last_merge=0.9666 (last merge round=31)
[S8] round=40 local utility u=0.257386 metrics={'f1_val': 0.43664380496181077, 'auprc': 0.43664380496181077, 'loss_val': 0.4925932935735789, 'psi': 0.43664380496181077}-{'f1_val': 0.3813178540468187, 'auprc': 0.3813178540468187, 'loss_val': 0.5094318205630818, 'psi': 0.3813178540468187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=40 head_norm_before_train=1.802067 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8914025124767888, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8671111111043366, 'psi': 0.36867172340800847}
[S10] START round=40 head_norm_before_train=1.821578 cos_to_last_merge=0.9992 (last merge round=37)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.2497015994270709, 'auprc': 0.2497015994270709, 'loss_val': 1.8307958083786784, 'psi': 0.2497015994270709}-{'f1_val': 0.24952290076335878, 'auprc': 0.24952290076335878, 'loss_val': 1.7219697280558848, 'psi': 0.2495229007633588}
[S11] START round=40 head_norm_before_train=1.929888 (no previous merge yet)
[S11] round=40 local utility u=0.081669 metrics={'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 3.2993289496963993, 'psi': 0.3237965485921889}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.534532393531056, 'psi': 0.33178150217256364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S11] sending update (kind=head size=1808 to 1 peers)
[S13] START round=40 head_norm_before_train=1.417320 cos_to_last_merge=0.9968 (last merge round=38)
[S13] round=40 local utility u=0.102881 metrics={'f1_val': 0.5888771797536646, 'auprc': 0.5888771797536646, 'loss_val': 0.788411775649831, 'psi': 0.5888771797536646}-{'f1_val': 0.5728395812515551, 'auprc': 0.5728395812515551, 'loss_val': 0.8498358975617738, 'psi': 0.5728395812515551}
[S14] START round=40 head_norm_before_train=1.871476 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.3239383984516, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.287503621386405, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.523739 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.027945 metrics={'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.7458142104667668, 'psi': 0.6160556042184989}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.8049460840373585, 'psi': 0.6164158146233559}
[S16] START round=40 head_norm_before_train=1.905225 (no previous merge yet)
[S16] round=40 local utility u=1.000000 metrics={'f1_val': 0.213298139768728, 'auprc': 0.213298139768728, 'loss_val': 2.7154080923728254, 'psi': 0.213298139768728}-{'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 4.968800096689709, 'psi': 0.09036289353520788}
[S17] START round=40 head_norm_before_train=1.978704 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.4749113423068634, 'auprc': 0.4749113423068634, 'loss_val': 1.2531633572084837, 'psi': 0.4749113423068634}-{'f1_val': 0.505402902130287, 'auprc': 0.505402902130287, 'loss_val': 1.1893923733526053, 'psi': 0.505402902130287}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=40 metric=0.5889 head_norm=1.450943
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.688414e-01
[S13] stored merged vector for next round verification (round=40)
[S13] DEBUG after merge:  round=40 metric=0.6653 head_norm=1.531326 delta_norm=0.368841
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=41 head_norm_before_train=1.944291 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.2493174484983867, 'auprc': 0.2493174484983867, 'loss_val': 2.9484662696410506, 'psi': 0.2493174484983867}-{'f1_val': 0.25024912805181865, 'auprc': 0.25024912805181865, 'loss_val': 2.9315197806710085, 'psi': 0.25024912805181865}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.584895 cos_to_last_merge=0.9996 (last merge round=38)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.2602004526349822, 'auprc': 0.2602004526349822, 'loss_val': 1.647194742443724, 'psi': 0.2602004526349822}-{'f1_val': 0.26640185369083086, 'auprc': 0.26640185369083086, 'loss_val': 1.6412248547922585, 'psi': 0.26640185369083086}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.996865 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3152715146571847, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3081103026741523, 'psi': 0.3567939207526687}
[S5] START round=41 head_norm_before_train=2.135461 cos_to_last_merge=0.9983 (last merge round=32)
[S5] round=41 local utility u=0.016468 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.7017700975761594, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.734706867817533, 'psi': 0.33300395256917}
[S6] START round=41 head_norm_before_train=1.708046 cos_to_last_merge=0.9811 (last merge round=36)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.4204911602610855, 'psi': 0.021310724106324473}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.2066795507623045, 'psi': 0.017551963048498844}
[S7] START round=41 head_norm_before_train=1.784842 cos_to_last_merge=0.9586 (last merge round=31)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 0.9089487142637864, 'psi': 0.23930704898446833}-{'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.9100742874846901, 'psi': 0.23953668875753775}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.931357 cos_to_last_merge=0.9654 (last merge round=31)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.4347957497048406, 'auprc': 0.4347957497048406, 'loss_val': 0.48374656007712, 'psi': 0.4347957497048406}-{'f1_val': 0.43664380496181077, 'auprc': 0.43664380496181077, 'loss_val': 0.4925932935735789, 'psi': 0.43664380496181077}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.829612 cos_to_last_merge=0.9997 (last merge round=39)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0158575794196474, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8914025124767888, 'psi': 0.36867172340800847}
[S10] START round=41 head_norm_before_train=1.853857 cos_to_last_merge=0.9984 (last merge round=37)
[S10] round=41 local utility u=0.034253 metrics={'f1_val': 0.2489883361104499, 'auprc': 0.2489883361104499, 'loss_val': 1.7558712318771716, 'psi': 0.2489883361104499}-{'f1_val': 0.2497015994270709, 'auprc': 0.2497015994270709, 'loss_val': 1.8307958083786784, 'psi': 0.2497015994270709}
[S11] START round=41 head_norm_before_train=1.936277 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 3.405073590560099, 'psi': 0.3240172688025449}-{'f1_val': 0.3237965485921889, 'auprc': 0.3237965485921889, 'loss_val': 3.2993289496963993, 'psi': 0.3237965485921889}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.531326 cos_to_last_merge=1.0000 (last merge round=40)
[S13] round=41 local utility u=0.323587 metrics={'f1_val': 0.6644332551972167, 'auprc': 0.6644332551972167, 'loss_val': 0.8212417327652775, 'psi': 0.6644332551972167}-{'f1_val': 0.5888771797536646, 'auprc': 0.5888771797536646, 'loss_val': 0.788411775649831, 'psi': 0.5888771797536646}
[S14] START round=41 head_norm_before_train=1.877903 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.358214469154071, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.3239383984516, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.556648 cos_to_last_merge=0.9992 (last merge round=39)
[S15] round=41 local utility u=0.028760 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.6927884541340974, 'psi': 0.6165550083006743}-{'f1_val': 0.6160556042184989, 'auprc': 0.6160556042184989, 'loss_val': 0.7458142104667668, 'psi': 0.6160556042184989}
[S16] START round=41 head_norm_before_train=1.911956 (no previous merge yet)
[S16] round=41 local utility u=0.047361 metrics={'f1_val': 0.1858337689492943, 'auprc': 0.1858337689492943, 'loss_val': 2.373506710921145, 'psi': 0.1858337689492943}-{'f1_val': 0.213298139768728, 'auprc': 0.213298139768728, 'loss_val': 2.7154080923728254, 'psi': 0.213298139768728}
[S17] START round=41 head_norm_before_train=1.987947 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.4146654861761882, 'auprc': 0.4146654861761882, 'loss_val': 1.4513532501572601, 'psi': 0.4146654861761882}-{'f1_val': 0.4749113423068634, 'auprc': 0.4749113423068634, 'loss_val': 1.2531633572084837, 'psi': 0.4749113423068634}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.664)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → trigger blocked (psi=0.617)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.333)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.186)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.951078 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.20272546317562393, 'auprc': 0.20272546317562393, 'loss_val': 3.8739806889757875, 'psi': 0.20272546317562393}-{'f1_val': 0.2493174484983867, 'auprc': 0.2493174484983867, 'loss_val': 2.9484662696410506, 'psi': 0.2493174484983867}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.605028 cos_to_last_merge=0.9992 (last merge round=38)
[S3] round=42 local utility u=0.007891 metrics={'f1_val': 0.26116303219106957, 'auprc': 0.26116303219106957, 'loss_val': 1.640076956285675, 'psi': 0.26116303219106957}-{'f1_val': 0.2602004526349822, 'auprc': 0.2602004526349822, 'loss_val': 1.647194742443724, 'psi': 0.2602004526349822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=42 head_norm_before_train=2.004401 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3258595451461521, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3152715146571847, 'psi': 0.3567939207526687}
[S5] START round=42 head_norm_before_train=2.144184 cos_to_last_merge=0.9980 (last merge round=32)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.7323202504346367, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.7017700975761594, 'psi': 0.33300395256917}
[S6] START round=42 head_norm_before_train=1.739172 cos_to_last_merge=0.9763 (last merge round=36)
[S6] round=42 local utility u=0.051148 metrics={'f1_val': 0.026518585675430643, 'auprc': 0.026518585675430643, 'loss_val': 5.365066474593449, 'psi': 0.026518585675430643}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.4204911602610855, 'psi': 0.021310724106324473}
[S7] START round=42 head_norm_before_train=1.794811 cos_to_last_merge=0.9571 (last merge round=31)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 0.9229427209053529, 'psi': 0.23930704898446833}-{'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 0.9089487142637864, 'psi': 0.23930704898446833}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.942615 cos_to_last_merge=0.9642 (last merge round=31)
[S8] round=42 local utility u=0.012098 metrics={'f1_val': 0.43664380496181077, 'auprc': 0.43664380496181077, 'loss_val': 0.47618352278826365, 'psi': 0.43664380496181077}-{'f1_val': 0.4347957497048406, 'auprc': 0.4347957497048406, 'loss_val': 0.48374656007712, 'psi': 0.4347957497048406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=42 head_norm_before_train=1.856159 cos_to_last_merge=0.9989 (last merge round=39)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1039413162203897, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0158575794196474, 'psi': 0.36867172340800847}
[S10] START round=42 head_norm_before_train=1.883130 cos_to_last_merge=0.9976 (last merge round=37)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.2489883361104499, 'auprc': 0.2489883361104499, 'loss_val': 1.7795225129211547, 'psi': 0.2489883361104499}-{'f1_val': 0.2489883361104499, 'auprc': 0.2489883361104499, 'loss_val': 1.7558712318771716, 'psi': 0.2489883361104499}
[S11] START round=42 head_norm_before_train=1.943609 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.32460335534806045, 'auprc': 0.32460335534806045, 'loss_val': 3.5047001776944984, 'psi': 0.32460335534806045}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 3.405073590560099, 'psi': 0.3240172688025449}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.550887 cos_to_last_merge=0.9983 (last merge round=40)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6529796127006912, 'auprc': 0.6529796127006912, 'loss_val': 0.7757718065672327, 'psi': 0.6529796127006912}-{'f1_val': 0.6644332551972167, 'auprc': 0.6644332551972167, 'loss_val': 0.8212417327652775, 'psi': 0.6644332551972167}
[S14] START round=42 head_norm_before_train=1.884227 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.392126199538318, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.358214469154071, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.590517 cos_to_last_merge=0.9976 (last merge round=39)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.6783273154813799, 'psi': 0.6149367764291455}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.6927884541340974, 'psi': 0.6165550083006743}
[S16] START round=42 head_norm_before_train=1.918609 (no previous merge yet)
[S16] round=42 local utility u=0.009425 metrics={'f1_val': 0.18589855325082796, 'auprc': 0.18589855325082796, 'loss_val': 2.3552401502449887, 'psi': 0.18589855325082796}-{'f1_val': 0.1858337689492943, 'auprc': 0.1858337689492943, 'loss_val': 2.373506710921145, 'psi': 0.1858337689492943}
[S17] START round=42 head_norm_before_train=2.001494 (no previous merge yet)
[S17] round=42 local utility u=0.317848 metrics={'f1_val': 0.46765370502953285, 'auprc': 0.46765370502953285, 'loss_val': 1.2925515824131675, 'psi': 0.46765370502953285}-{'f1_val': 0.4146654861761882, 'auprc': 0.4146654861761882, 'loss_val': 1.4513532501572601, 'psi': 0.4146654861761882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.027)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.957257 (no previous merge yet)
[S2] round=43 local utility u=0.584761 metrics={'f1_val': 0.2619428876434481, 'auprc': 0.2619428876434481, 'loss_val': 3.23741528261199, 'psi': 0.2619428876434481}-{'f1_val': 0.20272546317562393, 'auprc': 0.20272546317562393, 'loss_val': 3.8739806889757875, 'psi': 0.20272546317562393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=43 head_norm_before_train=1.621132 cos_to_last_merge=0.9987 (last merge round=38)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.25034216747542615, 'auprc': 0.25034216747542615, 'loss_val': 1.683255978491419, 'psi': 0.25034216747542615}-{'f1_val': 0.26116303219106957, 'auprc': 0.26116303219106957, 'loss_val': 1.640076956285675, 'psi': 0.26116303219106957}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.014627 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3418794740893427, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3258595451461521, 'psi': 0.3567939207526687}
[S5] START round=43 head_norm_before_train=2.158062 cos_to_last_merge=0.9977 (last merge round=32)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.7843267524426087, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.7323202504346367, 'psi': 0.33300395256917}
[S6] START round=43 head_norm_before_train=1.763707 cos_to_last_merge=0.9726 (last merge round=36)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.594973982508976, 'psi': 0.021967963386727688}-{'f1_val': 0.026518585675430643, 'auprc': 0.026518585675430643, 'loss_val': 5.365066474593449, 'psi': 0.026518585675430643}
[S7] START round=43 head_norm_before_train=1.800950 cos_to_last_merge=0.9560 (last merge round=31)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.9292271898293164, 'psi': 0.2396131805157593}-{'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 0.9229427209053529, 'psi': 0.23930704898446833}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.951753 cos_to_last_merge=0.9633 (last merge round=31)
[S8] round=43 local utility u=0.015194 metrics={'f1_val': 0.43909917737213083, 'auprc': 0.43909917737213083, 'loss_val': 0.467892942332569, 'psi': 0.43909917737213083}-{'f1_val': 0.43664380496181077, 'auprc': 0.43664380496181077, 'loss_val': 0.47618352278826365, 'psi': 0.43664380496181077}
[S8] not sending this round → trigger blocked (psi=0.439)
[S9] START round=43 head_norm_before_train=1.878560 cos_to_last_merge=0.9979 (last merge round=39)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.184194620337288, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1039413162203897, 'psi': 0.36867172340800847}
[S10] START round=43 head_norm_before_train=1.909451 cos_to_last_merge=0.9967 (last merge round=37)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.24946339136656331, 'auprc': 0.24946339136656331, 'loss_val': 1.8572576942283767, 'psi': 0.24946339136656331}-{'f1_val': 0.2489883361104499, 'auprc': 0.2489883361104499, 'loss_val': 1.7795225129211547, 'psi': 0.2489883361104499}
[S11] START round=43 head_norm_before_train=1.951568 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.32571602681291895, 'auprc': 0.32571602681291895, 'loss_val': 3.5399848483072844, 'psi': 0.32571602681291895}-{'f1_val': 0.32460335534806045, 'auprc': 0.32460335534806045, 'loss_val': 3.5047001776944984, 'psi': 0.32460335534806045}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.573345 cos_to_last_merge=0.9943 (last merge round=40)
[S13] round=43 local utility u=0.035489 metrics={'f1_val': 0.651836920057726, 'auprc': 0.651836920057726, 'loss_val': 0.6945098017179977, 'psi': 0.651836920057726}-{'f1_val': 0.6529796127006912, 'auprc': 0.6529796127006912, 'loss_val': 0.7757718065672327, 'psi': 0.6529796127006912}
[S14] START round=43 head_norm_before_train=1.890308 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.426908025792542, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.392126199538318, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.619656 cos_to_last_merge=0.9957 (last merge round=39)
[S15] round=43 local utility u=0.017933 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6437240415852167, 'psi': 0.6150769866718802}-{'f1_val': 0.6149367764291455, 'auprc': 0.6149367764291455, 'loss_val': 0.6783273154813799, 'psi': 0.6149367764291455}
[S16] START round=43 head_norm_before_train=1.925091 (no previous merge yet)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.18745848279527036, 'auprc': 0.18745848279527036, 'loss_val': 3.4544438951219316, 'psi': 0.18745848279527036}-{'f1_val': 0.18589855325082796, 'auprc': 0.18589855325082796, 'loss_val': 2.3552401502449887, 'psi': 0.18589855325082796}
[S17] START round=43 head_norm_before_train=2.013302 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.4511372949916719, 'auprc': 0.4511372949916719, 'loss_val': 1.3849666155976204, 'psi': 0.4511372949916719}-{'f1_val': 0.46765370502953285, 'auprc': 0.46765370502953285, 'loss_val': 1.2925515824131675, 'psi': 0.46765370502953285}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.963175 (no previous merge yet)
[S2] round=44 local utility u=0.551080 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.085066928615208, 'psi': 0.3674775928297055}-{'f1_val': 0.2619428876434481, 'auprc': 0.2619428876434481, 'loss_val': 3.23741528261199, 'psi': 0.2619428876434481}
[S2] not sending this round → trigger blocked (psi=0.367)
[S3] START round=44 head_norm_before_train=1.632353 cos_to_last_merge=0.9983 (last merge round=38)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.2510919755397479, 'auprc': 0.2510919755397479, 'loss_val': 1.7073596546514234, 'psi': 0.2510919755397479}-{'f1_val': 0.25034216747542615, 'auprc': 0.25034216747542615, 'loss_val': 1.683255978491419, 'psi': 0.25034216747542615}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=2.019487 (no previous merge yet)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.346034619859531, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3418794740893427, 'psi': 0.3567939207526687}
[S5] START round=44 head_norm_before_train=2.173601 cos_to_last_merge=0.9975 (last merge round=32)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.8225943626121204, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.7843267524426087, 'psi': 0.33300395256917}
[S6] START round=44 head_norm_before_train=1.783551 cos_to_last_merge=0.9697 (last merge round=36)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.849064793628483, 'psi': 0.02153000458085204}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.594973982508976, 'psi': 0.021967963386727688}
[S7] START round=44 head_norm_before_train=1.806563 cos_to_last_merge=0.9550 (last merge round=31)
[S7] round=44 local utility u=0.001764 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9263879752327535, 'psi': 0.23968964488212474}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.9292271898293164, 'psi': 0.2396131805157593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=44 head_norm_before_train=1.960067 cos_to_last_merge=0.9625 (last merge round=31)
[S8] round=44 local utility u=0.211727 metrics={'f1_val': 0.48509122277603123, 'auprc': 0.48509122277603123, 'loss_val': 0.4583675328166381, 'psi': 0.48509122277603123}-{'f1_val': 0.43909917737213083, 'auprc': 0.43909917737213083, 'loss_val': 0.467892942332569, 'psi': 0.43909917737213083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] sending update (kind=head size=1808 to 1 peers)
[S9] START round=44 head_norm_before_train=1.897790 cos_to_last_merge=0.9969 (last merge round=39)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.257084780425094, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.184194620337288, 'psi': 0.36867172340800847}
[S10] START round=44 head_norm_before_train=1.933528 cos_to_last_merge=0.9958 (last merge round=37)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.24952290076335878, 'auprc': 0.24952290076335878, 'loss_val': 1.9036689467879995, 'psi': 0.2495229007633588}-{'f1_val': 0.24946339136656331, 'auprc': 0.24946339136656331, 'loss_val': 1.8572576942283767, 'psi': 0.24946339136656331}
[S11] START round=44 head_norm_before_train=1.959679 (no previous merge yet)
[S11] round=44 local utility u=0.004936 metrics={'f1_val': 0.3245294474802672, 'auprc': 0.3245294474802672, 'loss_val': 3.5194342236643985, 'psi': 0.3245294474802672}-{'f1_val': 0.32571602681291895, 'auprc': 0.32571602681291895, 'loss_val': 3.5399848483072844, 'psi': 0.32571602681291895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=44 head_norm_before_train=1.606640 cos_to_last_merge=0.9880 (last merge round=40)
[S13] round=44 local utility u=0.095163 metrics={'f1_val': 0.6632577268710548, 'auprc': 0.6632577268710548, 'loss_val': 0.606970088546802, 'psi': 0.6632577268710548}-{'f1_val': 0.651836920057726, 'auprc': 0.651836920057726, 'loss_val': 0.6945098017179977, 'psi': 0.651836920057726}
[S14] START round=44 head_norm_before_train=1.896091 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.459577230380918, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.426908025792542, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.648200 cos_to_last_merge=0.9937 (last merge round=39)
[S15] round=44 local utility u=0.016389 metrics={'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6159848062438639, 'psi': 0.615636807189815}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6437240415852167, 'psi': 0.6150769866718802}
[S16] START round=44 head_norm_before_train=1.928856 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.13826508146191105, 'auprc': 0.13826508146191105, 'loss_val': 4.385487659386638, 'psi': 0.13826508146191105}-{'f1_val': 0.18745848279527036, 'auprc': 0.18745848279527036, 'loss_val': 3.4544438951219316, 'psi': 0.18745848279527036}
[S17] START round=44 head_norm_before_train=2.027805 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.4081148407199394, 'auprc': 0.4081148407199394, 'loss_val': 1.5932895759101724, 'psi': 0.4081148407199394}-{'f1_val': 0.4511372949916719, 'auprc': 0.4511372949916719, 'loss_val': 1.3849666155976204, 'psi': 0.4511372949916719}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.663)
[S15] not sending this round → trigger blocked (psi=0.616)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.968406 (no previous merge yet)
[S2] round=45 local utility u=0.000209 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0846480248752517, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.085066928615208, 'psi': 0.3674775928297055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=45 head_norm_before_train=1.645331 cos_to_last_merge=0.9978 (last merge round=38)
[S3] round=45 local utility u=0.019482 metrics={'f1_val': 0.25794871794871793, 'auprc': 0.25794871794871793, 'loss_val': 1.7301066532596507, 'psi': 0.25794871794871793}-{'f1_val': 0.2510919755397479, 'auprc': 0.2510919755397479, 'loss_val': 1.7073596546514234, 'psi': 0.2510919755397479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=45 head_norm_before_train=2.028264 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.351572469841715, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.346034619859531, 'psi': 0.3567939207526687}
[S5] START round=45 head_norm_before_train=2.189701 cos_to_last_merge=0.9973 (last merge round=32)
[S5] round=45 local utility u=0.020910 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.780775314983719, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.8225943626121204, 'psi': 0.33300395256917}
[S6] START round=45 head_norm_before_train=1.799939 cos_to_last_merge=0.9675 (last merge round=36)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.97790724213644, 'psi': 0.021310724106324473}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.849064793628483, 'psi': 0.02153000458085204}
[S7] START round=45 head_norm_before_train=1.821440 cos_to_last_merge=0.9533 (last merge round=31)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.2383860153256705, 'auprc': 0.2383860153256705, 'loss_val': 0.918593740604031, 'psi': 0.2383860153256705}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9263879752327535, 'psi': 0.23968964488212474}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.967603 cos_to_last_merge=0.9620 (last merge round=31)
[S8] round=45 local utility u=0.544655 metrics={'f1_val': 0.605098705547698, 'auprc': 0.605098705547698, 'loss_val': 0.44912563419566826, 'psi': 0.605098705547698}-{'f1_val': 0.48509122277603123, 'auprc': 0.48509122277603123, 'loss_val': 0.4583675328166381, 'psi': 0.48509122277603123}
[S8] not sending this round → trigger blocked (psi=0.605)
[S9] START round=45 head_norm_before_train=1.914661 cos_to_last_merge=0.9961 (last merge round=39)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.308668940201868, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.257084780425094, 'psi': 0.36867172340800847}
[S10] START round=45 head_norm_before_train=1.955419 cos_to_last_merge=0.9949 (last merge round=37)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.24952290076335878, 'auprc': 0.24952290076335878, 'loss_val': 1.9373613430623993, 'psi': 0.2495229007633588}-{'f1_val': 0.24952290076335878, 'auprc': 0.24952290076335878, 'loss_val': 1.9036689467879995, 'psi': 0.2495229007633588}
[S11] START round=45 head_norm_before_train=1.967909 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.32460335534806045, 'auprc': 0.32460335534806045, 'loss_val': 3.5407543812758613, 'psi': 0.32460335534806045}-{'f1_val': 0.3245294474802672, 'auprc': 0.3245294474802672, 'loss_val': 3.5194342236643985, 'psi': 0.3245294474802672}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.643170 cos_to_last_merge=0.9806 (last merge round=40)
[S13] round=45 local utility u=0.030847 metrics={'f1_val': 0.6646461055498384, 'auprc': 0.6646461055498384, 'loss_val': 0.5577715576128608, 'psi': 0.6646461055498384}-{'f1_val': 0.6632577268710548, 'auprc': 0.6632577268710548, 'loss_val': 0.606970088546802, 'psi': 0.6632577268710548}
[S14] START round=45 head_norm_before_train=1.901868 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.4900097294349015, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.459577230380918, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.673634 cos_to_last_merge=0.9918 (last merge round=39)
[S15] round=45 local utility u=0.007724 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6055602430346878, 'psi': 0.6161950003225232}-{'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6159848062438639, 'psi': 0.615636807189815}
[S16] START round=45 head_norm_before_train=1.933733 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.09186037223420401, 'auprc': 0.09186037223420401, 'loss_val': 4.822180572823295, 'psi': 0.09186037223420401}-{'f1_val': 0.13826508146191105, 'auprc': 0.13826508146191105, 'loss_val': 4.385487659386638, 'psi': 0.13826508146191105}
[S17] START round=45 head_norm_before_train=2.040044 (no previous merge yet)
[S17] round=45 local utility u=0.403730 metrics={'f1_val': 0.475335802846615, 'auprc': 0.475335802846615, 'loss_val': 1.3908189504541697, 'psi': 0.47533580284661503}-{'f1_val': 0.4081148407199394, 'auprc': 0.4081148407199394, 'loss_val': 1.5932895759101724, 'psi': 0.4081148407199394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S2] START round=46 head_norm_before_train=1.973468 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.22016051837125394, 'auprc': 0.22016051837125394, 'loss_val': 3.549164728651501, 'psi': 0.22016051837125394}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0846480248752517, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.659629 cos_to_last_merge=0.9972 (last merge round=38)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 1.7661906064746369, 'psi': 0.2584955354275069}-{'f1_val': 0.25794871794871793, 'auprc': 0.25794871794871793, 'loss_val': 1.7301066532596507, 'psi': 0.25794871794871793}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.036768 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3656767892557282, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.351572469841715, 'psi': 0.3567939207526687}
[S5] START round=46 head_norm_before_train=2.196912 cos_to_last_merge=0.9969 (last merge round=32)
[S5] round=46 local utility u=0.039810 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7056831993632233, 'psi': 0.3335071121394324}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.780775314983719, 'psi': 0.33300395256917}
[S6] START round=46 head_norm_before_train=1.813842 cos_to_last_merge=0.9656 (last merge round=36)
[S6] round=46 local utility u=0.013632 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.954588520145243, 'psi': 0.021749084249084248}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.97790724213644, 'psi': 0.021310724106324473}
[S7] START round=46 head_norm_before_train=1.832025 cos_to_last_merge=0.9519 (last merge round=31)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9327427671432319, 'psi': 0.23976608187134504}-{'f1_val': 0.2383860153256705, 'auprc': 0.2383860153256705, 'loss_val': 0.918593740604031, 'psi': 0.2383860153256705}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.973915 cos_to_last_merge=0.9616 (last merge round=31)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.5881274681842918, 'auprc': 0.5881274681842918, 'loss_val': 0.44295341360858503, 'psi': 0.5881274681842918}-{'f1_val': 0.605098705547698, 'auprc': 0.605098705547698, 'loss_val': 0.44912563419566826, 'psi': 0.605098705547698}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.928964 cos_to_last_merge=0.9953 (last merge round=39)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.353531763110125, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.308668940201868, 'psi': 0.36867172340800847}
[S10] START round=46 head_norm_before_train=1.975425 cos_to_last_merge=0.9940 (last merge round=37)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.24952290076335878, 'auprc': 0.24952290076335878, 'loss_val': 1.9779697827875233, 'psi': 0.2495229007633588}-{'f1_val': 0.24952290076335878, 'auprc': 0.24952290076335878, 'loss_val': 1.9373613430623993, 'psi': 0.2495229007633588}
[S11] START round=46 head_norm_before_train=1.975960 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.3261632341723875, 'auprc': 0.3261632341723875, 'loss_val': 3.5857844898368367, 'psi': 0.3261632341723875}-{'f1_val': 0.32460335534806045, 'auprc': 0.32460335534806045, 'loss_val': 3.5407543812758613, 'psi': 0.32460335534806045}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.669141 cos_to_last_merge=0.9751 (last merge round=40)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6646461055498384, 'auprc': 0.6646461055498384, 'loss_val': 0.5641692123969807, 'psi': 0.6646461055498384}-{'f1_val': 0.6646461055498384, 'auprc': 0.6646461055498384, 'loss_val': 0.5577715576128608, 'psi': 0.6646461055498384}
[S14] START round=46 head_norm_before_train=1.907620 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.521125738661182, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.4900097294349015, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.695929 cos_to_last_merge=0.9901 (last merge round=39)
[S15] round=46 local utility u=0.004006 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.597548700157158, 'psi': 0.6161950003225232}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6055602430346878, 'psi': 0.6161950003225232}
[S16] START round=46 head_norm_before_train=1.939069 (no previous merge yet)
[S16] round=46 local utility u=0.325681 metrics={'f1_val': 0.1332147884715122, 'auprc': 0.1332147884715122, 'loss_val': 4.5430086507113385, 'psi': 0.1332147884715122}-{'f1_val': 0.09186037223420401, 'auprc': 0.09186037223420401, 'loss_val': 4.822180572823295, 'psi': 0.09186037223420401}
[S17] START round=46 head_norm_before_train=2.053253 (no previous merge yet)
[S17] round=46 local utility u=0.675798 metrics={'f1_val': 0.5971562655200979, 'auprc': 0.5971562655200979, 'loss_val': 1.1356076845345695, 'psi': 0.5971562655200979}-{'f1_val': 0.475335802846615, 'auprc': 0.475335802846615, 'loss_val': 1.3908189504541697, 'psi': 0.47533580284661503}
[S17] not sending this round → trigger blocked (psi=0.597)
[S13]  timeout peer S15
[S9]  timeout peer S3
[S10]  timeout peer S7
[S16]  timeout peer S6
[S15]  timeout peer S10
[S4]  timeout peer S2
[S6]  timeout peer S8
[S5]  timeout peer S9
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.616)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] not sending this round → trigger blocked (psi=0.022)
[S2] START round=47 head_norm_before_train=1.978679 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.19378127820165725, 'auprc': 0.19378127820165725, 'loss_val': 4.423540212576063, 'psi': 0.19378127820165725}-{'f1_val': 0.22016051837125394, 'auprc': 0.22016051837125394, 'loss_val': 3.549164728651501, 'psi': 0.22016051837125394}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.674149 cos_to_last_merge=0.9966 (last merge round=38)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.258047967166859, 'auprc': 0.258047967166859, 'loss_val': 1.7912064735578759, 'psi': 0.258047967166859}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 1.7661906064746369, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.045460 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3785344563255983, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3656767892557282, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=2.202151 cos_to_last_merge=0.9965 (last merge round=32)
[S5] round=47 local utility u=0.004925 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6958326075411123, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7056831993632233, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=47 head_norm_before_train=1.826052 cos_to_last_merge=0.9640 (last merge round=36)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.959907399003848, 'psi': 0.021967963386727688}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.954588520145243, 'psi': 0.021749084249084248}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.835809 cos_to_last_merge=0.9511 (last merge round=31)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.23846291973424313, 'auprc': 0.23846291973424313, 'loss_val': 0.9394190620976811, 'psi': 0.23846291973424316}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9327427671432319, 'psi': 0.23976608187134504}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.979637 cos_to_last_merge=0.9610 (last merge round=31)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.4372585780342658, 'auprc': 0.4372585780342658, 'loss_val': 0.44797029165144187, 'psi': 0.4372585780342658}-{'f1_val': 0.5881274681842918, 'auprc': 0.5881274681842918, 'loss_val': 0.44295341360858503, 'psi': 0.5881274681842918}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.941841 cos_to_last_merge=0.9946 (last merge round=39)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.397033128528377, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.353531763110125, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.993228 cos_to_last_merge=0.9932 (last merge round=37)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.24928503336510963, 'auprc': 0.24928503336510963, 'loss_val': 1.9820157880094829, 'psi': 0.24928503336510963}-{'f1_val': 0.24952290076335878, 'auprc': 0.24952290076335878, 'loss_val': 1.9779697827875233, 'psi': 0.2495229007633588}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.983648 (no previous merge yet)
[S11] round=47 local utility u=0.001834 metrics={'f1_val': 0.33047376149625163, 'auprc': 0.33047376149625163, 'loss_val': 3.6209116256160963, 'psi': 0.33047376149625163}-{'f1_val': 0.3261632341723875, 'auprc': 0.3261632341723875, 'loss_val': 3.5857844898368367, 'psi': 0.3261632341723875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=47 head_norm_before_train=1.691847 cos_to_last_merge=0.9704 (last merge round=40)
[S13] round=47 local utility u=0.023585 metrics={'f1_val': 0.6650709964249512, 'auprc': 0.6650709964249512, 'loss_val': 0.5208240393711214, 'psi': 0.6650709964249512}-{'f1_val': 0.6646461055498384, 'auprc': 0.6646461055498384, 'loss_val': 0.5641692123969807, 'psi': 0.6646461055498384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=47 head_norm_before_train=1.913081 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.551199808182496, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.521125738661182, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.715697 cos_to_last_merge=0.9885 (last merge round=39)
[S15] round=47 local utility u=0.004195 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5904122375059941, 'psi': 0.6163342951580373}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.597548700157158, 'psi': 0.6161950003225232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=47 head_norm_before_train=1.944579 (no previous merge yet)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 5.3058324703723265, 'psi': 0.09036289353520788}-{'f1_val': 0.1332147884715122, 'auprc': 0.1332147884715122, 'loss_val': 4.5430086507113385, 'psi': 0.1332147884715122}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.060626 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.43843833185448094, 'auprc': 0.43843833185448094, 'loss_val': 1.5408133307738743, 'psi': 0.43843833185448094}-{'f1_val': 0.5971562655200979, 'auprc': 0.5971562655200979, 'loss_val': 1.1356076845345695, 'psi': 0.5971562655200979}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.984197 (no previous merge yet)
[S2] round=48 local utility u=1.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0941284589099207, 'psi': 0.3674775928297055}-{'f1_val': 0.19378127820165725, 'auprc': 0.19378127820165725, 'loss_val': 4.423540212576063, 'psi': 0.19378127820165725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=48 head_norm_before_train=1.686510 cos_to_last_merge=0.9961 (last merge round=38)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.24711373126995825, 'auprc': 0.24711373126995825, 'loss_val': 1.8397169493030283, 'psi': 0.24711373126995825}-{'f1_val': 0.258047967166859, 'auprc': 0.258047967166859, 'loss_val': 1.7912064735578759, 'psi': 0.258047967166859}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.055837 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3868395937200486, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3785344563255983, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=2.212379 cos_to_last_merge=0.9961 (last merge round=32)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.705029259575398, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6958326075411123, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.836738 cos_to_last_merge=0.9626 (last merge round=36)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.014053794700958, 'psi': 0.021967963386727688}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.959907399003848, 'psi': 0.021967963386727688}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.838547 cos_to_last_merge=0.9501 (last merge round=31)
[S7] round=48 local utility u=0.004667 metrics={'f1_val': 0.23915381857296522, 'auprc': 0.23915381857296522, 'loss_val': 0.9363024857248297, 'psi': 0.23915381857296522}-{'f1_val': 0.23846291973424313, 'auprc': 0.23846291973424313, 'loss_val': 0.9394190620976811, 'psi': 0.23846291973424316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] sending update (kind=head size=1809 to 1 peers)
[S8] START round=48 head_norm_before_train=1.985281 cos_to_last_merge=0.9604 (last merge round=31)
[S8] round=48 local utility u=0.008749 metrics={'f1_val': 0.43909917737213083, 'auprc': 0.43909917737213083, 'loss_val': 0.4470384619360178, 'psi': 0.43909917737213083}-{'f1_val': 0.4372585780342658, 'auprc': 0.4372585780342658, 'loss_val': 0.44797029165144187, 'psi': 0.4372585780342658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=48 head_norm_before_train=1.953681 cos_to_last_merge=0.9939 (last merge round=39)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.43502278901525, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.397033128528377, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.009985 cos_to_last_merge=0.9924 (last merge round=37)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.24904761904761905, 'auprc': 0.24904761904761905, 'loss_val': 1.9931182633162186, 'psi': 0.24904761904761902}-{'f1_val': 0.24928503336510963, 'auprc': 0.24928503336510963, 'loss_val': 1.9820157880094829, 'psi': 0.24928503336510963}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.991185 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.33085731971525845, 'auprc': 0.33085731971525845, 'loss_val': 3.6402005507241224, 'psi': 0.33085731971525845}-{'f1_val': 0.33047376149625163, 'auprc': 0.33047376149625163, 'loss_val': 3.6209116256160963, 'psi': 0.33047376149625163}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.709818 cos_to_last_merge=0.9668 (last merge round=40)
[S13] round=48 local utility u=0.025215 metrics={'f1_val': 0.6649648747744116, 'auprc': 0.6649648747744116, 'loss_val': 0.46943825880893275, 'psi': 0.6649648747744116}-{'f1_val': 0.6650709964249512, 'auprc': 0.6650709964249512, 'loss_val': 0.5208240393711214, 'psi': 0.6650709964249512}
[S13] not sending this round → trigger blocked (psi=0.665)
[S14] START round=48 head_norm_before_train=1.918607 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.580910096175896, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.551199808182496, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.734314 cos_to_last_merge=0.9870 (last merge round=39)
[S15] round=48 local utility u=0.003630 metrics={'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.576874214060062, 'psi': 0.615636807189815}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5904122375059941, 'psi': 0.6163342951580373}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=48 head_norm_before_train=1.949494 (no previous merge yet)
[S16] round=48 local utility u=0.541642 metrics={'f1_val': 0.1324129740963408, 'auprc': 0.1324129740963408, 'loss_val': 4.600999886352287, 'psi': 0.1324129740963408}-{'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 5.3058324703723265, 'psi': 0.09036289353520788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=48 head_norm_before_train=2.069848 (no previous merge yet)
[S17] round=48 local utility u=0.034481 metrics={'f1_val': 0.4460271076907004, 'auprc': 0.4460271076907004, 'loss_val': 1.5401506650403656, 'psi': 0.4460271076907004}-{'f1_val': 0.43843833185448094, 'auprc': 0.43843833185448094, 'loss_val': 1.5408133307738743, 'psi': 0.43843833185448094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=49 head_norm_before_train=1.988934 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.136627265201366, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0941284589099207, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.698126 cos_to_last_merge=0.9956 (last merge round=38)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.2465233106659315, 'auprc': 0.2465233106659315, 'loss_val': 1.8724944359416396, 'psi': 0.24652331066593147}-{'f1_val': 0.24711373126995825, 'auprc': 0.24711373126995825, 'loss_val': 1.8397169493030283, 'psi': 0.24711373126995825}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.065423 (no previous merge yet)
[S4] round=49 local utility u=0.000998 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3848439001030564, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3868395937200486, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=49 head_norm_before_train=2.217652 cos_to_last_merge=0.9959 (last merge round=32)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.733282010582857, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.705029259575398, 'psi': 0.33300395256917}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.846661 cos_to_last_merge=0.9614 (last merge round=36)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.094590573753608, 'psi': 0.021749084249084248}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.014053794700958, 'psi': 0.021967963386727688}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.846785 cos_to_last_merge=0.9490 (last merge round=31)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=49 local utility u=0.524882 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.972027498955012, 'psi': 0.35976373724718097}-{'f1_val': 0.23915381857296522, 'auprc': 0.23915381857296522, 'loss_val': 0.9363024857248297, 'psi': 0.23915381857296522}
[S7] not sending this round → trigger blocked (psi=0.360)
[S8] START round=49 head_norm_before_train=1.993001 cos_to_last_merge=0.9594 (last merge round=31)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.4372585780342658, 'auprc': 0.4372585780342658, 'loss_val': 0.45077655558877444, 'psi': 0.4372585780342658}-{'f1_val': 0.43909917737213083, 'auprc': 0.43909917737213083, 'loss_val': 0.4470384619360178, 'psi': 0.43909917737213083}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.964519 cos_to_last_merge=0.9932 (last merge round=39)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4659362155461646, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.43502278901525, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.025400 cos_to_last_merge=0.9917 (last merge round=37)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.24922563736001907, 'auprc': 0.24922563736001907, 'loss_val': 2.019277259594304, 'psi': 0.24922563736001907}-{'f1_val': 0.24904761904761905, 'auprc': 0.24904761904761905, 'loss_val': 1.9931182633162186, 'psi': 0.24904761904761902}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.998499 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.3298619146802438, 'auprc': 0.3298619146802438, 'loss_val': 3.649097662186835, 'psi': 0.3298619146802438}-{'f1_val': 0.33085731971525845, 'auprc': 0.33085731971525845, 'loss_val': 3.6402005507241224, 'psi': 0.33085731971525845}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.726095 cos_to_last_merge=0.9636 (last merge round=40)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6648586857877993, 'auprc': 0.6648586857877993, 'loss_val': 0.46899111642838814, 'psi': 0.6648586857877993}-{'f1_val': 0.6649648747744116, 'auprc': 0.6649648747744116, 'loss_val': 0.46943825880893275, 'psi': 0.6649648747744116}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.923931 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.611450194757036, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.580910096175896, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.752714 cos_to_last_merge=0.9855 (last merge round=39)
[S15] round=49 local utility u=0.001138 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.5708216644103331, 'psi': 0.6152170947577895}-{'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.576874214060062, 'psi': 0.615636807189815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=49 head_norm_before_train=1.955127 (no previous merge yet)
[S16] round=49 local utility u=0.737397 metrics={'f1_val': 0.18745848279527036, 'auprc': 0.18745848279527036, 'loss_val': 3.6216149564148523, 'psi': 0.18745848279527036}-{'f1_val': 0.1324129740963408, 'auprc': 0.1324129740963408, 'loss_val': 4.600999886352287, 'psi': 0.1324129740963408}
[S16] not sending this round → trigger blocked (psi=0.187)
[S17] START round=49 head_norm_before_train=2.080986 (no previous merge yet)
[S17] round=49 local utility u=1.000000 metrics={'f1_val': 0.6308935925845558, 'auprc': 0.6308935925845558, 'loss_val': 1.1119873732928673, 'psi': 0.6308935925845558}-{'f1_val': 0.4460271076907004, 'auprc': 0.4460271076907004, 'loss_val': 1.5401506650403656, 'psi': 0.4460271076907004}
[S17] not sending this round → trigger blocked (psi=0.631)
[runner] rounds complete.
[runner] all agents stopped.
