[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:42003
[S3] → join 127.0.0.1:42002
[S4] → join 127.0.0.1:42002
[S5] → join 127.0.0.1:42002
[S6] → join 127.0.0.1:42002
[S7] → join 127.0.0.1:42002
[S8] → join 127.0.0.1:42002
[S9] → join 127.0.0.1:42002
[S10] → join 127.0.0.1:42002
[S11] → join 127.0.0.1:42002
[S13] → join 127.0.0.1:42002
[S14] → join 127.0.0.1:42002
[S15] → join 127.0.0.1:42002
[S16] → join 127.0.0.1:42002
[S17] → join 127.0.0.1:42002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.209809 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.198080 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.131815 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.144693 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.156048 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.139585 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.136316 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.204646 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.172796 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.192226 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.164396 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.159301 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.152963 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.144411 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.223103 (no previous merge yet)
[S14]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3] + discovered S6
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S10
[S3] + discovered S11
[S3] + discovered S9
[S3] + discovered S7
[S3] + discovered S8
[S3] + discovered S15
[S3] + discovered S17
[S3] + discovered S13
[S3] + discovered S16
[S3] + discovered S4
[S5] + discovered S2
[S4] + discovered S17
[S4] + discovered S16
[S5] + discovered S4
[S4] + discovered S6
[S4] + discovered S10
[S4] + discovered S7
[S4] + discovered S13
[S5] + discovered S3
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S9
[S4] + discovered S8
[S4] + discovered S11
[S4] + discovered S15
[S6] + discovered S4
[S6] + discovered S5
[S5] + discovered S10
[S5] + discovered S17
[S5] + discovered S16
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S13
[S5] + discovered S14
[S6] + discovered S3
[S5] + discovered S15
[S5] + discovered S8
[S5] + discovered S9
[S5] + discovered S7
[S6] + discovered S2
[S6] + discovered S8
[S7] + discovered S2
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S6
[S7] + discovered S4
[S6] + discovered S15
[S6] + discovered S9
[S6] + discovered S16
[S6] + discovered S13
[S6] + discovered S11
[S6] + discovered S14
[S6] + discovered S17
[S6] + discovered S10
[S6] + discovered S7
[S7] + discovered S17
[S7] + discovered S11
[S7] + discovered S13
[S7] + discovered S9
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S10
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S5
[S8] + discovered S2
[S8] + discovered S6
[S8] + discovered S16
[S8] + discovered S17
[S8] + discovered S14
[S8] + discovered S15
[S9] + discovered S6
[S8] + discovered S13
[S9] + discovered S7
[S9] + discovered S2
[S8] + discovered S11
[S9] + discovered S4
[S8] + discovered S9
[S8] + discovered S10
[S9] + discovered S5
[S9] + discovered S3
[S9] + discovered S8
[S10] + discovered S8
[S10] + discovered S5
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S2
[S9] + discovered S14
[S9] + discovered S13
[S9] + discovered S17
[S10] + discovered S7
[S9] + discovered S16
[S9] + discovered S10
[S9] + discovered S15
[S10] + discovered S4
[S9] + discovered S11
[S10] + discovered S3
[S10] + discovered S16
[S10] + discovered S15
[S10] + discovered S13
[S10] + discovered S14
[S10] + discovered S11
[S10] + discovered S17
[S11] + discovered S10
[S11] + discovered S8
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S9
[S11] + discovered S6
[S11] + discovered S4
[S11] + discovered S7
[S11] + discovered S3
[S11] + discovered S16
[S13] + discovered S3
[S13] + discovered S9
[S13] + discovered S4
[S13] + discovered S2
[S11] + discovered S14
[S13] + discovered S6
[S13] + discovered S7
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S11
[S11] + discovered S17
[S11] + discovered S13
[S13] + discovered S10
[S11] + discovered S15
[S14] + discovered S13
[S14] + discovered S3
[S14] + discovered S4
[S14] + discovered S2
[S14] + discovered S9
[S13] + discovered S14
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S6
[S13] + discovered S17
[S14] + discovered S11
[S14] + discovered S10
[S14] + discovered S8
[S14] + discovered S5
[S14] + discovered S7
[S14] + discovered S16
[S15] + discovered S3
[S15] + discovered S7
[S15] + discovered S2
[S15] + discovered S11
[S14] + discovered S15
[S15] + discovered S9
[S15] + discovered S14
[S15] + discovered S5
[S15] + discovered S8
[S15] + discovered S4
[S14] + discovered S17
[S15] + discovered S6
[S15] + discovered S10
[S15] + discovered S13
[S16] + discovered S10
[S16] + discovered S6
[S16] + discovered S11
[S16] + discovered S8
[S16] + discovered S5
[S16] + discovered S7
[S16] + discovered S9
[S16] + discovered S14
[S16] + discovered S15
[S15] + discovered S16
[S16] + discovered S13
[S15] + discovered S17
[S16] + discovered S2
[S16] + discovered S3
[S16] + discovered S4
[S17] + discovered S16
[S17] + discovered S14
[S17] + discovered S3
[S17] + discovered S8
[S17] + discovered S5
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S9
[S17] + discovered S6
[S17] + discovered S7
[S17] + discovered S10
[S17] + discovered S2
[S17] + discovered S15
[S16] + discovered S17
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:42016
[S2] ⇄ pheromone p=1.000 → S13@127.0.0.1:42013
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:42013
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:42004
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:42004
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:42009
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:42015
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:42012
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:42010
[S15] ⇄ pheromone p=1.000 → S11@127.0.0.1:42012
[S10] ⇄ pheromone p=1.000 → S3@127.0.0.1:42003
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:42017
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:42014
[S16] ⇄ pheromone p=1.000 → S17@127.0.0.1:42017
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:42003
[S2] START round=1 head_norm_before_train=1.784181 (no previous merge yet)
[S2] round=1 local utility u=0.061641 metrics={'f1_val': 0.22638495607347708, 'auprc': 0.22638495607347708, 'loss_val': 3.1626733090441714, 'psi': 0.22638495607347708}-{'f1_val': 0.19448340345956053, 'auprc': 0.19448340345956053, 'loss_val': 2.998841612793485, 'psi': 0.19448340345956053}
[S3] START round=1 head_norm_before_train=2.008698 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.2337646333949476, 'auprc': 0.2337646333949476, 'loss_val': 3.3621213361789843, 'psi': 0.23376463339494763}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.7760391512170557, 'psi': 0.3641628959276018}
[S4] START round=1 head_norm_before_train=1.928069 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.708757884401705, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2012570357367904, 'psi': 0.3567939207526687}
[S5] START round=1 head_norm_before_train=2.042133 (no previous merge yet)
[S5] round=1 local utility u=0.097033 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.427664782925638, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.621730157479467, 'psi': 0.3335071121394324}
[S6] START round=1 head_norm_before_train=1.813527 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.475227032546234, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.526355459891927, 'psi': 0.017551963048498844}
[S7] START round=1 head_norm_before_train=1.835193 (no previous merge yet)
[S7] round=1 local utility u=0.083282 metrics={'f1_val': 0.2424720738222438, 'auprc': 0.2424720738222438, 'loss_val': 0.7686759046986539, 'psi': 0.2424720738222438}-{'f1_val': 0.21818380266317397, 'auprc': 0.21818380266317397, 'loss_val': 0.7166455936954496, 'psi': 0.21818380266317397}
[S8] START round=1 head_norm_before_train=1.891066 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.78315850325242, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9410057344071648, 'psi': 0.35939447907390915}
[S9] START round=1 head_norm_before_train=1.931161 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.39252208382552, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9859936857745173, 'psi': 0.36867172340800847}
[S10] START round=1 head_norm_before_train=1.853601 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.2809562181036798, 'auprc': 0.2809562181036798, 'loss_val': 1.657473126700237, 'psi': 0.2809562181036798}-{'f1_val': 0.3141141141141141, 'auprc': 0.3141141141141141, 'loss_val': 1.5493609072514973, 'psi': 0.3141141141141141}
[S11] START round=1 head_norm_before_train=2.033709 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.27417082853118196, 'auprc': 0.27417082853118196, 'loss_val': 2.9910326151602127, 'psi': 0.27417082853118196}-{'f1_val': 0.24831825562514498, 'auprc': 0.24831825562514498, 'loss_val': 2.6824078901529265, 'psi': 0.24831825562514498}
[S13] START round=1 head_norm_before_train=1.802887 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.950617463617166, 'psi': 0.3330058939096267}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7281744788747078, 'psi': 0.3599362944611573}
[S14] START round=1 head_norm_before_train=1.939717 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 7.484797112802915, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 6.662118013913363, 'psi': 0.13582554517133957}
[S15] START round=1 head_norm_before_train=1.865115 (no previous merge yet)
[S15] round=1 local utility u=0.029964 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.5703625483316052, 'psi': 0.6152170947577895}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.6410788119281357, 'psi': 0.6164158146233559}
[S16] START round=1 head_norm_before_train=1.795747 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.05771346365405772, 'auprc': 0.05771346365405772, 'loss_val': 5.810319606185023, 'psi': 0.05771346365405772}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.618643849840252, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.613961 (no previous merge yet)
[S17] round=1 local utility u=0.657188 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.1152809374309278, 'psi': 0.30380970798684975}-{'f1_val': 0.1575095247643874, 'auprc': 0.1575095247643874, 'loss_val': 1.1129556954715616, 'psi': 0.1575095247643874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:42002
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:42011
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:42011
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=2.218458)
[S10] loaded HEAD from S7 (vec_in norm=2.218458)
[S10] cosine check vs S7: cos=-0.0310
[S10] DROPPED delta from S7 (cos=-0.0310 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.215588)
[S2] loaded HEAD from S15 (vec_in norm=2.215588)
[S2] cosine check vs S15: cos=0.0171
[S2] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.984375)
[S10] loaded HEAD from S2 (vec_in norm=1.984375)
[S10] cosine check vs S2: cos=-0.0206
[S10] DROPPED delta from S2 (cos=-0.0206 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.386483)
[S13] loaded HEAD from S5 (vec_in norm=2.386483)
[S13] cosine check vs S5: cos=0.0028
[S13] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:42002
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S17
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.034657)
[S2] loaded HEAD from S17 (vec_in norm=2.034657)
[S2] cosine check vs S17: cos=-0.1303
[S2] DROPPED delta from S17 (cos=-0.1303 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.3330 head_norm=2.169591
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.3330 head_norm=2.169591 delta_norm=0.000000
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.2264 head_norm=1.984375
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.2264 head_norm=1.984375 delta_norm=0.000000
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.984375 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.630263 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1719818440738705, 'psi': 0.3674775928297055}-{'f1_val': 0.22638495607347708, 'auprc': 0.22638495607347708, 'loss_val': 3.1626733090441714, 'psi': 0.22638495607347708}
[S3] START round=2 head_norm_before_train=2.199881 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.23167409608717185, 'auprc': 0.23167409608717185, 'loss_val': 3.679057630544035, 'psi': 0.23167409608717185}-{'f1_val': 0.2337646333949476, 'auprc': 0.2337646333949476, 'loss_val': 3.3621213361789843, 'psi': 0.23376463339494763}
[S4] START round=2 head_norm_before_train=2.183342 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.7831950962822432, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.708757884401705, 'psi': 0.3567939207526687}
[S5] START round=2 head_norm_before_train=2.386483 (no previous merge yet)
[S5] round=2 local utility u=0.202368 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.0274519935870927, 'psi': 0.33400978131092857}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.427664782925638, 'psi': 0.3335071121394324}
[S6] START round=2 head_norm_before_train=2.002998 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 8.127474451004336, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 7.475227032546234, 'psi': 0.017551963048498844}
[S7] START round=2 head_norm_before_train=2.218458 (no previous merge yet)
[S7] round=2 local utility u=0.140706 metrics={'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.5510976523625469, 'psi': 0.24956478487938324}-{'f1_val': 0.2424720738222438, 'auprc': 0.2424720738222438, 'loss_val': 0.7686759046986539, 'psi': 0.2424720738222438}
[S8] START round=2 head_norm_before_train=2.216981 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9432685528467422, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.78315850325242, 'psi': 0.35939447907390915}
[S9] START round=2 head_norm_before_train=2.091892 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.6384915053675613, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.39252208382552, 'psi': 0.36867172340800847}
[S10] START round=2 head_norm_before_train=2.272220 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.2764453254046911, 'auprc': 0.2764453254046911, 'loss_val': 1.8375180484127134, 'psi': 0.2764453254046911}-{'f1_val': 0.2809562181036798, 'auprc': 0.2809562181036798, 'loss_val': 1.657473126700237, 'psi': 0.2809562181036798}
[S11] START round=2 head_norm_before_train=2.233485 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.2836512983571807, 'auprc': 0.2836512983571807, 'loss_val': 3.179060337572256, 'psi': 0.2836512983571807}-{'f1_val': 0.27417082853118196, 'auprc': 0.27417082853118196, 'loss_val': 2.9910326151602127, 'psi': 0.27417082853118196}
[S13] START round=2 head_norm_before_train=2.169591 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.3238595653212324, 'auprc': 0.3238595653212324, 'loss_val': 2.1269788264843323, 'psi': 0.3238595653212324}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.950617463617166, 'psi': 0.3330058939096267}
[S14] START round=2 head_norm_before_train=2.105013 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 7.979703155488471, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 7.484797112802915, 'psi': 0.13582554517133957}
[S15] START round=2 head_norm_before_train=2.215588 (no previous merge yet)
[S15] round=2 local utility u=0.017751 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5461677661386318, 'psi': 0.6164734888353558}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.5703625483316052, 'psi': 0.6152170947577895}
[S16] START round=2 head_norm_before_train=2.005198 (no previous merge yet)
[S16] round=2 local utility u=0.356174 metrics={'f1_val': 0.09103271738260939, 'auprc': 0.09103271738260939, 'loss_val': 5.397844436697145, 'psi': 0.09103271738260939}-{'f1_val': 0.05771346365405772, 'auprc': 0.05771346365405772, 'loss_val': 5.810319606185023, 'psi': 0.05771346365405772}
[S17] START round=2 head_norm_before_train=2.034657 (no previous merge yet)
[S17] round=2 local utility u=1.000000 metrics={'f1_val': 0.7698955394343858, 'auprc': 0.7698955394343858, 'loss_val': 0.7751350384415383, 'psi': 0.7698955394343858}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 1.1152809374309278, 'psi': 0.30380970798684975}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:42003
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:42010
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:42004
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.091)
[S7] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.375488)
[S10] loaded HEAD from S15 (vec_in norm=2.375488)
[S10] cosine check vs S15: cos=0.0098
[S10] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.529886)
[S9] loaded HEAD from S5 (vec_in norm=2.529886)
[S9] cosine check vs S5: cos=0.0710
[S9] BUFFERED delta from S5 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.094801)
[S3] loaded HEAD from S2 (vec_in norm=2.094801)
[S3] cosine check vs S2: cos=-0.0759
[S3] DROPPED delta from S2 (cos=-0.0759 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=2.413650)
[S4] loaded HEAD from S7 (vec_in norm=2.413650)
[S4] cosine check vs S7: cos=0.0269
[S4] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:42014
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.340704)
[S14] loaded HEAD from S17 (vec_in norm=2.340704)
[S14] cosine check vs S17: cos=-0.0064
[S14] DROPPED delta from S17 (cos=-0.0064 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.2764 head_norm=2.450336
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.2764 head_norm=2.450336 delta_norm=0.000000
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.3687 head_norm=2.193605
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.3687 head_norm=2.193605 delta_norm=0.000000
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=2 metric=0.3568 head_norm=2.337477
[S4] stored merged vector for next round verification (round=2)
[S4] DEBUG after merge:  round=2 metric=0.3568 head_norm=2.337477 delta_norm=0.000000
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=2.094801 cos_to_last_merge=0.9990 (last merge round=1)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.3832664697709944, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1719818440738705, 'psi': 0.3674775928297055}
[S3] START round=3 head_norm_before_train=2.310953 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.2290732436472347, 'auprc': 0.2290732436472347, 'loss_val': 3.893086570894093, 'psi': 0.2290732436472347}-{'f1_val': 0.23167409608717185, 'auprc': 0.23167409608717185, 'loss_val': 3.679057630544035, 'psi': 0.23167409608717185}
[S4] START round=3 head_norm_before_train=2.337477 cos_to_last_merge=1.0000 (last merge round=2)
[S4] round=3 local utility u=0.012642 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.7579107931305449, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.7831950962822432, 'psi': 0.3567939207526687}
[S5] START round=3 head_norm_before_train=2.529886 (no previous merge yet)
[S5] round=3 local utility u=0.206838 metrics={'f1_val': 0.33442959559018326, 'auprc': 0.33442959559018326, 'loss_val': 1.6175552689836858, 'psi': 0.33442959559018326}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.0274519935870927, 'psi': 0.33400978131092857}
[S6] START round=3 head_norm_before_train=2.124274 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 8.581755198926635, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 8.127474451004336, 'psi': 0.017551963048498844}
[S7] START round=3 head_norm_before_train=2.413650 (no previous merge yet)
[S7] round=3 local utility u=0.018870 metrics={'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.5133571448709033, 'psi': 0.24956478487938324}-{'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.5510976523625469, 'psi': 0.24956478487938324}
[S8] START round=3 head_norm_before_train=2.338316 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1244984016171786, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.9432685528467422, 'psi': 0.35939447907390915}
[S9] START round=3 head_norm_before_train=2.193605 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.8255884167961725, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.6384915053675613, 'psi': 0.36867172340800847}
[S10] START round=3 head_norm_before_train=2.450336 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.2751364503189321, 'auprc': 0.2751364503189321, 'loss_val': 1.9676145648539785, 'psi': 0.2751364503189321}-{'f1_val': 0.2764453254046911, 'auprc': 0.2764453254046911, 'loss_val': 1.8375180484127134, 'psi': 0.2764453254046911}
[S11] START round=3 head_norm_before_train=2.352193 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.28870010787486516, 'auprc': 0.28870010787486516, 'loss_val': 3.308179055225193, 'psi': 0.28870010787486516}-{'f1_val': 0.2836512983571807, 'auprc': 0.2836512983571807, 'loss_val': 3.179060337572256, 'psi': 0.2836512983571807}
[S13] START round=3 head_norm_before_train=2.387760 cos_to_last_merge=0.9965 (last merge round=1)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.348761037451321, 'psi': 0.3330058939096267}-{'f1_val': 0.3238595653212324, 'auprc': 0.3238595653212324, 'loss_val': 2.1269788264843323, 'psi': 0.3238595653212324}
[S14] START round=3 head_norm_before_train=2.206378 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.343204250731514, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 7.979703155488471, 'psi': 0.13582554517133957}
[S15] START round=3 head_norm_before_train=2.375488 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6040477357280463, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5461677661386318, 'psi': 0.6164734888353558}
[S16] START round=3 head_norm_before_train=2.123809 (no previous merge yet)
[S16] round=3 local utility u=0.561573 metrics={'f1_val': 0.14786048184106437, 'auprc': 0.14786048184106437, 'loss_val': 4.786148864220476, 'psi': 0.14786048184106437}-{'f1_val': 0.09103271738260939, 'auprc': 0.09103271738260939, 'loss_val': 5.397844436697145, 'psi': 0.09103271738260939}
[S17] START round=3 head_norm_before_train=2.340704 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.5189887613975902, 'auprc': 0.5189887613975902, 'loss_val': 0.8537437830289916, 'psi': 0.5189887613975902}-{'f1_val': 0.7698955394343858, 'auprc': 0.7698955394343858, 'loss_val': 0.7751350384415383, 'psi': 0.7698955394343858}
[S2]  timeout peer S3
[S3]  timeout peer S2
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.148)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=2.175928 cos_to_last_merge=0.9973 (last merge round=1)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.5394028594976903, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.3832664697709944, 'psi': 0.3674775928297055}
[S3] START round=4 head_norm_before_train=2.392425 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.22369333585524243, 'auprc': 0.22369333585524243, 'loss_val': 4.066400355088799, 'psi': 0.22369333585524243}-{'f1_val': 0.2290732436472347, 'auprc': 0.2290732436472347, 'loss_val': 3.893086570894093, 'psi': 0.2290732436472347}
[S4] START round=4 head_norm_before_train=2.446440 cos_to_last_merge=0.9971 (last merge round=2)
[S4] round=4 local utility u=0.010931 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.7360488007384216, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.7579107931305449, 'psi': 0.3567939207526687}
[S5] START round=4 head_norm_before_train=2.708433 (no previous merge yet)
[S5] round=4 local utility u=0.099929 metrics={'f1_val': 0.3343472707664763, 'auprc': 0.3343472707664763, 'loss_val': 1.4169568506900472, 'psi': 0.3343472707664763}-{'f1_val': 0.33442959559018326, 'auprc': 0.33442959559018326, 'loss_val': 1.6175552689836858, 'psi': 0.33442959559018326}
[S6] START round=4 head_norm_before_train=2.206236 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 8.909683475496623, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 8.581755198926635, 'psi': 0.017551963048498844}
[S7] START round=4 head_norm_before_train=2.612495 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.5806283322286421, 'psi': 0.2496892866020383}-{'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.5133571448709033, 'psi': 0.24956478487938324}
[S8] START round=4 head_norm_before_train=2.474858 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.2460468145091137, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.1244984016171786, 'psi': 0.35939447907390915}
[S9] START round=4 head_norm_before_train=2.270787 cos_to_last_merge=0.9997 (last merge round=2)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.9789874545374913, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.8255884167961725, 'psi': 0.36867172340800847}
[S10] START round=4 head_norm_before_train=2.568727 cos_to_last_merge=0.9995 (last merge round=2)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.2750821827744905, 'auprc': 0.2750821827744905, 'loss_val': 2.0702054811120396, 'psi': 0.2750821827744905}-{'f1_val': 0.2751364503189321, 'auprc': 0.2751364503189321, 'loss_val': 1.9676145648539785, 'psi': 0.2751364503189321}
[S11] START round=4 head_norm_before_train=2.439028 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.2933278531305658, 'auprc': 0.2933278531305658, 'loss_val': 3.416328962037655, 'psi': 0.2933278531305658}-{'f1_val': 0.28870010787486516, 'auprc': 0.28870010787486516, 'loss_val': 3.308179055225193, 'psi': 0.28870010787486516}
[S13] START round=4 head_norm_before_train=2.558250 cos_to_last_merge=0.9919 (last merge round=1)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.31338109544719206, 'auprc': 0.31338109544719206, 'loss_val': 2.31797612768825, 'psi': 0.31338109544719206}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.348761037451321, 'psi': 0.3330058939096267}
[S14] START round=4 head_norm_before_train=2.281420 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.63595190175898, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.343204250731514, 'psi': 0.13582554517133957}
[S15] START round=4 head_norm_before_train=2.499236 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6334946450559007, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6040477357280463, 'psi': 0.6164734888353558}
[S16] START round=4 head_norm_before_train=2.245319 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.15306848924960845, 'auprc': 0.15306848924960845, 'loss_val': 5.0707590785480985, 'psi': 0.15306848924960845}-{'f1_val': 0.14786048184106437, 'auprc': 0.14786048184106437, 'loss_val': 4.786148864220476, 'psi': 0.14786048184106437}
[S17] START round=4 head_norm_before_train=2.491856 (no previous merge yet)
[S17] round=4 local utility u=0.257124 metrics={'f1_val': 0.5608623816589065, 'auprc': 0.5608623816589065, 'loss_val': 0.7163584354630641, 'psi': 0.5608623816589065}-{'f1_val': 0.5189887613975902, 'auprc': 0.5189887613975902, 'loss_val': 0.8537437830289916, 'psi': 0.5189887613975902}
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=2.239323 cos_to_last_merge=0.9955 (last merge round=1)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.6590401118320512, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.5394028594976903, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=5 head_norm_before_train=2.458284 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.22209567198177674, 'auprc': 0.22209567198177674, 'loss_val': 4.206267385831835, 'psi': 0.22209567198177674}-{'f1_val': 0.22369333585524243, 'auprc': 0.22369333585524243, 'loss_val': 4.066400355088799, 'psi': 0.22369333585524243}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=5 head_norm_before_train=2.473517 cos_to_last_merge=0.9909 (last merge round=2)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.8598558325433348, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.7360488007384216, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=5 head_norm_before_train=2.834560 (no previous merge yet)
[S5] round=5 local utility u=0.313312 metrics={'f1_val': 0.3351853131249382, 'auprc': 0.3351853131249382, 'loss_val': 0.7978750576188638, 'psi': 0.3351853131249382}-{'f1_val': 0.3343472707664763, 'auprc': 0.3343472707664763, 'loss_val': 1.4169568506900472, 'psi': 0.3343472707664763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=5 head_norm_before_train=2.270619 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 9.178477739967953, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 8.909683475496623, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=5 head_norm_before_train=2.743309 (no previous merge yet)
[S7] round=5 local utility u=1.000000 metrics={'f1_val': 0.4868875217479479, 'auprc': 0.4868875217479479, 'loss_val': 0.32326057697415855, 'psi': 0.4868875217479479}-{'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.5806283322286421, 'psi': 0.2496892866020383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=5 head_norm_before_train=2.582940 (no previous merge yet)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.3722811611564487, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.2460468145091137, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=5 head_norm_before_train=2.334231 cos_to_last_merge=0.9992 (last merge round=2)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.108199584489427, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.9789874545374913, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=5 head_norm_before_train=2.658487 cos_to_last_merge=0.9987 (last merge round=2)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.2750821827744905, 'auprc': 0.2750821827744905, 'loss_val': 2.1559877263491956, 'psi': 0.2750821827744905}-{'f1_val': 0.2750821827744905, 'auprc': 0.2750821827744905, 'loss_val': 2.0702054811120396, 'psi': 0.2750821827744905}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=5 head_norm_before_train=2.509389 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.2966195622055971, 'auprc': 0.2966195622055971, 'loss_val': 3.504019753874775, 'psi': 0.2966195622055971}-{'f1_val': 0.2933278531305658, 'auprc': 0.2933278531305658, 'loss_val': 3.416328962037655, 'psi': 0.2933278531305658}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=5 head_norm_before_train=2.671951 cos_to_last_merge=0.9888 (last merge round=1)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.26878097125867195, 'auprc': 0.26878097125867195, 'loss_val': 2.4744169634530686, 'psi': 0.26878097125867195}-{'f1_val': 0.31338109544719206, 'auprc': 0.31338109544719206, 'loss_val': 2.31797612768825, 'psi': 0.31338109544719206}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=5 head_norm_before_train=2.342322 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.887980334687267, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.63595190175898, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=5 head_norm_before_train=2.591482 (no previous merge yet)
[S15] round=5 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6570240697992168, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6334946450559007, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=5 head_norm_before_train=2.327072 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.15590484282073067, 'auprc': 0.15590484282073067, 'loss_val': 5.2512185698854665, 'psi': 0.15590484282073067}-{'f1_val': 0.15306848924960845, 'auprc': 0.15306848924960845, 'loss_val': 5.0707590785480985, 'psi': 0.15306848924960845}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=5 head_norm_before_train=2.608711 (no previous merge yet)
[S17] round=5 local utility u=0.249453 metrics={'f1_val': 0.5907351630074988, 'auprc': 0.5907351630074988, 'loss_val': 0.4863079356192047, 'psi': 0.5907351630074988}-{'f1_val': 0.5608623816589065, 'auprc': 0.5608623816589065, 'loss_val': 0.7163584354630641, 'psi': 0.5608623816589065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=6 head_norm_before_train=2.292008 cos_to_last_merge=0.9938 (last merge round=1)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.7591102756137316, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.6590401118320512, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=6 head_norm_before_train=2.514581 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.2215887495248955, 'auprc': 0.2215887495248955, 'loss_val': 4.32308571681472, 'psi': 0.2215887495248955}-{'f1_val': 0.22209567198177674, 'auprc': 0.22209567198177674, 'loss_val': 4.206267385831835, 'psi': 0.22209567198177674}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=6 head_norm_before_train=2.593867 cos_to_last_merge=0.9853 (last merge round=2)
[S4] round=6 local utility u=0.009017 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.8418224615615661, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.8598558325433348, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=6 head_norm_before_train=2.933275 (no previous merge yet)
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.1425098852181466, 'psi': 0.3335071121394324}-{'f1_val': 0.3351853131249382, 'auprc': 0.3351853131249382, 'loss_val': 0.7978750576188638, 'psi': 0.3351853131249382}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=6 head_norm_before_train=2.324087 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 9.4099712847542, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 9.178477739967953, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=6 head_norm_before_train=2.759542 (no previous merge yet)
[S7] round=6 local utility u=0.881088 metrics={'f1_val': 0.6654110814434088, 'auprc': 0.6654110814434088, 'loss_val': 0.16779676810730476, 'psi': 0.6654110814434088}-{'f1_val': 0.4868875217479479, 'auprc': 0.4868875217479479, 'loss_val': 0.32326057697415855, 'psi': 0.4868875217479479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] sending update (kind=head size=1791 to 1 peers)
[S8] START round=6 head_norm_before_train=2.663330 (no previous merge yet)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.4834603654017, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.3722811611564487, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=6 head_norm_before_train=2.388420 cos_to_last_merge=0.9985 (last merge round=2)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.221623923116959, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.108199584489427, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=6 head_norm_before_train=2.732121 cos_to_last_merge=0.9977 (last merge round=2)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.2750821827744905, 'auprc': 0.2750821827744905, 'loss_val': 2.230304246927474, 'psi': 0.2750821827744905}-{'f1_val': 0.2750821827744905, 'auprc': 0.2750821827744905, 'loss_val': 2.1559877263491956, 'psi': 0.2750821827744905}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=6 head_norm_before_train=2.569423 (no previous merge yet)
[S11] round=6 local utility u=0.000000 metrics={'f1_val': 0.2977332777082464, 'auprc': 0.2977332777082464, 'loss_val': 3.579148711508646, 'psi': 0.2977332777082464}-{'f1_val': 0.2966195622055971, 'auprc': 0.2966195622055971, 'loss_val': 3.504019753874775, 'psi': 0.2966195622055971}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=6 head_norm_before_train=2.780204 cos_to_last_merge=0.9857 (last merge round=1)
[S13] round=6 local utility u=0.313718 metrics={'f1_val': 0.32864760058167714, 'auprc': 0.32864760058167714, 'loss_val': 2.3857796974297694, 'psi': 0.32864760058167714}-{'f1_val': 0.26878097125867195, 'auprc': 0.26878097125867195, 'loss_val': 2.4744169634530686, 'psi': 0.26878097125867195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=6 head_norm_before_train=2.394277 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 9.111915557835951, 'psi': 0.13577478824115594}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.887980334687267, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=6 head_norm_before_train=2.665526 (no previous merge yet)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6757652967725726, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6570240697992168, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=6 head_norm_before_train=2.390655 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.1583879377157754, 'auprc': 0.1583879377157754, 'loss_val': 5.403994267761238, 'psi': 0.1583879377157754}-{'f1_val': 0.15590484282073067, 'auprc': 0.15590484282073067, 'loss_val': 5.2512185698854665, 'psi': 0.15590484282073067}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=6 head_norm_before_train=2.684022 (no previous merge yet)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.5866415999948528, 'auprc': 0.5866415999948528, 'loss_val': 0.6369506603126595, 'psi': 0.5866415999948528}-{'f1_val': 0.5907351630074988, 'auprc': 0.5907351630074988, 'loss_val': 0.4863079356192047, 'psi': 0.5907351630074988}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=7 head_norm_before_train=2.337278 cos_to_last_merge=0.9922 (last merge round=1)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.848393543706334, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.7591102756137316, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=7 head_norm_before_train=2.564193 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.21723277681826905, 'auprc': 0.21723277681826905, 'loss_val': 4.434530018851839, 'psi': 0.21723277681826905}-{'f1_val': 0.2215887495248955, 'auprc': 0.2215887495248955, 'loss_val': 4.32308571681472, 'psi': 0.2215887495248955}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=7 head_norm_before_train=2.697274 cos_to_last_merge=0.9781 (last merge round=2)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.912560845419275, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.8418224615615661, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=7 head_norm_before_train=3.028695 (no previous merge yet)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.4619981100341788, 'psi': 0.33400978131092857}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.1425098852181466, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=7 head_norm_before_train=2.370214 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 9.60960491382834, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 9.4099712847542, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=7 head_norm_before_train=2.883964 (no previous merge yet)
[S7] round=7 local utility u=0.007705 metrics={'f1_val': 0.6655773316590636, 'auprc': 0.6655773316590636, 'loss_val': 0.15388258211533476, 'psi': 0.6655773316590636}-{'f1_val': 0.6654110814434088, 'auprc': 0.6654110814434088, 'loss_val': 0.16779676810730476, 'psi': 0.6654110814434088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=7 head_norm_before_train=2.728481 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.583287430618659, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.4834603654017, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=7 head_norm_before_train=2.436259 cos_to_last_merge=0.9978 (last merge round=2)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.3226461807615255, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.221623923116959, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=7 head_norm_before_train=2.794658 cos_to_last_merge=0.9967 (last merge round=2)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.2751364503189321, 'auprc': 0.2751364503189321, 'loss_val': 2.2958090569584084, 'psi': 0.2751364503189321}-{'f1_val': 0.2750821827744905, 'auprc': 0.2750821827744905, 'loss_val': 2.230304246927474, 'psi': 0.2750821827744905}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=7 head_norm_before_train=2.622562 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.2994824450972164, 'auprc': 0.2994824450972164, 'loss_val': 3.6482958693687526, 'psi': 0.2994824450972164}-{'f1_val': 0.2977332777082464, 'auprc': 0.2977332777082464, 'loss_val': 3.579148711508646, 'psi': 0.2977332777082464}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=7 head_norm_before_train=2.895402 cos_to_last_merge=0.9824 (last merge round=1)
[S13] round=7 local utility u=0.119371 metrics={'f1_val': 0.33251593918587546, 'auprc': 0.33251593918587546, 'loss_val': 2.1818523842066133, 'psi': 0.33251593918587546}-{'f1_val': 0.32864760058167714, 'auprc': 0.32864760058167714, 'loss_val': 2.3857796974297694, 'psi': 0.32864760058167714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=7 head_norm_before_train=2.440131 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 9.31543821262147, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 9.111915557835951, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=7 head_norm_before_train=2.727936 (no previous merge yet)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6922422229925757, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6757652967725726, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=7 head_norm_before_train=2.444544 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.16074058489375131, 'auprc': 0.16074058489375131, 'loss_val': 5.52695907115146, 'psi': 0.16074058489375131}-{'f1_val': 0.1583879377157754, 'auprc': 0.1583879377157754, 'loss_val': 5.403994267761238, 'psi': 0.1583879377157754}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=7 head_norm_before_train=2.752203 (no previous merge yet)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.5460257883654104, 'auprc': 0.5460257883654104, 'loss_val': 0.8015345714232203, 'psi': 0.5460257883654104}-{'f1_val': 0.5866415999948528, 'auprc': 0.5866415999948528, 'loss_val': 0.6369506603126595, 'psi': 0.5866415999948528}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=8 head_norm_before_train=2.377243 cos_to_last_merge=0.9907 (last merge round=1)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.9278518317056452, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.848393543706334, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=8 head_norm_before_train=2.609135 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.21497910639665704, 'auprc': 0.21497910639665704, 'loss_val': 4.531397539822699, 'psi': 0.21497910639665704}-{'f1_val': 0.21723277681826905, 'auprc': 0.21723277681826905, 'loss_val': 4.434530018851839, 'psi': 0.21723277681826905}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=8 head_norm_before_train=2.766752 cos_to_last_merge=0.9694 (last merge round=2)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.9882935285182377, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.912560845419275, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=8 head_norm_before_train=3.123332 (no previous merge yet)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.2452383627307793, 'auprc': 0.2452383627307793, 'loss_val': 1.0488240104265862, 'psi': 0.2452383627307793}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.4619981100341788, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=8 head_norm_before_train=2.411540 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 9.787563436025158, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 9.60960491382834, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=8 head_norm_before_train=2.906893 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.6656603947486558, 'auprc': 0.6656603947486558, 'loss_val': 0.1647389195925384, 'psi': 0.6656603947486558}-{'f1_val': 0.6655773316590636, 'auprc': 0.6655773316590636, 'loss_val': 0.15388258211533476, 'psi': 0.6655773316590636}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=8 head_norm_before_train=2.784177 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.6743875805622266, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.583287430618659, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=8 head_norm_before_train=2.479557 cos_to_last_merge=0.9971 (last merge round=2)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.417022882976429, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.3226461807615255, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=8 head_norm_before_train=2.849313 cos_to_last_merge=0.9957 (last merge round=2)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.27540810953133227, 'auprc': 0.27540810953133227, 'loss_val': 2.3550962018266772, 'psi': 0.27540810953133227}-{'f1_val': 0.2751364503189321, 'auprc': 0.2751364503189321, 'loss_val': 2.2958090569584084, 'psi': 0.2751364503189321}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=8 head_norm_before_train=2.670643 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.30163426317272474, 'auprc': 0.30163426317272474, 'loss_val': 3.7109591598655576, 'psi': 0.30163426317272474}-{'f1_val': 0.2994824450972164, 'auprc': 0.2994824450972164, 'loss_val': 3.6482958693687526, 'psi': 0.2994824450972164}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=8 head_norm_before_train=2.998600 cos_to_last_merge=0.9796 (last merge round=1)
[S13] round=8 local utility u=0.188300 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.8096614233907704, 'psi': 0.3330058939096267}-{'f1_val': 0.33251593918587546, 'auprc': 0.33251593918587546, 'loss_val': 2.1818523842066133, 'psi': 0.33251593918587546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=8 head_norm_before_train=2.481575 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 9.502145251820197, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 9.31543821262147, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=8 head_norm_before_train=2.782519 (no previous merge yet)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7064958605177413, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6922422229925757, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=8 head_norm_before_train=2.492059 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.1616967660646787, 'auprc': 0.1616967660646787, 'loss_val': 5.639209466337466, 'psi': 0.1616967660646787}-{'f1_val': 0.16074058489375131, 'auprc': 0.16074058489375131, 'loss_val': 5.52695907115146, 'psi': 0.16074058489375131}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=8 head_norm_before_train=2.804118 (no previous merge yet)
[S17] round=8 local utility u=0.186126 metrics={'f1_val': 0.5771917655638198, 'auprc': 0.5771917655638198, 'loss_val': 0.7097757329558743, 'psi': 0.5771917655638198}-{'f1_val': 0.5460257883654104, 'auprc': 0.5460257883654104, 'loss_val': 0.8015345714232203, 'psi': 0.5460257883654104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=9 head_norm_before_train=2.413214 cos_to_last_merge=0.9893 (last merge round=1)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.9993451296442064, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.9278518317056452, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=9 head_norm_before_train=2.650687 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.21428111518897688, 'auprc': 0.21428111518897688, 'loss_val': 4.617231658236122, 'psi': 0.21428111518897688}-{'f1_val': 0.21497910639665704, 'auprc': 0.21497910639665704, 'loss_val': 4.531397539822699, 'psi': 0.21497910639665704}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=9 head_norm_before_train=2.877810 cos_to_last_merge=0.9629 (last merge round=2)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.10651337327624, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.9882935285182377, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=9 head_norm_before_train=3.172652 (no previous merge yet)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.22570562278629197, 'auprc': 0.22570562278629197, 'loss_val': 1.6160225881199768, 'psi': 0.22570562278629197}-{'f1_val': 0.2452383627307793, 'auprc': 0.2452383627307793, 'loss_val': 1.0488240104265862, 'psi': 0.2452383627307793}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=9 head_norm_before_train=2.448448 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 9.95653012053394, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 9.787563436025158, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=9 head_norm_before_train=3.006560 (no previous merge yet)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.6655773316590636, 'auprc': 0.6655773316590636, 'loss_val': 0.1699630072267951, 'psi': 0.6655773316590636}-{'f1_val': 0.6656603947486558, 'auprc': 0.6656603947486558, 'loss_val': 0.1647389195925384, 'psi': 0.6656603947486558}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=9 head_norm_before_train=2.833439 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.7601287556358445, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.6743875805622266, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=9 head_norm_before_train=2.519540 cos_to_last_merge=0.9964 (last merge round=2)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.504462569409502, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.417022882976429, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=9 head_norm_before_train=2.898151 cos_to_last_merge=0.9948 (last merge round=2)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.2756258234519104, 'auprc': 0.2756258234519104, 'loss_val': 2.409553110362914, 'psi': 0.2756258234519104}-{'f1_val': 0.27540810953133227, 'auprc': 0.27540810953133227, 'loss_val': 2.3550962018266772, 'psi': 0.27540810953133227}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=9 head_norm_before_train=2.715213 (no previous merge yet)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.3027218098267939, 'auprc': 0.3027218098267939, 'loss_val': 3.7679467008274243, 'psi': 0.3027218098267939}-{'f1_val': 0.30163426317272474, 'auprc': 0.30163426317272474, 'loss_val': 3.7109591598655576, 'psi': 0.30163426317272474}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=9 head_norm_before_train=3.073017 cos_to_last_merge=0.9774 (last merge round=1)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.0471764295157393, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.8096614233907704, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=9 head_norm_before_train=2.519943 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 9.67852849418117, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 9.502145251820197, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=9 head_norm_before_train=2.830517 (no previous merge yet)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7165678346285845, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7064958605177413, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=9 head_norm_before_train=2.535163 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.16180278535936735, 'auprc': 0.16180278535936735, 'loss_val': 5.747540142876859, 'psi': 0.16180278535936735}-{'f1_val': 0.1616967660646787, 'auprc': 0.1616967660646787, 'loss_val': 5.639209466337466, 'psi': 0.1616967660646787}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=9 head_norm_before_train=2.863309 (no previous merge yet)
[S17] round=9 local utility u=0.559732 metrics={'f1_val': 0.751255440895975, 'auprc': 0.751255440895975, 'loss_val': 1.1568844470355715, 'psi': 0.751255440895975}-{'f1_val': 0.5771917655638198, 'auprc': 0.5771917655638198, 'loss_val': 0.7097757329558743, 'psi': 0.5771917655638198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=10 head_norm_before_train=2.446196 cos_to_last_merge=0.9879 (last merge round=1)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.065783681079747, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.9993451296442064, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=10 head_norm_before_train=2.689476 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.21375620447366725, 'auprc': 0.21375620447366725, 'loss_val': 4.697876365157618, 'psi': 0.21375620447366725}-{'f1_val': 0.21428111518897688, 'auprc': 0.21428111518897688, 'loss_val': 4.617231658236122, 'psi': 0.21428111518897688}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=10 head_norm_before_train=2.963407 cos_to_last_merge=0.9569 (last merge round=2)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.2901553625366207, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.10651337327624, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=10 head_norm_before_train=3.282077 (no previous merge yet)
[S5] round=10 local utility u=0.296228 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.9983033099757779, 'psi': 0.33400978131092857}-{'f1_val': 0.22570562278629197, 'auprc': 0.22570562278629197, 'loss_val': 1.6160225881199768, 'psi': 0.22570562278629197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=10 head_norm_before_train=2.482361 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.11332119871974, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 9.95653012053394, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=10 head_norm_before_train=3.077084 (no previous merge yet)
[S7] round=10 local utility u=0.018468 metrics={'f1_val': 0.6656603947486558, 'auprc': 0.6656603947486558, 'loss_val': 0.13377529492766174, 'psi': 0.6656603947486558}-{'f1_val': 0.6655773316590636, 'auprc': 0.6655773316590636, 'loss_val': 0.1699630072267951, 'psi': 0.6655773316590636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=10 head_norm_before_train=2.878048 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.8331726962755903, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.7601287556358445, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=10 head_norm_before_train=2.556853 cos_to_last_merge=0.9957 (last merge round=2)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.5881465703748985, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.504462569409502, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=10 head_norm_before_train=2.942515 cos_to_last_merge=0.9939 (last merge round=2)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.27600765221980345, 'auprc': 0.27600765221980345, 'loss_val': 2.4596738901796664, 'psi': 0.27600765221980345}-{'f1_val': 0.2756258234519104, 'auprc': 0.2756258234519104, 'loss_val': 2.409553110362914, 'psi': 0.2756258234519104}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=10 head_norm_before_train=2.756727 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.3034942235452548, 'auprc': 0.3034942235452548, 'loss_val': 3.8209715387454115, 'psi': 0.3034942235452548}-{'f1_val': 0.3027218098267939, 'auprc': 0.3027218098267939, 'loss_val': 3.7679467008274243, 'psi': 0.3027218098267939}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=10 head_norm_before_train=3.172860 cos_to_last_merge=0.9744 (last merge round=1)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.4640922945359187, 'psi': 0.3599362944611573}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.0471764295157393, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=10 head_norm_before_train=2.555628 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 9.845633971380805, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 9.67852849418117, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=10 head_norm_before_train=2.874404 (no previous merge yet)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7291585149226797, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7165678346285845, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=10 head_norm_before_train=2.574996 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.16222641773302568, 'auprc': 0.16222641773302568, 'loss_val': 5.8412460202286605, 'psi': 0.16222641773302568}-{'f1_val': 0.16180278535936735, 'auprc': 0.16180278535936735, 'loss_val': 5.747540142876859, 'psi': 0.16180278535936735}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=10 head_norm_before_train=2.887132 (no previous merge yet)
[S17] round=10 local utility u=0.425794 metrics={'f1_val': 0.8095337690631808, 'auprc': 0.8095337690631808, 'loss_val': 0.8298013201304127, 'psi': 0.8095337690631808}-{'f1_val': 0.751255440895975, 'auprc': 0.751255440895975, 'loss_val': 1.1568844470355715, 'psi': 0.751255440895975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=11 head_norm_before_train=2.476742 cos_to_last_merge=0.9866 (last merge round=1)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.126868833131147, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.065783681079747, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=11 head_norm_before_train=2.726081 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.21058098020123336, 'auprc': 0.21058098020123336, 'loss_val': 4.777981726441809, 'psi': 0.21058098020123336}-{'f1_val': 0.21375620447366725, 'auprc': 0.21375620447366725, 'loss_val': 4.697876365157618, 'psi': 0.21375620447366725}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=11 head_norm_before_train=3.054523 cos_to_last_merge=0.9497 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.950
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.355752286316414, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.2901553625366207, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=11 head_norm_before_train=3.357548 (no previous merge yet)
[S5] round=11 local utility u=0.007168 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.9839671549442388, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.9983033099757779, 'psi': 0.33400978131092857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=11 head_norm_before_train=2.513899 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.253143759414364, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.11332119871974, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=11 head_norm_before_train=3.139469 (no previous merge yet)
[S7] round=11 local utility u=0.017857 metrics={'f1_val': 0.6654110814434088, 'auprc': 0.6654110814434088, 'loss_val': 0.09581697065253876, 'psi': 0.6654110814434088}-{'f1_val': 0.6656603947486558, 'auprc': 0.6656603947486558, 'loss_val': 0.13377529492766174, 'psi': 0.6656603947486558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=11 head_norm_before_train=2.918050 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.9034766714034648, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.8331726962755903, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=11 head_norm_before_train=2.592268 cos_to_last_merge=0.9950 (last merge round=2)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.664729811350542, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.5881465703748985, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=11 head_norm_before_train=2.983389 cos_to_last_merge=0.9930 (last merge round=2)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.2762263154420017, 'auprc': 0.2762263154420017, 'loss_val': 2.506638824449802, 'psi': 0.2762263154420017}-{'f1_val': 0.27600765221980345, 'auprc': 0.27600765221980345, 'loss_val': 2.4596738901796664, 'psi': 0.27600765221980345}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=11 head_norm_before_train=2.796120 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.3045952482572201, 'auprc': 0.3045952482572201, 'loss_val': 3.874416396953642, 'psi': 0.3045952482572201}-{'f1_val': 0.3034942235452548, 'auprc': 0.3034942235452548, 'loss_val': 3.8209715387454115, 'psi': 0.3034942235452548}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=11 head_norm_before_train=3.160526 cos_to_last_merge=0.9751 (last merge round=1)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.24063886424134873, 'auprc': 0.24063886424134873, 'loss_val': 1.9570412370008226, 'psi': 0.24063886424134873}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.4640922945359187, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=11 head_norm_before_train=2.589409 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.004888752312642, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 9.845633971380805, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=11 head_norm_before_train=2.914606 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7384710871461573, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7291585149226797, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=11 head_norm_before_train=2.612429 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.16296606619187265, 'auprc': 0.16296606619187265, 'loss_val': 5.935716857380324, 'psi': 0.16296606619187265}-{'f1_val': 0.16222641773302568, 'auprc': 0.16222641773302568, 'loss_val': 5.8412460202286605, 'psi': 0.16222641773302568}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=11 head_norm_before_train=2.919222 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.8012327416326521, 'auprc': 0.8012327416326521, 'loss_val': 0.896675859078935, 'psi': 0.8012327416326521}-{'f1_val': 0.8095337690631808, 'auprc': 0.8095337690631808, 'loss_val': 0.8298013201304127, 'psi': 0.8095337690631808}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=12 head_norm_before_train=2.505256 cos_to_last_merge=0.9854 (last merge round=1)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.186647276685907, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.126868833131147, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=12 head_norm_before_train=2.760983 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.21182106557907684, 'auprc': 0.21182106557907684, 'loss_val': 4.844672749721549, 'psi': 0.21182106557907684}-{'f1_val': 0.21058098020123336, 'auprc': 0.21058098020123336, 'loss_val': 4.777981726441809, 'psi': 0.21058098020123336}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=12 head_norm_before_train=3.166956 cos_to_last_merge=0.9429 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.943
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.4373497641973803, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.355752286316414, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=12 head_norm_before_train=3.436808 (no previous merge yet)
[S5] round=12 local utility u=0.244966 metrics={'f1_val': 0.3351853131249382, 'auprc': 0.3351853131249382, 'loss_val': 1.5046155060626858, 'psi': 0.3351853131249382}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.9839671549442388, 'psi': 0.33400978131092857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=12 head_norm_before_train=2.543171 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.387644441847536, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.253143759414364, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=12 head_norm_before_train=3.083337 (no previous merge yet)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.6654110814434088, 'auprc': 0.6654110814434088, 'loss_val': 0.1749460526708556, 'psi': 0.6654110814434088}-{'f1_val': 0.6654110814434088, 'auprc': 0.6654110814434088, 'loss_val': 0.09581697065253876, 'psi': 0.6654110814434088}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=12 head_norm_before_train=2.955191 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.9693202631705358, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.9034766714034648, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=12 head_norm_before_train=2.625722 cos_to_last_merge=0.9942 (last merge round=2)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.739604175752101, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.664729811350542, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=12 head_norm_before_train=3.021395 cos_to_last_merge=0.9922 (last merge round=2)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.2765001321702353, 'auprc': 0.2765001321702353, 'loss_val': 2.550789496407178, 'psi': 0.2765001321702353}-{'f1_val': 0.2762263154420017, 'auprc': 0.2762263154420017, 'loss_val': 2.506638824449802, 'psi': 0.2762263154420017}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=12 head_norm_before_train=2.833494 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.30531194295900177, 'auprc': 0.30531194295900177, 'loss_val': 3.9217535527500864, 'psi': 0.30531194295900177}-{'f1_val': 0.3045952482572201, 'auprc': 0.3045952482572201, 'loss_val': 3.874416396953642, 'psi': 0.3045952482572201}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=12 head_norm_before_train=3.253817 cos_to_last_merge=0.9723 (last merge round=1)
[S13] round=12 local utility u=0.274485 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.4817477975297573, 'psi': 0.3599362944611573}-{'f1_val': 0.24063886424134873, 'auprc': 0.24063886424134873, 'loss_val': 1.9570412370008226, 'psi': 0.24063886424134873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=12 head_norm_before_train=2.621659 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.155980846222663, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.004888752312642, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=12 head_norm_before_train=2.951851 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7479183392838463, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7384710871461573, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=12 head_norm_before_train=2.647906 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.1630715532286213, 'auprc': 0.1630715532286213, 'loss_val': 6.024082067947961, 'psi': 0.1630715532286213}-{'f1_val': 0.16296606619187265, 'auprc': 0.16296606619187265, 'loss_val': 5.935716857380324, 'psi': 0.16296606619187265}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=12 head_norm_before_train=2.982129 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.4885299181660514, 'auprc': 0.4885299181660514, 'loss_val': 1.5037113105656614, 'psi': 0.4885299181660514}-{'f1_val': 0.8012327416326521, 'auprc': 0.8012327416326521, 'loss_val': 0.896675859078935, 'psi': 0.8012327416326521}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=13 head_norm_before_train=2.532287 cos_to_last_merge=0.9842 (last merge round=1)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.239484634541121, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.186647276685907, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=13 head_norm_before_train=2.794448 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.21058098020123336, 'auprc': 0.21058098020123336, 'loss_val': 4.913844210010331, 'psi': 0.21058098020123336}-{'f1_val': 0.21182106557907684, 'auprc': 0.21182106557907684, 'loss_val': 4.844672749721549, 'psi': 0.21182106557907684}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=13 head_norm_before_train=3.255711 cos_to_last_merge=0.9360 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.936
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.577430673665243, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.4373497641973803, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=13 head_norm_before_train=3.496736 (no previous merge yet)
[S5] round=13 local utility u=0.430056 metrics={'f1_val': 0.33568586802432815, 'auprc': 0.33568586802432815, 'loss_val': 0.6490075422784253, 'psi': 0.33568586802432815}-{'f1_val': 0.3351853131249382, 'auprc': 0.3351853131249382, 'loss_val': 1.5046155060626858, 'psi': 0.3351853131249382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=13 head_norm_before_train=2.570999 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.51372790488491, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.387644441847536, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=13 head_norm_before_train=3.171211 (no previous merge yet)
[S7] round=13 local utility u=0.042241 metrics={'f1_val': 0.6654110814434088, 'auprc': 0.6654110814434088, 'loss_val': 0.09046397623225548, 'psi': 0.6654110814434088}-{'f1_val': 0.6654110814434088, 'auprc': 0.6654110814434088, 'loss_val': 0.1749460526708556, 'psi': 0.6654110814434088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=13 head_norm_before_train=2.989961 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.0300347376983896, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.9693202631705358, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=13 head_norm_before_train=2.658085 cos_to_last_merge=0.9935 (last merge round=2)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.81094462983044, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.739604175752101, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=13 head_norm_before_train=3.056937 cos_to_last_merge=0.9914 (last merge round=2)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.27666468293328045, 'auprc': 0.27666468293328045, 'loss_val': 2.5924682660703415, 'psi': 0.27666468293328045}-{'f1_val': 0.2765001321702353, 'auprc': 0.2765001321702353, 'loss_val': 2.550789496407178, 'psi': 0.2765001321702353}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=13 head_norm_before_train=2.869359 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.3064920191825925, 'auprc': 0.3064920191825925, 'loss_val': 3.968980678332852, 'psi': 0.3064920191825925}-{'f1_val': 0.30531194295900177, 'auprc': 0.30531194295900177, 'loss_val': 3.9217535527500864, 'psi': 0.30531194295900177}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=13 head_norm_before_train=3.279649 cos_to_last_merge=0.9719 (last merge round=1)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.2415820416889364, 'auprc': 0.2415820416889364, 'loss_val': 1.9598658486976652, 'psi': 0.24158204168893638}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.4817477975297573, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=13 head_norm_before_train=2.652688 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.30263909444143, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.155980846222663, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=13 head_norm_before_train=2.986694 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6163920092621171, 'auprc': 0.6163920092621171, 'loss_val': 0.756387612221013, 'psi': 0.6163920092621171}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7479183392838463, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=13 head_norm_before_train=2.681892 (no previous merge yet)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.16380872717133696, 'auprc': 0.16380872717133696, 'loss_val': 6.108844490860228, 'psi': 0.16380872717133696}-{'f1_val': 0.1630715532286213, 'auprc': 0.1630715532286213, 'loss_val': 6.024082067947961, 'psi': 0.1630715532286213}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=13 head_norm_before_train=3.006815 (no previous merge yet)
[S17] round=13 local utility u=1.000000 metrics={'f1_val': 0.7865232504143359, 'auprc': 0.7865232504143359, 'loss_val': 0.8512086163374789, 'psi': 0.7865232504143359}-{'f1_val': 0.4885299181660514, 'auprc': 0.4885299181660514, 'loss_val': 1.5037113105656614, 'psi': 0.4885299181660514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=14 head_norm_before_train=2.557681 cos_to_last_merge=0.9831 (last merge round=1)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.290573391240508, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.239484634541121, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=14 head_norm_before_train=2.826777 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.20951265534517535, 'auprc': 0.20951265534517535, 'loss_val': 4.979682845617416, 'psi': 0.20951265534517535}-{'f1_val': 0.21058098020123336, 'auprc': 0.21058098020123336, 'loss_val': 4.913844210010331, 'psi': 0.21058098020123336}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=14 head_norm_before_train=3.284736 cos_to_last_merge=0.9342 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.934
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.6986428386353163, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.577430673665243, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=14 head_norm_before_train=3.521512 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.25095518892935254, 'auprc': 0.25095518892935254, 'loss_val': 1.2080723241186584, 'psi': 0.25095518892935254}-{'f1_val': 0.33568586802432815, 'auprc': 0.33568586802432815, 'loss_val': 0.6490075422784253, 'psi': 0.33568586802432815}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=14 head_norm_before_train=2.597494 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.633320393629814, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.51372790488491, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=14 head_norm_before_train=3.319958 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.6655773316590636, 'auprc': 0.6655773316590636, 'loss_val': 0.09574230290894557, 'psi': 0.6655773316590636}-{'f1_val': 0.6654110814434088, 'auprc': 0.6654110814434088, 'loss_val': 0.09046397623225548, 'psi': 0.6654110814434088}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=14 head_norm_before_train=3.022331 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.0893665303142703, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.0300347376983896, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=14 head_norm_before_train=2.689307 cos_to_last_merge=0.9928 (last merge round=2)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.878939139384056, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.81094462983044, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=14 head_norm_before_train=3.090433 cos_to_last_merge=0.9906 (last merge round=2)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.2768843888558004, 'auprc': 0.2768843888558004, 'loss_val': 2.632150237641113, 'psi': 0.2768843888558004}-{'f1_val': 0.27666468293328045, 'auprc': 0.27666468293328045, 'loss_val': 2.5924682660703415, 'psi': 0.27666468293328045}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=14 head_norm_before_train=2.904095 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.3070194307019431, 'auprc': 0.3070194307019431, 'loss_val': 4.013463833021644, 'psi': 0.3070194307019431}-{'f1_val': 0.3064920191825925, 'auprc': 0.3064920191825925, 'loss_val': 3.968980678332852, 'psi': 0.3064920191825925}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=14 head_norm_before_train=3.369907 cos_to_last_merge=0.9694 (last merge round=1)
[S13] round=14 local utility u=0.480867 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.063319324136067, 'psi': 0.3599362944611573}-{'f1_val': 0.2415820416889364, 'auprc': 0.2415820416889364, 'loss_val': 1.9598658486976652, 'psi': 0.24158204168893638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=14 head_norm_before_train=2.682730 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.444978079772056, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.30263909444143, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=14 head_norm_before_train=3.019442 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6163920092621171, 'auprc': 0.6163920092621171, 'loss_val': 0.7636667879195056, 'psi': 0.6163920092621171}-{'f1_val': 0.6163920092621171, 'auprc': 0.6163920092621171, 'loss_val': 0.756387612221013, 'psi': 0.6163920092621171}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=14 head_norm_before_train=2.714629 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.16475335698879845, 'auprc': 0.16475335698879845, 'loss_val': 6.19141954271197, 'psi': 0.16475335698879845}-{'f1_val': 0.16380872717133696, 'auprc': 0.16380872717133696, 'loss_val': 6.108844490860228, 'psi': 0.16380872717133696}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=14 head_norm_before_train=3.055454 (no previous merge yet)
[S17] round=14 local utility u=0.653684 metrics={'f1_val': 0.8930115631651317, 'auprc': 0.8930115631651317, 'loss_val': 0.5022359372299611, 'psi': 0.8930115631651319}-{'f1_val': 0.7865232504143359, 'auprc': 0.7865232504143359, 'loss_val': 0.8512086163374789, 'psi': 0.7865232504143359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=15 head_norm_before_train=2.581999 cos_to_last_merge=0.9820 (last merge round=1)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.339420157779274, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.290573391240508, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=15 head_norm_before_train=2.858218 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.21120186697782964, 'auprc': 0.21120186697782964, 'loss_val': 5.037447187398736, 'psi': 0.21120186697782967}-{'f1_val': 0.20951265534517535, 'auprc': 0.20951265534517535, 'loss_val': 4.979682845617416, 'psi': 0.20951265534517535}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=15 head_norm_before_train=3.358143 cos_to_last_merge=0.9263 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.926
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.8991483083547287, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.6986428386353163, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=15 head_norm_before_train=3.619504 (no previous merge yet)
[S5] round=15 local utility u=0.117144 metrics={'f1_val': 0.33442959559018326, 'auprc': 0.33442959559018326, 'loss_val': 1.7250547141490498, 'psi': 0.33442959559018326}-{'f1_val': 0.25095518892935254, 'auprc': 0.25095518892935254, 'loss_val': 1.2080723241186584, 'psi': 0.25095518892935254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=15 head_norm_before_train=2.622532 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.74979357568124, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.633320393629814, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=15 head_norm_before_train=3.438054 (no previous merge yet)
[S7] round=15 local utility u=0.009829 metrics={'f1_val': 0.6655773316590636, 'auprc': 0.6655773316590636, 'loss_val': 0.07608518071886575, 'psi': 0.6655773316590636}-{'f1_val': 0.6655773316590636, 'auprc': 0.6655773316590636, 'loss_val': 0.09574230290894557, 'psi': 0.6655773316590636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=15 head_norm_before_train=3.053237 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.14609054257331, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.0893665303142703, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=15 head_norm_before_train=2.719516 cos_to_last_merge=0.9922 (last merge round=2)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.946591855819367, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.878939139384056, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=15 head_norm_before_train=3.122252 cos_to_last_merge=0.9899 (last merge round=2)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.2769393698702674, 'auprc': 0.2769393698702674, 'loss_val': 2.670198890301904, 'psi': 0.2769393698702674}-{'f1_val': 0.2768843888558004, 'auprc': 0.2768843888558004, 'loss_val': 2.632150237641113, 'psi': 0.2768843888558004}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=15 head_norm_before_train=2.937831 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.30781396017540075, 'auprc': 0.30781396017540075, 'loss_val': 4.056813758448217, 'psi': 0.30781396017540075}-{'f1_val': 0.3070194307019431, 'auprc': 0.3070194307019431, 'loss_val': 4.013463833021644, 'psi': 0.3070194307019431}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=15 head_norm_before_train=3.360181 cos_to_last_merge=0.9698 (last merge round=1)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.2511111111111111, 'auprc': 0.2511111111111111, 'loss_val': 1.3846584029601603, 'psi': 0.2511111111111111}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.063319324136067, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=15 head_norm_before_train=2.711881 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.583016957505885, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.444978079772056, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=15 head_norm_before_train=3.050679 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6163920092621171, 'auprc': 0.6163920092621171, 'loss_val': 0.7722838357197721, 'psi': 0.6163920092621171}-{'f1_val': 0.6163920092621171, 'auprc': 0.6163920092621171, 'loss_val': 0.7636667879195056, 'psi': 0.6163920092621171}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=15 head_norm_before_train=2.746301 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.1653811409908971, 'auprc': 0.1653811409908971, 'loss_val': 6.271308805436259, 'psi': 0.1653811409908971}-{'f1_val': 0.16475335698879845, 'auprc': 0.16475335698879845, 'loss_val': 6.19141954271197, 'psi': 0.16475335698879845}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=15 head_norm_before_train=3.111088 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.86582686279238, 'auprc': 0.86582686279238, 'loss_val': 0.6533054429799728, 'psi': 0.86582686279238}-{'f1_val': 0.8930115631651317, 'auprc': 0.8930115631651317, 'loss_val': 0.5022359372299611, 'psi': 0.8930115631651319}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=16 head_norm_before_train=2.605257 cos_to_last_merge=0.9810 (last merge round=1)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.385411057839597, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.339420157779274, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=16 head_norm_before_train=2.888756 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.21190938511326862, 'auprc': 0.21190938511326862, 'loss_val': 5.095542716850869, 'psi': 0.21190938511326862}-{'f1_val': 0.21120186697782964, 'auprc': 0.21120186697782964, 'loss_val': 5.037447187398736, 'psi': 0.21120186697782967}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=16 head_norm_before_train=3.410888 cos_to_last_merge=0.9213 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.921
[S4] round=16 local utility u=0.000883 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.897382662556778, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.8991483083547287, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] sending update (kind=head size=1790 to 1 peers)
[S5] START round=16 head_norm_before_train=3.679331 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.110907851686485, 'psi': 0.33400978131092857}-{'f1_val': 0.33442959559018326, 'auprc': 0.33442959559018326, 'loss_val': 1.7250547141490498, 'psi': 0.33442959559018326}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=16 head_norm_before_train=2.646389 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.863047216757687, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.74979357568124, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=16 head_norm_before_train=3.559484 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.05394961531469321, 'psi': 0.49924507948268093}-{'f1_val': 0.6655773316590636, 'auprc': 0.6655773316590636, 'loss_val': 0.07608518071886575, 'psi': 0.6655773316590636}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=16 head_norm_before_train=3.082629 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.198171919828502, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.14609054257331, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=16 head_norm_before_train=2.749175 cos_to_last_merge=0.9915 (last merge round=2)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.0121997145825485, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.946591855819367, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=16 head_norm_before_train=3.152672 cos_to_last_merge=0.9892 (last merge round=2)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.2771595124536301, 'auprc': 0.2771595124536301, 'loss_val': 2.7066673742224374, 'psi': 0.2771595124536301}-{'f1_val': 0.2769393698702674, 'auprc': 0.2769393698702674, 'loss_val': 2.670198890301904, 'psi': 0.2769393698702674}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=16 head_norm_before_train=2.970760 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.3086126126126126, 'auprc': 0.3086126126126126, 'loss_val': 4.098836457645703, 'psi': 0.3086126126126126}-{'f1_val': 0.30781396017540075, 'auprc': 0.30781396017540075, 'loss_val': 4.056813758448217, 'psi': 0.30781396017540075}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=16 head_norm_before_train=3.441190 cos_to_last_merge=0.9674 (last merge round=1)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.2528435577102368, 'auprc': 0.2528435577102368, 'loss_val': 1.4828762695490367, 'psi': 0.2528435577102368}-{'f1_val': 0.2511111111111111, 'auprc': 0.2511111111111111, 'loss_val': 1.3846584029601603, 'psi': 0.2511111111111111}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=16 head_norm_before_train=2.740343 (no previous merge yet)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.718001283370423, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.583016957505885, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=16 head_norm_before_train=3.080443 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6163105695516834, 'auprc': 0.6163105695516834, 'loss_val': 0.778503353340125, 'psi': 0.6163105695516834}-{'f1_val': 0.6163920092621171, 'auprc': 0.6163920092621171, 'loss_val': 0.7722838357197721, 'psi': 0.6163920092621171}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=16 head_norm_before_train=2.777217 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.16652800887409872, 'auprc': 0.16652800887409872, 'loss_val': 6.344072838442751, 'psi': 0.16652800887409872}-{'f1_val': 0.1653811409908971, 'auprc': 0.1653811409908971, 'loss_val': 6.271308805436259, 'psi': 0.1653811409908971}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=16 head_norm_before_train=3.163023 (no previous merge yet)
[S17] round=16 local utility u=0.346618 metrics={'f1_val': 0.9073883443580706, 'auprc': 0.9073883443580706, 'loss_val': 0.33412201727814295, 'psi': 0.9073883443580706}-{'f1_val': 0.86582686279238, 'auprc': 0.86582686279238, 'loss_val': 0.6533054429799728, 'psi': 0.86582686279238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=17 head_norm_before_train=2.627565 cos_to_last_merge=0.9800 (last merge round=1)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.431087888720854, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.385411057839597, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=17 head_norm_before_train=2.918758 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.21182106557907684, 'auprc': 0.21182106557907684, 'loss_val': 5.153391554538536, 'psi': 0.21182106557907684}-{'f1_val': 0.21190938511326862, 'auprc': 0.21190938511326862, 'loss_val': 5.095542716850869, 'psi': 0.21190938511326862}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=17 head_norm_before_train=3.502495 cos_to_last_merge=0.9193 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.919
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.911568246276281, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.897382662556778, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=17 head_norm_before_train=3.742360 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.3206373249161856, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.110907851686485, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=17 head_norm_before_train=2.669400 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.970390859093552, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.863047216757687, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=17 head_norm_before_train=3.634637 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.49930737685375043, 'auprc': 0.49930737685375043, 'loss_val': 0.060751786831688935, 'psi': 0.4993073768537504}-{'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.05394961531469321, 'psi': 0.49924507948268093}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=17 head_norm_before_train=3.110655 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.24855633973746, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.198171919828502, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=17 head_norm_before_train=2.778171 cos_to_last_merge=0.9908 (last merge round=2)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.075648911427145, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.0121997145825485, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=17 head_norm_before_train=3.181860 cos_to_last_merge=0.9885 (last merge round=2)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.27721460279599813, 'auprc': 0.27721460279599813, 'loss_val': 2.741887220790803, 'psi': 0.27721460279599813}-{'f1_val': 0.2771595124536301, 'auprc': 0.2771595124536301, 'loss_val': 2.7066673742224374, 'psi': 0.2771595124536301}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=17 head_norm_before_train=3.002886 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.309147353981662, 'auprc': 0.309147353981662, 'loss_val': 4.141307613198778, 'psi': 0.309147353981662}-{'f1_val': 0.3086126126126126, 'auprc': 0.3086126126126126, 'loss_val': 4.098836457645703, 'psi': 0.3086126126126126}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=17 head_norm_before_train=3.511147 cos_to_last_merge=0.9658 (last merge round=1)
[S13] round=17 local utility u=0.106781 metrics={'f1_val': 0.25779467680608364, 'auprc': 0.25779467680608364, 'loss_val': 1.3138748866643997, 'psi': 0.25779467680608364}-{'f1_val': 0.2528435577102368, 'auprc': 0.2528435577102368, 'loss_val': 1.4828762695490367, 'psi': 0.2528435577102368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=17 head_norm_before_train=2.768210 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.851281581949292, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.718001283370423, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=17 head_norm_before_train=3.109039 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6163105695516834, 'auprc': 0.6163105695516834, 'loss_val': 0.7841913206165639, 'psi': 0.6163105695516834}-{'f1_val': 0.6163105695516834, 'auprc': 0.6163105695516834, 'loss_val': 0.778503353340125, 'psi': 0.6163105695516834}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=17 head_norm_before_train=2.807416 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.16725510557286258, 'auprc': 0.16725510557286258, 'loss_val': 6.426195356695264, 'psi': 0.16725510557286258}-{'f1_val': 0.16652800887409872, 'auprc': 0.16652800887409872, 'loss_val': 6.344072838442751, 'psi': 0.16652800887409872}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=17 head_norm_before_train=3.217291 (no previous merge yet)
[S17] round=17 local utility u=0.472615 metrics={'f1_val': 0.9814328349997936, 'auprc': 0.9814328349997936, 'loss_val': 0.05529242257141349, 'psi': 0.9814328349997936}-{'f1_val': 0.9073883443580706, 'auprc': 0.9073883443580706, 'loss_val': 0.33412201727814295, 'psi': 0.9073883443580706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=18 head_norm_before_train=2.649250 cos_to_last_merge=0.9790 (last merge round=1)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.475682972038113, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.431087888720854, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=18 head_norm_before_train=2.948110 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.21305442572147978, 'auprc': 0.21305442572147978, 'loss_val': 5.207508544610377, 'psi': 0.21305442572147976}-{'f1_val': 0.21182106557907684, 'auprc': 0.21182106557907684, 'loss_val': 5.153391554538536, 'psi': 0.21182106557907684}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=18 head_norm_before_train=3.562073 cos_to_last_merge=0.9168 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.079427601770728, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.911568246276281, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=18 head_norm_before_train=3.790403 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.442519034311901, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.3206373249161856, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=18 head_norm_before_train=2.691566 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.074158147188513, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 10.970390859093552, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=18 head_norm_before_train=3.760824 (no previous merge yet)
[S7] round=18 local utility u=0.000707 metrics={'f1_val': 0.4994318786609748, 'auprc': 0.4994318786609748, 'loss_val': 0.06045818681245689, 'psi': 0.4994318786609748}-{'f1_val': 0.49930737685375043, 'auprc': 0.49930737685375043, 'loss_val': 0.060751786831688935, 'psi': 0.4993073768537504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=18 head_norm_before_train=3.137667 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.297686029443612, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.24855633973746, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=18 head_norm_before_train=2.806638 cos_to_last_merge=0.9901 (last merge round=2)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.137763682346536, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.075648911427145, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=18 head_norm_before_train=3.209919 cos_to_last_merge=0.9878 (last merge round=2)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 2.775554289987451, 'psi': 0.2773248492079274}-{'f1_val': 0.27721460279599813, 'auprc': 0.27721460279599813, 'loss_val': 2.741887220790803, 'psi': 0.27721460279599813}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=18 head_norm_before_train=3.034542 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.3096167751265365, 'auprc': 0.3096167751265365, 'loss_val': 4.181476687779099, 'psi': 0.3096167751265365}-{'f1_val': 0.309147353981662, 'auprc': 0.309147353981662, 'loss_val': 4.141307613198778, 'psi': 0.309147353981662}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=18 head_norm_before_train=3.566969 cos_to_last_merge=0.9646 (last merge round=1)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.24059616749467708, 'auprc': 0.24059616749467708, 'loss_val': 1.7981145824955689, 'psi': 0.24059616749467708}-{'f1_val': 0.25779467680608364, 'auprc': 0.25779467680608364, 'loss_val': 1.3138748866643997, 'psi': 0.25779467680608364}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=18 head_norm_before_train=2.795523 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.982053992963142, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.851281581949292, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=18 head_norm_before_train=3.136429 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6162291696748081, 'auprc': 0.6162291696748081, 'loss_val': 0.7899599152237032, 'psi': 0.6162291696748081}-{'f1_val': 0.6163105695516834, 'auprc': 0.6163105695516834, 'loss_val': 0.7841913206165639, 'psi': 0.6163105695516834}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=18 head_norm_before_train=2.837106 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.16798009124844462, 'auprc': 0.16798009124844462, 'loss_val': 6.503602231226227, 'psi': 0.16798009124844462}-{'f1_val': 0.16725510557286258, 'auprc': 0.16725510557286258, 'loss_val': 6.426195356695264, 'psi': 0.16725510557286258}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=18 head_norm_before_train=3.268125 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.9002023057715174, 'auprc': 0.9002023057715174, 'loss_val': 0.4395087948429136, 'psi': 0.9002023057715174}-{'f1_val': 0.9814328349997936, 'auprc': 0.9814328349997936, 'loss_val': 0.05529242257141349, 'psi': 0.9814328349997936}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=19 head_norm_before_train=2.670284 cos_to_last_merge=0.9780 (last merge round=1)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.518150491185829, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.475682972038113, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.367 u=0.0000 p_local=0.0175 f1=0.367 auprc=0.367 bytes=3602
[S3] START round=19 head_norm_before_train=2.977047 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.21463038023547576, 'auprc': 0.21463038023547576, 'loss_val': 5.259591430346402, 'psi': 0.21463038023547576}-{'f1_val': 0.21305442572147978, 'auprc': 0.21305442572147978, 'loss_val': 5.207508544610377, 'psi': 0.21305442572147976}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=20 psi=0.215 u=0.0000 p_local=0.0144 f1=0.215 auprc=0.215 bytes=0
[S4] START round=19 head_norm_before_train=3.627294 cos_to_last_merge=0.9153 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.915
[S4] round=19 local utility u=0.051152 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.9771245573729974, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.079427601770728, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S4] r=20 psi=0.357 u=0.0512 p_local=0.0250 f1=0.357 auprc=0.357 bytes=8980
[S5] START round=19 head_norm_before_train=3.831849 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.567484957884099, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.442519034311901, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=20 psi=0.334 u=0.0000 p_local=0.0709 f1=0.334 auprc=0.334 bytes=17999
[S6] START round=19 head_norm_before_train=2.713063 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.174161854156056, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.074158147188513, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.018 u=0.0000 p_local=0.0144 f1=0.018 auprc=0.018 bytes=0
[S7] START round=19 head_norm_before_train=3.898746 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.49930737685375043, 'auprc': 0.49930737685375043, 'loss_val': 0.08175160533791842, 'psi': 0.4993073768537504}-{'f1_val': 0.4994318786609748, 'auprc': 0.4994318786609748, 'loss_val': 0.06045818681245689, 'psi': 0.4994318786609748}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=20 psi=0.499 u=0.0000 p_local=0.0383 f1=0.499 auprc=0.499 bytes=19786
[S8] START round=19 head_norm_before_train=3.163668 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.3465925122316387, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.297686029443612, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=20 psi=0.359 u=0.0000 p_local=0.0144 f1=0.359 auprc=0.359 bytes=0
[S9] START round=19 head_norm_before_train=2.834621 cos_to_last_merge=0.9894 (last merge round=2)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.19956989096927, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.137763682346536, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0144 f1=0.369 auprc=0.369 bytes=0
[S10] START round=19 head_norm_before_train=3.236993 cos_to_last_merge=0.9871 (last merge round=2)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 2.808290748308495, 'psi': 0.2773248492079274}-{'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 2.775554289987451, 'psi': 0.2773248492079274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=20 psi=0.277 u=0.0000 p_local=0.0144 f1=0.277 auprc=0.277 bytes=0
[S11] START round=19 head_norm_before_train=3.065634 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.30995294969236337, 'auprc': 0.30995294969236337, 'loss_val': 4.220147357517821, 'psi': 0.30995294969236337}-{'f1_val': 0.3096167751265365, 'auprc': 0.3096167751265365, 'loss_val': 4.181476687779099, 'psi': 0.3096167751265365}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=20 psi=0.310 u=0.0000 p_local=0.0144 f1=0.310 auprc=0.310 bytes=0
[S13] START round=19 head_norm_before_train=3.590960 cos_to_last_merge=0.9645 (last merge round=1)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.2435344827586207, 'auprc': 0.2435344827586207, 'loss_val': 1.8305949773215577, 'psi': 0.2435344827586207}-{'f1_val': 0.24059616749467708, 'auprc': 0.24059616749467708, 'loss_val': 1.7981145824955689, 'psi': 0.24059616749467708}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.244 u=0.0000 p_local=0.0794 f1=0.244 auprc=0.244 bytes=10806
[S14] START round=19 head_norm_before_train=2.822359 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.11047451773623, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 10.982053992963142, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=20 psi=0.136 u=0.0000 p_local=0.0144 f1=0.136 auprc=0.136 bytes=0
[S15] START round=19 head_norm_before_train=3.163098 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6162291696748081, 'auprc': 0.6162291696748081, 'loss_val': 0.7968752450474642, 'psi': 0.6162291696748081}-{'f1_val': 0.6162291696748081, 'auprc': 0.6162291696748081, 'loss_val': 0.7899599152237032, 'psi': 0.6162291696748081}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=20 psi=0.616 u=0.0000 p_local=0.0146 f1=0.616 auprc=0.616 bytes=3599
[S16] START round=19 head_norm_before_train=2.866236 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.1681868435599779, 'auprc': 0.1681868435599779, 'loss_val': 6.585719645046984, 'psi': 0.1681868435599779}-{'f1_val': 0.16798009124844462, 'auprc': 0.16798009124844462, 'loss_val': 6.503602231226227, 'psi': 0.16798009124844462}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=20 psi=0.168 u=0.0000 p_local=0.0192 f1=0.168 auprc=0.168 bytes=0
[S17] START round=19 head_norm_before_train=3.320350 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.6501329479016108, 'auprc': 0.6501329479016108, 'loss_val': 0.10241832286986585, 'psi': 0.6501329479016108}-{'f1_val': 0.9002023057715174, 'auprc': 0.9002023057715174, 'loss_val': 0.4395087948429136, 'psi': 0.9002023057715174}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=20 psi=0.650 u=0.0000 p_local=0.2432 f1=0.650 auprc=0.650 bytes=19768
[S2] START round=20 head_norm_before_train=2.690640 cos_to_last_merge=0.9771 (last merge round=1)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.559383434561602, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.518150491185829, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=3.005603 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.21384377416860015, 'auprc': 0.21384377416860015, 'loss_val': 5.31519846526285, 'psi': 0.21384377416860015}-{'f1_val': 0.21463038023547576, 'auprc': 0.21463038023547576, 'loss_val': 5.259591430346402, 'psi': 0.21463038023547576}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=20 head_norm_before_train=3.681522 cos_to_last_merge=0.9128 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.913
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.214517590338299, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.9771245573729974, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=20 head_norm_before_train=3.869374 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.675314263505324, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.567484957884099, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=20 head_norm_before_train=2.734100 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.274625016432628, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.174161854156056, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=4.007235 (no previous merge yet)
[S7] round=20 local utility u=0.737411 metrics={'f1_val': 0.6657434165338773, 'auprc': 0.6657434165338773, 'loss_val': 0.10485359733869062, 'psi': 0.6657434165338773}-{'f1_val': 0.49930737685375043, 'auprc': 0.49930737685375043, 'loss_val': 0.08175160533791842, 'psi': 0.4993073768537504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=20 head_norm_before_train=3.189073 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.3944028141216616, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.3465925122316387, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=20 head_norm_before_train=2.862297 cos_to_last_merge=0.9887 (last merge round=2)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.260324039762848, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.19956989096927, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=20 head_norm_before_train=3.263287 cos_to_last_merge=0.9865 (last merge round=2)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 2.8398453491103344, 'psi': 0.2773248492079274}-{'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 2.808290748308495, 'psi': 0.2773248492079274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=20 head_norm_before_train=3.096281 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.31028985507246376, 'auprc': 0.31028985507246376, 'loss_val': 4.259807247791968, 'psi': 0.31028985507246376}-{'f1_val': 0.30995294969236337, 'auprc': 0.30995294969236337, 'loss_val': 4.220147357517821, 'psi': 0.30995294969236337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=20 head_norm_before_train=3.644501 cos_to_last_merge=0.9630 (last merge round=1)
[S13] round=20 local utility u=1.000000 metrics={'f1_val': 0.384765316937961, 'auprc': 0.384765316937961, 'loss_val': 0.7286696235607957, 'psi': 0.384765316937961}-{'f1_val': 0.2435344827586207, 'auprc': 0.2435344827586207, 'loss_val': 1.8305949773215577, 'psi': 0.2435344827586207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=20 head_norm_before_train=2.848898 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.237418669577716, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.11047451773623, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=20 head_norm_before_train=3.188806 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6162291696748081, 'auprc': 0.6162291696748081, 'loss_val': 0.8018249444141016, 'psi': 0.6162291696748081}-{'f1_val': 0.6162291696748081, 'auprc': 0.6162291696748081, 'loss_val': 0.7968752450474642, 'psi': 0.6162291696748081}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=2.895057 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.16952656605333885, 'auprc': 0.16952656605333885, 'loss_val': 6.646018294752071, 'psi': 0.16952656605333885}-{'f1_val': 0.1681868435599779, 'auprc': 0.1681868435599779, 'loss_val': 6.585719645046984, 'psi': 0.1681868435599779}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=3.382703 (no previous merge yet)
[S17] round=20 local utility u=1.000000 metrics={'f1_val': 0.9713772500272041, 'auprc': 0.9713772500272041, 'loss_val': 0.15363160155389308, 'psi': 0.9713772500272041}-{'f1_val': 0.6501329479016108, 'auprc': 0.6501329479016108, 'loss_val': 0.10241832286986585, 'psi': 0.6501329479016108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=21 head_norm_before_train=2.710451 cos_to_last_merge=0.9761 (last merge round=1)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.59945743277014, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.559383434561602, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=21 head_norm_before_train=3.033822 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.21697388632872505, 'auprc': 0.21697388632872505, 'loss_val': 5.36245723230251, 'psi': 0.21697388632872505}-{'f1_val': 0.21384377416860015, 'auprc': 0.21384377416860015, 'loss_val': 5.31519846526285, 'psi': 0.21384377416860015}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=21 head_norm_before_train=3.706882 cos_to_last_merge=0.9077 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.908
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.239386726165206, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.214517590338299, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=21 head_norm_before_train=3.904466 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.7583358820127146, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.675314263505324, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=2.754498 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.368955246014494, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.274625016432628, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=4.118149 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.05355807929182228, 'psi': 0.49924507948268093}-{'f1_val': 0.6657434165338773, 'auprc': 0.6657434165338773, 'loss_val': 0.10485359733869062, 'psi': 0.6657434165338773}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=21 head_norm_before_train=3.213701 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.440116977884679, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.3944028141216616, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=21 head_norm_before_train=2.889669 cos_to_last_merge=0.9880 (last merge round=2)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.319713458431321, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.260324039762848, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=3.288721 cos_to_last_merge=0.9858 (last merge round=2)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.2774351833432796, 'auprc': 0.2774351833432796, 'loss_val': 2.870487551938137, 'psi': 0.2774351833432796}-{'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 2.8398453491103344, 'psi': 0.2773248492079274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=21 head_norm_before_train=3.126681 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.31062749365252085, 'auprc': 0.31062749365252085, 'loss_val': 4.298159512632568, 'psi': 0.31062749365252085}-{'f1_val': 0.31028985507246376, 'auprc': 0.31028985507246376, 'loss_val': 4.259807247791968, 'psi': 0.31028985507246376}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=21 head_norm_before_train=3.620851 cos_to_last_merge=0.9635 (last merge round=1)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.228550462459183, 'psi': 0.3599362944611573}-{'f1_val': 0.384765316937961, 'auprc': 0.384765316937961, 'loss_val': 0.7286696235607957, 'psi': 0.384765316937961}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=2.875138 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.363215540795036, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.237418669577716, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=21 head_norm_before_train=3.213840 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6162291696748081, 'auprc': 0.6162291696748081, 'loss_val': 0.8076523580197074, 'psi': 0.6162291696748081}-{'f1_val': 0.6162291696748081, 'auprc': 0.6162291696748081, 'loss_val': 0.8018249444141016, 'psi': 0.6162291696748081}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=2.923426 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.16973203829992423, 'auprc': 0.16973203829992423, 'loss_val': 6.725818943430557, 'psi': 0.16973203829992423}-{'f1_val': 0.16952656605333885, 'auprc': 0.16952656605333885, 'loss_val': 6.646018294752071, 'psi': 0.16952656605333885}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=3.442156 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.9716562634395967, 'auprc': 0.9716562634395967, 'loss_val': 0.15749802796415868, 'psi': 0.9716562634395967}-{'f1_val': 0.9713772500272041, 'auprc': 0.9713772500272041, 'loss_val': 0.15363160155389308, 'psi': 0.9713772500272041}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=22 head_norm_before_train=2.729799 cos_to_last_merge=0.9752 (last merge round=1)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.638941217813284, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.59945743277014, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=3.061711 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.2177496645581752, 'auprc': 0.2177496645581752, 'loss_val': 5.412704277412605, 'psi': 0.2177496645581752}-{'f1_val': 0.21697388632872505, 'auprc': 0.21697388632872505, 'loss_val': 5.36245723230251, 'psi': 0.21697388632872505}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=3.771355 cos_to_last_merge=0.9046 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.905
[S4] round=22 local utility u=0.021723 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.195941262180563, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.239386726165206, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=22 head_norm_before_train=3.938299 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.8456859838543256, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.7583358820127146, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=2.774546 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.467136344612648, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.368955246014494, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=22 head_norm_before_train=4.166681 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.49729836474279066, 'auprc': 0.49729836474279066, 'loss_val': 0.09354691049659028, 'psi': 0.49729836474279066}-{'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.05355807929182228, 'psi': 0.49924507948268093}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=22 head_norm_before_train=3.237654 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.4823471290201313, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.440116977884679, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=22 head_norm_before_train=2.916757 cos_to_last_merge=0.9874 (last merge round=2)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.37905708692198, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.319713458431321, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=3.313539 cos_to_last_merge=0.9852 (last merge round=2)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 2.900261402123802, 'psi': 0.27754560530679934}-{'f1_val': 0.2774351833432796, 'auprc': 0.2774351833432796, 'loss_val': 2.870487551938137, 'psi': 0.2774351833432796}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=22 head_norm_before_train=3.156766 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.31083042973286873, 'auprc': 0.31083042973286873, 'loss_val': 4.337186250032828, 'psi': 0.31083042973286873}-{'f1_val': 0.31062749365252085, 'auprc': 0.31062749365252085, 'loss_val': 4.298159512632568, 'psi': 0.31062749365252085}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=22 head_norm_before_train=3.588949 cos_to_last_merge=0.9627 (last merge round=1)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.24609800362976408, 'auprc': 0.24609800362976408, 'loss_val': 1.633224042253878, 'psi': 0.24609800362976408}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.228550462459183, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=2.901104 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.487360240816985, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.363215540795036, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=22 head_norm_before_train=3.238114 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6160664893048908, 'auprc': 0.6160664893048908, 'loss_val': 0.8135565020350201, 'psi': 0.6160664893048908}-{'f1_val': 0.6162291696748081, 'auprc': 0.6162291696748081, 'loss_val': 0.8076523580197074, 'psi': 0.6162291696748081}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=22 head_norm_before_train=2.951539 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.16983471074380166, 'auprc': 0.16983471074380166, 'loss_val': 6.8012088330930744, 'psi': 0.16983471074380166}-{'f1_val': 0.16973203829992423, 'auprc': 0.16973203829992423, 'loss_val': 6.725818943430557, 'psi': 0.16973203829992423}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=3.481633 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.9713772500272041, 'auprc': 0.9713772500272041, 'loss_val': 0.163347223269465, 'psi': 0.9713772500272041}-{'f1_val': 0.9716562634395967, 'auprc': 0.9716562634395967, 'loss_val': 0.15749802796415868, 'psi': 0.9716562634395967}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=2.748771 cos_to_last_merge=0.9743 (last merge round=1)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.677794250664184, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.638941217813284, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=3.089382 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.21997584080361118, 'auprc': 0.21997584080361118, 'loss_val': 5.460874930381763, 'psi': 0.21997584080361118}-{'f1_val': 0.2177496645581752, 'auprc': 0.2177496645581752, 'loss_val': 5.412704277412605, 'psi': 0.2177496645581752}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=3.836113 cos_to_last_merge=0.9019 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.902
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.230778539048907, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.195941262180563, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=23 head_norm_before_train=3.971742 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.9595607429064237, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.8456859838543256, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=23 head_norm_before_train=2.794008 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.558352939721155, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.467136344612648, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=4.177626 (no previous merge yet)
[S7] round=23 local utility u=0.009112 metrics={'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.09284335197547149, 'psi': 0.49924507948268093}-{'f1_val': 0.49729836474279066, 'auprc': 0.49729836474279066, 'loss_val': 0.09354691049659028, 'psi': 0.49729836474279066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=23 head_norm_before_train=3.260777 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.524560948090743, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.4823471290201313, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=23 head_norm_before_train=2.943624 cos_to_last_merge=0.9867 (last merge round=2)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.437346879642087, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.37905708692198, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=23 head_norm_before_train=3.337684 cos_to_last_merge=0.9846 (last merge round=2)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 2.929197749929735, 'psi': 0.27754560530679934}-{'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 2.900261402123802, 'psi': 0.27754560530679934}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=23 head_norm_before_train=3.186670 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.3108981340303492, 'auprc': 0.3108981340303492, 'loss_val': 4.374968539712848, 'psi': 0.3108981340303492}-{'f1_val': 0.31083042973286873, 'auprc': 0.31083042973286873, 'loss_val': 4.337186250032828, 'psi': 0.31083042973286873}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=23 head_norm_before_train=3.677216 cos_to_last_merge=0.9609 (last merge round=1)
[S13] round=23 local utility u=0.359068 metrics={'f1_val': 0.2718524458700882, 'auprc': 0.2718524458700882, 'loss_val': 1.1468787267678766, 'psi': 0.2718524458700882}-{'f1_val': 0.24609800362976408, 'auprc': 0.24609800362976408, 'loss_val': 1.633224042253878, 'psi': 0.24609800362976408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=23 head_norm_before_train=2.926814 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.610781826473714, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.487360240816985, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=23 head_norm_before_train=3.261961 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6159039679189656, 'auprc': 0.6159039679189656, 'loss_val': 0.8199998546138567, 'psi': 0.6159039679189656}-{'f1_val': 0.6160664893048908, 'auprc': 0.6160664893048908, 'loss_val': 0.8135565020350201, 'psi': 0.6160664893048908}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=2.979416 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.17003992840424068, 'auprc': 0.17003992840424068, 'loss_val': 6.876590550691465, 'psi': 0.17003992840424068}-{'f1_val': 0.16983471074380166, 'auprc': 0.16983471074380166, 'loss_val': 6.8012088330930744, 'psi': 0.16983471074380166}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=23 head_norm_before_train=3.520181 (no previous merge yet)
[S17] round=23 local utility u=0.001017 metrics={'f1_val': 0.9716562634395967, 'auprc': 0.9716562634395967, 'loss_val': 0.16382379451080284, 'psi': 0.9716562634395967}-{'f1_val': 0.9713772500272041, 'auprc': 0.9713772500272041, 'loss_val': 0.163347223269465, 'psi': 0.9713772500272041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=24 head_norm_before_train=2.767327 cos_to_last_merge=0.9735 (last merge round=1)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.714249622355719, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.677794250664184, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=3.116837 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.22074130489972074, 'auprc': 0.22074130489972074, 'loss_val': 5.5106210546703815, 'psi': 0.22074130489972074}-{'f1_val': 0.21997584080361118, 'auprc': 0.21997584080361118, 'loss_val': 5.460874930381763, 'psi': 0.21997584080361118}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=24 head_norm_before_train=3.888797 cos_to_last_merge=0.9012 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.901
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.4882742834271294, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.230778539048907, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=4.004220 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.011446026505763, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.9595607429064237, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=2.813066 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.64773089777205, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.558352939721155, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=4.324813 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.11265708126294091, 'psi': 0.49924507948268093}-{'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.09284335197547149, 'psi': 0.49924507948268093}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=24 head_norm_before_train=3.283515 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.5669430686174337, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.524560948090743, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=24 head_norm_before_train=2.970296 cos_to_last_merge=0.9860 (last merge round=2)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.496570402431432, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.437346879642087, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=3.361380 cos_to_last_merge=0.9840 (last merge round=2)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 2.95749695763075, 'psi': 0.27754560530679934}-{'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 2.929197749929735, 'psi': 0.27754560530679934}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=24 head_norm_before_train=3.216382 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.31083042973286873, 'auprc': 0.31083042973286873, 'loss_val': 4.411511540945481, 'psi': 0.31083042973286873}-{'f1_val': 0.3108981340303492, 'auprc': 0.3108981340303492, 'loss_val': 4.374968539712848, 'psi': 0.3108981340303492}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=24 head_norm_before_train=3.742837 cos_to_last_merge=0.9597 (last merge round=1)
[S13] round=24 local utility u=0.036697 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8662399198864985, 'psi': 0.3599362944611573}-{'f1_val': 0.2718524458700882, 'auprc': 0.2718524458700882, 'loss_val': 1.1468787267678766, 'psi': 0.2718524458700882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=24 head_norm_before_train=2.952428 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.732636832536743, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.610781826473714, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=24 head_norm_before_train=3.285276 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6157416052840889, 'auprc': 0.6157416052840889, 'loss_val': 0.8240343314547398, 'psi': 0.6157416052840889}-{'f1_val': 0.6159039679189656, 'auprc': 0.6159039679189656, 'loss_val': 0.8199998546138567, 'psi': 0.6159039679189656}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=24 head_norm_before_train=3.007120 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.17034743722050225, 'auprc': 0.17034743722050225, 'loss_val': 6.948847512723029, 'psi': 0.17034743722050225}-{'f1_val': 0.17003992840424068, 'auprc': 0.17003992840424068, 'loss_val': 6.876590550691465, 'psi': 0.17003992840424068}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=3.546217 (no previous merge yet)
[S17] round=24 local utility u=0.005054 metrics={'f1_val': 0.9724934671984596, 'auprc': 0.9724934671984596, 'loss_val': 0.16125125901843723, 'psi': 0.9724934671984596}-{'f1_val': 0.9716562634395967, 'auprc': 0.9716562634395967, 'loss_val': 0.16382379451080284, 'psi': 0.9716562634395967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=25 head_norm_before_train=2.785522 cos_to_last_merge=0.9726 (last merge round=1)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.751681895508288, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.714249622355719, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=25 head_norm_before_train=3.144183 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.22133485453508273, 'auprc': 0.22133485453508273, 'loss_val': 5.559703934801363, 'psi': 0.22133485453508273}-{'f1_val': 0.22074130489972074, 'auprc': 0.22074130489972074, 'loss_val': 5.5106210546703815, 'psi': 0.22074130489972074}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=3.883675 cos_to_last_merge=0.9017 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.902
[S4] round=25 local utility u=0.027207 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.4338603197635615, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.4882742834271294, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=25 head_norm_before_train=4.036415 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.07846836614937, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.011446026505763, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=2.831875 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.737723172590561, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.64773089777205, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=4.409790 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.49930737685375043, 'auprc': 0.49930737685375043, 'loss_val': 0.14108005087556408, 'psi': 0.4993073768537504}-{'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.11265708126294091, 'psi': 0.49924507948268093}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=25 head_norm_before_train=3.305948 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.6091263128551687, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.5669430686174337, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=25 head_norm_before_train=2.996997 cos_to_last_merge=0.9853 (last merge round=2)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.556227224461294, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.496570402431432, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=3.384531 cos_to_last_merge=0.9834 (last merge round=2)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 2.9850981823552516, 'psi': 0.27754560530679934}-{'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 2.95749695763075, 'psi': 0.27754560530679934}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=25 head_norm_before_train=3.245850 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.31083042973286873, 'auprc': 0.31083042973286873, 'loss_val': 4.449504754498905, 'psi': 0.31083042973286873}-{'f1_val': 0.31083042973286873, 'auprc': 0.31083042973286873, 'loss_val': 4.411511540945481, 'psi': 0.31083042973286873}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=3.542509 cos_to_last_merge=0.9635 (last merge round=1)
[S13] round=25 local utility u=0.017131 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.831978904011578, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8662399198864985, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=25 head_norm_before_train=2.977889 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.853775002329462, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.732636832536743, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=25 head_norm_before_train=3.308027 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6157416052840889, 'auprc': 0.6157416052840889, 'loss_val': 0.8289068141167011, 'psi': 0.6157416052840889}-{'f1_val': 0.6157416052840889, 'auprc': 0.6157416052840889, 'loss_val': 0.8240343314547398, 'psi': 0.6157416052840889}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=3.034650 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.1704498555509699, 'auprc': 0.1704498555509699, 'loss_val': 7.02356230164991, 'psi': 0.1704498555509699}-{'f1_val': 0.17034743722050225, 'auprc': 0.17034743722050225, 'loss_val': 6.948847512723029, 'psi': 0.17034743722050225}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=3.569582 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.9719353040154968, 'auprc': 0.9719353040154968, 'loss_val': 0.1664036509670436, 'psi': 0.9719353040154968}-{'f1_val': 0.9724934671984596, 'auprc': 0.9724934671984596, 'loss_val': 0.16125125901843723, 'psi': 0.9724934671984596}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=26 head_norm_before_train=2.803346 cos_to_last_merge=0.9718 (last merge round=1)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.7879863981204185, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.751681895508288, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=3.171346 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.2231060606060606, 'auprc': 0.2231060606060606, 'loss_val': 5.606387740366836, 'psi': 0.22310606060606059}-{'f1_val': 0.22133485453508273, 'auprc': 0.22133485453508273, 'loss_val': 5.559703934801363, 'psi': 0.22133485453508273}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=3.951856 cos_to_last_merge=0.9012 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.901
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.43898247269136, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.4338603197635615, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=26 head_norm_before_train=4.068164 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.151091013381256, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.07846836614937, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=2.850457 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.826024667585122, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.737723172590561, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=4.473175 (no previous merge yet)
[S7] round=26 local utility u=0.024529 metrics={'f1_val': 0.499182751102467, 'auprc': 0.499182751102467, 'loss_val': 0.09090023299393843, 'psi': 0.499182751102467}-{'f1_val': 0.49930737685375043, 'auprc': 0.49930737685375043, 'loss_val': 0.14108005087556408, 'psi': 0.4993073768537504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=26 head_norm_before_train=3.328052 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.650195999203455, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.6091263128551687, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=26 head_norm_before_train=3.023640 cos_to_last_merge=0.9846 (last merge round=2)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.613751948335451, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.556227224461294, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=3.407241 cos_to_last_merge=0.9828 (last merge round=2)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 3.0120653148777428, 'psi': 0.27754560530679934}-{'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 2.9850981823552516, 'psi': 0.27754560530679934}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=26 head_norm_before_train=3.275215 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.31083042973286873, 'auprc': 0.31083042973286873, 'loss_val': 4.486493734779147, 'psi': 0.31083042973286873}-{'f1_val': 0.31083042973286873, 'auprc': 0.31083042973286873, 'loss_val': 4.449504754498905, 'psi': 0.31083042973286873}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=3.612958 cos_to_last_merge=0.9617 (last merge round=1)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.846386376284754, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.831978904011578, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=3.003171 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.974407693519758, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.853775002329462, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=3.330547 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6157416052840889, 'auprc': 0.6157416052840889, 'loss_val': 0.8330311437770814, 'psi': 0.6157416052840889}-{'f1_val': 0.6157416052840889, 'auprc': 0.6157416052840889, 'loss_val': 0.8289068141167011, 'psi': 0.6157416052840889}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=3.062134 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.17055223162093391, 'auprc': 0.17055223162093391, 'loss_val': 7.105290218388628, 'psi': 0.17055223162093391}-{'f1_val': 0.1704498555509699, 'auprc': 0.1704498555509699, 'loss_val': 7.02356230164991, 'psi': 0.1704498555509699}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=3.591270 (no previous merge yet)
[S17] round=26 local utility u=0.002014 metrics={'f1_val': 0.9724934671984596, 'auprc': 0.9724934671984596, 'loss_val': 0.16739835835701067, 'psi': 0.9724934671984596}-{'f1_val': 0.9719353040154968, 'auprc': 0.9719353040154968, 'loss_val': 0.1664036509670436, 'psi': 0.9719353040154968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=27 head_norm_before_train=2.820831 cos_to_last_merge=0.9709 (last merge round=1)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.824881880459579, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.7879863981204185, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=3.198391 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.22344183699217765, 'auprc': 0.22344183699217765, 'loss_val': 5.654432924139877, 'psi': 0.22344183699217768}-{'f1_val': 0.2231060606060606, 'auprc': 0.2231060606060606, 'loss_val': 5.606387740366836, 'psi': 0.22310606060606059}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=4.008360 cos_to_last_merge=0.9004 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.900
[S4] round=27 local utility u=0.030645 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.3776930480352325, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.43898247269136, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=27 head_norm_before_train=4.099929 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.2165646596344306, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.151091013381256, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=2.868616 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.909045541357372, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.826024667585122, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=4.576659 (no previous merge yet)
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.9988640044715731, 'auprc': 0.9988640044715731, 'loss_val': 0.12476941469861084, 'psi': 0.9988640044715731}-{'f1_val': 0.499182751102467, 'auprc': 0.499182751102467, 'loss_val': 0.09090023299393843, 'psi': 0.499182751102467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=27 head_norm_before_train=3.349760 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.690252451578693, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.650195999203455, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=27 head_norm_before_train=3.049970 cos_to_last_merge=0.9840 (last merge round=2)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.671055213274504, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.613751948335451, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=3.429542 cos_to_last_merge=0.9822 (last merge round=2)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 3.0386902285340613, 'psi': 0.27754560530679934}-{'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 3.0120653148777428, 'psi': 0.27754560530679934}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=27 head_norm_before_train=3.304492 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.3105599071656513, 'auprc': 0.3105599071656513, 'loss_val': 4.523199912048637, 'psi': 0.3105599071656513}-{'f1_val': 0.31083042973286873, 'auprc': 0.31083042973286873, 'loss_val': 4.486493734779147, 'psi': 0.31083042973286873}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=3.659968 cos_to_last_merge=0.9607 (last merge round=1)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8858982014598065, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.846386376284754, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=3.028418 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.094659982173688, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.974407693519758, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=3.352604 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6155794011677721, 'auprc': 0.6155794011677721, 'loss_val': 0.8383287649260617, 'psi': 0.6155794011677721}-{'f1_val': 0.6157416052840889, 'auprc': 0.6157416052840889, 'loss_val': 0.8330311437770814, 'psi': 0.6157416052840889}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=3.089430 (no previous merge yet)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.17075685708393484, 'auprc': 0.17075685708393484, 'loss_val': 7.172776652981421, 'psi': 0.17075685708393484}-{'f1_val': 0.17055223162093391, 'auprc': 0.17055223162093391, 'loss_val': 7.105290218388628, 'psi': 0.17055223162093391}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=3.611263 (no previous merge yet)
[S17] round=27 local utility u=0.003390 metrics={'f1_val': 0.9730517406579368, 'auprc': 0.9730517406579368, 'loss_val': 0.1656431199067882, 'psi': 0.9730517406579369}-{'f1_val': 0.9724934671984596, 'auprc': 0.9724934671984596, 'loss_val': 0.16739835835701067, 'psi': 0.9724934671984596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=28 head_norm_before_train=2.838211 cos_to_last_merge=0.9701 (last merge round=1)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.8597301594236555, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.824881880459579, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=3.225305 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.22419547830467912, 'auprc': 0.22419547830467912, 'loss_val': 5.701887644778343, 'psi': 0.22419547830467912}-{'f1_val': 0.22344183699217765, 'auprc': 0.22344183699217765, 'loss_val': 5.654432924139877, 'psi': 0.22344183699217768}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=4.067542 cos_to_last_merge=0.8983 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.898
[S4] round=28 local utility u=0.015366 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.346961601507865, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.3776930480352325, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=28 head_norm_before_train=4.131595 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.282074138217352, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.2165646596344306, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=2.886590 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.999737773248754, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.909045541357372, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=4.631988 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.08222599238398211, 'psi': 0.49924507948268093}-{'f1_val': 0.9988640044715731, 'auprc': 0.9988640044715731, 'loss_val': 0.12476941469861084, 'psi': 0.9988640044715731}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=3.371090 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.7290700163668453, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.690252451578693, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=3.076332 cos_to_last_merge=0.9833 (last merge round=2)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.728446105223435, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.671055213274504, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=3.451531 cos_to_last_merge=0.9816 (last merge round=2)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 3.064810313847629, 'psi': 0.27754560530679934}-{'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 3.0386902285340613, 'psi': 0.27754560530679934}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=28 head_norm_before_train=3.333606 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.3100876240133246, 'auprc': 0.3100876240133246, 'loss_val': 4.558942329091105, 'psi': 0.3100876240133246}-{'f1_val': 0.3105599071656513, 'auprc': 0.3105599071656513, 'loss_val': 4.523199912048637, 'psi': 0.3105599071656513}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=28 head_norm_before_train=3.699342 cos_to_last_merge=0.9599 (last merge round=1)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9311673767013073, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8858982014598065, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=3.053606 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.213985831977805, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.094659982173688, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=3.374272 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6154983584815449, 'auprc': 0.6154983584815449, 'loss_val': 0.8427248287280069, 'psi': 0.6154983584815449}-{'f1_val': 0.6155794011677721, 'auprc': 0.6155794011677721, 'loss_val': 0.8383287649260617, 'psi': 0.6155794011677721}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=3.116620 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.17085910652920963, 'auprc': 0.17085910652920963, 'loss_val': 7.2466339499782215, 'psi': 0.17085910652920963}-{'f1_val': 0.17075685708393484, 'auprc': 0.17075685708393484, 'loss_val': 7.172776652981421, 'psi': 0.17075685708393484}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=3.630562 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.9727725900759834, 'auprc': 0.9727725900759834, 'loss_val': 0.1696231242872447, 'psi': 0.9727725900759834}-{'f1_val': 0.9730517406579368, 'auprc': 0.9730517406579368, 'loss_val': 0.1656431199067882, 'psi': 0.9730517406579369}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=2.855265 cos_to_last_merge=0.9693 (last merge round=1)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.894988413777597, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.8597301594236555, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=3.252167 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.22536272847182967, 'auprc': 0.22536272847182967, 'loss_val': 5.749270409867374, 'psi': 0.2253627284718297}-{'f1_val': 0.22419547830467912, 'auprc': 0.22419547830467912, 'loss_val': 5.701887644778343, 'psi': 0.22419547830467912}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=4.119873 cos_to_last_merge=0.8975 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.898
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.369567547718527, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.346961601507865, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=4.163159 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.3362365434370878, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.282074138217352, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=2.904342 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.083448987446703, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 11.999737773248754, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=4.657148 (no previous merge yet)
[S7] round=29 local utility u=0.740218 metrics={'f1_val': 0.6647667125487918, 'auprc': 0.6647667125487918, 'loss_val': 0.09148507241835248, 'psi': 0.6647667125487918}-{'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.08222599238398211, 'psi': 0.49924507948268093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=29 head_norm_before_train=3.392061 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.7673408660909953, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.7290700163668453, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=3.102660 cos_to_last_merge=0.9826 (last merge round=2)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.785464545517615, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.728446105223435, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=3.473220 cos_to_last_merge=0.9810 (last merge round=2)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.2774351833432796, 'auprc': 0.2774351833432796, 'loss_val': 3.0904888837680193, 'psi': 0.2774351833432796}-{'f1_val': 0.27754560530679934, 'auprc': 0.27754560530679934, 'loss_val': 3.064810313847629, 'psi': 0.27754560530679934}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=29 head_norm_before_train=3.362693 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.30995294969236337, 'auprc': 0.30995294969236337, 'loss_val': 4.595623128577442, 'psi': 0.30995294969236337}-{'f1_val': 0.3100876240133246, 'auprc': 0.3100876240133246, 'loss_val': 4.558942329091105, 'psi': 0.3100876240133246}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=3.734156 cos_to_last_merge=0.9592 (last merge round=1)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9777306807628032, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9311673767013073, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=3.078617 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.332700626157457, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.213985831977805, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=3.395671 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6154983584815449, 'auprc': 0.6154983584815449, 'loss_val': 0.8477924166774148, 'psi': 0.6154983584815449}-{'f1_val': 0.6154983584815449, 'auprc': 0.6154983584815449, 'loss_val': 0.8427248287280069, 'psi': 0.6154983584815449}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=3.143739 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.17106347897774113, 'auprc': 0.17106347897774113, 'loss_val': 7.321789455170803, 'psi': 0.17106347897774113}-{'f1_val': 0.17085910652920963, 'auprc': 0.17085910652920963, 'loss_val': 7.2466339499782215, 'psi': 0.17085910652920963}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=3.649122 (no previous merge yet)
[S17] round=29 local utility u=0.000425 metrics={'f1_val': 0.9730517406579368, 'auprc': 0.9730517406579368, 'loss_val': 0.17128484108421682, 'psi': 0.9730517406579369}-{'f1_val': 0.9727725900759834, 'auprc': 0.9727725900759834, 'loss_val': 0.1696231242872447, 'psi': 0.9727725900759834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=30 head_norm_before_train=2.872155 cos_to_last_merge=0.9685 (last merge round=1)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.930157315724062, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.894988413777597, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=3.279043 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.22602696770147382, 'auprc': 0.22602696770147382, 'loss_val': 5.79794432258743, 'psi': 0.22602696770147382}-{'f1_val': 0.22536272847182967, 'auprc': 0.22536272847182967, 'loss_val': 5.749270409867374, 'psi': 0.2253627284718297}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=4.148312 cos_to_last_merge=0.8960 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.896
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.4917483960875355, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.369567547718527, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=4.195652 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.405287831170664, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.3362365434370878, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=2.921934 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.168302334893017, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.083448987446703, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=4.725567 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.16509911500339575, 'psi': 0.49924507948268093}-{'f1_val': 0.6647667125487918, 'auprc': 0.6647667125487918, 'loss_val': 0.09148507241835248, 'psi': 0.6647667125487918}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=3.412831 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.805263701596325, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.7673408660909953, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=3.128802 cos_to_last_merge=0.9819 (last merge round=2)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.842025284687562, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.785464545517615, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=3.494554 cos_to_last_merge=0.9805 (last merge round=2)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.2774351833432796, 'auprc': 0.2774351833432796, 'loss_val': 3.115810338932636, 'psi': 0.2774351833432796}-{'f1_val': 0.2774351833432796, 'auprc': 0.2774351833432796, 'loss_val': 3.0904888837680193, 'psi': 0.2774351833432796}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=30 head_norm_before_train=3.391682 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3096839516887249, 'auprc': 0.3096839516887249, 'loss_val': 4.633097366537037, 'psi': 0.3096839516887249}-{'f1_val': 0.30995294969236337, 'auprc': 0.30995294969236337, 'loss_val': 4.595623128577442, 'psi': 0.30995294969236337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=3.765474 cos_to_last_merge=0.9585 (last merge round=1)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0303180949191155, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9777306807628032, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=3.103678 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.454062917861531, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.332700626157457, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=3.416779 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6154983584815449, 'auprc': 0.6154983584815449, 'loss_val': 0.8527760900240275, 'psi': 0.6154983584815449}-{'f1_val': 0.6154983584815449, 'auprc': 0.6154983584815449, 'loss_val': 0.8477924166774148, 'psi': 0.6154983584815449}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=3.170793 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.1712676830105755, 'auprc': 0.1712676830105755, 'loss_val': 7.3944448387919595, 'psi': 0.1712676830105755}-{'f1_val': 0.17106347897774113, 'auprc': 0.17106347897774113, 'loss_val': 7.321789455170803, 'psi': 0.17106347897774113}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=3.667014 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.9730517406579368, 'auprc': 0.9730517406579368, 'loss_val': 0.17163869712438806, 'psi': 0.9730517406579369}-{'f1_val': 0.9730517406579368, 'auprc': 0.9730517406579368, 'loss_val': 0.17128484108421682, 'psi': 0.9730517406579369}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=2.888880 cos_to_last_merge=0.9677 (last merge round=1)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.965350109778406, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.930157315724062, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=3.305795 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.22808988764044943, 'auprc': 0.22808988764044943, 'loss_val': 5.844837797798555, 'psi': 0.2280898876404494}-{'f1_val': 0.22602696770147382, 'auprc': 0.22602696770147382, 'loss_val': 5.79794432258743, 'psi': 0.22602696770147382}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=4.104881 cos_to_last_merge=0.8913 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.891
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.636366541387603, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.4917483960875355, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=4.227694 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.466923808374686, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.405287831170664, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=2.939450 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.251089886732029, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.168302334893017, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=4.802937 (no previous merge yet)
[S7] round=31 local utility u=0.767236 metrics={'f1_val': 0.6656835997830904, 'auprc': 0.6656835997830904, 'loss_val': 0.1285744286126032, 'psi': 0.6656835997830904}-{'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.16509911500339575, 'psi': 0.49924507948268093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=31 head_norm_before_train=3.433331 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.844722014824211, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.805263701596325, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=3.154970 cos_to_last_merge=0.9812 (last merge round=2)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.898187116334453, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.842025284687562, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=3.515680 cos_to_last_merge=0.9799 (last merge round=2)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.2774351833432796, 'auprc': 0.2774351833432796, 'loss_val': 3.1409311677738407, 'psi': 0.2774351833432796}-{'f1_val': 0.2774351833432796, 'auprc': 0.2774351833432796, 'loss_val': 3.115810338932636, 'psi': 0.2774351833432796}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=3.420640 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3090134949844844, 'auprc': 0.3090134949844844, 'loss_val': 4.668443169139369, 'psi': 0.3090134949844844}-{'f1_val': 0.3096839516887249, 'auprc': 0.3096839516887249, 'loss_val': 4.633097366537037, 'psi': 0.3096839516887249}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=3.795012 cos_to_last_merge=0.9580 (last merge round=1)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.075767536423631, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0303180949191155, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=3.128825 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.568139451992922, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.454062917861531, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=3.437735 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6153591648042265, 'auprc': 0.6153591648042265, 'loss_val': 0.8572017049253748, 'psi': 0.6153591648042265}-{'f1_val': 0.6154983584815449, 'auprc': 0.6154983584815449, 'loss_val': 0.8527760900240275, 'psi': 0.6154983584815449}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=3.197838 (no previous merge yet)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.17157367373550203, 'auprc': 0.17157367373550203, 'loss_val': 7.4692076433496535, 'psi': 0.17157367373550203}-{'f1_val': 0.1712676830105755, 'auprc': 0.1712676830105755, 'loss_val': 7.3944448387919595, 'psi': 0.1712676830105755}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=3.684613 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.9727725900759834, 'auprc': 0.9727725900759834, 'loss_val': 0.17694560708334228, 'psi': 0.9727725900759834}-{'f1_val': 0.9730517406579368, 'auprc': 0.9730517406579368, 'loss_val': 0.17163869712438806, 'psi': 0.9730517406579369}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=2.905465 cos_to_last_merge=0.9669 (last merge round=1)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.000457964990882, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.965350109778406, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=3.332630 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.2289096573208723, 'auprc': 0.2289096573208723, 'loss_val': 5.892237669948098, 'psi': 0.2289096573208723}-{'f1_val': 0.22808988764044943, 'auprc': 0.22808988764044943, 'loss_val': 5.844837797798555, 'psi': 0.2280898876404494}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=4.147968 cos_to_last_merge=0.8941 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.894
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.7197081282910296, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.636366541387603, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=4.260211 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.538920394985104, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.466923808374686, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=2.956726 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.33543414272062, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.251089886732029, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=4.895419 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6653507676820047, 'auprc': 0.6653507676820047, 'loss_val': 0.12682634793805828, 'psi': 0.6653507676820047}-{'f1_val': 0.6656835997830904, 'auprc': 0.6656835997830904, 'loss_val': 0.1285744286126032, 'psi': 0.6656835997830904}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=3.453841 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8817300921504665, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.844722014824211, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=3.181426 cos_to_last_merge=0.9806 (last merge round=2)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.954216513109776, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.898187116334453, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=3.536539 cos_to_last_merge=0.9794 (last merge round=2)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.277380005303633, 'auprc': 0.277380005303633, 'loss_val': 3.1657048540011368, 'psi': 0.277380005303633}-{'f1_val': 0.2774351833432796, 'auprc': 0.2774351833432796, 'loss_val': 3.1409311677738407, 'psi': 0.2774351833432796}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=3.449624 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.308679354094579, 'auprc': 0.308679354094579, 'loss_val': 4.705267536886857, 'psi': 0.308679354094579}-{'f1_val': 0.3090134949844844, 'auprc': 0.3090134949844844, 'loss_val': 4.668443169139369, 'psi': 0.3090134949844844}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=3.822696 cos_to_last_merge=0.9575 (last merge round=1)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.119096019971576, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.075767536423631, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=3.153574 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.68522636875669, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.568139451992922, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=3.458388 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6153591648042265, 'auprc': 0.6153591648042265, 'loss_val': 0.8621016155535717, 'psi': 0.6153591648042265}-{'f1_val': 0.6153591648042265, 'auprc': 0.6153591648042265, 'loss_val': 0.8572017049253748, 'psi': 0.6153591648042265}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=3.224854 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.17157367373550203, 'auprc': 0.17157367373550203, 'loss_val': 7.545702831683031, 'psi': 0.17157367373550203}-{'f1_val': 0.17157367373550203, 'auprc': 0.17157367373550203, 'loss_val': 7.4692076433496535, 'psi': 0.17157367373550203}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=3.702578 (no previous merge yet)
[S17] round=32 local utility u=0.004819 metrics={'f1_val': 0.9733309190796922, 'auprc': 0.9733309190796922, 'loss_val': 0.1723319756805213, 'psi': 0.9733309190796922}-{'f1_val': 0.9727725900759834, 'auprc': 0.9727725900759834, 'loss_val': 0.17694560708334228, 'psi': 0.9727725900759834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=33 head_norm_before_train=2.921933 cos_to_last_merge=0.9661 (last merge round=1)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.0344019165365115, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.000457964990882, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=3.359299 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.2291549909707952, 'auprc': 0.2291549909707952, 'loss_val': 5.940663466716899, 'psi': 0.22915499097079517}-{'f1_val': 0.2289096573208723, 'auprc': 0.2289096573208723, 'loss_val': 5.892237669948098, 'psi': 0.2289096573208723}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=4.208936 cos_to_last_merge=0.8945 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.894
[S4] round=33 local utility u=0.045520 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.628668160450645, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.7197081282910296, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=33 head_norm_before_train=4.292166 (no previous merge yet)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.5797461263716572, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.538920394985104, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=2.973854 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.413993392374035, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.33543414272062, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=4.985352 (no previous merge yet)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6651841027540183, 'auprc': 0.6651841027540183, 'loss_val': 0.18146511044430386, 'psi': 0.6651841027540183}-{'f1_val': 0.6653507676820047, 'auprc': 0.6653507676820047, 'loss_val': 0.12682634793805828, 'psi': 0.6653507676820047}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=3.473997 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.918543547431449, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8817300921504665, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=3.207211 cos_to_last_merge=0.9799 (last merge round=2)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.0104121956632754, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.954216513109776, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=3.557233 cos_to_last_merge=0.9788 (last merge round=2)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 3.190084312152589, 'psi': 0.2773248492079274}-{'f1_val': 0.277380005303633, 'auprc': 0.277380005303633, 'loss_val': 3.1657048540011368, 'psi': 0.277380005303633}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=3.478699 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.30821276902037, 'auprc': 0.30821276902037, 'loss_val': 4.740668421996218, 'psi': 0.30821276902037}-{'f1_val': 0.308679354094579, 'auprc': 0.308679354094579, 'loss_val': 4.705267536886857, 'psi': 0.308679354094579}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=3.849111 cos_to_last_merge=0.9570 (last merge round=1)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1672039156448464, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.119096019971576, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=3.178540 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.808061146801156, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.68522636875669, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=3.478769 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6151971980308252, 'auprc': 0.6151971980308252, 'loss_val': 0.866225353038209, 'psi': 0.6151971980308252}-{'f1_val': 0.6153591648042265, 'auprc': 0.6153591648042265, 'loss_val': 0.8621016155535717, 'psi': 0.6153591648042265}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=3.251902 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.17198107385311664, 'auprc': 0.17198107385311664, 'loss_val': 7.618186132911747, 'psi': 0.17198107385311664}-{'f1_val': 0.17157367373550203, 'auprc': 0.17157367373550203, 'loss_val': 7.545702831683031, 'psi': 0.17157367373550203}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=3.719920 (no previous merge yet)
[S17] round=33 local utility u=0.002018 metrics={'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.1708098139749268, 'psi': 0.9736101254766788}-{'f1_val': 0.9733309190796922, 'auprc': 0.9733309190796922, 'loss_val': 0.1723319756805213, 'psi': 0.9733309190796922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=34 head_norm_before_train=2.938150 cos_to_last_merge=0.9654 (last merge round=1)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.068073603387252, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.0344019165365115, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=3.386021 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.229726368159204, 'auprc': 0.229726368159204, 'loss_val': 5.988486557603108, 'psi': 0.229726368159204}-{'f1_val': 0.2291549909707952, 'auprc': 0.2291549909707952, 'loss_val': 5.940663466716899, 'psi': 0.22915499097079517}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=4.272312 cos_to_last_merge=0.8947 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.895
[S4] round=34 local utility u=0.002900 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.622867528431723, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.628668160450645, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=34 head_norm_before_train=4.326049 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.6498138373858273, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.5797461263716572, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=2.990745 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.499170854397702, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.413993392374035, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=5.045380 (no previous merge yet)
[S7] round=34 local utility u=0.005706 metrics={'f1_val': 0.6658497674514683, 'auprc': 0.6658497674514683, 'loss_val': 0.17604438446653606, 'psi': 0.6658497674514683}-{'f1_val': 0.6651841027540183, 'auprc': 0.6651841027540183, 'loss_val': 0.18146511044430386, 'psi': 0.6651841027540183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=34 head_norm_before_train=3.493987 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.9567389703111644, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.918543547431449, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=3.233280 cos_to_last_merge=0.9792 (last merge round=2)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.06692335555197, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.0104121956632754, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=3.577624 cos_to_last_merge=0.9783 (last merge round=2)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 3.214280380264617, 'psi': 0.2773248492079274}-{'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 3.190084312152589, 'psi': 0.2773248492079274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=3.507548 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.30741618206619287, 'auprc': 0.30741618206619287, 'loss_val': 4.7743731089533545, 'psi': 0.30741618206619287}-{'f1_val': 0.30821276902037, 'auprc': 0.30821276902037, 'loss_val': 4.740668421996218, 'psi': 0.30821276902037}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=3.874583 cos_to_last_merge=0.9565 (last merge round=1)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.213075955626355, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.1672039156448464, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=3.203734 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.923810930889477, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.808061146801156, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=3.499066 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6147929715768676, 'auprc': 0.6147929715768676, 'loss_val': 0.8703141826732452, 'psi': 0.6147929715768676}-{'f1_val': 0.6151971980308252, 'auprc': 0.6151971980308252, 'loss_val': 0.866225353038209, 'psi': 0.6151971980308252}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=3.278912 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.17208281914164267, 'auprc': 0.17208281914164267, 'loss_val': 7.69174250754733, 'psi': 0.17208281914164267}-{'f1_val': 0.17198107385311664, 'auprc': 0.17198107385311664, 'loss_val': 7.618186132911747, 'psi': 0.17198107385311664}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=3.736444 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.17260511048412133, 'psi': 0.9736101254766788}-{'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.1708098139749268, 'psi': 0.9736101254766788}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=2.954238 cos_to_last_merge=0.9646 (last merge round=1)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.10195247147927, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.068073603387252, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=3.412614 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.229726368159204, 'auprc': 0.229726368159204, 'loss_val': 6.037268931441931, 'psi': 0.229726368159204}-{'f1_val': 0.229726368159204, 'auprc': 0.229726368159204, 'loss_val': 5.988486557603108, 'psi': 0.229726368159204}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=4.320062 cos_to_last_merge=0.8939 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.894
[S4] round=35 local utility u=0.039484 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.543898715479081, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.622867528431723, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=35 head_norm_before_train=4.358234 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.720395931845967, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.6498138373858273, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=3.007674 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.578460620641067, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.499170854397702, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=5.114983 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.6640127793056542, 'auprc': 0.6640127793056542, 'loss_val': 0.21020459627402086, 'psi': 0.6640127793056542}-{'f1_val': 0.6658497674514683, 'auprc': 0.6658497674514683, 'loss_val': 0.17604438446653606, 'psi': 0.6658497674514683}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=3.513937 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.9928893039809497, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.9567389703111644, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=3.259211 cos_to_last_merge=0.9785 (last merge round=2)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.124885170195335, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.06692335555197, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=3.597842 cos_to_last_merge=0.9777 (last merge round=2)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 3.2382392379353813, 'psi': 0.2773248492079274}-{'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 3.214280380264617, 'psi': 0.2773248492079274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=3.536514 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.3068874077259371, 'auprc': 0.3068874077259371, 'loss_val': 4.809623223789967, 'psi': 0.3068874077259371}-{'f1_val': 0.30741618206619287, 'auprc': 0.30741618206619287, 'loss_val': 4.7743731089533545, 'psi': 0.30741618206619287}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=3.899180 cos_to_last_merge=0.9561 (last merge round=1)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.2554342987821463, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.213075955626355, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=3.228709 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.03504277666096, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.923810930889477, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=3.519208 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6145509080236213, 'auprc': 0.6145509080236213, 'loss_val': 0.8748612907220695, 'psi': 0.6145509080236213}-{'f1_val': 0.6147929715768676, 'auprc': 0.6147929715768676, 'loss_val': 0.8703141826732452, 'psi': 0.6147929715768676}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=3.305901 (no previous merge yet)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.17208281914164267, 'auprc': 0.17208281914164267, 'loss_val': 7.770635695820867, 'psi': 0.17208281914164267}-{'f1_val': 0.17208281914164267, 'auprc': 0.17208281914164267, 'loss_val': 7.69174250754733, 'psi': 0.17208281914164267}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=3.752775 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.17274506115020014, 'psi': 0.9736101254766788}-{'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.17260511048412133, 'psi': 0.9736101254766788}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=2.970288 cos_to_last_merge=0.9638 (last merge round=1)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.136257899880269, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.10195247147927, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=3.439568 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2308646569904478, 'auprc': 0.2308646569904478, 'loss_val': 6.085253315186546, 'psi': 0.2308646569904478}-{'f1_val': 0.229726368159204, 'auprc': 0.229726368159204, 'loss_val': 6.037268931441931, 'psi': 0.229726368159204}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=4.362852 cos_to_last_merge=0.8935 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.894
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.24300677757239678, 'auprc': 0.24300677757239678, 'loss_val': 3.2609559420171945, 'psi': 0.24300677757239678}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.543898715479081, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=4.390613 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.7846309035797896, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.720395931845967, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=3.024435 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.658046842786614, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.578460620641067, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=5.167087 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6657667042900423, 'auprc': 0.6657667042900423, 'loss_val': 0.30428219941221873, 'psi': 0.6657667042900423}-{'f1_val': 0.6640127793056542, 'auprc': 0.6640127793056542, 'loss_val': 0.21020459627402086, 'psi': 0.6640127793056542}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=3.533566 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.030145413974455, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.9928893039809497, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=3.285967 cos_to_last_merge=0.9779 (last merge round=2)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.180143176371993, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.124885170195335, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=3.617946 cos_to_last_merge=0.9772 (last merge round=2)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 3.262137963321039, 'psi': 0.2773248492079274}-{'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 3.2382392379353813, 'psi': 0.2773248492079274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=3.565430 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.306689586019195, 'auprc': 0.306689586019195, 'loss_val': 4.847877307819913, 'psi': 0.306689586019195}-{'f1_val': 0.3068874077259371, 'auprc': 0.3068874077259371, 'loss_val': 4.809623223789967, 'psi': 0.3068874077259371}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=3.923141 cos_to_last_merge=0.9556 (last merge round=1)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.301371678839054, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.2554342987821463, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=3.253091 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.157565796931074, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.03504277666096, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=3.539081 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.613746576725195, 'auprc': 0.613746576725195, 'loss_val': 0.8794014244170839, 'psi': 0.613746576725195}-{'f1_val': 0.6145509080236213, 'auprc': 0.6145509080236213, 'loss_val': 0.8748612907220695, 'psi': 0.6145509080236213}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=3.332984 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.17218452258550965, 'auprc': 0.17218452258550965, 'loss_val': 7.841115659447643, 'psi': 0.17218452258550965}-{'f1_val': 0.17208281914164267, 'auprc': 0.17208281914164267, 'loss_val': 7.770635695820867, 'psi': 0.17208281914164267}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=3.768831 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.17371596292493763, 'psi': 0.9736101254766788}-{'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.17274506115020014, 'psi': 0.9736101254766788}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=2.986302 cos_to_last_merge=0.9631 (last merge round=1)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.170659071818113, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.136257899880269, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=3.466174 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.23159328751006256, 'auprc': 0.23159328751006256, 'loss_val': 6.133985697475812, 'psi': 0.23159328751006256}-{'f1_val': 0.2308646569904478, 'auprc': 0.2308646569904478, 'loss_val': 6.085253315186546, 'psi': 0.2308646569904478}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=4.345824 cos_to_last_merge=0.8887 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.889
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.24300677757239678, 'auprc': 0.24300677757239678, 'loss_val': 3.308048921172124, 'psi': 0.24300677757239678}-{'f1_val': 0.24300677757239678, 'auprc': 0.24300677757239678, 'loss_val': 3.2609559420171945, 'psi': 0.24300677757239678}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=4.423152 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.851104972649883, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.7846309035797896, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=3.041042 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.740490668452143, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.658046842786614, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=5.234744 (no previous merge yet)
[S7] round=37 local utility u=0.051057 metrics={'f1_val': 0.6652674559836392, 'auprc': 0.6652674559836392, 'loss_val': 0.19767579082327597, 'psi': 0.6652674559836392}-{'f1_val': 0.6657667042900423, 'auprc': 0.6657667042900423, 'loss_val': 0.30428219941221873, 'psi': 0.6657667042900423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=37 head_norm_before_train=3.553218 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.066300713070428, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.030145413974455, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=3.311664 cos_to_last_merge=0.9772 (last merge round=2)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.235987350764132, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.180143176371993, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=3.637902 cos_to_last_merge=0.9766 (last merge round=2)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 3.2857810370607137, 'psi': 0.2773248492079274}-{'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 3.262137963321039, 'psi': 0.2773248492079274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=3.594359 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.30616330616330617, 'auprc': 0.30616330616330617, 'loss_val': 4.883962270477961, 'psi': 0.30616330616330617}-{'f1_val': 0.306689586019195, 'auprc': 0.306689586019195, 'loss_val': 4.847877307819913, 'psi': 0.306689586019195}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=3.946443 cos_to_last_merge=0.9552 (last merge round=1)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.3408314727578117, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.301371678839054, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=3.278466 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.271646005326309, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.157565796931074, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=3.558955 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.6132658502983372, 'auprc': 0.6132658502983372, 'loss_val': 0.8841688383097119, 'psi': 0.6132658502983372}-{'f1_val': 0.613746576725195, 'auprc': 0.613746576725195, 'loss_val': 0.8794014244170839, 'psi': 0.613746576725195}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=3.359963 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.1723878040424803, 'auprc': 0.1723878040424803, 'loss_val': 7.915676567011833, 'psi': 0.1723878040424803}-{'f1_val': 0.17218452258550965, 'auprc': 0.17218452258550965, 'loss_val': 7.841115659447643, 'psi': 0.17218452258550965}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=3.785294 (no previous merge yet)
[S17] round=37 local utility u=0.000317 metrics={'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.17308242465593718, 'psi': 0.9736101254766788}-{'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.17371596292493763, 'psi': 0.9736101254766788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=38 head_norm_before_train=3.002268 cos_to_last_merge=0.9623 (last merge round=1)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.203841830140029, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.170659071818113, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=3.492501 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.23175487465181058, 'auprc': 0.23175487465181058, 'loss_val': 6.183351728070759, 'psi': 0.23175487465181055}-{'f1_val': 0.23159328751006256, 'auprc': 0.23159328751006256, 'loss_val': 6.133985697475812, 'psi': 0.23159328751006256}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=4.418108 cos_to_last_merge=0.8886 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.889
[S4] round=38 local utility u=0.223531 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.8850719768752393, 'psi': 0.3567939207526687}-{'f1_val': 0.24300677757239678, 'auprc': 0.24300677757239678, 'loss_val': 3.308048921172124, 'psi': 0.24300677757239678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=38 head_norm_before_train=4.455855 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.924682206990012, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.851104972649883, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=3.057626 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.81917652208293, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.740490668452143, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=5.351787 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.49912039168995026, 'auprc': 0.49912039168995026, 'loss_val': 0.2356338757076223, 'psi': 0.49912039168995026}-{'f1_val': 0.6652674559836392, 'auprc': 0.6652674559836392, 'loss_val': 0.19767579082327597, 'psi': 0.6652674559836392}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=3.572714 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.102748545288471, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.066300713070428, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=3.337988 cos_to_last_merge=0.9765 (last merge round=2)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.2933802287483855, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.235987350764132, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=3.657691 cos_to_last_merge=0.9761 (last merge round=2)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.2772697150430749, 'auprc': 0.2772697150430749, 'loss_val': 3.3093479106516748, 'psi': 0.2772697150430749}-{'f1_val': 0.2773248492079274, 'auprc': 0.2773248492079274, 'loss_val': 3.2857810370607137, 'psi': 0.2773248492079274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=3.623151 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.3057697800628392, 'auprc': 0.3057697800628392, 'loss_val': 4.919657755371362, 'psi': 0.3057697800628392}-{'f1_val': 0.30616330616330617, 'auprc': 0.30616330616330617, 'loss_val': 4.883962270477961, 'psi': 0.30616330616330617}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=3.969085 cos_to_last_merge=0.9548 (last merge round=1)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.38527080928564, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.3408314727578117, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=3.303105 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.376182358412489, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.271646005326309, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=3.578554 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6130260112595923, 'auprc': 0.6130260112595923, 'loss_val': 0.8889841103001672, 'psi': 0.6130260112595923}-{'f1_val': 0.6132658502983372, 'auprc': 0.6132658502983372, 'loss_val': 0.8841688383097119, 'psi': 0.6132658502983372}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=3.386860 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.17248938210713796, 'auprc': 0.17248938210713796, 'loss_val': 7.988985233629096, 'psi': 0.17248938210713796}-{'f1_val': 0.1723878040424803, 'auprc': 0.1723878040424803, 'loss_val': 7.915676567011833, 'psi': 0.1723878040424803}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=3.801319 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.1747818072560357, 'psi': 0.9736101254766788}-{'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.17308242465593718, 'psi': 0.9736101254766788}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=3.018035 cos_to_last_merge=0.9615 (last merge round=1)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.236470251806278, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.203841830140029, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.367 u=0.0000 p_local=0.0002 f1=0.367 auprc=0.367 bytes=3602
[S3] START round=39 head_norm_before_train=3.519307 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.23199703043801037, 'auprc': 0.23199703043801037, 'loss_val': 6.232775511182539, 'psi': 0.23199703043801034}-{'f1_val': 0.23175487465181058, 'auprc': 0.23175487465181058, 'loss_val': 6.183351728070759, 'psi': 0.23175487465181055}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.232 u=0.0000 p_local=0.0002 f1=0.232 auprc=0.232 bytes=0
[S4] START round=39 head_norm_before_train=4.364302 cos_to_last_merge=0.8782 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.878
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.114152177496179, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.8850719768752393, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0429 f1=0.357 auprc=0.357 bytes=23359
[S5] START round=39 head_norm_before_train=4.488715 (no previous merge yet)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.9785708987063915, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.924682206990012, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.334 u=0.0000 p_local=0.0008 f1=0.334 auprc=0.334 bytes=17999
[S6] START round=39 head_norm_before_train=3.074182 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.901027613198027, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.81917652208293, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.018 u=0.0000 p_local=0.0002 f1=0.018 auprc=0.018 bytes=0
[S7] START round=39 head_norm_before_train=5.401967 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.28094819635719587, 'psi': 0.49924507948268093}-{'f1_val': 0.49912039168995026, 'auprc': 0.49912039168995026, 'loss_val': 0.2356338757076223, 'psi': 0.49912039168995026}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.499 u=0.0000 p_local=0.0652 f1=0.499 auprc=0.499 bytes=34206
[S8] START round=39 head_norm_before_train=3.592110 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.137819081800307, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.102748545288471, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0002 f1=0.359 auprc=0.359 bytes=0
[S9] START round=39 head_norm_before_train=3.364462 cos_to_last_merge=0.9758 (last merge round=2)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.349755868279673, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.2933802287483855, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0002 f1=0.369 auprc=0.369 bytes=0
[S10] START round=39 head_norm_before_train=3.677408 cos_to_last_merge=0.9756 (last merge round=2)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.27721460279599813, 'auprc': 0.27721460279599813, 'loss_val': 3.3325727042527067, 'psi': 0.27721460279599813}-{'f1_val': 0.2772697150430749, 'auprc': 0.2772697150430749, 'loss_val': 3.3093479106516748, 'psi': 0.2772697150430749}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.277 u=0.0000 p_local=0.0002 f1=0.277 auprc=0.277 bytes=0
[S11] START round=39 head_norm_before_train=3.651692 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.30492060101117996, 'auprc': 0.30492060101117996, 'loss_val': 4.953804629965837, 'psi': 0.30492060101117996}-{'f1_val': 0.3057697800628392, 'auprc': 0.3057697800628392, 'loss_val': 4.919657755371362, 'psi': 0.3057697800628392}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.305 u=0.0000 p_local=0.0002 f1=0.305 auprc=0.305 bytes=0
[S13] START round=39 head_norm_before_train=3.991422 cos_to_last_merge=0.9544 (last merge round=1)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.4257168325555702, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.38527080928564, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0062 f1=0.360 auprc=0.360 bytes=17995
[S14] START round=39 head_norm_before_train=3.327281 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.449442105794857, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.376182358412489, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0002 f1=0.136 auprc=0.136 bytes=0
[S15] START round=39 head_norm_before_train=3.598090 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6124677405475711, 'auprc': 0.6124677405475711, 'loss_val': 0.8934169717799094, 'psi': 0.6124677405475711}-{'f1_val': 0.6130260112595923, 'auprc': 0.6130260112595923, 'loss_val': 0.8889841103001672, 'psi': 0.6130260112595923}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.612 u=0.0000 p_local=0.0002 f1=0.612 auprc=0.612 bytes=3599
[S16] START round=39 head_norm_before_train=3.413973 (no previous merge yet)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.17248938210713796, 'auprc': 0.17248938210713796, 'loss_val': 8.069777309930965, 'psi': 0.17248938210713796}-{'f1_val': 0.17248938210713796, 'auprc': 0.17248938210713796, 'loss_val': 7.988985233629096, 'psi': 0.17248938210713796}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.172 u=0.0000 p_local=0.0002 f1=0.172 auprc=0.172 bytes=0
[S17] START round=39 head_norm_before_train=3.817257 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.1758561173474162, 'psi': 0.9736101254766788}-{'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.1747818072560357, 'psi': 0.9736101254766788}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.974 u=0.0000 p_local=0.0062 f1=0.974 auprc=0.974 bytes=35943
[S2] START round=40 head_norm_before_train=3.033668 cos_to_last_merge=0.9608 (last merge round=1)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.269987215212583, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.236470251806278, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=3.546324 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.23199703043801037, 'auprc': 0.23199703043801037, 'loss_val': 6.282209734478582, 'psi': 0.23199703043801034}-{'f1_val': 0.23199703043801037, 'auprc': 0.23199703043801037, 'loss_val': 6.232775511182539, 'psi': 0.23199703043801034}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=4.413870 cos_to_last_merge=0.8741 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.874
[S4] round=40 local utility u=0.100895 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.9123630187119187, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.114152177496179, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=40 head_norm_before_train=4.521897 (no previous merge yet)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.03097839795869, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.9785708987063915, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=3.090548 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.97939319523347, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.901027613198027, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=5.475049 (no previous merge yet)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.4987455822367085, 'auprc': 0.4987455822367085, 'loss_val': 0.3148915311750583, 'psi': 0.4987455822367085}-{'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.28094819635719587, 'psi': 0.49924507948268093}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=3.611309 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.174426829212031, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.137819081800307, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=3.392039 cos_to_last_merge=0.9751 (last merge round=2)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.4053936750189155, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.349755868279673, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=3.696909 cos_to_last_merge=0.9751 (last merge round=2)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.2771044440029141, 'auprc': 0.2771044440029141, 'loss_val': 3.3557333956129733, 'psi': 0.2771044440029141}-{'f1_val': 0.27721460279599813, 'auprc': 0.27721460279599813, 'loss_val': 3.3325727042527067, 'psi': 0.27721460279599813}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=3.680043 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.3045952482572201, 'auprc': 0.3045952482572201, 'loss_val': 4.990609642093859, 'psi': 0.3045952482572201}-{'f1_val': 0.30492060101117996, 'auprc': 0.30492060101117996, 'loss_val': 4.953804629965837, 'psi': 0.30492060101117996}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=4.013242 cos_to_last_merge=0.9540 (last merge round=1)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.462174237767104, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.4257168325555702, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=3.352193 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.515499414713204, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.449442105794857, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=3.617550 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.611752735925089, 'auprc': 0.611752735925089, 'loss_val': 0.89829854670076, 'psi': 0.611752735925089}-{'f1_val': 0.6124677405475711, 'auprc': 0.6124677405475711, 'loss_val': 0.8934169717799094, 'psi': 0.6124677405475711}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=3.441065 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.17279386595467927, 'auprc': 0.17279386595467927, 'loss_val': 8.13578743653855, 'psi': 0.17279386595467927}-{'f1_val': 0.17248938210713796, 'auprc': 0.17248938210713796, 'loss_val': 8.069777309930965, 'psi': 0.17248938210713796}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=3.833374 (no previous merge yet)
[S17] round=40 local utility u=0.002609 metrics={'f1_val': 0.9741686227383506, 'auprc': 0.9741686227383506, 'loss_val': 0.17566391978547397, 'psi': 0.9741686227383506}-{'f1_val': 0.9736101254766788, 'auprc': 0.9736101254766788, 'loss_val': 0.1758561173474162, 'psi': 0.9736101254766788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=41 head_norm_before_train=3.049333 cos_to_last_merge=0.9600 (last merge round=1)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.302742501890723, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.269987215212583, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=3.572967 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.23199703043801037, 'auprc': 0.23199703043801037, 'loss_val': 6.332985913196016, 'psi': 0.23199703043801034}-{'f1_val': 0.23199703043801037, 'auprc': 0.23199703043801037, 'loss_val': 6.282209734478582, 'psi': 0.23199703043801034}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=4.510155 cos_to_last_merge=0.8772 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.877
[S4] round=41 local utility u=0.002073 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.9082178965581806, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.9123630187119187, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=41 head_norm_before_train=4.555621 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.0839592364137465, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.03097839795869, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=3.106792 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.057638443446816, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 12.97939319523347, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=5.596317 (no previous merge yet)
[S7] round=41 local utility u=0.821129 metrics={'f1_val': 0.6644320496452956, 'auprc': 0.6644320496452956, 'loss_val': 0.1638111091176978, 'psi': 0.6644320496452956}-{'f1_val': 0.4987455822367085, 'auprc': 0.4987455822367085, 'loss_val': 0.3148915311750583, 'psi': 0.4987455822367085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=41 head_norm_before_train=3.630590 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.209325199362453, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.174426829212031, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=3.417592 cos_to_last_merge=0.9745 (last merge round=2)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.461802537463517, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.4053936750189155, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=3.716332 cos_to_last_merge=0.9745 (last merge round=2)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.27704939743080387, 'auprc': 0.27704939743080387, 'loss_val': 3.378801293268799, 'psi': 0.27704939743080387}-{'f1_val': 0.2771044440029141, 'auprc': 0.2771044440029141, 'loss_val': 3.3557333956129733, 'psi': 0.2771044440029141}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=3.708561 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.30433546552949536, 'auprc': 0.30433546552949536, 'loss_val': 5.027819945196019, 'psi': 0.30433546552949536}-{'f1_val': 0.3045952482572201, 'auprc': 0.3045952482572201, 'loss_val': 4.990609642093859, 'psi': 0.3045952482572201}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=4.034692 cos_to_last_merge=0.9536 (last merge round=1)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.5105048984927865, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.462174237767104, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=3.378067 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.53899460281861, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.515499414713204, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=3.636896 (no previous merge yet)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6115150908769027, 'auprc': 0.6115150908769027, 'loss_val': 0.9029922317261163, 'psi': 0.6115150908769027}-{'f1_val': 0.611752735925089, 'auprc': 0.611752735925089, 'loss_val': 0.89829854670076, 'psi': 0.611752735925089}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=3.467951 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.1728952772073922, 'auprc': 0.1728952772073922, 'loss_val': 8.212355436725446, 'psi': 0.1728952772073922}-{'f1_val': 0.17279386595467927, 'auprc': 0.17279386595467927, 'loss_val': 8.13578743653855, 'psi': 0.17279386595467927}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=3.849078 (no previous merge yet)
[S17] round=41 local utility u=0.001812 metrics={'f1_val': 0.9744479138741822, 'auprc': 0.9744479138741822, 'loss_val': 0.17455437490478512, 'psi': 0.9744479138741822}-{'f1_val': 0.9741686227383506, 'auprc': 0.9741686227383506, 'loss_val': 0.17566391978547397, 'psi': 0.9741686227383506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=42 head_norm_before_train=3.064889 cos_to_last_merge=0.9593 (last merge round=1)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.335448900538469, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.302742501890723, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=3.599494 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.23215831787260358, 'auprc': 0.23215831787260358, 'loss_val': 6.383281441383596, 'psi': 0.23215831787260358}-{'f1_val': 0.23199703043801037, 'auprc': 0.23199703043801037, 'loss_val': 6.332985913196016, 'psi': 0.23199703043801034}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=4.553232 cos_to_last_merge=0.8785 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.879
[S4] round=42 local utility u=0.021487 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.8652439846325835, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.9082178965581806, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=42 head_norm_before_train=4.589564 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.162081795117722, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.0839592364137465, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=3.123147 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.13541469053227, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.057638443446816, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=5.692397 (no previous merge yet)
[S7] round=42 local utility u=0.003025 metrics={'f1_val': 0.6640127793056542, 'auprc': 0.6640127793056542, 'loss_val': 0.15398701511044297, 'psi': 0.6640127793056542}-{'f1_val': 0.6644320496452956, 'auprc': 0.6644320496452956, 'loss_val': 0.1638111091176978, 'psi': 0.6644320496452956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=42 head_norm_before_train=3.649627 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.244026565210727, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.209325199362453, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=3.442406 cos_to_last_merge=0.9738 (last merge round=2)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.518588914424986, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.461802537463517, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=3.735650 cos_to_last_merge=0.9740 (last merge round=2)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.27699437272426347, 'auprc': 0.27699437272426347, 'loss_val': 3.401890094599513, 'psi': 0.27699437272426347}-{'f1_val': 0.27704939743080387, 'auprc': 0.27704939743080387, 'loss_val': 3.378801293268799, 'psi': 0.27704939743080387}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=3.737198 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3037525714691069, 'auprc': 0.3037525714691069, 'loss_val': 5.064256879537656, 'psi': 0.3037525714691069}-{'f1_val': 0.30433546552949536, 'auprc': 0.30433546552949536, 'loss_val': 5.027819945196019, 'psi': 0.30433546552949536}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=4.055929 cos_to_last_merge=0.9532 (last merge round=1)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.5506302828883824, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.5105048984927865, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=3.403888 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539149931148744, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.53899460281861, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=3.656145 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.6110408310336292, 'auprc': 0.6110408310336292, 'loss_val': 0.9078494017933462, 'psi': 0.6110408310336292}-{'f1_val': 0.6115150908769027, 'auprc': 0.6115150908769027, 'loss_val': 0.9029922317261163, 'psi': 0.6115150908769027}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=3.495100 (no previous merge yet)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.1735028712059065, 'auprc': 0.1735028712059065, 'loss_val': 8.286402160700682, 'psi': 0.1735028712059065}-{'f1_val': 0.1728952772073922, 'auprc': 0.1728952772073922, 'loss_val': 8.212355436725446, 'psi': 0.1728952772073922}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=3.865102 (no previous merge yet)
[S17] round=42 local utility u=0.000988 metrics={'f1_val': 0.9747272335275384, 'auprc': 0.9747272335275384, 'loss_val': 0.17509217295640592, 'psi': 0.9747272335275385}-{'f1_val': 0.9744479138741822, 'auprc': 0.9744479138741822, 'loss_val': 0.17455437490478512, 'psi': 0.9744479138741822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=43 head_norm_before_train=3.080382 cos_to_last_merge=0.9586 (last merge round=1)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.367800314269607, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.335448900538469, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=3.626388 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.23215831787260358, 'auprc': 0.23215831787260358, 'loss_val': 6.433634732051903, 'psi': 0.23215831787260358}-{'f1_val': 0.23215831787260358, 'auprc': 0.23215831787260358, 'loss_val': 6.383281441383596, 'psi': 0.23215831787260358}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=4.593529 cos_to_last_merge=0.8794 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.879
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.8698733429018253, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.8652439846325835, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=4.622783 (no previous merge yet)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.216181167472534, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.162081795117722, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=3.139343 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.215343338852866, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.13541469053227, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=5.697607 (no previous merge yet)
[S7] round=43 local utility u=0.018534 metrics={'f1_val': 0.6651841027540183, 'auprc': 0.6651841027540183, 'loss_val': 0.12746022835044807, 'psi': 0.6651841027540183}-{'f1_val': 0.6640127793056542, 'auprc': 0.6640127793056542, 'loss_val': 0.15398701511044297, 'psi': 0.6640127793056542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=43 head_norm_before_train=3.668689 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.279135517423355, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.244026565210727, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=3.468861 cos_to_last_merge=0.9732 (last merge round=2)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.574338574293013, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.518588914424986, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=3.754918 cos_to_last_merge=0.9735 (last merge round=2)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.2768843888558004, 'auprc': 0.2768843888558004, 'loss_val': 3.42490802536076, 'psi': 0.2768843888558004}-{'f1_val': 0.27699437272426347, 'auprc': 0.27699437272426347, 'loss_val': 3.401890094599513, 'psi': 0.27699437272426347}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=3.766005 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.30368794326241133, 'auprc': 0.30368794326241133, 'loss_val': 5.104624732458876, 'psi': 0.30368794326241133}-{'f1_val': 0.3037525714691069, 'auprc': 0.3037525714691069, 'loss_val': 5.064256879537656, 'psi': 0.3037525714691069}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=4.076794 cos_to_last_merge=0.9529 (last merge round=1)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.5890572569053045, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.5506302828883824, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=3.430639 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539301234015625, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539149931148744, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=3.675402 (no previous merge yet)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6106466602954743, 'auprc': 0.6106466602954743, 'loss_val': 0.9128803258044812, 'psi': 0.6106466602954743}-{'f1_val': 0.6110408310336292, 'auprc': 0.6110408310336292, 'loss_val': 0.9078494017933462, 'psi': 0.6110408310336292}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=3.522587 (no previous merge yet)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.1735028712059065, 'auprc': 0.1735028712059065, 'loss_val': 8.36378922467482, 'psi': 0.1735028712059065}-{'f1_val': 0.1735028712059065, 'auprc': 0.1735028712059065, 'loss_val': 8.286402160700682, 'psi': 0.1735028712059065}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=3.881019 (no previous merge yet)
[S17] round=43 local utility u=0.002389 metrics={'f1_val': 0.9750065818341378, 'auprc': 0.9750065818341378, 'loss_val': 0.17282764508985687, 'psi': 0.9750065818341378}-{'f1_val': 0.9747272335275384, 'auprc': 0.9747272335275384, 'loss_val': 0.17509217295640592, 'psi': 0.9747272335275385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=44 head_norm_before_train=3.095813 cos_to_last_merge=0.9578 (last merge round=1)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.40027201794497, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.367800314269607, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=3.653283 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.23215831787260358, 'auprc': 0.23215831787260358, 'loss_val': 6.484514879374195, 'psi': 0.23215831787260358}-{'f1_val': 0.23215831787260358, 'auprc': 0.23215831787260358, 'loss_val': 6.433634732051903, 'psi': 0.23215831787260358}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=4.628232 cos_to_last_merge=0.8795 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.880
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.895142426140991, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.8698733429018253, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=4.656219 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.273865871650306, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.216181167472534, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=3.155524 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.293115544611764, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.215343338852866, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=5.777947 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6650172715767273, 'auprc': 0.6650172715767273, 'loss_val': 0.2268428514819135, 'psi': 0.6650172715767273}-{'f1_val': 0.6651841027540183, 'auprc': 0.6651841027540183, 'loss_val': 0.12746022835044807, 'psi': 0.6651841027540183}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=3.687760 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.31441842501146, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.279135517423355, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=3.496503 cos_to_last_merge=0.9725 (last merge round=2)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.62826505015587, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.574338574293013, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=3.774145 cos_to_last_merge=0.9730 (last merge round=2)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.2768843888558004, 'auprc': 0.2768843888558004, 'loss_val': 3.4477104543523405, 'psi': 0.2768843888558004}-{'f1_val': 0.2768843888558004, 'auprc': 0.2768843888558004, 'loss_val': 3.42490802536076, 'psi': 0.2768843888558004}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=3.795305 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.30323631470859, 'auprc': 0.30323631470859, 'loss_val': 5.139858155529696, 'psi': 0.30323631470859}-{'f1_val': 0.30368794326241133, 'auprc': 0.30368794326241133, 'loss_val': 5.104624732458876, 'psi': 0.30368794326241133}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=4.097507 cos_to_last_merge=0.9525 (last merge round=1)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.632313402301084, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.5890572569053045, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=3.456267 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539447076707564, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539301234015625, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=3.694474 (no previous merge yet)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6100179556021464, 'auprc': 0.6100179556021464, 'loss_val': 0.9178025385976187, 'psi': 0.6100179556021464}-{'f1_val': 0.6106466602954743, 'auprc': 0.6106466602954743, 'loss_val': 0.9128803258044812, 'psi': 0.6106466602954743}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=3.550775 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.1735028712059065, 'auprc': 0.1735028712059065, 'loss_val': 8.44542284593237, 'psi': 0.1735028712059065}-{'f1_val': 0.1735028712059065, 'auprc': 0.1735028712059065, 'loss_val': 8.36378922467482, 'psi': 0.1735028712059065}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=3.897441 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.9750065818341378, 'auprc': 0.9750065818341378, 'loss_val': 0.17473602671002222, 'psi': 0.9750065818341378}-{'f1_val': 0.9750065818341378, 'auprc': 0.9750065818341378, 'loss_val': 0.17282764508985687, 'psi': 0.9750065818341378}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=3.111227 cos_to_last_merge=0.9571 (last merge round=1)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.432690546379112, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.40027201794497, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=3.681002 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.23223891671304023, 'auprc': 0.23223891671304023, 'loss_val': 6.5363682492346, 'psi': 0.23223891671304023}-{'f1_val': 0.23215831787260358, 'auprc': 0.23215831787260358, 'loss_val': 6.484514879374195, 'psi': 0.23215831787260358}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=4.655566 cos_to_last_merge=0.8794 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.879
[S4] round=45 local utility u=0.012080 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.870981773527432, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.895142426140991, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=45 head_norm_before_train=4.689784 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.331561991023731, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.273865871650306, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=3.171706 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.371132221882768, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.293115544611764, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=5.823870 (no previous merge yet)
[S7] round=45 local utility u=0.020566 metrics={'f1_val': 0.6649337935668381, 'auprc': 0.6649337935668381, 'loss_val': 0.1849598716292584, 'psi': 0.6649337935668381}-{'f1_val': 0.6650172715767273, 'auprc': 0.6650172715767273, 'loss_val': 0.2268428514819135, 'psi': 0.6650172715767273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=45 head_norm_before_train=3.706720 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.34931002130766, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.31441842501146, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=3.521322 cos_to_last_merge=0.9718 (last merge round=2)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638373393095, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.62826505015587, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=3.793187 cos_to_last_merge=0.9725 (last merge round=2)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.2768294296678576, 'auprc': 0.2768294296678576, 'loss_val': 3.470442005190453, 'psi': 0.2768294296678576}-{'f1_val': 0.2768843888558004, 'auprc': 0.2768843888558004, 'loss_val': 3.4477104543523405, 'psi': 0.2768843888558004}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=3.824596 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.3027218098267939, 'auprc': 0.3027218098267939, 'loss_val': 5.175880560658415, 'psi': 0.3027218098267939}-{'f1_val': 0.30323631470859, 'auprc': 0.30323631470859, 'loss_val': 5.139858155529696, 'psi': 0.30323631470859}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=4.118065 cos_to_last_merge=0.9521 (last merge round=1)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.671366927283879, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.632313402301084, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=3.481746 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539576527987151, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539447076707564, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=3.713620 (no previous merge yet)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6095480097719803, 'auprc': 0.6095480097719803, 'loss_val': 0.9230607866279467, 'psi': 0.6095480097719803}-{'f1_val': 0.6100179556021464, 'auprc': 0.6100179556021464, 'loss_val': 0.9178025385976187, 'psi': 0.6100179556021464}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=3.578341 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.17360399152484451, 'auprc': 0.17360399152484451, 'loss_val': 8.519173567868483, 'psi': 0.17360399152484451}-{'f1_val': 0.1735028712059065, 'auprc': 0.1735028712059065, 'loss_val': 8.44542284593237, 'psi': 0.1735028712059065}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=3.913373 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.9750065818341378, 'auprc': 0.9750065818341378, 'loss_val': 0.17616007923095697, 'psi': 0.9750065818341378}-{'f1_val': 0.9750065818341378, 'auprc': 0.9750065818341378, 'loss_val': 0.17473602671002222, 'psi': 0.9750065818341378}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=3.126621 cos_to_last_merge=0.9563 (last merge round=1)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.464047261909244, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.432690546379112, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=3.708551 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.23223891671304023, 'auprc': 0.23223891671304023, 'loss_val': 6.58697746487337, 'psi': 0.23223891671304023}-{'f1_val': 0.23223891671304023, 'auprc': 0.23223891671304023, 'loss_val': 6.5363682492346, 'psi': 0.23223891671304023}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=4.683613 cos_to_last_merge=0.8793 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.879
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.24309664694280078, 'auprc': 0.24309664694280078, 'loss_val': 3.6309310847175857, 'psi': 0.24309664694280078}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.870981773527432, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=4.723691 (no previous merge yet)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.390903743588541, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.331561991023731, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=3.187873 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.448506626216362, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.371132221882768, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=5.907400 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6657667042900423, 'auprc': 0.6657667042900423, 'loss_val': 0.32739499936157396, 'psi': 0.6657667042900423}-{'f1_val': 0.6649337935668381, 'auprc': 0.6649337935668381, 'loss_val': 0.1849598716292584, 'psi': 0.6649337935668381}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=3.725688 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.384933223219851, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.34931002130766, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=3.547412 cos_to_last_merge=0.9712 (last merge round=2)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638316269864, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638373393095, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=3.812247 cos_to_last_merge=0.9720 (last merge round=2)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.2767744922934445, 'auprc': 0.2767744922934445, 'loss_val': 3.492850208333502, 'psi': 0.2767744922934445}-{'f1_val': 0.2768294296678576, 'auprc': 0.2768294296678576, 'loss_val': 3.470442005190453, 'psi': 0.2768294296678576}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=3.853455 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.3025934562928415, 'auprc': 0.3025934562928415, 'loss_val': 5.2165938875480276, 'psi': 0.3025934562928415}-{'f1_val': 0.3027218098267939, 'auprc': 0.3027218098267939, 'loss_val': 5.175880560658415, 'psi': 0.3027218098267939}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=4.138393 cos_to_last_merge=0.9518 (last merge round=1)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.7094329635173593, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.671366927283879, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=3.504126 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539700482477791, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539576527987151, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=3.732620 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6094698168835717, 'auprc': 0.6094698168835717, 'loss_val': 0.9280107820352228, 'psi': 0.6094698168835717}-{'f1_val': 0.6095480097719803, 'auprc': 0.6095480097719803, 'loss_val': 0.9230607866279467, 'psi': 0.6095480097719803}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=3.605738 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.1739071038251366, 'auprc': 0.1739071038251366, 'loss_val': 8.585481407014523, 'psi': 0.1739071038251366}-{'f1_val': 0.17360399152484451, 'auprc': 0.17360399152484451, 'loss_val': 8.519173567868483, 'psi': 0.17360399152484451}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=3.929964 (no previous merge yet)
[S17] round=46 local utility u=0.001117 metrics={'f1_val': 0.9752859589297571, 'auprc': 0.9752859589297571, 'loss_val': 0.1764403040517854, 'psi': 0.9752859589297571}-{'f1_val': 0.9750065818341378, 'auprc': 0.9750065818341378, 'loss_val': 0.17616007923095697, 'psi': 0.9750065818341378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=47 head_norm_before_train=3.141838 cos_to_last_merge=0.9556 (last merge round=1)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.496283239082635, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.464047261909244, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=3.735757 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.23223891671304023, 'auprc': 0.23223891671304023, 'loss_val': 6.629961840224092, 'psi': 0.23223891671304023}-{'f1_val': 0.23223891671304023, 'auprc': 0.23223891671304023, 'loss_val': 6.58697746487337, 'psi': 0.23223891671304023}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=4.635681 cos_to_last_merge=0.8805 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.880
[S4] round=47 local utility u=0.148570 metrics={'f1_val': 0.2428272380248738, 'auprc': 0.2428272380248738, 'loss_val': 3.3313671751114766, 'psi': 0.2428272380248738}-{'f1_val': 0.24309664694280078, 'auprc': 0.24309664694280078, 'loss_val': 3.6309310847175857, 'psi': 0.24309664694280078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=47 head_norm_before_train=4.757653 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.447683207263812, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.390903743588541, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=3.204065 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.522881449984439, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.448506626216362, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=5.963930 (no previous merge yet)
[S7] round=47 local utility u=0.010781 metrics={'f1_val': 0.6649337935668381, 'auprc': 0.6649337935668381, 'loss_val': 0.298336671541609, 'psi': 0.6649337935668381}-{'f1_val': 0.6657667042900423, 'auprc': 0.6657667042900423, 'loss_val': 0.32739499936157396, 'psi': 0.6657667042900423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=47 head_norm_before_train=3.744609 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.4194148310960655, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.384933223219851, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=3.572172 cos_to_last_merge=0.9705 (last merge round=2)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638303779362, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638316269864, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=3.831074 cos_to_last_merge=0.9714 (last merge round=2)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.27671957671957675, 'auprc': 0.27671957671957675, 'loss_val': 3.5151694271398104, 'psi': 0.27671957671957675}-{'f1_val': 0.2767744922934445, 'auprc': 0.2767744922934445, 'loss_val': 3.492850208333502, 'psi': 0.2767744922934445}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=3.882806 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.3020811287477954, 'auprc': 0.3020811287477954, 'loss_val': 5.252773961150356, 'psi': 0.3020811287477954}-{'f1_val': 0.3025934562928415, 'auprc': 0.3025934562928415, 'loss_val': 5.2165938875480276, 'psi': 0.3025934562928415}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=4.158522 cos_to_last_merge=0.9514 (last merge round=1)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.7501087731523657, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.7094329635173593, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=3.526007 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539800832124822, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539700482477791, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=3.751479 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.60900144559939, 'auprc': 0.60900144559939, 'loss_val': 0.9333592743369593, 'psi': 0.60900144559939}-{'f1_val': 0.6094698168835717, 'auprc': 0.6094698168835717, 'loss_val': 0.9280107820352228, 'psi': 0.6094698168835717}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=3.633295 (no previous merge yet)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.1744114636642784, 'auprc': 0.1744114636642784, 'loss_val': 8.647717594921929, 'psi': 0.1744114636642784}-{'f1_val': 0.1739071038251366, 'auprc': 0.1739071038251366, 'loss_val': 8.585481407014523, 'psi': 0.1739071038251366}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=3.945817 (no previous merge yet)
[S17] round=47 local utility u=0.001346 metrics={'f1_val': 0.9755653649502324, 'auprc': 0.9755653649502324, 'loss_val': 0.17626355452790052, 'psi': 0.9755653649502324}-{'f1_val': 0.9752859589297571, 'auprc': 0.9752859589297571, 'loss_val': 0.1764403040517854, 'psi': 0.9752859589297571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=48 head_norm_before_train=3.157202 cos_to_last_merge=0.9549 (last merge round=1)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.527834355406106, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.496283239082635, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=3.762057 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.23231948565776459, 'auprc': 0.23231948565776459, 'loss_val': 6.6666563824937555, 'psi': 0.23231948565776456}-{'f1_val': 0.23223891671304023, 'auprc': 0.23223891671304023, 'loss_val': 6.629961840224092, 'psi': 0.23223891671304023}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=4.781427 cos_to_last_merge=0.8636 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.864
[S4] round=48 local utility u=0.009302 metrics={'f1_val': 0.24246895364564122, 'auprc': 0.24246895364564122, 'loss_val': 3.309539015444503, 'psi': 0.2424689536456412}-{'f1_val': 0.2428272380248738, 'auprc': 0.2428272380248738, 'loss_val': 3.3313671751114766, 'psi': 0.2428272380248738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=48 head_norm_before_train=4.791542 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.5051634833019945, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.447683207263812, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=3.220108 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.606644567724672, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.522881449984439, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=6.026285 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.4454108415924978, 'auprc': 0.4454108415924978, 'loss_val': 0.3935288464572346, 'psi': 0.4454108415924978}-{'f1_val': 0.6649337935668381, 'auprc': 0.6649337935668381, 'loss_val': 0.298336671541609, 'psi': 0.6649337935668381}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=3.763444 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.453915595010625, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.4194148310960655, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=3.595421 cos_to_last_merge=0.9699 (last merge round=2)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638234565334, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638303779362, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=3.849873 cos_to_last_merge=0.9709 (last merge round=2)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.27666468293328045, 'auprc': 0.27666468293328045, 'loss_val': 3.537497215626981, 'psi': 0.27666468293328045}-{'f1_val': 0.27671957671957675, 'auprc': 0.27671957671957675, 'loss_val': 3.5151694271398104, 'psi': 0.27671957671957675}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=3.911012 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.30093471080188344, 'auprc': 0.30093471080188344, 'loss_val': 5.281661137738939, 'psi': 0.30093471080188344}-{'f1_val': 0.3020811287477954, 'auprc': 0.3020811287477954, 'loss_val': 5.252773961150356, 'psi': 0.3020811287477954}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=4.178585 cos_to_last_merge=0.9511 (last merge round=1)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.7864068588849222, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.7501087731523657, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=3.546283 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539831937006516, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539800832124822, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=3.770239 (no previous merge yet)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.608689944722998, 'auprc': 0.608689944722998, 'loss_val': 0.9386275550641627, 'psi': 0.608689944722998}-{'f1_val': 0.60900144559939, 'auprc': 0.60900144559939, 'loss_val': 0.9333592743369593, 'psi': 0.60900144559939}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=3.658908 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.17451221176149542, 'auprc': 0.17451221176149542, 'loss_val': 8.712116535740334, 'psi': 0.17451221176149542}-{'f1_val': 0.1744114636642784, 'auprc': 0.1744114636642784, 'loss_val': 8.647717594921929, 'psi': 0.1744114636642784}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=3.961779 (no previous merge yet)
[S17] round=48 local utility u=0.000433 metrics={'f1_val': 0.9755653649502324, 'auprc': 0.9755653649502324, 'loss_val': 0.17539773947594564, 'psi': 0.9755653649502324}-{'f1_val': 0.9755653649502324, 'auprc': 0.9755653649502324, 'loss_val': 0.17626355452790052, 'psi': 0.9755653649502324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=49 head_norm_before_train=3.172471 cos_to_last_merge=0.9542 (last merge round=1)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.559397175302057, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.527834355406106, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=3.787660 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.2324805339265851, 'auprc': 0.2324805339265851, 'loss_val': 6.692581877906317, 'psi': 0.23248053392658508}-{'f1_val': 0.23231948565776459, 'auprc': 0.23231948565776459, 'loss_val': 6.6666563824937555, 'psi': 0.23231948565776456}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=4.853848 cos_to_last_merge=0.8620 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.862
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.2423795476892822, 'auprc': 0.2423795476892822, 'loss_val': 3.310095519333142, 'psi': 0.2423795476892822}-{'f1_val': 0.24246895364564122, 'auprc': 0.24246895364564122, 'loss_val': 3.309539015444503, 'psi': 0.2424689536456412}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=4.825298 (no previous merge yet)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.558375585769525, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 4.5051634833019945, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=3.236049 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.68343370866127, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 13.606644567724672, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=6.085469 (no previous merge yet)
[S7] round=49 local utility u=1.000000 metrics={'f1_val': 0.6645157780577774, 'auprc': 0.6645157780577774, 'loss_val': 0.25977165094745946, 'psi': 0.6645157780577774}-{'f1_val': 0.4454108415924978, 'auprc': 0.4454108415924978, 'loss_val': 0.3935288464572346, 'psi': 0.4454108415924978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=49 head_norm_before_train=3.782192 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.488161734106016, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.453915595010625, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=3.618840 cos_to_last_merge=0.9693 (last merge round=2)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638234165639, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638234565334, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=3.868646 cos_to_last_merge=0.9704 (last merge round=2)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.27666468293328045, 'auprc': 0.27666468293328045, 'loss_val': 3.5600316503930363, 'psi': 0.27666468293328045}-{'f1_val': 0.27666468293328045, 'auprc': 0.27666468293328045, 'loss_val': 3.537497215626981, 'psi': 0.27666468293328045}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=3.938186 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.29973400531989364, 'auprc': 0.29973400531989364, 'loss_val': 5.31384138397481, 'psi': 0.29973400531989364}-{'f1_val': 0.30093471080188344, 'auprc': 0.30093471080188344, 'loss_val': 5.281661137738939, 'psi': 0.30093471080188344}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=4.198462 cos_to_last_merge=0.9507 (last merge round=1)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.82476118130333, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.7864068588849222, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=3.564309 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539880118317695, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 13.539831937006516, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=3.789044 (no previous merge yet)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6083790391660068, 'auprc': 0.6083790391660068, 'loss_val': 0.9441293009761236, 'psi': 0.6083790391660068}-{'f1_val': 0.608689944722998, 'auprc': 0.608689944722998, 'loss_val': 0.9386275550641627, 'psi': 0.608689944722998}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=3.684438 (no previous merge yet)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.17571798012794337, 'auprc': 0.17571798012794337, 'loss_val': 8.761443692530412, 'psi': 0.17571798012794337}-{'f1_val': 0.17451221176149542, 'auprc': 0.17451221176149542, 'loss_val': 8.712116535740334, 'psi': 0.17451221176149542}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=3.977820 (no previous merge yet)
[S17] round=49 local utility u=0.002592 metrics={'f1_val': 0.9761242643093877, 'auprc': 0.9761242643093877, 'loss_val': 0.17524392644793296, 'psi': 0.9761242643093877}-{'f1_val': 0.9755653649502324, 'auprc': 0.9755653649502324, 'loss_val': 0.17539773947594564, 'psi': 0.9755653649502324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
