[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:63503
[S3] → join 127.0.0.1:63502
[S4] → join 127.0.0.1:63502
[S5] → join 127.0.0.1:63502
[S6] → join 127.0.0.1:63502
[S7] → join 127.0.0.1:63502
[S8] → join 127.0.0.1:63502
[S9] → join 127.0.0.1:63502
[S10] → join 127.0.0.1:63502
[S11] → join 127.0.0.1:63502
[S13] → join 127.0.0.1:63502
[S14] → join 127.0.0.1:63502
[S15] → join 127.0.0.1:63502
[S16] → join 127.0.0.1:63502
[S17] → join 127.0.0.1:63502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.155434 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.165957 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.206327 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.164733 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.152831 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.210187 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.068075 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.184461 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.184525 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.151813 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.152098 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.156035 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.147125 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.173728 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.174415 (no previous merge yet)
[S4]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S3] + discovered S11
[S3] + discovered S17
[S3] + discovered S16
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S8
[S3] + discovered S9
[S3] + discovered S4
[S4] + discovered S3
[S3] + discovered S7
[S4] + discovered S2
[S3] + discovered S5
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S10
[S4] + discovered S7
[S4] + discovered S14
[S4] + discovered S17
[S4] + discovered S5
[S4] + discovered S9
[S4] + discovered S11
[S4] + discovered S10
[S4] + discovered S8
[S4] + discovered S15
[S4] + discovered S13
[S5] + discovered S2
[S5] + discovered S4
[S4] + discovered S16
[S4] + discovered S6
[S5] + discovered S3
[S5] + discovered S11
[S5] + discovered S7
[S5] + discovered S16
[S5] + discovered S9
[S5] + discovered S14
[S6] + discovered S5
[S6] + discovered S4
[S5] + discovered S15
[S5] + discovered S6
[S6] + discovered S3
[S6] + discovered S2
[S5] + discovered S10
[S5] + discovered S17
[S5] + discovered S13
[S5] + discovered S8
[S6] + discovered S14
[S6] + discovered S7
[S6] + discovered S13
[S7] + discovered S5
[S6] + discovered S10
[S6] + discovered S17
[S7] + discovered S2
[S7] + discovered S3
[S7] + discovered S6
[S6] + discovered S9
[S7] + discovered S4
[S6] + discovered S15
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S16
[S8] + discovered S5
[S7] + discovered S15
[S8] + discovered S6
[S7] + discovered S16
[S8] + discovered S7
[S7] + discovered S17
[S7] + discovered S13
[S7] + discovered S10
[S7] + discovered S11
[S8] + discovered S2
[S7] + discovered S14
[S7] + discovered S8
[S7] + discovered S9
[S8] + discovered S3
[S8] + discovered S4
[S9] + discovered S4
[S8] + discovered S15
[S9] + discovered S6
[S9] + discovered S8
[S9] + discovered S2
[S8] + discovered S13
[S8] + discovered S14
[S9] + discovered S7
[S8] + discovered S9
[S9] + discovered S5
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S10
[S9] + discovered S3
[S8] + discovered S16
[S10] + discovered S6
[S10] + discovered S7
[S10] + discovered S9
[S9] + discovered S15
[S9] + discovered S11
[S10] + discovered S4
[S9] + discovered S17
[S10] + discovered S8
[S9] + discovered S14
[S9] + discovered S16
[S9] + discovered S10
[S10] + discovered S3
[S10] + discovered S5
[S9] + discovered S13
[S10] + discovered S2
[S11] + discovered S10
[S11] + discovered S4
[S10] + discovered S13
[S11] + discovered S9
[S10] + discovered S17
[S10] + discovered S15
[S11] + discovered S3
[S11] + discovered S7
[S11] + discovered S5
[S11] + discovered S8
[S11] + discovered S6
[S10] + discovered S14
[S11] + discovered S2
[S10] + discovered S11
[S10] + discovered S16
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S5
[S11] + discovered S13
[S13] + discovered S3
[S13] + discovered S7
[S13] + discovered S11
[S13] + discovered S2
[S13] + discovered S10
[S11] + discovered S14
[S11] + discovered S16
[S13] + discovered S9
[S13] + discovered S4
[S11] + discovered S17
[S11] + discovered S15
[S14] + discovered S2
[S13] + discovered S14
[S14] + discovered S8
[S14] + discovered S13
[S14] + discovered S7
[S13] + discovered S15
[S14] + discovered S10
[S14] + discovered S11
[S13] + discovered S16
[S14] + discovered S3
[S14] + discovered S9
[S13] + discovered S17
[S14] + discovered S5
[S14] + discovered S4
[S14] + discovered S6
[S14] + discovered S16
[S15] + discovered S5
[S14] + discovered S17
[S15] + discovered S2
[S15] + discovered S10
[S15] + discovered S6
[S14] + discovered S15
[S15] + discovered S8
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S7
[S15] + discovered S9
[S15] + discovered S13
[S15] + discovered S11
[S15] + discovered S14
[S16] + discovered S7
[S15] + discovered S17
[S16] + discovered S11
[S16] + discovered S6
[S16] + discovered S15
[S15] + discovered S16
[S16] + discovered S9
[S16] + discovered S4
[S16] + discovered S2
[S16] + discovered S3
[S16] + discovered S5
[S16] + discovered S13
[S16] + discovered S8
[S16] + discovered S10
[S16] + discovered S14
[S17] + discovered S16
[S17] + discovered S8
[S17] + discovered S14
[S17] + discovered S10
[S17] + discovered S7
[S17] + discovered S13
[S17] + discovered S3
[S17] + discovered S11
[S17] + discovered S5
[S16] + discovered S17
[S17] + discovered S4
[S17] + discovered S15
[S17] + discovered S9
[S17] + discovered S2
[S17] + discovered S6
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S13] ⇄ pheromone p=1.000 → S8@127.0.0.1:63509
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:63507
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:63509
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:63505
[S10] ⇄ pheromone p=1.000 → S17@127.0.0.1:63517
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:63516
[S15] ⇄ pheromone p=1.000 → S4@127.0.0.1:63504
[S5] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:63517
[S4] ⇄ pheromone p=1.000 → S16@127.0.0.1:63516
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:63508
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S2] ⇄ pheromone p=1.000 → S14@127.0.0.1:63514
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:63513
[S2] START round=1 head_norm_before_train=1.798175 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.3503083895853942, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.0454115217743842, 'psi': 0.3674775928297055}
[S3] START round=1 head_norm_before_train=1.979843 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.2637823664372337, 'auprc': 0.2637823664372337, 'loss_val': 3.4062635676663002, 'psi': 0.2637823664372337}-{'f1_val': 0.27805417357656165, 'auprc': 0.27805417357656165, 'loss_val': 3.1143311931499515, 'psi': 0.27805417357656165}
[S4] START round=1 head_norm_before_train=1.968453 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.6225672173779657, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.407186702459396, 'psi': 0.3567939207526687}
[S5] START round=1 head_norm_before_train=2.026977 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7709552769477006, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.456307965507897, 'psi': 0.3335071121394324}
[S6] START round=1 head_norm_before_train=1.802701 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.07315079689415611, 'auprc': 0.07315079689415611, 'loss_val': 7.399777524959089, 'psi': 0.07315079689415611}-{'f1_val': 0.061686949223667645, 'auprc': 0.061686949223667645, 'loss_val': 6.62626401695376, 'psi': 0.061686949223667645}
[S7] START round=1 head_norm_before_train=1.995026 (no previous merge yet)
[S7] round=1 local utility u=0.844406 metrics={'f1_val': 0.3921487059525984, 'auprc': 0.3921487059525984, 'loss_val': 0.5484965968330162, 'psi': 0.3921487059525984}-{'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 0.8624235644096703, 'psi': 0.23938362300662963}
[S8] START round=1 head_norm_before_train=1.859194 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.588481399448521, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.881607152912806, 'psi': 0.35939447907390915}
[S9] START round=1 head_norm_before_train=1.910090 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.4255894678090812, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9950943746376018, 'psi': 0.36867172340800847}
[S10] START round=1 head_norm_before_train=1.856844 (no previous merge yet)
[S10] round=1 local utility u=0.402350 metrics={'f1_val': 0.2494033412887828, 'auprc': 0.2494033412887828, 'loss_val': 1.7298687852002428, 'psi': 0.24940334128878278}-{'f1_val': 0.24964166268514096, 'auprc': 0.24964166268514096, 'loss_val': 2.536713926538794, 'psi': 0.24964166268514096}
[S11] START round=1 head_norm_before_train=2.019372 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.29747011398387546, 'auprc': 0.29747011398387546, 'loss_val': 3.234766048554255, 'psi': 0.29747011398387546}-{'f1_val': 0.28095050544833927, 'auprc': 0.28095050544833927, 'loss_val': 2.7986532219208646, 'psi': 0.28095050544833927}
[S13] START round=1 head_norm_before_train=1.799253 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.642170220232095, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1182306719532897, 'psi': 0.3599362944611573}
[S14] START round=1 head_norm_before_train=1.983430 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 7.374066663873782, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.509237772399024, 'psi': 0.13592717296421}
[S15] START round=1 head_norm_before_train=1.844515 (no previous merge yet)
[S15] round=1 local utility u=0.045200 metrics={'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.4982095621932, 'psi': 0.6173065327346117}-{'f1_val': 0.6172494631641352, 'auprc': 0.6172494631641352, 'loss_val': 0.5880962466230187, 'psi': 0.6172494631641352}
[S16] START round=1 head_norm_before_train=1.919088 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.13947368421052633, 'auprc': 0.13947368421052633, 'loss_val': 5.021264311788482, 'psi': 0.13947368421052633}-{'f1_val': 0.12439831528279181, 'auprc': 0.12439831528279181, 'loss_val': 4.51638133058194, 'psi': 0.12439831528279181}
[S17] START round=1 head_norm_before_train=1.765901 (no previous merge yet)
[S17] round=1 local utility u=1.000000 metrics={'f1_val': 0.7431735594827598, 'auprc': 0.7431735594827598, 'loss_val': 0.7997726707228514, 'psi': 0.7431735594827598}-{'f1_val': 0.25264885148628485, 'auprc': 0.25264885148628485, 'loss_val': 0.8799730918508605, 'psi': 0.25264885148628485}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:63513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:63512
[S10] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.222428)
[S11] loaded HEAD from S15 (vec_in norm=2.222428)
[S11] cosine check vs S15: cos=-0.0543
[S11] DROPPED delta from S15 (cos=-0.0543 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.219140)
[S8] loaded HEAD from S10 (vec_in norm=2.219140)
[S8] cosine check vs S10: cos=-0.1323
[S8] DROPPED delta from S10 (cos=-0.1323 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=2.414963)
[S13] loaded HEAD from S7 (vec_in norm=2.414963)
[S13] cosine check vs S7: cos=0.0548
[S13] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:63503
[S17] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.197248)
[S3] loaded HEAD from S17 (vec_in norm=2.197248)
[S3] cosine check vs S17: cos=0.0213
[S3] BUFFERED delta from S17 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.2638 head_norm=2.160577
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.2638 head_norm=2.160577 delta_norm=0.000000
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.3599 head_norm=2.076296
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.3599 head_norm=2.076296 delta_norm=0.000000
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.984030 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.590751434254125, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.3503083895853942, 'psi': 0.3674775928297055}
[S3] START round=2 head_norm_before_train=2.160577 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.26466719284398843, 'auprc': 0.26466719284398843, 'loss_val': 3.6498226114791024, 'psi': 0.26466719284398843}-{'f1_val': 0.2637823664372337, 'auprc': 0.2637823664372337, 'loss_val': 3.4062635676663002, 'psi': 0.2637823664372337}
[S4] START round=2 head_norm_before_train=2.194858 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.6623884196636325, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.6225672173779657, 'psi': 0.3567939207526687}
[S5] START round=2 head_norm_before_train=2.438856 (no previous merge yet)
[S5] round=2 local utility u=0.408387 metrics={'f1_val': 0.24988280966978718, 'auprc': 0.24988280966978718, 'loss_val': 1.2015630425054444, 'psi': 0.24988280966978718}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7709552769477006, 'psi': 0.3335071121394324}
[S6] START round=2 head_norm_before_train=1.963866 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.06260469011725293, 'auprc': 0.06260469011725293, 'loss_val': 7.890712112187747, 'psi': 0.06260469011725293}-{'f1_val': 0.07315079689415611, 'auprc': 0.07315079689415611, 'loss_val': 7.399777524959089, 'psi': 0.07315079689415611}
[S7] START round=2 head_norm_before_train=2.414963 (no previous merge yet)
[S7] round=2 local utility u=1.000000 metrics={'f1_val': 0.6636554092885958, 'auprc': 0.6636554092885958, 'loss_val': 0.19026216708844407, 'psi': 0.6636554092885958}-{'f1_val': 0.3921487059525984, 'auprc': 0.3921487059525984, 'loss_val': 0.5484965968330162, 'psi': 0.3921487059525984}
[S8] START round=2 head_norm_before_train=2.170526 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0213567336999896, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.588481399448521, 'psi': 0.35939447907390915}
[S9] START round=2 head_norm_before_train=2.065531 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.666098443356574, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.4255894678090812, 'psi': 0.36867172340800847}
[S10] START round=2 head_norm_before_train=2.219140 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.24886931682932636, 'auprc': 0.24886931682932636, 'loss_val': 1.8515392378737687, 'psi': 0.2488693168293264}-{'f1_val': 0.2494033412887828, 'auprc': 0.2494033412887828, 'loss_val': 1.7298687852002428, 'psi': 0.24940334128878278}
[S11] START round=2 head_norm_before_train=2.218148 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.30111158013226397, 'auprc': 0.30111158013226397, 'loss_val': 3.4321477511288876, 'psi': 0.30111158013226397}-{'f1_val': 0.29747011398387546, 'auprc': 0.29747011398387546, 'loss_val': 3.234766048554255, 'psi': 0.29747011398387546}
[S13] START round=2 head_norm_before_train=2.076296 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0220393926773177, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.642170220232095, 'psi': 0.3599362944611573}
[S14] START round=2 head_norm_before_train=2.156871 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 7.8696183573201175, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 7.374066663873782, 'psi': 0.13587634006482174}
[S15] START round=2 head_norm_before_train=2.222428 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6570313518896693, 'psi': 0.6163342951580373}-{'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.4982095621932, 'psi': 0.6173065327346117}
[S16] START round=2 head_norm_before_train=2.129321 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.13606943218593703, 'auprc': 0.13606943218593703, 'loss_val': 5.305003193742272, 'psi': 0.13606943218593703}-{'f1_val': 0.13947368421052633, 'auprc': 0.13947368421052633, 'loss_val': 5.021264311788482, 'psi': 0.13947368421052633}
[S17] START round=2 head_norm_before_train=2.197248 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.7271305138341477, 'auprc': 0.7271305138341477, 'loss_val': 0.9892802938624717, 'psi': 0.7271305138341477}-{'f1_val': 0.7431735594827598, 'auprc': 0.7431735594827598, 'loss_val': 0.7997726707228514, 'psi': 0.7431735594827598}
[S2]  timeout peer S3
[S3]  timeout peer S2
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:63502
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:63513
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.559612)
[S13] loaded HEAD from S5 (vec_in norm=2.559612)
[S13] cosine check vs S5: cos=-0.1295
[S13] DROPPED delta from S5 (cos=-0.1295 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=2.546610)
[S2] loaded HEAD from S7 (vec_in norm=2.546610)
[S2] cosine check vs S7: cos=0.0665
[S2] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.3675 head_norm=2.095571
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.3675 head_norm=2.095571 delta_norm=0.000000
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=2.095571 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.7490130779067377, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.590751434254125, 'psi': 0.3674775928297055}
[S3] START round=3 head_norm_before_train=2.303793 cos_to_last_merge=0.9988 (last merge round=1)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.26435422414925763, 'auprc': 0.26435422414925763, 'loss_val': 3.8474630420038993, 'psi': 0.26435422414925763}-{'f1_val': 0.26466719284398843, 'auprc': 0.26466719284398843, 'loss_val': 3.6498226114791024, 'psi': 0.26466719284398843}
[S4] START round=3 head_norm_before_train=2.301633 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.7032492906453862, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.6623884196636325, 'psi': 0.3567939207526687}
[S5] START round=3 head_norm_before_train=2.559612 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.029900799122038, 'psi': 0.3335071121394324}-{'f1_val': 0.24988280966978718, 'auprc': 0.24988280966978718, 'loss_val': 1.2015630425054444, 'psi': 0.24988280966978718}
[S6] START round=3 head_norm_before_train=2.060700 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.07933950865888038, 'auprc': 0.07933950865888038, 'loss_val': 8.18830248965541, 'psi': 0.07933950865888038}-{'f1_val': 0.06260469011725293, 'auprc': 0.06260469011725293, 'loss_val': 7.890712112187747, 'psi': 0.06260469011725293}
[S7] START round=3 head_norm_before_train=2.546610 (no previous merge yet)
[S7] round=3 local utility u=0.038014 metrics={'f1_val': 0.6644100941239898, 'auprc': 0.6644100941239898, 'loss_val': 0.12102709517763295, 'psi': 0.6644100941239898}-{'f1_val': 0.6636554092885958, 'auprc': 0.6636554092885958, 'loss_val': 0.19026216708844407, 'psi': 0.6636554092885958}
[S8] START round=3 head_norm_before_train=2.319382 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.2132007498384083, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.0213567336999896, 'psi': 0.35939447907390915}
[S9] START round=3 head_norm_before_train=2.162255 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.839844528870579, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.666098443356574, 'psi': 0.36867172340800847}
[S10] START round=3 head_norm_before_train=2.405760 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.24658018867924528, 'auprc': 0.24658018867924528, 'loss_val': 1.9790364870341643, 'psi': 0.24658018867924528}-{'f1_val': 0.24886931682932636, 'auprc': 0.24886931682932636, 'loss_val': 1.8515392378737687, 'psi': 0.2488693168293264}
[S11] START round=3 head_norm_before_train=2.333642 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.3014161910801099, 'auprc': 0.3014161910801099, 'loss_val': 3.55937938918414, 'psi': 0.3014161910801099}-{'f1_val': 0.30111158013226397, 'auprc': 0.30111158013226397, 'loss_val': 3.4321477511288876, 'psi': 0.30111158013226397}
[S13] START round=3 head_norm_before_train=2.278231 cos_to_last_merge=0.9970 (last merge round=1)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.24025513819985825, 'auprc': 0.24025513819985825, 'loss_val': 1.7949463966163435, 'psi': 0.24025513819985825}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.0220393926773177, 'psi': 0.3599362944611573}
[S14] START round=3 head_norm_before_train=2.259682 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 8.235896454798244, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 7.8696183573201175, 'psi': 0.13587634006482174}
[S15] START round=3 head_norm_before_train=2.420873 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.7057830669950325, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6570313518896693, 'psi': 0.6163342951580373}
[S16] START round=3 head_norm_before_train=2.251072 (no previous merge yet)
[S16] round=3 local utility u=0.074770 metrics={'f1_val': 0.14243150933798415, 'auprc': 0.14243150933798415, 'loss_val': 5.212721567624865, 'psi': 0.14243150933798415}-{'f1_val': 0.13606943218593703, 'auprc': 0.13606943218593703, 'loss_val': 5.305003193742272, 'psi': 0.13606943218593703}
[S17] START round=3 head_norm_before_train=2.376623 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.6679741446764442, 'auprc': 0.6679741446764442, 'loss_val': 1.2751176537914723, 'psi': 0.6679741446764442}-{'f1_val': 0.7271305138341477, 'auprc': 0.7271305138341477, 'loss_val': 0.9892802938624717, 'psi': 0.7271305138341477}
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.142)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=2.175944 cos_to_last_merge=0.9996 (last merge round=2)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.8743434323641486, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.7490130779067377, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=4 head_norm_before_train=2.399223 cos_to_last_merge=0.9972 (last merge round=1)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.2642500656685054, 'auprc': 0.2642500656685054, 'loss_val': 3.998616922072291, 'psi': 0.2642500656685054}-{'f1_val': 0.26435422414925763, 'auprc': 0.26435422414925763, 'loss_val': 3.8474630420038993, 'psi': 0.26435422414925763}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=4 head_norm_before_train=2.409472 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.811465691050914, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.7032492906453862, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=4 head_norm_before_train=2.761193 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.24994455315150516, 'auprc': 0.24994455315150516, 'loss_val': 2.1518212441117788, 'psi': 0.24994455315150516}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.029900799122038, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=4 head_norm_before_train=2.130750 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.07866075030254134, 'auprc': 0.07866075030254134, 'loss_val': 8.457343405416042, 'psi': 0.07866075030254134}-{'f1_val': 0.07933950865888038, 'auprc': 0.07933950865888038, 'loss_val': 8.18830248965541, 'psi': 0.07933950865888038}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=4 head_norm_before_train=2.726883 (no previous merge yet)
[S7] round=4 local utility u=0.012304 metrics={'f1_val': 0.6647444222245239, 'auprc': 0.6647444222245239, 'loss_val': 0.09942833182787575, 'psi': 0.6647444222245239}-{'f1_val': 0.6644100941239898, 'auprc': 0.6644100941239898, 'loss_val': 0.12102709517763295, 'psi': 0.6644100941239898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] sending update (kind=head size=1793 to 1 peers)
[S8] START round=4 head_norm_before_train=2.455416 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.3881732242537783, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.2132007498384083, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=4 head_norm_before_train=2.235649 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.9786441651248636, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.839844528870579, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=4 head_norm_before_train=2.527971 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.24376311494520866, 'auprc': 0.24376311494520866, 'loss_val': 2.0882801818317804, 'psi': 0.24376311494520866}-{'f1_val': 0.24658018867924528, 'auprc': 0.24658018867924528, 'loss_val': 1.9790364870341643, 'psi': 0.24658018867924528}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=4 head_norm_before_train=2.418730 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.3008438818565401, 'auprc': 0.3008438818565401, 'loss_val': 3.6513548642948233, 'psi': 0.3008438818565401}-{'f1_val': 0.3014161910801099, 'auprc': 0.3014161910801099, 'loss_val': 3.55937938918414, 'psi': 0.3014161910801099}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=4 head_norm_before_train=2.397620 cos_to_last_merge=0.9913 (last merge round=1)
[S13] round=4 local utility u=0.061925 metrics={'f1_val': 0.24654545454545454, 'auprc': 0.24654545454545454, 'loss_val': 1.7277093974013207, 'psi': 0.24654545454545454}-{'f1_val': 0.24025513819985825, 'auprc': 0.24025513819985825, 'loss_val': 1.7949463966163435, 'psi': 0.24025513819985825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=4 head_norm_before_train=2.336391 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 8.534560273114613, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 8.235896454798244, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=4 head_norm_before_train=2.549149 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.7490920722081577, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.7057830669950325, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=4 head_norm_before_train=2.352566 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.15240946678072428, 'auprc': 0.15240946678072428, 'loss_val': 5.416926769394435, 'psi': 0.15240946678072428}-{'f1_val': 0.14243150933798415, 'auprc': 0.14243150933798415, 'loss_val': 5.212721567624865, 'psi': 0.14243150933798415}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=4 head_norm_before_train=2.470588 (no previous merge yet)
[S17] round=4 local utility u=0.617891 metrics={'f1_val': 0.7710693933432441, 'auprc': 0.7710693933432441, 'loss_val': 0.9671936612554227, 'psi': 0.7710693933432441}-{'f1_val': 0.6679741446764442, 'auprc': 0.6679741446764442, 'loss_val': 1.2751176537914723, 'psi': 0.6679741446764442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=5 head_norm_before_train=2.239813 cos_to_last_merge=0.9988 (last merge round=2)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.9776261627979306, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.8743434323641486, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=5 head_norm_before_train=2.474216 cos_to_last_merge=0.9957 (last merge round=1)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.2642500656685054, 'auprc': 0.2642500656685054, 'loss_val': 4.12462251730246, 'psi': 0.2642500656685054}-{'f1_val': 0.2642500656685054, 'auprc': 0.2642500656685054, 'loss_val': 3.998616922072291, 'psi': 0.2642500656685054}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=5 head_norm_before_train=2.526998 (no previous merge yet)
[S4] round=5 local utility u=0.000502 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.8104625192210988, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.811465691050914, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=5 head_norm_before_train=2.878423 (no previous merge yet)
[S5] round=5 local utility u=0.198612 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.5074018204015673, 'psi': 0.33358943696313936}-{'f1_val': 0.24994455315150516, 'auprc': 0.24994455315150516, 'loss_val': 2.1518212441117788, 'psi': 0.24994455315150516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=5 head_norm_before_train=2.187375 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.07967806841046278, 'auprc': 0.07967806841046278, 'loss_val': 8.671577124339013, 'psi': 0.07967806841046278}-{'f1_val': 0.07866075030254134, 'auprc': 0.07866075030254134, 'loss_val': 8.457343405416042, 'psi': 0.07866075030254134}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=5 head_norm_before_train=2.759737 (no previous merge yet)
[S7] round=5 local utility u=0.023294 metrics={'f1_val': 0.6648279000586513, 'auprc': 0.6648279000586513, 'loss_val': 0.05359115879908555, 'psi': 0.6648279000586513}-{'f1_val': 0.6647444222245239, 'auprc': 0.6647444222245239, 'loss_val': 0.09942833182787575, 'psi': 0.6647444222245239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] sending update (kind=head size=1792 to 1 peers)
[S8] START round=5 head_norm_before_train=2.547121 (no previous merge yet)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.5082308688914208, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.3881732242537783, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=5 head_norm_before_train=2.295442 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.095204273149434, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.9786441651248636, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=5 head_norm_before_train=2.620496 (no previous merge yet)
[S10] round=5 local utility u=0.310834 metrics={'f1_val': 0.32291425484294206, 'auprc': 0.32291425484294206, 'loss_val': 2.178972568662775, 'psi': 0.32291425484294206}-{'f1_val': 0.24376311494520866, 'auprc': 0.24376311494520866, 'loss_val': 2.0882801818317804, 'psi': 0.24376311494520866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=5 head_norm_before_train=2.487757 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.2993911400377913, 'auprc': 0.2993911400377913, 'loss_val': 3.724338357352378, 'psi': 0.2993911400377913}-{'f1_val': 0.3008438818565401, 'auprc': 0.3008438818565401, 'loss_val': 3.6513548642948233, 'psi': 0.3008438818565401}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=5 head_norm_before_train=2.530010 cos_to_last_merge=0.9843 (last merge round=1)
[S13] round=5 local utility u=0.088241 metrics={'f1_val': 0.24735497993433053, 'auprc': 0.24735497993433053, 'loss_val': 1.558512509216254, 'psi': 0.24735497993433053}-{'f1_val': 0.24654545454545454, 'auprc': 0.24654545454545454, 'loss_val': 1.7277093974013207, 'psi': 0.24654545454545454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=5 head_norm_before_train=2.398657 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.788632549707664, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 8.534560273114613, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=5 head_norm_before_train=2.645467 (no previous merge yet)
[S15] round=5 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.7853399616403586, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.7490920722081577, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=5 head_norm_before_train=2.432206 (no previous merge yet)
[S16] round=5 local utility u=0.014395 metrics={'f1_val': 0.16042105263157894, 'auprc': 0.16042105263157894, 'loss_val': 5.4602419971341005, 'psi': 0.16042105263157894}-{'f1_val': 0.15240946678072428, 'auprc': 0.15240946678072428, 'loss_val': 5.416926769394435, 'psi': 0.15240946678072428}
[S16] not sending this round → trigger blocked (psi=0.160)
[S17] START round=5 head_norm_before_train=2.581862 (no previous merge yet)
[S17] round=5 local utility u=0.141165 metrics={'f1_val': 0.7974972051122877, 'auprc': 0.7974972051122877, 'loss_val': 0.9227134709655888, 'psi': 0.7974972051122877}-{'f1_val': 0.7710693933432441, 'auprc': 0.7710693933432441, 'loss_val': 0.9671936612554227, 'psi': 0.7710693933432441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=6 head_norm_before_train=2.293441 cos_to_last_merge=0.9978 (last merge round=2)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.067177646634881, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.9776261627979306, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=6 head_norm_before_train=2.536960 cos_to_last_merge=0.9943 (last merge round=1)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.26409398175493864, 'auprc': 0.26409398175493864, 'loss_val': 4.241668100448387, 'psi': 0.26409398175493864}-{'f1_val': 0.2642500656685054, 'auprc': 0.2642500656685054, 'loss_val': 4.12462251730246, 'psi': 0.2642500656685054}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=6 head_norm_before_train=2.593116 (no previous merge yet)
[S4] round=6 local utility u=0.000317 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.8098283212619781, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.8104625192210988, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=6 head_norm_before_train=2.969488 (no previous merge yet)
[S5] round=6 local utility u=0.336193 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.8387991362830496, 'psi': 0.33400978131092857}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.5074018204015673, 'psi': 0.33358943696313936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=6 head_norm_before_train=2.234969 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.07933950865888038, 'auprc': 0.07933950865888038, 'loss_val': 8.865893343432557, 'psi': 0.07933950865888038}-{'f1_val': 0.07967806841046278, 'auprc': 0.07967806841046278, 'loss_val': 8.671577124339013, 'psi': 0.07967806841046278}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=6 head_norm_before_train=2.870935 (no previous merge yet)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.6655773316590636, 'auprc': 0.6655773316590636, 'loss_val': 0.08166557948090812, 'psi': 0.6655773316590636}-{'f1_val': 0.6648279000586513, 'auprc': 0.6648279000586513, 'loss_val': 0.05359115879908555, 'psi': 0.6648279000586513}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=6 head_norm_before_train=2.629425 (no previous merge yet)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.543117986287139, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.5082308688914208, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=6 head_norm_before_train=2.346325 (no previous merge yet)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.20247821649416, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.095204273149434, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=6 head_norm_before_train=2.695801 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.32164821648216485, 'auprc': 0.32164821648216485, 'loss_val': 2.2572552686409977, 'psi': 0.32164821648216485}-{'f1_val': 0.32291425484294206, 'auprc': 0.32291425484294206, 'loss_val': 2.178972568662775, 'psi': 0.32291425484294206}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=6 head_norm_before_train=2.546499 (no previous merge yet)
[S11] round=6 local utility u=0.000000 metrics={'f1_val': 0.2980769230769231, 'auprc': 0.2980769230769231, 'loss_val': 3.7861122006236654, 'psi': 0.2980769230769231}-{'f1_val': 0.2993911400377913, 'auprc': 0.2993911400377913, 'loss_val': 3.724338357352378, 'psi': 0.2993911400377913}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=6 head_norm_before_train=2.632576 cos_to_last_merge=0.9767 (last merge round=1)
[S13] round=6 local utility u=0.018374 metrics={'f1_val': 0.24699453551912567, 'auprc': 0.24699453551912567, 'loss_val': 1.51851958795373, 'psi': 0.24699453551912567}-{'f1_val': 0.24735497993433053, 'auprc': 0.24735497993433053, 'loss_val': 1.558512509216254, 'psi': 0.24735497993433053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=6 head_norm_before_train=2.452276 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.015743385886525, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.788632549707664, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=6 head_norm_before_train=2.723404 (no previous merge yet)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8152618339274768, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.7853399616403586, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=6 head_norm_before_train=2.492524 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.16222641773302568, 'auprc': 0.16222641773302568, 'loss_val': 5.516148319915784, 'psi': 0.16222641773302568}-{'f1_val': 0.16042105263157894, 'auprc': 0.16042105263157894, 'loss_val': 5.4602419971341005, 'psi': 0.16042105263157894}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=6 head_norm_before_train=2.663133 (no previous merge yet)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.3217648762251103, 'auprc': 0.3217648762251103, 'loss_val': 3.299753211931791, 'psi': 0.3217648762251103}-{'f1_val': 0.7974972051122877, 'auprc': 0.7974972051122877, 'loss_val': 0.9227134709655888, 'psi': 0.7974972051122877}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=7 head_norm_before_train=2.339857 cos_to_last_merge=0.9969 (last merge round=2)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.146830786750367, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.067177646634881, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=7 head_norm_before_train=2.591900 cos_to_last_merge=0.9929 (last merge round=1)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.26399002820967005, 'auprc': 0.26399002820967005, 'loss_val': 4.344087878356829, 'psi': 0.26399002820967005}-{'f1_val': 0.26409398175493864, 'auprc': 0.26409398175493864, 'loss_val': 4.241668100448387, 'psi': 0.26409398175493864}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=7 head_norm_before_train=2.682158 (no previous merge yet)
[S4] round=7 local utility u=0.022100 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.7656282726644592, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.8098283212619781, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=7 head_norm_before_train=3.029363 (no previous merge yet)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.3612208075306294, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.8387991362830496, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=7 head_norm_before_train=2.276413 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.08386454183266932, 'auprc': 0.08386454183266932, 'loss_val': 9.011544426174094, 'psi': 0.08386454183266932}-{'f1_val': 0.07933950865888038, 'auprc': 0.07933950865888038, 'loss_val': 8.865893343432557, 'psi': 0.07933950865888038}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=7 head_norm_before_train=2.865465 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.6641589095718148, 'auprc': 0.6641589095718148, 'loss_val': 0.08181864749394825, 'psi': 0.6641589095718148}-{'f1_val': 0.6655773316590636, 'auprc': 0.6655773316590636, 'loss_val': 0.08166557948090812, 'psi': 0.6655773316590636}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=7 head_norm_before_train=2.721898 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.6278778029686474, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.543117986287139, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=7 head_norm_before_train=2.391883 (no previous merge yet)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.297644231996318, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.20247821649416, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=7 head_norm_before_train=2.759881 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.32046568627450983, 'auprc': 0.32046568627450983, 'loss_val': 2.3268972221168402, 'psi': 0.32046568627450983}-{'f1_val': 0.32164821648216485, 'auprc': 0.32164821648216485, 'loss_val': 2.2572552686409977, 'psi': 0.32164821648216485}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=7 head_norm_before_train=2.598409 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.29734611643740444, 'auprc': 0.29734611643740444, 'loss_val': 3.838920416068824, 'psi': 0.29734611643740444}-{'f1_val': 0.2980769230769231, 'auprc': 0.2980769230769231, 'loss_val': 3.7861122006236654, 'psi': 0.2980769230769231}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=7 head_norm_before_train=2.764651 cos_to_last_merge=0.9713 (last merge round=1)
[S13] round=7 local utility u=0.146590 metrics={'f1_val': 0.2528907124207385, 'auprc': 0.2528907124207385, 'loss_val': 1.2784054300722798, 'psi': 0.2528907124207385}-{'f1_val': 0.24699453551912567, 'auprc': 0.24699453551912567, 'loss_val': 1.51851958795373, 'psi': 0.24699453551912567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=7 head_norm_before_train=2.499455 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.219988529847676, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.015743385886525, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=7 head_norm_before_train=2.789184 (no previous merge yet)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.842767565409453, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8152618339274768, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=7 head_norm_before_train=2.543529 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.16642396505096735, 'auprc': 0.16642396505096735, 'loss_val': 5.600451447329202, 'psi': 0.16642396505096735}-{'f1_val': 0.16222641773302568, 'auprc': 0.16222641773302568, 'loss_val': 5.516148319915784, 'psi': 0.16222641773302568}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=7 head_norm_before_train=2.712372 (no previous merge yet)
[S17] round=7 local utility u=1.000000 metrics={'f1_val': 0.8308173913043478, 'auprc': 0.8308173913043478, 'loss_val': 0.575074545522277, 'psi': 0.8308173913043478}-{'f1_val': 0.3217648762251103, 'auprc': 0.3217648762251103, 'loss_val': 3.299753211931791, 'psi': 0.3217648762251103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=8 head_norm_before_train=2.381290 cos_to_last_merge=0.9959 (last merge round=2)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.21712867067886, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.146830786750367, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=8 head_norm_before_train=2.641080 cos_to_last_merge=0.9916 (last merge round=1)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.2639380821199003, 'auprc': 0.2639380821199003, 'loss_val': 4.434006745505481, 'psi': 0.2639380821199003}-{'f1_val': 0.26399002820967005, 'auprc': 0.26399002820967005, 'loss_val': 4.344087878356829, 'psi': 0.26399002820967005}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=8 head_norm_before_train=2.744512 (no previous merge yet)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.7771103603904048, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.7656282726644592, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=8 head_norm_before_train=3.128629 (no previous merge yet)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.9524891089568635, 'psi': 0.33358943696313936}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.3612208075306294, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=8 head_norm_before_train=2.313395 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.0820328131252501, 'auprc': 0.0820328131252501, 'loss_val': 9.173052259826541, 'psi': 0.0820328131252501}-{'f1_val': 0.08386454183266932, 'auprc': 0.08386454183266932, 'loss_val': 9.011544426174094, 'psi': 0.08386454183266932}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=8 head_norm_before_train=2.937014 (no previous merge yet)
[S7] round=8 local utility u=0.007951 metrics={'f1_val': 0.6641589095718148, 'auprc': 0.6641589095718148, 'loss_val': 0.06591565912086879, 'psi': 0.6641589095718148}-{'f1_val': 0.6641589095718148, 'auprc': 0.6641589095718148, 'loss_val': 0.08181864749394825, 'psi': 0.6641589095718148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=8 head_norm_before_train=2.793072 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.7238298018623275, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.6278778029686474, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=8 head_norm_before_train=2.433153 (no previous merge yet)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.384655728467427, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.297644231996318, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=8 head_norm_before_train=2.816073 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.3200979267079795, 'auprc': 0.3200979267079795, 'loss_val': 2.3899443046550783, 'psi': 0.3200979267079795}-{'f1_val': 0.32046568627450983, 'auprc': 0.32046568627450983, 'loss_val': 2.3268972221168402, 'psi': 0.32046568627450983}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=8 head_norm_before_train=2.645504 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.2960503562288165, 'auprc': 0.2960503562288165, 'loss_val': 3.885417017280248, 'psi': 0.2960503562288165}-{'f1_val': 0.29734611643740444, 'auprc': 0.29734611643740444, 'loss_val': 3.838920416068824, 'psi': 0.29734611643740444}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=8 head_norm_before_train=2.867489 cos_to_last_merge=0.9661 (last merge round=1)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.24520795660036165, 'auprc': 0.24520795660036165, 'loss_val': 1.5863785979075211, 'psi': 0.24520795660036165}-{'f1_val': 0.2528907124207385, 'auprc': 0.2528907124207385, 'loss_val': 1.2784054300722798, 'psi': 0.2528907124207385}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=8 head_norm_before_train=2.542324 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.408158641915605, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.219988529847676, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=8 head_norm_before_train=2.846344 (no previous merge yet)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8669243292794899, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.842767565409453, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=8 head_norm_before_train=2.588563 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.1699373407698134, 'auprc': 0.1699373407698134, 'loss_val': 5.675728303998434, 'psi': 0.1699373407698134}-{'f1_val': 0.16642396505096735, 'auprc': 0.16642396505096735, 'loss_val': 5.600451447329202, 'psi': 0.16642396505096735}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=8 head_norm_before_train=2.721659 (no previous merge yet)
[S17] round=8 local utility u=0.076946 metrics={'f1_val': 0.8524393247809998, 'auprc': 0.8524393247809998, 'loss_val': 0.6157802164390853, 'psi': 0.8524393247809998}-{'f1_val': 0.8308173913043478, 'auprc': 0.8308173913043478, 'loss_val': 0.575074545522277, 'psi': 0.8308173913043478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=9 head_norm_before_train=2.418602 cos_to_last_merge=0.9950 (last merge round=2)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.279267048299994, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.21712867067886, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=9 head_norm_before_train=2.685950 cos_to_last_merge=0.9904 (last merge round=1)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.26388615646927666, 'auprc': 0.26388615646927666, 'loss_val': 4.518713519399549, 'psi': 0.26388615646927666}-{'f1_val': 0.2639380821199003, 'auprc': 0.2639380821199003, 'loss_val': 4.434006745505481, 'psi': 0.2639380821199003}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=9 head_norm_before_train=2.833095 (no previous merge yet)
[S4] round=9 local utility u=0.021476 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.734157917969722, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.7771103603904048, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=9 head_norm_before_train=3.219337 (no previous merge yet)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.2501302424741856, 'auprc': 0.2501302424741856, 'loss_val': 2.762972751709266, 'psi': 0.2501302424741856}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.9524891089568635, 'psi': 0.33358943696313936}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=9 head_norm_before_train=2.347260 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.085680285600952, 'auprc': 0.085680285600952, 'loss_val': 9.303095675219318, 'psi': 0.085680285600952}-{'f1_val': 0.0820328131252501, 'auprc': 0.0820328131252501, 'loss_val': 9.173052259826541, 'psi': 0.0820328131252501}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=9 head_norm_before_train=3.030800 (no previous merge yet)
[S7] round=9 local utility u=0.003035 metrics={'f1_val': 0.6643264077517587, 'auprc': 0.6643264077517587, 'loss_val': 0.06135411602569802, 'psi': 0.6643264077517587}-{'f1_val': 0.6641589095718148, 'auprc': 0.6641589095718148, 'loss_val': 0.06591565912086879, 'psi': 0.6641589095718148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=9 head_norm_before_train=2.852662 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.8141088597102515, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.7238298018623275, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=9 head_norm_before_train=2.471221 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.4660937773448675, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.384655728467427, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=9 head_norm_before_train=2.866088 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.31899969502897224, 'auprc': 0.31899969502897224, 'loss_val': 2.451928332334871, 'psi': 0.31899969502897224}-{'f1_val': 0.3200979267079795, 'auprc': 0.3200979267079795, 'loss_val': 2.3899443046550783, 'psi': 0.3200979267079795}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=9 head_norm_before_train=2.688805 (no previous merge yet)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.2951317059715901, 'auprc': 0.2951317059715901, 'loss_val': 3.92843202517791, 'psi': 0.2951317059715901}-{'f1_val': 0.2960503562288165, 'auprc': 0.2960503562288165, 'loss_val': 3.885417017280248, 'psi': 0.2960503562288165}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=9 head_norm_before_train=2.958271 cos_to_last_merge=0.9619 (last merge round=1)
[S13] round=9 local utility u=0.220519 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.177894824367893, 'psi': 0.3599362944611573}-{'f1_val': 0.24520795660036165, 'auprc': 0.24520795660036165, 'loss_val': 1.5863785979075211, 'psi': 0.24520795660036165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=9 head_norm_before_train=2.581804 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.584371221691287, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.408158641915605, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=9 head_norm_before_train=2.897159 (no previous merge yet)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8882807981260818, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8669243292794899, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=9 head_norm_before_train=2.629414 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.1712676830105755, 'auprc': 0.1712676830105755, 'loss_val': 5.740866944049697, 'psi': 0.1712676830105755}-{'f1_val': 0.1699373407698134, 'auprc': 0.1699373407698134, 'loss_val': 5.675728303998434, 'psi': 0.1699373407698134}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=9 head_norm_before_train=2.809092 (no previous merge yet)
[S17] round=9 local utility u=0.114523 metrics={'f1_val': 0.8741664239321449, 'auprc': 0.8741664239321449, 'loss_val': 0.5822787452984638, 'psi': 0.8741664239321449}-{'f1_val': 0.8524393247809998, 'auprc': 0.8524393247809998, 'loss_val': 0.6157802164390853, 'psi': 0.8524393247809998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=10 head_norm_before_train=2.452548 cos_to_last_merge=0.9941 (last merge round=2)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.339879062275713, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.279267048299994, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=10 head_norm_before_train=2.727634 cos_to_last_merge=0.9893 (last merge round=1)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.26373050203172105, 'auprc': 0.26373050203172105, 'loss_val': 4.595556999492186, 'psi': 0.26373050203172105}-{'f1_val': 0.26388615646927666, 'auprc': 0.26388615646927666, 'loss_val': 4.518713519399549, 'psi': 0.26388615646927666}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=10 head_norm_before_train=2.888683 (no previous merge yet)
[S4] round=10 local utility u=0.030370 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.673418196725651, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.734157917969722, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=10 head_norm_before_train=3.284301 (no previous merge yet)
[S5] round=10 local utility u=0.383544 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.7470170141248578, 'psi': 0.33358943696313936}-{'f1_val': 0.2501302424741856, 'auprc': 0.2501302424741856, 'loss_val': 2.762972751709266, 'psi': 0.2501302424741856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=10 head_norm_before_train=2.378146 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.085680285600952, 'auprc': 0.085680285600952, 'loss_val': 9.433746975301828, 'psi': 0.085680285600952}-{'f1_val': 0.085680285600952, 'auprc': 0.085680285600952, 'loss_val': 9.303095675219318, 'psi': 0.085680285600952}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=10 head_norm_before_train=3.106859 (no previous merge yet)
[S7] round=10 local utility u=0.026120 metrics={'f1_val': 0.6656603947486558, 'auprc': 0.6656603947486558, 'loss_val': 0.021120053663605615, 'psi': 0.6656603947486558}-{'f1_val': 0.6643264077517587, 'auprc': 0.6643264077517587, 'loss_val': 0.06135411602569802, 'psi': 0.6643264077517587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] sending update (kind=head size=1789 to 1 peers)
[S8] START round=10 head_norm_before_train=2.904763 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.898818965018403, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.8141088597102515, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=10 head_norm_before_train=2.506858 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.542425368015157, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.4660937773448675, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=10 head_norm_before_train=2.911812 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.31870810481413775, 'auprc': 0.31870810481413775, 'loss_val': 2.50657950756376, 'psi': 0.31870810481413775}-{'f1_val': 0.31899969502897224, 'auprc': 0.31899969502897224, 'loss_val': 2.451928332334871, 'psi': 0.31899969502897224}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=10 head_norm_before_train=2.729239 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.2940974369545798, 'auprc': 0.2940974369545798, 'loss_val': 3.969465647430134, 'psi': 0.2940974369545798}-{'f1_val': 0.2951317059715901, 'auprc': 0.2951317059715901, 'loss_val': 3.92843202517791, 'psi': 0.2951317059715901}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=10 head_norm_before_train=3.022830 cos_to_last_merge=0.9612 (last merge round=1)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.275820111557438, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.177894824367893, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=10 head_norm_before_train=2.618649 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.750676620580297, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.584371221691287, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=10 head_norm_before_train=2.942981 (no previous merge yet)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.908607181460915, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8882807981260818, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=10 head_norm_before_train=2.667399 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.17177745763874597, 'auprc': 0.17177745763874597, 'loss_val': 5.8566810257893716, 'psi': 0.17177745763874597}-{'f1_val': 0.1712676830105755, 'auprc': 0.1712676830105755, 'loss_val': 5.740866944049697, 'psi': 0.1712676830105755}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=10 head_norm_before_train=2.869097 (no previous merge yet)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.8755545953286676, 'auprc': 0.8755545953286676, 'loss_val': 0.6314588811734774, 'psi': 0.8755545953286676}-{'f1_val': 0.8741664239321449, 'auprc': 0.8741664239321449, 'loss_val': 0.5822787452984638, 'psi': 0.8741664239321449}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=11 head_norm_before_train=2.484310 cos_to_last_merge=0.9932 (last merge round=2)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.395063976649388, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.339879062275713, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=11 head_norm_before_train=2.766857 cos_to_last_merge=0.9882 (last merge round=1)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.2636268343815514, 'auprc': 0.2636268343815514, 'loss_val': 4.668802029002569, 'psi': 0.2636268343815514}-{'f1_val': 0.26373050203172105, 'auprc': 0.26373050203172105, 'loss_val': 4.595556999492186, 'psi': 0.26373050203172105}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=11 head_norm_before_train=2.916013 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.2427823945829486, 'auprc': 0.2427823945829486, 'loss_val': 1.5175487265995533, 'psi': 0.2427823945829486}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.673418196725651, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=11 head_norm_before_train=3.340090 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.944939463176681, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.7470170141248578, 'psi': 0.33358943696313936}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=11 head_norm_before_train=2.406812 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.08617274167987321, 'auprc': 0.08617274167987321, 'loss_val': 9.552936598989733, 'psi': 0.08617274167987321}-{'f1_val': 0.085680285600952, 'auprc': 0.085680285600952, 'loss_val': 9.433746975301828, 'psi': 0.085680285600952}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=11 head_norm_before_train=3.143477 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.6648271952537037, 'auprc': 0.6648271952537037, 'loss_val': 0.033794060791766334, 'psi': 0.6648271952537037}-{'f1_val': 0.6656603947486558, 'auprc': 0.6656603947486558, 'loss_val': 0.021120053663605615, 'psi': 0.6656603947486558}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=11 head_norm_before_train=2.951288 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.973057798344105, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.898818965018403, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=11 head_norm_before_train=2.540548 (no previous merge yet)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.61564949318756, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.542425368015157, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=11 head_norm_before_train=2.953907 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.31827171763274, 'auprc': 0.31827171763274, 'loss_val': 2.5599141502653087, 'psi': 0.31827171763274}-{'f1_val': 0.31870810481413775, 'auprc': 0.31870810481413775, 'loss_val': 2.50657950756376, 'psi': 0.31870810481413775}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=11 head_norm_before_train=2.767441 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.29193097333060497, 'auprc': 0.29193097333060497, 'loss_val': 4.006582595718973, 'psi': 0.29193097333060497}-{'f1_val': 0.2940974369545798, 'auprc': 0.2940974369545798, 'loss_val': 3.969465647430134, 'psi': 0.2940974369545798}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=11 head_norm_before_train=3.103322 cos_to_last_merge=0.9570 (last merge round=1)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.4695050899676767, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.275820111557438, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=11 head_norm_before_train=2.653343 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.909521661260959, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.750676620580297, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=11 head_norm_before_train=2.984994 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.9266192382779178, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.908607181460915, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=11 head_norm_before_train=2.702912 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.1734017094017094, 'auprc': 0.1734017094017094, 'loss_val': 5.934075602328138, 'psi': 0.1734017094017094}-{'f1_val': 0.17177745763874597, 'auprc': 0.17177745763874597, 'loss_val': 5.8566810257893716, 'psi': 0.17177745763874597}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=11 head_norm_before_train=2.941732 (no previous merge yet)
[S17] round=11 local utility u=0.161135 metrics={'f1_val': 0.8891348357039857, 'auprc': 0.8891348357039857, 'loss_val': 0.4314119286824841, 'psi': 0.8891348357039857}-{'f1_val': 0.8755545953286676, 'auprc': 0.8755545953286676, 'loss_val': 0.6314588811734774, 'psi': 0.8755545953286676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=12 head_norm_before_train=2.513869 cos_to_last_merge=0.9923 (last merge round=2)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.446260617332676, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.395063976649388, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=12 head_norm_before_train=2.804003 cos_to_last_merge=0.9871 (last merge round=1)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.2635750311128578, 'auprc': 0.2635750311128578, 'loss_val': 4.738545081264155, 'psi': 0.2635750311128578}-{'f1_val': 0.2636268343815514, 'auprc': 0.2636268343815514, 'loss_val': 4.668802029002569, 'psi': 0.2636268343815514}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=12 head_norm_before_train=2.991405 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.2420225822287678, 'auprc': 0.2420225822287678, 'loss_val': 1.537281051270238, 'psi': 0.24202258222876777}-{'f1_val': 0.2427823945829486, 'auprc': 0.2427823945829486, 'loss_val': 1.5175487265995533, 'psi': 0.2427823945829486}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=12 head_norm_before_train=3.423505 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.9775952809068116, 'psi': 0.33400978131092857}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.944939463176681, 'psi': 0.33358943696313936}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=12 head_norm_before_train=2.433933 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.08748025276461295, 'auprc': 0.08748025276461295, 'loss_val': 9.668134580013183, 'psi': 0.08748025276461295}-{'f1_val': 0.08617274167987321, 'auprc': 0.08617274167987321, 'loss_val': 9.552936598989733, 'psi': 0.08617274167987321}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=12 head_norm_before_train=3.180854 (no previous merge yet)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.6644928663451836, 'auprc': 0.6644928663451836, 'loss_val': 0.03941599059440494, 'psi': 0.6644928663451836}-{'f1_val': 0.6648271952537037, 'auprc': 0.6648271952537037, 'loss_val': 0.033794060791766334, 'psi': 0.6648271952537037}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=12 head_norm_before_train=2.993231 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.048155556156929, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.973057798344105, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=12 head_norm_before_train=2.572757 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.685112466723593, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.61564949318756, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=12 head_norm_before_train=2.993012 (no previous merge yet)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.317474770468169, 'auprc': 0.317474770468169, 'loss_val': 2.605820977018329, 'psi': 0.317474770468169}-{'f1_val': 0.31827171763274, 'auprc': 0.31827171763274, 'loss_val': 2.5599141502653087, 'psi': 0.31827171763274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=12 head_norm_before_train=2.803727 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.291334830848819, 'auprc': 0.291334830848819, 'loss_val': 4.0428181359169, 'psi': 0.291334830848819}-{'f1_val': 0.29193097333060497, 'auprc': 0.29193097333060497, 'loss_val': 4.006582595718973, 'psi': 0.29193097333060497}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=12 head_norm_before_train=3.164351 cos_to_last_merge=0.9539 (last merge round=1)
[S13] round=12 local utility u=0.000644 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.468216154566032, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.4695050899676767, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=12 head_norm_before_train=2.686439 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.060701703630862, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.909521661260959, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=12 head_norm_before_train=3.024076 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.9436364481400566, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.9266192382779178, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=12 head_norm_before_train=2.736697 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.17309797482211275, 'auprc': 0.17309797482211275, 'loss_val': 6.045908570916195, 'psi': 0.17309797482211275}-{'f1_val': 0.1734017094017094, 'auprc': 0.1734017094017094, 'loss_val': 5.934075602328138, 'psi': 0.1734017094017094}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=12 head_norm_before_train=3.004462 (no previous merge yet)
[S17] round=12 local utility u=0.288720 metrics={'f1_val': 0.9330742231652422, 'auprc': 0.9330742231652422, 'loss_val': 0.2494269198556415, 'psi': 0.9330742231652422}-{'f1_val': 0.8891348357039857, 'auprc': 0.8891348357039857, 'loss_val': 0.4314119286824841, 'psi': 0.8891348357039857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=13 head_norm_before_train=2.541712 cos_to_last_merge=0.9915 (last merge round=2)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.4938324317227805, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.446260617332676, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=13 head_norm_before_train=2.839565 cos_to_last_merge=0.9861 (last merge round=1)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.2635750311128578, 'auprc': 0.2635750311128578, 'loss_val': 4.802706820213357, 'psi': 0.2635750311128578}-{'f1_val': 0.2635750311128578, 'auprc': 0.2635750311128578, 'loss_val': 4.738545081264155, 'psi': 0.2635750311128578}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=13 head_norm_before_train=3.123568 (no previous merge yet)
[S4] round=13 local utility u=0.037976 metrics={'f1_val': 0.2396839866302036, 'auprc': 0.2396839866302036, 'loss_val': 1.440282469026398, 'psi': 0.2396839866302036}-{'f1_val': 0.2420225822287678, 'auprc': 0.2420225822287678, 'loss_val': 1.537281051270238, 'psi': 0.24202258222876777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=13 head_norm_before_train=3.500640 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.170214687363763, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.9775952809068116, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=13 head_norm_before_train=2.459332 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.08942610062893082, 'auprc': 0.08942610062893082, 'loss_val': 9.774572603899227, 'psi': 0.08942610062893082}-{'f1_val': 0.08748025276461295, 'auprc': 0.08748025276461295, 'loss_val': 9.668134580013183, 'psi': 0.08748025276461295}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=13 head_norm_before_train=3.267145 (no previous merge yet)
[S7] round=13 local utility u=0.002633 metrics={'f1_val': 0.6646601142356574, 'auprc': 0.6646601142356574, 'loss_val': 0.035655740645743755, 'psi': 0.6646601142356574}-{'f1_val': 0.6644928663451836, 'auprc': 0.6644928663451836, 'loss_val': 0.03941599059440494, 'psi': 0.6644928663451836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] sending update (kind=head size=1791 to 1 peers)
[S8] START round=13 head_norm_before_train=3.032485 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.11591917653881, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.048155556156929, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=13 head_norm_before_train=2.603645 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.752171617003805, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.685112466723593, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=13 head_norm_before_train=3.029810 (no previous merge yet)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.31740251858595053, 'auprc': 0.31740251858595053, 'loss_val': 2.65347826640204, 'psi': 0.31740251858595053}-{'f1_val': 0.317474770468169, 'auprc': 0.317474770468169, 'loss_val': 2.605820977018329, 'psi': 0.317474770468169}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=13 head_norm_before_train=2.838527 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.28997289972899726, 'auprc': 0.28997289972899726, 'loss_val': 4.077795963735146, 'psi': 0.28997289972899726}-{'f1_val': 0.291334830848819, 'auprc': 0.291334830848819, 'loss_val': 4.0428181359169, 'psi': 0.291334830848819}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=13 head_norm_before_train=3.230100 cos_to_last_merge=0.9500 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.950
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.7924950735760303, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.468216154566032, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=13 head_norm_before_train=2.718323 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.207879605213368, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.060701703630862, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=13 head_norm_before_train=3.060654 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.9599529551192223, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.9436364481400566, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=13 head_norm_before_train=2.768990 (no previous merge yet)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.1743106743106743, 'auprc': 0.1743106743106743, 'loss_val': 6.104762098282563, 'psi': 0.1743106743106743}-{'f1_val': 0.17309797482211275, 'auprc': 0.17309797482211275, 'loss_val': 6.045908570916195, 'psi': 0.17309797482211275}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=13 head_norm_before_train=3.050726 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.8866448003087015, 'auprc': 0.8866448003087015, 'loss_val': 0.4976595873546884, 'psi': 0.8866448003087015}-{'f1_val': 0.9330742231652422, 'auprc': 0.9330742231652422, 'loss_val': 0.2494269198556415, 'psi': 0.9330742231652422}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=14 head_norm_before_train=2.568031 cos_to_last_merge=0.9908 (last merge round=2)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.539966524893438, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.4938324317227805, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=14 head_norm_before_train=2.873771 cos_to_last_merge=0.9851 (last merge round=1)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.2635750311128578, 'auprc': 0.2635750311128578, 'loss_val': 4.865630695470713, 'psi': 0.2635750311128578}-{'f1_val': 0.2635750311128578, 'auprc': 0.2635750311128578, 'loss_val': 4.802706820213357, 'psi': 0.2635750311128578}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=14 head_norm_before_train=3.206851 (no previous merge yet)
[S4] round=14 local utility u=0.520535 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4532020207751617, 'psi': 0.3567939207526687}-{'f1_val': 0.2396839866302036, 'auprc': 0.2396839866302036, 'loss_val': 1.440282469026398, 'psi': 0.2396839866302036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=14 head_norm_before_train=3.604861 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.21934777999028246, 'auprc': 0.21934777999028246, 'loss_val': 3.576949987015325, 'psi': 0.2193477799902825}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 3.170214687363763, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=14 head_norm_before_train=2.483617 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.09087348217783, 'auprc': 0.09087348217783, 'loss_val': 9.875516710512933, 'psi': 0.09087348217783}-{'f1_val': 0.08942610062893082, 'auprc': 0.08942610062893082, 'loss_val': 9.774572603899227, 'psi': 0.08942610062893082}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=14 head_norm_before_train=3.368067 (no previous merge yet)
[S7] round=14 local utility u=0.000393 metrics={'f1_val': 0.6648271952537037, 'auprc': 0.6648271952537037, 'loss_val': 0.03637431986944545, 'psi': 0.6648271952537037}-{'f1_val': 0.6646601142356574, 'auprc': 0.6646601142356574, 'loss_val': 0.035655740645743755, 'psi': 0.6646601142356574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] sending update (kind=head size=1793 to 1 peers)
[S8] START round=14 head_norm_before_train=3.068887 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.1820302660369166, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.11591917653881, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=14 head_norm_before_train=2.633567 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.817134394248259, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.752171617003805, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=14 head_norm_before_train=3.064516 (no previous merge yet)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.3171138396240715, 'auprc': 0.3171138396240715, 'loss_val': 2.697371604985123, 'psi': 0.3171138396240715}-{'f1_val': 0.31740251858595053, 'auprc': 0.31740251858595053, 'loss_val': 2.65347826640204, 'psi': 0.31740251858595053}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=14 head_norm_before_train=2.872133 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.28885739353445367, 'auprc': 0.28885739353445367, 'loss_val': 4.112537875498262, 'psi': 0.28885739353445367}-{'f1_val': 0.28997289972899726, 'auprc': 0.28997289972899726, 'loss_val': 4.077795963735146, 'psi': 0.28997289972899726}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=14 head_norm_before_train=3.307362 cos_to_last_merge=0.9471 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=14 local utility u=0.141093 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.5103084166212977, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.7924950735760303, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=14 head_norm_before_train=2.749116 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.350156965069193, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.207879605213368, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=14 head_norm_before_train=3.095055 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.9760942975945983, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.9599529551192223, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=14 head_norm_before_train=2.800102 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.1752162953879692, 'auprc': 0.1752162953879692, 'loss_val': 6.158229138252681, 'psi': 0.1752162953879692}-{'f1_val': 0.1743106743106743, 'auprc': 0.1743106743106743, 'loss_val': 6.104762098282563, 'psi': 0.1743106743106743}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=14 head_norm_before_train=3.107002 (no previous merge yet)
[S17] round=14 local utility u=0.037577 metrics={'f1_val': 0.8894137260350097, 'auprc': 0.8894137260350097, 'loss_val': 0.4474252337313764, 'psi': 0.8894137260350097}-{'f1_val': 0.8866448003087015, 'auprc': 0.8866448003087015, 'loss_val': 0.4976595873546884, 'psi': 0.8866448003087015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=15 head_norm_before_train=2.593119 cos_to_last_merge=0.9900 (last merge round=2)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.583484624604519, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.539966524893438, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=15 head_norm_before_train=2.906918 cos_to_last_merge=0.9842 (last merge round=1)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.2635750311128578, 'auprc': 0.2635750311128578, 'loss_val': 4.9264183915869255, 'psi': 0.2635750311128578}-{'f1_val': 0.2635750311128578, 'auprc': 0.2635750311128578, 'loss_val': 4.865630695470713, 'psi': 0.2635750311128578}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=15 head_norm_before_train=3.302094 (no previous merge yet)
[S4] round=15 local utility u=0.018975 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.415252549190128, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4532020207751617, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=15 head_norm_before_train=3.648180 (no previous merge yet)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.21942615404971627, 'auprc': 0.21942615404971627, 'loss_val': 3.6246467325563474, 'psi': 0.21942615404971627}-{'f1_val': 0.21934777999028246, 'auprc': 0.21934777999028246, 'loss_val': 3.576949987015325, 'psi': 0.2193477799902825}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=15 head_norm_before_train=2.506547 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.08974862529457973, 'auprc': 0.08974862529457973, 'loss_val': 9.983105260789403, 'psi': 0.08974862529457973}-{'f1_val': 0.09087348217783, 'auprc': 0.09087348217783, 'loss_val': 9.875516710512933, 'psi': 0.09087348217783}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=15 head_norm_before_train=3.455527 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.6632331627791523, 'auprc': 0.6632331627791523, 'loss_val': 0.07435333204347744, 'psi': 0.6632331627791523}-{'f1_val': 0.6648271952537037, 'auprc': 0.6648271952537037, 'loss_val': 0.03637431986944545, 'psi': 0.6648271952537037}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=15 head_norm_before_train=3.103207 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.2440813410845264, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.1820302660369166, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=15 head_norm_before_train=2.662636 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.8820598462345455, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.817134394248259, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=15 head_norm_before_train=3.097557 (no previous merge yet)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.3167537285184344, 'auprc': 0.3167537285184344, 'loss_val': 2.7426698534726337, 'psi': 0.3167537285184344}-{'f1_val': 0.3171138396240715, 'auprc': 0.3171138396240715, 'loss_val': 2.697371604985123, 'psi': 0.3171138396240715}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=15 head_norm_before_train=2.904841 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.28809908454496497, 'auprc': 0.28809908454496497, 'loss_val': 4.146327031202781, 'psi': 0.28809908454496497}-{'f1_val': 0.28885739353445367, 'auprc': 0.28885739353445367, 'loss_val': 4.112537875498262, 'psi': 0.28885739353445367}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=15 head_norm_before_train=3.363848 cos_to_last_merge=0.9440 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.944
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.637859999692038, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.5103084166212977, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=15 head_norm_before_train=2.779018 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.488608835667227, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.350156965069193, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=15 head_norm_before_train=3.127424 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.9898288721487738, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.9760942975945983, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=15 head_norm_before_train=2.830242 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.17481420876798257, 'auprc': 0.17481420876798257, 'loss_val': 6.269530604287927, 'psi': 0.17481420876798257}-{'f1_val': 0.1752162953879692, 'auprc': 0.1752162953879692, 'loss_val': 6.158229138252681, 'psi': 0.1752162953879692}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=15 head_norm_before_train=3.129617 (no previous merge yet)
[S17] round=15 local utility u=0.579857 metrics={'f1_val': 0.9780786943645382, 'auprc': 0.9780786943645382, 'loss_val': 0.0856950707441893, 'psi': 0.9780786943645381}-{'f1_val': 0.8894137260350097, 'auprc': 0.8894137260350097, 'loss_val': 0.4474252337313764, 'psi': 0.8894137260350097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=16 head_norm_before_train=2.617176 cos_to_last_merge=0.9893 (last merge round=2)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.626775428161265, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.583484624604519, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=16 head_norm_before_train=2.939151 cos_to_last_merge=0.9832 (last merge round=1)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.2635750311128578, 'auprc': 0.2635750311128578, 'loss_val': 4.986519204767687, 'psi': 0.2635750311128578}-{'f1_val': 0.2635750311128578, 'auprc': 0.2635750311128578, 'loss_val': 4.9264183915869255, 'psi': 0.2635750311128578}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=16 head_norm_before_train=3.377119 (no previous merge yet)
[S4] round=16 local utility u=0.030813 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3536257713237387, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.415252549190128, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=16 head_norm_before_train=3.769138 (no previous merge yet)
[S5] round=16 local utility u=0.852253 metrics={'f1_val': 0.22291412009543368, 'auprc': 0.22291412009543368, 'loss_val': 1.95153236245019, 'psi': 0.22291412009543368}-{'f1_val': 0.21942615404971627, 'auprc': 0.21942615404971627, 'loss_val': 3.6246467325563474, 'psi': 0.21942615404971627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=16 head_norm_before_train=2.528612 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.08910306845003933, 'auprc': 0.08910306845003933, 'loss_val': 10.083378781635421, 'psi': 0.08910306845003933}-{'f1_val': 0.08974862529457973, 'auprc': 0.08974862529457973, 'loss_val': 9.983105260789403, 'psi': 0.08974862529457973}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=16 head_norm_before_train=3.491006 (no previous merge yet)
[S7] round=16 local utility u=0.017776 metrics={'f1_val': 0.6639901189354847, 'auprc': 0.6639901189354847, 'loss_val': 0.04561441192645578, 'psi': 0.6639901189354847}-{'f1_val': 0.6632331627791523, 'auprc': 0.6632331627791523, 'loss_val': 0.07435333204347744, 'psi': 0.6632331627791523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=16 head_norm_before_train=3.135740 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.304850650600407, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.2440813410845264, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=16 head_norm_before_train=2.691151 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.945650951199913, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.8820598462345455, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=16 head_norm_before_train=3.129169 (no previous merge yet)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.3160359543772188, 'auprc': 0.3160359543772188, 'loss_val': 2.7823129182698123, 'psi': 0.3160359543772188}-{'f1_val': 0.3167537285184344, 'auprc': 0.3167537285184344, 'loss_val': 2.7426698534726337, 'psi': 0.3167537285184344}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=16 head_norm_before_train=2.936424 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.28722904503053487, 'auprc': 0.28722904503053487, 'loss_val': 4.180163701824515, 'psi': 0.28722904503053487}-{'f1_val': 0.28809908454496497, 'auprc': 0.28809908454496497, 'loss_val': 4.146327031202781, 'psi': 0.28809908454496497}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=16 head_norm_before_train=3.395194 cos_to_last_merge=0.9407 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.941
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.766899510840742, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.637859999692038, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=16 head_norm_before_train=2.808310 (no previous merge yet)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.623367709957387, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.488608835667227, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=16 head_norm_before_train=3.158598 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.004268198530262, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.9898288721487738, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=16 head_norm_before_train=2.859549 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.1752162953879692, 'auprc': 0.1752162953879692, 'loss_val': 6.346810822764737, 'psi': 0.1752162953879692}-{'f1_val': 0.17481420876798257, 'auprc': 0.17481420876798257, 'loss_val': 6.269530604287927, 'psi': 0.17481420876798257}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=16 head_norm_before_train=3.198762 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.9713772500272041, 'auprc': 0.9713772500272041, 'loss_val': 0.1255252409569668, 'psi': 0.9713772500272041}-{'f1_val': 0.9780786943645382, 'auprc': 0.9780786943645382, 'loss_val': 0.0856950707441893, 'psi': 0.9780786943645381}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=17 head_norm_before_train=2.640338 cos_to_last_merge=0.9886 (last merge round=2)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.6689778256696854, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.626775428161265, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=17 head_norm_before_train=2.970645 cos_to_last_merge=0.9823 (last merge round=1)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.2635750311128578, 'auprc': 0.2635750311128578, 'loss_val': 5.043349064001117, 'psi': 0.2635750311128578}-{'f1_val': 0.2635750311128578, 'auprc': 0.2635750311128578, 'loss_val': 4.986519204767687, 'psi': 0.2635750311128578}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=17 head_norm_before_train=3.390972 (no previous merge yet)
[S4] round=17 local utility u=0.035981 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2816633338373211, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3536257713237387, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=17 head_norm_before_train=3.868191 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.22276161224549898, 'auprc': 0.22276161224549898, 'loss_val': 2.1461389197835645, 'psi': 0.22276161224549895}-{'f1_val': 0.22291412009543368, 'auprc': 0.22291412009543368, 'loss_val': 1.95153236245019, 'psi': 0.22291412009543368}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=17 head_norm_before_train=2.550035 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.0889413616686344, 'auprc': 0.0889413616686344, 'loss_val': 10.17786056703749, 'psi': 0.0889413616686344}-{'f1_val': 0.08910306845003933, 'auprc': 0.08910306845003933, 'loss_val': 10.083378781635421, 'psi': 0.08910306845003933}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=17 head_norm_before_train=3.607552 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.6633174376105556, 'auprc': 0.6633174376105556, 'loss_val': 0.07622087205395833, 'psi': 0.6633174376105556}-{'f1_val': 0.6639901189354847, 'auprc': 0.6639901189354847, 'loss_val': 0.04561441192645578, 'psi': 0.6639901189354847}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=17 head_norm_before_train=3.166936 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.3626916084069842, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.304850650600407, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=17 head_norm_before_train=2.719065 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.007067505170055, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.945650951199913, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=17 head_norm_before_train=3.159503 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.3158927897319743, 'auprc': 0.3158927897319743, 'loss_val': 2.823784002403249, 'psi': 0.3158927897319743}-{'f1_val': 0.3160359543772188, 'auprc': 0.3160359543772188, 'loss_val': 2.7823129182698123, 'psi': 0.3160359543772188}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=17 head_norm_before_train=2.967363 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.28584785948039804, 'auprc': 0.28584785948039804, 'loss_val': 4.214147179591203, 'psi': 0.28584785948039804}-{'f1_val': 0.28722904503053487, 'auprc': 0.28722904503053487, 'loss_val': 4.180163701824515, 'psi': 0.28722904503053487}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=17 head_norm_before_train=3.461715 cos_to_last_merge=0.9396 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.9281584024530347, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.766899510840742, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=17 head_norm_before_train=2.837058 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.756009318156174, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.623367709957387, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=17 head_norm_before_train=3.188242 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0181077796493612, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.004268198530262, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=17 head_norm_before_train=2.888229 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.1755174291938998, 'auprc': 0.1755174291938998, 'loss_val': 6.4252192337167475, 'psi': 0.1755174291938998}-{'f1_val': 0.1752162953879692, 'auprc': 0.1752162953879692, 'loss_val': 6.346810822764737, 'psi': 0.1752162953879692}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=17 head_norm_before_train=3.249201 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.9660809769176999, 'auprc': 0.9660809769176999, 'loss_val': 0.14401708452858744, 'psi': 0.9660809769176999}-{'f1_val': 0.9713772500272041, 'auprc': 0.9713772500272041, 'loss_val': 0.1255252409569668, 'psi': 0.9713772500272041}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=18 head_norm_before_train=2.662711 cos_to_last_merge=0.9879 (last merge round=2)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.709192915810534, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.6689778256696854, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=18 head_norm_before_train=3.001448 cos_to_last_merge=0.9814 (last merge round=1)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.2634197433883216, 'auprc': 0.2634197433883216, 'loss_val': 5.100819940179724, 'psi': 0.2634197433883216}-{'f1_val': 0.2635750311128578, 'auprc': 0.2635750311128578, 'loss_val': 5.043349064001117, 'psi': 0.2635750311128578}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=18 head_norm_before_train=3.473634 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3041406310703312, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2816633338373211, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=18 head_norm_before_train=3.947846 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.22276161224549898, 'auprc': 0.22276161224549898, 'loss_val': 2.2773963593772453, 'psi': 0.22276161224549895}-{'f1_val': 0.22276161224549898, 'auprc': 0.22276161224549898, 'loss_val': 2.1461389197835645, 'psi': 0.22276161224549895}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=18 head_norm_before_train=2.570804 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.08584456780333069, 'auprc': 0.08584456780333069, 'loss_val': 10.275722710291289, 'psi': 0.08584456780333069}-{'f1_val': 0.0889413616686344, 'auprc': 0.0889413616686344, 'loss_val': 10.17786056703749, 'psi': 0.0889413616686344}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=18 head_norm_before_train=3.684780 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6639901189354847, 'auprc': 0.6639901189354847, 'loss_val': 0.08351865222456034, 'psi': 0.6639901189354847}-{'f1_val': 0.6633174376105556, 'auprc': 0.6633174376105556, 'loss_val': 0.07622087205395833, 'psi': 0.6633174376105556}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=3.196840 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.417992736664965, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.3626916084069842, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=18 head_norm_before_train=2.746443 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.067021317099824, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.007067505170055, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=18 head_norm_before_train=3.188718 (no previous merge yet)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.31567828580051305, 'auprc': 0.31567828580051305, 'loss_val': 2.8610577859374344, 'psi': 0.31567828580051305}-{'f1_val': 0.3158927897319743, 'auprc': 0.3158927897319743, 'loss_val': 2.823784002403249, 'psi': 0.3158927897319743}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=18 head_norm_before_train=2.997624 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.28402681000729973, 'auprc': 0.28402681000729973, 'loss_val': 4.248177280510779, 'psi': 0.28402681000729973}-{'f1_val': 0.28584785948039804, 'auprc': 0.28584785948039804, 'loss_val': 4.214147179591203, 'psi': 0.28584785948039804}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=18 head_norm_before_train=3.525314 cos_to_last_merge=0.9374 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.937
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.0017581639427444, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.9281584024530347, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=18 head_norm_before_train=2.865297 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.886241075380202, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.756009318156174, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=18 head_norm_before_train=3.216669 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0301622485263153, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0181077796493612, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=18 head_norm_before_train=2.916351 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.17571798012794337, 'auprc': 0.17571798012794337, 'loss_val': 6.504072504765035, 'psi': 0.17571798012794337}-{'f1_val': 0.1755174291938998, 'auprc': 0.1755174291938998, 'loss_val': 6.4252192337167475, 'psi': 0.1755174291938998}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=18 head_norm_before_train=3.299061 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.8966048848941837, 'auprc': 0.8966048848941837, 'loss_val': 0.39846954247049104, 'psi': 0.8966048848941837}-{'f1_val': 0.9660809769176999, 'auprc': 0.9660809769176999, 'loss_val': 0.14401708452858744, 'psi': 0.9660809769176999}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=19 head_norm_before_train=2.684304 cos_to_last_merge=0.9872 (last merge round=2)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.747797845461407, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.709192915810534, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.367 u=0.0000 p_local=0.0144 f1=0.367 auprc=0.367 bytes=0
[S3] START round=19 head_norm_before_train=3.031703 cos_to_last_merge=0.9805 (last merge round=1)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.2634197433883216, 'auprc': 0.2634197433883216, 'loss_val': 5.155520058941284, 'psi': 0.2634197433883216}-{'f1_val': 0.2634197433883216, 'auprc': 0.2634197433883216, 'loss_val': 5.100819940179724, 'psi': 0.2634197433883216}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=20 psi=0.263 u=0.0000 p_local=0.0144 f1=0.263 auprc=0.263 bytes=0
[S4] START round=19 head_norm_before_train=3.550998 (no previous merge yet)
[S4] round=19 local utility u=0.022678 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2587846768793882, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3041406310703312, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S4] r=20 psi=0.357 u=0.0227 p_local=0.0660 f1=0.357 auprc=0.357 bytes=19789
[S5] START round=19 head_norm_before_train=4.010001 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.22276161224549898, 'auprc': 0.22276161224549898, 'loss_val': 2.462693725207236, 'psi': 0.22276161224549895}-{'f1_val': 0.22276161224549898, 'auprc': 0.22276161224549898, 'loss_val': 2.2773963593772453, 'psi': 0.22276161224549895}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=20 psi=0.223 u=0.0000 p_local=0.1193 f1=0.223 auprc=0.223 bytes=9000
[S6] START round=19 head_norm_before_train=2.590838 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.08813091482649842, 'auprc': 0.08813091482649842, 'loss_val': 10.358878656563403, 'psi': 0.08813091482649842}-{'f1_val': 0.08584456780333069, 'auprc': 0.08584456780333069, 'loss_val': 10.275722710291289, 'psi': 0.08584456780333069}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.088 u=0.0000 p_local=0.0144 f1=0.088 auprc=0.088 bytes=0
[S7] START round=19 head_norm_before_train=3.807338 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.6635700089004647, 'auprc': 0.6635700089004647, 'loss_val': 0.0915088768759173, 'psi': 0.6635700089004647}-{'f1_val': 0.6639901189354847, 'auprc': 0.6639901189354847, 'loss_val': 0.08351865222456034, 'psi': 0.6639901189354847}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=20 psi=0.664 u=0.0000 p_local=0.0253 f1=0.664 auprc=0.664 bytes=19729
[S8] START round=19 head_norm_before_train=3.225446 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.470074558813876, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.417992736664965, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=20 psi=0.359 u=0.0000 p_local=0.0144 f1=0.359 auprc=0.359 bytes=0
[S9] START round=19 head_norm_before_train=2.773315 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.126823464800711, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.067021317099824, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0144 f1=0.369 auprc=0.369 bytes=0
[S10] START round=19 head_norm_before_train=3.217156 (no previous merge yet)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.3153214258798704, 'auprc': 0.3153214258798704, 'loss_val': 2.8995245043748112, 'psi': 0.3153214258798704}-{'f1_val': 0.31567828580051305, 'auprc': 0.31567828580051305, 'loss_val': 2.8610577859374344, 'psi': 0.31567828580051305}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=20 psi=0.315 u=0.0000 p_local=0.0186 f1=0.315 auprc=0.315 bytes=3600
[S11] START round=19 head_norm_before_train=3.027324 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.28312495865581794, 'auprc': 0.28312495865581794, 'loss_val': 4.282783498796928, 'psi': 0.28312495865581794}-{'f1_val': 0.28402681000729973, 'auprc': 0.28402681000729973, 'loss_val': 4.248177280510779, 'psi': 0.28402681000729973}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=20 psi=0.283 u=0.0000 p_local=0.0144 f1=0.283 auprc=0.283 bytes=0
[S13] START round=19 head_norm_before_train=3.557703 cos_to_last_merge=0.9350 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.935
[S13] round=19 local utility u=0.019533 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.9626927945501067, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.0017581639427444, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S13] r=20 psi=0.360 u=0.0195 p_local=0.0358 f1=0.360 auprc=0.360 bytes=14392
[S14] START round=19 head_norm_before_train=2.893125 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.014958000160204, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.886241075380202, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=20 psi=0.136 u=0.0000 p_local=0.0144 f1=0.136 auprc=0.136 bytes=0
[S15] START round=19 head_norm_before_train=3.244319 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0428982860364733, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0301622485263153, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=20 psi=0.616 u=0.0000 p_local=0.0146 f1=0.616 auprc=0.616 bytes=1798
[S16] START round=19 head_norm_before_train=2.944070 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.17571798012794337, 'auprc': 0.17571798012794337, 'loss_val': 6.58994428110198, 'psi': 0.17571798012794337}-{'f1_val': 0.17571798012794337, 'auprc': 0.17571798012794337, 'loss_val': 6.504072504765035, 'psi': 0.17571798012794337}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=20 psi=0.176 u=0.0000 p_local=0.0150 f1=0.176 auprc=0.176 bytes=0
[S17] START round=19 head_norm_before_train=3.348936 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.6007713374346362, 'auprc': 0.6007713374346362, 'loss_val': 0.38678247074559324, 'psi': 0.6007713374346362}-{'f1_val': 0.8966048848941837, 'auprc': 0.8966048848941837, 'loss_val': 0.39846954247049104, 'psi': 0.8966048848941837}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=20 psi=0.601 u=0.0000 p_local=0.1086 f1=0.601 auprc=0.601 bytes=17979
[S2] START round=20 head_norm_before_train=2.705249 cos_to_last_merge=0.9865 (last merge round=2)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.786479036940416, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.747797845461407, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=3.061550 cos_to_last_merge=0.9797 (last merge round=1)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.26336802146737354, 'auprc': 0.26336802146737354, 'loss_val': 5.210914116920779, 'psi': 0.26336802146737354}-{'f1_val': 0.2634197433883216, 'auprc': 0.2634197433883216, 'loss_val': 5.155520058941284, 'psi': 0.2634197433883216}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=20 head_norm_before_train=3.569940 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2654434212376389, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2587846768793882, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=20 head_norm_before_train=4.064295 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.22276161224549898, 'auprc': 0.22276161224549898, 'loss_val': 2.6092790399874866, 'psi': 0.22276161224549895}-{'f1_val': 0.22276161224549898, 'auprc': 0.22276161224549898, 'loss_val': 2.462693725207236, 'psi': 0.22276161224549895}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=20 head_norm_before_train=2.610347 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.08974862529457973, 'auprc': 0.08974862529457973, 'loss_val': 10.440105588489565, 'psi': 0.08974862529457973}-{'f1_val': 0.08813091482649842, 'auprc': 0.08813091482649842, 'loss_val': 10.358878656563403, 'psi': 0.08813091482649842}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=3.883718 (no previous merge yet)
[S7] round=20 local utility u=0.010101 metrics={'f1_val': 0.6639061809925196, 'auprc': 0.6639061809925196, 'loss_val': 0.07433227452564872, 'psi': 0.6639061809925196}-{'f1_val': 0.6635700089004647, 'auprc': 0.6635700089004647, 'loss_val': 0.0915088768759173, 'psi': 0.6635700089004647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] sending update (kind=head size=1793 to 1 peers)
[S8] START round=20 head_norm_before_train=3.252979 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.5232213867288116, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.470074558813876, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=20 head_norm_before_train=2.799987 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.1868423064429985, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.126823464800711, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=20 head_norm_before_train=3.244570 (no previous merge yet)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.3150365183344628, 'auprc': 0.3150365183344628, 'loss_val': 2.9361771047800356, 'psi': 0.3150365183344628}-{'f1_val': 0.3153214258798704, 'auprc': 0.3153214258798704, 'loss_val': 2.8995245043748112, 'psi': 0.3153214258798704}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=20 head_norm_before_train=3.056690 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.2824523196726721, 'auprc': 0.2824523196726721, 'loss_val': 4.317171586441014, 'psi': 0.2824523196726721}-{'f1_val': 0.28312495865581794, 'auprc': 0.28312495865581794, 'loss_val': 4.282783498796928, 'psi': 0.28312495865581794}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=20 head_norm_before_train=3.622150 cos_to_last_merge=0.9333 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.933
[S13] round=20 local utility u=0.104528 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.7536373014896784, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.9626927945501067, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=20 head_norm_before_train=2.920642 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.141955981225989, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.014958000160204, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=20 head_norm_before_train=3.270883 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0554211885675147, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0428982860364733, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=2.971402 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 6.66135533170054, 'psi': 0.1761185910512716}-{'f1_val': 0.17571798012794337, 'auprc': 0.17571798012794337, 'loss_val': 6.58994428110198, 'psi': 0.17571798012794337}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=3.396884 (no previous merge yet)
[S17] round=20 local utility u=0.052529 metrics={'f1_val': 0.6094289590575556, 'auprc': 0.6094289590575556, 'loss_val': 0.3596440642643942, 'psi': 0.6094289590575556}-{'f1_val': 0.6007713374346362, 'auprc': 0.6007713374346362, 'loss_val': 0.38678247074559324, 'psi': 0.6007713374346362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=21 head_norm_before_train=2.725680 cos_to_last_merge=0.9859 (last merge round=2)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.824376444676714, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.786479036940416, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=21 head_norm_before_train=3.090999 cos_to_last_merge=0.9788 (last merge round=1)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.26336802146737354, 'auprc': 0.26336802146737354, 'loss_val': 5.26409848838298, 'psi': 0.26336802146737354}-{'f1_val': 0.26336802146737354, 'auprc': 0.26336802146737354, 'loss_val': 5.210914116920779, 'psi': 0.26336802146737354}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=21 head_norm_before_train=3.645661 (no previous merge yet)
[S4] round=21 local utility u=0.049983 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1654770340645049, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2654434212376389, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=21 head_norm_before_train=4.112192 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.22276161224549898, 'auprc': 0.22276161224549898, 'loss_val': 2.7678920099131985, 'psi': 0.22276161224549895}-{'f1_val': 0.22276161224549898, 'auprc': 0.22276161224549898, 'loss_val': 2.6092790399874866, 'psi': 0.22276161224549895}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=2.629159 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.08974862529457973, 'auprc': 0.08974862529457973, 'loss_val': 10.522122038122292, 'psi': 0.08974862529457973}-{'f1_val': 0.08974862529457973, 'auprc': 0.08974862529457973, 'loss_val': 10.440105588489565, 'psi': 0.08974862529457973}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=3.978643 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.6636554092885958, 'auprc': 0.6636554092885958, 'loss_val': 0.07563456838061942, 'psi': 0.6636554092885958}-{'f1_val': 0.6639061809925196, 'auprc': 0.6639061809925196, 'loss_val': 0.07433227452564872, 'psi': 0.6639061809925196}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=21 head_norm_before_train=3.279939 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.5728055768351745, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.5232213867288116, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=21 head_norm_before_train=2.826437 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.24548473132737, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.1868423064429985, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=3.271343 (no previous merge yet)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.3148231753197893, 'auprc': 0.3148231753197893, 'loss_val': 2.9722156210003368, 'psi': 0.3148231753197893}-{'f1_val': 0.3150365183344628, 'auprc': 0.3150365183344628, 'loss_val': 2.9361771047800356, 'psi': 0.3150365183344628}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=21 head_norm_before_train=3.085521 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.2817272248551869, 'auprc': 0.2817272248551869, 'loss_val': 4.35159618790646, 'psi': 0.2817272248551869}-{'f1_val': 0.2824523196726721, 'auprc': 0.2824523196726721, 'loss_val': 4.317171586441014, 'psi': 0.2824523196726721}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=21 head_norm_before_train=3.673333 cos_to_last_merge=0.9318 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.9470764116218504, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.7536373014896784, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=2.947891 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.267810573509616, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.141955981225989, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=21 head_norm_before_train=3.296751 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0663076453138876, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0554211885675147, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=2.998501 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 6.742046190851175, 'psi': 0.1761185910512716}-{'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 6.66135533170054, 'psi': 0.1761185910512716}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=3.432013 (no previous merge yet)
[S17] round=21 local utility u=0.013091 metrics={'f1_val': 0.6119125607973191, 'auprc': 0.6119125607973191, 'loss_val': 0.3558152070533417, 'psi': 0.6119125607973191}-{'f1_val': 0.6094289590575556, 'auprc': 0.6094289590575556, 'loss_val': 0.3596440642643942, 'psi': 0.6094289590575556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=22 head_norm_before_train=2.745661 cos_to_last_merge=0.9853 (last merge round=2)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.8608282219683945, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.824376444676714, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=3.120118 cos_to_last_merge=0.9780 (last merge round=1)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.26336802146737354, 'auprc': 0.26336802146737354, 'loss_val': 5.316605272659263, 'psi': 0.26336802146737354}-{'f1_val': 0.26336802146737354, 'auprc': 0.26336802146737354, 'loss_val': 5.26409848838298, 'psi': 0.26336802146737354}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=3.718170 (no previous merge yet)
[S4] round=22 local utility u=0.003687 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1581029636181395, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1654770340645049, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=22 head_norm_before_train=4.155279 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.22283788710209548, 'auprc': 0.22283788710209548, 'loss_val': 2.918003695527447, 'psi': 0.22283788710209548}-{'f1_val': 0.22276161224549898, 'auprc': 0.22276161224549898, 'loss_val': 2.7678920099131985, 'psi': 0.22276161224549895}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=2.647589 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.08974862529457973, 'auprc': 0.08974862529457973, 'loss_val': 10.594668352852473, 'psi': 0.08974862529457973}-{'f1_val': 0.08974862529457973, 'auprc': 0.08974862529457973, 'loss_val': 10.522122038122292, 'psi': 0.08974862529457973}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=22 head_norm_before_train=3.943784 (no previous merge yet)
[S7] round=22 local utility u=0.012723 metrics={'f1_val': 0.6641578689459691, 'auprc': 0.6641578689459691, 'loss_val': 0.05471066951347084, 'psi': 0.6641578689459691}-{'f1_val': 0.6636554092885958, 'auprc': 0.6636554092885958, 'loss_val': 0.07563456838061942, 'psi': 0.6636554092885958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=22 head_norm_before_train=3.305825 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.6214224727134225, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.5728055768351745, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=22 head_norm_before_train=2.852587 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.303605588253749, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.24548473132737, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=3.297427 (no previous merge yet)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.31453916704254997, 'auprc': 0.31453916704254997, 'loss_val': 3.007547767858298, 'psi': 0.31453916704254997}-{'f1_val': 0.3148231753197893, 'auprc': 0.3148231753197893, 'loss_val': 2.9722156210003368, 'psi': 0.3148231753197893}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=22 head_norm_before_train=3.113985 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.2812274131020435, 'auprc': 0.2812274131020435, 'loss_val': 4.38656499597332, 'psi': 0.2812274131020435}-{'f1_val': 0.2817272248551869, 'auprc': 0.2817272248551869, 'loss_val': 4.35159618790646, 'psi': 0.2817272248551869}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=22 head_norm_before_train=3.663085 cos_to_last_merge=0.9323 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.430655280424347, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.9470764116218504, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=2.974922 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.391889956220304, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.267810573509616, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=22 head_norm_before_train=3.321890 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0786972595072049, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0663076453138876, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=22 head_norm_before_train=3.025296 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 6.829990684353517, 'psi': 0.1761185910512716}-{'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 6.742046190851175, 'psi': 0.1761185910512716}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=3.460795 (no previous merge yet)
[S17] round=22 local utility u=0.006376 metrics={'f1_val': 0.6133867856311507, 'auprc': 0.6133867856311507, 'loss_val': 0.35633123157600066, 'psi': 0.6133867856311507}-{'f1_val': 0.6119125607973191, 'auprc': 0.6119125607973191, 'loss_val': 0.3558152070533417, 'psi': 0.6119125607973191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=23 head_norm_before_train=2.765167 cos_to_last_merge=0.9846 (last merge round=2)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.896807965793539, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.8608282219683945, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=3.148966 cos_to_last_merge=0.9771 (last merge round=1)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.26326463853451093, 'auprc': 0.26326463853451093, 'loss_val': 5.3702524024825244, 'psi': 0.26326463853451093}-{'f1_val': 0.26336802146737354, 'auprc': 0.26336802146737354, 'loss_val': 5.316605272659263, 'psi': 0.26336802146737354}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=3.781175 (no previous merge yet)
[S4] round=23 local utility u=0.018174 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.121754918029761, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1581029636181395, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=23 head_norm_before_train=4.195209 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.22283788710209548, 'auprc': 0.22283788710209548, 'loss_val': 3.0486413175696687, 'psi': 0.22283788710209548}-{'f1_val': 0.22283788710209548, 'auprc': 0.22283788710209548, 'loss_val': 2.918003695527447, 'psi': 0.22283788710209548}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=23 head_norm_before_train=2.665723 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.085680285600952, 'auprc': 0.085680285600952, 'loss_val': 10.66644226218986, 'psi': 0.085680285600952}-{'f1_val': 0.08974862529457973, 'auprc': 0.08974862529457973, 'loss_val': 10.594668352852473, 'psi': 0.08974862529457973}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=4.047948 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.6637394309508321, 'auprc': 0.6637394309508321, 'loss_val': 0.10262561401449309, 'psi': 0.6637394309508321}-{'f1_val': 0.6641578689459691, 'auprc': 0.6641578689459691, 'loss_val': 0.05471066951347084, 'psi': 0.6641578689459691}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=23 head_norm_before_train=3.331107 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.6689419873996574, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.6214224727134225, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=23 head_norm_before_train=2.878545 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.3610707534337, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.303605588253749, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=23 head_norm_before_train=3.322957 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.3144682450206689, 'auprc': 0.3144682450206689, 'loss_val': 3.0427713201170357, 'psi': 0.3144682450206689}-{'f1_val': 0.31453916704254997, 'auprc': 0.31453916704254997, 'loss_val': 3.007547767858298, 'psi': 0.31453916704254997}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=23 head_norm_before_train=3.142220 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.28100584334580786, 'auprc': 0.28100584334580786, 'loss_val': 4.421761126733098, 'psi': 0.28100584334580786}-{'f1_val': 0.2812274131020435, 'auprc': 0.2812274131020435, 'loss_val': 4.38656499597332, 'psi': 0.2812274131020435}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=23 head_norm_before_train=3.686595 cos_to_last_merge=0.9288 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.929
[S13] round=23 local utility u=0.173106 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.0844425476369493, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.430655280424347, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=23 head_norm_before_train=3.001792 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.515221509448581, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.391889956220304, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=23 head_norm_before_train=3.346422 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0906988963954263, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0786972595072049, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=3.051928 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.17621864164797063, 'auprc': 0.17621864164797063, 'loss_val': 6.894665131662897, 'psi': 0.17621864164797063}-{'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 6.829990684353517, 'psi': 0.1761185910512716}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=23 head_norm_before_train=3.486505 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.612465384871023, 'auprc': 0.612465384871023, 'loss_val': 0.3655215176349716, 'psi': 0.612465384871023}-{'f1_val': 0.6133867856311507, 'auprc': 0.6133867856311507, 'loss_val': 0.35633123157600066, 'psi': 0.6133867856311507}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=24 head_norm_before_train=2.784271 cos_to_last_merge=0.9840 (last merge round=2)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.931539801541177, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.896807965793539, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=3.177568 cos_to_last_merge=0.9763 (last merge round=1)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.26321297749869177, 'auprc': 0.26321297749869177, 'loss_val': 5.4224233548434615, 'psi': 0.26321297749869177}-{'f1_val': 0.26326463853451093, 'auprc': 0.26326463853451093, 'loss_val': 5.3702524024825244, 'psi': 0.26326463853451093}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=24 head_norm_before_train=3.834418 (no previous merge yet)
[S4] round=24 local utility u=0.007511 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1067320794900093, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.121754918029761, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] sending update (kind=head size=1787 to 1 peers)
[S5] START round=24 head_norm_before_train=4.233299 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.22283788710209548, 'auprc': 0.22283788710209548, 'loss_val': 3.185640651803156, 'psi': 0.22283788710209548}-{'f1_val': 0.22283788710209548, 'auprc': 0.22283788710209548, 'loss_val': 3.0486413175696687, 'psi': 0.22283788710209548}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=2.683268 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.08502185141040922, 'auprc': 0.08502185141040922, 'loss_val': 10.723561474363295, 'psi': 0.08502185141040922}-{'f1_val': 0.085680285600952, 'auprc': 0.085680285600952, 'loss_val': 10.66644226218986, 'psi': 0.085680285600952}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=4.082624 (no previous merge yet)
[S7] round=24 local utility u=0.008513 metrics={'f1_val': 0.6638234105917321, 'auprc': 0.6638234105917321, 'loss_val': 0.08635515384143752, 'psi': 0.6638234105917321}-{'f1_val': 0.6637394309508321, 'auprc': 0.6637394309508321, 'loss_val': 0.10262561401449309, 'psi': 0.6637394309508321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=24 head_norm_before_train=3.355729 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.7148055012773162, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.6689419873996574, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=24 head_norm_before_train=2.904245 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.416967757137167, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.3610707534337, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=3.347930 (no previous merge yet)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.3143973549744515, 'auprc': 0.3143973549744515, 'loss_val': 3.0768741753911857, 'psi': 0.3143973549744515}-{'f1_val': 0.3144682450206689, 'auprc': 0.3144682450206689, 'loss_val': 3.0427713201170357, 'psi': 0.3144682450206689}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=24 head_norm_before_train=3.170195 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.28072937163846257, 'auprc': 0.28072937163846257, 'loss_val': 4.456518868548125, 'psi': 0.28072937163846257}-{'f1_val': 0.28100584334580786, 'auprc': 0.28100584334580786, 'loss_val': 4.421761126733098, 'psi': 0.28100584334580786}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=24 head_norm_before_train=3.770906 cos_to_last_merge=0.9270 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.927
[S13] round=24 local utility u=0.082124 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.9201953298106136, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.0844425476369493, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=24 head_norm_before_train=3.028512 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.637326686492111, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.515221509448581, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=24 head_norm_before_train=3.370524 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1010124733872484, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.0906988963954263, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=24 head_norm_before_train=3.078283 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.17651854871585815, 'auprc': 0.17651854871585815, 'loss_val': 6.965208253584161, 'psi': 0.17651854871585815}-{'f1_val': 0.17621864164797063, 'auprc': 0.17621864164797063, 'loss_val': 6.894665131662897, 'psi': 0.17621864164797063}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=3.510386 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.6093328028623981, 'auprc': 0.6093328028623981, 'loss_val': 0.3852972181741974, 'psi': 0.6093328028623981}-{'f1_val': 0.612465384871023, 'auprc': 0.612465384871023, 'loss_val': 0.3655215176349716, 'psi': 0.612465384871023}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=2.802978 cos_to_last_merge=0.9834 (last merge round=2)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.965502429090048, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.931539801541177, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=25 head_norm_before_train=3.205946 cos_to_last_merge=0.9755 (last merge round=1)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.26321297749869177, 'auprc': 0.26321297749869177, 'loss_val': 5.473100950147055, 'psi': 0.26321297749869177}-{'f1_val': 0.26321297749869177, 'auprc': 0.26321297749869177, 'loss_val': 5.4224233548434615, 'psi': 0.26321297749869177}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=3.880636 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1213666991126017, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1067320794900093, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=25 head_norm_before_train=4.268873 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.22283788710209548, 'auprc': 0.22283788710209548, 'loss_val': 3.279564271051688, 'psi': 0.22283788710209548}-{'f1_val': 0.22283788710209548, 'auprc': 0.22283788710209548, 'loss_val': 3.185640651803156, 'psi': 0.22283788710209548}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=2.700648 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.08369868473495416, 'auprc': 0.08369868473495416, 'loss_val': 10.791184557778417, 'psi': 0.08369868473495416}-{'f1_val': 0.08502185141040922, 'auprc': 0.08502185141040922, 'loss_val': 10.723561474363295, 'psi': 0.08502185141040922}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=4.184244 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6635700089004647, 'auprc': 0.6635700089004647, 'loss_val': 0.09043735918396373, 'psi': 0.6635700089004647}-{'f1_val': 0.6638234105917321, 'auprc': 0.6638234105917321, 'loss_val': 0.08635515384143752, 'psi': 0.6638234105917321}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=25 head_norm_before_train=3.379839 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.7599186420290307, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.7148055012773162, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=25 head_norm_before_train=2.929729 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.473703909665711, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.416967757137167, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=3.372415 (no previous merge yet)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.3143973549744515, 'auprc': 0.3143973549744515, 'loss_val': 3.110922480075507, 'psi': 0.3143973549744515}-{'f1_val': 0.3143973549744515, 'auprc': 0.3143973549744515, 'loss_val': 3.0768741753911857, 'psi': 0.3143973549744515}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=25 head_norm_before_train=3.197876 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.28061893522161024, 'auprc': 0.28061893522161024, 'loss_val': 4.491291587048336, 'psi': 0.28061893522161024}-{'f1_val': 0.28072937163846257, 'auprc': 0.28072937163846257, 'loss_val': 4.456518868548125, 'psi': 0.28072937163846257}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=3.824007 cos_to_last_merge=0.9265 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.926
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.2249243457579357, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 2.9201953298106136, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=3.055130 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.758715690968602, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.637326686492111, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=25 head_norm_before_train=3.393892 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1118665990240615, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1010124733872484, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=3.104514 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.17681808922387451, 'auprc': 0.17681808922387451, 'loss_val': 7.0328395082983715, 'psi': 0.17681808922387451}-{'f1_val': 0.17651854871585815, 'auprc': 0.17651854871585815, 'loss_val': 6.965208253584161, 'psi': 0.17651854871585815}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=3.532842 (no previous merge yet)
[S17] round=25 local utility u=0.030621 metrics={'f1_val': 0.6141239369820352, 'auprc': 0.6141239369820352, 'loss_val': 0.3671753427196042, 'psi': 0.6141239369820352}-{'f1_val': 0.6093328028623981, 'auprc': 0.6093328028623981, 'loss_val': 0.3852972181741974, 'psi': 0.6093328028623981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=26 head_norm_before_train=2.821352 cos_to_last_merge=0.9828 (last merge round=2)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.999434990201754, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.965502429090048, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=3.234144 cos_to_last_merge=0.9747 (last merge round=1)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.2631613367340266, 'auprc': 0.2631613367340266, 'loss_val': 5.524580555125492, 'psi': 0.2631613367340266}-{'f1_val': 0.26321297749869177, 'auprc': 0.26321297749869177, 'loss_val': 5.473100950147055, 'psi': 0.26321297749869177}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=3.926966 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1345977609657636, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1213666991126017, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=26 head_norm_before_train=4.303724 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.22283788710209548, 'auprc': 0.22283788710209548, 'loss_val': 3.390900896480659, 'psi': 0.22283788710209548}-{'f1_val': 0.22283788710209548, 'auprc': 0.22283788710209548, 'loss_val': 3.279564271051688, 'psi': 0.22283788710209548}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=2.717403 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.08502185141040922, 'auprc': 0.08502185141040922, 'loss_val': 10.852779476323184, 'psi': 0.08502185141040922}-{'f1_val': 0.08369868473495416, 'auprc': 0.08369868473495416, 'loss_val': 10.791184557778417, 'psi': 0.08369868473495416}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=4.260326 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.4974237408711758, 'auprc': 0.4974237408711758, 'loss_val': 0.08902931844677911, 'psi': 0.4974237408711758}-{'f1_val': 0.6635700089004647, 'auprc': 0.6635700089004647, 'loss_val': 0.09043735918396373, 'psi': 0.6635700089004647}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=3.403447 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8041272899019694, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.7599186420290307, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=26 head_norm_before_train=2.955249 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.529785560256045, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.473703909665711, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=3.396512 (no previous merge yet)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.31425567072254773, 'auprc': 0.31425567072254773, 'loss_val': 3.1446860902691296, 'psi': 0.31425567072254773}-{'f1_val': 0.3143973549744515, 'auprc': 0.3143973549744515, 'loss_val': 3.110922480075507, 'psi': 0.3143973549744515}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=26 head_norm_before_train=3.225259 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.28056374959029823, 'auprc': 0.28056374959029823, 'loss_val': 4.526364204724474, 'psi': 0.28056374959029823}-{'f1_val': 0.28061893522161024, 'auprc': 0.28061893522161024, 'loss_val': 4.491291587048336, 'psi': 0.28061893522161024}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=3.586064 cos_to_last_merge=0.9336 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.934
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.6650529031540824, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.2249243457579357, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=3.081551 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.87925979939255, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.758715690968602, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=3.416825 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1224348187171604, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1118665990240615, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=3.130728 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.17651854871585815, 'auprc': 0.17651854871585815, 'loss_val': 7.12223014907036, 'psi': 0.17651854871585815}-{'f1_val': 0.17681808922387451, 'auprc': 0.17681808922387451, 'loss_val': 7.0328395082983715, 'psi': 0.17681808922387451}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=3.553857 (no previous merge yet)
[S17] round=26 local utility u=0.006339 metrics={'f1_val': 0.6155983449854433, 'auprc': 0.6155983449854433, 'loss_val': 0.367767108890283, 'psi': 0.6155983449854433}-{'f1_val': 0.6141239369820352, 'auprc': 0.6141239369820352, 'loss_val': 0.3671753427196042, 'psi': 0.6141239369820352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=27 head_norm_before_train=2.839431 cos_to_last_merge=0.9823 (last merge round=2)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.033554310782829, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 4.999434990201754, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=3.262178 cos_to_last_merge=0.9739 (last merge round=1)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.2631613367340266, 'auprc': 0.2631613367340266, 'loss_val': 5.57459170458613, 'psi': 0.2631613367340266}-{'f1_val': 0.2631613367340266, 'auprc': 0.2631613367340266, 'loss_val': 5.524580555125492, 'psi': 0.2631613367340266}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=3.959615 (no previous merge yet)
[S4] round=27 local utility u=0.023001 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0885956839263073, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1345977609657636, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=27 head_norm_before_train=4.336936 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.22291412009543368, 'auprc': 0.22291412009543368, 'loss_val': 3.4864593232484022, 'psi': 0.22291412009543368}-{'f1_val': 0.22283788710209548, 'auprc': 0.22283788710209548, 'loss_val': 3.390900896480659, 'psi': 0.22283788710209548}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=2.734098 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.08403026682596575, 'auprc': 0.08403026682596575, 'loss_val': 10.926793351067486, 'psi': 0.08403026682596575}-{'f1_val': 0.08502185141040922, 'auprc': 0.08502185141040922, 'loss_val': 10.852779476323184, 'psi': 0.08502185141040922}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=4.203850 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.4975501853675723, 'auprc': 0.4975501853675723, 'loss_val': 0.10608693864530115, 'psi': 0.4975501853675723}-{'f1_val': 0.4974237408711758, 'auprc': 0.4974237408711758, 'loss_val': 0.08902931844677911, 'psi': 0.4974237408711758}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=27 head_norm_before_train=3.426665 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8500117822740116, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8041272899019694, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=27 head_norm_before_train=2.980580 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.585934597382334, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.529785560256045, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=3.420185 (no previous merge yet)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.3141141141141141, 'auprc': 0.3141141141141141, 'loss_val': 3.1778564910413163, 'psi': 0.3141141141141141}-{'f1_val': 0.31425567072254773, 'auprc': 0.31425567072254773, 'loss_val': 3.1446860902691296, 'psi': 0.31425567072254773}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=27 head_norm_before_train=3.252525 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.28050858565998166, 'auprc': 0.28050858565998166, 'loss_val': 4.561880607930043, 'psi': 0.28050858565998166}-{'f1_val': 0.28056374959029823, 'auprc': 0.28056374959029823, 'loss_val': 4.526364204724474, 'psi': 0.28056374959029823}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=3.670054 cos_to_last_merge=0.9328 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.933
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.751009759349701, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.6650529031540824, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=3.108012 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.00020622778348, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.87925979939255, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=3.439488 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1335823823045668, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1224348187171604, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=3.156780 (no previous merge yet)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.17671828307525128, 'auprc': 0.17671828307525128, 'loss_val': 7.193538767328176, 'psi': 0.17671828307525128}-{'f1_val': 0.17651854871585815, 'auprc': 0.17651854871585815, 'loss_val': 7.12223014907036, 'psi': 0.17651854871585815}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=3.573958 (no previous merge yet)
[S17] round=27 local utility u=0.001796 metrics={'f1_val': 0.6161512912623742, 'auprc': 0.6161512912623742, 'loss_val': 0.3691509675601839, 'psi': 0.6161512912623742}-{'f1_val': 0.6155983449854433, 'auprc': 0.6155983449854433, 'loss_val': 0.367767108890283, 'psi': 0.6155983449854433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=28 head_norm_before_train=2.857319 cos_to_last_merge=0.9817 (last merge round=2)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.0669541891228524, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.033554310782829, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=3.290106 cos_to_last_merge=0.9731 (last merge round=1)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.2631613367340266, 'auprc': 0.2631613367340266, 'loss_val': 5.626139866343941, 'psi': 0.2631613367340266}-{'f1_val': 0.2631613367340266, 'auprc': 0.2631613367340266, 'loss_val': 5.57459170458613, 'psi': 0.2631613367340266}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=3.993733 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.23838017527954067, 'auprc': 0.23838017527954067, 'loss_val': 1.0107357113546773, 'psi': 0.2383801752795407}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0885956839263073, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=4.369758 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.22291412009543368, 'auprc': 0.22291412009543368, 'loss_val': 3.5827891895272597, 'psi': 0.22291412009543368}-{'f1_val': 0.22291412009543368, 'auprc': 0.22291412009543368, 'loss_val': 3.4864593232484022, 'psi': 0.22291412009543368}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=2.750524 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.08369868473495416, 'auprc': 0.08369868473495416, 'loss_val': 10.998599284586339, 'psi': 0.08369868473495416}-{'f1_val': 0.08403026682596575, 'auprc': 0.08403026682596575, 'loss_val': 10.926793351067486, 'psi': 0.08403026682596575}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=4.350020 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.49761336009215623, 'auprc': 0.49761336009215623, 'loss_val': 0.12647358884817542, 'psi': 0.4976133600921562}-{'f1_val': 0.4975501853675723, 'auprc': 0.4975501853675723, 'loss_val': 0.10608693864530115, 'psi': 0.4975501853675723}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=3.449657 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8934222665399, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8500117822740116, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=3.005810 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.642804012270543, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.585934597382334, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=3.443542 (no previous merge yet)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.31404338362230727, 'auprc': 0.31404338362230727, 'loss_val': 3.2102959661263535, 'psi': 0.31404338362230727}-{'f1_val': 0.3141141141141141, 'auprc': 0.3141141141141141, 'loss_val': 3.1778564910413163, 'psi': 0.3141141141141141}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=28 head_norm_before_train=3.279692 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.28050858565998166, 'auprc': 0.28050858565998166, 'loss_val': 4.597402288357485, 'psi': 0.28050858565998166}-{'f1_val': 0.28050858565998166, 'auprc': 0.28050858565998166, 'loss_val': 4.561880607930043, 'psi': 0.28050858565998166}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=28 head_norm_before_train=3.719033 cos_to_last_merge=0.9313 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.931
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.8243455835191784, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.751009759349701, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=3.134379 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.11930674558606, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.00020622778348, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=3.461818 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.143429100591831, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1335823823045668, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=3.182854 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.17671828307525128, 'auprc': 0.17671828307525128, 'loss_val': 7.27040060104714, 'psi': 0.17671828307525128}-{'f1_val': 0.17671828307525128, 'auprc': 0.17671828307525128, 'loss_val': 7.193538767328176, 'psi': 0.17671828307525128}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=3.593874 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6163356126203129, 'auprc': 0.6163356126203129, 'loss_val': 0.37265616348434055, 'psi': 0.6163356126203129}-{'f1_val': 0.6161512912623742, 'auprc': 0.6161512912623742, 'loss_val': 0.3691509675601839, 'psi': 0.6161512912623742}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=2.874956 cos_to_last_merge=0.9811 (last merge round=2)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.0991862625672315, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.0669541891228524, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=3.317958 cos_to_last_merge=0.9723 (last merge round=1)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.2631613367340266, 'auprc': 0.2631613367340266, 'loss_val': 5.6774974471708255, 'psi': 0.2631613367340266}-{'f1_val': 0.2631613367340266, 'auprc': 0.2631613367340266, 'loss_val': 5.626139866343941, 'psi': 0.2631613367340266}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=4.030303 (no previous merge yet)
[S4] round=29 local utility u=0.090168 metrics={'f1_val': 0.2410463268549077, 'auprc': 0.2410463268549077, 'loss_val': 0.8543949748154902, 'psi': 0.24104632685490773}-{'f1_val': 0.23838017527954067, 'auprc': 0.23838017527954067, 'loss_val': 1.0107357113546773, 'psi': 0.2383801752795407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=29 head_norm_before_train=4.401301 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.22291412009543368, 'auprc': 0.22291412009543368, 'loss_val': 3.6907775106307144, 'psi': 0.22291412009543368}-{'f1_val': 0.22291412009543368, 'auprc': 0.22291412009543368, 'loss_val': 3.5827891895272597, 'psi': 0.22291412009543368}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=2.766700 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.0853513298928146, 'auprc': 0.0853513298928146, 'loss_val': 11.061224910458117, 'psi': 0.0853513298928146}-{'f1_val': 0.08369868473495416, 'auprc': 0.08369868473495416, 'loss_val': 10.998599284586339, 'psi': 0.08369868473495416}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=4.439805 (no previous merge yet)
[S7] round=29 local utility u=0.762958 metrics={'f1_val': 0.6641578689459691, 'auprc': 0.6641578689459691, 'loss_val': 0.09945809554982193, 'psi': 0.6641578689459691}-{'f1_val': 0.49761336009215623, 'auprc': 0.49761336009215623, 'loss_val': 0.12647358884817542, 'psi': 0.4976133600921562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=29 head_norm_before_train=3.472167 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.9374704501527225, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8934222665399, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=3.031163 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.697595873136538, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.642804012270543, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=3.466593 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.31404338362230727, 'auprc': 0.31404338362230727, 'loss_val': 3.241662149305117, 'psi': 0.31404338362230727}-{'f1_val': 0.31404338362230727, 'auprc': 0.31404338362230727, 'loss_val': 3.2102959661263535, 'psi': 0.31404338362230727}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=29 head_norm_before_train=3.306746 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.28050858565998166, 'auprc': 0.28050858565998166, 'loss_val': 4.632969355290547, 'psi': 0.28050858565998166}-{'f1_val': 0.28050858565998166, 'auprc': 0.28050858565998166, 'loss_val': 4.597402288357485, 'psi': 0.28050858565998166}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=3.764734 cos_to_last_merge=0.9306 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.931
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.931098380214046, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.8243455835191784, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=3.160580 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.239013428000575, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.11930674558606, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=3.483702 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1542174856719045, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.143429100591831, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=3.208839 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.17621864164797063, 'auprc': 0.17621864164797063, 'loss_val': 7.364534256209628, 'psi': 0.17621864164797063}-{'f1_val': 0.17671828307525128, 'auprc': 0.17671828307525128, 'loss_val': 7.27040060104714, 'psi': 0.17671828307525128}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=3.612934 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.6163356126203129, 'auprc': 0.6163356126203129, 'loss_val': 0.37656630040381434, 'psi': 0.6163356126203129}-{'f1_val': 0.6163356126203129, 'auprc': 0.6163356126203129, 'loss_val': 0.37265616348434055, 'psi': 0.6163356126203129}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=2.892363 cos_to_last_merge=0.9806 (last merge round=2)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.1322687128489015, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.0991862625672315, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=3.345717 cos_to_last_merge=0.9715 (last merge round=1)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.2631613367340266, 'auprc': 0.2631613367340266, 'loss_val': 5.728011220006038, 'psi': 0.2631613367340266}-{'f1_val': 0.2631613367340266, 'auprc': 0.2631613367340266, 'loss_val': 5.6774974471708255, 'psi': 0.2631613367340266}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=4.017771 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.24060517325524647, 'auprc': 0.24060517325524647, 'loss_val': 0.8716166522136083, 'psi': 0.2406051732552465}-{'f1_val': 0.2410463268549077, 'auprc': 0.2410463268549077, 'loss_val': 0.8543949748154902, 'psi': 0.24104632685490773}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=4.432517 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.22299031125996893, 'auprc': 0.22299031125996893, 'loss_val': 3.7746463330718045, 'psi': 0.22299031125996893}-{'f1_val': 0.22291412009543368, 'auprc': 0.22291412009543368, 'loss_val': 3.6907775106307144, 'psi': 0.22291412009543368}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=2.782645 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.0853513298928146, 'auprc': 0.0853513298928146, 'loss_val': 11.130654968285674, 'psi': 0.0853513298928146}-{'f1_val': 0.0853513298928146, 'auprc': 0.0853513298928146, 'loss_val': 11.061224910458117, 'psi': 0.0853513298928146}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=4.530862 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.6632316544949011, 'auprc': 0.6632316544949011, 'loss_val': 0.1416594842246841, 'psi': 0.6632316544949011}-{'f1_val': 0.6641578689459691, 'auprc': 0.6641578689459691, 'loss_val': 0.09945809554982193, 'psi': 0.6641578689459691}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=3.494519 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.979396113409655, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.9374704501527225, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=3.056128 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.753048986424141, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.697595873136538, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=3.489369 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.31404338362230727, 'auprc': 0.31404338362230727, 'loss_val': 3.273916563117774, 'psi': 0.31404338362230727}-{'f1_val': 0.31404338362230727, 'auprc': 0.31404338362230727, 'loss_val': 3.241662149305117, 'psi': 0.31404338362230727}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=30 head_norm_before_train=3.333553 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.28045344341786255, 'auprc': 0.28045344341786255, 'loss_val': 4.668920023719828, 'psi': 0.28045344341786255}-{'f1_val': 0.28050858565998166, 'auprc': 0.28050858565998166, 'loss_val': 4.632969355290547, 'psi': 0.28050858565998166}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=3.798170 cos_to_last_merge=0.9297 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.930
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.9567292741328046, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.931098380214046, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=3.186871 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.357958882443263, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.239013428000575, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=3.505238 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1640546151623592, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1542174856719045, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=3.234723 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.17671828307525128, 'auprc': 0.17671828307525128, 'loss_val': 7.423719618098625, 'psi': 0.17671828307525128}-{'f1_val': 0.17621864164797063, 'auprc': 0.17621864164797063, 'loss_val': 7.364534256209628, 'psi': 0.17621864164797063}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=3.631865 (no previous merge yet)
[S17] round=30 local utility u=0.000116 metrics={'f1_val': 0.6167042647499696, 'auprc': 0.6167042647499696, 'loss_val': 0.3796524163957652, 'psi': 0.6167042647499696}-{'f1_val': 0.6163356126203129, 'auprc': 0.6163356126203129, 'loss_val': 0.37656630040381434, 'psi': 0.6163356126203129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=31 head_norm_before_train=2.909620 cos_to_last_merge=0.9800 (last merge round=2)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.1652470997420155, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.1322687128489015, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=3.373335 cos_to_last_merge=0.9707 (last merge round=1)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.2631613367340266, 'auprc': 0.2631613367340266, 'loss_val': 5.7788201702050195, 'psi': 0.2631613367340266}-{'f1_val': 0.2631613367340266, 'auprc': 0.2631613367340266, 'loss_val': 5.728011220006038, 'psi': 0.2631613367340266}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=4.067140 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.24126751085826145, 'auprc': 0.24126751085826145, 'loss_val': 0.907208973287469, 'psi': 0.24126751085826145}-{'f1_val': 0.24060517325524647, 'auprc': 0.24060517325524647, 'loss_val': 0.8716166522136083, 'psi': 0.2406051732552465}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=4.463346 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.22299031125996893, 'auprc': 0.22299031125996893, 'loss_val': 3.8692601522290344, 'psi': 0.22299031125996893}-{'f1_val': 0.22299031125996893, 'auprc': 0.22299031125996893, 'loss_val': 3.7746463330718045, 'psi': 0.22299031125996893}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=2.798635 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.08419585987261147, 'auprc': 0.08419585987261147, 'loss_val': 11.20671929154737, 'psi': 0.08419585987261147}-{'f1_val': 0.0853513298928146, 'auprc': 0.0853513298928146, 'loss_val': 11.130654968285674, 'psi': 0.0853513298928146}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=4.592625 (no previous merge yet)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.6631472947355797, 'auprc': 0.6631472947355797, 'loss_val': 0.1946277411220548, 'psi': 0.6631472947355797}-{'f1_val': 0.6632316544949011, 'auprc': 0.6632316544949011, 'loss_val': 0.1416594842246841, 'psi': 0.6632316544949011}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=3.516383 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.021995734499719, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.979396113409655, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=3.081290 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.809277555922084, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.753048986424141, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=3.511830 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.3138313831383138, 'auprc': 0.3138313831383138, 'loss_val': 3.305174719112162, 'psi': 0.3138313831383138}-{'f1_val': 0.31404338362230727, 'auprc': 0.31404338362230727, 'loss_val': 3.273916563117774, 'psi': 0.31404338362230727}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=3.360279 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 4.704913435509388, 'psi': 0.280398322851153}-{'f1_val': 0.28045344341786255, 'auprc': 0.28045344341786255, 'loss_val': 4.668920023719828, 'psi': 0.28045344341786255}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=3.814851 cos_to_last_merge=0.9292 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.929
[S13] round=31 local utility u=0.032548 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.8916340871863047, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.9567292741328046, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=31 head_norm_before_train=3.213096 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.47569729667535, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.357958882443263, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=3.526538 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1741473847918769, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1640546151623592, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=3.260588 (no previous merge yet)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.17681808922387451, 'auprc': 0.17681808922387451, 'loss_val': 7.497083825947698, 'psi': 0.17681808922387451}-{'f1_val': 0.17671828307525128, 'auprc': 0.17671828307525128, 'loss_val': 7.423719618098625, 'psi': 0.17671828307525128}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=3.650405 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6161512912623742, 'auprc': 0.6161512912623742, 'loss_val': 0.3899180349080291, 'psi': 0.6161512912623742}-{'f1_val': 0.6167042647499696, 'auprc': 0.6167042647499696, 'loss_val': 0.3796524163957652, 'psi': 0.6167042647499696}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=2.926747 cos_to_last_merge=0.9794 (last merge round=2)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.197124662962799, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.1652470997420155, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=3.400988 cos_to_last_merge=0.9700 (last merge round=1)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 5.8296744254354635, 'psi': 0.26310971622858637}-{'f1_val': 0.2631613367340266, 'auprc': 0.2631613367340266, 'loss_val': 5.7788201702050195, 'psi': 0.2631613367340266}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=4.114480 (no previous merge yet)
[S4] round=32 local utility u=0.006938 metrics={'f1_val': 0.2413560981580075, 'auprc': 0.2413560981580075, 'loss_val': 0.8941296897161908, 'psi': 0.2413560981580075}-{'f1_val': 0.24126751085826145, 'auprc': 0.24126751085826145, 'loss_val': 0.907208973287469, 'psi': 0.24126751085826145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=32 head_norm_before_train=4.493439 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.22306646063011884, 'auprc': 0.22306646063011884, 'loss_val': 3.9533900601854426, 'psi': 0.22306646063011884}-{'f1_val': 0.22299031125996893, 'auprc': 0.22299031125996893, 'loss_val': 3.8692601522290344, 'psi': 0.22299031125996893}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=2.814460 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.0853513298928146, 'auprc': 0.0853513298928146, 'loss_val': 11.27254706911685, 'psi': 0.0853513298928146}-{'f1_val': 0.08419585987261147, 'auprc': 0.08419585987261147, 'loss_val': 11.20671929154737, 'psi': 0.08419585987261147}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=4.649364 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.4976765031660766, 'auprc': 0.4976765031660766, 'loss_val': 0.29017854153443345, 'psi': 0.4976765031660766}-{'f1_val': 0.6631472947355797, 'auprc': 0.6631472947355797, 'loss_val': 0.1946277411220548, 'psi': 0.6631472947355797}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=3.538083 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.064077425174582, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.021995734499719, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=3.106374 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.86486436377944, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.809277555922084, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=3.534112 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.3138313831383138, 'auprc': 0.3138313831383138, 'loss_val': 3.339421515505919, 'psi': 0.3138313831383138}-{'f1_val': 0.3138313831383138, 'auprc': 0.3138313831383138, 'loss_val': 3.305174719112162, 'psi': 0.3138313831383138}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=3.386969 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 4.740933670371774, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 4.704913435509388, 'psi': 0.280398322851153}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=3.799104 cos_to_last_merge=0.9295 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.930
[S13] round=32 local utility u=0.013445 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.864743672518921, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.8916340871863047, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=32 head_norm_before_train=3.239261 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.594573847237772, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.47569729667535, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=3.547707 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1830394148691292, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1741473847918769, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=3.286563 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.17691785471826205, 'auprc': 0.17691785471826205, 'loss_val': 7.5685642493838055, 'psi': 0.17691785471826205}-{'f1_val': 0.17681808922387451, 'auprc': 0.17681808922387451, 'loss_val': 7.497083825947698, 'psi': 0.17681808922387451}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=3.668662 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6161512912623742, 'auprc': 0.6161512912623742, 'loss_val': 0.39315292461894774, 'psi': 0.6161512912623742}-{'f1_val': 0.6161512912623742, 'auprc': 0.6161512912623742, 'loss_val': 0.3899180349080291, 'psi': 0.6161512912623742}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=2.943641 cos_to_last_merge=0.9789 (last merge round=2)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.228677268198925, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.197124662962799, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=3.428572 cos_to_last_merge=0.9692 (last merge round=1)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 5.878954117708022, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 5.8296744254354635, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=4.154393 (no previous merge yet)
[S4] round=33 local utility u=0.004669 metrics={'f1_val': 0.24157785128016662, 'auprc': 0.24157785128016662, 'loss_val': 0.8867880109425403, 'psi': 0.24157785128016662}-{'f1_val': 0.2413560981580075, 'auprc': 0.2413560981580075, 'loss_val': 0.8941296897161908, 'psi': 0.2413560981580075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=33 head_norm_before_train=4.523861 (no previous merge yet)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.22306646063011884, 'auprc': 0.22306646063011884, 'loss_val': 4.033304808528969, 'psi': 0.22306646063011884}-{'f1_val': 0.22306646063011884, 'auprc': 0.22306646063011884, 'loss_val': 3.9533900601854426, 'psi': 0.22306646063011884}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=2.830271 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.08584456780333069, 'auprc': 0.08584456780333069, 'loss_val': 11.340382370533174, 'psi': 0.08584456780333069}-{'f1_val': 0.0853513298928146, 'auprc': 0.0853513298928146, 'loss_val': 11.27254706911685, 'psi': 0.0853513298928146}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=4.731248 (no previous merge yet)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.32863744181522525, 'auprc': 0.32863744181522525, 'loss_val': 0.4792205631754654, 'psi': 0.32863744181522525}-{'f1_val': 0.4976765031660766, 'auprc': 0.4976765031660766, 'loss_val': 0.29017854153443345, 'psi': 0.4976765031660766}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=3.559621 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.105246092871236, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.064077425174582, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=3.131604 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.920049293583794, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.86486436377944, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=3.556111 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.3137607799025122, 'auprc': 0.3137607799025122, 'loss_val': 3.3690434427300864, 'psi': 0.3137607799025122}-{'f1_val': 0.3138313831383138, 'auprc': 0.3138313831383138, 'loss_val': 3.339421515505919, 'psi': 0.3138313831383138}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=3.413624 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 4.77734530576123, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 4.740933670371774, 'psi': 0.280398322851153}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=3.856537 cos_to_last_merge=0.9281 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.928
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.8964157582752614, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.864743672518921, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=3.265481 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.711921656335175, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.594573847237772, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=3.568596 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.193430569576842, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.1830394148691292, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=3.312226 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.17671828307525128, 'auprc': 0.17671828307525128, 'loss_val': 7.64945432876423, 'psi': 0.17671828307525128}-{'f1_val': 0.17691785471826205, 'auprc': 0.17691785471826205, 'loss_val': 7.5685642493838055, 'psi': 0.17691785471826205}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=3.686764 (no previous merge yet)
[S17] round=33 local utility u=0.004506 metrics={'f1_val': 0.6170729300041028, 'auprc': 0.6170729300041028, 'loss_val': 0.3924361323740038, 'psi': 0.6170729300041028}-{'f1_val': 0.6161512912623742, 'auprc': 0.6161512912623742, 'loss_val': 0.39315292461894774, 'psi': 0.6161512912623742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=34 head_norm_before_train=2.960361 cos_to_last_merge=0.9784 (last merge round=2)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.25996669536153, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.228677268198925, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=3.456036 cos_to_last_merge=0.9684 (last merge round=1)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 5.9294183060162755, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 5.878954117708022, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=4.196815 (no previous merge yet)
[S4] round=34 local utility u=0.011429 metrics={'f1_val': 0.2420225822287678, 'auprc': 0.2420225822287678, 'loss_val': 0.8679334699794258, 'psi': 0.24202258222876777}-{'f1_val': 0.24157785128016662, 'auprc': 0.24157785128016662, 'loss_val': 0.8867880109425403, 'psi': 0.24157785128016662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=34 head_norm_before_train=4.553594 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.22306646063011884, 'auprc': 0.22306646063011884, 'loss_val': 4.133425600943956, 'psi': 0.22306646063011884}-{'f1_val': 0.22306646063011884, 'auprc': 0.22306646063011884, 'loss_val': 4.033304808528969, 'psi': 0.22306646063011884}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=2.845813 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.08584456780333069, 'auprc': 0.08584456780333069, 'loss_val': 11.41248791528854, 'psi': 0.08584456780333069}-{'f1_val': 0.08584456780333069, 'auprc': 0.08584456780333069, 'loss_val': 11.340382370533174, 'psi': 0.08584456780333069}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=4.815501 (no previous merge yet)
[S7] round=34 local utility u=0.210129 metrics={'f1_val': 0.3616357018429775, 'auprc': 0.3616357018429775, 'loss_val': 0.35594784451657363, 'psi': 0.3616357018429775}-{'f1_val': 0.32863744181522525, 'auprc': 0.32863744181522525, 'loss_val': 0.4792205631754654, 'psi': 0.32863744181522525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=34 head_norm_before_train=3.580798 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.145552445556838, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.105246092871236, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=3.156200 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.976388121581122, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.920049293583794, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=3.577944 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.3137607799025122, 'auprc': 0.3137607799025122, 'loss_val': 3.4007876570878746, 'psi': 0.3137607799025122}-{'f1_val': 0.3137607799025122, 'auprc': 0.3137607799025122, 'loss_val': 3.3690434427300864, 'psi': 0.3137607799025122}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=3.440171 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 4.813757808985924, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 4.77734530576123, 'psi': 0.280398322851153}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=3.896406 cos_to_last_merge=0.9274 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.927
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.9049660722484196, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.8964157582752614, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=3.291637 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.832616229507432, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.711921656335175, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=3.589283 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2018538828483893, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.193430569576842, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=3.338031 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.17671828307525128, 'auprc': 0.17671828307525128, 'loss_val': 7.727917542740341, 'psi': 0.17671828307525128}-{'f1_val': 0.17671828307525128, 'auprc': 0.17671828307525128, 'loss_val': 7.64945432876423, 'psi': 0.17671828307525128}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=3.704925 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6160569538219481, 'auprc': 0.6160569538219481, 'loss_val': 0.40242483891878017, 'psi': 0.6160569538219481}-{'f1_val': 0.6170729300041028, 'auprc': 0.6170729300041028, 'loss_val': 0.3924361323740038, 'psi': 0.6170729300041028}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=2.976956 cos_to_last_merge=0.9778 (last merge round=2)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.291564044575464, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.25996669536153, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=3.483476 cos_to_last_merge=0.9677 (last merge round=1)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 5.9793309375340495, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 5.9294183060162755, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=4.230979 (no previous merge yet)
[S4] round=35 local utility u=0.500831 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.8992142692401287, 'psi': 0.3567939207526687}-{'f1_val': 0.2420225822287678, 'auprc': 0.2420225822287678, 'loss_val': 0.8679334699794258, 'psi': 0.24202258222876777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] sending update (kind=head size=1788 to 1 peers)
[S5] START round=35 head_norm_before_train=4.582807 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.22321863412474405, 'auprc': 0.22321863412474405, 'loss_val': 4.219941216496152, 'psi': 0.22321863412474405}-{'f1_val': 0.22306646063011884, 'auprc': 0.22306646063011884, 'loss_val': 4.133425600943956, 'psi': 0.22306646063011884}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=2.861281 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.08910306845003933, 'auprc': 0.08910306845003933, 'loss_val': 11.4741237648189, 'psi': 0.08910306845003933}-{'f1_val': 0.08584456780333069, 'auprc': 0.08584456780333069, 'loss_val': 11.41248791528854, 'psi': 0.08584456780333069}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=4.813256 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.2483120780195049, 'auprc': 0.2483120780195049, 'loss_val': 0.6577076460336135, 'psi': 0.2483120780195049}-{'f1_val': 0.3616357018429775, 'auprc': 0.3616357018429775, 'loss_val': 0.35594784451657363, 'psi': 0.3616357018429775}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=3.601680 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.185736468554885, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.145552445556838, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=3.181816 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.032091903471072, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.976388121581122, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=3.599594 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.3137607799025122, 'auprc': 0.3137607799025122, 'loss_val': 3.4332590072167273, 'psi': 0.3137607799025122}-{'f1_val': 0.3137607799025122, 'auprc': 0.3137607799025122, 'loss_val': 3.4007876570878746, 'psi': 0.3137607799025122}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=3.466801 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 4.85070993407653, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 4.813757808985924, 'psi': 0.280398322851153}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=3.928960 cos_to_last_merge=0.9268 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.927
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.9322825668376034, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.9049660722484196, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=3.317942 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.947362073744575, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.832616229507432, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=3.609716 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2115283471050422, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2018538828483893, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=3.363924 (no previous merge yet)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.17651854871585815, 'auprc': 0.17651854871585815, 'loss_val': 7.812406905030391, 'psi': 0.17651854871585815}-{'f1_val': 0.17671828307525128, 'auprc': 0.17671828307525128, 'loss_val': 7.727917542740341, 'psi': 0.17671828307525128}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=3.722602 (no previous merge yet)
[S17] round=35 local utility u=0.001771 metrics={'f1_val': 0.6166100765382713, 'auprc': 0.6166100765382713, 'loss_val': 0.40386165655900397, 'psi': 0.6166100765382713}-{'f1_val': 0.6160569538219481, 'auprc': 0.6160569538219481, 'loss_val': 0.40242483891878017, 'psi': 0.6160569538219481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=36 head_norm_before_train=2.993485 cos_to_last_merge=0.9773 (last merge round=2)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.323907635099491, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.291564044575464, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=3.510785 cos_to_last_merge=0.9669 (last merge round=1)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.029402474335614, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 5.9793309375340495, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=4.187639 (no previous merge yet)
[S4] round=36 local utility u=0.003883 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.8914487527248617, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.8992142692401287, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=36 head_norm_before_train=4.612613 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.22321863412474405, 'auprc': 0.22321863412474405, 'loss_val': 4.307928775750586, 'psi': 0.22321863412474405}-{'f1_val': 0.22321863412474405, 'auprc': 0.22321863412474405, 'loss_val': 4.219941216496152, 'psi': 0.22321863412474405}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=2.876794 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.08813091482649842, 'auprc': 0.08813091482649842, 'loss_val': 11.547862541078937, 'psi': 0.08813091482649842}-{'f1_val': 0.08910306845003933, 'auprc': 0.08910306845003933, 'loss_val': 11.4741237648189, 'psi': 0.08910306845003933}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=4.857521 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.24723618090452262, 'auprc': 0.24723618090452262, 'loss_val': 0.7685880588551662, 'psi': 0.2472361809045226}-{'f1_val': 0.2483120780195049, 'auprc': 0.2483120780195049, 'loss_val': 0.6577076460336135, 'psi': 0.2483120780195049}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=3.622538 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.2253405481638255, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.185736468554885, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=3.207001 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.087806396938903, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.032091903471072, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=3.621110 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.3137607799025122, 'auprc': 0.3137607799025122, 'loss_val': 3.4631373376732655, 'psi': 0.3137607799025122}-{'f1_val': 0.3137607799025122, 'auprc': 0.3137607799025122, 'loss_val': 3.4332590072167273, 'psi': 0.3137607799025122}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=3.493509 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 4.887847110293487, 'psi': 0.2803432239470754}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 4.85070993407653, 'psi': 0.280398322851153}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=3.957395 cos_to_last_merge=0.9263 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.926
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.958420945677165, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.9322825668376034, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=3.343989 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.064854916087711, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 12.947362073744575, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=3.630039 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2206115288993176, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2115283471050422, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=3.389837 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 7.908765057852064, 'psi': 0.1761185910512716}-{'f1_val': 0.17651854871585815, 'auprc': 0.17651854871585815, 'loss_val': 7.812406905030391, 'psi': 0.17651854871585815}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=3.740170 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6162413249621773, 'auprc': 0.6162413249621773, 'loss_val': 0.4118833287661471, 'psi': 0.6162413249621773}-{'f1_val': 0.6166100765382713, 'auprc': 0.6166100765382713, 'loss_val': 0.40386165655900397, 'psi': 0.6166100765382713}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=3.010002 cos_to_last_merge=0.9768 (last merge round=2)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.354889105792706, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.323907635099491, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=3.538226 cos_to_last_merge=0.9662 (last merge round=1)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.080164719901688, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.029402474335614, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=4.182405 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.2428272380248738, 'auprc': 0.2428272380248738, 'loss_val': 0.8316108065333719, 'psi': 0.2428272380248738}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 0.8914487527248617, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=4.641695 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.22329465831786593, 'auprc': 0.22329465831786593, 'loss_val': 4.385689928971668, 'psi': 0.22329465831786593}-{'f1_val': 0.22321863412474405, 'auprc': 0.22321863412474405, 'loss_val': 4.307928775750586, 'psi': 0.22321863412474405}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=2.892325 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.085680285600952, 'auprc': 0.085680285600952, 'loss_val': 11.625447624950024, 'psi': 0.085680285600952}-{'f1_val': 0.08813091482649842, 'auprc': 0.08813091482649842, 'loss_val': 11.547862541078937, 'psi': 0.08813091482649842}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=4.895315 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.24786967418546366, 'auprc': 0.24786967418546366, 'loss_val': 0.8465691233705406, 'psi': 0.24786967418546368}-{'f1_val': 0.24723618090452262, 'auprc': 0.24723618090452262, 'loss_val': 0.7685880588551662, 'psi': 0.2472361809045226}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=3.643195 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.264423947204826, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.2253405481638255, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=3.231759 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.143988685748609, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.087806396938903, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=3.642411 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.31361966869050295, 'auprc': 0.31361966869050295, 'loss_val': 3.4946148724475905, 'psi': 0.31361966869050295}-{'f1_val': 0.3137607799025122, 'auprc': 0.3137607799025122, 'loss_val': 3.4631373376732655, 'psi': 0.3137607799025122}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=3.520171 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 4.925030042798591, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 4.887847110293487, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=3.982761 cos_to_last_merge=0.9258 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.926
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.97842445610433, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.958420945677165, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=3.370090 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.163252885405342, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.064854916087711, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=3.650180 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2302109491926925, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2206115288993176, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=3.415334 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.17651854871585815, 'auprc': 0.17651854871585815, 'loss_val': 7.964171877520853, 'psi': 0.17651854871585815}-{'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 7.908765057852064, 'psi': 0.1761185910512716}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=3.757755 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6162413249621773, 'auprc': 0.6162413249621773, 'loss_val': 0.4155181047995841, 'psi': 0.6162413249621773}-{'f1_val': 0.6162413249621773, 'auprc': 0.6162413249621773, 'loss_val': 0.4118833287661471, 'psi': 0.6162413249621773}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=3.026336 cos_to_last_merge=0.9763 (last merge round=2)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.385946634431853, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.354889105792706, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=3.565780 cos_to_last_merge=0.9655 (last merge round=1)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.1296997576282095, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.080164719901688, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=4.264287 (no previous merge yet)
[S4] round=38 local utility u=0.005849 metrics={'f1_val': 0.2429169746242917, 'auprc': 0.2429169746242917, 'loss_val': 0.8207213227933008, 'psi': 0.2429169746242917}-{'f1_val': 0.2428272380248738, 'auprc': 0.2428272380248738, 'loss_val': 0.8316108065333719, 'psi': 0.2428272380248738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=38 head_norm_before_train=4.670873 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.22329465831786593, 'auprc': 0.22329465831786593, 'loss_val': 4.475031105380009, 'psi': 0.22329465831786593}-{'f1_val': 0.22329465831786593, 'auprc': 0.22329465831786593, 'loss_val': 4.385689928971668, 'psi': 0.22329465831786593}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=2.907608 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.08584456780333069, 'auprc': 0.08584456780333069, 'loss_val': 11.697680070422512, 'psi': 0.08584456780333069}-{'f1_val': 0.085680285600952, 'auprc': 0.085680285600952, 'loss_val': 11.625447624950024, 'psi': 0.085680285600952}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=4.980300 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.24786967418546366, 'auprc': 0.24786967418546366, 'loss_val': 0.9611025652313733, 'psi': 0.24786967418546368}-{'f1_val': 0.24786967418546366, 'auprc': 0.24786967418546366, 'loss_val': 0.8465691233705406, 'psi': 0.24786967418546368}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=3.663599 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.304224087863606, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.264423947204826, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=3.256004 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.197729319486055, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.143988685748609, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=3.663615 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.31361966869050295, 'auprc': 0.31361966869050295, 'loss_val': 3.524045362108739, 'psi': 0.31361966869050295}-{'f1_val': 0.31361966869050295, 'auprc': 0.31361966869050295, 'loss_val': 3.4946148724475905, 'psi': 0.31361966869050295}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=3.546819 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 4.961907071403649, 'psi': 0.28036404111831337}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 4.925030042798591, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=4.006456 cos_to_last_merge=0.9254 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.925
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.000461960661057, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 3.97842445610433, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=3.396102 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.223581492768808, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.163252885405342, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=3.670278 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2400425913643662, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2302109491926925, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=3.441102 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.17641862045531773, 'auprc': 0.17641862045531773, 'loss_val': 8.040617829715561, 'psi': 0.17641862045531773}-{'f1_val': 0.17651854871585815, 'auprc': 0.17651854871585815, 'loss_val': 7.964171877520853, 'psi': 0.17651854871585815}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=3.775258 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6130121731926516, 'auprc': 0.6130121731926516, 'loss_val': 0.437280571737857, 'psi': 0.6130121731926516}-{'f1_val': 0.6162413249621773, 'auprc': 0.6162413249621773, 'loss_val': 0.4155181047995841, 'psi': 0.6162413249621773}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=3.042591 cos_to_last_merge=0.9757 (last merge round=2)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.416525906844091, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.385946634431853, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.367 u=0.0000 p_local=0.0002 f1=0.367 auprc=0.367 bytes=0
[S3] START round=39 head_norm_before_train=3.593252 cos_to_last_merge=0.9647 (last merge round=1)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.181677231990907, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.1296997576282095, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.263 u=0.0000 p_local=0.0002 f1=0.263 auprc=0.263 bytes=0
[S4] START round=39 head_norm_before_train=4.318398 (no previous merge yet)
[S4] round=39 local utility u=0.012031 metrics={'f1_val': 0.24300677757239678, 'auprc': 0.24300677757239678, 'loss_val': 0.7974674103616369, 'psi': 0.24300677757239678}-{'f1_val': 0.2429169746242917, 'auprc': 0.2429169746242917, 'loss_val': 0.8207213227933008, 'psi': 0.2429169746242917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S4] r=40 psi=0.243 u=0.0120 p_local=0.0494 f1=0.243 auprc=0.243 bytes=43118
[S5] START round=39 head_norm_before_train=4.700516 (no previous merge yet)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.22337064085389569, 'auprc': 0.22337064085389569, 'loss_val': 4.532474496112655, 'psi': 0.22337064085389569}-{'f1_val': 0.22329465831786593, 'auprc': 0.22329465831786593, 'loss_val': 4.475031105380009, 'psi': 0.22329465831786593}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.223 u=0.0000 p_local=0.0014 f1=0.223 auprc=0.223 bytes=9000
[S6] START round=39 head_norm_before_train=2.922860 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.0884554767533491, 'auprc': 0.0884554767533491, 'loss_val': 11.76125332296528, 'psi': 0.0884554767533491}-{'f1_val': 0.08584456780333069, 'auprc': 0.08584456780333069, 'loss_val': 11.697680070422512, 'psi': 0.08584456780333069}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.088 u=0.0000 p_local=0.0002 f1=0.088 auprc=0.088 bytes=0
[S7] START round=39 head_norm_before_train=5.049013 (no previous merge yet)
[S7] round=39 local utility u=1.000000 metrics={'f1_val': 0.4963438201722874, 'auprc': 0.4963438201722874, 'loss_val': 0.1374830313092104, 'psi': 0.4963438201722874}-{'f1_val': 0.24786967418546366, 'auprc': 0.24786967418546366, 'loss_val': 0.9611025652313733, 'psi': 0.24786967418546368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] r=40 psi=0.496 u=1.0000 p_local=0.2306 f1=0.496 auprc=0.496 bytes=30528
[S8] START round=39 head_norm_before_train=3.683949 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.343478032409886, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.304224087863606, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0002 f1=0.359 auprc=0.359 bytes=0
[S9] START round=39 head_norm_before_train=3.280376 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.253393500799993, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.197729319486055, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0002 f1=0.369 auprc=0.369 bytes=0
[S10] START round=39 head_norm_before_train=3.684631 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.3135491606714628, 'auprc': 0.3135491606714628, 'loss_val': 3.555651572059619, 'psi': 0.3135491606714628}-{'f1_val': 0.31361966869050295, 'auprc': 0.31361966869050295, 'loss_val': 3.524045362108739, 'psi': 0.31361966869050295}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.314 u=0.0000 p_local=0.0002 f1=0.314 auprc=0.314 bytes=3600
[S11] START round=39 head_norm_before_train=3.572782 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 4.999886585318773, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 4.961907071403649, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.280 u=0.0000 p_local=0.0002 f1=0.280 auprc=0.280 bytes=0
[S13] START round=39 head_norm_before_train=4.028609 cos_to_last_merge=0.9249 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.925
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.023186999835576, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.000461960661057, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0039 f1=0.360 auprc=0.360 bytes=23389
[S14] START round=39 head_norm_before_train=3.422310 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.288343076637483, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.223581492768808, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0002 f1=0.136 auprc=0.136 bytes=0
[S15] START round=39 head_norm_before_train=3.690097 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2493322566796017, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2400425913643662, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.616 u=0.0000 p_local=0.0002 f1=0.616 auprc=0.616 bytes=1798
[S16] START round=39 head_norm_before_train=3.467039 (no previous merge yet)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 8.128944257919196, 'psi': 0.1761185910512716}-{'f1_val': 0.17641862045531773, 'auprc': 0.17641862045531773, 'loss_val': 8.040617829715561, 'psi': 0.17641862045531773}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.176 u=0.0000 p_local=0.0002 f1=0.176 auprc=0.176 bytes=0
[S17] START round=39 head_norm_before_train=3.793199 (no previous merge yet)
[S17] round=39 local utility u=0.006928 metrics={'f1_val': 0.6141185047070278, 'auprc': 0.6141185047070278, 'loss_val': 0.4333810600491107, 'psi': 0.6141185047070278}-{'f1_val': 0.6130121731926516, 'auprc': 0.6130121731926516, 'loss_val': 0.437280571737857, 'psi': 0.6130121731926516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] r=40 psi=0.614 u=0.0069 p_local=0.0036 f1=0.614 auprc=0.614 bytes=35959
[S2] START round=40 head_norm_before_train=3.058719 cos_to_last_merge=0.9752 (last merge round=2)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.447082227606921, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.416525906844091, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=3.620606 cos_to_last_merge=0.9640 (last merge round=1)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.229596323365647, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.181677231990907, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=4.358837 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.24305170395020645, 'auprc': 0.24305170395020645, 'loss_val': 0.8015822294342814, 'psi': 0.24305170395020642}-{'f1_val': 0.24300677757239678, 'auprc': 0.24300677757239678, 'loss_val': 0.7974674103616369, 'psi': 0.24300677757239678}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=4.729605 (no previous merge yet)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.22337064085389569, 'auprc': 0.22337064085389569, 'loss_val': 4.601889669412378, 'psi': 0.22337064085389569}-{'f1_val': 0.22337064085389569, 'auprc': 0.22337064085389569, 'loss_val': 4.532474496112655, 'psi': 0.22337064085389569}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=2.938103 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.08633663366336633, 'auprc': 0.08633663366336633, 'loss_val': 11.838206755180122, 'psi': 0.08633663366336633}-{'f1_val': 0.0884554767533491, 'auprc': 0.0884554767533491, 'loss_val': 11.76125332296528, 'psi': 0.0884554767533491}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=5.295668 (no previous merge yet)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.34692758765121834, 'auprc': 0.34692758765121834, 'loss_val': 0.776872331355434, 'psi': 0.34692758765121834}-{'f1_val': 0.4963438201722874, 'auprc': 0.4963438201722874, 'loss_val': 0.1374830313092104, 'psi': 0.4963438201722874}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=3.704155 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.38384613542911, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.343478032409886, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=3.305629 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.307684373475667, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.253393500799993, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=3.705552 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.3135491606714628, 'auprc': 0.3135491606714628, 'loss_val': 3.5867219151232974, 'psi': 0.3135491606714628}-{'f1_val': 0.3135491606714628, 'auprc': 0.3135491606714628, 'loss_val': 3.555651572059619, 'psi': 0.3135491606714628}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=3.598630 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.038019413898372, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 4.999886585318773, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=4.050361 cos_to_last_merge=0.9246 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.925
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.039786770645155, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.023186999835576, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=3.448944 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.35811099451774, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.288343076637483, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=3.709819 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2577788974733777, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2493322566796017, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=3.493053 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.17601849962592667, 'auprc': 0.17601849962592667, 'loss_val': 8.212996589513413, 'psi': 0.17601849962592667}-{'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 8.128944257919196, 'psi': 0.1761185910512716}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=3.810512 (no previous merge yet)
[S17] round=40 local utility u=0.007144 metrics={'f1_val': 0.6157781485423222, 'auprc': 0.6157781485423222, 'loss_val': 0.4340293477194315, 'psi': 0.6157781485423222}-{'f1_val': 0.6141185047070278, 'auprc': 0.6141185047070278, 'loss_val': 0.4333810600491107, 'psi': 0.6141185047070278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=41 head_norm_before_train=3.074816 cos_to_last_merge=0.9747 (last merge round=2)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.477933607084796, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.447082227606921, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=3.648038 cos_to_last_merge=0.9633 (last merge round=1)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.281717757691998, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.229596323365647, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=4.405161 (no previous merge yet)
[S4] round=41 local utility u=0.006153 metrics={'f1_val': 0.24305170395020645, 'auprc': 0.24305170395020645, 'loss_val': 0.7892771117622556, 'psi': 0.24305170395020642}-{'f1_val': 0.24305170395020645, 'auprc': 0.24305170395020645, 'loss_val': 0.8015822294342814, 'psi': 0.24305170395020642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=41 head_norm_before_train=4.758798 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.22352248109155867, 'auprc': 0.22352248109155867, 'loss_val': 4.679305611586548, 'psi': 0.22352248109155867}-{'f1_val': 0.22337064085389569, 'auprc': 0.22337064085389569, 'loss_val': 4.601889669412378, 'psi': 0.22337064085389569}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=2.953300 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.08829325975561687, 'auprc': 0.08829325975561687, 'loss_val': 11.904210493929826, 'psi': 0.08829325975561687}-{'f1_val': 0.08633663366336633, 'auprc': 0.08633663366336633, 'loss_val': 11.838206755180122, 'psi': 0.08633663366336633}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=5.311830 (no previous merge yet)
[S7] round=41 local utility u=1.000000 metrics={'f1_val': 0.4957683780083394, 'auprc': 0.4957683780083394, 'loss_val': 0.10568341117763247, 'psi': 0.4957683780083394}-{'f1_val': 0.34692758765121834, 'auprc': 0.34692758765121834, 'loss_val': 0.776872331355434, 'psi': 0.34692758765121834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=41 head_norm_before_train=3.724399 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.424172658043088, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.38384613542911, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=3.332029 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.362980628515372, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.307684373475667, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=3.726286 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.3135491606714628, 'auprc': 0.3135491606714628, 'loss_val': 3.6184446549959293, 'psi': 0.3135491606714628}-{'f1_val': 0.3135491606714628, 'auprc': 0.3135491606714628, 'loss_val': 3.5867219151232974, 'psi': 0.3135491606714628}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=3.624188 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.076674085502206, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.038019413898372, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=4.070643 cos_to_last_merge=0.9242 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.924
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.060087768061115, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.039786770645155, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=3.476352 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.42278489812121, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.35811099451774, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=3.729406 (no previous merge yet)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2684388485688043, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2577788974733777, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=3.518570 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.17601849962592667, 'auprc': 0.17601849962592667, 'loss_val': 8.286422404359922, 'psi': 0.17601849962592667}-{'f1_val': 0.17601849962592667, 'auprc': 0.17601849962592667, 'loss_val': 8.212996589513413, 'psi': 0.17601849962592667}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=3.827760 (no previous merge yet)
[S17] round=41 local utility u=0.000253 metrics={'f1_val': 0.6159625665597951, 'auprc': 0.6159625665597951, 'loss_val': 0.43518385584084107, 'psi': 0.6159625665597951}-{'f1_val': 0.6157781485423222, 'auprc': 0.6157781485423222, 'loss_val': 0.4340293477194315, 'psi': 0.6157781485423222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=42 head_norm_before_train=3.090854 cos_to_last_merge=0.9742 (last merge round=2)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.5080590057617345, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.477933607084796, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=3.675490 cos_to_last_merge=0.9626 (last merge round=1)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.325605197788593, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.281717757691998, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=4.445712 (no previous merge yet)
[S4] round=42 local utility u=0.005152 metrics={'f1_val': 0.24305170395020645, 'auprc': 0.24305170395020645, 'loss_val': 0.7789724459671777, 'psi': 0.24305170395020642}-{'f1_val': 0.24305170395020645, 'auprc': 0.24305170395020645, 'loss_val': 0.7892771117622556, 'psi': 0.24305170395020642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=42 head_norm_before_train=4.787897 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.22367415511111802, 'auprc': 0.22367415511111802, 'loss_val': 4.767772336820573, 'psi': 0.22367415511111804}-{'f1_val': 0.22352248109155867, 'auprc': 0.22352248109155867, 'loss_val': 4.679305611586548, 'psi': 0.22352248109155867}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=2.968446 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.08813091482649842, 'auprc': 0.08813091482649842, 'loss_val': 11.975296977634796, 'psi': 0.08813091482649842}-{'f1_val': 0.08829325975561687, 'auprc': 0.08829325975561687, 'loss_val': 11.904210493929826, 'psi': 0.08829325975561687}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=5.449612 (no previous merge yet)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.49710707407440086, 'auprc': 0.49710707407440086, 'loss_val': 0.15765318265204478, 'psi': 0.49710707407440086}-{'f1_val': 0.4957683780083394, 'auprc': 0.4957683780083394, 'loss_val': 0.10568341117763247, 'psi': 0.4957683780083394}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=3.744449 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.462396354178121, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.424172658043088, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=3.358640 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.41756553721965, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.362980628515372, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=3.746940 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.3134082397003745, 'auprc': 0.3134082397003745, 'loss_val': 3.6490363960390257, 'psi': 0.3134082397003745}-{'f1_val': 0.3135491606714628, 'auprc': 0.3135491606714628, 'loss_val': 3.6184446549959293, 'psi': 0.3135491606714628}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=3.650455 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.1165624519912205, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.076674085502206, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=4.090425 cos_to_last_merge=0.9238 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.924
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.081226380730188, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.060087768061115, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=3.503424 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.487290853825405, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.42278489812121, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=3.748872 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2756961261020077, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2684388485688043, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=3.544496 (no previous merge yet)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.17581819418929034, 'auprc': 0.17581819418929034, 'loss_val': 8.367199127510162, 'psi': 0.17581819418929034}-{'f1_val': 0.17601849962592667, 'auprc': 0.17601849962592667, 'loss_val': 8.286422404359922, 'psi': 0.17601849962592667}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=3.844983 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6156836615182377, 'auprc': 0.6156836615182377, 'loss_val': 0.44501618351548067, 'psi': 0.6156836615182377}-{'f1_val': 0.6159625665597951, 'auprc': 0.6159625665597951, 'loss_val': 0.43518385584084107, 'psi': 0.6159625665597951}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=3.106742 cos_to_last_merge=0.9737 (last merge round=2)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.53809051780432, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.5080590057617345, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=3.702776 cos_to_last_merge=0.9619 (last merge round=1)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.365262777991701, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.325605197788593, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=4.493520 (no previous merge yet)
[S4] round=43 local utility u=0.017479 metrics={'f1_val': 0.24309664694280078, 'auprc': 0.24309664694280078, 'loss_val': 0.7444180687750352, 'psi': 0.24309664694280078}-{'f1_val': 0.24305170395020645, 'auprc': 0.24305170395020645, 'loss_val': 0.7789724459671777, 'psi': 0.24305170395020642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=43 head_norm_before_train=4.817098 (no previous merge yet)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.22374992987437806, 'auprc': 0.22374992987437806, 'loss_val': 4.835955219633443, 'psi': 0.22374992987437806}-{'f1_val': 0.22367415511111802, 'auprc': 0.22367415511111802, 'loss_val': 4.767772336820573, 'psi': 0.22367415511111804}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=2.983511 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.08958742632612966, 'auprc': 0.08958742632612966, 'loss_val': 12.039114178298872, 'psi': 0.08958742632612966}-{'f1_val': 0.08813091482649842, 'auprc': 0.08813091482649842, 'loss_val': 11.975296977634796, 'psi': 0.08813091482649842}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=5.558787 (no previous merge yet)
[S7] round=43 local utility u=0.017231 metrics={'f1_val': 0.4980546982756554, 'auprc': 0.4980546982756554, 'loss_val': 0.13171918326857018, 'psi': 0.4980546982756554}-{'f1_val': 0.49710707407440086, 'auprc': 0.49710707407440086, 'loss_val': 0.15765318265204478, 'psi': 0.49710707407440086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=43 head_norm_before_train=3.764318 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.500515816118006, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.462396354178121, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=3.385784 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.472031115022022, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.41756553721965, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=3.767527 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.3134082397003745, 'auprc': 0.3134082397003745, 'loss_val': 3.6792385452751324, 'psi': 0.3134082397003745}-{'f1_val': 0.3134082397003745, 'auprc': 0.3134082397003745, 'loss_val': 3.6490363960390257, 'psi': 0.3134082397003745}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=3.677057 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.156143968761403, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.1165624519912205, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=4.109713 cos_to_last_merge=0.9234 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.923
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.101517500350362, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.081226380730188, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=3.529673 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.539408975936688, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.487290853825405, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=3.768414 (no previous merge yet)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2837121060359307, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2756961261020077, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=3.571015 (no previous merge yet)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.17581819418929034, 'auprc': 0.17581819418929034, 'loss_val': 8.449307507096021, 'psi': 0.17581819418929034}-{'f1_val': 0.17581819418929034, 'auprc': 0.17581819418929034, 'loss_val': 8.367199127510162, 'psi': 0.17581819418929034}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=3.861983 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6154991964189976, 'auprc': 0.6154991964189976, 'loss_val': 0.44801489161967467, 'psi': 0.6154991964189976}-{'f1_val': 0.6156836615182377, 'auprc': 0.6156836615182377, 'loss_val': 0.44501618351548067, 'psi': 0.6156836615182377}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=3.122599 cos_to_last_merge=0.9732 (last merge round=2)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.568378416754885, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.53809051780432, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=3.729940 cos_to_last_merge=0.9612 (last merge round=1)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.404437523744184, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.365262777991701, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=4.519937 (no previous merge yet)
[S4] round=44 local utility u=0.013927 metrics={'f1_val': 0.2431865828092243, 'auprc': 0.2431865828092243, 'loss_val': 0.717373804140438, 'psi': 0.2431865828092243}-{'f1_val': 0.24309664694280078, 'auprc': 0.24309664694280078, 'loss_val': 0.7444180687750352, 'psi': 0.24309664694280078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=44 head_norm_before_train=4.846359 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.22390135507807077, 'auprc': 0.22390135507807077, 'loss_val': 4.902693666349267, 'psi': 0.22390135507807077}-{'f1_val': 0.22374992987437806, 'auprc': 0.22374992987437806, 'loss_val': 4.835955219633443, 'psi': 0.22374992987437806}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=2.998648 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.08910306845003933, 'auprc': 0.08910306845003933, 'loss_val': 12.116023448733053, 'psi': 0.08910306845003933}-{'f1_val': 0.08958742632612966, 'auprc': 0.08958742632612966, 'loss_val': 12.039114178298872, 'psi': 0.08958742632612966}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=5.666354 (no previous merge yet)
[S7] round=44 local utility u=0.709161 metrics={'f1_val': 0.6636528194841506, 'auprc': 0.6636528194841506, 'loss_val': 0.20378069053075992, 'psi': 0.6636528194841506}-{'f1_val': 0.4980546982756554, 'auprc': 0.4980546982756554, 'loss_val': 0.13171918326857018, 'psi': 0.4980546982756554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=44 head_norm_before_train=3.784042 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.539006835668699, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.500515816118006, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=3.410869 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.525533012436825, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.472031115022022, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=3.787932 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.3133378267056092, 'auprc': 0.3133378267056092, 'loss_val': 3.7090237574726928, 'psi': 0.3133378267056092}-{'f1_val': 0.3134082397003745, 'auprc': 0.3134082397003745, 'loss_val': 3.6792385452751324, 'psi': 0.3134082397003745}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=3.703548 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.194642951829199, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.156143968761403, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=4.128550 cos_to_last_merge=0.9231 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.923
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.115707255735226, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.101517500350362, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=3.554939 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.539496481050218, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.539408975936688, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=3.787784 (no previous merge yet)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2935787514501391, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2837121060359307, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=3.597390 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.17581819418929034, 'auprc': 0.17581819418929034, 'loss_val': 8.516164384858621, 'psi': 0.17581819418929034}-{'f1_val': 0.17581819418929034, 'auprc': 0.17581819418929034, 'loss_val': 8.449307507096021, 'psi': 0.17581819418929034}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=3.879310 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6152200970889236, 'auprc': 0.6152200970889236, 'loss_val': 0.45573503835883217, 'psi': 0.6152200970889236}-{'f1_val': 0.6154991964189976, 'auprc': 0.6154991964189976, 'loss_val': 0.44801489161967467, 'psi': 0.6154991964189976}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=3.138395 cos_to_last_merge=0.9727 (last merge round=2)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.598965488811704, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.568378416754885, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=3.757367 cos_to_last_merge=0.9605 (last merge round=1)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.441729733901899, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.404437523744184, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=4.556670 (no previous merge yet)
[S4] round=45 local utility u=0.010561 metrics={'f1_val': 0.24336665432555846, 'auprc': 0.24336665432555846, 'loss_val': 0.6978731879908677, 'psi': 0.24336665432555846}-{'f1_val': 0.2431865828092243, 'auprc': 0.2431865828092243, 'loss_val': 0.717373804140438, 'psi': 0.2431865828092243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=45 head_norm_before_train=4.875849 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.22390135507807077, 'auprc': 0.22390135507807077, 'loss_val': 4.972496655489675, 'psi': 0.22390135507807077}-{'f1_val': 0.22390135507807077, 'auprc': 0.22390135507807077, 'loss_val': 4.902693666349267, 'psi': 0.22390135507807077}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=3.013731 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.08942610062893082, 'auprc': 0.08942610062893082, 'loss_val': 12.18237726096247, 'psi': 0.08942610062893082}-{'f1_val': 0.08910306845003933, 'auprc': 0.08910306845003933, 'loss_val': 12.116023448733053, 'psi': 0.08910306845003933}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=5.750037 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6632316544949011, 'auprc': 0.6632316544949011, 'loss_val': 0.25046599627008315, 'psi': 0.6632316544949011}-{'f1_val': 0.6636528194841506, 'auprc': 0.6636528194841506, 'loss_val': 0.20378069053075992, 'psi': 0.6636528194841506}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=3.803750 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.576072964436304, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.539006835668699, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=3.432376 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.582326429035688, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.525533012436825, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=3.808287 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.3133378267056092, 'auprc': 0.3133378267056092, 'loss_val': 3.7399607664609746, 'psi': 0.3133378267056092}-{'f1_val': 0.3133378267056092, 'auprc': 0.3133378267056092, 'loss_val': 3.7090237574726928, 'psi': 0.3133378267056092}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=3.730258 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.235122236057296, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.194642951829199, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=4.147249 cos_to_last_merge=0.9227 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.923
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.134624304586154, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.115707255735226, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=3.581179 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.539635889964217, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.539496481050218, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=3.807051 (no previous merge yet)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.3010123132749571, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.2935787514501391, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=3.622355 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.17581819418929034, 'auprc': 0.17581819418929034, 'loss_val': 8.58652058432996, 'psi': 0.17581819418929034}-{'f1_val': 0.17581819418929034, 'auprc': 0.17581819418929034, 'loss_val': 8.516164384858621, 'psi': 0.17581819418929034}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=3.896671 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6150355873104115, 'auprc': 0.6150355873104115, 'loss_val': 0.46148846850351577, 'psi': 0.6150355873104115}-{'f1_val': 0.6152200970889236, 'auprc': 0.6152200970889236, 'loss_val': 0.45573503835883217, 'psi': 0.6152200970889236}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=3.154223 cos_to_last_merge=0.9722 (last merge round=2)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.62867976779664, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.598965488811704, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=3.785260 cos_to_last_merge=0.9598 (last merge round=1)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.481132249070475, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.441729733901899, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=4.594496 (no previous merge yet)
[S4] round=46 local utility u=0.014627 metrics={'f1_val': 0.24323157570151097, 'auprc': 0.24323157570151097, 'loss_val': 0.6674033633787378, 'psi': 0.24323157570151097}-{'f1_val': 0.24336665432555846, 'auprc': 0.24336665432555846, 'loss_val': 0.6978731879908677, 'psi': 0.24336665432555846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=46 head_norm_before_train=4.905299 (no previous merge yet)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.22397700558647657, 'auprc': 0.22397700558647657, 'loss_val': 5.035965866203344, 'psi': 0.2239770055864766}-{'f1_val': 0.22390135507807077, 'auprc': 0.22390135507807077, 'loss_val': 4.972496655489675, 'psi': 0.22390135507807077}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=3.028788 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.0884554767533491, 'auprc': 0.0884554767533491, 'loss_val': 12.256194984575531, 'psi': 0.0884554767533491}-{'f1_val': 0.08942610062893082, 'auprc': 0.08942610062893082, 'loss_val': 12.18237726096247, 'psi': 0.08942610062893082}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=5.771869 (no previous merge yet)
[S7] round=46 local utility u=0.071857 metrics={'f1_val': 0.6633159719580283, 'auprc': 0.6633159719580283, 'loss_val': 0.10751016867113812, 'psi': 0.6633159719580283}-{'f1_val': 0.6632316544949011, 'auprc': 0.6632316544949011, 'loss_val': 0.25046599627008315, 'psi': 0.6632316544949011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=46 head_norm_before_train=3.823265 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.614859325860579, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.576072964436304, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=3.454588 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.62698942782397, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.582326429035688, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=3.828508 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.3133378267056092, 'auprc': 0.3133378267056092, 'loss_val': 3.770362798970204, 'psi': 0.3133378267056092}-{'f1_val': 0.3133378267056092, 'auprc': 0.3133378267056092, 'loss_val': 3.7399607664609746, 'psi': 0.3133378267056092}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=3.758245 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.277676347831328, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.235122236057296, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=4.165559 cos_to_last_merge=0.9224 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.922
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.154796549061516, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.134624304586154, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=3.606689 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.539749940809154, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.539635889964217, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=3.826315 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.3099461184329861, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.3010123132749571, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=3.647912 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.17581819418929034, 'auprc': 0.17581819418929034, 'loss_val': 8.668792692294899, 'psi': 0.17581819418929034}-{'f1_val': 0.17581819418929034, 'auprc': 0.17581819418929034, 'loss_val': 8.58652058432996, 'psi': 0.17581819418929034}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=3.913589 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.614297572549345, 'auprc': 0.614297572549345, 'loss_val': 0.4685570420617301, 'psi': 0.614297572549345}-{'f1_val': 0.6150355873104115, 'auprc': 0.6150355873104115, 'loss_val': 0.46148846850351577, 'psi': 0.6150355873104115}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=3.169928 cos_to_last_merge=0.9717 (last merge round=2)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.658703266900629, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.62867976779664, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=3.812675 cos_to_last_merge=0.9591 (last merge round=1)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.516761875453284, 'psi': 0.26310971622858637}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.481132249070475, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=4.529385 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.24327658524549714, 'auprc': 0.24327658524549714, 'loss_val': 0.6698057026186833, 'psi': 0.2432765852454971}-{'f1_val': 0.24323157570151097, 'auprc': 0.24323157570151097, 'loss_val': 0.6674033633787378, 'psi': 0.24323157570151097}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=4.935259 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.22397700558647657, 'auprc': 0.22397700558647657, 'loss_val': 5.114430631603284, 'psi': 0.2239770055864766}-{'f1_val': 0.22397700558647657, 'auprc': 0.22397700558647657, 'loss_val': 5.035965866203344, 'psi': 0.2239770055864766}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=3.043815 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.08942610062893082, 'auprc': 0.08942610062893082, 'loss_val': 12.324240982936987, 'psi': 0.08942610062893082}-{'f1_val': 0.0884554767533491, 'auprc': 0.0884554767533491, 'loss_val': 12.256194984575531, 'psi': 0.0884554767533491}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=5.842512 (no previous merge yet)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6633159719580283, 'auprc': 0.6633159719580283, 'loss_val': 0.11158504545283406, 'psi': 0.6633159719580283}-{'f1_val': 0.6633159719580283, 'auprc': 0.6633159719580283, 'loss_val': 0.10751016867113812, 'psi': 0.6633159719580283}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=3.842832 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.652122783576286, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.614859325860579, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=3.476220 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638301614344, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.62698942782397, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=3.848641 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.3133378267056092, 'auprc': 0.3133378267056092, 'loss_val': 3.8017746986828764, 'psi': 0.3133378267056092}-{'f1_val': 0.3133378267056092, 'auprc': 0.3133378267056092, 'loss_val': 3.770362798970204, 'psi': 0.3133378267056092}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=3.785300 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.318222754998837, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.277676347831328, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=4.183587 cos_to_last_merge=0.9220 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.922
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.1633898223126975, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.154796549061516, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=3.633400 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.539849437697177, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.539749940809154, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=3.845495 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.3196738492373243, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.3099461184329861, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=3.674995 (no previous merge yet)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 8.716796294165608, 'psi': 0.1761185910512716}-{'f1_val': 0.17581819418929034, 'auprc': 0.17581819418929034, 'loss_val': 8.668792692294899, 'psi': 0.17581819418929034}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=3.930639 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6137440846419174, 'auprc': 0.6137440846419174, 'loss_val': 0.47608919314591064, 'psi': 0.6137440846419174}-{'f1_val': 0.614297572549345, 'auprc': 0.614297572549345, 'loss_val': 0.4685570420617301, 'psi': 0.614297572549345}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=3.185567 cos_to_last_merge=0.9713 (last merge round=2)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.688801838661261, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.658703266900629, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=3.839106 cos_to_last_merge=0.9584 (last merge round=1)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.26300653594771245, 'auprc': 0.26300653594771245, 'loss_val': 6.549486219856794, 'psi': 0.26300653594771245}-{'f1_val': 0.26310971622858637, 'auprc': 0.26310971622858637, 'loss_val': 6.516761875453284, 'psi': 0.26310971622858637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=4.527901 (no previous merge yet)
[S4] round=48 local utility u=0.014333 metrics={'f1_val': 0.24386322883818712, 'auprc': 0.24386322883818712, 'loss_val': 0.6464200849960305, 'psi': 0.24386322883818712}-{'f1_val': 0.24327658524549714, 'auprc': 0.24327658524549714, 'loss_val': 0.6698057026186833, 'psi': 0.2432765852454971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=48 head_norm_before_train=4.965154 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.22405261474450883, 'auprc': 0.22405261474450883, 'loss_val': 5.1843794408392085, 'psi': 0.22405261474450883}-{'f1_val': 0.22397700558647657, 'auprc': 0.22397700558647657, 'loss_val': 5.114430631603284, 'psi': 0.2239770055864766}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=3.059025 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.0889413616686344, 'auprc': 0.0889413616686344, 'loss_val': 12.397584388372415, 'psi': 0.0889413616686344}-{'f1_val': 0.08942610062893082, 'auprc': 0.08942610062893082, 'loss_val': 12.324240982936987, 'psi': 0.08942610062893082}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=5.909050 (no previous merge yet)
[S7] round=48 local utility u=0.004203 metrics={'f1_val': 0.6641568272792373, 'auprc': 0.6641568272792373, 'loss_val': 0.11074738323429668, 'psi': 0.6641568272792373}-{'f1_val': 0.6633159719580283, 'auprc': 0.6633159719580283, 'loss_val': 0.11158504545283406, 'psi': 0.6633159719580283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=48 head_norm_before_train=3.862275 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.68887574933458, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.652122783576286, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=3.497795 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638275700717, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638301614344, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=3.868807 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.3133378267056092, 'auprc': 0.3133378267056092, 'loss_val': 3.83302477342997, 'psi': 0.3133378267056092}-{'f1_val': 0.3133378267056092, 'auprc': 0.3133378267056092, 'loss_val': 3.8017746986828764, 'psi': 0.3133378267056092}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=3.810285 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.361028550091612, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.318222754998837, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=4.201669 cos_to_last_merge=0.9217 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.922
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.177698651296168, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.1633898223126975, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=3.661317 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.539919835899282, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.539849437697177, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=3.864587 (no previous merge yet)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.3275294012901229, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.3196738492373243, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=3.701070 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 8.784057914374737, 'psi': 0.1761185910512716}-{'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 8.716796294165608, 'psi': 0.1761185910512716}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=3.947925 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6131906140105622, 'auprc': 0.6131906140105622, 'loss_val': 0.48330669149660693, 'psi': 0.6131906140105622}-{'f1_val': 0.6137440846419174, 'auprc': 0.6137440846419174, 'loss_val': 0.47608919314591064, 'psi': 0.6137440846419174}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=3.201265 cos_to_last_merge=0.9708 (last merge round=2)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.71849428755311, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 5.688801838661261, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=3.865438 cos_to_last_merge=0.9577 (last merge round=1)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.26305811597045176, 'auprc': 0.26305811597045176, 'loss_val': 6.574823801267017, 'psi': 0.26305811597045176}-{'f1_val': 0.26300653594771245, 'auprc': 0.26300653594771245, 'loss_val': 6.549486219856794, 'psi': 0.26300653594771245}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=4.616290 (no previous merge yet)
[S4] round=49 local utility u=0.025703 metrics={'f1_val': 0.24422564864697505, 'auprc': 0.24422564864697505, 'loss_val': 0.5982757668062065, 'psi': 0.24422564864697505}-{'f1_val': 0.24386322883818712, 'auprc': 0.24386322883818712, 'loss_val': 0.6464200849960305, 'psi': 0.24386322883818712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=49 head_norm_before_train=4.994761 (no previous merge yet)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.22405261474450883, 'auprc': 0.22405261474450883, 'loss_val': 5.24338362803805, 'psi': 0.22405261474450883}-{'f1_val': 0.22405261474450883, 'auprc': 0.22405261474450883, 'loss_val': 5.1843794408392085, 'psi': 0.22405261474450883}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=3.074195 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.08829325975561687, 'auprc': 0.08829325975561687, 'loss_val': 12.4698527016159, 'psi': 0.08829325975561687}-{'f1_val': 0.0889413616686344, 'auprc': 0.0889413616686344, 'loss_val': 12.397584388372415, 'psi': 0.0889413616686344}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=5.945477 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.37034248746426446, 'auprc': 0.37034248746426446, 'loss_val': 0.429607715769633, 'psi': 0.37034248746426446}-{'f1_val': 0.6641568272792373, 'auprc': 0.6641568272792373, 'loss_val': 0.11074738323429668, 'psi': 0.6641568272792373}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=3.881529 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.725342336008276, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.68887574933458, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=3.517818 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638247855227, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 6.632638275700717, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=3.888929 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.313267445342917, 'auprc': 0.313267445342917, 'loss_val': 3.862869084749031, 'psi': 0.313267445342917}-{'f1_val': 0.3133378267056092, 'auprc': 0.3133378267056092, 'loss_val': 3.83302477342997, 'psi': 0.3133378267056092}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=3.835146 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.405415305014859, 'psi': 0.28036404111831337}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 5.361028550091612, 'psi': 0.28036404111831337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=4.219569 cos_to_last_merge=0.9214 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.921
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.194282148999523, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 4.177698651296168, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=3.688683 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.540007424027582, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 13.539919835899282, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=3.883676 (no previous merge yet)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.335921002236623, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 1.3275294012901229, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=3.725813 (no previous merge yet)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 8.855674520386495, 'psi': 0.1761185910512716}-{'f1_val': 0.1761185910512716, 'auprc': 0.1761185910512716, 'loss_val': 8.784057914374737, 'psi': 0.1761185910512716}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=3.964862 (no previous merge yet)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6126345885288843, 'auprc': 0.6126345885288843, 'loss_val': 0.4923815811884528, 'psi': 0.6126345885288843}-{'f1_val': 0.6131906140105622, 'auprc': 0.6131906140105622, 'loss_val': 0.48330669149660693, 'psi': 0.6131906140105622}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
