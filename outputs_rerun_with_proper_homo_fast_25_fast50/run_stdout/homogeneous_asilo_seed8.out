[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:61803
[S3] → join 127.0.0.1:61802
[S4] → join 127.0.0.1:61802
[S5] → join 127.0.0.1:61802
[S6] → join 127.0.0.1:61802
[S7] → join 127.0.0.1:61802
[S8] → join 127.0.0.1:61802
[S9] → join 127.0.0.1:61802
[S10] → join 127.0.0.1:61802
[S11] → join 127.0.0.1:61802
[S13] → join 127.0.0.1:61802
[S14] → join 127.0.0.1:61802
[S15] → join 127.0.0.1:61802
[S16] → join 127.0.0.1:61802
[S17] → join 127.0.0.1:61802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.176476 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.186794 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.126654 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.130140 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.221851 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.159106 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.180179 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.109782 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.139441 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.181603 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.177667 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.193325 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.138372 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.178700 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.186404 (no previous merge yet)
[S2]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3] + discovered S8
[S3] + discovered S17
[S4] + discovered S3
[S3] + discovered S4
[S3] + discovered S9
[S3] + discovered S11
[S3] + discovered S13
[S3] + discovered S5
[S3] + discovered S10
[S3] + discovered S15
[S3] + discovered S16
[S3] + discovered S6
[S4] + discovered S2
[S3] + discovered S7
[S3] + discovered S14
[S5] + discovered S2
[S4] + discovered S16
[S4] + discovered S11
[S4] + discovered S15
[S5] + discovered S3
[S4] + discovered S13
[S4] + discovered S9
[S4] + discovered S5
[S4] + discovered S6
[S4] + discovered S17
[S4] + discovered S7
[S4] + discovered S8
[S5] + discovered S4
[S4] + discovered S10
[S4] + discovered S14
[S5] + discovered S10
[S5] + discovered S8
[S5] + discovered S17
[S6] + discovered S5
[S5] + discovered S16
[S5] + discovered S15
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S13
[S6] + discovered S2
[S6] + discovered S3
[S5] + discovered S14
[S6] + discovered S4
[S5] + discovered S9
[S5] + discovered S7
[S7] + discovered S3
[S6] + discovered S16
[S7] + discovered S2
[S6] + discovered S17
[S6] + discovered S15
[S6] + discovered S10
[S6] + discovered S11
[S6] + discovered S14
[S6] + discovered S8
[S7] + discovered S6
[S6] + discovered S7
[S7] + discovered S5
[S6] + discovered S9
[S7] + discovered S4
[S6] + discovered S13
[S7] + discovered S14
[S8] + discovered S5
[S7] + discovered S16
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S4
[S7] + discovered S15
[S7] + discovered S9
[S7] + discovered S8
[S7] + discovered S10
[S8] + discovered S3
[S8] + discovered S2
[S7] + discovered S17
[S7] + discovered S13
[S7] + discovered S11
[S8] + discovered S9
[S8] + discovered S15
[S8] + discovered S13
[S9] + discovered S5
[S8] + discovered S14
[S9] + discovered S2
[S9] + discovered S3
[S8] + discovered S17
[S9] + discovered S6
[S9] + discovered S7
[S8] + discovered S11
[S9] + discovered S8
[S8] + discovered S16
[S9] + discovered S4
[S8] + discovered S10
[S9] + discovered S14
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S4
[S10] + discovered S5
[S10] + discovered S3
[S9] + discovered S13
[S9] + discovered S17
[S9] + discovered S15
[S9] + discovered S16
[S10] + discovered S7
[S10] + discovered S9
[S10] + discovered S6
[S9] + discovered S11
[S9] + discovered S10
[S11] + discovered S2
[S10] + discovered S14
[S11] + discovered S10
[S10] + discovered S16
[S11] + discovered S3
[S10] + discovered S17
[S11] + discovered S7
[S11] + discovered S6
[S10] + discovered S11
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S4
[S11] + discovered S8
[S10] + discovered S13
[S10] + discovered S15
[S13] + discovered S3
[S13] + discovered S8
[S13] + discovered S10
[S13] + discovered S5
[S11] + discovered S15
[S13] + discovered S2
[S11] + discovered S16
[S13] + discovered S7
[S13] + discovered S6
[S11] + discovered S17
[S13] + discovered S11
[S13] + discovered S9
[S11] + discovered S14
[S11] + discovered S13
[S13] + discovered S4
[S14] + discovered S9
[S14] + discovered S6
[S14] + discovered S4
[S14] + discovered S10
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S2
[S14] + discovered S8
[S14] + discovered S13
[S14] + discovered S3
[S14] + discovered S5
[S13] + discovered S17
[S13] + discovered S14
[S14] + discovered S11
[S14] + discovered S7
[S15] + discovered S7
[S15] + discovered S2
[S14] + discovered S15
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S10
[S15] + discovered S11
[S15] + discovered S8
[S15] + discovered S13
[S15] + discovered S5
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S9
[S16] + discovered S7
[S16] + discovered S15
[S16] + discovered S8
[S16] + discovered S14
[S16] + discovered S5
[S15] + discovered S16
[S16] + discovered S4
[S16] + discovered S10
[S16] + discovered S13
[S16] + discovered S3
[S16] + discovered S11
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S6
[S15] + discovered S17
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S5
[S17] + discovered S2
[S17] + discovered S16
[S17] + discovered S6
[S17] + discovered S7
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S9
[S16] + discovered S17
[S17] + discovered S10
[S17] + discovered S3
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:61808
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:61809
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:61802
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:61805
[S6] ⇄ pheromone p=1.000 → S5@127.0.0.1:61805
[S3] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S9] ⇄ pheromone p=1.000 → S2@127.0.0.1:61802
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:61810
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:61804
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:61810
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:61812
[S5] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:61808
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:61815
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S2] START round=1 head_norm_before_train=1.830568 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.2521335341365462, 'auprc': 0.2521335341365462, 'loss_val': 3.207081214144098, 'psi': 0.2521335341365462}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.847531699676871, 'psi': 0.24507471790179935}
[S3] START round=1 head_norm_before_train=1.875502 (no previous merge yet)
[S3] round=1 local utility u=0.343147 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8161055886229973, 'psi': 0.3641628959276018}-{'f1_val': 0.26060488310342594, 'auprc': 0.26060488310342594, 'loss_val': 2.570377177856535, 'psi': 0.26060488310342594}
[S4] START round=1 head_norm_before_train=1.911364 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.6531003901099879, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.319009260472451, 'psi': 0.3567939207526687}
[S5] START round=1 head_norm_before_train=1.787101 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.4124432206597337, 'psi': 0.3335071121394324}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.2080452809735578, 'psi': 0.33300395256917}
[S6] START round=1 head_norm_before_train=1.866471 (no previous merge yet)
[S6] round=1 local utility u=0.041211 metrics={'f1_val': 0.061686949223667645, 'auprc': 0.061686949223667645, 'loss_val': 7.227625509015375, 'psi': 0.061686949223667645}-{'f1_val': 0.02280782863307135, 'auprc': 0.02280782863307135, 'loss_val': 6.96013575455219, 'psi': 0.02280782863307135}
[S7] START round=1 head_norm_before_train=1.672289 (no previous merge yet)
[S7] round=1 local utility u=0.165689 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.5186357367172157, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8500130831163817, 'psi': 0.3330019880715706}
[S8] START round=1 head_norm_before_train=1.898186 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.882555674333366, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0796878576875402, 'psi': 0.35939447907390915}
[S9] START round=1 head_norm_before_train=1.749408 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2994263795266305, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8618507303870078, 'psi': 0.36867172340800847}
[S10] START round=1 head_norm_before_train=1.783358 (no previous merge yet)
[S10] round=1 local utility u=0.072474 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.616346521095135, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.761295264326054, 'psi': 0.3330944988456333}
[S11] START round=1 head_norm_before_train=1.864241 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.6497710002520654, 'psi': 0.33162711338607104}-{'f1_val': 0.3249734002127983, 'auprc': 0.3249734002127983, 'loss_val': 3.0518932311584113, 'psi': 0.3249734002127983}
[S13] START round=1 head_norm_before_train=1.722119 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.869900232769565, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2175522526912002, 'psi': 0.3599362944611573}
[S14] START round=1 head_norm_before_train=1.858184 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.996583491680241, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.023143800357664, 'psi': 0.13587634006482174}
[S15] START round=1 head_norm_before_train=1.806590 (no previous merge yet)
[S15] round=1 local utility u=0.080752 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.39331740524480047, 'psi': 0.6164734888353558}-{'f1_val': 0.6174450213799425, 'auprc': 0.6174450213799425, 'loss_val': 0.5635652948770898, 'psi': 0.6174450213799425}
[S16] START round=1 head_norm_before_train=1.780938 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.08982996470965672, 'auprc': 0.08982996470965672, 'loss_val': 4.819243502298296, 'psi': 0.08982996470965672}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 3.9938484133357264, 'psi': 0.08899598393574297}
[S17] START round=1 head_norm_before_train=1.753072 (no previous merge yet)
[S17] round=1 local utility u=1.000000 metrics={'f1_val': 0.6601293388647886, 'auprc': 0.6601293388647886, 'loss_val': 1.0852511284602888, 'psi': 0.6601293388647886}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.821034202319583, 'psi': 0.30380970798684975}
[S6] not sending this round → trigger blocked (psi=0.062)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:61804
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:61811
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:61816
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:61810
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.189466)
[S16] loaded HEAD from S10 (vec_in norm=2.189466)
[S16] cosine check vs S10: cos=0.1311
[S16] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.082904)
[S4] loaded HEAD from S3 (vec_in norm=2.082904)
[S4] cosine check vs S3: cos=0.0923
[S4] BUFFERED delta from S3 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.208695)
[S9] loaded HEAD from S15 (vec_in norm=2.208695)
[S9] cosine check vs S15: cos=-0.1136
[S9] DROPPED delta from S15 (cos=-0.1136 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.998438)
[S10] loaded HEAD from S7 (vec_in norm=1.998438)
[S10] cosine check vs S7: cos=0.0074
[S10] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:61807
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.154350)
[S6] loaded HEAD from S17 (vec_in norm=2.154350)
[S6] cosine check vs S17: cos=0.0701
[S6] BUFFERED delta from S17 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.0617 head_norm=2.049808
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.0617 head_norm=2.049808 delta_norm=0.000000
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.3568 head_norm=2.224738
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.3568 head_norm=2.224738 delta_norm=0.000000
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.3331 head_norm=2.189466
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.3331 head_norm=2.189466 delta_norm=0.000000
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.0898 head_norm=1.982048
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.0898 head_norm=1.982048 delta_norm=0.000000
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=2.001268 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.2520860781730347, 'auprc': 0.2520860781730347, 'loss_val': 3.422073647815754, 'psi': 0.2520860781730347}-{'f1_val': 0.2521335341365462, 'auprc': 0.2521335341365462, 'loss_val': 3.207081214144098, 'psi': 0.2521335341365462}
[S3] START round=2 head_norm_before_train=2.082904 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.2559796437659033, 'auprc': 0.2559796437659033, 'loss_val': 3.099367179178981, 'psi': 0.2559796437659033}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.8161055886229973, 'psi': 0.3641628959276018}
[S4] START round=2 head_norm_before_train=2.224738 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.8420985264210876, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.6531003901099879, 'psi': 0.3567939207526687}
[S5] START round=2 head_norm_before_train=2.233346 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.6279117988002385, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.4124432206597337, 'psi': 0.3335071121394324}
[S6] START round=2 head_norm_before_train=2.049808 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.023711810305517556, 'auprc': 0.023711810305517556, 'loss_val': 8.04716830055957, 'psi': 0.023711810305517556}-{'f1_val': 0.061686949223667645, 'auprc': 0.061686949223667645, 'loss_val': 7.227625509015375, 'psi': 0.061686949223667645}
[S7] START round=2 head_norm_before_train=1.998438 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 0.4971047380411988, 'psi': 0.24944015924359295}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.5186357367172157, 'psi': 0.3330019880715706}
[S8] START round=2 head_norm_before_train=2.120915 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.2786284733840176, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.882555674333366, 'psi': 0.35939447907390915}
[S9] START round=2 head_norm_before_train=1.900865 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.532449626402938, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2994263795266305, 'psi': 0.36867172340800847}
[S10] START round=2 head_norm_before_train=2.189466 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.9382731938311024, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.616346521095135, 'psi': 0.3330944988456333}
[S11] START round=2 head_norm_before_train=2.064082 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.877405005080234, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.6497710002520654, 'psi': 0.33162711338607104}
[S13] START round=2 head_norm_before_train=2.180833 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.32424677187948353, 'auprc': 0.32424677187948353, 'loss_val': 1.6904739021189386, 'psi': 0.32424677187948353}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.869900232769565, 'psi': 0.3599362944611573}
[S14] START round=2 head_norm_before_train=2.021099 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 7.463740409883507, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.996583491680241, 'psi': 0.13587634006482174}
[S15] START round=2 head_norm_before_train=2.208695 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4422674006883117, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.39331740524480047, 'psi': 0.6164734888353558}
[S16] START round=2 head_norm_before_train=1.982048 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0908945431269003, 'auprc': 0.0908945431269003, 'loss_val': 5.137494425785739, 'psi': 0.0908945431269003}-{'f1_val': 0.08982996470965672, 'auprc': 0.08982996470965672, 'loss_val': 4.819243502298296, 'psi': 0.08982996470965672}
[S17] START round=2 head_norm_before_train=2.154350 (no previous merge yet)
[S17] round=2 local utility u=0.701198 metrics={'f1_val': 0.7888405739341169, 'auprc': 0.7888405739341169, 'loss_val': 0.8412558880797998, 'psi': 0.7888405739341169}-{'f1_val': 0.6601293388647886, 'auprc': 0.6601293388647886, 'loss_val': 1.0852511284602888, 'psi': 0.6601293388647886}
[S2]  timeout peer S3
[S3]  timeout peer S2
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61815
[S17] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S17
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.334865)
[S15] loaded HEAD from S17 (vec_in norm=2.334865)
[S15] cosine check vs S17: cos=-0.0229
[S15] DROPPED delta from S17 (cos=-0.0229 < 0.0)
[S2] START round=3 head_norm_before_train=2.099017 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.2513763763763764, 'auprc': 0.2513763763763764, 'loss_val': 3.571638504571366, 'psi': 0.2513763763763764}-{'f1_val': 0.2520860781730347, 'auprc': 0.2520860781730347, 'loss_val': 3.422073647815754, 'psi': 0.2520860781730347}
[S3] START round=3 head_norm_before_train=2.207305 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.25829642467424097, 'auprc': 0.25829642467424097, 'loss_val': 3.291050724797724, 'psi': 0.25829642467424097}-{'f1_val': 0.2559796437659033, 'auprc': 0.2559796437659033, 'loss_val': 3.099367179178981, 'psi': 0.2559796437659033}
[S4] START round=3 head_norm_before_train=2.373519 cos_to_last_merge=0.9970 (last merge round=1)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.2063903687449025, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.8420985264210876, 'psi': 0.3567939207526687}
[S5] START round=3 head_norm_before_train=2.426441 (no previous merge yet)
[S5] round=3 local utility u=0.000585 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.631269424342762, 'psi': 0.3335071121394324}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.6279117988002385, 'psi': 0.33300395256917}
[S6] START round=3 head_norm_before_train=2.157431 cos_to_last_merge=0.9990 (last merge round=1)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 8.492434177150127, 'psi': 0.023059360730593607}-{'f1_val': 0.023711810305517556, 'auprc': 0.023711810305517556, 'loss_val': 8.04716830055957, 'psi': 0.023711810305517556}
[S7] START round=3 head_norm_before_train=2.319516 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.24950248756218907, 'auprc': 0.24950248756218907, 'loss_val': 0.5380950829932012, 'psi': 0.24950248756218907}-{'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 0.4971047380411988, 'psi': 0.24944015924359295}
[S8] START round=3 head_norm_before_train=2.256527 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.5899288174617903, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.2786284733840176, 'psi': 0.35939447907390915}
[S9] START round=3 head_norm_before_train=1.993785 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.70310299232919, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.532449626402938, 'psi': 0.36867172340800847}
[S10] START round=3 head_norm_before_train=2.367695 cos_to_last_merge=0.9983 (last merge round=1)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.164250235399871, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.9382731938311024, 'psi': 0.3330944988456333}
[S11] START round=3 head_norm_before_train=2.170504 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.040133997143816, 'psi': 0.3317042898145993}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 3.877405005080234, 'psi': 0.33162711338607104}
[S13] START round=3 head_norm_before_train=2.422926 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.8813655941758045, 'psi': 0.3330058939096267}-{'f1_val': 0.32424677187948353, 'auprc': 0.32424677187948353, 'loss_val': 1.6904739021189386, 'psi': 0.32424677187948353}
[S14] START round=3 head_norm_before_train=2.111210 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 7.780797957590625, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 7.463740409883507, 'psi': 0.13582554517133957}
[S15] START round=3 head_norm_before_train=2.398951 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4779487659065484, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4422674006883117, 'psi': 0.6164734888353558}
[S16] START round=3 head_norm_before_train=2.108436 cos_to_last_merge=0.9992 (last merge round=1)
[S16] round=3 local utility u=0.319435 metrics={'f1_val': 0.13950427725378373, 'auprc': 0.13950427725378373, 'loss_val': 4.936112823884782, 'psi': 0.13950427725378373}-{'f1_val': 0.0908945431269003, 'auprc': 0.0908945431269003, 'loss_val': 5.137494425785739, 'psi': 0.0908945431269003}
[S17] START round=3 head_norm_before_train=2.334865 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.7876823929384736, 'auprc': 0.7876823929384736, 'loss_val': 1.0416906235020171, 'psi': 0.7876823929384736}-{'f1_val': 0.7888405739341169, 'auprc': 0.7888405739341169, 'loss_val': 0.8412558880797998, 'psi': 0.7888405739341169}
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.140)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=2.170182 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.2512820512820513, 'auprc': 0.2512820512820513, 'loss_val': 3.6908448623480146, 'psi': 0.2512820512820513}-{'f1_val': 0.2513763763763764, 'auprc': 0.2513763763763764, 'loss_val': 3.571638504571366, 'psi': 0.2513763763763764}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=4 head_norm_before_train=2.291824 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 3.427216223214671, 'psi': 0.2584955354275069}-{'f1_val': 0.25829642467424097, 'auprc': 0.25829642467424097, 'loss_val': 3.291050724797724, 'psi': 0.25829642467424097}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=4 head_norm_before_train=2.521731 cos_to_last_merge=0.9923 (last merge round=1)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.49775348881831, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.2063903687449025, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=4 head_norm_before_train=2.558739 (no previous merge yet)
[S5] round=4 local utility u=0.007000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6172701375385656, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.631269424342762, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=4 head_norm_before_train=2.234303 cos_to_last_merge=0.9975 (last merge round=1)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 8.799388412713332, 'psi': 0.02284148012791229}-{'f1_val': 0.023059360730593607, 'auprc': 0.023059360730593607, 'loss_val': 8.492434177150127, 'psi': 0.023059360730593607}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=4 head_norm_before_train=2.500278 (no previous merge yet)
[S7] round=4 local utility u=0.047930 metrics={'f1_val': 0.24919053549190537, 'auprc': 0.24919053549190537, 'loss_val': 0.439426528891449, 'psi': 0.24919053549190537}-{'f1_val': 0.24950248756218907, 'auprc': 0.24950248756218907, 'loss_val': 0.5380950829932012, 'psi': 0.24950248756218907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=4 head_norm_before_train=2.374264 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.7003440413376025, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.5899288174617903, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=4 head_norm_before_train=2.063727 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.8368315904742083, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.70310299232919, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=4 head_norm_before_train=2.484671 cos_to_last_merge=0.9958 (last merge round=1)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.3386756820729633, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.164250235399871, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=4 head_norm_before_train=2.248153 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.151091740097889, 'psi': 0.3317042898145993}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.040133997143816, 'psi': 0.3317042898145993}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=4 head_norm_before_train=2.582495 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.93824352338567, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.8813655941758045, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=4 head_norm_before_train=2.177613 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.035347085176154, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 7.780797957590625, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=4 head_norm_before_train=2.517776 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5064485754697727, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4779487659065484, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=4 head_norm_before_train=2.196985 cos_to_last_merge=0.9979 (last merge round=1)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14088820826952528, 'auprc': 0.14088820826952528, 'loss_val': 5.1965188493091885, 'psi': 0.14088820826952528}-{'f1_val': 0.13950427725378373, 'auprc': 0.13950427725378373, 'loss_val': 4.936112823884782, 'psi': 0.13950427725378373}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=4 head_norm_before_train=2.413543 (no previous merge yet)
[S17] round=4 local utility u=0.679312 metrics={'f1_val': 0.8877525220952491, 'auprc': 0.8877525220952491, 'loss_val': 0.5836979259292704, 'psi': 0.8877525220952491}-{'f1_val': 0.7876823929384736, 'auprc': 0.7876823929384736, 'loss_val': 1.0416906235020171, 'psi': 0.7876823929384736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=5 head_norm_before_train=2.227171 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.25104654795376447, 'auprc': 0.25104654795376447, 'loss_val': 3.791822436329129, 'psi': 0.25104654795376447}-{'f1_val': 0.2512820512820513, 'auprc': 0.2512820512820513, 'loss_val': 3.6908448623480146, 'psi': 0.2512820512820513}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=5 head_norm_before_train=2.357631 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.25854536108969417, 'auprc': 0.25854536108969417, 'loss_val': 3.531558094780345, 'psi': 0.25854536108969417}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 3.427216223214671, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=5 head_norm_before_train=2.587544 cos_to_last_merge=0.9873 (last merge round=1)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.6992737109483436, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.49775348881831, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=5 head_norm_before_train=2.675181 (no previous merge yet)
[S5] round=5 local utility u=0.039087 metrics={'f1_val': 0.3333416467015932, 'auprc': 0.3333416467015932, 'loss_val': 1.5376059830847788, 'psi': 0.3333416467015932}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.6172701375385656, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=5 head_norm_before_train=2.296399 cos_to_last_merge=0.9959 (last merge round=1)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 9.055147720335052, 'psi': 0.02262340036563071}-{'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 8.799388412713332, 'psi': 0.02284148012791229}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=5 head_norm_before_train=2.633541 (no previous merge yet)
[S7] round=5 local utility u=0.315101 metrics={'f1_val': 0.3127121533058866, 'auprc': 0.3127121533058866, 'loss_val': 0.38091850434236485, 'psi': 0.3127121533058866}-{'f1_val': 0.24919053549190537, 'auprc': 0.24919053549190537, 'loss_val': 0.439426528891449, 'psi': 0.24919053549190537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=5 head_norm_before_train=2.545681 (no previous merge yet)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.8003085705005426, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.7003440413376025, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=5 head_norm_before_train=2.120473 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.9494215325773276, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.8368315904742083, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=5 head_norm_before_train=2.573403 cos_to_last_merge=0.9935 (last merge round=1)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.4779742938053713, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.3386756820729633, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=5 head_norm_before_train=2.309899 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.239713853685346, 'psi': 0.33162711338607104}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.151091740097889, 'psi': 0.3317042898145993}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=5 head_norm_before_train=2.734160 (no previous merge yet)
[S13] round=5 local utility u=0.168475 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.6012935497022611, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.93824352338567, 'psi': 0.3330058939096267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=5 head_norm_before_train=2.231067 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.251469937389482, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.035347085176154, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=5 head_norm_before_train=2.606498 (no previous merge yet)
[S15] round=5 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5314606187571457, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5064485754697727, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=5 head_norm_before_train=2.266006 cos_to_last_merge=0.9966 (last merge round=1)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14249363867684478, 'auprc': 0.14249363867684478, 'loss_val': 5.362440991714441, 'psi': 0.14249363867684478}-{'f1_val': 0.14088820826952528, 'auprc': 0.14088820826952528, 'loss_val': 5.1965188493091885, 'psi': 0.14088820826952528}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=5 head_norm_before_train=2.530939 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.724075456240855, 'auprc': 0.724075456240855, 'loss_val': 0.9420674564360619, 'psi': 0.724075456240855}-{'f1_val': 0.8877525220952491, 'auprc': 0.8877525220952491, 'loss_val': 0.5836979259292704, 'psi': 0.8877525220952491}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=6 head_norm_before_train=2.275385 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.25099950024987505, 'auprc': 0.25099950024987505, 'loss_val': 3.8790064163790947, 'psi': 0.25099950024987505}-{'f1_val': 0.25104654795376447, 'auprc': 0.25104654795376447, 'loss_val': 3.791822436329129, 'psi': 0.25104654795376447}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=6 head_norm_before_train=2.412239 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.258595205963627, 'auprc': 0.258595205963627, 'loss_val': 3.6169917671803407, 'psi': 0.258595205963627}-{'f1_val': 0.25854536108969417, 'auprc': 0.25854536108969417, 'loss_val': 3.531558094780345, 'psi': 0.25854536108969417}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=6 head_norm_before_train=2.661232 cos_to_last_merge=0.9811 (last merge round=1)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.8673700730066742, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.6992737109483436, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=6 head_norm_before_train=2.753181 (no previous merge yet)
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.642943360853526, 'psi': 0.3335071121394324}-{'f1_val': 0.3333416467015932, 'auprc': 0.3333416467015932, 'loss_val': 1.5376059830847788, 'psi': 0.3333416467015932}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=6 head_norm_before_train=2.348666 cos_to_last_merge=0.9945 (last merge round=1)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 9.276019057849108, 'psi': 0.02262340036563071}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 9.055147720335052, 'psi': 0.02262340036563071}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=6 head_norm_before_train=2.702950 (no previous merge yet)
[S7] round=6 local utility u=0.475387 metrics={'f1_val': 0.41315430827998434, 'auprc': 0.41315430827998434, 'loss_val': 0.3341233180183098, 'psi': 0.41315430827998434}-{'f1_val': 0.3127121533058866, 'auprc': 0.3127121533058866, 'loss_val': 0.38091850434236485, 'psi': 0.3127121533058866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=6 head_norm_before_train=2.605462 (no previous merge yet)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.8811802755156246, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.8003085705005426, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=6 head_norm_before_train=2.168873 (no previous merge yet)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.047205896371522, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.9494215325773276, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=6 head_norm_before_train=2.645710 cos_to_last_merge=0.9914 (last merge round=1)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.5971936426145747, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.4779742938053713, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=6 head_norm_before_train=2.362591 (no previous merge yet)
[S11] round=6 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.326432766686615, 'psi': 0.3317042898145993}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.239713853685346, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=6 head_norm_before_train=2.827820 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7123482390146207, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.6012935497022611, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=6 head_norm_before_train=2.276297 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.44061687174524, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.251469937389482, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=6 head_norm_before_train=2.678106 (no previous merge yet)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5525752354774981, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5314606187571457, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=6 head_norm_before_train=2.322772 cos_to_last_merge=0.9954 (last merge round=1)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.14237929028504945, 'auprc': 0.14237929028504945, 'loss_val': 5.571819228990962, 'psi': 0.14237929028504945}-{'f1_val': 0.14249363867684478, 'auprc': 0.14249363867684478, 'loss_val': 5.362440991714441, 'psi': 0.14249363867684478}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=6 head_norm_before_train=2.546450 (no previous merge yet)
[S17] round=6 local utility u=0.251528 metrics={'f1_val': 0.7734138266796495, 'auprc': 0.7734138266796495, 'loss_val': 0.8830564627005731, 'psi': 0.7734138266796495}-{'f1_val': 0.724075456240855, 'auprc': 0.724075456240855, 'loss_val': 0.9420674564360619, 'psi': 0.724075456240855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=7 head_norm_before_train=2.317397 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.2511406962935184, 'auprc': 0.2511406962935184, 'loss_val': 3.9538091411876564, 'psi': 0.2511406962935184}-{'f1_val': 0.25099950024987505, 'auprc': 0.25099950024987505, 'loss_val': 3.8790064163790947, 'psi': 0.25099950024987505}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=7 head_norm_before_train=2.459642 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 3.6877036151051055, 'psi': 0.25869495339119253}-{'f1_val': 0.258595205963627, 'auprc': 0.258595205963627, 'loss_val': 3.6169917671803407, 'psi': 0.258595205963627}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=7 head_norm_before_train=2.755640 cos_to_last_merge=0.9761 (last merge round=1)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.977241273830558, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.8673700730066742, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=7 head_norm_before_train=2.813221 (no previous merge yet)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.860781323985713, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.642943360853526, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=7 head_norm_before_train=2.393752 cos_to_last_merge=0.9932 (last merge round=1)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 9.472150352740467, 'psi': 0.02262340036563071}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 9.276019057849108, 'psi': 0.02262340036563071}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=7 head_norm_before_train=2.800639 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.4169336778882293, 'psi': 0.3330019880715706}-{'f1_val': 0.41315430827998434, 'auprc': 0.41315430827998434, 'loss_val': 0.3341233180183098, 'psi': 0.41315430827998434}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=7 head_norm_before_train=2.707472 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.974172455116724, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.8811802755156246, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=7 head_norm_before_train=2.211489 (no previous merge yet)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.133166265468978, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.047205896371522, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=7 head_norm_before_train=2.707224 cos_to_last_merge=0.9895 (last merge round=1)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.703449190289943, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.5971936426145747, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=7 head_norm_before_train=2.408472 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.392423966232756, 'psi': 0.33162711338607104}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.326432766686615, 'psi': 0.3317042898145993}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=7 head_norm_before_train=2.938990 (no previous merge yet)
[S13] round=7 local utility u=0.034853 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.64264257555455, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7123482390146207, 'psi': 0.3330058939096267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=7 head_norm_before_train=2.315956 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.610901503431773, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.44061687174524, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=7 head_norm_before_train=2.738328 (no previous merge yet)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5708132540977586, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5525752354774981, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=7 head_norm_before_train=2.370522 cos_to_last_merge=0.9943 (last merge round=1)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.14237929028504945, 'auprc': 0.14237929028504945, 'loss_val': 5.7452263137023545, 'psi': 0.14237929028504945}-{'f1_val': 0.14237929028504945, 'auprc': 0.14237929028504945, 'loss_val': 5.571819228990962, 'psi': 0.14237929028504945}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=7 head_norm_before_train=2.668665 (no previous merge yet)
[S17] round=7 local utility u=0.489280 metrics={'f1_val': 0.8605365730335518, 'auprc': 0.8605365730335518, 'loss_val': 0.6886015721529423, 'psi': 0.8605365730335518}-{'f1_val': 0.7734138266796495, 'auprc': 0.7734138266796495, 'loss_val': 0.8830564627005731, 'psi': 0.7734138266796495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=8 head_norm_before_train=2.354807 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.2509054577244911, 'auprc': 0.2509054577244911, 'loss_val': 4.024658271086444, 'psi': 0.2509054577244911}-{'f1_val': 0.2511406962935184, 'auprc': 0.2511406962935184, 'loss_val': 3.9538091411876564, 'psi': 0.2511406962935184}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=8 head_norm_before_train=2.501366 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 3.7504430946675043, 'psi': 0.2587947777992154}-{'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 3.6877036151051055, 'psi': 0.25869495339119253}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=8 head_norm_before_train=2.843633 cos_to_last_merge=0.9708 (last merge round=1)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.0070225623278675, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 2.977241273830558, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=8 head_norm_before_train=2.896317 (no previous merge yet)
[S5] round=8 local utility u=0.112490 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.639589405091341, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.860781323985713, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=8 head_norm_before_train=2.434390 cos_to_last_merge=0.9920 (last merge round=1)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 9.651074970246007, 'psi': 0.02262340036563071}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 9.472150352740467, 'psi': 0.02262340036563071}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=8 head_norm_before_train=2.848649 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.4155194898452271, 'psi': 0.24956478487938324}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.4169336778882293, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=8 head_norm_before_train=2.788556 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.0373408761788925, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 2.974172455116724, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=8 head_norm_before_train=2.249496 (no previous merge yet)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.208313331505453, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.133166265468978, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=8 head_norm_before_train=2.760844 cos_to_last_merge=0.9878 (last merge round=1)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.7981878793660058, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.703449190289943, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=8 head_norm_before_train=2.449489 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.460289853511642, 'psi': 0.3317042898145993}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.392423966232756, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=8 head_norm_before_train=3.005774 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.731194624447068, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.64264257555455, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=8 head_norm_before_train=2.351485 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.76690647892091, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.610901503431773, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=8 head_norm_before_train=2.790988 (no previous merge yet)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5879866303287626, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5708132540977586, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=8 head_norm_before_train=2.412497 cos_to_last_merge=0.9933 (last merge round=1)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.14249363867684478, 'auprc': 0.14249363867684478, 'loss_val': 5.865803020250544, 'psi': 0.14249363867684478}-{'f1_val': 0.14237929028504945, 'auprc': 0.14237929028504945, 'loss_val': 5.7452263137023545, 'psi': 0.14237929028504945}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=8 head_norm_before_train=2.750141 (no previous merge yet)
[S17] round=8 local utility u=0.090197 metrics={'f1_val': 0.8774965876750116, 'auprc': 0.8774965876750116, 'loss_val': 0.6608473933741273, 'psi': 0.8774965876750116}-{'f1_val': 0.8605365730335518, 'auprc': 0.8605365730335518, 'loss_val': 0.6886015721529423, 'psi': 0.8605365730335518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=9 head_norm_before_train=2.388770 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.2509054577244911, 'auprc': 0.2509054577244911, 'loss_val': 4.088261855089009, 'psi': 0.2509054577244911}-{'f1_val': 0.2509054577244911, 'auprc': 0.2509054577244911, 'loss_val': 4.024658271086444, 'psi': 0.2509054577244911}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=9 head_norm_before_train=2.539101 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 3.8059225349469474, 'psi': 0.2587947777992154}-{'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 3.7504430946675043, 'psi': 0.2587947777992154}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=9 head_norm_before_train=2.889129 cos_to_last_merge=0.9635 (last merge round=1)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.1282709685343386, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.0070225623278675, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=9 head_norm_before_train=2.950598 (no previous merge yet)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.852694280445995, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.639589405091341, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=9 head_norm_before_train=2.470977 cos_to_last_merge=0.9909 (last merge round=1)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 9.815009661789954, 'psi': 0.02262340036563071}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 9.651074970246007, 'psi': 0.02262340036563071}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=9 head_norm_before_train=2.897321 (no previous merge yet)
[S7] round=9 local utility u=0.568644 metrics={'f1_val': 0.3722185733762955, 'auprc': 0.3722185733762955, 'loss_val': 0.3821161189397867, 'psi': 0.3722185733762955}-{'f1_val': 0.24956478487938324, 'auprc': 0.24956478487938324, 'loss_val': 0.4155194898452271, 'psi': 0.24956478487938324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=9 head_norm_before_train=2.864609 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.115937219602808, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.0373408761788925, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=9 head_norm_before_train=2.283921 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.278819177886775, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.208313331505453, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=9 head_norm_before_train=2.808805 cos_to_last_merge=0.9862 (last merge round=1)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.8858942200360516, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.7981878793660058, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=9 head_norm_before_train=2.486925 (no previous merge yet)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.519422900425768, 'psi': 0.3317042898145993}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.460289853511642, 'psi': 0.3317042898145993}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=9 head_norm_before_train=3.113004 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7328401340912742, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.731194624447068, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=9 head_norm_before_train=2.383867 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.910825888408503, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.76690647892091, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=9 head_norm_before_train=2.838061 (no previous merge yet)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6032229615556786, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5879866303287626, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=9 head_norm_before_train=2.450413 cos_to_last_merge=0.9924 (last merge round=1)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.14237929028504945, 'auprc': 0.14237929028504945, 'loss_val': 6.020990113727331, 'psi': 0.14237929028504945}-{'f1_val': 0.14249363867684478, 'auprc': 0.14249363867684478, 'loss_val': 5.865803020250544, 'psi': 0.14249363867684478}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=9 head_norm_before_train=2.826013 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.8596983081452695, 'auprc': 0.8596983081452695, 'loss_val': 0.751413200151014, 'psi': 0.8596983081452696}-{'f1_val': 0.8774965876750116, 'auprc': 0.8774965876750116, 'loss_val': 0.6608473933741273, 'psi': 0.8774965876750116}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=10 head_norm_before_train=2.419972 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.25071758392612004, 'auprc': 0.25071758392612004, 'loss_val': 4.148218662181852, 'psi': 0.25071758392612004}-{'f1_val': 0.2509054577244911, 'auprc': 0.2509054577244911, 'loss_val': 4.088261855089009, 'psi': 0.2509054577244911}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=10 head_norm_before_train=2.573578 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 3.8572535742460987, 'psi': 0.2588447188987521}-{'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 3.8059225349469474, 'psi': 0.2587947777992154}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=10 head_norm_before_train=2.937951 cos_to_last_merge=0.9581 (last merge round=1)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.2287523359945403, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.1282709685343386, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=10 head_norm_before_train=3.008250 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.4211853964916843, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.852694280445995, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=10 head_norm_before_train=2.504712 cos_to_last_merge=0.9898 (last merge round=1)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 9.968179809324889, 'psi': 0.02262340036563071}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 9.815009661789954, 'psi': 0.02262340036563071}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=10 head_norm_before_train=2.975163 (no previous merge yet)
[S7] round=10 local utility u=1.000000 metrics={'f1_val': 0.6657434165338773, 'auprc': 0.6657434165338773, 'loss_val': 0.300364790410957, 'psi': 0.6657434165338773}-{'f1_val': 0.3722185733762955, 'auprc': 0.3722185733762955, 'loss_val': 0.3821161189397867, 'psi': 0.3722185733762955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=10 head_norm_before_train=2.934554 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.1632770515616144, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.115937219602808, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=10 head_norm_before_train=2.315886 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.343640155210767, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.278819177886775, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=10 head_norm_before_train=2.851972 cos_to_last_merge=0.9847 (last merge round=1)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.9657225801399067, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.8858942200360516, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=10 head_norm_before_train=2.521165 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.570169635079894, 'psi': 0.3317042898145993}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.519422900425768, 'psi': 0.3317042898145993}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=10 head_norm_before_train=3.181743 (no previous merge yet)
[S13] round=10 local utility u=0.000150 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7325404437861418, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7328401340912742, 'psi': 0.3330058939096267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] sending update (kind=head size=1789 to 1 peers)
[S14] START round=10 head_norm_before_train=2.413826 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.045705612898873, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 8.910825888408503, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=10 head_norm_before_train=2.880742 (no previous merge yet)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6157634131951601, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6032229615556786, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=10 head_norm_before_train=2.485046 cos_to_last_merge=0.9915 (last merge round=1)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.1427221858876535, 'auprc': 0.1427221858876535, 'loss_val': 6.098041916560017, 'psi': 0.1427221858876535}-{'f1_val': 0.14237929028504945, 'auprc': 0.14237929028504945, 'loss_val': 6.020990113727331, 'psi': 0.14237929028504945}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=10 head_norm_before_train=2.894521 (no previous merge yet)
[S17] round=10 local utility u=0.111546 metrics={'f1_val': 0.8799937404142377, 'auprc': 0.8799937404142377, 'loss_val': 0.7109803513205367, 'psi': 0.8799937404142377}-{'f1_val': 0.8596983081452695, 'auprc': 0.8596983081452695, 'loss_val': 0.751413200151014, 'psi': 0.8596983081452696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=11 head_norm_before_train=2.449154 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.25071758392612004, 'auprc': 0.25071758392612004, 'loss_val': 4.2043496016889055, 'psi': 0.25071758392612004}-{'f1_val': 0.25071758392612004, 'auprc': 0.25071758392612004, 'loss_val': 4.148218662181852, 'psi': 0.25071758392612004}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=11 head_norm_before_train=2.605580 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 3.9051575197266897, 'psi': 0.2588447188987521}-{'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 3.8572535742460987, 'psi': 0.2588447188987521}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=11 head_norm_before_train=3.048687 cos_to_last_merge=0.9550 (last merge round=1)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.2988458222154775, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.2287523359945403, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=11 head_norm_before_train=3.076787 (no previous merge yet)
[S5] round=11 local utility u=0.300508 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8201692490522998, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.4211853964916843, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=11 head_norm_before_train=2.535835 cos_to_last_merge=0.9889 (last merge round=1)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 10.109132366552824, 'psi': 0.02262340036563071}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 9.968179809324889, 'psi': 0.02262340036563071}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=11 head_norm_before_train=3.044493 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.48993198989910813, 'auprc': 0.48993198989910813, 'loss_val': 0.3386614507393801, 'psi': 0.48993198989910813}-{'f1_val': 0.6657434165338773, 'auprc': 0.6657434165338773, 'loss_val': 0.300364790410957, 'psi': 0.6657434165338773}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=11 head_norm_before_train=3.007029 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.207897948204371, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.1632770515616144, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=11 head_norm_before_train=2.345579 (no previous merge yet)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.402871312329328, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.343640155210767, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=11 head_norm_before_train=2.891602 cos_to_last_merge=0.9833 (last merge round=1)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.041555782054312, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 3.9657225801399067, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=11 head_norm_before_train=2.553342 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.620026085234408, 'psi': 0.3317042898145993}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.570169635079894, 'psi': 0.3317042898145993}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=11 head_norm_before_train=3.257002 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7897595020695285, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7325404437861418, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=11 head_norm_before_train=2.441622 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.172709604653114, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.045705612898873, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=11 head_norm_before_train=2.919738 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.627189797315776, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6157634131951601, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=11 head_norm_before_train=2.517091 cos_to_last_merge=0.9906 (last merge round=1)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.14329268292682926, 'auprc': 0.14329268292682926, 'loss_val': 6.186181268302728, 'psi': 0.14329268292682926}-{'f1_val': 0.1427221858876535, 'auprc': 0.1427221858876535, 'loss_val': 6.098041916560017, 'psi': 0.1427221858876535}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=11 head_norm_before_train=2.952937 (no previous merge yet)
[S17] round=11 local utility u=0.435275 metrics={'f1_val': 0.9319681526689179, 'auprc': 0.9319681526689179, 'loss_val': 0.3081996493005416, 'psi': 0.9319681526689179}-{'f1_val': 0.8799937404142377, 'auprc': 0.8799937404142377, 'loss_val': 0.7109803513205367, 'psi': 0.8799937404142377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=12 head_norm_before_train=2.476504 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.2506706594297835, 'auprc': 0.2506706594297835, 'loss_val': 4.256623269598728, 'psi': 0.2506706594297835}-{'f1_val': 0.25071758392612004, 'auprc': 0.25071758392612004, 'loss_val': 4.2043496016889055, 'psi': 0.25071758392612004}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=12 head_norm_before_train=2.635461 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 3.948775310811024, 'psi': 0.2588447188987521}-{'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 3.9051575197266897, 'psi': 0.2588447188987521}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=12 head_norm_before_train=3.086228 cos_to_last_merge=0.9536 (last merge round=1)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.4154030931927037, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.2988458222154775, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=12 head_norm_before_train=3.130863 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.0527820542762307, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8201692490522998, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=12 head_norm_before_train=2.565221 cos_to_last_merge=0.9880 (last merge round=1)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 10.244998555112703, 'psi': 0.02262340036563071}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 10.109132366552824, 'psi': 0.02262340036563071}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=12 head_norm_before_train=3.096140 (no previous merge yet)
[S7] round=12 local utility u=0.832159 metrics={'f1_val': 0.6656603947486558, 'auprc': 0.6656603947486558, 'loss_val': 0.25589820489949655, 'psi': 0.6656603947486558}-{'f1_val': 0.48993198989910813, 'auprc': 0.48993198989910813, 'loss_val': 0.3386614507393801, 'psi': 0.48993198989910813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=12 head_norm_before_train=3.086899 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.245423827867938, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.207897948204371, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=12 head_norm_before_train=2.373339 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.460227424568249, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.402871312329328, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=12 head_norm_before_train=2.928082 cos_to_last_merge=0.9820 (last merge round=1)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.112432571909394, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.041555782054312, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=12 head_norm_before_train=2.583547 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.664233696497041, 'psi': 0.33162711338607104}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 4.620026085234408, 'psi': 0.3317042898145993}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=12 head_norm_before_train=3.342306 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.8167407945600202, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7897595020695285, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=12 head_norm_before_train=2.467788 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.293624559687014, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.172709604653114, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=12 head_norm_before_train=2.955952 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6396165110944901, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.627189797315776, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=12 head_norm_before_train=2.547077 cos_to_last_merge=0.9899 (last merge round=1)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.14329268292682926, 'auprc': 0.14329268292682926, 'loss_val': 6.28114557966762, 'psi': 0.14329268292682926}-{'f1_val': 0.14329268292682926, 'auprc': 0.14329268292682926, 'loss_val': 6.186181268302728, 'psi': 0.14329268292682926}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=12 head_norm_before_train=3.012165 (no previous merge yet)
[S17] round=12 local utility u=0.317142 metrics={'f1_val': 0.9791926758218894, 'auprc': 0.9791926758218894, 'loss_val': 0.09893718748991519, 'psi': 0.9791926758218894}-{'f1_val': 0.9319681526689179, 'auprc': 0.9319681526689179, 'loss_val': 0.3081996493005416, 'psi': 0.9319681526689179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=13 head_norm_before_train=2.502286 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.25062375249500995, 'auprc': 0.25062375249500995, 'loss_val': 4.307967946963399, 'psi': 0.25062375249500995}-{'f1_val': 0.2506706594297835, 'auprc': 0.2506706594297835, 'loss_val': 4.256623269598728, 'psi': 0.2506706594297835}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=13 head_norm_before_train=2.663541 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 3.991350498457659, 'psi': 0.2588447188987521}-{'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 3.948775310811024, 'psi': 0.2588447188987521}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=13 head_norm_before_train=3.149659 cos_to_last_merge=0.9516 (last merge round=1)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.4707327316832988, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.4154030931927037, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=13 head_norm_before_train=3.172567 (no previous merge yet)
[S5] round=13 local utility u=0.314794 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.4277174227182237, 'psi': 0.33400978131092857}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.0527820542762307, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=13 head_norm_before_train=2.592833 cos_to_last_merge=0.9871 (last merge round=1)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 10.373493825544966, 'psi': 0.02262340036563071}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 10.244998555112703, 'psi': 0.02262340036563071}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=13 head_norm_before_train=3.152561 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.6657434165338773, 'auprc': 0.6657434165338773, 'loss_val': 0.28976279425904494, 'psi': 0.6657434165338773}-{'f1_val': 0.6656603947486558, 'auprc': 0.6656603947486558, 'loss_val': 0.25589820489949655, 'psi': 0.6656603947486558}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=13 head_norm_before_train=3.171492 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.2882745408740286, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.245423827867938, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=13 head_norm_before_train=2.399755 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.514046420832604, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.460227424568249, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=13 head_norm_before_train=2.962233 cos_to_last_merge=0.9808 (last merge round=1)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.178780527686421, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.112432571909394, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=13 head_norm_before_train=2.611977 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.7087107019941055, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.664233696497041, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=13 head_norm_before_train=3.390758 (no previous merge yet)
[S13] round=13 local utility u=0.035423 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7458942427327202, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.8167407945600202, 'psi': 0.3330058939096267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=13 head_norm_before_train=2.492577 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.408201012821126, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.293624559687014, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=13 head_norm_before_train=2.989817 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6500145618260019, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6396165110944901, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=13 head_norm_before_train=2.575134 cos_to_last_merge=0.9891 (last merge round=1)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.14352053402989406, 'auprc': 0.14352053402989406, 'loss_val': 6.378973133936843, 'psi': 0.14352053402989406}-{'f1_val': 0.14329268292682926, 'auprc': 0.14329268292682926, 'loss_val': 6.28114557966762, 'psi': 0.14329268292682926}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=13 head_norm_before_train=3.066709 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.8979903748683862, 'auprc': 0.8979903748683862, 'loss_val': 0.4510980623319062, 'psi': 0.8979903748683862}-{'f1_val': 0.9791926758218894, 'auprc': 0.9791926758218894, 'loss_val': 0.09893718748991519, 'psi': 0.9791926758218894}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=14 head_norm_before_train=2.527127 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.25043630017452007, 'auprc': 0.25043630017452007, 'loss_val': 4.356096751733511, 'psi': 0.25043630017452007}-{'f1_val': 0.25062375249500995, 'auprc': 0.25062375249500995, 'loss_val': 4.307967946963399, 'psi': 0.25062375249500995}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=14 head_norm_before_train=2.690230 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 4.0304268379074495, 'psi': 0.2588447188987521}-{'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 3.991350498457659, 'psi': 0.2588447188987521}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=14 head_norm_before_train=3.227244 cos_to_last_merge=0.9504 (last merge round=1)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.5669837780686477, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.4707327316832988, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=14 head_norm_before_train=3.197976 (no previous merge yet)
[S5] round=14 local utility u=0.090649 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.2464190271307742, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.4277174227182237, 'psi': 0.33400978131092857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=14 head_norm_before_train=2.619039 cos_to_last_merge=0.9863 (last merge round=1)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 10.496480192999345, 'psi': 0.02262340036563071}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 10.373493825544966, 'psi': 0.02262340036563071}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=14 head_norm_before_train=3.177544 (no previous merge yet)
[S7] round=14 local utility u=0.013963 metrics={'f1_val': 0.6657434165338773, 'auprc': 0.6657434165338773, 'loss_val': 0.26183647851593955, 'psi': 0.6657434165338773}-{'f1_val': 0.6657434165338773, 'auprc': 0.6657434165338773, 'loss_val': 0.28976279425904494, 'psi': 0.6657434165338773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=14 head_norm_before_train=3.250345 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.340742320682834, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.2882745408740286, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=14 head_norm_before_train=2.424802 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.565598584289199, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.514046420832604, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=14 head_norm_before_train=2.994374 cos_to_last_merge=0.9796 (last merge round=1)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.241960887850971, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.178780527686421, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=14 head_norm_before_train=2.639200 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.7481942225856075, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.7087107019941055, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=14 head_norm_before_train=3.448058 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.3331695331695332, 'auprc': 0.3331695331695332, 'loss_val': 1.8935784297979683, 'psi': 0.3331695331695332}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7458942427327202, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=14 head_norm_before_train=2.516208 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.518834346796353, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.408201012821126, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=14 head_norm_before_train=3.021694 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6607097024527769, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6500145618260019, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=14 head_norm_before_train=2.601726 cos_to_last_merge=0.9884 (last merge round=1)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.1439756415832971, 'auprc': 0.1439756415832971, 'loss_val': 6.4660687923615665, 'psi': 0.1439756415832971}-{'f1_val': 0.14352053402989406, 'auprc': 0.14352053402989406, 'loss_val': 6.378973133936843, 'psi': 0.14352053402989406}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=14 head_norm_before_train=3.119263 (no previous merge yet)
[S17] round=14 local utility u=0.176921 metrics={'f1_val': 0.922575518267474, 'auprc': 0.922575518267474, 'loss_val': 0.3185230742721864, 'psi': 0.922575518267474}-{'f1_val': 0.8979903748683862, 'auprc': 0.8979903748683862, 'loss_val': 0.4510980623319062, 'psi': 0.8979903748683862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=15 head_norm_before_train=2.550745 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.25062375249500995, 'auprc': 0.25062375249500995, 'loss_val': 4.402366580288456, 'psi': 0.25062375249500995}-{'f1_val': 0.25043630017452007, 'auprc': 0.25043630017452007, 'loss_val': 4.356096751733511, 'psi': 0.25043630017452007}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=15 head_norm_before_train=2.715525 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 4.068807506372493, 'psi': 0.2588447188987521}-{'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 4.0304268379074495, 'psi': 0.2588447188987521}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=15 head_norm_before_train=3.288305 cos_to_last_merge=0.9487 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.670817956381053, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.5669837780686477, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=15 head_norm_before_train=3.269103 (no previous merge yet)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.4792110082028485, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.2464190271307742, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=15 head_norm_before_train=2.643933 cos_to_last_merge=0.9855 (last merge round=1)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 10.61399638344998, 'psi': 0.02262340036563071}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 10.496480192999345, 'psi': 0.02262340036563071}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=15 head_norm_before_train=3.212236 (no previous merge yet)
[S7] round=15 local utility u=0.004924 metrics={'f1_val': 0.6652446656398898, 'auprc': 0.6652446656398898, 'loss_val': 0.24749972131477713, 'psi': 0.6652446656398898}-{'f1_val': 0.6657434165338773, 'auprc': 0.6657434165338773, 'loss_val': 0.26183647851593955, 'psi': 0.6657434165338773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=15 head_norm_before_train=3.318739 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.3946047893288447, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.340742320682834, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=15 head_norm_before_train=2.448840 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.616548534144577, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.565598584289199, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=15 head_norm_before_train=3.024854 cos_to_last_merge=0.9784 (last merge round=1)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.3016817504689735, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.241960887850971, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=15 head_norm_before_train=2.665155 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.784416028414007, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.7481942225856075, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=15 head_norm_before_train=3.493213 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.25270219903093555, 'auprc': 0.25270219903093555, 'loss_val': 1.8803238703884204, 'psi': 0.25270219903093555}-{'f1_val': 0.3331695331695332, 'auprc': 0.3331695331695332, 'loss_val': 1.8935784297979683, 'psi': 0.3331695331695332}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=15 head_norm_before_train=2.538697 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.625072229127975, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.518834346796353, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=15 head_norm_before_train=3.052114 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6708414665130327, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6607097024527769, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=15 head_norm_before_train=2.627308 cos_to_last_merge=0.9877 (last merge round=1)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.14386193894568922, 'auprc': 0.14386193894568922, 'loss_val': 6.556942252597414, 'psi': 0.14386193894568922}-{'f1_val': 0.1439756415832971, 'auprc': 0.1439756415832971, 'loss_val': 6.4660687923615665, 'psi': 0.1439756415832971}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=15 head_norm_before_train=3.162471 (no previous merge yet)
[S17] round=15 local utility u=0.165730 metrics={'f1_val': 0.9485778164203205, 'auprc': 0.9485778164203205, 'loss_val': 0.2210828002922004, 'psi': 0.9485778164203205}-{'f1_val': 0.922575518267474, 'auprc': 0.922575518267474, 'loss_val': 0.3185230742721864, 'psi': 0.922575518267474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=16 head_norm_before_train=2.573511 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.25062375249500995, 'auprc': 0.25062375249500995, 'loss_val': 4.445908117878931, 'psi': 0.25062375249500995}-{'f1_val': 0.25062375249500995, 'auprc': 0.25062375249500995, 'loss_val': 4.402366580288456, 'psi': 0.25062375249500995}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=16 head_norm_before_train=2.739837 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 4.105322666707767, 'psi': 0.2588447188987521}-{'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 4.068807506372493, 'psi': 0.2588447188987521}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=16 head_norm_before_train=3.341793 cos_to_last_merge=0.9474 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.6783767245299623, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.670817956381053, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=16 head_norm_before_train=3.342683 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.5352902436875293, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.4792110082028485, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=16 head_norm_before_train=2.667779 cos_to_last_merge=0.9847 (last merge round=1)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 10.727975643909247, 'psi': 0.02240512117055327}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 10.61399638344998, 'psi': 0.02262340036563071}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=16 head_norm_before_train=3.197305 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.6654942272342688, 'auprc': 0.6654942272342688, 'loss_val': 0.26116727068171214, 'psi': 0.6654942272342688}-{'f1_val': 0.6652446656398898, 'auprc': 0.6652446656398898, 'loss_val': 0.24749972131477713, 'psi': 0.6652446656398898}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=16 head_norm_before_train=3.379825 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.4708819512217777, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.3946047893288447, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=16 head_norm_before_train=2.472102 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.664080776225139, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.616548534144577, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=16 head_norm_before_train=3.053953 cos_to_last_merge=0.9773 (last merge round=1)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.358694555928204, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.3016817504689735, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=16 head_norm_before_train=2.690087 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.8249028233444475, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.784416028414007, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=16 head_norm_before_train=3.506140 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.24685963954123427, 'auprc': 0.24685963954123427, 'loss_val': 2.107249561918669, 'psi': 0.24685963954123424}-{'f1_val': 0.25270219903093555, 'auprc': 0.25270219903093555, 'loss_val': 1.8803238703884204, 'psi': 0.25270219903093555}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=16 head_norm_before_train=2.560364 (no previous merge yet)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.727867826350598, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.625072229127975, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=16 head_norm_before_train=3.080903 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6792630717216541, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6708414665130327, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=16 head_norm_before_train=2.651537 cos_to_last_merge=0.9871 (last merge round=1)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.1437481868291268, 'auprc': 0.1437481868291268, 'loss_val': 6.645672807815701, 'psi': 0.1437481868291268}-{'f1_val': 0.14386193894568922, 'auprc': 0.14386193894568922, 'loss_val': 6.556942252597414, 'psi': 0.14386193894568922}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=16 head_norm_before_train=3.218951 (no previous merge yet)
[S17] round=16 local utility u=0.064189 metrics={'f1_val': 0.9594034610804792, 'auprc': 0.9594034610804792, 'loss_val': 0.1901355996158275, 'psi': 0.9594034610804791}-{'f1_val': 0.9485778164203205, 'auprc': 0.9485778164203205, 'loss_val': 0.2210828002922004, 'psi': 0.9485778164203205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=17 head_norm_before_train=2.595241 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.25034267912772584, 'auprc': 0.25034267912772584, 'loss_val': 4.488956762333628, 'psi': 0.25034267912772584}-{'f1_val': 0.25062375249500995, 'auprc': 0.25062375249500995, 'loss_val': 4.445908117878931, 'psi': 0.25062375249500995}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=17 head_norm_before_train=2.763171 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 4.140654460461698, 'psi': 0.2588447188987521}-{'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 4.105322666707767, 'psi': 0.2588447188987521}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=17 head_norm_before_train=3.365736 cos_to_last_merge=0.9459 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.7288455796112006, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.6783767245299623, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=17 head_norm_before_train=3.397584 (no previous merge yet)
[S5] round=17 local utility u=1.000000 metrics={'f1_val': 0.6633131193653932, 'auprc': 0.6633131193653932, 'loss_val': 0.09130631877080024, 'psi': 0.6633131193653932}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.5352902436875293, 'psi': 0.33400978131092857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=17 head_norm_before_train=2.690880 cos_to_last_merge=0.9840 (last merge round=1)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 10.837394319747345, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 10.727975643909247, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=17 head_norm_before_train=3.246309 (no previous merge yet)
[S7] round=17 local utility u=0.033165 metrics={'f1_val': 0.665161395565352, 'auprc': 0.665161395565352, 'loss_val': 0.19184180610962948, 'psi': 0.665161395565352}-{'f1_val': 0.6654942272342688, 'auprc': 0.6654942272342688, 'loss_val': 0.26116727068171214, 'psi': 0.6654942272342688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=17 head_norm_before_train=3.011478 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.609143704051573, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.4708819512217777, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=17 head_norm_before_train=2.494362 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.709689430909867, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.664080776225139, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=17 head_norm_before_train=3.081890 cos_to_last_merge=0.9762 (last merge round=1)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.413855296714602, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.358694555928204, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=17 head_norm_before_train=2.714217 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.861179802102229, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.8249028233444475, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=17 head_norm_before_train=3.560435 (no previous merge yet)
[S13] round=17 local utility u=0.226219 metrics={'f1_val': 0.2608695652173913, 'auprc': 0.2608695652173913, 'loss_val': 1.780900351905564, 'psi': 0.2608695652173913}-{'f1_val': 0.24685963954123427, 'auprc': 0.24685963954123427, 'loss_val': 2.107249561918669, 'psi': 0.24685963954123424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] START round=17 head_norm_before_train=2.581299 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.82713166783612, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.727867826350598, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=17 head_norm_before_train=3.108689 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6888371050961192, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6792630717216541, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=17 head_norm_before_train=2.674907 cos_to_last_merge=0.9864 (last merge round=1)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.1439756415832971, 'auprc': 0.1439756415832971, 'loss_val': 6.725131315067115, 'psi': 0.1439756415832971}-{'f1_val': 0.1437481868291268, 'auprc': 0.1437481868291268, 'loss_val': 6.645672807815701, 'psi': 0.1437481868291268}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=17 head_norm_before_train=3.261423 (no previous merge yet)
[S17] round=17 local utility u=0.110635 metrics={'f1_val': 0.9778016707286852, 'auprc': 0.9778016707286852, 'loss_val': 0.13444883736907529, 'psi': 0.9778016707286852}-{'f1_val': 0.9594034610804792, 'auprc': 0.9594034610804792, 'loss_val': 0.1901355996158275, 'psi': 0.9594034610804791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=18 head_norm_before_train=2.616366 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.25024912805181865, 'auprc': 0.25024912805181865, 'loss_val': 4.530091948278448, 'psi': 0.25024912805181865}-{'f1_val': 0.25034267912772584, 'auprc': 0.25034267912772584, 'loss_val': 4.488956762333628, 'psi': 0.25034267912772584}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=18 head_norm_before_train=2.785667 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 4.174845862708176, 'psi': 0.2588447188987521}-{'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 4.140654460461698, 'psi': 0.2588447188987521}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=18 head_norm_before_train=3.417092 cos_to_last_merge=0.9440 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.794140363692314, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.7288455796112006, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=18 head_norm_before_train=3.353642 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.6629908830658303, 'auprc': 0.6629908830658303, 'loss_val': 0.12580272950046503, 'psi': 0.6629908830658303}-{'f1_val': 0.6633131193653932, 'auprc': 0.6633131193653932, 'loss_val': 0.09130631877080024, 'psi': 0.6633131193653932}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=18 head_norm_before_train=2.713176 cos_to_last_merge=0.9833 (last merge round=1)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 10.944824149326678, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 10.837394319747345, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=18 head_norm_before_train=3.305757 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6649113362787039, 'auprc': 0.6649113362787039, 'loss_val': 0.23009056423932955, 'psi': 0.6649113362787039}-{'f1_val': 0.665161395565352, 'auprc': 0.665161395565352, 'loss_val': 0.19184180610962948, 'psi': 0.665161395565352}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=3.055478 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.6863108670687343, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.609143704051573, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=18 head_norm_before_train=2.515882 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.75457696515271, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.709689430909867, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=18 head_norm_before_train=3.108816 cos_to_last_merge=0.9751 (last merge round=1)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.4668928550046125, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.413855296714602, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=18 head_norm_before_train=2.737674 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.895286229399743, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.861179802102229, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=18 head_norm_before_train=3.633138 (no previous merge yet)
[S13] round=18 local utility u=0.076556 metrics={'f1_val': 0.2714171337069656, 'auprc': 0.2714171337069656, 'loss_val': 1.7227169796469395, 'psi': 0.2714171337069656}-{'f1_val': 0.2608695652173913, 'auprc': 0.2608695652173913, 'loss_val': 1.780900351905564, 'psi': 0.2608695652173913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=18 head_norm_before_train=2.601519 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.924185848222747, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.82713166783612, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=18 head_norm_before_train=3.135516 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6966267420983403, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6888371050961192, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=18 head_norm_before_train=2.697489 cos_to_last_merge=0.9858 (last merge round=1)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.14420289855072463, 'auprc': 0.14420289855072463, 'loss_val': 6.800280562529967, 'psi': 0.14420289855072463}-{'f1_val': 0.1439756415832971, 'auprc': 0.1439756415832971, 'loss_val': 6.725131315067115, 'psi': 0.1439756415832971}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=18 head_norm_before_train=3.297803 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.5456167858071175, 'auprc': 0.5456167858071175, 'loss_val': 1.9891156310871796, 'psi': 0.5456167858071175}-{'f1_val': 0.9778016707286852, 'auprc': 0.9778016707286852, 'loss_val': 0.13444883736907529, 'psi': 0.9778016707286852}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=19 head_norm_before_train=2.636843 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.25015564686838504, 'auprc': 0.25015564686838504, 'loss_val': 4.570446422322476, 'psi': 0.25015564686838504}-{'f1_val': 0.25024912805181865, 'auprc': 0.25024912805181865, 'loss_val': 4.530091948278448, 'psi': 0.25024912805181865}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.250 u=0.0000 p_local=0.0144 f1=0.250 auprc=0.250 bytes=0
[S3] START round=19 head_norm_before_train=2.807439 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 4.208038784357866, 'psi': 0.2587947777992154}-{'f1_val': 0.2588447188987521, 'auprc': 0.2588447188987521, 'loss_val': 4.174845862708176, 'psi': 0.2588447188987521}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=20 psi=0.259 u=0.0000 p_local=0.0156 f1=0.259 auprc=0.259 bytes=1795
[S4] START round=19 head_norm_before_train=3.458946 cos_to_last_merge=0.9434 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.943
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.860857453553577, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.794140363692314, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=20 psi=0.357 u=0.0000 p_local=0.0144 f1=0.357 auprc=0.357 bytes=0
[S5] START round=19 head_norm_before_train=3.444694 (no previous merge yet)
[S5] round=19 local utility u=0.003587 metrics={'f1_val': 0.6633131193653932, 'auprc': 0.6633131193653932, 'loss_val': 0.12152924146463102, 'psi': 0.6633131193653932}-{'f1_val': 0.6629908830658303, 'auprc': 0.6629908830658303, 'loss_val': 0.12580272950046503, 'psi': 0.6629908830658303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S5] r=20 psi=0.663 u=0.0036 p_local=0.1780 f1=0.663 auprc=0.663 bytes=16181
[S6] START round=19 head_norm_before_train=2.734527 cos_to_last_merge=0.9827 (last merge round=1)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.05026843801538, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 10.944824149326678, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.022 u=0.0000 p_local=0.0146 f1=0.022 auprc=0.022 bytes=0
[S7] START round=19 head_norm_before_train=3.347283 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.6649113362787039, 'auprc': 0.6649113362787039, 'loss_val': 0.24231558843094822, 'psi': 0.6649113362787039}-{'f1_val': 0.6649113362787039, 'auprc': 0.6649113362787039, 'loss_val': 0.23009056423932955, 'psi': 0.6649113362787039}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=20 psi=0.665 u=0.0000 p_local=0.1029 f1=0.665 auprc=0.665 bytes=17999
[S8] START round=19 head_norm_before_train=3.129933 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.7349071586382014, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.6863108670687343, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=20 psi=0.359 u=0.0000 p_local=0.0144 f1=0.359 auprc=0.359 bytes=0
[S9] START round=19 head_norm_before_train=2.536891 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.798721684077682, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.75457696515271, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0144 f1=0.369 auprc=0.369 bytes=0
[S10] START round=19 head_norm_before_train=3.134916 cos_to_last_merge=0.9741 (last merge round=1)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.518404886951021, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.4668928550046125, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=20 psi=0.333 u=0.0000 p_local=0.0147 f1=0.333 auprc=0.333 bytes=1803
[S11] START round=19 head_norm_before_train=2.760312 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.932709149621097, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.895286229399743, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=20 psi=0.332 u=0.0000 p_local=0.0144 f1=0.332 auprc=0.332 bytes=0
[S13] START round=19 head_norm_before_train=3.660888 (no previous merge yet)
[S13] round=19 local utility u=0.247285 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7824466906935996, 'psi': 0.3330058939096267}-{'f1_val': 0.2714171337069656, 'auprc': 0.2714171337069656, 'loss_val': 1.7227169796469395, 'psi': 0.2714171337069656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S13] r=20 psi=0.333 u=0.2473 p_local=0.1089 f1=0.333 auprc=0.333 bytes=12568
[S14] START round=19 head_norm_before_train=2.621140 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.019260066942056, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 9.924185848222747, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=20 psi=0.136 u=0.0000 p_local=0.0144 f1=0.136 auprc=0.136 bytes=0
[S15] START round=19 head_norm_before_train=3.161284 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7062608379385226, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6966267420983403, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=20 psi=0.616 u=0.0000 p_local=0.0147 f1=0.616 auprc=0.616 bytes=1804
[S16] START round=19 head_norm_before_train=2.719406 cos_to_last_merge=0.9852 (last merge round=1)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.14465682015638576, 'auprc': 0.14465682015638576, 'loss_val': 6.8664916757407095, 'psi': 0.14465682015638576}-{'f1_val': 0.14420289855072463, 'auprc': 0.14420289855072463, 'loss_val': 6.800280562529967, 'psi': 0.14420289855072463}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=20 psi=0.145 u=0.0000 p_local=0.0162 f1=0.145 auprc=0.145 bytes=0
[S17] START round=19 head_norm_before_train=3.264524 (no previous merge yet)
[S17] round=19 local utility u=1.000000 metrics={'f1_val': 0.9833989234780256, 'auprc': 0.9833989234780256, 'loss_val': 0.06460044336065092, 'psi': 0.9833989234780256}-{'f1_val': 0.5456167858071175, 'auprc': 0.5456167858071175, 'loss_val': 1.9891156310871796, 'psi': 0.5456167858071175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S17] r=20 psi=0.983 u=1.0000 p_local=0.3138 f1=0.983 auprc=0.983 bytes=25167
[S2] START round=20 head_norm_before_train=2.656826 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.25010893246187366, 'auprc': 0.25010893246187366, 'loss_val': 4.609528642186205, 'psi': 0.25010893246187366}-{'f1_val': 0.25015564686838504, 'auprc': 0.25015564686838504, 'loss_val': 4.570446422322476, 'psi': 0.25015564686838504}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=2.828552 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 4.24039137993242, 'psi': 0.25869495339119253}-{'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 4.208038784357866, 'psi': 0.2587947777992154}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=20 head_norm_before_train=3.477091 cos_to_last_merge=0.9419 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.971716118532469, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.860857453553577, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=20 head_norm_before_train=3.521260 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 3.399442653694397, 'psi': 0.333168561542264}-{'f1_val': 0.6633131193653932, 'auprc': 0.6633131193653932, 'loss_val': 0.12152924146463102, 'psi': 0.6633131193653932}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=20 head_norm_before_train=2.755349 cos_to_last_merge=0.9820 (last merge round=1)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.15142622461573, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.05026843801538, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=3.378376 (no previous merge yet)
[S7] round=20 local utility u=0.016989 metrics={'f1_val': 0.6649113362787039, 'auprc': 0.6649113362787039, 'loss_val': 0.20833802734148735, 'psi': 0.6649113362787039}-{'f1_val': 0.6649113362787039, 'auprc': 0.6649113362787039, 'loss_val': 0.24231558843094822, 'psi': 0.6649113362787039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=20 head_norm_before_train=3.234080 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8326807550525452, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.7349071586382014, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=20 head_norm_before_train=2.557355 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.84017694320626, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.798721684077682, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=20 head_norm_before_train=3.160231 cos_to_last_merge=0.9730 (last merge round=1)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.568230576332795, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.518404886951021, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=20 head_norm_before_train=2.782283 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.965468861100838, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.932709149621097, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=20 head_norm_before_train=3.721254 (no previous merge yet)
[S13] round=20 local utility u=0.004441 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.773563839699441, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7824466906935996, 'psi': 0.3330058939096267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=20 head_norm_before_train=2.640263 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.11219964131003, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.019260066942056, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=20 head_norm_before_train=3.186121 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7147491185732918, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7062608379385226, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=2.740670 cos_to_last_merge=0.9846 (last merge round=1)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.14454341371569265, 'auprc': 0.14454341371569265, 'loss_val': 6.943620211657158, 'psi': 0.14454341371569265}-{'f1_val': 0.14465682015638576, 'auprc': 0.14465682015638576, 'loss_val': 6.8664916757407095, 'psi': 0.14465682015638576}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=3.340043 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.9794776499660187, 'auprc': 0.9794776499660187, 'loss_val': 0.08225614850789587, 'psi': 0.9794776499660187}-{'f1_val': 0.9833989234780256, 'auprc': 0.9833989234780256, 'loss_val': 0.06460044336065092, 'psi': 0.9833989234780256}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=21 head_norm_before_train=2.676277 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.25020237872843887, 'auprc': 0.25020237872843887, 'loss_val': 4.648393140854485, 'psi': 0.25020237872843887}-{'f1_val': 0.25010893246187366, 'auprc': 0.25010893246187366, 'loss_val': 4.609528642186205, 'psi': 0.25010893246187366}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=21 head_norm_before_train=2.849072 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 4.272194310905947, 'psi': 0.25869495339119253}-{'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 4.24039137993242, 'psi': 0.25869495339119253}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=21 head_norm_before_train=3.534661 cos_to_last_merge=0.9404 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.940
[S4] round=21 local utility u=0.032478 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.906759286705004, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.971716118532469, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] sending update (kind=head size=1790 to 1 peers)
[S5] START round=21 head_norm_before_train=3.542212 (no previous merge yet)
[S5] round=21 local utility u=1.000000 metrics={'f1_val': 0.6639557459258837, 'auprc': 0.6639557459258837, 'loss_val': 0.06780933270077276, 'psi': 0.6639557459258837}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 3.399442653694397, 'psi': 0.333168561542264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=21 head_norm_before_train=2.775554 cos_to_last_merge=0.9814 (last merge round=1)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.250564486159448, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.15142622461573, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=3.404294 (no previous merge yet)
[S7] round=21 local utility u=0.021063 metrics={'f1_val': 0.6649113362787039, 'auprc': 0.6649113362787039, 'loss_val': 0.16621128311567562, 'psi': 0.6649113362787039}-{'f1_val': 0.6649113362787039, 'auprc': 0.6649113362787039, 'loss_val': 0.20833802734148735, 'psi': 0.6649113362787039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=21 head_norm_before_train=3.327996 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8512244801226974, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8326807550525452, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=21 head_norm_before_train=2.577112 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.8815963551111645, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.84017694320626, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=3.184833 cos_to_last_merge=0.9720 (last merge round=1)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.615856315061756, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.568230576332795, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=21 head_norm_before_train=2.803816 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.996382383188416, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.965468861100838, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=21 head_norm_before_train=3.761481 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.31816048803378694, 'auprc': 0.31816048803378694, 'loss_val': 1.8771721570037627, 'psi': 0.31816048803378694}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.773563839699441, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=2.658889 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.20368194424705, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.11219964131003, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=21 head_norm_before_train=3.210455 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7221375056623974, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7147491185732918, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=2.761401 cos_to_last_merge=0.9840 (last merge round=1)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.14420289855072463, 'auprc': 0.14420289855072463, 'loss_val': 7.03024358168568, 'psi': 0.14420289855072463}-{'f1_val': 0.14454341371569265, 'auprc': 0.14454341371569265, 'loss_val': 6.943620211657158, 'psi': 0.14454341371569265}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=3.399221 (no previous merge yet)
[S17] round=21 local utility u=0.027495 metrics={'f1_val': 0.9839596257840104, 'auprc': 0.9839596257840104, 'loss_val': 0.06760462839393422, 'psi': 0.9839596257840104}-{'f1_val': 0.9794776499660187, 'auprc': 0.9794776499660187, 'loss_val': 0.08225614850789587, 'psi': 0.9794776499660187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=22 head_norm_before_train=2.695443 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.25001555597038144, 'auprc': 0.25001555597038144, 'loss_val': 4.68619803717131, 'psi': 0.25001555597038144}-{'f1_val': 0.25020237872843887, 'auprc': 0.25020237872843887, 'loss_val': 4.648393140854485, 'psi': 0.25020237872843887}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=2.869126 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.303225570693529, 'psi': 0.2586450700604191}-{'f1_val': 0.25869495339119253, 'auprc': 0.25869495339119253, 'loss_val': 4.272194310905947, 'psi': 0.25869495339119253}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=3.487782 cos_to_last_merge=0.9387 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.939
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.028027355447754, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 3.906759286705004, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=22 head_norm_before_train=3.591672 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.6628010089620648, 'auprc': 0.6628010089620648, 'loss_val': 0.0969186599347684, 'psi': 0.6628010089620648}-{'f1_val': 0.6639557459258837, 'auprc': 0.6639557459258837, 'loss_val': 0.06780933270077276, 'psi': 0.6639557459258837}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=2.795398 cos_to_last_merge=0.9808 (last merge round=1)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.347932012002873, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.250564486159448, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=22 head_norm_before_train=3.458036 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6656603947486558, 'auprc': 0.6656603947486558, 'loss_val': 0.199934278306312, 'psi': 0.6656603947486558}-{'f1_val': 0.6649113362787039, 'auprc': 0.6649113362787039, 'loss_val': 0.16621128311567562, 'psi': 0.6649113362787039}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=22 head_norm_before_train=3.396531 (no previous merge yet)
[S8] round=22 local utility u=0.002272 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8466795243680223, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8512244801226974, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=22 head_norm_before_train=2.596545 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.922061687196079, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.8815963551111645, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=3.208992 cos_to_last_merge=0.9711 (last merge round=1)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.663021816605722, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.615856315061756, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=22 head_norm_before_train=2.824858 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.027673243968973, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 4.996382383188416, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=22 head_norm_before_train=3.774552 (no previous merge yet)
[S13] round=22 local utility u=0.012278 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.9862242803827697, 'psi': 0.3330058939096267}-{'f1_val': 0.31816048803378694, 'auprc': 0.31816048803378694, 'loss_val': 1.8771721570037627, 'psi': 0.31816048803378694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] START round=22 head_norm_before_train=2.677113 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.29410481195551, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.20368194424705, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=22 head_norm_before_train=3.234121 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7289721167634656, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7221375056623974, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=22 head_norm_before_train=2.781674 cos_to_last_merge=0.9835 (last merge round=1)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.14477017734346725, 'auprc': 0.14477017734346725, 'loss_val': 7.083012482064328, 'psi': 0.14477017734346725}-{'f1_val': 0.14420289855072463, 'auprc': 0.14420289855072463, 'loss_val': 7.03024358168568, 'psi': 0.14420289855072463}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=3.449865 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.9831186220043759, 'auprc': 0.9831186220043759, 'loss_val': 0.07549589536570375, 'psi': 0.9831186220043759}-{'f1_val': 0.9839596257840104, 'auprc': 0.9839596257840104, 'loss_val': 0.06760462839393422, 'psi': 0.9839596257840104}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=2.714174 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.25001555597038144, 'auprc': 0.25001555597038144, 'loss_val': 4.723039206182773, 'psi': 0.25001555597038144}-{'f1_val': 0.25001555597038144, 'auprc': 0.25001555597038144, 'loss_val': 4.68619803717131, 'psi': 0.25001555597038144}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=2.888673 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.333759704003543, 'psi': 0.2586450700604191}-{'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.303225570693529, 'psi': 0.2586450700604191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=3.588664 cos_to_last_merge=0.9389 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.939
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.098489186677084, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.028027355447754, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=23 head_norm_before_train=3.637813 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.5370903284911713, 'auprc': 0.5370903284911713, 'loss_val': 0.4017302131951171, 'psi': 0.5370903284911713}-{'f1_val': 0.6628010089620648, 'auprc': 0.6628010089620648, 'loss_val': 0.0969186599347684, 'psi': 0.6628010089620648}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=23 head_norm_before_train=2.814783 cos_to_last_merge=0.9802 (last merge round=1)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.442013687746154, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.347932012002873, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=3.496913 (no previous merge yet)
[S7] round=23 local utility u=0.026291 metrics={'f1_val': 0.6654110814434088, 'auprc': 0.6654110814434088, 'loss_val': 0.1451085444099311, 'psi': 0.6654110814434088}-{'f1_val': 0.6656603947486558, 'auprc': 0.6656603947486558, 'loss_val': 0.199934278306312, 'psi': 0.6656603947486558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=23 head_norm_before_train=3.455274 (no previous merge yet)
[S8] round=23 local utility u=0.000678 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.845323747425444, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8466795243680223, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=23 head_norm_before_train=2.615567 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.96232698455129, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.922061687196079, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=23 head_norm_before_train=3.232563 cos_to_last_merge=0.9701 (last merge round=1)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.7089270249379185, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.663021816605722, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=23 head_norm_before_train=2.845487 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.061213420579153, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.027673243968973, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=23 head_norm_before_train=3.824638 (no previous merge yet)
[S13] round=23 local utility u=0.134553 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7171179358129776, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.9862242803827697, 'psi': 0.3330058939096267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=23 head_norm_before_train=2.695017 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.38236619229362, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.29410481195551, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=23 head_norm_before_train=3.257033 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7367175768617549, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7289721167634656, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=2.801549 cos_to_last_merge=0.9829 (last merge round=1)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.1448834853090172, 'auprc': 0.1448834853090172, 'loss_val': 7.148196597693463, 'psi': 0.1448834853090172}-{'f1_val': 0.14477017734346725, 'auprc': 0.14477017734346725, 'loss_val': 7.083012482064328, 'psi': 0.14477017734346725}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=23 head_norm_before_train=3.484517 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.9822779146481553, 'auprc': 0.9822779146481553, 'loss_val': 0.08172419827882797, 'psi': 0.9822779146481553}-{'f1_val': 0.9831186220043759, 'auprc': 0.9831186220043759, 'loss_val': 0.07549589536570375, 'psi': 0.9831186220043759}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=24 head_norm_before_train=2.732518 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.24996889386587037, 'auprc': 0.24996889386587037, 'loss_val': 4.75991147249999, 'psi': 0.24996889386587035}-{'f1_val': 0.25001555597038144, 'auprc': 0.25001555597038144, 'loss_val': 4.723039206182773, 'psi': 0.25001555597038144}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=2.907822 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.364370296637798, 'psi': 0.2586450700604191}-{'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.333759704003543, 'psi': 0.2586450700604191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=24 head_norm_before_train=3.636256 cos_to_last_merge=0.9382 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.18536274741211, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.098489186677084, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=3.639293 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 0.7068636380533155, 'psi': 0.33308623671855697}-{'f1_val': 0.5370903284911713, 'auprc': 0.5370903284911713, 'loss_val': 0.4017302131951171, 'psi': 0.5370903284911713}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=2.833979 cos_to_last_merge=0.9796 (last merge round=1)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.537999772649053, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.442013687746154, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=3.552297 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.49930737685375043, 'auprc': 0.49930737685375043, 'loss_val': 0.1260760215516285, 'psi': 0.4993073768537504}-{'f1_val': 0.6654110814434088, 'auprc': 0.6654110814434088, 'loss_val': 0.1451085444099311, 'psi': 0.6654110814434088}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=24 head_norm_before_train=3.506493 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8524775263352184, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.845323747425444, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=24 head_norm_before_train=2.634334 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.001286737784231, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 4.96232698455129, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=3.255688 cos_to_last_merge=0.9692 (last merge round=1)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.75432168238942, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.7089270249379185, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=24 head_norm_before_train=2.865785 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.089289706266396, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.061213420579153, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=24 head_norm_before_train=3.782765 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.8318567540116297, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.7171179358129776, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=2.712613 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.470426926883052, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.38236619229362, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=24 head_norm_before_train=3.279714 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7428171468933426, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7367175768617549, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=24 head_norm_before_train=2.821036 cos_to_last_merge=0.9824 (last merge round=1)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.14477017734346725, 'auprc': 0.14477017734346725, 'loss_val': 7.228555946835625, 'psi': 0.14477017734346725}-{'f1_val': 0.1448834853090172, 'auprc': 0.1448834853090172, 'loss_val': 7.148196597693463, 'psi': 0.1448834853090172}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=3.513871 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.981717605922058, 'auprc': 0.981717605922058, 'loss_val': 0.08615585487025577, 'psi': 0.981717605922058}-{'f1_val': 0.9822779146481553, 'auprc': 0.9822779146481553, 'loss_val': 0.08172419827882797, 'psi': 0.9822779146481553}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=2.750608 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.24996889386587037, 'auprc': 0.24996889386587037, 'loss_val': 4.795711099418453, 'psi': 0.24996889386587035}-{'f1_val': 0.24996889386587037, 'auprc': 0.24996889386587037, 'loss_val': 4.75991147249999, 'psi': 0.24996889386587035}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=25 head_norm_before_train=2.926676 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.394324291318449, 'psi': 0.2586450700604191}-{'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.364370296637798, 'psi': 0.2586450700604191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=3.683277 cos_to_last_merge=0.9368 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.937
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.224932819495323, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.18536274741211, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=25 head_norm_before_train=3.635423 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.0318563179888556, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 0.7068636380533155, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=2.852512 cos_to_last_merge=0.9790 (last merge round=1)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.63069072632505, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.537999772649053, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=3.596028 (no previous merge yet)
[S7] round=25 local utility u=0.713859 metrics={'f1_val': 0.6657434165338773, 'auprc': 0.6657434165338773, 'loss_val': 0.19628321634714166, 'psi': 0.6657434165338773}-{'f1_val': 0.49930737685375043, 'auprc': 0.49930737685375043, 'loss_val': 0.1260760215516285, 'psi': 0.4993073768537504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=25 head_norm_before_train=3.552990 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8681888197054803, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8524775263352184, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=25 head_norm_before_train=2.652717 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.038546110399168, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.001286737784231, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=3.278446 cos_to_last_merge=0.9682 (last merge round=1)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.797707163605578, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.75432168238942, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=25 head_norm_before_train=2.885718 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.118081332491285, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.089289706266396, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=3.839526 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.8615335765632177, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.8318567540116297, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=2.729831 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.556839424693264, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.470426926883052, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=25 head_norm_before_train=3.301797 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7515373729305602, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7428171468933426, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=2.840220 cos_to_last_merge=0.9819 (last merge round=1)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.1451099537037037, 'auprc': 0.1451099537037037, 'loss_val': 7.272947310131459, 'psi': 0.1451099537037037}-{'f1_val': 0.14477017734346725, 'auprc': 0.14477017734346725, 'loss_val': 7.228555946835625, 'psi': 0.14477017734346725}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=3.539504 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.9808773843511387, 'auprc': 0.9808773843511387, 'loss_val': 0.0921088676378001, 'psi': 0.9808773843511387}-{'f1_val': 0.981717605922058, 'auprc': 0.981717605922058, 'loss_val': 0.08615585487025577, 'psi': 0.981717605922058}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=26 head_norm_before_train=2.768349 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.24992224917584127, 'auprc': 0.24992224917584127, 'loss_val': 4.831120817297873, 'psi': 0.24992224917584127}-{'f1_val': 0.24996889386587037, 'auprc': 0.24996889386587037, 'loss_val': 4.795711099418453, 'psi': 0.24996889386587035}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=2.945146 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.4239966739775065, 'psi': 0.2586450700604191}-{'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.394324291318449, 'psi': 0.2586450700604191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=3.659853 cos_to_last_merge=0.9331 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.933
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.231985799292181, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.224932819495323, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=26 head_norm_before_train=3.692384 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.0527824798792853, 'psi': 0.33358943696313936}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.0318563179888556, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=2.870809 cos_to_last_merge=0.9784 (last merge round=1)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.721693962429644, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.63069072632505, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=3.631150 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.49936964323881095, 'auprc': 0.49936964323881095, 'loss_val': 0.2068994231557538, 'psi': 0.49936964323881095}-{'f1_val': 0.6657434165338773, 'auprc': 0.6657434165338773, 'loss_val': 0.19628321634714166, 'psi': 0.6657434165338773}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=3.595763 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.888107945163007, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.8681888197054803, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=26 head_norm_before_train=2.670727 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.076137281596427, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.038546110399168, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=3.300840 cos_to_last_merge=0.9673 (last merge round=1)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.8408409544288915, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.797707163605578, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=26 head_norm_before_train=2.905264 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.145383402142583, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.118081332491285, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=3.874450 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.9575834336214966, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.8615335765632177, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=2.746816 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.641694635116098, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.556839424693264, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=3.323603 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7585686454667502, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7515373729305602, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=2.859027 cos_to_last_merge=0.9813 (last merge round=1)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.1451099537037037, 'auprc': 0.1451099537037037, 'loss_val': 7.338493675202931, 'psi': 0.1451099537037037}-{'f1_val': 0.1451099537037037, 'auprc': 0.1451099537037037, 'loss_val': 7.272947310131459, 'psi': 0.1451099537037037}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=3.563671 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.9800374493077345, 'auprc': 0.9800374493077345, 'loss_val': 0.09641205877995362, 'psi': 0.9800374493077345}-{'f1_val': 0.9808773843511387, 'auprc': 0.9808773843511387, 'loss_val': 0.0921088676378001, 'psi': 0.9808773843511387}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=2.785896 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.2497824194952132, 'auprc': 0.2497824194952132, 'loss_val': 4.86640016393044, 'psi': 0.2497824194952132}-{'f1_val': 0.24992224917584127, 'auprc': 0.24992224917584127, 'loss_val': 4.831120817297873, 'psi': 0.24992224917584127}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=2.963331 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.45358950053663, 'psi': 0.2586450700604191}-{'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.4239966739775065, 'psi': 0.2586450700604191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=3.729889 cos_to_last_merge=0.9314 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.931
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.378762013059454, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.231985799292181, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=3.708333 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 3.2029124806379827, 'psi': 0.333168561542264}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.0527824798792853, 'psi': 0.33358943696313936}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=2.888729 cos_to_last_merge=0.9779 (last merge round=1)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.817032991507062, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.721693962429644, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=3.647046 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.2128068413878357, 'psi': 0.49924507948268093}-{'f1_val': 0.49936964323881095, 'auprc': 0.49936964323881095, 'loss_val': 0.2068994231557538, 'psi': 0.49936964323881095}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=27 head_norm_before_train=3.635798 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.9113489222442084, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.888107945163007, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=27 head_norm_before_train=2.688570 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.1130227429036035, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.076137281596427, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=3.322850 cos_to_last_merge=0.9664 (last merge round=1)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.883401036901268, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.8408409544288915, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=27 head_norm_before_train=2.924572 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.176401954685689, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.145383402142583, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=3.879089 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.9625746583923493, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.9575834336214966, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=2.763608 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.72570310273945, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.641694635116098, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=3.344947 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.765453800134691, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7585686454667502, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=2.877537 cos_to_last_merge=0.9808 (last merge round=1)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.1452231141968612, 'auprc': 0.1452231141968612, 'loss_val': 7.398021533353176, 'psi': 0.1452231141968612}-{'f1_val': 0.1451099537037037, 'auprc': 0.1451099537037037, 'loss_val': 7.338493675202931, 'psi': 0.1451099537037037}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=3.585724 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.9800374493077345, 'auprc': 0.9800374493077345, 'loss_val': 0.09970244239716407, 'psi': 0.9800374493077345}-{'f1_val': 0.9800374493077345, 'auprc': 0.9800374493077345, 'loss_val': 0.09641205877995362, 'psi': 0.9800374493077345}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=28 head_norm_before_train=2.803277 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.24973584436571572, 'auprc': 0.24973584436571572, 'loss_val': 4.900910659082074, 'psi': 0.24973584436571572}-{'f1_val': 0.2497824194952132, 'auprc': 0.2497824194952132, 'loss_val': 4.86640016393044, 'psi': 0.2497824194952132}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=2.981249 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.482569831470966, 'psi': 0.2586450700604191}-{'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.45358950053663, 'psi': 0.2586450700604191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=3.782970 cos_to_last_merge=0.9308 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.931
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.382285492043405, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.378762013059454, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=3.767004 (no previous merge yet)
[S5] round=28 local utility u=0.857317 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.4958500936585981, 'psi': 0.33400978131092857}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 3.2029124806379827, 'psi': 0.333168561542264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=28 head_norm_before_train=2.906433 cos_to_last_merge=0.9774 (last merge round=1)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.90447966956385, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.817032991507062, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=3.694563 (no previous merge yet)
[S7] round=28 local utility u=0.745204 metrics={'f1_val': 0.6657434165338773, 'auprc': 0.6657434165338773, 'loss_val': 0.2208834544971648, 'psi': 0.6657434165338773}-{'f1_val': 0.49924507948268093, 'auprc': 0.49924507948268093, 'loss_val': 0.2128068413878357, 'psi': 0.49924507948268093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=28 head_norm_before_train=3.674094 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.937825012821211, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.9113489222442084, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=2.706160 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.148957342675559, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.1130227429036035, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=3.344621 cos_to_last_merge=0.9655 (last merge round=1)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.924776190880391, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.883401036901268, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=28 head_norm_before_train=2.943683 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.2008342456479975, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.176401954685689, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=28 head_norm_before_train=3.927056 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.083397771004653, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.9625746583923493, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=2.780206 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.808954608878182, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.72570310273945, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=3.366108 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7731237949232325, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.765453800134691, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=2.895899 cos_to_last_merge=0.9803 (last merge round=1)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.1452231141968612, 'auprc': 0.1452231141968612, 'loss_val': 7.46982787102571, 'psi': 0.1452231141968612}-{'f1_val': 0.1452231141968612, 'auprc': 0.1452231141968612, 'loss_val': 7.398021533353176, 'psi': 0.1452231141968612}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=3.606881 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.9797575339928171, 'auprc': 0.9797575339928171, 'loss_val': 0.10432051132704155, 'psi': 0.9797575339928171}-{'f1_val': 0.9800374493077345, 'auprc': 0.9800374493077345, 'loss_val': 0.09970244239716407, 'psi': 0.9800374493077345}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=2.820379 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.24964274619447033, 'auprc': 0.24964274619447033, 'loss_val': 4.935068323250253, 'psi': 0.2496427461944703}-{'f1_val': 0.24973584436571572, 'auprc': 0.24973584436571572, 'loss_val': 4.900910659082074, 'psi': 0.24973584436571572}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=2.998909 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.511626897639974, 'psi': 0.2586450700604191}-{'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.482569831470966, 'psi': 0.2586450700604191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=3.833776 cos_to_last_merge=0.9296 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.930
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.535573160499404, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.382285492043405, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=3.829310 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.5128006322975243, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.4958500936585981, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=2.923948 cos_to_last_merge=0.9768 (last merge round=1)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.991352015230905, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.90447966956385, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=3.747052 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.49824408849912083, 'auprc': 0.49824408849912083, 'loss_val': 0.16539196762648478, 'psi': 0.49824408849912083}-{'f1_val': 0.6657434165338773, 'auprc': 0.6657434165338773, 'loss_val': 0.2208834544971648, 'psi': 0.6657434165338773}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=3.711237 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.967023924811741, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.937825012821211, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=2.723507 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.184708696244747, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.148957342675559, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=3.366203 cos_to_last_merge=0.9647 (last merge round=1)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.966073959001867, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.924776190880391, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=29 head_norm_before_train=2.962547 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.230406217204661, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.2008342456479975, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=3.968999 (no previous merge yet)
[S13] round=29 local utility u=0.033441 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.0165165834541603, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.083397771004653, 'psi': 0.3330058939096267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] START round=29 head_norm_before_train=2.796543 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.890862696455983, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.808954608878182, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=3.386959 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7805820092884153, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7731237949232325, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=2.913994 cos_to_last_merge=0.9798 (last merge round=1)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.14544928793464904, 'auprc': 0.14544928793464904, 'loss_val': 7.526771635897468, 'psi': 0.14544928793464904}-{'f1_val': 0.1452231141968612, 'auprc': 0.1452231141968612, 'loss_val': 7.46982787102571, 'psi': 0.1452231141968612}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=3.626797 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.9797575339928171, 'auprc': 0.9797575339928171, 'loss_val': 0.1084473839743121, 'psi': 0.9797575339928171}-{'f1_val': 0.9797575339928171, 'auprc': 0.9797575339928171, 'loss_val': 0.10432051132704155, 'psi': 0.9797575339928171}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=2.837323 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.24950322901142574, 'auprc': 0.24950322901142574, 'loss_val': 4.969665113022327, 'psi': 0.24950322901142574}-{'f1_val': 0.24964274619447033, 'auprc': 0.24964274619447033, 'loss_val': 4.935068323250253, 'psi': 0.2496427461944703}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=3.016347 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.540677005956124, 'psi': 0.2586450700604191}-{'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.511626897639974, 'psi': 0.2586450700604191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=3.869839 cos_to_last_merge=0.9292 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.929
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.5574173425696625, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.535573160499404, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=3.893426 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.5650115252731407, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.5128006322975243, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=2.941199 cos_to_last_merge=0.9763 (last merge round=1)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.077503254248054, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 11.991352015230905, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=3.798148 (no previous merge yet)
[S7] round=30 local utility u=0.020603 metrics={'f1_val': 0.49936964323881095, 'auprc': 0.49936964323881095, 'loss_val': 0.13431551584041693, 'psi': 0.49936964323881095}-{'f1_val': 0.49824408849912083, 'auprc': 0.49824408849912083, 'loss_val': 0.16539196762648478, 'psi': 0.49824408849912083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=30 head_norm_before_train=3.746773 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.995704982365456, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.967023924811741, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=2.740677 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.220768051409291, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.184708696244747, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=3.387417 cos_to_last_merge=0.9638 (last merge round=1)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.006791010186604, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 4.966073959001867, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=30 head_norm_before_train=2.981239 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.255528888501029, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.230406217204661, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=4.020151 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.0969162264363406, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.0165165834541603, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=2.812775 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.972030986359417, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.890862696455983, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=3.407429 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7839368254150106, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7805820092884153, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=2.931897 cos_to_last_merge=0.9793 (last merge round=1)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.1452231141968612, 'auprc': 0.1452231141968612, 'loss_val': 7.59473457361578, 'psi': 0.1452231141968612}-{'f1_val': 0.14544928793464904, 'auprc': 0.14544928793464904, 'loss_val': 7.526771635897468, 'psi': 0.14544928793464904}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=3.646085 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.9794776499660187, 'auprc': 0.9794776499660187, 'loss_val': 0.11289171473885784, 'psi': 0.9794776499660187}-{'f1_val': 0.9797575339928171, 'auprc': 0.9797575339928171, 'loss_val': 0.1084473839743121, 'psi': 0.9797575339928171}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=2.854173 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.24950322901142574, 'auprc': 0.24950322901142574, 'loss_val': 5.0034237313143946, 'psi': 0.24950322901142574}-{'f1_val': 0.24950322901142574, 'auprc': 0.24950322901142574, 'loss_val': 4.969665113022327, 'psi': 0.24950322901142574}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=3.033621 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.568892143504823, 'psi': 0.2586450700604191}-{'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.540677005956124, 'psi': 0.2586450700604191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=3.867321 cos_to_last_merge=0.9277 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.928
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.602127898725302, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.5574173425696625, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=3.948608 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.7130316558640597, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.5650115252731407, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=2.958301 cos_to_last_merge=0.9758 (last merge round=1)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.164301962797722, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.077503254248054, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=3.850226 (no previous merge yet)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.49936964323881095, 'auprc': 0.49936964323881095, 'loss_val': 0.1701570289678312, 'psi': 0.49936964323881095}-{'f1_val': 0.49936964323881095, 'auprc': 0.49936964323881095, 'loss_val': 0.13431551584041693, 'psi': 0.49936964323881095}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=3.781472 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.025972110904886, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 3.995704982365456, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=2.757720 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.255536698484101, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.220768051409291, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=3.408498 cos_to_last_merge=0.9629 (last merge round=1)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.046424685616151, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.006791010186604, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=2.999759 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.282637073665229, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.255528888501029, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=4.058736 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.1132099995993348, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.0969162264363406, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=2.828860 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.051920888165007, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 10.972030986359417, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=3.427765 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7918754836889459, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7839368254150106, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=2.949657 cos_to_last_merge=0.9788 (last merge round=1)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.1452231141968612, 'auprc': 0.1452231141968612, 'loss_val': 7.662151600624276, 'psi': 0.1452231141968612}-{'f1_val': 0.1452231141968612, 'auprc': 0.1452231141968612, 'loss_val': 7.59473457361578, 'psi': 0.1452231141968612}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=3.664689 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.9794776499660187, 'auprc': 0.9794776499660187, 'loss_val': 0.11563516904000812, 'psi': 0.9794776499660187}-{'f1_val': 0.9794776499660187, 'auprc': 0.9794776499660187, 'loss_val': 0.11289171473885784, 'psi': 0.9794776499660187}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=2.870843 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.24936386768447838, 'auprc': 0.24936386768447838, 'loss_val': 5.0370530224946855, 'psi': 0.24936386768447838}-{'f1_val': 0.24950322901142574, 'auprc': 0.24950322901142574, 'loss_val': 5.0034237313143946, 'psi': 0.24950322901142574}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=3.050673 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.258595205963627, 'auprc': 0.258595205963627, 'loss_val': 4.5979225888442645, 'psi': 0.258595205963627}-{'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 4.568892143504823, 'psi': 0.2586450700604191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=3.909033 cos_to_last_merge=0.9257 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.926
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.24305170395020645, 'auprc': 0.24305170395020645, 'loss_val': 3.838467843096604, 'psi': 0.24305170395020642}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.602127898725302, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=3.992094 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.8903058973881233, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.7130316558640597, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=2.975151 cos_to_last_merge=0.9753 (last merge round=1)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.248790768798022, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.164301962797722, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=3.901193 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.4981805111821086, 'auprc': 0.4981805111821086, 'loss_val': 0.20614781552500644, 'psi': 0.4981805111821086}-{'f1_val': 0.49936964323881095, 'auprc': 0.49936964323881095, 'loss_val': 0.1701570289678312, 'psi': 0.49936964323881095}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=3.815485 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.057493950780128, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.025972110904886, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=2.774586 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.290408079270721, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.255536698484101, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=3.429318 cos_to_last_merge=0.9621 (last merge round=1)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.086302317199125, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.046424685616151, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=3.018040 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.31187022764055, 'psi': 0.33162711338607104}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.282637073665229, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=3.996068 (no previous merge yet)
[S13] round=32 local utility u=0.072339 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.9685320395463866, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.1132099995993348, 'psi': 0.3330058939096267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=32 head_norm_before_train=2.844792 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.131504647980583, 'psi': 0.13577478824115594}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 11.051920888165007, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=3.447731 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7972221334927609, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7918754836889459, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=2.967134 cos_to_last_merge=0.9783 (last merge round=1)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.14556230124313385, 'auprc': 0.14556230124313385, 'loss_val': 7.69800172996825, 'psi': 0.14556230124313385}-{'f1_val': 0.1452231141968612, 'auprc': 0.1452231141968612, 'loss_val': 7.662151600624276, 'psi': 0.1452231141968612}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=3.683205 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.9794776499660187, 'auprc': 0.9794776499660187, 'loss_val': 0.11987375193209905, 'psi': 0.9794776499660187}-{'f1_val': 0.9794776499660187, 'auprc': 0.9794776499660187, 'loss_val': 0.11563516904000812, 'psi': 0.9794776499660187}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=2.887366 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.24936386768447838, 'auprc': 0.24936386768447838, 'loss_val': 5.069980333504493, 'psi': 0.24936386768447838}-{'f1_val': 0.24936386768447838, 'auprc': 0.24936386768447838, 'loss_val': 5.0370530224946855, 'psi': 0.24936386768447838}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=3.067614 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.25854536108969417, 'auprc': 0.25854536108969417, 'loss_val': 4.626817341545613, 'psi': 0.25854536108969417}-{'f1_val': 0.258595205963627, 'auprc': 0.258595205963627, 'loss_val': 4.5979225888442645, 'psi': 0.258595205963627}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=3.917109 cos_to_last_merge=0.9196 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.24153346806295548, 'auprc': 0.24153346806295548, 'loss_val': 4.112746083451133, 'psi': 0.24153346806295548}-{'f1_val': 0.24305170395020645, 'auprc': 0.24305170395020645, 'loss_val': 3.838467843096604, 'psi': 0.24305170395020642}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=4.030315 (no previous merge yet)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.068830370378413, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.8903058973881233, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=2.991890 cos_to_last_merge=0.9748 (last merge round=1)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.333851320734205, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.248790768798022, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=3.889939 (no previous merge yet)
[S7] round=33 local utility u=0.038584 metrics={'f1_val': 0.498995238318914, 'auprc': 0.498995238318914, 'loss_val': 0.136312832227203, 'psi': 0.498995238318914}-{'f1_val': 0.4981805111821086, 'auprc': 0.4981805111821086, 'loss_val': 0.20614781552500644, 'psi': 0.4981805111821086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=33 head_norm_before_train=3.848705 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.091253524396734, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.057493950780128, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=2.791327 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.325190579302092, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.290408079270721, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=3.450066 cos_to_last_merge=0.9612 (last merge round=1)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.12532367438761, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.086302317199125, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=3.036277 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.335464752380933, 'psi': 0.33154997286190585}-{'f1_val': 0.33162711338607104, 'auprc': 0.33162711338607104, 'loss_val': 5.31187022764055, 'psi': 0.33162711338607104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=3.855568 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.020191641950655, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 1.9685320395463866, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=2.860597 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.20982188550339, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.131504647980583, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=3.467503 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.8040532589341304, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.7972221334927609, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=2.984478 cos_to_last_merge=0.9779 (last merge round=1)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.14544928793464904, 'auprc': 0.14544928793464904, 'loss_val': 7.779163526587988, 'psi': 0.14544928793464904}-{'f1_val': 0.14556230124313385, 'auprc': 0.14556230124313385, 'loss_val': 7.69800172996825, 'psi': 0.14556230124313385}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=3.700840 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.9794776499660187, 'auprc': 0.9794776499660187, 'loss_val': 0.1240515400968064, 'psi': 0.9794776499660187}-{'f1_val': 0.9794776499660187, 'auprc': 0.9794776499660187, 'loss_val': 0.11987375193209905, 'psi': 0.9794776499660187}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=2.903702 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.2495497174088566, 'auprc': 0.2495497174088566, 'loss_val': 5.102605204543724, 'psi': 0.24954971740885662}-{'f1_val': 0.24936386768447838, 'auprc': 0.24936386768447838, 'loss_val': 5.069980333504493, 'psi': 0.24936386768447838}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=3.084416 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.655768276618966, 'psi': 0.2584955354275069}-{'f1_val': 0.25854536108969417, 'auprc': 0.25854536108969417, 'loss_val': 4.626817341545613, 'psi': 0.25854536108969417}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=3.997381 cos_to_last_merge=0.9200 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.2422009334315893, 'auprc': 0.2422009334315893, 'loss_val': 4.171282210641119, 'psi': 0.2422009334315893}-{'f1_val': 0.24153346806295548, 'auprc': 0.24153346806295548, 'loss_val': 4.112746083451133, 'psi': 0.24153346806295548}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=4.065835 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.235422747399553, 'psi': 0.3335071121394324}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.068830370378413, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=3.008492 cos_to_last_merge=0.9743 (last merge round=1)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.418038446930835, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.333851320734205, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=3.929825 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.49855719615464983, 'auprc': 0.49855719615464983, 'loss_val': 0.1379354658382903, 'psi': 0.4985571961546498}-{'f1_val': 0.498995238318914, 'auprc': 0.498995238318914, 'loss_val': 0.136312832227203, 'psi': 0.498995238318914}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=3.881463 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.125837780797537, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.091253524396734, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=2.807927 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.360096580436369, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.325190579302092, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=3.470599 cos_to_last_merge=0.9604 (last merge round=1)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.164427335748017, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.12532367438761, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=3.054281 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.363312604855845, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.335464752380933, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=3.919409 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.0746044781352686, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.020191641950655, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=2.876336 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.287914868539865, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.20982188550339, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=3.487235 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.8111313542390711, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.8040532589341304, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=3.001759 cos_to_last_merge=0.9774 (last merge round=1)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.14556230124313385, 'auprc': 0.14556230124313385, 'loss_val': 7.828318231540525, 'psi': 0.14556230124313385}-{'f1_val': 0.14544928793464904, 'auprc': 0.14544928793464904, 'loss_val': 7.779163526587988, 'psi': 0.14544928793464904}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=3.718353 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.9794776499660187, 'auprc': 0.9794776499660187, 'loss_val': 0.12628007731980348, 'psi': 0.9794776499660187}-{'f1_val': 0.9794776499660187, 'auprc': 0.9794776499660187, 'loss_val': 0.1240515400968064, 'psi': 0.9794776499660187}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=2.919942 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.2495497174088566, 'auprc': 0.2495497174088566, 'loss_val': 5.135008425435024, 'psi': 0.24954971740885662}-{'f1_val': 0.2495497174088566, 'auprc': 0.2495497174088566, 'loss_val': 5.102605204543724, 'psi': 0.24954971740885662}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=3.101096 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.6843119294034885, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.655768276618966, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=4.036306 cos_to_last_merge=0.9195 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=35 local utility u=0.002471 metrics={'f1_val': 0.24300677757239678, 'auprc': 0.24300677757239678, 'loss_val': 4.173593388392097, 'psi': 0.24300677757239678}-{'f1_val': 0.2422009334315893, 'auprc': 0.2422009334315893, 'loss_val': 4.171282210641119, 'psi': 0.2422009334315893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=35 head_norm_before_train=4.099055 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.397192840849123, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.235422747399553, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=3.025090 cos_to_last_merge=0.9738 (last merge round=1)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.501689376441165, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.418038446930835, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=3.970348 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.49799089916708983, 'auprc': 0.49799089916708983, 'loss_val': 0.14093223348836095, 'psi': 0.49799089916708983}-{'f1_val': 0.49855719615464983, 'auprc': 0.49855719615464983, 'loss_val': 0.1379354658382903, 'psi': 0.4985571961546498}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=3.913005 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.1594270006769, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.125837780797537, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=2.824450 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.395026505078323, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.360096580436369, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=3.490985 cos_to_last_merge=0.9596 (last merge round=1)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.202203778290902, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.164427335748017, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=3.072222 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.384590194941751, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.363312604855845, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=3.965907 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.1189436385814346, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.0746044781352686, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=2.891912 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.364933231772834, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.287914868539865, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=3.506723 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.8171800369932477, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.8111313542390711, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=3.018831 cos_to_last_merge=0.9769 (last merge round=1)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.14556230124313385, 'auprc': 0.14556230124313385, 'loss_val': 7.878636675931731, 'psi': 0.14556230124313385}-{'f1_val': 0.14556230124313385, 'auprc': 0.14556230124313385, 'loss_val': 7.828318231540525, 'psi': 0.14556230124313385}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=3.735358 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.9791977970904402, 'auprc': 0.9791977970904402, 'loss_val': 0.131342508098732, 'psi': 0.9791977970904402}-{'f1_val': 0.9794776499660187, 'auprc': 0.9794776499660187, 'loss_val': 0.12628007731980348, 'psi': 0.9794776499660187}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=2.936116 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.24936386768447838, 'auprc': 0.24936386768447838, 'loss_val': 5.167549499944288, 'psi': 0.24936386768447838}-{'f1_val': 0.2495497174088566, 'auprc': 0.2495497174088566, 'loss_val': 5.135008425435024, 'psi': 0.24954971740885662}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=3.117631 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.712111208975792, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.6843119294034885, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=4.085479 cos_to_last_merge=0.9182 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.23812111332488076, 'auprc': 0.23812111332488076, 'loss_val': 4.353876500817126, 'psi': 0.23812111332488076}-{'f1_val': 0.24300677757239678, 'auprc': 0.24300677757239678, 'loss_val': 4.173593388392097, 'psi': 0.24300677757239678}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=4.130158 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.555283378274723, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.397192840849123, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=3.041653 cos_to_last_merge=0.9733 (last merge round=1)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.583994182341486, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.501689376441165, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=4.013646 (no previous merge yet)
[S7] round=36 local utility u=0.004904 metrics={'f1_val': 0.49868250719009266, 'auprc': 0.49868250719009266, 'loss_val': 0.13734805558723812, 'psi': 0.49868250719009266}-{'f1_val': 0.49799089916708983, 'auprc': 0.49799089916708983, 'loss_val': 0.14093223348836095, 'psi': 0.49799089916708983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=36 head_norm_before_train=3.943947 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.19363621601552, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.1594270006769, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=2.840929 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.4290824939301805, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.395026505078323, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=3.511275 cos_to_last_merge=0.9588 (last merge round=1)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.240388056896322, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.202203778290902, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=3.090158 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.41140856426059, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.384590194941751, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=4.003048 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.1536150437934625, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.1189436385814346, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=2.907455 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.442350476896543, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.364933231772834, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=3.526023 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.8211957681816325, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.8171800369932477, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=3.035889 cos_to_last_merge=0.9764 (last merge round=1)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.14556230124313385, 'auprc': 0.14556230124313385, 'loss_val': 7.947748872427553, 'psi': 0.14556230124313385}-{'f1_val': 0.14556230124313385, 'auprc': 0.14556230124313385, 'loss_val': 7.878636675931731, 'psi': 0.14556230124313385}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=3.752201 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.9791977970904402, 'auprc': 0.9791977970904402, 'loss_val': 0.1339629736974471, 'psi': 0.9791977970904402}-{'f1_val': 0.9791977970904402, 'auprc': 0.9791977970904402, 'loss_val': 0.131342508098732, 'psi': 0.9791977970904402}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=2.952174 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.2493174484983867, 'auprc': 0.2493174484983867, 'loss_val': 5.199358973870802, 'psi': 0.2493174484983867}-{'f1_val': 0.24936386768447838, 'auprc': 0.24936386768447838, 'loss_val': 5.167549499944288, 'psi': 0.24936386768447838}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=3.133986 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.74170164215262, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.712111208975792, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=4.116133 cos_to_last_merge=0.9177 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=37 local utility u=0.612553 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.196826412297076, 'psi': 0.3567939207526687}-{'f1_val': 0.23812111332488076, 'auprc': 0.23812111332488076, 'loss_val': 4.353876500817126, 'psi': 0.23812111332488076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=37 head_norm_before_train=4.159613 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6901231108699406, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.555283378274723, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=3.057883 cos_to_last_merge=0.9728 (last merge round=1)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.667821914661078, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.583994182341486, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=4.078946 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.4976754986507803, 'auprc': 0.4976754986507803, 'loss_val': 0.27499061347164466, 'psi': 0.4976754986507803}-{'f1_val': 0.49868250719009266, 'auprc': 0.49868250719009266, 'loss_val': 0.13734805558723812, 'psi': 0.49868250719009266}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=3.974531 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.227370203646064, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.19363621601552, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=2.857232 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.462967587414686, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.4290824939301805, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=3.531387 cos_to_last_merge=0.9580 (last merge round=1)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.278240942556224, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.240388056896322, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=3.107907 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.433048426607923, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.41140856426059, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=4.035456 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.1903594510973563, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.1536150437934625, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=2.922856 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.51829671215066, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.442350476896543, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=3.545339 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.8291134757024846, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.8211957681816325, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=3.052773 cos_to_last_merge=0.9760 (last merge round=1)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.14544928793464904, 'auprc': 0.14544928793464904, 'loss_val': 8.018063109436897, 'psi': 0.14544928793464904}-{'f1_val': 0.14556230124313385, 'auprc': 0.14556230124313385, 'loss_val': 7.947748872427553, 'psi': 0.14556230124313385}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=3.769350 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.14164198634622246, 'psi': 0.9786381842456608}-{'f1_val': 0.9791977970904402, 'auprc': 0.9791977970904402, 'loss_val': 0.1339629736974471, 'psi': 0.9791977970904402}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=2.968114 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.24922466195261136, 'auprc': 0.24922466195261136, 'loss_val': 5.231147813708743, 'psi': 0.24922466195261136}-{'f1_val': 0.2493174484983867, 'auprc': 0.2493174484983867, 'loss_val': 5.199358973870802, 'psi': 0.2493174484983867}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=3.150450 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.770028648557132, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.74170164215262, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=4.097005 cos_to_last_merge=0.9156 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.916
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.2422009334315893, 'auprc': 0.2422009334315893, 'loss_val': 4.001526085252727, 'psi': 0.2422009334315893}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.196826412297076, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=4.188792 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8561576339766073, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6901231108699406, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=3.073963 cos_to_last_merge=0.9723 (last merge round=1)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.750217288097932, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.667821914661078, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=4.106719 (no previous merge yet)
[S7] round=38 local utility u=0.092758 metrics={'f1_val': 0.49750368960602664, 'auprc': 0.49750368960602664, 'loss_val': 0.08792737965674251, 'psi': 0.49750368960602664}-{'f1_val': 0.4976754986507803, 'auprc': 0.4976754986507803, 'loss_val': 0.27499061347164466, 'psi': 0.4976754986507803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=38 head_norm_before_train=4.004523 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.261621295306274, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.227370203646064, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=2.873385 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.496986429720812, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.462967587414686, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=3.551495 cos_to_last_merge=0.9572 (last merge round=1)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.315622059417053, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.278240942556224, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=3.125551 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.462145989159117, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.433048426607923, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=4.064617 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.222800623939665, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.1903594510973563, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=2.938199 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.593778775145065, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.51829671215066, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=3.564423 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.8347699924396244, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.8291134757024846, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=3.069599 cos_to_last_merge=0.9755 (last merge round=1)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.14556230124313385, 'auprc': 0.14556230124313385, 'loss_val': 8.075287403941928, 'psi': 0.14556230124313385}-{'f1_val': 0.14544928793464904, 'auprc': 0.14544928793464904, 'loss_val': 8.018063109436897, 'psi': 0.14544928793464904}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=3.786659 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.14208551450518045, 'psi': 0.9786381842456608}-{'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.14164198634622246, 'psi': 0.9786381842456608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=2.983977 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.24913194444444445, 'auprc': 0.24913194444444445, 'loss_val': 5.263488365154394, 'psi': 0.24913194444444445}-{'f1_val': 0.24922466195261136, 'auprc': 0.24922466195261136, 'loss_val': 5.231147813708743, 'psi': 0.24922466195261136}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.249 u=0.0000 p_local=0.0002 f1=0.249 auprc=0.249 bytes=0
[S3] START round=39 head_norm_before_train=3.166665 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.798938417961894, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.770028648557132, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.258 u=0.0000 p_local=0.0002 f1=0.258 auprc=0.258 bytes=1795
[S4] START round=39 head_norm_before_train=4.105152 cos_to_last_merge=0.9116 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=39 local utility u=0.103049 metrics={'f1_val': 0.24309664694280078, 'auprc': 0.24309664694280078, 'loss_val': 3.803488752900255, 'psi': 0.24309664694280078}-{'f1_val': 0.2422009334315893, 'auprc': 0.2422009334315893, 'loss_val': 4.001526085252727, 'psi': 0.2422009334315893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] sending update (kind=head size=1789 to 1 peers)
[S4] r=40 psi=0.243 u=0.1030 p_local=0.0995 f1=0.243 auprc=0.243 bytes=7168
[S5] START round=39 head_norm_before_train=4.217596 (no previous merge yet)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9987749632733096, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8561576339766073, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.334 u=0.0000 p_local=0.0204 f1=0.334 auprc=0.334 bytes=19790
[S6] START round=39 head_norm_before_train=3.090023 cos_to_last_merge=0.9718 (last merge round=1)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.831867550876765, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.750217288097932, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.022 u=0.0000 p_local=0.0002 f1=0.022 auprc=0.022 bytes=0
[S7] START round=39 head_norm_before_train=4.181539 (no previous merge yet)
[S7] round=39 local utility u=0.003659 metrics={'f1_val': 0.4975669277033721, 'auprc': 0.4975669277033721, 'loss_val': 0.0811778451071801, 'psi': 0.4975669277033721}-{'f1_val': 0.49750368960602664, 'auprc': 0.49750368960602664, 'loss_val': 0.08792737965674251, 'psi': 0.49750368960602664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S7] r=40 psi=0.498 u=0.0037 p_local=0.0392 f1=0.498 auprc=0.498 bytes=36038
[S8] START round=39 head_norm_before_train=4.034149 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.297198392450043, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.261621295306274, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0002 f1=0.359 auprc=0.359 bytes=3611
[S9] START round=39 head_norm_before_train=2.889523 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.530075692722885, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.496986429720812, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0002 f1=0.369 auprc=0.369 bytes=0
[S10] START round=39 head_norm_before_train=3.571348 cos_to_last_merge=0.9564 (last merge round=1)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.35245424820542, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.315622059417053, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.333 u=0.0000 p_local=0.0002 f1=0.333 auprc=0.333 bytes=1803
[S11] START round=39 head_norm_before_train=3.143112 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.488134698170394, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.462145989159117, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0002 f1=0.332 auprc=0.332 bytes=0
[S13] START round=39 head_norm_before_train=4.091245 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.252897068434468, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.222800623939665, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.333 u=0.0000 p_local=0.0058 f1=0.333 auprc=0.333 bytes=21537
[S14] START round=39 head_norm_before_train=2.953481 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.669114063944507, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.593778775145065, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0002 f1=0.136 auprc=0.136 bytes=0
[S15] START round=39 head_norm_before_train=3.583417 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8407120324998312, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.8347699924396244, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.616 u=0.0000 p_local=0.0002 f1=0.616 auprc=0.616 bytes=1804
[S16] START round=39 head_norm_before_train=3.086343 cos_to_last_merge=0.9751 (last merge round=1)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.14556230124313385, 'auprc': 0.14556230124313385, 'loss_val': 8.129917517003298, 'psi': 0.14556230124313385}-{'f1_val': 0.14556230124313385, 'auprc': 0.14556230124313385, 'loss_val': 8.075287403941928, 'psi': 0.14556230124313385}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.146 u=0.0000 p_local=0.0002 f1=0.146 auprc=0.146 bytes=0
[S17] START round=39 head_norm_before_train=3.803282 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.1447619692539304, 'psi': 0.9786381842456608}-{'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.14208551450518045, 'psi': 0.9786381842456608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.979 u=0.0000 p_local=0.0037 f1=0.979 auprc=0.979 bytes=26967
[S2] START round=40 head_norm_before_train=2.999860 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.24903929589686377, 'auprc': 0.24903929589686377, 'loss_val': 5.295816246159854, 'psi': 0.24903929589686374}-{'f1_val': 0.24913194444444445, 'auprc': 0.24913194444444445, 'loss_val': 5.263488365154394, 'psi': 0.24913194444444445}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=3.182879 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.827041614556242, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.798938417961894, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=4.169860 cos_to_last_merge=0.9106 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.911
[S4] round=40 local utility u=0.093950 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.6388641812607565, 'psi': 0.3567939207526687}-{'f1_val': 0.24309664694280078, 'auprc': 0.24309664694280078, 'loss_val': 3.803488752900255, 'psi': 0.24309664694280078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=40 head_norm_before_train=4.244083 (no previous merge yet)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.120770078330753, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9987749632733096, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=3.105930 cos_to_last_merge=0.9714 (last merge round=1)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.913538159421318, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.831867550876765, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=4.233415 (no previous merge yet)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.49855719615464983, 'auprc': 0.49855719615464983, 'loss_val': 0.10196759636723834, 'psi': 0.4985571961546498}-{'f1_val': 0.4975669277033721, 'auprc': 0.4975669277033721, 'loss_val': 0.0811778451071801, 'psi': 0.4975669277033721}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=4.063512 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.332514109459948, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.297198392450043, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=2.905513 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.563106690597062, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.530075692722885, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=3.591290 cos_to_last_merge=0.9556 (last merge round=1)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.389021226384124, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.35245424820542, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=3.160628 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.513231811170285, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.488134698170394, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=4.116266 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.2851554167452766, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.252897068434468, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=2.968750 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.743450218003833, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.669114063944507, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=3.602214 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8473630807376498, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8407120324998312, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=3.103005 cos_to_last_merge=0.9746 (last merge round=1)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.14578818089871406, 'auprc': 0.14578818089871406, 'loss_val': 8.168340532844203, 'psi': 0.14578818089871406}-{'f1_val': 0.14556230124313385, 'auprc': 0.14556230124313385, 'loss_val': 8.129917517003298, 'psi': 0.14556230124313385}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=3.819553 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.1479333514574831, 'psi': 0.9786381842456608}-{'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.1447619692539304, 'psi': 0.9786381842456608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=3.015713 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.24899299745925516, 'auprc': 0.24899299745925516, 'loss_val': 5.327963169298797, 'psi': 0.24899299745925516}-{'f1_val': 0.24903929589686377, 'auprc': 0.24903929589686377, 'loss_val': 5.295816246159854, 'psi': 0.24903929589686374}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=3.198968 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.855603184165189, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.827041614556242, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=4.178148 cos_to_last_merge=0.9103 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.910
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.2431865828092243, 'auprc': 0.2431865828092243, 'loss_val': 4.03564720699132, 'psi': 0.2431865828092243}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 4.6388641812607565, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=4.268843 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.24353691888229, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.120770078330753, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=3.121836 cos_to_last_merge=0.9709 (last merge round=1)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.995343175920492, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.913538159421318, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=4.280466 (no previous merge yet)
[S7] round=41 local utility u=0.014101 metrics={'f1_val': 0.4986371448895006, 'auprc': 0.4986371448895006, 'loss_val': 0.07448553189164893, 'psi': 0.4986371448895006}-{'f1_val': 0.49855719615464983, 'auprc': 0.49855719615464983, 'loss_val': 0.10196759636723834, 'psi': 0.4985571961546498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=41 head_norm_before_train=4.092343 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.368526074479298, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.332514109459948, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=2.921447 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.595697548096239, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.563106690597062, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=3.611063 cos_to_last_merge=0.9548 (last merge round=1)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.426010833332403, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.389021226384124, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=3.178004 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.537916906997326, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.513231811170285, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=4.139891 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.3113305408150238, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.2851554167452766, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.983997 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.818164582580431, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.743450218003833, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=3.620933 (no previous merge yet)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8529116772809433, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8473630807376498, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=3.119585 cos_to_last_merge=0.9742 (last merge round=1)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.14590104730949802, 'auprc': 0.14590104730949802, 'loss_val': 8.223507491143257, 'psi': 0.14590104730949802}-{'f1_val': 0.14578818089871406, 'auprc': 0.14578818089871406, 'loss_val': 8.168340532844203, 'psi': 0.14578818089871406}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=3.835847 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.1494512956740408, 'psi': 0.9786381842456608}-{'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.1479333514574831, 'psi': 0.9786381842456608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=3.031499 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.24894671623296158, 'auprc': 0.24894671623296158, 'loss_val': 5.360499489876593, 'psi': 0.24894671623296158}-{'f1_val': 0.24899299745925516, 'auprc': 0.24899299745925516, 'loss_val': 5.327963169298797, 'psi': 0.24899299745925516}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=3.215011 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.88367697830075, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.855603184165189, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=4.269760 cos_to_last_merge=0.9051 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.905
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.2431865828092243, 'auprc': 0.2431865828092243, 'loss_val': 4.308219038946972, 'psi': 0.2431865828092243}-{'f1_val': 0.2431865828092243, 'auprc': 0.2431865828092243, 'loss_val': 4.03564720699132, 'psi': 0.2431865828092243}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=4.293584 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.3651787690362083, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.24353691888229, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=3.137655 cos_to_last_merge=0.9704 (last merge round=1)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.075516946981592, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 12.995343175920492, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=4.246358 (no previous merge yet)
[S7] round=42 local utility u=0.012939 metrics={'f1_val': 0.4986371448895006, 'auprc': 0.4986371448895006, 'loss_val': 0.04860753134821475, 'psi': 0.4986371448895006}-{'f1_val': 0.4986371448895006, 'auprc': 0.4986371448895006, 'loss_val': 0.07448553189164893, 'psi': 0.4986371448895006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=42 head_norm_before_train=4.121667 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.403477781213371, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.368526074479298, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=2.937257 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.630103533043983, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.595697548096239, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=3.630739 cos_to_last_merge=0.9540 (last merge round=1)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.462248547059211, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.426010833332403, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=3.195400 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.563817329577446, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.537916906997326, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=4.162349 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.338282211724938, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.3113305408150238, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=2.999093 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.892365478077066, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.818164582580431, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=3.639586 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8578690003295932, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8529116772809433, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=3.136103 cos_to_last_merge=0.9737 (last merge round=1)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.14601386481802428, 'auprc': 0.14601386481802428, 'loss_val': 8.275894858844822, 'psi': 0.14601386481802428}-{'f1_val': 0.14590104730949802, 'auprc': 0.14590104730949802, 'loss_val': 8.223507491143257, 'psi': 0.14590104730949802}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=3.852037 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.15308822711433376, 'psi': 0.9786381842456608}-{'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.1494512956740408, 'psi': 0.9786381842456608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=3.047275 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.24890045220838752, 'auprc': 0.24890045220838752, 'loss_val': 5.3916799262010295, 'psi': 0.24890045220838752}-{'f1_val': 0.24894671623296158, 'auprc': 0.24894671623296158, 'loss_val': 5.360499489876593, 'psi': 0.24894671623296158}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=3.230961 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.912038837926608, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.88367697830075, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=4.321163 cos_to_last_merge=0.9050 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.905
[S4] round=43 local utility u=0.121246 metrics={'f1_val': 0.24327658524549714, 'auprc': 0.24327658524549714, 'loss_val': 4.066537230728223, 'psi': 0.2432765852454971}-{'f1_val': 0.2431865828092243, 'auprc': 0.2431865828092243, 'loss_val': 4.308219038946972, 'psi': 0.2431865828092243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] sending update (kind=head size=1789 to 1 peers)
[S5] START round=43 head_norm_before_train=4.318264 (no previous merge yet)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.4778098587589, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.3651787690362083, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=3.153450 cos_to_last_merge=0.9700 (last merge round=1)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.157881006923446, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.075516946981592, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=4.285770 (no previous merge yet)
[S7] round=43 local utility u=0.005881 metrics={'f1_val': 0.4986998160437376, 'auprc': 0.4986998160437376, 'loss_val': 0.03740892572664667, 'psi': 0.4986998160437376}-{'f1_val': 0.4986371448895006, 'auprc': 0.4986371448895006, 'loss_val': 0.04860753134821475, 'psi': 0.4986371448895006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=43 head_norm_before_train=4.150025 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.4389574400542955, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.403477781213371, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.953181 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.662919857048902, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.630103533043983, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=3.650391 cos_to_last_merge=0.9533 (last merge round=1)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.497695639228714, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.462248547059211, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=3.212663 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.589922052087984, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.563817329577446, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=4.183948 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.3672156652193785, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.338282211724938, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=3.014177 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.966507709778984, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.892365478077066, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=3.658063 (no previous merge yet)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8650749450847692, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8578690003295932, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=3.152558 cos_to_last_merge=0.9733 (last merge round=1)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.14590104730949802, 'auprc': 0.14590104730949802, 'loss_val': 8.340032475073649, 'psi': 0.14590104730949802}-{'f1_val': 0.14601386481802428, 'auprc': 0.14601386481802428, 'loss_val': 8.275894858844822, 'psi': 0.14601386481802428}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=3.868289 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.1564102588035837, 'psi': 0.9786381842456608}-{'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.15308822711433376, 'psi': 0.9786381842456608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=3.062851 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.2488542053759445, 'auprc': 0.2488542053759445, 'loss_val': 5.423359606125824, 'psi': 0.2488542053759445}-{'f1_val': 0.24890045220838752, 'auprc': 0.24890045220838752, 'loss_val': 5.3916799262010295, 'psi': 0.24890045220838752}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=3.246904 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.940392263758371, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.912038837926608, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=4.361013 cos_to_last_merge=0.9035 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.903
[S4] round=44 local utility u=0.067069 metrics={'f1_val': 0.24332161145042877, 'auprc': 0.24332161145042877, 'loss_val': 3.932804303627108, 'psi': 0.24332161145042877}-{'f1_val': 0.24327658524549714, 'auprc': 0.24327658524549714, 'loss_val': 4.066537230728223, 'psi': 0.2432765852454971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] sending update (kind=head size=1790 to 1 peers)
[S5] START round=44 head_norm_before_train=4.341846 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.5815475413962283, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.4778098587589, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=3.169132 cos_to_last_merge=0.9695 (last merge round=1)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.237596219210376, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.157881006923446, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=4.346710 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.4991376397874129, 'auprc': 0.4991376397874129, 'loss_val': 0.0421313930775968, 'psi': 0.4991376397874129}-{'f1_val': 0.4986998160437376, 'auprc': 0.4986998160437376, 'loss_val': 0.03740892572664667, 'psi': 0.4986998160437376}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=4.178177 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.4736392504712095, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.4389574400542955, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.968921 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.69612915110671, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.662919857048902, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=3.669951 cos_to_last_merge=0.9525 (last merge round=1)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.534221951024472, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.497695639228714, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=3.229944 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.610166093874471, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.589922052087984, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=4.204911 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.3916961105473704, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.3672156652193785, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=3.029282 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.039509924689192, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 11.966507709778984, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=3.676512 (no previous merge yet)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8692340645225135, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8650749450847692, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=3.168974 cos_to_last_merge=0.9728 (last merge round=1)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.14590104730949802, 'auprc': 0.14590104730949802, 'loss_val': 8.40017415343563, 'psi': 0.14590104730949802}-{'f1_val': 0.14590104730949802, 'auprc': 0.14590104730949802, 'loss_val': 8.340032475073649, 'psi': 0.14590104730949802}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=3.884321 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.15823275958440253, 'psi': 0.9786381842456608}-{'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.1564102588035837, 'psi': 0.9786381842456608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=3.078477 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.24876176324913324, 'auprc': 0.24876176324913324, 'loss_val': 5.454745678999058, 'psi': 0.24876176324913324}-{'f1_val': 0.2488542053759445, 'auprc': 0.2488542053759445, 'loss_val': 5.423359606125824, 'psi': 0.2488542053759445}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=3.262782 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.968990115782816, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.940392263758371, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=4.397720 cos_to_last_merge=0.9031 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.903
[S4] round=45 local utility u=0.009826 metrics={'f1_val': 0.24350188306476508, 'auprc': 0.24350188306476508, 'loss_val': 3.914774949698284, 'psi': 0.24350188306476506}-{'f1_val': 0.24332161145042877, 'auprc': 0.24332161145042877, 'loss_val': 3.932804303627108, 'psi': 0.24332161145042877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=45 head_norm_before_train=4.364455 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.674483568481645, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.5815475413962283, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=3.184764 cos_to_last_merge=0.9690 (last merge round=1)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.317702989249794, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.237596219210376, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=4.396840 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.49907518705376486, 'auprc': 0.49907518705376486, 'loss_val': 0.048576911962381605, 'psi': 0.49907518705376486}-{'f1_val': 0.4991376397874129, 'auprc': 0.4991376397874129, 'loss_val': 0.0421313930775968, 'psi': 0.4991376397874129}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=4.206153 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.508880320488184, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.4736392504712095, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.984773 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.729003630665743, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.69612915110671, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=3.689480 cos_to_last_merge=0.9517 (last merge round=1)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.569904894842235, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.534221951024472, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=3.247156 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.637540143040983, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.610166093874471, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=4.225255 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.417270314644872, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.3916961105473704, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=3.044327 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.113011093220331, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.039509924689192, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=3.694883 (no previous merge yet)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8751205976563918, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8692340645225135, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=3.185309 cos_to_last_merge=0.9724 (last merge round=1)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.14612663345606816, 'auprc': 0.14612663345606816, 'loss_val': 8.445700425211273, 'psi': 0.14612663345606816}-{'f1_val': 0.14590104730949802, 'auprc': 0.14590104730949802, 'loss_val': 8.40017415343563, 'psi': 0.14590104730949802}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=3.900564 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.16093849812271457, 'psi': 0.9786381842456608}-{'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.15823275958440253, 'psi': 0.9786381842456608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=3.094062 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.24876176324913324, 'auprc': 0.24876176324913324, 'loss_val': 5.4861520601381315, 'psi': 0.24876176324913324}-{'f1_val': 0.24876176324913324, 'auprc': 0.24876176324913324, 'loss_val': 5.454745678999058, 'psi': 0.24876176324913324}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=3.278625 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.9976221219148576, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.968990115782816, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=4.450856 cos_to_last_merge=0.9013 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.901
[S4] round=46 local utility u=0.020195 metrics={'f1_val': 0.24332161145042877, 'auprc': 0.24332161145042877, 'loss_val': 3.8727616939335987, 'psi': 0.24332161145042877}-{'f1_val': 0.24350188306476508, 'auprc': 0.24350188306476508, 'loss_val': 3.914774949698284, 'psi': 0.24350188306476506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=46 head_norm_before_train=4.386766 (no previous merge yet)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.7671363669280757, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.674483568481645, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=3.200461 cos_to_last_merge=0.9686 (last merge round=1)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.398943193428087, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.317702989249794, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=4.461947 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.49918250321398117, 'auprc': 0.49918250321398117, 'loss_val': 0.10026461932432842, 'psi': 0.49918250321398117}-{'f1_val': 0.49907518705376486, 'auprc': 0.49907518705376486, 'loss_val': 0.048576911962381605, 'psi': 0.49907518705376486}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=4.233459 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.543416368892261, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.508880320488184, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=3.000361 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.762134109303721, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.729003630665743, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=3.709072 cos_to_last_merge=0.9510 (last merge round=1)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.605001921681633, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.569904894842235, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=3.264334 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.660837385986774, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.637540143040983, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=4.245085 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.4431512321864775, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.417270314644872, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=3.059321 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.185522040413378, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.113011093220331, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=3.713173 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8803411573937048, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8751205976563918, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=3.201603 cos_to_last_merge=0.9719 (last merge round=1)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.14601386481802428, 'auprc': 0.14601386481802428, 'loss_val': 8.510520862248026, 'psi': 0.14601386481802428}-{'f1_val': 0.14612663345606816, 'auprc': 0.14612663345606816, 'loss_val': 8.445700425211273, 'psi': 0.14612663345606816}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=3.916637 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.16666717990239957, 'psi': 0.9786381842456608}-{'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.16093849812271457, 'psi': 0.9786381842456608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=3.109514 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.24871556793562366, 'auprc': 0.24871556793562366, 'loss_val': 5.517530347537837, 'psi': 0.24871556793562366}-{'f1_val': 0.24876176324913324, 'auprc': 0.24876176324913324, 'loss_val': 5.4861520601381315, 'psi': 0.24876176324913324}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=3.294457 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 5.02620918198541, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 4.9976221219148576, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=4.388393 cos_to_last_merge=0.8948 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.895
[S4] round=47 local utility u=0.055933 metrics={'f1_val': 0.24372759856630824, 'auprc': 0.24372759856630824, 'loss_val': 3.7645487318127144, 'psi': 0.24372759856630827}-{'f1_val': 0.24332161145042877, 'auprc': 0.24332161145042877, 'loss_val': 3.8727616939335987, 'psi': 0.24332161145042877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=47 head_norm_before_train=4.408864 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.8551151164781294, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.7671363669280757, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=3.216150 cos_to_last_merge=0.9681 (last merge round=1)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.478509409534666, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.398943193428087, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=4.510784 (no previous merge yet)
[S7] round=47 local utility u=0.002370 metrics={'f1_val': 0.498995238318914, 'auprc': 0.498995238318914, 'loss_val': 0.0938389098159475, 'psi': 0.498995238318914}-{'f1_val': 0.49918250321398117, 'auprc': 0.49918250321398117, 'loss_val': 0.10026461932432842, 'psi': 0.49918250321398117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=47 head_norm_before_train=4.260715 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.579410354135698, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.543416368892261, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=3.015998 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.795324024680589, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.762134109303721, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=3.728555 cos_to_last_merge=0.9502 (last merge round=1)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.640716716802369, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.605001921681633, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=3.281397 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.683059711543125, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.660837385986774, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=4.264521 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.4682727207790918, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.4431512321864775, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=3.074314 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.258275241933958, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.185522040413378, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=3.731339 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8859712857624513, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8803411573937048, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=3.217889 cos_to_last_merge=0.9715 (last merge round=1)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.14601386481802428, 'auprc': 0.14601386481802428, 'loss_val': 8.569128971389187, 'psi': 0.14601386481802428}-{'f1_val': 0.14601386481802428, 'auprc': 0.14601386481802428, 'loss_val': 8.510520862248026, 'psi': 0.14601386481802428}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=3.933131 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.16709035596756508, 'psi': 0.9786381842456608}-{'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.16666717990239957, 'psi': 0.9786381842456608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=3.125021 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.2486693897759624, 'auprc': 0.2486693897759624, 'loss_val': 5.548416765516859, 'psi': 0.24866938977596242}-{'f1_val': 0.24871556793562366, 'auprc': 0.24871556793562366, 'loss_val': 5.517530347537837, 'psi': 0.24871556793562366}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=3.310263 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 5.054030515684599, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 5.02620918198541, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=4.515538 cos_to_last_merge=0.8931 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.893
[S4] round=48 local utility u=0.095839 metrics={'f1_val': 0.2441802872709262, 'auprc': 0.2441802872709262, 'loss_val': 3.576944577945632, 'psi': 0.24418028727092617}-{'f1_val': 0.24372759856630824, 'auprc': 0.24372759856630824, 'loss_val': 3.7645487318127144, 'psi': 0.24372759856630827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=48 head_norm_before_train=4.430422 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.939230338846334, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.8551151164781294, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=3.231652 cos_to_last_merge=0.9677 (last merge round=1)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.557351865360957, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.478509409534666, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=4.605276 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.4980546982756554, 'auprc': 0.4980546982756554, 'loss_val': 0.12648199923687672, 'psi': 0.4980546982756554}-{'f1_val': 0.498995238318914, 'auprc': 0.498995238318914, 'loss_val': 0.0938389098159475, 'psi': 0.498995238318914}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=4.287865 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.6158777815297025, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.579410354135698, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=3.031739 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.828037327632872, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.795324024680589, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=3.747910 cos_to_last_merge=0.9495 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.675288072878122, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.640716716802369, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=3.298477 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.708195957528282, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.683059711543125, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=4.283857 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.493761513134452, 'psi': 0.3330058939096267}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.4682727207790918, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=3.089302 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.331577695003913, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.258275241933958, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=3.749521 (no previous merge yet)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8899809743811633, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8859712857624513, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=3.234167 cos_to_last_merge=0.9711 (last merge round=1)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.14601386481802428, 'auprc': 0.14601386481802428, 'loss_val': 8.625913209367495, 'psi': 0.14601386481802428}-{'f1_val': 0.14601386481802428, 'auprc': 0.14601386481802428, 'loss_val': 8.569128971389187, 'psi': 0.14601386481802428}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=3.949345 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.9783584240029749, 'auprc': 0.9783584240029749, 'loss_val': 0.17059755160869394, 'psi': 0.9783584240029749}-{'f1_val': 0.9786381842456608, 'auprc': 0.9786381842456608, 'loss_val': 0.16709035596756508, 'psi': 0.9786381842456608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=3.140377 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.2486693897759624, 'auprc': 0.2486693897759624, 'loss_val': 5.580104089073436, 'psi': 0.24866938977596242}-{'f1_val': 0.2486693897759624, 'auprc': 0.2486693897759624, 'loss_val': 5.548416765516859, 'psi': 0.24866938977596242}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=3.325961 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 5.08288126559192, 'psi': 0.2584955354275069}-{'f1_val': 0.2584955354275069, 'auprc': 0.2584955354275069, 'loss_val': 5.054030515684599, 'psi': 0.2584955354275069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=4.573512 cos_to_last_merge=0.8920 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.892
[S4] round=49 local utility u=0.293476 metrics={'f1_val': 0.2738888888888889, 'auprc': 0.2738888888888889, 'loss_val': 3.2573702303269254, 'psi': 0.2738888888888889}-{'f1_val': 0.2441802872709262, 'auprc': 0.2441802872709262, 'loss_val': 3.576944577945632, 'psi': 0.24418028727092617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=49 head_norm_before_train=4.451153 (no previous merge yet)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 4.030381222517366, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.939230338846334, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=3.247234 cos_to_last_merge=0.9672 (last merge round=1)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.638564606596196, 'psi': 0.02240512117055327}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 13.557351865360957, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=4.689569 (no previous merge yet)
[S7] round=49 local utility u=0.014972 metrics={'f1_val': 0.49792875943035686, 'auprc': 0.49792875943035686, 'loss_val': 0.09540405268217474, 'psi': 0.49792875943035686}-{'f1_val': 0.4980546982756554, 'auprc': 0.4980546982756554, 'loss_val': 0.12648199923687672, 'psi': 0.4980546982756554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=49 head_norm_before_train=4.315084 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.652867940588415, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 4.6158777815297025, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=3.047179 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.861029342397018, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 5.828037327632872, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=3.767267 cos_to_last_merge=0.9487 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.710866950560593, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 5.675288072878122, 'psi': 0.3330944988456333}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=3.315559 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.732818472579063, 'psi': 0.33154997286190585}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 5.708195957528282, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=4.303030 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.25711035267349264, 'auprc': 0.25711035267349264, 'loss_val': 2.4523533158372706, 'psi': 0.25711035267349264}-{'f1_val': 0.3330058939096267, 'auprc': 0.3330058939096267, 'loss_val': 2.493761513134452, 'psi': 0.3330058939096267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=3.104338 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.403938649830172, 'psi': 0.13577478824115594}-{'f1_val': 0.13577478824115594, 'auprc': 0.13577478824115594, 'loss_val': 12.331577695003913, 'psi': 0.13577478824115594}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=3.767671 (no previous merge yet)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8966186584752397, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.8899809743811633, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=3.250367 cos_to_last_merge=0.9706 (last merge round=1)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.14612663345606816, 'auprc': 0.14612663345606816, 'loss_val': 8.680097496219306, 'psi': 0.14612663345606816}-{'f1_val': 0.14601386481802428, 'auprc': 0.14601386481802428, 'loss_val': 8.625913209367495, 'psi': 0.14601386481802428}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=3.965624 (no previous merge yet)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.9783584240029749, 'auprc': 0.9783584240029749, 'loss_val': 0.1745434912191902, 'psi': 0.9783584240029749}-{'f1_val': 0.9783584240029749, 'auprc': 0.9783584240029749, 'loss_val': 0.17059755160869394, 'psi': 0.9783584240029749}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
